<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โฅ๏ธ ๐ค ๐ ูููุงุช ูุถุบูุทุฉ: ุงูุชุงุฑูุฎ ูุงูุดุฑุญ ูุงูุชูููุฐ ๐ ๐น ๐คด</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุทุงููุง ุชุณุงุกูุช ุนู ููููุฉ ุถุบุท ุงูุจูุงูุงุช ุ ุจูุง ูู ุฐูู ูู ูููุงุช ูุถุบูุทุฉ. ุจูุฌุฑุฏ ุฃู ูุฑุฑุช ุฅุดุจุงุน ูุถููู: ููุนุฑูุฉ ููููุฉ ุนูู ุงูุถุบุท ุ ููุชุงุจุฉ ุจุฑูุงูุฌ Zip ุงูุฎุงุต ุจู. ุฃุตุจุญ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ูููุงุช ูุถุบูุทุฉ: ุงูุชุงุฑูุฎ ูุงูุดุฑุญ ูุงูุชูููุฐ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/490790/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/bo/tw/dr/botwdrbtegpbnpnwmy7id56fbaa.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุทุงููุง ุชุณุงุกูุช ุนู ููููุฉ ุถุบุท ุงูุจูุงูุงุช ุ ุจูุง ูู ุฐูู ูู ูููุงุช ูุถุบูุทุฉ. ุจูุฌุฑุฏ ุฃู ูุฑุฑุช ุฅุดุจุงุน ูุถููู: ููุนุฑูุฉ ููููุฉ ุนูู ุงูุถุบุท ุ ููุชุงุจุฉ ุจุฑูุงูุฌ Zip ุงูุฎุงุต ุจู. ุฃุตุจุญ ุงูุชูููุฐ ููุงุฑุณุฉ ูุซูุฑุฉ ูู ุงูุจุฑูุฌุฉ. ุชุญุตู ุนูู ูุชุนุฉ ูุจูุฑุฉ ูู ุฅูุดุงุก ุขูุฉ ูุตุญุญุฉ ุชุฃุฎุฐ ุงูุจูุงูุงุช ุ ูุชููู ุจุชุงุชูุง ุฅูู ุชูุซูู ุฃูุซุฑ ููุงุกุฉ ุ ุซู ุชุฌูุนูุง ูุฑุฉ ุฃุฎุฑู. ุขูู ุฃู ุชููู ููุชููุง ุฃูุถูุง ุจุงููุฑุงุกุฉ ุนูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุดุฑุญ ุงูููุงูุฉ ุจุชูุตูู ูุจูุฑ ููู ุชุนูู ูููุงุช Zip ููุธุงู ุงูุถุบุท: ุถุบุท LZ77 ุ ุฎูุงุฑุฒููุฉ ููููุงู ุ ุฎูุงุฑุฒููุฉ ุงูุงูููุงุด ูุงููุฒูุฏ. ุณูู ุชุชุนูู ุชุงุฑูุฎ ุชุทูุฑ ุงูุชูููููุฌูุง ูุชูุธุฑ ูู ุฃูุซูุฉ ุงูุชูููุฐ ุงููุนุงูุฉ ุฅูู ุญุฏ ูุง ุงูููุชูุจุฉ ูู ุงูุตูุฑ ูู C. ุดูุฑุฉ ุงููุตุฏุฑ ููุง: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwzip-1.0.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃูุง ููุชู ุฌุฏุง ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุฌ ุงูุจุฑุชููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gynvael Coldwind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุจูุงู ุฌูุณูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌููุงุณ Skeppstedt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุดุจูุฉ ุงูุฅูุชุฑูุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primiano ุชูุชุดูุ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ููุจุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุฐูู ูุฏููุง ููุงุญุธุงุช ูููุฉ ุนูู ูุณูุฏุงุช ูู ูุฐู ุงููุงุฏุฉ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุญุชูู</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุฉ</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKZip</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Info-zip ู zlib</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winzip</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถุบุท Lempel-Ziv (LZ77)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ููููุงู</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ ููููุงู</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑููุฒ ููููุงู ุงููุงููููุฉ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุกุฉ ูู ููููุงู</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุบ</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏููุงุช ุจุช</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฑูุบ (ุงูุชุถุฎู)</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ููุฑุบุฉ ุบูุฑ ูุถุบูุทุฉ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุบ ุงููุชู ุจุงุณุชุฎุฏุงู ุฑููุฒ ููููุงู ุงูุซุงุจุชุฉ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑุงุบ ุงููุชู ุจุงุณุชุฎุฏุงู ุฑููุฒ Huffman ุงูุฏููุงููููุฉ</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุถุบุท (ุงูุงูููุงุด)</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุณูู ููู ูุถุบูุท</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑุฉ ุนุงูุฉ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงูู ุงูุจูุงูุงุช</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงูุฉ ุฅุฏุฎุงู ุงูุฏููู ุงููุฑูุฒู</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฃุณ ุงูููู ุงููุฑูุฒู</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฃุณ ููู ูุญูู</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููุฐ Zip Read</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููุฐ ุณุฌู Zip</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฒูุจ</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูููุงุช ุงูุชุฌููุน</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชูุชุงุฌ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุงุฑูู</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฏ ูููุฏุฉ</font></font></a></li>
</ul><br>
<a name="1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุฉ</font></font></h2><br>
<a name="2"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKZip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุซูุงููููุงุช ูุฃูุงุฆู ุงูุชุณุนููุงุช ุ ูุจู ุงูุชุดุงุฑ ุงูุฅูุชุฑูุช ุ ุงุณุชุฎุฏู ููุงุฉ ุงูููุจููุชุฑ ุฃุฌูุฒุฉ ููุฏู ุงูุงุชุตุงู ุงููุงุชูู ููุงุชุตุงู ุนุจุฑ ุดุจูุฉ ุงููุงุชู ุจุดุจูุฉ ุฃูุธูุฉ ููุญุฉ ุงูุฅุนูุงูุงุช (BBS). </font><font style="vertical-align: inherit;">BBS ูู ูุธุงู ููุจููุชุฑ ุชูุงุนูู ูุณูุญ ูููุณุชุฎุฏููู ุจุฅุฑุณุงู ุงูุฑุณุงุฆู ูููุงุฑุณุฉ ุงูุฃูุนุงุจ ููุดุงุฑูุฉ ุงููููุงุช. </font><font style="vertical-align: inherit;">ููุงุชุตุงู ุจุงูุฅูุชุฑูุช ุ ูุงู ูููู ุฃู ูููู ูุฏูู ุฌูุงุฒ ููุจููุชุฑ ูููุฏู ูุฑูู ูุงุชู BBS ุฌูุฏ. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู ูุดุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุฑูุงู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ูู ูุฌูุงุช ุงูููุจููุชุฑ</font></a><font style="vertical-align: inherit;"> ูุนูู BBS ุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ุฃุฏุงุฉ ูุงูุฉ ูุชุณููู ุชูุฒูุน ูููุงุช </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฑุดููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุณูุญ ูู ุจุญูุธ ููู ูุงุญุฏ ุฃู ุฃูุซุฑ ูู </font><i><font style="vertical-align: inherit;">ููู ุฃุฑุดูู</font></i><font style="vertical-align: inherit;"> ูุงุญุฏ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุฎุฒูู ุงููุนูููุงุช ุฃู ููููุง ุจุดูู ุฃูุซุฑ ููุงุกูุฉ. ูุจุดูู ูุซุงูู ุ ูููู ุงูุฃุฑุดูู ุฃูุถูุง ุจุถุบุท ุงููููุงุช ูุชูููุฑ ุงููุณุงุญุฉ ูุงูููุช ููุฅุฑุณุงู ุนุจุฑ ุงูุดุจูุฉ. ูู ุฃูุงู BBS ุ ูุงู ุฃุฑุดููู Arc ุดุงุฆุนูุง ุ ูุชุจู ุชูู ููุฏุฑุณูู ูู ุดุฑูุฉ System Enhancement Associates (SEA) ุ ููู ุดุฑูุฉ ุตุบูุฑุฉ ุฃุณุณูุง ูุน ุตูุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃูุงุฎุฑ ุงูุซูุงููููุงุช ุ ุฃุตุฏุฑ ุงููุจุฑูุฌ ููู ูุงุชุฒ ูุณุฎุชู ุงูุฎุงุตุฉ ูู Arc ุ PKArc. ูุงูุช ูุชูุงููุฉ ูุน SEA Arc ุ ููููุง ุนููุช ุจุดูู ุฃุณุฑุน ุจูุถู ุงูุฑูุชููุงุช ุงููุฑุนูุฉ ุงูููุชูุจุฉ ุจูุบุฉ ุงูุชุฌููุน ูุงุณุชุฎุฏูุช ุทุฑููุฉ ุถุบุท ุฌุฏูุฏุฉ. ุฃุตุจุญ ุงูุจุฑูุงูุฌ ุดุงุฆุนูุง ุ ูุงุณุชูุงู ูุงุชุฒ ูู ูุธููุชู ูุฎูู PKWare ููุชุฑููุฒ ุนูู ูุฒูุฏ ูู ุงูุชุทููุฑ. ูููุง ููุฃุณุทูุฑุฉ ุ ุชู ูุนุธู ุงูุนูู ูู ูุทุจุฎ ูุงูุฏุชู ูู ุฌูููุฏุงู ุ ููุณูููุณู.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1e/50a/990/b1e50a990a86a05045dde9d2a819fbf0.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุตููุฑ ููู ูุงุชุฒ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุงู ูุดุฑ ูู ููููููู ุณููุชููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ 19 ุณุจุชูุจุฑ 1994.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ููุน ุฐูู ุ ูู ูุญุจ SEA ูุจุงุฏุฑุฉ ูุงุชุฒ. ุงุชููุชู ุงูุดุฑูุฉ ุจุงูุชูุงู ุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ ูุญููู ุงูุชุฃููู ูุงููุดุฑ. ุฃุตุจุญ ุงูุชูุงุถู ูุงูุฌุฏู ุนูู ุดุจูุฉ BBS ูุนุงูู ุงูููุจููุชุฑ ุงูุดุฎุตู ูุนุฑูููุง ุจุงุณู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arc Wars</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูู ุงูููุงูุฉ ุ ุชู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณููุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุฒุงุน </font><font style="vertical-align: inherit;">ูุตุงูุญ SEA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชุฎูู ุนู Arc ุ ุฃูุดุฃ Katz ุชูุณูู ุฃุฑุดูุฉ ุฌุฏูุฏ ูู ุนุงู 1989 ุ ูุงูุฐู ุฃุทูู ุนููู Zip ูุฃุชุงุญู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฌูููุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<blockquote> ,   ,        ,      .  ,  ".ZIP",             ,      ,     ,          , , ,                  ,     ,      .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู ุจุฑูุงูุฌ ูุงุชุฒ ูุฅูุดุงุก ูุซู ูุฐู ุงููููุงุช ูุณูู PKZip ูุณุฑุนุงู ูุง ุงูุชุดุฑ ุฅูู ุนุงูู BBS ูุงูููุจููุชุฑ ุงูุดุฎุตู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุญุฏ ุงูุฌูุงูุจ ุงูุชู ุณุงููุช ุนูู ุงูุฃุฑุฌุญ ูู ูุฌุงุญ ุชูุณูู Zip ูู ุฃู ุงููุซุงุฆู ุฌุงุกุช ูุน PKZip ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ ุงูุชุทุจูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุชู ุชุดุฑุญ ุจุงูุชูุตูู ููููุฉ ุนูู ุงูุชูุณูู. ุณูุญ ูุฐุง ููุขุฎุฑูู ุจุชุนูู ุงูุชูุณูู ูุฅูุดุงุก ุงูุจุฑุงูุฌ ุงูุชู ุชูุดุฆ ูููุงุช Zip ุฃู ุชุณุชุฎุฑุฌูุง ุฃู ุชุชูุงุนู ูุนูุง ุจุฃู ุทุฑููุฉ ุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zip - ุชูุณูู ุถุบุท </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏูู ููุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ุจุนุฏ ุชูุฑูุบ ุงูุจูุงูุงุช ุณุชููู ููุง ูุงูุช ูุจู ุงูุถุบุท. ุชุณุนู ุงูุฎูุงุฑุฒููุฉ ุฅูู ุงูุชูุฑุงุฑ ูู ุจูุงูุงุช ุงููุตุฏุฑ ูุชูุฏู ูุนูููุงุช ุฃูุซุฑ ููุงุกุฉ. ูุฐุง ุงูููุฌ ูุฎุชูู ุนู </font><i><font style="vertical-align: inherit;">ุงูุถุบุท ูุน</font></i><font style="vertical-align: inherit;"> ุงูููุฏ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงูุชู ูุชู ุงุณุชุฎุฏุงููุง ูู ุชูุณููุงุช ูุซู JPEG ู MP3: ุนูุฏ ุถุบุทูุง ุ ูุชู ุงูุชุฎูุต ูู ุจุนุถ ุงููุนูููุงุช ุงูุฃูู ูุถูุญูุง ููุนูู ุฃู ุงูุฃุฐู ุงูุจุดุฑูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุชูุฒูุน PKZip ูู Shareware: ูููู ุงุณุชุฎุฏุงูู ููุณุฎู ุจุญุฑูุฉ ุ ููู ุงููุคูู ุงูุชุฑุญ ุนูู ุงููุณุชุฎุฏููู "ุชุณุฌูู" ุงูุจุฑูุงูุฌ. </font><font style="vertical-align: inherit;">ููุงุจู 47 ุฏููุงุฑูุง ุ ููููู ุงูุญุตูู ุนูู ุชุนูููุงุช ูุทุจูุนุฉ ูุฏุนู ูุชููุฒ ูุฅุตุฏุงุฑ ูุญุณูู ูู ุงูุชุทุจูู.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/031/509/4fc/0315094fc6917b61db8f78b2f776ce13.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู ุฃุญุฏ ุงูุฅุตุฏุงุฑุงุช ุงูุฑุฆูุณูุฉ ูู PKZip 2.04c ุ ุงูุฐู ุตุฏุฑ ูู 28 ุฏูุณูุจุฑ 1992 (ุชู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑ 2.04g</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ูุชุฑุฉ ูุฌูุฒุฉ </font><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุฎูุงุฑุฒููุฉ ุถุบุท ุงูุงูููุงุด ุงูุงูุชุฑุงุถูุฉ. </font><font style="vertical-align: inherit;">ุญุฏุฏุช ุงููุณุฎุฉ ุงูุชุทููุฑ ุงูุฅุถุงูู ููุถุบุท ูู ูููุงุช Zip ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงูุฉ ูุฎุตุตุฉ ููุฅุตุฏุงุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/58e/bd3/69b/58ebd369bf36c272d0c8c7c9515fc670.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฐ ุฐูู ุงูุญูู ุ ุชู ุงุณุชุฎุฏุงู ุชูุณูู zip ูู ุงูุนุฏูุฏ ูู ุชูุณููุงุช ุงููููุงุช ุงูุฃุฎุฑู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุชุณุชุฎุฏู ุฃุฑุดููุงุช Java (.jar) ูุญุฒู ุชุทุจููุงุช Android (.apk) ููููุงุช Microsoft Office .docx ุชูุณูู Zip. </font><font style="vertical-align: inherit;">ุชุณุชุฎุฏู ุงูุนุฏูุฏ ูู ุงูุชูุณููุงุช ูุงูุจุฑูุชููููุงุช ููุณ ุฎูุงุฑุฒููุฉ ุงูุถุบุท ุ Deflate. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุนูู ุงูุฃุฑุฌุญ ุฃู ุตูุญุงุช ุงูููุจ ูุชู ููููุง ุฅูู ูุชุตูุญู ูููู gzip ุ ูุงูุฐู ูุณุชุฎุฏู ุชูุณููู ุถุบุท ุงูุงูููุงุด. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ููู ูุงุชุฒ ูู ุนุงู 2000. </font><font style="vertical-align: inherit;">ูุง ูุฒุงู PKWare ููุฌูุฏูุง ููุฏุนู ุชูุณูู Zip ุ ุนูู ุงูุฑุบู ูู ุฃู ุงูุดุฑูุฉ ุชุฑูุฒ ุจุดูู ุฃุณุงุณู ุนูู ุจุฑุงูุฌ ุญูุงูุฉ ุงูุจูุงูุงุช.</font></font><br>
<br>
<a name="3"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Info-zip ู zlib</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ููุช ูุตูุฑ ูู ุฅุตุฏุงุฑ PKZip ูู ุนุงู 1989 ุ ุจุฏุฃุช ุชุธูุฑ ุจุฑุงูุฌ ุฃุฎุฑู ูุชูุฑูุบ ูููุงุช Zip. ุนูู ุณุจูู ุงููุซุงู ุ ุจุฑูุงูุฌ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unzip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููููู ูู ุงูุญุฒู ุนูู ุฃูุธูุฉ Unix. ูู ูุงุฑุณ 1990 ุ ุชู ุฅูุดุงุก ูุงุฆูุฉ ุจุฑูุฏูุฉ ุชุณูู Info-ZIP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูููุงุช-ZIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฌููุนุฉ </font><font style="vertical-align: inherit;">ุฃุตุฏุฑุช ุจุฑุงูุฌ ููุชูุญุฉ ุงููุตุฏุฑ ูุฌุงููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑูุฒ ุงูุจุฑูุฏู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุชู ูุงูุช ุชุณุชุฎุฏู ูุชูุฑูุบ ูุฅูุดุงุก ุงููููุงุช ุงููุถุบูุทุฉ. ุชู ููู ุงูุฑูุฒ ุฅูู ุงูุนุฏูุฏ ูู ุงูุฃูุธูุฉ ุ ููุง ูุฒุงู ุงููุนูุงุฑ ูุจุฑุงูุฌ Zip ูุฃูุธูุฉ Unix. ููุฏ ุณุงุนุฏ ุฐูู ูุงุญููุง ุนูู ุฒูุงุฏุฉ ุดุนุจูุฉ ุงููููุงุช ุงููุถุบูุทุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจูุฌุฑุฏ ููู ุฑูุฒ Info-ZIP ุงูุฐู ูุงู ุจูู ุถุบุท ุงูุถุบุท ูุฅูุบุงุก ุถุบุทู ุฅูู ููุชุจุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุตูุฉ </font><font style="vertical-align: inherit;">ูุชุจููุง</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุงู ููุจ ุฌูููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุถุบุท) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฑู ุฃุฏูุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุชูุฑูุบ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/68b/216/d1d/68b216d1debaffdb2d890067e38bed47.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุงู ููุจ ุฌูููู (ูุณุงุฑ) ููุงุฑู ุฃุฏูุฑ (ูููู) ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุงุฆุฒุฉ USENIX STUG ูุนุงู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2009.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุฃุญุฏ ุฃุณุจุงุจ ุฅูุดุงุก ุงูููุชุจุฉ ูู ุฃููุง ููุฑุช ุงูุฑุงุญุฉ ูุงุณุชุฎุฏุงู ุถุบุท Deflate ูู ุงูุชุทุจููุงุช ูุงูุชูุณููุงุช ุงูุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gzip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฏูุฏ </font><font style="vertical-align: inherit;">ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PNG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุงู ุงููุตุฏ ูู ูุฐู ุงูุชูุณููุงุช ุงูุฌุฏูุฏุฉ ุงุณุชุจุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compress</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GIF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุชู ุงุณุชุฎุฏูุช ุฎูุงุฑุฒููุฉ LZW ุงููุญููุฉ ุจุจุฑุงุกุฉ ุงุฎุชุฑุงุน. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุฒุก ูู ุฅูุดุงุก ูุฐู ุงูุชูุณููุงุช ุ ูุชุจ ุจูุชุฑ ุฏููุชุด ููุงุตูุงุช ุงูุงูููุงุด ููุดุฑูุง ุชุญุช ุงุณู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet RFC 1951</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุงูู 1996. ููุฏ ุชุจูู ุฃู ูุฐุง ูุตู ุฃูุซุฑ ุณูููุฉ ููุงุฑูุฉ ุจููุงุญุธุฉ ุชุทุจูู PKZip ุงูุฃุตููุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููู ูุณุชุฎุฏู zlib ูู ูู ููุงู. </font><font style="vertical-align: inherit;">ุฑุจูุง ูู ุงูุขู ูุณุคูู ุนู ุถุบุท ูุฐู ุงูุตูุญุฉ ุนูู ุฎุงุฏู ุงูููุจ ูุชูุฑูุบูุง ูู ูุชุตูุญู. </font><font style="vertical-align: inherit;">ุงูููู ุ ูุชู ุถุบุท ูุนุธู ุงููููุงุช ุงููุถุบูุทุฉ ููู ุถุบุทูุง ุจุงุณุชุฎุฏุงู zlib.</font></font><br>
<br>
<a name="4"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winzip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุณุชุฎุฏู ุงูุนุฏูุฏ ูู ุฃููุฆู ุงูุฐูู ูู ูุฌุฏูุง PKZip WinZip. ุชุญูู ูุณุชุฎุฏูู ุงูููุจููุชุฑ ุงูุดุฎุตู ูู DOS ุฅูู Windows ุ ููู PKZip ุฅูู WinZip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุฃ ูู ุดูุก ุจูุดุฑูุน ูููุจุฑูุฌ Nico Mac ุ ุงูุฐู ูุงู ุจุฅูุดุงุก ุจุฑูุงูุฌ ูู OS / 2 ูู Mansfield Software Group ูู Storrs-Mansfield ุ ููููุชููุช. ุงุณุชุฎุฏู Nico ูุฏูุฑ ุงูุนุฑูุถ ุงูุชูุฏูููุฉ ุ ููู ูุงุฌูุฉ ูุณุชุฎุฏู ุฑุณูููุฉ ูู OS / 2 ุ ููุงู ููุฒุนุฌูุง ูู ุฃูู ุงุถุทุฑ ุฅูู ุงูุชุจุฏูู ูู ูุฏูุฑ ุงููููุงุช ุฅูู ุฃูุงูุฑ DOS ูู ูู ูุฑุฉ ูุฑูุฏ ูููุง ุฅูุดุงุก ูููุงุช Zip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุจ Mac ุจุฑูุงูุฌ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ ุงูุจุณูุท ุงูุฐู ุนูู ูุน ูููุงุช Zip ูุจุงุดุฑุฉ ูู Presentation Manager ุ ูุฃุทูู ุนููู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMZip ุ ูุฃุทููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุจุฑูุงูุฌ ุชุฌุฑูุจู ูู ุงูุชุณุนูููุงุช.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ููุฌุญ OS / 2 ุ ูุณูุทุฑ ุนุงูู ุงูููุจููุชุฑ ุนูู Microsoft Windows. </font><font style="vertical-align: inherit;">ูู ุนุงู 1991 ุ ูุฑุฑ Mac ุชุนูู ููููุฉ ูุชุงุจุฉ ุจุฑุงูุฌ Windows ุ ููุงู ุฃูู ูุดุฑูุน ูู ูู ููู ุชุทุจูู Zip ุฅูู ูุธุงู ุชุดุบูู ุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ูู ุฃุจุฑูู 1991 ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู ุฅุตุฏุงุฑ WinZip 1.00</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุชู ุชูุฒูุนู ูุจุฑูุงูุฌ ุชุฌุฑูุจู ูุน ูุชุฑุฉ ุชุฌุฑูุจูุฉ ููุฏุฉ 21 ููููุง ูุฑุณูู ุชุณุฌูู ูุฏุฑูุง 29 ุฏููุงุฑูุง. </font><font style="vertical-align: inherit;">ุจุฏุช ูุซู ูุฐุง:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b1/2f4/bcd/0b12f4bcd048691aa0487b9d3a445b39.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุฅุตุฏุงุฑุงุช ุงูุฃููู ูู WinZip ุ ุชู ุงุณุชุฎุฏุงู PKZip ุชุญุช ุบุทุงุก ุงููุญุฑู. </font><font style="vertical-align: inherit;">ูููู ูู ุงูุฅุตุฏุงุฑ 5.0 ูู ุนุงู 1993 ุ ุจุฏุฃ ุงุณุชุฎุฏุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู Info-ZIP ูููุนุงูุฌุฉ ุงููุจุงุดุฑุฉ ููููุงุช Zip. </font><font style="vertical-align: inherit;">ููุง ุชุทูุฑุช ูุงุฌูุฉ ุงููุณุชุฎุฏู ุชุฏุฑูุฌููุง.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf4/273/962/bf427396212f63fba9c80db12fdd2132.png"></div><br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinZip 6.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุถูู Windows 3.11 ููุฌููุนุงุช ุงูุนูู. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู WinZip ูุงุญุฏูุง ูู ุจุฑุงูุฌ ุงูุชุดููุฑ ุงูุฃูุซุฑ ุดุนุจูุฉ ูู ุงูุชุณุนููุงุช. </font><font style="vertical-align: inherit;">ูููู ูู ุงูููุงูุฉ ุ ููุฏ ุฃูููุชู ุจุณุจุจ ุชุถููู ุฏุนู ููููุงุช Zip ูู ุฃูุธูุฉ ุงูุชุดุบูู. </font><font style="vertical-align: inherit;">ูุนูู Windows ูุนูู ูู "ูุฌูุฏุงุช ูุถุบูุทุฉ" ููุฐ ุนุงู 2001 (Windows XP) ุ ูุชุณุชุฎุฏู ููุชุจุฉ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DynaZip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฐุง ุงูุบุฑุถ</font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงู Mac ูุณูู ูู ุงูุฃุตู Nico Mak Computing. </font><font style="vertical-align: inherit;">ูู ุนุงู 2000 ุ ุฃุนูุฏุช ุชุณููุชู WinZip Computing ุ ููู ุชูู ุงูุณููุงุช ุชุฑูู ูุงู. </font><font style="vertical-align: inherit;">ูู ุนุงู 2005 ุ ูุงูุช</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vector Capital ุจุจูุน</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุดุฑูุฉ</font><font style="vertical-align: inherit;">ุ ููู ุงูููุงูุฉ ุ ุฃุตุจุญุช ูููููุฉ ูุดุฑูุฉ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Corel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุชู ูุง ุชุฒุงู ุชุทูู WinZip ูููุชุฌ.</font></font><br>
<br>
<a name="5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถุบุท Lempel-Ziv (LZ77)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชููู ุถุบุท Zip ูู ูููููู ุฑุฆูุณููู: ุถุบุท Lempel-Ziv ูุฑูุฒ Huffman. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุชูุซู ุฅุญุฏู ุทุฑู ุถุบุท ุงููุต ูู ุฅูุดุงุก ูุงุฆูุฉ ุจุงููููุงุช ุฃู ุงูุนุจุงุฑุงุช ุงูุดุงุฆุนุฉ ูุน ุงุณุชุจุฏุงู ุฃุตูุงู ูุฐู ุงููููุงุช ุฏุงุฎู ุงููุต ุจุฑูุงุจุท ุฅูู ุงููุงููุณ. ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุชูุซูู ุงููููุฉ ุงูุทูููุฉ "ุถุบุท" ูู ุงููุต ุงููุตุฏุฑ ุจุงูุฑูู # 1234 ุ ุญูุซ ูุดูุฑ 1234 ุฅูู ููุถุน ุงููููุฉ ูู ุงููุงุฆูุฉ. ููุฐุง ูุง ูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถุบุท ุงููุงููุณ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูู ูุฌูุฉ ูุธุฑ ุงูุถุบุท ุงูุดุงูู ุ ูุฅู ูุฐู ุงูุทุฑููุฉ ููุง ุนุฏุฉ ุนููุจ. ุฃููุงู ุ ูุง ุงูุฐู ูุฌุจ ุฃู ูุฏุฎู ุงููุงููุณ ุจุงูุถุจุทุ ูููู ุฃู ุชููู ุงูุจูุงูุงุช ุงููุตุฏุฑ ุจูุบุงุช ูุฎุชููุฉ ุ ุญุชู ุฃููุง ูุง ูููู ุฃู ุชููู ูุตูุง ูููู ูุฑุงุกุชู ุจูุงุณุทุฉ ุงูุฅูุณุงู. ูุฅุฐุง ูู ูุชู ุงูุงุชูุงู ุนูู ุงููุงููุณ ูุณุจููุง ุจูู ุงูุถุบุท ููู ุงูุถุบุท ุ ููุฌุจ ุชุฎุฒููู ููููู ูุน ุงูุจูุงูุงุช ุงููุถุบูุทุฉ ุ ููุง ูููู ูู ูุงุฆุฏุฉ ุงูุถุบุท. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุญู ุงูุฃููู ููุฐู ุงููุดููุฉ ูู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุตุฏุฑ ููุณูุง ููุนุฌู. ูู ุนุงู </font><font style="vertical-align: inherit;">1977 ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฑุญ ุฎูุงุฑุฒููุฉ ุนุงูููุฉ ูุถุบุท ุงูุจูุงูุงุช ุงููุชุณูุณูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุนููุจ ุฒูู ูุฃุจุฑุงูุงู ูููุจู (ุงูุฐูู ุนูููุง ูู ุงูุชุฎูููู) ูุฎุทุท ุถุบุท ูุชู ููู ุชูุฏูู ุจูุงูุงุช ุงููุตุฏุฑ ุนูู ุฃููุง ุชุณูุณู ุซูุงุซู:</font></font><br>
<br>
<pre><code class="cpp hljs">(, , )
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญูุซ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃููุง </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุดูู ุญููุฉ ุงููุฑุงุก ูุชุณูุณู ุงูุฃุญุฑู ุงูุชู ุชุฑูุฏ ูุณุฎูุง ูู ุงููููู ุงูุณุงุจู ูู ุงููุต ุงูุฃุตููุ ู </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูู ุงูุญุฑู ุงูุชุงูู ูู ุงูุจูุงูุงุช ุงูุชู ุชู ุฅูุดุงุคูุง.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e5/21e/fdb/5e521efdb5649015f685e26ab308d1b9.jpg"></div><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ce/cfa/2e3/2cecfa2e39798ce3302ff4b48e1a62ef.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุจุฑุงููู ููุจู ููุนููุจ ุฒูู. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุณุทูุฑ ุงูุชุงููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
it was the worst of times,<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุณุทุฑ ุงูุซุงูู ุ ูููู ุชูุซูู ุงูุชุณูุณู "t was the w" ุนูู ุฃูู (26 ุ 10 ุ w) ุ ุญูุซ ูุชู ุฅุนุงุฏุฉ ุฅูุดุงุฆู ุนู ุทุฑูู ูุณุฎ 10 ุฃุญุฑู ูู ููุถุน 26 ุญุฑููุง ุฅูู ุงูุญุฑู "w". ุจุงููุณุจุฉ ุฅูู ุงูุฃุญุฑู ุงูุชู ูู ุชุธูุฑ ุจุนุฏ ุ ูุชู ุงุณุชุฎุฏุงู ุฑูุงุจุท ุฎูููุฉ ุฐุงุช ุทูู ุตูุฑู. ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุชูุซูู ุงูุญุฑู "I" ุงูุฃููู ุจุงูุดูู (0 ุ 0 ุ I). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณูู ูุฐุง ุงููุฎุทุท ุถุบุท Lempel-Ziv ุ ุฃู ุถุบุท LZ77. ููุน ุฐูู ุ ูู ุงูุชุทุจููุงุช ุงูุนูููุฉ ููุฎูุงุฑุฒููุฉ ุ ุนุงุฏุฉ ูุง ูุชู ุงุณุชุฎุฏุงู ุฌุฒุก ูู ุซูุงุซูุฉ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุจุฏูุงู ูู ุฐูู ุ ูุชู ุฅูุดุงุก ุงูุฃุญุฑู ุจุดูู ูุฑุฏู ุ ููุชู ุงุณุชุฎุฏุงู ุฃุฒูุงุฌ ( </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">ููุฑูุงุจุท ุงูุฎูููุฉ </font><font style="vertical-align: inherit;">(ูุณูู ูุฐุง ุงูุฎูุงุฑ ุถุบุท </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LZSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). ุชูุนุฏ ููููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุดููุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุญุฑู ูุงูุฑูุงุจุท ุงูุฎูููุฉ ูุดููุฉ ูููุตูุฉ ุ ูุณููุธุฑ ูููุง ุฃุฏูุงู ุนูุฏูุง ูุญูู ุงูุฎูุงุฑุฒููุฉ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุด</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุงููุต:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
it was the worst of times,<font></font>
it was the age of wisdom,<font></font>
it was the age of foolishness,<font></font>
it was the epoch of belief,<font></font>
it was the epoch of incredulity,<font></font>
it was the season of Light,<font></font>
it was the season of Darkness,<font></font>
it was the spring of hope,<font></font>
it was the winter of despair,<font></font>
we had everything before us,<font></font>
we had nothing before us,<font></font>
we were all going direct to Heaven,<font></font>
we were all going direct the other way<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุถุบุท ูู ูุฐุง:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
i(<span class="hljs-number">26</span>,<span class="hljs-number">10</span>)wor(<span class="hljs-number">27</span>,<span class="hljs-number">24</span>)age(<span class="hljs-number">25</span>,<span class="hljs-number">4</span>)wisdom(<span class="hljs-number">26</span>,<span class="hljs-number">20</span>)<font></font>
foolishnes(<span class="hljs-number">57</span>,<span class="hljs-number">14</span>)epoch(<span class="hljs-number">33</span>,<span class="hljs-number">4</span>)belief(<span class="hljs-number">28</span>,<span class="hljs-number">22</span>)incredulity<font></font>
(<span class="hljs-number">33</span>,<span class="hljs-number">13</span>)season(<span class="hljs-number">34</span>,<span class="hljs-number">4</span>)Light(<span class="hljs-number">28</span>,<span class="hljs-number">23</span>)Dark(<span class="hljs-number">120</span>,<span class="hljs-number">17</span>)<font></font>
spring(<span class="hljs-number">31</span>,<span class="hljs-number">4</span>)hope(<span class="hljs-number">231</span>,<span class="hljs-number">14</span>)inter(<span class="hljs-number">27</span>,<span class="hljs-number">4</span>)despair,
<span class="hljs-function">we had <span class="hljs-title">everyth</span><span class="hljs-params">(<span class="hljs-number">57</span>,<span class="hljs-number">4</span>)</span>before <span class="hljs-title">us</span><span class="hljs-params">(<span class="hljs-number">29</span>,<span class="hljs-number">9</span>)</span><span class="hljs-title">no</span><span class="hljs-params">(<span class="hljs-number">26</span>,<span class="hljs-number">20</span>)</span>
<span class="hljs-title">we</span><span class="hljs-params">(<span class="hljs-number">12</span>,<span class="hljs-number">3</span>)</span>all <span class="hljs-title">go</span><span class="hljs-params">(<span class="hljs-number">29</span>,<span class="hljs-number">4</span>)</span>direct to <span class="hljs-title">Heaven</span>
<span class="hljs-params">(<span class="hljs-number">36</span>,<span class="hljs-number">28</span>)</span><span class="hljs-params">(<span class="hljs-number">139</span>,<span class="hljs-number">3</span>)</span><span class="hljs-params">(<span class="hljs-number">83</span>,<span class="hljs-number">3</span>)</span><span class="hljs-params">(<span class="hljs-number">138</span>,<span class="hljs-number">3</span>)</span>way
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุญุฏู ุงูุฎุตุงุฆุต ุงููููุฉ ููุฑูุงุจุท ุงูุฎูููุฉ ูู ุฃููุง ูููู ุฃู ุชุชุฏุงุฎู. </font><font style="vertical-align: inherit;">ูุญุฏุซ ูุฐุง ุนูุฏูุง ูููู ุงูุทูู ุฃูุจุฑ ูู ุงููุณุงูุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู:</font></font><br>
<br>
<pre><code class="cpp hljs">Fa-la-la-la-la
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุถุบุท ูู ุฃุฌู:</font></font><br>
<br>
<pre><code class="cpp hljs">Fa-la(<span class="hljs-number">3</span>,<span class="hljs-number">9</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏ ูุจุฏู ุงูุฃูุฑ ุบุฑูุจูุง ุจุงููุณุจุฉ ูู ุ ูููู ุงูุทุฑููุฉ ุชุนูู: ุจุนุฏ ูุณุฎ ูุญุฏุงุช ุงูุจุงูุช ุงูุซูุงุซุฉ ุงูุฃููู "-la" ุ ูุณุชูุฑ ุงููุณุฎ ุจุงุณุชุฎุฏุงู ูุญุฏุงุช ุงูุจุงูุช ุงูุชู ุชู ุฅูุดุงุคูุง ุญุฏูุซูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุงูุน ุ ูุฐุง ูู ููุน ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑููุฒ ุฃุทูุงู ุงูุณูุณูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุญูุซ ูุชู ูุณุฎ ุฌุฒุก ูู ุงูุจูุงูุงุช ุจุดูู ูุชูุฑุฑ ููุญุตูู ุนูู ุงูุทูู ุงููุทููุจ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธูุฑ ูุซุงู ุชูุงุนูู ูุงุณุชุฎุฏุงู ุถุบุท Lempel-Ziv ูููููุงุช ูู ููุงูุฉ ูุชุจูุง Colin Morris </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฃุตุจุญุช ูููุงุช ุงูุจูุจ โโุฃูุซุฑ ุชูุฑุงุฑูุงุ </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ููู ูุซุงู ููุณุฎ ุงูุฑูุงุจุท ุงูุฎูููุฉ ูู C. ูุฑุฌู ููุงุญุธุฉ ุฃูู ุจุณุจุจ ุงูุชุฏุงุฎู ุงููุญุชูู ุ ูุง ูููููุง ุงุณุชุฎุฏุงู </font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃู </font></font><code>memmove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output the (dist,len) backref at dst_pos in dst. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lz77_output_backref</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos,
                                       <span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        assert(dist &lt;= dst_pos &amp;&amp; <span class="hljs-string">"cannot reference before beginning of dst"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++) {<font></font>
                dst[dst_pos] = dst[dst_pos - dist];<font></font>
                dst_pos++;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุณูู ุฅูุดุงุก ุญุฑูู ุ ูููู ูู ุฃุฌู ุงูุงูุชูุงู ุ ุณูุณุชุฎุฏู ูุธููุฉ ูุณุงุนุฏุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output lit at dst_pos in dst. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lz77_output_lit</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos, <span class="hljs-keyword">uint8_t</span> lit)</span>
</span>{<font></font>
        dst[dst_pos] = lit;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุญุธ ุฃู ุงููุชุตู ุจูุฐู ุงููุธููุฉ ูุฌุจ ุฃู ูุชุฃูุฏ ูู ูุฌูุฏ </font></font><code>dst</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุงุญุฉ ูุงููุฉ ููุจูุงูุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ูุฃู ุงูุงุฑุชุจุงุท ุงูุฎููู ูุง ูุตู ุฅูู ุงูููุถุน ูุจู ุจุฏุก ุงููุฎุฒู ุงููุคูุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุตุนุจ ุนุฏู ุฅูุดุงุก ุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุฑูุงุจุท ุฎูููุฉ ุฃุซูุงุก ุงูุชูุฑูุบ ุ ูููู ุฅูุดุงุคูุง ุฃููุงู ุนูุฏ ุถุบุท ุจูุงูุงุช ุงููุตุฏุฑ. ูููู ุงูููุงู ุจุฐูู ุจุทุฑู ูุฎุชููุฉ ุ ููููุง ุณูุณุชุฎุฏู ุงูุทุฑููุฉ ุงููุงุฆูุฉ ุนูู ุฌุฏุงูู ุงูุชุฌุฒุฆุฉ ูู zlib ุ ุงูููุชุฑุญุฉ ูู RFC 1951. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุณุชุฎุฏู ุฌุฏูู ุงูุชุฌุฒุฆุฉ ูุน ููุงุถุน ุงูุจุงุฏุฆุงุช ุงูููููุฉ ูู ุซูุงุซุฉ ุฃุญุฑู ูุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุณุงุจููุง ูู ุงูุณุทุฑ (ุงูุฑูุงุจุท ุงูุฎูููุฉ ุงูุฃูุตุฑ ูุง ุชุฌูุจ ุฃู ูุงุฆุฏุฉ). ูุณูุญ ุงูุชูุฑูุบ ููุฑุงุจุทุงุช ุงูุฎูููุฉ ุถูู ุงูุฃุญุฑู ุงูู 32ุ768 ุงูุณุงุจูุฉ - ููุฐุง ูุง ูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงูุฐุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุฐุง ูููุฑ ุถุบุท ุงูุฏูู: ุชุชู ูุนุงูุฌุฉ ุจูุงูุงุช ุงูุฅุฏุฎุงู ููููุงู ูู ูู ูุฑุฉ ุ ุจุดุฑุท ุฃู ูุชู ุชุฎุฒูู ุงููุงูุฐุฉ ุงูุชู ุชุญุชูู ุนูู ูุญุฏุงุช ุงูุจุงูุช ุงูุฃุฎูุฑุฉ ูู ุงูุฐุงูุฑุฉ. ููุน ุฐูู ุ ููุชุฑุถ ุชูููุฐูุง ุฃู ุฌููุน ุจูุงูุงุช ุงูุฅุฏุฎุงู ูุชุงุญุฉ ููุง ูุฃูู ูููููุง ูุนุงูุฌุชูุง ุจุงููุงูู ูู ูู ูุฑุฉ. ูุชูุญ ูู ูุฐุง ุงูุชุฑููุฒ ุนูู ุงูุถุบุท ุจุฏูุงู ูู ุงููุญุงุณุจุฉ ุ ููู ุฃูุฑ ุถุฑูุฑู ููุนุงูุฌุฉ ุงูุฏูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุณุชุฎุฏู ุตููููู: ูู </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุนูู ูููุฉ ุงูุชุฌุฒุฆุฉ ููุจุงุฏุฆุฉ ุงูููููุฉ ูู ุซูุงุซุฉ ุฃุญุฑู ููููุถุน ูู ุงูุฅุฏุฎุงู ุ ููู </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุนูู ููุถุน ุงูููุถุน ุงูุณุงุจู ุจูููุฉ ุงูุชุฌุฒุฆุฉ ูุฐู. ูู ุงููุงูุน ุ </font></font><code>head[h]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูู ุนููุงู ูุงุฆูุฉ ูุฑุชุจุทุฉ ุจููุงุถุน ุงูุจุงุฏุฆุฉ ุจุชุฌุฒุฆุฉ </font></font><code>h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>prev[x]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชููู ุงูุนูุตุฑ ุงูุฐู ูุณุจู </font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุฆูุฉ.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LZ_WND_SIZE 32768</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LZ_MAX_LEN  258</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HASH_SIZE 15</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NO_POS    SIZE_MAX</span><font></font>
<font></font>
<span class="hljs-comment">/* Perform LZ77 compression on the len bytes in src. Returns false as soon as
   either of the callback functions returns false, otherwise returns true when
   all bytes have been processed. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">lz77_compress</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> len,
                   <span class="hljs-keyword">bool</span> (*lit_callback)(<span class="hljs-keyword">uint8_t</span> lit, <span class="hljs-keyword">void</span> *aux),
                   <span class="hljs-keyword">bool</span> (*backref_callback)(<span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">void</span> *aux),
                   <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">size_t</span> head[<span class="hljs-number">1U</span> &lt;&lt; HASH_SIZE];
        <span class="hljs-keyword">size_t</span> prev[LZ_WND_SIZE];<font></font>
<font></font>
        <span class="hljs-keyword">uint16_t</span> h;
        <span class="hljs-keyword">size_t</span> i, j, dist;
        <span class="hljs-keyword">size_t</span> match_len, match_pos;
        <span class="hljs-keyword">size_t</span> prev_match_len, prev_match_pos;<font></font>
<font></font>
        <span class="hljs-comment">/* Initialize the hash table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(head) / <span class="hljs-keyword">sizeof</span>(head[<span class="hljs-number">0</span>]); i++) {<font></font>
                head[i] = NO_POS;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุฏุฑุงุฌ ููุถุน ุณูุณูุฉ ุฌุฏูุฏุฉ ูู ุฌุฏูู ุงูุชุฌุฒุฆุฉ </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุชู ุชุญุฏูุซู ููุฅุดุงุฑุฉ ุฅูู ุงููุฑูุฒ ุงูุณุงุจู </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุซู ูุชู ุชุญุฏูุซู ุจููุณู </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert_hash</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> hash, <span class="hljs-keyword">size_t</span> pos, <span class="hljs-keyword">size_t</span> *head, <span class="hljs-keyword">size_t</span> *prev)</span>
</span>{<font></font>
        prev[pos % LZ_WND_SIZE] = head[hash];<font></font>
        head[hash] = pos;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชุจู ููุนูููุฉ ุงููุนูุงุฑูุฉ ุนูุฏ ุงูููุฑุณุฉ </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ูุญู ููุชููู ููุท ุจุงูููุงูู ุงูุชู ุชูุน ูู ุงููุงูุฐุฉ ุงูุญุงููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏูุงู ูู ุญุณุงุจ ูููุฉ ุงูุชุฌุฒุฆุฉ ููู ุจุงุฏุฆุฉ ููููุฉ ูู ุซูุงุซุฉ ุฃุญุฑู ูู ุงูุจุฏุงูุฉ ุ ุณูุณุชุฎุฏู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุฌุฒุฆุฉ ุงูุฏุงุฆุฑู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุณูููู ุจุชุญุฏูุซูุง ุจุงุณุชูุฑุงุฑ ุจุญูุซ ูุง ุชูุนูุณ ุฅูุง ููููุง ุงูุซูุงุซุฉ ุงูุฃุฎูุฑุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint16_t</span> <span class="hljs-title">update_hash</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> hash, <span class="hljs-keyword">uint8_t</span> c)</span>
</span>{<font></font>
        hash &lt;&lt;= <span class="hljs-number">5</span>;                     <span class="hljs-comment">/* Shift out old bits. */</span>
        hash ^= c;                      <span class="hljs-comment">/* Include new bits. */</span>
        hash &amp;= (<span class="hljs-number">1U</span> &lt;&lt; HASH_SIZE) - <span class="hljs-number">1</span>;  <span class="hljs-comment">/* Mask off excess bits. */</span><font></font>
<font></font>
        <span class="hljs-keyword">return</span> hash;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุนุฏ ุฐูู ุงุณุชุฎุฏุงู ุฎุฑูุทุฉ ุงูุชุฌุฒุฆุฉ ููุจุญุซ ุจููุงุกุฉ ุนู ุงูุชุทุงุจูุงุช ุงูุณุงุจูุฉ ุจุชุณูุณู ุ ููุง ูู ููุถุญ ุฃุฏูุงู. </font><font style="vertical-align: inherit;">ุงูุจุญุซ ุนู ุงูุชุทุงุจูุงุช ูู ุนูููุฉ ุงูุถุบุท ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ููููุงุฑุฏ ุ ูุฐูู ุณูุญุฏ ูู ุนูู ุงูุจุญุซ ูู ุงููุงุฆูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนุฏ ุชุบููุฑ ุงููุนููุงุช ุงููุฎุชููุฉ ุ ูุซู ุนูู ุงูุจุญุซ ูู ูุงุฆูุฉ ุงูุจุงุฏุฆุงุช ูุฅุฌุฑุงุก ููุงุฑูุงุช ูุณููุฉ ุ ููุง ูู ููุถุญ ุฃุฏูุงู ุ ุทุฑููุฉ ูุฒูุงุฏุฉ ุงูุณุฑุนุฉ ุนู ุทุฑูู ุชูููู ุฏุฑุฌุฉ ุงูุถุบุท. </font><font style="vertical-align: inherit;">ูุชู ุชุญุฏูุฏ ุงูุฅุนุฏุงุฏุงุช ุงูููุฌูุฏุฉ ูู ุงูููุฏ ุงูุฎุงุต ุจูุง ูุชุชูุงูู ูุน ุงูุญุฏ ุงูุฃูุตู ููุณุชูู ุงูุถุบุท ูู zlib.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Find the longest most recent string which matches the string starting
 * at src[pos]. The match must be strictly longer than prev_match_len and
 * shorter or equal to max_match_len. Returns the length of the match if found
 * and stores the match position in *match_pos, otherwise returns zero. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">find_match</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> pos, <span class="hljs-keyword">uint16_t</span> hash,
                         <span class="hljs-keyword">size_t</span> prev_match_len, <span class="hljs-keyword">size_t</span> max_match_len,
                         <span class="hljs-keyword">const</span> <span class="hljs-keyword">size_t</span> *head, <span class="hljs-keyword">const</span> <span class="hljs-keyword">size_t</span> *prev,
                         <span class="hljs-keyword">size_t</span> *match_pos)</span>
</span>{
        <span class="hljs-keyword">size_t</span> max_match_steps = <span class="hljs-number">4096</span>;
        <span class="hljs-keyword">size_t</span> i, l;
        <span class="hljs-keyword">bool</span> found;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">/* We want backrefs of length 3 or longer. */</span>
                prev_match_len = <span class="hljs-number">2</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len &gt;= max_match_len) {
                <span class="hljs-comment">/* A longer match would be too long. */</span>
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len &gt;= <span class="hljs-number">32</span>) {
                <span class="hljs-comment">/* Do not try too hard if there is already a good match. */</span>
                max_match_steps /= <span class="hljs-number">4</span>;<font></font>
        }<font></font>
<font></font>
        found = <span class="hljs-literal">false</span>;<font></font>
        i = head[hash];<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (max_match_steps != <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (i == NO_POS) {
                        <span class="hljs-comment">/* No match. */</span>
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                assert(i &lt; pos &amp;&amp; <span class="hljs-string">"Matches should precede pos."</span>);
                <span class="hljs-keyword">if</span> (pos - i &gt; LZ_WND_SIZE) {
                        <span class="hljs-comment">/* The match is outside the window. */</span>
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                l = cmp(src, i, pos, prev_match_len, max_match_len);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l != <span class="hljs-number">0</span>) {<font></font>
                        assert(l &gt; prev_match_len);<font></font>
                        assert(l &lt;= max_match_len);<font></font>
<font></font>
                        found = <span class="hljs-literal">true</span>;<font></font>
                        *match_pos = i;<font></font>
                        prev_match_len = l;<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (l == max_match_len) {
                                <span class="hljs-comment">/* A longer match is not possible. */</span>
                                <span class="hljs-keyword">return</span> l;<font></font>
                        }<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Look further back in the prefix list. */</span><font></font>
                i = prev[i % LZ_WND_SIZE];<font></font>
                max_match_steps--;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!found) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> prev_match_len;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Compare the substrings starting at src[i] and src[j], and return the length
 * of the common prefix. The match must be strictly longer than prev_match_len
 * and shorter or equal to max_match_len. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> i, <span class="hljs-keyword">size_t</span> j,
                  <span class="hljs-keyword">size_t</span> prev_match_len, <span class="hljs-keyword">size_t</span> max_match_len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> l;<font></font>
<font></font>
        assert(prev_match_len &lt; max_match_len);<font></font>
<font></font>
        <span class="hljs-comment">/* Check whether the first prev_match_len + 1 characters match. Do this
         * backwards for a higher chance of finding a mismatch quickly. */</span>
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">0</span>; l &lt; prev_match_len + <span class="hljs-number">1</span>; l++) {
                <span class="hljs-keyword">if</span> (src[i + prev_match_len - l] !=<font></font>
                    src[j + prev_match_len - l]) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        assert(l == prev_match_len + <span class="hljs-number">1</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* Now check how long the full match is. */</span>
        <span class="hljs-keyword">for</span> (; l &lt; max_match_len; l++) {
                <span class="hljs-keyword">if</span> (src[i + l] != src[j + l]) {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        assert(l &gt; prev_match_len);<font></font>
        assert(l &lt;= max_match_len);<font></font>
        assert(<span class="hljs-built_in">memcmp</span>(&amp;src[i], &amp;src[j], l) == <span class="hljs-number">0</span>);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> l;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุฅููุงุก ุงููุธููุฉ </font></font><code>lz77_compress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุฐุง ุงูุฑูุฒ ููุจุญุซ ุนู ุงูุชุทุงุจูุงุช ุงูุณุงุจูุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* h is the hash of the three-byte prefix starting at position i. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (len &gt;= <span class="hljs-number">2</span>) {<font></font>
                h = update_hash(h, src[<span class="hljs-number">0</span>]);<font></font>
                h = update_hash(h, src[<span class="hljs-number">1</span>]);<font></font>
        }<font></font>
<font></font>
        prev_match_len = <span class="hljs-number">0</span>;<font></font>
        prev_match_pos = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i + <span class="hljs-number">2</span> &lt; len; i++) {<font></font>
                h = update_hash(h, src[i + <span class="hljs-number">2</span>]);<font></font>
<font></font>
                <span class="hljs-comment">/* Search for a match using the hash table. */</span><font></font>
                match_len = find_match(src, i, h, prev_match_len,<font></font>
                                       min(LZ_MAX_LEN, len - i), head, prev,<font></font>
                                       &amp;match_pos);<font></font>
<font></font>
                <span class="hljs-comment">/* Insert the current hash for future searches. */</span><font></font>
                insert_hash(h, i, head, prev);<font></font>
<font></font>
                <span class="hljs-comment">/* If the previous match is at least as good as the current. */</span>
                <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span> &amp;&amp; prev_match_len &gt;= match_len) {
                        <span class="hljs-comment">/* Output the previous match. */</span>
                        dist = (i - <span class="hljs-number">1</span>) - prev_match_pos;
                        <span class="hljs-keyword">if</span> (!backref_callback(dist, prev_match_len, aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-comment">/* Move past the match. */</span>
                        <span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; min((i - <span class="hljs-number">1</span>) + prev_match_len,<font></font>
                                                len - <span class="hljs-number">2</span>); j++) {<font></font>
                                h = update_hash(h, src[j + <span class="hljs-number">2</span>]);<font></font>
                                insert_hash(h, j, head, prev);<font></font>
                        }<font></font>
                        i = (i - <span class="hljs-number">1</span>) + prev_match_len - <span class="hljs-number">1</span>;<font></font>
                        prev_match_len = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* If no match (and no previous match), output literal. */</span>
                <span class="hljs-keyword">if</span> (match_len == <span class="hljs-number">0</span>) {<font></font>
                        assert(prev_match_len == <span class="hljs-number">0</span>);
                        <span class="hljs-keyword">if</span> (!lit_callback(src[i], aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Otherwise the current match is better than the previous. */</span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Output a literal instead of the previous match. */</span>
                        <span class="hljs-keyword">if</span> (!lit_callback(src[i - <span class="hljs-number">1</span>], aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Defer this match and see if the next is even better. */</span><font></font>
                prev_match_len = match_len;<font></font>
                prev_match_pos = match_pos;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Output any previous match. */</span>
        <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span>) {<font></font>
                dist = (i - <span class="hljs-number">1</span>) - prev_match_pos;
                <span class="hljs-keyword">if</span> (!backref_callback(dist, prev_match_len, aux)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                i = (i - <span class="hljs-number">1</span>) + prev_match_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Output any remaining literals. */</span>
        <span class="hljs-keyword">for</span> (; i &lt; len; i++) {
                <span class="hljs-keyword">if</span> (!lit_callback(src[i], aux)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุญุซ ูุฐุง ุงูุฑูุฒ ุนู ุฃุทูู ุฑุงุจุท ุฎููู ูููู ุฅูุดุงุคู ูู ุงูููุถุน ุงูุญุงูู. ูููู ูุจู ุฅุตุฏุงุฑู ุ ููุฑุฑ ุงูุจุฑูุงูุฌ ูุง ุฅุฐุง ูุงู ูู ุงููููู ุงูุนุซูุฑ ุนูู ุชุทุงุจู ุฃุทูู ูู ุงูููุถุน ุงูุชุงูู. ูู zlib ุ ูุณูู ูุฐุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููู ุงูููุงุฑูุฉ ุงูุจุทูุฆุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุง ุชุฒุงู ูุฐู </font><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุดุนุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ููู ุชุญุฏุฏ ุฃุทูู ุชุทุงุจู ุ ุญุชู ุฅุฐุง ูุงูุช ุงูุทุฑููุฉ ุงูุฃูุตุฑ ุงูุญุงููุฉ ุชุณูุญ ูู ุจุงูุญุตูู ุนูู ูุจุงุฑุงุฉ ุฃุทูู ููุชุฑุฉ ุฃุทูู ูุชุญููู ุถุบุท ุฃููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุฃู ูุนูู ุถุบุท Lempel-Ziv ุจุณุฑุนุฉ ูุจุทูุฆุฉ. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zopfli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุถู ุงููุซูุฑ ูู ุงูููุช ูู ุงูุจุญุซ ุนู ุฑูุงุจุท ุฎูููุฉ ูุซุงููุฉ ููุถุบุท ุนูู ูุณุจ ุงูุถุบุท ุงูุฅุถุงููุฉ. ูุฐุง ูููุฏ ููุจูุงูุงุช ุงูุชู ูุชู ุถุบุทูุง ูุฑุฉ ูุงุญุฏุฉ ุซู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุญุตูู ุนูู ูุนูููุงุช ุซุงุจุชุฉ ุนูู ุฎุงุฏู ุงูููุจ. ุนูู ุงูุฌุงูุจ ุงูุขุฎุฑ ูู ุงููููุงุณ ุชูุฌุฏ ุถูุงุบุท ูุซู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Snappy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LZ4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุชู ุชุชู ููุงุฑูุชูุง ููุท ูุน ุงูุจุงุฏุฆุฉ 4 ุจุงูุช ุงูุฃุฎูุฑุฉ ููู ุณุฑูุนุฉ ุฌุฏูุง. ููุนุฏ ูุฐุง ุงูููุน ูู ุงูุถุบุท ูููุฏูุง ูู ููุงุนุฏ ุงูุจูุงูุงุช ูุฃูุธูุฉ RPC ุงูุชู ูุชู ูููุง ุฏูุน ุงูููุช ุงููุณุชุบุฑู ูู ุงูุถุบุท ุนู ุทุฑูู ุชูููุฑ ุงูููุช ุนูุฏ ุฅุฑุณุงู ุงูุจูุงูุงุช ุนุจุฑ ุดุจูุฉ ุฃู ุฅูู ูุฑุต. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅู ููุฑุฉ ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงููุตุฏุฑ ููุงููุณ ุฃูููุฉ ููุบุงูุฉ ุ ูููู ููููู ุฃูุถูุง ุงูุงุณุชูุงุฏุฉ ูู ูุงููุณ ุซุงุจุช. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brotli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุฎูุงุฑุฒููุฉ ุชุนุชูุฏ ุนูู LZ77 ุ ูููููุง ุชุณุชุฎุฏู ุฃูุถูุง ุฎูุงุฑุฒููุฉ ูุจูุฑุฉ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงููุณ ุงูุซุงุจุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุณูุณูุฉ ุ ูุงูุชู ุชูุฌุฏ ุบุงูุจูุง ุนูู ุงูุดุจูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุงุทูุงุน ููุฏ LZ77 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู lz77.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lz77.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="6"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ููููุงู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎูุงุฑุฒููุฉ ุถุบุท Zip ุงูุซุงููุฉ ูู ุฑูุฒ Huffman. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅู ูุตุทูุญ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุฐุง ุงูุณูุงู ูู ูุฑุฌุน ููุธุงู ูุชูุฏูู ุงูุจูุงูุงุช ูู ุดูู ุขุฎุฑ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูุญู ููุชููู ุจุงูููุฏ ุงูุฐู ูููู ุงุณุชุฎุฏุงูู ูุชูุซูู ุงูุญุฑู ูุงูุฑูุงุจุท ุงูุฎูููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ุฎูุงุฑุฒููุฉ Lempel-Ziv ุจููุงุกุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชูููุฏูุง ุ ูุชู ุชูุฏูู ุงููุต ุงูุฅูุฌููุฒู ุจุงุณุชุฎุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏ ุงูููุงุณู ุงูุฃูุฑููู ูุชุจุงุฏู ุงููุนูููุงุช (ASCII)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุนูู ูุฐุง ุงููุธุงู ุฑูููุง ููู ุญุฑู ุ ูุงูุฐู ูุชู ุชุฎุฒููู ุนุงุฏุฉ ูู ุชูุซูู 8 ุจุช. </font><font style="vertical-align: inherit;">ูููุง ููู ุฑููุฒ ASCII ููุญุฑูู ุงููุจูุฑุฉ ูู ุงูุฃุจุฌุฏูุฉ ุงูุฅูุฌููุฒูุฉ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01000001</font></font></td>
<td><strong>N</strong></td>
<td>01001110</td>
</tr>
<tr>
<td><strong>B</strong></td>
<td>01000010</td>
<td><strong>O</strong></td>
<td>01001111</td>
</tr>
<tr>
<td><strong>C</strong></td>
<td>01000011</td>
<td><strong>P</strong></td>
<td>01010000</td>
</tr>
<tr>
<td><strong>D</strong></td>
<td>01000100</td>
<td><strong>Q</strong></td>
<td>01010001</td>
</tr>
<tr>
<td><strong>E</strong></td>
<td>01000101</td>
<td><strong>R</strong></td>
<td>01010010</td>
</tr>
<tr>
<td><strong>F</strong></td>
<td>01000110</td>
<td><strong>S</strong></td>
<td>01010011</td>
</tr>
<tr>
<td><strong>G</strong></td>
<td>01000111</td>
<td><strong>T</strong></td>
<td>01010100</td>
</tr>
<tr>
<td><strong>H</strong></td>
<td>01001000</td>
<td><strong>U</strong></td>
<td>01010101</td>
</tr>
<tr>
<td><strong>I</strong></td>
<td>01001001</td>
<td><strong>V</strong></td>
<td>01010110</td>
</tr>
<tr>
<td><strong>J</strong></td>
<td>01001010</td>
<td><strong>W</strong></td>
<td>01010111</td>
</tr>
<tr>
<td><strong>K</strong></td>
<td>01001011</td>
<td><strong>X</strong></td>
<td>01011000</td>
</tr>
<tr>
<td><strong>L</strong></td>
<td>01001100</td>
<td><strong>Y</strong></td>
<td>01011001</td>
</tr>
<tr>
<td><strong>M</strong></td>
<td>01001101</td>
<td><strong>Z</strong></td>
<td>01011010</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุช ูุงุญุฏ ููู ุญุฑู ูู ุทุฑููุฉ ููุงุณุจุฉ ูุชุฎุฒูู ุงููุต. ูุณูุญ ูู ุจุงููุตูู ุจุณูููุฉ ุฃู ุชุนุฏูู ุฃุฌุฒุงุก ูู ุงููุต ุ ููู ุงููุงุถุญ ุฏุงุฆููุง ุนุฏุฏ ุงูุจุงูุชุงุช ุงููุทููุจุฉ ูุชุฎุฒูู ุงูุฃุญุฑู N ุ ุฃู ุนุฏุฏ ุงูุฃุญุฑู ุงููุฎุฒูุฉ ูู N ุจุงูุช. ููุน ุฐูู ุ ูุฐู ููุณุช ุงูุทุฑููุฉ ุงูุฃูุซุฑ ูุนุงููุฉ ูู ุญูุซ ุงููุณุงุญุฉ ุงููุญุชูุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุ ูุชู ุงุณุชุฎุฏุงู ุงูุญุฑู E ูู ุฃุบูุจ ุงูุฃุญูุงู ุ ู Z ูู ุงูุฃูู ุงุณุชุฎุฏุงููุง. ูุฐูู ุ ูู ุญูุซ ุงูุญุฌู ุ ูู ุงูุฃูุซุฑ ูุงุนููุฉ ุงุณุชุฎุฏุงู ุชูุซูู ุจุช ุฃูุตุฑ ูู E ูุชูุซูู ุฃุทูู ูู Z ุ ุจุฏูุงู ูู ุชุนููู ููุณ ุนุฏุฏ ุงูุจุชุงุช ููู ุญุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููุฏ ุงูุฐู ูุญุฏุฏ ุงูุชุฑููุฒุงุช ุจุฃุทูุงู ูุฎุชููุฉ ูุฃุญุฑู ุงููุตุฏุฑ ุงููุฎุชููุฉ ูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ ูุชุบูุฑ ุงูุทูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุงููุซุงู ุงูุฃูุซุฑ ุดูุฑุฉ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฑุณ.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุญูุซ ูุชู ุชุฑููุฒ ูู ุญุฑู ุจููุงุท ูุดุฑุทุงุช ุ ูุชู ุฅุฑุณุงููุง ูู ุงูุฃุตู ุนู ุทุฑูู ุงูุชูุบุฑุงู ูุน ูุจุถุงุช ูุตูุฑุฉ ูุทูููุฉ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข โข โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข - โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข - - โข</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - โข - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข - โข</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข - โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข โข</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุช</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข โข โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุด</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุงูุณ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข โข โข -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข - - -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุจููู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข โข โข -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โข - โข โข</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- โข - - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - โข โข</font></font></strong></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุนููุจ ุดูุฑุฉ ููุฑุณ ุฃู ูููุฉ ูุงุญุฏุฉ ูุฏ ุชููู ุจุงุฏุฆุฉ ูุฃุฎุฑู. ุนูู ุณุจูู ุงููุซุงู ุ โข โข - โข ูุง ูุญุชูู ุนูู ูู ุชุดููุฑ ูุฑูุฏ: ูููู ุฃู ูููู F ุฃู ER. ูุชู ุญู ุฐูู ุนู ุทุฑูู ุงูุชููู ุงููุคูุช (ุซูุงุซ ููุงุท ูู ุงูุทูู) ุจูู ุงูุญุฑูู ุฃุซูุงุก ุงูุฅุฑุณุงู. ููุน ุฐูู ุ ุณูููู ูู ุงูุฃูุถู ุฅุฐุง ูู ุชูู ูููุงุช ุงูุดูุฑุฉ ุจุงุฏุฆุงุช ููููุงุช ุฃุฎุฑู. ูุฐุง ุงูููุฏ ูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unrefixed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุดูุฑุฉ ASCII ุฐุงุช ุงูุทูู ุงูุซุงุจุช ุบูุฑ ุซุงุจุชุฉ ูุฃู ูููุงุช ุงูุชุดููุฑ ุฏุงุฆููุง ูุง ุชููู ุจููุณ ุงูุทูู. ูููู ูููู ุฃูุถูุง ุฅุนุงุฏุฉ ุฅุตูุงุญ ุงูุฑููุฒ ุฐุงุช ุงูุทูู ุงููุชุบูุฑ. ุบุงูุจูุง ูุง ูุง ูุชู ุฅุตูุงุญ ุฃุฑูุงู ุงููุงุชู. ูุจู ุฅุฏุฎุงู ุฑูู ุงูุทูุงุฑุฆ 112 ูู ุงูุณููุฏ ุ ูุงู ูุฌุจ ุชุบููุฑ ุฌููุน ุงูุฃุฑูุงู ุงูุชู ุชุจุฏุฃ ุจู 112. ููู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ ุ ูุง ููุฌุฏ ุฑูู ูุงุชู ูุงุญุฏ ูุจุฏุฃ ุจุฑูู 911.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชูููู ุญุฌู ุงูุฑุณุงูุฉ ุงููุดูุฑุฉ ุ ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุฑูุฒ ุบูุฑ ููุนุงุฏ ุฅุตุฏุงุฑู ุญูุซ ูููู ููุฃุญุฑู ุงูุชู ุชุญุฏุซ ุจุดูู ูุชูุฑุฑ ูููุงุช ุดูุฑุฉ ุฃูุตุฑ. </font><font style="vertical-align: inherit;">ุณูููู ุงูุฑูุฒ ุงูุฃูุซู ูู ุงูุฐู ูููุฏ ุฃูุตุฑ ูุชูุฌุฉ ููููุฉ - ุณูููู ูุฌููุน ุฃุทูุงู ูููุงุช ุงูุดูุฑุฉ ุ ูุถุฑูุจูุง ูู ุชูุฑุงุฑ ุญุฏูุซูุง ุ ูู ุงูุญุฏ ุงูุฃุฏูู ุงููููู. </font><font style="vertical-align: inherit;">ููุฐุง ูุง ูุณูู ุฑูุฒ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบูุฑ ุจุงุฏุฆุฉ ูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุชูุฑุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฃู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ููููุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุชูุฑูููุง ููุฎุชุฑุน ุฎูุงุฑุฒููุฉ ูุนุงูุฉ ูุชูููุฏ ูุซู ูุฐู ุงูุฑููุฒ.</font></font><br>
<br>
<a name="7"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ ููููุงู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุซูุงุก ุฏุฑุงุณุฉ ุงูููุงุฏ ููุชุงุจุฉ ุฃุทุฑูุญุฉ ุงูุฏูุชูุฑุงู ูู ุงูููุฏุณุฉ ุงูุฅููุชุฑูููุฉ ูู ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง ุ ุญุถุฑ ุฏูููุฏ ููููุงู ุฏูุฑุฉ ุญูู ูุธุฑูุฉ ุงููุนูููุงุช ูุงู ุจุชุฏุฑูุณูุง ุฑูุจุฑุช ูุงูู. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุง ููุฃุณุทูุฑุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุณูุญ Fano ูุทูุงุจู ุจุงูุงุฎุชูุงุฑ: ูุชุงุจุฉ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู ุฃู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ. ุงุฎุชุงุฑ ููููุงู ุงูุฃุฎูุฑ ุ ูุชู ุฅุนุทุงุคู ููุถูุน ุงูุจุญุซ ุนู ุฑููุฒ ุบูุฑ ูุณุจููุฉ ูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุชูุฑุงุฑ. ูู ุงูููุชุฑุถ ุฃูู ูู ููู ูุนุฑู ุฃู ูุงูู ููุณู ูุงู ูุนูู ูู ูุฐู ุงููููุฉ ูู ุฐูู ุงูููุช (ูุงูุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ ุดุงููู-ูุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุทุฑููุฉ ุงูุฃูุซุฑ ุดูุฑุฉ ูู ุชูู ุงูุณููุงุช </font><font style="vertical-align: inherit;">). ููุดุฑุช ุฃุนูุงู ููููุงู ูู ุนุงู 1952 ุชุญุช ุนููุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุฉ ูุจูุงุก ุฑููุฒ ุงูุญุฏ ุงูุฃุฏูู ููุชูุฑุงุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุนุงู 1952. ูููุฐ ุฐูู ุงูุญูู ุชู ุงุณุชุฎุฏุงู ุงูุฎูุงุฑุฒููุฉ ุนูู ูุทุงู ูุงุณุน.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf0/4fe/003/cf04fe00303a663594eea8e8db063002.jpg"></div><br>
<i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงู ุตุญูู ูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> David Huffman </font><font style="vertical-align: inherit;">UC Santa Cruz. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ุฎูุงุฑุฒููุฉ ููููุงู ุจุฅูุดุงุก ููุฏ ุบูุฑ ูุนุงุฏ ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุชูุฑุงุฑ ููุฌููุนุฉ ุงูุฃุญุฑู ูุชูุฑุงุฑ ุงุณุชุฎุฏุงููุง. </font><font style="vertical-align: inherit;">ุชููู ุงูุฎูุงุฑุฒููุฉ ุจุดูู ูุชูุฑุฑ ุจุงุฎุชูุงุฑ ุญุฑููู ุฃูู ุงุญุชูุงููุง ููุนุซูุฑ ุนููููุง ูู ุจูุงูุงุช ุงููุตุฏุฑ - ูููู ุ X ู Y - ูุงุณุชุจุฏุงูููุง ุจุญุฑู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑูุจ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุนูู "X ุฃู Y". </font><font style="vertical-align: inherit;">ุชุฑุฏุฏ ุญุฏูุซ ุฑูุฒ ูุฑูุจ ูู ูุฌููุน ุชุฑุฏุฏุงุช ุฑูุฒู ุงููุตุฏุฑ. </font><font style="vertical-align: inherit;">ูููู ุฃู ุชููู ูููุงุช ุงูุชุดููุฑ ููู ูู X ู Y ุฃู ูููุงุช ุชุดููุฑ ูุชู ุชุนููููุง ุฅูู ุงูุญุฑู ุงููุฑูุจ "X ุฃู Y" ูุชุจูุนูุง ุจู 0 ุฃู 1 ููุชูููุฒ ุจูู ุงูุฃุญุฑู ุงูุฃุตููุฉ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ูุชู ุชูููู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุฅูู ุญุฑู ูุงุญุฏ ุ ุชุชููู ุงูุฎูุงุฑุฒููุฉ ุนู ุงูุนูู ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฑุญ ุงูููุฏูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ููู ูุซุงู ุนูู ุงูุฎูุงุฑุฒููุฉ ุงูุชู ุชุนูู ุนูู ูุฌููุนุฉ ุฃุญุฑู ุตุบูุฑุฉ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฑุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชูุฑุงุฑ ุงูุฃูู ูููุนุงูุฌุฉ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e90/a8f/4e4/e90a8f4e47c49cd14ca3a55f884d55e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุชู ุฅุฒุงูุฉ ุงูุฑูุฒูู ุงูุฃูุฏุฑ ุ C ู D ุ ูู ุงููุฌููุนุฉ ูุงุณุชุจุฏุงูููุง ุจุฑูุฒ ูุฑูุจ ุชุฑุฏุฏู ูู ูุฌููุน ุงูุชุฑุฏุฏุงุช C ู D:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e9/b0b/aed/7e9b0baeda34fc4d368c933bed7e1d15.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฃูุฏุฑ ุงูุฑููุฒ ูู B ูุฑูุฒ ูุฑูุจ ุจุชุฑุฏุฏ 5. ูุชู ุฅุฒุงูุชูุง ูู ุงููุฌููุนุฉ ูุงุณุชุจุฏุงููุง ุจุฑูุฒ ูุฑูุจ ุจุชุฑุฏุฏ 9:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bca/94b/ad6/bca94bad698775402e8bab2c6a20f664.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃุฎูุฑูุง ุ ูุชู ุฏูุฌ A ูุฑูุฒ ูุฑูุจ ุจุชุฑุฏุฏ 9 ูู ุฑูุฒ ุฌุฏูุฏ ุจุชุฑุฏุฏ 15:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/260/aa3/800/260aa38005cf701421881214915d859a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุชุฎููุถ ุงููุฌููุนุฉ ุจุฃููููุง ุฅูู ุญุฑู ูุงุญุฏ ุ ุงูุชูุงู ุงููุนุงูุฌุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎููุช ุงูุฎูุงุฑุฒููุฉ ุจููุฉ ุชุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฌุฑุฉ ููููุงู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฃุญุฑู ุงูุฅุฏุฎุงู ูู ุฃูุฑุงู ุ ููููุง ุฒุงุฏ ุชูุงุชุฑ ุงูุญุฑู ุ ุฒุงุฏ ุงุฑุชูุงุนู. </font><font style="vertical-align: inherit;">ุจุฏุกูุง ูู ุฌุฐุฑ ุงูุดุฌุฑุฉ ุ ููููู ุฅูุดุงุก ูููุงุช ูุดูุฑุฉ ููุฃุญุฑู ุจุฅุถุงูุฉ 0 ุฃู 1 ุนูุฏ ุงูุชุญุฑู ูุณุงุฑูุง ุฃู ูููููุง ุ ุนูู ุงูุชูุงูู. </font><font style="vertical-align: inherit;">ุงุชุถุญ ูุซู ูุฐุง:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ุชูุฌุฏ ูููุฉ ูุดูุฑุฉ ุจุงุฏุฆุฉ ูุฃู ุฃุฎุฑู. ูููุง ุญุฏุซ ุฑูุฒ ุ ูููุง ูุงูุช ูููุฉ ุงูุณุฑ ุฃูุตุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุงูุดุฌุฑุฉ ููู ุงูุชุดููุฑ: ูุจุฏุฃ ูู ุงูุฌุฐุฑ ูููุชูู ูููููุง ุฃู ูุณุงุฑูุง ูููููุฉ ูุน 0 ุฃู 1 ุฃูุงู ุงูุญุฑู. ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ูู ุงูุฎุท 010100 ูู ABBA. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุญุธ ุฃู ุทูู ูู ูููุฉ ูุดูุฑุฉ ูุนุงุฏู ุนูู ุนูุฏุฉ ุงูุดุฌุฑุฉ ุงูููุงุจูุฉ. ููุง ุณูุฑู ูู ุงูุฌุฒุก ุงูุชุงูู ุ ูุณูุง ุจุญุงุฌุฉ ุฅูู ุดุฌุฑุฉ ุญููููุฉ ูุชุนููู ูููุงุช ูุดูุฑุฉ. ูููู ุฃู ุชุนุฑู ุทูู ุงููููุงุช ููุณูุง. ูุจุงูุชุงูู ุ ุณุชููู ูุชูุฌุฉ ุชุทุจูููุง ูุฎูุงุฑุฒููุฉ ููููุงู ูู ุทูู ูููุงุช ุงูุดูุฑุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุฎุฒูู ูุฌููุนุฉ ุงูุฃุญุฑู ูุงูุนุซูุฑ ุนูู ุฃูู ุชุฑุฏุฏุงุช ุจููุงุกุฉ ุ ุณูุณุชุฎุฏู ุจููุฉ ุจูุงูุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ ุงูุซูุงุฆูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุนูู ูุฌู ุงูุฎุตูุต ุ ูุญู ููุชููู</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">min-heap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุญูุซ ูุฌุจ ุฃู ุชููู ุงููููุฉ ุงูุฏููุง ูู ุงูุฃุนูู.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Swap the 32-bit values pointed to by a and b. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap32</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *a, <span class="hljs-keyword">uint32_t</span> *b)</span>
</span>{
        <span class="hljs-keyword">uint32_t</span> tmp;<font></font>
<font></font>
        tmp = *a;<font></font>
        *a = *b;<font></font>
        *b = tmp;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Move element i in the n-element heap down to restore the minheap property. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">minheap_down</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *heap, <span class="hljs-keyword">size_t</span> n, <span class="hljs-keyword">size_t</span> i)</span>
</span>{
        <span class="hljs-keyword">size_t</span> left, right, min;<font></font>
<font></font>
        assert(i &gt;= <span class="hljs-number">1</span> &amp;&amp; i &lt;= n &amp;&amp; <span class="hljs-string">"i must be inside the heap"</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* While the ith element has at least one child. */</span>
        <span class="hljs-keyword">while</span> (i * <span class="hljs-number">2</span> &lt;= n) {<font></font>
                left = i * <span class="hljs-number">2</span>;<font></font>
                right = i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;<font></font>
<font></font>
                <span class="hljs-comment">/* Find the child with lowest value. */</span><font></font>
                min = left;<font></font>
                <span class="hljs-keyword">if</span> (right &lt;= n &amp;&amp; heap[right] &lt; heap[left]) {<font></font>
                        min = right;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Move i down if it is larger. */</span>
                <span class="hljs-keyword">if</span> (heap[min] &lt; heap[i]) {<font></font>
                        swap32(&amp;heap[min], &amp;heap[i]);<font></font>
                        i = min;<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Establish minheap property for heap[1..n]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">minheap_heapify</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *heap, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        <span class="hljs-comment">/* Floyd's algorithm. */</span>
        <span class="hljs-keyword">for</span> (i = n / <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">1</span>; i--) {<font></font>
                minheap_down(heap, n, i);<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุชุจุน ุชูุฑุงุฑ </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุฑูู ุ ุณูุณุชุฎุฏู ูุฌููุนุฉ ูู </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนูุงุตุฑ. </font><font style="vertical-align: inherit;">ุฃูุถูุง ุ ูู ูู ูุฑุฉ ูุชู ูููุง ุฅูุดุงุก ุฑูุฒ ูุฑูุจ ุ ูุฑูุฏ "ุฑุจุท" ุฑูุฒู ุงููุตุฏุฑ ุจู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุณูููู ููู ุฑูุฒ "ุนูุตุฑ ุงุชุตุงู". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุฎุฒูู </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุนูุตุฑ </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูุงุตุฑ ุงูุงุชุตุงู ุ ุณูุณุชุฎุฏู ูุฌููุนุฉ ูู </font></font><code>n * 2 + 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนูุงุตุฑ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ูุชู ุงุณุชุจุฏุงู ุญุฑููู ุนูู ูููุฉ ุจุฃุฎุฑู ุ ุณูู ูุณุชุฎุฏู ุงูุนูุตุฑ ุงูุซุงูู ูุญูุธ ุงูุงุฑุชุจุงุท ุฅูู ุงูุญุฑู ุงูุฌุฏูุฏ. </font><font style="vertical-align: inherit;">ูุนุชูุฏ ูุฐุง ุงูููุฌ ุนูู ุชูููุฐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฏุงุฑุฉ ุบูุบุงุจุงูุช ูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Witten ู Moffat ู Bell.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูู ุนูุฏุฉ ูู ุงููููุฉ ุ ุณูุณุชุฎุฏู 16 ุจุช ุงูุฃูุซุฑ ุฃูููุฉ ูุชุฎุฒูู ุชุฑุฏุฏ ุงูุฑูุฒ ุ ู 16 ุจุช ุงูุฃูู ุฃูููุฉ ูุชุฎุฒูู ููุฑุณ ุนูุตุฑ ุงุชุตุงู ุงูุฑูุฒ. ูุธุฑูุง ูุงุณุชุฎุฏุงู ุงูุจุชุงุช ุงูุนุงููุฉ ุ ุณูุชู ุชุญุฏูุฏ ูุฑู ุงูุชุฑุฏุฏ ูู ุฎูุงู ููุงุฑูุฉ 32 ุจุช ุจูู ุนูุตุฑู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุณุจุจ ูุฐุง ุงูุชูุซูู ุ ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ุชุฑุฏุฏ ุงูุฃุญุฑู ูุชูุงุณุจ ุฏุงุฆููุง ูุน 16 ุจุช. ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุฎูุงุฑุฒููุฉ ุ ุณูููู ููุฑูุฒ ุงููุฑูุจ ุงูููุงุฆู ุชุฑุฏุฏ ุฌููุน ุงูุฑููุฒ ุงููุฏูุฌุฉ ุ ุฃู ุฃูู ูุฌุจ ูุถุน ูุฐุง ุงููุฌููุน ูู 16 ุจุช. ุณูุชุญูู ุชุทุจูู Deflate ูู ูุฐุง ูู ุฎูุงู ูุนุงูุฌุฉ ูุง ูุตู ุฅูู 64.535 ุญุฑููุง ูู ููุช ูุงุญุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณุชุณุชูุจู ุงูุฑููุฒ ุฐุงุช ุงูุชุฑุฏุฏ ุงูุตูุฑู ูููุงุช ููุฏ ุจุทูู ุตูุฑู ููู ุชุดุงุฑู ูู ุชุฌููุน ุงูุชุฑููุฒ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ูุตูุช ูููุฉ ุงูุดูุฑุฉ ุฅูู ุฃูุตู ุนูู ูุญุฏุฏ ุ ูุณูููู "ุจุชุฎููู" ุชูุฒูุน ุงูุชุฑุฏุฏ ูู ุฎูุงู ูุฑุถ ุญุฏ ููุชุฑุฏุฏ ูุฅุนุงุฏุฉ ุงููุญุงููุฉ (ูุนู ุ ุจูุณุงุนุฏุฉ </font></font><code>goto</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). ููุงู ุทุฑู ุฃูุซุฑ ุชุนููุฏูุง ููููุงู ุจุชุดููุฑ Huffman ุงููุญุฏูุฏ ุจุนูู ุ ูููู ูุฐู ุงูุทุฑููุฉ ุจุณูุทุฉ ููุนุงูุฉ.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_HUFFMAN_SYMBOLS 288      <span class="hljs-comment">/* Deflate uses max 288 symbols. */</span></span><font></font>
<font></font>
<span class="hljs-comment">/* Construct a Huffman code for n symbols with the frequencies in freq, and
 * codeword length limited to max_len. The sum of the frequencies must be &lt;=
 * UINT16_MAX. max_len must be large enough that a code is always possible,
 * i.e. 2 ** max_len &gt;= n. Symbols with zero frequency are not part of the code
 * and get length zero. Outputs the codeword lengths in lengths[0..n-1]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compute_huffman_lengths</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *freqs, <span class="hljs-keyword">size_t</span> n,
                                    <span class="hljs-keyword">uint8_t</span> max_len, <span class="hljs-keyword">uint8_t</span> *lengths)</span>
</span>{
        <span class="hljs-keyword">uint32_t</span> nodes[MAX_HUFFMAN_SYMBOLS * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>], p, q;
        <span class="hljs-keyword">uint16_t</span> freq;
        <span class="hljs-keyword">size_t</span> i, h, l;
        <span class="hljs-keyword">uint16_t</span> freq_cap = UINT16_MAX;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span>
        <span class="hljs-keyword">uint32_t</span> freq_sum = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                freq_sum += freqs[i];<font></font>
        }<font></font>
        assert(freq_sum &lt;= UINT16_MAX &amp;&amp; <span class="hljs-string">"Frequency sum too large!"</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        assert((<span class="hljs-number">1U</span> &lt;&lt; max_len) &gt;= n &amp;&amp; <span class="hljs-string">"max_len must be large enough"</span>);<font></font>
<font></font>
try_again:<font></font>
        <span class="hljs-comment">/* Initialize the heap. h is the heap size. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                freq = freqs[i];<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (freq == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>; <span class="hljs-comment">/* Ignore zero-frequency symbols. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (freq &gt; freq_cap) {<font></font>
                        freq = freq_cap; <span class="hljs-comment">/* Enforce the frequency cap. */</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* High 16 bits: Symbol frequency.
                   Low 16 bits:  Symbol link element index. */</span><font></font>
                h++;<font></font>
                nodes[h] = ((<span class="hljs-keyword">uint32_t</span>)freq &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-keyword">uint32_t</span>)(n + h);<font></font>
        }<font></font>
        minheap_heapify(nodes, h);<font></font>
<font></font>
        <span class="hljs-comment">/* Special case for less than two non-zero symbols. */</span>
        <span class="hljs-keyword">if</span> (h &lt; <span class="hljs-number">2</span>) {
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                        lengths[i] = (freqs[i] == <span class="hljs-number">0</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Build the Huffman tree. */</span>
        <span class="hljs-keyword">while</span> (h &gt; <span class="hljs-number">1</span>) {
                <span class="hljs-comment">/* Remove the lowest frequency node p from the heap. */</span>
                p = nodes[<span class="hljs-number">1</span>];<font></font>
                nodes[<span class="hljs-number">1</span>] = nodes[h--];<font></font>
                minheap_down(nodes, h, <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Get q, the next lowest frequency node. */</span>
                q = nodes[<span class="hljs-number">1</span>];<font></font>
<font></font>
                <span class="hljs-comment">/* Replace q with a new symbol with the combined frequencies of
                   p and q, and with the no longer used h+1'th node as the
                   link element. */</span>
                nodes[<span class="hljs-number">1</span>] = ((p &amp; <span class="hljs-number">0xffff0000</span>) + (q &amp; <span class="hljs-number">0xffff0000</span>))<font></font>
                           | (<span class="hljs-keyword">uint32_t</span>)(h + <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Set the links of p and q to point to the link element of
                   the new node. */</span>
                nodes[p &amp; <span class="hljs-number">0xffff</span>] = nodes[q &amp; <span class="hljs-number">0xffff</span>] = (<span class="hljs-keyword">uint32_t</span>)(h + <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Move the new symbol down to restore heap property. */</span>
                minheap_down(nodes, h, <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Compute the codeword length for each symbol. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {
                <span class="hljs-keyword">if</span> (freqs[i] == <span class="hljs-number">0</span>) {<font></font>
                        lengths[i] = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
                h++;<font></font>
<font></font>
                <span class="hljs-comment">/* Link element for the i'th symbol. */</span><font></font>
                p = nodes[n + h];<font></font>
<font></font>
                <span class="hljs-comment">/* Follow the links until we hit the root (link index 2). */</span>
                l = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">while</span> (p != <span class="hljs-number">2</span>) {<font></font>
                        l++;<font></font>
                        p = nodes[p];<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l &gt; max_len) {
                        <span class="hljs-comment">/* Lower freq_cap to flatten the distribution. */</span>
                        assert(freq_cap != <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-string">"Cannot lower freq_cap!"</span>);<font></font>
                        freq_cap /= <span class="hljs-number">2</span>;
                        <span class="hljs-keyword">goto</span> try_again;<font></font>
                }<font></font>
<font></font>
                assert(l &lt;= UINT8_MAX);<font></font>
                lengths[i] = (<span class="hljs-keyword">uint8_t</span>)l;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุจุฏูู ุงูุฃููู ูุฎูุงุฑ ูููุฉ ุงูุฐุงูุฑุฉ ุงูุซูุงุฆูุฉ ูู ุชุฎุฒูู ุงูุฃุญุฑู ูู ุทุงุจูุฑ. </font><font style="vertical-align: inherit;">ูุญุชูู ุงูุฃูู ุนูู ุฃุญุฑู ุงููุตุฏุฑ ุ ูุฑุชุจุฉ ุญุณุจ ุงูุชุฑุฏุฏ. </font><font style="vertical-align: inherit;">ุนูุฏูุง ูุชู ุฅูุดุงุก ุฑูุฒ ูุฑูุจ ุ ูุชู ุฅุถุงูุชู ุจุดูู ุซุงููู. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ุณูููู ุงูุฑูุฒ ุฐู ุงูุชุฑุฏุฏ ุงูุฃูู ุฏุงุฆููุง ูู ุงูููุถุน ุงูุฃูู ูุฃุญุฏ ููุงุฆู ุงูุงูุชุธุงุฑ. </font><font style="vertical-align: inherit;">ุชู ูุตู ูุฐุง ุงูููุฌ ูู ูุจู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุงู ูุงู ููููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ุจูุงุก ุฃุดุฌุงุฑ ููููุงู"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1976). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุงู ุงูุชุฑููุฒ ูู ุงูุฃูุซู ูุฑููุฒ ุบูุฑ ุงูุจุงุฏุฆุฉุ ูููู ูู ุญุงูุงุช ุฃุฎุฑู ููุงู ุทุฑู ุฃูุซุฑ ููุงุกุฉ: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุณุงุจูุฉ ุงูุชุฑููุฒ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธู ุนุฏุฏ ุบูุฑ ุงููุชูุงุซูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="8"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑููุฒ ููููุงู ุงููุงููููุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุซุงู ุฃุนูุงู ุ ูููุง ุจุจูุงุก ุดุฌุฑุฉ ููููุงู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/260/aa3/800/260aa38005cf701421881214915d859a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุง ุงูุชูููุง ูู ุงูุฌุฐุฑ ูุงุณุชุฎุฏููุง 0 ูููุฑุน ุงูุฃูุณุฑ ู 1 ูููููู ุ ูุฅููุง ูุญุตู ุนูู ุงูุฑููุฒ ุงูุชุงููุฉ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ูุฑุงุฑ ุงุณุชุฎุฏุงู 0 ูููุฑุน ุงูุฃูุณุฑ ู 1 ูููุฑุน ุงูุฃููู ุชุนุณููุงู. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุนููุง ุงูุนูุณ ูุญุตู ุนูู:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">001</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">000</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุง ุชูููุฒ ูุฑุนูู ุจุดูู ุชุนุณูู ููุดุฃ ูู ุนูุฏุฉ ุจุตูุฑ ููุฑุน (ุงูุดูุก ุงูุฑุฆูุณู ูู ุฃู ุงูุชุณููุงุช ูุฎุชููุฉ) ุ ููุง ุฒููุง ูุญุตู ุนูู ุงูุฑูุฒ ุงูููุงูุฆ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/29b/acb/499/29bacb4999e9a3f530f22634846a97b7.png"></div><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุญุฏ ุนุดุฑ</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">101</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุงูุฑุบู ูู ุฃู ุฎูุงุฑุฒููุฉ ููููุงู ุชููุฑ ุฃุทูุงู ูููุงุช ุงูููุฏ ุงููุทููุจุฉ ููููุฏ ุบูุฑ ุงููุนุงุฏ ุฅุตูุงุญู ูุน ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุชูุฑุงุฑ ุ ูููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ูุชุนููู ูููุงุช ุงูููุฏ ุงููุฑุฏูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุธุฑ ุฅูู ุทูู ูููุฉ ุงูุดูุฑุฉ ุงููุญุณูุจุฉ ุจูุงุณุทุฉ ุฎูุงุฑุฒููุฉ ููููุงู ุ ูุฅู ุฑูุฒ ููููุงู ุงููุนููู ูุนูู ูููุงุช ุงูุดูุฑุฉ ุฅูู ุงูุฃุญุฑู ุจุทุฑููุฉ ูุนููุฉ. ูุฐุง ูููุฏ ูุฃูู ูุณูุญ ูู ุจุชุฎุฒูู ูููู ุฃุทูุงู ูููุงุช ุงูุชุดููุฑ ุจุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุถุบูุทุฉ: ุณูููู ูููู ุงูุชุดููุฑ ูุงุฏุฑูุง ุนูู ุงุณุชุนุงุฏุฉ ูููุงุช ุงูุชุดููุฑ ุจูุงุกู ุนูู ุฃุทูุงููุง. ุจุงูุทุจุน ุ ููููู ุชุฎุฒูู ุชุฑุฏุฏุงุช ุงูุฑูุฒ ูููููุง ูุชุดุบูู ุฎูุงุฑุฒููุฉ ููููุงู ูู ูุญุฏุฉ ูู ุงูุชุฑููุฒ ุ ูููู ูุฐุง ุณูุชุทูุจ ุงููุฒูุฏ ูู ุงูุนูู ูุงููุฒูุฏ ูู ุงูุชุฎุฒูู ูู ูุญุฏุฉ ูู ุงูุชุฑููุฒ. ุฎุงุตูุฉ ุฃุฎุฑู ูููุฉ ููุบุงูุฉ ูู ุฃู ุจููุฉ ุงูุฑููุฒ ุงูุฃุณุงุณูุฉ ุชุณุชุฎุฏู ูู ุชุดููุฑ ูุนุงู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ุงูููุฑุฉ ูู ุชุนููู ูููุงุช ูุดูุฑุฉ ููุฃุญุฑู ุจุงูุชุณูุณู ุ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู. ูููุฉ ุงูููุฏ ุงูุฃููู ูู 0. ูุงููููุฉ ุงูุชุงููุฉ ุณุชููู ูููุฉ ุจุทูู ุงููููุฉ ุงูุณุงุจูุฉ + 1. ุชุชููู ุงููููุฉ ุงูุฃููู ุจุทูู N ูู ุงููููุฉ ุงูุฃุฎูุฑุฉ ุจุทูู N-1 ุ ูุฅุถุงูุฉ ูููุฉ ูุงุญุฏุฉ (ููุญุตูู ุนูู ูููุฉ ููุฏ ุฌุฏูุฏุฉ) ูุชุญููู ุฎุทูุฉ ูุงุญุฏุฉ ุฅูู ุงููุณุงุฑ (ูุฒูุงุฏุฉ ุงูุทูู). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุตุทูุญุงุช ุดุฌุฑุฉ ููููุงู ุ ูุชู ุชุนููู ูููุงุช ุงูุดูุฑุฉ ุจุดูู ุชุณูุณูู ููุฃูุฑุงู ุจุงูุชุฑุชูุจ ูู ุงููุณุงุฑ ุฅูู ุงููููู ุ ูุณุชูู ูุงุญุฏ ูู ูู ูุฑุฉ ุ ูุงูุงูุชูุงู ุฅูู ุงููุณุงุฑ ุนูุฏ ุงูุงูุชูุงู ุฅูู ุงููุณุชูู ุงูุชุงูู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุซุงู ABCD ุ ูุงูุช ุฎูุงุฑุฒููุฉ ููููุงู ุจุชุนููู ูููุงุช ููุฏ ุจุฃุทูุงู 1 ู 2 ู 3 ู 3. ุงููููุฉ ุงูุฃููู ูู 0. ููุฐู ุฃูุถูุง ูู ุขุฎุฑ ูููุฉ ูู ุงูุทูู 1. ุจุงููุณุจุฉ ููุทูู 2 ุ ูุฃุฎุฐ 0 ููุถูู 1 ููุญุตูู ุนูู ุงูุฑูุฒ ุงูุชุงูู ุ ูุงูุฐู ุณูุตุจุญ ุจุงุฏุฆุฉ ูุฑููุฒ ุซูุงุฆูุฉ ุ ุงูุชูู ุฅูู ุงููุณุงุฑ ูุงุญุตู ุนูู 10. ูุฐู ูู ุงููููุฉ ุงูุฃุฎูุฑุฉ ูู ุงูุทูู 2. ููุญุตูู ุนูู ุงูุทูู 3 ุ ูุถูู 1 ููุญูู: 110. ููุญุตูู ุนูู ุงููููุฉ ุงูุชุงููุฉ ูู ุงูุทูู 3 ูุถูู 1: 111.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธูุฑ ุชูููุฐ ููุดุฆ ุฑูุฒ ุงูููุณู ุฃุฏูุงู. </font><font style="vertical-align: inherit;">ูุงุญุธ ุฃู ุฎูุงุฑุฒููุฉ ุงูุงูููุงุด ุชุชููุน ุฃู ูุชู ุฅูุดุงุก ูููุงุช ูุดูุฑุฉ ุนูู ุฃุณุงุณ ูุจุฏุฃ LSB-first (ุฃููุงู ุ ุงูุจุช ุงูุฃูู ุฃูููุฉ). </font><font style="vertical-align: inherit;">ุฃู ุฃูู ูุฌุจ ุชุฎุฒูู ุงูุจุชุฉ ุงูุฃููู ูู ุงููููุฉ ุงูุดูุฑูุฉ ูู ุงูุจุชุฉ ุงูุฃูู ุฏูุงูุฉ. </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃููุง ุจุญุงุฌุฉ ุฅูู ุชุบููุฑ ุชุฑุชูุจ ุงูุจุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุงุณุชุฎุฏุงู ุฌุฏูู ุงูุจุญุซ.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_HUFFMAN_BITS 15          <span class="hljs-comment">/* Deflate uses max 15-bit codewords. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compute_canonical_code</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> *codewords, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                                   <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint16_t</span> count[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">uint16_t</span> code[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">int</span> l;<font></font>
<font></font>
        <span class="hljs-comment">/* Count the number of codewords of each length. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                count[lengths[i]]++;<font></font>
        }<font></font>
        count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">/* Ignore zero-length codes. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Compute the first codeword for each length. */</span>
        code[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {<font></font>
                code[l] = (<span class="hljs-keyword">uint16_t</span>)((code[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Assign a codeword for each symbol. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                l = lengths[i];<font></font>
                <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                codewords[i] = reverse16(code[l]++, l); <span class="hljs-comment">/* Make it LSB-first. */</span><font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Reverse the n least significant bits of x.
   The (16 - n) most significant bits of the result will be zero. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint16_t</span> <span class="hljs-title">reverse16</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> x, <span class="hljs-keyword">int</span> n)</span>
</span>{
        <span class="hljs-keyword">uint16_t</span> lo, hi;
        <span class="hljs-keyword">uint16_t</span> reversed;<font></font>
<font></font>
        assert(n &gt; <span class="hljs-number">0</span>);<font></font>
        assert(n &lt;= <span class="hljs-number">16</span>);<font></font>
<font></font>
        lo = x &amp; <span class="hljs-number">0xff</span>;<font></font>
        hi = x &gt;&gt; <span class="hljs-number">8</span>;<font></font>
<font></font>
        reversed = (<span class="hljs-keyword">uint16_t</span>)((reverse8_tbl[lo] &lt;&lt; <span class="hljs-number">8</span>) | reverse8_tbl[hi]);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> reversed &gt;&gt; (<span class="hljs-number">16</span> - n);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุถุน ูู ุดูุก ูุนูุง ูุงูุชุจ ููุฏ ุชููุฆุฉ ุจุฑูุงูุฌ ุงูุชุดููุฑ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_encoder_t</span> <span class="hljs-title">huffman_encoder_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_encoder_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> codewords[MAX_HUFFMAN_SYMBOLS]; <span class="hljs-comment">/* LSB-first codewords. */</span>
        <span class="hljs-keyword">uint8_t</span> lengths[MAX_HUFFMAN_SYMBOLS];    <span class="hljs-comment">/* Codeword lengths. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize a Huffman encoder based on the n symbol frequencies. */</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">huffman_encoder_init</span><span class="hljs-params">(<span class="hljs-keyword">huffman_encoder_t</span> *e, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *freqs, <span class="hljs-keyword">size_t</span> n,
                          <span class="hljs-keyword">uint8_t</span> max_codeword_len)</span>
</span>{<font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        assert(max_codeword_len &lt;= MAX_HUFFMAN_BITS);<font></font>
<font></font>
        compute_huffman_lengths(freqs, n, max_codeword_len, e-&gt;lengths);<font></font>
        compute_canonical_code(e-&gt;codewords, e-&gt;lengths, n);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุฃูุถูุง ุจุนูู ูุธููุฉ ูุชููุฆุฉ ุงููุดูุฑ ุจุงุณุชุฎุฏุงู ุฃุทูุงู ุงูุดูุฑุฉ ุงููุญุณูุจุฉ ุจุงููุนู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Initialize a Huffman encoder based on the n codeword lengths. */</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">huffman_encoder_init2</span><span class="hljs-params">(<span class="hljs-keyword">huffman_encoder_t</span> *e, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                           <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                e-&gt;lengths[i] = lengths[i];<font></font>
        }<font></font>
        compute_canonical_code(e-&gt;codewords, e-&gt;lengths, n);<font></font>
}<font></font>
</code></pre><br>
<a name="9"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุกุฉ ูู ููููุงู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุณูู ุทุฑููุฉ ููู ุดูุฑุฉ Huffman ูู ุงุฌุชูุงุฒ ุงูุดุฌุฑุฉ ุจุฏุกูุง ูู ุงูุฌุฐุฑ ุ ููุฑุงุกุฉ ุฌุฒุก ูุงุญุฏ ูู ุงููุฏุฎูุงุช ูู ูู ูุฑุฉ ูุชุญุฏูุฏ ุงููุฑุน ุงูุฐู ูุฌุจ ุงุชุฎุงุฐู ุจุนุฏ ุฐูู ุ ุฅูู ุงููุณุงุฑ ุฃู ุงููููู. </font><font style="vertical-align: inherit;">ุนูุฏ ุงููุตูู ุฅูู ุนูุฏุฉ ูุฑูุฉ ุ ูููู ุญุฑููุง ูุดูุฑูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุบุงูุจูุง ูุง ูุชู ุชุฏุฑูุณ ูุฐู ุงูุทุฑููุฉ ูู ุงูุฌุงูุนุงุช ูุงููุชุจ. </font><font style="vertical-align: inherit;">ุฅูู ุจุณูุท ูุฃููู ุ ูููู ุงููุนุงูุฌุฉ ุงููุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุจุทูุฆุฉ ุฌุฏูุง. </font><font style="vertical-align: inherit;">ุฅูู ุฃุณุฑุน ุจูุซูุฑ ููู ุงูุชุดููุฑ ุจุงุณุชุฎุฏุงู ุฌุฏูู ุงูุจุญุซ. </font><font style="vertical-align: inherit;">ูู ุงููุซุงู ุฃุนูุงู ุ ุญูุซ ูุจูุบ ุงูุญุฏ ุงูุฃูุตู ูุทูู ูููุฉ ุงูุณุฑ ุซูุงุซุฉ ุจุชุงุช ุ ููููู ุงุณุชุฎุฏุงู ุงูุฌุฏูู ุงูุชุงูู:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุช</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูู ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุงูุฑุบู ูู ูุฌูุฏ ุฃุฑุจุนุฉ ุฃุญุฑู ููุท ุ ูุญุชุงุฌ ุฅูู ุฌุฏูู ูุญุชูู ุนูู ุซูุงููุฉ ุฅุฏุฎุงูุงุช ูุชุบุทูุฉ ุฌููุน ูุฌููุนุงุช ุงูุซูุงุซุฉ ุจุช ุงูููููุฉ. </font><font style="vertical-align: inherit;">ุชุญุชูู ุงูุฑููุฒ ุงูุชู ุชุญุชูู ุนูู ูููุงุช ูุดูุฑุฉ ุฃูุตุฑ ูู ุซูุงุซ ุจุชุงุช ุนูู ุนุฏุฉ ุฅุฏุฎุงูุงุช ูู ุงูุฌุฏูู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุชู "ุชูููุฉ" ุงููููุฉ 10 ุจุงูุฑูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0 ู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 ูุชุบุทูุฉ ุฌููุน ูุฌููุนุงุช ุงูุซูุงุซุฉ ุจุชุงุช ุงูุชู ุชุจุฏุฃ ุจู 10. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูุดูุฑุฉ ุจูุฐู ุงูุทุฑููุฉ ุ ุชุญุชุงุฌ ุฅูู ุงูููุฑุณุฉ ูู ุงูุฌุฏูู ุจุงุณุชุฎุฏุงู ูุญุฏุงุช ุจุช ุงูุฅุฏุฎุงู ุงูุซูุงุซุฉ ุงูุชุงููุฉ ูุงูุนุซูุฑ ุนูู ุงูููุฑ ุนูู ุงูุญุฑู ุงูููุงุจู ูุทูู ูููุฉ ุงูููุฏ ุงูุฎุงุตุฉ ุจู. </font><font style="vertical-align: inherit;">ุงูุทูู ููู ุ ูุฃูู ุนูู ุงูุฑุบู ูู ุงููุธุฑ ุฅูู ุงูุจุชุงุช ุงูุซูุงุซุฉ ุงูุชุงููุฉ ุ ูุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ููุณ ุนุฏุฏ ุจุชุงุช ุงูุฅุฏุฎุงู ูุซู ุทูู ูููุฉ ุงูุชุดููุฑ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุนูู ุงูุทุฑููุฉ ุงููุณุชูุฏุฉ ุฅูู ุฌุฏูู ุงูุจุญุซ ุจุณุฑุนุฉ ูุจูุฑุฉ ุ ูููู ููุง ุนูุจูุง: ูุชุถุงุนู ุญุฌู ุงูุฌุฏูู ูุน ูู ุจุช ุฅุถุงูู ูู ุทูู ูููุฉ ุงูุชุดููุฑ. ุฃู ุฃู ุจูุงุก ุงูุฌุฏูู ูุชุจุงุทุฃ ุจุดูู ูุจูุฑ ุ ูุฅุฐุง ุชููู ุนู ููุงุกูุชู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุนุงูุฌ ุ ูุณุชุจุฏุฃ ุงูุทุฑููุฉ ูู ุงูุนูู ุจุจุทุก. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุณุจุจ ูุฐุง ุ ูุชู ุงุณุชุฎุฏุงู ุฌุฏูู ุงูุจุญุซ ุนุงุฏุฉู ููุท ูููููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ูุง ูุฒูุฏ ุทูููุง ุนู ุทูู ูุนูู. ููููููุงุช ุงูุฃุทูู ุชุชุฎุฐ ููุฌูุง ูุฎุชูููุง. ูุซููุง ูููู ุชุฑููุฒ Huffman ุจุชุนููู ูููุงุช ูุดูุฑุฉ ุฃูุตุฑ ูุดุฎุตูุงุช ุฃูุซุฑ ุชูุฑุงุฑูุง ุ ูุฅู ุงุณุชุฎุฏุงู ุฌุฏูู ุจุญุซ ููููุงุช ูุดูุฑุฉ ูุตูุฑุฉ ูู ูู ูุซูุฑ ูู ุงูุญุงูุงุช ุชุญุณูู ููุชุงุฒ. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฒููุจ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุงุณุชุฎุฏุงู ุนุฏุฉ ูุณุชููุงุช ูู ุฌุฏุงูู ุงูุจุญุซ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ูููุฉ ุงูููุฏ ุทูููุฉ ุฌุฏูุง ุจุงููุณุจุฉ ููุฌุฏูู ุงูุฃูู ุ ูุณูุฐูุจ ุงูุจุญุซ ุฅูู ุงูุฌุฏูู ุงูุซุงููู ูููุฑุณุฉ ุงูุจุชุงุช ุงููุชุจููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุงู ุทุฑููุฉ ุฃุฎุฑู ุฃูููุฉ ููุบุงูุฉ ุ ุชุณุชูุฏ ุฅูู ุฎุตุงุฆุต ุฑููุฒ ููููุงู ุงููุงููููุฉ. </font><font style="vertical-align: inherit;">ููุฏ ุชู ูุตูู ูู " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูู ุชูููุฐ ุงูุญุฏ ุงูุฃุฏูู ูู ุฑููุฒ ุจุงุฏุฆุฉ ุงูุชูุฑุงุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ูููุงุช ูุชูุฑุจูู ุ 1997) ุ ููุง ุชู ุดุฑุญู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุดุงุฑูุฒ ุจููู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">The Lost Huffman Paper</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฃุฎุฐ ูููุงุช ุงูุดูุฑุฉ ูู ุงููุณุฎุฉ ุงููุชุนุงุฑู ุนูููุง: 0 ุ 10 ุ 110 ุ 111. ุณูุชุชุจุน ูููุงุช ุงูุดูุฑุฉ ุงูุฃููู ููู ุทูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุนุฏุฏ ูู ูููุฉ ููุฏ ูู ุงูุชุณูุณู ุงูุนุงู - "ููุฑุณ ุงูุฑููุฒ".</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูู ูููุฉ ุงูุณุฑ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุณุฑ ุงูุฃููู</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุดุฑ ุงูุญุฑู ุงูุฃูู</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 (ุฃ)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 (ุจ)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 (ุฌ)</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุฃู ูููุงุช ุงูุชุดููุฑ ูุชู ุชุนููููุง ุจุงูุชุณูุณู ุ ุฅุฐุง ุนุฑููุง ุนุฏุฏ ุงูุจุชุงุช ุ ููููููุง ุงูุนุซูุฑ ูู ุงูุฌุฏูู ุฃุนูุงู ุนูู ุงูุญุฑู ุงูุฐู ุชูุซูู ูุฐู ุงูุจุชุงุช. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ููุซูุงุซุฉ 111 ุจุช ุ ูุฑู ุฃู ูุฐุง ููุซู ุฅุฒุงุญุฉ ุจูุงุณุทุฉ ูุงุญุฏ ูู ุฃูู ูููุฉ ูุดูุฑุฉ ุจูุฐุง ุงูุทูู (110). </font><font style="vertical-align: inherit;">ูุคุดุฑ ุงูุญุฑู ุงูุฃูู ูู ูุฐุง ุงูุทูู ูู 3 ุ ูุชุนุทููุง ุฅุฒุงุญุฉ ูุงุญุฏ ููุฑุณ 4. ููุงุฑู ุฌุฏูู ุขุฎุฑ ููุฑุณ ุงูุญุฑู ุจุงูุญุฑู:</font></font><br>
<br>
<pre><code class="cpp hljs">sym_idx = d-&gt;first_symbol[len] + (bits - d-&gt;first_code[len]);<font></font>
sym = d-&gt;syms[sym_idx];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููููู ูู ุงูุชุญุณูู: ุจุฏูุงู ูู ุชุฎุฒูู ููุฑุณ ุงูุญุฑู ุงูุฃูู ููููุฉ ุงูููุฏ ุงูุฃููู ุจุดูู ูููุตู ุ ูููููุง ุชุฎุฒูู ุงูููุฑุณ ุงูุฃูู ูุทุฑูุญูุง ููู ุฃูู ูููุฉ ูุดูุฑุฉ ูู ุงูุฌุฏูู:</font></font><br>
<br>
<pre><code class="cpp hljs">sym_idx = d-&gt;offset_first_sym_idx[len] + bits;<font></font>
sym = d-&gt;syms[sym_idx];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุนุฏุฏ ุงูุจุชุงุช ุงูุชู ูุฌุจ ุชูุฏูุฑูุง ุ ูุณุชุฎุฏู ูุฑุฉ ุฃุฎุฑู ุฎุงุตูุฉ ุชุณูุณู ุงูููุฏ. </font><font style="vertical-align: inherit;">ูู ูุซุงููุง ุ ุชููู ุฌููุน ูููุงุช ุงูุชุดููุฑ ุงูุตุงูุญุฉ ุฐุงุช ุงูุจุชุฉ ุงููุงุญุฏุฉ ุฃูู ูู 1 ุ ุจุชูู - ุฃูู ูู 11 ุ ุซูุงุซ ุจุชุงุช - ุฃูู ูู 1000 (ูู ุงููุงูุน ุ ุตุญูุญ ูุฌููุน ููู ุงูุซูุงุซุฉ ุจุช). </font><font style="vertical-align: inherit;">ุจูุนูู ุขุฎุฑ ุ ูุฌุจ ุฃู ุชููู ูููุฉ ุดูุฑุฉ N-bit ุงูุตุงูุญุฉ ุฃูู ุจูุซูุฑ ูู ูููุฉ ุดูุฑุฉ N-bit ุงูุฃููู ุจุงูุฅุถุงูุฉ ุฅูู ุนุฏุฏ ูููุงุช ุดูุฑุฉ N-bit. </font><font style="vertical-align: inherit;">ุนูุงูุฉ ุนูู ุฐูู ุ ูููููุง ุชุญููู ูุฐู ุงูุญุฏูุฏ ุฅูู ุงููุณุงุฑ ุจุญูุซ ุชููู ูููุง ุจุนุฑุถ ุซูุงุซุฉ ุจุช. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุณูููุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุชุงุช ุชูููุฏูุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ูู ุฃุทูุงู ูููุงุช ุงูุชุฑููุฒ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูู ูููุฉ ุงูุณุฑ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุช ุงูุญุฏ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000</font></font></td>
</tr>
</tbody></table></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู ุชุฌุงูุฒ ูุญุฏุฏ ุงูุทูู 3 ุฅูู 4 ุจุช ุ ูููู ูุฐุง ูุนูู ููุท ุฃู ุฃู ูููุฉ ูู ุซูุงุซ ุจุชุงุช ุณุชูุนู. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููููุง ุงูุจุญุซ ุจูู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุงูููููุฉ ูู ุซูุงุซุฉ ุจุชุงุช ูุงูููุงุฑูุฉ ูุน ุงูุจุชุงุช ุงููููุฏุฉ ูููู ูุฏุฉ ูููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจูุง. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ุ ูุญูู ุจุชุงุช ุงูุฅุฏุฎุงู ุ ููุท ูุญุณุงุจ ุงูุนุฏุฏ ุงูุตุญูุญ ููุง ุ ุซู ูุนุซุฑ ุนูู ููุฑุณ ุงูุฃุญุฑู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (len = <span class="hljs-number">1</span>; len &lt;= <span class="hljs-number">3</span>; len++) {
        <span class="hljs-keyword">if</span> (bits &lt; d-&gt;sentinel_bits[len]) {<font></font>
                bits &gt;&gt;= <span class="hljs-number">3</span> - len;  <span class="hljs-comment">/* Get the len most significant bits. */</span><font></font>
                sym_idx = d-&gt;offset_first_sym_idx[len] + bits;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุชุนููุฏ ุงูููุช ููุนูููุฉ ุฎุทููุง ูููุง ูุชุนูู ุจุนุฏุฏ ุงูุจุชุงุช ูู ูููุงุช ุงูุดูุฑุฉ ุ ูููู ูุชู ุฅููุงู ุงูููุงู ุจููุงุกุฉ ุ ููุง ููุฒู ุณูู ุงูุชุญููู ูุงูููุงุฑูุฉ ูู ูู ุฎุทูุฉ ุ ูุจูุง ุฃู ูููุงุช ุงูุดูุฑุงุช ุงูุฃูุตุฑ ูู ุงูุฃูุซุฑ ุดููุนูุง ุ ุชุณูุญ ุงูุทุฑููุฉ ุจุชุญุณูู ุงูุถุบุท ูู ุงูุนุฏูุฏ ูู ุงูููุงูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฑูุฒ ูุญุฏุฉ ูู ุงูุชุฑููุฒ ุงููุงููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HUFFMAN_LOOKUP_TABLE_BITS 8  <span class="hljs-comment">/* Seems a good trade-off. */</span></span><font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_decoder_t</span> <span class="hljs-title">huffman_decoder_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_decoder_t</span> {</span>
        <span class="hljs-comment">/* Lookup table for fast decoding of short codewords. */</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
                <span class="hljs-keyword">uint16_t</span> sym : <span class="hljs-number">9</span>;  <span class="hljs-comment">/* Wide enough to fit the max symbol nbr. */</span>
                <span class="hljs-keyword">uint16_t</span> len : <span class="hljs-number">7</span>;  <span class="hljs-comment">/* 0 means no symbol. */</span>
        } table[<span class="hljs-number">1U</span> &lt;&lt; HUFFMAN_LOOKUP_TABLE_BITS];<font></font>
<font></font>
        <span class="hljs-comment">/* "Sentinel bits" value for each codeword length. */</span>
        <span class="hljs-keyword">uint16_t</span> sentinel_bits[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* First symbol index minus first codeword mod 2**16 for each length. */</span>
        <span class="hljs-keyword">uint16_t</span> offset_first_sym_idx[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* Map from symbol index to symbol. */</span>
        <span class="hljs-keyword">uint16_t</span> syms[MAX_HUFFMAN_SYMBOLS];
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span>
        <span class="hljs-keyword">size_t</span> num_syms;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Get the n least significant bits of x. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">lsb</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> x, <span class="hljs-keyword">int</span> n)</span>
</span>{<font></font>
        assert(n &gt;= <span class="hljs-number">0</span> &amp;&amp; n &lt;= <span class="hljs-number">63</span>);
        <span class="hljs-keyword">return</span> x &amp; (((<span class="hljs-keyword">uint64_t</span>)<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Use the decoder d to decode a symbol from the LSB-first zero-padded bits.
 * Returns the decoded symbol number or -1 if no symbol could be decoded.
 * *num_used_bits will be set to the number of bits used to decode the symbol,
 * or zero if no symbol could be decoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">huffman_decode</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">uint16_t</span> bits,
                                 <span class="hljs-keyword">size_t</span> *num_used_bits)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> lookup_bits;
        <span class="hljs-keyword">size_t</span> l;
        <span class="hljs-keyword">size_t</span> sym_idx;<font></font>
<font></font>
        <span class="hljs-comment">/* First try the lookup table. */</span><font></font>
        lookup_bits = lsb(bits, HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
        assert(lookup_bits &lt; <span class="hljs-keyword">sizeof</span>(d-&gt;table) / <span class="hljs-keyword">sizeof</span>(d-&gt;table[<span class="hljs-number">0</span>]));
        <span class="hljs-keyword">if</span> (d-&gt;table[lookup_bits].len != <span class="hljs-number">0</span>) {<font></font>
                assert(d-&gt;table[lookup_bits].len &lt;= HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
                assert(d-&gt;table[lookup_bits].sym &lt; d-&gt;num_syms);<font></font>
<font></font>
                *num_used_bits = d-&gt;table[lookup_bits].len;<font></font>
                <span class="hljs-keyword">return</span> d-&gt;table[lookup_bits].sym;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Then do canonical decoding with the bits in MSB-first order. */</span><font></font>
        bits = reverse16(bits, MAX_HUFFMAN_BITS);<font></font>
        <span class="hljs-keyword">for</span> (l = HUFFMAN_LOOKUP_TABLE_BITS + <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {
                <span class="hljs-keyword">if</span> (bits &lt; d-&gt;sentinel_bits[l]) {<font></font>
                        bits &gt;&gt;= MAX_HUFFMAN_BITS - l;<font></font>
<font></font>
                        sym_idx = (<span class="hljs-keyword">uint16_t</span>)(d-&gt;offset_first_sym_idx[l] + bits);<font></font>
                        assert(sym_idx &lt; d-&gt;num_syms);<font></font>
<font></font>
                        *num_used_bits = l;<font></font>
                        <span class="hljs-keyword">return</span> d-&gt;syms[sym_idx];<font></font>
                }<font></font>
        }<font></font>
<font></font>
        *num_used_bits = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชููุฆุฉ ูููู ุงูุชุดููุฑ ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุญุณุจ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุดูุฑุงุช ุงูุฃุณุงุณูุฉ ูุณุจููุง ุ ูุซู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">huffman_encoder_init</font></a><font style="vertical-align: inherit;"> ุ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ููููุฃ</font></a><font style="vertical-align: inherit;"> ุฌุฏุงูู ูุฎุชููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Initialize huffman decoder d for a code defined by the n codeword lengths.
   Returns false if the codeword lengths do not correspond to a valid prefix
   code. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">huffman_decoder_init</span><span class="hljs-params">(<span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                          <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint16_t</span> count[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">uint16_t</span> code[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint32_t</span> s;
        <span class="hljs-keyword">uint16_t</span> sym_idx[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">int</span> l;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span><font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        d-&gt;num_syms = n;<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
        <span class="hljs-comment">/* Zero-initialize the lookup table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(d-&gt;table) / <span class="hljs-keyword">sizeof</span>(d-&gt;table[<span class="hljs-number">0</span>]); i++) {<font></font>
                d-&gt;table[i].len = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Count the number of codewords of each length. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                assert(lengths[i] &lt;= MAX_HUFFMAN_BITS);<font></font>
                count[lengths[i]]++;<font></font>
        }<font></font>
        count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  <span class="hljs-comment">/* Ignore zero-length codewords. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Compute sentinel_bits and offset_first_sym_idx for each length. */</span>
        code[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<font></font>
        sym_idx[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {
                <span class="hljs-comment">/* First canonical codeword of this length. */</span>
                code[l] = (<span class="hljs-keyword">uint16_t</span>)((code[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (count[l] != <span class="hljs-number">0</span> &amp;&amp; code[l] + count[l] - <span class="hljs-number">1</span> &gt; (<span class="hljs-number">1U</span> &lt;&lt; l) - <span class="hljs-number">1</span>) {
                        <span class="hljs-comment">/* The last codeword is longer than l bits. */</span>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                s = (<span class="hljs-keyword">uint32_t</span>)((code[l] + count[l]) &lt;&lt; (MAX_HUFFMAN_BITS - l));<font></font>
                d-&gt;sentinel_bits[l] = (<span class="hljs-keyword">uint16_t</span>)s;<font></font>
                assert(d-&gt;sentinel_bits[l] == s &amp;&amp; <span class="hljs-string">"No overflow."</span>);<font></font>
<font></font>
                sym_idx[l] = sym_idx[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>];<font></font>
                d-&gt;offset_first_sym_idx[l] = sym_idx[l] - code[l];<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Build mapping from index to symbol and populate the lookup table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                l = lengths[i];<font></font>
                <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                d-&gt;syms[sym_idx[l]] = (<span class="hljs-keyword">uint16_t</span>)i;<font></font>
                sym_idx[l]++;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l &lt;= HUFFMAN_LOOKUP_TABLE_BITS) {<font></font>
                        table_insert(d, i, l, code[l]);<font></font>
                        code[l]++;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">table_insert</span><span class="hljs-params">(<span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">size_t</span> sym, <span class="hljs-keyword">int</span> len,
                         <span class="hljs-keyword">uint16_t</span> codeword)</span>
</span>{
        <span class="hljs-keyword">int</span> pad_len;
        <span class="hljs-keyword">uint16_t</span> padding, index;<font></font>
<font></font>
        assert(len &lt;= HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
<font></font>
        codeword = reverse16(codeword, len); <span class="hljs-comment">/* Make it LSB-first. */</span><font></font>
        pad_len = HUFFMAN_LOOKUP_TABLE_BITS - len;<font></font>
<font></font>
        <span class="hljs-comment">/* Pad the pad_len upper bits with all bit combinations. */</span>
        <span class="hljs-keyword">for</span> (padding = <span class="hljs-number">0</span>; padding &lt; (<span class="hljs-number">1U</span> &lt;&lt; pad_len); padding++) {<font></font>
                index = (<span class="hljs-keyword">uint16_t</span>)(codeword | (padding &lt;&lt; len));<font></font>
                d-&gt;table[index].sym = (<span class="hljs-keyword">uint16_t</span>)sym;<font></font>
                d-&gt;table[index].len = (<span class="hljs-keyword">uint16_t</span>)len;<font></font>
<font></font>
                assert(d-&gt;table[index].sym == sym &amp;&amp; <span class="hljs-string">"Fits in bitfield."</span>);<font></font>
                assert(d-&gt;table[index].len == len &amp;&amp; <span class="hljs-string">"Fits in bitfield."</span>);<font></font>
        }<font></font>
}<font></font>
</code></pre><br>
<a name="10"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุบ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎูุงุฑุฒููุฉ ุงูุงูููุงุด ุ ุงูููุฏูุฉ ูู PKZip 2.04c ูู ุนุงู 1993 ุ ูู ุทุฑููุฉ ุถุบุท ููุงุณูุฉ ูู ูููุงุช Zip ุงูุญุฏูุซุฉ. </font><font style="vertical-align: inherit;">ูุชู ุงุณุชุฎุฏุงูู ุฃูุถูุง ูู gzip ู PNG ูุงูุนุฏูุฏ ูู ุงูุชูุณููุงุช ุงูุฃุฎุฑู. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูุฒูุฌูุง ูู ุถุบุท LZ77 ูุชุฑููุฒ ููููุงู ุ ูุงูุฐู ุณููุงูุดู ููููุฐู ูู ูุฐุง ุงููุณู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจู ุงูููุงุด ุ ุงุณุชุฎุฏู PKZip ุทุฑู ุงูุถุบุท Shrink ู Reduce ู Implode. </font><font style="vertical-align: inherit;">ุงูููู ุฃุตุจุญุช ูุงุฏุฑุฉ ุ ุนูู ุงูุฑุบู ูู ุฃู Deflate ูุงูุช ูุง ุชุฒุงู ุชุณุชุฎุฏู ูุจุนุถ ุงูููุช ุ ูุฃููุง ุชุณุชููู ุฐุงูุฑุฉ ุฃูู. </font><font style="vertical-align: inherit;">ููููุง ูู ููุธุฑ ูููุง.</font></font><br>
<br>
<a name="11"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏููุงุช ุจุช</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู Deflate ุจุชุฎุฒูู ูููุงุช ููุฏูุงู ุงูุดูุฑูุฉ ูู ุชุฏูู ุจุชุงุช ููููุง ููุจุฏุฃ LSB-first. ููุฐุง ูุนูู ุฃูู ูุชู ุชุฎุฒูู ุงูุจุชุฉ ุงูุฃููู ูู ุงูุฏูู ูู ุงูุจุชุฉ ุงูุฃูู ุฏูุงูุฉ ูู ุงูุจุงูุช ุงูุฃูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุถุน ูู ุงุนุชุจุงุฑู ุชุฏูู ุงูุจุช (ุงูุฑุฃ ูู ุงููุณุงุฑ ุฅูู ุงููููู) 1-0-0-1-1. ุนูุฏูุง ูุชู ุชุฎุฒูููุง ููููุง ููุจุฏุฃ LSB ุงูุฃูู ุ ุชุตุจุญ ูููุฉ ุงูุจุงูุช 0b00011001 (ุซูุงุฆู) ุฃู 0x19 (ุณุฏุงุณู ุนุดุฑู). ูุฏ ูุจุฏู ุฃู ุงูุฏูู ููุซู ุจุจุณุงุทุฉ ุฅูู ุงููุฑุงุก (ุจูุนูู ูุง ุ) ุ ูููู ุงูููุฒุฉ ูู ุฃูู ูู ุงูุฃุณูู ุจุงููุณุจุฉ ููุง ุงูุญุตูู ุนูู ุฃูู ุจุช N ูู ูููุฉ ุงูููุจููุชุฑ: ูุญู ุจุจุณุงุทุฉ ูุฎูู ุงูุจุชุงุช ุงูุฃูู ุฃูููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุคุฎุฐ ูุฐู ุงูุฅุฌุฑุงุกุงุช ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bitstream.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Input bitstream. */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">istream_t</span> <span class="hljs-title">istream_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">istream_t</span> {</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src;  <span class="hljs-comment">/* Source bytes. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *end;  <span class="hljs-comment">/* Past-the-end byte of src. */</span>
        <span class="hljs-keyword">size_t</span> bitpos;       <span class="hljs-comment">/* Position of the next bit to read. */</span>
        <span class="hljs-keyword">size_t</span> bitpos_end;   <span class="hljs-comment">/* Position of past-the-end bit. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize an input stream to present the n bytes from src as an LSB-first
 * bitstream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">istream_init</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        is-&gt;src = src;<font></font>
        is-&gt;end = src + n;<font></font>
        is-&gt;bitpos = <span class="hljs-number">0</span>;<font></font>
        is-&gt;bitpos_end = n * <span class="hljs-number">8</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชุงุฌ ูููู ุชุดููุฑ Huffman ุฅูู ุงููุธุฑ ูู ุงูุจุชุงุช ุงูุชุงููุฉ ูู ุงูุฏูู (ุจุชุงุช ูุงููุฉ ูุฃุทูู ูููุฉ ูุดูุฑุฉ ููููุฉ) ุ ุซู ูุชุงุจุนุฉ ุงูุฏูู ุจุนุฏุฏ ุงูุจุชุงุช ุงูุชู ูุณุชุฎุฏููุง ุงูุฑูุฒ ุงูุฐู ุชู ูู ุชุฑููุฒู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ISTREAM_MIN_BITS (64 - 7)</span><font></font>
<font></font>
<span class="hljs-comment">/* Get the next bits from the input stream. The number of bits returned is
 * between ISTREAM_MIN_BITS and 64, depending on the position in the stream, or
 * fewer if the end of stream is reached. The upper bits are zero-padded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">istream_bits</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">istream_t</span> *is)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *next;
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
        next = is-&gt;src + (is-&gt;bitpos / <span class="hljs-number">8</span>);<font></font>
<font></font>
        assert(next &lt;= is-&gt;end &amp;&amp; <span class="hljs-string">"Cannot read past end of stream."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (is-&gt;end - next &gt;= <span class="hljs-number">8</span>) {
                <span class="hljs-comment">/* Common case: read 8 bytes in one go. */</span><font></font>
                bits = read64le(next);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">/* Read the available bytes and zero-pad. */</span>
                bits = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; is-&gt;end - next; i++) {<font></font>
                        bits |= (<span class="hljs-keyword">uint64_t</span>)next[i] &lt;&lt; (i * <span class="hljs-number">8</span>);<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> bits &gt;&gt; (is-&gt;bitpos % <span class="hljs-number">8</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Advance n bits in the bitstream if possible. Returns false if that many bits
 * are not available in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">istream_advance</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">size_t</span> n)</span> </span>{
        <span class="hljs-keyword">if</span> (is-&gt;bitpos + n &gt; is-&gt;bitpos_end) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        is-&gt;bitpos += n;<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎูุงุตุฉ ุงูููู ูู ุฃูู ุนูู ุงูุฃุฌูุฒุฉ ุฐุงุช 64 ุจุช ุ </font></font><code>istream_bits</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุนุงุฏุฉู ุชูููุฐูุง ูุฅุฑุดุงุฏุงุช ุชูููุฏ ูุงุญุฏ ูุจุนุถ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุ ูุธุฑูุง ูุฃู ุนูุงุตุฑ ุงููููู </font></font><code>istream_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฌูุฏุฉ ูู ุงูุณุฌูุงุช. </font><font style="vertical-align: inherit;">ูุชู ุชูููุฐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">read64le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">bits.h</font></a><font style="vertical-align: inherit;"> (ูููู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุงููุชุฑุฌููู</font></a><font style="vertical-align: inherit;"> ุงูุญุฏูุซูู ุจุชุญูููู ุฅูู ุชูุฒูู 64 ุจุช ูุงุญุฏ ุจุงุณุชุฎุฏุงู ูุจุฏุฃ endian ุงูุตุบูุฑ):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Read a 64-bit value from p in little-endian byte order. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">read64le</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p)</span>
</span>{
        <span class="hljs-comment">/* The one true way, see
         * https://commandcenter.blogspot.com/2012/04/byte-order-fallacy.html */</span>
        <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">0</span>)  |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>)  |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">32</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">5</span>] &lt;&lt; <span class="hljs-number">40</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">6</span>] &lt;&lt; <span class="hljs-number">48</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">7</span>] &lt;&lt; <span class="hljs-number">56</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชุงุฌ ุฃูุถูุง ุฅูู ูุธููุฉ ููุชุงุจุนุฉ ุชุฏูู ุงูุจุชุงุช ุญุชู ุญุฏูุฏ ุงูุจุงูุช ุงูุชุงูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Round x up to the next multiple of m, which must be a power of 2. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">round_up</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> x, <span class="hljs-keyword">size_t</span> m)</span>
</span>{<font></font>
        assert((m &amp; (m - <span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">"m must be a power of two"</span>);
        <span class="hljs-keyword">return</span> (x + m - <span class="hljs-number">1</span>) &amp; (<span class="hljs-keyword">size_t</span>)(-m); <span class="hljs-comment">/* Hacker's Delight (2nd), 3-1. */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Align the input stream to the next 8-bit boundary and return a pointer to
 * that byte, which may be the past-the-end-of-stream byte. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">istream_byte_align</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *byte;<font></font>
<font></font>
        assert(is-&gt;bitpos &lt;= is-&gt;bitpos_end &amp;&amp; <span class="hljs-string">"Not past end of stream."</span>);<font></font>
<font></font>
        is-&gt;bitpos = round_up(is-&gt;bitpos, <span class="hljs-number">8</span>);<font></font>
        byte = is-&gt;src + is-&gt;bitpos / <span class="hljs-number">8</span>;<font></font>
        assert(byte &lt;= is-&gt;end);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> byte;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุณุจุฉ ูุชุฏูู ุงูุจุชุงุช ุงูุตุงุฏุฑุฉ ุ ููุชุจ ุงูุจุชุงุช ุจุงุณุชุฎุฏุงู ุนูููุฉ ูุฑุงุกุฉ - ุชุนุฏูู - ูุชุงุจุฉ. </font><font style="vertical-align: inherit;">ูู ุงูุญุงูุฉ ุงูุณุฑูุนุฉ ุ ููููู ุงููุชุงุจุฉ ููููุงู ุจุงุณุชุฎุฏุงู ูุฑุงุกุฉ 64 ุจุช ุ ูููุน ูู ุนูููุงุช ุงูุจุช ุ ููุชุงุจุฉ 64 ุจุช.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output bitstream. */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ostream_t</span> <span class="hljs-title">ostream_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ostream_t</span> {</span>
        <span class="hljs-keyword">uint8_t</span> *dst;
        <span class="hljs-keyword">uint8_t</span> *end;
        <span class="hljs-keyword">size_t</span> bitpos;
        <span class="hljs-keyword">size_t</span> bitpos_end;<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize an output stream to write LSB-first bits into dst[0..n-1]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ostream_init</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os, <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        os-&gt;dst = dst;<font></font>
        os-&gt;end = dst + n;<font></font>
        os-&gt;bitpos = <span class="hljs-number">0</span>;<font></font>
        os-&gt;bitpos_end = n * <span class="hljs-number">8</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Get the current bit position in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">ostream_bit_pos</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">ostream_t</span> *os)</span>
</span>{
        <span class="hljs-keyword">return</span> os-&gt;bitpos;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Return the number of bytes written to the output buffer. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">ostream_bytes_written</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os)</span>
</span>{
        <span class="hljs-keyword">return</span> round_up(os-&gt;bitpos, <span class="hljs-number">8</span>) / <span class="hljs-number">8</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Write n bits to the output stream. Returns false if there is not enough room
 * at the destination. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ostream_write</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os, <span class="hljs-keyword">uint64_t</span> bits, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint64_t</span> x;
        <span class="hljs-keyword">int</span> shift, i;<font></font>
<font></font>
        assert(n &lt;= <span class="hljs-number">57</span>);<font></font>
        assert(bits &lt;= ((<span class="hljs-keyword">uint64_t</span>)<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-string">"Must fit in n bits."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (os-&gt;bitpos_end - os-&gt;bitpos &lt; n) {
                <span class="hljs-comment">/* Not enough room. */</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;os-&gt;dst[os-&gt;bitpos / <span class="hljs-number">8</span>];<font></font>
        shift = os-&gt;bitpos % <span class="hljs-number">8</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (os-&gt;end - p &gt;= <span class="hljs-number">8</span>) {
                <span class="hljs-comment">/* Common case: read and write 8 bytes in one go. */</span><font></font>
                x = read64le(p);<font></font>
                x = lsb(x, shift);<font></font>
                x |= bits &lt;&lt; shift;<font></font>
                write64le(p, x);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">/* Slow case: read/write as many bytes as are available. */</span>
                x = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; os-&gt;end - p; i++) {<font></font>
                        x |= (<span class="hljs-keyword">uint64_t</span>)p[i] &lt;&lt; (i * <span class="hljs-number">8</span>);<font></font>
                }<font></font>
                x = lsb(x, shift);<font></font>
                x |= bits &lt;&lt; shift;<font></font>
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; os-&gt;end - p; i++) {<font></font>
                        p[i] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; (i * <span class="hljs-number">8</span>));<font></font>
                }<font></font>
        }<font></font>
<font></font>
        os-&gt;bitpos += n;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Write a 64-bit value x to dst in little-endian byte order. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write64le</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">uint64_t</span> x)</span>
</span>{<font></font>
        dst[<span class="hljs-number">0</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">0</span>);<font></font>
        dst[<span class="hljs-number">1</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">8</span>);<font></font>
        dst[<span class="hljs-number">2</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">16</span>);<font></font>
        dst[<span class="hljs-number">3</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">24</span>);<font></font>
        dst[<span class="hljs-number">4</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">32</span>);<font></font>
        dst[<span class="hljs-number">5</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">40</span>);<font></font>
        dst[<span class="hljs-number">6</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">48</span>);<font></font>
        dst[<span class="hljs-number">7</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">56</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชุงุฌ ุฃูุถูุง ุฅูู ูุชุงุจุฉ ูุญุฏุงุช ุงูุจุงูุช ุจููุงุกุฉ ุฅูู ุงูุฏูู. </font><font style="vertical-align: inherit;">ุจุงูุทุจุน ุ ููููู ุชูููุฐ ุชุณุฌููุงุช 8 ุจุช ุจุดูู ูุชูุฑุฑ ุ ูููู ุณูููู ุงุณุชุฎุฏุงููุง ุฃุณุฑุน </font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Align the bitstream to the next byte boundary, then write the n bytes from
   src to it. Returns false if there is not enough room in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ostream_write_bytes_aligned</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os,
                                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src,
                                               <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">if</span> (os-&gt;bitpos_end - round_up(os-&gt;bitpos, <span class="hljs-number">8</span>) &lt; n * <span class="hljs-number">8</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        os-&gt;bitpos = round_up(os-&gt;bitpos, <span class="hljs-number">8</span>);
        <span class="hljs-built_in">memcpy</span>(&amp;os-&gt;dst[os-&gt;bitpos / <span class="hljs-number">8</span>], src, n);<font></font>
        os-&gt;bitpos += n * <span class="hljs-number">8</span>;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="12"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฑูุบ (ุงูุชุถุฎู)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุฃู ุฎูุงุฑุฒููุฉ ุงูุถุบุท ุชุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุงูููุงุด</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุงูููุฎ ุ ูุงุณุชุฎุฑุงุฌ ุงูููุงุก ูู ุดูุก ูุง - ุชุณูู ุนูููุฉ ุงูุชูุฑูุบ ุฃุญูุงููุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุชุถุฎู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฅุฐุง ุฏุฑุณุช ูุฐู ุงูุนูููุฉ ูุฃูู ูุฑุฉ ุ ูุณูู ูููู ููู ูุนูู ุงูุชูุณูู. </font><font style="vertical-align: inherit;">ุชุณุชุทูุน ุฃู ุชุฑู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุงูุฌุฒุก ุงูุฃูู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deflate.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deflate.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bits.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tables.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tables.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generate_tables.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช ุงููุถุบูุทุฉ ุจุงุณุชุฎุฏุงู Deflate ูุณูุณูุฉ ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชู.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุชุจุฏุฃ ูู ูุฏุฑุฉ ุจุฑุฃุณ 3 ุจุช ุ ุญูุซ ูุชู ุชุนููู ุงูุจุช ุงูุฃูู (ุงูุฃูู ุฃูููุฉ) ุฅุฐุง ูุงูุช ูุฐู ูู ุงููุชูุฉ ุงูููุงุฆูุฉ ููุณูุณูุฉ ุ ูุชุดูุฑ ุงูุจุชุชุงู ุงูุฃุฎุฑูุงู ุฅูู ููุนูุง.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/875/b36/1fd/875b361fd3414431d2a20d1ab0b6ef8b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุซูุงุซุฉ ุฃููุงุน ูู ุงููุชู: ุบูุฑ ูุถุบูุท (0) ุ ูุถุบูุท ุจุงุณุชุฎุฏุงู ุฑููุฒ Huffman ุงูุซุงุจุชุฉ (1) ุ ููุถุบูุท ุจุงุณุชุฎุฏุงู ุฑููุฒ Huffman "ุฏููุงููููุฉ" (2). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐ ูุฐุง ุงูููุฏ ุงูุชูุฑูุบ ุจุงุณุชุฎุฏุงู ูุธุงุฆู ูุณุงุนุฏุฉ ูุฃููุงุน ูุฎุชููุฉ ูู ุงููุชู ุ ูุงูุชู ุณูููู ุจุชูููุฐูุง ูุงุญููุง:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> {<font></font>
        HWINF_OK,   <span class="hljs-comment">/* Inflation was successful. */</span>
        HWINF_FULL, <span class="hljs-comment">/* Not enough room in the output buffer. */</span>
        HWINF_ERR   <span class="hljs-comment">/* Error in the input data. */</span>
} <span class="hljs-keyword">inf_stat_t</span>;<font></font>
<font></font>
<span class="hljs-comment">/* Decompress (inflate) the Deflate stream in src. The number of input bytes
   used, at most src_len, is stored in *src_used on success. Output is written
   to dst. The number of bytes written, at most dst_cap, is stored in *dst_used
   on success. src[0..src_len-1] and dst[0..dst_cap-1] must not overlap.
   Returns a status value as defined above. */</span>
<span class="hljs-function"><span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">hwinflate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len, <span class="hljs-keyword">size_t</span> *src_used,
                     <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_used)</span>
</span>{
        <span class="hljs-keyword">istream_t</span> is;
        <span class="hljs-keyword">size_t</span> dst_pos;
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">bool</span> bfinal;
        <span class="hljs-keyword">inf_stat_t</span> s;<font></font>
<font></font>
        istream_init(&amp;is, src, src_len);<font></font>
        dst_pos = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">do</span> {
                <span class="hljs-comment">/* Read the 3-bit block header. */</span><font></font>
                bits = istream_bits(&amp;is);<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(&amp;is, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                bfinal = bits &amp; <span class="hljs-number">1</span>;<font></font>
                bits &gt;&gt;= <span class="hljs-number">1</span>;<font></font>
<font></font>
                <span class="hljs-keyword">switch</span> (lsb(bits, <span class="hljs-number">2</span>)) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">/* 00: No compression. */</span><font></font>
                        s = inf_noncomp_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">/* 01: Compressed with fixed Huffman codes. */</span><font></font>
                        s = inf_fixed_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">/* 10: Compressed with "dynamic" Huffman codes. */</span><font></font>
                        s = inf_dyn_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>: <span class="hljs-comment">/* Invalid block type. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (s != HWINF_OK) {
                        <span class="hljs-keyword">return</span> s;<font></font>
                }<font></font>
        } <span class="hljs-keyword">while</span> (!bfinal);<font></font>
<font></font>
        *src_used = (<span class="hljs-keyword">size_t</span>)(istream_byte_align(&amp;is) - src);<font></font>
<font></font>
        assert(dst_pos &lt;= dst_cap);<font></font>
        *dst_used = dst_pos;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="13"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ููุฑุบุฉ ุบูุฑ ูุถุบูุทุฉ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ูู ูุชู "ุงููุฎุฒูุฉ" ุ ุฃุจุณุท ููุน. </font><font style="vertical-align: inherit;">ููุจุฏุฃ ุจุงูุญุฏูุฏ ุงูุชุงููุฉ ุงูููููุฉ ูู 8 ุจุชุฉ ูู ุชุฏูู ุงูุจุชุงุช ุจูููุฉ ูู 16 ุจุช (len) ุชุฏู ุนูู ุทูู ุงููุชูุฉ. </font><font style="vertical-align: inherit;">ุฎูููุง ูููุฉ ุฃุฎุฑู ูู 16 ุจุช (nlen) ุ ูุงูุชู ุชููู (ูุชู ุนูุณ ุชุฑุชูุจ ุงูุจุชุงุช) ูู ุงููููุงุช len. </font><font style="vertical-align: inherit;">ูู ุงูููุชุฑุถ ุฃู nlen ูุนูู ููุฌููุน ุชุฏููู ุจุณูุท: ุฅุฐุง ูุงู ุงูููู ุชุงูููุง ุ ููู ุงููุญุชูู ุฃูุง ุชููู ุงูููู ููููุฉ ูุณูุชููู ุงูุจุฑูุงูุฌ ูู ุงูุชุดุงู ุงูุฎุทุฃ.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0e1/eb8/15b/0e1eb815b2dfec1edb50eeafd1291cc5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ len ู nlen ุจูุงูุงุช ุบูุฑ ูุถุบูุทุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุทูู ุงููุชูุฉ ูู ูููุฉ 16 ุจุช ุ ูุฅู ุญุฌู ุงูุจูุงูุงุช ููุชุตุฑ ุนูู 65535 ุจุงูุช.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_noncomp_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                    <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint16_t</span> len, nlen;<font></font>
<font></font>
        p = istream_byte_align(is);<font></font>
<font></font>
        <span class="hljs-comment">/* Read len and nlen (2 x 16 bits). */</span>
        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">32</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* Not enough input. */</span><font></font>
        }<font></font>
        len  = read16le(p);<font></font>
        nlen = read16le(p + <span class="hljs-number">2</span>);<font></font>
        p += <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (nlen != (<span class="hljs-keyword">uint16_t</span>)~len) {
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!istream_advance(is, len * <span class="hljs-number">8</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* Not enough input. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (dst_cap - *dst_pos &lt; len) {
                <span class="hljs-keyword">return</span> HWINF_FULL; <span class="hljs-comment">/* Not enough room to output. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">memcpy</span>(&amp;dst[*dst_pos], p, len);<font></font>
        *dst_pos += len;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="14"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุบ ุงููุชู ุจุงุณุชุฎุฏุงู ุฑููุฒ ููููุงู ุงูุซุงุจุชุฉ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุณุชุฎุฏู ูุชู ุงูุงูููุงุด ุงููุถุบูุทุฉ ููุฏ Huffman ูุชูุซูู ุณูุณูุฉ ูู LZ77. </font><font style="vertical-align: inherit;">ูุชู ูุณุฑ ุงูุฑูุงุจุท ุงูุฎูููุฉ ุจุงุณุชุฎุฏุงู ุนูุงูุงุช ููุงูุฉ ุงููุชูุฉ. </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญุฑูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฃุทูุงู ุงูุฑูุงุจุท ุงูุฎูููุฉ ูุงูุนูุงูุงุช ุ ูุชู </font><i><font style="vertical-align: inherit;">ุงุณุชุฎุฏุงู</font></i><font style="vertical-align: inherit;"> ุฑูุฒ </font><i><font style="vertical-align: inherit;">litlen</font></i><font style="vertical-align: inherit;"> Huffman </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุจุงููุณุจุฉ ููุณุงูุงุช ุงููุตูุงุช ุงูุฎูููุฉ ุ ูุชู ุงุณุชุฎุฏุงู ููุฏ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c35/0e1/a8c/c350e1a8c73f69203949ccc534141497.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฑููุฒ Litlen ุงูููู ูู ุงููุทุงู 0-285. </font><font style="vertical-align: inherit;">ุชูุณุชุฎุฏู ุงูููู 0-255 ููุจุงูุชุงุช ุงูุญุฑููุฉ ุ ู 256 ูู ุนูุงูุฉ ููุงูุฉ ุงููุชูุฉ ุ ู 257-285 ุชุณุชุฎุฏู ูุฃุทูุงู ุงููุตูุงุช ุงูุฎูููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูุบ ุทูู ุงูุฑูุงุจุท ุงูุฎูููุฉ 3-258 ุจุงูุช. </font><font style="vertical-align: inherit;">ุชุญุฏุฏ ูููุฉ Litlen ุงูุทูู ุงูุฃุณุงุณู ุงูุฐู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุถุงู ุฅููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุตูุฑ </font><i><font style="vertical-align: inherit;">ุจุชุงุช ุฅุถุงููุฉ</font></i><font style="vertical-align: inherit;"> ุฃู ุฃูุซุฑ ูู ุงูุฏูู </font><font style="vertical-align: inherit;">ููุญุตูู ุนูู ุงูุทูู ุงููุงูู ููููุง ููุฌุฏูู ุฃุฏูุงู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุชุนูู ูููุฉ litlen 269 ุทูููุง ุฃุณุงุณููุง ูุจูุบ 19 ููุทุนุชูู ุฅุถุงููุชูู. </font><font style="vertical-align: inherit;">ุฅุถุงูุฉ ูุทุนุชูู ูู ุงูุชูุงุฑ ุชุนุทู ุงูุทูู ุงูููุงุฆู ูู 19 ุฅูู 22.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชููู</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุชุงุช ุฅุถุงููุฉ</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุทูุงู</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">258</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">259</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">260</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">261</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">262</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">263</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">264</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">265</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11-12</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">266</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13-14</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">267</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15-16</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">268</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17-18</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">269</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19-22</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">270</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23-26</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">271</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27-30</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">272</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">31-34</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">273</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35-42</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">274</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">43-50</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">275</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">51-58</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">276</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">59-66</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">277</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">67-82</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">278</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">83-98</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">279</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99-114</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">280</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">115-130</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">281</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">131-162</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">282</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">163-194</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">283</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">195โ226</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">284</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">227-257</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">285</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">258</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฑุฌู ููุงุญุธุฉ ุฃู ูููุฉ litlen 284 ุจุงูุฅุถุงูุฉ ุฅูู 5 ุจุชุงุช ุฅุถุงููุฉ ูููู ุฃู ุชูุซู ุฃุทูุงููุง ูู 227 ุฅูู 258 ุ ููุน ุฐูู ุ ุชูุต ุงูููุงุตูุงุช ุนูู ุฃูู ูุฌุจ ุชูุซูู ุงูุทูู 258 - ุงูุญุฏ ุงูุฃูุตู ูุทูู ุงููุตูุฉ ุงูุฎูููุฉ - ุจุงุณุชุฎุฏุงู ูููุฉ litlen ูููุตูุฉ. </font><font style="vertical-align: inherit;">ูู ุงูููุชุฑุถ ุฃู ูุคุฏู ุฐูู ุฅูู ุชูููู ุงูุชุฑููุฒ ูู ุงูููุงูู ุงูุชู ุบุงูุจูุง ูุง ุชุชู ูููุง ููุงุฌูุฉ ุงูุญุฏ ุงูุฃูุตู ููุทูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณุชุฎุฏู ุจุฑูุงูุฌ ูู ุงูุถุบุท ุงูุฌุฏูู ููุญุตูู ุนูู ุงูุทูู ุงูุฃุณุงุณู ูุงูุจุชุงุช ุงูุฅุถุงููุฉ ูู ูููุฉ litlen (ูุงูุต 257):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Table of litlen symbol values minus 257 with corresponding base length
   and number of extra bits. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">litlen_tbl_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> base_len : <span class="hljs-number">9</span>;
        <span class="hljs-keyword">uint16_t</span> ebits : <span class="hljs-number">7</span>;<font></font>
};<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">litlen_tbl_t</span> <span class="hljs-title">litlen_tbl</span>[29] = {</span>
<span class="hljs-comment">/* 257 */</span> { <span class="hljs-number">3</span>, <span class="hljs-number">0</span> },
<span class="hljs-comment">/* 258 */</span> { <span class="hljs-number">4</span>, <span class="hljs-number">0</span> },<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 284 */</span> { <span class="hljs-number">227</span>, <span class="hljs-number">5</span> },
<span class="hljs-comment">/* 285 */</span> { <span class="hljs-number">258</span>, <span class="hljs-number">0</span> }<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนุฏ ุฑูุฒ Litlen ุงูุซุงุจุช ูู Huffman ุฃูุฑูุง ุฃุณุงุณููุง ููุณุชุฎุฏู ุฃุทูุงู ูููุงุช ุงูุดูุฑุฉ ุงูุชุงููุฉ (286-287 ููุณุช ููููุง ุตุงูุญุฉ ูู litlen ุ ูููููุง ูุชูุฑุทุฉ ูู ุฅูุดุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ):</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู Litlen</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูู ูููุฉ ุงูุณุฑ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-143</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">144-255</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">256-279</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">280โ287</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุฑูุงูุฌ ูู ุงูุถุบุท ุจุชุฎุฒูู ูุฐู ุงูุฃุทูุงู ูู ุฌุฏูู ููุงุณุจ ููุฅุฑุณุงู ุฅูู </font></font><code>huffman_decoder_init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> fixed_litlen_lengths[<span class="hljs-number">288</span>] = {
<span class="hljs-comment">/*   0 */</span> <span class="hljs-number">8</span>,
<span class="hljs-comment">/*   1 */</span> <span class="hljs-number">8</span>,<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 287 */</span> <span class="hljs-number">8</span>,<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฎุชูู ูุณุงูุงุช ุงููุตูุฉ ุงูุฎูููุฉ ูู 1 ุฅูู 32ุ768 ุ ููุชู ุชุดููุฑูุง ุจุงุณุชุฎุฏุงู ูุฎุทุท ูุดุงุจู ููุฎุทุท ุชุดููุฑ ุงูุทูู. </font><font style="vertical-align: inherit;">ูุนูู ููุฏ ููููุงู ุนูู ุชุดููุฑ ุงูููู ูู 0 ุฅูู 29 ุ ููู ูููุง ูุชูุงูู ูุน ุทูู ุงููุงุนุฏุฉ ุ ูุงูุชู ุชุถุงู ุฅูููุง ุจุชุงุช ุฅุถุงููุฉ ููุญุตูู ุนูู ุงููุณุงูุฉ ุงูููุงุฆูุฉ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญู</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุชุงุช ุฅุถุงููุฉ</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณุงูุงุช</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5-6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7-8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9-12</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13-16</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17-24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25-32</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">33-48</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุญุฏ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">49-64</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">65-96</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซูุงุซุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">97-128</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">129-192</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุณุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">193-256</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุณุงุฏุณ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257-384</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">385-512</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุซุงููุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">513-768</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณุนุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">769-1024</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุดุฑูู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1025-1536</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1537-2048</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2049-3072</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3073-4096</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุญุฏ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4097-6144</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุญุฏ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6145-8192</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8193-12288</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12289-16384</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซูุงุซุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16385-24576</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุงุณุน ูุงูุนุดุฑูู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซูุงุซุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24577โ32768</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนุฏ ุฑูุฒ Huffman ุงูุซุงุจุช ูู ุฃูุฑูุง ูุงูููููุง. </font><font style="vertical-align: inherit;">ุฌููุน ูููุงุช ุงูุชุดููุฑ ูู 5 ุจุช. </font><font style="vertical-align: inherit;">ุฅูู ุจุณูุท ุ ูููู ุจุฑูุงูุฌ ูู ุงูุถุบุท ุจุชุฎุฒูู ุงูุฑููุฒ ูู ุฌุฏูู ูููู ุงุณุชุฎุฏุงูู ูุน </font></font><code>huffman_decoder_init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ููู dist 30-31 ุบูุฑ ุตุญูุญุฉ. ูุดุงุฑ ุฅูู ุฃููุง ูุชูุฑุทุฉ ูู ุชูููุฏ ุฑููุฒ Huffman ุ ูููู ููุณ ููุง ุฃู ุชุฃุซูุฑ ูู ุงููุงูุน):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> fixed_dist_lengths[<span class="hljs-number">32</span>] = {
<span class="hljs-comment">/*  0 */</span> <span class="hljs-number">5</span>,
<span class="hljs-comment">/*  1 */</span> <span class="hljs-number">5</span>,<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 31 */</span> <span class="hljs-number">5</span>,<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุถุบุท ุฃู ูู ุงูุชุบููู - ูู ุจูู ุงููุชูุฉ ุจุงุณุชุฎุฏุงู ุฃููุงุฏ ููููุงู ุงูุซุงุจุชุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_fixed_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                  <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">huffman_decoder_t</span> litlen_dec, dist_dec;<font></font>
<font></font>
        huffman_decoder_init(&amp;litlen_dec, fixed_litlen_lengths,<font></font>
                             <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths) /
                             <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths[<span class="hljs-number">0</span>]));<font></font>
        huffman_decoder_init(&amp;dist_dec, fixed_dist_lengths,<font></font>
                             <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths) /
                             <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths[<span class="hljs-number">0</span>]));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> inf_block(is, dst, dst_cap, dst_pos, &amp;litlen_dec, &amp;dist_dec);<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_EOB 256</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_MAX 285</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_TBL_OFFSET 257</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_LEN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_LEN 258</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DISTSYM_MAX 29</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_DISTANCE 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_DISTANCE 32768</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_cap,
                            <span class="hljs-keyword">size_t</span> *dst_pos,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *litlen_dec,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *dist_dec)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">size_t</span> used, used_tot, dist, len;
        <span class="hljs-keyword">int</span> litlen, distsym;
        <span class="hljs-keyword">uint16_t</span> ebits;<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">/* Read a litlen symbol. */</span><font></font>
                bits = istream_bits(is);<font></font>
                litlen = huffman_decode(litlen_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                used_tot = used;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (litlen &lt; <span class="hljs-number">0</span> || litlen &gt; LITLEN_MAX) {
                        <span class="hljs-comment">/* Failed to decode, or invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (litlen &lt;= UINT8_MAX) {
                        <span class="hljs-comment">/* Literal. */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">if</span> (*dst_pos == dst_cap) {
                                <span class="hljs-keyword">return</span> HWINF_FULL;<font></font>
                        }<font></font>
                        lz77_output_lit(dst, (*dst_pos)++, (<span class="hljs-keyword">uint8_t</span>)litlen);
                        <span class="hljs-keyword">continue</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (litlen == LITLEN_EOB) {
                        <span class="hljs-comment">/* End of block. */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* It is a back reference. Figure out the length. */</span><font></font>
                assert(litlen &gt;= LITLEN_TBL_OFFSET &amp;&amp; litlen &lt;= LITLEN_MAX);<font></font>
                len   = litlen_tbl[litlen - LITLEN_TBL_OFFSET].base_len;<font></font>
                ebits = litlen_tbl[litlen - LITLEN_TBL_OFFSET].ebits;<font></font>
                <span class="hljs-keyword">if</span> (ebits != <span class="hljs-number">0</span>) {<font></font>
                        len += lsb(bits, ebits);<font></font>
                        bits &gt;&gt;= ebits;<font></font>
                        used_tot += ebits;<font></font>
                }<font></font>
                assert(len &gt;= MIN_LEN &amp;&amp; len &lt;= MAX_LEN);<font></font>
<font></font>
                <span class="hljs-comment">/* Get the distance. */</span>
                distsym = huffman_decode(dist_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                used_tot += used;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (distsym &lt; <span class="hljs-number">0</span> || distsym &gt; DISTSYM_MAX) {
                        <span class="hljs-comment">/* Failed to decode, or invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                dist  = dist_tbl[distsym].base_dist;<font></font>
                ebits = dist_tbl[distsym].ebits;<font></font>
                <span class="hljs-keyword">if</span> (ebits != <span class="hljs-number">0</span>) {<font></font>
                        dist += lsb(bits, ebits);<font></font>
                        bits &gt;&gt;= ebits;<font></font>
                        used_tot += ebits;<font></font>
                }<font></font>
                assert(dist &gt;= MIN_DISTANCE &amp;&amp; dist &lt;= MAX_DISTANCE);<font></font>
<font></font>
                assert(used_tot &lt;= ISTREAM_MIN_BITS);<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Bounds check and output the backref. */</span>
                <span class="hljs-keyword">if</span> (dist &gt; *dst_pos) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (round_up(len, <span class="hljs-number">8</span>) &lt;= dst_cap - *dst_pos) {<font></font>
                        output_backref64(dst, *dst_pos, dist, len);<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len &lt;= dst_cap - *dst_pos) {<font></font>
                        lz77_output_backref(dst, *dst_pos, dist, len);<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> HWINF_FULL;<font></font>
                }<font></font>
                (*dst_pos) += len;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชุจู ุฅูู ูุฐุง ุงูุชุญุณูู: ุนูุฏูุง ูุง ุชููู ููุงู ูุณุงุญุฉ ูุงููุฉ ูู ุงููุฎุฒู ุงููุคูุช ุงูุตุงุฏุฑ ุ ูุตุฏุฑ ุฑูุงุจุท ุฎูููุฉ ุจุงุณุชุฎุฏุงู ุงููุธููุฉ ุฃุฏูุงู ุ ูุงูุชู ุชูุณุฎ 64 ุจุช ูู ุงููุฑุฉ ุงููุงุญุฏุฉ. </font><font style="vertical-align: inherit;">ูุฐุง "ููุถูู" ุจูุนูู ุฃูู ุบุงูุจูุง ูุง ููุณุฎ ุจุถุนุฉ ุจุงูุชุงุช ุฅุถุงููุฉ (ุญุชู ุงููุถุงุนู ุงูุชุงูู ูู 8). </font><font style="vertical-align: inherit;">ููููุง ุชุนูู ุจุดูู ุฃุณุฑุน </font></font><code>lz77_output_backref</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฃููุง ุชุชุทูุจ ุชูุฑุงุฑุงุช ุฏูุฑูุฉ ุฃูู ููุตูู ุฅูู ุงูุฐุงูุฑุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ุณูุชู ุงูุขู ูุนุงูุฌุฉ ุงูุฑูุงุจุท ุงูุฎูููุฉ ุงููุตูุฑุฉ ูู ุชูุฑุงุฑ ูุงุญุฏ ุ ููู ุฃูุฑ ุฌูุฏ ุฌุฏูุง ููุชูุจุค ุจุงููุฑูุน.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output the (dist,len) backref at dst_pos in dst using 64-bit wide writes.
   There must be enough room for len bytes rounded to the next multiple of 8. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">output_backref64</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos, <span class="hljs-keyword">size_t</span> dist,
                             <span class="hljs-keyword">size_t</span> len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint64_t</span> tmp;<font></font>
<font></font>
        assert(len &gt; <span class="hljs-number">0</span>);<font></font>
        assert(dist &lt;= dst_pos &amp;&amp; <span class="hljs-string">"cannot reference before beginning of dst"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (len &gt; dist) {
                <span class="hljs-comment">/* Self-overlapping backref; fall back to byte-by-byte copy. */</span><font></font>
                lz77_output_backref(dst, dst_pos, dist, len);<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">do</span> {
                <span class="hljs-built_in">memcpy</span>(&amp;tmp, &amp;dst[dst_pos - dist + i], <span class="hljs-number">8</span>);
                <span class="hljs-built_in">memcpy</span>(&amp;dst[dst_pos + i], &amp;tmp, <span class="hljs-number">8</span>);<font></font>
                i += <span class="hljs-number">8</span>;<font></font>
        } <span class="hljs-keyword">while</span> (i &lt; len);<font></font>
}<font></font>
</code></pre><br>
<a name="15"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฑุงุบ ุงููุชู ุจุงุณุชุฎุฏุงู ุฑููุฒ Huffman ุงูุฏููุงููููุฉ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุนูู ูุชู ุงูุงูููุงุด ุจุงุณุชุฎุฏุงู ุฑููุฒ Huffman ุงูุฏููุงููููุฉ ุจููุณ ุงูุทุฑููุฉ ุงูููุถุญุฉ ุฃุนูุงู. ูููู ุจุฏูุงู ูู ุงูุฑููุฒ ุงููุญุฏุฏุฉ ูุณุจููุง ูู litlen ู dist ุ ูุณุชุฎุฏููู ุงูุฑููุฒ ุงููุฎุฒูุฉ ูู ุฏูู ุงูุงูููุงุด ููุณู ูู ุจุฏุงูุฉ ุงููุชูุฉ. ุฑุจูุง ูููู ุงูุงุณู ุบูุฑ ูุงุฌุญ ุ ูุฃู ุฑููุฒ Huffman ุงูุฏููุงููููุฉ ุชุณูู ุฃูุถูุง ุงูุฑููุฒ ุงูุชู ุชุชุบูุฑ ุฃุซูุงุก ุงูุชุฑููุฒ - ููุฐุง ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑููุฒ Huffman ุงูุชูููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุงูุฑููุฒ ุงูููุตููุฉ ููุง ูุง ุนูุงูุฉ ููุง ุจูุฐุง ุงูุฅุฌุฑุงุก. ุฅููุง ุฏููุงููููุฉ ููุท ุจูุนูู ุฃู ุงููุชู ุงููุฎุชููุฉ ูููููุง ุงุณุชุฎุฏุงู ุฑููุฒ ูุฎุชููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนุชุจุฑ ุฅูุดุงุก ุงูุฑููุฒ ุงูุฏููุงููููุฉ ูุงููุดุชูุฉ ุงูุฏููุงููููุฉ ุงูุฌุฒุก ุงูุฃูุซุฑ ุตุนูุจุฉ ูู ุชูุณูู ุงูุงูููุงุด. ูููู ุจูุฌุฑุฏ ุฅูุดุงุก ุงูุฑููุฒ ุ ูุชู ูู ุงูุถุบุท ุจููุณ ุงูุทุฑููุฉ ุงูููุถุญุฉ ูู ุงูุฌุฒุก ุงูุณุงุจู ุ ุจุงุณุชุฎุฏุงู </font></font><code>inf_block</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_dyn_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">inf_stat_t</span> s;
        <span class="hljs-keyword">huffman_decoder_t</span> litlen_dec, dist_dec;<font></font>
<font></font>
        s = init_dyn_decoders(is, &amp;litlen_dec, &amp;dist_dec);<font></font>
        <span class="hljs-keyword">if</span> (s != HWINF_OK) {
                <span class="hljs-keyword">return</span> s;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> inf_block(is, dst, dst_cap, dst_pos, &amp;litlen_dec, &amp;dist_dec);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชุฎุฒูู ุฑููุฒ Litlen ู dist ููุชู โโุงูุงูููุงุด ุงูุฏููุงููููุฉ ูุณูุณูุฉ ูู ุฃุทูุงู ูููุงุช ุงูุชุดููุฑ. </font><font style="vertical-align: inherit;">ูุชู ุชุฑููุฒ ุงูุฃุทูุงู ููุณูุง ุจุงุณุชุฎุฏุงู ููุฏ ููููุงู ุงูุซุงูุซ - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุชู ุชุญุฏูุฏ ูุฐุง ุงูุฑูุฒ ูู ุฎูุงู ุทูู ูููุงุช ุงูููุฏ ( </font></font><code>codelen_lens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ุงููุฎุฒูุฉ ูู ุงููุชูุฉ (ูู ุฐูุฑุช ุฃูู ุตุนุจุ).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/84e/1fc/0e3/84e1fc0e3d3cfcb56ff215702d14f73d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุฏุงูุฉ ุงููุชูุฉ ุงูุฏููุงููููุฉ ุ ููุงู 14 ุจุชุฉ ุชุญุฏุฏ ุนุฏุฏ ุฃุทูุงู ูููุงุช ุงูุชุดููุฑ ุ ูุงูุชุดููุฑ ุ ูุงูุดูุฑุงุช ุงูุชู ูุฌุจ ูุฑุงุกุชูุง ูู ุงููุชูุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_CODELEN_LENS 4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_CODELEN_LENS 19</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_LITLEN_LENS 257</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_LITLEN_LENS 288</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_DIST_LENS 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_DIST_LENS 32</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_MAX_LIT 15</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY 16</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY_MIN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY_MAX 6</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS 17</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS_MIN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS_MAX 10</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2 18</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2_MIN 11</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2_MAX 138</span><font></font>
<font></font>
<span class="hljs-comment">/* RFC 1951, 3.2.7 */</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> codelen_lengths_order[MAX_CODELEN_LENS] =<font></font>
{ <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span> };<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">init_dyn_decoders</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is,
                                    <span class="hljs-keyword">huffman_decoder_t</span> *litlen_dec,
                                    <span class="hljs-keyword">huffman_decoder_t</span> *dist_dec)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">size_t</span> num_litlen_lens, num_dist_lens, num_codelen_lens;
        <span class="hljs-keyword">uint8_t</span> codelen_lengths[MAX_CODELEN_LENS];
        <span class="hljs-keyword">uint8_t</span> code_lengths[MAX_LITLEN_LENS + MAX_DIST_LENS];
        <span class="hljs-keyword">size_t</span> i, n, used;
        <span class="hljs-keyword">int</span> sym;
        <span class="hljs-keyword">huffman_decoder_t</span> codelen_dec;<font></font>
<font></font>
        bits = istream_bits(is);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of litlen codeword lengths (5 bits + 257). */</span>
        num_litlen_lens = lsb(bits, <span class="hljs-number">5</span>) + MIN_LITLEN_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">5</span>;<font></font>
        assert(num_litlen_lens &lt;= MAX_LITLEN_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of dist codeword lengths (5 bits + 1). */</span>
        num_dist_lens = lsb(bits, <span class="hljs-number">5</span>) + MIN_DIST_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">5</span>;<font></font>
        assert(num_dist_lens &lt;= MAX_DIST_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of code length lengths (4 bits + 4). */</span>
        num_codelen_lens = lsb(bits, <span class="hljs-number">4</span>) + MIN_CODELEN_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">4</span>;<font></font>
        assert(num_codelen_lens &lt;= MAX_CODELEN_LENS);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">5</span> + <span class="hljs-number">5</span> + <span class="hljs-number">4</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ุชุฃุชู ุฃุทูุงู ูููุงุช ุงูุดูุฑุฉ ูููุฏ ุงูุชุดููุฑ. </font><font style="vertical-align: inherit;">ูุฐู ุงูุฃุทูุงู ูู ุงูููู ุงูุซูุงุซูุฉ ุงููุนุชุงุฏุฉ ุ ูููููุง ููุชูุจุฉ ุจุงูุชุฑุชูุจ ุงูุฎุงุต ุงููุญุฏุฏ ูู </font></font><code>codelen_lengths_order</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ููุฒู ุชุญุฏูุฏ 19 ุทูููุง ุ ุณูุชู ูุฑุงุกุฉ ุงูุฏูู ููุท </font></font><code>num_codelen_lens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font><font style="vertical-align: inherit;">ูู ุดูุก ุขุฎุฑ ุจุงุทู ุถููููุง. </font><font style="vertical-align: inherit;">ูุชู ุณุฑุฏ ุงูุฃุทูุงู ุจุชุฑุชูุจ ูุนูู ุจุญูุซ ูู ุงููุฑุฌุญ ุฃู ุชุณูุท ุฃุทูุงู ุตูุฑูุฉ ูู ููุงูุฉ ุงููุงุฆูุฉ ููุง ูุชู ุชุฎุฒูููุง ูู ุงููุชูุฉ.</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* Read the codelen codeword lengths (3 bits each)
           and initialize the codelen decoder. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_codelen_lens; i++) {<font></font>
                bits = istream_bits(is);<font></font>
                codelen_lengths[codelen_lengths_order[i]] =<font></font>
                        (<span class="hljs-keyword">uint8_t</span>)lsb(bits, <span class="hljs-number">3</span>);
                <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
        }<font></font>
        <span class="hljs-keyword">for</span> (; i &lt; MAX_CODELEN_LENS; i++) {<font></font>
                codelen_lengths[codelen_lengths_order[i]] = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (!huffman_decoder_init(&amp;codelen_dec, codelen_lengths,<font></font>
                                  MAX_CODELEN_LENS)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฎูุงู ุชุนููู ูุญุฏุฉ ูู ุชุฑููุฒ codelen ุ ูููููุง ูุฑุงุกุฉ ุฃุทูุงู ูููุงุช ุงูุชุดููุฑ litlen ู dist ูู ุงูุฏูู.</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* Read the litlen and dist codeword lengths. */</span>
        i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (i &lt; num_litlen_lens + num_dist_lens) {<font></font>
                bits = istream_bits(is);<font></font>
                sym = huffman_decode(&amp;codelen_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(is, used)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (sym &gt;= <span class="hljs-number">0</span> &amp;&amp; sym &lt;= CODELEN_MAX_LIT) {
                        <span class="hljs-comment">/* A literal codeword length. */</span>
                        code_lengths[i++] = (<span class="hljs-keyword">uint8_t</span>)sym;<font></font>
                }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
16 ู 17 ู 18 ููุณุช ุฃุทูุงููุง ุญููููุฉ ุ ููู ูุคุดุฑุงุช ุนูู ุฃู ุงูุทูู ุงูุณุงุจู ูุญุชุงุฌ ุฅูู ุชูุฑุงุฑ ุนุฏุฉ ูุฑุงุช ุ ุฃู ุฃูู ุจุญุงุฌุฉ ุฅูู ุชูุฑุงุฑ ุงูุทูู ุงูุตูุฑู:</font></font><br>
<br>
<pre><code class="cpp hljs">               <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_COPY) {
                        <span class="hljs-comment">/* Copy the previous codeword length 3--6 times. */</span>
                        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">1</span>) {
                                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* No previous length. */</span><font></font>
                        }<font></font>
                        n = lsb(bits, <span class="hljs-number">2</span>) + CODELEN_COPY_MIN; <span class="hljs-comment">/* 2 bits + 3 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">2</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_COPY_MIN &amp;&amp; n &lt;= CODELEN_COPY_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i] = code_lengths[i - <span class="hljs-number">1</span>];<font></font>
                                i++;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS) {
                        <span class="hljs-comment">/* 3--10 zeros. */</span>
                        n = lsb(bits, <span class="hljs-number">3</span>) + CODELEN_ZEROS_MIN; <span class="hljs-comment">/* 3 bits + 3 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">3</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_ZEROS_MIN &amp;&amp;<font></font>
                               n &lt;= CODELEN_ZEROS_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i++] = <span class="hljs-number">0</span>;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS2) {
                        <span class="hljs-comment">/* 11--138 zeros. */</span>
                        n = lsb(bits, <span class="hljs-number">7</span>) + CODELEN_ZEROS2_MIN; <span class="hljs-comment">/* 7 bits +138 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">7</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_ZEROS2_MIN &amp;&amp;<font></font>
                               n &lt;= CODELEN_ZEROS2_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i++] = <span class="hljs-number">0</span>;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-comment">/* Invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุญุธ ุฃู ุฃุทูุงู litlen ู dist ุชุชู ูุฑุงุกุชูุง ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ูู ุงููุตูููุฉ </font></font><code>code_lengths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูุง ูููู ูุฑุงุกุชูุง ุจุดูู ูููุตู ุ ูุฃูู ูููู ุชุฑุญูู ุนูููุงุช ุชุดุบูู ุทูู ุงูููุฏ ูู ุฃุทูุงู ุงูุฅูุงุฑุฉ ุงูุฃุฎูุฑุฉ ุฅูู ุฃุทูุงู ุงูุฅูุทูุงู ุงูุฃููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฅุนุฏุงุฏ ุฃุทูุงู ูููุงุช ุงูุชุฑููุฒ ุ ูููููุง ุชูููู ุฃุฌูุฒุฉ ูู ุงูุชุดููุฑ Huffman ูุงูุนูุฏุฉ ุฅูู ูููุฉ ูู ุงูุฑููุฒ ูุงูุญุฑูู ุงูุฎูููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-keyword">if</span> (!huffman_decoder_init(litlen_dec, &amp;code_lengths[<span class="hljs-number">0</span>],<font></font>
                                  num_litlen_lens)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (!huffman_decoder_init(dist_dec, &amp;code_lengths[num_litlen_lens],<font></font>
                                  num_dist_lens)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="16"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุถุบุท (ุงูุงูููุงุด)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุฃุฌุฒุงุก ุงูุณุงุจูุฉ ุ ุฃูุดุฃูุง ุฌููุน ุงูุฃุฏูุงุช ุงููุงุฒูุฉ ูุถุบุท ุงูุงูููุงุด: Lempel-Ziv ุ ุชุฑููุฒ Huffman ุ ุชุฏููุงุช ุงูุจุชุงุช ููุตู ููุฃููุงุน ุงูุซูุงุซุฉ ูู ูุชู ุงูุงูููุงุด. ููู ูุฐุง ุงูุฌุฒุก ุณูููู ุจุชุฌููุน ูู ุดูุก ููุญุตูู ุนูู ุถุบุท ุงูุงูููุงุด. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุถุบุท Lempel-Ziv ููุฒุน ุงูุจูุงูุงุช ุงููุตุฏุฑ ูู ุณูุณูุฉ ูู ุงูุฑูุงุจุท ุงูุฎูููุฉ ูุงูุญุฑูู. ูุฌุจ ุชูุณูู ูุฐุง ุงูุชุณูุณู ูุชุฑููุฒู ุฅูู ูุชู ุงูููุงุด ุ ููุง ูู ููุถุญ ูู ุงูุฌุฒุก ุงูุณุงุจู. ุบุงูุจูุง ูุง ูุณูู ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุชูุณูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุญุฌุจ.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ูุงุญูุฉ ุ ุชุนูู ูู ูุชูุฉ ุฌุฏูุฏุฉ ููุนูุง ูู ุงููููุงุช ุงูุนุงูุฉ ุ ูุนุชูุฏ ุญุฌููุง ุนูู ููุน ุงููุชูุฉ ููุญุชููุงุชูุง. </font><font style="vertical-align: inherit;">ูุชู ุฃูู - ุญูู ุฃูู. </font><font style="vertical-align: inherit;">ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุฅู ุชูุงููู ุฅูุดุงุก ูุชูุฉ ุฌุฏูุฏุฉ ูููู ุฃู ุชุคุชู ุซูุงุฑูุง. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงูุช ุฎุตุงุฆุต ุงูุจูุงูุงุช ุชุณูุญ ุจุชุดููุฑ Huffman ุงูุฃูุซุฑ ููุงุกุฉ ูุชูููู ุฅุฌูุงูู ูููุฉ ุงูุจูุงูุงุช ุงูุชู ูุชู ุฅูุดุงุคูุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุญุธุฑ ูููุฉ ุชุญุณูู ุตุนุจุฉ. </font><font style="vertical-align: inherit;">ุจุนุถ ุงูุถูุงุบุท (ุนูู ุณุจูู ุงููุซุงู ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zopfli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ุชุญุงูู ุจุดูู ุฃูุถู ูู ุบูุฑูุง ุ ูููู ูุนุธููุง ุจุจุณุงุทุฉ ูุชุจุน ููุฌูุง ุฌุดุนูุง: ูุตุฏุฑูู ุงููุชู ุจูุฌุฑุฏ ูุตูููุง ุฅูู ุญุฌู ูุนูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงุน ูุฎุชููุฉ ูู ุงููุชู ููุง ูููุฏ ุงูุญุฌู ุงูุฎุงุตุฉ ุจูุง:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูููู ุฃู ุชุญุชูู ุงููุชู ุบูุฑ ุงููุถุบูุทุฉ ุนูู ุฃูุซุฑ ูู 65.535 ุจุงูุช.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุชุญุชูู ุฑููุฒ Huffman ุงูุซุงุจุชุฉ ุนูู ุญุฌู ุฃูุตู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ูุง ุชุญุชูู ุฑููุฒ Dynamic Huffman ุนูู ุงูุญุฏ ุงูุฃูุตู ููุญุฌู ุ ูููู ูุธุฑูุง ูุฃู ุชูููุฐูุง ูุฎูุงุฑุฒููุฉ Huffman ูุณุชุฎุฏู ุชุณูุณูุงุช ุฃุญุฑู 16 ุจุช ุ ูุฅููุง ูููุฏูู ุจู 65535 ุญุฑููุง.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุณุชุฎุฏุงู ูุชู ูู ุฃู ููุน ุจุญุฑูุฉ ุ ูู ุจูุตุฑ ุญุฌููุง ุนูู 65534 ุจุงูุช:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* The largest number of bytes that will fit in any kind of block is 65,534.
   It will fit in an uncompressed block (max 65,535 bytes) and a Huffman
   block with only literals (65,535 symbols including end-of-block marker). */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_BLOCK_LEN_BYTES 65534</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุชุจุน ุชุฏูู ุงูุจุชุงุช ุงูุตุงุฏุฑุฉ ููุญุชููุงุช ุงููุชูุฉ ุงูุญุงููุฉ ุฃุซูุงุก ุงูุถุบุท ุ ุณูุณุชุฎุฏู ุงูุจููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">deflate_state_t</span> <span class="hljs-title">deflate_state_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">deflate_state_t</span> {</span>
        <span class="hljs-keyword">ostream_t</span> os;<font></font>
<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *block_src; <span class="hljs-comment">/* First src byte in the block. */</span><font></font>
<font></font>
        <span class="hljs-keyword">size_t</span> block_len;       <span class="hljs-comment">/* Number of symbols in the current block. */</span>
        <span class="hljs-keyword">size_t</span> block_len_bytes; <span class="hljs-comment">/* Number of src bytes in the block. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Symbol frequencies for the current block. */</span>
        <span class="hljs-keyword">uint16_t</span> litlen_freqs[LITLEN_MAX + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint16_t</span> dist_freqs[DISTSYM_MAX + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
                <span class="hljs-keyword">uint16_t</span> distance;    <span class="hljs-comment">/* Backref distance. */</span>
                <span class="hljs-keyword">union</span> {
                        <span class="hljs-keyword">uint16_t</span> lit; <span class="hljs-comment">/* Literal byte or end-of-block. */</span>
                        <span class="hljs-keyword">uint16_t</span> len; <span class="hljs-comment">/* Backref length (distance != 0). */</span><font></font>
                } u;<font></font>
        } block[MAX_BLOCK_LEN_BYTES + <span class="hljs-number">1</span>];<font></font>
};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reset_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s)</span>
</span>{<font></font>
        s-&gt;block_len = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block_len_bytes = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">memset</span>(s-&gt;litlen_freqs, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(s-&gt;litlen_freqs));
        <span class="hljs-built_in">memset</span>(s-&gt;dist_freqs, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(s-&gt;dist_freqs));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุถุงูุฉ ูุชุงุฆุฌ ุงูุนูู ุฅูู ุงููุชูุฉ ุ </font></font><code>lz77_compress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุณุชุฎุฏู ูุธุงุฆู ุฑุฏ ุงูุงุชุตุงู ุ ูุนูุฏ ุงููุตูู ุฅูู ุงูุญุฌู ุงูุฃูุตู ุ ุณููุชุจ ุงููุชูุฉ ุฅูู ุชุฏูู ุงูุจุช:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">lit_callback</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> lit, <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> *s = aux;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (s-&gt;block_len_bytes + <span class="hljs-number">1</span> &gt; MAX_BLOCK_LEN_BYTES) {
                <span class="hljs-keyword">if</span> (!write_block(s, <span class="hljs-literal">false</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                s-&gt;block_src += s-&gt;block_len_bytes;<font></font>
                reset_block(s);<font></font>
        }<font></font>
<font></font>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block[s-&gt;block_len++].u.lit = lit;<font></font>
        s-&gt;block_len_bytes++;<font></font>
<font></font>
        s-&gt;litlen_freqs[lit]++;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">backref_callback</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> *s = aux;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (s-&gt;block_len_bytes + len &gt; MAX_BLOCK_LEN_BYTES) {
                <span class="hljs-keyword">if</span> (!write_block(s, <span class="hljs-literal">false</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                s-&gt;block_src += s-&gt;block_len_bytes;<font></font>
                reset_block(s);<font></font>
        }<font></font>
<font></font>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = (<span class="hljs-keyword">uint16_t</span>)dist;<font></font>
        s-&gt;block[s-&gt;block_len++].u.len = (<span class="hljs-keyword">uint16_t</span>)len;<font></font>
        s-&gt;block_len_bytes += len;<font></font>
<font></font>
        assert(len &gt;= MIN_LEN &amp;&amp; len &lt;= MAX_LEN);<font></font>
        assert(dist &gt;= MIN_DISTANCE &amp;&amp; dist &lt;= MAX_DISTANCE);<font></font>
        s-&gt;litlen_freqs[len2litlen[len]]++;<font></font>
        s-&gt;dist_freqs[distance2dist[dist]]++;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุดูุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ุชุณุฌูู ุงููุชู. </font><font style="vertical-align: inherit;">ุฅุฐุง ูู ูุชู ุถุบุท ุงููุชูุฉ ุ ููู ุดูุก ุจุณูุท:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_uncomp_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> len_nlen[<span class="hljs-number">4</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* Write the block header. */</span>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, (<span class="hljs-number">0x0</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>, <span class="hljs-number">3</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        len_nlen[<span class="hljs-number">0</span>] = (<span class="hljs-keyword">uint8_t</span>)(s-&gt;block_len_bytes &gt;&gt; <span class="hljs-number">0</span>);<font></font>
        len_nlen[<span class="hljs-number">1</span>] = (<span class="hljs-keyword">uint8_t</span>)(s-&gt;block_len_bytes &gt;&gt; <span class="hljs-number">8</span>);<font></font>
        len_nlen[<span class="hljs-number">2</span>] = ~len_nlen[<span class="hljs-number">0</span>];<font></font>
        len_nlen[<span class="hljs-number">3</span>] = ~len_nlen[<span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write_bytes_aligned(&amp;s-&gt;os, len_nlen, <span class="hljs-keyword">sizeof</span>(len_nlen))) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write_bytes_aligned(&amp;s-&gt;os, s-&gt;block_src,<font></font>
                                         s-&gt;block_len_bytes)) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุงุจุฉ ูุชูุฉ Huffman ุซุงุจุชุฉ ุ ููุดุฆ ุฃููุงู ุฑููุฒูุง ุฃุณุงุณูุฉ ุชุณุชูุฏ ุฅูู ุฃุทูุงู ูููุงุช ูุดูุฑุฉ ุซุงุจุชุฉ ูุฑููุฒ litlen ู dist. </font><font style="vertical-align: inherit;">ุซู ููุฑุฑ ุงููุชูุฉ ุ ูููุชุจ ุงูุฃุญุฑู ุงูุชู ุชุณุชุฎุฏู ูุฐู ุงูุฑููุฒ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_static_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">huffman_encoder_t</span> litlen_enc, dist_enc;<font></font>
<font></font>
        <span class="hljs-comment">/* Write the block header. */</span>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, (<span class="hljs-number">0x1</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>, <span class="hljs-number">3</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        huffman_encoder_init2(&amp;litlen_enc, fixed_litlen_lengths,<font></font>
                              <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths) /
                              <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths[<span class="hljs-number">0</span>]));<font></font>
        huffman_encoder_init2(&amp;dist_enc, fixed_dist_lengths,<font></font>
                              <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths) /
                              <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths[<span class="hljs-number">0</span>]));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> write_huffman_block(s, &amp;litlen_enc, &amp;dist_enc);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_huffman_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, nbits;
        <span class="hljs-keyword">uint64_t</span> distance, dist, len, litlen, bits, ebits;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; s-&gt;block_len; i++) {
                <span class="hljs-keyword">if</span> (s-&gt;block[i].distance == <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Literal or EOB. */</span><font></font>
                        litlen = s-&gt;block[i].u.lit;<font></font>
                        assert(litlen &lt;= LITLEN_EOB);<font></font>
                        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os,<font></font>
                                           litlen_enc-&gt;codewords[litlen],<font></font>
                                           litlen_enc-&gt;lengths[litlen])) {<font></font>
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Back reference length. */</span><font></font>
                len = s-&gt;block[i].u.len;<font></font>
                litlen = len2litlen[len];<font></font>
<font></font>
                <span class="hljs-comment">/* litlen bits */</span><font></font>
                bits = litlen_enc-&gt;codewords[litlen];<font></font>
                nbits = litlen_enc-&gt;lengths[litlen];<font></font>
<font></font>
                <span class="hljs-comment">/* ebits */</span><font></font>
                ebits = len - litlen_tbl[litlen - LITLEN_TBL_OFFSET].base_len;<font></font>
                bits |= ebits &lt;&lt; nbits;<font></font>
                nbits += litlen_tbl[litlen - LITLEN_TBL_OFFSET].ebits;<font></font>
<font></font>
                <span class="hljs-comment">/* Back reference distance. */</span><font></font>
                distance = s-&gt;block[i].distance;<font></font>
                dist = distance2dist[distance];<font></font>
<font></font>
                <span class="hljs-comment">/* dist bits */</span>
                bits |= (<span class="hljs-keyword">uint64_t</span>)dist_enc-&gt;codewords[dist] &lt;&lt; nbits;<font></font>
                nbits += dist_enc-&gt;lengths[dist];<font></font>
<font></font>
                <span class="hljs-comment">/* ebits */</span><font></font>
                ebits = distance - dist_tbl[dist].base_dist;<font></font>
                bits |= ebits &lt;&lt; nbits;<font></font>
                nbits += dist_tbl[dist].ebits;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุทุจุน ุ ุชุนุฏ ูุชุงุจุฉ ูุชู Huffman ุงูุฏููุงููููุฉ ุฃูุซุฑ ุตุนูุจุฉ ูุฃููุง ุชุญุชูู ุนูู ุชุฑููุฒ ุฎุงุฏุน ูุดูุฑุงุช litlen ู dist. </font><font style="vertical-align: inherit;">ูุชูุซูู ูุฐุง ุงูุชุฑููุฒ ุ ูุณุชุฎุฏู ุงูุจููุฉ ุงูุชุงููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">codelen_sym_t</span> <span class="hljs-title">codelen_sym_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">codelen_sym_t</span> {</span>
        <span class="hljs-keyword">uint8_t</span> sym;
        <span class="hljs-keyword">uint8_t</span> count; <span class="hljs-comment">/* For symbols 16, 17, 18. */</span><font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ูุชุฎูุต ูู ุฐูู ุฃุทูุงููุง ุงูุตูุฑูุฉ ููููุงุช ุงูุชุดููุฑ ูุงูุดูุฑุงุช ุ ุซู ููุณุฎูุง ูู ูุตูููุฉ ุนุงุฏูุฉ ููุชุฑููุฒ ุงููุงุญู. </font><font style="vertical-align: inherit;">ูุง ูููููุง ุชุฌุงูู ุฌููุน ุงูุฃุตูุงุฑ: ูู ุงููุณุชุญูู ุชุฑููุฒ ูุชูุฉ Deflate ุฅุฐุง ูู ููู ููุงู ุฑูุฒ dist ูุงุญุฏ. </font><font style="vertical-align: inherit;">ูู ุงููุณุชุญูู ุฃูุถูุง ุฃู ูููู ูุฏูู ุฃูู ูู 257 ุฑูุฒ litlen ุ ูููู ูุธุฑูุง ูุฃู ูุฏููุง ุฏุงุฆููุง ุนูุงูุฉ ููุงูุฉ ุงูุจุงูุช ุ ูุณูููู ููุงู ุฏุงุฆููุง ุฑูุฒ ุบูุฑ ุตูุฑู ูุญุฑู 256.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Encode litlen_lens and dist_lens into encoded. *num_litlen_lens and
   *num_dist_lens will be set to the number of encoded litlen and dist lens,
   respectively. Returns the number of elements in encoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">encode_dist_litlen_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *litlen_lens,
                                      <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *dist_lens,
                                      <span class="hljs-keyword">codelen_sym_t</span> *encoded,
                                      <span class="hljs-keyword">size_t</span> *num_litlen_lens,
                                      <span class="hljs-keyword">size_t</span> *num_dist_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, n;
        <span class="hljs-keyword">uint8_t</span> lens[LITLEN_MAX + <span class="hljs-number">1</span> + DISTSYM_MAX + <span class="hljs-number">1</span>];<font></font>
<font></font>
        *num_litlen_lens = LITLEN_MAX + <span class="hljs-number">1</span>;<font></font>
        *num_dist_lens = DISTSYM_MAX + <span class="hljs-number">1</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero litlen lengths. */</span>
        assert(litlen_lens[LITLEN_EOB] != <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">"EOB len should be non-zero."</span>);
        <span class="hljs-keyword">while</span> (litlen_lens[*num_litlen_lens - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) {<font></font>
                (*num_litlen_lens)--;<font></font>
        }<font></font>
        assert(*num_litlen_lens &gt;= MIN_LITLEN_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero dist lengths, keeping at least one. */</span>
        <span class="hljs-keyword">while</span> (dist_lens[*num_dist_lens - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span> &amp;&amp; *num_dist_lens &gt; <span class="hljs-number">1</span>) {<font></font>
                (*num_dist_lens)--;<font></font>
        }<font></font>
        assert(*num_dist_lens &gt;= MIN_DIST_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Copy the lengths into a unified array. */</span>
        n = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; *num_litlen_lens; i++) {<font></font>
                lens[n++] = litlen_lens[i];<font></font>
        }<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; *num_dist_lens; i++) {<font></font>
                lens[n++] = dist_lens[i];<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> encode_lens(lens, n, encoded);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฅุถุงูุฉ ุฃุทูุงู ุงูููุฏ ุฅูู ูุตูููุฉ ูุงุญุฏุฉ ุ ูููู ุจุฅุฌุฑุงุก ุงูุชุฑููุฒ ุจุงุณุชุฎุฏุงู ุฃุญุฑู ุฎุงุตุฉ ูุชุดุบูู ููุณ ุฃุทูุงู ุงูููุฏ.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Encode the n code lengths in lens into encoded, returning the number of
   elements in encoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">encode_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lens, <span class="hljs-keyword">size_t</span> n, <span class="hljs-keyword">codelen_sym_t</span> *encoded)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, j, num_encoded;
        <span class="hljs-keyword">uint8_t</span> count;<font></font>
<font></font>
        i = <span class="hljs-number">0</span>;<font></font>
        num_encoded = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (i &lt; n) {
                <span class="hljs-keyword">if</span> (lens[i] == <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Scan past the end of this zero run (max 138). */</span>
                        <span class="hljs-keyword">for</span> (j = i; j &lt; min(n, i + CODELEN_ZEROS2_MAX) &amp;&amp;<font></font>
                                    lens[j] == <span class="hljs-number">0</span>; j++);<font></font>
                        count = (<span class="hljs-keyword">uint8_t</span>)(j - i);<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (count &lt; CODELEN_ZEROS_MIN) {
                                <span class="hljs-comment">/* Output a single zero. */</span>
                                encoded[num_encoded++].sym = <span class="hljs-number">0</span>;<font></font>
                                i++;<font></font>
                                <span class="hljs-keyword">continue</span>;<font></font>
                        }<font></font>
<font></font>
                        <span class="hljs-comment">/* Output a repeated zero. */</span>
                        <span class="hljs-keyword">if</span> (count &lt;= CODELEN_ZEROS_MAX) {
                                <span class="hljs-comment">/* Repeated zero 3--10 times. */</span><font></font>
                                assert(count &gt;= CODELEN_ZEROS_MIN &amp;&amp;<font></font>
                                       count &lt;= CODELEN_ZEROS_MAX);<font></font>
                                encoded[num_encoded].sym = CODELEN_ZEROS;<font></font>
                                encoded[num_encoded++].count = count;<font></font>
                        } <span class="hljs-keyword">else</span> {
                                <span class="hljs-comment">/* Repeated zero 11--138 times. */</span><font></font>
                                assert(count &gt;= CODELEN_ZEROS2_MIN &amp;&amp;<font></font>
                                       count &lt;= CODELEN_ZEROS2_MAX);<font></font>
                                encoded[num_encoded].sym = CODELEN_ZEROS2;<font></font>
                                encoded[num_encoded++].count = count;<font></font>
                        }<font></font>
                        i = j;<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Output len. */</span><font></font>
                encoded[num_encoded++].sym = lens[i++];<font></font>
<font></font>
                <span class="hljs-comment">/* Scan past the end of the run of this len (max 6). */</span>
                <span class="hljs-keyword">for</span> (j = i; j &lt; min(n, i + CODELEN_COPY_MAX) &amp;&amp;<font></font>
                            lens[j] == lens[i - <span class="hljs-number">1</span>]; j++);<font></font>
                count = (<span class="hljs-keyword">uint8_t</span>)(j - i);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (count &gt;= CODELEN_COPY_MIN) {
                        <span class="hljs-comment">/* Repeat last len 3--6 times. */</span><font></font>
                        assert(count &gt;= CODELEN_COPY_MIN &amp;&amp;<font></font>
                               count &lt;= CODELEN_COPY_MAX);<font></font>
                        encoded[num_encoded].sym = CODELEN_COPY;<font></font>
                        encoded[num_encoded++].count = count;<font></font>
                        i = j;<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> num_encoded;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชู ุชุณุฌูู ุงูุฃุญุฑู ุงููุณุชุฎุฏูุฉ ููุชุดููุฑ ุจุงุณุชุฎุฏุงู ููุฏ Huffman - codelen. </font><font style="vertical-align: inherit;">ุชุชู ูุชุงุจุฉ ุฃุทูุงู ูููุงุช ุงูุชุดููุฑ ูู ููุฏ ุงูููุฏูู ุฅูู ุงููุชูุฉ ุจุชุฑุชูุจ ูุนูู ุจุญูุซ ูู ุงููุฑุฌุญ ุฃู ุชูุชูู ุฃุทูุงู ุงูุตูุฑ ูู ุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ูููุง ููู ุฏุงูุฉ ุชุญุณุจ ุนุฏุฏ ุงูุฃุทูุงู ุงูุชู ูุฌุจ ูุชุงุจุชูุง:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> codelen_lengths_order[<span class="hljs-number">19</span>] =<font></font>
{ <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span> };<font></font>
<font></font>
<span class="hljs-comment">/* Count the number of significant (not trailing zeros) codelen lengths. */</span>
<span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">count_codelen_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *codelen_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> n = MAX_CODELEN_LENS;<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero lengths. */</span>
        <span class="hljs-keyword">while</span> (codelen_lens[codelen_lengths_order[n - <span class="hljs-number">1</span>]] == <span class="hljs-number">0</span>) {<font></font>
                n--;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* The first 4 lengths in the order (16, 17, 18, 0) cannot be used to
           encode any non-zero lengths. Since there will always be at least
           one non-zero codeword length (for EOB), n will be &gt;= 4. */</span><font></font>
        assert(n &gt;= MIN_CODELEN_LENS &amp;&amp; n &lt;= MAX_CODELEN_LENS);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> n;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชุฑุถ ุฃููุง ูููุง ุจุงููุนู ุจุชุนููู ุฑููุฒ litlen ู dist ุ ููููุง ุจุฅุนุฏุงุฏ ุชุฑููุฒ ุฃุทูุงู ูููุงุช ุงูุดูุฑุฉ ุงูุฎุงุตุฉ ุจูู ุ ูุฑูุฒ ููุฐู ุงูุฃุทูุงู. </font><font style="vertical-align: inherit;">ุงูุขู ูููููุง ูุชุงุจุฉ ูุชูุฉ ููููุงู ุฏููุงููููุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_dynamic_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>,
                                <span class="hljs-keyword">size_t</span> num_litlen_lens, <span class="hljs-keyword">size_t</span> num_dist_lens,
                                <span class="hljs-keyword">size_t</span> num_codelen_lens,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *codelen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">codelen_sym_t</span> *encoded_lens,
                                <span class="hljs-keyword">size_t</span> num_encoded_lens,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint8_t</span> codelen, sym;
        <span class="hljs-keyword">size_t</span> nbits;
        <span class="hljs-keyword">uint64_t</span> bits, hlit, hdist, hclen, count;<font></font>
<font></font>
        <span class="hljs-comment">/* Block header. */</span>
        bits = (<span class="hljs-number">0x2</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>;<font></font>
        nbits = <span class="hljs-number">3</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hlit (5 bits) */</span><font></font>
        hlit = num_litlen_lens - MIN_LITLEN_LENS;<font></font>
        bits |= hlit &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">5</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hdist (5 bits) */</span><font></font>
        hdist = num_dist_lens - MIN_DIST_LENS;<font></font>
        bits |= hdist &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">5</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hclen (4 bits) */</span><font></font>
        hclen = num_codelen_lens - MIN_CODELEN_LENS;<font></font>
        bits |= hclen &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen lengths. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_codelen_lens; i++) {<font></font>
                codelen = codelen_enc-&gt;lengths[codelen_lengths_order[i]];<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, codelen, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Litlen and dist code lengths. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_encoded_lens; i++) {<font></font>
                sym = encoded_lens[i].sym;<font></font>
<font></font>
                bits = codelen_enc-&gt;codewords[sym];<font></font>
                nbits = codelen_enc-&gt;lengths[sym];<font></font>
<font></font>
                count = encoded_lens[i].count;<font></font>
                <span class="hljs-keyword">if</span> (sym == CODELEN_COPY) { <span class="hljs-comment">/* 2 ebits */</span><font></font>
                        bits |= (count - CODELEN_COPY_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">2</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS) { <span class="hljs-comment">/* 3 ebits */</span><font></font>
                        bits |= (count - CODELEN_ZEROS_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">3</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS2) { <span class="hljs-comment">/* 7 ebits */</span><font></font>
                        bits |= (count - CODELEN_ZEROS2_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">7</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> write_huffman_block(s, litlen_enc, dist_enc);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ูุชูุฉ ุ ูุฑูุฏ ุงุณุชุฎุฏุงู ุงูููุน ุงูุฐู ูุชุทูุจ ุฃูู ุนุฏุฏ ูู ุงูุจุชุงุช. </font><font style="vertical-align: inherit;">ูููู ุญุณุงุจ ุทูู ุงููุชูุฉ ุบูุฑ ุงููุถุบูุทุฉ ุจุณุฑุนุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for an uncompressed block, including header. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">uncomp_block_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s)</span>
</span>{
        <span class="hljs-keyword">size_t</span> bit_pos, padding;<font></font>
<font></font>
        <span class="hljs-comment">/* Bit position after writing the block header. */</span>
        bit_pos = ostream_bit_pos(&amp;s-&gt;os) + <span class="hljs-number">3</span>;<font></font>
        padding = round_up(bit_pos, <span class="hljs-number">8</span>) - bit_pos;<font></font>
<font></font>
        <span class="hljs-comment">/* Header + padding + len/nlen + block contents. */</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">3</span> + padding + <span class="hljs-number">2</span> * <span class="hljs-number">16</span> + s-&gt;block_len_bytes * <span class="hljs-number">8</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงููุณุจุฉ ุฅูู ุงููุชู ุงููุดูุฑุฉ ูู Huffman ุ ููููู ุญุณุงุจ ุทูู ุงูุฌุณู ุจุงุณุชุฎุฏุงู ุชุฑุฏุฏุงุช litlen- ู dist- ุงูุชุฑุฏุฏุงุช ููุฃุญุฑู ูุฃุทูุงู ุงูููุฏ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for a Huffman encoded block body. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">huffman_block_body_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s,
                                     <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *litlen_lens,
                                     <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *dist_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, freq, len;<font></font>
<font></font>
        len = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt;= LITLEN_MAX; i++) {<font></font>
                freq = s-&gt;litlen_freqs[i];<font></font>
                len += litlen_lens[i] * freq;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (i &gt;= LITLEN_TBL_OFFSET) {<font></font>
                        len += litlen_tbl[i - LITLEN_TBL_OFFSET].ebits * freq;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt;= DISTSYM_MAX; i++) {<font></font>
                freq = s-&gt;dist_freqs[i];<font></font>
                len += dist_lens[i] * freq;<font></font>
                len += dist_tbl[i].ebits * freq;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> len;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุทูู ุงูููู ูููุชูุฉ ุงูุซุงุจุชุฉ ูู 3 ุจุชุงุช ูู ุงูุฑุฃุณ ุจุงูุฅุถุงูุฉ ุฅูู ุทูู ุงูุฌุณู. </font><font style="vertical-align: inherit;">ูุชุทูุจ ุญุณุงุจ ุญุฌู ุฑุฃุณ ูุชูุฉ ุฏููุงููููุฉ ุงููุฒูุฏ ูู ุงูุนูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for a dynamic Huffman block. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">dyn_block_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">size_t</span> num_codelen_lens,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *codelen_freqs,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *codelen_enc,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> len, i, freq;<font></font>
<font></font>
        <span class="hljs-comment">/* Block header. */</span>
        len = <span class="hljs-number">3</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Nbr of litlen, dist, and codelen lengths. */</span>
        len += <span class="hljs-number">5</span> + <span class="hljs-number">5</span> + <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen lengths. */</span>
        len += <span class="hljs-number">3</span> * num_codelen_lens;<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen encoding. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; MAX_CODELEN_LENS; i++) {<font></font>
                freq = codelen_freqs[i];<font></font>
                len += codelen_enc-&gt;lengths[i] * freq;<font></font>
<font></font>
                <span class="hljs-comment">/* Extra bits. */</span>
                <span class="hljs-keyword">if</span> (i == CODELEN_COPY) {<font></font>
                        len += <span class="hljs-number">2</span> * freq;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == CODELEN_ZEROS) {<font></font>
                        len += <span class="hljs-number">3</span> * freq;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == CODELEN_ZEROS2) {<font></font>
                        len += <span class="hljs-number">7</span> * freq;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> len + huffman_block_body_len(s, litlen_enc-&gt;lengths,<font></font>
                                            dist_enc-&gt;lengths);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุณูุฌูุน ูู ุดูุก ูุนูุง ูููุดุฆ ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ููุชุงุจุฉ ุงููุชู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write the current deflate block, marking it final if that parameter is true,
   returning false if there is not enough room in the output stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">size_t</span> old_bit_pos, uncomp_len, static_len, dynamic_len;
        <span class="hljs-keyword">huffman_encoder_t</span> dyn_litlen_enc, dyn_dist_enc, codelen_enc;
        <span class="hljs-keyword">size_t</span> num_encoded_lens, num_litlen_lens, num_dist_lens;
        <span class="hljs-keyword">codelen_sym_t</span> encoded_lens[LITLEN_MAX + <span class="hljs-number">1</span> + DISTSYM_MAX + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint16_t</span> codelen_freqs[MAX_CODELEN_LENS] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">size_t</span> num_codelen_lens;
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        old_bit_pos = ostream_bit_pos(&amp;s-&gt;os);<font></font>
<font></font>
        <span class="hljs-comment">/* Add the end-of-block marker in case we write a Huffman block. */</span>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        assert(s-&gt;litlen_freqs[LITLEN_EOB] == <span class="hljs-number">0</span>);<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block[s-&gt;block_len++].u.lit = LITLEN_EOB;<font></font>
        s-&gt;litlen_freqs[LITLEN_EOB] = <span class="hljs-number">1</span>;<font></font>
<font></font>
        uncomp_len = uncomp_block_len(s);<font></font>
<font></font>
        static_len = <span class="hljs-number">3</span> + huffman_block_body_len(s, fixed_litlen_lengths,<font></font>
                                                fixed_dist_lengths);<font></font>
<font></font>
        <span class="hljs-comment">/* Compute "dynamic" Huffman codes. */</span><font></font>
        huffman_encoder_init(&amp;dyn_litlen_enc, s-&gt;litlen_freqs,<font></font>
                             LITLEN_MAX + <span class="hljs-number">1</span>, <span class="hljs-number">15</span>);<font></font>
        huffman_encoder_init(&amp;dyn_dist_enc, s-&gt;dist_freqs, DISTSYM_MAX + <span class="hljs-number">1</span>, <span class="hljs-number">15</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* Encode the litlen and dist code lengths. */</span><font></font>
        num_encoded_lens = encode_dist_litlen_lens(dyn_litlen_enc.lengths,<font></font>
                                                   dyn_dist_enc.lengths,<font></font>
                                                   encoded_lens,<font></font>
                                                   &amp;num_litlen_lens,<font></font>
                                                   &amp;num_dist_lens);<font></font>
<font></font>
        <span class="hljs-comment">/* Compute the codelen code. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_encoded_lens; i++) {<font></font>
                codelen_freqs[encoded_lens[i].sym]++;<font></font>
        }<font></font>
        huffman_encoder_init(&amp;codelen_enc, codelen_freqs, MAX_CODELEN_LENS, <span class="hljs-number">7</span>);<font></font>
        num_codelen_lens = count_codelen_lens(codelen_enc.lengths);<font></font>
<font></font>
        dynamic_len = dyn_block_len(s, num_codelen_lens, codelen_freqs,<font></font>
                                    &amp;codelen_enc, &amp;dyn_litlen_enc,<font></font>
                                    &amp;dyn_dist_enc);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (uncomp_len &lt;= dynamic_len &amp;&amp; uncomp_len &lt;= static_len) {
                <span class="hljs-keyword">if</span> (!write_uncomp_block(s, <span class="hljs-keyword">final</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == uncomp_len);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (static_len &lt;= dynamic_len) {
                <span class="hljs-keyword">if</span> (!write_static_block(s, <span class="hljs-keyword">final</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == static_len);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (!write_dynamic_block(s, <span class="hljs-keyword">final</span>, num_litlen_lens,<font></font>
                                         num_dist_lens, num_codelen_lens,<font></font>
                                         &amp;codelen_enc, encoded_lens,<font></font>
                                         num_encoded_lens, &amp;dyn_litlen_enc,<font></font>
                                         &amp;dyn_dist_enc)) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == dynamic_len);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุฎูุฑูุง ุ ูุฌุจ ุนูู ุงูุจุงุฏุฆ ูุนูููุฉ ุงูุถุบุท ุจุฃููููุง ุชุนููู ุงูุญุงูุฉ ุงูุฃูููุฉ ูุจุฏุก ุถุบุท Lempel-Ziv ููุชุงุจุฉ ุงููุชูุฉ ุงููุงุชุฌุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Compress (deflate) the data in src into dst. The number of bytes output, at
   most dst_cap, is stored in *dst_used. Returns false if there is not enough
   room in dst. src and dst must not overlap. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">hwdeflate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len, <span class="hljs-keyword">uint8_t</span> *dst,
               <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_used)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> s;<font></font>
<font></font>
        ostream_init(&amp;s.os, dst, dst_cap);<font></font>
        reset_block(&amp;s);<font></font>
        s.block_src = src;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!lz77_compress(src, src_len, &amp;lit_callback,<font></font>
                           &amp;backref_callback, &amp;s)) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!write_block(&amp;s, <span class="hljs-literal">true</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* The end of the final block should match the end of src. */</span><font></font>
        assert(s.block_src + s.block_len_bytes == src + src_len);<font></font>
<font></font>
        *dst_used = ostream_bytes_written(&amp;s.os);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="17"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุณูู ููู ูุถุบูุท</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุนูุงู ุ ุฏุฑุณูุง ููู ูุนูู ุถุบุท ุงูุงูููุงุด ุงููุณุชุฎุฏู ูู ูููุงุช Zip. </font><font style="vertical-align: inherit;">ูุงุฐุง ุนู ุชูุณูู ุงูููู ููุณูุ </font><font style="vertical-align: inherit;">ูู ูุฐุง ุงูุฌุฒุก ุ ุณูู ูุฏุฑุณ ุจุงูุชูุตูู ูููููุง ูุชูููุฐูุง. </font><font style="vertical-align: inherit;">ูุชุงุญ ูู ูุงููู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="18"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑุฉ ุนุงูุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ูุตู ุชูุณูู ุงูููู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ ุชุทุจูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PKZip </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ูู ููู ุฃู ุนูุตุฑ ุฃุฑุดูุฉ ูู ููู ูุถุบูุท ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฃุณ ููู ูุญูู ูุญุชูู ุนูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงูุงุช ุชุนุฑูู ุญูู ุงูุนูุตุฑ.</font></font></li>
<li><i> </i>   .         ,      ,    ,      Zip-.</li>
<li>  ,     <i>   </i>.       ,        .     Zip-.</li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/821/bba/6ce/821bba6cede767c834da639e00d7d6ba.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุถุบุท ูู ุนูุตุฑ ุฃุฑุดูู ูุชุฎุฒููู ุจุดูู ูุฑุฏู. ููุฐุง ูุนูู ุฃูู ุญุชู ูู ุญุงูุฉ ูุฌูุฏ ุชุทุงุจูุงุช ุจูู ุงููููุงุช ุงูููุฌูุฏุฉ ูู ุงูุฃุฑุดูู ุ ููู ูุชู ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ูุชุญุณูู ุงูุถุบุท. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณูุญ ูู ูููุน ุงููุชุงููุฌ ุงููุฑูุฒู ูู ุงูููุงูุฉ ุจุฅููุงู ุงูุฃุฑุดูู ุชุฏุฑูุฌููุง. ุฃุซูุงุก ุถุบุท ุนูุงุตุฑ ุงูููู ุ ุชุชู ุฅุถุงูุชูุง ุฅูู ุงูุฃุฑุดูู. ูุชู ุชุณุฌูู ุงูููุฑุณ ุจุนุฏ ุฌููุน ุงูุฃุญุฌุงู ุงููุถุบูุทุฉ ุ ููุง ูุณูุญ ูู ุจูุนุฑูุฉ ุชุนููุถุงุช ุฌููุน ุงููููุงุช. ุชุนุฏ ุฅุถุงูุฉ ุงููููุงุช ุฅูู ุฃุฑุดูู ููุฌูุฏ ุฃูุฑูุง ุณููุงู ููุบุงูุฉ ุ ุญูุซ ูุชู ูุถุนูุง ุจุนุฏ ุงูุนูุตุฑ ุงูุฃุฎูุฑ ุ ููุชู ุงุณุชุจุฏุงู ุงูุฏููู ุงููุฑูุฒู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ุงููุฏุฑุฉ ุนูู ุฅูุดุงุก ุงููุญููุธุงุช ุชุฏุฑูุฌูุงู ูููุฉ ุจุดูู ุฎุงุต ููุดุฑ ุงููุนูููุงุช ุนูู ุงูุนุฏูุฏ ูู ุงูุฃูุฑุงุต ุฃู ุงููุฌูุฏุงุช ุงููุฑูุฉ. ุฃุซูุงุก ุถุบุทู ุ ุงูุชุฑุญ PKZip ุนูู ุงููุณุชุฎุฏููู ุฅุฏุฎุงู ุฃูุฑุงุต ุฌุฏูุฏุฉ ุ ููุชุงุจุฉ ุงูุฏููู ุงููุฑูุฒู ุฅูู ุขุฎุฑ (ุขุฎุฑ). ููู ุถุบุท ุฃุฑุดูู ูุชุนุฏุฏ ุงููุฌูุฏุงุช ุ ุทูุจ PKZip ุฃููุงู ูู ุงููุฑุต ุงููุฑู ุงูุฃุฎูุฑ ุฃู ููุชุจ ููุฑุงุกุฉ ุงูุฏููู ุงููุฑูุฒู ุ ุซู ุจููุฉ ุงููุฑุต ุงููุฑู ุงููุทููุจ ูุงุณุชุฎุฑุงุฌ ุงููููุงุช ุงููุทููุจุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฏ ููุงุฌุฆู ูุฐุง ุ ูููู ูู ุชูู ููุงู ูุงุนุฏุฉ ุชุญุธุฑ ูุฌูุฏ ูููุงุช ูุชุนุฏุฏุฉ ุจููุณ ุงูุงุณู ูู ุงูุฃุฑุดูู. ูููู ุฃู ูุคุฏู ูุฐุง ุฅูู ุงููุซูุฑ ูู ุงูุงุฑุชุจุงู ุนูุฏ ุงูุชูุฑูุบ: ุฅุฐุง ูุงู ููุงู ุงูุนุฏูุฏ ูู ุงููููุงุช ุงูุชู ุชุญูู ููุณ ุงูุงุณู ุ ููุง ุงูููู ุงูุฐู ูุฌุจ ุนููู ุชูุฑูุบูุ ููุฐุง ุจุฏูุฑู ูุฏ ูุคุฏู ุฅูู ูุดุงูู ุฃูููุฉ. ุจุณุจุจ ุฎุทุฃ "ุงูููุชุงุญ ุงูุฑุฆูุณู" ูู Android (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2013-4787</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุฑุงุฆุญ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุชูุฑูุฑ ุนูู ุงููุจุนุฉ ุงูุณูุฏุงุก) ููููุงุฌู ุชุฌุงูุฒ ุงูุดููุงุช ูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุชูููุน ุงูุชุดููุฑ</font></a><font style="vertical-align: inherit;"> ูุธุงู ุงูุชุดุบูู ุนูุฏ ุชุซุจูุช ุงูุจุฑุงูุฌ. ูุชู ุชูุฒูุน ุจุฑุงูุฌ Android ูู </font><font style="vertical-align: inherit;">ูููุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููู ูููุงุช Zip. ููุง ุงุชุถุญ ุ ุฅุฐุง ุงุญุชูู ููู APK ุนูู ุนุฏุฉ ูููุงุช ุจุงูุงุณู ููุณู ุ ุญุฏุฏ ุฑูุฒ ุงูุชุญูู ูู ุงูุชูููุน </font><font style="vertical-align: inherit;">ุงูููู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฎูุฑ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจููุณ ุงูุงุณู ุ ูุญุฏุฏ ุงููุซุจุช </font><font style="vertical-align: inherit;">ุงูููู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฃู ุฃูู ูู ูุชู ุฅุฌุฑุงุก ุงูุชุญูู. ุจูุนูู ุขุฎุฑ ุ ูุฅู ูุฐุง ุงูุงุฎุชูุงู ุงูุตุบูุฑ ุจูู ุงูููุชุจุชูู Zip ุฌุนู ูู ุงููููู ุชุฌุงูุฒ ูููุฐุฌ ุฃูุงู ูุธุงู ุงูุชุดุบูู ุจุงููุงูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุนูุณ ูุนุธู ุงูุชูุณููุงุช ุ ูุฌุจ ุฃูุง ุชุจุฏุฃ ุงููููุงุช ุงููุถุบูุทุฉ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุจุฑูู</font></a><font style="vertical-align: inherit;"> ุชูููุน ุฃู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุญุฑู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุจุดูู ุนุงู ุ ูุง ููุดุงุฑ ุฅูู ุฃู ููู Zip ูุฌุจ ุฃู ูุจุฏุฃ ุจุฃู ุทุฑููุฉ ูุญุฏุฏุฉ ุ ููุง ูุณูุญ ูู ุจุณูููุฉ ุจุฅูุดุงุก ูููุงุช ุตุงูุญุฉ ูููู Zip ูุชูุณูู ูุฎุชูู - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุงุช ูุชุนุฏุฏุฉ ุงููุบุงุช</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุนูู ุณุจูู ุงููุซุงู ุ </font><font style="vertical-align: inherit;">ุนุงุฏุฉู ูุง ุชููู </font><font style="vertical-align: inherit;">ุฃุฑุดููุงุช Zip ุฐุงุชูุฉ ุงูุงุณุชุฎุฑุงุฌ (ุนูู ุณุจูู ุงููุซุงู ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkz204g.exe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ูุงุจูุฉ ููุชูููุฐ ููููุงุช Zip: ุงูุฌุฒุก ุงูุฃูู ูุงุจู ููุชูููุฐ ุ ูุชุจูุนูุง ุจููู Zip (ุงูุฐู ูุชู ุชูุฑูุบู ุจูุงุณุทุฉ ุงูุฌุฒุก ุงููุงุจู ููุชูููุฐ). ูููู ููุธุงู ุงูุชุดุบูู ุชูููุฐู ูููู ูุงุจู ููุชูููุฐ ุ ููู ุจุฑูุงูุฌ Zip ุณููุชุญู ูููู Zip. ูุฏ ุชุชุณุจุจ ูุฐู ุงูููุฒุฉ ูู ุนุฏู ุทูุจ ุงูุชูููุน ูู ุจุฏุงูุฉ ุงูููู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุงูุฑุบู ูู ุฃู ูุฐู ุงููููุงุช ูุชุนุฏุฏุฉ ุงููุบุงุช ุฐููุฉ ุ ุฅูุง ุฃููุง ูููู ุฃู ุชุคุฏู ุฅูู ูุดุงูู ุฃูููุฉ ูุฃููุง ูููู ุฃู ุชุฎุฏุน ุงูุจุฑุงูุฌ ุงูุชู ุชุญุงูู ุชุญุฏูุฏ ูุญุชููุงุช ุงูููู ูุชุณูุญ ุฃูุถูุง ุจุชุณููู ุชุนูููุงุช ุจุฑูุฌูุฉ ุถุงุฑุฉ ูู ููุงู ูุญุชูู ุนูู ูููุงุช ูู ุฃููุงุน ูุฎุชููุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ูุณุชุบู </font><font style="vertical-align: inherit;">ูููุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GIFAR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุณุชุฎุฏูุฉ </font><font style="vertical-align: inherit;">ุ ูุงูุชู ูู ูู ููุณ ุงูููุช ุตูุฑ GIF ุตุงูุญุฉ ูุฃุฑุดููุงุช Java (JAR ุ ููู ููุน ูู ูููุงุช Zip). ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ูุฐู ุงููุดููุฉ ุ ุฑุงุฌุน ุงูููุงูุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุณุงุกุฉ ุงุณุชุฎุฏุงู ุชูุณููุงุช ุงููููุงุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุจุฏุกูุง ูู ุงูุตูุญุฉ 18). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุณูุฑู ุฃุฏูุงู ุ ุชุณุชุฎุฏู ูููุงุช Zip ุญููู 32 ุจุช ููุฅุฒุงุญุฉ ูุงูุฃุญุฌุงู ููุญุฏ ูู ุญุฌู ุงูุฃุฑุดูู ูุนูุงุตุฑู ุฅูู ุฃุฑุจุนุฉ ุบูุบุงุจุงูุช. ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ ุงูุชุทุจูู 4.5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถุงูุช PKWare ููุญูุงุช ุชูุณูู ุชุณูุญ ุจุงุณุชุฎุฏุงู ุฅุฒุงุญุงุช ูุฃุญุฌุงู 64 ุจุช. ุงููููุงุช ุงูุชู ุชุณุชุฎุฏู ูุฐู ุงูุงูุชุฏุงุฏุงุช ุจุชูุณูู Zip64 ุ ููููุง ูู ูููุฑ ูููุง.</font></font><br>
<br>
<a name="19"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงูู ุงูุจูุงูุงุช</font></font></h3><br>
<a name="20"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงูุฉ ุฅุฏุฎุงู ุงูุฏููู ุงููุฑูุฒู</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนุงุฏุฉู ูุง ูุชู ุงุณุชุฎุฏุงู ููุงูุฉ ุฅุฏุฎุงู ุงูุฏููู ุงููุฑูุฒู (EOCDR) ูููุทุฉ ุจุฏุงูุฉ ููุฑุงุกุฉ ููู ูุถุบูุท. ูุญุชูู ุนูู ูููุน ุงูุฏููู ุงููุฑูุฒู ูุญุฌูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุนูููุงุช ุงุฎุชูุงุฑูุฉ ุญูู ุงูุฃุฑุดูู ุจุฃูููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููููุงุช ุงููุถุบูุทุฉ ุงูุชู ุงุญุชูุช ุงูุนุฏูุฏ ูู ุงูุฃูุฑุงุต - ุฃู ูุญุฏุงุช ุงูุชุฎุฒูู - ูุญุชูู EOCDR ุฃูุถูุง ุนูู ูุนูููุงุช ุญูู ุงููุฑุต ุงูุฐู ูุณุชุฎุฏูู ุญุงูููุง ุ ูุนูู ุฃู ูุฑุต ูุจุฏุฃ ุงูุฏููู ุงููุฑูุฒู ุ ููุง ุฅูู ุฐูู. ุงูููู ุ ูุงุฏุฑูุง ูุง ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ ุ ููุง ูุนุงูุฌ ุงูุฑูุฒ ูู ูุฐู ุงูููุงูุฉ ูุซู ูุฐู ุงููููุงุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุชุญุฏูุฏ EOCDR ุจุงูุชูููุน "P" "K" ุ ูุชุจูุนูุง ุจุงูุจุงูุชูู 5 ู 6. ููุชุจุนู ุงููููู ุฃุฏูุงู ุ ููุชู ุชุฎุฒูู ุงูุฃุฑูุงู ููููุง ููุจุฏุฃ ุงูุญุฏ ุงูุฃุฏูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* End of Central Directory Record. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> {</span>
        <span class="hljs-keyword">uint16_t</span> disk_nbr;        <span class="hljs-comment">/* Number of this disk. */</span>
        <span class="hljs-keyword">uint16_t</span> cd_start_disk;   <span class="hljs-comment">/* Nbr. of disk with start of the CD. */</span>
        <span class="hljs-keyword">uint16_t</span> disk_cd_entries; <span class="hljs-comment">/* Nbr. of CD entries on this disk. */</span>
        <span class="hljs-keyword">uint16_t</span> cd_entries;      <span class="hljs-comment">/* Nbr. of Central Directory entries. */</span>
        <span class="hljs-keyword">uint32_t</span> cd_size;         <span class="hljs-comment">/* Central Directory size in bytes. */</span>
        <span class="hljs-keyword">uint32_t</span> cd_offset;       <span class="hljs-comment">/* Central Directory file offset. */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;     <span class="hljs-comment">/* Archive comment length. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;   <span class="hljs-comment">/* Archive comment. */</span><font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ูุถุน EOCDR ูู ููุงูุฉ ุงูููู. </font><font style="vertical-align: inherit;">ูููู ูุธุฑูุง ูุฃูู ูุฏ ูููู ููุงู ุชุนููู ุจุทูู 16 ุจุช ุชุนุณูู ูู ุฐููู ุ ููุฏ ูููู ูู ุงูุถุฑูุฑู ุงูุนุซูุฑ ุนูู ูููู ูุญุฏุฏ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Read 16/32 bits little-endian and bump p forward afterwards. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ16(p) ((p) += 2, read16le((p) - 2))</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ32(p) ((p) += 4, read32le((p) - 4))</span><font></font>
<font></font>
<span class="hljs-comment">/* Size of the End of Central Directory Record, not including comment. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EOCDR_BASE_SZ 22</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EOCDR_SIGNATURE 0x06054b50  <span class="hljs-comment">/* "PK\5\6" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">find_eocdr</span><span class="hljs-params">(struct eocdr *r, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> comment_len;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (comment_len = <span class="hljs-number">0</span>; comment_len &lt;= UINT16_MAX; comment_len++) {
                <span class="hljs-keyword">if</span> (src_len &lt; EOCDR_BASE_SZ + comment_len) {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                p = &amp;src[src_len - EOCDR_BASE_SZ - comment_len];<font></font>
                signature = READ32(p);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (signature == EOCDR_SIGNATURE) {<font></font>
                        r-&gt;disk_nbr = READ16(p);<font></font>
                        r-&gt;cd_start_disk = READ16(p);<font></font>
                        r-&gt;disk_cd_entries = READ16(p);<font></font>
                        r-&gt;cd_entries = READ16(p);<font></font>
                        r-&gt;cd_size = READ32(p);<font></font>
                        r-&gt;cd_offset = READ32(p);<font></font>
                        r-&gt;comment_len = READ16(p);<font></font>
                        r-&gt;comment = p;<font></font>
                        assert(p == &amp;src[src_len - comment_len] &amp;&amp;<font></font>
                               <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (r-&gt;comment_len == comment_len) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
                        }<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุณุฌูู EOCDR ุณูู. </font><font style="vertical-align: inherit;">ุชููู ูุฐู ุงููุธููุฉ ุจูุชุงุจุฉ ูุฅุนุงุฏุฉ ุนุฏุฏ ุงูุจุงูุช ุงูููุชูุจ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write 16/32 bits little-endian and bump p forward afterwards. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE16(p, x) (write16le((p), (x)), (p) += 2)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE32(p, x) (write32le((p), (x)), (p) += 4)</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_eocdr</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct eocdr *r)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, EOCDR_SIGNATURE);<font></font>
        WRITE16(p, r-&gt;disk_nbr);<font></font>
        WRITE16(p, r-&gt;cd_start_disk);<font></font>
        WRITE16(p, r-&gt;disk_cd_entries);<font></font>
        WRITE16(p, r-&gt;cd_entries);<font></font>
        WRITE32(p, r-&gt;cd_size);<font></font>
        WRITE32(p, r-&gt;cd_offset);<font></font>
        WRITE16(p, r-&gt;comment_len);<font></font>
        assert(p - dst == EOCDR_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (r-&gt;comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, r-&gt;comment, r-&gt;comment_len);<font></font>
                p += r-&gt;comment_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="21"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฃุณ ุงูููู ุงููุฑูุฒู</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชููู ุงูุฏููู ุงููุฑูุฒู ูู ุฑุคูุณ ุงููููุงุช ุงููุฑูุฒูุฉ ุงูููุชูุจุฉ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุ ูุงุญุฏุฉ ููู ุนูุตุฑ ุฃุฑุดูู. </font><font style="vertical-align: inherit;">ูุจุฏุฃ ูู ุนููุงู ุจุงูุชูููุน "P" ู "K" ู 1 ู 2 ุ ุซู ููุฌุฏ ูุซู ูุฐุง ุงููููู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EXT_ATTR_DIR (1U &lt;&lt; 4)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EXT_ATTR_ARC (1U &lt;&lt; 5)</span><font></font>
<font></font>
<span class="hljs-comment">/* Central File Header (Central Directory Entry) */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> {</span>
        <span class="hljs-keyword">uint16_t</span> made_by_ver;    <span class="hljs-comment">/* Version made by. */</span>
        <span class="hljs-keyword">uint16_t</span> extract_ver;    <span class="hljs-comment">/* Version needed to extract. */</span>
        <span class="hljs-keyword">uint16_t</span> gp_flag;        <span class="hljs-comment">/* General purpose bit flag. */</span>
        <span class="hljs-keyword">uint16_t</span> method;         <span class="hljs-comment">/* Compression method. */</span>
        <span class="hljs-keyword">uint16_t</span> mod_time;       <span class="hljs-comment">/* Modification time. */</span>
        <span class="hljs-keyword">uint16_t</span> mod_date;       <span class="hljs-comment">/* Modification date. */</span>
        <span class="hljs-keyword">uint32_t</span> crc32;          <span class="hljs-comment">/* CRC-32 checksum. */</span>
        <span class="hljs-keyword">uint32_t</span> comp_size;      <span class="hljs-comment">/* Compressed size. */</span>
        <span class="hljs-keyword">uint32_t</span> uncomp_size;    <span class="hljs-comment">/* Uncompressed size. */</span>
        <span class="hljs-keyword">uint16_t</span> name_len;       <span class="hljs-comment">/* Filename length. */</span>
        <span class="hljs-keyword">uint16_t</span> extra_len;      <span class="hljs-comment">/* Extra data length. */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;    <span class="hljs-comment">/* Comment length. */</span>
        <span class="hljs-keyword">uint16_t</span> disk_nbr_start; <span class="hljs-comment">/* Disk nbr. where file begins. */</span>
        <span class="hljs-keyword">uint16_t</span> int_attrs;      <span class="hljs-comment">/* Internal file attributes. */</span>
        <span class="hljs-keyword">uint32_t</span> ext_attrs;      <span class="hljs-comment">/* External file attributes. */</span>
        <span class="hljs-keyword">uint32_t</span> lfh_offset;     <span class="hljs-comment">/* Local File Header offset. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;     <span class="hljs-comment">/* Filename. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *extra;    <span class="hljs-comment">/* Extra data. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;  <span class="hljs-comment">/* File comment. */</span><font></font>
};<font></font>
</code></pre><br>
<code>made_by_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>extract_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุนูููุงุช ุญูู ุชุฑููุฒ OS ููุณุฎุฉ ูู ุงูุจุฑูุงูุฌ ุชุณุชุฎุฏู ูุฅุถุงูุฉ ูุฐุง ุงูุจูุฏุ ููุฐูู ุงูุชู ุชุญุชุงุฌ ุฅูู ุงูุฅุตุฏุงุฑ ูุงุณุชุฑุฌุงุนูุง. </font><font style="vertical-align: inherit;">ุชููู ุงูุจุชุงุช ุงูุซูุงููุฉ ุงูุฃูุซุฑ ุฃูููุฉ ุจุชุฑููุฒ ูุธุงู ุงูุชุดุบูู (ุนูู ุณุจูู ุงููุซุงู ุ 0 ุชุนูู DOS ุ 3 ุชุนูู Unix ุ 10 ุชุนูู Windows NTFS) ุ ูุงูุจุชุงุช ุงูุซูุงููุฉ ุงูุณูููุฉ ุชุฑููุฒ ุฅุตุฏุงุฑ ุงูุจุฑูุงูุฌ. </font><font style="vertical-align: inherit;">ูู ุจุชุนููู ุงููููุฉ ุงูุนุดุฑูุฉ ุฅูู 20 ุ ููุง ูุนูู ุงูุชูุงูู ูุน PKZip 2.0. </font></font><br>
<br>
<code>gp_flag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุนูู ุฃุนูุงู ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ูุญู ููุชููู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุช 0 ุ ุชุดูุฑ ุฅูู ุญูููุฉ ุชุดููุฑ ุงูุนูุตุฑ (ูู ูุนุชุจุฑ ุฐูู) ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุจุชุงุช 1 ู 2 ุ ุชุฑููุฒ ูุณุชูู ุถุบุท ุงูุงูููุงุด (0 - ุนุงุฏู ุ 1 - ุงูุญุฏ ุงูุฃูุตู ุ 2 - ุณุฑูุน ุ 3 - ุณุฑูุน ุฌุฏูุง).</font></font></li>
</ul><br>
<code>method</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดูุฑ ุทุฑููุฉ ุถุบุท. 0 - ุงูุจูุงูุงุช ุบูุฑ ูุถุบูุทุฉ ุ 8 - Delate ูุทุจูุฉ. ุชุฑุชุจุท ุงูููู ุงูุฃุฎุฑู ุจุงูุฎูุงุฑุฒููุงุช ุงููุฏููุฉ ุฃู ุงูุฌุฏูุฏุฉ ุ ูููู ูุนุธู Zip ุชุณุชุฎุฏู ูุงุชูู ุงููููุชูู. </font></font><br>
<br>
<code>mod_time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>mod_date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชุถูู ุชุงุฑูุฎ ูููุช ุชู ุชุนุฏูู ุงููููุ ุงููุดูุฑุฉ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดูู MS-DOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุฑูุฒ ุ ุณูููู ุจุชุญููู ุงูุทูุงุจุน ุงูุฒูููุฉ C ุงููุนุชุงุฏุฉ </font></font><code>time_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฅูู ุชูุณูู MS-DOS:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Convert DOS date and time to time_t. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">time_t</span> <span class="hljs-title">dos2ctime</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> dos_date, <span class="hljs-keyword">uint16_t</span> dos_time)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> <span class="hljs-title">tm</span> = {</span><span class="hljs-number">0</span>};<font></font>
<font></font>
        tm.tm_sec = (dos_time &amp; <span class="hljs-number">0x1f</span>) * <span class="hljs-number">2</span>;  <span class="hljs-comment">/* Bits 0--4:  Secs divided by 2. */</span>
        tm.tm_min = (dos_time &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0x3f</span>; <span class="hljs-comment">/* Bits 5--10: Minute. */</span>
        tm.tm_hour = (dos_time &gt;&gt; <span class="hljs-number">11</span>);      <span class="hljs-comment">/* Bits 11-15: Hour (0--23). */</span><font></font>
<font></font>
        tm.tm_mday = (dos_date &amp; <span class="hljs-number">0x1f</span>);          <span class="hljs-comment">/* Bits 0--4: Day (1--31). */</span>
        tm.tm_mon = ((dos_date &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0xf</span>) - <span class="hljs-number">1</span>; <span class="hljs-comment">/* Bits 5--8: Month (1--12). */</span>
        tm.tm_year = (dos_date &gt;&gt; <span class="hljs-number">9</span>) + <span class="hljs-number">80</span>;       <span class="hljs-comment">/* Bits 9--15: Year-1980. */</span><font></font>
<font></font>
        tm.tm_isdst = <span class="hljs-number">-1</span>;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> mktime(&amp;tm);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Convert time_t to DOS date and time. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ctime2dos</span><span class="hljs-params">(<span class="hljs-keyword">time_t</span> t, <span class="hljs-keyword">uint16_t</span> *dos_date, <span class="hljs-keyword">uint16_t</span> *dos_time)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">tm</span> = <span class="hljs-title">localtime</span>(&amp;<span class="hljs-title">t</span>);</span><font></font>
<font></font>
        *dos_time = <span class="hljs-number">0</span>;<font></font>
        *dos_time |= tm-&gt;tm_sec / <span class="hljs-number">2</span>;    <span class="hljs-comment">/* Bits 0--4:  Second divided by two. */</span>
        *dos_time |= tm-&gt;tm_min &lt;&lt; <span class="hljs-number">5</span>;   <span class="hljs-comment">/* Bits 5--10: Minute. */</span>
        *dos_time |= tm-&gt;tm_hour &lt;&lt; <span class="hljs-number">11</span>; <span class="hljs-comment">/* Bits 11-15: Hour. */</span><font></font>
<font></font>
        *dos_date = <span class="hljs-number">0</span>;<font></font>
        *dos_date |= tm-&gt;tm_mday;             <span class="hljs-comment">/* Bits 0--4:  Day (1--31). */</span>
        *dos_date |= (tm-&gt;tm_mon + <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">5</span>;   <span class="hljs-comment">/* Bits 5--8:  Month (1--12). */</span>
        *dos_date |= (tm-&gt;tm_year - <span class="hljs-number">80</span>) &lt;&lt; <span class="hljs-number">9</span>; <span class="hljs-comment">/* Bits 9--15: Year from 1980. */</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><code>crc32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู </font><font style="vertical-align: inherit;">
ุงูุญูู </font><font style="vertical-align: inherit;">ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฉ ุงูุฑูุฒ ุงูุฒุงุฆุฏ ุงูุฏูุฑู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุจูุงูุงุช ุบูุฑ ุงููุถุบูุทุฉ. ูุชู ุงุณุชุฎุฏุงูู ููุชุญูู ูู ุณูุงูุฉ ุงูุจูุงูุงุช ุจุนุฏ ุงุณุชุฑุฌุงุนูุง. ุงูุชูููุฐ ููุง: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crc32.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<code>comp_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>uncomp_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญุชูุงุก ุญุฌู ูุถุบูุท ูุบูุฑ ูุถุบูุท ููุจูุงูุงุช ููู ุงูุจูุฏ. ุชุญุชูู ุงูุญููู ุงูุซูุงุซุฉ ุงูุชุงููุฉ ุนูู ุทูู ุงูุงุณู ูุงูุชุนููู ูุงูุจูุงูุงุช ุงูุฅุถุงููุฉ ุงูุชู ุชูู ุงูุนููุงู ูุจุงุดุฑุฉ. </font></font><code>disk_nbr_start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตููุฉ ููุฃุฑุดููุงุช ุจุงุณุชุฎุฏุงู ุฃูุฑุงุต ูุชุนุฏุฏุฉ. </font></font><br>
<br>
<code>int_attrs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>ext_attrs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตู ุงูุณูุงุช ุงูุฏุงุฎููุฉ ูุงูุฎุงุฑุฌูุฉ ูู ุงูููู. ุชุชุนูู ุงููููุงุช ุงูุฏุงุฎููุฉ ุจูุญุชููุงุช ุงูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุดูุฑ ุงูุจุช ุงูููุฎูุถ ุฅูู ูุง ุฅุฐุง ูุงู ุงูููู ูุญุชูู ุนูู ูุต ููุท. ุชุดูุฑ ุงูุณูุงุช ุงูุฎุงุฑุฌูุฉ ุฅูู ูุง ุฅุฐุง ูุงู ุงูููู ูุฎูููุง ุ ุฃู ูููุฑุงุกุฉ ููุท ุ ููุง ุฅูู ุฐูู. ูุนุชูุฏ ูุญุชูู ูุฐู ุงูุญููู ุนูู ูุธุงู ุงูุชุดุบูู ุ ุนูู ูุฌู ุงูุฎุตูุต ุ ุนูู</font></font><code>made_by_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ูู DOS ุ ุชุญุชูู ุงูุจุชุงุช ุงูุณูููุฉ 8 ุนูู ุจุงูุช ุณูุฉ ุงูููู ุ ูุงูุชู ูููู ุงูุญุตูู ุนูููุง ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int 21 / AX = 4300h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชุฏุนุงุก ุงููุธุงู </font><font style="vertical-align: inherit;">. ุนูู ุณุจูู ุงููุซุงู ุ ูุนูู ุงูุจุช 4 ุฃูู ุฏููู ุ ูุงูุจุช 5 ูุนูู ุฃูู ุชู ุชุนููู ุณูุฉ "ุงูุฃุฑุดูู" (ุตุญูุญ ููุนุธู ุงููููุงุช ูู DOS). ุจูุฏุฑ ูุง ุฃููู ุ ูู ุฃุฌู ุงูุชูุงูู ุ ูุชู ุชุนููู ูุฐู ุงูุจุชุงุช ุจุงููุซู ูู ุฃูุธูุฉ ุชุดุบูู ุฃุฎุฑู. ูู Unix ุ ุชุญุชูู ุงูุจุชุงุช ุงูู 16 ุงูุนุงููุฉ ูู ูุฐุง ุงูุญูู ุนูู ุจุชุงุช ูุถุน ุงูููู ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stat (2)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in </font></font><code>st_mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<code>lfh_offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุจุฑูุง ุนู ููุงู ุงูุจุญุซ ุนู ุฑุฃุณ ุงูููู ุงููุญูู. </font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุงุณู ุงูููู (C-line) ู </font></font><code>comment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุชุนููู ุงุฎุชูุงุฑู ูุนูุตุฑ ุงูุฃุฑุดูู ูุฐุง (C-line). </font></font><code>extra</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏ ุชุญุชูู ุนูู ุจูุงูุงุช ุฅุถุงููุฉ ุงุฎุชูุงุฑูุฉ ูุซู ูุนูููุงุช ุญูู ูุงูู ููู Unix ุฃู ุชุงุฑูุฎ ูููุช ุฃูุซุฑ ุฏูุฉ ููุชุบููุฑ ุฃู ุญููู Zip64.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุณุชุฎุฏู ูุฐู ุงููุธููุฉ ููุฑุงุกุฉ ุงูุฑุคูุณ ุงููุฑูุฒูุฉ ูููููุงุช:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Size of a Central File Header, not including name, extra, and comment. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CFH_BASE_SZ 46</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CFH_SIGNATURE 0x02014b50 <span class="hljs-comment">/* "PK\1\2" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">read_cfh</span><span class="hljs-params">(struct cfh *cfh, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len,
                     <span class="hljs-keyword">size_t</span> offset)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (offset &gt; src_len || src_len - offset &lt; CFH_BASE_SZ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;src[offset];<font></font>
        signature = READ32(p);<font></font>
        <span class="hljs-keyword">if</span> (signature != CFH_SIGNATURE) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        cfh-&gt;made_by_ver = READ16(p);<font></font>
        cfh-&gt;extract_ver = READ16(p);<font></font>
        cfh-&gt;gp_flag = READ16(p);<font></font>
        cfh-&gt;method = READ16(p);<font></font>
        cfh-&gt;mod_time = READ16(p);<font></font>
        cfh-&gt;mod_date = READ16(p);<font></font>
        cfh-&gt;crc32 = READ32(p);<font></font>
        cfh-&gt;comp_size = READ32(p);<font></font>
        cfh-&gt;uncomp_size = READ32(p);<font></font>
        cfh-&gt;name_len = READ16(p);<font></font>
        cfh-&gt;extra_len = READ16(p);<font></font>
        cfh-&gt;comment_len = READ16(p);<font></font>
        cfh-&gt;disk_nbr_start = READ16(p);<font></font>
        cfh-&gt;int_attrs = READ16(p);<font></font>
        cfh-&gt;ext_attrs = READ32(p);<font></font>
        cfh-&gt;lfh_offset = READ32(p);<font></font>
        cfh-&gt;name = p;<font></font>
        cfh-&gt;extra = cfh-&gt;name + cfh-&gt;name_len;<font></font>
        cfh-&gt;comment = cfh-&gt;extra + cfh-&gt;extra_len;<font></font>
        assert(p == &amp;src[offset + CFH_BASE_SZ] &amp;&amp; <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_len - offset - CFH_BASE_SZ &lt;<font></font>
            cfh-&gt;name_len + cfh-&gt;extra_len + cfh-&gt;comment_len) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_cfh</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct cfh *cfh)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, CFH_SIGNATURE);<font></font>
        WRITE16(p, cfh-&gt;made_by_ver);<font></font>
        WRITE16(p, cfh-&gt;extract_ver);<font></font>
        WRITE16(p, cfh-&gt;gp_flag);<font></font>
        WRITE16(p, cfh-&gt;method);<font></font>
        WRITE16(p, cfh-&gt;mod_time);<font></font>
        WRITE16(p, cfh-&gt;mod_date);<font></font>
        WRITE32(p, cfh-&gt;crc32);<font></font>
        WRITE32(p, cfh-&gt;comp_size);<font></font>
        WRITE32(p, cfh-&gt;uncomp_size);<font></font>
        WRITE16(p, cfh-&gt;name_len);<font></font>
        WRITE16(p, cfh-&gt;extra_len);<font></font>
        WRITE16(p, cfh-&gt;comment_len);<font></font>
        WRITE16(p, cfh-&gt;disk_nbr_start);<font></font>
        WRITE16(p, cfh-&gt;int_attrs);<font></font>
        WRITE32(p, cfh-&gt;ext_attrs);<font></font>
        WRITE32(p, cfh-&gt;lfh_offset);<font></font>
        assert(p - dst == CFH_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;name_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;name, cfh-&gt;name_len);<font></font>
                p += cfh-&gt;name_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;extra_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;extra, cfh-&gt;extra_len);<font></font>
                p += cfh-&gt;extra_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;comment, cfh-&gt;comment_len);<font></font>
                p += cfh-&gt;comment_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="22"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุฃุณ ููู ูุญูู</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณุจู ุจูุงูุงุช ูู ุนูุตุฑ ุฃุฑุดูู ุฑุฃุณ ููู ูุญูู ุ ูุงูุฐู ููุฑุฑ ูุนุธู ุงููุนูููุงุช ูู ุงูุฑุฃุณ ุงููุฑูุฒู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฑุจูุง ุชู ุฅุฏุฎุงู ุงุฒุฏูุงุฌูุฉ ุงูุจูุงูุงุช ูู ุงูุฑุคูุณ ุงููุฑูุฒูุฉ ูุงููุญููุฉ ุจุญูุซ ูุง ูุญุชูุธ PKZip ุจุงูุฏููู ุงููุฑูุฒู ุจุฃูููู ูู ุงูุฐุงูุฑุฉ ุนูุฏ ุชูุฑูุบู. ุจุฏูุงู ูู ุฐูู ุ ุฃุซูุงุก ุงุณุชุฎุฑุงุฌ ูู ููู ุ ูููู ูุฑุงุกุฉ ุงุณูู ููุนูููุงุช ุฃุฎุฑู ูู ุงูุนููุงู ุงููุญูู. ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชููุฏ ุงูุฑุคูุณ ุงููุญููุฉ ูู ุงุณุชุฑุฏุงุฏ ุงููููุงุช ูู ุฃุฑุดููุงุช Zip ุงูุชู ูููู ูููุง ุงูุฏููู ุงููุฑูุฒู ููููุฏูุง ุฃู ุชุงูููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุน ุฐูู ุ ูุฅู ูุฐุง ุงูุชูุฑุงุฑ ูู ุฃูุถูุง ุงููุตุฏุฑ ุงูุฑุฆูุณู ูุนุฏู ุงููููู. ุนูู ุณุจูู ุงููุซุงู ุ ูุงุฐุง ูุญุฏุซ ุฅุฐุง ูู ุชุชุทุงุจู ุฃุณูุงุก ุงููููุงุช ูู ุงูุฑุคูุณ ุงููุฑูุฒูุฉ ูุงููุญููุฉุ ุบุงูุจูุง ูุง ูุคุฏู ูุฐุง ุฅูู ุงูุฃุฎุทุงุก ููุดููุงุช ุงูุฃูุงู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูุชู ุชูุฑุงุฑ ุฌููุน ุงููุนูููุงุช ูู ุงูุนููุงู ุงููุฑูุฒู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุงูุญููู ุฐุงุช ุณูุงุช ุงูููู. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุฅุฐุง ุชู ุชุญุฏูุฏ ุงูุจุช ุงูุซุงูุซ ุงูุฃูู ุฃูููุฉ </font></font><code>gp_flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CRC-32) ุ ูุณูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุญููู ุงููุถุบูุทุฉ ูุบูุฑ ุงููุถุบูุทุฉ ุฅูู ุงูุตูุฑ ุ ููููู ุงูุนุซูุฑ ุนูู ูุฐู ุงููุนูููุงุช ูู ูุชูุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุตู ุงูุจูุงูุงุช</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุจูุงูุงุช ุงูููู ููุณู (ูู ูุฃุฎุฐูุง ุจุนูู ุงูุงุนุชุจุงุฑ). </font><font style="vertical-align: inherit;">ูุฐุง ูุณูุญ ูู ุจุชุณุฌูู ุฑุฃุณ ูุญูู ูุจู ุฃู ูุนุฑู ุญุฌู ููู ุงูุนูุตุฑ ุฃู ุฅูู ุฃู ุญุฌู ุณูุชู ุถุบุทู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุงูุนููุงู ุงููุญูู ุจุงูุชูููุน "P" ู "K" ู 3 ู 4 ุ ุซู ููุงู ูุซู ูุฐุง ุงููููู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Local File Header. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> {</span>
        <span class="hljs-keyword">uint16_t</span> extract_ver;
        <span class="hljs-keyword">uint16_t</span> gp_flag;
        <span class="hljs-keyword">uint16_t</span> method;
        <span class="hljs-keyword">uint16_t</span> mod_time;
        <span class="hljs-keyword">uint16_t</span> mod_date;
        <span class="hljs-keyword">uint32_t</span> crc32;
        <span class="hljs-keyword">uint32_t</span> comp_size;
        <span class="hljs-keyword">uint32_t</span> uncomp_size;
        <span class="hljs-keyword">uint16_t</span> name_len;
        <span class="hljs-keyword">uint16_t</span> extra_len;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *extra;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชููู ูุฐู ุงููุธุงุฆู ุจูุฑุงุกุฉ ููุชุงุจุฉ ุงูุนูุงููู ุงููุญููุฉ ุ ูุซู ููุงูู ุงูุจูุงูุงุช ุงูุฃุฎุฑู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Size of a Local File Header, not including name and extra. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LFH_BASE_SZ 30</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LFH_SIGNATURE 0x04034b50 <span class="hljs-comment">/* "PK\3\4" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">read_lfh</span><span class="hljs-params">(struct lfh *lfh, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len,
                     <span class="hljs-keyword">size_t</span> offset)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (offset &gt; src_len || src_len - offset &lt; LFH_BASE_SZ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;src[offset];<font></font>
        signature = READ32(p);<font></font>
        <span class="hljs-keyword">if</span> (signature != LFH_SIGNATURE) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        lfh-&gt;extract_ver = READ16(p);<font></font>
        lfh-&gt;gp_flag = READ16(p);<font></font>
        lfh-&gt;method = READ16(p);<font></font>
        lfh-&gt;mod_time = READ16(p);<font></font>
        lfh-&gt;mod_date = READ16(p);<font></font>
        lfh-&gt;crc32 = READ32(p);<font></font>
        lfh-&gt;comp_size = READ32(p);<font></font>
        lfh-&gt;uncomp_size = READ32(p);<font></font>
        lfh-&gt;name_len = READ16(p);<font></font>
        lfh-&gt;extra_len = READ16(p);<font></font>
        lfh-&gt;name = p;<font></font>
        lfh-&gt;extra = lfh-&gt;name + lfh-&gt;name_len;<font></font>
        assert(p == &amp;src[offset + LFH_BASE_SZ] &amp;&amp; <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_len - offset - LFH_BASE_SZ &lt; lfh-&gt;name_len + lfh-&gt;extra_len) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_lfh</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct lfh *lfh)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, LFH_SIGNATURE);<font></font>
        WRITE16(p, lfh-&gt;extract_ver);<font></font>
        WRITE16(p, lfh-&gt;gp_flag);<font></font>
        WRITE16(p, lfh-&gt;method);<font></font>
        WRITE16(p, lfh-&gt;mod_time);<font></font>
        WRITE16(p, lfh-&gt;mod_date);<font></font>
        WRITE32(p, lfh-&gt;crc32);<font></font>
        WRITE32(p, lfh-&gt;comp_size);<font></font>
        WRITE32(p, lfh-&gt;uncomp_size);<font></font>
        WRITE16(p, lfh-&gt;name_len);<font></font>
        WRITE16(p, lfh-&gt;extra_len);<font></font>
        assert(p - dst == LFH_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (lfh-&gt;name_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, lfh-&gt;name, lfh-&gt;name_len);<font></font>
                p += lfh-&gt;name_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (lfh-&gt;extra_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, lfh-&gt;extra, lfh-&gt;extra_len);<font></font>
                p += lfh-&gt;extra_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="23"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููุฐ Zip Read</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู ุงููุฐููุฑุฉ ุฃุนูุงู ุ ูููู ุจุชูููุฐ ูุฑุงุกุฉ ููู Zip ูู ุงูุฐุงูุฑุฉ ููุญุตู ุนูู ููุฑุฑ ูููุตูู ุฅูู ุนูุงุตุฑ ุงูุฃุฑุดูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">size_t</span> <span class="hljs-keyword">zipiter_t</span>; <span class="hljs-comment">/* Zip archive member iterator. */</span><font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zip_t</span> <span class="hljs-title">zip_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zip_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> num_members;    <span class="hljs-comment">/* Number of members. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;  <span class="hljs-comment">/* Zip file comment (not terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;    <span class="hljs-comment">/* Zip file comment length. */</span>
        <span class="hljs-keyword">zipiter_t</span> members_begin; <span class="hljs-comment">/* Iterator to the first member. */</span>
        <span class="hljs-keyword">zipiter_t</span> members_end;   <span class="hljs-comment">/* Iterator to the end of members. */</span><font></font>
<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src;
        <span class="hljs-keyword">size_t</span> src_len;<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize zip based on the source data. Returns true on success, or false
   if the data could not be parsed as a valid Zip file. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">zip_read</span><span class="hljs-params">(<span class="hljs-keyword">zip_t</span> *zip, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> <span class="hljs-title">eocdr</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">size_t</span> i, offset;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comp_data;<font></font>
<font></font>
        zip-&gt;src = src;<font></font>
        zip-&gt;src_len = src_len;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!find_eocdr(&amp;eocdr, src, src_len)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (eocdr.disk_nbr != <span class="hljs-number">0</span> || eocdr.cd_start_disk != <span class="hljs-number">0</span> ||<font></font>
            eocdr.disk_cd_entries != eocdr.cd_entries) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Cannot handle multi-volume archives. */</span><font></font>
        }<font></font>
<font></font>
        zip-&gt;num_members = eocdr.cd_entries;<font></font>
        zip-&gt;comment = eocdr.comment;<font></font>
        zip-&gt;comment_len = eocdr.comment_len;<font></font>
<font></font>
        offset = eocdr.cd_offset;<font></font>
        zip-&gt;members_begin = offset;<font></font>
<font></font>
        <span class="hljs-comment">/* Read the member info and do a few checks. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; eocdr.cd_entries; i++) {
                <span class="hljs-keyword">if</span> (!read_cfh(&amp;cfh, src, src_len, offset)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (cfh.gp_flag &amp; <span class="hljs-number">1</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* The member is encrypted. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.method != ZIP_STORED &amp;&amp; cfh.method != ZIP_DEFLATED) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Unsupported compression method. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.method == ZIP_STORED &amp;&amp;<font></font>
                    cfh.uncomp_size != cfh.comp_size) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.disk_nbr_start != <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Cannot handle multi-volume archives. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">memchr</span>(cfh.name, <span class="hljs-string">'\0'</span>, cfh.name_len) != <span class="hljs-literal">NULL</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Bad filename. */</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!read_lfh(&amp;lfh, src, src_len, cfh.lfh_offset)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                comp_data = lfh.extra + lfh.extra_len;<font></font>
                <span class="hljs-keyword">if</span> (cfh.comp_size &gt; src_len - (<span class="hljs-keyword">size_t</span>)(comp_data - src)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Member data does not fit in src. */</span><font></font>
                }<font></font>
<font></font>
                offset += CFH_BASE_SZ + cfh.name_len + cfh.extra_len +<font></font>
                          cfh.comment_len;<font></font>
        }<font></font>
<font></font>
        zip-&gt;members_end = offset;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุฐูุฑุช ุฃุนูุงู ุ ูุฅู ุชูุฑุงุฑุงุช ุงูุนูุงุตุฑ ูู ูุฌุฑุฏ ุฅุฒุงุญุฉ ูุฑุฃุณ ุงูููู ุงููุฑูุฒู ุงูุฐู ููููู ูู ุฎูุงูู ุงููุตูู ุฅูู ุจูุงูุงุช ุงูุนูุตุฑ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> { ZIP_STORED = <span class="hljs-number">0</span>, ZIP_DEFLATED = <span class="hljs-number">8</span> } <span class="hljs-keyword">method_t</span>;<font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zipmemb_t</span> <span class="hljs-title">zipmemb_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zipmemb_t</span> {</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;      <span class="hljs-comment">/* Member name (not null terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> name_len;        <span class="hljs-comment">/* Member name length. */</span>
        <span class="hljs-keyword">time_t</span> mtime;             <span class="hljs-comment">/* Modification time. */</span>
        <span class="hljs-keyword">uint32_t</span> comp_size;       <span class="hljs-comment">/* Compressed size. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comp_data; <span class="hljs-comment">/* Compressed data. */</span>
        <span class="hljs-keyword">method_t</span> method;          <span class="hljs-comment">/* Compression method. */</span>
        <span class="hljs-keyword">uint32_t</span> uncomp_size;     <span class="hljs-comment">/* Uncompressed size. */</span>
        <span class="hljs-keyword">uint32_t</span> crc32;           <span class="hljs-comment">/* CRC-32 checksum. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;   <span class="hljs-comment">/* Comment (not null terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;     <span class="hljs-comment">/* Comment length. */</span>
        <span class="hljs-keyword">bool</span> is_dir;              <span class="hljs-comment">/* Whether this is a directory. */</span>
        <span class="hljs-keyword">zipiter_t</span> next;           <span class="hljs-comment">/* Iterator to the next member. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Get the Zip archive member through iterator it. */</span>
<span class="hljs-function"><span class="hljs-keyword">zipmemb_t</span> <span class="hljs-title">zip_member</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">zip_t</span> *zip, <span class="hljs-keyword">zipiter_t</span> it)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">bool</span> ok;
        <span class="hljs-keyword">zipmemb_t</span> m;<font></font>
<font></font>
        assert(it &gt;= zip-&gt;members_begin &amp;&amp; it &lt; zip-&gt;members_end);<font></font>
<font></font>
        ok = read_cfh(&amp;cfh, zip-&gt;src, zip-&gt;src_len, it);<font></font>
        assert(ok);<font></font>
<font></font>
        ok = read_lfh(&amp;lfh, zip-&gt;src, zip-&gt;src_len, cfh.lfh_offset);<font></font>
        assert(ok);<font></font>
<font></font>
        m.name = cfh.name;<font></font>
        m.name_len = cfh.name_len;<font></font>
        m.mtime = dos2ctime(cfh.mod_date, cfh.mod_time);<font></font>
        m.comp_size = cfh.comp_size;<font></font>
        m.comp_data = lfh.extra + lfh.extra_len;<font></font>
        m.method = cfh.method;<font></font>
        m.uncomp_size = cfh.uncomp_size;<font></font>
        m.crc32 = cfh.crc32;<font></font>
        m.comment = cfh.comment;<font></font>
        m.comment_len = cfh.comment_len;<font></font>
        m.is_dir = (cfh.ext_attrs &amp; EXT_ATTR_DIR) != <span class="hljs-number">0</span>;<font></font>
<font></font>
        m.next = it + CFH_BASE_SZ +<font></font>
                 cfh.name_len + cfh.extra_len + cfh.comment_len;<font></font>
<font></font>
        assert(m.next &lt;= zip-&gt;members_end);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> m;<font></font>
}<font></font>
</code></pre><br>
<a name="24"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูููุฐ ุณุฌู Zip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุงุจุฉ ููู ูุถุบูุท ุฅูู ุงููุฎุฒู ุงููุคูุช ููุฐุงูุฑุฉ ุ ุชุญุชุงุฌ ุฃููุงู ุฅูู ูุนุฑูุฉ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ูู. </font><font style="vertical-align: inherit;">ูุจูุง ุฃููุง ูุง ูุนุฑู ููุฏุงุฑ ุงูุจูุงูุงุช ุงูุชู ุณูุถุบุทูุง ูุจู ุฃู ูุญุงูู ุงููุชุงุจุฉ ุ ูุฅููุง ูุญุณุจ ุงูุญุฏ ุงูุฃุนูู ุจูุงุกู ุนูู ุฃุญุฌุงู ุงูุนูุงุตุฑ ุบูุฑ ุงููุถุบูุทุฉ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Compute an upper bound on the dst size required by zip_write() for an
 * archive with num_memb members with certain filenames, sizes, and archive
 * comment. Returns zero on error, e.g. if a filename is longer than 2^16-1, or
 * if the total file size is larger than 2^32-1. */</span>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">zip_max_size</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> num_memb, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames,
                      <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint32_t</span> *file_sizes, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment)</span>
</span>{
        <span class="hljs-keyword">size_t</span> comment_len, name_len;
        <span class="hljs-keyword">uint64_t</span> total;
        <span class="hljs-keyword">uint16_t</span> i;<font></font>
<font></font>
        comment_len = (comment == <span class="hljs-literal">NULL</span> ? <span class="hljs-number">0</span> : <span class="hljs-built_in">strlen</span>(comment));
        <span class="hljs-keyword">if</span> (comment_len &gt; UINT16_MAX) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        total = EOCDR_BASE_SZ + comment_len; <span class="hljs-comment">/* EOCDR */</span><font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                assert(filenames[i] != <span class="hljs-literal">NULL</span>);<font></font>
                name_len = <span class="hljs-built_in">strlen</span>(filenames[i]);
                <span class="hljs-keyword">if</span> (name_len &gt; UINT16_MAX) {
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
<font></font>
                total += CFH_BASE_SZ + name_len; <span class="hljs-comment">/* Central File Header */</span>
                total += LFH_BASE_SZ + name_len; <span class="hljs-comment">/* Local File Header */</span>
                total += file_sizes[i];          <span class="hljs-comment">/* Uncompressed data size. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (total &gt; UINT32_MAX) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">uint32_t</span>)total;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุจ ูุฐุง ุงูุฑูุฒ ุงูููู ุงููุถุบูุท ุจุงุณุชุฎุฏุงู ุถุบุท ุงูููุงุด ูู ุนูุตุฑ ุ ููุง ูููู ุญุฌูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write a Zip file containing num_memb members into dst, which must be large
   enough to hold the resulting data. Returns the number of bytes written, which
   is guaranteed to be less than or equal to the result of zip_max_size() when
   called with the corresponding arguments. comment shall be a null-terminated
   string or null. callback shall be null or point to a function which will
   get called after the compression of each member. */</span>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">zip_write</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">uint16_t</span> num_memb,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-keyword">const</span> *file_data,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint32_t</span> *file_sizes,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">time_t</span> *mtimes,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment,
                   <span class="hljs-keyword">void</span> (*callback)(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">uint32_t</span> size,
                                    <span class="hljs-keyword">uint32_t</span> comp_size))</span>
</span>{
        <span class="hljs-keyword">uint16_t</span> i;
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> <span class="hljs-title">eocdr</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">bool</span> ok;
        <span class="hljs-keyword">uint16_t</span> name_len;
        <span class="hljs-keyword">uint8_t</span> *data_dst;
        <span class="hljs-keyword">size_t</span> comp_sz;
        <span class="hljs-keyword">uint32_t</span> lfh_offset, cd_offset, eocdr_offset;<font></font>
<font></font>
        p = dst;<font></font>
<font></font>
        <span class="hljs-comment">/* Write Local File Headers and deflated or stored data. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                assert(filenames[i] != <span class="hljs-literal">NULL</span>);<font></font>
                assert(<span class="hljs-built_in">strlen</span>(filenames[i]) &lt;= UINT16_MAX);<font></font>
                name_len = (<span class="hljs-keyword">uint16_t</span>)<span class="hljs-built_in">strlen</span>(filenames[i]);<font></font>
<font></font>
                data_dst = p + LFH_BASE_SZ + name_len;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (hwdeflate(file_data[i], file_sizes[i], data_dst,<font></font>
                              file_sizes[i], &amp;comp_sz) &amp;&amp;<font></font>
                                comp_sz &lt; file_sizes[i]) {<font></font>
                        lfh.method = ZIP_DEFLATED;<font></font>
                        assert(comp_sz &lt;= UINT32_MAX);<font></font>
                        lfh.comp_size = (<span class="hljs-keyword">uint32_t</span>)comp_sz;<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-built_in">memcpy</span>(data_dst, file_data[i], file_sizes[i]);<font></font>
                        lfh.method = ZIP_STORED;<font></font>
                        lfh.comp_size = file_sizes[i];<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (callback != <span class="hljs-literal">NULL</span>) {<font></font>
                        callback(filenames[i], file_sizes[i], lfh.comp_size);<font></font>
                }<font></font>
<font></font>
                lfh.extract_ver = (<span class="hljs-number">0</span> &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-number">20</span>; <span class="hljs-comment">/* DOS | PKZIP 2.0 */</span>
                lfh.gp_flag = (lfh.method == ZIP_DEFLATED ? (<span class="hljs-number">0x1</span> &lt;&lt; <span class="hljs-number">1</span>) : <span class="hljs-number">0x0</span>);<font></font>
                ctime2dos(mtimes[i], &amp;lfh.mod_date, &amp;lfh.mod_time);<font></font>
                lfh.crc32 = crc32(file_data[i], file_sizes[i]);<font></font>
                lfh.uncomp_size = file_sizes[i];<font></font>
                lfh.name_len = name_len;<font></font>
                lfh.extra_len = <span class="hljs-number">0</span>;<font></font>
                lfh.name = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>*)filenames[i];<font></font>
                p += write_lfh(p, &amp;lfh);<font></font>
                p += lfh.comp_size;<font></font>
        }<font></font>
<font></font>
        assert(p - dst &lt;= UINT32_MAX);<font></font>
        cd_offset = (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
<font></font>
        <span class="hljs-comment">/* Write the Central Directory based on the Local File Headers. */</span>
        lfh_offset = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                ok = read_lfh(&amp;lfh, dst, SIZE_MAX, lfh_offset);<font></font>
                assert(ok);<font></font>
<font></font>
                cfh.made_by_ver = lfh.extract_ver;<font></font>
                cfh.extract_ver = lfh.extract_ver;<font></font>
                cfh.gp_flag = lfh.gp_flag;<font></font>
                cfh.method = lfh.method;<font></font>
                cfh.mod_time = lfh.mod_time;<font></font>
                cfh.mod_date = lfh.mod_date;<font></font>
                cfh.crc32 = lfh.crc32;<font></font>
                cfh.comp_size = lfh.comp_size;<font></font>
                cfh.uncomp_size = lfh.uncomp_size;<font></font>
                cfh.name_len = lfh.name_len;<font></font>
                cfh.extra_len = <span class="hljs-number">0</span>;<font></font>
                cfh.comment_len = <span class="hljs-number">0</span>;<font></font>
                cfh.disk_nbr_start = <span class="hljs-number">0</span>;<font></font>
                cfh.int_attrs = <span class="hljs-number">0</span>;<font></font>
                cfh.ext_attrs = EXT_ATTR_ARC;<font></font>
                cfh.lfh_offset = lfh_offset;<font></font>
                cfh.name = lfh.name;<font></font>
                p += write_cfh(p, &amp;cfh);<font></font>
<font></font>
                lfh_offset += LFH_BASE_SZ + lfh.name_len + lfh.comp_size;<font></font>
        }<font></font>
<font></font>
        assert(p - dst &lt;= UINT32_MAX);<font></font>
        eocdr_offset = (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
<font></font>
        <span class="hljs-comment">/* Write the End of Central Directory Record. */</span>
        eocdr.disk_nbr = <span class="hljs-number">0</span>;<font></font>
        eocdr.cd_start_disk = <span class="hljs-number">0</span>;<font></font>
        eocdr.disk_cd_entries = num_memb;<font></font>
        eocdr.cd_entries = num_memb;<font></font>
        eocdr.cd_size = eocdr_offset - cd_offset;<font></font>
        eocdr.cd_offset = cd_offset;<font></font>
        eocdr.comment_len = (<span class="hljs-keyword">uint16_t</span>)(comment == <span class="hljs-literal">NULL</span> ? <span class="hljs-number">0</span> : <span class="hljs-built_in">strlen</span>(comment));<font></font>
        eocdr.comment = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>*)comment;<font></font>
        p += write_eocdr(p, &amp;eocdr);<font></font>
<font></font>
        assert(p - dst &lt;= zip_max_size(num_memb, filenames, file_sizes,<font></font>
                                       comment));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="25"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฒูุจ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูุญู ูุนุฑู ููููุฉ ูุฑุงุกุฉ ููุชุงุจุฉ ูููุงุช Zip ุ ูููููุฉ ุถุบุท ููู ุถุบุท ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูููุง. </font><font style="vertical-align: inherit;">ุงูุชุจ ุงูุขู ุจุฑูุงูุฌูุง ูุถุบูุทูุง ุจุณูุทูุง ูุญุชูู ุนูู ูู ูุฐู ุงูุฃุฏูุงุช. </font><font style="vertical-align: inherit;">ุงูููุฏ ูุชุงุญ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwzip.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุณุชุฎุฏู ูุงูุฑู ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุจุณูุทุฉ ูุงูุนุฏูุฏ ูู ุงููุธุงุฆู ุงูุฅุถุงููุฉ ูุชุฎุตูุต ุงูุฐุงูุฑุฉ ุงูุชู ุชู ูุญุตูุง:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PERROR_IF(cond, msg) <span class="hljs-meta-keyword">if</span> (cond) { perror(msg); exit(1); }</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">xmalloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> size)</span>
</span>{
        <span class="hljs-keyword">void</span> *ptr = <span class="hljs-built_in">malloc</span>(size);<font></font>
        PERROR_IF(ptr == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"malloc"</span>);
        <span class="hljs-keyword">return</span> ptr;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">xrealloc</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr, <span class="hljs-keyword">size_t</span> size)</span>
</span>{<font></font>
        ptr = <span class="hljs-built_in">realloc</span>(ptr, size);<font></font>
        PERROR_IF(ptr == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"realloc"</span>);
        <span class="hljs-keyword">return</span> ptr;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุงุณุชุฎุฏุงู ุงููุธููุชูู ุงูุฃุฎุฑููู ููุฑุงุกุฉ ุงููููุงุช ููุชุงุจุชูุง:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">read_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">size_t</span> *file_sz)</span>
</span>{<font></font>
        FILE *f;<font></font>
        <span class="hljs-keyword">uint8_t</span> *buf;
        <span class="hljs-keyword">size_t</span> buf_cap;<font></font>
<font></font>
        f = fopen(filename, <span class="hljs-string">"rb"</span>);<font></font>
        PERROR_IF(f == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"fopen"</span>);<font></font>
<font></font>
        buf_cap = <span class="hljs-number">4096</span>;<font></font>
        buf = xmalloc(buf_cap);<font></font>
<font></font>
        *file_sz = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (feof(f) == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (buf_cap - *file_sz == <span class="hljs-number">0</span>) {<font></font>
                        buf_cap *= <span class="hljs-number">2</span>;<font></font>
                        buf = xrealloc(buf, buf_cap);<font></font>
                }<font></font>
<font></font>
                *file_sz += fread(&amp;buf[*file_sz], <span class="hljs-number">1</span>, buf_cap - *file_sz, f);<font></font>
                PERROR_IF(ferror(f), <span class="hljs-string">"fread"</span>);<font></font>
        }<font></font>
<font></font>
        PERROR_IF(fclose(f) != <span class="hljs-number">0</span>, <span class="hljs-string">"fclose"</span>);
        <span class="hljs-keyword">return</span> buf;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *data, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        FILE *f;<font></font>
<font></font>
        f = fopen(filename, <span class="hljs-string">"wb"</span>);<font></font>
        PERROR_IF(f == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"fopen"</span>);<font></font>
        PERROR_IF(fwrite(data, <span class="hljs-number">1</span>, n, f) != n, <span class="hljs-string">"fwrite"</span>);<font></font>
        PERROR_IF(fclose(f) != <span class="hljs-number">0</span>, <span class="hljs-string">"fclose"</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูุจุฑูุงูุฌ Zip ุงูุฎุงุต ุจูุง ุชูููุฐ ุซูุงุซ ูุธุงุฆู: ุนูู ูุงุฆูุฉ ุจูุญุชููุงุช ูููุงุช Zip ูุงุณุชุฎุฑุงุฌูุง ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฅูุดุงุก ูููุงุช Zip. </font><font style="vertical-align: inherit;">ุงูุฅุฏุฑุงุฌ ูู ุฃู ููุงู ุฃุจุณุท:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">list_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">size_t</span> zip_sz;
        <span class="hljs-keyword">zip_t</span> z;
        <span class="hljs-keyword">zipiter_t</span> it;
        <span class="hljs-keyword">zipmemb_t</span> m;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Listing ZIP archive: %s\n\n"</span>, filename);<font></font>
<font></font>
        zip_data = read_file(filename, &amp;zip_sz);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!zip_read(&amp;z, zip_data, zip_sz)) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Failed to parse ZIP file!\n"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (z.comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n\n"</span>, (<span class="hljs-keyword">int</span>)z.comment_len, z.comment);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (it = z.members_begin; it != z.members_end; it = m.next) {<font></font>
                m = zip_member(&amp;z, it);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n"</span>, (<span class="hljs-keyword">int</span>)m.name_len, m.name);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-built_in">free</span>(zip_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุงุณุชุฎุฑุงุฌ ุฃูุซุฑ ุชุนููุฏูุง ููููุงู. </font><font style="vertical-align: inherit;">ุณูุณุชุฎุฏู ุงูุฏูุงู ุงูุฅุถุงููุฉ ูุฅููุงุก ุงุณู ุงูููู (ูุชูุฑูุฑู ุฅููู </font></font><code>fopen</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ูุชูุฑูุบู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">char</span> *<span class="hljs-title">terminate_str</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *str, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">char</span> *p = xmalloc(n + <span class="hljs-number">1</span>);
        <span class="hljs-built_in">memcpy</span>(p, str, n);<font></font>
        p[n] = <span class="hljs-string">'\0'</span>;
        <span class="hljs-keyword">return</span> p;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">inflate_member</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">zipmemb_t</span> *m)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">size_t</span> src_used, dst_used;<font></font>
<font></font>
        assert(m-&gt;method == ZIP_DEFLATED);<font></font>
<font></font>
        p = xmalloc(m-&gt;uncomp_size);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (hwinflate(m-&gt;comp_data, m-&gt;comp_size, &amp;src_used, p, m-&gt;uncomp_size,<font></font>
                      &amp;dst_used) != HWINF_OK) {<font></font>
                <span class="hljs-built_in">free</span>(p);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_used != m-&gt;comp_size || dst_used != m-&gt;uncomp_size) {
                <span class="hljs-built_in">free</span>(p);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> p;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชุฎุทู ุจุฑูุงูุฌูุง ุฃู ุนูุงุตุฑ ุฃุฑุดูู ููุง ุฃุฏูุฉ. </font><font style="vertical-align: inherit;">ูุชู ุฐูู ูู ุฃุฌู ุชุฌูุจ ูุง ูุณูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุฌูุงุช ุงุฌุชูุงุฒ ุงููุณุงุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ูุชู ุงุณุชุฎุฏุงู ุฃุฑุดูู ุถุงุฑ ููุชุงุจุฉ ุงูููู ูู ุฎุงุฑุฌ ุงูุฏููู ุงููุญุฏุฏ ูู ูุจู ุงููุณุชุฎุฏู. </font><font style="vertical-align: inherit;">ุงูุฑุฃ ุงูุชูุงุตูู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุณุฆูุฉ ุงููุชุฏุงููุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">Info-ZIP</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">extract_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">size_t</span> zip_sz;
        <span class="hljs-keyword">zip_t</span> z;
        <span class="hljs-keyword">zipiter_t</span> it;
        <span class="hljs-keyword">zipmemb_t</span> m;
        <span class="hljs-keyword">char</span> *tname;
        <span class="hljs-keyword">uint8_t</span> *inflated;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *uncomp_data;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Extracting ZIP archive: %s\n\n"</span>, filename);<font></font>
<font></font>
        zip_data = read_file(filename, &amp;zip_sz);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!zip_read(&amp;z, zip_data, zip_sz)) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Failed to read ZIP file!\n"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (z.comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n\n"</span>, (<span class="hljs-keyword">int</span>)z.comment_len, z.comment);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (it = z.members_begin; it != z.members_end; it = m.next) {<font></font>
                m = zip_member(&amp;z, it);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (m.is_dir) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (Skipping dir: %.*s)\n"</span>,<font></font>
                               (<span class="hljs-keyword">int</span>)m.name_len, m.name);
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">memchr</span>(m.name, <span class="hljs-string">'/'</span>,  m.name_len) != <span class="hljs-literal">NULL</span> ||
                    <span class="hljs-built_in">memchr</span>(m.name, <span class="hljs-string">'\\'</span>, m.name_len) != <span class="hljs-literal">NULL</span>) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (Skipping file in dir: %.*s)\n"</span>,<font></font>
                               (<span class="hljs-keyword">int</span>)m.name_len, m.name);
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                assert(m.method == ZIP_STORED || m.method == ZIP_DEFLATED);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">" %s: %.*s"</span>,<font></font>
                       m.method == ZIP_STORED ? <span class="hljs-string">"Extracting"</span> : <span class="hljs-string">" Inflating"</span>,<font></font>
                       (<span class="hljs-keyword">int</span>)m.name_len, m.name);<font></font>
                fflush(<span class="hljs-built_in">stdout</span>);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (m.method == ZIP_STORED) {<font></font>
                        assert(m.uncomp_size == m.comp_size);<font></font>
                        inflated = <span class="hljs-literal">NULL</span>;<font></font>
                        uncomp_data = m.comp_data;<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                        inflated = inflate_member(&amp;m);<font></font>
                        <span class="hljs-keyword">if</span> (inflated == <span class="hljs-literal">NULL</span>) {
                                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error: inflation failed!\n"</span>);
                                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                        }<font></font>
                        uncomp_data = inflated;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (crc32(uncomp_data, m.uncomp_size) != m.crc32) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error: CRC-32 mismatch!\n"</span>);
                        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                }<font></font>
<font></font>
                tname = terminate_str((<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)m.name, m.name_len);<font></font>
                write_file(tname, uncomp_data, m.uncomp_size);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
                <span class="hljs-built_in">free</span>(inflated);
                <span class="hljs-built_in">free</span>(tname);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
        <span class="hljs-built_in">free</span>(zip_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅูุดุงุก ุฃุฑุดูู ูุถุบูุท ุ ุณููุฑุฃ ูููุงุช ุงูุฅุฏุฎุงู ููุทุนููุง </font></font><code>zip_write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ููุชุจุฉ C ุงูููุงุณูุฉ ูุง ุชุณูุญ ูู ุจุงูุญุตูู ุนูู ููุช ุชุนุฏูู ุงูููู ุ ูุณูู ูุณุชุฎุฏู ุงูููุช ุงูุญุงูู (ุฃุชุฑู ูุฐุง ููุงุฌุจ ููุฒูู ูุฅุตูุงุญ ูุฐู ุงูููุฒุฉ).</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">zip_callback</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">uint32_t</span> size, <span class="hljs-keyword">uint32_t</span> comp_size)</span>
</span>{
        <span class="hljs-keyword">bool</span> deflated = comp_size &lt; size;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" %s: %s"</span>, deflated ? <span class="hljs-string">"Deflated"</span> : <span class="hljs-string">"  Stored"</span>, filename);
        <span class="hljs-keyword">if</span> (deflated) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (%u%%)"</span>, <span class="hljs-number">100</span> - <span class="hljs-number">100</span> * comp_size / size);<font></font>
        }<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">create_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *zip_filename, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment,
                       <span class="hljs-keyword">uint16_t</span> n, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames)</span>
</span>{
        <span class="hljs-keyword">time_t</span> mtime;
        <span class="hljs-keyword">time_t</span> *mtimes;
        <span class="hljs-keyword">uint8_t</span> **file_data;
        <span class="hljs-keyword">uint32_t</span> *file_sizes;
        <span class="hljs-keyword">size_t</span> file_size, zip_size;
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">uint16_t</span> i;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Creating ZIP archive: %s\n\n"</span>, zip_filename);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (comment != <span class="hljs-literal">NULL</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n\n"</span>, comment);<font></font>
        }<font></font>
<font></font>
        mtime = time(<span class="hljs-literal">NULL</span>);<font></font>
<font></font>
        file_data = xmalloc(<span class="hljs-keyword">sizeof</span>(*file_data) * n);<font></font>
        file_sizes = xmalloc(<span class="hljs-keyword">sizeof</span>(*file_sizes) * n);<font></font>
        mtimes = xmalloc(<span class="hljs-keyword">sizeof</span>(*mtimes) * n);<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                file_data[i] = read_file(filenames[i], &amp;file_size);<font></font>
                <span class="hljs-keyword">if</span> (file_size &gt;= UINT32_MAX) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s is too large!\n"</span>, filenames[i]);
                        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                }<font></font>
                file_sizes[i] = (<span class="hljs-keyword">uint32_t</span>)file_size;<font></font>
                mtimes[i] = mtime;<font></font>
        }<font></font>
<font></font>
        zip_size = zip_max_size(n, filenames, file_sizes, comment);<font></font>
        <span class="hljs-keyword">if</span> (zip_size == <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"zip writing not possible"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        zip_data = xmalloc(zip_size);<font></font>
        zip_size = zip_write(zip_data, n, filenames,<font></font>
                             (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-keyword">const</span> *)file_data,<font></font>
                             file_sizes, mtimes, comment, zip_callback);<font></font>
<font></font>
        write_file(zip_filename, zip_data, zip_size);<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-built_in">free</span>(zip_data);
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {
                <span class="hljs-built_in">free</span>(file_data[i]);<font></font>
        }<font></font>
        <span class="hljs-built_in">free</span>(mtimes);
        <span class="hljs-built_in">free</span>(file_sizes);
        <span class="hljs-built_in">free</span>(file_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุฎูุฑูุง ุ </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญูู ูู ุญุฌุฌ ุณุทุฑ ุงูุฃูุงูุฑ ูููุฑุฑ ูุง ูุฌุจ ูุนูู:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_usage</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *argv0)</span>
</span>{
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Usage:\n\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s list &lt;zipfile&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s extract &lt;zipfile&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s create &lt;zipfile&gt; [-c &lt;comment&gt;] &lt;files...&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>{
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"HWZIP "</span> VERSION <span class="hljs-string">" -- A very simple ZIP program "</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"from https://www.hanshq.net/zip.html\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"list"</span>) == <span class="hljs-number">0</span>) {<font></font>
                list_zip(argv[<span class="hljs-number">2</span>]);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"extract"</span>) == <span class="hljs-number">0</span>) {<font></font>
                extract_zip(argv[<span class="hljs-number">2</span>]);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argc &gt;= <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"create"</span>) == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (argc &gt;= <span class="hljs-number">5</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">3</span>], <span class="hljs-string">"-c"</span>) == <span class="hljs-number">0</span>) {<font></font>
                        create_zip(argv[<span class="hljs-number">2</span>], argv[<span class="hljs-number">4</span>], (<span class="hljs-keyword">uint16_t</span>)(argc - <span class="hljs-number">5</span>),<font></font>
                                   (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *)&amp;argv[<span class="hljs-number">5</span>]);<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                        create_zip(argv[<span class="hljs-number">2</span>], <span class="hljs-literal">NULL</span>, (<span class="hljs-keyword">uint16_t</span>)(argc - <span class="hljs-number">3</span>),<font></font>
                                   (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *)&amp;argv[<span class="hljs-number">3</span>]);<font></font>
                }<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
                print_usage(argv[<span class="hljs-number">0</span>]);
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="26"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูููุงุช ุงูุชุฌููุน</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุชููุฑ ูุฌููุนุฉ ูุงููุฉ ูู ูููุงุช ุงููุตุฏุฑ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwzip-1.0.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููููุฉ ุชุฌููุน HWZip ุชุญุช Linux ุฃู Mac:</font></font><br>
<br>
<pre><code class="cpp hljs">$ clang generate_tables.c &amp;&amp; ./a.out &gt; tables.c<font></font>
$ clang -O3 -DNDEBUG -march=native -o hwzip crc32.c deflate.c huffman.c \<font></font>
        hwzip.c lz77.c tables.c zip.c<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู Windows ุ ูู ููุฌู ุฃูุงูุฑ ุงููุทูุฑ ูู Visual Studio (ุฅุฐุง ูู ููู ูุฏูู Visual Studio ุ ููู ุจุชูุฒูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฏูุงุช ุงูุจูุงุก</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="cpp hljs">cl /TC generate_tables.c &amp;&amp; generate_tables &gt; tables.c<font></font>
cl /O2 /DNDEBUG /MT /Fehwzip.exe /TC crc32.c deflate.c huffman.c hwzip.c<font></font>
        lz77.c tables.c zip.c /link setargv.obj<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setargv.obj </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุณูุน ูุณูุทุงุช ุณุทุฑ ุฃูุงูุฑ ุญุฑู ุงูุจุฏู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .)</font></font><br>
<br>
<a name="27"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชูุชุงุฌ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุฏูุด ููู ุชุชุทูุฑ ุงูุชูููููุฌูุง ุจุณุฑุนุฉ ูุจุทุก. </font><font style="vertical-align: inherit;">ุชู ุฅูุดุงุก ุชูุณูู Zip ูุจู 30 ุนุงููุง ุงุณุชูุงุฏูุง ุฅูู ุงูุชูููููุฌูุง ูู ุงูุฎูุณููุงุช ูุงูุณุจุนููุงุช. </font><font style="vertical-align: inherit;">ูุนูู ุงูุฑุบู ูู ุชุบูุฑ ุงููุซูุฑ ููุฐ ุฐูู ุงูุญูู ุ ุฅูุง ุฃู ุงููููุงุช ุงููุถุบูุทุฉ ุ ูู ุงููุงูุน ุ ุธูุช ููุง ูู ุ ููู ุงูููู ุฃูุซุฑ ุดููุนูุง ูู ุฃู ููุช ูุถู. </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃูู ุณูููู ูู ุงููููุฏ ุงูุญุตูู ุนูู ููู ุฌูุฏ ูููููุฉ ุนูููู.</font></font><br>
<br>
<a name="28"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุงุฑูู</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฌุนู HWZip ูุณุฌู ุงูููุช ุงูุฐู ูุณุชุบุฑูู ูู ููู ููุชุบููุฑ ุ ุจุฏูุงู ูู ุงูููุช ุงูุญุงูู ุงูุฐู ุชู ููู ุฅูุดุงุก ุงูุฃุฑุดูู. </font><font style="vertical-align: inherit;">ุงุณุชุฎุฏู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stat (2)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู Linux ุฃู Mac ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetFileTime</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู Windows. </font><font style="vertical-align: inherit;">ุฃู ุฃุถู ุนูุงูุฉ ุณุทุฑ ุฃูุงูุฑ ุชุณูุญ ูููุณุชุฎุฏู ุจุชุนููู ููุช ูุญุฏุฏ ูุชุบููุฑุงุช ุงูููู.</font></font></li>
<li>              gzip-.   โ    ,    Deflate (   ).    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RFC 1952</a>.</li>
<li>    Zip-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">   </a>.  HWZip ,   <code>read_file</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">mmap(2)</a>  Linux  Mac  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CreateFileMapping</a>  Windows.</li>
<li> HWZip ,          Zip64.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> appnote.txt</a>.</li>
</ul><br>
<a name="29"></a><h2> </h2><br>
<ul>
<li>  BBS-   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BBS: The Documentary</a>.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> YouTube</a>.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Part 8: Compression</a>    SEA  PKWare.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  </a>.</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">A better Zip bomb</a>    Zip-,    ยซยป    .</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Zip Files All The Way Down</a> ,   <i>Zip-</i> โ ,    .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ascii-zip</a> โ  ,  Deflate-   ASCII-.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Rosetta Flash</a>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ten Thousand Security Pitfalls: the Zip File Format</a> โ        .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Reading bits in far too many ways part 1</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">part 2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">part 3</a> โ       .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Understanding Compression</a>      .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar490780/index.html">Intel Xeon Scalable Gen2: Big Sale of Cores</a></li>
<li><a href="../ar490782/index.html">ูุคุชูุฑ AnalogBytes: Roskomnadzor ุ ูุณุงุฆุท ุ ุญูููุฉ ุนุงููุฉ ููู ุดูุก ุงููู</a></li>
<li><a href="../ar490784/index.html">ุฃูุง ูุทูุฑ Android ููุง ุฃุฑุบุจ ูู ุงูุนูู ุงููุฏูู.</a></li>
<li><a href="../ar490786/index.html">ุชุญููู ุงูุชุณุฑุจ ูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ: ุนูุฏูุง ูุชุณุฑุจ ูู ุฃููุฆู ุงูุฐูู ูุณุฑููู ุงูุจูุงูุงุช ูู ุงูุจูู</a></li>
<li><a href="../ar490788/index.html">REPL ุนุฏูู ุงูุฌุฏูู. ุชูุฑูุฑ ูุงูุฏูุณ</a></li>
<li><a href="../ar490792/index.html">VXLAN ูู NSX-V - ุทุจูุฉ ุณูููุฉ ูุถุทุฑุจุฉ</a></li>
<li><a href="../ar490796/index.html">ููููุฉ ุฃุชูุชุฉ ุฃูู ุงูุญุงููุงุช ุจุฃุณููุจ ุงูุณูุงุณุฉ ูุฑูุฒ ุจุงุณุชุฎุฏุงู CRD</a></li>
<li><a href="../ar490804/index.html">ููู ุฏุฎูุช ูุงูุฏุฉ ุงููุฑุงุตูุฉ ุฅูู ุงูุณุฌู ูุฃุตุงุจุช ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจุงูุฑุฆูุณ</a></li>
<li><a href="../ar490808/index.html">ุงูุฑูุงุถูุงุช ูู ุนูู ุงููุถุงุก: ูุญุฑู ุงูุชูุฌูุฑ ุงูุฏูุฑุงูู</a></li>
<li><a href="../ar490812/index.html">ุงูุดูุงุฏุงุช ุงูููููุฉ ุงูุฑุจูุน 5 ุชุฌุฑุจุฉ ุชูุฏูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>