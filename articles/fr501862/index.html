<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚öñÔ∏è üå©Ô∏è üë®üèæ‚Äçüéì Flotter sous le capot ü§±üèΩ ‚õπüèº üçñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! Je m'appelle Mikhail Zotiev, je travaille en tant que d√©veloppeur Flutter chez Surf. Moi, comme probablement la majorit√© des autres d√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Flotter sous le capot</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/501862/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour √† tous! Je m'appelle Mikhail Zotiev, je travaille en tant que d√©veloppeur Flutter chez Surf. Moi, comme probablement la majorit√© des autres d√©veloppeurs qui travaillent avec Flutter, j'aime surtout combien il est facile de cr√©er des applications belles et pratiques avec son aide. Il faut tr√®s peu de temps pour entrer dans le d√©veloppement de Flutter. J'ai r√©cemment travaill√© dans le d√©veloppement de jeux, et maintenant je suis compl√®tement pass√© au d√©veloppement mobile multiplateforme sur Flutter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelle est la simplicit√©? </font><font style="vertical-align: inherit;">Avec une douzaine de widgets de base, vous pouvez cr√©er des interfaces utilisateur assez d√©centes. </font><font style="vertical-align: inherit;">Et au fil du temps, lorsque les bagages utilis√©s sont assez d√©cents, il est peu probable qu'une t√¢che vous arr√™te: que ce soit un design inhabituel ou une animation sophistiqu√©e. </font><font style="vertical-align: inherit;">Et le plus int√©ressant - tr√®s probablement vous pouvez l'utiliser sans m√™me penser √† la question: "Comment √ßa marche du tout?" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis Flutter a l'open source, j'ai d√©cid√© de comprendre ce qui est sous le capot (du c√¥t√© Dart de la Force) et de le partager avec vous.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lg/ln/q6/lglnq6t8sbc8gq-emifhx1dxjwu.png"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widget</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons tous entendu plus d'une fois la phrase de l'√©quipe de d√©veloppement du framework: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tout dans Flutter est un widget</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">" </font></i><font style="vertical-align: inherit;">Voyons voir si c'est vraiment le cas. </font><font style="vertical-align: inherit;">Pour ce faire, nous nous tournons vers la classe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Widget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ci-apr√®s - le widget) et commen√ßons progressivement √† nous familiariser avec le contenu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re chose que nous lirons dans la documentation de la classe:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©crit la configuration d'un [√©l√©ment].</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'av√®re que le widget lui-m√™me n'est qu'une description d'un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©l√©ment</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ci-apr√®s - l'√©l√©ment).</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les widgets sont la hi√©rarchie centrale des classes dans le framework Flutter. </font><font style="vertical-align: inherit;">Un widget est une description immuable d'une partie d'une interface utilisateur. </font><font style="vertical-align: inherit;">Les widgets peuvent √™tre gonfl√©s en √©l√©ments, qui g√®rent l'arborescence de rendu sous-jacente.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour r√©sumer, l'expression </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tout dans Flutter est un widget"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le niveau minimum de compr√©hension de la fa√ßon dont tout est organis√© pour utiliser Flutter. </font><font style="vertical-align: inherit;">Le widget est la classe centrale de la hi√©rarchie Flutter. </font><font style="vertical-align: inherit;">En m√™me temps, il existe de nombreux m√©canismes suppl√©mentaires qui aident le cadre √† faire face √† sa t√¢che. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc appris quelques faits suppl√©mentaires:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - une description immuable d'une partie de l'interface utilisateur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le widget est associ√© √† une vue avanc√©e appel√©e √©l√©ment; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un √©l√©ment contr√¥le une entit√© de l'arbre de rendu.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez avoir remarqu√© une chose √©trange. </font><font style="vertical-align: inherit;">L'interface utilisateur et l'immuabilit√© sont tr√®s mal li√©es, je dirais m√™me que ce sont des concepts totalement incompatibles. </font><font style="vertical-align: inherit;">Mais nous y reviendrons quand une image plus compl√®te de l'appareil du monde Flutter √©mergera, mais pour l'instant, nous continuerons √† nous familiariser avec la documentation du widget.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les widgets eux-m√™mes n'ont pas d'√©tat mutable (tous leurs champs doivent √™tre d√©finitifs). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez associer un √©tat mutable √† un widget, envisagez d'utiliser un [StatefulWidget], qui cr√©e un objet [State] (via [StatefulWidget.createState]) chaque fois qu'il est gonfl√© dans un √©l√©ment et incorpor√© dans l'arborescence.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce paragraphe compl√®te un peu le premier paragraphe: si nous avons besoin d'une configuration mutable, nous utilisons l'entit√© sp√©ciale </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">State</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ci-apr√®s d√©nomm√©e l'√©tat), qui d√©crit l'√©tat actuel de ce widget. </font><font style="vertical-align: inherit;">Cependant, l'√©tat n'est pas associ√© au widget, mais √† sa repr√©sentation √©l√©mentaire.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un widget donn√© peut √™tre inclus dans l'arbre z√©ro ou plusieurs fois. </font><font style="vertical-align: inherit;">En particulier, un widget donn√© peut √™tre plac√© plusieurs fois dans l'arborescence. </font><font style="vertical-align: inherit;">Chaque fois qu'un widget est plac√© dans l'arbre, il est gonfl√© dans un [Element], ce qui signifie qu'un widget qui est incorpor√© plusieurs fois dans l'arbre sera gonfl√© plusieurs fois.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le m√™me widget peut √™tre inclus plusieurs fois dans l'arborescence des widgets, ou ne pas √™tre inclus du tout. </font><font style="vertical-align: inherit;">Mais chaque fois qu'un widget est inclus dans l'arborescence des widgets, un √©l√©ment lui est mapp√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, √† ce stade, les widgets sont presque termin√©s, r√©sumons:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - la classe centrale de la hi√©rarchie;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget est une configuration; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widget - une description immuable d'une partie de l'interface utilisateur; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le widget est associ√© √† un √©l√©ment qui contr√¥le le rendu d'une mani√®re ou d'une autre; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'√©tat changeant du widget peut √™tre d√©crit par une entit√©, mais il n'est pas connect√© au widget, mais √† l'√©l√©ment qui repr√©sente ce widget.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âl√©ment</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'apr√®s ce que nous avons appris, la question se pose: ¬´Quels sont ces √©l√©ments qui r√©gissent tout?¬ª </font><font style="vertical-align: inherit;">Faites de m√™me - ouvrez la documentation de la classe Element.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une instanciation d'un [Widget] √† un emplacement particulier dans l'arborescence.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un √©l√©ment est une repr√©sentation d'un widget √† un endroit sp√©cifique dans un arbre.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les widgets d√©crivent comment configurer un sous-arbre, mais le m√™me widget peut √™tre utilis√© pour configurer plusieurs sous-arbres simultan√©ment car les widgets sont immuables. </font><font style="vertical-align: inherit;">Un [Element] repr√©sente l'utilisation d'un widget pour configurer un emplacement sp√©cifique dans l'arborescence. </font><font style="vertical-align: inherit;">Au fil du temps, le widget associ√© √† un √©l√©ment donn√© peut changer, par exemple, si le widget parent se reconstruit et cr√©e un nouveau widget pour cet emplacement.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le widget d√©crit la configuration d'une partie de l'interface utilisateur, mais comme nous le savons d√©j√†, le m√™me widget peut √™tre utilis√© √† diff√©rents endroits de l'arborescence. Chacun de ces lieux sera repr√©sent√© par un √©l√©ment correspondant. Mais au fil du temps, le widget associ√© √† l'√©l√©ment peut changer. Cela signifie que les √©l√©ments sont plus tenaces et continuent d'√™tre utilis√©s, ne mettant √† jour que leurs connexions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une d√©cision assez rationnelle. Comme nous l'avons d√©j√† d√©fini ci-dessus, les widgets sont une configuration immuable qui d√©crit simplement une partie sp√©cifique de l'interface, ce qui signifie qu'ils doivent √™tre tr√®s l√©gers. Et les √©l√©ments dans le domaine desquels la gestion est beaucoup plus lourde, mais ils ne sont pas recr√©√©s inutilement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour comprendre comment cela se fait, consid√©rez le cycle de vie d'un √©l√©ment:</font></font><br>
<br>
<ul>
<li>     Widget.createElement    ,     .</li>
<li>   mount        .              .</li>
<li>       .</li>
<li>   ,    (,    ),     .       runtimeType  key,     .   ,     ,           .</li>
<li> ,       ,    ,             ,      (  deactivate).</li>
<li>   ,     .           ,       ,   (unmount),           .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque vous r√©-incluez des √©l√©ments dans l'arborescence, par exemple, si l'√©l√©ment ou ses anc√™tres ont une cl√© globale, elle sera supprim√©e de la liste des √©l√©ments inactifs, la m√©thode activate sera appel√©e et l'objet rendu associ√© √† cet √©l√©ment sera √† nouveau incorpor√© dans l'arborescence de rendu. </font><font style="vertical-align: inherit;">Cela signifie que l'√©l√©ment devrait r√©appara√Ætre √† l'√©cran.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la d√©claration de classe, nous voyons que l'√©l√©ment impl√©mente l'interface BuildContext. </font><font style="vertical-align: inherit;">Un BuildContext est quelque chose qui contr√¥le la position d'un widget dans une arborescence de widgets, comme suit dans sa documentation. </font><font style="vertical-align: inherit;">Correspond presque exactement √† la description de l'article. </font><font style="vertical-align: inherit;">Cette interface est utilis√©e pour √©viter la manipulation directe de l'√©l√©ment, mais donne en m√™me temps acc√®s aux m√©thodes de contexte n√©cessaires. </font><font style="vertical-align: inherit;">Par exemple, findRenderObject, qui vous permet de trouver l'objet d'arbre de rendu correspondant √† cet √©l√©ment.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renderderbject</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste √† traiter du dernier maillon de cette triade - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RenderObject</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Comme son nom l'indique, il s'agit d'un objet de l'arbre de visualisation. Il a un objet parent, ainsi qu'un champ de donn√©es que l'objet parent utilise pour stocker des informations sp√©cifiques concernant cet objet lui-m√™me, par exemple, sa position. Cet objet est responsable de l'impl√©mentation des protocoles de rendu et de mise en page de base.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RenderObject ne limite pas le mod√®le d'utilisation des objets enfants: il peut n'y en avoir aucun, un ou plusieurs. </font><font style="vertical-align: inherit;">En outre, le syst√®me de positionnement n'est pas limit√© √†: le syst√®me cart√©sien, les coordonn√©es polaires, tout cela et bien plus encore est disponible pour utilisation. </font><font style="vertical-align: inherit;">Il n'y a pas de restrictions sur l'utilisation des protocoles de localisation: ajuster la largeur ou la hauteur, limiter la taille, sp√©cifier la taille et l'emplacement du parent ou, si n√©cessaire, utiliser les donn√©es de l'objet parent.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image du monde Flutter</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons de construire une vue d'ensemble de la fa√ßon dont tout fonctionne ensemble. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous l'avons d√©j√† not√© ci-dessus, le widget est une description immuable, mais l'interface utilisateur n'est pas du tout statique. </font><font style="vertical-align: inherit;">Cet √©cart est supprim√© en divisant en 3 niveaux d'objets et la division des zones de responsabilit√©.</font></font><br>
<br>
<ul>
<li> ,          . </li>
<li> ,               . </li>
<li>  ,   ‚Äî ,     .</li>
</ul><br>
<img src="https://habrastorage.org/webt/j_/n_/og/j_n_ogui1a0iawbuoq5vxclsnne.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voyons √† quoi ces arbres ressemblent avec un exemple simple: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u7/0o/wk/u70owkgirs6krcos85rwn-acli8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dans ce cas, nous avons un StatelessWidget envelopp√© dans un widget Padding et contenant du texte √† l'int√©rieur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mettons-nous √† la place de Flutter - on nous a donn√© cet arbre de widget. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hey, Padding, j'ai besoin de votre √©l√©ment"</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Padding: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Bien s√ªr, maintenez SingleChildRenderObjectElement"</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/jj/u7/zn/jju7znfat7skocfex74adc4cu7o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Element, voici votre place, installez-vous"</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
SingleChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Les gars, tout va bien, mais j'ai besoin de RenderObject"</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Padding, comme pour vous dessiner? "</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Rembourrage: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Tenez-le, RenderPadding"</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
SingleChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Super,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mettez </font><i><font style="vertical-align: inherit;">-vous au travail"</font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/zk/ty/se/zktyse7pgo6jdd6x7impyivfhy0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Alors qui est le prochain?" StatelessWidget, maintenant vous laissez l'√©l√©ment ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
StatelessWidget: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ Ici StatelessElement ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ StatelessElement, vous serez soumis √† SingleChildRenderObjectElement, voici l'endroit, embarquant ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
StatelessElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ OK ¬ª</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/7w/tb/ke/7wtbkebtfn_xeq1ieqxqbarpkro.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ le RichText, elementik Present, veuillez ¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
le RichText donne MultiChildRenderObjectElement </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´MultiChildRenderObjectElement, c'est parti, commencez¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
MultiChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´J'ai besoin d'un rendu pour le travail¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´RichText, nous avons besoin d'un objet de rendu¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
RichText: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Voici un RenderParagraph¬ª</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Flutter:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"RenderParagraph vous recevrez des instructions RenderPadding, et MultiChildRenderObjectElement vous contr√¥lera"</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
MultiChildRenderObjectElement: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Maintenant tout va bien, je suis pr√™t"</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/s4/24/fn/s424fnivo4j2tb4sv9pcirmxov0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Vous allez s√ªrement poser une question logique: "O√π est l'objet de rendu pour StatelessWidget, pourquoi n'est-il pas l√†, nous avons d√©cid√© ci-dessus que les √©l√©ments lient les configurations avec √©cran? " </font><font style="vertical-align: inherit;">Prenons attention √† l'impl√©mentation de base de la m√©thode de montage, qui a √©t√© discut√©e dans cette section de la description du cycle de vie.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">void</span> mount(Element parent, dynamic newSlot) {<font></font>
    assert(_debugLifecycleState == _ElementLifecycle.initial);<font></font>
    assert(widget != <span class="hljs-literal">null</span>);<font></font>
    assert(_parent == <span class="hljs-literal">null</span>);<font></font>
    assert(parent == <span class="hljs-literal">null</span> || parent._debugLifecycleState == _ElementLifecycle.active);<font></font>
    assert(slot == <span class="hljs-literal">null</span>);<font></font>
    assert(depth == <span class="hljs-literal">null</span>);<font></font>
    assert(!_active);<font></font>
    _parent = parent;<font></font>
    _slot = newSlot;<font></font>
    _depth = _parent != <span class="hljs-literal">null</span> ? _parent.depth + <span class="hljs-number">1</span> : <span class="hljs-number">1</span>;<font></font>
    _active = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (parent != <span class="hljs-literal">null</span>)<font></font>
        _owner = parent.owner;<font></font>
    <span class="hljs-keyword">if</span> (widget.key is GlobalKey) {<font></font>
        final GlobalKey key = widget.key;<font></font>
        key._register(<span class="hljs-keyword">this</span>);<font></font>
    }<font></font>
    _updateInheritance();<font></font>
    assert(() {<font></font>
        _debugLifecycleState = _ElementLifecycle.active;<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    }());<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On n'y verra pas la cr√©ation d'un objet de rendu. </font><font style="vertical-align: inherit;">Mais l'√©l√©ment impl√©mente un BuildContext, qui a une m√©thode de recherche d'objet de visualisation findRenderObject, qui nous m√®nera au getter suivant:</font></font><br>
<br>
<pre><code class="javascript hljs">RenderObject get renderObject {<font></font>
    RenderObject result;<font></font>
    <span class="hljs-keyword">void</span> visit(Element element) {<font></font>
        assert(result == <span class="hljs-literal">null</span>); 
        <span class="hljs-keyword">if</span> (element is RenderObjectElement)<font></font>
            result = element.renderObject;<font></font>
        <span class="hljs-keyword">else</span><font></font>
            element.visitChildren(visit);<font></font>
    }<font></font>
    visit(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">return</span> result;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas de base, un √©l√©ment ne peut pas cr√©er un objet de rendu; seuls RenderObjectElement et ses descendants sont requis pour ce faire, cependant, dans ce cas, un √©l√©ment √† un certain niveau d'imbrication doit avoir un √©l√©ment enfant qui a un objet de rendu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semblerait pourquoi toutes ces difficult√©s. Jusqu'√† 3 arbres, diff√©rents domaines de responsabilit√©, etc. La r√©ponse est assez simple - c'est l√† que les performances de Flutter sont construites. Les widgets sont des configurations immuables, par cons√©quent, ils sont souvent recr√©√©s, mais en m√™me temps, ils sont assez l√©gers, ce qui n'affecte pas les performances. Mais Flutter essaie de r√©utiliser autant que possible les √©l√©ments lourds. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenons un exemple. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texte au milieu de l'√©cran. Dans ce cas, le code ressemblera √† ceci:</font></font></i><br>
<br>
<pre><code class="javascript hljs">body: Center(<font></font>
    child: Text(‚ÄúHello world!‚Äù)<font></font>
),</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, l'arborescence des widgets ressemblera √† ceci: Une </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/wt/fa/lcwtfazdhkpaprcu9tqvhssvck4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
fois que Flutter a construit les 3 arbres, nous obtenons l'image suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/vx/ph/ucvxphu5r2ds-6_kmoizgyoczo8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que se passe-t-il si nous modifions le texte que nous allons afficher? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_u/8b/do/_u8bdowthfzx9jshpbprfnpj1ai.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons maintenant une nouvelle arborescence de widgets. Ci-dessus, nous avons parl√© de la r√©utilisation maximale possible des √©l√©ments. Jetez un ≈ìil √† la m√©thode de classe Widget, sous le nom parlant </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canUpdate</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">static</span> bool canUpdate(Widget oldWidget, Widget newWidget) {
    <span class="hljs-keyword">return</span> oldWidget.runtimeType == newWidget.runtimeType &amp;&amp; oldWidget.key == newWidget.key;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous v√©rifions le type du widget pr√©c√©dent et du nouveau, ainsi que leurs cl√©s. S'ils sont identiques, il n'est pas n√©cessaire de modifier l'√©l√©ment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, avant la mise √† niveau, le premier √©l√©ment est Centre, apr√®s la mise √† niveau, √©galement Centre. Les deux n'ont pas de cl√©s, une co√Øncidence compl√®te. Nous pouvons mettre √† jour le lien de l'√©l√©ment vers un nouveau widget. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/tr/s4/hetrs4cgzrimhibqeilfoja5xzi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais en plus du type et de la cl√©, le widget est une description et une configuration, et les valeurs des param√®tres n√©cessaires √† l'affichage peuvent changer. C'est pourquoi l'√©l√©ment, apr√®s avoir mis √† jour le lien vers le widget, doit lancer des mises √† jour de l'objet de rendu. Dans le cas de Center, rien n'a chang√© et nous continuons de comparer davantage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, le type et la cl√© nous indiquent qu'il est inutile de recr√©er l'√©l√©ment. Le texte est un descendant de StatelessWidget; il n'a pas d'objet d'affichage direct.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dp/yy/6m/dpyy6mckv6cddryb0_yu5asy_uy.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acc√©dez √† RichText. Le widget n'a pas non plus chang√© de type; il n'y a pas de divergence dans les cl√©s. L'√©l√©ment met √† jour son association avec le nouveau widget. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hw/vh/95/hwvh952jekjwhudyj6czju3hq6a.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion est mise √† jour, il ne reste plus qu'√† mettre √† jour les propri√©t√©s. Par cons√©quent, RenderParagraph affichera la nouvelle valeur de texte. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lv/_p/g-/lv_pg-n6wlmcmlunokumb60nqw0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et d√®s que le moment sera venu pour le prochain cadre de dessin, nous verrons le r√©sultat que nous attendons. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√¢ce √† ce type de travail, Flutter atteint des performances aussi √©lev√©es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple ci-dessus d√©crit le cas o√π la structure du widget elle-m√™me n'a pas chang√©. Mais que se passe-t-il si la structure change? Flutter, bien s√ªr, continuera d'essayer de maximiser l'utilisation des objets existants, comme nous l'avons compris dans la description du cycle de vie, mais de nouveaux √©l√©ments seront cr√©√©s pour tous les nouveaux widgets, et les anciens et les plus inutiles seront supprim√©s √† la fin du cadre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardons quelques exemples. </font><font style="vertical-align: inherit;">Et pour nous assurer de ce qui pr√©c√®de, nous utilisons l'outil Android Studio - Flutter Inspector.</font></font><br>
<br>
<pre><code class="javascript hljs">@override<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">build</span>(<span class="hljs-params">BuildContext context</span>) {
    <span class="hljs-keyword">return</span> Scaffold(<font></font>
        body: Center(<font></font>
            child: _isFirst ? first() : second(),<font></font>
        ),<font></font>
        <span class="hljs-attr">floatingActionButton</span>: FloatingActionButton(<font></font>
            child: Text(<span class="hljs-string">"Switch"</span>),
            <span class="hljs-attr">onPressed</span>: () {<font></font>
                setState(() {<font></font>
                    _isFirst = !_isFirst;<font></font>
                });<font></font>
            },<font></font>
        ),<font></font>
    );<font></font>
}<font></font>
<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">first</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    mainAxisAlignment: MainAxisAlignment.center,
    children: &lt;Widget&gt;[
        Text(
            <span class="hljs-string">"test"</span>,
            style: TextStyle(fontSize: <span class="hljs-number">25</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">SizedBox</span>(<span class="hljs-params">
            width: <span class="hljs-number">5</span>,
        </span>),
        <span class="hljs-title">Icon</span>(<span class="hljs-params">
            Icons.error,
        </span>),<font></font>
    ],<font></font>
);<font></font>
<font></font>
<span class="hljs-title">Widget</span> <span class="hljs-title">second</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    mainAxisAlignment: MainAxisAlignment.center,
    children: &lt;Widget&gt;[
        Text(
            <span class="hljs-string">"one more test"</span>,
            style: TextStyle(fontSize: <span class="hljs-number">25</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">Padding</span>(<span class="hljs-params">
            padding: EdgeInsets.only(left: <span class="hljs-number">5</span></span>),<font></font>
        ),<font></font>
        <span class="hljs-title">Icon</span>(<span class="hljs-params">
            Icons.error,
        </span>),<font></font>
    ],<font></font>
);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, en cliquant sur le bouton, l'un des widgets changera. </font><font style="vertical-align: inherit;">Voyons ce que l'inspecteur nous montre. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wi/vt/vt/wivtvtojhv4uq3l7ouoje3le-u0.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/webt/f4/rb/0a/f4rb0avn7pombux2ct6pkap2edi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme nous pouvons le voir, Flutter a recr√©√© le rendu uniquement pour le remplissage, le reste vient d'√™tre r√©utilis√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez 1 option de plus dans laquelle la structure change d'une mani√®re plus globale - nous changeons les niveaux d'imbrication.</font></font><br>
<br>
<pre><code class="javascript hljs">Wid<span class="hljs-keyword">get</span> <span class="hljs-title">second</span>() =&gt; <span class="hljs-title">Container</span>(<span class="hljs-params">child: first(</span>),);</code></pre><br>
<img src="https://habrastorage.org/webt/yt/8i/gs/yt8igsxt3r3b-ofhkrlcyjaqryc.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/webt/j7/na/qw/j7naqwq6060sh-tw_atxna_umpa.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgr√© le fait que l'arbre n'a pas chang√© du tout visuellement, les √©l√©ments et les objets de l'arbre de rendu ont √©t√© recr√©√©s. </font><font style="vertical-align: inherit;">Cela s'est produit parce que Flutter compare par niveau (dans ce cas, peu importe que la majeure partie de l'arbre n'ait pas chang√©), le filtrage de cette partie a eu lieu au moment de la comparaison du conteneur et de la ligne. </font><font style="vertical-align: inherit;">Cependant, on peut sortir de cette situation. </font><font style="vertical-align: inherit;">Cela nous aidera √† GlobalKey. </font><font style="vertical-align: inherit;">Ajoutez une telle cl√© pour Row.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">var</span> _key = GlobalKey(debugLabel: <span class="hljs-string">"testLabel"</span>);<font></font>
<font></font>
Wid<span class="hljs-keyword">get</span> <span class="hljs-title">first</span>() =&gt; <span class="hljs-title">Row</span>(<span class="hljs-params">
    key: _key,
    ‚Ä¶
</span>);</code></pre><br>
<img src="https://habrastorage.org/webt/gg/jp/zj/ggjpzjlpox-ijhgtwxy-i6rvcsk.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/webt/zy/br/zy/zybrzywy-_ixs_apl7j1fiqsrco.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√®s que nous avons dit √† Flutter que la pi√®ce pouvait √™tre r√©utilis√©e, il en a profit√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous nous sommes un peu plus familiaris√©s avec la magie Flutter et nous savons maintenant que ce n'est pas seulement dans les widgets. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Flutter est un m√©canisme bien coordonn√© bien pens√© avec sa propre hi√©rarchie, ses domaines de responsabilit√©, avec lesquels vous pouvez cr√©er non seulement de belles, mais aussi des applications productives. </font><font style="vertical-align: inherit;">Bien s√ªr, nous n‚Äôavons examin√© qu‚Äôune petite partie, quoique assez importante, de son dispositif, nous continuerons donc √† analyser divers aspects du travail interne du cadre dans de futurs articles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'esp√®re que les informations de cet article vous aideront √† comprendre le fonctionnement interne de Flutter et vous aideront √† trouver des solutions √©l√©gantes et productives pendant le d√©veloppement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci pour l'attention!</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ressources</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flutter </font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Comment Flutter rend les widgets" par Andrew Fitz Gibbon, Matt Sullivan</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501850/index.html">Nous d√©montons l'algorithme EM en petites briques</a></li>
<li><a href="../fr501854/index.html">Comment quitter la programmation et commencer √† jouer</a></li>
<li><a href="../fr501856/index.html">Tarantool: Look Analyst</a></li>
<li><a href="../fr501858/index.html">Dotting tous les psi</a></li>
<li><a href="../fr501860/index.html">15 mai RU-Center peut vous ajouter un service payant sans votre participation</a></li>
<li><a href="../fr501864/index.html">Assistant ou inspecteur: pour qui le robot appelle-t-il?</a></li>
<li><a href="../fr501866/index.html">Combien d'emplois les robots vont d√©truire</a></li>
<li><a href="../fr501868/index.html">Comment ne pas laisser le comptable se jeter ou On transf√®re 1C vers le cloud. Instruction √©tape par √©tape</a></li>
<li><a href="../fr501870/index.html">Nombre maximal de valeurs dans la partie II de l'√©num√©ration</a></li>
<li><a href="../fr501872/index.html">Lieu d'√©tude dans les syst√®mes cybern√©tiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>