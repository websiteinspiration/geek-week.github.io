<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèΩ üö¢ üëáüèª Reduzieren Sie die Gr√∂√üe des ML-Modells ohne Registrierung und SMS üïí ü§≥üèø üë©‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jeder, der auf maschinelles Lernen st√∂√üt, versteht, dass dies ernsthafte Rechenleistung erfordert. In diesem Artikel werden wir versuchen, den am MIT ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Reduzieren Sie die Gr√∂√üe des ML-Modells ohne Registrierung und SMS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504354/"><img src="https://habrastorage.org/webt/u3/w2/jm/u3w2jmkqidenskb9-sgwysh2gy8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jeder, der auf maschinelles Lernen st√∂√üt, versteht, dass dies ernsthafte Rechenleistung erfordert. In diesem Artikel werden wir versuchen, den am MIT entwickelten Algorithmus anzuwenden, um ein neuronales Netzwerk zu komprimieren. Dies reduziert die Dimension der Gewichte des trainierten Modells und f√ºhrt sowohl zu einem schnelleren Lernen als auch zu einem schnelleren Modellstart. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neuronale Netze haben sich als hervorragendes Werkzeug zur L√∂sung einer Vielzahl von Aufgaben erwiesen. Leider erfordert ihre Verwendung eine erhebliche Rechenleistung, die in kleinen Unternehmen m√∂glicherweise noch nicht vorhanden ist. Es gibt viele Arten der Komprimierung neuronaler Netze, die in Hardware, Low-Level und Mathematik unterteilt werden k√∂nnen. In diesem Artikel wird jedoch die Methode er√∂rtert, die 2019 am MIT entwickelt wurde und direkt mit dem neuronalen Netz selbst zusammenarbeitet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Methode wird als "Winning Ticket Hypothesis" bezeichnet. </font><font style="vertical-align: inherit;">Im Allgemeinen klingt es so: Jedes vollst√§ndig verbundene neuronale Netzwerk mit zuf√§llig initialisierten Gewichten enth√§lt ein Subnetz mit denselben Gewichten, und ein solches separat trainiertes Subnetz kann in seiner Genauigkeit dem urspr√ºnglichen Netzwerk entsprechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formale Beweise und vollst√§ndiger Artikel finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir sind an der M√∂glichkeit der praktischen Anwendung interessiert. </font><font style="vertical-align: inherit;">Kurz gesagt lautet der Algorithmus wie folgt:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir erstellen ein Modell und initialisieren seine Parameter zuf√§llig</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lernen eines Netzwerks von Iterationen j</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir schneiden die Netzwerkparameter ab, die den kleinsten Wert haben (die einfachste Aufgabe besteht darin, einen Schwellenwert festzulegen).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir setzen die restlichen Parameter auf ihre Anfangswerte zur√ºck und erhalten das Subnetz, das wir ben√∂tigen.</font></font></li>
</ol><br>
<a name="habracut"></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Theoretisch muss dieser Algorithmus die n-te Anzahl von Schritten wiederholt werden, aber f√ºr ein Beispiel werden wir nur eine Iteration durchf√ºhren. </font><font style="vertical-align: inherit;">Erstellen Sie mit Tensorflow und Keras ein einfaches, vollst√§ndig verbundenes Netzwerk:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf
<span class="hljs-keyword">from</span> tensorflow <span class="hljs-keyword">import</span> keras<font></font>
<font></font>
model = keras.Sequential([<font></font>
    keras.layers.Flatten(input_shape=(<span class="hljs-number">28</span>, <span class="hljs-number">28</span>)),<font></font>
    keras.layers.Dense(<span class="hljs-number">300</span>, activation=<span class="hljs-string">'relu'</span>),<font></font>
    keras.layers.Dense(<span class="hljs-number">150</span>, activation=<span class="hljs-string">'relu'</span>),<font></font>
    keras.layers.Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">'softmax'</span>)<font></font>
])<font></font>
<font></font>
model.compile(optimizer=<span class="hljs-string">'SGD'</span>,<font></font>
              loss=<span class="hljs-string">'sparse_categorical_crossentropy'</span>,<font></font>
              metrics=[<span class="hljs-string">'accuracy'</span>])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten die folgende Netzwerkarchitektur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/c_/cy/t6c_cypjz1pyzbzlebveqxseiag.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir werden sie auf dem MNIST-Modedatensatz von 60.000 Bildern trainieren. </font><font style="vertical-align: inherit;">Die Genauigkeit der Verifizierungsdaten betr√§gt 0,8594. </font><font style="vertical-align: inherit;">Wir wenden auf die Parameter der Netzwerk-1-Iteration dieses Algorithmus an. </font><font style="vertical-align: inherit;">Im Code sieht es so aus:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#  </span>
threshold = <span class="hljs-number">0.001</span><font></font>
<font></font>
<span class="hljs-comment">#       np.array</span><font></font>
weights = model.weights<font></font>
weights = np.asarray(weights)<font></font>
<font></font>
<span class="hljs-comment">#    </span>
first_h_layer_weights = weights[<span class="hljs-number">1</span>]<font></font>
second_h_layer_weights = weights[<span class="hljs-number">3</span>]<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_layers</span>(<span class="hljs-params">one_d_array, threshold</span>):</span><font></font>
    index = []<font></font>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(one_d_array.shape[<span class="hljs-number">0</span>]):
        <span class="hljs-comment">#   ,       </span>
        <span class="hljs-keyword">if</span> abs(one_d_array[i]) &lt;= threshold:<font></font>
            index.append(i)<font></font>
    <span class="hljs-comment">#    ,   </span><font></font>
    new_layer = np.delete(one_d_array, index)<font></font>
    <span class="hljs-keyword">return</span> new_layer<font></font>
<font></font>
new_layer_weights = delete_from_layers(second_h_layer_weights, threshold)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir diesen Code ausgef√ºhrt haben, werden wir praktisch nicht verwendete Gewichte entfernen. </font><font style="vertical-align: inherit;">Zwei Dinge sind erw√§hnenswert: In diesem Beispiel wurde der Schwellenwert empirisch ausgew√§hlt und dieser Algorithmus kann nicht auf die Gewichte der Eingabe- und Ausgabeschichten angewendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie neue Gewichte erhalten haben, m√ºssen Sie das urspr√ºngliche Modell neu definieren und den √úberschuss entfernen. </font><font style="vertical-align: inherit;">Als Ergebnis erhalten wir:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yd/yp/uo/ydypuoqyvx--8f5bgzjr-yee97q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen feststellen, dass sich die Gesamtzahl der Parameter um fast das Zweifache verringert hat, was bedeutet, dass beim Training des ersten Netzwerks mehr als die H√§lfte der Parameter einfach unn√∂tig waren. </font><font style="vertical-align: inherit;">Gleichzeitig betr√§gt die Genauigkeit des Subnetzes 0,8554, was erheblich unter dem des Hauptnetzwerks liegt. </font><font style="vertical-align: inherit;">Dieses Beispiel ist nat√ºrlich bezeichnend. Normalerweise kann das Netzwerk um 10 bis 20% der urspr√ºnglichen Anzahl von Parametern reduziert werden. </font><font style="vertical-align: inherit;">Hier ist auch ohne Anwendung dieses Algorithmus klar, dass die urspr√ºngliche Architektur zu umst√§ndlich gew√§hlt wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusammenfassend k√∂nnen wir sagen, dass diese Technik derzeit nicht gut entwickelt ist und bei realen Aufgaben ein Versuch, die Gewichte des Modells auf diese Weise zu optimieren, den Lernprozess nur verl√§ngern kann, aber der Algorithmus selbst hat ein gro√ües Potenzial.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de504328/index.html">Elektronischer Wahlunterricht in der Moskauer Stadtduma 2019</a></li>
<li><a href="../de504334/index.html">–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤—ã –∑–Ω–∞–µ—Ç–µ JavaScript?</a></li>
<li><a href="../de504344/index.html">Authentifizierung - CUSTOM SETUP / AWS Amplify + React Native</a></li>
<li><a href="../de504348/index.html">Monorad: Was passiert w√§hrend des Trainings und wie kann dieser Prozess beschleunigt werden?</a></li>
<li><a href="../de504352/index.html">Zehn Unternehmen, denen Figma geholfen hat, neue Designergebnisse und mehr zu erzielen</a></li>
<li><a href="../de504356/index.html">PHP 8 in acht Codeteilen</a></li>
<li><a href="../de504358/index.html">PuppetConf 2016. Kubernetes f√ºr Systemadministratoren. Teil 2</a></li>
<li><a href="../de504362/index.html">Laden Sie schnell gro√üe Datenmengen in Google Colab</a></li>
<li><a href="../de504370/index.html">Office 365- und Microsoft-Teams - Einfache Zusammenarbeit und Auswirkungen auf die Sicherheit</a></li>
<li><a href="../en486014/index.html">SLAC Tour: US Department of Energy National Accelerator Laboratory at Stanford</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>