<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🀄️ 🚨 🕣 wc bis D: 712 Zeichen ohne einen einzigen Zweig 🏎️ 👩🏿‍🤝‍👨🏻 🛀🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nachdem ich " Beat With a 80-Line Program on Haskell" gelesen hatte , das ich in den Hacker News gefunden hatte , entschied ich, dass D besser sein kö...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>wc bis D: 712 Zeichen ohne einen einzigen Zweig</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490102/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem ich " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beat With a 80-Line Program on Haskell"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gelesen hatte </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> das ich in den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News gefunden hatte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , entschied ich, dass D besser sein könnte. </font><font style="vertical-align: inherit;">Und ich schrieb wc in D. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note.per. </font><font style="vertical-align: inherit;">Ich schlug vor, den obigen Artikel zu übersetzen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xd34df00d</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber er zog es vor, basierend auf seinem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Winning With Twenty Lines of Haskell: Writing Your Wc" zu machen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Und jetzt </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">vermehren sich</font></a><font style="vertical-align: inherit;"> die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wie Aufgüsse "geprägte Münzen".</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programm</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Besteht aus einer Datei - 34 Zeilen und 712 Zeichen.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellcode</font></font></b><div class="spoiler_text"><pre><code class="swift hljs"><span class="hljs-keyword">import</span> std.stdio : writefln, File;
<span class="hljs-keyword">import</span> std.algorithm : map, fold, splitter;
<span class="hljs-keyword">import</span> std.range : walkLength;
<span class="hljs-keyword">import</span> std.typecons : Yes;
<span class="hljs-keyword">import</span> std.uni : byCodePoint;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Line</span> </span>{<font></font>
	size_t chars;<font></font>
	size_t words;<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Output</span> </span>{<font></font>
	size_t lines;<font></font>
	size_t words;<font></font>
	size_t chars;<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Output</span> combine(<span class="hljs-type">Output</span> a, <span class="hljs-type">Line</span> b) pure nothrow {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Output</span>(a.lines + <span class="hljs-number">1</span>, a.words + b.words, a.chars + b.chars);<font></font>
}<font></font>
<font></font>
<span class="hljs-type">Line</span> toLine(char[] l) pure {
	<span class="hljs-keyword">return</span> <span class="hljs-type">Line</span>(l.byCodePoint.walkLength, l.splitter.walkLength);<font></font>
}<font></font>
<font></font>
void main(string[] args) {<font></font>
	auto f = <span class="hljs-type">File</span>(args[<span class="hljs-number">1</span>]);
	<span class="hljs-type">Output</span> o = f<font></font>
		.byLine(<span class="hljs-type">Yes</span>.keepTerminator)<font></font>
		.<span class="hljs-built_in">map</span>!(l =&gt; toLine(l))<font></font>
		.fold!(combine)(<span class="hljs-type">Output</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<font></font>
<font></font>
	writefln!<span class="hljs-string">"%u %u %u %s"</span>(o.lines, o.words, o.chars, args[<span class="hljs-number">1</span>]);<font></font>
}</code></pre><br>
</div></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich benutzt er </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phobos, die D-Standardbibliothek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber warum nicht? </font><font style="vertical-align: inherit;">Phobos ist wunderschön und wird mit jedem D-Compiler geliefert. Das Programm selbst enthält keine if-Anweisungen. </font><font style="vertical-align: inherit;">Und in der WC-Implementierung auf Haskell werden mehrere if verwendet. </font><font style="vertical-align: inherit;">Das D-Programm enthält neben dem Hauptprogramm drei weitere kleine Funktionen. </font><font style="vertical-align: inherit;">Ich könnte leicht alle Funktionen in eine Bereichskette einordnen, aber dann würde es wahrscheinlich mehr als 80 Zeichen pro Zeile geben. </font><font style="vertical-align: inherit;">Dies ist das Grundprinzip des Codestils.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ist wc auf D schneller als coreutils wc? </font><font style="vertical-align: inherit;">Nein, aber ich habe 15 Minuten gebraucht, um meine Version zu schreiben (ich musste nach walkLength suchen, weil ich den Namen der Funktion vergessen habe).</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datendatei</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linien</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Byte</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D.</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">46</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">906</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,5 ms ± 1,9 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,9 ms ± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">862</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64k</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,7 ms ± 2,0 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39,6 ms ± 7,8 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9,8 ms ± 2,1 ms</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,7 m</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">96M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">658,6 ms ± 24,5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">226,4 ms ± 29,5 ms</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,102 s ± 0,022 s</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12,1M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">671M</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,4 s ± 0,058 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,1 s ± 0,039 s</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7,4 s ± 0,085 s</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erinnerung:</font></font><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datendatei</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coreutils</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haskell</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D.</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.d</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2052K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7228K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7708K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">big.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2112K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7512K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7616K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2288K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42620K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7712K</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vbig2.txt</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2360K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50860K</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7736K</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wc auf Haskell schneller? </font><font style="vertical-align: inherit;">Natürlich für große Dateien, aber es wird Multithreading verwendet. </font><font style="vertical-align: inherit;">Bei kleinen Dateien gewinnt GNU coreutils immer noch. </font><font style="vertical-align: inherit;">Zu diesem Zeitpunkt ist meine Version höchstwahrscheinlich durch E / A begrenzt, und auf jeden Fall ist sie ziemlich schnell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde nicht argumentieren, dass eine Sprache schneller ist als eine andere. </font><font style="vertical-align: inherit;">Wenn Sie Zeit damit verbringen, den Mikro-Benchmark zu optimieren, werden Sie höchstwahrscheinlich gewinnen. </font><font style="vertical-align: inherit;">Aber nicht im wirklichen Leben. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aber ich werde argumentieren, dass die funktionale Programmierung in D fast die FP in Haskell einholt.</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen über die Reichweite in D.</font></font></h3><br>
<img src="https://habrastorage.org/webt/gp/qe/oo/gpqeookkvehf2hdsowdegomcqai.png" align="left"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">range ist eine Abstraktion, die iteriert werden kann, ohne die zugrunde liegende Sammlung zu berühren (falls vorhanden). </font><font style="vertical-align: inherit;">Technisch gesehen kann range eine Struktur oder Klasse sein, die eine oder mehrere Range-Schnittstellen implementiert. </font><font style="vertical-align: inherit;">Die einfachste Form, InputRange, erfordert eine Funktion</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span></span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und zwei Mitglieder oder Eigenschaften </font></font><br>
<br>
<pre><code class="cpp hljs">T front;
<span class="hljs-keyword">bool</span> empty;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
T ist ein generischer Elementtyp, über den der Bereich iteriert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D-Bereiche sind bestimmte Typen. </font><font style="vertical-align: inherit;">Wenn der Bereich in die foreach-Anweisung fällt, führt der Compiler eine kleine Änderung durch.</font></font><br>
<br>
<pre><code class="cpp hljs">foreach (e; range) { ... }</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
verwandelt sich in </font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> __r = range; !__r.empty; __r.popFront()) {
    <span class="hljs-keyword">auto</span> e = __r.front;<font></font>
    ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
auto e = berechnet den Typ und entspricht T e =. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Sinne ist es einfach, einen Bereich zu erstellen, der von foreach verwendet werden kann.</font></font><br>
<br>
<pre><code class="java hljs">struct Iota {
	<span class="hljs-keyword">int</span> front;
	<span class="hljs-keyword">int</span> end;<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.front == <span class="hljs-keyword">this</span>.end;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{<font></font>
		++<span class="hljs-keyword">this</span>.front;<font></font>
	}<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-keyword">import</span> std.stdio;<font></font>
	foreach(it; Iota(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iota ist ein sehr einfaches Beispiel für Reichweite. </font><font style="vertical-align: inherit;">Es fungiert als Generator ohne die zugrunde liegende Sammlung. </font><font style="vertical-align: inherit;">Es durchläuft ganze Zahlen von Anfang bis Ende in Schritten von eins. </font><font style="vertical-align: inherit;">Dieses Snippet enthüllt ein bisschen D-Syntax.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ property-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attribut </font><font style="vertical-align: inherit;">können Sie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leere</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">wie eine Mitgliedsvariable verwenden (Aufruf einer Funktion ohne Klammern). Das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attribut </font><font style="vertical-align: inherit;">am Ende bedeutet, dass wir die Instanzdaten, für die wir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufrufen, nicht </font><i><font style="vertical-align: inherit;">ändern</font></i><font style="vertical-align: inherit;"> . Der integrierte Komponententest gibt Zahlen von 0 bis 10 aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiteres kleines Merkmal ist das Fehlen eines expliziten Konstruktors. Die Iota-Struktur enthält zwei int-Mitgliedsvariablen. In der foreach-Anweisung im Test erstellen wir eine Iota-Instanz, als hätte sie einen Konstruktor, der zwei Ints akzeptiert. Dies ist ein strukturelles Literal. Wenn der Compiler D dies sieht, die Struktur jedoch keinen entsprechenden Konstruktor hat, werden gemäß der Reihenfolge der Deklaration von Variablen den Mitgliedern der Struktur int zugewiesen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beziehung zwischen den drei Mitgliedern ist einfach. </font><font style="vertical-align: inherit;">Wenn leer falsch ist, gibt front nach der Iteration nach dem Aufruf von popFront garantiert ein neues Element zurück. </font><font style="vertical-align: inherit;">Nach dem Aufruf von popFront kann sich der leere Wert ändern. </font><font style="vertical-align: inherit;">Wenn dies zutrifft, bedeutet dies, dass keine Elemente mehr iteriert werden müssen und weitere Aufrufe an front ungültig sind. </font><font style="vertical-align: inherit;">Laut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InputRange-Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">front kann genau dann korrekt berechnet werden, wenn leer oder falsch zurückgegeben wird.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">front kann mehrmals berechnet werden, ohne popFront aufzurufen oder den Bereich oder die zugrunde liegenden Daten auf andere Weise zu mutieren, und es wird für jede Berechnung das gleiche Ergebnis erzielt.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verwendung von foreach-Ausdrücken oder Schleifen ist nicht sehr funktional. </font><font style="vertical-align: inherit;">Angenommen, wir möchten alle ungeraden Zahlen für Iota herausfiltern. </font><font style="vertical-align: inherit;">Wir könnten ein Wenn in einen Foreach-Block stecken, aber das würde es nur noch schlimmer machen. </font><font style="vertical-align: inherit;">Es wäre besser, wenn wir einen Bereich hätten, der einen Bereich annimmt, und ein Prädikat, das entscheidet, ob ein Element geeignet ist oder nicht.</font></font><br>
<br>
<pre><code class="java hljs">struct Filter {<font></font>
	Iota input;<font></font>
	<span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate</span>;<font></font>
<font></font>
	<span class="hljs-keyword">this</span>(Iota input, <span class="hljs-function">bool <span class="hljs-title">function</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> predicate) </span>{
		<span class="hljs-keyword">this</span>.input = input;
		<span class="hljs-keyword">this</span>.predicate = predicate;
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testAndIterate</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">while</span>(!<span class="hljs-keyword">this</span>.input.empty<font></font>
				&amp;&amp; !<span class="hljs-keyword">this</span>.predicate(<span class="hljs-keyword">this</span>.input.front))<font></font>
		{<font></font>
			<span class="hljs-keyword">this</span>.input.popFront();<font></font>
		}<font></font>
	}<font></font>
<font></font>
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">popFront</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">this</span>.input.popFront();
		<span class="hljs-keyword">this</span>.testAndIterate();<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">front</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.front;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-meta">@property</span> <span class="hljs-function">bool <span class="hljs-title">empty</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.input.empty;<font></font>
	}<font></font>
}<font></font>
<font></font>
<span class="hljs-function">bool <span class="hljs-title">isEven</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	foreach(it; Filter(Iota(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>), &amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Filter ist wieder sehr einfach: Iota und ein Funktionszeiger werden benötigt. </font><font style="vertical-align: inherit;">Beim Erstellen des Filters rufen wir testAndIterate auf, das Elemente von Iota übernimmt, bis sie leer sind oder das Prädikat false zurückgibt. </font><font style="vertical-align: inherit;">Die Idee ist, dass das Prädikat entscheidet, was gefiltert und was verlassen wird. </font><font style="vertical-align: inherit;">Die vorderen und leeren Eigenschaften werden einfach in Iota übersetzt. </font><font style="vertical-align: inherit;">Das einzige, was den Job tatsächlich macht, ist popFront. </font><font style="vertical-align: inherit;">Es gibt das aktuelle Element zurück und ruft testAndIterate auf. </font><font style="vertical-align: inherit;">Das ist alles. </font><font style="vertical-align: inherit;">Dies ist eine Filterimplementierung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich hat testAndIterate eine while-Schleife, aber das Umschreiben mit Rekursion ist meiner Meinung nach einfach nur dumm. Was D großartig macht, ist, dass Sie für jede Aufgabe die entsprechende Methode verwenden können. Funktionale Programmierung ist gut und wird oft zur Schau gestellt, manchmal aber auch nicht. Wenn ein kleiner Inline-Assembler benötigt wird oder mehr Spaß macht, verwenden Sie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Aufrufen von Filter sieht immer noch nicht sehr gut aus. </font><font style="vertical-align: inherit;">Angenommen, Sie sind es gewohnt, von links nach rechts zu lesen, wird Filter vor Iota angezeigt, auch wenn er nach Iota ausgeführt wird. </font><font style="vertical-align: inherit;">D stellt keine Pipe-Anweisung bereit, verwendet jedoch die Unified Function Call Syntax (UFCS). </font><font style="vertical-align: inherit;">Wenn ein Ausdruck implizit in den ersten Parameter einer Funktion konvertiert werden kann, kann die Funktion so aufgerufen werden, als wäre sie eine Mitgliedsfunktion dieses Ausdrucks. </font><font style="vertical-align: inherit;">Das ist ziemlich kompliziert, verstehe ich. </font><font style="vertical-align: inherit;">Ein Beispiel hilft:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-built_in">string</span> a)</span> </span>{
	<span class="hljs-keyword">return</span> a ~ <span class="hljs-string">"World"</span>;<font></font>
}<font></font>
<font></font>
unittest {<font></font>
	<span class="hljs-built_in">string</span> a = foo(<span class="hljs-string">"Hello "</span>);
	<span class="hljs-built_in">string</span> b = <span class="hljs-string">"Hello "</span>.foo();<font></font>
	assert(a == b);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das obige Beispiel zeigt zwei Aufrufe der Funktion foo. </font><font style="vertical-align: inherit;">Wie Assert impliziert, sind beide Aufrufe gleichwertig. </font><font style="vertical-align: inherit;">Was bedeutet das für unser Iota-Filter-Beispiel? </font><font style="vertical-align: inherit;">Mit UFCS können wir den Komponententest folgendermaßen umschreiben:</font></font><br>
<br>
<pre><code class="swift hljs">unittest {<font></font>
	foreach(it; <span class="hljs-type">Iota</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>).<span class="hljs-type">Filter</span>(&amp;isEven)) {<font></font>
		writeln(it);<font></font>
	}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Map / Transform-Implementierung für Range sollte nun für jeden Leser zugänglich sein. </font><font style="vertical-align: inherit;">Natürlich kann ein Filter mithilfe von Vorlagen abstrakter gestaltet werden, aber dies sind nur Details, konzeptionell nichts Neues. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich gibt es verschiedene Arten von Bereichen, zum Beispiel bidirektional. </font><font style="vertical-align: inherit;">Ratet mal, welche Möglichkeiten dies für euch bietet. </font><font style="vertical-align: inherit;">Ein kurzer Tipp: Es gibt zwei neue Grundelemente im bidirektionalen Bereich, die als back und popBack bezeichnet werden. </font><font style="vertical-align: inherit;">Es gibt andere Arten von Bereichen, aber nachdem Sie den oben gezeigten Eingabebereich zweimal verstanden haben, erkennen Sie sie fast alle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Implementieren Sie aus Gründen der Übersichtlichkeit keinen eigenen Filter, keine eigene Karte oder Falte. </font><font style="vertical-align: inherit;">Die Phobos D Standardbibliothek bietet alles, was Sie brauchen. </font><font style="vertical-align: inherit;">Schauen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sich </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">std.algorithm</font></a><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std.range an</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über den Autor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Robert Schadeck erwarb einen Master in Informatik an der Universität Oldenburg. </font><font style="vertical-align: inherit;">Seine Masterarbeit trug den Titel "DMCD - Distributed Multithreaded D Compiler mit Caching", wo er an der Erstellung eines D-Compilers von Grund auf arbeitete. </font><font style="vertical-align: inherit;">Von 2012 bis 2018 war er Doktorand in Informatik. </font><font style="vertical-align: inherit;">an der Universität Oldenburg. </font><font style="vertical-align: inherit;">Seine Dissertation befasst sich mit Quorumsystemen in Verbindung mit Grafiken. </font><font style="vertical-align: inherit;">Seit 2018 verwendet er D gerne in seiner täglichen Arbeit für Symmetry Investments.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über Symmetry Investments</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symmetry Investments ist eine globale Investmentgesellschaft mit Niederlassungen in Hongkong, Singapur und London. </font><font style="vertical-align: inherit;">Wir sind seit 2014 im Geschäft, nachdem wir uns erfolgreich von einem großen New Yorker Hedgefonds getrennt haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Symmetry sind wir bestrebt, angemessene Risiken einzugehen, um Wert für unsere Kunden, Partner und Mitarbeiter zu schaffen. Wir profitieren von unserer Fähigkeit, Win-Win-Verträge zu generieren - im weitesten Sinne des Wortes. Win-Win ist unser grundlegendes ethisches und strategisches Prinzip. Durch die Generierung von Win-Win-Optionen können wir einzigartige Lösungen schaffen, die Perspektiven kombinieren, die normalerweise als inkompatibel oder gegensätzlich empfunden werden, und das Beste abdecken, was jede der Parteien bieten kann. Wir integrieren die Fixed Income Arbitration wieder in globale Makrostrategien. Wir erfinden und entwickeln eine Technologie, die sich auf das Potenzial der Mensch-Maschine-Integration konzentriert. Wir schaffen Systeme, in denen Maschinen das tun, was sie am besten können, und Menschen dabei unterstützendamit sie das tun, was sie am besten können. Wir schaffen eine Meritokratie, die auf Kooperation basiert: eine Kultur, in der der individuelle Beitrag sowohl persönlichen als auch kollektiven Zielen dient - und entsprechend belohnt wird. Wir legen Wert auf Eigenverantwortung und Teamgeist der Zusammenarbeit, Selbstverwirklichung und Gemeinschaft.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Mitarbeiter von Symmetry Investments sind seit 2014 aktive Mitglieder von Community D. </font><font style="vertical-align: inherit;">Wir haben die Entwicklung von Excel-D-, Dpp-, Autowrap-, Libmir- und anderen Projekten gesponsert. </font><font style="vertical-align: inherit;">Wir haben Symmetry Autumn of Code im Jahr 2018 gestartet und die DConf 2019 in London veranstaltet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ca. </font><font style="vertical-align: inherit;">Da der Übersetzer wie üblich betrunken war, kann ich nicht für die Richtigkeit einiger menschlicher Begriffe bürgen und verstehe im letzten Abschnitt nichts. </font><font style="vertical-align: inherit;">Senden Sie also Korrekturen in der persönlichen Kommunikation.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490088/index.html">So fahren Sie mit dem Erstellen einer Karte in UE4 fort</a></li>
<li><a href="../de490092/index.html">Andrei Zaretsky, Alexander Trukhanov: „Die Gebühr war genug, um Kaffee zu trinken“</a></li>
<li><a href="../de490094/index.html">Zurück zu den Wurzeln: Wir fahren einen Computer direkt vom MBR aus</a></li>
<li><a href="../de490096/index.html">Einfache Möglichkeit, einen winzigen USB-Hub für Raspberry Pi zu erstellen</a></li>
<li><a href="../de490100/index.html">Entwicklung einer Software für den dezentralen Rollerverleih. Wer hat gesagt, dass es einfach sein würde?</a></li>
<li><a href="../de490104/index.html">Intelligente Sonnenblende von Bosch. Prototypentest</a></li>
<li><a href="../de490110/index.html">Vom Entwickler zum Manager und umgekehrt</a></li>
<li><a href="../de490112/index.html">Monaden als Code-Wiederverwendungsmuster</a></li>
<li><a href="../de490114/index.html">Yandex.Practicum - Datenanalyst. Abschluss</a></li>
<li><a href="../de490118/index.html">10 wichtigsten Fakten zu SERM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>