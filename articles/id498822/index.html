<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ  ğŸ’‚ğŸ¼ ğŸ¦ Pengembangan dan pembuatan dari awal mesin arcade untuk empat pemain ğŸ…¾ï¸ ğŸ¥ª ğŸ¥•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada bulan November 2019, saya berhenti dari pekerjaan saya dan memutuskan untuk mencurahkan beberapa bulan untuk mempelajari keterampilan baru yang s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pengembangan dan pembuatan dari awal mesin arcade untuk empat pemain</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498822/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a6/10f/ede/6a610fede3bc45535fdcd0b8b3d6a9d7.jpg" alt="gambar"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bulan November 2019, saya berhenti dari pekerjaan saya dan memutuskan untuk mencurahkan beberapa bulan untuk mempelajari keterampilan baru yang sudah lama ingin saya pelajari. Saat itu saya bekerja sebagai pengembang web. Sebelum itu, saya mempelajari pengembangan perangkat lunak. Dan bahkan sebelumnya, sebagai seorang anak, saya terus bereksperimen dengan elektronik dan program. Karena itu, saya merasa cukup percaya diri dalam pembuatan perangkat lunak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, selalu ada benda ajaib yang disebut </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"besi" ini</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang saya gunakan setiap hari, tetapi saya tidak tahu bagaimana cara kerjanya. Pengembang perangkat lunak (dan terutama pengembang web) tidak perlu memahami perangkat kerasnya. Karena semua kode pengembangan web sangat tinggi, jarang sekali masalah perangkat lunak kami terkait dengan perangkat keras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, saya tidak pernah mengerjakan "besi" dan tidak memiliki pengetahuan umum tentang teknik elektro, kecuali yang diberikan kepada kami di sekolah menengah. Dan saya ingin mengubah situasi ini. Saya menetapkan tujuan yang tidak masuk akal, yang pada waktu itu tampak sangat jauh dari pengetahuan saya. Dan kemudian ... Saya baru saja mulai bereksperimen. Saya berencana untuk memeriksa seberapa jauh saya bisa pergi sebelum saya kehabisan motivasi. Saya tidak berharap untuk mencapai tujuan saya, tetapi entah bagaimana saya berhasil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah hasil saya:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/npsSCkFGR0g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan luar biasa saya adalah membuat konsol permainan arcade empat pemain dari awal. Menggunakan mikrokontroler sebagai otak, dan strip LED sebagai tampilan. Menggunakan satu joystick dan empat tombol untuk masing-masing pemain yang terletak di tepi meja, pemain mengontrol permainan yang secara dinamis dimuat ke dalam sistem dari chip memori. Berkat ini, gameplay pada perangkat menyerupai konsol lama yang baik. Hanya sekarang kita tidak perlu meniup kartrid untuk menghilangkan bug.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang mengejutkan saya ... saya benar-benar bisa menyelesaikan proyek. </font><font style="vertical-align: inherit;">Butuh waktu sekitar tiga bulan penuh untuk siklus percobaan, kegagalan, membaca dokumentasi, putus asa, dan mencoba lagi. </font><font style="vertical-align: inherit;">Akan diperlukan untuk memperbaiki jumlah jam kerja untuk mengetahui berapa banyak waktu yang saya habiskan untuk ini. </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya akan menganggap</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itu sekitar 800-900 jam. </font><font style="vertical-align: inherit;">(Dengan asumsi saya bekerja 6/7 hari seminggu selama 8-10 jam sehari, yang cukup dekat dengan kebenaran.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mencoba mendokumentasikan proses percobaan saya dari awal hingga akhir, mengambil foto dan merekam video. </font><font style="vertical-align: inherit;">Dengan posting ini saya akan mendokumentasikan proyek dan pengalaman saya untuk diri saya sendiri. </font><font style="vertical-align: inherit;">Saya berharap bagi Anda itu akan menjadi sumber inspirasi jika Anda juga memutuskan untuk mengambil proyek yang sama luar biasa.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai bekerja</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya katakan di awal artikel, ketika saya memulai proyek ini, saya tidak memiliki pengetahuan elektronik, kecuali formula hukum Ohm yang salah ingat. Karena itu, pertama-tama, saya perlu mempelajari cara kerja elektronik dalam praktik, dan baru kemudian mencoba membuat konsol game. Saya bahkan tidak tahu cara menyalakan LED menggunakan mikrokontroler. Jadi, langkah pertama saya: memesan elektronik dan mikrokontroler sederhana untuk percobaan. Untuk memulai, saya akan mencoba menyalakan LED. Saya hampir yakin bahwa upaya pertama saya untuk menyalakan LED menyebabkan terbakar. Tapi ini tidak didokumentasikan di kamera, jadi mari kita berpura-pura tidak.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/65d/3f9/4b4/65d3f94b409f452f2b89b61cebe87851.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eksperimen dengan mikrokontroler, resistor, transistor, dan LED. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah tonggak utama pertama. </font><font style="vertical-align: inherit;">Sekarang kita tahu cara membuat kode yang berjalan di mikrokontroler. </font><font style="vertical-align: inherit;">Kami juga belajar cara menggunakan transistor sebagai saklar listrik sederhana untuk menyalakan LED. </font><font style="vertical-align: inherit;">Luar biasa!</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Petualangan bersama EEPROM</font></font></h1><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b93/544/2b3/b935442b3b1db1c8c8e390c134394a6d.gif"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 1. Menggunakan register geser untuk mengontrol 16 jalur keluaran hanya dengan 3 pin keluaran.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bagian dari proyek adalah kemampuan untuk menulis logika game ke chip memori (EEPROM). Itu seharusnya sudah dibaca ketika kartrid dengan pemutar dimasukkan ke dalam sistem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam jangka panjang, itu menyakitkan saya bahwa saya tidak belajar informasi yang cukup tentang jenis EEPROM apa yang harus digunakan dalam proyek ini. Saya sangat bersemangat bahwa saya membeli chip EEPROM paralel lama (W27C512). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menulis atau membaca dari mereka, saya membutuhkan kemampuan untuk mengatur sinyal tinggi atau rendah pada semua 16 baris. Jika saya tidak ingin menempati semua kontak keluaran dari mikrokontroler, akan logis untuk mempelajari cara menggunakan register geser.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e51/17c/73e/e5117c73e685322a816450c33a198278.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 2. Sirkuit yang digunakan dalam upaya gagal membaca / menulis data ke chip EEPROM paralel.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dengan hanya beberapa kontak, kita dapat secara terpisah mengontrol semua 16 jalur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita terapkan pengetahuan ini ke EEPROM! Ya ... tapi tidak. Saya tidak dapat </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara stabil</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis data ke EEPROM. Jenis chip ini membutuhkan 12-14 V untuk menghapus atau menulis byte. Saya mencoba menyediakannya dengan menggunakan transistor sebagai saklar untuk memasok tegangan yang meningkat. Dan seperti yang saya pahami, itu HARUS berhasil. Tapi itu tidak berhasil. Saya masih tidak mengerti apa sebenarnya masalahnya. Dalam gbr. Gambar 2 menunjukkan sirkuit yang saya coba gunakan untuk membaca / menulis byte dari / ke EEPROM.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c8/55b/2cc/7c855b2cccc52a790973701590912927.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 3. Sebuah sirkuit yang telah berhasil membaca / menulis byte ke chip EEPROM serial.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Akhirnya, setelah mempelajari informasi lebih lanjut tentang topik ini, saya belajar bahwa </font><i><font style="vertical-align: inherit;">EEPROM</font></i><font style="vertical-align: inherit;"> paralel saat ini tidak sering digunakan. Biasanya, pengembang lebih suka serial EEPROM I2C, dan karenanya, lebih mudah untuk menemukan tutorial tentang mereka. (Misalnya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tutorial Sparkfun yang luar biasa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam gbr. </font><font style="vertical-align: inherit;">Gambar 3 menunjukkan skema saya untuk membaca dan menulis data ke EEPROMs serial ... Jauh lebih sederhana dan jauh lebih dapat diandalkan. </font><font style="vertical-align: inherit;">Ini mengajarkan saya bahwa Anda tidak boleh terlalu senang memesan suku cadang dan mencoba mengembangkan proyek terlalu cepat. </font><font style="vertical-align: inherit;">Kami menghabiskan sekitar 1-2 minggu untuk EEPROM paralel, dan akhirnya tidak menggunakannya sama sekali. </font><font style="vertical-align: inherit;">Namun, dalam prosesnya, kami belajar banyak dalam bidang elektronik dan spesifikasi bacaan (yang dengan sendirinya merupakan keterampilan). </font><font style="vertical-align: inherit;">Upaya itu tidak sepenuhnya sia-sia.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi bagaimana cara kita melakukannya?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita bisa membaca dan menulis ke chip memori. </font><font style="vertical-align: inherit;">Apa yang akan menjadi langkah selanjutnya? </font><font style="vertical-align: inherit;">Pada tahap ini, akan logis untuk menggambarkan rencana konsol saya lebih detail menggunakan beberapa gambar sebagai contoh.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbd/be2/3c5/fbdbe23c5506e650261938ce053e01a5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rencana keseluruhan. Ini akan menjadi konsol game dengan pengontrol untuk empat pemain. Setiap pemain memiliki satu joystick dan beberapa tombol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lingkaran merah menandai steker untuk kartrij permainan. Konektor ini akan memiliki empat pin logam yang digunakan konsol untuk membaca serial EEPROM untuk memuat game ke dalam memori. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hijau menunjukkan bagaimana kami berencana membuat layar strip LED. Kami ingin piksel layar menjadi bidang persegi, bercahaya warna, bukan tempat yang menyatu dengan tempat lain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mencapai efek yang diinginkan, kami menggunakan skema tersebut untuk memisahkan sumber cahaya satu sama lain. Pada saat yang sama, itu menyebarkan cahaya yang jatuh di atas layar. (Garis-garis putih di bawah kisi-kisi menunjukkan strip LED)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memutuskan untuk membuat tampilan LED 42x42. Artinya, total 1764 LED diperoleh. Saya memilih nomor 42, karena berkat ini, ukuran meja akan pas untuk empat orang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menyalakan banyak LED adalah tugas yang menakutkan. Pada kecerahan maksimum, LED RGB mengkonsumsi arus 60 mA. (Yang memberi warna putih dengan kecerahan maksimum). Jika kita mengalikan dengan jumlah LED, maka kita mendapatkan konsumsi arus maksimum 105,84 A pada 5 V! Untuk semakin mendekati arus ini, kami membeli catu daya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SE-600â€“5 MEAN WELL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini dapat memasok saat ini hingga 100 A. Yang secara teori kurang dari mungkin 105 A. Tapi saya tidak berusaha untuk menampilkan layar sepenuhnya putih dengan kecerahan maksimum dalam game. </font><font style="vertical-align: inherit;">Selain itu, kita dapat membatasi kecerahan secara terprogram. </font><font style="vertical-align: inherit;">Kami juga akan menambahkan sekering untuk mencegah secara tidak sengaja melebihi batas 100 A.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/332/a49/769/332a49769fc921086ed5072e01879586.gif"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. </font><font style="vertical-align: inherit;">4. Prototipe kardus untuk tampilan LED 3x3. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan kembali ke perakitan layar ini nanti. </font><font style="vertical-align: inherit;">Pertama, Anda perlu melakukan prototyping. </font><font style="vertical-align: inherit;">Mari kita lihat apakah kita bisa membuat layar LED kecil berfungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prototipe 3x3 ini terdiri dari beberapa lembar karton yang memisahkan piksel, dan selembar kertas biasa untuk printer yang menyebarkan cahaya. </font><font style="vertical-align: inherit;">Itu bekerja dengan baik! </font><font style="vertical-align: inherit;">Kami telah menerima konfirmasi luar biasa dari kapasitas kerja konsep tersebut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengontrol LED menggunakan mikrokontroler, kami menggunakan perpustakaan FastLED. Namun, ternyata jika LED dikendalikan oleh satu bus data, maka tidak mungkin memperbarui 1764 LED dengan kecepatan yang cukup untuk permainan. Diberikan frekuensi 800 kHz, kita bisa mencapai frame rate sekitar 17 frame per detik. Tidak persis apa yang kami perjuangkan. Secara pribadi, saya suka bermain dengan setidaknya 60FPS. Untungnya, ini mungkin. Cukup menggunakan lebih dari satu data bus. Layar 42x42 dapat dengan mudah dibagi menjadi 7 bagian yang sama. Masing-masing bagian ini dapat dikontrol secara terpisah, dengan bus data sendiri. Ini dimungkinkan berkat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penggunaan fungsi keluaran paralel dari perpustakaan FastLED di mikrokontroler Teensy 4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dengan menggunakan 7 bus data, kami dapat mencapai kecepatan refresh maksimum sekitar 120FPS!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak merencanakan ini, tetapi kebetulan, pada awal proyek, saya memilih mikrokontroler ini. </font><font style="vertical-align: inherit;">Tampak bagi saya bahwa untuk kelancaran permainan akan membutuhkan waktu pemrosesan yang cepat yang disediakan oleh MK ini. </font><font style="vertical-align: inherit;">Prototipe pada Gambar. </font><font style="vertical-align: inherit;">4 sudah dikontrol oleh fungsi output paralel. </font><font style="vertical-align: inherit;">Namun, dalam prototipe ini kami hanya menggunakan 2 bus data, hanya untuk menguji apakah semuanya benar-benar berfungsi sebagaimana dinyatakan.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana kita menjalankan kode dengan EEPROM?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, pada tahap ini, kita dapat membaca dan menulis ke EEPROM, dan kami juga memiliki bukti kerja dari konsep tampilan LED. Apa berikutnya? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya ada dua tugas teknis serius yang tersisa: pengorganisasian metode input untuk semua pemain (tombol dan joystick). Dan kita juga perlu memikirkan cara menjalankan logika game dari EEPROM dan menampilkan hasil dari instruksi ini di layar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tombol dan joystick yang dipesan belum tiba. Oleh karena itu, pertama-tama kita akan terlibat dalam pelaksanaan logika game dari EEPROM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada banyak cara untuk menjalankan instruksi (kode) dari EEPROM. Namun, pertama-tama kita perlu menetapkan persyaratan tertentu: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Kode harus mudah ditulis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Kode harus kecil (ukuran file).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Kode harus dapat berinteraksi dengan perpustakaan yang sudah jadi, misalnya, FastLED, untuk mengurangi jumlah pekerjaan saya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4) Kode harus dapat memuat ke dalam RAM secepat mungkin untuk mengurangi waktu buka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5) Anda membutuhkan kemampuan untuk meniru kode pada PC biasa untuk menguji game. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6) Solusi kami harus berkinerja tinggi (sediakan setidaknya 60FPS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7) Suatu solusi seharusnya tidak mengharuskan pembelian sejumlah besar peralatan tambahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8) Solusinya harus bekerja pada Teensy 4.0 MK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9) Solusinya harus mudah diimplementasikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya datang dengan empat cara berbeda untuk mengeksekusi kode dari EEPROM:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Kami menulis di EEPROM kode Arduino yang dikompilasi yang biasa. Kemudian kami memaksa programmer Arduino eksternal untuk membaca kode yang dikompilasi dari EEPROM dan memprogram ulang Arduino dengan cepat setiap kali game baru dimuat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Kami memuat kode assembler dalam RAM dan menjalankannya dari sana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Kami menggunakan juru bahasa kode siap pakai, misalnya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArduinoBASIC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitlash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Kami menulis juru kode kami sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut ini adalah perbandingan singkat tentang kelebihan dan kekurangan dari empat solusi untuk proyek kami:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/75d/9e6/f9c/75d9e6f9c00e8c1067278d2317de5ae3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(1) Ukuran file untuk solusi dengan programmer eksternal mengerikan. Bersama dengan logika permainan, semua pustaka kode yang kami gunakan dalam proyek ini harus disimpan dalam EEPROM. Untuk menampilkan kondisi permainan, setiap EEPROM harus memiliki salinan FastLED library-nya sendiri. Ini tidak bagus sama sekali. Masalah ini mungkin dapat diatasi dengan menambahkan kode dasar ke programmer eksternal, yang kemudian dikombinasikan dengan kode di EEPROM sebelum memprogram Arduino. Ini akan menjadi tugas yang berisiko tinggi, karena tidak begitu mudah untuk menemukan tutorial di Internet. Kami mungkin akan menghabiskan terlalu banyak waktu untuk itu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(2) Menjalankan assembler dari RAM adalah pilihan yang bagus. Itu sebabnya saya memutuskan untuk mempertimbangkannya. Kompleksitas penulisan kode dapat dikurangi dengan menggunakan beberapa bahasa tingkat tinggi, misalnya, C, yang kemudian dikompilasi ke dalam kode assembler yang benar. Namun, tidak jelas betapa mudahnya untuk berinteraksi dengan perpustakaan lain di Arduino, jadi saya memutuskan untuk mengabaikannya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(3) Menggunakan juru bahasa yang sudah jadi juga merupakan solusi yang cukup bagus. Namun, sejauh yang saya tahu, semua penafsir ini dieksekusi berdasarkan serangkaian karakter. Antrian panjang ini harus ditulis ke EEPROM. Ini bukan masalah besar, tapi jelas bukan cara terbaik untuk memperkecil ukuran file. Selain itu, tidak jelas apakah penerjemah ini dapat berinteraksi dengan perpustakaan Arduino. Karena itu, saya memutuskan bahwa menggunakan penerjemah yang sudah jadi bukanlah ide yang baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(4) Akhirnya, kami memiliki solusi 4: membuat juru bahasa kami sendiri. Itu memenuhi semua persyaratan, karena cara penerjemah diimplementasikan sepenuhnya tergantung pada saya. Dia </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan melakukannya</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki kecepatan tinggi jika saya mencapai kecepatan tinggi dari penerjemah itu sendiri. </font><font style="vertical-align: inherit;">Ya, ukuran file akan kecil dan kodenya akan mudah ditulis ... jika saya memberikan ini sendiri. </font><font style="vertical-align: inherit;">Dengan kata lain, kita akan memiliki kendali penuh atas segalanya. </font><font style="vertical-align: inherit;">Dan jika saya berusaha, maka semuanya akan menjadi sempurna. </font><font style="vertical-align: inherit;">Satu-satunya kelemahan serius dari solusi semacam itu adalah waktu pengembangan yang panjang. </font><font style="vertical-align: inherit;">Anda mungkin ingat bahwa saya menghabiskan 800-900 jam untuk proyek ini. </font><font style="vertical-align: inherit;">Artinya, jelas bahwa saya memutuskan untuk memilih solusi 4 - untuk membuat juru bahasa saya sendiri. </font><font style="vertical-align: inherit;">Waktu bukanlah masalah bagi saya. </font><font style="vertical-align: inherit;">Saya mengambil kesempatan ini untuk belajar bagaimana bahasa pemrograman dibuat. </font><font style="vertical-align: inherit;">Saya akan mencari tahu mengapa satu atau beberapa keputusan arsitektur dibuat dalam bahasa-bahasa ini.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kelahiran ArcadableScript</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prinsip umum penerjemah cukup sederhana. </font><font style="vertical-align: inherit;">Saya tidak akan merinci struktur internalnya, karena pada saat penulisan, saya berencana untuk sepenuhnya menulis ulang penerjemah sehingga akan menjadi lebih efisien dan akan lebih mudah baginya untuk menulis kode. </font><font style="vertical-align: inherit;">Namun, dasar-dasarnya tetap sama. </font><font style="vertical-align: inherit;">Penerjemah akan mengeksekusi loop kode sederhana untuk setiap ukuran permainan:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d38/795/8cf/d387958cf2e11b21d122f66d7f530918.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kelemahan besar dari skema semacam itu adalah bahwa input dan kondisi permainan diperiksa hanya sekali per frame. </font><font style="vertical-align: inherit;">Untuk gim yang tidak memerlukan reaksi cepat, ini normal. </font><font style="vertical-align: inherit;">Namun, di game lain, pemain tidak akan bisa bereaksi di antara frame. </font><font style="vertical-align: inherit;">Saya akan memecahkan masalah ini dalam versi penerjemah berikutnya.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/843/ee2/fe1/843ee2fe188d8a16ea99f0e9e427b9ef.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ara. 5</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dalam diagram dengan gambar. Gambar 5 menunjukkan bagaimana saya berencana untuk meningkatkan juru bahasa dalam waktu dekat, menciptakan dua siklus terpisah untuk keadaan permainan dan bingkai permainan. Ini akan memungkinkan kami untuk memperbarui keadaan permainan ratusan kali per detik, dan tampilan - hanya 60 kali per detik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, pada Teensy 4.0 tidak dimungkinkan untuk mengeksekusi kode multi-thread perangkat keras. Karenanya, kita tidak akan dapat melakukan dua siklus ini secara paralel. Tapi saya yakin saya akan menemukan sesuatu.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e56/8c7/878/e568c78787bb1b00b2aee6c406071050.gif"></div><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9bd/b45/225/9bdb45225d410ef24bcc8e5fa3b325c3.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah beberapa waktu, saya berhasil menulis dua program sederhana menggunakan bahasa bytecode saya sendiri. Mereka menggunakan angka mentah sebagai input untuk meminimalkan ukuran file. Yaitu, saya menyelesaikan penulisan kedua program ini, secara harfiah menuliskan daftar angka yang dapat dipahami oleh penerjemah. Untuk memberikan gambaran tentang seberapa mudahnya bytecode ini terbaca, saya akan mendemonstrasikan instruksi nyata yang digunakan dalam program contoh yang menggerakkan titik di layar:</font></font><br>
<br>
<blockquote><code><pre>// TODO: Write/read all untyped... data to/from ROM
  int untypedGamestate[] = {
    0, // Previous time, to keep track of game time/framerate.
    0, // Player position x.
    0, // Player position y.
    0, // Player R color value.
    0, // Player G color value.
    255, // Player B color value.
  };
  int untypedValues[][3] = {
    // ID, Type, Value
    {0, 0, 0}, // Move up button value 
    {1, 0, 1}, // Move right button value
    {2, 0, 2},  // Move down button value
    {3, 0, 3},  // Move left button value
    {4, 3, 1},  // True/1
    {5, 3, 0},  // False/0
    {6, 4, 0},  // Current millis since game start
    {7, 2, 0},  // Gamestate previous time
    {8, 2, 1},  // Gamestate player x
    {9, 2, 2},  // Gamestate player y
    {10, 2, 3}, // Gamestate player r color
    {11, 2, 4}, // Gamestate player g color
    {12, 2, 5}, // Gamestate player b color
    {13, 3, 1}, // Move player up after button press boundary check
    {14, 1, 0}, // System config screen width
    {15, 1, 1}, // System config screen height
    {16, 3, 3}, // Move player down after button press boundary check
    {17, 3, 5}, // Move player left after button press boundary check
    {18, 3, 7}, // Move player right after button press boundary check
  }
  int untypedCalculations[][5] = {
    // ID, ending, valueLeftID, calculationRightID, calculationOperator
    {0, 0, 9, 1, 1}, // Current player y position - 1
    {1, 1, 4, 0, 0}, // True/1
    {2, 1, 0, 0, 0}, // Up button
    {3, 1, 2, 0, 0}, // Down button
    {4, 1, 5, 0, 0}, // False/0
    {5, 1, 9, 0, 0}, // Current player y position
    {6, 0, 15, 1, 1} // screenheight - 1
    {7, 0, 9, 1, 0}, // Current player y position + 1
    {8, 1, 3, 0, 0}, // Left button
    {9, 1, 1, 0, 0}, // Right button
    {10, 1, 8, 0, 0}, // Current player x position
    {11, 0, 8, 1, 0}, // Current player x position + 1
    {12, 0, 8, 1, 1}, // Current player x position - 1
    {13, 0, 14, 1, 1} // screenwidth - 1
  }
  int untypedInstructions[][10] = {
    // ID, rootInstruction, conditionCalculationLeftID, conditionCalculationRightID, conditionOperator, conditionSuccesValueLeftID,
    // conditionSuccessCalculationRightID, hasFailedCondition, conditionFailedValueLeftID, conditionFailedCalculationRightID
    {0, 1, 2, 1, 0, 13, 0, 0, 0, 0}, // move player up when up button is pressed.
    {1, 0, 5, 4, 1, 9, 0, 0, 0, 0}, // move the player up when the boundary is not reached.
    {2, 1, 3, 1, 0, 16, 0, 0, 0, 0}, // move player down when down button is pressed. 
    {3, 0, 5, 6, 1, 9, 7, 0, 0, 0} // move the player down when the boundary is not reached.
    {4, 1, 8, 1, 0, 17, 0, 0, 0, 0}, // move player left when left button is pressed.
    {5, 0, 10, 4, 1, 8, 12, 0, 0, 0}, // move the player left when the boundary is not reached.
    {6, 1, 9, 1, 0, 18, 0, 0, 0, 0}, // move player right when right button is pressed.
    {7, 0, 10, 13, 1, 8, 11, 0, 0, 0}, // move the player right when the boundary is not reached.
  };</pre></code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda meluangkan waktu untuk mempelajari kode dengan cermat, Anda dapat memahami bagaimana versi awal penerjemah ini bekerja. Prinsip umum menggunakan "nilai", "perhitungan" dan "instruksi" dipertahankan dalam versi saat ini. Namun, banyak yang berubah. Kami tidak lagi memiliki daftar tetap nilai gamestate, sekarang mereka hanya bagian dari daftar nilai biasa. Selain itu, kami memisahkan "kondisi" dari instruksi. Berkat ini, kami dapat menggunakan kembali instruksi dalam kode, yang mengurangi ukuran file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita tidak membahas detail penerjemah, karena dalam versi yang dirancang ulang, semua ini akan segera berubah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita berada pada tahap ketika kita tahu cara membaca / menulis ke EEPROM, dan kita dapat menjalankan instruksi berdasarkan array angka biasa. </font><font style="vertical-align: inherit;">Langkah logis berikutnya adalah menghapus daftar instruksi yang telah di-hardcode dari kode dan menuliskannya ke EEPROM. </font><font style="vertical-align: inherit;">Mulai sekarang, kita akan dapat mencoba membaca dan menjalankan instruksi yang tersimpan di EEPROM.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/99f/787/c14/99f787c142065459798925f8a58105c7.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, kita memiliki semua bukti kapasitas kerja konsep yang kita butuhkan untuk mulai menciptakan hasil akhir! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentunya, setiap bagian individu dari prototipe yang kami buat masih membutuhkan banyak pekerjaan. </font><font style="vertical-align: inherit;">Tapi, menurut saya, tugas yang paling sulit sudah diselesaikan. </font><font style="vertical-align: inherit;">Yang harus saya lakukan adalah mengembangkan apa yang sudah saya miliki. </font><font style="vertical-align: inherit;">Semuanya sederhana!</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unit Display LED</font></font></h1><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f9d/661/fa9/f9d661fa96cd940cd19d0dd4c0f49930.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Butuh banyak pekerjaan untuk merakit tampilan. Sangat banyak pekerjaan. Saya mulai dengan menyolder kabel ke 42 strip terpisah. Setiap strip membutuhkan tiga kabel di satu sisi dan dua di sisi lainnya. Artinya, hanya sekitar 200 kabel. Sebelum proyek ini, saya tidak memiliki banyak praktik dalam menyolder, sehingga Anda dapat dengan jelas melihat bahwa semakin banyak saya melakukan penyolderan, semakin kuat kualitasnya. Tentu saja, pada akhirnya, saya harus mengulang banyak strip LED pertama, karena saya tidak suka hasilnya. Semua ini adalah bagian dari proses pembelajaran!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ec/9b3/604/2ec9b36040aadbe6007c8d3e7bf20d34.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah selanjutnya: kita pasang semua strip LED ke panel kayu besar. Melihat ke belakang, saya pikir mungkin demi konduktivitas termal yang lebih baik ada gunanya menggunakan lembaran logam, karena setelah satu jam operasi tampilan sekarang menjadi hangat (40-50 Â° C). Tapi ini masih tidak sering terjadi, jadi itu bukan masalah besar. Namun, jika saya memutuskan untuk mengulangi proyek, saya akan memperbaiki aspek ini.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ba/7b3/ebd/0ba7b3ebdd11e0349049d5bbf6c04761.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami memasang kabel dengan diameter lebih besar ke konduktor positif dan negatif dari strip strip LED. Kita harus memastikan bahwa kabel berdiameter besar andal tahan arus maksimum 100 A. Untuk perlindungan tambahan, kami juga menambahkan 15 sekering A ke setiap bagian layar.Pada </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tahap ini, kami siap melakukan upaya pertama untuk mengontrol tampilan. Setelah banyak kegagalan dan manipulasi dengan parameter perangkat lunak dan kabel, saya akhirnya berhasil menampilkan satu warna pada layar tanpa distorsi dan gangguan. Butuh waktu lama, dan hasilnya masih jauh dari sempurna. Untuk waktu yang lama, saya masih memiliki masalah dengan sinyal yang terdistorsi sampai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saya memposting pertanyaan tentang itu di electronics.stackexchange.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Orang-orang hebat dari situs ini membantu saya mendiagnosis masalahnya. </font><font style="vertical-align: inherit;">Saya masih belum sepenuhnya mengerti tentang apa itu, tetapi dengan menghubungkan kabel negatif langsung di sepanjang bus data dari landasan ke terminal landasan dekat input data, saya bisa menyelesaikannya. </font><font style="vertical-align: inherit;">Sejak itu saya tidak punya masalah dengan distorsi pada layar.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/78d/f76/e76/78df76e76fa5ca0494056dc1b7546e8c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang kita lihat dari ilustrasi di atas, dua lapisan material ditumpangkan pada strip LED. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai bahan untuk pelapisan ini, kita membutuhkan sesuatu yang kuat, transparan, tetapi menyebarkan cahaya. </font><font style="vertical-align: inherit;">Namun, saya tidak ingin menggunakan kaca karena harganya mahal dan rapuh. </font><font style="vertical-align: inherit;">Oleh karena itu, saya memutuskan untuk mengambil polystyrene transparan standar. </font><font style="vertical-align: inherit;">Agar dia menyebarkan cahaya, saya mengobatinya dengan ampelas halus sedemikian rupa sehingga tidak mungkin untuk melihat. </font><font style="vertical-align: inherit;">Semuanya sangat sederhana.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jauh lebih banyak waktu dihabiskan untuk membuat kisi yang akan ditempatkan langsung di atas strip. Saya pikir hanya memesan grille dengan parameter yang diperlukan untuk memesan, tetapi mereka memanggil saya harga sekitar 500 euro. Menurut saya, dia tidak layak. Karena itu, saya harus mengambilnya sendiri. Untuk ini kita perlu strip plastik tipis (tidak lebih dari 2 mm), tahan lama, buram putih. Cukup banyak persyaratan. Karena itu, pemilihan material yang tepat membutuhkan banyak waktu. Ternyata, garis-garis dari kerai jendela (lamella) adalah ideal.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c4d/069/ecc/c4d069ecc77f2597d1e5093b225333c2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, kami membuat pegangan kecil untuk membuat seragam, bahkan memotong garis lebar. Dalam hal ini, strip plastik yang agak kecil diperoleh. Kemudian kami perlu membuat sayatan di tengah setiap strip tepat di tempat yang tepat. Ini diperlukan untuk menghubungkan potongan-potongan plastik dan merakit jeruji. Inilah yang saya lakukan di foto ketiga. Sebelum melakukan ini, Anda harus memastikan bahwa lebar gergaji sama atau sedikit lebih besar dari lebar strip yang Anda potong. Kalau tidak, parut tidak dapat dirakit. Dalam kasus saya, ternyata gergaji besi untuk logam memiliki ketebalan yang ideal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada foto keempat, hasil pemasangan semua strip ke kisi terlihat. </font><font style="vertical-align: inherit;">Itu adalah pekerjaan yang sangat menjengkelkan dan monoton, tetapi panggangan ternyata sangat tahan lama. </font><font style="vertical-align: inherit;">Secara umum, sepertinya semua sel memiliki ukuran yang sama. </font><font style="vertical-align: inherit;">Tidak ada banyak variasi antara ukuran sel, jika tidak tampilan akan terlihat aneh, jadi semuanya ternyata cukup bagus. </font><font style="vertical-align: inherit;">Saya senang dengan panggangan ini.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e5/c98/a63/3e5c98a63af67f3ba0102a455a939724.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian saya menutup jeruji dalam bingkai kayu yang melakukan beberapa tugas. </font><font style="vertical-align: inherit;">Pertama, dia memegang selembar polystyrene di bagian atas panggangan. </font><font style="vertical-align: inherit;">Ini memastikan bahwa gril tidak bergerak. </font><font style="vertical-align: inherit;">Selain itu, bingkai kayu menekan semua kabel sehingga mereka menahan lebih aman dan tidak bisa terlepas (yang terjadi beberapa kali ketika saya memindahkan layar).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/817/19a/c01/81719ac01006db1add78e0f394d1fffb.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foto ini menunjukkan selembar polystyrene yang diampelas diletakkan di rak kawat. </font><font style="vertical-align: inherit;">Perhatikan bahwa panggangan sekarang hampir tidak terlihat, itulah yang kami inginkan.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3eb/a69/4e8/3eba694e869e4fc489af81f01c6de832.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menghabiskan berjam-jam bereksperimen dengan implementasi kontrol tampilan yang benar, kami akhirnya berhasil membuatnya bekerja. Masalah besar adalah pelestarian integritas sinyal. Tapi seperti yang saya katakan di atas. Komunitas dari electronics.stackexchange membantu saya dengan ini! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layarnya cerah, jauh lebih terang dari yang saya harapkan. Itu perlu untuk meramalkan ini, memesan unit 100 A untuk catu dayanya.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a0a/092/371/a0a09237152f40f6ce6cb24aaa8d3e89.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya katakan beberapa kali, kami menggunakan perpustakaan FastLED untuk mengontrol LED. </font><font style="vertical-align: inherit;">Tetapi saya tidak menyebutkan bahwa saya juga menggunakan versi modifikasi dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perpustakaan FastLED-GFX oleh </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JÃ¼rgen Skrocki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (yang itu sendiri adalah port dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adafruit-GFX-Library</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">untuk rendering sederhana angka pada tampilan </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Perubahan di perpustakaan ini kecil, tetapi mereka perlu agar penerjemah dapat berkomunikasi dengan perpustakaan dengan cara yang nyaman.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otak dan ...</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu tugas teknis terakhir yang perlu dipecahkan untuk menyelesaikan proyek ini adalah penyelesaian otak konsol. Anda perlu mengubahnya menjadi satu set yang nyaman dan kompak. Tapi pertama-tama kita perlu mencari tahu bagaimana menangani semua sinyal input dari para pemain. Biarkan saya mengingatkan Anda bahwa setiap pemain memiliki 4 tombol dan satu joystick. Itu adalah total 16 sinyal input digital dan 8 analog. MK tidak pernah memiliki cukup kontak untuk masukan seperti itu; selain itu, dua pin bus data sudah digunakan untuk membaca EEPROM, dan 7 pin bus data paralel diperlukan untuk mengontrol tampilan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengatasi masalah ini, kami menggunakan sepasang register geser untuk input digital. Dan untuk semua input analog, kami akan mengambil multiplexer analog.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be4/362/3d4/be43623d4bc69b23ee153bf4e0fc191b.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skema untuk membaca / menulis EEOPROM secara bersamaan, memproses input pemain dan kontrol tampilan.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dan kemudian kebingungan dimulai. Biarkan saya menjelaskan apa yang terjadi di foto ini, dari kiri ke kanan. Di bagian atas papan tempat memotong roti kiri adalah 7 bus data yang digunakan untuk mengontrol tampilan. Di bawah ini adalah area di mana EEPROM dapat dimasukkan dan di mana itu dibaca.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian atas papan tempat memotong roti tengah adalah multiplexer analog. Multiplexer ini dapat menerima hingga 16 sinyal input analog, dan tergantung pada sinyal input pada multiplexer, sambungkan salah satu sinyal analog ke MK. Jadi, kita hanya perlu satu pin input analog dan sepasang pin input digital untuk memproses 16 input analog. Sepertinya tidak ada input analog yang terhubung ke multiplexer di foto ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah multiplexer adalah MK Teensy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di papan tempat memotong roti sebelah kanan, kami memproses sinyal input digital. Dalam foto ini, 16 sinyal digital hanya terhubung ke ground. Saya masih menunggu tombol tiba, jadi saya menguji semua 16 sinyal digital dengan cara ini. Berkat register shift, hanya 4 pin yang diperlukan untuk mengontrol semua sinyal digital.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seluruh sistem adalah kekacauan besar yang tidak dapat diandalkan. </font><font style="vertical-align: inherit;">Hal ini diperlukan untuk membuatnya lebih kompak sehingga tidak terlepas dari satu pernafasan yang ceroboh. </font><font style="vertical-align: inherit;">Oleh karena itu, saya memesan beberapa papan prototipe dan mulai menyolder lagi!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/351/a13/ea7/351a13ea70ae3f30f125304080770dcc.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e86/af8/04c/e86af804cc17b0925735084d862a2204.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan itu ternyata menjadi tugas yang sulit! </font><font style="vertical-align: inherit;">Namun, ini adalah kesempatan yang bagus untuk belajar cara menyolder secara akurat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk membuat sirkuit ini, saya menggunakan contoh kekacauan kabel di papan tempat memotong roti. </font><font style="vertical-align: inherit;">Kemudian saya mencoba membuat sirkuit yang lebih pintar sehingga komponen yang harus berkomunikasi satu sama lain sedekat mungkin. </font><font style="vertical-align: inherit;">Jadi saya mencoba menyingkirkan kebutuhan untuk menarik terlalu banyak kabel. </font><font style="vertical-align: inherit;">Sekarang saya pikir Anda bisa menggunakan beberapa alat pemodelan untuk merancang rangkaian. </font><font style="vertical-align: inherit;">Tapi ternyata masih cukup baik.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memutuskan untuk merancang sirkuit dua lapis. Pada papan prototipe bawah, semua input diproses. Pada masing-masing dari 4 koneksi input, saya memiliki 8 jalur input (1-ground, 1-positif, 4-digital input, 2-analog input). MK berkomunikasi dengan lapisan bawah menggunakan empat koneksi di sebelah register geser dan empat koneksi di sebelah multiplexer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catu daya terletak di lapisan atas, di sebelah kanan ada 7 bus data output untuk tampilan, dan di bagian bawah ada kontak untuk membaca EEPROM. Dan akhirnya, di tengah, tentu saja, adalah mikrokontroler.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e36/b63/416/e36b63416aa9c6b7cfad5c3c3f3918e7.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antara papan kontrol utama dan input pemain, saya menempatkan papan perantara untuk mengurangi jumlah kabel yang dibutuhkan di kedua sisi dari 12 menjadi 8, karena tidak perlu menggunakan semua 5 kabel ground yang pergi dari papan utama ke papan input. </font><font style="vertical-align: inherit;">Satu pentanahan sudah cukup untuk semua tombol dan joystick. </font><font style="vertical-align: inherit;">Oleh karena itu, ada empat papan perantara tersebut. </font><font style="vertical-align: inherit;">Saya suka bahwa Anda dapat melihat peningkatan kualitas setiap papan berikutnya yang Anda kumpulkan.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/6b0/5ab/6d46b05abd9ced550837adb796becb9e.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena tidak pernah menerima tombol yang dipesan, saya memesan set lain dari penjual lain dan setelah beberapa hari saya menerimanya. </font><font style="vertical-align: inherit;">Ini memungkinkan kami untuk akhirnya mulai menguji semua tombol.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd3/083/a72/fd3083a7252ec45ff226ccaf9c3ee18a.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, saya juga menulis game pertama yang bisa dimainkan di konsol. Ya, sekarang saya menyebutnya konsol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya berhasil karena dalam proses mengerjakan tampilan saya secara simultan meningkatkan penerjemah. Secara khusus, saya berhasil meningkatkan proses pengembangan itu sendiri ketika menulis kode. Proses ini tidak begitu menarik secara eksternal, jadi saya memutuskan untuk tidak mendokumentasikannya secara khusus.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a6f/fed/54f/a6ffed54fd1a461d601e1424ccf9de2d.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menciptakan lingkungan pengembangan sederhana untuk menulis kode yang dapat dieksekusi di konsol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lingkungan ini berfungsi di browser, dan ini memungkinkan Anda untuk menulis kode untuk konsol tanpa mengacaukan daftar angka yang kacau yang kita lihat di atas. </font><font style="vertical-align: inherit;">Selain itu, saya membuat emulator konsol yang berjalan di aplikasi web yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemampuan untuk meniru permainan untuk konsol dalam aplikasi web menghemat banyak waktu, karena debugging pada PC jauh lebih mudah daripada pada MK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Emulatornya tidak sempurna. </font><font style="vertical-align: inherit;">Ada beberapa bug yang membedakan emulasi dari bermain di versi nyata dari konsol. </font><font style="vertical-align: inherit;">Saya akan mencoba menghilangkannya di masa depan ketika saya menulis penerjemah versi baru. </font><font style="vertical-align: inherit;">Kebutuhan untuk mendukung dua versi interpreter (satu ditulis dalam C ++, yang lain dalam TS) agak menjengkelkan, tetapi itu sepadan.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyatukan semuanya</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya sudah siap. </font><font style="vertical-align: inherit;">Kami dapat menampilkan gambar berdasarkan logika permainan yang diambil dari EEPROM dan memproses input pemain dari tombol dan joystick. </font><font style="vertical-align: inherit;">Sekarang kita perlu menggabungkan semua ini menjadi satu perangkat yang tahan lama.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df9/c7a/ebc/df9c7aebc3b77c16e5332a91ea52c04a.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mulai dengan mengebor lubang di pelat aluminium yang akan menahan tombol dan joystick di tempatnya. </font><font style="vertical-align: inherit;">Kemudian adalah mungkin untuk memasukkan lempengan-lempengan ini ke dalam alur dari kotak kayu di mana mereka mudah disembunyikan. </font><font style="vertical-align: inherit;">Berkat ini, pemain tidak akan dapat menggores logam secara tidak sengaja.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff9/911/305/ff991130552aade0b73c9241f014f781.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/989/61b/d54/98961bd54b0b66591cc5de96b952d17f.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengumpulkan semua yang ada di sekitar layar dan menambahkan kaki lipat yang andal (untuk penyimpanan mudah). </font><font style="vertical-align: inherit;">Pelat logam yang dicat dengan cat hitam terlihat sangat indah. </font><font style="vertical-align: inherit;">Ada perasaan bahwa proyek ini benar-benar bergerak menuju penyelesaian.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/171/5e8/1ee/1715e81ee0aad78e45735d8354761956.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi tentu saja saya salah meyakini bahwa proyek itu hampir selesai. </font><font style="vertical-align: inherit;">Beginilah bentuk konsol sekitar sebulan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengumpulkan semuanya, kami mengerti bahwa tombol tidak berfungsi. </font><font style="vertical-align: inherit;">Kami membongkar lagi, memperbaiki masalah dengan tombol. </font><font style="vertical-align: inherit;">Segalanya tampak bekerja. </font><font style="vertical-align: inherit;">Kami memahami bahwa joystick tidak berfungsi. </font><font style="vertical-align: inherit;">Bongkar lagi. </font><font style="vertical-align: inherit;">Cepat atau lambat, semua tombol dan joystick mulai bekerja. </font><font style="vertical-align: inherit;">Tetapi kemudian LED berhenti bekerja. </font><font style="vertical-align: inherit;">Untuk memperbaikinya, Anda harus membongkar seluruh konsol dan memasang kembali dari awal. </font><font style="vertical-align: inherit;">Ini berlangsung selama sekitar satu bulan, sampai akhirnya semuanya bekerja.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil</font></font></h1><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/N37waS4YijA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/797/f90/9fd/797f909fdad045379aa381c6d005422f.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya sudah siap! Setelah mulai bekerja pada proyek 3-4 bulan telah berlalu. Oleh karena itu, logis bahwa motivasi saya untuk terus meningkatkan penerjemah, melukis pohon dan mengembangkan permainan baru sudah mengering. Pada saat penulisan ini, satu bulan telah berlalu, ketika saya terakhir terlibat dalam proyek ini. Saya akhirnya mendapatkan kekuatan untuk menulis posting dokumenter ini untuk saya dan Anda, pembaca saya. Meskipun saya tidak berharap bahwa seseorang yang waras akan benar-benar membaca semua yang saya tulis, saya harap Anda menikmati melihat foto-foto perkembangan proyek secara bertahap. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi jika Anda membaca semua ini, maka Anda mungkin tertarik dengan repositori Github dari proyek tersebut. Tentu saja, semua kode saya adalah open source! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Arcadable</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Rencana pengembangan proyek lebih lanjut:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Pertama, Anda perlu membuat kartrid yang lebih indah untuk memainkan Pong untuk empat, yang ditunjukkan dalam video terakhir. </font><font style="vertical-align: inherit;">Sementara itu adalah selembar karton dengan potongan aluminium melengkung, yang digunakan sebagai permukaan kontak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Selain itu, saya ingin mengecat konsol dengan lebih baik. </font><font style="vertical-align: inherit;">Awalnya, saya berencana melukisnya dengan teman-teman yang sangat berpengalaman yang suka melukis. </font><font style="vertical-align: inherit;">Namun, sekarang karena pandemi ini tidak mungkin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Akhirnya, seperti yang saya katakan beberapa kali, saya akan menulis ulang penerjemah dengan cara yang lebih efisien. </font><font style="vertical-align: inherit;">Saya juga akan meningkatkan lingkungan pengembangan untuk membuat game lebih mudah. </font><font style="vertical-align: inherit;">Desain aplikasi web saat ini menghambat produktivitas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fb/339/925/2fb3399255938735b58a888c18aaaba8.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompensasi untuk merekam video vertikal.</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id498800/index.html">Bagaimana saya mengajar komputer saya untuk bermain Dobble dengan OpenCV dan Deep Learning</a></li>
<li><a href="../id498808/index.html">Vim dengan Dukungan YAML untuk Kubernetes</a></li>
<li><a href="../id498814/index.html">Anda gagal satu pertanyaan teoritis tentang Jaminan Sosial, dan mereka mengakhiri Anda. Ini normal? // Kita Ditakdirkan # 3</a></li>
<li><a href="../id498816/index.html">Kebenaran pertama-tama, atau mengapa sistem perlu dirancang berdasarkan pada perangkat basis data</a></li>
<li><a href="../id498820/index.html">Beberapa pertanyaan rumit tentang .NET dan C #</a></li>
<li><a href="../id498826/index.html">SIL dan Tenaga Pemasaran</a></li>
<li><a href="../id498828/index.html">Bagaimana garam meja dan protein akan meningkatkan kelangsungan hidup implan</a></li>
<li><a href="../id498830/index.html">Hash + cache: optimisasi pemrosesan aliran</a></li>
<li><a href="../id498832/index.html">Tinjauan tentang kemungkinan Qt Creator 4.12 dan QBS 1.16 untuk pemrograman mikrokontroler</a></li>
<li><a href="../id498834/index.html">33 mitaps online dalam seminggu. Pilih satu atau punya waktu untuk semuanya?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>