<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👵🏾 🌈 🤘🏼 Imitation de dessin à main levée sur l'exemple de RoughJS 🕺🏾 👁️ ✌🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RoughJS est une petite bibliothèque graphique JavaScript (< 9 Ko ) qui vous permet de dessiner dans un style manuscrit sommaire . Il vous permet de de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Imitation de dessin à main levée sur l'exemple de RoughJS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500018/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RoughJS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une petite bibliothèque graphique JavaScript (&lt; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">9 Ko</font></a><font style="vertical-align: inherit;"> ) qui vous permet de dessiner dans un </font><font style="vertical-align: inherit;">style </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manuscrit sommaire</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il vous permet de dessiner sur </font></font><code>&lt;canvas&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et avec </font></font><code>SVG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans cet article, je veux répondre à la question la plus populaire sur RoughJS: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comment ça marche?</font></font></strong><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06b/dcb/dee/06bdcbdee1eec1748f07434abb002f34.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un peu d'histoire</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fasciné par les images de graphiques, diagrammes et croquis dessinés à la main, je me suis, comme un vrai nerd, demandé: puis-je créer de tels dessins à l'aide d'un code, puis-je imiter le dessin aussi précisément que possible à la main, tout en conservant la possibilité de mise en œuvre logicielle? J'ai décidé de me concentrer sur les primitives - lignes, polygones, ellipses et courbes - pour créer une bibliothèque entière de graphiques 2D. Sur cette base, vous pouvez créer des bibliothèques et des graphiques pour dessiner des graphiques et des diagrammes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir brièvement examiné le problème, j'ai trouvé un article de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joe Wood</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et ses collègues intitulé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sketchy Rendering pour la visualisation d'informations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Les techniques qui y sont décrites sont devenues la base de la bibliothèque, en particulier pour dessiner des lignes et des ellipses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2017, j'ai écrit la première version de la bibliothèque, qui ne fonctionnait que sur Canvas. </font><font style="vertical-align: inherit;">Ayant résolu le problème, je m'y suis désintéressé. </font><font style="vertical-align: inherit;">Un an plus tard, j'ai beaucoup travaillé avec SVG et j'ai décidé d'adapter RoughJS pour qu'il fonctionne avec SVG. </font><font style="vertical-align: inherit;">J'ai également changé la structure de l'API pour la rendre plus simple et je me suis concentrée sur les primitives graphiques vectorielles simples. </font><font style="vertical-align: inherit;">J'ai parlé de la version 2.0 sur Hacker News et soudain, elle a gagné en popularité. </font><font style="vertical-align: inherit;">En 2018, c'était </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le deuxième poste le plus populaire de ShowHN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depuis lors, d'autres personnes ont créé des choses plus étonnantes basées sur RoughJS, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excalidraw</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do Cats &amp; Dogs ...</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la bibliothèque graphique roughViz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parlons maintenant des algorithmes ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inégalité</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base fondamentale de l'imitation de figures manuscrites est le hasard. </font><font style="vertical-align: inherit;">Lorsque nous dessinons à la main, deux formes différentes seront quelque peu différentes. </font><font style="vertical-align: inherit;">Personne ne dessine parfaitement avec précision, donc chaque point spatial dans RoughJS est ajusté pour un déplacement aléatoire. </font><font style="vertical-align: inherit;">L'amplitude du caractère aléatoire est donnée par un paramètre numérique </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/b72/e5e/35db72e5e11caf5a6cb19e194b0a5972.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez un point </font></font><code>A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et un cercle autour de lui. </font><font style="vertical-align: inherit;">Remplacez maintenant par un </font></font><code>A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">point aléatoire dans ce cercle. </font><font style="vertical-align: inherit;">L'aire de ce cercle de hasard est contrôlée par la valeur </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lignes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lignes manuscrites ne sont jamais droites et montrent souvent une courbure dans le </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">virage</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (décrit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Nous randomisons les deux extrémités de la ligne en fonction de la rugosité. </font><font style="vertical-align: inherit;">Ensuite, nous sélectionnons deux autres points aléatoires approximativement à une distance de 50% et 75% de la fin du segment. </font><font style="vertical-align: inherit;">En reliant ces points de la courbe, nous obtenons l'effet de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexion</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/633/f29/8fe/633f298feb4231e8c9d652cb2811b4ff.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du dessin à la main, les gens déplacent parfois le crayon vers l'avant et vers l'arrière le long de la ligne. </font><font style="vertical-align: inherit;">Cela est nécessaire soit pour rendre la ligne plus lumineuse, soit simplement pour corriger la rectitude de la ligne. </font><font style="vertical-align: inherit;">Cela ressemble à ceci:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/377/2fd/665/3772fd6659c97c0dea4144645d63fdf7.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter un effet esquissé, RoughJS trace deux fois une ligne. </font><font style="vertical-align: inherit;">À l'avenir, je prévois de rendre cet aspect plus personnalisable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Regardez cette surface de toile. </font><font style="vertical-align: inherit;">Le paramètre de rugosité modifie l'apparence des lignes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vw/vy/fp/vwvyfpdytbbalxolkj9eufdctri.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'article original sur toile, vous pouvez vous dessiner. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous dessinez à la main, les longues lignes deviennent généralement moins droites et plus courbes. </font><font style="vertical-align: inherit;">Autrement dit, le caractère aléatoire des décalages pour créer un effet </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est fonction de la longueur et de la valeur de la ligne </font></font><code>randomness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cependant, la mise à l'échelle de cette fonction n'est pas adaptée aux très longues lignes. </font><font style="vertical-align: inherit;">Par exemple, dans l'image ci-dessous, les carrés concentriques sont dessinés avec la même graine aléatoire, c'est-à-dire </font><font style="vertical-align: inherit;">en fait, ce n'est qu'une figure aléatoire, mais avec une échelle différente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6f/943/aaf/c6f943aaf7f5fd94336286e902a7ed5b.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous remarquerez peut-être que les bords des carrés extérieurs semblent un peu plus inégaux que ceux intérieurs. </font><font style="vertical-align: inherit;">Par conséquent, j'ai également ajouté un facteur d'amortissement en fonction de la longueur de la ligne. </font><font style="vertical-align: inherit;">Le coefficient d'atténuation est utilisé comme une fonction de pas à différentes longueurs.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/f30/162/f0ff30162ccf5f76efab1543ed36b79a.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ellipses (et cercles)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prenez une feuille de papier et tracez quelques cercles le plus rapidement possible en un seul mouvement continu. </font><font style="vertical-align: inherit;">Voici ce que j'ai obtenu:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/268/911/691/2689116919287022e800ab72c7e3877f.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez que les points de début et de fin de la boucle ne correspondent pas toujours. </font><font style="vertical-align: inherit;">RoughJS essaie d'imiter cela, tout en rendant l'apparence plus complète (la technique est adaptée de l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article giCenter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'algorithme trouve les </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">points d'ellipse où il </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est déterminé par la taille de l'ellipse. </font><font style="vertical-align: inherit;">Ensuite, chaque point est randomisé par sa valeur </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ensuite, une courbe est tracée à travers ces points. </font><font style="vertical-align: inherit;">Pour obtenir l'effet des </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extrémités déconnectées, les</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> points du deuxième au dernier ne coïncident pas avec le premier point. </font><font style="vertical-align: inherit;">Au lieu de cela, la courbe relie les deuxième et troisième points.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d8/a4f/238/4d8a4f238460b44b847da72c22cbf3d1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une deuxième ellipse est également dessinée afin que la boucle soit plus fermée et ait un effet d'esquisse supplémentaire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'article d'origine, vous pouvez dessiner des ellipses sur une surface de canevas interactive. </font><font style="vertical-align: inherit;">Variez la rugosité et regardez comment la forme change:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/5g/9o/kq5g9ouwifltwn-qfp2tednoaqq.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas du dessin au trait, certains de ces artefacts deviennent plus accentués si une forme est mise à l'échelle à différentes tailles. </font><font style="vertical-align: inherit;">Dans une ellipse, cet effet est plus visible car le rapport est quadratique. </font><font style="vertical-align: inherit;">Dans l'image ci-dessous, tous les cercles ont la même forme, mais les extérieurs semblent plus inégaux.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d1c/bc1/682/d1cbc168206970ade73e1b7a77639d7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'algorithme s'ajuste automatiquement en fonction de la taille de la forme, augmentant le nombre de points dans le cercle ( </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Vous trouverez ci-dessous le même ensemble de cercles générés à l'aide du réglage automatique.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa4/6f0/612/aa46f0612d82b8944e70fb888db8ac39.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Complétant</font></font></h2><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lignes </font><em><font style="vertical-align: inherit;">pointillées</font></em><font style="vertical-align: inherit;"> 
sont généralement utilisées pour remplir des formes dessinées à la main </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dans le cas des esquisses à main levée, les lignes ne restent pas toujours dans le contour des formes. </font><font style="vertical-align: inherit;">Ils sont également randomisés. </font><font style="vertical-align: inherit;">La densité, l'angle, la largeur de ligne peuvent être ajustés.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e4/d62/0dc/1e4d620dc5d4e0c7167c7f64595537c6.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les carrés illustrés ci-dessus sont faciles à remplir, mais dans le cas d'autres formes, toutes sortes de problèmes peuvent survenir. </font><font style="vertical-align: inherit;">Par exemple, les polygones concaves (dans lesquels les angles peuvent dépasser 180 °) causent souvent de tels problèmes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/20b/9cd/46f/20b9cd46fba00903739307fba87386f0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, l'image ci-dessus est tirée d'un rapport d'erreur dans l'une des versions précédentes de RoughJS. Depuis lors, j'ai mis à jour l'algorithme de remplissage des traits en adaptant la version de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la méthode de balayage des chaînes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'algorithme de balayage des chaînes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut être utilisé pour remplir n'importe quel polygone. Son principe est de balayer un polygone en utilisant des lignes horizontales (lignes raster). Les lignes raster vont du haut du polygone vers le bas. Pour chaque ligne raster, nous déterminons à quels points la ligne coupe le polygone. Nous construisons ces points d'intersection de gauche à droite.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d9/6df/028/8d96df0287ebd8320120e61813fc30f6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En passant d'un point à un autre, nous passons du mode remplissage au mode non remplissage; </font><font style="vertical-align: inherit;">la commutation entre les états se produit lorsque chaque point d'intersection sur la ligne raster se rencontre. </font><font style="vertical-align: inherit;">Ici, il faut prendre en compte bien plus, en particulier les cas limites et les méthodes d'optimisation de l'analyse; </font><font style="vertical-align: inherit;">Vous pouvez en savoir plus à ce sujet ici: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixellisation des polygones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou déployer un spoiler avec un pseudo-code.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Détails de la mise en œuvre de l'algorithme de balayage des chaînes</font></font></b>
                        <div class="spoiler_text">     ()      .<br>
<br>
 —     (Edge Table, ET),   ,    <code>Y<sub>min</sub></code>.      <code>Y<sub>min</sub></code>,        <code>X<sub>min</sub></code>.<br>
<br>
 —     (Active Edge Table, AET),       ,     .<br>
<br>
        :<br>
<br>
<pre><code class="javascript hljs">interface EdgeTableEntry {
  <span class="hljs-attr">ymin</span>: number;<font></font>
  ymax: number;<font></font>
  x: number; <span class="hljs-comment">// Initialized to Xmin</span>
  iSlope: number; <span class="hljs-comment">// Inverse of the slope of the line: 1/m</span><font></font>
}<font></font>
<font></font>
interface ActiveEdgeTableEntry {<font></font>
  <span class="hljs-attr">scanlineY</span>: number; <span class="hljs-comment">// The y value of the scanline</span><font></font>
  edge: EdgeTableEntry;<font></font>
}</code></pre><br>
   ,    :<br>
<br>
<strong>1.</strong>  <em>y</em>   <em>y</em>  ET.      .<br>
<br>
<strong>2.</strong>  AET   .<br>
<br>
<strong>3.</strong>   ,   AET,  ET  :<br>
<br>
<strong>(a)</strong>    ET <em>y</em>  AET ,   <em>y<sub>min</sub> ≤ y</em>.<br>
<br>
<strong>(b)</strong>   AET ,   <em>y = y<sub>max</sub></em>,    AET  <em>x</em>.<br>
<br>
<strong>()</strong>      <em>y</em>,    <em>x</em>  AET.<br>
<br>
<strong>(d)</strong>   <em>y</em>   ,   , ..    .<br>
<br>
<strong>(e)</strong>    ,   AET,  <em>x</em>   <em>y</em> (<code>edge.x = edge.x + edge.iSlope</code>)</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'image ci-dessous (dans l'article original interactif), chaque carré représente un pixel. </font><font style="vertical-align: inherit;">Vous pouvez déplacer les sommets pour changer le polygone et observer quels pixels seront remplis traditionnellement.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/o7/wg/2po7wg8kdj0ixdeogj9_b2hax78.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du remplissage de traits, l'incrément de lignes raster est effectué par incréments en fonction de la densité donnée de lignes de traits, et chaque ligne est dessinée en utilisant l'algorithme décrit ci-dessus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, cet algorithme concerne les lignes raster horizontales. </font><font style="vertical-align: inherit;">Pour implémenter différents angles de traits, l'algorithme fait d'abord pivoter la forme elle-même de l'angle de traits souhaité. </font><font style="vertical-align: inherit;">Ensuite, les lignes raster de la figure pivotée sont calculées. </font><font style="vertical-align: inherit;">De plus, les lignes calculées retournent à l'angle des traits dans la direction opposée.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9b/1ad/324/e9b1ad3244af05b53b02203659e7f6f7.jpg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pas seulement pour remplir des traits</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RoughJS prend également en charge d'autres styles de remplissage, mais ils sont tous dérivés du même algorithme de hachurage. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le hachurage croisé</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consiste à dessiner des lignes en pointillés sous un angle </font></font><code>angle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, puis d'autres lignes sous un angle </font></font><code>angle + 90°</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zigzag</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cherche à connecter une ligne pointillée avec la précédente. </font><font style="vertical-align: inherit;">Pour obtenir un </font><font style="vertical-align: inherit;">motif de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">points</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tracez de petits cercles le long des lignes en pointillés.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06b/dcb/dee/06bdcbdee1eec1748f07434abb002f34.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les courbes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout dans RoughJS est normalisé aux courbes - lignes, polygones, ellipses, etc. </font><font style="vertical-align: inherit;">Par conséquent, le développement naturel de cette idée est de créer une courbe d'esquisse. </font><font style="vertical-align: inherit;">Dans RoughJS, nous passons un ensemble de points à une courbe, après quoi nous utilisons l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">approximation de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la courbe </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">pour les</font></a><font style="vertical-align: inherit;"> convertir en </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">courbes de</font></a><font style="vertical-align: inherit;"> Bézier cubiques </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque courbe de Bézier a deux points d'extrémité et deux points de contrôle. </font><font style="vertical-align: inherit;">En les randomisant sur la base </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez également créer des courbes «manuscrites».</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba3/0bd/82c/ba30bd82c30edfc43f6845670f97f4b0.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remplissage de courbe</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, le processus inverse est nécessaire pour remplir les courbes. Au lieu de tout normaliser en une courbe, la courbe se normalise en un polygone. Après avoir obtenu le polygone, vous pouvez utiliser l'algorithme de balayage de ligne pour remplir la forme courbe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez échantillonner des points sur la courbe avec la fréquence souhaitée en utilisant l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">équation de la courbe de Bézier cubique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a85/bcc/2d5/a85bcc2d5b946e8e88df52f2080b5303.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous utilisons la fréquence d'échantillonnage, qui dépend de la densité des traits, nous obtenons suffisamment de points pour remplir la figure. Mais ce n'est pas particulièrement efficace. Si une partie de la courbe est nette, nous avons besoin de plus de points. Si une partie de la courbe est presque droite, alors moins de points sont nécessaires. Une solution peut être de déterminer la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">courbure / lissage de la</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> courbe. Si elle est très courbe, nous divisons la courbe en deux courbes plus petites. S'il est lisse, nous le considérerons simplement comme une ligne droite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le lissage de la courbe est calculé en utilisant la méthode décrite dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce post</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La valeur de lissage est comparée à la valeur de tolérance, après quoi une décision est prise de diviser ou non la courbe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici la même courbe avec un niveau de tolérance de 0,7:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/995/55d/9be/99555d9be7e6cc2223db46f6cbd98da8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la seule base de la tolérance, l'algorithme fournit suffisamment de points pour représenter la courbe. </font><font style="vertical-align: inherit;">Cependant, cela ne vous permet pas de vous débarrasser efficacement des points optionnels. </font><font style="vertical-align: inherit;">Cela aidera le deuxième paramètre appelé </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distance</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pour réduire le nombre de points dans cette méthode, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'algorithme Ramer-Douglas-Pecker est utilisé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui </font><font style="vertical-align: inherit;">suit montre les points générés avec des </font><font style="vertical-align: inherit;">valeurs de distance, égale à </font></font><code>0.15</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>0.75</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>1.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>3.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c9/e93/6e1/4c9e936e15771d9d02d1768a2e14b70b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fonction de la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rugosité de la</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> forme, vous pouvez définir la valeur de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distance</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appropriée </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Après avoir reçu tous les sommets du polygone, nous pouvons magnifiquement remplir les formes courbes:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/eb7/161/45beb716138e9836c8e841f63d15f28a.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuits SVG</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les contours SVG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont un outil très puissant qui peut être utilisé pour créer toutes sortes d'images époustouflantes, mais pour cette raison, il est assez difficile de les utiliser. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RoughJS analyse le chemin et le normalise en seulement trois opérations: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Move</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Line</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cubic Curve</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chemin-analyseur-de-données</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Après la normalisation, la figure peut être dessinée en utilisant les méthodes ci-dessus pour tracer des lignes et des courbes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le package de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">points sur chemin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> combine la normalisation des chemins et l'échantillonnage des points de courbe pour calculer les points de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">chemin</font></a><font style="vertical-align: inherit;"> correspondants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un exemple de calcul de points pour un chemin </font></font><code>M240,100c50,0,0,125,50,100s0,-125,50,-150s175,50,50,100s-175,50,-300,0s0,-125,50,-100s0,125,50,150s0,-100,50,-100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/585/374/dd6/585374dd67d5210ff7628540a6b5edaa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre exemple SVG que j'aime montrer est la </font><font style="vertical-align: inherit;">carte </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muette</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des États-Unis:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff7/68b/675/ff768b675300dc4604b87dc2e81478c7.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayez RoughJS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consultez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le site Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">référentiel sur Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> l' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">API</font></a><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suivez</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Twitter </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">@RoughLib</font></a><font style="vertical-align: inherit;"> pour des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">informations sur le</font></a><font style="vertical-align: inherit;"> projet </font><font style="vertical-align: inherit;">.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500008/index.html">Rencontrez des ascendants</a></li>
<li><a href="../fr500010/index.html">Histoire de l'hydrogène sale</a></li>
<li><a href="../fr500012/index.html">Entity Framework Core</a></li>
<li><a href="../fr500014/index.html">La conception entièrement réactive est plus que de simples requêtes médiatiques</a></li>
<li><a href="../fr500016/index.html">Travaux pratiques avec FPGA dans l'ensemble de Redd. Maîtriser le DMA pour le bus Avalon-ST et basculer entre les bus Avalon-MM</a></li>
<li><a href="../fr500020/index.html">Google Earth Engine - Plate-forme unique d'analyse de grandes géodonnées</a></li>
<li><a href="../fr500022/index.html">Pourquoi participer à la vie communautaire et comment cela contribue-t-il à la croissance professionnelle?</a></li>
<li><a href="../fr500026/index.html">Un non-sens dans cette industrie * tout simplement incroyable</a></li>
<li><a href="../fr500028/index.html">Plateformes de gestion des données: périphérique vers cloud</a></li>
<li><a href="../fr500030/index.html">Qui est bon dans une crise: exemples d'entreprises informatiques dont les stocks augmentent pendant une pandémie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>