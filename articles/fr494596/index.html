<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍟 🌴 🤝 Comment créer un modèle de transport multi-agents 🕢 🧑🏿‍🤝‍🧑🏻 👦🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 
 
 Imaginez que nous ayons la tâche de construire une nouvelle route. Vous pouvez construire une autoroute à deux voies dans chaque di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment créer un modèle de transport multi-agents</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494596/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imaginez que nous ayons la tâche de construire une nouvelle route. Vous pouvez construire une autoroute à deux voies dans chaque direction, mais que faire si cela ne suffit pas? Ou, au contraire, il s'avère qu'une bande suffirait, mais pour la mise en œuvre du projet il a fallu acheter de nombreux terrains? Dans les deux cas, la décision sera sans effet. Pour minimiser ces risques, les planificateurs des transports se tournent vers la modélisation informatique pour obtenir de l'aide. Cet article est une brève digression dans le monde de la modélisation multi-agents.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bq/k0/kj/bqk0kjbb814y7q7twu1uvqk3yf4.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide du modèle, qui est une copie du système de transport réel, vous pouvez estimer le débit nécessaire sur chaque tronçon de la route projetée, essayer différentes options de traçage, ou, par exemple, estimer la période de récupération d'un projet s'il s'agit d'une route à péage dans le cadre d'un partenariat public-privé. Mais d'autres tâches importantes peuvent être résolues: comment organiser les itinéraires de transport public optimaux et calculer les revenus potentiels des opérateurs, comment évaluer la présence d'une pénurie de places de stationnement dans une zone particulière, et bien d'autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui est le plus intéressant, c'est que n'importe qui peut construire un modèle similaire à l'ère du logiciel libre! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des outils de modélisation multi-agents les plus courants est l'open source.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATSim (Simulation de transport multi-agents)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MATSim simule le comportement d'agents individuels. Un agent est une représentation informatique d'un individu dans le monde réel. Chacun de ces agents a un plan quotidien, sur la base duquel il passe d'une activité à une autre (par exemple, maison-travail-maison, maison-institut-travail-maison, maison-atelier-travail1-travail2-maison, etc.), créant d'où la demande d'infrastructures routières. Une représentation schématique du plan quotidien ressemble à ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n6/xt/m_/n6xtm_ps8u0stk6f8doybvsxzq8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de créer des plans réalistes pour les agents qui refléteront le comportement réel des personnes pendant la journée, le nombre total de résidents des agents, leur réinstallation, lieux de travail, étude, emplacement des magasins, centres commerciaux, gares et autres lieux d'activité sont pris en compte. Pour valider la demande, le modèle est également calibré sur la base d'enquêtes de terrain: reconnaissance et calcul des flux de caméras de surveillance et de drones à l'aide d'un réseau de neurones ou, par exemple, des mesures manuelles d'intensité sur les routes.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/t-/ke/0xt-kelsnwf39k3mmu2saye2zky.gif" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la simulation, les agents sont répartis sur le réseau, imitant le comportement réaliste des personnes: la mise en œuvre de leur plan, les voitures occupent une place sur la route et les parkings, les usagers des transports en commun prennent place dans le bus, et interagissent également entre eux et, si de nombreux agents choisissent une route à la fois, des embouteillages et des encombrements sont créés. Tout est comme dans le monde réel! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois la simulation terminée, une évaluation est faite de la réalisation des plans quotidiens des agents, appelée notation. L'agent acquiert des unités utilitaires en cours d'activité et les perd lors du mouvement. En conséquence, les agents pris dans un embouteillage perdent plus d'unités utilitaires que les agents circulant sur des routes libres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après chaque itération, certains agents reconstruisent leur plan sur la base d'informations sur la charge du réseau routier de manière à améliorer leurs performances: les agents peuvent changer l'heure de départ, changer le mode de transport ou changer l'itinéraire. </font><font style="vertical-align: inherit;">Les agents restants adhèrent à leurs plans précédents, qui sont stockés dans la mémoire du programme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Idéalement, après la simulation, un équilibre de Nash devrait être atteint - c'est-à-dire une situation où aucun agent ne peut améliorer sa position sans aggraver la position d'autres agents. </font><font style="vertical-align: inherit;">C'est généralement la situation qui évolue au fil du temps sur les routes de la ville, compte tenu de la repensée quotidienne de l'expérience de la veille par ses habitants. </font><font style="vertical-align: inherit;">Pour cela, au moins 200 itérations sont effectuées dans le cadre d'un scénario. </font><font style="vertical-align: inherit;">L'ensemble du cycle de travail MATSim ressemble à ceci:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/zv/ds/mrzvds3njmsli5hbkiqvzhnuoju.png" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De la théorie à la pratique! </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour exécuter le premier scénario, nous avons besoin d'Intellij IDEA (ou Eclipse) avec Java 1.8 à bord. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ouvrons l'IDE, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clonons le référentiel MATSim à</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> partir du github et notre premier scénario est prêt à fonctionner! </font><font style="vertical-align: inherit;">Si simple. </font><font style="vertical-align: inherit;">Mais voyons d'abord quels fichiers d'entrée nous utilisons. </font><font style="vertical-align: inherit;">Pour la simulation la plus simple, il y en a trois: réseau, plans, config.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réseau</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier réseau est le réseau sur lequel les agents se déplacent. </font><font style="vertical-align: inherit;">Il se compose de nœuds et de nœuds / liens. </font><font style="vertical-align: inherit;">Chaque lien a des attributs différents: type, longueur de segment, débit, vitesse maximale, nombre de voies, trafic à sens unique, modes de transport autorisés, etc. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_n/5p/rx/_n5prxnenyiuei82fndy2uekigy.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création manuelle d'un réseau urbain est difficile, peu pratique et inefficace. </font><font style="vertical-align: inherit;">Par exemple, notre réseau de Saint-Pétersbourg comprend 26 000 nœuds et 46 000 liens. </font><font style="vertical-align: inherit;">Mais il y a de bonnes nouvelles. </font><font style="vertical-align: inherit;">La grille peut être convertie à partir d'OpenStreetMap puis modifiée à l'aide de JOSM, qui est également open-source.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des plans</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier des plans est une représentation structurée des plans quotidiens des agents. </font><font style="vertical-align: inherit;">Dans le scénario initial, nous avons 100 agents qui partent en voiture (mode = ”voiture”) le matin (end_time = ”05:59”) de chez eux (type = ”h”, lien = ”1”) pour travailler (type = ”W”, link = ”20”), après quoi après un certain temps (dur = ”02:30”) ils rentrent chez eux.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8g/vh/sp/8gvhsph0hfmjwzpfspy0liqv7xo.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Config</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, dans le fichier de configuration, tous les paramètres nécessaires sont définis pour exécuter le script. </font><font style="vertical-align: inherit;">MATSim se compose de modules que vous pouvez personnaliser, ajouter ou supprimer au besoin. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nombreux paramètres du fichier de configuration sont intuitifs, mais vous pouvez également toujours regarder ce que l'on appelle. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Livre MATSim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous allons maintenant considérer seulement deux modules.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les paramètres de notation sont définis dans le module planCalcScore: par exemple, un agent reçoit une pénalité de 18 unités pour les arrivées tardives. </font><font style="vertical-align: inherit;">utilité par heure (respectivement, être en retard de 10 minutes équivaut à perdre 3 unités utilitaires); </font><font style="vertical-align: inherit;">la performance d'une activité (par exemple, effectuer) apporte 6 unités utilitaires par heure, et conduire une voiture coûte les mêmes 6 unités utilitaires par heure. Pour trouver des paramètres de notation réalistes, les sondages d'opinion sont le plus souvent utilisés pour analyser le «coût» temps. » </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le module de stratégie, les </font><font style="vertical-align: inherit;">paramètres de </font><font style="vertical-align: inherit;">replanification sont configurés, par exemple, quel est le </font><font style="vertical-align: inherit;">pourcentage des agents (ModuleProbability) va essayer la nouvelle route (ReRoute) au </font><font style="vertical-align: inherit;">cours de </font><font style="vertical-align: inherit;">la prochaine itération. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dc/jf/yo/dcjfyoldbtrsg_zgrydyrrkc6ce.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'objectif de la simulation est d'aider l'agent du point A au point B au plus bas coût.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution de script</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est temps d'ouvrir RunMatsim runner et d'exécuter notre premier script! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les résultats de la simulation seront dans le dossier de sortie à la racine du projet. Les principaux fichiers de visualisation sont le réseau et les événements. Le fichier d'événements contient des informations par seconde sur toutes les actions de chaque agent, donc en fonction de ce fichier, vous pouvez restaurer l'image complète du mouvement de tous les agents. Vous pouvez visualiser les résultats à l'aide de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Via</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour des résultats plus représentatifs, j'augmenterai le nombre d'agents à 500. C'est ainsi que la distribution de 500 agents s'occupe de la première itération ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/by/o3/zk/byo3zk14bt0yj1y7od2sth35nok.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début de l'itération, les agents ont calculé le chemin le plus court en utilisant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dijkstra</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À la suite de quoi l'intensité du trafic dans une section du réseau a dépassé son débit, une congestion s'est formée. </font><font style="vertical-align: inherit;">Mais que faire si vous leur donnez la possibilité d'essayer différents itinéraires? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7l/_j/5_/7l_j5_q_n2g3roivtbnht8iwqfq.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après 200 itérations (~ 5 minutes), les agents ont été redistribués sur le réseau, le niveau de charge de la liaison ne dépasse plus 0,5 et le temps de trajet moyen pour tous les agents a diminué de 14% (5 minutes). </font><font style="vertical-align: inherit;">Hourra, nous avons surmonté le bouchon! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh, si seulement c'était aussi simple que ça! </font><font style="vertical-align: inherit;">En réalité, les systèmes de transport sont beaucoup plus compliqués. </font><font style="vertical-align: inherit;">Dans les articles suivants, je vais vous dire comment j'ai participé au développement de modèles de Saint-Pétersbourg et d'autres villes et comment nous avons résolu des problèmes pratiques sur des cas réels. </font><font style="vertical-align: inherit;">Scientia potentia est! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cj/v-/t0/cjv-t0plurhha0_szf4vhthcubo.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publié par Andrey Kolomatsky, analyste des transports à OTSLab.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr494580/index.html">Fractales dans le sable, ou Plus de trois ne se rassemblent pas</a></li>
<li><a href="../fr494582/index.html">Microsoft n'émettra plus de certificats MCSE / MCSD / MCSA</a></li>
<li><a href="../fr494586/index.html">Programmation fonctionnelle comme exemple de travail avec des matrices de la théorie de l'algèbre linéaire</a></li>
<li><a href="../fr494590/index.html">Coronavirus - l'apothéose de la panique</a></li>
<li><a href="../fr494592/index.html">Laser à vapeur de manganèse fait maison</a></li>
<li><a href="../fr494598/index.html">Des chercheurs de Stanford ont développé un exosquelette pour courir</a></li>
<li><a href="../fr494600/index.html">Création d'un bot Discord simple à l'aide de la bibliothèque discord.py</a></li>
<li><a href="../fr494604/index.html">Boîte de stérilisation UV pour la réutilisation des masques jetables</a></li>
<li><a href="../fr494606/index.html">Comment observer la lune et les planètes</a></li>
<li><a href="../fr494608/index.html">Se préparer pour Ludum Dare</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>