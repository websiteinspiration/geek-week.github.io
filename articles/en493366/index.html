<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏠 💦 🐎 What is Windows PowerShell and what does it eat? Part 3: passing parameters to scripts and functions, creating cmdlets 🏦 👕 ⌨️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The second part of the series covered the basics of the PowerShell programming language, but now it’s worthwhile to figure out how to use the code wri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>What is Windows PowerShell and what does it eat? Part 3: passing parameters to scripts and functions, creating cmdlets</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/493366/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">second part of the series</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> covered the basics of the PowerShell programming language, but now it’s worthwhile to figure out how to use the code written on it for administrative tasks. </font><font style="vertical-align: inherit;">The most obvious way to do this is to run the script. </font><font style="vertical-align: inherit;">In addition to it, it is possible to create your own cmdlets.</font></font><a name="habracut"></a><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table of contents:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positional parameters </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param () block </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additional parameter attributes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passing parameters through the pipeline </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function body structure </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attribute [CmdletBinding ()] and advanced functions </font></font></a> <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripting modules and creating cmdlets</font></font></a><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Positional parameters</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In scripts and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">functions,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you can pass positional parameters (arguments) whose values ​​are written to the $ args built-in variable. </font><font style="vertical-align: inherit;">This one-dimensional </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not require prior declaration, and its scope is limited to a script or function. </font><font style="vertical-align: inherit;">For example, run the simplest script:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">":"</span> <span class="hljs-variable">$args</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/pv/ba/n8/pvban8oufym9ppbwb0jkgp_rwfq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In functions, positional parameters are used in the same way:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Print-Args</span></span> {
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" :"</span> <span class="hljs-variable">$args</span>.count
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 0:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">0</span>]
    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" 1:"</span> <span class="hljs-variable">$args</span>[<span class="hljs-number">1</span>] <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Print-Args “Zero” “One” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that when calling Print-Args we do not put a comma between the parameters: it is not an array that is passed to the function, but individual values ​​that are written to the one-dimensional array $ args - its scope is limited by the body of the function. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tf/ur/o7/tfuro78h2bg7vhs405ymxd7ks-o.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The method described above allows you to pass any number of parameters to a script or function, but when calling you must follow the order of their sequence, and you can access them only by the index of the array - this is not always convenient.</font></font><br>
<br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Param block ()</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In scripts and functions, it is much more convenient to use named parameters. </font><font style="vertical-align: inherit;">In a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previous article,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we talked about one way to describe them:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">(<span class="hljs-variable">$arg0</span>, ..., <span class="hljs-variable">$argN</span>)</span></span><font></font>
{<font></font>
       <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A similar syntax is familiar to developers, but when a function is called, the parameters (if any) are separated by spaces, and are not enclosed in parentheses - a certain dissonance arises. This is the specificity of shell languages: for working with the shell in interactive mode, spaces between values ​​are much more convenient. The </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test ($ value0) call is</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also correct, but the parameter in this case is the entire expression in parentheses, i.e. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">($ value0)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instead of </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Passing in this way several parameters will not work. As a result of calling </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test ($ value0, $ value1), the</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function will receive only one - an array of two elements with values </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ value1</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft Corporation recommends using the Param () block - this syntax is more universal and allows you to specify not only function arguments, but also script parameters:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span> (
    <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$arg0</span> <span class="hljs-variable">$arg1</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/3o/yl/zy/3oylzy5_ukl893oyfcu54fejeaq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the body of the function, it looks like this:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
     <span class="hljs-keyword">param</span> (
           <span class="hljs-variable">$arg0</span>, <span class="hljs-variable">$arg1</span><font></font>
     )<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the argument list of the function is small, the Param () block will only clutter the design, but in many cases it makes the code more readable and is, among other things, an element of a good programming style.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additional parameter attributes</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When describing function arguments or script parameters, their additional attributes can be set. </font><font style="vertical-align: inherit;">The simplest example is a forced installation of the type:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([int]<span class="hljs-variable">$arg0</span>)</span></span> {<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to type casting, you can use the [parameter ()] attribute:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Argument1</span>=<span class="hljs-type">value1</span>, <span class="hljs-type">Argument2</span>=<span class="hljs-type">value2</span>)]
    <span class="hljs-variable">$ParameterName</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
With its help it is easy to make the parameter mandatory. </font><font style="vertical-align: inherit;">Pay attention to the simultaneous use of several attributes - in this case they follow each other:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span> <span class="hljs-params">([parameter(Mandatory=<span class="hljs-variable">$true</span>)</span>][<span class="hljs-title">int</span>]$<span class="hljs-title">arg0</span>)</span> { <font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span> {
          <span class="hljs-keyword">parameter</span>([<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)][<span class="hljs-built_in">int</span>]<span class="hljs-variable">$arg0</span>)<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/km/2j/7a/km2j7agackddylgawcafzzho-fq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Position allows you to specify the order of the parameter (by default, it corresponds to the order of the declaration):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>, <span class="hljs-type">Position</span>=<span class="hljs-number">0</span>)]<font></font>
                    [<span class="hljs-built_in">int</span>]
                    <span class="hljs-variable">$arg0</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">1</span>)]<font></font>
                    [<span class="hljs-built_in">string</span>]
                    <span class="hljs-variable">$arg1</span>,<font></font>
<font></font>
                    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Position</span>=<span class="hljs-number">2</span>)]<font></font>
                    [<span class="hljs-built_in">array</span>]
                    <span class="hljs-variable">$arg2</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The [Parameter ()] attribute has other arguments, a complete list of which is available </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">website</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Other attributes are described there, with the help of which you can validate the passed values, check them using regular expressions, etc. </font><font style="vertical-align: inherit;">Here are a few: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Alias ​​()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sets an alias for the parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">alias</span>(<span class="hljs-string">"ARG"</span>,<span class="hljs-string">"ArgumentName"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The cast operator [string []] means that the parameter value is a string array. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowNull ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows $ null as a required parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowNull</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyString ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows an empty string as a required parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyString</span>()]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[AllowEmptyCollection ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows an empty array as a required parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">AllowEmptyCollection</span>()]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ValidatePattern ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> validation using a regular expression:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidatePattern</span>(<span class="hljs-string">"[0-9][0-9][0-9][0-9]"</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ValidateLength ()]</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> checks the length of a string parameter:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-type">ValidateLength</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)]<font></font>
    [<span class="hljs-built_in">string</span>]
    <span class="hljs-variable">$arg0</span>
)</code></pre><br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passing parameters through the pipeline</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first article in the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> series, we talked about the possibility of transferring data to cmdlets through a pipeline. </font><font style="vertical-align: inherit;">In PowerShell, cmdlets and functions return objects or arrays of objects (results of statements), and also receive them at the input. </font><font style="vertical-align: inherit;">To see this, we prepare one of the cmdlets using Get-Help:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Help</span> <span class="hljs-built_in">Stop-Process</span> <span class="hljs-literal">-Parameter</span> Name</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ci/fg/4_/cifg4_8pquaf9x684dyznzxff0m.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Through the pipeline, you can accept parameter values ​​for which the corresponding attributes are set (ByValue and / or ByPropertyName). </font><font style="vertical-align: inherit;">In the first case, the parameter will be matched with an object received via the pipeline, provided that its type corresponds to the expected one. </font><font style="vertical-align: inherit;">In the second parameter value will be the property of the incoming object whose name corresponds to the name or alias of this parameter. </font><font style="vertical-align: inherit;">To set the attributes, use [parameter ()] with the boolean arguments ValueFromPipeline and ValueFromPipelineByPropertyName, whose default value is $ false:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ValueFromPipelineByPropertyName is usually used if necessary to pass several parameters so that there is no confusion, and the argument can be used simultaneously with ValueFromPipeline: </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">param</span>(<font></font>
    [<span class="hljs-type">parameter</span>(<span class="hljs-type">Mandatory</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipeline</span>=<span class="hljs-variable">$true</span>,
    <span class="hljs-type">ValueFromPipelineByPropertyName</span>=<span class="hljs-variable">$true</span>)]<font></font>
    [<span class="hljs-built_in">string</span>[]]
    <span class="hljs-variable">$Name</span><font></font>
)<font></font>
<font></font>
<span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$Name</span></code></pre><br>
<br>
<img src="https://habrastorage.org/webt/ym/i4/go/ymi4gowjn0tz4dpkgzdl5wjxztu.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, scripts can also receive parameters through the pipeline, but nevertheless, the practical application of the attributes described above is more likely for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">advanced functions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which will be discussed below.</font></font><br>
<br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Function body structure</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell, a function can include three optional blocks of code enclosed in statement brackets - Begin, Process, and End. </font><font style="vertical-align: inherit;">It looks something like this:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
   <span class="hljs-keyword">param</span>()
   <span class="hljs-keyword">begin</span> {}
   <span class="hljs-keyword">process</span> {}
   <span class="hljs-keyword">end</span> {}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Begin block is the first to be executed once, and if the parameters are passed to the function through the pipeline, the code will run before the first object arrives for processing. The $ _ and $ PSItem variables in the Begin block in this case will not contain values. If the function is called using explicitly specified parameters, they will be available in the Begin block, since there is no need to wait for objects to be received from the pipeline. Next, the Process block is executed: if the parameters are passed through the pipeline, it will be launched one by one for each object. In the case of explicitly specified parameters, the Process block starts only once. The function ends by executing the End block once. Obviously, the use of these constructions is justified only if the function can receive objects from the pipeline:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test</span></span><font></font>
{<font></font>
<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-type">Parameter</span>(<span class="hljs-type">ValueFromPipeline</span>)]<font></font>
        [<span class="hljs-built_in">string</span>[]]
        <span class="hljs-variable">$Param1</span>,<font></font>
<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$Param2</span><font></font>
    )<font></font>
<font></font>
    <span class="hljs-keyword">begin</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Begin"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">process</span> {
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" Process"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">end</span><font></font>
    {<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">" End"</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( pipeline):"</span> <span class="hljs-variable">$Param1</span>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"       ( ):"</span> <span class="hljs-variable">$Param2</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
'one', 'two', 'three' | </font><font style="vertical-align: inherit;">test -Param2 'four'</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aa/k5/fa/aak5fa8wzzrqxrzp4ixi-cybabw.png" alt="image"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[CmdletBinding ()] Attribute and Advanced Functions</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create “advanced” functions (and scripts strictly speaking), you can use the [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CmdletBinding ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] </font><font style="vertical-align: inherit;">attribute </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In particular, it allows you to define advanced functions with the capabilities of binary cmdlets compiled in Visual Studio, which are classes of .NET Core classes. </font><font style="vertical-align: inherit;">Since this attribute is used mainly in functions, we will stop on them:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> &lt;<span class="hljs-title">Name</span>&gt;</span><font></font>
{<font></font>
    [<span class="hljs-type">CmdletBinding</span>(<span class="hljs-type">ConfirmImpact</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">DefaultParameterSetName</span>=&lt;<span class="hljs-built_in">String</span>&gt;,
    <span class="hljs-type">HelpURI</span>=&lt;<span class="hljs-type">URI</span>&gt;,
    <span class="hljs-type">SupportsPaging</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">SupportsShouldProcess</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;,
    <span class="hljs-type">PositionalBinding</span>=&lt;<span class="hljs-built_in">Bool</span><span class="hljs-type">ean</span>&gt;)]<font></font>
<font></font>
    <span class="hljs-keyword">Param</span> ()<font></font>
<font></font>
    <span class="hljs-keyword">Begin</span>{}
    <span class="hljs-keyword">Process</span>{}
    <span class="hljs-keyword">End</span>{}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In fact, [CmdletBinding ()] initializes a new instance of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CmdletBindingAttribute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">by calling the constructor, to which optional arguments can be passed. Their detailed description is </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Microsoft </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">website</font></a><font style="vertical-align: inherit;"> . The CmdletBinding attribute allows you to control additional features of the advanced function: adding support for -Confirm and -WhatIf (via SupportsShouldProcess), -Force, -Verbose and -Debug, as well as disabling positional parameter binding, etc. Further we will analyze the use of special parameters. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Force</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter </font><strong><font style="vertical-align: inherit;">is</font></strong><font style="vertical-align: inherit;"> used to suppress requests for various operations; </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-WhatIf</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">needed to emulate the launch and display information about the consequences of executing a function (command) without this parameter. Commonly used if a function can perform destructive actions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remove-Item C: \ Windows \ notepad.exe -WhatIf </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ag/b9/cl/agb9cl6mbsaxqvrmwwl_fj1xjrm.png" alt="image"><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Confirm</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requires confirmation and is also used if the function can perform destructive actions.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Delete-File</span></span> {<font></font>
[<span class="hljs-type">CmdletBinding</span>(
    <span class="hljs-type">ConfirmImpact</span> = <span class="hljs-string">'High'</span>,
    <span class="hljs-type">SupportsShouldProcess</span> = <span class="hljs-variable">$true</span><font></font>
)]<font></font>
    <span class="hljs-keyword">param</span>(<font></font>
        [<span class="hljs-built_in">string</span>]<span class="hljs-variable">$File</span>,<font></font>
        [<span class="hljs-type">switch</span>]<span class="hljs-variable">$Force</span><font></font>
    )<font></font>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$Force</span> <span class="hljs-operator">-or</span> <span class="hljs-variable">$PSCmdlet</span>.ShouldProcess(<span class="hljs-variable">$File</span>,<span class="hljs-string">"Delete file"</span>)) {
        <span class="hljs-built_in">Remove-Item</span> <span class="hljs-variable">$File</span><font></font>
    }<font></font>
}</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/la/ie/oq/laieoqimwhyv-dtm_l5m0yp6xay.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To process -WhatIf and / or -Confirm, the ShouldProcess method (SupportsShouldProcess = $ true) is called, which either prompts or emulates the execution of the command. To implement -Force processing, we put it first in the IF condition. First, the expression to the left of the -or operator is checked, and if it is true, the test stops - the ShouldProcess method will not be called. Also, in the [CmdletBinding ()] attribute, we specified the ConfirmImpact argument, which determines the level of influence of the code on the system and includes the -Confirm parameter handler. This argument can take the following values: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or not specified - confirmation messages will not be displayed, even if the -Confirm parameter is passed. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Low</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the function slightly affects the system and does not create significant risks of data loss.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medium</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - medium exposure with little risk of data loss as a result of destructive actions. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">High</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the code creates a high risk of data loss as a result of destructive actions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, for a PowerShell session, the exposure level is considered High. The current value is stored in the $ ConfirmPreference variable, and if the code has the same or higher level of impact on the system, a confirmation request will always be displayed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Options </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Verbose</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-Debug</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">needed to display debugging information. </font><font style="vertical-align: inherit;">Their use is considered a good programming style (forget about Write-Host, this is not necessary in advanced functions). </font><font style="vertical-align: inherit;">The first parameter displays information about the progress, and the second - detailed debugging information. </font><font style="vertical-align: inherit;">It also makes it possible to switch to step-by-step code execution. </font><font style="vertical-align: inherit;">The behavior of -Verbose and -Debug is defined like this:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Get-Something</span></span> {
<span class="hljs-function">[<span class="hljs-type">CmdletBinding</span>()]</span>
    <span class="hljs-keyword">param</span>()
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Verbose) {<span class="hljs-variable">$VerbosePreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$PSBoundParameters</span>.Debug) {<span class="hljs-variable">$DebugPreference</span> = <span class="hljs-string">"Continue"</span>}
    <span class="hljs-built_in">Write-Verbose</span> <span class="hljs-string">"Type some verbose information"</span>
    <span class="hljs-built_in">Write-Debug</span> <span class="hljs-string">"Type some debug information"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To work with special parameters, we used the $ PSBoundParameters variable. </font><font style="vertical-align: inherit;">By default, the values ​​of $ VerbosePreference and $ DebugPreference are equal to 'SilentlyContinue', therefore, even if the corresponding parameters are specified, debugging information will not be displayed - they must be transferred to the 'Continue' state.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script Modules and Cmdlet Creation</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's start creating our own cmdlets. In fact, these are advanced functions that are described in the so-called </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script modules</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - text files with the extension .psm1. They are stored in directories defined in the environment variable PSModulePath. You can view the paths to them using the following command: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Get-ChildItem Env: \ PSModulePath | Format-Table -AutoSize </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The standard set looks something like this: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Users \% UserName% \ Documents \ WindowsPowerShell \ Modules </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Program Files \ WindowsPowerShell \ Modules </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C: \ Windows \ System32 \ WindowsPowerShell \ v1.0 \ Modules</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creating the ModuleName.psm1 file with the extended Delete-File function from the previous section, you need to save it, for example, in] C: \ Users \% UserName% \ Documents \ WindowsPowerShell \ Modules \ ModuleName. Please note that the script module must be stored in a separate subdirectory, the name of which coincides with the base name (without extension) of the .psm1 file. After running the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Import-Module ModuleName command</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the Delete-File function will become available to the user, and since it is advanced, from the practical point of view it is the same cmdlet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9j/5d/fw/9j5dfwsxqzf3jeznbl_em53lnpi.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we have examined in sufficient detail the passing of parameters to functions and scripts. The next part of the series will focus on object-oriented programming. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1: Windows PowerShell Essentials</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> 2:     Windows PowerShell</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> 4:   ,  <br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493348/index.html">Make "udalenka" great again: how to transfer the whole company to remote work in 4 stages</a></li>
<li><a href="../en493352/index.html">Broadcast your videos on YouTube around the clock</a></li>
<li><a href="../en493356/index.html">Video @Databases Meetup: DBMS Security, Tarantool in IoT, Greenplum for Big Data Analytics</a></li>
<li><a href="../en493360/index.html">Two fingers from Algol</a></li>
<li><a href="../en493362/index.html">Technical support "on the suitcases." How we work remotely without unnecessary nerves and get the services we need remotely</a></li>
<li><a href="../en493374/index.html">Coronavirus - practical tips and a bit of theory</a></li>
<li><a href="../en493376/index.html">The Big Initiative Theory - Russian Experience in Digital Transformation of Industrial Enterprises</a></li>
<li><a href="../en493378/index.html">Steam has you: how digital distribution takes away our games</a></li>
<li><a href="../en493380/index.html">Julia and quantum computing</a></li>
<li><a href="../en493382/index.html">.NET Core Windows Forms Designer Updates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>