<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏝️ 🤵🏻 🍉 CatBoostの概要。Yandexレポート ☑️ 🌬️ 🤙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="私の名前はStas Kirillovです。YandexのMLプラットフォームグループの主要開発者です。機械学習ツールを開発し、それらのインフラストラクチャをサポートおよび開発しています。以下は、CatBoostライブラリがどのように機能するかについての最近の講演です。レポートでは、コードを理解したり...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CatBoostの概要。Yandexレポート</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/458790/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私の名前はStas Kirillovです。YandexのMLプラットフォームグループの主要開発者です。</font><font style="vertical-align: inherit;">機械学習ツールを開発し、それらのインフラストラクチャをサポートおよび開発しています。</font><font style="vertical-align: inherit;">以下は、CatBoostライブラリがどのように機能するかについての最近の講演です。</font><font style="vertical-align: inherit;">レポートでは、コードを理解したり、貢献したりする人のために、コードのエントリポイントと機能について説明しました。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ySla2kczbeM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-CatBoostは、Apache 2.0ライセンスの下でGitHub上に存在します。つまり、CatBoostは誰にとってもオープンで無料です。プロジェクトは活発に開発されており、現在、リポジトリには4,000以上の星があります。 CatBoostはC ++で記述されており、決定木に対する勾配ブースティング用のライブラリです。ライブラリでデフォルトで使用される、いわゆる「対称」ツリーを含む、いくつかのタイプのツリーをサポートしています。</font></font><br>
<br>
<a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちの忘却の木の利益は何ですか？彼らは、モデルの最終的な品質の変化に関して、パラメーターの変化に対する抵抗力が高くなるようにすばやく学習し、すばやく適用し、学習を支援します。これにより、パラメーターの選択の必要性が大幅に減少します。私たちのライブラリは、本番環境での使用を便利にし、短期間で学習し、すぐに高品質を実現するためのものです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wv/0s/8f/wv0s8fv32vjvrpihdkyek1uv-yu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
勾配ブースティングは、目的関数を改善する単純な予測子を構築するアルゴリズムです。つまり、複雑なモデルをすぐに作成する代わりに、多数の小さなモデルを順に作成します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nn/jd/e0/nnjde08vq2zueuftpfs6nv1pemw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CatBoostの学習プロセスはどうですか？コードの観点から、それがどのように機能するかを説明します。まず、ユーザーが渡すトレーニングパラメーターを解析して検証し、データを読み込む必要があるかどうかを確認します。たとえば、PythonやRなどでデータを既にロードできるため。次に、データをロードし、境界からグリッドを構築して、数値的特徴を量子化します。これは学習を速くするために必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが少し異なって処理するカテゴリー的特徴。特徴を最初に分類し、カテゴリ特徴の組み合わせをすばやく読み取るために、ハッシュをゼロから分類特徴の一意の値の数に再番号付けします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、トレーニングループを直接起動します。これは、機械学習のメインサイクルで、ツリーを繰り返し作成します。このサイクルの後、モデルがエクスポートされます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/m6/lm/edm6lmnfi6ub-9ocgvxci6x7usm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングサイクル自体は4つのポイントで構成されます。最初に、1つのツリーを構築しようとしています。次に、品質のどのような増減があるかを調べます。次に、再トレーニング検出器が機能しているかどうかを確認します。次に、適切なタイミングでスナップショットを保存します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/es/f2/wnesf2muxq15auqojtipuwjzrjk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単一のツリーの学習は、ツリーレベルのサイクルです。最初に、順序付けられたブースティングを使用する場合、またはカテゴリカル機能がある場合は、データの順列をランダムに選択します。次に、この順列のカウンターを数えます。次に、このツリーで良い分割を貪欲に選びます。スプリットとは、単に特定のバイナリ条件を意味します。そのような数値的特徴は、そのような値よりも大きいか、またはカテゴリ特徴によるそのようなカウンタは、そのような値よりも大きいです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
貪欲なツリーレベルのサイクルはどのように配置されますか？最初に、ブートストラップが実行されます。オブジェクトの再計量またはサンプリングが行われ、その後、選択されたオブジェクトのみがツリーの構築に使用されます。各レベルのサンプリングオプションが有効になっている場合は、各分割を選択する前にブートストラップを再カウントすることもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、分割候補ごとに行うように、導関数をヒストグラムに集約します。ヒストグラムを利用して、この分割候補を選択した場合に発生する目的関数の変化を評価しようとしています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最高の速度で候補を選択し、ツリーに追加します。次に、残りの順列でこの選択されたツリーを使用して統計を計算し、これらの順列で葉の値を更新し、モデルの葉の値を計算して、ループの次の反復に進みます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7s/bd/dt/7sbddtjen2ktfvjvgccack2hrrm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングが行われる1つの場所を特定するのは非常に難しいため、このスライドでは、これをいくつかのエントリポイントとして使用できます。トレーニングに使用する主なファイルがリストされています。これはgreedy_tensor_searchであり、スプリットの貪欲な選択の手順そのものを実行します。これは、train.cppで、メインのCPUトレーニングファクトリがあります。これはaprox_calcerで、葉の値を更新する機能があります。また、score_calcer-候補を評価する関数。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様に重要な部分はcatboost.pyxとcore.pyです。これはpythonラッパーコードです。多くの場合、Pythonラッパーに何らかのものを埋め込みます。私たちのpythonラッパーはCythonで書かれており、CythonはC ++で翻訳されているため、このコードは高速です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RラッパーはRパッケージフォルダーにあります。おそらく誰かがいくつかのオプションを追加または修正する必要があります。オプションについては、別のライブラリ-catboost / libs / optionsがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはアルカディアからGi​​tHubに来たので、あなたが遭遇する多くの興味深いアーティファクトがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/aw/as/wcawas_io1tv2tsyir8wv9y9ewu.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yc/w6/or/ycw6or5ltsotncff_edmb_aq_4e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リポジトリの構造から始めましょう。基本的なプリミティブがあるベクター、マップ、ファイルシステム、文字列の操作、ストリームなどのutilフォルダーがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yandexで使用される共有ライブラリが配置されているライブラリがあります。CatBoostだけでなく、多くのライブラリがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CatBoostおよびcontribフォルダーは、リンク先のサードパーティライブラリのコードです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、遭遇するC ++プリミティブについて話しましょう。 1つはスマートポインタです。 Yandexでは、std :: unique_ptr以降THolderを使用しており、std :: make_uniqueの代わりにMakeHolderを使用しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vo/uy/dw/vouydw0bfucjevtxvyttk36rkim.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自のSharedPtrがあります。さらに、SimpleSharedPtrとAtomicSharedPtrの2つの形式で存在し、カウンターのタイプが異なります。 1つのケースでは、それはアトミックです。つまり、オブジェクトは複数のフローによって所有されているかのように所有できます。したがって、スレッド間の転送に関しては安全です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のクラスIntrusivePtrを使用すると、TRefCountedクラス、つまり参照カウンターが組み込まれたクラスから継承されたオブジェクトを所有できます。これは、カウンターを使用して制御ブロックを追加で割り当てることなく、一度にそのようなオブジェクトを割り当てることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、入出力のための独自のシステムもあります。 IInputStreamとIOutputStreamは、入力と出力のインターフェイスです。それらには、ReadTo、ReadLine、ReadAllなどの便利なメソッドがあり、一般に、InputStreamから期待できるすべてのものがあります。そして、コンソールを操作するためのこれらのストリームの実装があります。Cin、Cout、Cerr、および個別にEndlです。これはstd :: endlに似ています。つまり、ストリームをフラッシュします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n4/cs/wa/n4cswarvhmfpciuulxej55cbea8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ファイル用のインターフェースの独自の実装（TInputFile、TOutputFile）もあります。これはバッファされた読み取りです。それらは、ファイルへのバッファリングされた読み取りとバッファリングされた書き込みを実装しているので、それらを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Util / system / fs.hには、NFs :: ExistsおよびNFs :: Copyメソッドがあります。突然何かをコピーしたり、ファイルが実際に存在することを確認したりする必要がある場合です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a0/vq/4z/a0vq4zt1s-biymm5n2y4bix80a0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たち自身のコンテナーがあります。彼らはかなり前にstd :: vectorを使用するようになりました。つまり、単にstd :: vector、std :: setおよびstd :: mapを継承しますが、独自のTHashMapとTHashSetもあり、それらの一部はunordered_mapおよびunordered_set。しかし、一部のタスクでは処理が高速であることが判明したため、引き続き使用しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h-/he/go/h-hegomeoamviz05exj_rt03bzg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列参照は、C ++のstd :: spanに類似しています。確かに、彼は私たちと一緒に20年ではなく、もっと早い時期に現れました。毎回一時バッファーを割り当てないように、大きなバッファーに割り当てられているかのように、積極的にそれを使用して配列への参照を転送します。導関数またはいくつかの近似をカウントするために、事前に割り当てられた大きなバッファーにメモリを割り当て、TArrayRefカウント関数のみを渡すことができると仮定します。とても便利で、よく使っています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/18/f0/km/18f0kmuuuuigc-j7zdck_yzn_qi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arcadiaは、独自のクラスセットを使用して文字列を操作します。これは、まず、TStingBuf-C ++ 17のstr :: string_viewに類似しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TStringはstd :: stingではありません。CopyOnWrite文字列なので、慎重に操作する必要があります。さらに、TUtf16Stringは同じTStringであり、その基本型のみがcharではなく、16ビットwcharです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、文字列から文字列に変換するツールがあります。これはToStringです。これは、std :: to_stringおよびFromStringとTryFromStringを組み合わせたものに類似しています。これにより、文字列を必要なタイプに変換できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2f/fo/jv/2ffojvcw39thuqmjwps2cl2kreu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自の例外構造があり、アーケードライブラリの基本的な例外はyexceptionです。これはstd ::例外を継承しています。 yexceptionで例外がスローされた場所に関する情報を追加するythrowマクロがあります。これは単なる便利なラッパーです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
std :: current_exception-CurrentExceptionMessageに類似していますが、この関数は現在の例外を文字列としてスローします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アサートと検証のためのマクロがあります-これらはY_ASSERTとY_VERIFYです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ac/ao/di/acaodinndi3xj9hr7kiju_vreew.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、独自のシリアル化が組み込まれています。これはバイナリであり、異なるリビジョン間でデータを転送するためのものではありません。むしろ、この分散は、たとえば分散学習など、同じリビジョンの2つのバイナリ間でデータを転送するために必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たまたま、CatBoostには2つのバージョンのシリアル化があります。最初のオプションは、ストリームにシリアル化するインターフェイスメソッドSaveおよびLoadを介して機能します。別のオプションは、分散トレーニングで使用されます。これは、かなり古い内部BinSaverライブラリを使用します。これは、特別なファクトリで登録する必要がある多態性オブジェクトをシリアル化するのに便利です。これは分散型トレーニングに必要ですが、時間がないため、ここで話す時間はほとんどありません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lb/oa/q9/lboaq9rvcuexqpoea75mbnbve8g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独自のアナログboost_optionalまたはstd :: optional-TMaybeもあります。 std ::バリアントの類似体-TVariant。それらを使用する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/eg/xo/fdegxof00jzhggi1slypv6s_uvi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CatBoostコード内では、例外の代わりにTCatBoostExceptionをスローするという特定の規則があります。</font><font style="vertical-align: inherit;">これは例外ですが、スローされると常にスタックトレースのみが追加されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、CB_ENSUREマクロを使用して、いくつかのことを簡単にチェックし、実行されない場合は例外をスローします。</font><font style="vertical-align: inherit;">たとえば、オプションの解析やユーザーが渡したパラメーターの解析によく使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qn/ut/jk/qnutjk-36n7wnibgpx_1xvhzsw4.jpeg"><br>
<h5><sup><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スライドからのリンク：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目</font></font></a></sub></sup></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業を開始する前に、必ずコードスタイルを確認してください。コードスタイルは2つの部分で構成されています。 1つはオールアーケードコードスタイルで、CPP_STYLE_GUIDE.mdファイルのリポジトリのルートに直接あります。また、リポジトリのルートには、私たちのチームのための別のガイドがあります：catboost_command_style_guide_extension.md。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PEP8を使用してPythonコードをフォーマットしようとしています。 Cythonコードの場合、リンターは機能せず、PEP8で問題が発生する場合があるため、常に機能するとは限りません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dp/cl/kg/dpclkg4wxn_ilcriilpquvfpihk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのアセンブリの特徴は何ですか？アルカディアアセンブリは元々、最も気密性の高いアプリケーションを収集することを目的としていました。つまり、静的リンクにより外部依存が最小限に抑えられます。これにより、再コンパイルせずに同じバージョンのLinuxを異なるバージョンのLinuxで使用できるため、非常に便利です。アセンブリの目標はya.makeファイルに記述されています。 ya.makeの例を次のスライドに示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ua/zz/eh/uazzehw8w6k-2lo2f49jyk_tv9e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
突然、ある種のライブラリ、プログラムなどを追加したい場合は、まず、隣接するya.makeファイルを調べ、次に、この例を使用します。ここでは、ya.makeの最も重要な要素をリストしました。ファイルの冒頭で、ライブラリを宣言することを宣言し、次にこのライブラリに配置するコンパイル単位をリストします。ここには、cppファイルと、たとえばCythonが自動的に起動するpyxファイル、そしてコンパイラーの両方を含めることができます。ライブラリの依存関係は、PEERDIRマクロを通じてリストされます。リポジトリのルートを基準にして、ライブラリまたは内部に別のアーティファクトがあるフォルダへのパスを書き込むだけです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このマクロに渡すいくつかのヘッダーファイルに記述されている列挙型クラスおよび列挙型のToString、FromStringメソッドを生成するには、GENERATE_ENUM_SERIALIZATIONという便利なものがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/w3/rq/gjw3rq4uayzgspxh4sj95pcgime.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、最も重要なこと、ある種のテストをコンパイルして実行する方法について説明します。リポジトリのルートには、必要なツールキットとツールをダウンロードするyaスクリプトがあり、ya makeコマンド-makeサブコマンド-を使用すると、-dスイッチを使用して-rリリースを作成し、-dキーを使用してデバッグバージョンを作成できます。その中のアーティファクトが渡され、スペースで区切られます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonを構築するために、私はすぐに役立つかもしれないフラグをここで指摘しました。システムPython、この場合はPython 3での構築について話している。突然ラップトップまたは開発マシンにCUDAツールキットがインストールされた場合は、アセンブリを高速化するために、-d have_cuda noフラグを指定することをお勧めします。 CUDAはかなり長い間、特に4コアシステムでビルドされます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/eg/sn/4k/egsn4kcvq8bepyogckxf0p1vylw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya ideは既に動作するはずです。これはclionまたはqtソリューションを生成するツールです。また、Windowsを使用したユーザーのために、msvsフォルダーにあるMicrosoft Visual Studioソリューションを用意しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
学生：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Pythonラッパーによるすべてのテストはありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stas：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-いいえ、pytestフォルダーにあるテストを個別に用意しています。これらは、CLIインターフェース、つまりアプリケーションのテストです。確かに、それらはpytestを通じて機能します。つまり、これらはサブプロセスチェック呼び出しを行い、プログラムがクラッシュせず、一部のパラメーターで正しく機能することを確認するPython関数です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
学生：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-C ++での単体テスト？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stas：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-C ++の単体テストもあります。それらは通常、utサブフォルダーのlibフォルダーにあります。そして、それらはそのように書かれています-ユニットテストまたはユニットテスト。例があります。単体テストクラスを宣言するための特別なマクロと、単体テスト関数用の個別のレジスタがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
学生：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-何も壊れていないことを確認するには、それらとそれらの両方を起動する方が良いですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stas：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- はい。唯一のことは、私たちのオープンソーステストはLinuxでのみグリーンです。したがって、たとえばMacでコンパイルした場合、5つのテストが失敗しても、心配する必要はありません。異なるプラットフォームでの出展者の実装の違いやその他のいくつかの小さな違いにより、結果は非常に異なる場合があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kr/bs/n0/krbsn0v7mas3stqnhzg19l_uwrq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例として、タスクを取り上げます。いくつか例を示したいと思います。タスクを含むファイル-open_problems.mdがあります。 open_problems.mdからの問題№4を解決しましょう。これは次のように定式化されます。ユーザーが学習率をゼロに設定した場合、TCatBoostExceptionから落ちる必要があります。オプションの検証を追加する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ut/uu/hq/utuuhqx7huwgb0cuqoolyy253vm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、ブランチを作成し、フォークのクローンを作成し、オリジンをポップし、オリジンをフォークにプッシュしてから、ブランチを作成してそこで作業を開始する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オプションの解析はどのように機能しますか？言ったように、すべてのオプションの解析が保存される重要なcatboost / libs / optionsフォルダーがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/e-/n4/bi/e-n4bi3t-z6l5fedfrlaexyeiza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TOptionラッパーにすべてのオプションが格納されているため、ユーザーがオプションをオーバーライドしたかどうかを理解できます。そうでない場合は、それ自体がデフォルト値を保持します。一般に、CatBoostはすべてのオプションを大きなJSON辞書の形式で解析し、解析中にネストされた辞書とネストされた構造に変わります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bm/zo/ch/bmzochyhm--wr1cwi9jg5snn3aq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、grepで検索したり、コードを読んだりして、TBoostingOptionsの学習率があることがわかりました。 CB_ENSUREを追加するだけのコードを書いてみましょう。学習率はstd :: numeric_limits :: epsilonより高く、ユーザーが多かれ少なかれ妥当な値を入力したことを示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1m/u1/ay/1mu1ay3e5usvwwp51l1ctaxjtqy.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、CB_ENSUREマクロを使用してコードを記述し、テストを追加したいと思います。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ut/sb/gq/utsbgqg6miybtxhekflu0w6frie.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、コマンドラインインターフェイスにテストを追加します。 pytestフォルダーにはtest.pyスクリプトがあり、そこにはすでに多くのテスト例があり、タスクのように見えるものを1つ選んでコピーし、パラメーターを変更して、渡されたパラメーターに応じて、低下するかどうかを判断できます。この場合、2行の単純なプールを取得して作成します。 （Yandexではデータセットプールと呼ばれます。これが私たちの特殊性です。）次に、学習率0.0に合格すると、バイナリが実際に低下することを確認します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xb/uk/jn/xbukjnn55irccxybobjki-b8iyw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、atatBoost / python-package / ut / mediumにあるpython-packageにテストを追加します。また、Pythonホイールパッケージをビルドするためのテストに関連する大規模なテストもあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/jh/1p/kijh1pd1b8rdeyr2scg82dbjtis.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、ya make--tおよび-Aのキーがあります。 -tはテストを実行し、-Aはタグのサイズが大きいかどうかに関係なく、すべてのテストを強制的に実行します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、美しさのために、testという名前のフィルターも使用しました。</font><font style="vertical-align: inherit;">これは、-Fオプションと以下のテスト名を使用して設定されます。</font><font style="vertical-align: inherit;">このケースでは、test.py :: test_zero_learning_rate *を使用しました。これは、Pythonパッケージテストを見ると、ほとんどすべての関数がタスクタイプフィクスチャを受け取るためです。</font><font style="vertical-align: inherit;">これは、コードによると、PythonパッケージテストはCPU学習とGPU学習の両方で同じように見え、GPUおよびCPUトレーナーテストに使用できるようにするためです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hz/qj/yf/hzqjyf9cp0mlftldhq74zot4nya.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/d_/qx/g2/d_qxg2fyla89bki38tdx5o3gc68.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、変更をコミットして、フォークしたリポジトリにプッシュします。</font><font style="vertical-align: inherit;">プールリクエストを発行します。</font><font style="vertical-align: inherit;">彼はすでに参加していますが、すべて順調です。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja458778/index.html">Satellite 6.5 Reporting Engine：何を、そしてなぜ</a></li>
<li><a href="../ja458782/index.html">ZXスペクトラムのプログラムを最新の手段でTR-DOSに適合させます。パート3</a></li>
<li><a href="../ja458784/index.html">Altium DesignerからPADS Professionalにプロジェクトとライブラリをブロードキャスト</a></li>
<li><a href="../ja458786/index.html">ビデオゲームキーパーがゲーム文化を段階的に維持</a></li>
<li><a href="../ja458788/index.html">GTMのカスタムテンプレート：例</a></li>
<li><a href="../ja458792/index.html">「焦げた」従業員：方法はありますか？</a></li>
<li><a href="../ja458794/index.html">7月18日Redmadrobotでのビジネスアナリスト会議</a></li>
<li><a href="../ja458796/index.html">重いワークロードにサイトを準備する方法：5つの実用的なヒントと便利なツール</a></li>
<li><a href="../ja458798/index.html">NutrientBot、またはフィットネストレーナーからパンを取りたい方法</a></li>
<li><a href="../ja458800/index.html">ディープラーニング。連携学習</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>