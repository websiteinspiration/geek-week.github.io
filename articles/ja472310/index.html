<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤳 🌛 👇🏾 パスワードとCookieのないサイトでの顧客の識別：標準の申請 🛎️ 😊 🈚️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="親愛なるhabrozhitel！親愛なる専門家！私はあなたの評価のために、ウェブサイトでのユーザー識別の新しい概念を提示します。私は、あなたの助けにより、このインターネットの世界を少し良くするオープンなインターネット標準になることを願っています。これはパスワードなしの認証プロトコルのドラフトバージョ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>パスワードとCookieのないサイトでの顧客の識別：標準の申請</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472310/"><img src="https://habrastorage.org/webt/zx/gv/lz/zxgvlzpzrabaux0m9y-brjkhhpi.jpeg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
親愛なるhabrozhitel！親愛なる専門家！私はあなたの評価のために、ウェブサイトでのユーザー識別の新しい概念を提示します。私は、あなたの助けにより、このインターネットの世界を少し良くするオープンなインターネット標準になることを願っています。これはパスワードなしの認証プロトコルのドラフトバージョンであり、無料の記事として設計されています。そして、その根底にあるアイデアがあなたからの肯定的な評価を受け取った場合、親愛なる読者は、reddit.comとrfc-editor.orgで公開し続けます。そして、私はその実装で主要なブラウザの開発者に興味を持っていただけることを願っています。したがって、私はあなたから建設的な批判を期待しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意：たくさんのテキスト。</font></font><br>
<br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ですから問題です。</font><font style="vertical-align: inherit;">個人データを公開したり、異なるサイト間を追跡したりせずに、サイトの訪問者を明確に識別することは可能ですか？</font><font style="vertical-align: inherit;">このような問題を解決して、ログイン/パスワードによる承認の最も原始的な形式を完全に破棄し、Cookie / localStorageを使用することは可能ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方で、サイトは、たとえば、設定、製品バスケット、広告、記事などを「復元」するために、クライアントを認識する必要があります。</font><font style="vertical-align: inherit;">一方、訪問者は、個人データを公開せず、サードパーティのサイトがそれらを追跡できないようにして、できるだけ匿名性を維持したいと考えています。</font><font style="vertical-align: inherit;">そして後者は、収集したデータを相互に交換することでこれを行うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オオカミがいっぱいになり、羊が安全であることを確認するのは大変なことのようです。</font><font style="vertical-align: inherit;">本物ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は、ある程度、私は思う-本当に。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目次</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1   </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.1       </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.2  </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/472310/&amp;usg=ALkJrhiKCQ0dOk5Gq5Gu58MWP6mpd6aJuA#">1.3 HTTP- </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.4     ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.4.2  ,     ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.5     ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.6      ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.7     </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.8     ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.9   - ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.10   - ?</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">1.11   </a><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2   </a> <br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.0    </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.1    </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.2     </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.3       </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.4    Context</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.5    Sender  Recipient</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.6      Context</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.7   </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.8    </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">2.9 - </a><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">3   </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">3.1     </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">3.2      </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">3.3  /    </a><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">4    </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">4.1  </a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">4.2   XSS</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">4.3   SRF</a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.4 SSOスキームを使用した追跡</font></font></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.5 </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">SSOの</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">主要な侵害</font></a></font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.6転送中のトークンの侵害</font></font></a><br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.7サイトのハッキングとトークンの侵害</font></font></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></a><br>
 <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワードの何が問題になっていますか？</font></font></b><div class="spoiler_text">   .   .   .   .   ,     -      ,       ? ,   ,  .    ,     .  ,        .       .   . , , – .   - :     ,  !   . ,    .<br>
    .<br>
      – .    –   .    (   )        .       ,   ,        .  ,         .<br>
    .     ,       -.     ,         ( , ,  ).  ,   . <br>
   ,  :      (   email, mobile,    ),   /         - ,     – ,   ,  .        .   <abbr title=" Single Sign-On,     SAML, OAuth, Kerberos">SSO</abbr>.<br>
  :     SSO-  ,     …                    . <b>      !</b><br>
   ,  SSO- .        .      ,        .   .<br>
:  +  = .           .  cookie .      PHPSESSIONID, JSESSIONID,   .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして何をすべきか？</font></font></b><div class="spoiler_text">     ,    :                ?<br>
<ol>
<li>  « »,  , ,  .     ,    ,    ,  «»   «-»,   . ..  <b>    </b>,      –  (     «»   ).</li>
<li> .   - (, skype –  ).      () ,    . ..  <b>       </b>.   .    «»,             .     ,    .</li>
<li>    .            . :  , ,   ,  .  <b>      </b>.   ,  , .      .</li>
<li>-       ,   .       / . ,  , ,     ,        ,    ();           .  <b>        ,   </b>.  ,  , .  ,   .</li>
<li>     -:  , , -, -,  , CMS  ,  ..  <b>          </b>.       ,        .    .   .</li>
<li>,  , web-  -     .</li>
</ol><br>
<br>
,    ,    .   ,  ,      / ,    -     ,    .  ,    (    – «- ...»)     (      ,   ;       github, –    ,  ).   –      . ,  ,     « »   ,   «  ». <b>            </b>    ( ,    , 3D-secure, eToken, OTP-Token  ..).<br>
<br>
 .   ?<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいプロトコルは何を提供しますか？</font></font></b><div class="spoiler_text">    :<br>
<ol>
<li>       -     ;        ,     .  cookie,   .         <i></i>       ,          . ..          .</li>
<li>    «<b>  </b>»   ;    .            (  popup).               (   ),       .</li>
</ol><br>
<br>
.         ?<br>
<ol>
<li>   :         , , ,    .         framework,    .</li>
<li>       ,        .     .     .     . .</li>
</ol><br>
<br>
:<br>
<ol>
<li>      ;    ;       -.  ,        -     /, /  (    ,   ,      «» ,      ).</li>
<li>       (  ,  ,   );      -   ;        « ».     ,      .</li>
</ol><br>
<br>
   ,    :   .<br>
</div></div><br>
<br>
<a name="part1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1パスワードなしの認証の概念</font></font></h1><br>
<br>
<a name="tokens_vs_passwords"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1ログインとパスワードの代わりのキーとトークン</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
子ドメインを含むドメインごとに、クライアントブラウザは一意の256ビットキーをランダムに生成します </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このキーは送信されません。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーのセッション内で一定のままです。</font><font style="vertical-align: inherit;">新しいセッションごとに新しいキーが作成されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーベース</font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特別なアルゴリズム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">256ビット</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークン</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">生成し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/175/f98/839/175f98839ab732db76d5f20cd6ce2ce9.svg" alt="$ T $" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のドメインを持つユーザーを識別するため。</font><font style="vertical-align: inherit;">識別トークン</font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/175/f98/839/175f98839ab732db76d5f20cd6ce2ce9.svg" alt="$ T $" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー（以下、単にトークンと呼ぶ）は、PHPSESSIONIDやJSESSIONIDなどのセッションCookieの代わりとして機能します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キー</font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが「</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">固定</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」する</font><font style="vertical-align: inherit;">ことができ</font><font style="vertical-align: inherit;">ます。キーを修正すると、ユーザーはさまざまなブラウザセッションで無制限の期間サイトで認証されたままで、以前の認証を返すことができます。これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「remember me」機能の類似物です</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コミットがキャンセルされると、ブラウザはこのキーを「忘れ」、再び新しいセッションごとにこのドメインのランダムキーの生成を開始します（現在のセッションから開始）。これ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーのサイトからの</font><b><font style="vertical-align: inherit;">「出口」に類似</font></b><font style="vertical-align: inherit;">しています。出力は瞬時に行われ、ページの再読み込みは必要ありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はドメインの永続キーを作成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。永続キーと固定キーにより、ユーザーは以前の認証を返すことができます。実はこれ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーは、ログインパスワード接続の代わりになります。</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーは、ドメインのブラウザーがいつ定数キーを使用するか、そしていつ-ランダムかを制御する機会を得ます。</font><font style="vertical-align: inherit;">これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ログイン/ログアウト機能の類似物です</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンセプト</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は下のスクリーンショットに示されています</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
永続ドメインキーを生成する方法は、異なるデバイス間でのユーザーアカウントのモビリティを提供します。</font><font style="vertical-align: inherit;">プロトコルは以下を定義します：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーのマスターキーに基づくドメインキーの生成</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生物学的乱数センサーに基づいてドメインキーを個別に形成する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別のデバイスのキーファイルから既存のキーをインポートする</font></font></li>
</ul><br>
<br>
<a name="token_structure"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2トークンの構造</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンは256ビットの構造で、16進数の文字列として表されます。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">84bc3da1b3e33a18e8d5e1bdd7a18d7a</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">166d77ac1b46a1ec38aa35ab7e628ab5</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">識別部</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">認証部</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンの識別部分（最上位128ビット）はログインに似ています。</font><font style="vertical-align: inherit;">このビットシーケンスにより、サーバーはユーザーを一意に識別できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンの認証部分（下位128ビット）はパスワードに似ています。</font><font style="vertical-align: inherit;">このビットシーケンスは、サーバーがトークンを検証するのに役立ちます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンの検証ルールを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下に説明します</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="http_headers"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3 HTTPプロトコルヘッダー</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントが使用するヘッダー：</font></font></b><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：&lt;Token&gt;は、</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーにトークンを送信するために使用されます</font><font style="vertical-align: inherit;">：&lt;Token1&gt;; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Changed-To</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt;Token2&gt;は、現在のトークンを変更するために使用されます。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">永久キーで認証する場合、</font></font></li>
<li>   ,</li>
<li>   .</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：&lt;Token&gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permanentは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザーが現在のランダムキーを修正するときに使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：&lt;Token&gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログアウトは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、現在のセッションを途中で終了するために使用されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーが使用するヘッダー：</font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Support：yes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、サーバーがCSI承認プロトコルをサポートすることをクライアントに示します。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：成功は</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、新しいユーザートークン（Change-Toキー）の受け入れについてブラウザに通知するために使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：abort</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、トークンの変更手順（前のトークンへのロールバック）をキャンセルします。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：登録</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、新しいユーザートークンがまだ登録中であることをブラウザに通知します。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバー側でのトークンの検証で</font><b><font style="vertical-align: inherit;">無効な</font></b><font style="vertical-align: inherit;">エラーが発生しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Saltは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、トークン（認証部分）を保護するために使用される「塩」を交換するときに、ブラウザーとサーバーの両方から送信されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細については、以下を参照し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="how_site_identify_us"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4顧客はどのようにサイトを識別しますか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトはトークンを使用して、サイトの訪問者を識別できます。</font><font style="vertical-align: inherit;">同時に、トークン生成スキームとその256ビット容量</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">により、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザードメインという</font><b><font style="vertical-align: inherit;">ペアごとに一意のトークンが保証され</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">別のドメインには別のユーザートークンが表示されます。</font><font style="vertical-align: inherit;">ターゲットサイトのコンテキストで実行された場合でも（IFRAME、IMG、LINK、SCRIPTを介して）。</font><font style="vertical-align: inherit;">さらに、特別なトークン生成アルゴリズムは、XSSおよびSRF攻撃からユーザーを保護し、ユーザーの知識なしにユーザーを追跡することを不可能にします。</font><font style="vertical-align: inherit;">しかし、同時に、</font></font><abbr title="SAML、OAuth、Kerberosなどのさまざまなプロトコルによって実装されたシングルサインオンテクノロジー"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSO</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テクノロジー</font><abbr title=" Single Sign-On,     SAML, OAuth, Kerberos"><font style="vertical-align: inherit;">は</font></abbr><font style="vertical-align: inherit;">、その許可とクロスドメイン識別により、</font><abbr title=" Single Sign-On,     SAML, OAuth, Kerberos"><font style="vertical-align: inherit;">引き続き</font></abbr><font style="vertical-align: inherit;">可能</font><font style="vertical-align: inherit;">です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークン</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></b> <font style="vertical-align: inherit;"><u><font style="vertical-align: inherit;">、リクエストごとに</font></u><b><font style="vertical-align: inherit;">CSI-Token HTTPヘッダー</font></b><u><font style="vertical-align: inherit;">で</font></u><b><font style="vertical-align: inherit;">送信されます</font></b></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 任意のドメインリソース（ページ、ドキュメント、画像、スクリプト、スタイル、フォント、ファイル、ajaxリクエストなど）に：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ki/mv/0k/kimv0kx4wvesmftizvvlgpfe088.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンは</font><b><i><font style="vertical-align: inherit;">、</font></i></b><b><font style="vertical-align: inherit;"> HTTP（S）リクエスト（</font></b><font style="vertical-align: inherit;">ページ、画像、ajaxリクエスト</font><b><font style="vertical-align: inherit;">）</font></b><b><i><font style="vertical-align: inherit;">ごとに</font></i></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再計算さ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計算を最適化するために、ブラウザーによるトークンのキャッシングが許可されますが、これは、セッションの継続中と、要求を満たすための条件が変更されていない場合に限られます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のように、トークンは、PHPSESSIONIDやJSESSIONIDなどのセッションCookieの代わりとして使用できます。唯一の違いは、サイトが以前に訪問者の識別子を生成して特定のユーザーを異なるリクエスト間で追跡した場合（結局のところ、異なるユーザーからの何千ものリクエストが同時にサイトに来る）、クライアントはこの機能を実行することです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような識別情報は、オンラインストアでの購入、適切なサイトでの宣伝、フォーラム、ソーシャルネットワーク、Wikipedia、Habréの記事への書き込みを可能にするのに十分です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、ユーザーはサイトに対して匿名のままです。しかし、それはサイトにとって匿名の「なじみの深い」ものである可能性があります。また、サーバーは、そのようなユーザーのトークンを、そのデータ（購入、設定、カルマ、パン、いいね、その他のボーナスのある個人アカウント）とともに保存できます。ただし、ビジネスプロセス（購入、発表の提出など）が完了した状態に保つことのみを目的としています。条件はサイト自体によって決定されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、アクションを実行する機会を与える前にユーザーを登録する必要のないサイトでは、プロトコルはできるだけ単純です。</font><font style="vertical-align: inherit;">しかし、それを必要とする人はもう少し難しいでしょう。</font><font style="vertical-align: inherit;">しかし、それについては以下で詳しく説明します。</font></font><br>
<br>
<a name="how_we_know_what_sci_supported"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4.2サイトがこのプロトコルをサポートしているかどうかはどうすればわかりますか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Support：yes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> http-header </font><font style="vertical-align: inherit;">を応答のResponse Headersセクションに</font><font style="vertical-align: inherit;">渡す必要があり</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ly/gs/zu/lygszusqavjk8yjnljig4pgojdm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなタイトルを見ると、ブラウザは控えめにユーザーにサイトに自分を保存できることを通知します。</font><font style="vertical-align: inherit;">たとえば、アドレスバーのキーシンボル：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ar/ff/bt/arffbt4ibbg__wlp7eyvaei_gvq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、キーをクリックすると、ドメイン</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.youtube.comの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーを作成できます</font><font style="vertical-align: inherit;">。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fq/7c/4p/fq7c4piubz15qir9xtxchg9639o.jpeg"></div><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいキーの形成は、その自動使用にはつながりません。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
永久キーは、ユーザーがアクティブにしたときにのみ使用されます。</font></font><br>
<br>
<a name="how_make_authorization"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.5クライアントはどのようにサイトを承認しますか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンはまだ特定のサイトでユーザーを承認するものではなく、認識できるだけであることを理解することが重要です。</font><font style="vertical-align: inherit;">しかし、すでに述べたように、今のところ、あなたは単に認識可能な「匿名の人物」です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトがトークンを個人的に関連付ける必要がある場合、そのようなサイトでの登録は悲しいことに避けられません。</font><font style="vertical-align: inherit;">しかし、提案されたプロトコルでは、これは少し簡単になります。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開発者が理解することは重要です：ほとんどのサイトはアンケートを必要としません。</font><font style="vertical-align: inherit;">訪問者に登録を強制することは避けてください。</font><font style="vertical-align: inherit;">最も一般的な状況では、PD訪問者を収集せずにビジネスプロセスを実行できます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
面倒な登録フォームに「有無にかかわらず」記入するのは不愉快です。</font><font style="vertical-align: inherit;">しかし、新しいプロトコルでは、別のログインとパスワードを考え出す必要がなくなりました。</font><font style="vertical-align: inherit;">[確認して保存]ボタンのみ：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/__/0i/1x/__0i1xkyu82-ne_cnghuongzrfy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、最初にサイトの永続キーを作成する必要があります。</font><font style="vertical-align: inherit;">しかし、これは数回のマウスクリックの問題です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、確かに、あなたはあなたの電話または郵送先住所を確認するように求められます。</font><font style="vertical-align: inherit;">しかし、それはすでにサイトに依存しています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
承認が成功すると、サーバーは特別なHTTPヘッダーを介して、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が新しいキーを受け入れたことをブラウザーに通知します。</font><font style="vertical-align: inherit;">詳細は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第II章を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="how_implement_reliable_identification"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.6そして、信頼できる顧客識別を実装する方法は？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より深刻な状況（プロバイダーの個人アカウント、ホスティング、銀行）では、2要素認証を実行する必要があります。また、トークンの所持の証明は、事前登録と他の方法での身元の確認を通じて行うことができます。</font><font style="vertical-align: inherit;">（はい、はい。証明書は紙に記録されていますが、トークンではありません）。</font></font><br>
<br>
<a name="user_view_concept"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.7ユーザーの目によるサイトでの承認</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザは、サイトがアドレスバーのロックアイコンを介してCSI認証をサポートしていることをユーザーに通知します。</font><font style="vertical-align: inherit;">サイトで何らかのアクションを実行する場合は、サイトに覚えているように依頼できます。</font><font style="vertical-align: inherit;">この瞬間から、サーバーは異なるセッション間でもユーザーを認識します。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/up/et/3q/upet3q-qbs8ikn4ba9t0ycn8voy.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">    ,  .       ,   ,  ,   .    ,   .    .    .   ,   , ,      .   .  .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーを修正する代わりに、ユーザーはサイトの永続的なキーを作成してそこに登録できます。</font><font style="vertical-align: inherit;">アニメーションイラスト：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/32/82/tm/3282tmri0zwdfx1jqi_zgd76zu0.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">  .   .  .      .<br>
    ,  « ».      .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ユーザーがサイトの永続キーを持ち、このキーがそこに登録されている場合、ログインプロセスは大幅に簡略化されます。 </font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u4/cm/_g/u4cm_gdewg2j7ree3gq3phuz6x4.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">  . ,    .  ,  «».   ,  .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロトコルの最大の力は、ユーザーがマスターキーに基づいてサイトのキーを作成するときに明らかになります。</font><font style="vertical-align: inherit;">この場合、</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のデバイス上のサイトでの識別</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><u><font style="vertical-align: inherit;">問題</font></u><font style="vertical-align: inherit;">は簡単に</font><u><font style="vertical-align: inherit;">解決され</font></u><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次のアニメーションはこれを示しています。</font><font style="vertical-align: inherit;">以前にマスターキーをデバイス/ブラウザー間で1回配布したことが前提となっています。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xs/ye/tx/xsyetxguxoesirmridywcy-2rts.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">     .       -.  .    (  ).<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2要素認証のサイトの場合、「認識」は次のようになります。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/du/ab/cl/duabclss3t9nkxpnjygrqfxjdha.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">  .   .       .   ;    .   .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出口はさらに簡単です。</font><font style="vertical-align: inherit;">ブラウザで[ログアウト]をクリックすると、次のようになります。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/do/2r/fe/do2rfebsd3orgwphl0ujrt_o52q.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザは、HEADメソッドを使用してサイト（任意のページ）にリクエストを送信します。このメソッドでは、CSI-Token &lt;&gt;ヘッダーを送信します。</font><font style="vertical-align: inherit;">ログアウト</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mt/gj/s1/mtgjs1i1jmtbehjyus_hfukqsq4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーはそのようなヘッダーを見て、ログアウトします。</font><font style="vertical-align: inherit;">それが固定キーである場合、サイトはユーザーに関するすべての情報を削除します（そのようなキーが表示されることはありません）。</font><font style="vertical-align: inherit;">永続的なキーだった場合は、セッションを中断するだけです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトのそれ以上のアクティビティにより、ユーザーはサイトにとって未知の匿名になります。ページのリロード、ajaxリクエストの作成、ファイルのダウンロードなど。</font><font style="vertical-align: inherit;">-ブラウザは、ランダムなキーに基づいてすでに生成されたトークンを送信します。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーマネージャーでキーを管理できます。永続キーの変更、永続キーのファイルへのエクスポート、別のデバイスのファイルからのインポートです。</font><font style="vertical-align: inherit;">タブまたはブラウザを閉じた後、「自動終了」を設定します。</font><font style="vertical-align: inherit;">固定キーの期間を設定します。</font></font></blockquote><br>
<br>
<a name="how_user_can_change_key"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.8サイトキーはどのように変更されますか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトの永続キーを置き換えることは、技術的にはランダムキーから永続キーに変更することと同じです。</font><font style="vertical-align: inherit;">これについては、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第II章で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳しく説明し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトの永続キーを変更する場合、ブラウザーはトークンの対応する変更をサイトに通知し、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">後続の各リクエストで</font></font></i><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Changed-To</font></b><font style="vertical-align: inherit;">キー</font><b><font style="vertical-align: inherit;">を</font></b><i><font style="vertical-align: inherit;">含む</font></i></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダー</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">送信</font><i><font style="vertical-align: inherit;">し</font></i><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xk/rp/75/xkrp75ivdr3kjj1_i2sh9iwfqaa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトはそのようなリクエストを正しく処理する必要があります。</font><font style="vertical-align: inherit;">また、特定のユーザートークンがデータベースに格納されている場合は、適切に置き換える必要があります。</font><font style="vertical-align: inherit;">同時に、サイトは、その側でのトークンの正常な変更についてブラウザに応答する必要があります。</font><font style="vertical-align: inherit;">彼はこれを、応答ヘッダーヘッダーでパラメーター</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：success</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して行い、適用されたトークンを示します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトには、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：abortedパラメータを使用して</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、トークンを変更する試みを拒否する権利があります（たとえば、データベースにそのようなトークンがないか、まったく保存されていない場合）</font><b><font style="vertical-align: inherit;">。</font></b></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザーがCSI-Token-Actionヘッダーを受信するまで、ブラウザーはサイトへのすべてのCSI-Token要求にChanged-Toキーを追加します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザーの「パスワード変更」に類似しています。</font></font></b><br>
<br>
<a name="how_make_cross_domain_auth"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.9クロスドメイン認証はどのように実装されていますか？</font></font></h2><br><font style="vertical-align: inherit;"></font><abbr title="SAML、OAuth、Kerberosなどのさまざまなプロトコルによって実装されたシングルサインオンテクノロジー"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSO</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
テクノロジーを使用した従来のクロスドメイン認証に</font><font style="vertical-align: inherit;">は、ユーザーにとって多くの利点があります。たくさんのサイトからたくさんのパスワードを覚える必要はありません。退屈なフォームを登録して記入する必要はありません。一部の承認サーバーは、SSOを要求したサイトにどのような権限を付与するかを尋ねます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、欠点もあります。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSOプロバイダーに依存しています。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SSOサーバーが機能しない場合、ターゲットサイトにアクセスできません。パスワードを紛失したり、アカウントが盗まれた場合、すべてのサイトから一度にアクセスできなくなります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Web開発者にとって、物事はもう少し複雑です。最初から、承認サーバーにサイトを登録し、キーを取得し、プロトコル（</font></font><abbr title="アカウントプロバイダーとサービスプロバイダー間での認証および承認データの交換のためのオープンスタンダード"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAML</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><abbr title="  ,                  "><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OAuth</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など）と適切なライブラリ、キーの有効期限が切れていないこと、許可サーバーが理由などでサイトをブロックしていないことを確認してください。これは、ユーザーアカウントを保持したり、登録フォームを作成したり、ログインしたりする必要がないという事実に対する料金です。真実は、（突然の故障の修復という形で）メンテナンスのコストを増加させます。繰り返しになりますが、サーバーが突然サイトにアクセスできなくなった場合は、残念です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この承認スキームにより、SSOは少し安全になり、すべての参加者の承認がより簡単になります。セキュリティについては、以下の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">「SSOの主要な侵害」</font></a><font style="vertical-align: inherit;">のセクションで説明します</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GoogleのSSOをサポートするサイトSをご覧ください。</font><font style="vertical-align: inherit;">Googleアカウントを持っているとします。</font><font style="vertical-align: inherit;">ログインするには、[Googleでログイン]リンクをクリックして、Google認証タブを開きます。</font><font style="vertical-align: inherit;">ブラウザには、Googleのキーがあることが表示されます。</font><font style="vertical-align: inherit;">また、GoogleがSが要求する権利を通知します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同意する場合は、キーマネージャーの[ログイン]をクリックします。</font><font style="vertical-align: inherit;">ページが再読み込みされます。</font><font style="vertical-align: inherit;">Googleはすでに有効なトークンを受け取り、あなたを認識して承認します。</font><font style="vertical-align: inherit;">また、サーバー間リクエストでは、リクエストされたフィールドに従って、アカウント情報についてサイトSに通知します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リロードされたページには、ターゲットサイトに戻る「次へ」ボタンが含まれます。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/w5/u1/aa/w5u1aahv-_os9k2d81c819d5zhg.gif"></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イラストでは</font></font></b><div class="spoiler_text">        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">www.youtube.com</a>   -   accounts.google.com.<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトSは、ユーザーに関するデータをデータベースに保存するかどうかを決定する場合があります。</font><font style="vertical-align: inherit;">この問題は、提案されている承認スキームの範囲を超えています。</font><font style="vertical-align: inherit;">さらに、SSOのキーを失うリスクを検討する場合、サイトはユーザートークンと識別子をSSO側に保持することをお勧めします。ユーザーはSの永続的なキーを作成することをお勧めします。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脆弱性：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのような承認の後、サイトS1、S2、S3、...（Google経由でログインした場所）は（Googleによって割り当てられた識別子によって）あなたを認識し、その結果、あなたの活動を追跡できるようになります。</font></font></blockquote><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護オプション：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じプロバイダーのSSOを介して登録した場合、サイト上で同時に機能しません。</font><font style="vertical-align: inherit;">可能であれば、認証が完了したらすぐに認証サーバーからログアウトします（ドメインの「自動終了」）。</font></font></blockquote><br>
<br>
<a name="how_make_sub_domain_identify"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.10クロスドメイン認証を実装するには？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これはすべて問題ありません。</font><font style="vertical-align: inherit;">作業は1つのブラウザーで実行されますが、すべて正常です。</font><font style="vertical-align: inherit;">しかし、人が2台の携帯電話を持ち、1台の作業用コンピュータとその上にいくつかのブラウザ、家庭用コンピュータ、および別のラップトップを持っている場合、現代の現実についてはどうでしょうか。</font><font style="vertical-align: inherit;">さらに、妻/子供向けの一般的なタブレット。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザ、デバイス間でドメインキーを転送する問題を何らかの方法で解決する必要があります。</font><font style="vertical-align: inherit;">また、正しい同期の問題を解決します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するためのメカニズムの1つは、既知のドメインキーからマスターキーを逆回復することなく、共通のマスターキーに基づいてさまざまなドメインキーを計算することです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのデバイスでマスターキーMを使用してドメインDの個人キーKを作成することにより、ユーザーはドメインDと同じマスターキーMと単一のアルゴリズムを使用して他のデバイスに同じキーKを作成できます。より正確には、これはユーザーではなくブラウザによって行われます。このアプローチでは、ユーザーは自分が使用するすべてのブラウザー間でマスターキーを配布するだけで十分であり、ドメインの「すべてのキーを一度に転送」します。同時に、この方法でバックアップを作成します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最大限のユーザーの利便性。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ただし</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、マスターキーが侵害された場合の</font><b><font style="vertical-align: inherit;">最大のリスク</font></b><font style="vertical-align: inherit;">。したがって、後者はそれに応じて保護する必要があります。マスターキーの紛失または侵害のリスク、およびそのようなリスクを最小限に抑える方法については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「3安全に関する推奨事項」の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">章で説明してい</font><font style="vertical-align: inherit;">ます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスターキーを1つだけ使用してすべてのドメインのすべてのキーを生成することは、必ずしも便利なオプションではありません。</font><font style="vertical-align: inherit;">まず、突然ドメインキーが危険にさらされ、変更する必要がある場合はどうすればよいですか。</font><font style="vertical-align: inherit;">次に、ドメインキーを他の人と共有する必要がある場合はどうなりますか？</font><font style="vertical-align: inherit;">たとえば、家族の間で。</font><font style="vertical-align: inherit;">それとも企業のパブリックメールアクセスアカウントですか。</font><font style="vertical-align: inherit;">では、どのようにしてキーを「手に取る」ことができますか（実際にはキーが侵害されているため）？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、生物学的乱数センサーを使用した個々のドメインキーの生成は、ブラウザーでサポートする必要があります。</font><font style="vertical-align: inherit;">しかし、再び、モビリティの問題と、ブラウザでの同期、キーのエクスポートとインポート、バックアップコピーの作成の問題に戻ります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物理的に使用可能なデバイスを介して転送する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スマートカードとUSBトークンは、キー情報を安全に保管するために非常に適しています（これらのために作成されたため）。 2要素認証は、デバイスへの直接アクセスにより、不正アクセスからキーを保護します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、スマートカードには特別なリーダー（ドライバーは言うまでもありません）が必要です。そのため、そのようなリーダーを備えたワークステーションにのみ使用が制限されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
USBトークンを使用すると、少し簡単になります。ドライバーのみが必要です。しかし、そのようなトークンを電話に貼り付けることはできません。また、携帯電話にはSDカードの形で作成されたトークンがありますが、言うまでもなく、このソリューションはモバイル性を高めます。携帯電話からカードを引き、他のカードに挿入してみてください。そして、これが不可能であるということではありません。それは便利ではないということです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、トークンが壊れたら？次に、すべてのキーはグレートクトゥルフに送られます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、いくつかの重複するデバイスを使用するこのようなスキームには誘惑があります。ただし、スマートカードが複数ある場合は、キー同期の問題を解決する必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして率直に言って、そのようなデバイスはキーロガーから保護されていません。今、ピンコードがカード/トークン自体から入力される場合。次に別のこと。しかし、私はそのような性質のものを見たことはありません。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/1g/js/gq1gjsgtxvfjjvs79syif5_u8_w.png"></div><br>
<blockquote><b>:</b>    256- ;       ;      .<br>
<b>:</b>   ;   ;  ;    ,  ,    ;     .<br>
</blockquote><br>
<h3>  -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「クラウドテクノロジー」は、可能な限り強制されています。それらはブロックチェーンとともに「バナナ技術」の代替品になっているようです。当然、重要な情報を交換するために特定のインターネットプラットフォームを使用したいという要望があります。 「オンライン」の一種のスマートカード。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして何？あなたは私たちのスキームを使って匿名でそのようなサイトにログインします。そこにパスワードで暗号化されたキーを送信します。同じキー/パスワードで別のデバイスから同じサイトに移動します。そこから鍵を取得します。編集日ごとに変更を同期します。パスワードマネージャーと同様に、これだけがオンラインです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それだけです。暗号化されていても、必要に応じて、オンラインサービスがハッキングされたりマージされたりしないことを誰も保証しません。誰がそのようなサービスを無料で実装するでしょう。それでおしまい。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、パスワードはキーを直接使用することから保護します。</font><font style="vertical-align: inherit;">しかし、あなたのパスワードはブルートフォースの「オフライン」に対して耐性がありますか？</font><font style="vertical-align: inherit;">それは別の質問です。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">長所：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資格の移動性が高い。</font><font style="vertical-align: inherit;">デバイスとブラウザの独立性。</font><font style="vertical-align: inherit;">必要なパスワードは1つだけです（パスワードは忘れていませんが、すでに優れています）。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短所：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不可解なメディアにキーを保存するよりも安全性が低くなります。</font><font style="vertical-align: inherit;">実際、キーのセキュリティは、選択に対するパスワードの強度に基づいています。</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、マスターキーを使用して他のキーを暗号化することもできます。</font><font style="vertical-align: inherit;">他のドメインキーの計算に使用されるもの。</font><font style="vertical-align: inherit;">オプションとして。</font></font><br>
<br>
<a name="part2"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2プロトコルの技術的説明</font></font></h1> <br>
<br>
<a name="perm_key_algo"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.0ドメインキー生成アルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このプロトコルでは、ドメインキーを生成するための2つの方法のみを定義しています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">乱数ジェネレータに基づく（生物学的であることが望ましい）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">256ビットのマスターキーに基づく</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後者の場合、ドメインキーは次のように計算されます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/3aa/d39/ac7/3aad39ac79fc322d157a9f4c58a793f2.svg" alt="$K=HMAC_{M_{key}} (Domain)$" data-tex="display"></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこ </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/0b7/f4d/5a6/0b7f4d5a6dcc0d36804bd9dfc0ff9403.svg" alt="$M_{key}$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-256ビットのマスターキー、ドメイン-キーが作成されるドメイン名。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HMAC</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">SHA-2</font></a><font style="vertical-align: inherit;">ハッシュ関数の256ビット実装に基づく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュ暗号アルゴリズム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメインキーの侵害または自発的な開示は、元のマスターキーを危険にさらしません。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスターキーは、ユーザーの資格情報を移動するためのメカニズムを提供します。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メモについて</font></font></b><div class="spoiler_text">            ,    ,        .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">«3   »</a>   ,        .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「マスター」に基づいて作成されたキーが侵害された場合、またはそのようなキーから計算されたトークン（サイトのハッキングの結果として）が侵害された場合、キーを変更する必要があります。</font><font style="vertical-align: inherit;">バージョンを追加して、ランダムな256ビットキーに変更したり、同じ「ウィザード」から生成したりできます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/eae/301/46b/eae30146bac887a402418464641e617e.svg" alt="$K=HMAC_{Mkey} (Domain \cup Version )$" data-tex="display"></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下、記号 </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/a47/285/a28/a47285a2828b9a69edf64fea3e240a0d.svg" alt="$\cup$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 文字列連結演算（バイト配列）に使用されます。</font></font><br>
<br>
<a name="token_algo"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1ソーストークンを計算するためのアルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーの認証トークンは、ドメインリソースのリクエストごとに計算されます。</font><font style="vertical-align: inherit;">要求トークンを計算するために、次のデータが取得されます。</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信者</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -リクエストの開始</font><i><font style="vertical-align: inherit;">者</font></i><font style="vertical-align: inherit;">のドメイン名（フェッチを実行する他の誰かのドメインからのiframeまたはスクリプトを含むページにすることができます）、</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信者</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">受信者の</font></i><font style="vertical-align: inherit;">ドメイン名（リクエストが送信される場所）、</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキスト</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -リクエスト実行コンテキスト、</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -コンテキストが空の場合、32バイト（256ビット）のランダムなシーケンス。</font><font style="vertical-align: inherit;">そうでなければ空</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このデータは連結され</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、リクエストを開始するドメインのキーKで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 256ビットのSHA-2 </font><b><font style="vertical-align: inherit;">で</font></b><font style="vertical-align: inherit;">ハッシュされ</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8d1/bd1/cbc/8d1bd1cbc81815e0121976c9bb5e4ccc.svg" alt="$K=HMAC_M (Sender \cup Recipient \cup Context \cup Protection)$" data-tex="display"></p><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストが空でない場合、有効なトークンが取得されます。</font><font style="vertical-align: inherit;">ターゲットサイトで適切に識別するためには、Sender = Recipient = Contextの条件を満たす必要があります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contextフィールドは、Protectionとともに、</font></font><abbr title="Cross-Site Scripting — « »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSS</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃</font><font style="vertical-align: inherit;">からの保護と</font><font style="vertical-align: inherit;">、ユーザー追跡からの</font><font style="vertical-align: inherit;">保護に使用</font><font style="vertical-align: inherit;">されます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
送信者/受信者/コンテキストを決定するためのルールの詳細については、以下で説明します。</font></font><br>
<br>
<a name="token_validation_algo"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2転送中のトークン保護アルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元のクライアントトークンが送信されることは非常にまれです。</font><font style="vertical-align: inherit;">セッションの作成時に未登録のトークンを転送する場合のみ。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンは</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、次の場合に</font><b><font style="vertical-align: inherit;">未登録と見なされ</font></b><font style="vertical-align: inherit;">ます。ランダムな（固定されていない）キーに基づいて作成されたもの。</font><font style="vertical-align: inherit;">Change-ToまたはPermanentキーを送信した後、サーバーによって受け入れられませんでした。</font><font style="vertical-align: inherit;">詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「サーバーでのトークンの処理」を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザとサーバーは共同で1対の乱数を生成します。</font><font style="vertical-align: inherit;">salt（Salt）。トークンの下位128ビットがハッシュされます。</font><font style="vertical-align: inherit;">どちらもプロトコルに従ってこれらの番号を交換します。</font><font style="vertical-align: inherit;">詳細については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Salt Swap Procedure Browser-Server」を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、サイトサーバーには次のトークンが表示されます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8ea/b59/cc3/8eab59cc3e5060cfec9956f984807b5f.svg" alt="$T = Hi(T_s) \cup HMAC_{salt} ( Lo(T_s) )$" data-tex="display"></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこ </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/69c/826/a5b/69c826a5bc2d0953c3db1dbcc842a035.svg" alt="$Hi(T_s)$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -高128ビット、 </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/73a/cbf/6b4/73acbf6b426b5d3dff599b4cba44ebfd.svg" alt="$Lo(T_s)$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -元のトークンの下位128ビット </font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/a47/285/a28/a47285a2828b9a69edf64fea3e240a0d.svg" alt="$\cup$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-文字列の連結。</font><font style="vertical-align: inherit;">この場合、最初のトークン</font></font><math></math><img src="https://habrastorage.org/getpro/habr/formulas/c39/070/036/c39070036bed1c9b371606081981a5fb.svg" alt="$T_s$" data-tex="inline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでにサーバーに認識されているはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理想的には、ブラウザーがサーバーを要求するたびにCSI-Saltを変更する必要があります。ただし、これはコンピューティングリソースの点でコストのかかる要件になる可能性があります。さらに、並列要求をサーバーに送信する機能を「殺す」ことができます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、計算を最適化するために、CSI-Salt値を変更せずに異なるリクエストで保持</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でき</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますが、</font><u><font style="vertical-align: inherit;">1セッションより長くすることはできません</font></u><font style="vertical-align: inherit;">。これは、時間制限（5分ごとのCSI-Saltの変更）、または要求の強度に対する反応（100要求ごとのCSI-Saltの変更）、または一連の各要求の後（一時停止時、クライアント/サーバー）、または混合バージョンにすることができます。ここでの決定はブラウザ開発者に任されています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CSI-Saltをあまり長く変更しないでおくと、送信されたトークンの保護が弱まり、攻撃者はトークンをインターセプトするときに、正当なユーザーがログアウトを完了し、被害者に代わって不正なリクエストを実行するまでトークンを使用できます。</font></font><br>
<br>
<a name="salt_exchange_algo"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3ブラウザとサーバー間の塩交換手順</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.3.1ランダムまたは未登録の</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーキーに</font><font style="vertical-align: inherit;">基づくトークン</font><font style="vertical-align: inherit;">。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザ</font></font></b></th>
<th><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバ</font></font></b></th>
</tr>
<tr>
<td colspan="2"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のリクエスト（ユーザーセッションの初期化）</font></font></b></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザはトークンをそのまま送信します。</font></font><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストにCSI-Saltがありません。</font></font></b><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーは最初にそのようなトークンを見つけます。 </font></font><br>
 <div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ところで</font></font></b><div class="spoiler_text">       .     .    <u>     -   </u>.      .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 そのまま認識します（保護されていないと見なします）。</font><font style="vertical-align: inherit;">このトークンをセッション識別子として使用します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 その</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソルト</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を生成し</font><font style="vertical-align: inherit;">ます。</font></font><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Saltヘッダーの応答でそれを返します。</font></font></b><br>
 </td>
</tr>
<tr>
<td colspan="2"><b> </b></td>
</tr>
<tr>
<td>  <i><sub>salt</sub></i>.<br>
  <sup>[3]</sup>     .<br>
   ,     .<br>
 <b> CSI-Salt.</b><br>
 </td>
<td>    <b> CSI-Salt </b>.<br>
           .<br>
<br>
   ,        .<br>
<br>
      <b>CSI-Token-Action: invalid</b>.      :   .<br>
 </td>
</tr>
<tr>
<td colspan="2"><b> </b></td>
</tr>
<tr>
<td>  ,     .<br>
 <b>   CSI-Salt.</b><br>
 </td>
<td>      .<br>
<br>
   ,        .<br>
<br>
      <b>CSI-Token-Action: invalid</b>.      :   .<br>
 </td>
</tr>
<tr>
<td colspan="2"><b> <sup>[2]</sup>  </b></td>
</tr>
<tr>
<td>   <i><sub>salt</sub></i>. <br>
      .<br>
  ,      .<br>
 <b> CSI-Salt.</b><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーはリクエストを受信し</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、新しいCSI-Saltクライアント</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">取得します</font></b><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 サーバーはブラウザソルトを独自のものに接続し、それを使用してトークンを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンの検証が成功すると、ユーザーの権利に応じたコンテンツがユーザーに提供されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検証が失敗した場合、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action：invalid</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダーをクライアントに返します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コンテンツを返すか、空の応答を返します。サーバーによって異なります。</font></font><br>
 </td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.3.2 </font><font style="vertical-align: inherit;">サーバー</font><font style="vertical-align: inherit;">によって登録され</font><font style="vertical-align: inherit;">たキーに</font><font style="vertical-align: inherit;">基づくトークン</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザ</font></font></b></th>
<th><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバ</font></font></b></th>
</tr>
<tr>
<td colspan="2"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のリクエスト（ユーザーセッションの初期化）</font></font></b></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">塩を生成</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">塩</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Saltを送信します。</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 保護された形式でトークンを転送します。</font></font><br>
 </td>
<td>    <b> CSI-Salt </b>.<br>
   .<br>
        (    128-    ).<br>
 ..   ,     ,  <b>        </b>.<br>
<br>
      <b>CSI-Token-Action: invalid</b>.      :   .<br>
<br>
   ,        .<br>
 <br>
    <i>S<sub>salt</sub></i>. <br>
 <b>      CSI-Salt</b>.<br>
 </td>
</tr>
<tr>
<td colspan="2"><b> </b></td>
</tr>
<tr>
<td>      .<br>
   ,     .<br>
 <b>   CSI-Salt</b>.<br>
 </td>
<td>      .<br>
<br>
   ,        .<br>
<br>
      <b>CSI-Token-Action: invalid</b>.      :   .<br>
 </td>
</tr>
<tr>
<td colspan="2"><b> <sup>[2]</sup>  </b></td>
</tr>
<tr>
<td>   <i><sub>salt</sub></i>. <br>
       .<br>
   ,      .<br>
 <b> CSI-Salt</b>.<br>
 </td>
<td>    <b>  CSI-Salt </b>.<br>
           .<br>
<br>
   ,        .<br>
<br>
      <b>CSI-Token-Action: invalid</b>.      :   .<br>
 </td>
</tr>
</tbody></table></div><hr><sup>[1]   ,  :     ;        Change-To  Permanent  CSI-Token-Action: success.<br>
[2] ,     CSI-Salt   .      ,  ,    .   – <b>     CSI-Salt    </b>.<br>
[3]     16-  128- .     ,   : <i><sub>salt</sub></i> || <i>S<sub>salt</sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ブラウザにサーバーソルトがない場合は、トークンをそのソルトでハッシュして、ヘッダーに渡します。</font><font style="vertical-align: inherit;">サーバーにクライアントソルトがない場合は、トークンが安全に送信されないことを考慮する必要があります。</font></font></sup><br>
<br>
<a name="context_rules"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4 Contextフィールドの形成に関する規則</font></font></h2><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルールに関する免責事項</font></font></b><div class="spoiler_text">     .   ,  -  .            .<br>
      ,   .      ,     .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、呼び出します</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのページ我々は（ブラウザのアドレスバーに表示される）ロードされているドメイン。</font><font style="vertical-align: inherit;">残りのドメインは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれ</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらが特定の子ドメインであっても。</font><font style="vertical-align: inherit;">外部ドメインからダウンロードされた</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リソースを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼び</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ドメインからダウンロードされ</font><font style="vertical-align: inherit;">たリソースを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内部</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼び</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">リソースには、スクリプト、画像、ajaxリクエスト、その他のファイルを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトが外部ドメインからダウンロードされた場合、スクリプトは外部と見なされます。作成された&lt;script&gt;タグに配置され、外部スクリプトによって作成されたスクリプトも、外部と見なされます。変更された&lt;script&gt;タグにあるスクリプトは、外部スクリプトによって変更された場合、または内容が変更されたときに外部スクリプトが呼び出しチェーンに存在した場合、外部として宣言されます。同時に、指定された&lt;script&gt;が元々ページ上にあったか、内部スクリプトによって作成された場合でも同様です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LINK、SCRIPT、IMG、IFAMEタグなどに名前を付けます。DOMパーサーの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リソースタグ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がリソースを検出するとすぐに、ブラウザはリソースを読み込む必要があり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FORM、A、METAなどのタグに名前を付けます。これらのタグは、特定の条件（送信、クリック、タイムアウト）- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タグの開始</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグ</font><font style="vertical-align: inherit;">がサーバーによって最初に発行されたときにページに元々存在していた場合</font><font style="vertical-align: inherit;">は、タグを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">static</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼び</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">スクリプトの実行中に作成され</font><font style="vertical-align: inherit;">たタグを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダイナミック</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼びます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグ自体が変更されただけでなく、このフォームに関連付けられたすべてのINPUTフィールドの値も変更された場合でも、FORMタグは動的に宣言されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動的タグ</font><font style="vertical-align: inherit;">を作成したスクリプトがドメインに属し、このタグを生成した命令の呼び出しチェーンに外部スクリプトに属する関数がない場合は</font><font style="vertical-align: inherit;">、動的タグを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出します。それ以外の場合は、そのようなダイナミックタグは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不適切</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と見なされ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タグの開始により、ページの読み込みがトリガーされます。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開始タグは、ユーザーが直接アクティブ化するか、スクリプトによってアクティブ化することができます。これには、クリックコマンド（リンクの場合）を実行して送信（フォームの場合）するか、スクリプトによって、対応するonclick / onsubmitイベントを生成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、開始タグはブラウザでアクティブ化できます。</font><font style="vertical-align: inherit;">そのようなタグの例は、パラメーターhttp-equiv = "refresh" content = "0"を持つMETAです。</font></font><br>
<br>
<sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表P.さまざまなページを開いた状態でのコンテキスト値</font></font></sup><br>
<a name="context_table_P"></a><div class="scrollable-table"><table>
<tbody><tr>
<th colspan="3" rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">開封方法</font></font></th>
<th colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰がページの読み込みをトリガーしましたか？</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分の。</font><font style="vertical-align: inherit;">Js</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内線 </font><font style="vertical-align: inherit;">Js</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザ</font></font></th>
</tr>
<tr>
<td rowspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タグ</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1。</font><font style="vertical-align: inherit;">リファラー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2。</font><font style="vertical-align: inherit;">バリアント</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P3。</font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4。</font><font style="vertical-align: inherit;">継承する</font></font></td>
</tr>
<tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5。</font><font style="vertical-align: inherit;">継承する</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6。</font><font style="vertical-align: inherit;">バリアント</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P7 </font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8。</font><font style="vertical-align: inherit;">継承する</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不適切</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P9 </font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA。</font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PB。</font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PC。</font><font style="vertical-align: inherit;">空の</font></font></td>
</tr>
<tr>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD。</font><font style="vertical-align: inherit;">ドメイン</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE。</font><font style="vertical-align: inherit;">バリアント</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pf。</font><font style="vertical-align: inherit;">空の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG。</font><font style="vertical-align: inherit;">バリアント</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup></td>
</tr>
</tbody></table></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ表、画像のみ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/cq/l-/6e/cql-6eob6gouvsqsrdy5ltykhfg.gif" align="right"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リソースタグがスクリプト（たとえば、IMGのSRC属性）によって変更され、リソースがブラウザーによって自動的に読み込まれた場合、コンテンツ/リソースはパーサーによってトリガーされたと考えられます。読み込み方法はタグですが、このタグのステータスは「動的」になります。</font></font><br>
<br>
<sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表R. </font><b><font style="vertical-align: inherit;">コンテンツ/リソース</font></b><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">ロードする</font></b><font style="vertical-align: inherit;">ためのさまざまな条件下でのコンテキスト値</font></font><b><font style="vertical-align: inherit;"></font></b></sup><br>
<a name="context_table_R"></a><div class="scrollable-table"><table>
<tbody><tr>
<th colspan="3" rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロード方法</font></font></th>
<th colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰がコンテンツをダウンロードしたのですか？</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMパーサー</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分の。</font><font style="vertical-align: inherit;">Js</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内線 </font><font style="vertical-align: inherit;">Js</font></font></th>
</tr>
<tr>
<td rowspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タグ</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1。</font><font style="vertical-align: inherit;">ページ</font></font></td>
<td></td>
<td></td>
</tr>
<tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">動的</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分の</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4。</font><font style="vertical-align: inherit;">ページ</font></font></td>
<td></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不適切</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R7。</font><font style="vertical-align: inherit;">空の</font></font></td>
<td></td>
<td></td>
</tr>
<tr>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RA。</font><font style="vertical-align: inherit;">リファラー</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RB。</font><font style="vertical-align: inherit;">ページ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC </font><font style="vertical-align: inherit;">リファラー</font></font></td>
</tr>
</tbody></table></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ表、画像のみ</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/dl/zi/mn/dlzimnup-7etmrsysxzlxjw1zd8.gif" align="right"></div></div><br>
<hr><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]開始タグ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[2]リソースタグ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[3]独自のページを継承、外部ドメインのページを開くときに空</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[4]サーバーをそのページにリダイレクトするときに継承、外部ドメインにリダイレクトするとき、または外部ソースからページを開くときに空（を参照） 。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></sup><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">略語</font></font></b><div class="spoiler_text"><b>Referrer</b> –     Referrer.<br>
<b>Page</b> –   (Tab)      .<br>
<b>Empty</b> –  .<br>
<b>Domain</b> –  Context    <br>
<b>Inherit</b> –  Context    <br>
<b>Variant</b> –  Context    «-»  <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
P1..PF、R1..RCの形式のマークは、特定の状況を分析するときに、テーブル内の対応するセルを参照するために使用されます。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の表で</font><font style="vertical-align: inherit;">強調表示されている</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リファラー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメイン</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">注目</font><font style="vertical-align: inherit;">してください。</font><font style="vertical-align: inherit;">自分が直接アドレスで、または別のサイトからのリンクを介して自分のサイトを開いて、その後、自分の主導でページを再読み込みした場合にのみ、サイトで承認を受けることができます。</font></font></blockquote><br>
<br>
<a name="sender_recipient_rules"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5送信者および受信者フィールドを定義するためのルール</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
送信者は、リクエストの送信元であるページ/スクリプト/スタイルのドメインです。</font><font style="vertical-align: inherit;">ページはスタイル、写真、スクリプトを要求します。</font><font style="vertical-align: inherit;">スクリプトはajax経由でコンテンツを要求します。</font><font style="vertical-align: inherit;">スタイルは他のスタイルをロードできます。</font><font style="vertical-align: inherit;">これらは要求の開始者です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
受信者は、リクエストが実際に送信されるドメインです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残っている質問がないように、具体的な例を考えてみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.netサイトがあるとします。</font><font style="vertical-align: inherit;">サイトのメインページは次のとおりです。</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スタイルsite.net/css/common.css</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">common.cssスタイルはfonts.google.com/fonts/Roboto.cssスタイルをインポートします </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roboto.cssスタイルはフォントfonts.google.com/fonts/Roboto.ttfをインポートします</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.site.net/picture1.jpgにつながる画像</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/frameから読み込まれたフレーム</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adm.site.net/admin.jsからのスクリプト</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フレームに（adriver.ruを使用して）接続します。</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/style.cssからのスタイル</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.adriver.ru/img/01.pngの画像</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/libs.jsからのスクリプト</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.adriver.ru/v1/ad.jsからのスクリプト</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DOMパーサーでリソースを読み込むときの送信者/受信者の値</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロード可能なリソース</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信者の値</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信者の価値</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net/css/common.css</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonts.google.com/fonts/Roboto.css</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonts.google.com</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonts.google.com/fonts/Roboto.ttf</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonts.google.com</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fonts.google.com</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.site.net/picture1.jpg</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.site.net</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/frame</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adm.site.net/admin.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adm.site.net</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/style.css</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.adriver.ru/img/01.png</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">img.adriver.ru</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/libs.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.adriver.ru/v1/ad.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.adriver.ru</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ajaxリクエスト中にスクリプトでコンテンツをロードするときのSender / Recipientの値を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトでコンテンツをロードするときの送信者/受信者の値</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行可能なスクリプト</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストはどこに行きますか？</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信者</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受取人</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adm.site.net/admin.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net/api/</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adm.site.net</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site.net</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/libs.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru/api/</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adriver.ru</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.adriver.ru/v1/ad.js</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.2gis.ru / ...</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.adriver.ru</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api.2gis.ru</font></font></td>
</tr>
</tbody></table></div><br>
<br>
<a name="context_tables_comments"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6コンテキスト定義テーブルの値の詳細</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページ（ブラウザーのタブ）を開くためのオプションと、取得するコンテキスト値について詳しく説明します。</font></font><br>
<br>
<a name="P1"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のページのユーザーがリンクをクリックしたか、フォームの送信ボタンをクリックした。リンク/フォームの標準イベントブラウザーハンドラーは、ユーザーをこのページにリダイレクトしました。通常の状況。ドメインまたは異なるドメインのページ間の安全な移行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のgoogle.comドメインからsite.netに切り替えると、コンテキストは以前のドメイン（google.com）と同じになります。また、新しいsite.netドメインのユーザーは承認されません（ユーザーが承認されているこのサイトの隣接するタブが開いている場合でも）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じサイトへのリンクへのユーザーの繰り返しの独立した移行（スクリプトの支援なしで）は、再び状況</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">つながりますが</font><font style="vertical-align: inherit;">、コンテキストはすでにドメインsite.netに等しいため、ルールContext = Referrer。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを防ぐために作られています</font></font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃。</font></font><br>
<br>
<a name="P5"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のページのユーザーが、前のページのドメインからダウンロードされたスクリプトによって作成または変更されたリンクをクリックした。</font><font style="vertical-align: inherit;">または、前のページのユーザーが、スクリプトによって作成または変更されたフォームの送信ボタンをクリックした（FORMタグとそのINPUTフィールドを変更した）。</font><font style="vertical-align: inherit;">リンク/フォームの標準イベントブラウザーハンドラーは、ユーザーをこのページにリダイレクトしました。</font></font><br>
<br>
<a name="P9"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じですが、</font><font style="vertical-align: inherit;">スクリプトのみが外部であるか、コールチェーンに外部スクリプトからの関数があります（サードパーティのスクリプトによるサイトスクリプトのスクリプト関数の編集からの保護）。</font></font><br>
<br>
<a name="PD"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが直接アドレスでページを開いた。</font><font style="vertical-align: inherit;">安全なオープニング。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーは、アドレスバーにURLを入力してページを開く必要があります。</font><font style="vertical-align: inherit;">または、ブラウザのブックマークからサイトを開きます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のプログラムのデスクトップショートカットからリンクを開く、OSがブラウザーにコマンドを送信してリンクを開くその他の状況は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PGの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケースと見なされます（リンクを開くの</font><font style="vertical-align: inherit;">はブラウザーによって開始されます）。ユーザーがF5キーを押してページを再読み込みした場合でも、これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケースと見なす必要があります</font><font style="vertical-align: inherit;">。ユーザーがアドレスバーにアクセスしてEnterキーを押した場合にのみ、ブラウザーは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と見なし</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、CSRF攻撃を他のプログラムから保護するために行われます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のプログラムからのリンクをたどると、無効なトークンと空のコンテキストを使用して、攻撃されたサイトにユーザーが誘導されます。ユーザーがF5キーを押しても保存されます（ページを更新）。ユーザーがサイトのページへのリンクを開くまでログインできません（状況</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、別のプログラムからの攻撃者が、権限のあるユーザーにコマンドを実行しているsite.netサイトページへのリンクをスリップすることを決定した場合、攻撃者は簡単にそうすることができません。ユーザーにこのページの別のリンクをクリックするように強制する必要があり、次にユーザーにそこで認証を強制する必要があります。それから初めて...ユーザーはおそらくsite.netの別のページにいるでしょう。</font></font><br>
<br>
<a name="P2"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元のページに配置されたリンクまたはフォームの前のページで、前のページのネイティブスクリプトがクリック/送信イベントを生成しました。</font><font style="vertical-align: inherit;">外部スクリプトに属する関数がコールチェーンにありませんでした。</font><font style="vertical-align: inherit;">ブラウザはユーザーをこのページにリダイレクトしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいページが同じドメインに属している場合、コンテキストは前のページから継承されます。</font><font style="vertical-align: inherit;">新しいページが外部ドメインに属している場合、コンテキストは空白になります。</font></font><br>
<br>
<a name="P6"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じですが、</font><font style="vertical-align: inherit;">リンク/フォームのみが独自のスクリプトによって作成/変更されました。</font></font><br>
<br>
<a name="PA"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じですが、</font><font style="vertical-align: inherit;">リンク/フォームのみが外部スクリプトによって作成/変更されました。</font></font><br>
<br>
<a name="PE"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のページのスクリプトにより、コマンドwindow.location.hrefまたはwindow.open（...）でこのページが開かれました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.netページスクリプトが同じドメインのページにユーザーをリダイレクトする場合、Contextフィールドは生成ページから継承されます。この場合、Context = site.netです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ya.ruページが開いていて、スクリプトによってmaps.ya.ruに転送された場合、新しいページのコンテキストは空になります。ユーザーのその後のアクションでは、コンテキストはほとんど常に空のままであり、サイトでのユーザーの認証が複雑になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロトコルは、あるサイトを別のサイトで開くことは安全でない操作であることを意味します。これにより、これらのサイトによる不正な追跡やCSRF攻撃からユーザーを保護します。</font></font><br>
<br>
<a name="P3"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同様に</font><font style="vertical-align: inherit;">、クリック/送信イベントのみが外部スクリプトによってトリガーされました。</font><font style="vertical-align: inherit;">コンテキストが空になり（代わりにランダムなバイトシーケンスが送信されます）、サードパーティサイトがサイト（バナーネットワーク）を追跡するのを防ぎます。</font></font><br>
<br>
<a name="P7"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同様に</font><font style="vertical-align: inherit;">、リンク/フォームのみが外部スクリプトによって作成/変更されました。</font></font><br>
<br>
<a name="PB"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同様に</font><font style="vertical-align: inherit;">、リンク/フォームのみが外部スクリプトによって作成/変更されました。</font></font><br>
<br>
<a name="PF"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同様に</font><font style="vertical-align: inherit;">、挑発的なスクリプトのみが外部のものでした。</font></font><br>
<br>
<a name="P4"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt;META&gt;タグの処理の結果として、ブラウザーがページをリロードしました。</font><font style="vertical-align: inherit;">タグはもともとページにありました。</font><font style="vertical-align: inherit;">法的リダイレクト。</font><font style="vertical-align: inherit;">コンテキストは元のページから保持されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の場合と同様に</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="P8"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt;META&gt;タグを処理した結果、ブラウザーがページを再ロードしました。</font><font style="vertical-align: inherit;">ただし、タグは独自のスクリプトによって作成/変更されました。</font><font style="vertical-align: inherit;">これは有効ですが、コンテキストは元のページから保持されます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の場合と同様に</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この方法でユーザーの法的トークンを誘導することはできません。</font></font><br>
<br>
<a name="PC"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同様</font><font style="vertical-align: inherit;">、外部スクリプトのみ。</font><font style="vertical-align: inherit;">開かれたサイトは、コンテキストとして乱数を受け取ります。</font></font><br>
<br>
<a name="PG"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザはOSからのコマンドでリンクを開きます。</font><font style="vertical-align: inherit;">別のプログラムからのリンクをクリックして、デスクトップにショートカットを開いた可能性があります。</font><font style="vertical-align: inherit;">これは、知らないうちに別のプログラムからのコマンドである可能性があります。</font><font style="vertical-align: inherit;">この場合、ソースは信頼されておらず、ユーザーが操作している間はContextフィールドは空のままです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、CSRF攻撃を他のプログラムから保護するために行われます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザ自体が以前に保存されたタブを開く場合、ページのコンテキストは、ブラウザを閉じるときにこのページの値に等しく設定されます。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、このカテゴリには、ヘッダーHTTPヘッダーの処理の結果として、ブラウザーがサーバーによって（自身のドメインまたは他の誰かの）別のページにリダイレクトされるすべての状況が含まれます。</font><font style="vertical-align: inherit;">リダイレクトが自分のページに移動する場合、Context値が継承されます。</font><font style="vertical-align: inherit;">リダイレクトが他の誰かにリダイレクトされた場合-リセットされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、Webサーバーの追跡攻撃から保護するために行われます。</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ちなみに、このようなルールは、クロスドメイン認証の現在の実装で問題を引き起こす可能性があります。</font><font style="vertical-align: inherit;">承認後、SSOサーバーがユーザーをターゲットサイトにリダイレクトすると、ターゲットサイトは匿名になります。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーがターゲットサイトの元の承認を「失う」ことを防ぐには、サーバー要求間で認証情報を送信する必要があります。</font><font style="vertical-align: inherit;">アルゴリズムは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーはターゲットサイトの永続キーを作成してアクティブ化します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切なリンクをクリックして、ターゲットサイトからSSOサーバー自体に移動します。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSOサーバーから既存の永続キーをアクティブ化します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Changed-Toキーを受け取ったSSOサーバーは、サーバー間要求をターゲットサイトに送信します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが承認ページの[続行]ボタンをクリックすると、ターゲットサイトに戻ります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルール</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実現するために</font><font style="vertical-align: inherit;">、ターゲットサイトは、ユーザーに再度リンクボタンをクリックするようにユーザーに提供します（たとえば、承認された参加者のスタートページに移動します）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーがリンクボタンをクリックすると、ページがリロードされ、ユーザーはターゲットサイトで既に承認されています。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アルゴリズムの説明は、実際にはその実装よりも複雑に見えます。</font><font style="vertical-align: inherit;">UI実装は次のようになります。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/w5/u1/aa/w5u1aahv-_os9k2d81c819d5zhg.gif"></div><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターゲットサイトに再度アクセスする場合、ユーザーからのSSO承認は不要です。</font><font style="vertical-align: inherit;">永久キーをアクティブ化するのに十分です。</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ページにコンテンツをロードするためのオプションと、要求に応じて取得されるコンテキスト値について詳しく見ていきましょう。</font></font><br>
<br>
<a name="R1"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リソースは、ページの解析の結果としてブラウザーによってロードされます（ブラウザーはリソースタグを満たしました）。</font><font style="vertical-align: inherit;">リソースのリクエストを生成するときのコンテキスト値は、リソースタグを含むコンテキストページから取得されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、site.netにimg.disk.comからの画像が読み込まれるadriver.ruフレームがある場合、img.disk.comへのHTTPリクエストを生成すると、ブラウザはページのコンテキストとして計算された値を取得しますsite.net。</font></font><br>
<br>
<a name="R4"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じ</font><font style="vertical-align: inherit;">です。リソースタグのみが独自のスクリプトによって作成/変更された結果、ブラウザのDOMパーサーが機能しました。たとえば、site.net / index.htmlページでは、独自のsite.net/require.jsスクリプトが別のカスタムスクリプト（&lt;script src = ...&gt;タグ）site.net/min.jsを挿入し、ブラウザにファイルダウンロードリクエストを生成させましたmain.js。このリクエストのContextフィールドは、site.netページに対して計算された値に設定されます。</font></font><br>
<br>
<a name="R7"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同じ</font><font style="vertical-align: inherit;">です。ただし、リソースタグは外部スクリプトによって作成/変更されたため、リソースがリクエストされると、ブラウザは空のコンテキストとランダムな256ビットシーケンスに基づいてトークンを生成します。その結果、攻撃されたsite.netドメインのページに埋め込まれた外部の攻撃者スクリプトevil.com/drop.jsは、被害者の代わりにターゲットsite.netへのリクエストを実行しようとして失敗します。サーバーはランダムなトークンを含むリクエストを受信し、リクエストの送信者を識別することができません。</font></font><br>
<br>
<a name="RA"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RA-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のコンテンツを分析した結果、パーサーがコンテンツをダウンロードします。たとえば、site.net / css / common.cssスタイルシートは、site.net / index.htmlページ用にダウンロードされ、fonts.google.com / fonts / Roboto.cssスタイルシートをインポートします。これにより、ブラウザはfonts.googleをリクエストします。参照者に代わって.com = site.net/css/common.css。この場合のコンテキスト値はリファラーに等しくなります。次に、Roboto.cssスタイルファイルはRoboto.ttfフォントをインポートします。これにより、ブラウザはReferrer = fonts.google.com/fonts/Roboto.cssに代わってfonts.google.com/fonts/Roboto.ttfをリクエストします。この場合、コンテキスト値はリファラーに等しくなりますが、異なります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仮に、Roboto.cssファイル（外部リソース）がフォント/スタイルをインポートせず、次の命令でCSRF攻撃を実行しようとしているとします。</font></font><pre><code class="css">@import "https://site.net/api/payment?victim_params"</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">許可されたユーザーに代わってsite.netで要求を満たすことを期待しています。</font><font style="vertical-align: inherit;">しかし、攻撃者にとっての問題は、site.netがユーザーからトークンを受け取ることを期待していることです。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/18c/ba0/6d3/18cba06d3ab48142219dbf3e3f4e2330.svg" alt="$T_s^1 = HMAC_k(site.net \cup site.net \cup site.net)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、そのようなCSRF要求と同様に、ブラウザーはトークンを作成します。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/466/929/b86/466929b86ade0b848996042a3ac12f25.svg" alt="$T_s^2 = HMAC_k(fonts.google.com\cup site.net \cup fonts.google.com)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、サイトへのリクエストは、これらの操作を実行するためのアクセス権を持たない匿名サイトに代わって送信されます。</font></font><br>
<br>
<a name="RB"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RB-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツはサイト独自のスクリプトによってアップロードされます。</font><font style="vertical-align: inherit;">この場合、コンテキストを使用してリクエストトークンが計算されます。これは、スクリプトを含むページと同じです。</font><font style="vertical-align: inherit;">site.netコンテキストページのsite.net/1.jsスクリプトの場合、これはページ自体のコンテキストと同じになります。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページ自体のコンテキストは、常にページのドメイン名と同じであるとは限らず、ページが最初に開かれた方法に依存することに注意してください。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者evil.comのサイトが、攻撃されたサイトsite.netのページを開いたとします。ここで、site.net / util.jsスクリプトは、ページのURLを通じて渡されたパラメーターを使用してリクエストを実行します。</font><font style="vertical-align: inherit;">攻撃者は、URLを介して「彼のパラメータ」をすり抜けることにより、自分のsite.net/util.jsスクリプトがajaxリクエストを実行して、被害者に代わって重要なアクションを実行することを強制します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー自身が直接リンクを介してevil.comにアクセスしたとします。</font><font style="vertical-align: inherit;">その場合、evil.comのコンテキストはevil.comになります。</font><font style="vertical-align: inherit;">さらにevil.comスクリプトが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">site.net/api/payment?victim_paramsを</font></a><font style="vertical-align: inherit;">開き</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃を実行することを期待していますが、site.netのContextフィールドはすでに空です（PE / PFの場合）。</font><font style="vertical-align: inherit;">site.net/utils.jsスクリプトがajaxリクエストを実行すると、ブラウザーは強制的にsite.netページからコンテキストを取得します。</font><font style="vertical-align: inherit;">そしてそれは私たちにとって空です。</font><font style="vertical-align: inherit;">しかし、site.netはこのトークンを使用してajaxリクエストを受け取ります。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/866/a41/990/866a41990a710d17dbe34a04ecb2e28c.svg" alt="$T = HMAC_{site.ru-key}(site.net \cup site.net \cup random)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、承認されたユーザーの場合は次のことが期待されます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/025/1b3/fad/0251b3fadaf0e4f1535b6aa8a67df332.svg" alt="$T_s = HMAC_{site.ru-key}(site.net \cup site.net \cup site.net)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.netには不明なトークンが表示され、ユーザーを識別できなくなります。</font><font style="vertical-align: inherit;">保護は機能しました。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ちなみに、このようなスキームのため、ポップアップによるクロスドメイン認証の実行は現実的ではありません。 </font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコルでSSOを実装するには、認証サーバーページの新しいタブを開く必要があります。</font><font style="vertical-align: inherit;">同時に、ユーザーはそのようなタブを開く必要があります。</font><font style="vertical-align: inherit;">最良のオプションは、ユーザーがターゲットサイトから適切なリンクを開くことです。</font></font><br>
<br>
<a name="RC"></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツは外部のWebサイトスクリプトで読み込まれます。この場合、コンテキストはリクエストトークンの計算に使用されます。これは、リクエストリファラーフィールドと同じです。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">RA</font></a><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">RB</font></a><font style="vertical-align: inherit;">、および</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">RC</font></a><font style="vertical-align: inherit;">はCSRF攻撃から保護</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
するという事実にもかかわらず、</font><font style="vertical-align: inherit;">それでも一定のトークンが生成されます。また、</font><b><font style="vertical-align: inherit;">これにより、クロスドメイン認証とクロスドメイン</font></b><font style="vertical-align: inherit;">ユーザー</font><b><font style="vertical-align: inherit;">認証を実装できます</font></b><font style="vertical-align: inherit;">（異なるサーバーへの複数のリクエストがこのユーザーからのものであると判断する必要がある場合）。関連するドメインのグループに対して同等の権限を彼に提供するために実装できるもの。</font><b><font style="vertical-align: inherit;">サイトページが自動的に開く</font></b><font style="vertical-align: inherit;"> 
場合</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別のサイトからは、自分でこのサイトをリロードしてもログインできません。 Sourceは空の値から継承するためです。ブラウザはこの事実をユーザーに通知する必要があります（ソース=ランダム）：</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1h/pr/ew/1hprewdwumpuwpzmzkqfmbds104.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、他のポップアップウィンドウを強制的に開くサイト（自分自身またはその外部スクリプト）から保護するために行われ、開いたサイトでは、再起動するか、画面全体に偽の「閉じる」ボタンを作成して同じサイトにつながります。それら。これは、有効なトークンを取得することを期待して、あなたを追跡する試みを防ぎます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトが外部スクリプトを使用してアクションを模倣</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しようとしたり、外部スクリプトが直接または間接的に開始タグを作成してそれを取得しようとしたりすると、ソースが空になり、トークンハッシュの計算時にランダムバイトが追加されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DOMの攻撃されたページで&lt;script&gt;タグを作成または変更するトリックは役に立ちません。 [ソース]フィールドは空白のままです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、同じ条件下で、内部スクリプトはSourceが以前の値と等しいクエリを導きます。元のページにSource = Domainが含まれている場合は、すべて問題ありません。ユーザーはそのような要求に対して引き続き許可されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、サードパーティのリソース（CDN）からダウンロードしたスクリプトを使用すると、問題が発生する場合があります。そしてそれは正しいですCDNコードの整合性は保証されません。ユーザー認証を失わないようにするには、サイトにスクリプトを保持し、ドメインからダウンロードします。これは、httpsページでのhttpリンクの使用を禁止するのと少し似ています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発者が陥る可能性のある状況について説明します。ユーザーアクションの結果として、スクリプトは承認されたユーザーをサイトのいずれかのページにリダイレクトし（たとえば、これはフォームによって行われます）、ユーザーは承認されたままでいる必要があります。スクリプトは、たとえば、CDNからロードされたjQueryスクリプトを使用して$（フォーム）.submit（）を呼び出します。この場合、ブラウザーは、フォームの送信イベントをトリガーした呼び出しスタックに、外部スクリプトからの関数があることを確認します。</font></font><abbr title="Cross-Site Scripting — « »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSS</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃</font><font style="vertical-align: inherit;">を防ぐため</font><font style="vertical-align: inherit;">に、ブラウザーはSourceフィールドを空にし、ランダムバイトをトークンの生成に追加します（ケース</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P9</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">その結果、新しいページのユーザーは突然不正になり、操作を完了できなくなります。</font><font style="vertical-align: inherit;">これは、CDNの使用に慣れている開発者を混乱させる可能性があります。</font></font><br>
<br>
<a name="protocol_scenario"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.7プロトコルシナリオ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーがサイトを操作する主なシナリオは次のとおりです。すべての可能な状況とその実装の段階に影響を与えます（匿名ログイン、「覚えて」、「忘れて」、永久キーの使用への切り替え、承認とログアウト、登録と2要素認証、エクスポート/キーのインポート、キーの交換など）</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1フォーラム、ブログ、ウィキペディア</font></font></th>
</tr>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザ</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトサーバー</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1このサイトへの最初のアクセス。</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムなキーを生成します。</font><font style="vertical-align: inherit;">ランダムなキーから安全でないトークンを送信します。</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーは匿名と見なされます。</font><font style="vertical-align: inherit;">このトークンをユーザーセッションの識別子として使用します。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2ページを表示します。</font></font></td>
<td>     .</td>
<td>  .   128-  .</td>
</tr>
<tr>
<td>1.3    (   ..)</td>
<td>     .</td>
<td> ,    .     ,   – .</td>
</tr>
<tr>
<td>1.4  ,    .</td>
<td>  .   Permanent.        .      ,&nbsp;      success.</td>
<td>  ,   .  CSI-Token-Action: success.        :     ,      .         (  ).</td>
</tr>
<tr>
<td>1.5   ( ,   ..)</td>
<td>  CSI-Token   .</td>
<td>    .</td>
</tr>
<tr>
<td>1.6   .</td>
<td>.</td>
<td>      .</td>
</tr>
<tr>
<td>1.7    .</td>
<td>   .</td>
<td>   .          .</td>
</tr>
<tr>
<td>1.8    (    )</td>
<td>  Logout</td>
<td>    , ..    ,        .  .       .</td>
</tr>
<tr>
<td>1.9       Logout.</td>
<td>  . &nbsp;     .</td>
<td>     .   .       .</td>
</tr>
<tr>
<td>1.10  .</td>
<td>     .</td>
<td>  .   128-  .</td>
</tr>
<tr>
<td>1.11   .</td>
<td>.</td>
<td>   .</td>
</tr>
<tr>
<td>1.12    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .</td>
</tr>
<tr>
<td>1.13    .</td>
<td>.</td>
</tr>
<tr>
<td>1.14   .</td>
<td> <b> :   ,     ? ,     ,    .</b><br>
  Change-To.        .            .          CSI-Token-Action: success.</td>
<td>     .  ID .      .  CSI-Token-Action: success.</td>
</tr>
<tr>
<td>1.15   ( ,   ..)</td>
<td>  Token   </td>
<td>    .   128- .</td>
</tr>
<tr>
<td>1.16  «».</td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<td>1.17    .</td>
<td>  . &nbsp;     .</td>
<td>  .       .</td>
</tr>
<tr>
<td>1.18   .</td>
<td> Change-To.   , ..       CSI-Token-Action: success.</td>
<td>     .  ID .    .  ,      .</td>
</tr>
<tr>
<td>1.19   .</td>
<td>.   Logout,   «»   .</td>
<td>   ,     Logout.</td>
</tr>
<tr>
<th colspan="3">2 -   </th>
</tr>
<tr>
<th></th>
<th></th>
<th> </th>
</tr>
<tr>
<td>2.1     .</td>
<td>  . &nbsp;     .</td>
<td>  .        .</td>
</tr>
<tr>
<td>2.2  .</td>
<td>     .</td>
<td>  .   128-  .</td>
</tr>
<tr>
<td>2.3    ( ,   ..)</td>
<td>     .</td>
<td> ,    .     ,   – .</td>
</tr>
<tr>
<td>2.4  ,    .</td>
<td>  .       CSI-Token   Permanent.   success,    .</td>
<td>  ,   .        :     ,      .         ( ).</td>
</tr>
<tr>
<td>2.5   ( ,   ..)</td>
<td>  CSI-Token   .</td>
<td>    .  .</td>
</tr>
<tr>
<td>2.6   .</td>
<td>.</td>
<td> .             .</td>
</tr>
<tr>
<td>2.7    .</td>
<td>   .</td>
<td> .   ,      .</td>
</tr>
<tr>
<td>2.8 <b>  </b>   .</td>
<td>.</td>
</tr>
<tr>
<td>2.9   .          .</td>
<td>  Change-To.   <b></b>         .   <b></b>   .</td>
<td>2.9..     . <br>
        –     . <br>
 <br>
 2.9..     . <br>
        –  .       (       ) – ..         :      .  ID .  CSI-Token-Action: success.       .</td>
</tr>
<tr>
<td>2.10   (,  , , , , )</td>
<td>  Token   </td>
<td>    .   128- .</td>
</tr>
<tr>
<td>2.11   .</td>
<td>.   Logout,   «»   .</td>
<td>   ,     Logout.</td>
</tr>
<tr>
<th colspan="3">3      (. )</th>
</tr>
<tr>
<th></th>
<th></th>
<th> </th>
</tr>
<tr>
<td>3.1    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .     .          .</td>
</tr>
<tr>
<td>3.2    </td>
<td></td>
</tr>
<tr>
<td>3.3   .</td>
<td> <b> :   ,     ? ,     ,    .</b><br>
 <br>
  Change-To.<br>
 <b>    </b>.</td>
<td>  .     ,     .     «»,       (, ).  CSI-Token-Action: registration</td>
</tr>
<tr>
<td>3.4    .</td>
<td> ajax-.  Change-To.       .<br>
 <b>      </b>. <br>
 <br>
    success,      ( ).</td>
<td>  .   ,  CSI-Token-Action: success. : CSI-Token-Action: registration.   CSI-Token-Action: abort,    .        ( ).     .</td>
</tr>
<tr>
<td>3.5     </td>
<td>  Token   .</td>
<td> ,   128- .</td>
</tr>
<tr>
<td>3.6   (,  , , , , )</td>
<td>  Token   .</td>
<td>    .   128- .</td>
</tr>
<tr>
<td>3.7   .</td>
<td>.   Logout,   «»   .</td>
<td>   ,     Logout.</td>
</tr>
<tr>
<td>3.8    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .     .        ,   .</td>
</tr>
<tr>
<td>3.9   .</td>
<td> Change-To.     .</td>
<td>       ( 128-).   ,   .</td>
</tr>
<tr>
<td>3.10     (  )</td>
<td> <b> :   ,      ? ,     ,    .</b><br>
 <br>
  Change-To.<br>
 <b>     ;  –  </b><br>
 </td>
<td>     .   .      .  CSI-Token-Action: success</td>
</tr>
<tr>
<td>3.11   ( ,   ..)</td>
<td>  Token   </td>
<td>    .   128- .</td>
</tr>
<tr>
<td>3.12  «».</td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<td>3.13    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .    .</td>
</tr>
<tr>
<td>3.14   </td>
<td> Change-To.     .</td>
<td>       ( 128-).</td>
</tr>
<tr>
<td>3.15      .<br>
 <b>:       .</b><br>
 </td>
<td>  Logout     .</td>
<td> </td>
</tr>
<tr>
<td>3.16   </td>
<td> Change-To.<br>
 <b>     .</b> <br>
 <br>
  ,    «»     (. 3.15).</td>
<td>     . <b> </b>       .    ,  <b>   </b>    .    –           .</td>
</tr>
<tr>
<td>3.17   ( ,   ..)</td>
<td>  Token   </td>
<td>    .   128- .</td>
</tr>
<tr>
<td>3.18 </td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<th colspan="3">4   -  ( )</th>
</tr>
<tr>
<th></th>
<th></th>
<th> </th>
</tr>
<tr>
<td>4.1    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .    .</td>
</tr>
<tr>
<td>4.2    </td>
<td></td>
</tr>
<tr>
<td>4.3   .</td>
<td> <b> :   ,     ? ,     ,    .</b><br>
 <br>
  Change-To.<br>
 <b>    </b>.</td>
<td>   .   .     .  CSI-Token-Action: registration.</td>
</tr>
<tr>
<td>4.4     .  «»</td>
<td> Change-To      success.       .<br>
 <b>      .</b><br>
 </td>
<td>  .    .</td>
</tr>
<tr>
<td>4.5      .</td>
<td> ajax-.      Change-To. <br>
 <br>
    success,      ( ).</td>
<td>  .      ( ).  CSI-Token-Action: success <br>
       . <br>
    ,  CSI-Token-Action: registration. <br>
 <br>
      CSI-Token-Action: abort.    ,      .</td>
</tr>
<tr>
<td>4.6    .</td>
<td>  Token   </td>
<td>       .</td>
</tr>
<tr>
<td>4.7  «»  </td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<td>4.8    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .          «».</td>
</tr>
<tr>
<td>4.9   .</td>
<td> Change-To.<br>
 <b>     </b>(..   ;    ).</td>
<td>       ( 128-).  ,        .      ,   .    .   CSI-Token-Action: success</td>
</tr>
<tr>
<td>4.10      .</td>
<td> ajax-.   &nbsp;      .</td>
<td> .  .  .       .</td>
</tr>
<tr>
<td>4.11    .</td>
<td>  Token   .</td>
<td>       .</td>
</tr>
<tr>
<td>4.12  «»   </td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<td>4.12     ().</td>
<td>   Logout,   «»   .  .</td>
<td> ,     Logout.   .</td>
</tr>
<tr>
<th colspan="3">5  :   ESXi</th>
</tr>
<tr>
<th></th>
<th></th>
<th> </th>
</tr>
<tr>
<td>5.1    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .   .</td>
</tr>
<tr>
<td>5.2    .</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5.3     ( ,   ).  ,   <i></i> .</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5.4     (SSH, RDP).      (  .htaccess – .  )</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5.5  </td>
<td></td>
<td>   </td>
</tr>
<tr>
<td>5.6    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .   .</td>
</tr>
<tr>
<td>5.7   .</td>
<td> Change-To.<br>
 <b>     </b>(..  ,         ;     <i></i>).</td>
<td>       (. ). <br>
 <br>
     ( 128-).&nbsp; <br>
    128-.     .<br>
   CSI-Token-Action: success. <br>
   CSI-Token-Action: abort (    ),   403 – Forbidden. <br>
     .</td>
</tr>
<tr>
<td>5.8   </td>
<td>     .</td>
<td>       .</td>
</tr>
<tr>
<td>5.9  </td>
<td>   Logout,   «»   .  .</td>
<td> ,     Logout.   .</td>
</tr>
<tr>
<th colspan="3">6  :  </th>
</tr>
<tr>
<th></th>
<th></th>
<th> </th>
</tr>
<tr>
<td>6.1    .</td>
<td>  . &nbsp;     .</td>
<td>  .        .<b>   .</b>  CSI-Support: yes;</td>
</tr>
<tr>
<td>6.2   .</td>
<td></td>
<td></td>
</tr>
<tr>
<td>6.3   .</td>
<td> <b> :   ,     ? ,     ,    .</b><br>
 <br>
  Change-To.<br>
 <b>    </b>.</td>
<td> ,   CSI-Token-Action: registration, ..   .</td>
</tr>
<tr>
<td>6.4  /  « »</td>
<td> / POST-  .      Change-To,    .</td>
<td> /.    .    .  CSI-Token-Action: success</td>
</tr>
<tr>
<td>6.5&nbsp;           «»</td>
<td>    Token   </td>
<td>   /.  .</td>
</tr>
<tr>
<td>6.6 </td>
<td>  Logout</td>
<td> </td>
</tr>
<tr>
<td>6.7    .</td>
<td>  . &nbsp;     .</td>
<td>  . <b>  « »</b><br>
 </td>
</tr>
<tr>
<td>6.8   .</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変更先を送信します。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンは保護された形式で送信されます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（すでにデバイスに認識されているため、以前に登録を渡しました）。</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最高の128ビットトークンでユーザーを識別します。</font><font style="vertical-align: inherit;">下位ビットをチェックします。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.9特権アクションを実行します</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">永久キーから安全なトークンを送信します</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー特権に従ってアクションを実行します。</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.10出てくる</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログアウトキーを送信します</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セッションを中断します</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
.htaccessファイルに基づくトークンアクセス構成の例。</font></font><br>
<pre><code class="apache">&lt;Directory "/var/www/html"&gt;<font></font>
        AuthType CSI<font></font>
        AuthName "Restricted Content"<font></font>
        AuthTokensFile /etc/apache2/.csi_keys<font></font>
        Require valid-user<font></font>
&lt;/Directory&gt;<font></font>
</code></pre><br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">猫/etc/apache2/.csi_keys</font></font></pre><pre><code class="bash">#<font></font>
# Client Self Identification tokens file<font></font>
#<font></font>
# CSI-Domain-Key							UserName		Role<font></font>
84bc3da1b3e33a18e8d5e1bdd7a18d7a166d77ac1b46a1ec38aa35ab7e628ab5	MelnikovIN	admin<font></font>
6d7fce9fee471194aa8b5b6e47267f0348a24b70a0b376535542b996af517398	BoshirovAM	user</code></pre><br>
<br>
<a name="token_algo_for_server"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.7.1既知のキーを使用してサイトの可能なユーザートークンを計算するアルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドメインキーKがわかっている場合は、要求に同行するユーザーの可能な「有効な」トークンTを簡単に計算できます。</font><font style="vertical-align: inherit;">このためには、条件が満たされている必要があります。要求の開始者、要求の受信者、および実行コンテキストは、ドメインと一致し、ドメインと等しくなければなりません。</font><font style="vertical-align: inherit;">つまり、vsphere.localドメイン名がある場合、次のようになります。</font></font><br>
<pre><code class="plaintext">Sender = Recipient = Context = vsphere.local</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここから、元の（生の）トークンは次のように計算されます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/af8/1c2/5b0/af81c25b054111db5d526fcfb8c4fb8c.svg" alt="$T_s = HMAC_{K}(Sender \cup Recipient \cup Context)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
転送時に、元のトークンはさらに保護されます。</font><font style="vertical-align: inherit;">トークンの下位128ビットは、CSI-Salt </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストヘッダーで渡されるソルトでハッシュされ</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">したがって、サイトには次のトークンが表示されます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8ea/b59/cc3/8eab59cc3e5060cfec9956f984807b5f.svg" alt="$T = Hi(T_s) \cup HMAC_{salt}( Lo(T_s) )$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hiが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高い128ビットであり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローは、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元のトークンの低い128ビットです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、企業ネットワーク上の閉じた管理コンソールの場合、Webコンソールは外部スクリプトやフレームなどをロードしません。</font><font style="vertical-align: inherit;">したがって、ほとんどの場合、この条件は満たされます。</font></font><br>
<hr><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">※ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ソルト化の方法については、「ブラウザとサーバー間の塩交換手順」</font></a><font style="vertical-align: inherit;">の項をご覧ください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a></sup><br>
<br>
<a name="server_token_processing"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.8サーバーでのトークンの処理</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンをサーバーに送信する（キーなし）</font></font></h3><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトセッションのトークンTステータス</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトサーバーアクション</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">わからない</font></font></td>
<td>        ,              .<br>
<br>
  .   .<br>
  128       . <br>
    .      CSI-Salt.<br>
<br>
</td>
</tr>
<tr>
<td> ( 128 )</td>
<td>  . <br>
     CSI-Salt –   .<br>
   .       CSI-Token.<br>
<br>
  ,  CSI-Token-Action: invalid.    400.<br>
<br>
   –  200.<br>
<br>
</td>
</tr>
</tbody></table></div><br>
<br>
<h3>    Permanent</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザはクライアントキーをキャプチャします。</font><font style="vertical-align: inherit;">ユーザーは、サイトが複数のセッションで顧客を覚えていることを望んでいます。</font><font style="vertical-align: inherit;">ユーザートークンをデータベースに格納するかどうかは、サーバーの決定です。</font><font style="vertical-align: inherit;">CSI-Token-Action：successまたはCSI-Token-Action：abortをクライアントに返します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログアウトキーを使用してトークンを送信する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在のトークンがブラウザーで使用されなくなることを示します。</font><font style="vertical-align: inherit;">これは、ユーザーがブラウザーで[終了]をクリックするか、タブを閉じてオプションが構成されている（タブが閉じているときに自動終了する）か、固定キーの使用を拒否する（「このサイトで私を忘れる」）と送信されます。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ところで、自動ログインはそうすべきではありません。</font><font style="vertical-align: inherit;">セキュリティ上の理由から。</font></font></blockquote><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change-Toキーを使用してトークンを送信する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古いトークンをT、新しいトークンをT-としましょう。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいトークンT 'として、トークンの実際の値が送信され（登録されていないトークンが初めて）、古いトークンがハッシュされて送信されます（下位128ビット）。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーデータベースのトークンステータス</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup></td>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトサーバーアクション</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T '</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">番号</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">番号</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">理由：</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法的な</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザー</font><b><font style="vertical-align: inherit;">登録</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーセッションIDをT 'に変更します</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 。CSI-Token-Action：Successをクライアントに送信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーはサイトの永続キーを作成し、「ログイン」を実行しました。</font><font style="vertical-align: inherit;">サーバーはそのようなトークンをその側に格納できます。</font><font style="vertical-align: inherit;">その前に、登録フォームへの記入を提案します（必要な場合）。</font></font><br>
<br>
   CSI-Token-Action: registration,   ,     (        ).        Change-To (   )   ,     success  abort.   ,  ,     .   –      (  ).<br>
 </td>
</tr>
<tr>
<td></td>
<td></td>
<td>: <b> Login</b>.<br>
<br>
   T'  .   .   .   CSI-Token-Action: success.<br>
<br>
<b></b>.         Change-To   ,    CSI-Token-Action: success, <b>  </b>    Change-To   <b>  </b>.<br>
    ,       .          .<br>
  <b>     </b>,       «» .    <b>      </b>,       -. ..    «  »,    .<br>
 </td>
</tr>
<tr>
<td></td>
<td></td>
<td>: <b>  </b>   .<br>
<br>
   T     T'.   .<br>
   CSI-Token-Action: success.<br>
 </td>
</tr>
<tr>
<td>,<br>
 <br>
 <br>
 </td>
<td></td>
<td>: <b>     </b><br>
<br>
 ,         ,      -.                  -     .<br>
<br>
           (  ).      – .<br>
<br>
  .   CSI-Token-Action: success<br>
 </td>
</tr>
<tr>
<td>,<br>
 <br>
 <br>
 .<br>
 </td>
<td></td>
<td> .            .   .  CSI-Token-Action: abort.   .<br>
<br>
 256-       SHA-2.      ( )         .<br>
<br>
         :<ul>
<li>     ;</li>
<li>        ;</li>
<li>  </li>
</ul>     .   , –  -    .<br>
     ,      .        Logout   .   Login  .  .<br>
 </td>
</tr>
</tbody></table></div><hr><sup>*        ,    .</sup><br>
<br>
<a name="sub_domain_identify"></a><h2>2.9 - </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前述のように、サイトは他のパートナーサイトまたはそのサブドメインと対話して、ユーザーにいくつかの機能を提供できます。最も一般的な例は、site.ruサイトで、img.site.ruサブドメインから一部のリソースがダウンロードされ、download.site.ruの一部が読み込まれ、他のリソースが他の一部から読み込まれる場合です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、site.ruは、パートナードメインにリクエストの送信元を正確に通知できる必要があります。実際、site.ruで承認されている場合でも、サイトのサブドメインを含む他のサイトで自動的に承認されるわけではありません。彼らはあなたからの他のトークンを見ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンの計算方法と、これがどのように役立つかを見てみましょう。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーに永続キーでsite.ruにログインさせ、そこにトークンを持たせます。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/a5a/e9b/500/a5ae9b500f4fd8f2600eafdb3a315d32.svg" alt="$ T_1 = HMAC_ {site.ru-key}（site.ru \ cup site.ru \ cup site.ru）$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.ruサイトページからsite.ruドメインへのすべてのリクエストは、次の原因で発生します。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページリソースタグ（静的またはネイティブ動的）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独自のスクリプト</font></font></li>
</ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンT </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を持ちます</font><font style="vertical-align: inherit;">（ルール</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RBを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照）。</font><font style="vertical-align: inherit;">これらは、site.ruへの正当なリクエストです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントが制限されたファイルをsite.ruページからダウンロードできるようにしますが、リンクはdownload.site.ruにつながります。</font><font style="vertical-align: inherit;">この場合、サブドメインは次のトークンを受け取ります（ルール</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/445/897/361/445897361e99df033e11f354f37071af.svg" alt="$ T_2 = HMAC_ {site.ru-key}（site.ru \ cup download.site.ru \ cup site.ru）$" data-tex="display"></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.ruサイトページからajaxリクエストが行われた場合、まったく同じdownload.site.ruトークンを受け取ります（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルール</font><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のドメインdomainがトークンを受け取ります：</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/231/d05/899/231d058996ea04e27a4a67dbdadf68ee.svg" alt="$ T_3 = HMAC_ {site.ru-key}（site.ru \ cup domain \ cup site.ru）$" data-tex="display"></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、要求を満たすための条件が変わらない場合は、ドメインA、B、Cの特定のバンドルに対して、ブラウザーは常に一定のトークンを生成することに注意してください。</font><font style="vertical-align: inherit;">したがって、クロスドメインの識別を行うことができます。</font><font style="vertical-align: inherit;">たとえば、そのように。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
site.ruから、サブドメインのajaxリクエストを作成します。</font><font style="vertical-align: inherit;">識別子IDを渡します！= </font><font style="vertical-align: inherit;">site.ruによってユーザーに発行されたユーザーの</font><font style="vertical-align: inherit;">T </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">サブドメインは同じユーザーのT </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンを受け取ります</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">各サブドメインは、ユーザーIDを使用して一連のトークンを作成します。</font><font style="vertical-align: inherit;">サブドメインは、サーバー間要求でユーザーIDとその権限に関する情報をすでに共有しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
束は1回です。</font><font style="vertical-align: inherit;">その後、サブドメインは独自のトークンに焦点を当てます。</font><font style="vertical-align: inherit;">それらは、site.ru永続キーに対しても永続的です。</font></font><br>
<br>
<a name="part3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3安全に関する推奨事項</font></font></h1><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></b><div class="spoiler_text">     .          .</div></div><br>
<br>
<a name="keys_NAA_protection"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1不正アクセスからの重要な情報の保護</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提案された認証プロトコルは、提案されたスキームがパスワードをまったく使用しないため、キーロガーがパスワードを盗むことからユーザーを保護します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、キーを侵害から保護する方法をより詳細に検討する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キーは次の方法で危険にさらされる可能性があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルウェアによるキー情報のコピー（リモートアクセス）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キー情報が「オフライン」のファイルへの直接アクセス（直接アクセス）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバイス間の配布時</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
キー情報がスマートカードに保存されていると（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「アカウントモビリティ」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セクションでこのオプションを検討しました</font><font style="vertical-align: inherit;">）、キー情報を保護するタスクがチップに転送されます。確かに、入力されたPINコードを傍受できるキーロガーの脆弱性があります。さて、使いにくかったです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スマートカードに加えて、対称暗号化を使用して、主要な情報への直接アクセスから保護できます。しかし、問題は、暗号化のためにどのキーを使用するかです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このキーがユーザーのパスワードに基づいて生成された場合、最初に、「オフライン」というパスワードの選択に対する脆弱性が発生し、次に、実際に、私たちが残したものから、「いくつかのパスワード」に到達しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
より正しいオプションは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、特別な方法で縫うことです</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザアセンブリ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（またはその専用ライブラリの1つ）にあるその</font><b><font style="vertical-align: inherit;">ようなキー</font></b><font style="vertical-align: inherit;">。ブラウザを更新するたびに、コンパイルされたファイル内のキーとその場所の両方が変更されます。このアプローチでは、保護が100％保証されるわけではありませんが、復号化のタスクが非常に複雑になります。最初に、攻撃者はアセンブリの正確なバージョンを見つけ、それを見つけて分解し、キーがどのように組み立てられているかを知る必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、ドメインキー自体は別のファイルに直接保存する必要があり、使用するための構成と一緒に保存する必要はありません（つまり、キーのみでそれ以上は保存しない）。正しく解読されたキーをランダムなバイトシーケンスから区別することができないため、（既知のアセンブリからの）キー選択方法による解読は不可能になります。次に、ブラウザアセンブリの正確なバージョンを知らずにマスターキーを取得し、そのコードを直接分解しようとすると、まったく不可能になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザーのキーによる暗号化+ OSアカウントのユーザーパスワードによる暗号化（OS APIで許可されている場合）の組み合わせオプションを使用できます。さらに、キーは常にオンザフライで生成されます。次に、オフラインの総当たりはさらに高価になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、OSでユーザーパスワードを変更すると、キーも変更されます。</font><font style="vertical-align: inherit;">また、古いキーを事前に復号化しない場合、これにより、コンピューター管理者がアカウントにアクセスしてユーザーに代わってアクションを実行するためにパスワードを変更する状況から保護されます。</font><font style="vertical-align: inherit;">タイプの状況：彼の仕事を辞めます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、キーのバックアップコピーを作成します（キーをファイルにエクスポートします）。</font><font style="vertical-align: inherit;">もちろん、他のデバイスにキーを配布するときに、以前にこれを行っていた場合を除きます。</font></font><br>
<hr><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*たとえば、32バイトのキーは、実行可能ファイルの64Kセクションにランダムに配布されます。</font><font style="vertical-align: inherit;">そして、ソースコードだけがこれらのバイトから秘蔵鍵を収集する方法を知っています。</font></font></sup><br>
<br>
<a name="why_password_for_keys_not_good"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2ドメインキーとしてのパスワードについて</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロトコルの初期バージョンの1つでは、ユーザーのパスワードに基づいてドメインキーを生成できます。アルゴリズムはトリッキーで、同じパスワードの異なるドメインからの重複したキーを除外しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはモビリティアカウントへの便利な方法として位置付けられました。 1つのパスワードを入力し、何も心配しません。しかし、それから次のことがわかりました。</font></font><br>
<br>
<ol>
<li>    ,     «» ,        ,   .   ,       -,          .<br>
 <br>
  (),     8-  ,       ,    .: ~!@#$%^&amp;.   : 26 + 26 + 10 + 8 = 70 . 8-       70<sup>8</sup> .<br>
 <br>
 ,     ,         10<sup>12</sup>   .      70<sup>8</sup> / 10<sup>12</sup> = ~576 . ..       ~10 .          5       . 10-      15 .      10 ,      1-2 .<br>
 <br>
           ,        .</li>
<li>      ,     .</li>
<li>               ,     . ..      (       SHA-2).</li>
<li> , ,  ,      .        .</li>
</ol><br>
<br>
<a name="risks_loss_keys"></a><h2>3.3  /    </h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マスターキーを紛失した場合はどうなりますか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは、パスワードを変更した場合、またはOSを再インストールした場合に発生する可能性があります。リスクは何ですか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、あなたはあなたが以前あった場所に到達しません。オンラインストアでのショッピング履歴、オンラインサイトでの広告、フォーラムでのカルマを失います。問題ない。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、新しいトークンを使用して再登録手続きを行い、同じアナウンスに示されている電話番号でそれを確認するのを防ぐのは誰ですか？サイトはトークンの再登録のフォームを実行する必要があることがわかりました（「パスワード回復」の類似物）？ 「あらゆる種類の」フォームの約束された欠如はどこにありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際には、ニーズだけでなく、訪問者を識別するだけでなく、それが本当に誰であるか知っていることをサイト</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にあります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登録フォームを作成します。</font><font style="vertical-align: inherit;">実際、このフォームは再登録に使用できます。</font><font style="vertical-align: inherit;">以前とまったく同じデータ（メール、モバイル）を指定します。</font><font style="vertical-align: inherit;">これらのデータ（手紙、SMS）があることを確認します。</font><font style="vertical-align: inherit;">システムは、そのようなアカウントがすでに存在していることを確認します。データは100％あなたのものですが、トークンは異なります-トークンを書き換えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、マスターキーを紛失しないようにしてください。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損失を防ぐ方法は？</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックアップコピーを作成し、パスワードで保護して、使い捨てメディアに保存します。</font><font style="vertical-align: inherit;">また、実際には、ビットコインのキーで行われます。</font><font style="vertical-align: inherit;">原則として、マスターキーを印刷形式に変換して、紙に保存できます。</font><font style="vertical-align: inherit;">そのことについては。</font><font style="vertical-align: inherit;">そして手動入力で復元します。</font><font style="vertical-align: inherit;">しかし、これは私のようなかなり「パラノイア」な人々のためのものです。</font></font><br>
</blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、マスターキーが私から盗まれた場合はどうなりますか？</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これはすでに深刻です。ここで説明されているマスターキー（プロトコルには含まれていません）を保存するための推奨事項は、直接の改ざん、キーロガー、トロイの木馬から保護しますが、マスターキーを危険にさらすリスクは残ります。残念ながら、完全な保護は存在しません。キーは、JavaScriptエンジンの脆弱性を介してブラウザのメモリから直接ハイジャックされる可能性があります。例として。または、携帯電話を紛失します</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か？マスターキーを盗むリスクは何ですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
あなたに関する情報を受け取り、あなたに代わって行動を起こすことさえも不可欠です。攻撃者があなたの下と読み取りモードでログインして機密情報にアクセスする能力を獲得する。静かで静か。または、クラスメートからすべてのプライベートビデオを一度にダウンロードします。それはあなたにとって不愉快です。アザラシのファンは大喜びです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、重要なサイトの新しいキーですばやく再登録する必要があります。</font><font style="vertical-align: inherit;">そして、ひどいことが起こった場合、新しいトークンをサービスプロバイダーのデータベースに正式な方法で登録することが唯一の正しいオプションです。</font><font style="vertical-align: inherit;">正式な書面による紙の固定から、サイトのテクニカルサポートサービスを介した申請まで、さまざまな登録方法を考えることができます。</font><font style="vertical-align: inherit;">しかし、これはオンラインバンキングなどの深刻なサイトにのみ当てはまります。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスクを最小限に抑える方法。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメインの個別のキーの使用（ただし、これによりアカウントの移動性が低下します）。</font><font style="vertical-align: inherit;">独立したチャネルによる2要素認証。</font><font style="vertical-align: inherit;">サイトには、接続が最後に行われたIPアドレスとデバイスが表示されるので、少なくとも時間内に侵害に気付くことができます。</font></font><br>
</blockquote><br>
<br>
<a name="part4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4認可スキームへの攻撃</font></font></h1><br>
<br>
<a name="attack_user_tracking"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1ユーザー追跡</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
信頼できるサイトは、あなたに関する情報を他のサイトと恥知らずにマージすることができます。</font><font style="vertical-align: inherit;">インターネット上には、そのような情報を集めてみんなに売るコレクターサイトがあります。</font><font style="vertical-align: inherit;">Yandexメトリックス、Googleアナリティクス-それらなしでまれなサイト。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの異なるサイトが同じクライアントで動作していると判断できるように、2つの手法が使用されます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別のコンテキストでの1つのサイトの実装と、実際に生成されたユーザー識別子の相互交換（識別子として、プロファイルの任意のものを使用できます）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">単一のアルゴリズム（ブラウザ属性の一意のセットの形成）によるブラウザのフィンガープリントの形成と、このフィンガープリントによるクライアントの間接的な識別。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スキーム2にはわずかな欠点があり</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。ユーザーが識別されるの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ではなく、ブラウザー</font><b><font style="vertical-align: inherit;">が識別され</font></b><font style="vertical-align: inherit;">ます。しかし、多くの場合、ブラウザ==クライアントです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンはスキーム2での使用に最も適しているようです。結局のところ、ユーザーが2つのサイト（ペアとして機能）に「記憶」することを許可されている場合、永続トークンはブラウザーだけでなくユーザー自身もそのような「指紋」として機能できます。ここのサイトの問題は、それら</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が異なるトークンを受け取ること</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、サイトはスキーム1も適用しようとすることができます。その後、次のことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイト1は、コードH受信する</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザから</font><font style="vertical-align: inherit;">、サイト2、サイト1のコンテキストで実行される、</font><font style="vertical-align: inherit;">受信する</font><font style="vertical-align: inherit;">コード・H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。サイトはペアを形成できるようです（H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、H</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）さらに、それをアグリゲーターサイトに渡します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたを追跡するために、サイト2とペアになっている別のサイト3があるとします。</font><font style="vertical-align: inherit;">サイト3はブラウザーからH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンを受け取り、</font><font style="vertical-align: inherit;">サイト2はサイト3のコンテキストで実行され</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 '</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークン</font><font style="vertical-align: inherit;">！= H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を受け取り</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">（トークンの形成方法を参照）。</font><font style="vertical-align: inherit;">結果として、取得したデータを結合することは不可能です。</font><font style="vertical-align: inherit;">重なり合う部分はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、サイトが指紋ブラウザを使用して監視できないことを意味するものではありません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">トークン生成スキーム自体は非常に信頼性が高く、追跡から保護されているとのみ述べています。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護オプション：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作業を終えたサイトからログアウトします。</font><font style="vertical-align: inherit;">タブを閉じると、ブラウザはこれを自動的に実行できます。</font></font><br>
<br>
<a name="attack_XSS"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2 XSS攻撃</font></font></h2><br>
<br>
<abbr title="クロスサイトスクリプティング-「クロスサイトスクリプティング」"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSS</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、victim.com Webサイトのページへの悪意のあるコードの導入を伴うタイプの攻撃です。たとえば、アフィリエイトスクリプトまたは人気のあるフレームワークのハッキングされたCDNを介して。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
悪意のあるコードは、サイトのユーザー認証を使用して、認証されたアクセスを取得したり、ユーザー認証データを盗んだりする可能性があります。悪意のあるコードは、Webサーバーの脆弱性（些細なハッキング）、アフィリエイトネットワーク（信頼できないソース）、ユーザーのコンピューターの脆弱性（プロキシトロイの木馬）を介してページに挿入される可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの認証スキームに対するそのような攻撃に対する主な保護は、トークンを計算するときにSourceフィールドを生成するための特別なルールです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脆弱性</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：保存されたXSSの場合（スクリプトが攻撃されたサイトに直接挿入され、サーバーのハッキングの結果としてそこからロードされた場合）、保護は機能しません。</font><font style="vertical-align: inherit;">これは、ブラウザがそのようなスクリプトを「外部」として識別できないためです。</font><font style="vertical-align: inherit;">攻撃者がクライアント/サーバートラフィックをプロキシするときにも同じ問題が発生します。</font></font><br>
<br>
<a name="attack_CSRF"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.3 CSRF攻撃</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
被害者は、攻撃者が作成したevil.comサイトを訪問します。彼女に代わって、ユーザーが既に承認されているサイト（たとえば、支払いシステムサーバー）に対して要求（GET / POST / HEAD / PUT / DELETE）が実行されます。リクエスト自体が何らかの悪意のある操作（攻撃者のアカウントへの送金など）を実行します。開発者の監督によると、サイトはリファラーフィールドをチェックせず、ユーザーに追加の確認情報を要求しません。その結果、攻撃は成功します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
提案されたサイト認証スキームは、ほとんどの</font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;">CSRF</font></abbr><font style="vertical-align: inherit;">攻撃シナリオを抑制します</font></font><abbr title="クロスサイトリクエストフォージェリ-「クロスサイトリクエストフォージェリ」"><font style="vertical-align: inherit;"></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、トークン生成アルゴリズムのため。</font><font style="vertical-align: inherit;">クロスサイトリクエストがあると、攻撃されたサイトはユーザーから無効なトークンを受け取ります。</font><font style="vertical-align: inherit;">その結果、この状況では、攻撃されたサイトのユーザーは匿名匿名になります。</font><font style="vertical-align: inherit;">攻撃サイトから攻撃サイトへの無害なGETリクエストの実行（画像の読み込み）を試みても、後者は無効なトークンを受け取ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、サイト開発者の生活が大幅に簡素化されます。</font></font><br>
<br>
<a name="attack_SSO"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.4 SSOスキームを使用した追跡</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが信頼し、それらのキーを持っている</font><font style="vertical-align: inherit;">
2つのサイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2は</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザー追跡にSSOと同様のテクノロジーを適用することを決定します。しかしそれ以来あるサイトを別のサイトに埋め込むことはできません（そのうちの1つは無効なトークンを受け取ります）。パートナーのサイトをスクリプトで開くことはできません（同じ理由で）。その場合、サイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はトリッキーなテクニックを使用することを決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ページの1つに、ウィンドウ全体を覆う半透明のタグAを配置します。リンクはサイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2に</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">つながり</font><font style="vertical-align: inherit;">、ユーザー識別子（S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">）とトークンH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1が</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドレスで送信されます</font><font style="vertical-align: inherit;">。ユーザーにはリンクが表示されません。サイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1の</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任意の領域をクリックすると</font><font style="vertical-align: inherit;">、サイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2で</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいタブが開きます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は有効なトークンを受け取りません。</font><font style="vertical-align: inherit;">タグを使用した自己リロードも彼を助けません</font></font><br>
<pre><code class="xml">&lt;meta http-equiv="refresh" content="0"&gt;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはスクリプト。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はページ全体に偽の閉じるボタンの形でAタグを作成できます。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/is/n5/jh/isn5jhlcnubhl580cvv6lgdloye.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このリンクは最初にサイトをリロードし、次にサイトを閉じます。再起動時に、ブラウザーは</font><font style="vertical-align: inherit;">既に有効なH </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;">トークン</font><font style="vertical-align: inherit;">をS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトに送信します</font><font style="vertical-align: inherit;">（ルール2.4 P1が満たされているため、ユーザーが個人的に両方のリンクを開いています）。</font><font style="vertical-align: inherit;">
その結果、S </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;">はサイトS </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;">での</font><font style="vertical-align: inherit;">ユーザーのアクションに関する情報を受け取り</font><font style="vertical-align: inherit;">、トークンH </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;">をそのH </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">関連付け、</font><font style="vertical-align: inherit;">H </font><sub><font style="vertical-align: inherit;">2に</font></sub><font style="vertical-align: inherit;">サーバー間要求をS </font><sub><font style="vertical-align: inherit;">1に</font></sub><font style="vertical-align: inherit;">送信し</font><font style="vertical-align: inherit;">ます。将来的には、サイトS </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;">およびS </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;">は、次のようにサーバー交換によってユーザーに関するあらゆる情報を交換できるようになります。これで、相互に</font><b><font style="vertical-align: inherit;">個別に</font></b><font style="vertical-align: inherit;">識別できるようになりました</font><font style="vertical-align: inherit;">。</font></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モバイルユーザーは特に、この攻撃に対して脆弱です。</font><font style="vertical-align: inherit;">不要なページを閉じようとすると、モバイル画面全体を占める偽のリンクが誤ってクリックされる可能性があります。</font></font></blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護方法：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タブが閉じられると自動的にセッションを中断します。</font><font style="vertical-align: inherit;">次に、サイトS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ユーザー自身がログインするまで有効なトークンを受け取ることができませんでした。</font><font style="vertical-align: inherit;">確かに、これはユーザー自身がタブを開いてS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とS </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2に</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログインした状況から保護しません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そしてその時だけ、サイトはそのような攻撃を実行しました。</font></font><br>
<br>
<a name="attack_sso_key_discredit"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.5 SSOの主要な侵害</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSOをサポートする認証サーバーのユーザーアカウントが侵害されるようにします。</font><font style="vertical-align: inherit;">認証スキームを使用して、考えられるリスクを評価します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各サイトのトークンは、ドメインキーに基づいて個別に計算されます。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのドメインキーを危険にさらしても、他のすべてのキーが自動的に侵害されることはありません。</font></font></b></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前にSSOを使用してログインしたほとんどのサイトでは、SSOサーバーのプロファイルを使用して、トークンをデータベースに保存する可能性があります。</font><font style="vertical-align: inherit;">私たちのスキームでは、サイトはデータベースからトークンを取得し、あなたを認識します。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">そのようなサイトではSSOサーバーは不要になりました-登録段階でその機能を実行しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、一度にすべてのアクセスが自動的に失われるわけではありません。</font><font style="vertical-align: inherit;">攻撃者は別の人と同じサイトで識別されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クロスドメイン認証を再実行しようとしても、攻撃者には役立ちません。サイトは、古いSSO Idユーザーと新しいサイトトークンで新しいアカウントを作成する試みをブロックする必要があります。または、SSOプロセスで既存のIDのユーザートークンを書き換える試みはブロックする必要があります。この事実は、サイトの側に合理的な疑いを引き起こす必要があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザートークンは、1つの方法でのみ正当に変更できます（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「スクリプトスクリプト」を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">危険。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイトがトークンとプロファイルをデータベースに保存せず、SSOメカニズムに完全に依存している場合、攻撃者はクロスドメイン認証を実行するだけで、自分の名前でログインできます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">妥協した場合のリスクの最小化。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">奇妙なことに、これは側のサイトによるトークンとユーザープロファイルの保持です。攻撃者がクロスドメイン認証を実行しようとすると、古いIDユーザーと新しいトークンが競合する可能性があります。ユーザーがプロトコルで指定されている以外の方法でトークンを変更した場合、状況自体が疑わしいと見なされるか、完全に拒否されます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最大のリスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のサイト（あなたが行ったことがない場所）に代わって承認を得る。プロファイルデータへのアクセス。あなたに代わって違法行為を行う。そして、正当な所有者が何も返すことができないように、攻撃者は認証サーバーで自分のトークンを合法的に変更することができます。ただし、このリスクは、従来の承認スキームを使用する場合のリスクと一致します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護の方法。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSOの使用を拒否する（特に、提案されたスキームは、集中認証スキームから離れる方法として考えられたため）。</font><font style="vertical-align: inherit;">複数のSSOを使用する（すべての卵を1つのバスケットに保管しないでください！）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SSOが他の属性（メール、電話）による認証を伴う2要素認証をサポートしている場合、承認サーバーのアカウントを再び制御できる可能性があります。</font></font><br>
<br>
<a name="attack_token_compromise_due_transmit"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.6転送中のトークンの侵害</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
転送中にトークンをハッシュするための提案されたメカニズムは、トークンの</font><font style="vertical-align: inherit;">保護を</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100％保証しない</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことは明らかです</font><font style="vertical-align: inherit;">。例として、攻撃者は、安全でないトークンの転送時（永久キーの最初の登録時）に被害者のトラフィックを傍受することができます。そしてそれを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、SSLの使用をお勧めします。ただし、HTTPSを万能薬として使用しないでください。このプロトコルだけでなく、HTTPも公開されています。少しだけ難しい。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、オープントークンのこのようなまれな転送、およびドメインごとに個別のトークンを使用することで、脆弱性を悪用するリスクが軽減されます。それにもかかわらず。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つの危険は、現在のユーザーセッション内でのトークンの傍受と再利用です。</font><font style="vertical-align: inherit;">先に述べたように、理想的には、トークンはクライアント要求ごとに新しいソルトでハッシュされる必要があります。</font><font style="vertical-align: inherit;">ただし、これにより、サーバー上で要求が並列処理される可能性がなくなり、クライアントから並列要求を送信できなくなります。</font><font style="vertical-align: inherit;">ハッシュの計算とチェックは一般に、パフォーマンスを低下させる高価な操作です。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、ヘッダーで渡されたトークンがJavaScriptから利用可能であってはなりません。</font><font style="vertical-align: inherit;">HttpOnlyフラグ付きのCookieに似ています。</font><font style="vertical-align: inherit;">スクリプトでajaxリクエストを受け取った場合でも。</font></font></blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作方法：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーのリクエストをインターセプトし、現在のトークン値を取得し、同じトークンを使用して別の操作を送信します（同じユーザーに代わって）。</font><font style="vertical-align: inherit;">確かに、セッションCookieに基づく従来のシステムもこのタイプの攻撃に対して脆弱です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保護方法：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SMSやメールなど、他の通信チャネルを介した重要な操作の確認。</font><font style="vertical-align: inherit;">他の通信チャネルによるトークンの事前登録（例として紙の証明書）。</font></font><br>
<br>
<a name="attack_token_compromise_due_site_hacking"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.7 Webサイトのハッキングとトークンの侵害</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッキングサイトは常に発生しています。</font><font style="vertical-align: inherit;">大規模で十分に保護されたサイトでさえ壊れます。</font><font style="vertical-align: inherit;">侵入には多くの方法があります。ささいな注入から内部の「ドレイン」までです。</font><font style="vertical-align: inherit;">したがって、どのサイトでもトークンが侵害される可能性は非常に高いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、提案されたプロトコルはまったく同じで、サイトのハッキングイベントを最も苦痛にしません。</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンの侵害は、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計算に基づい</font><b><font style="vertical-align: inherit;">たドメインキーの侵害にはつながりません</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">また、この</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イベントによって他のトークンが侵害されることはありません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その場合、他のサイトへのアクセスは引き続きアクセスできません。</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、ほとんどのサイトのキーがマスターキーを使用して作成されている場合に特に快適です。リバースエンジニアリングでそれを復元することは不可能です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし同時に、明らかな理由により、トークンが侵害されたドメインキーを使用することは不可能です。</font><font style="vertical-align: inherit;">キーを変更する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
公式リークが発生したドメインのキーは、乱数またはマスターキーに基づいて作成でき、バージョン番号が追加されています。</font></font><br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/b1c/9ee/9ac/b1c9ee9ac9a8f065c9a394045a24edb9.svg" alt="$ DomainKey = HMAC_ {M_ {key}}（DomainName \ cup VersionNumber）$" data-tex="display"></p><br>
<br>
<a name="epilog"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が記事を見せてくれた私の友人の何人かは、本質的に同じ質問を私に尋ねました：「ここの主なものは何ですか？」</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高いところから見た</font></font></b><div class="spoiler_text"> ,        (     ),     (?)  ,   .<br>
<br>
,     ,  -  .  ,    ,       ,           .       (   ,   ).    ,        « »      «-».<br>
<br>
 -    « ». <s>  </s>    ,  <s></s> «».     ,    .     (   Google ,  Facebook –       ).     (  DDOS-    . – <abbr title="            "><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></abbr>  )   - .   ,     SSO       ,        .   ?<br>
<br>
  , , ,       .  ,     -     -.  ,     .,     .     email,  .      .  ,             .    ?<br>
<br>
<b>  -.  ?</b> SSO –    .<br>
<br>
,        « ».         .      .       .             .   , .<br>
<br>
     -      «»  .    ,    « ».          ,    .<br>
<br>
 -,         ?<br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ああ、メインチップはありません！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ああ。</font><font style="vertical-align: inherit;">しかし、プロトコルを従来のログイン/パスワード方式よりも収益性の高いものにする多くの詳細があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1.多くのサイトでこの迷惑なポップアップに気づいたはずです。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「私たちのサイトはクッキーを保存します！</font><font style="vertical-align: inherit;">兄があなたを見ているので、ヘルメットをかぶって警戒してください！</font><font style="vertical-align: inherit;">まだ選択肢がないので、「はい」をクリックしてください。」</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは、他の同様に侵入的で非常に必要なものへの別のポップアップです。</font><font style="vertical-align: inherit;">これはすべて、ヨーロッパのGDPR（PD法の類似物）のおかげです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だからここに。</font><font style="vertical-align: inherit;">私たちのスキームでは、識別のためにCookieは不要になりました。</font><font style="vertical-align: inherit;">「完全に」という言葉から。</font><font style="vertical-align: inherit;">ユーザーは、サイトにサイトの識別を許可するかどうか、いつ、どのくらいの期間を決定します。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マイナス1の迷惑なポップアップ、プロトコルのカルマに+1。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2.開発者は、承認およびパスワード回復フォームを実行する必要がなくなりました。</font><font style="vertical-align: inherit;">OAuth、SAML、Kerberosなどの複雑なSSOアルゴリズムやマスター複雑なライブラリを実装する必要はありません。サイトの登録、認証キーの変更、セキュリティの監視の手順を実行します。</font><font style="vertical-align: inherit;">SSOで問題が発生した場合は、「何が問題で、なぜか」を早急に理解してください。</font><font style="vertical-align: inherit;">さらに、承認サーバーは、未知の理由でサイトをブロックする場合があります。</font><font style="vertical-align: inherit;">それを理解してください。</font><font style="vertical-align: inherit;">昨日はすべてうまくいきましたが、今日は...ヘッダーからトークンを読み取って、データベースにトークンがあるかどうかを確認するだけで十分です。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンプル=信頼できる</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ただ言って ...</font></font></b><div class="spoiler_text">     .     .       ,   -  -  .       . .  .<br>
<br>
   -, -,  « »   .<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3.ユーザーは一連のパスワードを入力して覚える必要はありません。サードパーティのサイトのサービスを使用するか、誰がどのようにプログラムを作成したかは不明です。サードパーティ、キーロガー、トロイの木馬によるコンピュータへのアクセスを恐れることはできません。マスターキーのバックアップコピーを作成し、パスワードで保護して、USBフラッシュドライブのどこかに保存するだけで十分です。ビットコインの財布のようです。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能とは何ですか？</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
4.サイトがハッキングされても、何のリスクもありません。さて、もう一度鍵を再生成してください。サイトのクラッカーにパスワードが漏洩した場合、多くの問題が発生する可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5.このプロトコルは、既知のネットワーク攻撃の経験を考慮して作成されました。そのアーキテクチャには、XSS、CSRFに対する基本的な保護がすでに含まれています。繰り返しになりますが、ウェブマスターはサイトを開発しやすくなります。そしてそのユーザー-落ち着いて。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.特定のサービスプロバイダーとその気まぐれからのプロトコルの独立性。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコルはあなたを自由にします。</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
7.最後に、提案された</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロトコルは将来のオープンスタンダードを主張しています</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。そして、参加者が採用した場合、この規格は</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、仕様に従って機能を実装する義務を課し</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、集合ファームを独自の承認決定からフェンスしないで、ログイン、登録、パスワード回復、ログアウトの形式を再び発明します。また、パスワードハッシュやSQLインジェクションをいじらないでください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最も重要なことは、他のオープンスタンダードと同様に、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検証が可能であり、検証が必要</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">独立した専門家。</font><font style="vertical-align: inherit;">プロトコルのオリジナルバージョンの作成者が詳細に「めちゃくちゃ」になっている場合でも、オンラインコミュニティはこの修正をタイムリーに特定できます。</font><font style="vertical-align: inherit;">まあ、または私のプロトコルをスクラップに送ってください。</font><font style="vertical-align: inherit;">ああ、私にとっては悲しいことだし、他のすべての人にとっては「うんちを運ぶ」。</font></font><br>
<br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-私はこの</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
E. Wilesに</font><i><font style="vertical-align: inherit;">立ち寄る必要があると思います</font></i></font><br>
</blockquote><br>
<br>
<hr><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
オフライン形式のフルレングスの記事のオプションに慣れることができます。</font><font style="vertical-align: inherit;">Habrで資料を組版するときに、タイプミスをすることができました。</font><font style="vertical-align: inherit;">深刻なコメントがある場合は、元の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を確認し、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">このファイルに</font></a><font style="vertical-align: inherit;">記事のコメント（レビュー）を残しておくことをお勧めし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">変更内容をメールsergey201991 [] gmailで送ってください。</font><font style="vertical-align: inherit;">私はタコではありませんが、答えてみます。</font><font style="vertical-align: inherit;">この記事に複数の一致する/興味深いコメントを追加します。</font><font style="vertical-align: inherit;">それらへの答えと共に。</font><font style="vertical-align: inherit;">別のコメント記事の変形は除外されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、プロトコルに問題がある可能性があることを知っています：</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーが手元にない場合、他の人のデバイスの自分のアカウントでログインする方法はありませんが、緊急に必要です。</font><font style="vertical-align: inherit;">ここではパスワードがより便利です</font></font></li>
<li>     ;           ,  SSO</li>
<li>      «», -  : -      (   )</li>
<li>   - </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1ページ目について-私はパスワードに基づいてドメインキーを生成するという考えに戻り、キーを生成するプロセスを複雑にすることでブルートフォースから保護することを真剣に考えていました：たとえば、ハッシュラウンドの数を1000に増やすことです。サイトは私を悩ませます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ページについて-これは時間で扱われます。</font><font style="vertical-align: inherit;">新しいインターフェースに慣れる必要があります。</font><font style="vertical-align: inherit;">最初は明確ではありませんが、簡単です。</font><font style="vertical-align: inherit;">80年代の男性に最新のスマートフォンを提供すれば、彼はそれを管理する方法も推測しなかったでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後までお読みいただきありがとうございます！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja472296/index.html">洗濯機の漏れ防止システム</a></li>
<li><a href="../ja472298/index.html">先週フロントエンドの世界からの新鮮な食材のダイジェストNo.385（2019年10月14日〜20日）</a></li>
<li><a href="../ja472300/index.html">バイナリ分類問題における対数損失関数（LogLoss）の確率的勾配降下法（SGD）</a></li>
<li><a href="../ja472304/index.html">NASAがエンジニアを雇って次世代のヒューマノイドロボットを開発</a></li>
<li><a href="../ja472306/index.html">PHPダイジェストNo. 166（2019年10月7-21日）</a></li>
<li><a href="../ja472312/index.html">Mavenプロジェクトをマルチリリースjarに転送した経験：すでに可能ですが、それでも難しい</a></li>
<li><a href="../ja472314/index.html">段ボールの人が好き</a></li>
<li><a href="../ja472318/index.html">Istioでの分散トレース</a></li>
<li><a href="../ja472320/index.html">Zabbixへのインタビュー：12の率直な答え</a></li>
<li><a href="../ja472326/index.html">私たちの宇宙産業...そして、オタクの立場からこの産業の問題を​​見ると？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>