<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔟 🧑🏿‍🤝‍🧑🏾 🐊 Comment nous avons migré d'Oracle JDK et Java Web Start vers AdoptOpenJDK et OpenWebStart 🚴🏽 🖐🏽 👨🏻‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journée. 
 
 Dans cet article, je parlerai de la «modernisation» dans l'entreprise pour laquelle je travaille d'un outil tel que Java Web Start,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons migré d'Oracle JDK et Java Web Start vers AdoptOpenJDK et OpenWebStart</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487798/"><img src="https://habrastorage.org/webt/wy/dl/dd/wydlddv9m1-mxrvnfor6vxdifra.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne journée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, je parlerai de la «modernisation» dans l'entreprise pour laquelle je travaille d'un outil tel que Java Web Start, ou plutôt, de le remplacer par une solution open source alternative.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos de moi</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je m'appelle Ildar et je travaille pour une entreprise allemande qui, comme de nombreuses entreprises allemandes, utilise l'ancienne pile technologique et essaie de migrer vers une pile plus récente. </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problème</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais commencer par une description du problème. Notre entreprise possède la partie la plus importante du système, qui est une application héritée écrite en java 6 et partiellement en java 8. Elle a été lancée en java 8. Pour utiliser cette application pour la production, les utilisateurs téléchargent le fichier jnlp à partir du site et l'exécutent à la maison sur les ordinateurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La société </font><font style="vertical-align: inherit;">existait donc </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">heureusement</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> depuis </font><font style="vertical-align: inherit;">longtemps </font><font style="vertical-align: inherit;">, jusqu'à ce qu'Oracle annonce qu'il a cessé de prendre en charge la version 8 de java, a déclaré la technologie Java Web Start comme déconseillée, et a décidé de la supprimer à partir de java 11. Cela signifiait qu'il y avait encore plus d'applications JWS, dont il y en a encore beaucoup ne recevra pas les mises à jour de sécurité incluses. Bien sûr, peu de gens peuvent accepter cela. Les amateurs de Karakun ont également décidé d'écrire leur remplaçant pour JWS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre entreprise, il y a quelque temps, ils ont commencé à réécrire l'application en utilisant Spring boot pour le backend et React pour le frontend, mais le processus n'est pas rapide et il n'y a pas de mises à jour maintenant.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher une solution</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipe de développement a donc été confrontée à la question de trouver des solutions alternatives. En général, il convient de reconnaître qu'il existe plusieurs solutions au problème. Initialement, les architectes ont sélectionné deux solutions </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetDown</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le même </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWebStart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Au moment de la décision initiale, le choix s'est porté sur la première option, car OpenWebStart n'était même pas sorti sous la première version (il n'y avait que quelques développements et plans). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chacune des solutions avait ses avantages et ses inconvénients, mais la société a décidé de ne pas attendre la sortie d'OpenWebStart et de commencer à mettre en œuvre la preuve de concept basée sur GetDown. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir passé quelques semaines, l'un des développeurs a fait face à la tâche et nous avons réalisé qu'en principe, nous pouvons mettre en œuvre une solution complète qui satisfait nos besoins en passant un peu plus de temps.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre-temps, d'autres tâches urgentes sont arrivées et l'équipe de développement a été distraite de la transition de l'étape PoC à la mise en œuvre complète du remplacement de Java Web Start.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Délais</font></font></h4> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout le monde a vécu heureux jusqu'à ce que la direction se rende compte qu'il était déjà temps de se terminer et avec le remplacement de Java Web Start. </font><font style="vertical-align: inherit;">Jusqu'à ce moment, je n'étais pas impliqué dans ce projet, mais ici, ils m'ont aussi connecté. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, j'ai décidé de chercher à nouveau des informations sur les solutions à notre problème. </font><font style="vertical-align: inherit;">Disons donc entrer dans la solution à partir de zéro. </font><font style="vertical-align: inherit;">Ainsi, j'ai découvert l'existence d'OpenWebStart. </font><font style="vertical-align: inherit;">Je l'ai testé localement, j'ai rencontré des problèmes (puis nous en avons rencontré d'autres également) et les ai résolus. </font><font style="vertical-align: inherit;">En conséquence, tout le monde a aimé la solution. </font><font style="vertical-align: inherit;">Inutile de dire que la direction l'a particulièrement apprécié car elle n'aurait pas à consacrer de temps au développement, comme c'est le cas avec GetDown. </font><font style="vertical-align: inherit;">Mais à la fin, nous avons passé du temps à faire fonctionner notre système avec OpenWebStart.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informations rapides sur OpenWebStart</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenWebStart est basé sur une autre implémentation de Java Web Start - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IcedTea-Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et la spécification JNLP </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSR-56</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Au moment de la rédaction, le projet existe dans la version 1.1.4 et prévoit de mettre en œuvre les principales fonctionnalités de Java Web Start (des progrès peuvent être observés </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne vois pas l'intérêt de lister tous les paramètres possibles, cela peut prendre très longtemps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quelques-uns d'entre eux:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gestion du cache (taille, emplacement ...),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paramètres de sécurité (permettant aux utilisateurs d'exécuter une application non signée par des certificats, d'afficher ou non des popups d'avertissement ...),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajouter des adresses de serveurs à la liste blanche,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paramètres de débogage à distance,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gestion des certificats de sécurité</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrôle de version JRE / JDK,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autre</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caractéristiques de l'utilisation d'OpenWebStart et problèmes rencontrés</font></font></h4><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez OpenWebStart</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'installation d'OpenWebStart est assez simple. </font><font style="vertical-align: inherit;">Il suffit de </font><font style="vertical-align: inherit;">télécharger le fichier d'installation de votre plateforme </font><font style="vertical-align: inherit;">sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et de suivre les instructions de l'installateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais c'est pas de chance. </font><font style="vertical-align: inherit;">Dans notre cas, les utilisateurs sont environ 10 000 clients, pour chacun desquels le service d'assistance de notre entreprise doit installer cet outil. </font><font style="vertical-align: inherit;">La solution a été trouvée assez rapidement: l'installation dite en arrière-plan est disponible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez télécharger le fichier d'installation sur chacun des ordinateurs et exécuter une commande spéciale (et pour cela, l'entreprise dispose déjà d'un outil):</font></font><br>
<br>
<pre><code class="bash hljs">OpenWebStart_windows_Setup.exe -q -varfile response.varfile
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
, où response.varfile est un fichier avec certains paramètres qui peuvent être définis à l'avance par le programme d'installation. Par exemple, le dossier dans lequel installer OpenWebStart et quelques autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, nous avons fait face à ce problème. De plus, il serait nécessaire que tous les clients installent en quelque sorte une version spécifique d'AdoptOpenJDK et les lient à OpenWebStart, ce qui se fait facilement via l'interface utilisateur, mais ce n'est pas notre cas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0w/w4/3l/0ww43l5ljpbdwqa766ywant6yac.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons trouvé dans les paramètres que vous pouvez spécifier l'URL à partir de laquelle OpenWebStart prendra le fichier de paramètres, dans lequel vous pouvez spécifier l'URL du JRE dont nous avons besoin. Et l'URL elle-même avec le fichier de paramètres peut être spécifiée dans le fichier response.varfile mentionné ci-dessus (c'est compliqué). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fichier de paramètres JSON lui-même avec différentes versions de JRE est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le suivant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les paramètres, vous pouvez également spécifier la version et le fournisseur du JRE, au cas où plusieurs JRE sont spécifiés dans le fichier JSON. </font><font style="vertical-align: inherit;">Nous en avons indiqué un seul et avons téléchargé le fichier JSON et l'archive avec le JRE dont nous avons besoin sur le compartiment Amazon S3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après les tests, nous avons constaté qu'avec la version JRE que nous avons téléchargée, l'application ne démarre pas ... Il s'est avéré que notre Java a une structure légèrement différente dans l'archive. </font><font style="vertical-align: inherit;">Nous avons créé un script batch qui a reconstruit la structure de l'archive JRE. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«Eh bien, maintenant tout va bien fonctionner», nous avons pensé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous démarrez l'application pour la première fois, le JRE est automatiquement chargé, qui sera utilisé à l'avenir. </font><font style="vertical-align: inherit;">Mais nous attendions la prochaine surprise.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le malheur ne vient jamais seul</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais comme cela arrive habituellement, nous ne nous sommes pas limités à un seul problème. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre application a, disons, une fonctionnalité. Il y en a en fait deux. Une application (un fichier jnlp) démarre une deuxième application (second jnlp). Et dans ce cas, la deuxième application n'a pas démarré. Dans les journaux, vous pouvez voir que les applications sont bloquées dans l'impasse. De la trace furtive, il est devenu clair que la raison en est le mécanisme de journalisation interne d'OpenWebStart. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le problème a été résolu en désactivant la journalisation interne d'OpenWebStart. Bien entendu, les journaux de nos applications sont restés. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0t/1n/yi/0t1nyitsnxpltecpcwbrpjavjw0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces paramètres ont également été désactivés dans le fichier response.varfile, qui est utilisé lors de l'installation en arrière-plan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, après avoir surmonté ces obstacles et quelques autres (je n'ai pas besoin de mentionner tout le monde déjà), nous avons réussi à lancer notre application, qui est actuellement en cours de test avant d'être publiée sur le prod. </font><font style="vertical-align: inherit;">Comme nous l'avons testé, la version d'OpenWebStart est passée de 1.1.1 à 1.1.4. </font><font style="vertical-align: inherit;">Parmi les changements notables a été ajoutée la possibilité de débuter à distance. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/da/lg/sf/dalgsf4r0owjtavojy00fc7fgwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que mon article sera utile à quelqu'un dans un travail aussi difficile que le support des applications héritées. </font><font style="vertical-align: inherit;">Si vous avez des questions - demandez, je vais essayer de répondre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS toutes les images sont extraites du site officiel d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWebStart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr487788/index.html">Conception de produits sans concepteur</a></li>
<li><a href="../fr487790/index.html">"Oui, ils existent!" Que font les spécialistes des sciences des données au Kazakhstan et combien gagnent-ils?</a></li>
<li><a href="../fr487792/index.html">Augmenter Mercurial sur un serveur Windows (avec Nginx)</a></li>
<li><a href="../fr487794/index.html">Évaluation des frameworks Web haute vitesse 2020</a></li>
<li><a href="../fr487796/index.html">Top 10 des plugins Eclipse essentiels pour les développeurs Java</a></li>
<li><a href="../fr487800/index.html">Pourquoi est-il important de dire au demandeur ce qui n'a pas fonctionné pendant l'entretien (et comment le faire correctement)</a></li>
<li><a href="../fr487802/index.html">Onduleur APC Smart sans coupure et comment les cuisiner</a></li>
<li><a href="../fr487804/index.html">Meetup Growth Teams à Raiffeisenbank</a></li>
<li><a href="../fr487806/index.html">Création d'une petite API Deno</a></li>
<li><a href="../fr487808/index.html">Réseaux de neurones récurrents (RNN) avec Keras</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>