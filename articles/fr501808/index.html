<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏻 🥈 🌹 La liste des changements dans D 2.092. Emprunter Emprunter ⏯️ 🙇🏾 😤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Du traducteur. Je ne traduis généralement pas de tels articles, car je n'y vois rien d'intéressant. Ici, deux petites innovations, mais les plus impor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>La liste des changements dans D 2.092. Emprunter Emprunter</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501808/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Du traducteur. </font><font style="vertical-align: inherit;">Je ne traduis généralement pas de tels articles, car je n'y vois rien d'intéressant. </font><font style="vertical-align: inherit;">Ici, deux petites innovations, mais les plus importantes - la prise en charge de la liaison directe des bibliothèques C ++ et le système de propriété et d'emprunt «emprunté» de Rust (la seconde est l'hirondelle DFA, la première est sortie dans GCC10 il y a seulement quelques jours, et Nim y pense aussi comme ça) avec une description. </font><font style="vertical-align: inherit;">En fait, je n'ai traduit aucune liste fastidieuse et les liens mènent à l'original. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version précédente de la liste 2.0.91.1 (eng) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Où télécharger</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2.092.0 est sorti avec 15 changements importants et 44 corrections de bugs et améliorations. </font><font style="vertical-align: inherit;">Un grand merci aux </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">47 contributeurs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui ont rendu cette sortie possible.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications du compilateur</font></font></h4><a name="habracut"></a><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les </font><b><font style="vertical-align: inherit;">commutateurs de</font></b><font style="vertical-align: inherit;"> ligne de commande </font><b><font style="vertical-align: inherit;">-revert = </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">import</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-transition = checkimports ont été</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supprimés</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout de la prise en charge du codage (mangling) des noms C ++ GNU ABI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les constructeurs et destructeurs pour les modules qui ne sont pas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">externes (D)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont marqués comme obsolètes</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Violations DIP25 marquées par défaut Obsolète</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système de propriété et d'emprunt de prototypes pour pointeurs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajouté </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-preview = en option qui</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> transforme la classe de stockage </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">périmètre const</font></font></b></li>
<li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> paramètres </font><b><font style="vertical-align: inherit;">Printf</font></b><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scanf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont maintenant vérifiés pour la conformité avec les spécificateurs de format</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La variable d'environnement </font><b><font style="vertical-align: inherit;">SOURCE_DATE_EPOCH est</font></b><font style="vertical-align: inherit;"> désormais prise en charge.</font></font><b><font style="vertical-align: inherit;"></font></b></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications de l'exécution</font></font></h4><br>
<ol>
<li> <b>TypeInfo_Class/TypeInfo_Interface.isBaseOf</b>  C#/Java <b>isAssignableFrom</b></li>
<li> <b>core.memory.pageSize</b>  <b>minimumPageSize</b></li>
</ol><br>
<h4> </h4><br>
<ol>
<li> <b>Date.isoWeekYear</b>  <b>Date.fromISOWeek</b>  <b>std.datetime.date</b></li>
<li> <b>std.xml</b>  </li>
<li>   <b>std.digest.digest</b> </li>
</ol><br>
<h4>   Dub</h4><br>
<ol>
<li>   </li>
<li>Dub lint    <b>--report-file</b></li>
</ol><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une liste complète des corrections et améliorations (Fr.)</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Remarque: J'ai des pattes, par conséquent, il n'est pas possible de configurer des liens intra-page corrects à partir de la table des matières pour divulguer les sujets dans l'original, désolé = (</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications du compilateur</font></font></h4><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les commutateurs de ligne de commande </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-revert = import</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-transition = checkimports ont</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> été supprimés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ces clés n'ont rien fait, et pendant un certain temps, elles ont été marquées comme obsolètes. </font><font style="vertical-align: inherit;">Le compilateur ne les reconnaîtra plus.</font></font></li>
<li>   ()  C++ GNU ABI<br>
<br>
 GNU ABI   C++11  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> GCC 5.1</a>.     D  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">  C++</a>, DMD    UDA ( ) <b>gnuAbiTag</b>,   <b>core.attribute</b>      <b>object</b> (         ). ABI    ,     ,       ++ .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">std::string</a>     C++11   (DMD  <b>-extern-std={c++11,c++14,c++17}</b>).<br>
<br>
  : <br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">extern</span>(C++):<font></font>
@gnuAbiTag(<span class="hljs-string">"tagOnStruct"</span>)
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">MyStruct</span> {</span>}<font></font>
@gnuAbiTag(<span class="hljs-string">"Multiple"</span>, <span class="hljs-string">"Tags"</span>, <span class="hljs-string">"On"</span>, <span class="hljs-string">"Function"</span>)
<span class="hljs-function">MyStruct <span class="hljs-title">func</span><span class="hljs-params">()</span></span>;</code></pre><br>
      gnuAbiTag.     (  ). UDA        <b>-extern-std=c++11</b>.   (<b>-extern-std=c++98</b>) UDA . UDA    extern(C++)        .</li>
<li>    ,   <b>extern(D)</b>  .<br>
<br>
    (    )     ,   <b>extern(D)</b>,     .       ,    ,     /     , ,        <b> </b>   479,     <b> </b>    479,      .<br>
<br>
 ,      ,          .</li>
<li> DIP25    .<br>
<br>
DIP25    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">2.067.0</a>,    ,       -preview=dip25.          , , DIP1000.<br>
<br>
   , ,         <b>-preview=dip25</b>,          <b>-preview=dip25</b>.     (    ).<br>
<br>
DIP25   ,  <b>@ safe</b>       .     ,   <b>ref </b>  ,   <b>return </b>    ,   .<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Foo</span>
{</span>
    <span class="hljs-keyword">int</span> x;
    <span class="hljs-comment">// returning `this.x` escapes a reference to parameter `this`, perhaps annotate with `return`</span>
    <span class="hljs-function">ref <span class="hljs-keyword">int</span> <span class="hljs-title">method</span><span class="hljs-params">()</span> <span class="hljs-comment">/* return */</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.x; }<font></font>
}<font></font>
<span class="hljs-comment">// returning `v` escapes a reference to parameter `v`, perhaps annotate with `return`</span>
<span class="hljs-function">ref <span class="hljs-keyword">int</span> <span class="hljs-title">identity</span><span class="hljs-params">(<span class="hljs-comment">/* return */</span> ref <span class="hljs-keyword">int</span> v)</span> </span>{ <span class="hljs-keyword">return</span> v; }</code></pre><br>
    <b>return </b> .   DIP25   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a>.</li>
<li>  <b>-preview=in</b>    <b>in</b>  <b>scope const</b>.<br>
<br>
      <b>const scope</b>,   <b>in </b>        .   , <b>in </b>       (.  inout )  .<br>
<br>
  <b>-preview=in</b>,    :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(in <span class="hljs-keyword">int</span> x)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> x)</span></span>;</code></pre><br>
  <b>-preview=in</b>,    :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(in <span class="hljs-keyword">int</span> x)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(scope <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> x)</span></span>;</code></pre></li>
<li> <b>printf</b>  <b>scanf</b>      <br>
<br>
  C99 7.19.6.1  printf  7.19.6.2  scanf.<br>
<br>
 printf   ,     . ,         .<br>
<br>
 scanf     .<br>
<br>
  :<br>
<br>
<ol>
<li> ,      </li>
<li> ,    </li>
<li>  </li>
<li> </li>
<li>   </li>
<li> —  ,    s</li>
<li> </li>
<li>     C99</li>
</ol><br>
 -,   .<br>
<br>
        .<br>
<br>
 ,     printf/scanf,    :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">printf</span>(<span class="hljs-string">"%k\n"</span>, value);  <span class="hljs-comment">// error: non-Standard format k</span>
<span class="hljs-keyword">const</span> format = <span class="hljs-string">"%k\n"</span>;
<span class="hljs-built_in">printf</span>(format.ptr, value);  <span class="hljs-comment">// no error</span></code></pre><br>
   —    . ,<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">string</span> s;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n"</span>, s.length, s.ptr);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, s.<span class="hljs-keyword">sizeof</span>);<font></font>
ulong u;<font></font>
<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%lld%*c\n"</span>, &amp;u);</code></pre><br>
  :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">string</span> s;
<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n"</span>, cast(<span class="hljs-keyword">int</span>) s.length, s.ptr);
<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%zd\n"</span>, s.<span class="hljs-keyword">sizeof</span>);<font></font>
ulong u;<font></font>
<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%llu%*c\n"</span>, &amp;u);</code></pre><br>
  printf  scanf       <b>pragma(printf)</b>    printf  <b>pragma(scanf)</b>    scanf.<br>
<br>
 ,     :<br>
<br>
<ol>
<li> <b>extern (C )</b>  <b>extern (C++)</b></li>
<li>     <b>const(char)*</b></li>
<li>    …  -v ,     <b>va_list </b> (    «v»  <b>printf  scanf</b>)</li>
</ol>         .<br>
<br>
   «v»-   .<br>
</li>
<li>    <b>SOURCE_DATE_EPOCH</b><br>
<br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"> </a>    SOURCE_DATE_EPOCH.    UNIX (  1970-01-01 00:00:00),   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a>.  DMD       __DATE__, __TIME__  __TIMESTAMP__ .</li>
</ol><br>
<br>
<h3>      </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système de propriété / emprunt (également appelé OB) pour les pointeurs garantit que les pointeurs déréférencés pointent vers un objet mémoire valide.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portée du prototype de système OB</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un prototype du système OB, adapté pour D. Initialement, il est destiné uniquement aux pointeurs, et non aux tableaux dynamiques, aux références de classe, aux références ou aux champs de pointeur dans les agrégats. </font><font style="vertical-align: inherit;">L'ajout d'un support de ce type compliquera la mise en œuvre, mais ne change pas son essence, par conséquent, il est reporté pour plus tard. </font><font style="vertical-align: inherit;">Les objets RAII peuvent gérer en toute sécurité leur propre mémoire, ils ne sont donc pas couverts par l'OB. </font><font style="vertical-align: inherit;">Quelle que soit la méthode, que le pointeur alloue de la mémoire à l'aide de GC ou d'un autre allocateur, cela n'est pas important pour OB, ils ne diffèrent pas et sont traités de manière identique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système OB n'est actif que dans les fonctions annotées avec l'attribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il est appliqué après traitement sémantique uniquement comme contrôle de violation des règles des substances organiques. </font><font style="vertical-align: inherit;">Aucune nouvelle syntaxe n'est ajoutée. </font><font style="vertical-align: inherit;">Aucune modification n'est apportée au code généré. </font><font style="vertical-align: inherit;">Si </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctions </font><b><font style="vertical-align: inherit;">@ live</font></b><font style="vertical-align: inherit;"> appellent des fonctions autres que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il est prévu que ces fonctions appelées soient une </font><font style="vertical-align: inherit;">interface compatible </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bien qu'elle ne soit pas testée. </font><font style="vertical-align: inherit;">Si </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctions </font><font style="vertical-align: inherit;">non </font><b><font style="vertical-align: inherit;">@ live</font></b><font style="vertical-align: inherit;"> appellent des fonctions </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les arguments transmis doivent suivre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conventions </font><b><font style="vertical-align: inherit;">@ live</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système OB détecte les erreurs:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déréférencer les pointeurs qui sont dans un état non valide</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plusieurs pointeurs actifs vers un objet mémoire muté.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne détectera pas les tentatives de déréférencement d'un pointeur nul ou, potentiellement, d'un pointeur nul. </font><font style="vertical-align: inherit;">Cela ne fonctionne pas, car il n'existe actuellement aucune méthode pour annoter un type en tant que pointeur non nullable.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principe de base de l'OB</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conception de l'OB découle du principe suivant: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pour chaque objet mémoire, il peut y avoir exactement un pointeur de mutation ou plusieurs pointeurs non mutants (en lecture seule).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conception</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un pointeur mutant unique est appelé le "propriétaire" de l'objet mémoire. Il possède transitoirement un objet mémoire et tous les objets en mémoire accessibles depuis celui-ci (c'est-à-dire le graphe des objets). Puisqu'il est le seul pointeur vers cet objet mémoire, il peut gérer la mémoire en toute sécurité (changer sa forme, allouer, libérer et redimensionner) sans assommer le sol sous les pieds des autres pointeurs (mutants ou non) qui peuvent y être (graphique mémoire) indiquent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
S'il existe plusieurs pointeurs vers un graphique d'objets en mémoire qui sont en lecture seule, ils peuvent le lire en toute sécurité sans se soucier des changements soudains dans le graphique des objets en mémoire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les autres détails de la technologie concernent la façon dont les pointeurs deviennent en lecture seule et invalides, et comment le principe de base de l’OB est constamment maintenu. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pointeurs suivis</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Seuls les pointeurs déclarés dans la fonction </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ceci</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , les paramètres de fonction ou les variables locales sont </font><font style="vertical-align: inherit;">suivis </font><font style="vertical-align: inherit;">. Les variables provenant d'autres fonctions ne sont pas suivies, même </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ live</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car l'analyse des interactions avec d'autres fonctions ne dépend complètement que de la signature de cette fonction, et non de ses internes. Les paramètres </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ne sont pas suivis. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">États du</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
pointeur Chaque pointeur se trouve dans l'un des états suivants: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Non défini</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le pointeur est dans un état non valide. Déréférencer un tel pointeur est une erreur. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Propriétaire Le</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
propriétaire est le seul pointeur vers un graphique d'objets en mémoire. Généralement, un pointeur - le propriétaire n'a pas d'attribut de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">portée</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Si le pointeur avec l'attribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scope</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><font style="vertical-align: inherit;">initialisé avec une expression qui n'est pas dérivée du pointeur suivi, il devient alors le propriétaire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le pointeur Propriétaire est affecté à un autre pointeur - le Propriétaire, le premier passe à l'état Non défini. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emprunté</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un pointeur emprunté est un pointeur qui devient temporairement le seul pointeur sur un graphe d'objets mémoire. Il passe dans cet état grâce à l'affectation du pointeur - le propriétaire, tandis que le propriétaire passe à l'état de l'emprunteur jusqu'à ce que l'utilisation du pointeur emprunté soit terminée. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un pointeur emprunté doit avoir un attribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scope</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et être un pointeur vers un objet mutable. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lecture</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
seule L' </font><i><font style="vertical-align: inherit;">index en lecture</font></i><font style="vertical-align: inherit;"> seule est attribué par le propriétaire. Tant que le pointeur en lecture seule est actif, seuls les pointeurs en lecture seule peuvent toujours être attribués à partir de ce propriétaire. Le pointeur en lecture seule doit avoir un attribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scope</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et il ne doit pas non plus être un pointeur vers un objet mutable. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durée de vie</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La durée de vie de l'indicateur "Emprunté" ou "Lecture seule" commence au moment où il est déréférencé pour la première fois (et non au moment où il est initialisé ou auquel une valeur a été attribuée) et se termine lorsque la valeur est déréférencée en dernier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est également connu sous le nom </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de durée de vie non lexicale</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transitions d'état pour les pointeurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un pointeur change son état lorsqu'une de ces opérations est effectuée:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de la mémoire lui est allouée (par exemple, une variable locale sur la pile), ce qui place le pointeur dans un état non défini</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initialisation (considérée comme affectation)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affectation - les pointeurs source et cible changent d'état en fonction de l'état dans lequel ils se trouvent, ainsi que de leurs types et classes de stockage</font></font></li>
<li>   <b>out</b> (    ),   ,   .</li>
<li>  <b>ref </b> ,          ,        .</li>
<li> </li>
<li>    ,      .</li>
<li>       - ()</li>
<li>  ,     ,   .</li>
<li>      ,     ,    </li>
<li>        ,     ,    </li>
<li>         ,       </li>
</ul><br>
<h4></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que prototype, de nombreux aspects n'ont pas encore été pris en compte et ne le seront que lorsque le prototype montrera qu'il s'agit d'une solution viable. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erreurs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Attendez-vous à de nombreuses erreurs. Veuillez les signaler à bugzilla et étiqueter avec le mot clé "ob". Il n'est pas nécessaire de signaler d'autres restrictions déjà répertoriées ici. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les références aux classes et aux tableaux associatifs ne sont pas suivies.</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ils sont censés être contrôlés par le GC. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'emprunt et la lecture de non-propriétaires</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
sont surveillés pour les fuites, mais pas d'autres indicateurs. Les emprunteurs sont considérés comme propriétaires s'ils ne sont pas initialisés avec un pointeur.</font></font><br>
<br>
<pre><code class="cpp hljs">@<span class="hljs-function">live <span class="hljs-keyword">void</span> <span class="hljs-title">uhoh</span><span class="hljs-params">()</span>
</span>{<font></font>
    scope p = <span class="hljs-built_in">malloc</span>();  <span class="hljs-comment">// p is considered an Owner</span>
    scope <span class="hljs-keyword">const</span> pc = <span class="hljs-built_in">malloc</span>(); <span class="hljs-comment">// pc is not considered an Owner</span>
} <span class="hljs-comment">// dangling pointer pc is not detected on exit</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semblerait que cela n'a aucun sens de marquer des pointeurs tels que la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">portée</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , peut-être que cela peut être corrigé en traitant cela comme une erreur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les pointeurs sont lus / écrits par des fonctions imbriquées</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
.</font></font><br>
<br>
<pre><code class="cpp hljs">@<span class="hljs-function">live <span class="hljs-keyword">void</span> <span class="hljs-title">ohno</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> p = <span class="hljs-built_in">malloc</span>();<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sneaky</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">free</span>(p); }<font></font>
<font></font>
    sneaky();<font></font>
    <span class="hljs-built_in">free</span>(p);  <span class="hljs-comment">// double free not detected</span>
}</code></pre><br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'analyse des </font><b><font style="vertical-align: inherit;">exceptions</font></b><font style="vertical-align: inherit;"> suppose que les exceptions ne sont pas levées.</font></font><br>
<br>
<pre><code class="cpp hljs">@<span class="hljs-function">live <span class="hljs-keyword">void</span> <span class="hljs-title">leaky</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> p = <span class="hljs-built_in">malloc</span>();<font></font>
    pitcher();  <span class="hljs-comment">// throws exception, p leaks</span>
    <span class="hljs-built_in">free</span>(p);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une solution consiste à utiliser </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scope (exit)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs">@<span class="hljs-function">live <span class="hljs-keyword">void</span> <span class="hljs-title">waterTight</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">auto</span> p = <span class="hljs-built_in">malloc</span>();<font></font>
    scope(<span class="hljs-built_in">exit</span>) <span class="hljs-built_in">free</span>(p);<font></font>
    pitcher();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
utiliser des objets RAII ou appeler uniquement des fonctions de non-retour. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paramètres paresseux</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Non pris en compte. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Complexité quadratique L'</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
analyse montre la complexité quadratique, essayez de garder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctions </font><b><font style="vertical-align: inherit;">@ live</font></b><font style="vertical-align: inherit;"> petites. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mélanger différents groupes de mémoire</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Combiner différents pools de mémoire:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span>* <span class="hljs-title">xmalloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span>)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">xfree</span><span class="hljs-params">(<span class="hljs-keyword">void</span>*)</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span>* <span class="hljs-title">ymalloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span>)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">yfree</span><span class="hljs-params">(<span class="hljs-keyword">void</span>*)</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">auto</span> p = xmalloc(<span class="hljs-number">20</span>);<font></font>
yfree(p);  <span class="hljs-comment">// should call xfree() instead</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
non-détecté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela peut être contourné en utilisant des pools spécifiques à un type particulier:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">U* <span class="hljs-title">umalloc</span><span class="hljs-params">()</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ufree</span><span class="hljs-params">(U*)</span></span>;<font></font>
<font></font>
<span class="hljs-function">V* <span class="hljs-title">vmalloc</span><span class="hljs-params">()</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vfree</span><span class="hljs-params">(V*)</span></span>;<font></font>
<font></font>
<span class="hljs-keyword">auto</span> p = umalloc();<font></font>
vfree(p);  <span class="hljs-comment">// type mismatch</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
et éventuellement interdire les conversions implicites à </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void *</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonctions </font><b><font style="vertical-align: inherit;">@ live</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arguments d'une fonction variadique</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Les arguments d'une fonction variadique (par exemple, printf) sont considérés comme consommés. </font><font style="vertical-align: inherit;">Bien que cela soit sûr, cela ne semble pas très pratique et nécessitera probablement un examen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications de l'exécution</font></font></h4><br>
<ol>
<li> <b>TypeInfo_Class/TypeInfo_Interface.isBaseOf</b>  C#/Java <b>isAssignableFrom</b>.<br>
<br>
<b>TypeInfo_Class.isBaseOf</b>  true,        ,  ,   ,  .   <b>isBaseOf</b>,   <b>isAssignableFrom</b>,     ,   opAssign               D — . <b>TypeInfo_Interface.isBaseOf</b>    ,      <b>TypeInfo_Class</b>,  <b>TypeInfo_Interface</b>.</li>
<li> <b>core.memory.pageSize</b>  <b>minimumPageSize</b>.<br>
<br>
<b>pageSize </b>     .<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">import</span> core.memory : pageSize;<font></font>
ubyte[] buffer = <span class="hljs-keyword">new</span> ubyte[pageSize];</code></pre><br>
<b>minimumPageSize </b>      .<br>
<br>
   ,   .     ,     .      <b>pageSize</b>,     .<br>
<br>
  ,        , ,    : <b>ubyte[minimumPageSize]</b>.<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">import</span> core.memory : minimumPageSize;<font></font>
ubyte[minimumPageSize] buffer;</code></pre><br>
</li>
</ol><br>
<h4> </h4><br>
<ol>
<li> <b>Date.isoWeekYear</b>  <b>Date.fromISOWeek</b>  <b>std.datetime.date</b><br>
<br>
      ISO 8601   ,    Date and DateTime.<br>
<br>
    ISO   ,     . <b>Date.fromISOWeek(2020, 11, DayOfWeek.mon)</b>   <b>Date(2020, 3, 9).</b><br>
<br>
          ISO   ,    () <b>.isoWeekYear</b>     <b>Date </b>   ISO.      ,    <b>.isoWeekAndYear</b>     ,      .</li>
<li> <b>std.xml</b>  .<br>
<br>
 <b>std.xml</b>  .  ,      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">UndeaD</a>.   xml     dub- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">dxml</a>.</li>
<li>   <b>std.digest.digest</b> .<br>
<br>
    2.076.1     .    <b>std.digest</b>   .<br>
<br>
     <b>std.digest.digest</b>       2.101.</li>
</ol><br>
<h4>   Dub</h4><br>
<ol>
<li>   .<br>
<br>
      Posix   ,  <b>.dub</b>.   dub    (, <b>.swap.file.d</b>),    .      ,  dub  .        ,             dub.<br>
<br>
 ,            .</li>
<li>Dub lint    <b>--report-file</b>.<br>
<br>
Dub lint      --report-file: <b>dub lint --report-file report.json</b></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501796/index.html">7 erreurs dangereuses faciles à faire en C # /. NET</a></li>
<li><a href="../fr501798/index.html">C ++ / Qt: est-il temps de blâmer?.</a></li>
<li><a href="../fr501800/index.html">Une petite session osinta sur la modernisation et la production de systèmes de radiocommunication pour les forces armées</a></li>
<li><a href="../fr501804/index.html">Dard. Tout ce que vous devez savoir sur les constantes</a></li>
<li><a href="../fr501806/index.html">ACS: problèmes, solutions et gestion des risques de sécurité</a></li>
<li><a href="../fr501810/index.html">Tireurs 3D sympas sur un ancien ordinateur portable: un test de la plate-forme de jeux en nuage GFN.RU</a></li>
<li><a href="../fr501812/index.html">Bot de pagination de télégramme Python</a></li>
<li><a href="../fr501814/index.html">Changements COVID: histoires des membres de StartupDrive qui ont changé et sont devenues plus fortes pendant une pandémie</a></li>
<li><a href="../fr501820/index.html">Intégration des solutions de surveillance Netflow et SIEM</a></li>
<li><a href="../fr501822/index.html">Ingénieur de troisième génération</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>