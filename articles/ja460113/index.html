<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛓️ 🎣 🙋 JSOC CERT、またはUnbanalフォレンジックの生涯からのいくつかの物語 👩🏼‍🤝‍👨🏿 ☹️ ☀️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JSOC CERTでインシデントを調査しています。一般に、JSOCの170人全員が調査を行っていますが、最も技術的に困難なケースはCERTの専門家の手に渡ります。たとえば、攻撃者がクリーンアップした場合にマルウェアの痕跡を検出するにはどうすればよいですか？ロギングが適切に構成されていないファイルサー...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>JSOC CERT、またはUnbanalフォレンジックの生涯からのいくつかの物語</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/460113/"><img src="https://habrastorage.org/webt/fw/po/fk/fwpofkq5njstadcz-dktv-oeokq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSOC CERTでインシデントを調査しています。</font><font style="vertical-align: inherit;">一般に、JSOCの170人全員が調査を行っていますが、最も技術的に困難なケースはCERTの専門家の手に渡ります。</font><font style="vertical-align: inherit;">たとえば、攻撃者がクリーンアップした場合にマルウェアの痕跡を検出するにはどうすればよいですか？</font><font style="vertical-align: inherit;">ロギングが適切に構成されていないファイルサーバーから重要なビジネスドキュメントを削除した「ウィザード」を見つける方法 </font><font style="vertical-align: inherit;">さて、デザートについて：攻撃者は、ネットワークに侵入することなく、関係のない多数のドメインアカウントからパスワードを取得する方法を教えてください。</font><font style="vertical-align: inherit;">いつも通り、カットの下の詳細。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平日JSOC CERT</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、お客様のネットワークの実際の妥協点を評価する必要があります。このために、次のことを実行します。 </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハードドライブとメモリイメージの遡及分析、 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルウェアリバースエンジニアリング </font></font></li>
<li>  —             .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは自由な時間に、詳細な要約、テクニック、およびプレイブックを書きます。あなたはそれらに半自動的に行動することができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時々インシデント対応中-「火事」を消している最中-「心理的サポートサービス」としても行動する必要があります。大規模な組織のサブネットへの感染対策に招待されたとき。このネットワークは2人の請負業者がサービスを提供しており、この状況では、無私</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でファンに身を投じ</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">他の何かに従事してい</font><s><font style="vertical-align: inherit;">ました</font></s><font style="vertical-align: inherit;">が、悪意のあるワームを検索していませんでした。ヒステリーの程度を減らすために、私は全員にテーブル</font><s><font style="vertical-align: inherit;">に</font></s><font style="vertical-align: inherit;">座っ</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てタオルとバーボンのボトルを手に入れなければなりませんでした</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして今は有罪を探す時ではないことを明確に説明してください。彼らは配布手順を決定し、追加の監査を開始し、体系的に感染をまとめてクリーンアップし始めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
調査中、ディスクとメモリのイメージを選択して、そこでアクティブなマルウェアを見つける必要があります。プロセスを予測可能かつ客観的にするために、ディスクを遡及的に分析するためのいくつかの方法を形式化および自動化し、すでにクラシックな</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SANS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを基礎として採用しました</font><font style="vertical-align: inherit;">-元のバージョンではそれは非常に高レベルですが、正しく使用すると、非常に高い精度でアクティブな感染を検出できます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5f/vc/fv/5fvcfvwxumpiwrynuvlo1s48f2a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのチェックを実行するには、オペレーティングシステムのさまざまなコンポーネントの機能に関する時間と深い専門知識が必要であることは明らかです（多くの特殊なソフトウェアが必要です）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクティブな感染がないかディスクを簡単にチェックする方法は？</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちはライフハックを共有しています-これは動的に（サンドボックスのように）チェックできます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">疑わしいホストのハードドライブを少しずつコピーします。</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティ</font><font style="vertical-align: inherit;">を使用して、結果のdd-imageをVMDK形式に変換し</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Virtual Box / VMwareでVMDKイメージを実行します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> トラフィックに注意を払いながら、生きているシステムのように分析します。 </font></font></li>
</ul><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、詳細な指示が書かれておらず、技術が自動化されていないインシデントが常にあります。</font></font></i></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケース1.会計士はそれとは何の関係もないか、マルウェアの検索方法 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントから会計士のコンピューターにマルウェアがないか確認するように依頼されました。誰かが不明なアドレスにいくつかの支払い注文をしました。会計士は、彼はこれに関与しておらず、コンピューターは以前に奇妙な動作をしたと主張しました。マウスは文字通り画面自体を移動することがありました-実際、私たちはこれらの表示を確認するように求められました。キャッチは、1Cを狙ったトロイの木馬がその汚い行為を行い、片付けた後、感染からほぼ1か月が経過したことです。この間、勤勉なenikeyschikがソフトウェアの束を入れ、ディスクの未割り当てスペースをこすり、それにより調査の成功の可能性を最小限に抑えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような場合は、経験豊富で細心の注意を払ったアナリストと、自動的に更新される広範な脅威インテリジェンスデータベースだけが役立ちます。</font><font style="vertical-align: inherit;">したがって、スタートアップフォルダーのスキャン中に、ウイルス対策ユーティリティとされている疑わしい更新ユーティリティを示す疑わしいラベルが注目を集めました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/ud/av/auudav_v3jtb0vqdga1r0nlca38.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、トロイの木馬のディスクからの死体は復元できませんでしたが</font><font style="vertical-align: inherit;">、同じフォルダーからリモート管理ユーティリティを起動し</font><font style="vertical-align: inherit;">たという</font><font style="vertical-align: inherit;">事実は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Superfetch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャッシュを</font><font style="vertical-align: inherit;">「誇示した」ものです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a_/6s/x4/a_6sx4vlbqcgc2n51htfy_hracq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらを事件の時間と比較すると、私たちはお金を盗んだ罪を犯したのは会計士ではなく、外部の攻撃者であることを証明しました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケース2.誰が私のファイルを削除したのですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
調査とインシデント対応のほとんどは、マルウェアの検出、マルチモジュラーユーティリティを使用した標的型攻撃、および外部の攻撃者がいる類似のストーリーに何らかの形で関連しています。しかし、時にはもっと平凡なものもありますが、それほど興味深い調査ではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントには最も一般的な古いファイルサーバーがあり、そのパブリックフォルダーには複数の部門がアクセスできました。サーバー上には、誰かが取得して削除した非常に重要なビジネスドキュメントが多数置かれていました。バックアップが過負荷になった後、私たちはそれを遅く実現しました。彼らは有罪を探し始めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どのユーザーがファイルを削除したかを判断する方法をグーグルしようとしたことがある場合、Windowsログにすべてが含まれているヒントに出会った可能性があります。事前に正しく設定している場合（ところで、すでに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかのヒントを提供</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しています）ログを構成します）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xt/jl/yv/xtjlyvwma5smm-3v3wuoxcm1kkc.png"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></i></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
しかし、実際には、ファイルシステムを監査する人はほとんどいません。多くのファイル操作があり、ログがすぐに破損し、ログを格納するために別のサーバーが必要になるため、これは一般的です...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タスクを2つに分割することにしました。まず、ファイルが削除された時期を特定します。第二に、-削除時にWHOがサーバーに接続していた。 NTFSの機能を理解している場合、このファイルシステムのほとんどの実装では、ファイルを削除すると、そのファイルが占有していたスペースが空きとしてマークされ、そのタイムスタンプは変更されないことがわかります。そのため、一見すると削除時間の設定はできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、ファイルシステムにはファイルだけでなくフォルダも含まれます。</font><font style="vertical-align: inherit;">さらに、フォルダーには特殊な属性$ INDEX_ROOTがあり、フォルダーの内容をBツリーとして記述します。</font><font style="vertical-align: inherit;">当然、ファイルを削除すると、フォルダーの$ INDEX_ROOT属性が変更され、特に$ STD_INFOの構造で、そのタイムスタンプが変更されます。</font><font style="vertical-align: inherit;">したがって、それは異常でして、ファイルやフォルダの数が多いを削除するためのおおよその時間を決定することが可能である</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MFT（メインファイルテーブル）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/op/uy/rropuy-nl7np57uum_rxa2zrgxw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイルが約削除されたとき、あなたは容疑者の輪を絞り込むためにその時点で北に働いていた人を見つけることを試みることが分かったました。</font><font style="vertical-align: inherit;">以下の方法が思い浮かびます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバー自体のログによって-イベントID 4624/4625のイベントによって、ユーザーが接続および切断したときに表示されます。</font></font></li>
<li>    — EventID 4768  ,       ;</li>
<li>  — netflow/   —  ,          smb.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの場合、このデータはもう存在していません。時間が経過しすぎたため、ログがローテーションされました。</font><font style="vertical-align: inherit;">この場合、信頼性はそれほど高くありませんが、それでもメソッド、またはレジストリキーである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://web.archive.org/web/20180427090821/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shellbagsがあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">特に、ユーザーが最後にアクセスしたフォルダの種類に関する情報（テーブル、リスト、大きいアイコン、小さいアイコン、コンテンツなど）を保存します。</font><font style="vertical-align: inherit;">そして、この同じキーにはタイムスタンプが含まれています。タイムスタンプは、フォルダーへの最後のアクセス時刻として高い信頼性で解釈できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法が見つかりました。残っているのは、必要なホストからレジストリを収集して分析することだけでした。</font><font style="vertical-align: inherit;">これを行うには、次のものが必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォルダーへのアクセス権を持つドメイングループによって決定します（この場合、約300人のユーザーがいます）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらのユーザーが作業したすべてのホストからレジストリを収集します（これを行うことはできません。ドライブを直接操作するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https：//github.com/jschicht/RawCopy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの特別なユーティリティが必要です</font><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autopsyの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのレジストリに「フィード」し、</font><font style="vertical-align: inherit;">Shellbagsプラグインを使用します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">利益！</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/aq/cb/wj/aqcbwj76a6htvj4qj4cnyddngiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
具体的には、このインシデントでは、ファイルを削除する時間は、ユーザーが削除されたフォルダーのルートにアクセスした時間と一致し、容疑者の輪を300から1に狭めることができました</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。</font><font style="vertical-align: inherit;">私たちは、少女が偶然それをしたと告白し、会社で働き続けていることだけを知っています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ケース3.パスワードマスター：数秒で「盗む」（さらに高速になる）</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃者がクライアントのネットワークに入り、VPNを介して私たちに助けを求めるとすぐに検出されました。驚くことではありません。侵入直後、彼はサブネットを脆弱性スキャナーでスキャンし始めた-チャニポットがクリスマスツリーのように点滅したからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アカウントがロックされた後、クライアントのセキュリティスタッフはVPNログの解析を開始し、攻撃者が侵入のために20を超えるドメインアカウントを使用していることを確認しました（ほとんどの場合、彼は正常にログインしましたが、一部は認証に失敗しました）。そして、論理的な疑問が生じました：彼はどのようにしてこれらのアカウントからパスワードを見つけましたか？ JSOC CERTのスタッフが回答を検索するよう招待されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前の記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査では、確率が下がったときに仮説を立ててテストする必要があるとすでに述べました。</font><font style="vertical-align: inherit;">そこで今回は、典型的なアカウントの盗難ベクトルについて説明し始めました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部サービスデータリーク</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">強引な</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミミカッツまたは類似の</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーロガー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィッシング</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NTLMハッシュハーベスト（例</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">//github.com/CylanceSPEAR/SMBTrap</font></a><font style="vertical-align: inherit;">）または同様のネットワーク攻撃。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たくさんのバージョンをチェックしましたが、攻撃のヒントさえどこにもありませんでした。調査が行き詰まっているというわけではありませんが、内なる声と常識は、何かが間違っていることを示唆しました-一歩下がって、絵をより広く見る必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、一見すると、これらのアカウントはすべて接続されていません。彼らの所有者は、地理的に離れた異なる部門の出身です。通常、重複しない一連の企業サービスを使用します。 ITリテラシーのレベルも異なります。はい、一歩下がるだけでは不十分で、もう1つ必要でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このときまでに、さまざまなエンタープライズシステムから膨大な数のログを収集し、攻撃者が残した痕跡を特定することができました。</font><font style="vertical-align: inherit;">彼らはそれがどこに現れたかを分析し始めました（私は覚えています：彼は会社の内部ネットワークを積極的にスキャンしました）。</font><font style="vertical-align: inherit;">飛んでいるエクスプロイトから均一に分散されたネットワークノイズを背景に、パスワード回復サービスへのリクエストが異常に多いことに気づきました。</font><font style="vertical-align: inherit;">インターネットからアクセスできるサービス。</font><font style="vertical-align: inherit;">うーん... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nx/b1/xk/nxb1xks2lrp7ff6p9edajqkp8fq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セキュリティイベントを監視している場合、インターネットノイズのために、外部からアクセス可能なサーバーへの攻撃を分析することは意味をなさないことがよくあります。実際に深刻な攻撃をスクリプトキディによる多数の攻撃から区別することは、一般的に簡単ではありません。</font><font style="vertical-align: inherit;">しかしいつもではない。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dj/mm/or/djmmoreaqbaebd0ecccqifgnvl4.png"><br>
<br>
<img src="https://habrastorage.org/webt/sm/eq/sn/smeqsnqlx6yodg5hytj-wr2vmts.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webサービスのログにしばらく時間を費やした後、サービスに対する次の攻撃を特定することができました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acunetixでスキャン</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLmapスキャン</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1ページへの多数のリクエスト。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目の攻撃は、一見すると、残忍なユーザーログインに似ています。</font><font style="vertical-align: inherit;">しかし、これはそうではありません。サービスがこれから保護されているためです。少なくとも、パスワードがハッシュされた形式でソルトを使用して保存されているという事実によって-それともそうではありませんか？</font><font style="vertical-align: inherit;">早急に確認する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の図は、パスワードリセットサービスを使用するための一般的なスキームを</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ng/ja/pu/ngjapuquafi2dcvswqwk1knp3xi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
示しています。パスワードが常に安全な形式で保存されるとは限らないことは興味深いです-アプリケーションが開かれた直後で、実行される前に、それらがパブリックドメインにある時点があります！</font><font style="vertical-align: inherit;">1つのページへの多数のリクエストがブルートフォースやスキャンではなく、SQLインジェクションによる高頻度のクエリであることが判明しました。その目的は、変更時にパスワードを抽出することでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、サービスへの攻撃をモデル化し、Webサーバーのログ、パスワード変更ログ、およびいくつかのネットワークデバイスからの情報を比較した後も、企業における攻撃者の侵入ポイントを見つけました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
だから、同僚、生データを掘り下げて、力があなたと一緒になるかもしれません！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jv/vp/zn/jvvpznkwwdnlfljvwthatwb0ee0.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460099/index.html">トランスフォーマー・アーキテクチャーを備えたニューラル・ネットワークへの自動機械学習の適用</a></li>
<li><a href="../ja460101/index.html">CookieベースのXSS操作| $ 2300バグバウンティストーリー</a></li>
<li><a href="../ja460107/index.html">ISPsystem、許して、さようなら！サーバーコントロールパネルを作成した理由と方法</a></li>
<li><a href="../ja460109/index.html">Angular：アプリケーションを確認する必要があるが、バックエンドの準備がまだ整っていない場合</a></li>
<li><a href="../ja460111/index.html">SAP Business One 9.3の更新バージョン：変更点</a></li>
<li><a href="../ja460115/index.html">Erlangでの10年間のプログラミング</a></li>
<li><a href="../ja460117/index.html">ロシアの最大の顧客は大きなジャックポットか頭痛の種ですか？AGIMAエクスペリエンス</a></li>
<li><a href="../ja460119/index.html">静的コード分析が使用されていないために検出できないエラー</a></li>
<li><a href="../ja460125/index.html">Node.jsまたはJava：パフォーマンス、リソース、フロー制御、人気、個人的な経験</a></li>
<li><a href="../ja460129/index.html">ロボットとイチゴ：AIがフィールドの歩留まりを向上させる方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>