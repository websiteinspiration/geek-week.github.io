<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📛 🚏 🐔 Antipatterns untuk bekerja dengan database 🧑‍🤝‍🧑 😍 🏴󠁧󠁢󠁳󠁣󠁴󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! Saya mempersembahkan kepada Anda terjemahan artikel saya “Basis Data: Anti-Pola” . 
 
 Jika Anda menyimpan data, ini adalah bagian penting...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Antipatterns untuk bekerja dengan database</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487622/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo, Habr! </font><font style="vertical-align: inherit;">Saya mempersembahkan kepada Anda terjemahan artikel saya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Basis Data: Anti-Pola”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda menyimpan data, ini adalah bagian penting dari aplikasi Anda. </font><font style="vertical-align: inherit;">Anda dapat dengan mudah dan cepat memperbaiki bug di situs kencan baru sehingga petani Joe dari Texas Utara akhirnya dapat membaca pesan terakhir dari kekasih penpal dan mengetahui bahwa dia menyukai pria botak. </font><font style="vertical-align: inherit;">Tapi Tuhan melarang Anda kehilangan atau merusak data pengguna. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/e2d/e07/3a3/e2de073a3ff6c38cf29617834cd2cd42.png" alt="gambar"><br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lembah Silikon, Musim 2, Episode 8</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, banyak pengembang tidak sepenuhnya memahami kebenaran sederhana ini. </font><font style="vertical-align: inherit;">Saya belum menjadi programmer profesional selama bertahun-tahun, tetapi saya telah melihat banyak kesalahan yang dibuat oleh orang yang bekerja dengan database. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inilah beberapa yang langsung muncul di pikiran.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kurangnya cadangan</font></font></h2><br>
<img src="https://habrastorage.org/getpro/habr/post_images/727/d48/742/727d487423bf0fb28b5a497d58cb2169.jpg" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Buat cadangan" adalah salah satu aturan itu (seperti "jangan bekerja di bawah root" atau "kencangkan sabuk pengaman Anda") yang banyak dari kita setuju dengan tetapi tidak mengikuti mereka, berharap hal-hal buruk terjadi pada orang lain dan bukan kepada kita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Omong-omong, jika Anda tidak menguji pemulihan dari cadangan, Anda dapat mengasumsikan bahwa Anda tidak memiliki cadangan sama sekali. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Belajar dari kesalahan orang lain</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan kata lain, dari lima teknologi cadangan, tidak ada yang bekerja dengan andal atau tidak dikonfigurasi. </font><font style="vertical-align: inherit;">Pada akhirnya, kami mengembalikan data dari cadangan yang dibuat 6 jam yang lalu.</font></font></blockquote><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami kehilangan data database dalam 6 jam (masalah, menggabungkan permintaan, pengguna, komentar, cuplikan, dll.) Dengan GitLab.com.</font></font></blockquote><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NoSQL</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kebetulan </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengguna Anda memiliki terlalu banyak konten dewasa dan mereka terlalu sering menontonnya.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jumlah data terlalu besar atau beban terlalu tinggi untuk ditangani oleh basis data relasional. </font><font style="vertical-align: inherit;">Ini adalah kasus ketika teknologi NoSQL ikut bermain. </font><font style="vertical-align: inherit;">Raksasa perangkat lunak seperti Google terbiasa dengan ini secara langsung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda bukan Google</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Beberapa ratus gigabytes bukan "data besar", tetapi 1000 komentar per hari bukanlah "beban tinggi". </font><font style="vertical-align: inherit;">Kemungkinan besar PostgreSQL sudah cukup untuk data Anda. </font><font style="vertical-align: inherit;">Lihat: bahkan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mendukung JSON dan dapat mengindeksnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayo, apakah Anda serius ingin mengorbankan struktur yang dapat diandalkan untuk fitur yang tidak Anda butuhkan dan - hadapi itu - tidak akan pernah dibutuhkan? </font><font style="vertical-align: inherit;">Anda tidak akan menjadi Google baru - Anda hanya memiliki kekacauan di database.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skema yang terlalu longgar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini lebih relevan untuk NoSQL, tetapi pengguna DBMS relasional sering lupa atau terlalu malas untuk membuat semua pembatasan yang diperlukan. </font><font style="vertical-align: inherit;">Karena kesalahan dalam kode aplikasi, itu </font></font><code>NULL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat disimpan di mana nilai yang berarti diharapkan, atau tautan ke entri yang hilang dapat dibuat. </font><font style="vertical-align: inherit;">Selanjutnya, Anda memperhatikan ini dan memperbaiki kodenya, tetapi Anda tidak tahu cara memperbaiki data.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kunci primer alami</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bayangkan kami ingin menyimpan pengguna, yang masing-masing harus memiliki email unik. </font><font style="vertical-align: inherit;">Solusi yang paling jelas adalah membuat tabel </font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan kolom </font></font><code>email</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang juga akan menjadi kunci utama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, kunci alami mungkin menjadi tidak dapat diterima sebagai yang utama ketika persyaratan berubah (dan selalu berubah). </font><font style="vertical-align: inherit;">Hari ini </font></font><code>PRIMARY KEY(email)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berfungsi, dan besok kami memutuskan untuk menambahkan pendaftaran melalui Facebook dan menjadikan email opsional. </font><font style="vertical-align: inherit;">Mana yang lebih baik: buat alamat unik dan tambahkan bendera yang menunjukkan email fiktif, atau ubah kunci utama, semua kunci asing yang merujuk ke </font></font><code>user</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dll., Dll.? </font><font style="vertical-align: inherit;">Kita tidak harus memilih kejahatan yang lebih sedikit jika kita hanya menggunakan kunci primer pengganti.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logika dalam Penyimpanan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak suka ini karena dua alasan:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode aplikasi biasanya jauh lebih mudah untuk diperbarui daripada skema database.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua SQL PL ini mengingatkan saya pada Pascal, dan mereka juga jelek.</font></font></li>
</ol><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skrip migrasi khusus lingkungan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tahu bahwa kadang-kadang tidak ada pilihan, tetapi secara umum lebih baik untuk mencoba memastikan bahwa semua lingkungan (dev, test, prod, dll.) Adalah semirip mungkin. </font><font style="vertical-align: inherit;">Semakin besar perbedaan antara lingkungan, semakin besar kemungkinan untuk membuat kesalahan dan menemukannya hanya pada prod. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Biasanya bahkan skrip DML bisa universal. </font><font style="vertical-align: inherit;">Skema yang berbeda, lebih sering daripada tidak, adalah kejahatan murni. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, ketika saya melihat label khusus lingkungan dalam skrip liquibase, saya ingin membunuh.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script Migrasi Toleransi</font></font></h2><br>
<code>IF NOT EXISTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan hal-hal serupa di DDL tidak diperlukan jika dalam semua lingkungan skema identik, tetapi dapat menutupi kesalahan. </font><font style="vertical-align: inherit;">Jika sesuatu yang tidak terduga terjadi selama pembaruan basis data, saya lebih memilih untuk mengetahuinya dan memperbaikinya sesegera mungkin, daripada memutar otak saya seminggu kemudian, bagaimana cara memperbaiki kekacauan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembaruan non-atom</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalkan Anda menjalankan changeset pada basis produksi dan migrasi tidak berhasil. Anda memperbaiki sesuatu dan ingin mencoba lagi. Apakah ini akan berhasil? Bagaimana jika beberapa operasi changeset dilakukan, sementara yang lain tidak? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda mungkin memperhatikan bahwa ini sebenarnya adalah cerita yang berubah- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus </font><i><font style="vertical-align: inherit;">idempoten</font></i><font style="vertical-align: inherit;"> , dan Anda akan benar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, banyak pengembang, memikirkan idempotensi, penggunaan </font></font><code>IF NOT EXISTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau semacamnya. Di bagian sebelumnya, saya menjelaskan mengapa ini jahat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alih-alih, buat perubahan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atom</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian, jika terjadi kesalahan, perubahan yang dilakukan akan dibatalkan dan Anda tidak akan memiliki masalah dengan aplikasi berikutnya dari perubahan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun berhati-hatilah saat mengandalkan transaksi. Contohnya,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dukungan untuk ekspresi DDL dalam transaksi MySQL gelap dan penuh kengerian</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi saya selalu membuat perubahan yang terpisah untuk setiap ekspresi DDL ketika saya menulis skrip Liquibase untuk MySQL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antipattern apa yang Anda lihat?</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487606/index.html">Visualisasi garis-garis ketegangan dan gerakan muatan elektrostatik, simulasi gerakan planet tata surya</a></li>
<li><a href="../id487610/index.html">RealWorld: aiohttp, Tortoise ORM</a></li>
<li><a href="../id487612/index.html">Menambahkan, menghapus, dan mengganti nama file serta tujuan dengan mudah dalam proyek-proyek CMake</a></li>
<li><a href="../id487616/index.html">Membuat item khusus menggunakan tabel contoh di C # untuk Windows Form</a></li>
<li><a href="../id487620/index.html">Pemecahan masalah dengan pwnable.kr 27 - tiny_easy. Memahami Stack Spraying</a></li>
<li><a href="../id487626/index.html">Cara kerja sensor parkir dan cara menipunya</a></li>
<li><a href="../id487628/index.html">Diagnosis penuaan berdasarkan 9 tanda tanda penuaan</a></li>
<li><a href="../id487630/index.html">Algoritma Sederhana untuk Membuat Puzzle Lapangan (Bagian 1)</a></li>
<li><a href="../id487632/index.html">“Kolega, bernapas lebih tenang”: mengapa kebisingan kantor membuat kita gila - kita membahas penelitian</a></li>
<li><a href="../id487636/index.html">API yang akhirnya layak ditingkatkan dari Java 8. Bagian 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>