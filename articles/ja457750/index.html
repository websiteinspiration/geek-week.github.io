<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙋 🧜🏿 👳 Symfony 4でJSON RPCを操作する 🤱 👵 🍔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは。今日は、Symfony 4、JSON RPC、OpenAPI 3で友達を作る方法についてお話します。
 

この記事は初心者を対象としていません。Symfony、Dependency Injection、およびその他の「怖い」ものを扱う方法をすでに理解しているはずです。
 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Symfony 4でJSON RPCを操作する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457750/"><p><img src="https://habrastorage.org/webt/g1/j9/qj/g1j9qjsv7kj71sq2w-eraxp1ol0.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">みなさん、こんにちは。今日は、Symfony 4、JSON RPC、OpenAPI 3で友達を作る方法についてお話します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事は初心者を対象としていません。Symfony、Dependency Injection、およびその他の「怖い」ものを扱う方法をすでに理解しているはずです。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日は、JSON RPCの特定の実装を見てみましょう。</font></font></p><a name="habracut"></a><br>
<h2 id="realizacii"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実装</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symfonyには多くのJSON RPC実装があり、特に：</font></font></p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wasinger / jsonrpc-bundle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">timiki / rpc-server-bundle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoFusion / JsonRpcBundle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insidestyles / json-rpc-bundle</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://github.com/yoanm/symfony-jsonrpc-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">symfony-jsonrpc-http-server</font></font></a></li>
</ul><br>
<p>        .    ,    . </p><br>
<p>        (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">yoanm/php-jsonrpc-server-sdk</a>),    Symfony,    ,     ,  ,         .</p><br>
<h2 id="ustanovka"></h2><br>
<p>   symfony/skeleton.</p><br>
<pre><code class="bash hljs">$ composer create-project symfony/skeleton jsonrpc</code></pre><br>
<p>   .</p><br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> jsonrpc</code></pre><br>
<p>   .</p><br>
<pre><code class="bash hljs">$ composer require yoanm/symfony-jsonrpc-http-server</code></pre><br>
<p>.</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-keyword">return</span> [<font></font>
    ...<font></font>
    Symfony\Bundle\FrameworkBundle\FrameworkBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    Yoanm\SymfonyJsonRpcHttpServer\JsonRpcHttpServerBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    ...<font></font>
];</code></pre><br>
<pre><code class="plaintext hljs"># config/routes.yaml<font></font>
json-rpc-endpoint:<font></font>
    resource: '@JsonRpcHttpServerBundle/Resources/config/routing/endpoint.xml'</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/json_rpc.yaml<font></font>
json_rpc_http_server: ~</code></pre><br>
<p> ,      .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/MappingCollector.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodAwareInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MappingCollector</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">JsonRpcMethodAwareInterface</span>
</span>{
   <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> JsonRpcMethodInterface[] */</span>
   <span class="hljs-keyword">private</span> $mappingList = [];<font></font>
<font></font>
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addJsonRpcMethod</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> $methodName, JsonRpcMethodInterface $method</span>): <span class="hljs-title">void</span>
   </span>{
       <span class="hljs-keyword">$this</span>-&gt;mappingList[$methodName] = $method;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-comment">/**
    * <span class="hljs-doctag">@return</span> JsonRpcMethodInterface[]
    */</span>
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMappingList</span>(<span class="hljs-params"></span>) : <span class="hljs-title">array</span>
   </span>{
       <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;mappingList;<font></font>
   }<font></font>
}</code></pre><br>
<p>    services.yaml.</p><br>
<pre><code class="plaintext hljs"># config/services.yaml<font></font>
services:<font></font>
    ...<font></font>
    mapping_aware_service:<font></font>
        class: App\MappingCollector<font></font>
        tags: ['json_rpc_http_server.method_aware']<font></font>
    ...</code></pre><br>
<h2 id="realizaciya-metodov"> </h2><br>
<p> JSON RPC       services.yaml.     ping.</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Method/PingMethod.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Method</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PingMethod</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">JsonRpcMethodInterface</span>
</span>{
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $paramList = <span class="hljs-literal">null</span></span>)
   </span>{
       <span class="hljs-keyword">return</span> <span class="hljs-string">'pong'</span>;<font></font>
   }<font></font>
}</code></pre><br>
<p>   . </p><br>
<pre><code class="plaintext hljs"># config/services.yaml<font></font>
services:<font></font>
    ...<font></font>
    App\Method\PingMethod:<font></font>
        public: false<font></font>
        tags: [{ method: 'ping', name: 'json_rpc_http_server.jsonrpc_method' }]<font></font>
    ...</code></pre><br>
<p>    Symfony.</p><br>
<pre><code class="bash hljs">$ symfony serve</code></pre><br>
<p>  .</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/json-rpc'</span> --data-binary <span class="hljs-string">'[{ "jsonrpc":"2.0","method":"ping","params":[],"id" : 1 }]'</span></code></pre><br>
<pre><code class="json hljs">[<font></font>
  {<font></font>
    <span class="hljs-attr">"jsonrpc"</span>: <span class="hljs-string">"2.0"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"result"</span>: <span class="hljs-string">"pong"</span><font></font>
  }<font></font>
]</code></pre><br>
<p>  ,  .      .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Method/ParamsMethod.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Method</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParamsMethod</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">JsonRpcMethodInterface</span>
</span>{
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $paramList = <span class="hljs-literal">null</span></span>)
   </span>{
       <span class="hljs-keyword">return</span> $paramList;<font></font>
   }<font></font>
}</code></pre><br>
<pre><code class="plaintext hljs"># config/services.yaml<font></font>
services:<font></font>
    ...<font></font>
    App\Method\ParamsMethod:<font></font>
   public: false<font></font>
   tags: [{ method: 'params', name: 'json_rpc_http_server.jsonrpc_method' }]<font></font>
    ...</code></pre><br>
<p> .</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/json-rpc'</span> --data-binary <span class="hljs-string">'[{ "jsonrpc":"2.0","method":"params","params":{"name":"John","age":21},"id" : 1 }]'</span></code></pre><br>
<pre><code class="json hljs">[<font></font>
  {<font></font>
    <span class="hljs-attr">"jsonrpc"</span>: <span class="hljs-string">"2.0"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"result"</span>: {
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"John"</span>,
      <span class="hljs-attr">"age"</span>: <span class="hljs-number">21</span><font></font>
    }<font></font>
  }<font></font>
]</code></pre><br>
<h2 id="validaciya-vhodnyh-dannyh-metoda">   </h2><br>
<p>       ,       <em>yoanm/symfony-jsonrpc-params-validator</em>.</p><br>
<pre><code class="bash hljs">$ composer require yoanm/symfony-jsonrpc-params-validator</code></pre><br>
<p> .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-keyword">return</span> [<font></font>
    ...<font></font>
    Yoanm\SymfonyJsonRpcParamsValidator\JsonRpcParamsValidatorBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    ...<font></font>
];</code></pre><br>
<p>,          <em>Yoanm\JsonRpcParamsSymfonyValidator\Domain\MethodWithValidatedParamsInterface</em>.    <em>ParamsMethod</em>.</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Method/ParamsMethod.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Method</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraint</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Choice</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Collection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Length</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">NotBlank</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Optional</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Positive</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Required</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcParamsSymfonyValidator</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">MethodWithValidatedParamsInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodInterface</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParamsMethod</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">JsonRpcMethodInterface</span>, <span class="hljs-title">MethodWithValidatedParamsInterface</span>
</span>{
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $paramList = <span class="hljs-literal">null</span></span>)
   </span>{
       <span class="hljs-keyword">return</span> $paramList;<font></font>
   }<font></font>
<font></font>
   <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getParamsConstraint</span>(<span class="hljs-params"></span>) : <span class="hljs-title">Constraint</span>
   </span>{
       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Collection([<span class="hljs-string">'fields'</span> =&gt; [
           <span class="hljs-string">'name'</span> =&gt; <span class="hljs-keyword">new</span> Required([
               <span class="hljs-keyword">new</span> Length([<span class="hljs-string">'min'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">32</span>])<font></font>
           ]),<font></font>
           <span class="hljs-string">'age'</span> =&gt; <span class="hljs-keyword">new</span> Required([
               <span class="hljs-keyword">new</span> Positive()<font></font>
           ]),<font></font>
           <span class="hljs-string">'sex'</span> =&gt; <span class="hljs-keyword">new</span> Optional([
               <span class="hljs-keyword">new</span> Choice([<span class="hljs-string">'f'</span>, <span class="hljs-string">'m'</span>])<font></font>
           ]),<font></font>
       ]]);<font></font>
   }<font></font>
}</code></pre><br>
<p>         ,      .</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/json-rpc'</span> --data-binary <span class="hljs-string">'[{"jsonrpc":"2.0","method":"params","params":[],"id" : 1 }]'</span></code></pre><br>
<pre><code class="json hljs">[<font></font>
  {<font></font>
    <span class="hljs-attr">"jsonrpc"</span>: <span class="hljs-string">"2.0"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"error"</span>: {
      <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32602</span>,
      <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Invalid params"</span>,
      <span class="hljs-attr">"data"</span>: {
        <span class="hljs-attr">"violations"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"path"</span>: <span class="hljs-string">"[name]"</span>,
            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"This field is missing."</span>,
            <span class="hljs-attr">"code"</span>: <span class="hljs-string">"2fa2158c-2a7f-484b-98aa-975522539ff8"</span><font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"path"</span>: <span class="hljs-string">"[age]"</span>,
            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"This field is missing."</span>,
            <span class="hljs-attr">"code"</span>: <span class="hljs-string">"2fa2158c-2a7f-484b-98aa-975522539ff8"</span><font></font>
          }<font></font>
        ]<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
]</code></pre><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/json-rpc'</span> --data-binary <span class="hljs-string">'[{"jsonrpc":"2.0","method":"params","params":{"name":"John","age":-1},"id" : 1 }]'</span></code></pre><br>
<pre><code class="json hljs">[<font></font>
  {<font></font>
    <span class="hljs-attr">"jsonrpc"</span>: <span class="hljs-string">"2.0"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"error"</span>: {
      <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32602</span>,
      <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Invalid params"</span>,
      <span class="hljs-attr">"data"</span>: {
        <span class="hljs-attr">"violations"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"path"</span>: <span class="hljs-string">"[age]"</span>,
            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"This value should be positive."</span>,
            <span class="hljs-attr">"code"</span>: <span class="hljs-string">"778b7ae0-84d3-481a-9dec-35fdb64b1d78"</span><font></font>
          }<font></font>
        ]<font></font>
      }<font></font>
    }<font></font>
  }</code></pre><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/json-rpc'</span> --data-binary <span class="hljs-string">'[{ "jsonrpc":"2.0","method":"params","params":{"name":"John","age":21,"sex":"u"},"id" : 1 }]'</span>  </code></pre><br>
<pre><code class="json hljs">[<font></font>
  {<font></font>
    <span class="hljs-attr">"jsonrpc"</span>: <span class="hljs-string">"2.0"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"error"</span>: {
      <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32602</span>,
      <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Invalid params"</span>,
      <span class="hljs-attr">"data"</span>: {
        <span class="hljs-attr">"violations"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"path"</span>: <span class="hljs-string">"[sex]"</span>,
            <span class="hljs-attr">"message"</span>: <span class="hljs-string">"The value you selected is not a valid choice."</span>,
            <span class="hljs-attr">"code"</span>: <span class="hljs-string">"8e179f1b-97aa-4560-a02f-2a8b42e49df7"</span><font></font>
          }<font></font>
        ]<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
]</code></pre><br>
<h2 id="avtodokumentaciya"></h2><br>
<p>  .</p><br>
<pre><code class="bash hljs">composer require yoanm/symfony-jsonrpc-http-server-doc</code></pre><br>
<p> .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-keyword">return</span> [<font></font>
    ...<font></font>
    Yoanm\SymfonyJsonRpcHttpServerDoc\JsonRpcHttpServerDocBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    ...<font></font>
];</code></pre><br>
<pre><code class="plaintext hljs"># config/routes.yaml<font></font>
...<font></font>
json-rpc-endpoint-doc:<font></font>
  resource: '@JsonRpcHttpServerDocBundle/Resources/config/routing/endpoint.xml'</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/json_rpc.yaml<font></font>
...<font></font>
json_rpc_http_server_doc: ~</code></pre><br>
<p>     JSON .</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/doc'</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="json hljs">{
  <span class="hljs-attr">"methods"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"identifier"</span>: <span class="hljs-string">"Params"</span>,
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"params"</span><font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"identifier"</span>: <span class="hljs-string">"Ping"</span>,
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"ping"</span><font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"errors"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"ParseError-32700"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Parse error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32700</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"InvalidRequest-32600"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Invalid request"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32600</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"MethodNotFound-32601"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Method not found"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32601</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"ParamsValidationsError-32602"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Params validations error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32602</span>,
        <span class="hljs-attr">"data"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"siblings"</span>: {
            <span class="hljs-attr">"violations"</span>: {
              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
              <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span><font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"InternalError-32603"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Internal error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32603</span>,
        <span class="hljs-attr">"data"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">"siblings"</span>: {
            <span class="hljs-attr">"previous"</span>: {
              <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Previous error message"</span>,
              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
              <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span><font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"http"</span>: {
    <span class="hljs-attr">"host"</span>: <span class="hljs-string">"127.0.0.1:8000"</span><font></font>
  }<font></font>
}</code></pre></div></div><br>
<p>   ?     ?        <em>yoanm/symfony-jsonrpc-params-sf-constraints-doc</em>.</p><br>
<pre><code class="bash hljs">$ composer require yoanm/symfony-jsonrpc-params-sf-constraints-doc</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-keyword">return</span> [<font></font>
    ...<font></font>
    Yoanm\SymfonyJsonRpcParamsSfConstraintsDoc\JsonRpcParamsSfConstraintsDocBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    ...<font></font>
];</code></pre><br>
<p>   ,   JSON    .</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/doc'</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="json hljs">{
  <span class="hljs-attr">"methods"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"identifier"</span>: <span class="hljs-string">"Params"</span>,
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"params"</span>,
      <span class="hljs-attr">"params"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"siblings"</span>: {
          <span class="hljs-attr">"name"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"minLength"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-attr">"maxLength"</span>: <span class="hljs-number">32</span><font></font>
          },<font></font>
          <span class="hljs-attr">"age"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span><font></font>
          },<font></font>
          <span class="hljs-attr">"sex"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">"allowedValues"</span>: [
              <span class="hljs-string">"f"</span>,
              <span class="hljs-string">"m"</span><font></font>
            ]<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"identifier"</span>: <span class="hljs-string">"Ping"</span>,
      <span class="hljs-attr">"name"</span>: <span class="hljs-string">"ping"</span><font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"errors"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"ParseError-32700"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Parse error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32700</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"InvalidRequest-32600"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Invalid request"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32600</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"MethodNotFound-32601"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Method not found"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32601</span><font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"ParamsValidationsError-32602"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Params validations error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32602</span>,
        <span class="hljs-attr">"data"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"siblings"</span>: {
            <span class="hljs-attr">"violations"</span>: {
              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
              <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span>,
              <span class="hljs-attr">"item_validation"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"siblings"</span>: {
                  <span class="hljs-attr">"path"</span>: {
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">"example"</span>: <span class="hljs-string">"[key]"</span><font></font>
                  },<font></font>
                  <span class="hljs-attr">"message"</span>: {
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span><font></font>
                  },<font></font>
                  <span class="hljs-attr">"code"</span>: {
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span><font></font>
                  }<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    },<font></font>
    {<font></font>
      <span class="hljs-attr">"id"</span>: <span class="hljs-string">"InternalError-32603"</span>,
      <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Internal error"</span>,
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">-32603</span>,
        <span class="hljs-attr">"data"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">"siblings"</span>: {
            <span class="hljs-attr">"previous"</span>: {
              <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Previous error message"</span>,
              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
              <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">"required"</span>: <span class="hljs-literal">false</span><font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"http"</span>: {
    <span class="hljs-attr">"host"</span>: <span class="hljs-string">"127.0.0.1:8000"</span><font></font>
  }<font></font>
}</code></pre></div></div><br>
<h3 id="openapi-3">OpenAPI 3</h3><br>
<p> ,  JSON      OpenAPI 3,   <em>yoanm/symfony-jsonrpc-http-server-openapi-doc</em>.</p><br>
<pre><code class="bash hljs">$ composer require yoanm/symfony-jsonrpc-http-server-openapi-doc</code></pre><br>
<p>.</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-keyword">return</span> [<font></font>
    ...<font></font>
    Yoanm\SymfonyJsonRpcHttpServerOpenAPIDoc\JsonRpcHttpServerOpenAPIDocBundle::class =&gt; [<span class="hljs-string">'all'</span> =&gt; <span class="hljs-literal">true</span>],<font></font>
    ...<font></font>
];</code></pre><br>
<p>  ,   JSON    OpenApi 3.</p><br>
<pre><code class="bash hljs">$ curl <span class="hljs-string">'http://127.0.0.1:8000/doc/openapi.json'</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="json hljs">{
  <span class="hljs-attr">"openapi"</span>: <span class="hljs-string">"3.0.0"</span>,
  <span class="hljs-attr">"servers"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"url"</span>: <span class="hljs-string">"http:\/\/127.0.0.1:8000"</span><font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"paths"</span>: {
    <span class="hljs-attr">"\/Params\/..\/json-rpc"</span>: {
      <span class="hljs-attr">"post"</span>: {
        <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"\"params\" json-rpc method"</span>,
        <span class="hljs-attr">"operationId"</span>: <span class="hljs-string">"Params"</span>,
        <span class="hljs-attr">"requestBody"</span>: {
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"content"</span>: {
            <span class="hljs-attr">"application\/json"</span>: {
              <span class="hljs-attr">"schema"</span>: {
                <span class="hljs-attr">"allOf"</span>: [<font></font>
                  {<font></font>
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                    <span class="hljs-attr">"required"</span>: [
                      <span class="hljs-string">"jsonrpc"</span>,
                      <span class="hljs-string">"method"</span><font></font>
                    ],<font></font>
                    <span class="hljs-attr">"properties"</span>: {
                      <span class="hljs-attr">"id"</span>: {
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"req_id"</span>,
                        <span class="hljs-attr">"oneOf"</span>: [<font></font>
                          {<font></font>
                            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                          },<font></font>
                          {<font></font>
                            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
                          }<font></font>
                        ]<font></font>
                      },<font></font>
                      <span class="hljs-attr">"jsonrpc"</span>: {
                        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2.0"</span><font></font>
                      },<font></font>
                      <span class="hljs-attr">"method"</span>: {
                        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                      },<font></font>
                      <span class="hljs-attr">"params"</span>: {
                        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Method parameters"</span><font></font>
                      }<font></font>
                    }<font></font>
                  },<font></font>
                  {<font></font>
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                    <span class="hljs-attr">"required"</span>: [
                      <span class="hljs-string">"params"</span><font></font>
                    ],<font></font>
                    <span class="hljs-attr">"properties"</span>: {
                      <span class="hljs-attr">"params"</span>: {
                        <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/Method-Params-RequestParams"</span><font></font>
                      }<font></font>
                    }<font></font>
                  },<font></font>
                  {<font></font>
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                    <span class="hljs-attr">"properties"</span>: {
                      <span class="hljs-attr">"method"</span>: {
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"params"</span><font></font>
                      }<font></font>
                    }<font></font>
                  }<font></font>
                ]<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        },<font></font>
        <span class="hljs-attr">"responses"</span>: {
          <span class="hljs-attr">"200"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSON-RPC response"</span>,
            <span class="hljs-attr">"content"</span>: {
              <span class="hljs-attr">"application\/json"</span>: {
                <span class="hljs-attr">"schema"</span>: {
                  <span class="hljs-attr">"allOf"</span>: [<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"required"</span>: [
                        <span class="hljs-string">"jsonrpc"</span><font></font>
                      ],<font></font>
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"id"</span>: {
                          <span class="hljs-attr">"example"</span>: <span class="hljs-string">"req_id"</span>,
                          <span class="hljs-attr">"oneOf"</span>: [<font></font>
                            {<font></font>
                              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
                            }<font></font>
                          ]<font></font>
                        },<font></font>
                        <span class="hljs-attr">"jsonrpc"</span>: {
                          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                          <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2.0"</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"result"</span>: {
                          <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Result"</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"error"</span>: {
                          <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Error"</span><font></font>
                        }<font></font>
                      }<font></font>
                    },<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"result"</span>: {
                          <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Method result"</span><font></font>
                        }<font></font>
                      }<font></font>
                    },<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"error"</span>: {
                          <span class="hljs-attr">"oneOf"</span>: [<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-ParseError-32700"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-InvalidRequest-32600"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-MethodNotFound-32601"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-ParamsValidationsError-32602"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-InternalError-32603"</span><font></font>
                            }<font></font>
                          ]<font></font>
                        }<font></font>
                      }<font></font>
                    }<font></font>
                  ]<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    },<font></font>
    <span class="hljs-attr">"\/Ping\/..\/json-rpc"</span>: {
      <span class="hljs-attr">"post"</span>: {
        <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"\"ping\" json-rpc method"</span>,
        <span class="hljs-attr">"operationId"</span>: <span class="hljs-string">"Ping"</span>,
        <span class="hljs-attr">"requestBody"</span>: {
          <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">"content"</span>: {
            <span class="hljs-attr">"application\/json"</span>: {
              <span class="hljs-attr">"schema"</span>: {
                <span class="hljs-attr">"allOf"</span>: [<font></font>
                  {<font></font>
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                    <span class="hljs-attr">"required"</span>: [
                      <span class="hljs-string">"jsonrpc"</span>,
                      <span class="hljs-string">"method"</span><font></font>
                    ],<font></font>
                    <span class="hljs-attr">"properties"</span>: {
                      <span class="hljs-attr">"id"</span>: {
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"req_id"</span>,
                        <span class="hljs-attr">"oneOf"</span>: [<font></font>
                          {<font></font>
                            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                          },<font></font>
                          {<font></font>
                            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
                          }<font></font>
                        ]<font></font>
                      },<font></font>
                      <span class="hljs-attr">"jsonrpc"</span>: {
                        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2.0"</span><font></font>
                      },<font></font>
                      <span class="hljs-attr">"method"</span>: {
                        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                      },<font></font>
                      <span class="hljs-attr">"params"</span>: {
                        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Method parameters"</span><font></font>
                      }<font></font>
                    }<font></font>
                  },<font></font>
                  {<font></font>
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                    <span class="hljs-attr">"properties"</span>: {
                      <span class="hljs-attr">"method"</span>: {
                        <span class="hljs-attr">"example"</span>: <span class="hljs-string">"ping"</span><font></font>
                      }<font></font>
                    }<font></font>
                  }<font></font>
                ]<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        },<font></font>
        <span class="hljs-attr">"responses"</span>: {
          <span class="hljs-attr">"200"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSON-RPC response"</span>,
            <span class="hljs-attr">"content"</span>: {
              <span class="hljs-attr">"application\/json"</span>: {
                <span class="hljs-attr">"schema"</span>: {
                  <span class="hljs-attr">"allOf"</span>: [<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"required"</span>: [
                        <span class="hljs-string">"jsonrpc"</span><font></font>
                      ],<font></font>
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"id"</span>: {
                          <span class="hljs-attr">"example"</span>: <span class="hljs-string">"req_id"</span>,
                          <span class="hljs-attr">"oneOf"</span>: [<font></font>
                            {<font></font>
                              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
                            }<font></font>
                          ]<font></font>
                        },<font></font>
                        <span class="hljs-attr">"jsonrpc"</span>: {
                          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                          <span class="hljs-attr">"example"</span>: <span class="hljs-string">"2.0"</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"result"</span>: {
                          <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Result"</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"error"</span>: {
                          <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Error"</span><font></font>
                        }<font></font>
                      }<font></font>
                    },<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"result"</span>: {
                          <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Method result"</span><font></font>
                        }<font></font>
                      }<font></font>
                    },<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"error"</span>: {
                          <span class="hljs-attr">"oneOf"</span>: [<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-ParseError-32700"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-InvalidRequest-32600"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-MethodNotFound-32601"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-ParamsValidationsError-32602"</span><font></font>
                            },<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/ServerError-InternalError-32603"</span><font></font>
                            }<font></font>
                          ]<font></font>
                        }<font></font>
                      }<font></font>
                    }<font></font>
                  ]<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">"components"</span>: {
    <span class="hljs-attr">"schemas"</span>: {
      <span class="hljs-attr">"Method-Params-RequestParams"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"required"</span>: [
          <span class="hljs-string">"name"</span>,
          <span class="hljs-string">"age"</span><font></font>
        ],<font></font>
        <span class="hljs-attr">"properties"</span>: {
          <span class="hljs-attr">"name"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"minLength"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-attr">"maxLength"</span>: <span class="hljs-number">32</span><font></font>
          },<font></font>
          <span class="hljs-attr">"age"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span><font></font>
          },<font></font>
          <span class="hljs-attr">"sex"</span>: {
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"enum"</span>: [
              <span class="hljs-string">"f"</span>,
              <span class="hljs-string">"m"</span><font></font>
            ]<font></font>
          }<font></font>
        }<font></font>
      },<font></font>
      <span class="hljs-attr">"ServerError-ParseError-32700"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Parse error"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">-32700</span><font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      },<font></font>
      <span class="hljs-attr">"ServerError-InvalidRequest-32600"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Invalid request"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">-32600</span><font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      },<font></font>
      <span class="hljs-attr">"ServerError-MethodNotFound-32601"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Method not found"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">-32601</span><font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      },<font></font>
      <span class="hljs-attr">"ServerError-ParamsValidationsError-32602"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Params validations error"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"data"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">-32602</span><font></font>
              },<font></font>
              <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"properties"</span>: {
                  <span class="hljs-attr">"violations"</span>: {
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"array"</span>,
                    <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">"items"</span>: {
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                      <span class="hljs-attr">"required"</span>: [
                        <span class="hljs-string">"path"</span>,
                        <span class="hljs-string">"message"</span><font></font>
                      ],<font></font>
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"path"</span>: {
                          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                          <span class="hljs-attr">"example"</span>: <span class="hljs-string">"[key]"</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"message"</span>: {
                          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span><font></font>
                        },<font></font>
                        <span class="hljs-attr">"code"</span>: {
                          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                          <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span><font></font>
                        }<font></font>
                      }<font></font>
                    }<font></font>
                  }<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      },<font></font>
      <span class="hljs-attr">"ServerError-InternalError-32603"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Internal error"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">-32603</span><font></font>
              },<font></font>
              <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">"properties"</span>: {
                  <span class="hljs-attr">"previous"</span>: {
                    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Previous error message"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span><font></font>
                  }<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}</code></pre></div></div><br>
<h3 id="dokumentaciya-otveta-metoda">  </h3><br>
<p>  (   ),      , .   ,    ,    .</p><br>
<p> .</p><br>
<pre><code class="plaintext hljs"># config/services.yaml<font></font>
services:<font></font>
    ...<font></font>
    App\Listener\MethodDocListener:<font></font>
        tags:<font></font>
            - name: 'kernel.event_listener'<font></font>
              event: 'json_rpc_http_server_doc.method_doc_created'<font></font>
              method: 'enhanceMethodDoc'<font></font>
            - name: 'kernel.event_listener'<font></font>
              event: 'json_rpc_http_server_openapi_doc.array_created'<font></font>
              method: 'enhanceDoc'<font></font>
    ...</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Listener/MethodDocListener.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Listener</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodWithDocInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">ErrorDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">SymfonyJsonRpcHttpServerDoc</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">MethodDocCreatedEvent</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">SymfonyJsonRpcHttpServerOpenAPIDoc</span>\<span class="hljs-title">Event</span>\<span class="hljs-title">OpenAPIDocCreatedEvent</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodDocListener</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enhanceMethodDoc</span>(<span class="hljs-params">MethodDocCreatedEvent  $event</span>) : <span class="hljs-title">void</span>
    </span>{<font></font>
        $method = $event-&gt;getMethod();<font></font>
<font></font>
        <span class="hljs-keyword">if</span> ($method <span class="hljs-keyword">instanceof</span> JsonRpcMethodWithDocInterface) {<font></font>
            $doc = $event-&gt;getDoc();<font></font>
            $doc-&gt;setResultDoc($method-&gt;getDocResponse());<font></font>
<font></font>
            <span class="hljs-keyword">foreach</span> ($method-&gt;getDocErrors() <span class="hljs-keyword">as</span> $error) {
                <span class="hljs-keyword">if</span> ($error <span class="hljs-keyword">instanceof</span> ErrorDoc) {<font></font>
                    $doc-&gt;addCustomError($error);<font></font>
                }<font></font>
            }<font></font>
<font></font>
            $doc-&gt;setDescription($method-&gt;getDocDescription());<font></font>
            $doc-&gt;addTag($method-&gt;getDocTag());<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enhanceDoc</span>(<span class="hljs-params">OpenAPIDocCreatedEvent $event</span>)
    </span>{<font></font>
        $doc = $event-&gt;getOpenAPIDoc();<font></font>
<font></font>
        $doc[<span class="hljs-string">'info'</span>] = [
            <span class="hljs-string">'title'</span> =&gt; <span class="hljs-string">'Main title'</span>,
            <span class="hljs-string">'version'</span> =&gt; <span class="hljs-string">'1.0.0'</span>,
            <span class="hljs-string">'description'</span> =&gt; <span class="hljs-string">'Main description'</span><font></font>
        ];<font></font>
<font></font>
        $event-&gt;setOpenAPIDoc($doc);<font></font>
    }<font></font>
}</code></pre><br>
<p>,  ,        ,  ,      .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Domain/JsonRpcMethodWithDocInterface.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Domain</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">ErrorDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TypeDoc</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">JsonRpcMethodWithDocInterface</span>
</span>{
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> TypeDoc
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocResponse</span>(<span class="hljs-params"></span>): <span class="hljs-title">TypeDoc</span></span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> ErrorDoc[]
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocErrors</span>(<span class="hljs-params"></span>): <span class="hljs-title">array</span></span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocDescription</span>(<span class="hljs-params"></span>): <span class="hljs-title">string</span></span>;<font></font>
<font></font>
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> string
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocTag</span>(<span class="hljs-params"></span>): <span class="hljs-title">string</span></span>;<font></font>
}</code></pre><br>
<p>   ,       .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// src/Method/UserMethod.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">App</span>\<span class="hljs-title">Method</span>;<font></font>
<font></font>
<span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodWithDocInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraint</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Choice</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Collection</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Length</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">NotBlank</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Optional</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Positive</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Symfony</span>\<span class="hljs-title">Component</span>\<span class="hljs-title">Validator</span>\<span class="hljs-title">Constraints</span>\<span class="hljs-title">Required</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcParamsSymfonyValidator</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">MethodWithValidatedParamsInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServer</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">JsonRpcMethodInterface</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">ErrorDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">ArrayDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">NumberDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">ObjectDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">StringDoc</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Yoanm</span>\<span class="hljs-title">JsonRpcServerDoc</span>\<span class="hljs-title">Domain</span>\<span class="hljs-title">Model</span>\<span class="hljs-title">Type</span>\<span class="hljs-title">TypeDoc</span>;<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMethod</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">JsonRpcMethodInterface</span>, <span class="hljs-title">MethodWithValidatedParamsInterface</span>, <span class="hljs-title">JsonRpcMethodWithDocInterface</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apply</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> $paramList = <span class="hljs-literal">null</span></span>)
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'name'</span> =&gt; $paramList[<span class="hljs-string">'name'</span>],
            <span class="hljs-string">'age'</span> =&gt; $paramList[<span class="hljs-string">'age'</span>],
            <span class="hljs-string">'sex'</span> =&gt; $paramList[<span class="hljs-string">'sex'</span>] ?? <span class="hljs-literal">null</span>,<font></font>
        ];<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getParamsConstraint</span>(<span class="hljs-params"></span>) : <span class="hljs-title">Constraint</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Collection([<span class="hljs-string">'fields'</span> =&gt; [
            <span class="hljs-string">'name'</span> =&gt; <span class="hljs-keyword">new</span> Required([
                <span class="hljs-keyword">new</span> Length([<span class="hljs-string">'min'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'max'</span> =&gt; <span class="hljs-number">32</span>])<font></font>
            ]),<font></font>
            <span class="hljs-string">'age'</span> =&gt; <span class="hljs-keyword">new</span> Required([
                <span class="hljs-keyword">new</span> Positive()<font></font>
            ]),<font></font>
            <span class="hljs-string">'sex'</span> =&gt; <span class="hljs-keyword">new</span> Optional([
                <span class="hljs-keyword">new</span> Choice([<span class="hljs-string">'f'</span>, <span class="hljs-string">'m'</span>])<font></font>
            ]),<font></font>
        ]]);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocDescription</span>(<span class="hljs-params"></span>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'User method'</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocTag</span>(<span class="hljs-params"></span>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'main'</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocErrors</span>(<span class="hljs-params"></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> ErrorDoc(<span class="hljs-string">'Error 1'</span>, <span class="hljs-number">1</span>)];<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDocResponse</span>(<span class="hljs-params"></span>): <span class="hljs-title">TypeDoc</span>
    </span>{<font></font>
        $response = <span class="hljs-keyword">new</span> ObjectDoc();<font></font>
        $response-&gt;setNullable(<span class="hljs-literal">false</span>);<font></font>
<font></font>
        $response-&gt;addSibling((<span class="hljs-keyword">new</span> StringDoc())<font></font>
            -&gt;setNullable(<span class="hljs-literal">false</span>)<font></font>
            -&gt;setDescription(<span class="hljs-string">'Name of user'</span>)<font></font>
            -&gt;setName(<span class="hljs-string">'name'</span>)<font></font>
        );<font></font>
<font></font>
        $response-&gt;addSibling((<span class="hljs-keyword">new</span> NumberDoc())<font></font>
            -&gt;setNullable(<span class="hljs-literal">false</span>)<font></font>
            -&gt;setDescription(<span class="hljs-string">'Age of user'</span>)<font></font>
            -&gt;setName(<span class="hljs-string">'age'</span>)<font></font>
        );<font></font>
<font></font>
        $response-&gt;addSibling((<span class="hljs-keyword">new</span> StringDoc())<font></font>
            -&gt;setNullable(<span class="hljs-literal">true</span>)<font></font>
            -&gt;setDescription(<span class="hljs-string">'Sex of user'</span>)<font></font>
            -&gt;setName(<span class="hljs-string">'sex'</span>)<font></font>
        );<font></font>
<font></font>
        <span class="hljs-keyword">return</span> $response;<font></font>
    }<font></font>
}</code></pre><br>
<p>    .</p><br>
<pre><code class="plaintext hljs">services:<font></font>
    ...<font></font>
    App\Method\UserMethod:<font></font>
        public: false<font></font>
        tags: [{ method: 'user', name: 'json_rpc_http_server.jsonrpc_method' }]<font></font>
    ...</code></pre><br>
<p>     <em>/doc/openapi.json</em>,   .</p><br>
<pre><code class="bash hljs">curl <span class="hljs-string">'http://127.0.0.1:8000/doc/openapi.json'</span></code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><pre><code class="json hljs">{
  <span class="hljs-attr">"openapi"</span>: <span class="hljs-string">"3.0.0"</span>,
  <span class="hljs-attr">"servers"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"url"</span>: <span class="hljs-string">"http:\/\/127.0.0.1:8000"</span><font></font>
    }<font></font>
  ],<font></font>
  <span class="hljs-attr">"paths"</span>: {<font></font>
    ...<font></font>
    <span class="hljs-attr">"\/User\/..\/json-rpc"</span>: {
      <span class="hljs-attr">"post"</span>: {
        <span class="hljs-attr">"summary"</span>: <span class="hljs-string">"\"user\" json-rpc method"</span>,
        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"User method"</span>,
        <span class="hljs-attr">"tags"</span>: [
          <span class="hljs-string">"main"</span><font></font>
        ],<font></font>
        ...        <font></font>
        <span class="hljs-attr">"responses"</span>: {
          <span class="hljs-attr">"200"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSON-RPC response"</span>,
            <span class="hljs-attr">"content"</span>: {
              <span class="hljs-attr">"application\/json"</span>: {
                <span class="hljs-attr">"schema"</span>: {
                  <span class="hljs-attr">"allOf"</span>: [<font></font>
                    ...<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"result"</span>: {
                          <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/Method-User-Result"</span><font></font>
                        }<font></font>
                      }<font></font>
                    },<font></font>
                    {<font></font>
                      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                      <span class="hljs-attr">"properties"</span>: {
                        <span class="hljs-attr">"error"</span>: {
                          <span class="hljs-attr">"oneOf"</span>: [<font></font>
                            {<font></font>
                              <span class="hljs-attr">"$ref"</span>: <span class="hljs-string">"#\/components\/schemas\/Error-Error11"</span><font></font>
                            },<font></font>
                            ...<font></font>
                          ]<font></font>
                        }<font></font>
                      }<font></font>
                    }<font></font>
                  ]<font></font>
                }<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">"components"</span>: {
    <span class="hljs-attr">"schemas"</span>: {<font></font>
      ...<font></font>
      <span class="hljs-attr">"Method-User-Result"</span>: {
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"properties"</span>: {
          <span class="hljs-attr">"name"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Name of user"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">false</span><font></font>
          },<font></font>
          <span class="hljs-attr">"age"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Age of user"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">false</span><font></font>
          },<font></font>
          <span class="hljs-attr">"sex"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Sex of user"</span>,
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-attr">"nullable"</span>: <span class="hljs-literal">true</span><font></font>
          }<font></font>
        }<font></font>
      },<font></font>
      <span class="hljs-attr">"Error-Error11"</span>: {
        <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Error 1"</span>,
        <span class="hljs-attr">"allOf"</span>: [<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span>,
              <span class="hljs-string">"message"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span><font></font>
              },<font></font>
              <span class="hljs-attr">"message"</span>: {
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span><font></font>
              }<font></font>
            }<font></font>
          },<font></font>
          {<font></font>
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">"required"</span>: [
              <span class="hljs-string">"code"</span><font></font>
            ],<font></font>
            <span class="hljs-attr">"properties"</span>: {
              <span class="hljs-attr">"code"</span>: {
                <span class="hljs-attr">"example"</span>: <span class="hljs-number">1</span><font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        ]<font></font>
      },<font></font>
      ...<font></font>
    }<font></font>
  },<font></font>
  <span class="hljs-attr">"info"</span>: {
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Main title"</span>,
    <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Main description"</span><font></font>
  }<font></font>
}</code></pre></div></div><br>
<h3 id="vizualizaciya-json-dokumentacii"> JSON </h3><br>
<p>JSON  ,        .  /doc/openapi.json     ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Swagger Editor</a>. </p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/m-/qj/kk/m-qjkkisgq5t593cakydxv1bw_u.png"></a></p><br>
<p>    Swagger UI    .   <em>harmbandstra/swagger-ui-bundle</em>.</p><br>
<p>      composer.json .</p><br>
<pre><code class="json hljs">    <span class="hljs-string">"scripts"</span>: {
        <span class="hljs-attr">"auto-scripts"</span>: {
            <span class="hljs-attr">"cache:clear"</span>: <span class="hljs-string">"symfony-cmd"</span>,
            <span class="hljs-attr">"assets:install %PUBLIC_DIR%"</span>: <span class="hljs-string">"symfony-cmd"</span><font></font>
        },<font></font>
        <span class="hljs-attr">"post-install-cmd"</span>: [
            <span class="hljs-string">"HarmBandstra\\SwaggerUiBundle\\Composer\\ScriptHandler::linkAssets"</span>,
            <span class="hljs-string">"@auto-scripts"</span><font></font>
        ],<font></font>
        <span class="hljs-attr">"post-update-cmd"</span>: [
            <span class="hljs-string">"HarmBandstra\\SwaggerUiBundle\\Composer\\ScriptHandler::linkAssets"</span>,
            <span class="hljs-string">"@auto-scripts"</span><font></font>
        ]<font></font>
    },</code></pre><br>
<p>  .</p><br>
<pre><code class="bash hljs">$ composer require harmbandstra/swagger-ui-bundle</code></pre><br>
<p> .</p><br>
<pre><code class="php hljs"><span class="hljs-comment">// config/bundles.php</span>
<span class="hljs-meta">&lt;?php</span><font></font>
<font></font>
<span class="hljs-keyword">return</span> [
    <span class="hljs-comment">// ...</span>
    HarmBandstra\SwaggerUiBundle\HBSwaggerUiBundle::class =&gt; [<span class="hljs-string">'dev'</span> =&gt; <span class="hljs-literal">true</span>]<font></font>
];</code></pre><br>
<pre><code class="plaintext hljs"># config/routes.yaml<font></font>
_swagger-ui:<font></font>
    resource: '@HBSwaggerUiBundle/Resources/config/routing.yml'<font></font>
    prefix: /docs</code></pre><br>
<pre><code class="plaintext hljs"># config/packages/hb_swagger_ui.yaml<font></font>
hb_swagger_ui:<font></font>
  directory: "http://127.0.0.1:8000"<font></font>
  files:<font></font>
    - "/doc/openapi.json"</code></pre><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで、リンク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://127.0.0.1:8000/docs/を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たどると、</font><font style="vertical-align: inherit;">ドキュメントが美しい形式で取得されます。</font></font></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/yb/eu/i9/ybeui9nnpnliltn-4nwy956q0ha.png"></a></p><br>
<h2 id="itogi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての操作の結果として、Symfony 4に基づいた実用的なJSON RPCと、Swagger UIを使用した視覚化を備えたOpenAPIの自動ドキュメントを取得しました。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ありがとうございます。</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja457736/index.html">「ツールは、それが作成するシステムについて考える能力ほど重要ではありません。」マーティンクレップマンへのインタビュー</a></li>
<li><a href="../ja457738/index.html">SD-Accessの実装方法とそれが必要な理由</a></li>
<li><a href="../ja457742/index.html">高可用性とインフラストラクチャの可用性のためのKubernetesとPrometheusの炉床の水平方向の自動スケーリング</a></li>
<li><a href="../ja457744/index.html">Qtライブラリでの拡張システムの作成-パート2</a></li>
<li><a href="../ja457746/index.html">気象学とフライト</a></li>
<li><a href="../ja457752/index.html">月面探査機やジョーカーではありません。福島のロボットについて知っていること</a></li>
<li><a href="../ja457754/index.html">Государство и Т-киллеры</a></li>
<li><a href="../ja457756/index.html">アクションの本カフカストリーム。リアルタイムアプリケーションとマイクロサービス»</a></li>
<li><a href="../ja457758/index.html">エンジニアは森で失われた人々を救うが、森はまだ降伏していない</a></li>
<li><a href="../ja457760/index.html">コンテナーをさらに分離する方法：コンテナーサンドボックステクノロジーのレビュー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>