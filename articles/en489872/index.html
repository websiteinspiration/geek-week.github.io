<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚛️ 🏴󠁧󠁢󠁷󠁬󠁳󠁿 🤨 How the DLP system and the OCR module prevented employees from falsifying passport scans 🏴 👩🏻‍✈️ 🍵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remember the story of the leak of passport data from 500 million customers of the Marriott hotel chain? The attackers could have found the data, and t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How the DLP system and the OCR module prevented employees from falsifying passport scans</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/abbyy/blog/489872/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remember the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">story of the leak of passport data</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from 500 million customers of the Marriott hotel chain? The attackers could have found the data, and the hotel group even promised to pay the cost of changing passports to the affected guests. There are many similar cases. It’s clear why: today more than </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50% of companies</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> store more than half of their documents in the form of scans, screenshots, and PDF. Three years ago </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, no more than a third of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such documents were in organizations </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">.</font></a><font style="vertical-align: inherit;"> According to a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new survey by SearchInform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , 51% of companies said that the number of documents in image format increased.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recently, most often leaks in the form of images are subjected to legally relevant documents, for example, contracts. In second place in the “risk group” are financial documents: balance sheets, profit and loss statements and so on. The loss of such data not only threatens reputational risks for the company, but can also lead to disruption of transactions. To protect important data from outsiders and intruders, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - information leakage prevention </font><font style="vertical-align: inherit;">systems are installed in the company's information systems </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already spoke on Habr</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about how "SearchInform Information Security Circuit" (CIB) and the OCR module based on the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">ABBYY FineReader Engine</font></a><font style="vertical-align: inherit;"> technology product</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Now, together with the employees of the SearchInform product implementation department, we have collected four stories about leaks of different types of data through corporate and personal mailboxes. </font><font style="vertical-align: inherit;">And we figured out how to identify them using the DLP system with the OCR module.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cs/rx/2c/csrx2cjgzv6wpckia6nu02iy4pa.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-3/ng/jh/-3ngjh1c81sewz8qdctsylm4bcm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In one travel company, an employee sent files in graphic format to personal mail. </font></font><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using ABBYY technologies, it was possible to establish that the attachments were </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scans of passports</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and this is a gross violation of the work with identity documents. In addition, this was a serious violation of the security policy of this travel company. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How exactly did it turn out that the graphic files were scans of passports? Using the built-in OCR technologies, the DLP system recognized the text on the scan, analyzed it and determined that the document had a passport number. There are other characteristics that are peculiar only to passports, for example, the presence of phrases such as “Passport issued”, “Department code”, etc. in the document. Moreover, to recognize a number of documents, including passports, the DLP system uses the ABBYY classifier. He refines the work of OCR technologies, and this ultimately improves the accuracy of the result.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Specialists of the IB service began to investigate the incident and found out that confidential files were transferred from under the account of the company’s designer, from his computer. All documents had similar names - “Scans”, “Scans_new”, “Scans_1”: </font><font style="vertical-align: inherit;">
Recording from the monitor of the designer workstation in the mode of separate screenshots, which the MonitorController module of the DLP system makes, showed that the designer worked in Photoshop with passport scans. He cut out photos from them and then inserted new ones instead:</font></font><br>
 <br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/is/ea/vj/iseavjkxrqfq0q1lbt9bnlxdu-o.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7x/0-/xw/7x0-xwingyjhsgoftdsnkgqdeys.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After analyzing all the actions of the designer, the security service found that the employee forged scans of documents. High-quality fakes could be used to register in Internet services when an attacker does not want to “shine” his real identity. It would be difficult for automatic verification systems to determine the authenticity of information in such images. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, technology helped to track the situation with data leakage and fake passport scans. Thanks to this, the company eliminated the risk of harming its reputation.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/py/fp/hu/pyfphund1mctnuzt9nqlsfpda0q.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/q8/-h/km/q8-hkmxnnmnexhlznouanh0tp2c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The petrochemicals company kept hand-filled </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">questionnaires with employee data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The DLP system recorded the fact of sending these questionnaires outside the organization: the security policy for sending personal data worked. </font><font style="vertical-align: inherit;">
The DLP system gave a signal due to the fact that the built-in OCR module is able to work with handwritten text and recognize it with an accuracy of over 88%. This is done using a structural classifier. In more detail about technologies of intelligent character recognition ABBYY - intelligent character recognition (ICR) - we </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">already told on Habré</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/ct/bb/iu/ctbbiuidbp0k5n6nc84e3vxnv-i.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The presence of personal data in the questionnaires became a signal for checking the incident. It turned out that the questionnaires also contained telephones, as well as detailed information about the health status of employees. If the data is leaking, then someone needs it. For example, they may be of interest to those who advertise medical services and engage in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">social engineering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Scans of profiles could easily be in the public domain and this would lead to irreparable consequences. Attackers could extract this data and thereby harm not only employees, but also the reputation of the entire company. In this case, the employee whose questionnaire was in the wrong hands could complain to the labor inspectorate, Roskomnadzor or tell about the story on social networks.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The complexity of this case is that far from all technologies can recognize handwritten text, but the OCR ABBYY module can do this. </font><font style="vertical-align: inherit;">We give an example. </font><font style="vertical-align: inherit;">Below is a hand-filled questionnaire:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rz/nl/r1/rznlr1dqipi2xi3_g8u88fbdu-e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And the result of recognition of such a profile: </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/np/h_/io/nph_io102napw_yrswm06e3wcc0.png"></div><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zc/mw/cl/zcmwclme309uvrqehmbc7957klu.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cm/qc/lq/cmqclqyyioxn1kdotdfauqsrovc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ABBYY's text recognition module helped uncover industrial espionage patterns. </font><font style="vertical-align: inherit;">One of the hired top managers of the company, who moved to Russia from abroad, sent graphic files from his personal mail to his former colleagues. </font><font style="vertical-align: inherit;">The DLP system has discovered this fact. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to the OCR module, the DLP system extracted text from photographs and found out that the employee was sending out </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photos of technical documentation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the current developments of the company. </font><font style="vertical-align: inherit;">Then DLP analyzed the texts using the “search for similar” algorithm. </font><font style="vertical-align: inherit;">He is able to identify texts that are close in content or even meaning to a standard.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The difficulty was that the confidential documents were in the language of one of the CIS countries. But both the DLP system and the OCR module can work with this language. The OCR module recognizes documents in 210 languages ​​(in printed text format) and 126 languages ​​(in handwritten format) - for example, languages ​​with alphabets based on Latin, Cyrillic, Greek and Armenian characters and many others. You can even work with documents in mixed languages, if, for example, words in the CIS language and names in English are used there.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, all technical documentation contains many tables, drawings, graphs and diagrams. Often you need to understand what is written in them, since this information can play a significant role. The OCR module recognizes tables and other complex structures in documents well. Thanks to this, he can extract all the information from the graphs, for example, to understand whether the data is current or already outdated.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The DLP system signaled a leak of technical documentation to the IB service staff, they analyzed the incident and confirmed that the signal was not false and the photo was really taken from confidential documents. As a result, verification of the working correspondence of this manager began. Information security experts found that he was merging his friends abroad with valuable data that competitors from another state could use (spoiler: and use it). For example, in his letters there was an informal conversation with boasting about how “his friends will conquer the market first and go around everyone”, including the company in which the top manager worked at that time.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But the story does not end there. The security service continued to investigate this case, using the capabilities of the DLP system. The program helped to find correspondence with customers. It turned out that the top manager opened his own legal entity and passed it off as an authorized service center of the "native" company. He took part of the repair orders from the employer, but at the same time used not new, but discarded parts. This led to customer complaints about the main company and a loss of reputation. Firstly, the company lost its competitive advantage, and secondly, it didn’t receive profit, as orders left.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xv/3w/er/xv3werxwk0zbqb55kge2czzeshm.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4a/qf/i_/4aqfi_ue-kpepoqlj_kh5fcra0s.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The head of the engineering department of a large company issued a sick leave certificate. This fact would not have attracted attention if the security policy that fixes the forwarding of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">air tickets had</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not worked out earlier in the DLP system </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
The fact is that earlier a letter was sent to the employee's mail with a graphic attachment in PDF format. Thanks to the OCR module, the text on the PDF was recognized,</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/hw/db/tp/hwdbtpczfwpp-7ebbgibmn5518o.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uh/mz/va/uhmzvau91vdbfjpiyy_se4c8t6u.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0u/sm/sv/0usmsv_pfzm59kf9zbstq4-1uh4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
and the DLP phrase search analytic module specified that the attached file is a ticket. This was done using a set of phrases, which is characteristic only for electronic tickets, for example, “departure time”, “booking code”, “flight”, “electronic ticket”, etc. As a result, it turned out that the dates of the flight coincided with the sick leave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A further investigation showed that the head of the engineering department was going to another city for an interview, which was confirmed by his further correspondence with HR competitors, which the security service found and analyzed. Thus, the DLP system helped the company management put the situation under special control and prepare for the dismissal of the employee. It was possible to stop the potential leak of important data to competitors and maintain the continuity of the work process at the enterprise.</font></font><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the cases are different, but in all cases, documents can be recognized and analyzed. </font><font style="vertical-align: inherit;">If you have examples of unusual document leaks in the form of images or photographs, share them in the comments. </font><font style="vertical-align: inherit;">We will help to sort these situations out.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en489858/index.html">Internationalization: Making the Web Accessible to Everyone</a></li>
<li><a href="../en489860/index.html">The history of Telefunken: the phoenix of German electronics from Wilhelm II and Goebbels to the Beatles and today</a></li>
<li><a href="../en489862/index.html">Planning in Go: Part II - The Go Scheduler</a></li>
<li><a href="../en489868/index.html">Freezing Mozilla WebThings</a></li>
<li><a href="../en489870/index.html">Free offline intensive by Node.js in Nizhny Novgorod</a></li>
<li><a href="../en489874/index.html">Cross compiling Rust for Windows executables from Linux</a></li>
<li><a href="../en489876/index.html">How we solved the problem of three monoliths</a></li>
<li><a href="../en489878/index.html">How to help find an organization and not spend a week on it</a></li>
<li><a href="../en489880/index.html">Code review - improving the process</a></li>
<li><a href="../en489882/index.html">Reducing the response time when transmitting data over UDP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>