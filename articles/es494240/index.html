<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥜 🍊 👌 Personalización de sandbox: por qué la necesitas ahora 🦄 🆘 🤰🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La cuestión de personalizar las imágenes de sandbox ha sido relevante desde su inicio. Las primeras versiones de dichos programas eran soluciones inte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Personalización de sandbox: por qué la necesitas ahora</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/494240/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/w0/kd/as/w0kdasxxfgrntuq6bpubjtse6ym.png"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La cuestión de personalizar las imágenes de sandbox ha sido relevante desde su inicio. </font><font style="vertical-align: inherit;">Las primeras versiones de dichos programas eran soluciones internas de las empresas de seguridad de la información, pero incluso entonces era necesario un ajuste minucioso de máquinas aisladas. </font><font style="vertical-align: inherit;">Y no fue solo la instalación de software auxiliar para monitorear el estado del sistema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Incluso hace 10 años, la lógica de recopilar y procesar características ambientales estaba integrada en muestras maliciosas: nombre de usuario y computadora, dominio doméstico o corporativo, derechos de administrador, diseño del idioma, número de núcleos de procesador, versión del sistema operativo, presencia de software antivirus, signos de virtualización e incluso la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presencia de actualizaciones en sistema</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hasta la fecha, el número de parámetros y métodos para obtenerlos solo ha aumentado.</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sandbox Bypass Técnicas de malware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, el enfoque era bastante sencillo: si el malware verifica al usuario con la prueba de nombre, lo llamaremos John; si usamos la clave de registro SYSTEM \ CurrentControlSet \ Enum \ SCSI \ Disk &amp; Ven_VMware_ &amp; Prod_VMware_Virtual_S para averiguar si estamos en un entorno virtual, entonces (si es posible) reemplazaremos la clave o los resultados devueltos interceptando la llamada. Como resultado de numerosos estudios, se reclutó una cierta base de conocimiento de métodos de detección de derivación, que luego se utilizó para configurar el entorno. Pasaron los años, los creadores de virus ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y no solo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) comenzaron a utilizar cada vez más este conocimiento en su trabajo, lo que finalmente llevó a lo siguiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pregunta "¿Es este un entorno de investigación?" </font><font style="vertical-align: inherit;">fue reemplazado por "¿Es interesante el medio ambiente?" </font><font style="vertical-align: inherit;">Y el interés no está en encontrar rastros de algún cliente FTP para el robo de datos posterior. </font><font style="vertical-align: inherit;">Ahora, si esta es la máquina de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un empleado de contabilidad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que usa un software específico, entonces otra cosa. </font><font style="vertical-align: inherit;">Hay otros enfoques: infecte al usuario con un cargador de arranque liviano que recopile toda la información necesaria sobre el sistema, la envíe al servidor de administración y ... no reciba la carga útil en respuesta. </font><font style="vertical-align: inherit;">La lógica de servidor desconocida ha decidido que esta víctima no es de interés.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Así vemos: los sandboxes configurados por defecto no son una solución comercial efectiva. </font><font style="vertical-align: inherit;">Los atacantes dependen cada vez más de la autodefensa contra la detección, sino de reducir el rango de búsqueda de objetivos interesantes para el desarrollo posterior del ataque.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Cómo luchamos contra ellos?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En palabras simples, ofrecemos hacer una imagen única de un entorno aislado. </font><font style="vertical-align: inherit;">El objetivo es recrear un entorno que sea lo más similar posible a la estación de trabajo de un empleado, con acceso atractivo para los atacantes: un departamento de finanzas, un servidor de compilación para una integración continua durante el desarrollo, un servidor web, una máquina de administrador de dominio y, finalmente, la estación del CEO.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, para tal tarea, puede liberar una serie de espacios en blanco con el software "a bordo" apropiado, pero luego debe comenzar con datos específicos que correspondan a una organización en particular: el nombre de dominio, los recursos o aplicaciones utilizados, los nombres y el contenido de los documentos de trabajo: cuantos más matices, mejor . </font><font style="vertical-align: inherit;">A veces, el entorno debe ajustarse con precisión, hasta las versiones y parches de actualización del sistema. </font><font style="vertical-align: inherit;">En el caso más simple, la imagen se puede hacer simplemente "llena de agujeros". </font><font style="vertical-align: inherit;">Sin embargo, si su parque de infraestructura de TI no es anterior a ciertas versiones, esto también se puede tener en cuenta y eliminar muchos vectores de penetración irrelevantes que utilizan un cierto número de vulnerabilidades.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtenemos una imagen desconocida para los creadores de virus, que realmente les interesa y, por lo tanto, aumenta enormemente la probabilidad de detectar un ataque dirigido.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Por qué necesito emular el trabajo de una computadora "en vivo"? </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La emulación de las acciones del usuario es imprescindible, sin lo cual el sandbox pierde su efectividad. </font><font style="vertical-align: inherit;">En algunos casos, la ausencia de acciones conducirá a la detección de la presencia en el entorno limitado: por ejemplo, si el cursor del mouse no cambia su posición durante mucho tiempo, no aparecen nuevas ventanas, no se finalizan las aplicaciones o se lanzan muy pocas, si no aparecen nuevos archivos en directorios temporales, no actividad de red. </font><font style="vertical-align: inherit;">En otras situaciones, esto afectará el funcionamiento del malware en sí: por ejemplo, para ejecutarlo, se requiere el consentimiento del usuario para incluir macros en el documento de Office, o el troyano mostrará un cuadro de diálogo intermedio en el que será necesario estar de acuerdo con algo (o desde algo rechazar) para continuar su trabajo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A veces, las acciones insignificantes son simplemente necesarias: el usuario debe abrir algún documento y escribir algo o copiar la contraseña en el portapapeles para obtener más información; es precisamente en esos momentos que un troyano espía puede funcionar, lo que interceptará datos importantes y los enviará al servidor de su autor.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Cómo se hace esto con nosotros?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestra solución se repone gradualmente con nuevas acciones que emulan el trabajo de un usuario vivo. </font><font style="vertical-align: inherit;">Por supuesto, las secuencias predefinidas de eventos planificados de cualquier complejidad nunca se pueden comparar con la variedad de uso real. </font><font style="vertical-align: inherit;">Continuamos investigando y mejorando este lado del producto, aumentando su efectividad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Además de las funciones descritas anteriormente, vale la pena señalar una característica fundamental: nuestro entorno limitado pertenece a la clase de los agentes sin agente. En la mayoría de las soluciones, hay un agente auxiliar dentro de la máquina virtual que es responsable de administrar el estado del sistema, recibir y transmitir eventos y artefactos interesantes al servidor host. A pesar de las ventajas en el monitoreo y el claro principio de interacción entre el host y las máquinas invitadas, esta solución tiene un inconveniente significativo: la necesidad de ocultar y proteger los objetos asociados con el agente del malware. En el caso de que no haya un proveedor de eventos, surge la pregunta: ¿cómo, entonces, obtener información sobre lo que sucede dentro de la máquina virtual? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para esto utilizamos la tecnología </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabla de página extendida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(EPT) Intel Corporation. </font><font style="vertical-align: inherit;">Es una página de memoria intermedia que se encuentra entre la memoria física del invitado y la memoria física del host. </font><font style="vertical-align: inherit;">En resumen, esto le permite hacer lo siguiente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">examinar la visualización de las páginas de memoria de la máquina invitada;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resaltar secciones interesantes (por ejemplo, que contienen direcciones o códigos de funciones nucleares);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marque las páginas seleccionadas para que los derechos de acceso a las páginas de memoria en el EPT no coincidan con los derechos de acceso a las páginas en la máquina invitada;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para captar el atractivo de las secciones de memoria marcadas (en este momento se producirá un error de acceso (#PF), como resultado, la máquina invitada se suspenderá);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analizar el estado, extraer la información necesaria sobre el evento;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rediseñar la página de memoria en el estado correcto;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">restaurar la máquina invitada.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El monitoreo de todo lo que sucede se lleva a cabo fuera de la máquina aislada. El malware que está dentro no puede detectar el hecho de la observación. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecutar una muestra en el sandbox y analizar su comportamiento es solo uno de los componentes de un producto complejo. Después de comenzar, la memoria del proceso se escanea en busca de código malicioso, se registra la actividad de la red, que luego se analiza utilizando más de 5000 reglas de detección. Además, es posible descifrar interacciones seguras.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos los indicadores de compromiso (COI), que pudieron identificarse durante el estudio, se verifican mediante listas de reputación. </font><font style="vertical-align: inherit;">Antes de someterse a un análisis dinámico, la muestra se envía para procesamiento estático: se filtra previamente en varios antivirus y se escanea por nuestro propio motor con reglas de detección de expertos del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">centro de seguridad experto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (PT Expert Security Center). </font><font style="vertical-align: inherit;">Utilizamos un examen exhaustivo, incluso para identificar anomalías en la metainformación y los artefactos integrados de la muestra.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Qué tareas hace PT Sandbox mejor y por qué?</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT Sandbox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> combina el conocimiento y la experiencia de varios equipos y productos para contrarrestar los ataques dirigidos. </font><font style="vertical-align: inherit;">A pesar de que el producto se puede utilizar en el modo de contrarrestar amenazas (prevención), sigue siendo principalmente un medio para monitorear (detectar) la seguridad de los sistemas de TI. </font><font style="vertical-align: inherit;">La diferencia clave con las soluciones de protección de punto final clásicas es que la tarea de PT Sandbox es prestar atención a las anomalías y registrar una amenaza previamente desconocida. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publicado por</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alexey Vishnyakov, Especialista Senior, Grupo de Investigación de Tecnologías de Amenaza, Tecnologías Positivas</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es494228/index.html">Impresión 3D en la creación del Boeing 777</a></li>
<li><a href="../es494230/index.html">AI vs. COVID-19: Experiencia Hubei y Florida</a></li>
<li><a href="../es494232/index.html">¿Por qué hay errores en el cerebro?</a></li>
<li><a href="../es494234/index.html">Una selección de cascos VR para aplicaciones industriales.</a></li>
<li><a href="../es494238/index.html">Lecciones aprendidas en 3 años de trabajo remoto para permanecer en una mente sobria y memoria brillante</a></li>
<li><a href="../es494242/index.html">Ninja Bayesiano</a></li>
<li><a href="../es494244/index.html">Intercambio y gestión de riesgos: 5 consejos para diversificar su cartera de inversiones</a></li>
<li><a href="../es494252/index.html">Impresión 3D: tres casas y media en cuatro días.</a></li>
<li><a href="../es494254/index.html">OpenShift como una versión empresarial de Kubernetes</a></li>
<li><a href="../es494256/index.html">¿Quién más necesita selenio? ¿Alguien usa BDD en 2020? Machine Learning en Selenium</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>