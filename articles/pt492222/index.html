<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßú ‚öñÔ∏è üçû Artigo: CTFZone Quals 2019: Chicken üëºüèæ üë®üèø‚Äçü§ù‚Äçüë®üèæ üêØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apesar do adiamento da confer√™ncia OFFZONE 2020 , haver√° uma final da CTFZone ! Este ano, ser√° realizado pela primeira vez online e ser√° transmitido a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Artigo: CTFZone Quals 2019: Chicken</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bizone/blog/492222/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apesar do adiamento da confer√™ncia </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OFFZONE 2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haver√°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uma </font><font style="vertical-align: inherit;">final da </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">CTFZone</font></a><font style="vertical-align: inherit;"> ! </font><font style="vertical-align: inherit;">Este ano, ser√° realizado pela primeira vez online e ser√° transmitido ativamente nas redes sociais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anunciaremos os detalhes mais tarde, mas, por enquanto, sugerimos explorar a inicializa√ß√£o da webtask a partir da fase de qualifica√ß√£o. </font><font style="vertical-align: inherit;">A an√°lise da solu√ß√£o foi enviada por </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Devand MacLean</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do Canad√°. </font><font style="vertical-align: inherit;">Especialmente para Habr, traduzimos o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">texto da startup local</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e convidamos voc√™ a descobrir qual cadeia de vulnerabilidades os participantes encontraram e o que a galinha tem a ver com isso.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/kw/um/qqkwum4pqnrjnrgqxa9__wofqec.png"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informa√ß√£o geral</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autor da tarefa:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pavel Sorokin </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pontos:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 470 </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√∫mero de equipes que resolveram a tarefa:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font><br>
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Links √öteis:</font></font></b></p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://gchq.github.io/CyberChef/</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/directory-structure?view=aspnetcore-3.0</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://jakeydocs.readthedocs.io/en/latest/tutorials/first-mvc-app/adding-view.html</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/0xd4d/dnSpy/releases</a></li>
</ul><br>
<h2> </h2><br>
<p>  , - :</p><br>
<ul>
<li>  <b><font color="#ff0000">(/Home/Index)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Home/Hens)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Home/Contact)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Auth/Login)</font></b>.</li>
</ul><br>
<p>, &nbsp; ,   :</p><br>
<ul>
<li>    ;</li>
<li>  &nbsp;API  ,  &nbsp; .</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A p√°gina / Home / Hens cont√©m links para fazer o download de ‚Äúpassaportes‚Äù de frango.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7n/nc/1n/7nnc1nhfmbr0yfkok8ra-hqi1fo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s decodificar o Base64, encontramos o par√¢metro filename: 1.txt. </font><font style="vertical-align: inherit;">Usando o CyberChef, codificamos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / passwd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na Base64 e seguimos o link: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://web-chicken.ctfz.one/File/Download?filename=L2V0Yy9wYXNzd2Q=</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O conte√∫do do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo / etc / passwd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no servidor √© </font><font style="vertical-align: inherit;">aberto no navegador </font><font style="vertical-align: inherit;">, o que significa temos o direito de ler arquivos arbitr√°rios no sistema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao tentar encontrar outros arquivos no sistema, voc√™ pode perceber um erro que aparece toda vez que voc√™ solicita um arquivo inexistente (ou um arquivo que n√£o pode ser lido com os direitos de usu√°rio do aplicativo):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/au/su/ocausuexy92ii3ackgqn2fnh-ta.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendo observado que o erro se refere √† </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ambiente </font><b><font style="vertical-align: inherit;">ASPNETCORE_ENVIRONMENT</font></b><font style="vertical-align: inherit;"> , come√ßamos a estudar os layouts de aplicativos da web do ASP.NET Core. </font><font style="vertical-align: inherit;">E vemos o seguinte:</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dr/oz/7s/droz7stwr6mkzt3buptphi6yt88.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para converter os caminhos e nomes de arquivos necess√°rios e extra√≠-los para Base64, escrevemos um pequeno script Python ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetch.py</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/nv/of/aqnvofypmm8iiotr8xq0koyybtg.png"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando esse conhecimento sobre a estrutura do aplicativo Web MVC criado no ASP.NET Core, usando fetch.py, obtemos o c√≥digo-fonte para os seguintes arquivos:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Shared/_Layout.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Index.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Contact.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Hens.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Auth/Login.cshtml</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tendo feito isso e estudado o c√≥digo fonte de cada p√°gina, encontramos um detalhe interessante no Hens.cshtml </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7w/kp/mq/7wkpmqusqncbmjsdigxelqxxy2c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A linha 1 cont√©m a instru√ß√£o de inclus√£o @ usando StackHenneryMVCAppProject, que no ASP.NET significa um link para um arquivo DLL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abrimos ../StackHenneryMVCAppProject.dll - mas n√£o atrav√©s do utilit√°rio Python no Kali Linux, mas no navegador do Windows, porque vamos descompilar esse arquivo no Windows. Atrav√©s do uso de tais URL: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://web-chicken.ctfz.one/File/Download?filename=Li4vU3RhY2tIZW5uZXJ5TVZDQXBwUHJvamVjdC5kbGw=</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Abrindo DLL-arquivo em dnSpy (.NET decompiler), ver imediatamente que no m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialize ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da classe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de configura√ß√£o. A configura√ß√£o</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que √© executada quando o aplicativo Web √© iniciado, l√™ o conte√∫do do arquivo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chicken_domains_internal.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Usando um script Python, extra√≠mos o conte√∫do deste arquivo: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
web-chicken-flag</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
web-chicken-auth </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialize () se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conecta ao&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web-chicken-flag</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pela porta 4321 e recebe v√°rios par√¢metros: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flag</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infelizmente, n√£o √© poss√≠vel iniciar uma conex√£o com web-chicken-flag. Mas, quando configuramos o registro de hosts DNS locais para converter web-chicken-auth no endere√ßo IP externo do servidor ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">34.89.232.240</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), conseguimos abrir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth /</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface Swagger UI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usada para descrever e executar comandos por meio da API REST.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zy/jq/he/zyjqherp-esnmlziil2jnubkram.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s investigar o arquivo DLL descompilado, voc√™ pode observar que o controlador </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o tinha apenas o </font><font style="vertical-align: inherit;">m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Login ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas tamb√©m o m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tz/zb/1c/tzzb1cui_v-acwn19zzbvi-5kbq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando vamos para&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Auth / Change_Password_Test</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vemos este formul√°rio:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hx/-l/we/hx-lwesr4_cxhuu-ryjzb2ku76w.png"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao estudar o m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">entendemos que ele processa quatro par√¢metros do tipo String por meio de uma solicita√ß√£o HTTP POST:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nome do usu√°rio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nova senha;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senha Antiga;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url.</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qx/ik/qt/qxikqtcwxuiix9mslp_stalz9ea.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco mais baixo no m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que vemos: sem receber um valor para </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o m√©todo pega o valor </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf.auth_server</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que √© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web-chicken-auth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e adiciona </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ao final do valor </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , atribuindo a sequ√™ncia resultante √† vari√°vel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-d/aa/uj/-daaujfp1ocf8i6l9gtf1rtvemi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na pr√≥xima parte importante do c√≥digo, os valores da string dos </font><b><font style="vertical-align: inherit;">par√¢metros </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">username</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">old_password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da solicita√ß√£o HTTP POST e, com eles, o&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da configura√ß√£o, s√£o inseridos na string JSON. Em seguida, um objeto JSON </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StringContent</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© criado a partir desses dados </font><font style="vertical-align: inherit;">, que s√£o enviados como dados HTTP POST para a vari√°vel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestURI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criada na etapa anterior.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/qd/5b/3wqd5b7hjj1ftppsvtcxvfdpdyi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, o servidor aguarda a solicita√ß√£o HTTP POST para&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri para</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retornar o objeto JSON com o par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> igual a 0. Se isso n√£o acontecer, chegamos ao ramo de c√≥digo que come√ßa na linha 6 e retorna a visualiza√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Views / Auth / Login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com o erro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Login inv√°lido / senha</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se a solicita√ß√£o HTTP POST ainda </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retornar</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um objeto JSON com o par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> igual a 0, iremos para a ramifica√ß√£o de c√≥digo da linha 11. Em seguida, a vari√°vel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> obt√©m o valor </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , outro objeto JSON </font><b><font style="vertical-align: inherit;">StringContent</font></b><font style="vertical-align: inherit;"> √© criado</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com os par√¢metros da solicita√ß√£o HTTP POST original, como na parte anterior, e esses dados s√£o enviados para o endere√ßo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;na solicita√ß√£o HTTP PUT. Por fim, a mensagem de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senha alterada</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© retornada ao cliente </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cj/8y/wh/cj8ywhk0pr5vmdm8uyabhg26cf0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em poucas palavras: todo o processo come√ßa com uma solicita√ß√£o HTTP POST para&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Auth / Change_Password_Test</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que espera um certo n√∫mero de par√¢metros. Ele pega esses valores e cria um objeto JSON para envi√°-lo para&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;base_url&gt; / auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> via HTTP POST. Se em resposta receber JSON com o par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> igual a 0, ele cria outro objeto JSON e envia uma solicita√ß√£o HTTP PUT para&nbsp; </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth / auth / change_password</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao aprender a API REST na interface do usu√°rio do Swagger, vemos que no arquivo DLL descompilado n√£o havia apenas as rotas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;/ auth / change_password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas tamb√©m a rota para </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oh/kn/3p/ohkn3pbbiptuoxndp_xxo-in92q.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa rota da API esperava um objeto JSON com dois par√¢metros: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">email</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se ele o recebeu, ele retornou um objeto JSON com uma propriedade </font><font style="vertical-align: inherit;">de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0 e seq√º√™ncias de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mensagens</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qw/a1/j3/qwa1j37cbbppj5gpzr8iz6vdl2q.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que, se de alguma forma </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for√ßarmos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o m√©todo </font><b><font style="vertical-align: inherit;">Check_Password_Test ()</font></b><font style="vertical-align: inherit;"> a </font><font style="vertical-align: inherit;">solicitar imediatamente a rota </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vez de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para inserir o ramo de altera√ß√£o de senha, ser√° suficiente inserir um endere√ßo de email v√°lido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estudamos novamente a parte do c√≥digo na qual o m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atribui o valor </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na solicita√ß√£o HTTP POST original e entendemos que precisamos enviar o valor </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth / auth / password_recovery #</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como o par√¢metro base_url e requestUri na final o resultado ser√° </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth / auth / password_recovery # / auth / login</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O caractere # na URL HTTP indica que parte do endere√ßo de solicita√ß√£o foi finalizada. Portanto, o servidor que recebe a solicita√ß√£o simplesmente ignora a parte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-d/aa/uj/-daaujfp1ocf8i6l9gtf1rtvemi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso, √© claro, √© bom, mas precisamos descobrir como o terminal REST, onde agora redirecionamos a solicita√ß√£o, receber√° o valor do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">email</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sem esse valor, a solicita√ß√£o falhar√° e n√£o iremos mais longe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinamos cuidadosamente como o m√©todo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cria dados JSON e vemos que os dados de entrada n√£o s√£o limpos, o que significa que voc√™ pode implementar facilmente seus par√¢metros. √â suficiente enviar os seguintes par√¢metros na solicita√ß√£o HTTP POST: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nome do usu√°rio = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">admin</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
old_password = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pwned "," email ":" admin@chicken.ctf.zone "," lol ":" </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">new_password</font></b></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
= </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p0tat0</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
base_url = </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-chicken-auth / auth / password_recovery #</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O objeto JSON resultante √© enviado para&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/02/h8/4-/02h84-3pz0w1c7_bg2hlyqt4k7o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esses dados JSON, atendemos aos requisitos de que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve retornar uma resposta, ap√≥s o qual o servidor inserir√° a ramifica√ß√£o de altera√ß√£o de senha (o objeto JSON cont√©m a propriedade </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">email</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Agora </font><font style="vertical-align: inherit;">n√£o precisamos mais do </font><font style="vertical-align: inherit;">valor de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">old_password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nesta ramifica√ß√£o de c√≥digo, fornecemos todos os valores necess√°rios para alterar a senha (a propriedade </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">username</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">admin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a propriedade </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p0tat0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">A solicita√ß√£o foi conclu√≠da e a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">senha foi alterada</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em resposta.</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dl/pa/nw/dlpanwrefhtrjpvetawk6ed2nva.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resta apenas inserir um novo nome de usu√°rio e senha na p√°gina de login!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/zx/is/eezxiswaxjxezkq8cezfrbinggs.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E aqui est√° a nossa bandeira:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/ge/iw/yygeiwxjauomdcsnyqp2pabdcou.png"></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492212/index.html">Desenvolvimento front-end de portais em software de c√≥digo aberto: compartilhe experi√™ncia</a></li>
<li><a href="../pt492214/index.html">Por que vale a pena fazer reuni√µes enquanto caminha? Comprovado pela ci√™ncia, confirmado pela m√°fia</a></li>
<li><a href="../pt492216/index.html">Salvando valores em um aplicativo .Net no Build</a></li>
<li><a href="../pt492218/index.html">Regras de design de √≠cone para lembrar</a></li>
<li><a href="../pt492220/index.html">5 segredos pouco conhecidos dos pandas</a></li>
<li><a href="../pt492226/index.html">Compara√ß√£o de pre√ßos em Kubernetes gerenciados (2020)</a></li>
<li><a href="../pt492228/index.html">Como Sports.ru escreveu seu editor WYSIWYG</a></li>
<li><a href="../pt492232/index.html">Como as Smartcalls se tornaram o Voximplant Kit - recursos de rebranding e killer</a></li>
<li><a href="../pt492234/index.html">Pesquisa: por que as pessoas est√£o prontas para receber menos em projetos sociais</a></li>
<li><a href="../pt492242/index.html">M5Stack e seus contatos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>