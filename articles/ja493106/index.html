<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚐 🦅 😱 悪魔のダースはどれくらい新しいですか？ 🔁 🧑🏽‍🤝‍🧑🏼 🗯️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="私たちはPostgreSQL 13についてのみ話しています。4月8日に「フリーズ」が行われました-PostgreSQL 機能のフリーズ。この日付より前に受け入れられた機能のみがこのバージョンに含まれます。
 
 これの革新的なバージョンを示すのは難しいです。基本的な概念的な変更はありません。さらに、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>悪魔のダースはどれくらい新しいですか？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/493106/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちはPostgreSQL 13についてのみ話しています。4月8日に「フリーズ」が行われました-PostgreSQL </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能のフリーズ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この日付より前に受け入れられた機能のみがこのバージョンに含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これの革新的なバージョンを示すのは難しいです。</font><font style="vertical-align: inherit;">基本的な概念的な変更はありません。</font><font style="vertical-align: inherit;">さらに、PG12でJSONPathパッチの横に表示したい、JSON / SQL標準のテーブルと関数などの重要なパッチには、パッチを入力する時間がありませんでした。</font><font style="vertical-align: inherit;">既製の組み込みストレージは表示されませんでした。インターフェイスのみが確定されています。</font><font style="vertical-align: inherit;">しかし、改善のリストはまだ印象的です。</font><font style="vertical-align: inherit;">悪魔のダースに含まれるパッチのかなり完全な要約を用意しました。</font></font></i><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLコマンドの変更</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE DATABASE ... LOCALE</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーティリティ</font></font><code>initdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>createdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびチームに</font></font><code>CREATE COLLATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>LOCALE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、権限</font></font><code>LC_CTYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">との</font><font style="vertical-align: inherit;">値を指定できる</font><font style="vertical-align: inherit;">設定</font><font style="vertical-align: inherit;">があります</font></font><code>LC_COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">今、同じ機会がチームに現れました</font></font><code>CREATE DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db_koi8r <span class="hljs-keyword">TEMPLATE</span> template0 
    <span class="hljs-keyword">ENCODING</span> <span class="hljs-string">'KOI8R'</span> LOCALE <span class="hljs-string">'ru_RU.KOI8R'</span>;</code></pre><a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER VIEW ... RENAME COLUMN</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ビューの列名をコマンドで変更できるようになりました</font></font><code>ALTER VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以前は、これにはビューを再作成する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
列に名前を付けるのを忘れたとします。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">current_timestamp</span>, <span class="hljs-built_in">current_timestamp</span> - pg_postmaster_start_time();
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |    ?column?     <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:00.088824+03 | 04:18:24.897856</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修正できます：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> "?column?" <span class="hljs-keyword">TO</span> uptime;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |     uptime      <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:40.726516+03 | 04:19:05.535548</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TABLE ... ALTER COLUMN ... DROP EXPRESSION</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これで、テーブルの生成された列を通常にすることができます。つまり、式を削除して評価します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> payments (<font></font>
    id <span class="hljs-type">integer</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    income_tax <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> (amount*<span class="hljs-number">0.13</span>) STORED<font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> payments(id, amount) <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-number">42</span>);<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                                     Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable |                   Default            <font></font>
        <font></font>
------------+---------------+-----------+----------+--------------------------------------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          | generated always as ((amount * 0.13))<font></font>
 stored<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、彼らはincome_taxを明示的に設定することを決定しました。</font><font style="vertical-align: inherit;">式を削除します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> payments <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> income_tax <span class="hljs-keyword">DROP</span> EXPRESSION;<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                   Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable | Default<font></font>
------------+---------------+-----------+----------+---------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          |<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、列の既存のデータは消えていません。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> payments;</code></pre><br>
<pre><code class="plaintext hljs"> id | amount | income_tax<font></font>
----+--------+------------<font></font>
  1 |  42.00 |       5.46</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DROP DATABASE ... FORCE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
すべてのユーザーが切断するのを待たずにデータベースを削除する場合は、新しい</font></font><code>FORCE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">オプションを使用できます</font></font><code>DROP DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいデータベースに接続します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> dblink;
<span class="hljs-keyword">SELECT</span> dblink_connect(<span class="hljs-string">'dbname=db'</span>);</code></pre><br>
<pre><code class="plaintext hljs"> dblink_connect<font></font>
----------------<font></font>
 OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font></font><code>pg_terminate_backend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、開いている接続</font><font style="vertical-align: inherit;">を削除し、強制的に中断し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DATABASE</span> db <span class="hljs-keyword">WITH</span> (FORCE);</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TYPE ... SET STORAGE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このコマンドを</font></font><code>ALTER TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、基本的なデータ型でさまざまなプロパティ、特にストレージ戦略を変更できます。</font><font style="vertical-align: inherit;">以前は、チームにのみ設定できました</font></font><code>CREATE TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デモでは、新しい基本タイプを作成せず、既存の-を使用し</font></font><code>tsquery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ただし、最初に、別のデータベースを作成して接続します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;<font></font>
\c db</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tsqueryデータ型</font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">はストレージ戦略が使用されるため、</font><font style="vertical-align: inherit;">このタイプのテーブルの列は同じ戦略を取得します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | p</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | p</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいテーブルに別の戦略を使用する必要がある場合は、基本タイプを変更できます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=<span class="hljs-keyword">external</span>);
<span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいテーブルのストレージのタイプも変更されます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> new_queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'new_queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TOASTの使用を含む戦略の変更は、次の</font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ように</font><font style="vertical-align: inherit;">変更</font><font style="vertical-align: inherit;">できないことに注意</font><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">ください。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=plain);</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  cannot change type's storage to PLAIN</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、実験は別のデータベースで行われたため、削除するのは残念ではありません。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER STATISTICS ... SET STATISTICSこの</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンドを</font></font><code>CREATE STATISTICS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、テーブル列の選択した組み合わせの最も一般的な値のリストを収集できます。</font><font style="vertical-align: inherit;">収集される最も一般的な値の数は、パラメーターによって決定されます</font></font><code>default_statistics_target</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">特定の統計の値は、次のコマンドで変更できます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">STATISTICS</span>  <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATISTICS</span> _;</code></pre><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WITH TIESオプションを使用したFETCH FIRST</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ご存知の</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ように、</font><font style="vertical-align: inherit;">コマンド</font><font style="vertical-align: inherit;">を指定する代わり</font></font><code>LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に、SQL標準で定義されている構文を使用できます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
(2 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで</font></font><code>FETCH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレーズがサポート</font></font><code>WITH TIES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">され、出力にすべての「関連する」行（ソート条件のみが考慮されている場合は、すでに選択されている行と等しい行）が追加されます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">WITH</span> TIES;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
 2 | 2.2<font></font>
(3 rows)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込み関数とデータ型</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_random_uuid</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
新しい関数</font></font><code>get_random_uuid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、バージョン4のUUID値（ランダムな値）を返します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gen_random_uuid();</code></pre><br>
<pre><code class="plaintext hljs">           gen_random_uuid            <font></font>
--------------------------------------<font></font>
 25e02793-80c0-438c-be07-c94b966c43ab</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この関数は、分散システムで一意のUUID値を生成するのに役立ちます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前は、uuid-osspまたはpgcryptoライブラリを使用する必要がありました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数値タイプの値のmin_scaleおよびtrim_scale</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数</font></font><code>min_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">数値</font></b></a><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">小数部分の有効桁数を決定し、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">非</font></b></a><font style="vertical-align: inherit;">有効</font></font><code>trim_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゼロを破棄</font><font style="vertical-align: inherit;">します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> n, min_scale(n), trim_scale(n) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">42.42000</span>)) <span class="hljs-keyword">as</span> t(n);</code></pre><br>
<pre><code class="plaintext hljs">    n     | min_scale | trim_scale<font></font>
----------+-----------+------------<font></font>
 42.42000 |         2 |      42.42</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数学関数のセクションの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"> gcdおよびlcm</font></b></a><font style="vertical-align: inherit;">補充。</font><font style="vertical-align: inherit;">これで、最大公約数（</font></font><code>gcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）と</font><font style="vertical-align: inherit;">最小公倍数（</font><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">すばやく見つけることができます</font></font><code>lcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gcd(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>), lcm(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>);</code></pre><br>
<pre><code class="plaintext hljs"> gcd | lcm<font></font>
-----+-----<font></font>
   6 | 216</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_lsnタイプの集約関数の最小値と最大値</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集計関数はのために追加された</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データ型</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">、それはあなたがフォームのクエリを実行することができます：</font></font><code>pg_lsn</code><font style="vertical-align: inherit;"></font><code>min</code><font style="vertical-align: inherit;"></font><code>max</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> min(restart_lsn) <span class="hljs-keyword">FROM</span> pg_replication_slots;
<span class="hljs-keyword">SELECT</span> min(sent_lsn) <span class="hljs-keyword">FROM</span> pg_stat_replication;</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数の戻り値の型修飾子の確認</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以前のバージョンで</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">は、関数の戻り値の</font></b></a><font style="vertical-align: inherit;">型修飾子はチェックされませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通貨単位を格納するタイプと、所得税額を返す関数があるとします。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TYPE</span> currency <span class="hljs-keyword">AS</span> (<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    code   <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> income_tax(quantity currency) <span class="hljs-keyword">RETURNS</span> currency
    <span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT quantity.amount * 0.13, quantity.code'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この関数を呼び出すと、小数点以下2桁になることが予想されますが、4桁になります。</font><font style="vertical-align: inherit;">関数呼び出し後の明示的なキャストでも役に立たない（3列目）：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]--<font></font>
amount | 5.5146<font></font>
code   | <font></font>
amount | 5.5146</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バージョン13では、結果は正しいです。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]<font></font>
amount | 5.51<font></font>
code   | <font></font>
amount | 5.51</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to_date（）およびto_timestamp（）</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数</font><font style="vertical-align: inherit;">のローカライズされた名前は、月と曜日のローカライズされた名前を理解すること</font></font><code>to_date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font></font><code>to_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学びました。</font><font style="vertical-align: inherit;">以前は、英語名しか使用できませんでした：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> to_date(<span class="hljs-string">', 24  2020'</span>, <span class="hljs-string">'TMDay, DD TMMonth YYYY'</span>);</code></pre><br>
<pre><code class="plaintext hljs">  to_date   <font></font>
------------<font></font>
 2020-03-24</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normalizeおよびIS NORMALIZED</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
SQL標準に準拠するために、Unicode文字列を正規化するnormalize（）関数が追加され、文字列が正規化されているかどうかを確認するIS NORMALIZED述語が追加されました。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> str, normalize(str, NFC) <span class="hljs-keyword">AS</span> nfc,<font></font>
       str <span class="hljs-keyword">IS</span> NFC NORMALIZED <span class="hljs-keyword">AS</span> is_nfc_normalized,<font></font>
       normalize(str, NFKC) <span class="hljs-keyword">AS</span> nfkc,<font></font>
       str <span class="hljs-keyword">IS</span> NFKC NORMALIZED <span class="hljs-keyword">AS</span> is_nfkc_normalized
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">U&amp;'\0032\2075'</span>)) <span class="hljs-keyword">AS</span> vals(str)\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]------+---<font></font>
str                | 2⁵<font></font>
nfc                | 2⁵<font></font>
is_nfc_normalized  | t<font></font>
nfkc               | 25<font></font>
is_nfkc_normalized | f</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNICODE正規化フォームの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">詳細をご覧ください</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64ビットトランザクション番号用のxid8タイプとxid8_current（）関数64ビットトランザクション番号</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
用の新しいxid8データタイプを追加しました。しかし、これはPostgreSQLが64ビットトランザクションに切り替わったという意味ではありません。すべてが以前とまったく同じように機能します。しかし、一部の機能は、例えば、今、代わりにINT8返さ古い関数pg_current_xact_id txid_currentの使用を推奨します、というように。N.され、新しい型を返す</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい多型データ型anycompatibleファミリは、</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
種類を追加しました</font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>anycompatiblearray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>anycompatiblenonarray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>anycompatiblerange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ファミリータイプとは異なり</font></font><code>anyelement</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、新しいタイプではまったく同じではなく、実際には互換性のあるタイプを使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の例では、関数</font></font><code>maximum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として定義された引数として</font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">渡さ</font></font><code>integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ</font></font><code>numeric</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">戻り値は、次の2つのタイプの共通値に変換されます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> maximum(a anycompatible, b anycompatible) <span class="hljs-keyword">RETURNS</span> anycompatible
	<span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT CASE WHEN a &gt; b THEN a ELSE b END'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> f, pg_typeof(f) <span class="hljs-keyword">FROM</span> maximum(<span class="hljs-number">42</span>, <span class="hljs-number">42.42</span>) f;</code></pre><br>
<pre><code class="plaintext hljs">   f   | pg_typeof<font></font>
-------+-----------<font></font>
 42.42 | numeric</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、タイプanycompatible-およびany-は、2つの独立したタイプのセットです。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> first_elems(a <span class="hljs-type">anyarray</span>, b anycompatiblearray)
    <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span>(a <span class="hljs-type">anyelement</span>, b anycompatible) <span class="hljs-keyword">AS</span> $$<span class="pgsql">
        <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ROW</span>(a[array_lower(a,<span class="hljs-number">1</span>)], b[array_lower(b,<span class="hljs-number">1</span>)]);
    $$</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">sql</span>;
<span class="hljs-keyword">SELECT</span> first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-keyword">ARRAY</span>[<span class="hljs-string">'a'</span>,<span class="hljs-string">'b'</span>,<span class="hljs-string">'c'</span>]) <span class="hljs-keyword">AS</span> str, <font></font>
       first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>],<span class="hljs-keyword">ARRAY</span>[<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>]) <span class="hljs-type">bool</span>;</code></pre><br>
<pre><code class="plaintext hljs">  str  |  bool   <font></font>
-------+---------<font></font>
 (1,a) | (1.1,t)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手続き言語</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PL / Perlでbool型に変換する</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最近では、TRANSFORM of Ivan</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Panchenko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Postgres Professional）</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"> -bool_plperlがコミットされました</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">Postgresはブール値をPL / Perlのように</font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font><font style="vertical-align: inherit;">PL / Perlのよう</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">渡します</font><font style="vertical-align: inherit;">が、Perl</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の場合はブール値の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ではなく、文字fだけです。</font><font style="vertical-align: inherit;">論理的な文脈では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">真実</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この問題はさまざまな方法で解決できます（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通信を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照</font><font style="vertical-align: inherit;">）。ただし、Tom Laneによると、boolのTRANSFORMを作成するのが最も実用的です。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PL / pgSQLでの単純な式の高速実行</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
単純な式（少なくともテーブル呼び出しを含まず、ロックを必要としない）はより高速になります。</font><font style="vertical-align: inherit;">以前は、これらのケースでは、各サイクルでスケジューラに連絡するのに非生産的に時間が費やされていました。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR REPLACE</span> <span class="hljs-keyword">FUNCTION</span> slow_pi() <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">double</span> <span class="hljs-type">precision</span> <span class="hljs-keyword">AS</span> $$<span class="pgsql">
    <span class="hljs-keyword">DECLARE</span>
        a <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        s <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        r <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">0</span>;
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">FOR</span> i <span class="hljs-keyword">IN</span> <span class="hljs-number">1</span> .. <span class="hljs-number">10000000</span> <span class="hljs-keyword">LOOP</span>
            r := r + s/a; a := a + <span class="hljs-number">2</span>; s := -s;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
        <span class="hljs-keyword">RETURN</span> <span class="hljs-number">4</span>*r;
    <span class="hljs-keyword">END</span>;
    $$</span> <span class="hljs-keyword">LANGUAGE</span> plpgsql;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PG12でslow_pi（）を呼び出します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535898497<font></font>
    (1 row)<font></font>
    Time: 13060,650 ms (00:13,061)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在PG13で：</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535897915<font></font>
    (1 row)<font></font>
    Time: 2108,464 ms (00:02,108)</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_pltemplateではなくTrusted Extensions</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
システムディレクトリが1テーブル減少しました。</font><font style="vertical-align: inherit;">を削除しました</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">実行中に必要な手続き型言語のプロパティを格納しました</font></font><code>CREATE LANGUAGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次に、対応する言語の拡張機能のスクリプトにからプロパティを登録し</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、テーブル自体を削除することにしました。</font><font style="vertical-align: inherit;">ただし、計画を実装するには、データベース所有者（スーパーユーザー権限なし）が拡張スクリプトから信頼できる言語を作成できるようにする必要があります。</font><font style="vertical-align: inherit;">実際、たとえばplpgsqlなどを作成するために、データベースの所有者はスーパーユーザーである必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下のように受け取りました。</font><font style="vertical-align: inherit;">拡張用の制御ファイルに新しい論理パラメータが追加されました</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">パラメータ</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>superuser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">含まれている場合、拡張機能はスーパーユーザーだけでなく</font></font><code>CREATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、現在のデータベース（およびその所有者）</font><font style="vertical-align: inherit;">に対する権限</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">持つユーザーも作成できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このような拡張機能のスクリプトを実行する場合、クラスターを初期化したスーパーユーザー権限が使用されます。</font><font style="vertical-align: inherit;">拡張機能の所有者が作成ユーザーになりますが、拡張機能によって作成されたオブジェクトはそれに属します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの変更の重要な結果：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trusted Extensionsは、サードパーティの開発者が他の信頼できる言語を作成するための道を開きます。</font><font style="vertical-align: inherit;">現在、plpgsql、plperl、pltclのみに制限されています。</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plpythonが言語の2番目のバージョンを参照する</font><font style="vertical-align: inherit;">こと</font><font style="vertical-align: inherit;">は困難でした。</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そう</font><font style="vertical-align: inherit;">し</font><font style="vertical-align: inherit;">ないことは、Python 3への移行へのステップです（十分ではありませんが、必要です）。</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指数</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B-tree</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">圧縮</font></b></a><font style="vertical-align: inherit;"> Anastasia Lubennikova（Postgres Professional）とPeter Geigan（Peter Geoghegan）によって書かれた重要な待望の（作業は2015年に開始されました）パッチがついにPeterから通知されました。ナスティア</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はPGconf Indiaで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これについてなんとか</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">話しました</font></a><font style="vertical-align: inherit;">。 Postgresは重複排除、つまり重複するインデックスキーの節約により、Bツリーインデックスのサイズを大幅に削減することを学びました。これらのインデックスは真剣に再設計され、以前のバージョンのインデックスとの互換性を失うことなく圧縮が可能です。重複排除のアイデアは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（リバースインデックス-一般化された逆インデックス）</font><font style="vertical-align: inherit;">などのインデックスのより柔軟なアーキテクチャから採用されています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのインデックスでは、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"> Bツリー</font></a><font style="vertical-align: inherit;">よりも頻繁に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、キーが多数のレコードに対応する場合があります。たとえば、ワープロの場合、同じトークンが通常複数のドキュメントで見つかります。そして、それは一度だけインデックスに保存されます。最近まで、Bツリーインデックスはこれを行う方法を知りませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bツリーインデックスは、主にリーフページでGINインデックスとは異なります。同じキー値に関連するレコードの数に応じて、オプションが可能です。ページには投稿リスト（TID（インデックス付きレコードの識別子）のリスト）のみが含まれ、リストが小さい場合、およびTIDが多数ある場合は、値のリストではなくが保存されます新しい「ツリーブランチ」-投稿リストや他のツリーブランチ（投稿ツリーと呼ばれます）などの他のページへのリンク。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなツリー構造はBツリーに似ていますが、本質的な詳細が異なります。たとえば、GINの同じツリーレベルのページを移動するためのリストは、双方向ではなく単方向です。そのため、重複排除された新しいインデックスと古いバージョンとの良好な互換性（を含む）を達成することは容易ではありません。そして、改善には本当に3年以上かかりました。また、クリーニングのメカニズム（マイクロバキューム）やその他のニュアンスを検討する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンステストでは、重複排除を適用できるすべてのインデックスが約3倍縮小しました。重複の圧縮は一意のインデックスにも役立ち、テーブルの変更率が高いときにインデックスが膨らむという問題を排除できます。新しい動作は、インデックス設定レベルで接続および切断できます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GINインデックスによる完全スキャンは、必要のない場所では行われません</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパッチにより、場合によっては、GINインデックス全体のフルパスを回避できます。</font><font style="vertical-align: inherit;">一部の操作は、GINインデックスでサポートされていますが、インデックスのフルスキャンによって実行されます。</font><font style="vertical-align: inherit;">たとえば、全文列検索のインデックスを考えてみましょう</font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">検索クエリの形式が「特定の単語以外」の場合、インデックス全体を完全に読み取る必要があります。</font><font style="vertical-align: inherit;">ただし、インデックスのフルスキャンを必要としない別の条件がリクエストに存在する場合、インデックスは引き続き完全にスキャンされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい最適化では、より正確な条件が最初に使用され、インデックスから利益を得ることができます。次に、結果が再チェックされ、別の制限が考慮されます。</font><font style="vertical-align: inherit;">バージョン12（バッファー）で読み取られたページ数を比較します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5167<font></font>
   Buffers: shared hit=24 read=27405<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=24 read=22238<font></font>
 Planning Time: 0.283 ms<font></font>
 Execution Time: 3258.234 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいバージョンのバッファ数：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
---------------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5156<font></font>
   Buffers: shared hit=5179<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=23<font></font>
 Planning Time: 0.250 ms<font></font>
 Execution Time: 8.779 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トライグラムを使用するとき、および配列の出現をチェックするときに、同様の状況が発生する可能性があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演算子クラスのパラメーター</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PostgreSQLでは、多くのインデックスアクセスメソッドは、ページとロック、およびWALログを処理する検索アルゴリズムの高レベルの実装を引き受ける「フレームワーク」です。また、特定のデータ型と演算子へのバインドは、演算子クラスを使用して実行されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまで、演算子クラスにはパラメータを含めることができませんでした。たとえば、全文検索の場合、演算子のクラスを持つGiSTインデックスを使用できます</font></font><code>tsvector_ops</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここ</font></a><font style="vertical-align: inherit;">ではGiST演算子のクラスについて）</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）このクラスの演算子は署名ツリーを使用し、署名の長さは固定されていました（124バイト）。これで、長さを明示的に指定できるようになりました。これにより、インデックスのサイズと効率（ハッシュの衝突の数）のバランスを制御できます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> mail_messages <span class="hljs-keyword">USING</span> gist(tsv tsvector_ops(siglen=<span class="hljs-number">1024</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スターターに対して同様の変更が、hstore、intarray、ltree、およびpg_trgm拡張に適用される署名ツリーを使用するGiSTオペレーターの他のクラスに対して行われました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、この変更が考えられた主なアイデアは、JSONPath式をGINインデックスに渡して、JSONドキュメント全体ではなく、必要な部分だけをインデックスに登録できるようにすることです。多くの場合、これによりインデックスのサイズが大幅に縮小されます。しかし、この作業はまだ行われていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オレグ・バルトゥーノフのアイデア、ニキータ・グルホフとアレクサンダー・コロトコフ（3つすべてのPostgres Professional）の実装。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加しました演算子&lt; - &gt;（箱、ポイント）</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
のためのk最近傍での使用のために不足している操作を追加しまし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たGiST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SP-のGiST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。 PG12で幾何タイプ</font></font><code>point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用する場合</font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">距離演算子を使用でき</font></font><code>&lt;-&gt;(point, box)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これにより、GiSTおよびSP-GiSTインデックス</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">した検索が高速化されます。</font><font style="vertical-align: inherit;">しかし、彼と対称的な演算子</font></font><code>&lt;-&gt;(box, point)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は実装されていませんでし</font><font style="vertical-align: inherit;">た</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">、彼</font><font style="vertical-align: inherit;">は</font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より複雑なタイプ-ポリゴンと円までの距離</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">すでに理解していました。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> points(<span class="hljs-type">point</span> <span class="hljs-type">point</span>);
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> boxes(<span class="hljs-type">box</span> <span class="hljs-type">box</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> points <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'1,2'</span>,<span class="hljs-string">'3,4'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> boxes <span class="hljs-keyword">VALUES</span>(box(<span class="hljs-type">point</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>),<span class="hljs-type">point</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)), box(<span class="hljs-type">point</span>(<span class="hljs-number">13</span>,<span class="hljs-number">14</span>),<span class="hljs-type">point</span>(<span class="hljs-number">15</span>,<span class="hljs-number">16</span>)));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PG12の場合：</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs">:    : box &lt;-&gt; point</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
逆の場合は、すべて問題ありません。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, p.point  &lt;-&gt; b.box distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてPG13では：</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この操作では、GiSTおよびSP-GiSTインデックスが高速化されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PG13では、次のように尋ねると、</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> pg_operator <span class="hljs-keyword">WHERE</span> oprname = <span class="hljs-string">'&lt;-&gt;'</span>;</code></pre><pre><code class="plaintext hljs"> count <font></font>
-------<font></font>
    28</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じことをPG12で行うと、20のエントリが取得されます。13番目のバージョンでは、リストには8つの演算子が追加されました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジェイソン</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jsonpathの.datetime（）メソッドのサポート</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、PG12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が完了する時間がなかった</font><font style="vertical-align: inherit;">一連の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"> JSONPathパッチ</font></a><font style="vertical-align: inherit;">の失敗したパッチの1つです</font><font style="vertical-align: inherit;">。 JSON / SQL標準の一部。問題は、JSONPathパッチシリーズのすべての関数は不変ですが、日付の比較では現在のタイムゾーンが考慮されるため、セッション中に変更される可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような場合、既存の不変関数が、不変比較についてエラーをスローすることを許可します。同時に、このパッチには、サフィックス_tzが付いた関数があり、タイムゾーンの操作で安定して動作します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい関数-jsonb_set_lax関数</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、laxはjsonbを使用した関数の非厳密（厳密とは異なる）操作モードです。この場合、この関数は、取る引数の1つがNULLである状況で機能します。厳密なバージョンとは異なり-jsonb_set（）-NULLの場合のアクションを示す追加の引数があります。オプション：use_json_null / raise_exception / return_target / delete_key。関心のあるユーザーが提案したオプション。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかのjsonb関数を</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最適化しまし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、主にNikita Glukhov（Postgres Professional）の努力による。</font><font style="vertical-align: inherit;">しかし、この場合の各ポイントを分析することは無意味です。最初に、それらの豊富さはすでに短い記事を膨らませます。</font><font style="vertical-align: inherit;">2番目に、変更は内部デバイスに関連しており、すべてのユーザーが関心を持っているわけではありません。</font><font style="vertical-align: inherit;">したがって、それらのほとんどのみをリストします。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最適化された関数JsonbExtractScalar（）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最適化された演算子＃&gt;&gt;、関数jsonb_each_text（）、jsonb_array_elements_text（）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_jsonb_path_all（）でのタイプJsonbContainerの認識が最適化されました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JsonbIteratorイテレータから最初のトークンを取得すると、軽量マクロJsonbContainerIsXxx（）;に置き換えられます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より便利なキー抽出-findJsonbKeyInObject（）;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果findJsonbValueFromContainer（）およびgetIthJsonbValueFromContainer（）;の最適化されたストレージ</font></font></li>
<li>  get_jsonb_path_all(),     ;<br>
  JsonbValueAsText.</li>
</ol><br>
<i> ,        SQL/JSON: JSON_TABLE  SQL/JSON: functions.       . ,   .      .     PG14.   JSONPath   .</i><br>
<br>
<h3>  </h3><br>
<h4>pgbench</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パフォーマンステストを実行するためのユーティリティに一連の改善が加えられました。</font><font style="vertical-align: inherit;">あった</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の実行に関する統計</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期化フェーズでのタスクは、より</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">視覚的な結論</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、能力</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込みのスクリプトのコードを参照</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、テスト</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のパーティション表上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のアカウント。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、と</font></font><code>\aset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同様</font><font style="vertical-align: inherit;">のコマンドを追加しました</font></font><code>\gset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、一度に送信される複数のリクエストの変数に値を設定できます。</font><font style="vertical-align: inherit;">次の行は、実行のためにサーバーに送信され、変数</font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">との</font><font style="vertical-align: inherit;">両方を設定します</font></font><code>two</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> one \; <span class="hljs-keyword">SELECT</span> <span class="hljs-number">2</span> <span class="hljs-keyword">AS</span> two \aset</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_dump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_dumpは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サードパーティのテーブルからデータ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">アンロードする</font></a><font style="vertical-align: inherit;">ことを学びました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">パラメータ</font></font><code>--include-foreign-data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して、テーブルからのデータがアンロードされるサードパーティサーバーのリストを指定できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアンロードは慎重に使用してください。</font><font style="vertical-align: inherit;">データをサードパーティのサーバーにアップロードする必要があるという事実とはかけ離れています。</font><font style="vertical-align: inherit;">さらに、リカバリ中にサードパーティのサーバーが利用できない可能性があります。</font><font style="vertical-align: inherit;">または、サードパーティのサーバーは読み取りのみを許可し、データの書き込みは許可しません。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psql</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一連の小さなパッチにより、psqlがより快適になります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いくつかのチームのタブ補完を改善しました。</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>\echo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列をSTDOUT </font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">送信する</font><font style="vertical-align: inherit;">だけでなく</font><font style="vertical-align: inherit;">、新しいコマンド</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>\warn</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は文字列を標準エラー出力（STDERR）に送信します。</font></font></li>
<li> <code>\d</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> toast-</a>       .        <code>\d+</code>        .</li>
<li>  <code>\dt+</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  «Persistence»</a>      (unlogged)   (permanent).</li>
<li>  <code>\e</code>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>,       <code>;</code> (  <code>\g*</code>). ,       psql      .</li>
<li>         .     <code>PROMPT1</code>  <code>PROMPT2</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a> <code>%x</code>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいコマンド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のアクセス方法の詳細については：</font></font><code>\dAc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>\dAf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>\dAo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>\dAp</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">可能</font></a></font><code>\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">になりました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">括弧でサポートされているすべてのオプションを</font></font><code>\pset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">彼らは現在のチームでのみ行動します。</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libpq</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLに関連する小さな変更：</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hostおよびhostadrパラメータの説明</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">の不正確</font></a><font style="vertical-align: inherit;">さ、および</font></font><code>\conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psqlユーティリティコマンドの</font><font style="vertical-align: inherit;">出力の結果の不整合</font><font style="vertical-align: inherit;">が修正されました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアント証明書キーが暗号化された形式で保存されている場合は、インタラクティブモードでのみパスワードを入力できます。</font><font style="vertical-align: inherit;">新しい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslpassword</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">使用する</font></a><font style="vertical-align: inherit;">と、キーを非対話的に復号化</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">できます</font></a><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの新しいパラメーター</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslminprotocolversionとsslmaxprotocolversionを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、接続が許可されるSSL / TCLプロトコルのバージョンに制限を指定できます。</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reindexdb</font></font></h4><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reindexdb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーティリティ</font><font style="vertical-align: inherit;">
の新しい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">--jobs</font></a><font style="vertical-align: inherit;">パラメータは、</font><font style="vertical-align: inherit;">インデックスが同時に再構築されるデータベース接続の数を設定します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_rewind</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーティリティの制限は徐々になくなり、可能性が高まっています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、pg_rewind </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、リカバリの情報を記録できるようになり（pg_basebackupがこれを実行できるため）、インスタンスのリカバリを開始し、インスタンスがチェックポイントで停止されなかった場合はシャットダウンします（これは以前に手動で行う必要がありました）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、第二に、pg_rewind </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はWALアーカイブを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">操作することを学びました</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーティリティが2つのサーバー間のWAL分岐点を見つけた後、違いを排除するために、ターゲットクラスターにコピーする必要があるすべてのページのリストを作成する必要があります。</font><font style="vertical-align: inherit;">このため、ユーティリティは、見つかったポイントから始まるすべてのWALファイルを必要とします。</font><font style="vertical-align: inherit;">必要なWALファイルがターゲットクラスタで利用できない場合、ユーティリティは以前にその作業を実行できませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexey Kondratov（Postgres Professional）によるこのパッチでは、新しい-cまたは--restore-target-walスイッチが指定されている場合、pg_rewindは、restore_commandパラメーターを使用して、ログファイルのアーカイブから欠落しているWALセグメントを読み取ることができます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_waldump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_waldumpは</font><font style="vertical-align: inherit;">準備されたトランザクション</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レコード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">復号化</font></a><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amcheck</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
amcheck拡張は</font><font style="vertical-align: inherit;">、Bツリーインデックスの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">損傷</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">よりよく認識する</font></a><font style="vertical-align: inherit;">ことを学びました</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ところで、破損したページに関するサーバーログのメッセージは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックスとテーブルで異なります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページ検査</font></font></h4><br><font style="vertical-align: inherit;"></font><code>heap_tuple_infomask_flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pageinspect拡張機能は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドの値を復号化</font></font></a> <code>infomask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、</font></font><code>infomask2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数によって返さ</font></font><code>heap_page_items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">データ破損状況の調査に役立ちます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgres_fdw</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー名マッピングレベルのスーパーユーザーは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常のユーザーが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パスワードなしで接続</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を</font></a><font style="vertical-align: inherit;">使用する</font><font style="vertical-align: inherit;">ことを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">許可でき</font></a><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-keyword">MAPPING</span> <span class="hljs-keyword">FOR</span>  <span class="hljs-keyword">SERVER</span> 
    <span class="hljs-keyword">OPTIONS</span> (<span class="hljs-keyword">ADD</span> password_required <span class="hljs-string">'false'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは特に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslkeyとsslcert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を接続パラメータとして使用できるようにするために行われます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理パック</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
adminpack拡張機能に新機能-があり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>pg_file_sync</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">それを使用して、経由、例えば、ディスクにサーバーによって書き込まれたファイルのためにfsyncを行うことができます</font></font><code>pg_file_write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か</font></font><code>COPY TO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モニタリング</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_slru</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーの共有メモリには、大きなバッファキャッシュだけでなく、他のより単純なキャッシュ（トランザクションステータスなど）も多数含まれています。</font><font style="vertical-align: inherit;">使用頻度が最も低いページ（最も使用頻度が低い、またはSLRU）を混雑させるために、単純なアルゴリズムを使用します。</font><font style="vertical-align: inherit;">これまで、このようなキャッシュは「機能するだけ」でしたが、主にPostgreSQLカーネルの開発者が何かを変更する必要があるかどうかを把握するために、それらを監視する必要がありました。</font><font style="vertical-align: inherit;">この目的のために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_slruの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいビュー</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">が登場しました</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_activity</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ビューでは、</font></font><code>pg_stat_activity</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しい列</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">並列リクエストに参加しているプロセスの場合、先頭のプロセスの番号が入力されます。</font><font style="vertical-align: inherit;">そして先行工程</font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は工程番号</font></font><code>pid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のクエリは、どのクエリとどのプロセスが現在並行して実行されているかを示しています。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> query, leader_pid, <font></font>
    array_agg(pid) <span class="hljs-keyword">filter</span>(<span class="hljs-keyword">WHERE</span> leader_pid != pid) <span class="hljs-keyword">AS</span> members
  <span class="hljs-keyword">FROM</span> pg_stat_activity
 <span class="hljs-keyword">WHERE</span> leader_pid <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> query, leader_pid;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
待機中のイベントのリストに変更があります。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの新しいイベントが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加されました</font><font style="vertical-align: inherit;">：</font></font><code>BackupWaitWalArchive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>RecoveryPause</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、他の2つは、より正確な名前を与えられました：</font></font><code>RecoveryWalStream -&gt; RecoveryRetrieveRetryInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>RecoveryWalAll -&gt; RecoveryWalStream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに2つの新しい待機イベントは、レプリカで発生した</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><code>RecoveryConflictSnapshot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（VACUUMとの競合、必要な行のバージョンを削除）と</font></font><code>RecoveryConflictTablespace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（表スペースの除去に関連した紛争を）。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これまで、拡張機能は</font><font style="vertical-align: inherit;">フレーズの有無にかかわらず、同じリクエストとして</font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストを処理していました</font></font><code>FOR UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。でのリクエスト</font></font><code>FOR UPDATE</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は個別に記録されるようになりました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
収集される情報量が増加しました。今後は、コマンドを実行するためのリソースに関する情報だけでなく</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、生成されたジャーナルエントリに関する統計</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も記録され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。新しいプレゼンテーション列：</font></font><code>wal_bytes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-生成されたレコードの量、</font></font><code>wal_records</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-生成されたレコードの</font></font><code>wal_num_fpw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">-フルページ画像の数（フルページ書き込み）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは</font><font style="vertical-align: inherit;">、WALの使用を追跡するために</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準備されたインフラストラクチャの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おかげで可能になりました</font><font style="vertical-align: inherit;">。したがって、</font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新しいオプションを使用する</font></font><code>WAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、生成されたレコードの量が表示されます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t (id <span class="hljs-type">int</span>);
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, WAL, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">SUMMARY</span> <span class="hljs-keyword">OFF</span>)
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>);</code></pre><br>
<pre><code class="plaintext hljs">              QUERY PLAN              <font></font>
--------------------------------------<font></font>
 Insert on t (actual rows=0 loops=1)<font></font>
   WAL:  records=1  bytes=59<font></font>
   -&gt;  Result (actual rows=1 loops=1)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Extension </font></font><code>auto_explain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>VACUUM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font><code>VERBOSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、および</font></font><code>autovacuum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成されたインフラストラクチャを使用し、WALのボリュームを出力します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
に戻り</font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">新しいパラメーター</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements.track_planningが有効になっている</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、</font><font style="vertical-align: inherit;">スケジューラーに関連する追加の統計がオペレーターごとに記録されます。</font><font style="vertical-align: inherit;">総計画時間; </font><font style="vertical-align: inherit;">1つの計画の最小時間と最大時間、および平均と標準偏差。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スケジューラに割り当てられたリソースの説明は、に関連しない別のパッチに反映され</font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション</font></font><code>BUFFERS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、計画段階で使用されたバッファ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">数</font></a><font style="vertical-align: inherit;">が報告</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">されます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
    <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> pg_class;</code></pre><br>
<pre><code class="plaintext hljs">                   QUERY PLAN                   <font></font>
------------------------------------------------<font></font>
 Seq Scan on pg_class (actual rows=386 loops=1)<font></font>
   Buffers: shared hit=9 read=4<font></font>
 Planning Time: 0.782 ms<font></font>
   Buffers: shared hit=103 read=11<font></font>
 Execution Time: 0.219 ms</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マガジン</font></font></h4><br>
<ul>
<li> <code>log_statement_sample_rate</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   SQL,   </a>,      <code>log_min_duration_sample</code>( ).<br>
,    <code>log_min_duration_statement</code>    , ..  <code>log_min_duration_statement</code> ,  <code>log_min_duration_sample</code>,       ,      <code>log_statement_sample_rate</code>.<br>
 ,   <code>log_transaction_sample_rate</code>    ,       ,      .</li>
<li>  ,   (   log_min_error_statement),         .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>log_parameter_max_length_on_error</code></a>.     0,   .<br>
 <code>log_parameter_max_length_on_error</code>          SQL,    ,      .<br>
    (     <code>log_statements</code>  <code>log_duration</code>)   ,  : <code>log_parameter_max_length</code>,     ,   .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、プロセスタイプ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>pg_stat_activity.backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">サーバーログに</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">書き込む</font></a><font style="vertical-align: inherit;">ことができます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この</font></font><code>log_line_prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために、特別な記号が</font><font style="vertical-align: inherit;">パラメータで</font><font style="vertical-align: inherit;">提供さ</font><font style="vertical-align: inherit;">れます</font></font><code>%b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">また、ログがcsv（</font></font><code>log_destination=csvlog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">形式</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">記述されている</font><font style="vertical-align: inherit;">場合、列は</font></font><code>backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでにそこに含まれています。</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">進捗</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいビューは</font></font><code>pg_stat_progress_analyze</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、</font></font><code>pg_stat_progress_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたがの進捗状況を追跡できるようにする</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">統計情報の収集を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チーム</font></font><code>ANALYZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のバックアップコピーを作成</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーティリティを</font></font><code>pg_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれ。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最適化</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">計画段階</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"> FROM句での不変関数の計算</font></b></a><font style="vertical-align: inherit;"> Aleksandr KuzmenkovとAleksandr Parfyonov（両方ともPostgres Professionalから）のパッチは、</font></font><code>FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出しに実際に定数である関数呼び出しが含まれている</font><font style="vertical-align: inherit;">場合に役立ちます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この場合、接続を作成する代わりに、要求の必要な場所に定数値が代入されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全文検索に関連するクエリの例でこれがどのように行われるかを次に示します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                              <font></font>
------------------------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, '''tuple'''::tsquery)) DESC<font></font>
   -&gt;  Bitmap Heap Scan on mail_messages<font></font>
         Recheck Cond: (tsv @@ '''tuple'''::tsquery)<font></font>
         -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
               Index Cond: (tsv @@ '''tuple'''::tsquery)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接続はなく、値 'tuple' :: tsqueryは、すでに計画段階にあるクエリで置き換えられます。</font><font style="vertical-align: inherit;">バージョン12の状況は完全に異なりました。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank                            
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q                            
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                          QUERY PLAN                         <font></font>
-----------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, q.q)) DESC<font></font>
   -&gt;  Nested Loop<font></font>
         -&gt;  Function Scan on q<font></font>
         -&gt;  Bitmap Heap Scan on mail_messages<font></font>
               Recheck Cond: (tsv @@ q.q)<font></font>
               -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
                     Index Cond: (tsv @@ q.q)</code></pre><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">増分ソート</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
多数のキー（k1、k2、k3 ...）によるソートが必要な場合、スケジューラーはデータが最初のキーのいくつか（たとえば、k1とk2）によってすでにソートされているという知識を活用できます。この場合、すべてのデータを再度並べ替えることはできませんが、それらを同じ値k1とk2で連続するグループに分割し、キーk3で「並べ替え」ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ソート全体が、サイズの小さいいくつかの連続したソートに分割されます。これにより、必要なメモリの量が削減され、すべての並べ替えが完了する前に最初のデータを提供することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、チケットテーブルのデモベースでは、ticket_id列にインデックスがあります。</font><font style="vertical-align: inherit;">インデックスから受信したデータはticket_idでソートされるため、次のクエリはインクリメンタルソートを使用します。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                                  QUERY PLAN                                  <font></font>
------------------------------------------------------------------------------<font></font>
 Incremental Sort (actual rows=2949857 loops=1)<font></font>
   Sort Key: ticket_no, passenger_id<font></font>
   Presorted Key: ticket_no<font></font>
   Full-sort Groups: 92184 Sort Method: quicksort Memory: avg=31kB peak=31kB<font></font>
   -&gt;  Index Scan using tickets_pkey on tickets (actual rows=2949857 loops=1)<font></font>
 Planning Time: 2.137 ms<font></font>
 Execution Time: 2230.019 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
増分ソート機能は、enable_incrementalsortパラメーターで無効にできます。</font><font style="vertical-align: inherit;">この場合、並べ替えには著しく時間がかかります。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SET</span> enable_incrementalsort = <span class="hljs-keyword">off</span>;
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                               <font></font>
-----------------------------------------------------------------------<font></font>
 Gather Merge (actual rows=2949857 loops=1)<font></font>
   Workers Planned: 2<font></font>
   Workers Launched: 2<font></font>
   -&gt;  Sort (actual rows=983286 loops=3)<font></font>
         Sort Key: ticket_no, passenger_id<font></font>
         Sort Method: external merge  Disk: 107024kB<font></font>
         Worker 0:  Sort Method: external merge  Disk: 116744kB<font></font>
         Worker 1:  Sort Method: external merge  Disk: 107200kB<font></font>
         -&gt;  Parallel Seq Scan on tickets (actual rows=983286 loops=3)<font></font>
 Planning Time: 3.994 ms<font></font>
 Execution Time: 12291.844 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
増分ソートのアイデアは、2013年にAlexander Korotkov（Postgres Professional）によって提案され、7年後の今、このパッチはJames Colemanによってコミュニティによって承認された状態にされました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUNCATEアクセラレーション</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">共有メモリからテーブルバッファを削除するために</font><font style="vertical-align: inherit;">スキャンが行わ</font><font style="vertical-align: inherit;">れた</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とき</font><font style="vertical-align: inherit;">。以前は、スキャンはテーブルレイヤーごとに3回実行されました：MAIN（メインデータレイヤー）、FSM（フリースペースマップ）、VM（可視性マップ）。これでロジックが変更され、トリプル操作ではなく、バッファーが1回だけスキャンされます。大きな値の場合、</font><font style="vertical-align: inherit;">これは具体的な利益をもたらします。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">部分的減圧TOAST</font></b></a></font><code>TRUNCATE</code><font style="vertical-align: inherit;"></font><code>shared_buffers</code><font style="vertical-align: inherit;"></font><code>shared_buffers</code><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TOASTを完全に読み取る必要がなく、スライスを最初または最初のスライスに制限する場合、完全に解放することは意味がありません。</font><font style="vertical-align: inherit;">圧縮されたTOASTは反復で読み取られます。必要なデータがない場合は、ピースを読み取ってから、それを展開して読み取ります。</font><font style="vertical-align: inherit;">Google Summer of Codeの学生、Binguo Baoが例を挙げて提案しています。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> slicingtest (<font></font>
     id <span class="hljs-type">serial</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
     a <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> slicingtest (a) <span class="hljs-keyword">SELECT</span>
    repeat(<span class="hljs-string">'1234567890-=abcdefghijklmnopqrstuvwxyz'</span>, <span class="hljs-number">1000000</span>) <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">FROM</span>
    generate_series(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<font></font>
\<span class="hljs-keyword">timing</span>
<span class="hljs-keyword">SELECT</span> sum(length(substr(a, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>))) <span class="hljs-keyword">FROM</span> slicingtest;</code></pre><br>
<pre><code class="plaintext hljs">Time: 28.123 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パッチを適用すると、桁違いに速くなります。</font></font><br>
<br>
<pre><code class="plaintext hljs">Time: 2.306 ms</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">並列バキューム</font></font></b></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">このテーマに関する</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
彼の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事で、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イゴール・ロゴフは並列化におけるこの重要なステップを詳細に説明しています。つまり、「並行して掃除ができるパッチパッチ沢田まさひこ。テーブル自体は1つの（先行する）プロセスによってクリアされますが、インデックスをクリーンアップするために、インデックスごとに1つずつバックグラウンドワークフローを開始できるようになりました。手動モードでは、これにより、複数のインデックスを持つ大きなテーブルのクリーニングを高速化できます。自動クリーニングはまだこの機能を使用していません。」</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルに貼り付けたときに自動クリーニング</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパッチ（Berserk auto-vacuumとも呼ばれます）については、次の問題の解決策を提案したDorofei Proleskovskyに感謝する必要があります。自動クリーニングは追加の専用テーブルに来ません。これは、行の「デッド」バージョンがないためです。このため、可視性マップは更新されず、インデックスのみのスキャンのみが無効になり、クリーニングによってトランザクションカウンターのオーバーフローが防止されると、一度に多くの作業を行う必要があります。現在、この状況は修正されています。自動クリーニングは行の追加でも機能します。</font><font style="vertical-align: inherit;">変更（</font><font style="vertical-align: inherit;">および</font><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">パラメーター</font></font><code>autovacuum_vacuum_insert_threshold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>autovacuum_vacuum_insert_scale_factor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同様に、</font><font style="vertical-align: inherit;">2つの新しいサーバーパラメーター（</font><font style="vertical-align: inherit;">および</font><font style="vertical-align: inherit;">）が表示されました</font><font style="vertical-align: inherit;">。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">ハッシュ集合メモリ管理</font></b></a></font><code>autovacuum_vacuum_threshold</code><font style="vertical-align: inherit;"></font><code>autovacuum_vacuum_scale_factor</code><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッシュアグリゲーションは、スケジューラが考えている以上のRAMを必要とする場合があります</font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。以前は、このようなスケジューラエラーが原因で、サイズが</font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無視され、OOM Killerの操作または到着に必要なだけメモリが割り当てられていました。これで、アルゴリズムはを超えることができなく</font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なり、必要に応じて、ディスク上の一時ファイルを使用します。スケジューラの動作を制御するために、次のパラメータが表示されました：</font></font><code>enable_groupingsets_hash_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>enable_hashagg_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成された列を持つテーブルのUPDATEの最適化</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
バージョン12では、行の更新中に生成された列が再計算されました。この変更が何らかの影響を及ぼしていなくてもです。これで、本当に必要な場合にのみ再計算されます（ベース列が変更された場合）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、この最適化は、生成された型の列を持つテーブルの更新を大幅に高速化できます</font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、関数が</font></font><code>to_tsvector()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に高価であるためです。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トリガーから変更された列のリストへのアクセス変更された列</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font></font><code>TriggerData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビットマップを</font><font style="vertical-align: inherit;">構造に追加する小さなパッチ</font><font style="vertical-align: inherit;">。この情報は、</font></font><code>tsvector_update_trigger()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font><font style="vertical-align: inherit;">などの一般的なトリガー機能で、</font></font><code>lo_manage()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不要な作業を行わないようにするため</font><font style="vertical-align: inherit;">に使用できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">評価時のいくつかの高度な統計の使用</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PG12では、スケジューラは同じテーブルに対して同時に複数の高度な統計を使用できませんでした。たとえば、列の異なるセットに対して2つの高度な統計が作成され、あるセットと別のセットの列がクエリに参加している状況を想像してください。これで、プランナーはすべての利用可能な情報にアクセスできます。</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">並列化とコピーのためのインフラストラクチャ</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このパッチ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も参照してください</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a><font style="vertical-align: inherit;">）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQLの並行性は、読み取り専用のクエリでも機能します。</font><font style="vertical-align: inherit;">ライターには問題があり、そのうちの1つは、（共通の並列グループに含まれる）1つのタスクを同時に実行するブロックプロセスです。</font><font style="vertical-align: inherit;">そのようなプロセスのロックは競合しないと考えられています。たとえば、複数のプロセスが同じテーブルに排他ロックを保持できます。</font><font style="vertical-align: inherit;">これにはカーネル開発者の特別な注意が必要ですが、それ以外の場合は常にデッドロックが発生します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、2つの例外があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リレーション拡張ロック。データファイルの最後に新しいページが追加されたときに取得されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページロック。GINインデックス項目を待機リストからメインツリーに移動するときに使用されます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詳細</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を</font></a><font style="vertical-align: inherit;">読むことができます</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a><font style="vertical-align: inherit;">）</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなロックは、このパッチを実装する同じ並列グループのプロセス間でも競合するはずです。</font><font style="vertical-align: inherit;">ただし、これらのロックはデッドロックにつながることはないため、スキャンから除外されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーにとって、一般的には何も変化はありませんが、このパッチは重要です。最初に、INSERTとCOPYの並列処理が可能になるためです。次に、高負荷状態でのPostgreSQLのボトルネックの1つを排除します（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レポート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で確認できます）。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">HL ++</font></a><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全性</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SKH PRH</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
素数は、現在は使用されなくなったSKIPプロトコルを使用して、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">置き換えられた</font></b></a><font style="vertical-align: inherit;"> EDH素数（Diffie-Hellman Ephemeral Keys）を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">置き換えました</font></b></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initdb：認証のデフォルト設定</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
が変更されましたローカル接続とネットワーク接続のデフォルトアクセス設定がinitdbの起動時に変更されました。今すぐ</font></font><code>pg_hba.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わり認証方法のローカル接続のため</font></font><code>trust</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であろう</font></font><code>peer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（ピアがサポートされていない場合、またはMD5）、および</font></font><code>md5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワーク接続のために。最初に、より自由な措置が議論されました：ドキュメントの警告。その後、より厳しい：</font></font><code>scram-sha-256</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。その結果、とに限定することに</font></font><code>peer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しました</font></font><code>md5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> explicit_bzeroの使用</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要なパッチ。 bzero（）およびexplicit_bzero（）OS関数は、指定されたメモリ領域に含まれるバイトを書き込みます</font></font><code>'\0'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たとえば</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Linuxを</font><font style="vertical-align: inherit;">参照</font><font style="vertical-align: inherit;">）。これらのパッチはほんの始まりにすぎません。パスワードやその他の機密情報が残る可能性のあるメモリの多くのセクションがあります。 libpqのように、.pgpassを読み取った後、パスワードを含むファイル全体をメモリに残すことができる場所から開始し、接続を閉じた後のクリーニングから開始することにしました。 be-secure-common.cに、入力した秘密のフレーズがSSLで上書きされ、エラーの行（パス）に表示されます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libpqに「password_protocol」パラメータを追加しました</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパッチにより、libpqは接続中に使用されるパスワード転送プロトコルを制御できます。このパラメーターを受け取った後、プロトコルが指定されたものよりも弱い場合、libpqは認証を拒否します。デフォルトでは、このパラメータ</font></font><code>plaintext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまりすべてのプロトコルが適切です。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUNCATEの必須アクセス</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このパッチにより、拡張機能でTRUNCATE操作の必須アクセス制御（MAC）を埋め込むことができます。これに対する権限は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sepgsql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拡張機能によって確認されます</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxリファレンスポリシー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とRedhatベースのLinuxディストリビューションは、db_table {truncate}でのSELinuxチェックをサポートしていません。この場合、sepgsqlは 'deny_unknown'が1で使用され、TRUNCATEは失敗します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GUC ssl_passphrase_commandの可用性</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シンプルだが便利なパッチ。</font><font style="vertical-align: inherit;">これで、ssl_passphrase_commandパラメータの値は、スーパーユーザーのみに表示されます。</font><font style="vertical-align: inherit;">このパラメーターは、SSLファイルを暗号化解除するためにパスワードが必要な場合に呼び出される外部コマンド（例えば、秘密鍵）を指定します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカリゼーション</font></font></h3><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libc照合ルールのバージョン管理</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ICU照合ルールの場合、バージョン番号はデータベースに格納されます。ルールが使用されるたびに（ソート、文字比較）、保存されたバージョン番号がOSのICUライブラリーの現在のバージョンでチェックされ、矛盾がある場合は警告が発行されます。これにより、変更されたソート規則に従って作成された特定のインデックスが正しくない場合があり、再構築する必要があることがわかります。コマンドを使用してインデックスを再構築することにより</font></font><code>ALTER COLLATION ... REFRESH VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、データベース内の並べ替えルールのバージョンが更新され、警告が発行されなくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、それはICUのためだけでした。これでバージョン番号もlibcの並べ替えルールに保存されます。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> collname, collversion <span class="hljs-keyword">FROM</span> pg_collation <span class="hljs-keyword">WHERE</span> collname = <span class="hljs-string">'ru_RU'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> collname | collversion<font></font>
----------+-------------<font></font>
 ru_RU    | 2.27</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、OSでライブラリが変更されたときに警告を発行できます。</font><font style="vertical-align: inherit;">多くのソート規則が変更されたglibc 2.28への移行を考慮して、非常に関連性が高く、対応するインデックスを再構築する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、彼らが2.28に切り替わるまで、すべてが穏やかです。</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLLATION</span> "ru_RU" <span class="hljs-keyword">REFRESH</span> <span class="hljs-keyword">VERSION</span>;</code></pre><br>
<pre><code class="plaintext hljs">NOTICE:  version has not changed<font></font>
ALTER COLLATION</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">全文検索</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ギリシャ語の全文検索</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コメントはありません。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dict_intは絶対値を処理することを学習しまし</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
たdict_intテンプレートディクショナリ（別名拡張）は、数値から符号を削除する機能を追加しました。</font></font><br>
<br>
<pre><code class="pgsql hljs">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> dict_int;
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {-123}<font></font>
(1 row)</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TEXT SEARCH</span> <span class="hljs-keyword">DICTIONARY</span> intdict (ABSVAL = <span class="hljs-keyword">true</span>);
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {123}<font></font>
(1 row)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、今回は絶対値が認識されました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティショニング</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティションテーブルの</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
行トリガーの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;">前</font></b></a><font style="vertical-align: inherit;">バージョン12では</font></font><code>BEFORE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、パーティションテーブルに</font><font style="vertical-align: inherit;">行トリガー</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成できません</font><font style="vertical-align: inherit;">。別のセクション-一度にテーブル全体ではなく、お願いします。これで、</font></font><code>BEFORE FOR EACH ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーティション分割テーブルで作成され</font><font style="vertical-align: inherit;">た</font><font style="vertical-align: inherit;">トリガーは自動的に継承され、すべてのセクションで機能します。しかし、それがのトリガーである</font></font><code>UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合、その中のパーティションキーは現在のセクション内でのみ変更できます。</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">論理レプリケーションでのパーティションテーブルのサポート</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以前は、パブリケーションにパーティションテーブルを含めるとエラーが発生していました。</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PUBLICATION</span> pub <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">TABLE</span> p;</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  "p" is a partitioned table<font></font>
DETAIL:  Adding partitioned tables to publications is not supported.<font></font>
HINT:  You can add the table partitions individually.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今では動作します。</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改良されたセクション結合アルゴリズム</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
11番目のバージョン以降、スケジューラはセクションごとにパーティションテーブルを結合できますが、セクションの境界が正確に一致する場合に限られます。</font><font style="vertical-align: inherit;">アルゴリズムが改善されました。たとえば、1つのテーブルのセクションが別のセクションに完全に含まれている場合、サイズが一致していなくても機能します（たとえば、1つのテーブルが日によってパーティション化され、他のテーブルが月によってパーティション化されている場合）。</font><font style="vertical-align: inherit;">新しいアルゴリズムは、範囲別およびリスト別の分割に使用できます。</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sectional FULL OUTER JOIN Sectionalized join</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
は、フレーズで記録された完全外部結合に対して機能</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">する</font></a></b><font style="vertical-align: inherit;">ようになりました</font></font><code>USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この魅力的で有望であるが困難な分野では、PostgreSQL 12に関して根本的な進歩はありません。</font></font><code>zheap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヒープ以外</font><font style="vertical-align: inherit;">の既製のプラグインストレージはありませんが</font><font style="vertical-align: inherit;">、APIの作業は続行されます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルのサイズを決定する際のより高いレベルの抽象化により、</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Robert Haasはコードを書き直し、アーキテクチャを変更して抽象レイヤーを優先したため、将来コードを複製する必要がなくなります。この部分は</font></font><code>estimate_rel_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-テーブルのレイヤー（フォーク）のサイズを</font><font style="vertical-align: inherit;">指し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relcacheでテーブルアクセスメソッドを使用できます。</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このパッチは、テーブルアクセスメソッドのメモリ管理機能をインデックスメソッドの機能にもたらします。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableamとTOAST</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
TOASTは主に保管用に設計されています</font></font><code>heap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、新しい</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルアクセスメソッド</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を作成するとき</font><font style="vertical-align: inherit;">は、2つの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">方法で行う</font></a><font style="vertical-align: inherit;">ことができます。新しいメソッドの開発者がTOASTレコードを挿入、更新、削除するのを支援するか、TOASTでの作業を従来のPostgreSQLストレージ-ヒープを使用するコードに委任します。</font><font style="vertical-align: inherit;">一連の5つのパッチは、タプルスロットを使用して挿入/更新/削除操作を実装し、双方向の操作を支援します。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsync</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_receivewalおよびpg_recvlogicalでのfsyncエラーの処理fsync</font></font></b></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">（）</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
との戦い</font><font style="vertical-align: inherit;">は続きます。 PostgreSQLは、fsync（）呼び出しが成功すると、ファイル内のすべてのデータがディスクにフラッシュされたことを意味しますが、これは常に発生するわけではなく（OSに依存）、データが失われる可能性があります。 PG13は、ユーティリティ</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">に対処する必要があると判断しました</font><font style="vertical-align: inherit;">。現在、デフォルトの動作は次のとおりです。これらのユーティリティはfsyncエラーをログに書き込み、接続を復元して、何も起こらなかったかのように続行します。その結果、WALには正常にコピーされたファイルに関する情報が含まれていますが、実際には正しくディスクにフラッシュされていませんでした。したがって、ユーティリティを中断することをお勧めします。 pg_dump、pg_basebackup、pg_rewind、およびpg_checksumsの運命についても議論されましたが、これまではこれら2つに限定されていました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>pg_receivewal</code><font style="vertical-align: inherit;"></font><code>pg_recvlogical</code><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsync（）の不正なフラグの設定に対する保護</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このパッチは、fsync（）のファイル記述子を受信したときにフラグが正しく設定されているかどうかをチェックします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックアップとレプリケーション</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リカバリ中にリカバリポイントに到達する前に一時停止するリカバリ</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
中にWALが終了したが</font></font><code>recovery_target_time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">指定したWALに</font><font style="vertical-align: inherit;">到達していない場合、サーバーはリカバリを完了し、通常の動作モードに切り替えます。今はそうではありません。ログに報告されているように、回復プロセスは一時停止し、管理者は欠落しているWALセグメントを挿入して回復を続行することができます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ignore_invalid_pagesパラメータ</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
レプリカのリカバリプロセスで、WALレコード内の無効なページへのリンクが検出されると、</font></font><code>panic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-a</font><font style="vertical-align: inherit;">が発生し</font><font style="vertical-align: inherit;">ます。パラメータを含めると、それを克服するのに役立ちます。</font></font><code>ignore_invalid_pages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。回復は続行され、整合性、データ、およびその他の最も深刻な結果が失われる可能性があります。このパラメーターはサーバー開発者を対象としており、回復を完了してレプリカを開始する必要がある場合に使用する必要があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再起動せずにprimary_conninfoを変更する</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
設定を変更することができますセルゲイKornilovのパッチを、</font></font><code>primary_conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>primary_slot_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>wal_receiver_create_temp_slot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、サーバーを再起動せず。実際、このために、彼ら</font></font><code>recovery.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は12番目のリリースで</font><font style="vertical-align: inherit;">ファイルを放棄し</font><font style="vertical-align: inherit;">ました。</font><font style="vertical-align: inherit;">
Pg_basebackup </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックアップ</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マニフェストは、作成されたバックアップに関する情報（ファイル名とサイズ、必要なWALファイル、およびすべてのチェックサム）を含むJSONファイルを作成するようになりました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいpg_validatebackupユーティリティは、バックアップがマニフェストに準拠しているかどうかを確認し、pg_waldumpユーティリティを使用してリカバリに必要なWALファイルの可用性と正確さも確認します（これは、バックアップ内のWALファイルにのみ適用され、アーカイブには適用されません）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、バックアップファイルが破損または消失した場合や、必要なログファイルがないためにリカバリが不可能になった場合を検出できます。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未読データレプリケーションスロットの制限レプリケーション</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
スロットは便利ですが危険なメカニズムです。クライアントが時間どおりにスロットからデータを読み取らない場合、未読のWALレコードがサーバー上のすべてのスペースを占有する可能性があります。パラメータを使用します</font></font><code>max_slot_wal_keep_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未読データが占有できるディスク領域の最大量に制限を設定できます。</font><font style="vertical-align: inherit;">次のチェックポイントでサイズを超えていることが判明した場合、スロットは無効になり、場所は解放されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィンドウズ</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WindowsでのUnixソケットのサポートUnix</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ドメインソケットはWindows 10でサポートされていますが、デフォルトでは無効になっています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメンテーション</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ドキュメントには2つの新しいアプリケーションがあります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長い</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">議論の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">後</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付録M.用語集が登場しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">用語集には現在101の用語があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数を使用してコンソールユーティリティの診断メッセージの色を強調表示する機能</font></font><code>PG_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は以前のものです。</font><font style="vertical-align: inherit;">これは、今され</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、文書化</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付録N.色のサポート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このパッチにおけるPeter Eisentroutの当初の目的は、カラー化された出力をデフォルトでオンにすることでした。</font><font style="vertical-align: inherit;">そして、これを望まない人のために、変数を明示的に設定することが提案されました</font></font><code>NO_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、パッチについて議論している人の間で、メッセージの色の区別に反対する人が多かった。</font><font style="vertical-align: inherit;">したがって、彼らは利用可能な機会のみを文書化することを決定しました。</font><font style="vertical-align: inherit;">そして、ドキュメントの第1レベルの新しいセクションを取得しました。</font></font><br>
<br>
<hr><br>
<i>        PG13,  ,  PG14     . ,   . .</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493094/index.html">アマゾンの倉庫作業員がコロナウイルスの蔓延を警告</a></li>
<li><a href="../ja493096/index.html">iOSでダークテーマを追加する</a></li>
<li><a href="../ja493098/index.html">ASA VPNロードバランシングクラスターの導入</a></li>
<li><a href="../ja493100/index.html">簡単な方法を見つけることがスタートアップが積極的な成長を達成するのにどのように役立つか</a></li>
<li><a href="../ja493102/index.html">グローバルオートメーションのトレンド：RPA開発</a></li>
<li><a href="../ja493108/index.html">Cloudflareが第10世代エッジサーバーにAMDプロセッサを選択</a></li>
<li><a href="../ja493110/index.html">リモート作業で委任する方法-チームリードなどのガイド</a></li>
<li><a href="../ja493112/index.html">3年ではなく6か月で新しいビジネスを始める方法</a></li>
<li><a href="../ja493114/index.html">データエンジニアによるデータの監視方法</a></li>
<li><a href="../ja493116/index.html">「より多くのインタラクティブ性！」または、TeamLead Conf 2020はいかがでしたか</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>