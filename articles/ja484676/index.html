<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏖️ 👩‍🌾 🌛 IB fakapy 2019-典型的であり、それほどではない 👩🏿‍💼 📘 🤽🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="「でも退屈じゃない！」-これは私たちのソーラーJSOCサイバー脅威監視センターの従業員の非公式のモットーです（そして私は2019がそれに完全に対応したと言わなければなりません）。新年の初めには、多くの人が在庫を取り、新しい目標を設定することを好みますが、代わりに、いくつかの「私たちの町の恐怖」-経験...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IB fakapy 2019-典型的であり、それほどではない</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/484676/"><img src="https://habrastorage.org/webt/o_/ja/qs/o_jaqstiymm03aoz1w6qphpa3zo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「でも退屈じゃない！」</font><font style="vertical-align: inherit;">-これは私たちのソーラーJSOCサイバー脅威監視センターの従業員の非公式のモットーです（そして私は2019がそれに完全に対応したと言わなければなりません）。</font><font style="vertical-align: inherit;">新年の初めには、多くの人が在庫を取り、新しい目標を設定することを好みますが、代わりに、いくつかの「私たちの町の恐怖」-経験豊富なアナリストでさえ感銘を受けた2019年の事件を伝えることにしました。</font><font style="vertical-align: inherit;">これらの物語からの結論はただ1つです。テクノロジーは発展し進化し、人間の怠惰、過失、不注意は永遠です。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲストWifi</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
お客様をモニタリングに接続する際、まず重要な情報（重要なアカウント、ドメイングループ、信頼できないセグメント、ホワイトアドレス、DMZ、重要なサブネットなど）を尋ねます。信頼できないサブネットは、ゲストWi-Fiだけでなく、請負業者のネットワーク、すべてを許可する権限を持つテストセグメントなどです。通常、これらのセグメントを制御するため、これらのセグメントとの相互作用の可能性がないか、または深刻に制限されています。不可能ではないにしても、非常に難しい。お客様のネットワークでは、ゲストネットワークの承認ページを除いて、このような相互作用の可能性はありませんでした。私たちはWi-FiからTOR、C＆Cサーバー、その他の悪霊とのやり取りを禁止することで落ち着き、アラームにさらされないようにしました。これは潜在的な顧客にとって興味がありませんでした（ただし、これらのインシデントに関する統計を収集して要約レポートを作成しました）。パイロットプロジェクトの3日目の朝に、異常が発生しました。ファイアウォールからのイベントのフローが4倍に増加しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ao/gk/dx/aogkdxypbtzzkbsmbnzzwgnh-yo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼らは「閉塞」の原因を探し始め、驚いたことにゲストWi-Fiのセグメントにそれを発見しました。特定のホストが1時間あたり400万（！）のイベントを生成しました。そして、イベントは非常に興味深いです-ランダムな白いインターネットアドレスへのポート445での接続。 400万、カール！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zi/0s/k1/zi0sk1t0jcyqpybqjlxytrrfs54.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DHCP（これは承認サーバーです）がSIEMに接続されていなかったため、これについて顧客に知らせた後、ホストとインシデントに関する情報を待つようになりました。約3〜4時間後、お客様はホストが携帯電話であると報告しました。驚いたと言っても何も言わない。通常の携帯電話では、このような一連のイベントを生成できません。彼らは詳細を見つけ始め、携帯電話はそれとは何の関係もないことが判明しました-誰かが登録されたデバイスの1つをカバーとして使用しただけでした。真の活動の源を見つけることは不可能であり、私たちのクライアントは彼がこのケースに興味がないと言ったので、活動は最小化されなければなりませんでした。それにもかかわらず、私たちはお客様の専門家に潜在的なリスクについて警告しました：（明らかに悪意のある）アクティビティはアドレスからのものであるため、たとえばC＆アンチウイルスベンダーのCサーバーであり、法執行機関から苦情を受け取ります（このホストがスキャンするインフラストラクチャがわからない-KIIが存在する可能性があります。脆弱性スキャンは、州のSOPCAに報告する必要があるインシデントを指します）。このような議論の後、顧客はさらに詳細に理解し、推奨事項を実行することを決定しました。そしてそれらは次のとおりでした：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80と443を除くすべてのポートを閉じます（445の後でポート22のスキャンが続いたため、これは正しい判断でした）、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配られたインターネットの速度に制限を導入し、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーション制御を含むUTMチップをアクティブにし、急流、TORブラウザー、検出されたスキャナーなどの奇妙なカテゴリーをカットします。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間間隔ごとの接続数の制限をオンにします。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顧客はこのアクティブなWi-Fiユーザーが誰であるかを知ることはできませんでしたが、少なくとも彼らは酸素で彼をブロックしました（そしておそらく、攻撃者は次の利用可能なWi-Fiを探しに行きました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数か月後、このパイロットは正常に終了して転送されましたしかし、私たちは今日とはまったく異なる会社で同様のケースに直面しているため、上記の推奨事項はユニバーサルに分類できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトでは、またはベンダーの妨害</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solar JSOCモニタリングへのパイロット接続と並行して、お客様は新しいUTMを委託しました。移行は段階的でした。最初にACLをサブネット経由で転送し、次にアプリケーションポリシーを転送しました。デザートが一番面白い。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
金曜日の夜-すべては古典に従って起こった。 1行目は、TORノードの顧客インフラストラクチャへの連絡における事故を記録し、FinCERTメーリングリストの1つでC＆Cとして表示されました。プロジェクトはパイロットであり、顧客はすべてのインシデントを低重要度に転送したため、メールによる通知以外に、インシデントの通話カードはありませんでした。したがって、異なるホストから1つのアドレスへの最初の操作は、監視エンジニアの間で疑惑を引き起こしましたが、それ以上エスカレートされませんでした。トリップの数が3に達したとき、男たちは何かがおかしいと感じて、事件を担当したアナリストに知らせました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/92/yj/rb/92yjrbhfw46vr3kuadcpyqsbg10.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、アナリストは顧客の責任ある従業員に連絡し、ローカルログレベルでホストを接続してアクティビティのソースを特定するよう提案しました。お客様のスペシャリストとの話し合いの時点で、ホストの数は7に増えていました。状況は伝染病と非常に似ていましたが、ホスト上のウイルス対策は機能していて、静かで、ネットワーク上でアクティブなアクションやホストの相互作用はありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ローカルログレベルで3つのホストを接続しても、どのプロセスがアクティビティを生成したのか理解できませんでした。懸念が高まり、唯一の有効なオプションは、RAMのダンプとハードディスクのイメージを同時に削除してホストを分離することでした。アナリストは指示を準備し始め、同時にホストが他のメールやインシデントで利用できるようにアクセスしたIPをグーグルすることを決定しました（私たちが観察した活動のタイプはFinCERTニュースレターで説明されたものとは異なるため）。ほとんどの場合、このアイデアはかなり悲惨ですが、今回はそうではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイトルの記事に注目が集まり、UTMベンダーのIPアドレスと名前がリストされました。パブリケーションの本質を要約するために、ベンダーは、以前はFinCERTニュースレターで特集されていたTORノードに属していたIPアドレスを購入しました。そして、これだけではありません！さらに、ベンダーは、クライアントのインフラストラクチャから潜在的に悪意のあるアドレスへのすべての不審な呼び出しのリダイレクトのために、このアドレスをデフォルトにすることを決定しました。つまり、奇妙なIPアドレスとの接続は、UTMによって不正と解釈され、この奇跡的なアドレスにリダイレクトされていました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/xg/fu/b4xgfus7ztgevycehvha4zmbmfi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルウェア対策保護モジュールがすでにオンになっているかどうかを指定し、確認を受け取った後、アナリストとお客様の専門家が呼気を出しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS UTMが検出し​​た障害の分析により、7つすべてのアクティビティがFalse Positiveであることが確認されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それぞれのケースについて推奨事項を約束しましたが、ここではおそらく1つだけを示します。金曜日に展開しないでください。</font><font style="vertical-align: inherit;">また、関心を持つ同情者全員に警告します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/vy/nr/yuvynrtns5tf9j5tv9qo_ze8xl8.jpeg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歴史的に</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このleitmotifは、さまざまなケースをまとめます。</font><font style="vertical-align: inherit;">たとえば、廃止措置を取ります。</font><font style="vertical-align: inherit;">多くの場合、企業での関連性を失ったプロセスは単に忘れられます。古いインフラストラクチャを「解析」して、古い仮想マシン、サーバー、ネットワークへのアクセスを残すことはできません。</font><font style="vertical-align: inherit;">同時に、誰もこれらのホスト上の更新、アンチウイルス、およびイベントを監視しておらず、管理者でさえシステムの所有者を知らないことがよくあります。</font><font style="vertical-align: inherit;">したがって、しばらくすると、そのようなインフラストラクチャ要素は、最も楽しい驚きではありません。</font><font style="vertical-align: inherit;">2005年に完成したプロジェクトの環境組織から、非友好的な国のFTPサーバーに重要なテレメトリを送信するだけで、いくらかかりますか。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、10年前のシステムの保守は誰も扱っていませんが、引き続き使用されています。</font><font style="vertical-align: inherit;">たとえば、古代のエンジンを使用し、ユーザーの便宜を図るためのパスワードリセットポータルは、請負業者がビジネスアプリケーションを構成するために5〜6年間使用する必要があるインターネットまたはRDPを調べます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような問題の存在は通常、次の場合に判明します。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホストがハッキングされ、暗号化がさらに強要されました（最近、そのような事件が多数発生しています）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">境界上のあるソリューションから別のソリューションへの移行があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイロットのところに来て、周囲の開いているポートのプロファイルを収集します。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、非常に神秘的な状況があります。2013年に、同社は金融システムを提供する請負業者とトンネルを構築しました。</font><font style="vertical-align: inherit;">契約は終了しましたが、トンネルは残っていました。それは、請負業者がITインフラストラクチャーとともに建物を借りた会社によって作成されたためです。</font><font style="vertical-align: inherit;">新しい会社が同じ場所を取り、他の人々のインフラの利用可能なアドレスを見つけて驚いた。</font><font style="vertical-align: inherit;">好奇心が引き継いだ後、誘惑と利益への渇望。</font><font style="vertical-align: inherit;">彼らは取引相手と契約のデータベースを破棄しました-競合他社の利益は興味深いものでしたが、被害者の会社では誰も騒いでいませんでした。</font><font style="vertical-align: inherit;">物語は1年以上続きました（丸太に沿ってさらに追跡することは不可能でした）が、結局のところ、調査、解雇、ケーキのチェリーは刑事事件です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWOL、またはより便利だから</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体としてのケースはかなり取るに足らないものであり、「実装方法論」については言えません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与えられた：</font></font><br>
<br>
<ol>
<li>     ;</li>
<li>   ,       ;</li>
<li>,         ;</li>
<li>    ,       .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに述べたように、接続するときは、インターネットからの接続に関する統計を収集して外部境界プロファイルを形成するために、白いアドレスを含むさまざまな情報をお客様に求めます。 SIEMのリストを満たすルールを作成したら、約1〜2週間で、境界で開いているすべてのポートに関する統計を収集し、それを顧客にアップロードして、一緒に監視および修正します（不正なものを閉じながら）。プロファイルの情報を収集し、定期的にリストを調べて、ポートがホワイトリストのすべてまたは一部のアドレスに対してのみ開かれていることを確認しました。目立たないように見えたポート43388に注意が向けられましたが、3389と灰色の住所で放送されました。その所有者は当時は不明でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チェックしたところ、私たちの住所に閉じていることがわかりました。私たちは彼がホワイトリストに参加していると思っていましたが、日中は接続が1つも成功していませんでした。翌朝到着したとき、彼らはまた、イベントのパックが一夜に到着したことに気づきました。今回は、送信元アドレスを詳しく調べ、合計時間が5時間を超えるモスクワからのセッションがいくつかあり、世界中からの短いセッションがかなり多数ありました。次に、ポートがホワイトリストのアドレスにのみアクセス可能であるということではなく、夜間のみオープンすることがポイントであることが明らかになりました。ドメインとアンチウイルス（その時までに接続されたばかり）からのログを調べたところ、そのアドレスがこの期間中に職場にいる必要のある当番の管理者のものであることに驚きました！彼の車からのつながりを分析した後、彼らは別の興味深い状況を発見しました：閉じた専用セグメントで毎晩ポートが開かれました（どちらを推測するかは難しくないと思います）。パイロットの4日目には、そのようなアクティビティに気付くことはほとんど不可能です。そのときまでに、セグメント間の許可された接続の数は、境界で開いているポートよりも多いです。警備員に状況を知らせた後、ローカルログレベルでホストに接続し、管理者が静かに仕事から家に帰るようにしました。結局のところ、彼はほとんど隣の家に住んでいて、もちろんリモート接続はあまりにも魅力的なものになりました。その時までに、セグメント間の許可された接続の数は、まだ境界で開いているポートよりも多くなります。警備員に状況を知らせた後、ローカルログレベルでホストに接続し、管理者が静かに仕事から家に帰るようにしました。結局のところ、彼はほとんど隣の家に住んでいて、もちろんリモート接続はあまりにも魅力的なものになりました。その時までに、セグメント間の許可された接続の数は、まだ境界で開いているポートよりも多くなります。警備員に状況を知らせた後、ローカルログレベルでホストに接続し、管理者が静かに仕事から家に帰るようにしました。結局のところ、彼はほとんど隣の家に住んでいて、もちろんリモート接続はあまりにも魅力的なものになりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、管理者が状況を説明した場合、事故発生時に15分以内に出社でき、問題がなければ、SKDPUを介してリモートで作業することが許可されます。 </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">合計</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現実には、情報セキュリティに対する主な脅威の1つは地上での攻撃です。</font><font style="vertical-align: inherit;">したがって、リスクを最小限に抑えます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">境界とファイアウォールの構成を追跡します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会社内のリモートを管理できるようにしてください（ターミナルサーバー経由のVPN）。</font><font style="vertical-align: inherit;">すでに存在する場合は、それを使用しているユーザーを制御します（ほとんどすべてのウイルス対策エンジンを簡単に検出できるように、ホスト上のさまざまなRATを削除します）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特権ユーザーの行動を追跡します。非常に多くの場合、監視を失い、すべてが制御されていると信じ、攻撃者が重要なデータに簡単にアクセスできるようにします。</font></font></li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja484664/index.html">Android向けのもう1つの[ほぼ]削除できないトロイの木馬</a></li>
<li><a href="../ja484666/index.html">CES 2020での新しいDellとAlienware：主な発表の概要</a></li>
<li><a href="../ja484668/index.html">製品マインドセット製品思考プログラムの概要</a></li>
<li><a href="../ja484670/index.html">PostgreSQLアンチパターン：珍しいレコードがJOINの真ん中に到達する</a></li>
<li><a href="../ja484672/index.html">ハニポタンスがハッカーとオンライン詐欺師を匿名化する方法</a></li>
<li><a href="../ja484678/index.html">JetBrains Research Labsでの公開講義</a></li>
<li><a href="../ja484680/index.html">Andrew Unの本、機械学習への情熱、第33章の翻訳</a></li>
<li><a href="../ja484686/index.html">抵抗器が色で示されているのはなぜですか？</a></li>
<li><a href="../ja484688/index.html">計算能力の限界に近づいています-新しいプログラマが必要です</a></li>
<li><a href="../ja484690/index.html">セミナー、会議、mitap：18,000イベントの統計の研究</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>