<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘— ğŸ™ğŸ» ğŸ˜§ Penciptaan Minecraft dalam Satu Minggu dalam C ++ dan Vulkan ğŸš¦ â²ï¸ ğŸ•¡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya mengatur sendiri tugas membuat ulang Minecraft dari awal dalam satu minggu menggunakan mesin saya sendiri di C ++ dan Vulkan. Saya terinspirasi o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Penciptaan Minecraft dalam Satu Minggu dalam C ++ dan Vulkan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487832/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya mengatur sendiri tugas membuat ulang Minecraft dari awal dalam satu minggu menggunakan mesin saya sendiri di C ++ dan Vulkan. </font><font style="vertical-align: inherit;">Saya terinspirasi oleh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hopson</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang melakukan hal yang sama dengan C ++ dan OpenGL. </font><font style="vertical-align: inherit;">Pada gilirannya, dia terinspirasi oleh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shane Beck</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang terinspirasi oleh Minecraft, sumber inspirasi yang untuknya adalah Infiniminer, yang ciptaannya, mungkin, diilhami oleh penambangan nyata.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa1/8b2/50c/aa18b250ce4120bd3a0dc94c01a63621.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repositori GitHub untuk proyek ini ada di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Setiap hari memiliki tag git sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, saya tidak berencana untuk membuat ulang Minecraft secara harfiah. </font><font style="vertical-align: inherit;">Proyek ini seharusnya menjadi proyek pendidikan. </font><font style="vertical-align: inherit;">Saya ingin belajar tentang menggunakan Vulkan dalam sesuatu yang lebih rumit daripada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vulkan-tutorial.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau demo Sasha Willem. </font><font style="vertical-align: inherit;">Oleh karena itu, penekanan utama adalah pada desain mesin Vulkan, dan bukan pada desain game.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengembangan pada Vulkan jauh lebih lambat daripada di OpenGL, jadi saya tidak bisa memasukkan banyak fitur Minecraft ini ke dalam gim. </font><font style="vertical-align: inherit;">Tidak ada massa, tidak ada kerajinan, tidak ada batu merah, tidak ada fisika blok, dll. </font><font style="vertical-align: inherit;">Sejak awal, tujuan proyek adalah sebagai berikut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuat sistem render medan</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menumbuk</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Petir</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuat sistem generator medan</font></font><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bantuan</font></font></li>
</ul><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pohon</font></font></li>
</ul><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bioma</font></font></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan kemampuan untuk mengubah medan dan memindahkan blok</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya perlu menemukan cara untuk mengimplementasikan semua ini tanpa menambahkan GUI ke dalam game, karena saya tidak dapat menemukan perpustakaan GUI yang bekerja dengan Vulkan dan mudah diintegrasikan.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perpustakaan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, saya tidak akan menulis aplikasi Vulkan dari awal. </font><font style="vertical-align: inherit;">Untuk mempercepat proses pengembangan, saya akan menggunakan perpustakaan yang sudah jadi jika memungkinkan. </font><font style="vertical-align: inherit;">Yaitu:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VulkanWrapper</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pembungkus C ++ saya sendiri untuk Vulkan API</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLFW</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk windows dan input pengguna</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VulkanMemoryAllocator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk mengalokasikan memori Vulkan</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk vektor dan matriks matematika</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk sinyal / slot dan ECS</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk utilitas pemuatan gambar</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FastNoise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - untuk menghasilkan suara 3D</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari 1</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada hari pertama, saya menyiapkan pelat Vulkan dan kerangka mesin. </font><font style="vertical-align: inherit;">Sebagian besar kode adalah boilerplate dan saya bisa menyalinnya dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vulkan-tutorial.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini juga termasuk trik dengan menyimpan data vertex sebagai bagian dari shader vertex. </font><font style="vertical-align: inherit;">Ini berarti bahwa saya bahkan tidak perlu menyetel alokasi memori. </font><font style="vertical-align: inherit;">Hanya konveyor sederhana yang hanya bisa melakukan satu hal: menggambar segitiga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesinnya cukup sederhana untuk mendukung renderer segitiga. </font><font style="vertical-align: inherit;">Ini memiliki satu jendela dan loop game yang sistemnya dapat dihubungkan. </font><font style="vertical-align: inherit;">GUI dibatasi oleh frame rate yang ditampilkan dalam judul jendela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Proyek ini dibagi menjadi dua bagian: </font></font><code>VoxelEngine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>VoxelGame</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/875/3cd/190/8753cd190975239ad550e8c0c8b27d00.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ke-2</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengintegrasikan perpustakaan Vulkan Memory Allocator. </font><font style="vertical-align: inherit;">Perpustakaan ini menangani sebagian besar pelat alokasi alokasi memori Vulkan: tipe memori, tumpukan memori perangkat, dan alokasi sekunder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang saya memiliki alokasi memori, saya membuat kelas untuk jerat dan buffer verteks. </font><font style="vertical-align: inherit;">Saya mengubah renderer segitiga sehingga menggunakan kelas jerat, dan bukan array yang dibangun ke dalam shader. </font><font style="vertical-align: inherit;">Saat ini, data mesh ditransfer ke GPU dengan memberikan segitiga secara manual.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/627/28d/0fc/62728d0fce9015f2be4dad88f18c7b7a.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit yang berubah</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ke-3</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menambahkan sistem rendering grafik. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Posting ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diambil sebagai dasar untuk membuat kelas ini </font><font style="vertical-align: inherit;">, tetapi kelasnya sangat disederhanakan. Grafik rendering saya hanya berisi hal-hal penting untuk menangani sinkronisasi dengan Vulkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grafik rendering memungkinkan saya untuk mengatur </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">node</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">edge</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Node adalah pekerjaan yang dilakukan oleh GPU. Rusuk adalah ketergantungan data antara node. Setiap node menerima buffer instruksi sendiri, di mana ia menulis. Grafik terlibat dalam buffer perintah buffering ganda dan menyinkronkannya dengan frame sebelumnya. Tepi digunakan untuk secara otomatis memasukkan penghalang konveyor sebelum dan sesudah sebuah node menulis ke setiap buffer instruksi. Hambatan pipa menyinkronkan penggunaan semua sumber daya dan mentransfer kepemilikan antar antrian. Selain itu, tepi menyisipkan semaphores antara node. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Node dan edge membentuk </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grafik asiklik terarah</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian grafik rendering melakukan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penyortiran topologis.</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">node, yang mengarah ke pembuatan daftar datar node yang diurutkan sehingga setiap node berjalan setelah semua node yang bergantung padanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesin memiliki tiga jenis node. </font></font><code>AcquireNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menerima gambar dari rantai buffer (swapchain), </font></font><code>TransferNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mentransfer data dari CPU ke GPU, dan </font></font><code>PresentNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyediakan gambar rantai buffer untuk ditampilkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap node dapat diimplementasikan </font></font><code>preRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>render</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>postRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang dieksekusi di setiap frame. </font></font><code>AcquireNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mendapat gambar rantai buffer selama </font></font><code>preRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>PresentNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyediakan gambar ini tepat waktu </font></font><code>postRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya refactored renderer segitiga sehingga menggunakan sistem grafik rendering, daripada memproses semuanya sendiri. Ada keunggulan antara </font></font><code>AcquireNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan</font></font><code>TriangleRenderer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serta antara </font></font><code>TriangleRenderer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>PresentNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini memastikan bahwa gambar rantai penyangga disinkronkan dengan benar selama penggunaannya selama bingkai.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/12b/d88/6ba/12bd886ba9b41891ae1e2d0ff47b9929.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya bersumpah di dalam mesin telah berubah</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ke 4</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya membuat kamera dan sistem render 3D. Sejauh ini, kamera menerima buffer dan deskriptor kumpulan yang persisten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya melambat hari itu karena saya mencoba mencari konfigurasi yang tepat untuk rendering 3D dengan Vulkan. Sebagian besar materi daring berfokus pada rendering menggunakan OpenGL, yang menggunakan sistem koordinat yang sedikit berbeda dari Vulkan. Di OpenGL, sumbu Z dari ruang klip ditentukan sebagai </font></font><code>[-1, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan tepi atas layar berada di </font></font><code>Y = 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Di Vulkan, sumbu Z ditentukan sebagai </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan tepi atas layar berada di </font></font><code>Y = -1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Karena perbedaan kecil ini, matriks proyeksi GLM standar tidak berfungsi dengan benar karena dirancang untuk OpenGL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GLM memiliki opsi</font></font><code>GLM_FORCE_DEPTH_ZERO_TO_ONE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menghilangkan masalah dengan sumbu Z. Setelah itu, masalah dengan sumbu Y dapat dihilangkan dengan hanya mengubah tanda elemen </font></font><code>(1, 1)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matriks proyeksi (GLM menggunakan pengindeksan dari 0). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika kita membalik sumbu Y, maka kita perlu membalik data verteks, karena sebelum itu, arah negatif dari sumbu Y mengarah ke atas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d9/05d/464/8d905d4643a189400471c7e8d4fbd3f6.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang dalam 3D!</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ke 5</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menambahkan input pengguna dan kemampuan untuk memindahkan kamera dengan mouse. </font><font style="vertical-align: inherit;">Sistem input terlalu canggih, tetapi menghilangkan keanehan input GLFW. </font><font style="vertical-align: inherit;">Secara khusus, saya punya masalah mengubah posisi mouse sambil memblokirnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Input keyboard dan mouse pada dasarnya adalah pembungkus tipis di atas GLFW, dibuka melalui penangan sinyal </font></font><code>entt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai perbandingan - tentang hal yang sama yang dilakukan Hopson pada hari pertama proyeknya.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser Anda tidak mendukung video HTML5.</font></font><source src="https://vazgriz.com/wp-content/uploads/2020/01/voxels.webm" type="video/webm"></video></div></div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari 6</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mulai menambahkan kode untuk menghasilkan dan merender blok voxel. </font><font style="vertical-align: inherit;">Menulis kode meshing itu mudah karena saya melakukannya sebelumnya dan tahu abstraksi yang memungkinkan saya untuk membuat lebih sedikit kesalahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu abstraksi adalah kelas templat </font></font><code>ChunkData&lt;T, chunkSize&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang mendefinisikan kubus dengan tipe </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ukuran </font></font><code>chunkSize</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">masing-masing sisi. </font><font style="vertical-align: inherit;">Kelas ini menyimpan data dalam larik 1D dan memproses pengindeksan data dengan koordinat 3D. </font><font style="vertical-align: inherit;">Ukuran setiap blok adalah 16 x 16 x 16, sehingga data internal adalah array sederhana dengan panjang 4.096 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Abstraksi lain adalah membuat iterator posisi yang menghasilkan koordinat dari </font></font><code>(0, 0, 0)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hingga</font></font><code>(15, 15, 15)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kedua kelas ini memastikan bahwa iterasi dengan blok data dilakukan dalam urutan linear untuk meningkatkan lokalitas cache. </font><font style="vertical-align: inherit;">Koordinat 3D masih tersedia untuk operasi lain yang membutuhkannya. </font><font style="vertical-align: inherit;">Contohnya:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (glm::ivec3 pos : Chunk::Positions()) {
    <span class="hljs-keyword">auto</span>&amp; data = chunkData[pos];<font></font>
    glm::ivec3 offset = ...;<font></font>
    <span class="hljs-keyword">auto</span>&amp; neighborData = chunkData[pos + offset];<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memiliki beberapa array statis yang menentukan offset yang biasa digunakan dalam game. </font><font style="vertical-align: inherit;">Sebagai contoh, ia </font></font><code>Neighbors6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mendefinisikan 6 tetangga dengan kubus memiliki wajah yang sama.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;glm::ivec3, 6&gt; Neighbors6 = {<font></font>
        glm::ivec3(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),    <span class="hljs-comment">//right</span>
        glm::ivec3(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),   <span class="hljs-comment">//left</span>
        glm::ivec3(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>),    <span class="hljs-comment">//top</span>
        glm::ivec3(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>),   <span class="hljs-comment">//bottom</span>
        glm::ivec3(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>),    <span class="hljs-comment">//front</span>
        glm::ivec3(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>)    <span class="hljs-comment">//back</span>
    };</code></pre><br>
<code>Neighbors26</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- semua ini adalah tetangga yang memiliki kubus, wajah, tepi atau simpul yang sama. </font><font style="vertical-align: inherit;">Yaitu, itu adalah kotak 3x3x3 tanpa kubus pusat. </font><font style="vertical-align: inherit;">Ada juga array serupa untuk set tetangga lain dan untuk set 2D tetangga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada array yang mendefinisikan data yang dibutuhkan untuk membuat satu wajah kubus. </font><font style="vertical-align: inherit;">Arah setiap wajah dalam array ini sesuai dengan arah dalam array </font></font><code>Neighbors6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">array</span>&lt;FaceArray, 6&gt; NeighborFaces = {
    <span class="hljs-comment">//right face</span><font></font>
    FaceArray {<font></font>
        glm::ivec3(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<font></font>
        glm::ivec3(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>),<font></font>
        glm::ivec3(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>),<font></font>
        glm::ivec3(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),<font></font>
    },<font></font>
    ...<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berkat ini, kode kreasi mesh sangat sederhana. Itu hanya mem-bypass data blok dan menambahkan wajah ketika blok solid, tetapi tetangganya tidak. Kode hanya memeriksa setiap wajah dari setiap kubus di blok. Ini mirip dengan metode "naif" yang dijelaskan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (glm::ivec3 pos : Chunk::Positions()) {<font></font>
    Block block = chunk.blocks()[pos];<font></font>
    <span class="hljs-keyword">if</span> (block.type == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<font></font>
<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; Chunk::Neighbors6.size(); i++) {<font></font>
        glm::ivec3 offset = Chunk::Neighbors6[i];<font></font>
        glm::ivec3 neighborPos = pos + offset;<font></font>
<font></font>
        <span class="hljs-comment">//<span class="hljs-doctag">NOTE:</span> bounds checking omitted</span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> (chunk.blocks()[neighborPos].type == <span class="hljs-number">0</span>) {<font></font>
            Chunk::FaceArray&amp; faceArray = Chunk::NeighborFaces[i];<font></font>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> j = <span class="hljs-number">0</span>; j &lt; faceArray.size(); j++) {<font></font>
                m_vertexData.push_back(pos + faceArray[j]);<font></font>
                m_colorData.push_back(glm::i8vec4(pos.x * <span class="hljs-number">16</span>, pos.y * <span class="hljs-number">16</span>, pos.z * <span class="hljs-number">16</span>, <span class="hljs-number">0</span>));<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya diganti </font></font><code>TriangleRenderer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan </font></font><code>ChunkRenderer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Saya juga menambahkan buffer kedalaman sehingga blok jala dapat dirender dengan benar. Itu perlu untuk menambahkan satu sisi lagi ke grafik rendering antara </font></font><code>TransferNode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>ChunkRenderer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tepi ini mentransfer kepemilikan sumber daya keluarga antrian antara antrian transfer dan antrian grafis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu saya mengganti mesinnya sehingga bisa menangani acara perubahan jendela dengan benar. Dalam OpenGL, ini dilakukan secara sederhana, tetapi agak membingungkan di Vulkan. Karena rantai buffer harus dibuat secara eksplisit dan memiliki ukuran konstan, ketika Anda mengubah ukuran jendela, Anda perlu membuatnya kembali. Anda harus membuat ulang semua sumber daya yang bergantung pada rantai penyangga.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua perintah yang bergantung pada rantai penyangga (dan sekarang ini semua perintah menggambar) harus menyelesaikan eksekusi sebelum menghancurkan rantai penyangga yang lama. </font><font style="vertical-align: inherit;">Ini berarti bahwa seluruh GPU akan menganggur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda perlu mengubah jalur grafik untuk memberikan viewport dinamis dan mengubah ukuran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rantai penyangga tidak dapat dibuat jika ukuran jendela adalah 0 pada sumbu X atau Y. Termasuk ketika jendela diminimalkan. </font><font style="vertical-align: inherit;">Yaitu, ketika ini terjadi, seluruh permainan dihentikan sementara dan berlanjut hanya ketika jendela terbuka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mesh adalah papan catur tiga dimensi sederhana. </font><font style="vertical-align: inherit;">Warna RGB dari mesh diatur sesuai dengan posisi XYZ-nya dikalikan 16.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser Anda tidak mendukung video HTML5.</font></font><source src="https://vazgriz.com/wp-content/uploads/2020/01/voxels2.webm" type="video/webm"></video></div></div></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ke 7</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya membuat proses permainan bukan hanya satu, tetapi beberapa blok sekaligus. Beberapa blok dan jeratnya dikelola oleh perpustakaan ECS </font></font><code>entt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Kemudian saya refactored renderer blok sehingga memberikan semua blok yang ada di ECS. Saya hanya memiliki satu blok, tetapi saya </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bisa</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menambahkan yang baru jika perlu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya refactored mesh sehingga datanya dapat diperbarui setelah itu dibuat. Ini akan memungkinkan saya untuk memperbarui blokir blok di masa depan ketika saya menambahkan kemampuan untuk menambah dan menghapus kubus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat Anda menambah atau menghapus kubus, jumlah simpul di jala berpotensi meningkat atau berkurang. Buffer vertex yang dipilih sebelumnya hanya dapat digunakan jika mesh baru memiliki ukuran yang sama atau lebih kecil. Tetapi jika mesh lebih besar, maka buffer vertex baru harus dibuat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buffer vertex sebelumnya tidak dapat segera dihapus. Mungkin ada buffer instruksi yang dieksekusi dari frame sebelumnya yang khusus untuk objek tertentu </font></font><code>VkBuffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mesin harus menyimpan buffer sampai buffer perintah ini selesai. Artinya, jika kita menggambar mesh dalam sebuah frame </font></font><code>i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, GPU dapat menggunakan buffer ini sebelum frame dimulai </font></font><code>i + 2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Buffer tidak dapat dihapus dari CPU sampai GPU selesai menggunakannya. Jadi saya mengubah grafik rendering sehingga melacak masa pakai sumber daya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika simpul grafik render ingin menggunakan sumber daya (buffer atau gambar), maka simpul itu harus memanggil metode </font></font><code>sync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di dalam metode tersebut </font></font><code>preRender</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Metode ini mendapatkan pointer </font></font><code>shared_ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke sumber daya. Ini</font></font><code>shared_ptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memastikan bahwa sumber daya tidak akan dihapus saat buffer perintah dieksekusi. </font><font style="vertical-align: inherit;">(Dalam hal kinerja, solusi ini tidak terlalu baik. Lebih lanjut tentang ini nanti.) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang blok jala dibuat ulang di setiap frame.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser Anda tidak mendukung video HTML5.</font></font><source src="https://vazgriz.com/wp-content/uploads/2020/01/voxels3.webm" type="video/webm"></video></div></div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu semua yang saya lakukan dalam seminggu - menyiapkan dasar-dasar rendering dunia dengan beberapa blok voxel dan akan terus bekerja di minggu kedua.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id487812/index.html">Pengujian Led Spectrum Led Polandia E27</a></li>
<li><a href="../id487814/index.html">Kecepatan dan keandalan lebih tinggi, dan harganya lebih rendah. Kingston KC2000 Solid State Drive Baru</a></li>
<li><a href="../id487822/index.html">AvitoTech On Tour: Pertemuan Android di Nizhny Novgorod</a></li>
<li><a href="../id487824/index.html">Tinjauan umum lampu LED Spectrum Led GU10 dari Eropa</a></li>
<li><a href="../id487826/index.html">Tinjauan umum lampu LED dari Led Spectrum Polandia E14</a></li>
<li><a href="../id487834/index.html">Security Week 07: Kerentanan Stack Android Bluetooth</a></li>
<li><a href="../id487836/index.html">Unggahan file secara interaktif ke server menggunakan RxJS</a></li>
<li><a href="../id487838/index.html">Validasi Data: Suatu Pendekatan Yang Berbeda</a></li>
<li><a href="../id487842/index.html">2 SIM untuk router negara - apakah banyak atau sedikit?</a></li>
<li><a href="../id487844/index.html">Bau itu mengungkapkan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>