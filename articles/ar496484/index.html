<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ป ๐ โ๐พ ุงุฎุชูุงุฑ ุฃูููุฉ ุงูููุฒุงุช ูุฃูุฑุจ ุงูุฌูุฑุงู (ุฌูุฏูุง ุฃู ูุนููุงุช ููุฑุทุฉ ุฃุฎุฑู) ุญุณุจ ุฃุตู ูุดุงุจู ููุชุฏุฑุฌ ๐๐ฟ ๐ ๐ฉ๐ฝโ๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุนูุฏ ุชุฌุฑุจุฉ ุฃุจุณุท ูููุฉ ููุชุนูู ุงูุขูู ุ ูุฌุฏุช ุฃูู ุณูููู ูู ุงููุซูุฑ ููุงูุชูุงู ุงุฎุชูุงุฑ 18 ูุนููุงุช ููุฑุทุฉ ูู ููุณ ุงูููุช ูู ูุทุงู ูุงุณุน ุฅูู ุญุฏ ูุง. ูู ุญุงูุชู ุ ูุงู ูู ุดูุก...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุงุฎุชูุงุฑ ุฃูููุฉ ุงูููุฒุงุช ูุฃูุฑุจ ุงูุฌูุฑุงู (ุฌูุฏูุง ุฃู ูุนููุงุช ููุฑุทุฉ ุฃุฎุฑู) ุญุณุจ ุฃุตู ูุดุงุจู ููุชุฏุฑุฌ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496484/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/eg/qm/x6/egqmx63h8mgrbxfytg9nmuaby-g.gif" alt="ุฅู ุงููุฑุงุก ุงูุญูููู ูุง ูููู ุฃู ูุญูู ุงููุณุชุญูู ูุญุณุจ ุ ุจู ูุนูู ุฃูุถูุง ููุซุงู ุชุญุฐูุฑู"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุชุฌุฑุจุฉ ุฃุจุณุท ูููุฉ ููุชุนูู ุงูุขูู ุ ูุฌุฏุช ุฃูู ุณูููู ูู ุงููุซูุฑ ููุงูุชูุงู ุงุฎุชูุงุฑ 18 ูุนููุงุช ููุฑุทุฉ ูู ููุณ ุงูููุช ูู ูุทุงู ูุงุณุน ุฅูู ุญุฏ ูุง. ูู ุญุงูุชู ุ ูุงู ูู ุดูุก ุจุณูุทูุง ุฌุฏูุง ุจุญูุซ ูููู ุฅูุฌุงุฒ ุงููููุฉ ุจููุฉ ุงูููุจููุชุฑ ุงูุบุงุดูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุชุนูู ุดูุก ูุง ุ ูุฏ ูููู ูู ุงููุซูุฑ ููุงูุชูุงู ุงุฎุชุฑุงุน ููุน ูู ุงูุฏุฑุงุฌุงุช. ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุชุจูู ููุง ุฃู ูุฎุฑุฌ ุจุดูุก ุฌุฏูุฏ. ูู ุจุนุถ ุงูุฃุญูุงู ุงุชุถุญ ุฃู ูู ุดูุก ุงุฎุชุฑุน ูุจูู. ูููู ุญุชู ูู ูุฑุฑุช ุงููุณุงุฑ ุงูุฐู ูุทุนุชู ุฃูุงูู ููุชุฑุฉ ุทูููุฉ ุ ูุฅู ุงูููุงูุฃุฉ ุบุงูุจูุง ูุง ุฃููู ุงูุขููุงุช ุงูุฃุณุงุณูุฉ ูุฎูุงุฑุฒููุงุช ูุฏุฑุงุชูุง ูุญุฏูุฏูุง ุงูุฏุงุฎููุฉ. ุงูุฐู ุฃุฏุนูู ุฅููู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู Python ู DS ุ ุจุดูู ูุนุชุฏู ุ ุฃูุง ูุจุชุฏุฆ ุ ูุฃููู ุจุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุงูุชู ูููู ุชูููุฐูุง ูู ูุฑูู ูุงุญุฏ ููููุง ูุนุงุฏุชู ุงูุจุฑูุฌูุฉ ุงููุฏููุฉ ุ ูุงูุชู ูุนุงูุจูุง Python ุจุงูุชุจุงุทุค ุ ููุณ ูู ุจุนุถ ุงูุฃุญูุงู ุ ูููู ุจุฃูุงูุฑ ูู ุงูุญุฌู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุฃููู ุจุชุญููู ูู ุงูููุฏ ุงูุฎุงุต ุจู ุฅูู ุงููุณุชูุฏุน. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุนุฑู ููููุฉ ุชูููุฐูุง ุจุดูู ุฃูุซุฑ ูุงุนููุฉ - ููุง ุชุฎุฌู ุฃู ุชุนุฏู ููุงู ุฃู ุชูุชุจ ูู ุงูุชุนูููุงุช. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/kraidiky/GDforHyperparameters</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ุฃููุฆู ุงูุฐูู ูู ุจุงููุนู ููุงู ุจูุงูุงุช ุฑุงุฆุน ูุฌุฑุจูุง ูู ุดูุก ูู ูุฐู ุงูุญูุงุฉ ุณูููููู ูุซูุฑูู ููุงูุชูุงู ุ ุนูู ูุง ุฃุนุชูุฏ ุ ุชุตูุฑ ุนูููุฉ ุงูุชุนูู ุ ุงูุชู ูุง ุชูุทุจู ููุท ุนูู ูุฐู ุงููููุฉ.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุตูุงุบุฉ ุงููุดููุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ุฏูุฑุฉ ุฌูุฏุฉ ูู DS ูู ODS.ai ูููุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุตููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุญุงุถุฑุฉ ุงูุซุงูุซุฉ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุ ุฃุดุฌุงุฑ ุงููุฑุงุฑ ูุทุฑููุฉ ุฃูุฑุจ ุงูุฌูุฑุงู</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููุงู ุ ูุธูุฑ ุนูู ุงูุจูุงูุงุช ุงูุจุณูุทุฉ ููุบุงูุฉ ูุฑุจูุง ุงูุงุตุทูุงุนูุฉ ููู ุฃู ุฃุจุณุท ุดุฌุฑุฉ ูุฑุงุฑ ุชุนุทู ุฏูุฉ 94.5 ูช ุ ูููุณ ุงูุทุฑููุฉ ุงูุจุณูุทุฉ ููุบุงูุฉ ูุฃูุฑุจ ุงูุฌูุฑุงู ุชุนุทู 89 ูช ุจุฏูู ุฃู ูุนุงูุฌุฉ ูุณุจูุฉ</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชูุฑุงุฏ ูุชุญููู ุงูุจูุงูุงุช</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<font></font>
%matplotlib inline<font></font>
<span class="hljs-keyword">import</span> warnings<font></font>
warnings.filterwarnings(<span class="hljs-string">'ignore'</span>)<font></font>
<font></font>
df = pd.read_csv(<span class="hljs-string">'data/telecom_churn.csv'</span>)<font></font>
df[<span class="hljs-string">'Voice mail plan'</span>] = pd.factorize(df[<span class="hljs-string">'Voice mail plan'</span>])[<span class="hljs-number">0</span>]<font></font>
df[<span class="hljs-string">'International plan'</span>] = pd.factorize(df[<span class="hljs-string">'International plan'</span>])[<span class="hljs-number">0</span>]<font></font>
df[<span class="hljs-string">'Churn'</span>] = df[<span class="hljs-string">'Churn'</span>].astype(<span class="hljs-string">'int32'</span>)<font></font>
states = df[<span class="hljs-string">'State'</span>]<font></font>
y = df[<span class="hljs-string">'Churn'</span>]<font></font>
df.drop([<span class="hljs-string">'State'</span>,<span class="hljs-string">'Churn'</span>], axis = <span class="hljs-number">1</span>, inplace=<span class="hljs-literal">True</span>)<font></font>
df.head()<font></font>
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฑู ุงูุฎุดุจ ูุน knn</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split, StratifiedKFold
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier
<span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV, cross_val_score
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> accuracy_score<font></font>
<font></font>
X_train, X_holdout, y_train, y_holdout = train_test_split(df.values, y, test_size=<span class="hljs-number">0.3</span>,<font></font>
random_state=<span class="hljs-number">17</span>)<font></font>
<font></font>
tree = DecisionTreeClassifier(random_state=<span class="hljs-number">17</span>, max_depth=<span class="hljs-number">5</span>)<font></font>
knn = KNeighborsClassifier(n_neighbors=<span class="hljs-number">10</span>)<font></font>
<font></font>
tree_params = {<span class="hljs-string">'max_depth'</span>: range(<span class="hljs-number">1</span>,<span class="hljs-number">11</span>), <span class="hljs-string">'max_features'</span>: range(<span class="hljs-number">4</span>,<span class="hljs-number">19</span>)}<font></font>
tree_grid = GridSearchCV(tree, tree_params, cv=<span class="hljs-number">10</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
tree_grid.fit(X_train, y_train)<font></font>
tree_grid.best_params_, tree_grid.best_score_, accuracy_score(y_holdout, tree_grid.predict(X_holdout))<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
({'max_depth': 6ุ 'max_features': 16}ุ 0.944706386626661ุ 0.945)</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ knn</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-keyword">from</span> sklearn.pipeline <span class="hljs-keyword">import</span> Pipeline
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler<font></font>
<font></font>
knn_pipe = Pipeline([(<span class="hljs-string">'scaler'</span>, StandardScaler()), (<span class="hljs-string">'knn'</span>, KNeighborsClassifier(n_jobs=<span class="hljs-number">-1</span>))])<font></font>
knn_params = {<span class="hljs-string">'knn__n_neighbors'</span>: range(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)}<font></font>
knn_grid = GridSearchCV(knn_pipe, knn_params, cv=<span class="hljs-number">10</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
<font></font>
knn_grid.fit(X_train, y_train)<font></font>
knn_grid.best_params_, knn_grid.best_score_, accuracy_score(y_holdout, knn_grid.predict(X_holdout))<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
({'knn__n_neighbors': 9}ุ 0.8868409772824689ุ 0.891) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงููุฑุญูุฉ ุ ุดุนุฑุช ุจุงูุฃุณู ุนูู knn ุงูุฐู ูุงู ูู ุงููุงุถุญ ุฃูู ุบูุฑ ุฃููู ุ ูุฃูู ูู ููู ูุฏููุง ุนูู ูุน ุงููููุงุณ. </font><font style="vertical-align: inherit;">ูู ุฃููุฑ ุจุนููู ุ ููุฏ ุฃุฎุฐุช ููุฒุฉ ุงูููุฒุงููุงุช ูู ุงูุดุฌุฑุฉ ูููุช ุจุชุทุจูุน ุงููุฏุฎูุงุช ุฅูููุง. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูููุง ูุงูุช ุงูููุฒุฉ ุฃูุซุฑ ุฃูููุฉ ุ ุฒุงุฏุช ูุณุงููุชูุง ูู ุงููุณุงูุฉ ุจูู ุงูููุงุท.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุทุนู ุงูุจูุงูุงุช ุงููููุณุฉ ูุฃูููุฉ ุงูููุฒุงุช</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time<font></font>
feature_importances = pd.DataFrame({<span class="hljs-string">'features'</span>: df.columns, <span class="hljs-string">'importance'</span>:tree_grid.best_estimator_.feature_importances_})<font></font>
print(feature_importances.sort_values(by=[<span class="hljs-string">'importance'</span>], inplace=<span class="hljs-literal">False</span>, ascending=<span class="hljs-literal">False</span>))<font></font>
<font></font>
scaler = StandardScaler().fit(X_train)<font></font>
X_train_transformed = scaler.transform(X_train)<font></font>
X_train_transformed = X_train_transformed * np.array(feature_importances[<span class="hljs-string">'importance'</span>])<font></font>
<font></font>
X_holdout_transformed = scaler.transform(X_holdout)<font></font>
X_holdout_transformed = X_holdout_transformed * np.array(feature_importances[<span class="hljs-string">'importance'</span>])<font></font>
<font></font>
knn_grid = GridSearchCV(KNeighborsClassifier(n_jobs=<span class="hljs-number">-1</span>), {<span class="hljs-string">'n_neighbors'</span>: range(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>)}, cv=<span class="hljs-number">5</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
knn_grid.fit(X_train_transformed, y_train)<font></font>
<span class="hljs-keyword">print</span> (knn_grid.best_params_, knn_grid.best_score_, accuracy_score(y_holdout, knn_grid.predict(X_holdout_transformed)))
</code></pre></div></div><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุฏูุงุฆู ุงูููู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.270386</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงููุงุช ุฎุฏูุฉ ุงูุนููุงุก</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.147185</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุน ุนุดูุฉ ุงูุฏูุงุฆู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.135475</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุทุฉ ุงูุฏูููุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.097249</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุณุงุฏุณ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุงูุฑุณูู ุงูุฏูููุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.091671</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุณุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุงูููุงููุงุช ุงูุฏูููุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">09.090008</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฏุฏ ุฑุณุงุฆู vmail</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.050646</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุฑุณูู ุนุดูุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.038593</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุฑุณูู ุงูููู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.026422</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุทุฉ ุงูุจุฑูุฏ ุงูุตูุชู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.017068</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุญุฏ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุฏูุงุฆู ุงูููู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.014185</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซูุงุซุฉ ุนุดุฑ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุฑุณูู ุงููููุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.005742</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุงูููุงููุงุช ุงูููููุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.005502</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุงูููุงููุงุช ุนุดูุฉ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.003614</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ููุงููุงุช ุงูููู</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.002246</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฌูุงูู ุงูุฏูุงุฆู ุงูุฏูููุฉ</font></font></td>
<td>0.002009</td>
</tr>
<tr>
<td>0</td>
<td>Account length</td>
<td>0.001998</td>
</tr>
<tr>
<td>1</td>
<td>Area code</td>
<td>0.000000</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{'n_neighbors': 5} 0.909129875696528 0.913 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุดุงุฑูุช ุงูุดุฌุฑุฉ ูููููุง ูู ุงููุนุฑูุฉ ูุน knn ูุงูุขู ูุฑู 91ูช. ููุฐุง ููุณ ุจุนูุฏูุง ุนู 94.5ูช ูู ุดุฌุฑุฉ ุงููุงููููุง. ุซู ุฌุงุกุช ูู ููุฑุฉ. ูููู ููู ุ ูู ุงููุงูุน ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุชุทุจูุน ุงููุฏุฎูุงุช ุจุญูุซ ูุธูุฑ knn ุฃูุถู ูุชูุฌุฉุ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ุณูู ููุฏุฑ ูู ุฃุฐูุงููุง ููุฏุงุฑ ูุง ุณูุนุชุจุฑู ุงูุขู "ุฌุจูุชู". 18 ูุนููุฉ ุ ููู ูููุง ูููู ุจูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ 10 ุฎุทูุงุช ูุญุชููุฉ ููุนูุงูู ูู ุงููููุงุณ ุงูููุบุงุฑูุชูู. ูุญุตู ุนูู ุฎูุงุฑุงุช 10e18. ุฎูุงุฑ ูุงุญุฏ ูุน ูู ุนุฏุฏ ูุฑุฏู ูููู ูู ุงูุฌูุฑุงู ูู ุฃูู ูู 10 ูุงูุชุญูู ุงููุชุจุงุฏู ูู 10 ุฃูุถูุง ุ ุฃุนุชูุฏ ุญูุงูู 1.5 ุซุงููุฉ. ุงุชุถุญ 42 โโูููุงุฑ ุณูุฉ. ุฑุจูุง ูุฌุจ ุงูุชุฎูู ุนู ููุฑุฉ ุชุฑู ุงูุญุณุงุจ ูููุง. :) ููู ููุงู ูุง ููุง ููุฑุช ุ "ูุง! ูุฐุง ุณุฃุตูุน ุฏุฑุงุฌุฉ ุณุชุทูุฑ! "</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญุซ ูุชุฏุฑุฌ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุงูุน ุ ูุฐู ุงููููุฉ ุนูู ุงูุฃุฑุฌุญ ูุฏููุง ุญุฏ ุฃูุตู ูุชุงุญ ููุท. </font><font style="vertical-align: inherit;">ุญุณููุง ุ ูุฐุง ููุณ ุจุงูุทุจุน ูุฌุงููุง ุฌูุฏูุง ูู ุงููุชุงุฆุฌ ุงูุฌูุฏุฉ ุ ูููููุง ูุชุดุงุจูุงู ุฅูู ุญุฏ ูุจูุฑ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูููููุง ููุท ุงูุณูุฑ ุนูู ุทูู ุงูุชุฏุฑุฌ ูุงูุนุซูุฑ ุนูู ุงูููุทุฉ ุงูุฃูุซุฑ ููุงุกูุฉ. </font><font style="vertical-align: inherit;">ูุงู ุงูููุฑ ุงูุฃูู ูู ุชุนููู ุงูุฎูุงุฑุฒููุฉ ุงูุฌูููุฉ ุ ูููู ููุง ูุง ูุจุฏู ุฃู ุงูุชุถุงุฑูุณ ุงูุชููููุฉ ูุชูุงุทุนุฉ ููุบุงูุฉ ุ ูุณูููู ูุฐุง ูุจุงูุบุฉ ููููุงู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณุฃุญุงูู ุงูููุงู ุจุฐูู ูุฏูููุง ูุจุฏุงูุฉ. </font><font style="vertical-align: inherit;">ูุฏูุน ุงูุนูุงูู ููุนููุงุช ููุฑุทุฉ ุ ุฃุญุชุงุฌ ุฅูู ุงูุชุนุงูู ูุน ุงููุชุณูููู. </font><font style="vertical-align: inherit;">ูู ุงููุซุงู ุงูุณุงุจู ุ ููุง ูู ุงูุฏุฑุณ ุ ุงุณุชุฎุฏูุช StandartScaler ุ ุงูุชู ุชูุฑูุฒุช ุนููุฉ ุงูุชุฏุฑูุจ ูู ุงููุชูุณุท โโูุฌุนูุช ุณูุฌูุง = 1. ูู ุฃุฌู ููุงุณูุง ุจุดูู ุฌูุฏ ุฏุงุฎู ุฎุท ุงูุฃูุงุจูุจ ุ ูุฌุจ ุฌุนู ุงููุนููุฉ ุงูููุฑุทุฉ ุฃูุซุฑ ุตุนูุจุฉ. </font><font style="vertical-align: inherit;">ููุฏ ุจุฏุฃุช ูู ุงูุจุญุซ ุนู ุดูุก ููุงุณุจ ูุญุงูุชู ุจูู ุงููุญูููู ุงููุฐุจ ูู sklearn.pococessing ุ ููููู ูู ุฃุฌุฏ ุฃู ุดูุก. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุญุงููุช ุฃู ุชุฑุซ ูู StandartScaler ุนู ุทุฑูู ุชุนููู ูุฌููุนุฉ ุฅุถุงููุฉ ูู ุงูุนูุงูู ุนููู.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฆุฉ ููุชุณููุฉ ุซู ุงูุถุฑุจ ุญุณุจ ุงููููุงุณ ูุชูุงูู ููููุงู ูุน ุฎุท ุฃูุงุจูุจ sklearn</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> sklearn.base <span class="hljs-keyword">import</span> TransformerMixin
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StandardAndPoorScaler</span>(<span class="hljs-params">StandardScaler, TransformerMixin</span>):</span>
    <span class="hljs-comment">#normalization = None</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, copy=True, with_mean=True, with_std=True, normalization = None</span>):</span>
        <span class="hljs-comment">#print("new StandardAndPoorScaler(normalization=", normalization.shape if normalization is not None else normalization, ") // ", type(self))</span><font></font>
        self.normalization = normalization<font></font>
        super().__init__(copy, with_mean, with_std)<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fit</span>(<span class="hljs-params">self, X, y=None</span>):</span>
        <span class="hljs-comment">#print(type(self),".fit(",X.shape, ",", y.shape if y is not None else "&lt;null&gt;",")")</span><font></font>
        super().fit(X, y)<font></font>
        <span class="hljs-keyword">return</span> self
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">partial_fit</span>(<span class="hljs-params">self, X, y=None</span>):</span>
        <span class="hljs-comment">#print(type(self),".partial_fit(",X.shape, ",", y.shape if y is not None else "&lt;null&gt;)")</span><font></font>
        super().partial_fit(X, y)<font></font>
        <span class="hljs-keyword">if</span> self.normalization <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
            self.normalization = np.ones((X.shape[<span class="hljs-number">1</span>]))
        <span class="hljs-keyword">elif</span> type(self.normalization) != np.ndarray:<font></font>
            self.normalization = np.array(self.normalization)<font></font>
        <span class="hljs-keyword">if</span> X.shape[<span class="hljs-number">1</span>] != self.normalization.shape[<span class="hljs-number">0</span>]:
            <span class="hljs-keyword">raise</span> <span class="hljs-string">"X.shape[1]="</span>+X.shape[<span class="hljs-number">1</span>]+<span class="hljs-string">" in equal self.scale.shape[0]="</span>+self.normalization.shape[<span class="hljs-number">0</span>]
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transform</span>(<span class="hljs-params">self, X, copy=None</span>):</span>
        <span class="hljs-comment">#print(type(self),".transform(",X.shape,",",copy,").self.normalization", self.normalization)</span><font></font>
        Xresult = super().transform(X, copy)<font></font>
        Xresult *= self.normalization<font></font>
        <span class="hljs-keyword">return</span> Xresult
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_reset</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-comment">#print(type(self),"._reset()")</span><font></font>
        super()._reset()<font></font>
    <font></font>
scaler = StandardAndPoorScaler(normalization = feature_importances[<span class="hljs-string">'importance'</span>])<font></font>
scaler.fit(X = X_train, y = <span class="hljs-literal">None</span>)<font></font>
print(scaler.normalization)<font></font>
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุงูู ุชุทุจูู ูุฐู ุงููุฆุฉ</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time<font></font>
knn_pipe = Pipeline([(<span class="hljs-string">'scaler'</span>, StandardAndPoorScaler()), (<span class="hljs-string">'knn'</span>, KNeighborsClassifier(n_jobs=<span class="hljs-number">-1</span>))])<font></font>
<font></font>
knn_params = {<span class="hljs-string">'knn__n_neighbors'</span>: range(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>), <span class="hljs-string">'scaler__normalization'</span>: [feature_importances[<span class="hljs-string">'importance'</span>]]}<font></font>
knn_grid = GridSearchCV(knn_pipe, knn_params, cv=<span class="hljs-number">5</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
<font></font>
knn_grid.fit(X_train, y_train)<font></font>
knn_grid.best_params_, knn_grid.best_score_, accuracy_score(y_holdout, knn_grid.predict(X_holdout))<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
({'knn__n_neighbors': 5ุ 'scaler__normalization': Name: importantุ dtype: float64}ุ 0.909558508358337ุ 0.913) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููุชูุฌุฉ ูุฎุชููุฉ ููููุงู ุนู ุชููุนุงุชู. ุญุณูุง ุ ูุฐุง ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ูู ุดูุก ูุนูู. ููุท ูููู ูุฐุง ุ ูุงู ุนูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ูุฐุง ุงููุตู ูุน ูู ุงูุดุฌุงุนุฉ ูู ุงูุตูุฑ ูู ุบุถูู ุซูุงุซ ุณุงุนุงุช ุ ูุนูุฏูุง ููุท ุฃุฏุฑูุช ุฃู ุงูุทุจุงุนุฉ ูุง ุชุชู ุทุจุงุนุชูุง ููุณ ูุฃู sklearn ุชู ุจุทุฑููุฉ ุฎุงุทุฆุฉ ุ ูููู ูุฃู GridSearchCV ูุฎูู ูุณุฎูุง ูู ุงูุชุฏูู ุงูุฑุฆูุณู ุ ูููู ูููู ุจุชูููููู ูุชุฏุฑูุจูู ูู ุณูุงุณู ุฑุณุงุฆู ุฃุฎุฑู. ููู ุดูุก ุชุทุจุนู ูู ุชุฏููุงุช ุฃุฎุฑู ูุฎุชูู ูู ุทู ุงููุณูุงู. ูููู ุฅุฐุง ูุถุนุช n_jobs = 1 ุ ูุณูุชู ุนุฑุถ ุฌููุน ุงูุงุณุชุฏุนุงุกุงุช ูููุธุงุฆู ุงูููุบุงุฉ ุนูู ุฃููุง ูุทููุฉ. ุฌุงุกุช ุงููุนุฑูุฉ ุจุงูุธุฉ ุงูุซูู ุ ูุงูุขู ูุฏูู ุฃูุถูุง ุ ูุฏูุนุช ุซูููุง ูู ุฎูุงู ูุฑุงุกุฉ ููุงู ููู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ุฏุนูุง ููุชูู. </font><font style="vertical-align: inherit;">ุงูุขู ุฃุฑูุฏ ุฃู ุฃุนุทู ุจุนุถ ุงูุชุจุงูู ููู ูู ูุนููุงุชูุง ุ ุซู ุฃุนุทูุง ุฃูู ููููุงู ุญูู ุฃูุถู ูููุฉ ูููุฐุง ุญุชู ุฃุญุตู ุนูู ูุชูุฌุฉ ูุดุงุจูุฉ ูููุงูุน. </font><font style="vertical-align: inherit;">ุณูููู ูุฐุง ุฃูู ุฎุท ุฃุณุงุณ ููุญ ููุง ูุฌุจ ุฃู ูุญุตู ูู ุงูููุงูุฉ ุนูู ุฎูุงุฑุฒููุฉ ุฃุญูุงูู.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ุฃููู ุจุชุดููู ุนุฏุฉ ุฎูุงุฑุงุช ูุฅุนุงุฏุฉ ุงูุชูุงุฒู ุ ุชุฎุชูู ูู ุงูุนุฏูุฏ ูู ุงููุนููุงุช</font></font></b><div class="spoiler_text"><pre><code class="python hljs">feature_base = feature_importances[<span class="hljs-string">'importance'</span>]<font></font>
searchArea = np.array([feature_base - <span class="hljs-number">.05</span>, feature_base, feature_base + <span class="hljs-number">.05</span>])<font></font>
searchArea[searchArea &lt; <span class="hljs-number">0</span>] = <span class="hljs-number">0</span>
searchArea[searchArea &gt; <span class="hljs-number">1</span>] = <span class="hljs-number">1</span>
print(searchArea[<span class="hljs-number">2</span>,:] - searchArea[<span class="hljs-number">0</span>,:])<font></font>
<font></font>
<span class="hljs-keyword">import</span> itertools<font></font>
<font></font>
affected_props = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]<font></font>
parametrs_ranges = np.concatenate([<font></font>
    np.linspace(searchArea[<span class="hljs-number">0</span>,affected_props], searchArea[<span class="hljs-number">1</span>,affected_props], <span class="hljs-number">2</span>, endpoint=<span class="hljs-literal">False</span>),<font></font>
    np.linspace(searchArea[<span class="hljs-number">1</span>,affected_props], searchArea[<span class="hljs-number">2</span>,affected_props], <span class="hljs-number">3</span>, endpoint=<span class="hljs-literal">True</span>)]).transpose()<font></font>
<font></font>
print(parametrs_ranges) <span class="hljs-comment">#      .  125 </span>
recombinations = itertools.product(parametrs_ranges[<span class="hljs-number">0</span>],parametrs_ranges[<span class="hljs-number">1</span>],parametrs_ranges[<span class="hljs-number">1</span>])<font></font>
<font></font>
variances = []<font></font>
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> recombinations: <span class="hljs-comment">#          ,       Python .</span><font></font>
    varince = feature_base.copy()<font></font>
    varince[affected_props] = item<font></font>
    variances.append(varince)<font></font>
print(variances[<span class="hljs-number">0</span>])<font></font>
print(len(variances))<font></font>
<span class="hljs-comment">#  knn   ,               .</span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ูุฌููุนุฉ ุงูุจูุงูุงุช ููุชุฌุฑุจุฉ ุงูุฃููู ุฌุงูุฒุฉ. </font><font style="vertical-align: inherit;">ุณุฃุญุงูู ุงูุขู ุชุฌุฑุจุฉ ุงูุจูุงูุงุช ุ ูุจุฏุงูุฉ ูู ุฎูุงู ุงูุจุญุซ ุงูุดุงูู ููุฎูุงุฑุงุช ุงูุฎูุณุฉ ุนุดุฑ ุงููุงุชุฌุฉ.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุฑู ุงุฎุชูุงุฑูุง ุชุฌุฑูุจููุง ูููุนููุงุช ููุง ูู ุงูุญุงู ูู ุงูููุงูุฉ</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-comment">#scale = np.ones([18])</span>
knn_pipe = Pipeline([(<span class="hljs-string">'scaler'</span>, StandardAndPoorScaler()), (<span class="hljs-string">'knn'</span>, KNeighborsClassifier(n_neighbors = <span class="hljs-number">7</span> , n_jobs=<span class="hljs-number">-1</span>))])<font></font>
<font></font>
knn_params = {<span class="hljs-string">'scaler__normalization'</span>: variances} <span class="hljs-comment"># 'knn__n_neighbors': range(3, 9, 2), </span>
knn_grid = GridSearchCV(knn_pipe, knn_params, cv=<span class="hljs-number">10</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
<font></font>
knn_grid.fit(X_train, y_train)<font></font>
knn_grid.best_params_, knn_grid.best_score_, accuracy_score(y_holdout, knn_grid.predict(X_holdout))</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ูู ุดูุก ุณูุฆ ุ ุชู ูุถุงุก ุงูููุช ูู ุชุญููู ุงุฎุชุฑุงู ุ ูุงููุชูุฌุฉ ุบูุฑ ูุณุชูุฑุฉ ููุบุงูุฉ. </font><font style="vertical-align: inherit;">ููููู ุฑุคูุฉ ูุฐุง ุฃูุถูุง ูู ูุญุต X_holdout ุ ุญูุซ ุชุฑูุต ุงููุชูุฌุฉ ููุง ูู ุงูุญุงู ูู ูุดูุงู ูุน ุชุบููุฑุงุช ุทูููุฉ ูู ุจูุงูุงุช ุงูุฅุฏุฎุงู. </font><font style="vertical-align: inherit;">ุณุฃุญุงูู ุงุชุจุงุน ููุฌ ูุฎุชูู. </font><font style="vertical-align: inherit;">ุณูู ุฃููู ุจุชุบููุฑ ูุนููุฉ ูุงุญุฏุฉ ููุท ูู ูู ูุฑุฉ ุ ูููู ูุน ุชูุชู ุฃูุจุฑ.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุบูุฑ ุฎุงุตูุฉ 4TH</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time<font></font>
affected_property = <span class="hljs-number">4</span><font></font>
parametrs_range = np.concatenate([<font></font>
    np.linspace(searchArea[<span class="hljs-number">0</span>,affected_property], searchArea[<span class="hljs-number">1</span>,affected_property], <span class="hljs-number">29</span>, endpoint=<span class="hljs-literal">False</span>),<font></font>
    np.linspace(searchArea[<span class="hljs-number">1</span>,affected_property], searchArea[<span class="hljs-number">2</span>,affected_property], <span class="hljs-number">30</span>, endpoint=<span class="hljs-literal">True</span>)]).transpose()<font></font>
<font></font>
print(searchArea[<span class="hljs-number">1</span>,affected_property])<font></font>
print(parametrs_range) <span class="hljs-comment"># C   ,  .</span><font></font>
<font></font>
<font></font>
variances = []<font></font>
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> parametrs_range: <span class="hljs-comment">#          ,       Python .</span><font></font>
    varince = feature_base.copy()<font></font>
    varince[affected_property] = item<font></font>
    variances.append(varince)<font></font>
print(variances[<span class="hljs-number">0</span>])<font></font>
print(len(variances))<font></font>
<span class="hljs-comment">#  knn   ,               .</span><font></font>
<font></font>
knn_pipe = Pipeline([(<span class="hljs-string">'scaler'</span>, StandardAndPoorScaler()), (<span class="hljs-string">'knn'</span>, KNeighborsClassifier(n_neighbors = <span class="hljs-number">7</span> , n_jobs=<span class="hljs-number">-1</span>))])<font></font>
<font></font>
knn_params = {<span class="hljs-string">'scaler__normalization'</span>: variances} <span class="hljs-comment"># 'knn__n_neighbors': range(3, 9, 2), </span>
knn_grid = GridSearchCV(knn_pipe, knn_params, cv=<span class="hljs-number">10</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
<font></font>
knn_grid.fit(X_train, y_train)<font></font>
knn_grid.best_params_, knn_grid.best_score_, accuracy_score(y_holdout, knn_grid.predict(X_holdout))</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
({'scaler__normalization': 4 0.079957 ุงูุงุณู :ูููุฉ ุ dtype: float64} ุ 0.9099871410201458 ุ 0.913) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ูุงุฐุง ูุฏููุง ูุน ุฃูุฒุฉุ </font><font style="vertical-align: inherit;">ุชุญููุงุช ูู ูุงุญุฏ ุฅูู ุงุซููู ูู ุนุดุฑุฉ ูู ุงููุงุฆุฉ ุนูุฏ ุงูุชุญูู ุงููุชุจุงุฏู ุ ููุณุจุฉ ูุตู ูู ุงููุงุฆุฉ ุชููุฒ ุนูู X_holdout ุฅุฐุง ูุธุฑุช ุฅูู ููููุฉ ูุฎุชููุฉ ูุชุฃุซุฑุฉ. </font><font style="vertical-align: inherit;">ูุจุฏู ุฃูู ูู ุงูุถุฑูุฑู ูุงูุฑุฎูุต ุชุญุณูู ุงููุถุน ุฅุฐุง ุจุฏุฃุช ุจุญูููุฉ ุฃู ุงูุดุฌุฑุฉ ุชุนุทููุง ุฃูู ูู ุงููุณุชุญูู ุนูู ูุซู ูุฐู ุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ููู ูููุชุฑุถ ุฃูู ููุณ ูุฏููุง ุชูุฒูุน ูุจุฏุฆู ููุนุฑูู ูููุฒู ุ ููุญุงูู ุฃู ููุนู ููุณ ุงูุดูุก ุนูุฏ ููุทุฉ ุนุดูุงุฆูุฉ ูู ุงูุฏูุฑุฉ ุจุฎุทูุงุช ุตุบูุฑุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุซูุฑ ููุงูุชูุงู ูุง ุณูุฃุชู ุฅููู.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนุจุฆุฉ ุฃูููุฉ</font></font></b><div class="spoiler_text"><pre><code class="python hljs">searchArea = np.array([np.zeros((<span class="hljs-number">18</span>,)), np.ones((<span class="hljs-number">18</span>,)) /<span class="hljs-number">18</span>, np.ones((<span class="hljs-number">18</span>,))])<font></font>
print(searchArea[:,<span class="hljs-number">0</span>])<font></font>
<font></font>
history_parametrs = [searchArea[<span class="hljs-number">1</span>,:].copy()]<font></font>
scaler = StandardAndPoorScaler(normalization=searchArea[<span class="hljs-number">1</span>,:])<font></font>
scaler.fit(X_train)<font></font>
knn = KNeighborsClassifier(n_neighbors = <span class="hljs-number">7</span> , n_jobs=<span class="hljs-number">-1</span>)<font></font>
knn.fit(scaler.transform(X_train), y_train)<font></font>
history_holdout_score = [accuracy_score(y_holdout, knn.predict(scaler.transform(X_holdout)))]</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธููุฉ ุชุบูุฑ ููููุงู ูุนููุฉ ูุงุญุฏุฉ (ูุน ุณุฌูุงุช ุงูุชุตุญูุญ)</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">changePropertyNormalization</span>(<span class="hljs-params">affected_property, points_count = <span class="hljs-number">15</span></span>):</span><font></font>
    test_range = np.concatenate([<font></font>
        np.linspace(searchArea[<span class="hljs-number">0</span>,affected_property], searchArea[<span class="hljs-number">1</span>,affected_property], points_count//<span class="hljs-number">2</span>, endpoint=<span class="hljs-literal">False</span>),<font></font>
        np.linspace(searchArea[<span class="hljs-number">1</span>,affected_property], searchArea[<span class="hljs-number">2</span>,affected_property], points_count//<span class="hljs-number">2</span> + <span class="hljs-number">1</span>, endpoint=<span class="hljs-literal">True</span>)]).transpose()<font></font>
    variances = [searchArea[<span class="hljs-number">1</span>,:].copy() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(test_range.shape[<span class="hljs-number">0</span>])]
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> range(len(variances)):<font></font>
        variances[row][affected_property] = test_range[row]<font></font>
    <font></font>
    knn_pipe = Pipeline([(<span class="hljs-string">'scaler'</span>, StandardAndPoorScaler()), (<span class="hljs-string">'knn'</span>, KNeighborsClassifier(n_neighbors = <span class="hljs-number">7</span> , n_jobs=<span class="hljs-number">-1</span>))])<font></font>
    knn_params = {<span class="hljs-string">'scaler__normalization'</span>: variances} <span class="hljs-comment"># 'knn__n_neighbors': range(3, 9, 2), </span>
    knn_grid = GridSearchCV(knn_pipe, knn_params, cv=<span class="hljs-number">10</span>, n_jobs=<span class="hljs-number">-1</span>, verbose=<span class="hljs-literal">False</span>)<font></font>
<font></font>
    knn_grid.fit(X_train, y_train)<font></font>
    holdout_score = accuracy_score(y_holdout, knn_grid.predict(X_holdout))<font></font>
    best_param = knn_grid.best_params_[<span class="hljs-string">'scaler__normalization'</span>][affected_property]<font></font>
    print(affected_property,<font></font>
          <span class="hljs-string">'property:'</span>, searchArea[<span class="hljs-number">1</span>, affected_property], <span class="hljs-string">"=&gt;"</span>, best_param,
          <span class="hljs-string">'holdout:'</span>, history_holdout_score[<span class="hljs-number">-1</span>], <span class="hljs-string">"=&gt;"</span>, holdout_score, <span class="hljs-string">'('</span>, knn_grid.best_score_, <span class="hljs-string">')'</span>)
    <span class="hljs-comment">#             .</span><font></font>
    before = searchArea[:, affected_property]<font></font>
    propertySearchArea = searchArea[:, affected_property].copy()<font></font>
    <span class="hljs-keyword">if</span> best_param == propertySearchArea[<span class="hljs-number">0</span>]:<font></font>
        print(<span class="hljs-string">'|&lt;&lt;'</span>)<font></font>
        searchArea[<span class="hljs-number">0</span>, affected_property] = best_param/<span class="hljs-number">2</span> <span class="hljs-keyword">if</span> best_param &gt; <span class="hljs-number">0.01</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        searchArea[<span class="hljs-number">2</span>, affected_property] = (best_param + searchArea[<span class="hljs-number">2</span>, affected_property])/<span class="hljs-number">2</span>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">elif</span> best_param == propertySearchArea[<span class="hljs-number">2</span>]:<font></font>
        print(<span class="hljs-string">'&gt;&gt;|'</span>)<font></font>
        searchArea[<span class="hljs-number">2</span>, affected_property] = (best_param + <span class="hljs-number">1</span>)/<span class="hljs-number">2</span> <span class="hljs-keyword">if</span> best_param &lt; <span class="hljs-number">0.99</span> <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>
        searchArea[<span class="hljs-number">0</span>, affected_property] = (best_param + searchArea[<span class="hljs-number">0</span>, affected_property])/<span class="hljs-number">2</span>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">elif</span> best_param &lt; (propertySearchArea[<span class="hljs-number">0</span>] + propertySearchArea[<span class="hljs-number">1</span>])/<span class="hljs-number">2</span>:<font></font>
        print(<span class="hljs-string">'&lt;&lt;'</span>)<font></font>
        searchArea[<span class="hljs-number">0</span>, affected_property] = max(propertySearchArea[<span class="hljs-number">0</span>]*<span class="hljs-number">1.1</span> - <span class="hljs-number">.1</span>*propertySearchArea[<span class="hljs-number">1</span>], <span class="hljs-number">0</span>)<font></font>
        searchArea[<span class="hljs-number">2</span>, affected_property] = (best_param + propertySearchArea[<span class="hljs-number">2</span>])/<span class="hljs-number">2</span>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">elif</span> best_param &gt; (propertySearchArea[<span class="hljs-number">1</span>] + propertySearchArea[<span class="hljs-number">2</span>])/<span class="hljs-number">2</span>:<font></font>
        print(<span class="hljs-string">'&gt;&gt;'</span>)<font></font>
        searchArea[<span class="hljs-number">0</span>, affected_property] = (best_param + propertySearchArea[<span class="hljs-number">0</span>])/<span class="hljs-number">2</span>
        searchArea[<span class="hljs-number">2</span>, affected_property] = min(propertySearchArea[<span class="hljs-number">2</span>]*<span class="hljs-number">1.1</span> - <span class="hljs-number">.1</span>*propertySearchArea[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>)<font></font>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">elif</span> best_param &lt; propertySearchArea[<span class="hljs-number">1</span>]:<font></font>
        print(<span class="hljs-string">'&lt;'</span>)<font></font>
        searchArea[<span class="hljs-number">2</span>, affected_property] = searchArea[<span class="hljs-number">1</span>, affected_property]*<span class="hljs-number">.25</span> + <span class="hljs-number">.75</span>*searchArea[<span class="hljs-number">2</span>, affected_property]<font></font>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">elif</span> best_param &gt; propertySearchArea[<span class="hljs-number">1</span>]:<font></font>
        print(<span class="hljs-string">'&gt;'</span>)<font></font>
        searchArea[<span class="hljs-number">0</span>, affected_property] = searchArea[<span class="hljs-number">1</span>, affected_property]*<span class="hljs-number">.25</span> + <span class="hljs-number">.75</span>*searchArea[<span class="hljs-number">0</span>, affected_property]<font></font>
        searchArea[<span class="hljs-number">1</span>, affected_property] = best_param
    <span class="hljs-keyword">else</span>:<font></font>
        print(<span class="hljs-string">'='</span>)<font></font>
        searchArea[<span class="hljs-number">0</span>, affected_property] = searchArea[<span class="hljs-number">1</span>, affected_property]*<span class="hljs-number">.25</span> + <span class="hljs-number">.75</span>*searchArea[<span class="hljs-number">0</span>, affected_property]<font></font>
        searchArea[<span class="hljs-number">2</span>, affected_property] = searchArea[<span class="hljs-number">1</span>, affected_property]*<span class="hljs-number">.25</span> + <span class="hljs-number">.75</span>*searchArea[<span class="hljs-number">2</span>, affected_property]<font></font>
    normalization = searchArea[<span class="hljs-number">1</span>,:].sum() <span class="hljs-comment">#,      .</span><font></font>
    searchArea[:,:] /= normalization<font></font>
    print(before, <span class="hljs-string">"=&gt;"</span>,searchArea[:, affected_property])<font></font>
    history_parametrs.append(searchArea[<span class="hljs-number">1</span>,:].copy())<font></font>
    history_holdout_score.append(holdout_score)<font></font>
    <font></font>
changePropertyNormalization(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)<font></font>
changePropertyNormalization(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุญุณูู ุฃู ุดูุก ูู ุฃู ููุงู ุ ููุชูุฌุฉ ูุฐูู ุ ุงุชุฎุฐุช ุงูุฎุทูุฉ ุงูุญุงุณูุฉ ุงูุชุงููุฉ ููุฏุฉ ูุตู ุณุงุนุฉ ุชูุฑูุจูุง:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุต ูุฎูู</font></font></b><div class="spoiler_text">       40 .<pre><code class="python hljs">%%time
<span class="hljs-comment">#   </span>
searchArea = np.array([np.zeros((<span class="hljs-number">18</span>,)), np.ones((<span class="hljs-number">18</span>,)) /<span class="hljs-number">18</span>, np.ones((<span class="hljs-number">18</span>,))])<font></font>
print(searchArea[:,<span class="hljs-number">0</span>])<font></font>
<font></font>
history_parametrs = [searchArea[<span class="hljs-number">1</span>,:].copy()]<font></font>
scaler = StandardAndPoorScaler(normalization=searchArea[<span class="hljs-number">1</span>,:])<font></font>
scaler.fit(X_train)<font></font>
knn = KNeighborsClassifier(n_neighbors = <span class="hljs-number">7</span> , n_jobs=<span class="hljs-number">-1</span>)<font></font>
knn.fit(scaler.transform(X_train), y_train)<font></font>
history_holdout_score = [accuracy_score(y_holdout, knn.predict(scaler.transform(X_holdout)))]<font></font>
<font></font>
<span class="hljs-keyword">for</span> tick <span class="hljs-keyword">in</span> range(<span class="hljs-number">40</span>):
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> range(searchArea.shape[<span class="hljs-number">1</span>]):<font></font>
        changePropertyNormalization(p, <span class="hljs-number">7</span>)<font></font>
    <font></font>
print(searchArea[<span class="hljs-number">1</span>,:])<font></font>
print(history_holdout_score)</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุฏูุฉ ุงููุงุชุฌุฉ ูู knn: 91.9ูช ุฃูุถู ููุง ูุงูุช ุนููู ุนูุฏูุง ุชูุฒู ุงูุจูุงูุงุช ูู ุงูุดุฌุฑุฉ. </font><font style="vertical-align: inherit;">ูุฃูุถู ุจูุซูุฑ ูู ุงููุณุฎุฉ ุงูุฃุตููุฉ. </font><font style="vertical-align: inherit;">ูุงุฑู ูุง ูุฏููุง ุจุฃูููุฉ ุงูููุฒุงุช ููููุง ูุดุฌุฑุฉ ุงููุฑุงุฑุงุช:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุตูุฑ ุฃูููุฉ ุงูููุฒุงุช ุญุณุจ knn</font></font></b><div class="spoiler_text"><pre><code class="python hljs">feature_importances[<span class="hljs-string">'knn_importance'</span>] = history_parametrs[<span class="hljs-number">-1</span>]<font></font>
diagramma = feature_importances.copy()<font></font>
indexes = diagramma.index<font></font>
diagramma.index = diagramma[<span class="hljs-string">'features'</span>]<font></font>
diagramma.drop(<span class="hljs-string">'features'</span>, <span class="hljs-number">1</span>, inplace = <span class="hljs-literal">True</span>)<font></font>
diagramma.plot(kind=<span class="hljs-string">'bar'</span>);<font></font>
plt.savefig(<span class="hljs-string">"images/pic1.png"</span>, format = <span class="hljs-string">'png'</span>)<font></font>
plt.show()<font></font>
feature_importances</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/kk/pe/nf/kkpenftrnyfl6dpu4p1qh2dnwqq.gif"><br>
<br>
<img src="https://habrastorage.org/webt/ui/o2/rp/uio2rplq9j2p5cxppq7jb7h_mpk.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุงููุ </font><font style="vertical-align: inherit;">ูุนู ุ ุนูู ูุง ูุจุฏู. </font><font style="vertical-align: inherit;">ููู ุฃุจุนุฏ ูุง ูููู ุนู ุงูุชุทุงุจู. </font><font style="vertical-align: inherit;">ููุงุญุธุฉ ูุซูุฑุฉ ููุงูุชูุงู. </font><font style="vertical-align: inherit;">ููุงู ุงูุนุฏูุฏ ูู ุงูููุฒุงุช ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุชูุฑุฑ ุจุนุถูุง ุงูุจุนุถ ุชูุงููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ "ุฅุฌูุงูู ุฏูุงุฆู ุงูููู" ู "ุฅุฌูุงูู ุชูููุฉ ุงูููู". </font><font style="vertical-align: inherit;">ูุฐุง ุงูุชุจู ุ ููุฏ ุดุงูุฏ knn ููุณู ุฌุฒุกูุง ูุจูุฑูุง ูู ูุฐู ุงูููุฒุงุช ุงููุชูุฑุฑุฉ.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุญูุธ ุงููุชุงุฆุฌ ูู ููู ุ ูุฅูุง ูุฅูู ูู ุบูุฑ ุงูููุงุณุจ ุงูุนูุฏุฉ ุฅูู ุงูุนูู ....</font></font></b><div class="spoiler_text"><pre><code class="python hljs">parametrs_df = pd.DataFrame(history_parametrs)<font></font>
parametrs_df[<span class="hljs-string">'scores'</span>] = history_holdout_score<font></font>
parametrs_df.index.name = <span class="hljs-string">'index'</span>
parametrs_df.to_csv(<span class="hljs-string">'parametrs_and_scores.csv'</span>)
</code></pre></div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฌูุฏุงุช</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ุฅู ุงููุชูุฌุฉ .919 ูู ุญุฏ ุฐุงุชูุง ููุณุช ุณูุฆุฉ ูููุนุฑูุฉ ุ ููุงู ุฃุฎุทุงุก ุฃูู 1.5 ูุฑุฉ ูู ุฅุตุฏุงุฑ ุงููุงููููุง ูุฃูู ุจูุณุจุฉ 7ูช ููุง ูุงูุช ุนููู ุนูุฏูุง ุฃุฎุฐูุง ุดุฌุฑุฉ ุงูููุฒุฉ ุงููููุฉ ููููุงุฏุฉ. </font><font style="vertical-align: inherit;">ููู ุงูุดูุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ุฃูู ูุฏููุง ุงูุขู ููุฒุฉ ุงูููุฒุฉ ููููุง ููุนุฑูุฉ knn ููุณูุง. </font><font style="vertical-align: inherit;">ุฅูู ูุฎุชูู ุฅูู ุญุฏ ูุง ุนูุง ุฃุฎุจุฑุชูุง ุจู ุงูุดุฌุฑุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูุฏู ุงูุดุฌุฑุฉ ู knn ุขุฑุงุก ูุฎุชููุฉ ุญูู ุฃู ูู ุงูุนูุงูุงุช ุบูุฑ ูููุฉ ุจุงููุณุจุฉ ููุง ุนูู ุงูุฅุทูุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ูู ุงูููุงูุฉ. </font><font style="vertical-align: inherit;">ุญุตููุง ุนูู ุดูุก ุฌุฏูุฏ ูุบูุฑ ุนุงุฏู ูุณุจููุง ุ ุญูุซ ูุฏููุง ุงุญุชูุงุทู ูู ุงููุนุฑูุฉ ุจุซูุงุซ ูุญุงุถุฑุงุช mlcourse.ai </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ods ู Google ููุฅุฌุงุจุฉ ุนูู ุฃุณุฆูุฉ ุจุณูุทุฉ ุญูู ุงูุซุนุจุงู. </font><font style="vertical-align: inherit;">ูู ุฑุฃูู ุ ููุณ ุณูุฆุง.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฑุงุฆุญ ุงูุขู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงููุชุงุฆุฌ ุงูุซุงูููุฉ ูุนูู ุงูุฎูุงุฑุฒููุฉ ุงููุณุงุฑ ุงูุฐู ุณููุชู. ุตุญูุญ ุ ุงููุณุงุฑ ุฐู 18 ุจูุนุฏูุง ุ ููุง ูุนูู ูุนูู ููููุงู ุ ุฌูุฏูุง ุ ููุชุจุน ูู ุงูููุช ุงููุนูู ูุง ุชูุนูู ุงูุฎูุงุฑุฒููุฉ ููุงู ุ ูุชุนูู ุฃู ุงุณุชุฎุฏุงู ุงูููุงูุฉ ููุณ ููุงุณุจูุง ุฌุฏูุง. ููููุง ูุฌุฏูู ุงูุฃุฎุทุงุก ุ ูุฐุง ูู ุงููุงูุน ููุณ ูุฑุฆููุง ุฏุงุฆููุง. ูุฏ ูุง ูุชุบูุฑ ุงูุฎุทุฃ ุจุดูู ููุญูุธ ููุชุฑุฉ ุทูููุฉ ุ ูููู ุงูุฎูุงุฑุฒููุฉ ูุดุบููุฉ ููุบุงูุฉ ุ ุชุฒุญู ุนูู ุทูู ูุงุฏู ุถูู ุทููู ูู ุงููุถุงุก ุงูุชูููู. ูุฐูู ุ ุณุฃุทุจู ุ ุจุงููุณุจุฉ ูููุจุชุฏุฆูู ุ ุฃูู ููุฌ ุฃุจุณุท ููููู ุบูู ุจุงููุนูููุงุช ุชูุงููุง - ุฃููู ุจุดูู ุนุดูุงุฆู ุจุฅุณูุงุท ูุณุงุญุฉ 18 ุงูุฃุจุนุงุฏ ุนูู ูุณุงุญุฉ ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ ุจุญูุซ ุชููู ูุณุงููุงุช ุฌููุน ุงููุนููุงุช ุ ุจุบุถ ุงููุธุฑ ุนู ุฃูููุชูุง ุ ููุฑุฏุฉ. ูู ุงููุงูุน ุ ุงููุณุงุฑ ุฐู ุงูุฃุจุนุงุฏ 18 ุตุบูุฑ ุฌุฏูุง ุ ูู ููุงูุชูุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑุฉ ุฎุงุทูุฉ ุนูู ุฑููุงุช ุดุจูุฉ ุนุตุจูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุง ุฃุนุฌุจุช ุจูุณุงุญุฉ ููุงุฒูู ุฌููุน ุงููุดุงุจู ุงูุนุตุจูุฉ ุงูุชู ูุงูุช ููุฌูุฏุฉ ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ููุงูุช ุฌูููุฉ ูุบููุฉ ุจุงููุนูููุงุช.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฃุช ุงูุจูุงูุงุช ูู ุงูููู ุ ุฅุฐุง ุนุฏุช ุฅูู ุงูุนูู ุ ุจุนุฏ ุงุฌุชูุงุฒ ูุฑุญูุฉ ุงูุชุฏุฑูุจ ููุณูุง</font></font></b><div class="spoiler_text"><pre><code class="python hljs">parametrs_df = pd.read_csv(<span class="hljs-string">'parametrs_and_scores.csv'</span>, index_col = <span class="hljs-string">'index'</span>)<font></font>
history_holdout_score = np.array(parametrs_df[<span class="hljs-string">'scores'</span>])<font></font>
parametrs_df.drop(<span class="hljs-string">'scores'</span>,axis=<span class="hljs-number">1</span>)<font></font>
history_parametrs = np.array(parametrs_df.drop(<span class="hljs-string">'scores'</span>,axis=<span class="hljs-number">1</span>))</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชููู ุฎุทุฃ ุงูุชุญูู ูู ุงูุตุญุฉ ุนู ุงูุชุบููุฑ ูู ููุทุฉ ูุง. </font><font style="vertical-align: inherit;">ููุง ุณูููู ูู ุงููููู ุงูุชููู ุนู ุงูุชููู ุงูุชููุงุฆู ููุชุนูู ูุงุณุชุฎุฏุงู ุงููุธููุฉ ุงููุณุชููุฉ ูุจููุฉ ุญูุงุชู ุ ููู ูุฏู ุจุงููุนู ุงููููู ูู ุงูููุช. </font><font style="vertical-align: inherit;">:(</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุฏุฏ ูู ููุฏุฑุงุณุฉ.</font></font></b><div class="spoiler_text"><pre><code class="python hljs">last = history_holdout_score[<span class="hljs-number">-1</span>]<font></font>
steps = np.arange(<span class="hljs-number">0</span>, history_holdout_score.shape[<span class="hljs-number">0</span>])[history_holdout_score != last].max()<font></font>
print(steps/<span class="hljs-number">18</span>)</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
35.5555555555555556 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ุจุชุบููุฑ ูุนููุฉ ูุงุญุฏุฉ ูู ูู ูุฑุฉ ุ ูุฐูู </font><font style="vertical-align: inherit;">ุชุชููู </font><font style="vertical-align: inherit;">ุฏูุฑุฉ ุงูุชุญุณูู </font><font style="vertical-align: inherit;">ูู </font><font style="vertical-align: inherit;">18 ุฎุทูุฉ. </font><font style="vertical-align: inherit;">ุงุชุถุญ ุฃู ูุฏููุง 36 ุฎุทูุฉ ุฐุงุช ูุนูู ุ ุฃู ุดูุก ูู ูุฐุง ุงููุจูู. </font><font style="vertical-align: inherit;">ุงูุขู ุฏุนูุง ูุญุงูู ุชุตูุฑ ุงููุณุงุฑ ุงูุฐู ุชู ูู ุฎูุงูู ุชุฏุฑูุจ ุงูุทุฑููุฉ.</font></font><br>
<br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุต ูุฎูู</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-comment">#    :</span>
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<font></font>
%matplotlib inline<font></font>
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> math<font></font>
random.seed(<span class="hljs-number">17</span>)<font></font>
property_projection = np.array([[math.sin(a), math.cos(a)] <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> [random.uniform(-math.pi, math.pi) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(history_parametrs[<span class="hljs-number">0</span>].shape[<span class="hljs-number">0</span>])]]).transpose()<font></font>
history = np.array(history_parametrs[::<span class="hljs-number">18</span>]) <span class="hljs-comment">#   - 18 .</span>
<span class="hljs-comment">#           . :(</span>
points = np.array([(history[i] * property_projection).sum(axis=<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(history.shape[<span class="hljs-number">0</span>])])<font></font>
plt.plot(points[:<span class="hljs-number">36</span>,<span class="hljs-number">0</span>],points[<span class="hljs-number">0</span>:<span class="hljs-number">36</span>,<span class="hljs-number">1</span>]);<font></font>
plt.savefig(<span class="hljs-string">"images/pic2.png"</span>, format = <span class="hljs-string">'png'</span>)<font></font>
plt.show()</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/jt/zs/rc/jtzsrcgk60i_aeqhcvxjq9atvee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุงุญุธุฉ ุฃูู ุชู ุฅููุงู ุฌุฒุก ูุจูุฑ ูู ุงูุฑุญูุฉ ูู ุงูุฎุทูุงุช ุงูุฃุฑุจุน ุงูุฃููู. </font><font style="vertical-align: inherit;">ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุจููุฉ ุงูุทุฑูู ูุน ุงูุฒูุงุฏุฉ</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏูู ุฃูู 4 ููุงุท</font></font></b><div class="spoiler_text"><pre><code class="python hljs">plt.plot(points[<span class="hljs-number">4</span>:<span class="hljs-number">36</span>,<span class="hljs-number">0</span>],points[<span class="hljs-number">4</span>:<span class="hljs-number">36</span>,<span class="hljs-number">1</span>]);<font></font>
plt.savefig(<span class="hljs-string">"images/pic3.png"</span>, format = <span class="hljs-string">'png'</span>)</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/gq/xh/wa/gqxhwawt9nnsmypgk3tkry9vbpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุงูุฌุฒุก ุงูุฃุฎูุฑ ูู ุงููุณุงุฑ ููุฑู ูุง ูุนูู ุงููุนูู ุจุนุฏ ุงููุตูู ุฅูู ูุฌูุชูุง.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุฑุจ</font></font></b><div class="spoiler_text"><pre><code class="python hljs">plt.plot(points[<span class="hljs-number">14</span>:<span class="hljs-number">36</span>,<span class="hljs-number">0</span>],points[<span class="hljs-number">14</span>:<span class="hljs-number">36</span>,<span class="hljs-number">1</span>]);<font></font>
plt.savefig(<span class="hljs-string">"images/pic4.png"</span>, format = <span class="hljs-string">'png'</span>)<font></font>
plt.show()<font></font>
plt.plot(points[<span class="hljs-number">24</span>:<span class="hljs-number">36</span>,<span class="hljs-number">0</span>],points[<span class="hljs-number">24</span>:<span class="hljs-number">36</span>,<span class="hljs-number">1</span>]);<font></font>
plt.plot(points[<span class="hljs-number">35</span>:,<span class="hljs-number">0</span>],points[<span class="hljs-number">35</span>:,<span class="hljs-number">1</span>], color = <span class="hljs-string">'red'</span>);<font></font>
plt.savefig(<span class="hljs-string">"images/pic5.png"</span>, format = <span class="hljs-string">'png'</span>)<font></font>
plt.show()</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/a5/kq/6m/a5kq6mq5yxl3roojyjfzdw8wq8a.png"><br>
<br>
<img src="https://habrastorage.org/webt/g5/lo/gs/g5logsa_jmna5lveoc-w0679koy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ููุงุญุธุฉ ุฃู ุงูุฎูุงุฑุฒููุฉ ูุชู ุชุฏุฑูุจูุง ุจุงูุชูุงู. ุญุชู ูุฌุฏ ูุฌูุชู. ุงูููุทุฉ ุงููุญุฏุฏุฉ ุ ุจุงูุทุจุน ุ ุชุนุชูุฏ ุนูู ุงูุชูุฒูุน ุงูุนุดูุงุฆู ูู ุงูุชุญูู ุงููุชูุงุทุน. ูููู ุจุบุถ ุงููุธุฑ ุนู ุงูููุทุฉ ุงููุญุฏุฏุฉ ุ ูุฅู ุงูุตูุฑุฉ ุงูุนุงูุฉ ููุง ูุญุฏุซ ูููููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูููุงุณุจุฉ ุ ููุช ุฃุณุชุฎุฏู ูุซู ูุฐุง ุงูุฌุฏูู ุงูุฒููู ูุฅุซุจุงุช ุนูููุฉ ุงูุชุนูู. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูุชู ุนุฑุถ ุงููุณุงุฑ ุจุงููุงูู ุ ูููู ุงูุฎุทูุงุช ุงูููููุฉ ุงูุฃุฎูุฑุฉ ูุน ุงูุฒูุงู ุงููููุงุณ. ูููู ุงูุนุซูุฑ ุนูู ูุซุงู ูู ููุงูุชู ุงูุฃุฎุฑู ุ "We Spy on the Throws of Neural Network". ููุนู ุ ุจุงูุทุจุน ุ ูู ูู ููุงุฌู ูุซู ูุฐุง ุงูุชุตูุฑ ูุณุฃู ุนูู ุงูููุฑ ููุงุฐุง ุฌููุน ุงูุนูุงูู ููุง ููุณ ุงููุฒู ูุงูุฃูููุฉ ุ ุซู ููุง ูุฎุชููุฉ. ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ ูู ุงูููุงูุฉ ุ ุญุงููุช ุฅุนุงุฏุฉ ุงููุธุฑ ูู ุฃูููุฉ ุงููุดุงุจู ูุงุชุถุญ ุฃููุง ุฃูู ุฅูุงุฏุฉ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐู ุงููุฑุฉ ุ ูุณูุญูุง ุจูุนุฑูุฉ ุฌุฏูุฏุฉ ุ ุณุฃุญุงูู ุงุณุชุฎุฏุงู t-SNE ููุดุฑ ูุณุงุญุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ ูู ุฅุณูุงุท ูููู ุฃู ูููู ููู ูู ุดูุก ุฃูุถู.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู SNE</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-keyword">import</span> sklearn.manifold <span class="hljs-keyword">as</span> manifold<font></font>
tsne = manifold.TSNE(random_state=<span class="hljs-number">19</span>)<font></font>
tsne_representation = tsne.fit_transform(history)<font></font>
plt.plot(tsne_representation[:, <span class="hljs-number">0</span>], tsne_representation[:, <span class="hljs-number">1</span>])<font></font>
plt.savefig(<span class="hljs-string">"images/pic6.png"</span>, format = <span class="hljs-string">'png'</span>)<font></font>
plt.show();</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/qe/bp/nn/qebpnnz71ywbxgqvhzj3fpv8vzc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃู t-Sne ูุฏ ูุดูุช ุงููุณุงุญุฉ ุจุญูุซ ุฃููุช ุชูุงููุง ุญุฌู ุงูุชุบููุฑุงุช ูุชูู ุงูููุฒุงุช ุงูุชู ุชูููุช ุนู ุงูุชุบููุฑ ุจุณุฑุนุฉ ุ ููุง ุฌุนู ุงูุตูุฑุฉ ุบูุฑ ูุฃูููุฉ ุชูุงููุง. </font><font style="vertical-align: inherit;">ุงูุฎูุงุตุฉ - ูุง ุชุญุงูู ุฃู ุชูุฒูู ุงูุฎูุงุฑุฒููุงุช ุฅูู ุฃูุงูู ุบูุฑ ูุฎุตุตุฉ ููุง: \</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ููููู ูุฑุงุกุฉ ุงููุฒูุฏ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุงููุช ุฃูุถูุง ุญูู tsne ูู ุงูุฏุงุฎู ูุชุตูุฑ ุญุงูุงุช ุงูุชุญุณูู ุงููุชูุณุทุฉ ุ ุนูู ุฃูู ุฃู ูุชุญูู ุงูุฌูุงู. ููู ุงุชุถุญ ุฃูู ููุณ ุฌูุงููุง ุ ุจุนุถ ุงูููุงูุฉ. ุฅุฐุง ููุช ููุชููุง ุ ูุฑุงุฌุน ููููุฉ ุงูููุงู ุจุฐูู. ูุชูุงุซุฑุช ุงูุฅูุชุฑูุช ุฃูุซูุฉ ุนูู ูุฐู ุงููุฏููุฉ ุนู ุทุฑูู ุงูุญูู ูููู ุจุจุณุงุทุฉ ุนู ุทุฑูู ูุณุฎ ูู ููุนููุง ุณูููุง ุจูุช ุจุณุจุจ ุจุฏููุง ุงููุงุฑุฏุฉ ูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sklearn.manifold.t_sne</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุธููุฉ ุฏุงุฎููุฉ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_gradient_descent</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุฐูู ุงุนุชูุงุฏุง ุนูู ุงูุฅุตุฏุงุฑ ูุฏ ุชููู ูุฎุชููุฉ ุฌุฏุง ุณูุงุก ูู ุงูุชูููุน ูุจุดุฃู ูุนุงูุฌุฉ ุงููุชุบูุฑุงุช ุงูุฏุงุฎููุฉ. ุญุชู ุชุฌุฏ ุงููุตุงุฏุฑ ุจููุณู ุ ุงุฎุชุฑ ูุณุฎุชู ูู ุงููุธููุฉ ูู ููุงู ูุฃุฏุฎู ุณุทุฑูุง ูุงุญุฏูุง ููุท ูููุง ูุถูู ููุงูุจ ูุณูุทุฉ ุฅูู </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุบูุฑู ุงูุฎุงุต </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">ุงูููุงุถุน. append (p.copy ()) # ูุญูุธ ุงูููุถุน ุงูุญุงูู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุชุตูุฑ ุจุดูู ุฌููู ูุง ูุญุตู ุนููู ูุชูุฌุฉ ูุฐูู:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุงูุญูู</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> linalg
<span class="hljs-comment"># This list will contain the positions of the map points at every iteration.</span><font></font>
positions = []<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_gradient_descent</span>(<span class="hljs-params">objective, p0, it, n_iter,
                      n_iter_check=<span class="hljs-number">1</span>, n_iter_without_progress=<span class="hljs-number">300</span>,
                      momentum=<span class="hljs-number">0.8</span>, learning_rate=<span class="hljs-number">200.0</span>, min_gain=<span class="hljs-number">0.01</span>,
                      min_grad_norm=<span class="hljs-number">1e-7</span>, verbose=<span class="hljs-number">0</span>, args=None, kwargs=None</span>):</span>
    <span class="hljs-comment"># The documentation of this function can be found in scikit-learn's code.</span>
    <span class="hljs-keyword">if</span> args <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
        args = []<font></font>
    <span class="hljs-keyword">if</span> kwargs <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
        kwargs = {}<font></font>
<font></font>
    p = p0.copy().ravel()<font></font>
    update = np.zeros_like(p)<font></font>
    gains = np.ones_like(p)<font></font>
    error = np.finfo(np.float).max<font></font>
    best_error = np.finfo(np.float).max<font></font>
    best_iter = i = it<font></font>
<font></font>
    tic = time()<font></font>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(it, n_iter):<font></font>
        positions.append(p.copy()) <span class="hljs-comment"># We save the current position.</span><font></font>
        <font></font>
        check_convergence = (i + <span class="hljs-number">1</span>) % n_iter_check == <span class="hljs-number">0</span>
        <span class="hljs-comment"># only compute the error when needed</span>
        kwargs[<span class="hljs-string">'compute_error'</span>] = check_convergence <span class="hljs-keyword">or</span> i == n_iter - <span class="hljs-number">1</span><font></font>
<font></font>
        error, grad = objective(p, *args, **kwargs)<font></font>
        grad_norm = linalg.norm(grad)<font></font>
<font></font>
        inc = update * grad &lt; <span class="hljs-number">0.0</span><font></font>
        dec = np.invert(inc)<font></font>
        gains[inc] += <span class="hljs-number">0.2</span>
        gains[dec] *= <span class="hljs-number">0.8</span><font></font>
        np.clip(gains, min_gain, np.inf, out=gains)<font></font>
        grad *= gains<font></font>
        update = momentum * update - learning_rate * grad<font></font>
        p += update<font></font>
<font></font>
        <span class="hljs-keyword">if</span> check_convergence:<font></font>
            toc = time()<font></font>
            duration = toc - tic<font></font>
            tic = toc<font></font>
<font></font>
            <span class="hljs-keyword">if</span> verbose &gt;= <span class="hljs-number">2</span>:<font></font>
                print(<span class="hljs-string">"[t-SNE] Iteration %d: error = %.7f,"</span>
                      <span class="hljs-string">" gradient norm = %.7f"</span>
                      <span class="hljs-string">" (%s iterations in %0.3fs)"</span>
                      % (i + <span class="hljs-number">1</span>, error, grad_norm, n_iter_check, duration))<font></font>
<font></font>
            <span class="hljs-keyword">if</span> error &lt; best_error:<font></font>
                best_error = error<font></font>
                best_iter = i<font></font>
            <span class="hljs-keyword">elif</span> i - best_iter &gt; n_iter_without_progress:
                <span class="hljs-keyword">if</span> verbose &gt;= <span class="hljs-number">2</span>:<font></font>
                    print(<span class="hljs-string">"[t-SNE] Iteration %d: did not make any progress "</span>
                          <span class="hljs-string">"during the last %d episodes. Finished."</span>
                          % (i + <span class="hljs-number">1</span>, n_iter_without_progress))
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">if</span> grad_norm &lt;= min_grad_norm:
                <span class="hljs-keyword">if</span> verbose &gt;= <span class="hljs-number">2</span>:<font></font>
                    print(<span class="hljs-string">"[t-SNE] Iteration %d: gradient norm %f. Finished."</span>
                          % (i + <span class="hljs-number">1</span>, grad_norm))
                <span class="hljs-keyword">break</span><font></font>
<font></font>
    <span class="hljs-keyword">return</span> p, error, i<font></font>
<font></font>
manifold.t_sne._gradient_descent = _gradient_descent</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุทุจูู t-SNE `` ุงูุซุงุจุช ''</font></font></b><div class="spoiler_text"><pre><code class="python hljs">tsne_representation = manifold.TSNE(random_state=<span class="hljs-number">17</span>).fit_transform(history)<font></font>
X_iter = np.dstack(position.reshape(<span class="hljs-number">-1</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> position <span class="hljs-keyword">in</span> positions)<font></font>
position_reshape = [position.reshape(<span class="hljs-number">-1</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> position <span class="hljs-keyword">in</span> positions]<font></font>
print(position_reshape[<span class="hljs-number">0</span>].shape)<font></font>
print(<span class="hljs-string">'[0] min'</span>, position_reshape[<span class="hljs-number">0</span>][:,<span class="hljs-number">0</span>].min(),<span class="hljs-string">'max'</span>, position_reshape[<span class="hljs-number">0</span>][:,<span class="hljs-number">0</span>].max())<font></font>
print(<span class="hljs-string">'[1] min'</span>, position_reshape[<span class="hljs-number">1</span>][:,<span class="hljs-number">0</span>].min(),<span class="hljs-string">'max'</span>, position_reshape[<span class="hljs-number">1</span>][:,<span class="hljs-number">0</span>].max())<font></font>
print(<span class="hljs-string">'[2] min'</span>, position_reshape[<span class="hljs-number">2</span>][:,<span class="hljs-number">0</span>].min(),<span class="hljs-string">'max'</span>, position_reshape[<span class="hljs-number">2</span>][:,<span class="hljs-number">0</span>].max())
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(41 ุ 2) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[0] min -0.00018188123 max 0.00027207955 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[1] min -0.05136269 max 0.032607622 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
[2] min -4.392309 max 7.9074526 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููู ุชุฑูุต ูู ูุทุงู ูุงุณุน ุฌุฏูุง ุ ูุฐุง ุณุฃููู </font><font style="vertical-align: inherit;">ุจุชุญุฌูููุง </font><font style="vertical-align: inherit;">ูุจู ุฑุณููุง. </font><font style="vertical-align: inherit;">ุนูู ุฏูุฑุงุช ุ ูุชู ูู ูุฐุง ุจุทุงูุงุช. </font><font style="vertical-align: inherit;">:(</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูููุงุณ</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> MinMaxScaler<font></font>
minMaxScaler = MinMaxScaler()<font></font>
minMaxScaler.fit_transform(position_reshape[<span class="hljs-number">0</span>])<font></font>
position_reshape = [minMaxScaler.fit_transform(frame) <span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> position_reshape]<font></font>
position_reshape[<span class="hljs-number">0</span>].min(), position_reshape[<span class="hljs-number">0</span>].max()</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฑูู</font></font></b><div class="spoiler_text"><pre><code class="python hljs">%%time<font></font>
<font></font>
<span class="hljs-keyword">from</span> matplotlib.animation <span class="hljs-keyword">import</span> FuncAnimation, PillowWriter
<span class="hljs-comment">#plt.style.use('seaborn-pastel')</span><font></font>
<font></font>
fig = plt.figure()<font></font>
<font></font>
ax = plt.axes(xlim=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), ylim=(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))<font></font>
line, = ax.plot([], [], lw=<span class="hljs-number">3</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init</span>():</span><font></font>
    line.set_data([], [])<font></font>
    <span class="hljs-keyword">return</span> line,
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">animate</span>(<span class="hljs-params">i</span>):</span>
    x = position_reshape[i][:,<span class="hljs-number">0</span>]<font></font>
    y = position_reshape[i][:,<span class="hljs-number">1</span>]<font></font>
    line.set_data(x, y)<font></font>
    <span class="hljs-keyword">return</span> line,<font></font>
<font></font>
anim = FuncAnimation(fig, animate, init_func=init, frames=<span class="hljs-number">36</span>, interval=<span class="hljs-number">20</span>, blit=<span class="hljs-literal">True</span>, repeat_delay = <span class="hljs-number">1000</span>)<font></font>
anim.save(<span class="hljs-string">'images/animate_tsne_learning.gif'</span>, writer=PillowWriter(fps=<span class="hljs-number">5</span>))
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/lh/dq/g6/lhdqg6khzhplw6jtkei6y0s3pdu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅููุง ูููุฏุฉ ูู ุญูุซ ุงูููุงุฑุงุช ุ ูููููุง ุนุฏููุฉ ุงููุงุฆุฏุฉ ุนูู ุงูุฅุทูุงู ูู ูุฐู ุงููููุฉ ููุจูุญุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ูุฐุง ุฃููู ูุฏุงุนุง ูู. </font><font style="vertical-align: inherit;">ุขูู ุฃู ุชุณุงุนุฏู ููุฑุฉ ุฃูู ุญุชู ูู knn ููููู ุงูุญุตูู ุนูู ุดูุก ุฌุฏูุฏ ููุซูุฑ ููุงูุชูุงู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฃุฌุฒุงุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ุณุชุณุงุนุฏู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุงุณุชูุชุงุน ุจุงูุจูุงูุงุช ูู ูุฐุง ุงูุนูุฏ ุงูููุฑู ุฃุซูุงุก ุงูุทุงุนูู.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar496466/index.html">ุฃู ูุตุฏุฑ ุถูุก ุณุฑูุน ุจูุง ููู ุงูููุงูุฉ ูุฏูู ุชุญูู ุฏูุจูุฑ ุฃุญูุฑ</a></li>
<li><a href="../ar496472/index.html">10 ูุณุชูุฏุนุงุช ูุซูุฑุฉ ููุงูุชูุงู ุนูู ุฌูุซุจ ุ ูููุฏุฉ ูุฃู ูุทูุฑ</a></li>
<li><a href="../ar496476/index.html">ุงุฏูุน Windows Server ุฅูู VPS ููุฎูุถ ุงูุทุงูุฉ ุจุงุณุชุฎุฏุงู Windows Server Core</a></li>
<li><a href="../ar496480/index.html">ุตูุช ุงูุตูุช ุงููุณุชูุจูู</a></li>
<li><a href="../ar496482/index.html">ุชูููุฉ ุงูููุงุฏุฉ ุงููุงุนูุฉ ูุฅุฏุงุฑุฉ ุงููุฑูู</a></li>
<li><a href="../ar496486/index.html">ุงูุฑุฃู: Spamhaus - ุงูุฑูุงุจุฉ ุนูู ุงูุฅูุชุฑูุช ุฃู ููุงุชูู ุงูููุจ ุงููุธููููุ</a></li>
<li><a href="../ar496488/index.html">ูุญุงุฑุจ ูุฒูุฏู IaaS ุถุฏ ุงููุฌูุงุช ุนูู ุจุฑูุชูููู BGP</a></li>
<li><a href="../ar496490/index.html">ูุญู ูุฏุฑุณ ูุญุฑู Mediastreamer2 VoIP. ุงูุฌุฒุก 7</a></li>
<li><a href="../ar496492/index.html">ููุฒุงุช LXD ุงูุฃุณุงุณูุฉ - ุฃูุธูุฉ ุญุงููุงุช ููููุณ</a></li>
<li><a href="../ar496494/index.html">ููุนุจ ููุณููู ูู ูุงุฑูู ุนูู ููุจุฑ ุงูุตูุช</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>