<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüî¨ üê¶ üë®‚Äçüöí The scheme for counterfeiting, restoring and checking fruits in a greengrocery. Excerpt from the book üç£ üèûÔ∏è üö¥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, habrozhiteli! So far, such a situation outside the window, we decided to share an interesting excerpt from our book Generative Deep Learning. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>The scheme for counterfeiting, restoring and checking fruits in a greengrocery. Excerpt from the book</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/494408/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><div style="text-align:center;"><img src="https://habrastorage.org/webt/eu/cd/zn/eucdznloeewsy2iiwauxfne9vqu.png" alt="image"></div></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hello, habrozhiteli! </font><font style="vertical-align: inherit;">So far, such a situation outside the window, we decided to share an interesting excerpt from our book Generative Deep Learning. </font><font style="vertical-align: inherit;">The creative potential of neural networks ‚Äùby David Foster.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apples and oranges</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Granny Smith and Florida are co-owners of a greengrocer. To achieve maximum efficiency, each takes care of its shelves in the store. For example, Granny Smith is proud of her choice of apples, and Florida lays oranges for hours, achieving their perfect location. Both are so confident in themselves that they agreed to a deal: profits from the sale of apples will go to Granny Smith, profits from the sale of oranges will go to Florida.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, neither Granny Smith nor Florida intends to compete honestly. When Florida does not see, Granny Smith makes her way to the window with oranges and begins to paint them red so that they look like apples! Florida does exactly the same: she tries to make Granny Smith's apples look more like oranges, using a spray of a suitable color when she turns her back. Because of this, customers often choose the wrong fruits they intended to buy. Those who were about to buy oranges sometimes mistakenly choose Florida colored apples, and those who wanted to buy apples mistakenly choose oranges masked by Granny Smith. In the end, the profit for each fruit is added up and divided according to the agreements - Granny Smith loses money whenever one of her apples is sold as an orange,and Florida, when one of her oranges is sold as an apple.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the store closes, both begin to restore order on the fruit shelves. But instead of trying to wash the paint caused by the rival, both simply paint the fakes, trying to bring them back to their original form. It is important for them to do this job correctly: if the fruits do not look as they should, then they will not be able to sell them the next day and will again lose profits. To make sure their actions are correct, they sometimes test their methods on their own fruits. Florida sprinkles its oranges and checks to see if they look exactly the same as the original. Granny Smith tests her ‚Äúskills‚Äù on apples. If they find obvious discrepancies, then they will have to spend hard-earned profit on the study of more advanced methods (Fig. 5.2).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first, buyers often make the wrong choice. </font><font style="vertical-align: inherit;">However, over time, they gain experience and learn to determine which fruits were faked. </font><font style="vertical-align: inherit;">This forces Granny Smith and Florida to perfect themselves in faking each other's fruits, as well as in restoring the fakes to their original appearance. </font><font style="vertical-align: inherit;">In addition, they need to periodically make sure that the tricks they use do not alter the appearance of their own fruits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After many days and weeks of this ridiculous game, they noticed that something amazing had happened. </font><font style="vertical-align: inherit;">Customers no longer distinguish between real and fake fruits. </font><font style="vertical-align: inherit;">In fig. </font><font style="vertical-align: inherit;">5.3 shows what the fruits look like after falsification and restoration, as well as after testing.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p2/zs/qi/p2zsqiyfnjp2ufymz5cawrvqzkw.png" alt="image"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ma/xs/ug/maxsugg2pnt5k2hmdlnns3uzjds.png" alt="image"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CycleGAN</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The previous story is an allegory describing the development of one of the key areas in generative modeling, known as style transfer: a cyclically coordinated generative-competitive network, or CycleGAN. The article describing this network is a significant step forward in the field of style transfer and shows how to train a model that can copy a style from a set of reference images to another image without using a training set of paired examples.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pre-existing style transfer models, such as pix2pix, required that each image in the training set exist in both source and target form. For some style transfer tasks (for example, for converting black-and-white photographs into color photographs, maps into satellite imagery), you can create such a data set, but for others it is simply not possible. For example, we do not have original photographs of the pond from which Monet wrote his series ‚ÄúWater Lilies‚Äù, and paintings by Picasso with the image of Empire State Building. By analogy, it would take tremendous efforts to get photographs of horses and zebras standing in identical poses. An article describing CycleGAN came out just a few months after an article describing the pix2pix method, and shows how to train a model to solve the same problems,but in the absence of pairs of source and target images. In fig. Figure 5.4 shows the difference between paired and unpaired pix2pix and CycleGAN datasets, respectively. If the pix2pix method allows you to simulate changes in only one direction (from the source style to the target), then CycleGAN trains the model in both directions at the same time, so the model learns to convert source images to target and vice versa. This property is due to the architecture of the model, so you get the ability to convert in the opposite direction automatically.thanks to which the model learns to convert source images to target and vice versa. This property is due to the architecture of the model, so you get the ability to convert in the opposite direction automatically.thanks to which the model learns to convert source images to target and vice versa. This property is due to the architecture of the model, so you get the ability to convert in the opposite direction automatically.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/ll/7h/sjll7hxb1xg16b8gu7abio3sx9i.png" alt="image"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's see how to build a CycleGAN model using Keras. </font><font style="vertical-align: inherit;">To begin with, let's take the previous example with apples and oranges as a basis, go through all parts of CycleGAN and experiment with its architecture. </font><font style="vertical-align: inherit;">Then we apply the same approach to create a model that can apply the style of a particular artist to the photograph of your choice.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Your first CycleGAN network</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most of the following code was borrowed from the Keras-GAN repository (http://bit.ly/2Za68J2), maintained by Erik Linder-Nor√©n. </font><font style="vertical-align: inherit;">This wonderful resource contains many examples of generative-competitive networks from various books implemented with Keras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First you need to download the data that will be used for training. </font><font style="vertical-align: inherit;">In the folder where you cloned the repository with examples for the book, run the command:</font></font><br>
<br>
<code>bash ./scripts/download_cyclegan_data.sh apple2orange</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the downloaded set of images of apples and oranges, which we will use later, the data is divided into four folders: trainA and testA contain images of apples, and trainB and testB contain images of oranges. </font><font style="vertical-align: inherit;">That is, A represents the space of images of apples, and B represents the space of images of oranges. </font><font style="vertical-align: inherit;">Our goal is to train the model on the data sets in the train folders to convert images from set A to set B, and vice versa. </font><font style="vertical-align: inherit;">Images in the test folders we use to test the quality of the model. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬ªMore information on the book can be found on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the publisher‚Äôs website</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contents</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excerpt</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494396/index.html">Welcome Mat - now also in Russian</a></li>
<li><a href="../en494398/index.html">Playstation Doom Polygons</a></li>
<li><a href="../en494400/index.html">Coronavirus and the Internet</a></li>
<li><a href="../en494402/index.html">Stages of Strategic Maturity</a></li>
<li><a href="../en494406/index.html">Machine learning without a teacher. Excerpt from the book</a></li>
<li><a href="../en494410/index.html">Before it became mainstream: how we launched contactless delivery</a></li>
<li><a href="../en494416/index.html">The path from a young startup to a technology company that makes highly loaded real estate projects</a></li>
<li><a href="../en494418/index.html">Intel resets processor model numbers. But this is not certain - there will be a vote</a></li>
<li><a href="../en494422/index.html">2019 Student IoT Projects Competition: Severe Chelyabinsk Internet of Things Collected All Awards</a></li>
<li><a href="../en494424/index.html">About the development of speaking skills</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>