<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöú üôçüèº üòΩ Detecta COVID-19 en rayos X con Keras, TensorFlow y Deep Learning ü•â üï∏Ô∏è ü•´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Con la ayuda de esta gu√≠a, con la ayuda de Keras, TensorFlow y el aprendizaje profundo, aprenderemos c√≥mo determinar autom√°ticamente COVID-19 a partir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Detecta COVID-19 en rayos X con Keras, TensorFlow y Deep Learning</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con la ayuda de esta gu√≠a, con la ayuda de Keras, TensorFlow y el aprendizaje profundo, aprenderemos c√≥mo determinar autom√°ticamente COVID-19 a partir de un conjunto de datos ensamblado manualmente a partir de im√°genes de rayos X. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como muchos otros, estoy sinceramente preocupado por COVID-19. </font><font style="vertical-align: inherit;">Me di cuenta de que constantemente analizo mi condici√≥n y me pregunto si contraer√© la enfermedad y cu√°ndo ocurrir√°. </font><font style="vertical-align: inherit;">Y cuanto m√°s me preocupo por eso, m√°s se convierte en un juego mental doloroso, en el que la sintomatolog√≠a se combina con hipocondr√≠a:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me despert√© por la ma√±ana, sintiendo algo de dolor y debilidad.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando me arrastr√© fuera de la cama, encontr√© una nariz que moqueaba (aunque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya se sabe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que una nariz que moquea </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><font style="vertical-align: inherit;">un s√≠ntoma de COVID-19).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando llegu√© al ba√±o a buscar una bufanda de papel, ya estaba tosiendo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio no le prest√© mucha atenci√≥n: soy al√©rgico al polen y, debido al clima c√°lido en la costa este de los Estados Unidos, esta primavera fue muy temprana. </font><font style="vertical-align: inherit;">Lo m√°s probable es que estos sean s√≠ntomas al√©rgicos. </font><font style="vertical-align: inherit;">Pero durante el d√≠a mi condici√≥n no mejor√≥. </font><font style="vertical-align: inherit;">Me siento y escribo este manual con un term√≥metro en la boca. </font><font style="vertical-align: inherit;">Miro hacia abajo y veo 37.4 ¬∞ C. </font><font style="vertical-align: inherit;">Mi temperatura corporal normal es ligeramente m√°s baja que otras, a 36.3 ¬∞ C. </font><font style="vertical-align: inherit;">Todo por encima de 37.2 ¬∞ C ya es un poco de calor para m√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øTos y fiebre leve? </font><font style="vertical-align: inherit;">Podr√≠a ser COVID-19 ... o simplemente mi alergia. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es imposible descubrirlo sin probarlo, y es precisamente esta "ignorancia" lo que hace que la situaci√≥n sea tan intimidante a nivel humano.</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minuto de atenci√≥n ovni</font></font></h3><br>
     COVID-19 ‚Äî     ,   SARS-CoV-2 (2019-nCoV).        ‚Äî    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pesar de mis miedos, trato de pensar racionalmente. Tengo poco m√°s de 30 a√±os, estoy en buena forma y mi inmunidad es fuerte. Me pondr√© en cuarentena (por si acaso), descansar√© y me encargar√© de todo. COVID-19 no me asusta desde el punto de vista de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> salud </font><i><font style="vertical-align: inherit;">personal</font></i><font style="vertical-align: inherit;"> (al menos lo soportar√© yo mismo) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, me preocupo por mis parientes de edad avanzada, incluidos todos aquellos que ya han sido diagnosticados con la enfermedad, as√≠ como aquellos que est√°n en hogares de ancianos y hospitales. Estas personas son vulnerables, y ser√° terrible si mueren debido a COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En lugar de no hacer nada y dejar que mi dolencia me mantenga en casa (ya sea alergia, COVID-19 o mis miedos), decid√≠ hacer lo que pueda:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribir√© el c√≥digo, realizar√© experimentos y, utilizando ejemplos pr√°cticos, ense√±ar√© a otros c√≥mo usar la visi√≥n por computadora y el aprendizaje profundo</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debo decir de inmediato que este </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><i><font style="vertical-align: inherit;">el</font></i><font style="vertical-align: inherit;"> art√≠culo m√°s cient√≠fico escrito por m√≠. </font><font style="vertical-align: inherit;">Ella no es cient√≠fica en absoluto. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vale la pena publicar los </font><font style="vertical-align: inherit;">m√©todos y conjuntos de datos utilizados </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pero sirven como punto de partida para aquellos que quieren al menos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algo para</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ayudar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estoy preocupado por ti y esta comunidad. </font><font style="vertical-align: inherit;">Quiero ayudar en lo que pueda: este art√≠culo es mi forma de hacer frente mentalmente a los momentos dif√≠ciles, mientras ayudo a otros en una situaci√≥n similar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta gu√≠a aprender√°s:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥mo recopilar un conjunto de datos de c√≥digo abierto de im√°genes de rayos X de pacientes con COVID-19 detectado.</font></font></li>
<li>   ¬´¬ª (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ya he insinuado esto, pero ahora lo dir√© directamente. </font><font style="vertical-align: inherit;">Las t√©cnicas descritas aqu√≠ son solo para fines educativos. </font><font style="vertical-align: inherit;">Este </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><strong><font style="vertical-align: inherit;">un</font></strong><font style="vertical-align: inherit;"> estudio cient√≠fico riguroso; no se publicar√° en revistas. </font><font style="vertical-align: inherit;">Este art√≠culo es para lectores interesados ‚Äã‚Äãen la visi√≥n por computadora y el aprendizaje profundo, que quieran aprender en la pr√°ctica, as√≠ como para aquellos inspirados por los acontecimientos actuales. </font><font style="vertical-align: inherit;">Les pido que tengan todo esto en cuenta. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la primera parte del manual, discutiremos c√≥mo detectar COVID-19 en las radiograf√≠as de pulm√≥n. </font><font style="vertical-align: inherit;">Luego discutimos el conjunto de datos en s√≠. </font><font style="vertical-align: inherit;">Y luego mostrar√© c√≥mo entrenar al modelo usando Keras y TensorFlow para predecir COVID-19 en nuestras im√°genes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Explicaci√≥n</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este art√≠culo de autodetecci√≥n de COVID-19 est√° escrito solo con fines educativos. Que </font></font></strong><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> describen un sistema de diagn√≥stico fiable y preciso COVID-19, no se ha probado ni de un profesional, ni desde el punto de vista acad√©mico.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mi objetivo es inspirarlo y mostrarle c√≥mo el estudio de la visi√≥n por computadora y el aprendizaje profundo con la aplicaci√≥n posterior de este conocimiento en el campo de la medicina puede tener un gran impacto en el mundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imag√≠nese: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no necesita una educaci√≥n m√©dica para influir en la medicina</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Los profesionales de capacitaci√≥n profunda de hoy trabajan en estrecha colaboraci√≥n con los m√©dicos y otros m√©dicos para resolver problemas complejos, salvar vidas y hacer del mundo un lugar mejor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que mi liderazgo te inspire a hacerlo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero teniendo en cuenta todo lo anterior, los investigadores, los conservadores de revistas y el sistema de revisi√≥n ya est√°n sobrecargados con trabajos que describen modelos de pron√≥stico COVID-19 de dudosa calidad. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No env√≠e el c√≥digo y el modelo de este art√≠culo a una revista o alguna publicaci√≥n cient√≠fica; solo aumentar√° el caos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, si desea realizar una investigaci√≥n sobre la base de este art√≠culo (o cualquier otra publicaci√≥n sobre COVID-19), siga la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gu√≠a TR√çPODE para describir los modelos predictivos.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como comprender√°, el uso de la inteligencia artificial en el campo de la medicina puede tener consecuencias muy graves. Publique y use dichos modelos solo si es un m√©dico especialista o si ha sido informado en detalle por dichos especialistas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øC√≥mo se puede detectar COVID-19 en los rayos X?</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 1:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ejemplo de radiograf√≠a de un paciente diagnosticado con COVID-19. </font><font style="vertical-align: inherit;">En estas im√°genes, puede ense√±ar el clasificador usando Keras y TensorFlow para determinar COVID-19. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las pruebas para COVID-19 ahora son dif√≠ciles: no hay</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suficientes pruebas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero es imposible producirlas r√°pidamente, lo que solo aumenta el p√°nico. </font><font style="vertical-align: inherit;">Y en p√°nico, hay sinverg√ºenzas que intentan sacar provecho de otros</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y venden pruebas falsas en COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> encontr√°ndose v√≠ctimas desprevenidas en las redes sociales y mensajeros instant√°neos. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado el n√∫mero limitado de pruebas, debemos confiar en otros m√©todos de diagn√≥stico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decid√≠ estudiar las radiograf√≠as, porque los m√©dicos a menudo las usan y los resultados de la tomograf√≠a computarizada para diagnosticar neumon√≠a, inflamaci√≥n pulmonar, abscesos y ganglios linf√°ticos agrandados. Dado que el virus ataca las c√©lulas epiteliales que recubren el tracto respiratorio, podemos usar rayos X para estudiar la condici√≥n de los pulmones humanos. Y dado que las m√°quinas de rayos X est√°n en casi todas partes, utilizando las im√°genes puede detectar COVID-19 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kits de prueba. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las desventajas del m√©todo incluyen la necesidad de radi√≥logos, as√≠ como un tiempo de procesamiento significativo. Y el tiempo es especialmente costoso cuando las personas est√°n enfermas en todo el mundo. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y para ahorrar tiempo a los m√©dicos, debe crear un sistema de an√°lisis autom√°tico</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2:</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a la izquierda hay im√°genes de personas con un resultado positivo (infectado), a la derecha, con un negativo. </font><font style="vertical-align: inherit;">En estas im√°genes, ense√±aremos el modelo utilizando TensorFlow y Keras para predecir autom√°ticamente la presencia de COVID-19 (es decir, una enfermedad resultante del coronavirus). </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El conjunto de datos de im√°genes de pacientes utilizado con COVID-19 utilizado aqu√≠ fue compilado bajo la supervisi√≥n del</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dr. Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un estudiante graduado de la Universidad de Montreal. </font><font style="vertical-align: inherit;">Hace unos d√≠as, Cohen comenz√≥ a recolectar im√°genes de rayos X de pacientes con COVID-19 y subirlas</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al repositorio de GitHub. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All√≠ encontrar√° ejemplos no solo de esta enfermedad, sino tambi√©n de MERS, SARS y ARDS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para crear un conjunto de datos I:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analiza el archivo metadata.csv del repositorio.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccion√≥ todas las l√≠neas:</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En total, se obtuvieron </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 disparos con resultados positivos en COVID-19</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">izquierda</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora elija las fotos de personas sanas.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para hacer esto, tom√© un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de datos de rayos X de pulm√≥n de Kaggle (neumon√≠a)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y seleccion√© </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 im√°genes de personas sanas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derecha</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Este conjunto de datos tiene una serie de inconvenientes, incluidas las etiquetas con relleno incorrecto o incorrecto, pero es adecuado como punto de partida para probar la hip√≥tesis del detector COVID-19. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, recib√≠ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 inyecciones:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 25 pacientes con COVID-19 y 25 sanos. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede descargar el conjunto de datos desde el </font></font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enlace</font></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Adem√°s, agregu√© scripts de Python con los que gener√© el conjunto de datos, pero en este art√≠culo no los consider√©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estructura del proyecto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descargue el c√≥digo y los datos. </font><font style="vertical-align: inherit;">Extraiga los archivos desde all√≠ y obtendr√° la siguiente estructura de directorios:</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
‚îú‚îÄ‚îÄ dataset<font></font>
‚îÇ   ‚îú‚îÄ‚îÄ covid [<span class="hljs-number">25</span> entries]<font></font>
‚îÇ   ‚îî‚îÄ‚îÄ normal [<span class="hljs-number">25</span> entries]<font></font>
‚îú‚îÄ‚îÄ build_covid_dataset.py<font></font>
‚îú‚îÄ‚îÄ sample_kaggle_dataset.py<font></font>
‚îú‚îÄ‚îÄ train_covid19.py<font></font>
‚îú‚îÄ‚îÄ plot.png<font></font>
‚îî‚îÄ‚îÄ covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tres directorios, cinco archivos. </font><font style="vertical-align: inherit;">El conjunto de datos se encuentra en el directorio / conjunto de datos y se divide en dos clases: covid / y normal /. </font><font style="vertical-align: inherit;">A continuaci√≥n vemos el script train_covid19.py que entrena nuestro detector COVID-19.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementaci√≥n de script de entrenamiento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos a ajustar la red neuronal convolucional, que diagnosticar√° autom√°ticamente COVID-19 usando Keras, TensorFlow y aprendizaje profundo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abra el archivo train_covid19.py y pegue el siguiente c√≥digo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este script aprovecha las bibliotecas TensorFlow 2.0 y Keras seleccionando las importaciones de tensorflow.keras. </font><font style="vertical-align: inherit;">Tambi√©n usamos:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , esta es una </font><font style="vertical-align: inherit;">biblioteca de aprendizaje autom√°tico de Python </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de facto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para gr√°ficos,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para cargar y preprocesar im√°genes en un conjunto de datos.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para saber c√≥mo instalar TensorFlow 2.0 (incluidos scikit-learn, OpenCV y matplotlib), consulte mis tutoriales para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora analizamos los argumentos para la l√≠nea de comando e inicializamos los hiperpar√°metros:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestros tres </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumentos de l√≠nea de comando</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 24-31</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) incluyen:</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ruta al conjunto de datos de entrada.</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ruta opcional al horario de salida del historial de aprendizaje. </font><font style="vertical-align: inherit;">Por defecto, el gr√°fico se llama plot.png a menos que se especifique un nombre diferente en la l√≠nea de comando.</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ruta opcional a nuestro modelo de definici√≥n COVID-19 de salida. </font><font style="vertical-align: inherit;">Por defecto, se llama covid19.model.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora inicializamos la frecuencia de aprendizaje inicial, el n√∫mero de eras de entrenamiento y los hiperpar√°metros de tama√±o de paquete ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 35-37</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, descargue y procese previamente las radiograf√≠as:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para cargar los datos, tomamos todas las rutas a las im√°genes en el directorio --dataset ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠nea 42</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), y luego para cada imagePath:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extraemos de la ruta ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠nea 49</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) la etiqueta de clase (covid o normal).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cargamos la imagen, la convertimos a canales RGB y la reducimos a un tama√±o de 224x224 p√≠xeles para alimentar una red neuronal convolucional ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 53-55</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualizaci√≥n de listas de datos y etiquetas ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 58 y 59</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego escalamos la intensidad de p√≠xeles en un rango </font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y convertimos los datos y las etiquetas al formato de matriz NumPy ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 63 y 64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, realizaremos una codificaci√≥n en caliente de nuestras etiquetas y dividiremos el conjunto de datos en conjuntos de entrenamiento y prueba:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La codificaci√≥n de etiquetas unitarias se realiza en las </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 67-69</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : los datos se presentar√°n en este formato:</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada etiqueta codificada de esta manera consiste en una matriz de dos elementos, en la que uno de los elementos est√° "activo" (1) y el segundo es "no" (0). En las </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 73 y 74, el</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conjunto de datos se divide en dos partes: 80% para capacitaci√≥n, 20% para pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para generalizar el modelo, realizamos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la expansi√≥n de datos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (aumento de datos), estableciendo una rotaci√≥n de imagen aleatoria en 15 grados en sentido horario o en sentido contrario. El objeto de generaci√≥n de extensi√≥n se inicializa en las </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 77-79</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora inicialice el modelo VGGNet y prep√°relo para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un ajuste fino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 83 y 84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se crea una instancia de la red neuronal VGG16 con los pesos obtenidos de antemano en ImageNet sin una capa completamente conectada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, crearemos una capa totalmente conectada que consta de POOL =&gt; FC = capas SOFTMAX ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) y la colocaremos encima de VGG16 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠nea 97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora congele los pesos CONV para que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se entrene una capa completamente conectada ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 101-102</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Esto termina de sintonizar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora estamos listos para compilar y entrenar nuestro modelo de aprendizaje profundo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 106-108</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compilaron el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entrenamiento de velocidad de atenuaci√≥n de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> red </font><font style="vertical-align: inherit;">y el optimizador Adam. Dado que esta es una tarea de clasificaci√≥n de dos clases, utilizamos la funci√≥n de p√©rdida de la entrop√≠a cruzada binaria (binary_crossentropy), no la entrop√≠a cruzada categ√≥rica (crossentropy categ√≥rica). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comenzar el entrenamiento, llamamos al m√©todo Keras </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fit_generator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y le damos nuestros rayos X a trav√©s de una extensi√≥n de objeto de datos ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 112-117</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora vamos a evaluar el modelo:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, primero realizamos pron√≥sticos basados ‚Äã‚Äãen el conjunto de pruebas y obtenemos √≠ndices de pron√≥stico ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 121-125</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Luego generaremos y mostraremos el informe de clasificaci√≥n ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 128 y 129</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">usando la utilidad scikit-learn </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora calculemos la matriz de confusi√≥n para la estimaci√≥n estad√≠stica futura:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos aqu√≠:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generar una matriz de imprecisiones ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠nea 133</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilizamos esta matriz para determinar la precisi√≥n, la sensibilidad y la especificidad ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 135-137</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), y luego derivamos todas estas m√©tricas ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l√≠neas 141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, para un an√°lisis posterior, mostramos en forma de gr√°fico en un archivo el historial de cambios de precisi√≥n y p√©rdida:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y finalmente, serializamos el modelo de clasificador tf.keras en el disco:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrenamos nuestro detector con Keras y TensorFlow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de la implementaci√≥n del script train_covid19.py, podemos entrenar el detector autom√°tico. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descargue el c√≥digo fuente, el conjunto de datos y el modelo previamente entrenado. </font><font style="vertical-align: inherit;">Abra una terminal y ejecute el comando para entrenar el detector:</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diagn√≥stico autom√°tico de rayos X</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en esta parte no "resolvemos" el problema de determinar COVID-19. Est√° escrito en el contexto de la situaci√≥n actual y solo con fines educativos. Este es un ejemplo de la aplicaci√≥n pr√°ctica de la visi√≥n por computadora y el aprendizaje profundo, para que se sienta c√≥modo con diferentes m√©tricas, incluida la precisi√≥n, sensibilidad y especificidad habituales (y las compensaciones que deben tenerse en cuenta al trabajar con datos m√©dicos). Repito, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no resolvemos el</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> problema de determinar COVID-19.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Por lo tanto, nuestro detector autom√°tico mostr√≥ una precisi√≥n de</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ~ 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en muestras de</font><font style="vertical-align: inherit;">im√°genes de rayos X</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por s√≠ solos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No se utiliz√≥ otra informaci√≥n para entrenar el modelo, incluida la ubicaci√≥n geogr√°fica, la densidad de poblaci√≥n, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n recibimos</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sensibilidad del 100%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificidad del 80%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , lo que significa:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De los pacientes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (casos positivos verdaderos), utilizando el modelo, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pudimos identificar con precisi√≥n como "COVID-19 positivo" en el 100% de los casos.</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De los pacientes que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no ten√≠an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 (casos negativos verdaderos), utilizando el modelo, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pudimos identificarnos con precisi√≥n como "COVID-19 negativos" en solo el 80% de los casos.</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como muestra el gr√°fico del historial de entrenamiento, la red neuronal no est√° reentrenada, a pesar del </font><font style="vertical-align: inherit;">tama√±o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muy peque√±o</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de los datos de entrenamiento:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 3:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este gr√°fico de precisi√≥n y p√©rdida demuestra que nuestro modelo no est√° reentrenado.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es genial que hayamos logrado una precisi√≥n del 100% al detectar COVID-19. Sin embargo, la situaci√≥n con casos verdaderamente negativos es vergonzosa:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no queremos atribuir a "COVID-19-negativo" aquellos que realmente son "COVID-19-positivo".</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Menos queremos dejar que los pacientes enfermos se vayan a sus casas, a sus familiares y amigos, contribuyendo a una mayor propagaci√≥n de la enfermedad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambi√©n debe tener</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mucho cuidado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con la proporci√≥n de casos falsos positivos:</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no queremos contar por error a alguien como enfermo y ponerlo en cuarentena con otros pacientes para que se infecte de ellos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrar un equilibrio entre sensibilidad y especificidad:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">una</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tarea </font><i><font style="vertical-align: inherit;">extremadamente dif√≠cil</font></i><font style="vertical-align: inherit;"> , especialmente cuando se trata de medicina, y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especialmente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cuando se trata de propagar r√°pidamente enfermedades infecciosas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hablando de la visi√≥n m√©dica por computadora y el aprendizaje profundo, siempre debe recordar que el trabajo de nuestros modelos predictivos puede tener consecuencias muy graves: los </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagn√≥sticos err√≥neos pueden costar vidas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repito, los resultados en este art√≠culo se presentan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo con fines educativos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esta no es una publicaci√≥n de revista, estos datos no cumplen con los criterios del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TR√çPODE para la publicaci√≥n de modelos de pron√≥stico.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitaciones, mejoras y m√°s trabajo.</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 4:</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hoy en d√≠a, los profesionales de inteligencia artificial y aprendizaje profundo carecen de datos COVID-19 de calidad para entrenar de manera efectiva los sistemas autom√°ticos de reconocimiento de im√°genes.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Una de las principales limitaciones del m√©todo descrito en este manual son los datos.</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No tenemos suficientes datos (confiables) para entrenar detectores COVID-19.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Los hospitales ya tienen muchos casos con este virus, pero dada la privacidad y los derechos humanos, se hace a√∫n m√°s dif√≠cil reunir r√°pidamente un conjunto de datos de alta calidad a partir de im√°genes m√©dicas. Creo que en los pr√≥ximos 12-18 meses tendremos m√°s datos de calidad. Pero por ahora, tienes que usar lo que tienes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intent√© (dada mi condici√≥n f√≠sica y mental) en las condiciones de tiempo y recursos limitados para escribir esta gu√≠a para aquellos que est√©n interesados ‚Äã‚Äãen el uso de la visi√≥n por computadora y el aprendizaje profundo. Pero </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©jame</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recordarte que </font><strong><font style="vertical-align: inherit;">no soy un m√©dico profesional</font></strong><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para usar el detector COVID-19 en la vida real, debe ser </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rigurosamente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> probado por m√©dicos reales que trabajan de la mano con especialistas en aprendizaje profundo. El m√©todo que describ√≠ no es adecuado para esto. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, hay que tener cuidado con lo que "aprende" exactamente el modelo.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como escrib√≠ en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el manual de Grad-CAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, es probable que el modelo aprenda patrones que no son relevantes para COVID-19, pero solo pueda distinguir entre dos muestras de datos (es decir, diagn√≥sticos positivos y negativos). Los resultados de nuestro detector deber√°n ser rigurosamente probados y verificados por m√©dicos. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y finalmente, los detectores futuros (y m√°s avanzados) ser√°n multimodales.</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ahora usamos solo datos visuales (rayos X). Los mejores detectores deber√≠an usar otros datos: indicadores vitales del paciente, densidad de poblaci√≥n, ubicaci√≥n geogr√°fica, etc. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los datos visuales solos generalmente no son suficientes para tales tareas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por estas razones, quiero enfatizar nuevamente: esta gu√≠a solo juega el papel de material de capacitaci√≥n, no puede considerarse como un detector COVID-19 confiable. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si cree que usted o alguien cercano a COVID-19, siga las recomendaciones de su sistema de atenci√≥n m√©dica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que esta gu√≠a te haya sido √∫til. </font><font style="vertical-align: inherit;">Tambi√©n espero que sea para alguien un punto de partida en la b√∫squeda de m√©todos para utilizar la visi√≥n por computadora y el aprendizaje profundo para determinar autom√°ticamente COVID-19.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resumen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta gu√≠a, aprendi√≥ a usar Keras, TensorFlow y el aprendizaje profundo para crear un detector autom√°tico COVID-19 en un conjunto de datos a partir de im√°genes de rayos X. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoy (todav√≠a) no hay conjuntos de datos de imagen verificados de alta calidad para esta enfermedad, por lo que debe trabajar con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el repositorio de Joseph Cohen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tomamos 25 im√°genes de su</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conjunto de datos </font><strong><font style="vertical-align: inherit;">,</font></strong><font style="vertical-align: inherit;"> limit√°ndonos a la proyecci√≥n anteroposterior de casos diagnosticados positivamente.</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luego tomamos 25 im√°genes de personas sanas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">conjunto de datos </font></a><strong><font style="vertical-align: inherit;">de im√°genes de </font></strong></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rayos X de t√≥rax de Kaggle (neumon√≠a).</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, con la ayuda de Keras y TensorFlow, capacitamos al detector COVID-19, que mostr√≥ una </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precisi√≥n del 90-92%</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en nuestra muestra de prueba, con una sensibilidad del 100% y una especificidad del 80% (en nuestro peque√±o conjunto de datos). </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuerde que el detector descrito aqu√≠ es solo para fines educativos (vea la Nota en el texto). </font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quer√≠a inspirar a otras personas a utilizar el aprendizaje profundo, para mostrar que, en combinaci√≥n con la visi√≥n por computadora, puede tener un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gran impacto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en nuestras vidas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Espero que lo hayan disfrutado.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es493596/index.html">El hombre que no ten√≠a prisa</a></li>
<li><a href="../es493598/index.html">Ocultar parte del n√∫mero de tel√©fono</a></li>
<li><a href="../es493604/index.html">Eventos digitales en Mosc√∫ del 23 al 29 de marzo</a></li>
<li><a href="../es493606/index.html">La historia de la creaci√≥n de un servicio en la nube con sabor a cyberpunk</a></li>
<li><a href="../es493610/index.html">Programando una capa de video en una Raspberry Pi usando la API DispmanX</a></li>
<li><a href="../es493616/index.html">Im√°genes como cajas: ¬øqu√© hay dentro? Informar en Yandex</a></li>
<li><a href="../es493618/index.html">(No) OSINT obvio en Twitter</a></li>
<li><a href="../es493620/index.html">Curva log√≠stica ¬øCu√°ndo terminar√° la epidemia?</a></li>
<li><a href="../es493622/index.html">Escribir un Retrowave a Angular</a></li>
<li><a href="../es493626/index.html">Selenoide: cientos de pruebas de IU paralelas f√°ciles y r√°pidas. Pavel Senin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>