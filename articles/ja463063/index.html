<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐾 👶 👩🏾‍🔬 Goのインターフェースを扱います 👨🏿‍🤝‍👨🏽 🔻 🍒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="過去数か月間、私はGoで理解するのが難しいことを人々に尋ねる研究を行ってきました。そして、私は答えが定期的にインターフェースの概念に言及していることに気づきました。Goは私が最初に使用したインターフェース言語でしたが、当時、この概念は非常に混乱しているようでした。そして、このガイドでは、私はこれをし...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Goのインターフェースを扱います</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/463063/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/_f/w7/1l/_fw71luza3o_kj1bh6t015wlp4c.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
過去数か月間、私は</font><font style="vertical-align: inherit;">Goで理解するのが難しいことを人々に尋ねる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">行ってき</font><font style="vertical-align: inherit;">ました。</font><font style="vertical-align: inherit;">そして、私は答えが定期的にインターフェースの概念に言及していることに気づきました。</font><font style="vertical-align: inherit;">Goは私が最初に使用したインターフェース言語でしたが、当時、この概念は非常に混乱しているようでした。</font><font style="vertical-align: inherit;">そして、このガイドでは、私はこれをしたいです：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースとは人間の言語で説明する。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらがどのように役立つか、そしてコードでそれらをどのように使用できるかを説明してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何について話し</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます（空のインターフェース）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、標準ライブラリで見つけることができるいくつかの便利なインターフェイスタイプについて説明します。</font></font></li>
</ol><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、インターフェースとは何でしょうか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goのインターフェースタイプは一種の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定義</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のタイプが持つべき</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のメソッドを定義して説明し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
標準ライブラリのインターフェイスタイプの1つは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fmt.Stringer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイス</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Stringer <span class="hljs-keyword">interface</span> {<font></font>
    String() <span class="hljs-keyword">string</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その「何か」に特定の署名文字列値を持つメソッドがある場合</font><font style="vertical-align: inherit;">
、何か</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がこのインターフェイスを満たす</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（または</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このインターフェイスを実装する</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">と言い</font><font style="vertical-align: inherit;">ます</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、型</font></font><code>Book</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は文字列メソッドを持っているため、インターフェースを満たします</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Book <span class="hljs-keyword">struct</span> {<font></font>
    Title  <span class="hljs-keyword">string</span>
    Author <span class="hljs-keyword">string</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b Book)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"Book: %s - %s"</span>, b.Title, b.Author)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それがどのタイプ</font></font><code>Book</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か、何をするか</font><font style="vertical-align: inherit;">は関係ありません</font><font style="vertical-align: inherit;">。</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要なのは、文字列値を返す</font><font style="vertical-align: inherit;">メソッドが呼び出され</font><font style="vertical-align: inherit;">ていることです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の例を示します。この型</font><font style="vertical-align: inherit;">は、同じ署名文字列値を持つメソッドを持っているため</font><i><font style="vertical-align: inherit;">、インターフェイス</font></i></font><code>Count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">満たし</font></font></i> <code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Count <span class="hljs-keyword">int</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c Count)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> strconv.Itoa(<span class="hljs-keyword">int</span>(c))<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、2つの異なるタイプが</font></font><code>Book</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり</font></font><code>Count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、動作が異なる</font><font style="vertical-align: inherit;">ことを理解することが重要</font><font style="vertical-align: inherit;">です。しかし、それらは両方ともインターフェースを満たすという事実によって統一されています</font></font><code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
反対側から見ることができます。オブジェクトがインターフェイスを満たしていることがわかっている場合は、</font><font style="vertical-align: inherit;">呼び出し可能な</font></font><code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">署名文字列値</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">持つメソッドが</font><font style="vertical-align: inherit;">オブジェクトにある</font><font style="vertical-align: inherit;">と想定</font><font style="vertical-align: inherit;">できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、最も重要なこと。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Goで（変数、関数パラメーター、または構造体フィールドの）インターフェイス型を持つ宣言を見つけた場合、インターフェイスを満たす限り、任意の型のオブジェクトを使用できます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数があるとしましょう：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WriteLog</span><span class="hljs-params">(s fmt.Stringer)</span></span> {<font></font>
    log.Println(s.String())<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><code>WriteLog()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ宣言</font></font><code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">インターフェイスタイプを使用する</font><font style="vertical-align: inherit;">
ため</font><font style="vertical-align: inherit;">、インターフェイス</font><font style="vertical-align: inherit;">を満たす任意のオブジェクトを渡すことができます</font></font><code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。たとえば</font><font style="vertical-align: inherit;">、メソッド</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">以前に作成し</font><font style="vertical-align: inherit;">たタイプ</font></font><code>Book</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>Count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それを</font><font style="vertical-align: inherit;">渡すことができ</font></font><code>WriteLog()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、コードは正常に動作します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、渡されたオブジェクトを満たすインターフェース以来</font></font><code>fmt.Stringer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、私たちは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">知っている</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それは文字列のメソッドがあること</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、安全機能によって呼び出すことができます</font></font><code>WriteLog()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてを1つの例にまとめて、インターフェースの力を示しましょう。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"strconv"</span>
    <span class="hljs-string">"log"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">//   Book,    fmt.Stringer.</span>
<span class="hljs-keyword">type</span> Book <span class="hljs-keyword">struct</span> {<font></font>
    Title  <span class="hljs-keyword">string</span>
    Author <span class="hljs-keyword">string</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(b Book)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"Book: %s - %s"</span>, b.Title, b.Author)<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   Count,    fmt.Stringer.</span>
<span class="hljs-keyword">type</span> Count <span class="hljs-keyword">int</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c Count)</span> <span class="hljs-title">String</span><span class="hljs-params">()</span> <span class="hljs-title">string</span></span> {
    <span class="hljs-keyword">return</span> strconv.Itoa(<span class="hljs-keyword">int</span>(c))<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   WriteLog(),    ,</span>
<span class="hljs-comment">//   fmt.Stringer   .</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WriteLog</span><span class="hljs-params">(s fmt.Stringer)</span></span> {<font></font>
    log.Println(s.String())<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//   Book    WriteLog().</span>
    book := Book{<span class="hljs-string">"Alice in Wonderland"</span>, <span class="hljs-string">"Lewis Carrol"</span>}<font></font>
    WriteLog(book)<font></font>
<font></font>
    <span class="hljs-comment">//   Count    WriteLog().</span>
    count := Count(<span class="hljs-number">3</span>)<font></font>
    WriteLog(count)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カッコいい。</font><font style="vertical-align: inherit;">メイン関数では、さまざまなタイプ</font></font><code>Book</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">を作成しまし</font></font><code>Count</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たが、それらを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数に</font><font style="vertical-align: inherit;">渡しました</font></font><code>WriteLog()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そして、彼女は適切な関数を呼び出し、</font></font><code>String()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果をログに記録しました。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">コード</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、同様の結果が得られます。</font></font><br>
<br>
<pre><code class="plaintext hljs">2009/11/10 23:00:00 Book: Alice in Wonderland - Lewis Carrol<font></font>
2009/11/10 23:00:00 3</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これについては詳しく説明しません。</font><font style="vertical-align: inherit;">覚えておくべき主なこと：関数宣言</font></font><code>WriteLog()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">インターフェイスの種類を使用して</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受け取ったオブジェクトの</font><i><font style="vertical-align: inherit;">種類に関係</font></i><font style="vertical-align: inherit;">なく（または柔軟に）関数を作成しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">重要なのは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、彼が持っている方法</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">便利なインターフェースは何ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goでインターフェースの使用を開始できる理由はいくつかあります。</font><font style="vertical-align: inherit;">そして、私の経験では、最も重要なものは次のとおりです。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェースは、重複、つまり定型コードの量を減らすのに役立ちます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これにより、実際のオブジェクトの代わりに単体テストでスタブを使用しやすくなります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アーキテクチャーツールであるインターフェースは、コードベースの一部を分離するのに役立ちます。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのインターフェースの使用方法をさらに詳しく見てみましょう。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボイラープレートコードの量を減らす</font></font></h3><br><font style="vertical-align: inherit;"></font><code>Customer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントに関するデータを含む</font><font style="vertical-align: inherit;">
構造</font><font style="vertical-align: inherit;">があるとします。</font><font style="vertical-align: inherit;">コードの1つの部分では、この情報を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes.Buffer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に書き込み、もう1つの部分では、</font><font style="vertical-align: inherit;">クライアントデータを</font><font style="vertical-align: inherit;">ディスク上の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os.File</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">書き込みます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ただし、どちらの場合も、最初に構造</font></font><code>ustomer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をJSONに</font><font style="vertical-align: inherit;">シリアル化</font><font style="vertical-align: inherit;">する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシナリオでは、Goインターフェースを使用してボイラープレートコードの量を減らすことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io.Writer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイスタイプがあります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Writer <span class="hljs-keyword">interface</span> {<font></font>
        Write(p []<span class="hljs-keyword">byte</span>) (n <span class="hljs-keyword">int</span>, err error)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、我々は事実を利用することができ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes.Buffer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os.Fileの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプは</font><font style="vertical-align: inherit;">、彼らが持っているので、このインタフェースを満たす</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bytes.Buffer.Write（）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os.File.Write（）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドをそれぞれ</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単な実装：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"encoding/json"</span>
    <span class="hljs-string">"io"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"os"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">//   Customer.</span>
<span class="hljs-keyword">type</span> Customer <span class="hljs-keyword">struct</span> {<font></font>
    Name <span class="hljs-keyword">string</span>
    Age  <span class="hljs-keyword">int</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//   WriteJSON,   io.Writer   .</span>
<span class="hljs-comment">//    ustomer  JSON,     </span>
<span class="hljs-comment">// ,     Write()  io.Writer.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Customer)</span> <span class="hljs-title">WriteJSON</span><span class="hljs-params">(w io.Writer)</span> <span class="hljs-title">error</span></span> {<font></font>
    js, err := json.Marshal(c)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> err<font></font>
    }<font></font>
<font></font>
    _, err = w.Write(js)<font></font>
    <span class="hljs-keyword">return</span> err<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">//   Customer.</span>
    c := &amp;Customer{Name: <span class="hljs-string">"Alice"</span>, Age: <span class="hljs-number">21</span>}<font></font>
<font></font>
    <span class="hljs-comment">//    Buffer    WriteJSON</span>
    <span class="hljs-keyword">var</span> buf bytes.Buffer<font></font>
    err := c.WriteJSON(buf)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">//   .</span>
    f, err := os.Create(<span class="hljs-string">"/tmp/customer"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
    <span class="hljs-keyword">defer</span> f.Close()<font></font>
<font></font>
<font></font>
    err = c.WriteJSON(f)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、これは架空の例にすぎません（同じ結果を得るために、コードを異なる方法で構造化することができます）。</font><font style="vertical-align: inherit;">しかし、それはインターフェースを使用することの利点をよく示しています。メソッドを一度作成</font></font><code>Customer.WriteJSON()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して、インターフェースを満たす何かに書き込む必要があるたびにそれを呼び出すことができます</font></font><code>io.Writer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、Goを</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初めて使用する場合は、いくつか</font></font><code>bytes.Buffer</code><font style="vertical-align: inherit;"></font><code>os.File</code><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">質問があります。「</font><i><font style="vertical-align: inherit;">io.Writerインターフェイスが存在するかどうかを確認するにはどうすればよいですか。</font></i><i><font style="vertical-align: inherit;">そして、どのように、あなたは彼が満足していることを事前に知っています</font></i><i><font style="vertical-align: inherit;">と</font></i><i><font style="vertical-align: inherit;">？</font></i><font style="vertical-align: inherit;">」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡単な解決策はありません。</font><font style="vertical-align: inherit;">経験を積むだけで、標準ライブラリのインターフェイスやさまざまなタイプについて理解できます。</font><font style="vertical-align: inherit;">これは、このライブラリのドキュメントを読んだり、他の人のコードを表示したりするのに役立ちます。</font><font style="vertical-align: inherit;">また、簡単に参照できるように、記事の最後に最も有用なタイプのインターフェースタイプを追加しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、標準ライブラリのインターフェースを使用しない場合でも</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、独自のインターフェースタイプ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を作成して使用することを妨げるものはありません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これについては以下で説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユニットテストとスタブ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターフェースが単体テストでどのように役立つかを理解するために、より複雑な例を見てみましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストアがあり、PostgreSQLの売り上げと顧客数に関する情報があるとします。最終日の売上高のシェア（顧客ごとの特定の売上数）を小数点第2位で四捨五入して計算するコードを記述します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最小限の実装は次のようになります。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// : main.go</span>
<span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"time"</span>
    <span class="hljs-string">"database/sql"</span>
    _ <span class="hljs-string">"github.com/lib/pq"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">type</span> ShopDB <span class="hljs-keyword">struct</span> {<font></font>
    *sql.DB<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(sdb *ShopDB)</span> <span class="hljs-title">CountCustomers</span><span class="hljs-params">(since time.Time)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">var</span> count <span class="hljs-keyword">int</span>
    err := sdb.QueryRow(<span class="hljs-string">"SELECT count(*) FROM customers WHERE timestamp &gt; $1"</span>, since).Scan(&amp;count)
    <span class="hljs-keyword">return</span> count, err<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(sdb *ShopDB)</span> <span class="hljs-title">CountSales</span><span class="hljs-params">(since time.Time)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">var</span> count <span class="hljs-keyword">int</span>
    err := sdb.QueryRow(<span class="hljs-string">"SELECT count(*) FROM sales WHERE timestamp &gt; $1"</span>, since).Scan(&amp;count)
    <span class="hljs-keyword">return</span> count, err<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    db, err := sql.Open(<span class="hljs-string">"postgres"</span>, <span class="hljs-string">"postgres://user:pass@localhost/db"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
    <span class="hljs-keyword">defer</span> db.Close()<font></font>
<font></font>
    shopDB := &amp;ShopDB{db}<font></font>
    sr, err := calculateSalesRate(shopDB)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
    fmt.Printf(sr)<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">calculateSalesRate</span><span class="hljs-params">(sdb *ShopDB)</span> <span class="hljs-params">(<span class="hljs-keyword">string</span>, error)</span></span> {<font></font>
    since := time.Now().Sub(<span class="hljs-number">24</span> * time.Hour)<font></font>
<font></font>
    sales, err := sdb.CountSales(since)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err<font></font>
    }<font></font>
<font></font>
    customers, err := sdb.CountCustomers(since)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err<font></font>
    }<font></font>
<font></font>
    rate := <span class="hljs-keyword">float64</span>(sales) / <span class="hljs-keyword">float64</span>(customers)
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2f"</span>, rate), <span class="hljs-literal">nil</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font></font><code>calculateSalesRate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、計算の正確性を検証するために</font><font style="vertical-align: inherit;">、関数の単体テストを作成</font><font style="vertical-align: inherit;">します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、これは問題があります。 PostgreSQLのテストインスタンスを構成し、データベースに偽のデータを入力するスクリプトを作成および削除する必要があります。計算を実際にテストする場合は、多くの作業を行う必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、インターフェースが助けになります！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、メソッドについて説明し、当社独自のインターフェイスタイプが作成されます</font></font><code>CountSales()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、</font></font><code>CountCustomers()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能が依存するが</font></font><code>calculateSalesRate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。次に</font></font><code>calculateSalesRate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、登録された型の代わりにこのインターフェイス型をパラメーターとして使用するように</font><font style="vertical-align: inherit;">シグニチャーを更新します</font></font><code>*ShopDB</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// : main.go</span>
<span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"time"</span>
    <span class="hljs-string">"database/sql"</span>
    _ <span class="hljs-string">"github.com/lib/pq"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-comment">//    ShopModel.    </span>
<span class="hljs-comment">//     ,    </span>
<span class="hljs-comment">//  -,     .</span>
<span class="hljs-keyword">type</span> ShopModel <span class="hljs-keyword">interface</span> {<font></font>
    CountCustomers(time.Time) (<span class="hljs-keyword">int</span>, error)<font></font>
    CountSales(time.Time) (<span class="hljs-keyword">int</span>, error)<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//  ShopDB    ShopModel,  </span>
<span class="hljs-comment">//       -- CountCustomers()  CountSales().</span>
<span class="hljs-keyword">type</span> ShopDB <span class="hljs-keyword">struct</span> {<font></font>
    *sql.DB<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(sdb *ShopDB)</span> <span class="hljs-title">CountCustomers</span><span class="hljs-params">(since time.Time)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">var</span> count <span class="hljs-keyword">int</span>
    err := sdb.QueryRow(<span class="hljs-string">"SELECT count(*) FROM customers WHERE timestamp &gt; $1"</span>, since).Scan(&amp;count)
    <span class="hljs-keyword">return</span> count, err<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(sdb *ShopDB)</span> <span class="hljs-title">CountSales</span><span class="hljs-params">(since time.Time)</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">var</span> count <span class="hljs-keyword">int</span>
    err := sdb.QueryRow(<span class="hljs-string">"SELECT count(*) FROM sales WHERE timestamp &gt; $1"</span>, since).Scan(&amp;count)
    <span class="hljs-keyword">return</span> count, err<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    db, err := sql.Open(<span class="hljs-string">"postgres"</span>, <span class="hljs-string">"postgres://user:pass@localhost/db"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
        log.Fatal(err)<font></font>
    }<font></font>
    <span class="hljs-keyword">defer</span> db.Close()<font></font>
<font></font>
    shopDB := &amp;ShopDB{db}<font></font>
<font></font>
    sr := calculateSalesRate(shopDB)<font></font>
    fmt.Printf(sr)<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">//       ShopModel   </span>
<span class="hljs-comment">//    *ShopDB.</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">calculateSalesRate</span><span class="hljs-params">(sm ShopModel)</span> <span class="hljs-title">string</span></span> {<font></font>
    since := time.Now().Sub(<span class="hljs-number">24</span> * time.Hour)<font></font>
<font></font>
    sales, err := sm.CountSales(since)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err<font></font>
    }<font></font>
<font></font>
    customers, err := sm.CountCustomers(since)<font></font>
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err<font></font>
    }<font></font>
<font></font>
    rate := <span class="hljs-keyword">float64</span>(sales) / <span class="hljs-keyword">float64</span>(customers)
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"%.2f"</span>, rate), <span class="hljs-literal">nil</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行った後は、インターフェースを満たすスタブを作成するだけ</font></font><code>ShopModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">その後、関数内の数学的論理の正しい操作の単体テスト中に使用できます</font></font><code>calculateSalesRate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このような：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-comment">// : main_test.go</span>
<span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"testing"</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">type</span> MockShopDB <span class="hljs-keyword">struct</span>{}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MockShopDB)</span> <span class="hljs-title">CountCustomers</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">1000</span>, <span class="hljs-literal">nil</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(m *MockShopDB)</span> <span class="hljs-title">CountSales</span><span class="hljs-params">()</span> <span class="hljs-params">(<span class="hljs-keyword">int</span>, error)</span></span> {
    <span class="hljs-keyword">return</span> <span class="hljs-number">333</span>, <span class="hljs-literal">nil</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestCalculateSalesRate</span><span class="hljs-params">(t *testing.T)</span></span> {
    <span class="hljs-comment">//  .</span><font></font>
    m := &amp;MockShopDB{}<font></font>
    <span class="hljs-comment">//     calculateSalesRate().</span><font></font>
    sr := calculateSalesRate(m)<font></font>
<font></font>
    <span class="hljs-comment">// ,       </span>
    <span class="hljs-comment">//   .</span>
    exp := <span class="hljs-string">"0.33"</span>
    <span class="hljs-keyword">if</span> sr != exp {<font></font>
        t.Fatalf(<span class="hljs-string">"got %v; expected %v"</span>, sr, exp)<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでテストを実行すると、すべてが正常に動作します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションのアーキテクチャ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の例では、インターフェイスを使用して、コードの特定の部分を特定の型の使用から分離する方法を説明しました。</font><font style="vertical-align: inherit;">たとえば</font></font><code>calculateSalesRate()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、インターフェースを満たしていれば、どの</font><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">に渡してもかまいません</font></font><code>ShopModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアを拡張して、大規模なプロジェクトで「アンタイド」レベル全体を作成できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データベースと対話するWebアプリケーションを作成するとします。</font><font style="vertical-align: inherit;">データベースと対話するための特定のメソッドを記述するインターフェースを作成する場合、HTTPハンドラーを介して特定のタイプの代わりにそれを参照できます。</font><font style="vertical-align: inherit;">HTTPハンドラーはインターフェースのみを参照するため、これはHTTPレベルとデータベースとの対話レベルを互いに分離するのに役立ちます。</font><font style="vertical-align: inherit;">レベルを個別に操作する方が簡単です。将来的には、他のレベルの作業に影響を与えることなく、一部のレベルを置き換えることができるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このパターンについて</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、以前の投稿の1つで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書きました</font><font style="vertical-align: inherit;">。詳細と実際の例があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空のインターフェースとは何ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goでしばらくプログラミングしている場合は、おそらく</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空のインターフェースタイプに</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出くわすことでしょう</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それが何であるかを説明しようと思います。</font><font style="vertical-align: inherit;">この記事の冒頭で、私は書きました：</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Goのインターフェースタイプは一種の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定義</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のタイプが持つべき</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のメソッドを定義して説明し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空のインターフェイスタイプ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はメソッドを記述しません</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">彼にはルールがありません。</font><font style="vertical-align: inherit;">そして、どのオブジェクトも空のインターフェースを満たします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本質的に、空のインターフェイスタイプ</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は一種のジョーカーです。</font><font style="vertical-align: inherit;">宣言（変数、関数パラメーター、または構造体フィールド）でそれを満たす場合は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">任意のタイプの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトを使用できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを考えてみましょう：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    person := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">0</span>)<font></font>
<font></font>
    person[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"Alice"</span>
    person[<span class="hljs-string">"age"</span>] = <span class="hljs-number">21</span>
    person[<span class="hljs-string">"height"</span>] = <span class="hljs-number">167.64</span><font></font>
<font></font>
    fmt.Printf(<span class="hljs-string">"%+v"</span>, person)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは</font></font><code>person</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、キーに文字列型を使用し、値に空のインターフェース型を使用する</font><font style="vertical-align: inherit;">マップを初期化</font><font style="vertical-align: inherit;">します</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">マップ値として3つの異なるタイプ（文字列、整数、float32）を割り当てましたが、問題ありません。</font><font style="vertical-align: inherit;">どのタイプのオブジェクトも空のインターフェースを満たすため、コードは適切に機能します。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここ</font></a><font style="vertical-align: inherit;">で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">このコード</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すると、同様の結果が表示されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">map[age:21 height:167.64 name:Alice]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
地図から値を抽出して使用することになると、これを覚えておくことが重要です。</font><font style="vertical-align: inherit;">値を取得</font></font><code>age</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して1だけ増やし</font><font style="vertical-align: inherit;">たいとします</font><font style="vertical-align: inherit;">。同様のコードを記述した場合、コンパイルされません。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> <span class="hljs-string">"log"</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    person := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">0</span>)<font></font>
<font></font>
    person[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"Alice"</span>
    person[<span class="hljs-string">"age"</span>] = <span class="hljs-number">21</span>
    person[<span class="hljs-string">"height"</span>] = <span class="hljs-number">167.64</span><font></font>
<font></font>
    person[<span class="hljs-string">"age"</span>] = person[<span class="hljs-string">"age"</span>] + <span class="hljs-number">1</span><font></font>
<font></font>
    fmt.Printf(<span class="hljs-string">"%+v"</span>, person)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーメッセージが表示されます。</font></font><br>
<br>
<pre><code class="plaintext hljs">invalid operation: person["age"] + 1 (mismatched types interface {} and int)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その理由は、mapに格納された値が型</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">取り、</font><font style="vertical-align: inherit;">元のbase int型を失うためです。</font><font style="vertical-align: inherit;">また、値が整数ではなくなったため、1 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を</font><font style="vertical-align: inherit;">追加することはできません。</font><font style="vertical-align: inherit;">これを回避するには、値をもう一度整数にして、それを使用する必要があります。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">package</span> main<font></font>
<font></font>
<span class="hljs-keyword">import</span> <span class="hljs-string">"log"</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {<font></font>
    person := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">0</span>)<font></font>
<font></font>
    person[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"Alice"</span>
    person[<span class="hljs-string">"age"</span>] = <span class="hljs-number">21</span>
    person[<span class="hljs-string">"height"</span>] = <span class="hljs-number">167.64</span><font></font>
<font></font>
    age, ok := person[<span class="hljs-string">"age"</span>].(<span class="hljs-keyword">int</span>)
    <span class="hljs-keyword">if</span> !ok {<font></font>
        log.Fatal(<span class="hljs-string">"could not assert value to int"</span>)
        <span class="hljs-keyword">return</span><font></font>
    }<font></font>
<font></font>
    person[<span class="hljs-string">"age"</span>] = age + <span class="hljs-number">1</span><font></font>
<font></font>
    log.Printf(<span class="hljs-string">"%+v"</span>, person)<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行すると</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべてが期待どおりに動作します。</font></font><br>
<br>
<pre><code class="plaintext hljs">2009/11/10 23:00:00 map[age:22 height:167.64 name:Alice]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では、いつ空のインターフェイスタイプを使用する必要がありますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あまり頻繁ではない</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これに来たら、立ち止まって、今すぐ使用するかどうかを検討してください</font></font><code>interface{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。一般的なアドバイスとして、特定の型、つまり空でないインターフェース型を使用する方が、理解しやすく、安全で生産性が高いと言えます。上記の例では</font></font><code>Person</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、適切に型指定されたフィールドで</font><font style="vertical-align: inherit;">構造を定義する方が適切でした</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> {<font></font>
    Name   <span class="hljs-keyword">string</span>
    Age    <span class="hljs-keyword">int</span>
    Height <span class="hljs-keyword">float32</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一方、空のインターフェースは、予測できないタイプまたはユーザー定義のタイプにアクセスして操作する必要がある場合に役立ちます。</font><font style="vertical-align: inherit;">何らかの理由で、このようなインターフェースは、標準ライブラリのさまざまな場所で使用され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">てい</font></a><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gob.Encode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fmt.Print、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">template.Execute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">便利なインターフェイスタイプ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、標準ライブラリから最も要求され、有用なインターフェイスタイプの短いリストです。</font><font style="vertical-align: inherit;">それらにまだ慣れていない場合は、関連ドキュメントを読むことをお勧めします。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">builtin.Error</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fmt.Stringer</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io.Reader</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io.Writer</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">io.ReadWriteCloser</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://golang.org/pkg/net/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http.ResponseWriter</font></font></a><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://golang.org/pkg/net/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http.Handler</font></font></a><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">標準ライブラリのより長いリスト</font><font style="vertical-align: inherit;">
も</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここから</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入手でき</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja463045/index.html">ニューラルネットワークを使用してテキスト会話の感情を自動的に検出</a></li>
<li><a href="../ja463055/index.html">社内の管理者、開発者、無限の混乱、DevOpsの変革について</a></li>
<li><a href="../ja463057/index.html">Yiiフレームワーク2カスタム権利</a></li>
<li><a href="../ja463059/index.html">ITの3つの生活</a></li>
<li><a href="../ja463061/index.html">Figmaでレイアウトを準備するためのルール</a></li>
<li><a href="../ja463067/index.html">まずはフロント、次にバック（いつか）</a></li>
<li><a href="../ja463069/index.html">React Basic Animated Guide</a></li>
<li><a href="../ja463071/index.html">インターネットの停止はどのような影響がありますか？</a></li>
<li><a href="../ja463073/index.html">QUICの実際：Uberがパフォーマンスを最適化するためにどのように実装したか</a></li>
<li><a href="../ja463075/index.html">新しいオープンソースライセンス</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>