<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♉️ 🌲 🙏🏼 Testez des projets sans douleur. Rapport Yandex 👩🏾‍🤝‍👨🏼 🕐 👎🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous, dans l'équipe Yandex.Maps pour iOS, créons des projets de test en utilisant un petit plugin pour CocoaPods et plusieurs classes d'utilitaires. L...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Testez des projets sans douleur. Rapport Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/503660/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous, dans l'équipe Yandex.Maps pour iOS, créons des projets de test en utilisant un petit plugin pour CocoaPods et plusieurs classes d'utilitaires. </font><font style="vertical-align: inherit;">La création d'un projet est rapide et fiable. </font><font style="vertical-align: inherit;">Mais peut-être nous dérange-t-on trop et ce n'est pas si difficile d'assembler un projet manuellement avec les paramètres et les dépendances nécessaires? </font><font style="vertical-align: inherit;">Dans le rapport, je suis allé du contraire: j'ai d'abord regardé le processus manuel, puis le nôtre.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8iwkFkkV9es" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- D'abord, un peu d'histoire. </font><font style="vertical-align: inherit;">Yandex.Les cartes sont collectées pendant plus d'une minute. </font><font style="vertical-align: inherit;">Sur mon ordinateur, la création de l'application prend un peu plus de trois minutes. </font><font style="vertical-align: inherit;">Nous développons des projets de test afin de passer moins de temps sur chaque montage. </font><font style="vertical-align: inherit;">Nous avons suffisamment de modularité, et pour chaque module, nous faisons un projet de test. </font><font style="vertical-align: inherit;">Dans ce projet de test, des fonctionnalités sont en cours de développement.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création d'un projet de test prend désormais de 15 minutes à une heure. Cela est dû au fait que le projet doit être configuré. Autrement dit, vous devez configurer la signature afin que nous puissions développer sur les mêmes appareils que ceux auxquels nous sommes habitués. Il est nécessaire de configurer les bibliothèques nécessaires. Dans le processus de développement de la fonctionnalité elle-même, nous revenons constamment et terminons le projet de test afin qu'il réponde à nos besoins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi avons-nous besoin de projets de test? Pour gagner du temps lors du montage. Plus le projet est petit, plus il est assemblé rapidement, plus nous serons en mesure de lancer notre application sur l'appareil et plus il sera confortable pour nous de le développer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zh/d_/rt/zhd_rt3d8t6ojvedwzffktuan7e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que devrait contenir le projet de test? Nous devrions pouvoir lancer, déboguer notre application sur les mêmes appareils sur lesquels nous sommes habitués à lancer et déboguer notre application principale.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet doit être configuré de manière aussi similaire que possible au projet principal, de sorte que lors du transfert des fonctionnalités du projet de test vers le projet principal, nous n'obtenions pas de surprise. </font><font style="vertical-align: inherit;">Ou du moins réduit le nombre de surprises reçues au minimum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également besoin d'un environnement minimal dans le projet de test, afin de ne pas perdre de temps à créer des fenêtres d'interface utilisateur, à configurer des bibliothèques, à annuler l'appel pour ouvrir l'application à la bibliothèque qui traite des autorisations, etc.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CocoaPods app_spec</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toute mon histoire d'aujourd'hui sera construite autour de la fonctionnalité CocoaPods appelée app_spec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pk/eb/xf/pkebxfc7kvhzsszibluqrljlkai.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
App_spec est comme une sous-espèce régulière, seulement elle ne génère pas un framework qui peut être connecté, mais une application qui peut être lancée sur l'appareil. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ds/kj/67/dskj67urgk0wocvvue0rsaexelq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et prêt à l'emploi, CocoaPods nous permet de placer Info.plist et xcconfig dans app_spec. Cela nous permet déjà de bien monter notre projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais si nous allons écrire d'énormes dictionnaires dans chaque pods_spec, avec des valeurs pour Info.plist et xcconfig, alors nous développerons podspec nous-mêmes et il ne sera pas pratique de les modifier. Si nous devons changer quelque chose, nous devons aller dans chaque fichier podspec et éditer quelque chose avec des stylos. Dans tous les cas, cela n'est pas pratique.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/go/mf/t6gomf0wb3koti2mtcxnlsm36e8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous en débarrasser, nous avons créé un plugin local très simple pour CocoaPods. Il tient même entièrement dans une diapositive. Et il fait la seule et unique chose: nous donne la permission DSL CocoaPods, qui crée app_spec avec des valeurs déjà bouchées dans Info.plist et xcconfig. Cela nous permet déjà de configurer la signature, de configurer les choses importantes que nous voulons voir configurées dans notre projet de test. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/7h/7w/kk7h7w7bl013cgrbwntjge0jjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question: comment transférer le chemin d'accès aux droits d'accès, plus précisément, où stocker les droits d'accès afin que nous puissions coder en dur le chemin d'accès dans les plug-ins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a deux façons. Ou indiquez le chemin d'un fichier qui se trouve simplement dans notre référentiel, par exemple, vers les droits du projet principal. Ou stockez dans le plugin un fichier de droits spéciaux pour les projets de test. Et en utilisant le même plugin, copiez-le sur notre developmentpod.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/37/xo/jr/37xojrk1orzo5d_2nj1eu1tconi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons choisi la première voie, et ici nous avons eu quelques difficultés. Le fait est que dans notre référentiel, les modules de développement se trouvent dans différents sous-dossiers. Par conséquent, nous ne pouvons pas leur indiquer un chemin d'accès relatif depuis le développementpod vers le fichier de droits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de souligner ici que vous devez spécifier un chemin relatif, car ce chemin reste dans pods_spec. Cela signifie qu'il participera au calcul du montant du chèque, qui est stocké dans Podfile.lock. Et s'il existe un chemin absolu, cela affectera le montant du chèque. Cela signifie que le montant du chèque variera en fonction du dossier à partir duquel $ pod installer, d'où vous avez le référentiel, sur quelle machine vous exécutez $ pod install. En général, cela conduit à des conflits.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/ek/ng/loekngcf64nbbzuaaadwy3qmhl4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je vais montrer une autre petite extension du même plugin, qui nous permet de calculer le chemin relatif vers ces droits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connaissons le chemin relatif de notre plugin vers le fichier avec des droits, s'ils sont dans le même référentiel. </font><font style="vertical-align: inherit;">Et aussi lors du lancement de $ pod install, nous connaissons le chemin vers notre developmentpod. </font><font style="vertical-align: inherit;">Toute la magie qui se trouve dans ce code est une ligne en surbrillance où nous comptons simplement le chemin relatif, connaissant ces deux chemins absolus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ya/yg/1l/yayg1ll82qeeq2xg28xnfrm4i2g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, qu'avons-nous obtenu lorsque nous avions déjà configuré app_spec de cette manière? </font><font style="vertical-align: inherit;">Nous pouvons exécuter notre projet de test sur les mêmes appareils immédiatement. </font><font style="vertical-align: inherit;">Nous avons obtenu une énorme quantité de paramètres, y compris les droits, dont nous avons besoin.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine chose dont je veux parler est l'environnement, l'environnement minimum nécessaire dont nous avons besoin pour commencer à écrire du code tout de suite. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/f-/t2/uif-t2fox7l9twbo2isjpzcx_py.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, nous avons besoin de MapKit, déjà configuré, avec les clés transférées, avec renvoi d'appel dans le AccountManager. Ceci est notre bibliothèque d'autorisation. Elle doit également lancer des appels système, elle doit également transférer des clés, notamment pour passer l'ouverture de l'application par référence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également besoin d'un écran de démarrage avec une carte et une pile de navigation, afin de pouvoir utiliser la même pile de navigation que dans Maps, et il est plus facile de transférer des fonctionnalités du projet de test vers le projet principal. Et le point d'entrée pour que nous, sans réfléchir, puissions immédiatement commencer à écrire du code utile.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/l0/c_/jql0c_lfm6weosqqsvivxclmqro.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans votre cas, cela pourrait être, par exemple, la configuration du SDK Facebook, auquel vous devez également transférer des clés; vos bibliothèques pour la connexion, dont vous aurez presque certainement besoin pour sauter le lien d'ouverture de l'application. Une sorte de contrôleur de démarrage Windows de démarrage et le même point d'entrée pour exécuter le script principal que vous souhaitez développer dans votre projet de test. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7u/6v/7o/7u6v7oxzg3dipiw2ztkcsub5ou8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment avons-nous fait cela? En créant un seul modèle AppDelegate. Là, nous initialisons tous les environnements nécessaires, les bibliothèques. Nous renvoyons tous les appels nécessaires, transférons les clés nécessaires. En créant un projet de test, il nous reste à créer un nouveau AppDelegate pour le projet de test et à hériter du modèle.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, nous remplaçons la seule et unique méthode appelée après que le modèle AppDelegate a fait tout ce qui était nécessaire. </font><font style="vertical-align: inherit;">Et là, nous avons déjà le ViewController de départ et en plus nous pouvons exécuter notre script, que nous voulons déboguer dans le projet de test.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Était / est devenu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment puis-je créer un projet de test dans le front et comment le créer en utilisant la méthode que j'ai décrite aujourd'hui? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Création d'un projet de test dans le front: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Nous allons dans Xcode, créons un nouveau projet (Fichier&gt; Nouveau projet). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Saisissez le nom, de préférence sans erreur, signez le Bundle ID. Nous mettons en place ce projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Changez la version de Swift, changez la version cible. Nous essayons de tout exécuter sur l'appareil, de modifier la signature, etc. C'est un processus plutôt morne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Ensuite, nous créons un podfile, y connectons les dépendances, installons des pods. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Après cela, nous allons commencer à configurer très fastidieusement et doucement notre AppDelegate, en transférant à travers les morceaux d'initialisation des bibliothèques dont nous avons besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Créez un UIWindows de démarrage avec notre ViewController</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et seulement après cela, nous pouvons démarrer le code utile. </font><font style="vertical-align: inherit;">Procédure assez désagréable, d'accord. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment pouvons-nous créer un projet de test en utilisant les meilleures pratiques que j'ai décrites dans le rapport d'aujourd'hui? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Nous créons sample_app_spec, en utilisant l'extension, pour CocoaPods, avec lequel nous avons commencé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Créez un AppDelegate et héritez-le du modèle AppDelegate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, nous pouvons commencer à écrire du code utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création d'un projet de test de cette manière est beaucoup plus rapide et plus fiable. </font><font style="vertical-align: inherit;">Nous ne ferons certainement pas d'erreur dans la signature des paramètres, nous ne ferons certainement pas d'erreur dans les paramètres du projet. </font><font style="vertical-align: inherit;">Tout l'environnement nécessaire au démarrage des travaux nous approche immédiatement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela peut-il être plus simple?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez poser une question - cela peut-il être plus facile? Bien sûr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9e/t_/ux/9et_uxcpepiyc5iavhfehkqen-q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai identifié trois niveaux de difficulté. Le premier est ce dont j'ai parlé aujourd'hui, tout à coup, lorsque nous créons un plug-in pour CocoaPods, qui peut réparer les chemins d'accès aux droits, et un modèle AppDelegate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxième méthode est idéale dans le rapport des efforts au profit. Il ne contient que le plugin pour CocoaPods, qui était le premier dans l'histoire d'aujourd'hui. Autrement dit, il remplace simplement les valeurs dans Info.plist et xcconfig. Cela rend déjà la vie beaucoup plus facile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez pas besoin de votre fichier de droits dans vos applications de test, si vos applications de test sont assez différentes les unes des autres et n'ont pas besoin de composants communs, cette méthode vous convient parfaitement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième méthode est la plus simple, ne nécessite aucune préparation. Commencez simplement à utiliser app_spec. Le projet généré à partir de app_spec est créé dans le même espace de travail que votre projet principal. Par conséquent, il hérite déjà, par exemple, Swift, de la version cible et de tous les paramètres que vous avez dans Workspace. Il vous sera beaucoup plus facile de commencer à travailler avec lui. C'est tout, merci de votre attention. Aujourd'hui, je vais vous dire comment créer des projets de test sans douleur, et comment nous créons des projets de test dans Yandex.Maps.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- D'abord, un peu d'histoire. Yandex.Les cartes sont collectées pendant plus d'une minute. Sur mon ordinateur, la création de l'application prend un peu plus de trois minutes. Nous développons des projets de test afin de passer moins de temps sur chaque montage. Nous avons suffisamment de modularité, et pour chaque module, nous faisons un projet de test. Dans ce projet de test, des fonctionnalités sont en cours de développement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création d'un projet de test prend désormais de 15 minutes à une heure. Cela est dû au fait que le projet doit être configuré. Autrement dit, vous devez configurer la signature afin que nous puissions développer sur les mêmes appareils que ceux auxquels nous sommes habitués. Il est nécessaire de configurer les bibliothèques nécessaires. Dans le processus de développement de la fonctionnalité elle-même, nous revenons constamment et terminons le projet de test afin qu'il réponde à nos besoins.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi avons-nous besoin de projets de test? Pour gagner du temps lors du montage. Plus le projet est petit, plus il est assemblé rapidement, plus nous serons en mesure de lancer notre application sur l'appareil et plus il sera confortable pour nous de le développer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zh/d_/rt/zhd_rt3d8t6ojvedwzffktuan7e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que devrait contenir le projet de test? Nous devrions pouvoir lancer, déboguer notre application sur les mêmes appareils sur lesquels nous sommes habitués à lancer et déboguer notre application principale. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le projet doit être configuré de manière aussi similaire que possible au projet principal, de sorte que lors du transfert des fonctionnalités du projet de test vers le projet principal, nous n'obtenions pas de surprise. Ou du moins réduit le nombre de surprises reçues au minimum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également besoin d'un environnement minimal dans le projet de test, afin de ne pas perdre de temps à créer des fenêtres d'interface utilisateur, à configurer des bibliothèques, à annuler l'appel à ouvrir l'application dans la bibliothèque qui traite des autorisations, etc. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CocoaPods app_spec</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toute mon histoire d'aujourd'hui sera construite autour de la fonctionnalité CocoaPods appelée app_spec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pk/eb/xf/pkebxfc7kvhzsszibluqrljlkai.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
App_spec est comme une sous-espèce régulière, seulement elle ne génère pas un framework qui peut être connecté, mais une application qui peut être lancée sur l'appareil. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ds/kj/67/dskj67urgk0wocvvue0rsaexelq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et prêt à l'emploi, CocoaPods nous permet de placer Info.plist et xcconfig dans app_spec. Cela nous permet déjà de bien monter notre projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais si nous allons écrire d'énormes dictionnaires dans chaque pods_spec, avec des valeurs pour Info.plist et xcconfig, alors nous développerons podspec nous-mêmes et il ne sera pas pratique de les modifier. Si nous devons changer quelque chose, nous devons aller dans chaque fichier podspec et éditer quelque chose avec des stylos. Ou pas des stylos. Dans tous les cas, cela n'est pas pratique.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/go/mf/t6gomf0wb3koti2mtcxnlsm36e8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour nous en débarrasser, nous avons créé un plugin local très simple pour CocoaPods. Il tient même entièrement dans une diapositive. Et il fait la seule et unique chose: nous donne la permission DSL CocoaPods, qui crée app_spec avec des valeurs déjà bouchées dans Info.plist et xcconfig. Cela nous permet déjà de configurer la signature, de configurer les choses importantes que nous voulons voir configurées dans notre projet de test. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/7h/7w/kk7h7w7bl013cgrbwntjge0jjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Question: comment transférer le chemin d'accès aux droits d'accès, plus précisément, où stocker les droits d'accès afin que nous puissions coder en dur le chemin d'accès dans les plug-ins. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a deux façons. Ou indiquez le chemin d'un fichier qui se trouve simplement dans notre référentiel, par exemple, vers les droits du projet principal. Ou stockez dans le plugin un fichier de droits spéciaux pour les projets de test. Et en utilisant le même plugin, copiez-le sur notre developmentpod.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/37/xo/jr/37xojrk1orzo5d_2nj1eu1tconi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons choisi la première voie, et ici nous avons eu quelques difficultés. Le fait est que dans notre référentiel, les modules de développement se trouvent dans différents sous-dossiers. Par conséquent, nous ne pouvons pas leur indiquer un chemin d'accès relatif depuis le développementpod vers le fichier de droits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important de souligner ici que vous devez spécifier un chemin relatif, car ce chemin reste dans pods_spec. Cela signifie qu'il participera au calcul du montant du chèque, qui est stocké dans Podfile.lock. Et s'il existe un chemin absolu, cela affectera le montant du chèque. Cela signifie que le montant du chèque variera en fonction du dossier à partir duquel $ pod installer, d'où vous avez le référentiel, sur quelle machine vous exécutez $ pod install. En général, cela conduit à des conflits.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/ek/ng/loekngcf64nbbzuaaadwy3qmhl4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je vais montrer une autre petite extension du même plugin, qui nous permet de calculer le chemin relatif vers ces droits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connaissons le chemin relatif de notre plugin vers le fichier avec des droits, s'ils sont dans le même référentiel. </font><font style="vertical-align: inherit;">Et aussi lors du lancement de $ pod install, nous connaissons le chemin vers notre developmentpod. </font><font style="vertical-align: inherit;">Toute la magie qui se trouve dans ce code est une ligne en surbrillance où nous comptons simplement le chemin relatif, connaissant ces deux chemins absolus. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ya/yg/1l/yayg1ll82qeeq2xg28xnfrm4i2g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, qu'avons-nous obtenu lorsque nous avions déjà configuré app_spec de cette manière? </font><font style="vertical-align: inherit;">Nous pouvons exécuter notre projet de test sur les mêmes appareils immédiatement. </font><font style="vertical-align: inherit;">Nous avons obtenu une énorme quantité de paramètres, y compris les droits, dont nous avons besoin.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environnement</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine chose dont je veux parler est l'environnement, l'environnement minimum nécessaire dont nous avons besoin pour commencer à écrire du code tout de suite. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ui/f-/t2/uif-t2fox7l9twbo2isjpzcx_py.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, nous avons besoin de MapKit, déjà configuré, avec les clés transférées, avec renvoi d'appel dans le AccountManager. Ceci est notre bibliothèque d'autorisation. Elle doit également lancer des appels système, elle doit également transférer des clés, notamment pour passer l'ouverture de l'application par référence. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons également besoin d'un écran de démarrage avec une carte et une pile de navigation, afin de pouvoir utiliser la même pile de navigation que dans Maps, et il est plus facile de transférer des fonctionnalités du projet de test vers le projet principal. Et le point d'entrée pour que nous, sans réfléchir, puissions immédiatement commencer à écrire du code utile.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/l0/c_/jql0c_lfm6weosqqsvivxclmqro.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans votre cas, cela pourrait être, par exemple, la configuration du SDK Facebook, auquel vous devez également transférer des clés; vos bibliothèques pour la connexion, dont vous aurez presque certainement besoin pour sauter le lien d'ouverture de l'application. Une sorte de contrôleur de démarrage Windows de démarrage et le même point d'entrée pour exécuter le script principal que vous souhaitez développer dans votre projet de test. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7u/6v/7o/7u6v7oxzg3dipiw2ztkcsub5ou8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment avons-nous fait cela? En créant un seul modèle AppDelegate. Là, nous initialisons tous les environnements nécessaires, les bibliothèques. Nous renvoyons tous les appels nécessaires, transférons les clés nécessaires. En créant un projet de test, il nous reste à créer un nouveau AppDelegate pour le projet de test et à hériter du modèle.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, nous remplaçons la seule et unique méthode appelée après que le modèle AppDelegate a fait tout ce qui était nécessaire. </font><font style="vertical-align: inherit;">Et là, nous avons déjà le ViewController de départ et en plus nous pouvons exécuter notre script, que nous voulons déboguer dans le projet de test.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Était / est devenu</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment puis-je créer un projet de test dans le front et comment le créer en utilisant la méthode que j'ai décrite aujourd'hui? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Création d'un projet de test dans le front: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Nous allons dans Xcode, créons un nouveau projet (Fichier&gt; Nouveau projet). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Saisissez le nom, de préférence sans erreur, signez le Bundle ID. Nous mettons en place ce projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Changez la version de Swift, changez la version cible. Nous essayons de tout exécuter sur l'appareil, de modifier la signature, etc. C'est un processus plutôt morne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Ensuite, nous créons un podfile, y connectons les dépendances, installons des pods. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Après cela, nous allons commencer à configurer très fastidieusement et doucement notre AppDelegate, en transférant à travers les morceaux d'initialisation des bibliothèques dont nous avons besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Créez un UIWindows de démarrage avec notre ViewController</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et seulement après cela, nous pouvons démarrer le code utile. </font><font style="vertical-align: inherit;">Procédure assez désagréable, d'accord. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comment pouvons-nous créer un projet de test en utilisant les meilleures pratiques que j'ai décrites dans le rapport d'aujourd'hui? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Nous créons sample_app_spec, en utilisant l'extension, pour CocoaPods, avec lequel nous avons commencé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Créez un AppDelegate et héritez-le du modèle AppDelegate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, nous pouvons commencer à écrire du code utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création d'un projet de test de cette manière est beaucoup plus rapide et plus fiable. </font><font style="vertical-align: inherit;">Nous ne ferons certainement pas d'erreur dans la signature des paramètres, nous ne ferons certainement pas d'erreur dans les paramètres du projet. </font><font style="vertical-align: inherit;">Tout l'environnement nécessaire au démarrage des travaux nous approche immédiatement.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela peut-il être plus simple?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez poser une question - cela peut-il être plus facile? Bien sûr. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9e/t_/ux/9et_uxcpepiyc5iavhfehkqen-q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai identifié trois niveaux de difficulté. Le premier est ce dont j'ai parlé aujourd'hui, tout à coup, lorsque nous créons un plug-in pour CocoaPods, qui peut réparer les chemins d'accès aux droits, et un modèle AppDelegate. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxième méthode est idéale dans le rapport des efforts au profit. Il ne contient que le plugin pour CocoaPods, qui était le premier dans l'histoire d'aujourd'hui. Autrement dit, il remplace simplement les valeurs dans Info.plist et xcconfig. Cela rend déjà la vie beaucoup plus facile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous n'avez pas besoin de votre fichier de droits dans vos applications de test, si vos applications de test sont assez différentes les unes des autres et n'ont pas besoin de composants communs, cette méthode vous convient parfaitement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La troisième méthode est la plus simple, ne nécessite aucune préparation. </font><font style="vertical-align: inherit;">Commencez simplement à utiliser app_spec. </font><font style="vertical-align: inherit;">Le projet généré à partir de app_spec est créé dans le même espace de travail que votre projet principal. </font><font style="vertical-align: inherit;">Par conséquent, il hérite déjà de la version Swift, de la version cible et de tous les paramètres que vous avez dans Workspace. </font><font style="vertical-align: inherit;">Il vous sera beaucoup plus facile de commencer à travailler avec lui. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci pour l'attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr503642/index.html">Comment accéder à LinkedIn, Facebook, Google dans la Silicon Valley</a></li>
<li><a href="../fr503650/index.html">VKCup 2020 Stage I. Un long chemin</a></li>
<li><a href="../fr503652/index.html">Événements numériques à Moscou du 25 au 31 mai</a></li>
<li><a href="../fr503654/index.html">Service Web qui permet aux utilisateurs de maintenir indépendamment une culture de communication en ligne</a></li>
<li><a href="../fr503656/index.html">L'algorithme de suppression de bande dans l'image comme outil pour améliorer la qualité de la reconstruction tomographique</a></li>
<li><a href="../fr503662/index.html">NOUVEAU - Téléphone VoIP Snom D335</a></li>
<li><a href="../fr503666/index.html">Traduction de cours de démarrage et d'affaires de l'Université de Stanford. Conférence numéro 1. Comment démarrer une startup</a></li>
<li><a href="../fr503668/index.html">Circle Squared: Visual Evidence</a></li>
<li><a href="../fr503670/index.html">Mac OS ralentit-il? - Catalina vérifie tout code non signé sur Internet au démarrage</a></li>
<li><a href="../fr503672/index.html">De quel côté êtes-vous: pousser et tirer dans la configuration de l'état souhaité</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>