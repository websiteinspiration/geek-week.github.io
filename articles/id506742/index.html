<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇🏾 ▪️ 🥝 Mengapa pusat piksel harus di (0,5; 0,5) 🆑 🚒 🧝🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini, ketika penelusuran sinar yang dilakukan dari "mata" kamera menjadi lebih populer, pelajaran ini perlu dipelajari lagi: kode menjadi lebih ba...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Mengapa pusat piksel harus di (0,5; 0,5)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/506742/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hari ini, ketika penelusuran sinar yang dilakukan dari "mata" kamera menjadi lebih populer, pelajaran ini perlu dipelajari lagi: kode menjadi lebih baik dan hidup lebih mudah jika pusat piksel berada pada koordinat (0,5; 0,5). Jika Anda yakin bahwa Anda melakukan segalanya dengan benar, maka lanjutkan dengan nada yang sama, bagi Anda, artikel itu bukanlah hal yang baru. Baca yang lebih baik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perasaan menempatkan pusat piksel pada (0,5; 0,5) pertama kali dijelaskan (setidaknya bagi saya) oleh artikel pendek lucu Paul Huckbert "Apa itu koordinat piksel?" dari buku 1990 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphics Gems</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hlm. 246-248.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hari ini, artikel ini sulit ditemukan, jadi saya akan secara singkat menguraikan esensinya. Misalkan kita memiliki layar dengan lebar dan tinggi 1000. Mari kita hanya mempertimbangkan sumbu X. Mungkin tergoda untuk menetapkan 0,0 ke tengah piksel paling kiri berturut-turut, 1,0 ke tengah berikutnya, dan seterusnya. Anda bahkan dapat menggunakan pembulatan, di mana koordinat floating point dari 73,6 dan 74,4 ditransfer ke pusat 74,0. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, perlu dipertimbangkan. Dengan perbandingan ini, tepi kiri akan berada di koordinat -0,5, dan tepi kanan di 999,5. Tidak nyaman untuk bekerja dengan sistem seperti itu. Lebih buruk lagi, jika operator yang berbeda menyukai </font></font><code>abs()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font><font style="vertical-align: inherit;">diterapkan pada nilai-nilai koordinat piksel </font></font><code>mod()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka perbandingan semacam itu dapat menyebabkan kesalahan yang tidak signifikan di tepinya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih mudah untuk bekerja dengan interval 0,0 hingga 1000,0, di mana pusat setiap piksel memiliki bagian fraksional 0,5. Sebagai contoh, maka integer pixel 43 akan memiliki kisaran nilai nilai subpiksel yang indah dari 43.0 hingga 43.99999. Ini gambar dari artikel Paulus:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fcf/16a/79e/fcf16a79ea636a04f37b2259a034a954.png"></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pusat piksel selalu memiliki bagian fraksional (0,5; 0,5). Pada awalnya, DirectX tidak mematuhi ini, tetapi dalam DirectX 10, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">butuh pikiran</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Operasi untuk mengkonversi dari koordinat bilangan bulat ke koordinat piksel titik apung adalah dengan menambahkan 0,5; untuk mengkonversi float ke integer sudah cukup untuk digunakan </font></font><code>floor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi ini cerita panjang. Lagipula, semua orang melakukannya hari ini, kan? Saya kembali ke topik ini karena dalam contoh saya, saya menemukan kode (semu) untuk menghasilkan arah kamera perspektif untuk penelusuran sinar:</font></font><br>
<br>
<pre><code class="cpp hljs"> float3 ray_origin = camera-&gt;eye;<font></font>
 float2 d = <span class="hljs-number">2.0</span> * <font></font>
     ( float2(idx.x, idx.y) / <font></font>
       float2(width, height) ) - <span class="hljs-number">1.0</span>;<font></font>
 float3 ray_direction =<font></font>
     d.x*camera-&gt;U + d.y*camera-&gt;V + camera-&gt;W;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vektor </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">idx</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah lokasi bilangan bulat dari piksel, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lebar</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tinggi</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah resolusi layar. Vektor </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dihitung dan digunakan untuk menghasilkan vektor ke ruang angkasa dunia menggunakan perkalian dua vektor, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian vektor </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ditambahkan </font><font style="vertical-align: inherit;">- arah kamera di ruang dunia. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menunjukkan arah positif sumbu </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada bidang tampilan pada jarak </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari mata. Dalam kode di atas, semuanya terlihat cantik dan simetris; jadi untuk sebagian besar.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8d/cb1/563/d8dcb1563f2b9b2c440d51ca0e0aa5fe.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vektor </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus menunjukkan sepasang nilai dari -1.0 hingga 1.0 dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">koordinat perangkat yang dinormalisasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Normalized Device Coordinates, NDC) untuk titik-titik di layar. Namun, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode gagal di sini</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mari kita lanjutkan contoh kita: lokasi piksel integer (0; 0) ditransfer ke (-1.0; -1.0). Tampaknya bagus, bukan? Tetapi lokasi pixel integer maksimum adalah (999; 999), yang diterjemahkan menjadi (0,998; 0,998). Perbedaan total 0,002 adalah karena fakta bahwa overlay yang salah ini menggeser keseluruhan gambar hingga setengah piksel. Pusat piksel ini harus 0,001 dari masing-masing tepi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris kode kedua akan terlihat seperti ini:</font></font><br>
<br>
<pre><code class="cpp hljs">    float2 d = <span class="hljs-number">2.0</span> *<font></font>
        ( ( float2(idx.x, idx.y) + float2(<span class="hljs-number">0.5</span>,<span class="hljs-number">0.5</span>) ) / <font></font>
            float2(width, height) ) - <span class="hljs-number">1.0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kita mendapatkan interval NDC yang benar untuk pusat piksel, dari -0,999 hingga 0,999. Jika kita alih-alih mengonversi nilai sudut dengan titik mengambang (0,0; 0,0) dan (1000,0; 1000,0) dengan cara ini (kami tidak menambahkan 0,5, karena kami sudah bekerja dengan titik mengambang), kemudian kita mendapatkan interval NDC penuh, dari -1.0 ke 1.0, dari ujung ke ujung; ini membuktikan kebenaran kode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika 0,5 mengganggu Anda dan Anda kurang simetri, maka untuk menghasilkan nilai acak di dalam piksel, mis. saat Anda melakukan perataan dengan memancarkan sinar acak melalui setiap piksel, Anda dapat menggunakan formulasi elegan ini:</font></font><br>
<br>
<pre><code class="cpp hljs">    float2 d = <span class="hljs-number">2.0</span> *<font></font>
        ( ( float2(idx.x, idx.y) + <font></font>
                float2( rand(seed), rand(seed) ) ) /<font></font>
            float2(width, height) ) - <span class="hljs-number">1.0</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami cukup menambahkan angka acak dari interval [0,0,1.0) ke setiap nilai integer dari lokasi piksel. </font><font style="vertical-align: inherit;">Nilai rata-rata acak ini adalah 0,5, yaitu pusat piksel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi saya akan katakan secara singkat: hati-hati. </font><font style="vertical-align: inherit;">Terapkan setengah piksel dengan benar. </font><font style="vertical-align: inherit;">Dalam pengalaman saya, kesalahan setengah piksel itu muncul di banyak tempat berbeda (kamera, pengambilan sampel tekstur, dll.) Selama bertahun-tahun pekerjaan saya pada kode rasterizer di Autodesk. </font><font style="vertical-align: inherit;">Lebih jauh ke bawah jalur perakitan mereka tidak membawa apa-apa selain rasa sakit. </font><font style="vertical-align: inherit;">Jika kita tidak hati-hati, mereka juga dapat muncul dalam pelacak sinar.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id506730/index.html">Mendengus atau Suricata. Bagian 1: pilih IDS / IPS gratis untuk melindungi jaringan perusahaan</a></li>
<li><a href="../id506732/index.html">Penggunaan kembali komponen UI di seluruh organisasi</a></li>
<li><a href="../id506734/index.html">Perhitungan sementara dalam jaringan listrik</a></li>
<li><a href="../id506736/index.html">Berapa banyak metode yang harus di kelas?</a></li>
<li><a href="../id506740/index.html">Cara menggunakan Microsoft SQL untuk laporan di Power BI. Pada contoh Mindbox</a></li>
<li><a href="../id506748/index.html">Siapa yang memiliki penjualan karantina yang tumbuh?</a></li>
<li><a href="../id506758/index.html">Produk menyelenggarakan konferensi dengan prinsip open-source, dan selama 10 tahun setiap peserta adalah penyelenggara</a></li>
<li><a href="../id506762/index.html">Security Week 25: Kumpulan pemecahan rekor Microsoft</a></li>
<li><a href="../id506766/index.html">Kami menolak dari platform RPA berbayar dan didasarkan pada OpenSource (OpenRPA)</a></li>
<li><a href="../id506772/index.html">Untuk membuat atau menolak - ujian ide untuk kekuatan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>