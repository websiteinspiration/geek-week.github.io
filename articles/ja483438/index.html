<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👸 👭 🎵 大須に！遊び、間違いを忘れないで 👨🏻‍🔧 👩🏾‍🚒 💮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="エキゾチックなものを愛するすべての人を歓迎します。コードの誤りはあまりありません。今日のテストベンチでは、PVS-Studioはまれなゲストです-C＃のゲーム。つまり、おす！いつものように：間違いを探し、考え、遊びます。
 
 ゲーム
 大須！ -オープンソースの音楽リズムゲーム。ゲームのウェブサイ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>大須に！遊び、間違いを忘れないで</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/483438/"><p><img src="https://habrastorage.org/getpro/habr/post_images/3ac/9da/a12/3ac9daa12b519fc14e45f7f65abdd204.png" alt="写真1" align="left"></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エキゾチックなものを愛するすべての人を歓迎します。コードの誤りはあまりありません。</font><font style="vertical-align: inherit;">今日のテストベンチでは、PVS-Studioはまれなゲストです-C＃のゲーム。</font><font style="vertical-align: inherit;">つまり、おす！</font><font style="vertical-align: inherit;">いつものように：間違いを探し、考え、遊びます。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲーム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大須！ -オープンソースの音楽リズムゲーム。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームのウェブサイトの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">情報から判断すると、</font><font style="vertical-align: inherit;">1500万人以上の登録プレーヤーが主張されているため、非常に人気があります。このプロジェクトの特徴は、無料のゲームプレイ、カードをカスタマイズできるカラフルなデザイン、プレーヤーのオンラインランキングを編集するための高度な機能、マルチプレーヤーの存在、多数の楽曲です。ゲームについては詳しく説明しませんが、興味のある方はネットワーク上のすべての情報を簡単に見つけることができます。たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">GitHub</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
からダウンロードできるプロジェクトのソースコードにもっと興味があり</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。リポジトリへのかなりの数のコミット（24,000を超える）がすぐに注目されます。これは、プロジェクトが活発に開発されており、現在も続いていることを示しています（ゲームは2007年にリリースされましたが、おそらく作業はもっと早く始まりました）。ただし、ソースコードはそれほど多くありません。1813の.csファイルには、空のコードを除いて、135千行のコードが含まれています。このコードには、チェックで通常考慮しないテストが含まれています。テストコードは306個の.csファイルに含まれているため、空のコードを除いて25千行のコードが含まれています。これは小さなプロジェクトです。比較のために、PVS-StudioアナライザーのC＃コアには約30万行のコードが含まれています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全体として、ゲームのエラーをチェックするために、1507のソースコードファイルと11万行を含む非テストプロジェクトを使用しました。</font><font style="vertical-align: inherit;">ただし、いくつかの興味深いエラーがありましたので、その結果は私に一部満足しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">間違い</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '||'の左側と右側に同じサブ式 'result == HitResult.Perfect'があります </font><font style="vertical-align: inherit;">オペレーター。</font><font style="vertical-align: inherit;">DrawableHoldNote.cs 266</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckForResult</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  ApplyResult(r =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (holdNote.hasBroken<font></font>
      &amp;&amp; (result == HitResult.Perfect || result == HitResult.Perfect))<font></font>
      result = HitResult.Good;<font></font>
    ....<font></font>
  });<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コピー/ペースト指向プログラミングの良い例です。</font><font style="vertical-align: inherit;">私の同僚であるValery Komarovが彼の記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年のJavaプロジェクトにおけるエラーのトップ10</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」で最近使用（紹介）したコミック用語</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、2つの同一のチェックが次々に続きます。</font><font style="vertical-align: inherit;">チェックの1つには、おそらく別の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HitResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列挙</font><i><font style="vertical-align: inherit;">定数</font></i><font style="vertical-align: inherit;">が含まれているはず</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> HitResult<font></font>
{<font></font>
    None,<font></font>
    Miss,<font></font>
    Meh,<font></font>
    Ok,<font></font>
    Good,<font></font>
    Great,<font></font>
    Perfect,<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どの定数を使用する必要がありましたか、または2番目のチェックはまったく必要ありませんか？</font><font style="vertical-align: inherit;">開発者のみが回答できる質問。</font><font style="vertical-align: inherit;">いずれにしても、プログラムのロジックを歪めるエラーが発生しています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「&amp;&amp;」演算子の左側と右側に同一のサブ式「family！= GetFamilyString（TournamentTypeface.Aquatico）」があります。</font><font style="vertical-align: inherit;">TournamentFont.cs 64</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetWeightString</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> family, FontWeight weight</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (weight == FontWeight.Regular<font></font>
    &amp;&amp; family != GetFamilyString(TournamentTypeface.Aquatico)<font></font>
    &amp;&amp; family != GetFamilyString(TournamentTypeface.Aquatico))<font></font>
    weightString = <span class="hljs-keyword">string</span>.Empty;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして再びコピーして貼り付けます。</font><font style="vertical-align: inherit;">コードをフォーマットしたので、エラーはすぐにわかります。</font><font style="vertical-align: inherit;">元のバージョンでは、条件全体が1行で記述されていました。</font><font style="vertical-align: inherit;">また、コードをどのように修正できるかを言うのも難しいです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TournamentTypeface</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列挙に</font><font style="vertical-align: inherit;">は、1つの定数が含まれます。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> TournamentTypeface<font></font>
{<font></font>
  Aquatico<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
条件が誤って</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファミリー</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数を2回使用した可能性があります</font><font style="vertical-align: inherit;">が、これは正確ではありません。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-393]このメソッドが常に1つの同じ値「false」を返すのは奇妙です。</font><font style="vertical-align: inherit;">KeyCounterAction.cs 19</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">OnPressed</span>(<span class="hljs-params">T action, <span class="hljs-keyword">bool</span> forwards</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (!EqualityComparer&lt;T&gt;.Default.Equals(action, Action))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  IsLit = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (forwards)<font></font>
    Increment();<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドは常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このようなエラーについては、通常、呼び出しコードをチェックします。呼び出しコードはどこでも戻り値を使用しないことが多いため、エラーは発生しません（醜いプログラミングスタイルを除く）。</font><font style="vertical-align: inherit;">この場合、次のコードに遭遇しました。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">OnPressed</span>(<span class="hljs-params">T action</span>)</span> =&gt;<font></font>
  Target.Children<font></font>
    .OfType&lt;KeyCounterAction&lt;T&gt;&gt;()<font></font>
    .Any(c =&gt; c.OnPressed(action, Clock.Rate &gt;= <span class="hljs-number">0</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnPressed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドによって返された結果</font><font style="vertical-align: inherit;">が使用されます。</font><font style="vertical-align: inherit;">また、常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であるため、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnPressed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">呼び出した結果</font><font style="vertical-align: inherit;">も常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">エラーの可能性が高いので、このコードを再確認する必要があると思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の同様のエラー：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009 [CWE-393]このメソッドが常に1つの同じ値「false」を返すのは奇妙です。</font><font style="vertical-align: inherit;">KeyCounterAction.cs 30</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3042</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-476]考えられるNullReferenceException。</font><font style="vertical-align: inherit;">「？」</font><font style="vertical-align: inherit;">と '。' </font><font style="vertical-align: inherit;">演算子は、「val.NewValue」オブジェクトのメンバーにアクセスするために使用されますTournamentTeam.cs 41</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TournamentTeam</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  Acronym.ValueChanged += val =&gt;<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (....)<font></font>
      FlagName.Value = val.NewValue.Length &gt;= <span class="hljs-number">2</span>    <span class="hljs-comment">// &lt;=</span>
        ? val.NewValue?.Substring(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>).ToUpper()<font></font>
        : <span class="hljs-keyword">string</span>.Empty;<font></font>
  };<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
演算子の条件では、</font><font style="vertical-align: inherit;">変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">val.NewValue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は安全ではありません。</font><font style="vertical-align: inherit;">アナライザはそのような結論を出しました。それ以来、then-branchでは、安全なオプションを使用して、条件付きアクセス</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステートメントval.NewValue？.Substring（....）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を通じて変数にアクセスしています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の同様のエラー：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3042 [CWE-476]考えられるNullReferenceException。</font><font style="vertical-align: inherit;">「？」</font><font style="vertical-align: inherit;">と '。' </font><font style="vertical-align: inherit;">演算子は、「val.NewValue」オブジェクトのメンバーにアクセスするために使用されますTournamentTeam.cs 48</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3042</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-476]考えられるNullReferenceException。</font><font style="vertical-align: inherit;">「？」</font><font style="vertical-align: inherit;">と '。' </font><font style="vertical-align: inherit;">演算子は、「api」オブジェクトのメンバーにアクセスするために使用されます。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reload</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">new</span> ActionableInfo<font></font>
  {<font></font>
    Label = <span class="hljs-string">"Current User"</span>,<font></font>
    ButtonText = <span class="hljs-string">"Change Login"</span>,<font></font>
    Action = () =&gt;<font></font>
    {<font></font>
      api.Logout();    <span class="hljs-comment">// &lt;=</span><font></font>
      ....<font></font>
    },<font></font>
    Value = api?.LocalUser.Value.Username,<font></font>
    ....<font></font>
  },<font></font>
  ....<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ActionableInfo</span> : <span class="hljs-title">LabelledDrawable</span>&lt;Drawable&gt;<font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">public</span> Action Action;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードは不明確ですが、エラーはまだ残っていると思います。タイプ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ActionableInfoの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトを作成します</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Action</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドは</font><font style="vertical-align: inherit;">、ラムダで初期化されます。その本体では、nullの可能性がある参照</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を操作することは安全ではありません</font><font style="vertical-align: inherit;">。アナライザーはこのようなパターンをエラーと見なしたため、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Value</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーターを初期化すると、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">api</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">は安全に機能します。ラムダコードは実行の遅延を想定しているため、エラーを曖昧に呼び出しました。おそらく、開発者は何らかの理由で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクのゼロ以外の値を保証してい</font><font style="vertical-align: inherit;">ます。しかし、ラムダ本体にはリンクでの安全な作業の兆候が含まれていないので、これは単なる仮定です（たとえば、予備チェックなど）。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[CWE-683]「Atan2」メソッドに渡される引数の順序が誤っている可能性があります：「diff.X」および「diff.Y」。</font><font style="vertical-align: inherit;">SliderBall.cs 182</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateProgress</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> completionProgress</span>)</span><font></font>
{<font></font>
  ....<font></font>
  Rotation = <span class="hljs-number">-90</span> + (<span class="hljs-keyword">float</span>)(-Math.Atan2(diff.X, diff.Y) * <span class="hljs-number">180</span> / Math.PI);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザ</font><font style="vertical-align: inherit;">は、</font><i><font style="vertical-align: inherit;">Math</font></i><font style="vertical-align: inherit;">クラスの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atan2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">を使用する場合、</font><font style="vertical-align: inherit;">開発者が引数の順序を混同して</font><font style="vertical-align: inherit;">いると疑っていました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">広告</font><i><font style="vertical-align: inherit;">ATAN2</font></i><font style="vertical-align: inherit;">：</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-comment">// Parameters:</span>
<span class="hljs-comment">//   y:</span>
<span class="hljs-comment">//     The y coordinate of a point.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//   x:</span>
<span class="hljs-comment">//     The x coordinate of a point.</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">double</span> <span class="hljs-title">Atan2</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> y, <span class="hljs-keyword">double</span> x</span>)</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、値は逆の順序で転送されました。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateProgress</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドに</font><font style="vertical-align: inherit;">はかなりの重要な計算が含まれている</font><font style="vertical-align: inherit;">ため、これが間違いかどうかを判断できません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">コードで起こりうる問題の事実に注意します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-476]可能なnull逆参照。</font><font style="vertical-align: inherit;">「ビートマップ」を調べることを検討してください。</font><font style="vertical-align: inherit;">WorkingBeatmap.cs 57</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> Track <span class="hljs-title">GetVirtualTrack</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> lastObject = Beatmap.HitObjects.LastOrDefault();<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beatmap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nullリンクを介したアクセスの危険性を指摘しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは次のとおりです。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> IBeatmap Beatmap<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    <span class="hljs-keyword">try</span><font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> LoadBeatmapAsync().Result;<font></font>
    }<font></font>
    <span class="hljs-keyword">catch</span> (TaskCanceledException)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、アナライザは正しいです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studioがこのようなエラーを検出する方法、および同様のトピックに関連するC＃8.0の革新（null参照の可能性がある場合の操作）の詳細については、記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＃8.0の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Null </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">可能な参照タイプと静的分析</font></a><font style="vertical-align: inherit;">」を</font><font style="vertical-align: inherit;">参照してください</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3083</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-367]イベント 'ObjectConverted'の安全でない呼び出し、NullReferenceExceptionが発生する可能性があります。</font><font style="vertical-align: inherit;">イベントを呼び出す前に、ローカル変数にイベントを割り当てることを検討してください。</font><font style="vertical-align: inherit;">BeatmapConverter.cs 82</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;T&gt; <span class="hljs-title">convertHitObjects</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (ObjectConverted != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
    converted = converted.ToList();<font></font>
    ObjectConverted.Invoke(obj, converted);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重大ではない、よくある間違い。</font><font style="vertical-align: inherit;">イベントの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チェック</font><font style="vertical-align: inherit;">とその呼び出しの</font><font style="vertical-align: inherit;">間に、イベントの</font><font style="vertical-align: inherit;">サブスクライブを解除できます。これにより、プログラムがクラッシュします。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修正の1つ：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;T&gt; <span class="hljs-title">convertHitObjects</span>(<span class="hljs-params">....</span>)</span><font></font>
{<font></font>
  ....<font></font>
  converted = converted.ToList();<font></font>
  ObjectConverted?.Invoke(obj, converted);<font></font>
  ....<font></font>
}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-476] 'columns'オブジェクトは、nullであることが確認される前に使用されていました。</font><font style="vertical-align: inherit;">チェック行：141、142。SquareGraph.cs 141</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">redrawProgress</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ColumnCount; i++)<font></font>
    columns[i].State = i &lt;= progress ? ColumnState.Lit : ColumnState.Dimmed;<font></font>
  columns?.ForceRedraw();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ループで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コレクション</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">バイパスすること</font><font style="vertical-align: inherit;">は安全ではありません。</font><font style="vertical-align: inherit;">同時に、</font><font style="vertical-align: inherit;">コードの後半で条件付きアクセス演算子を使用してコレクションにアクセスするため</font><font style="vertical-align: inherit;">、開発者は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンク</font><font style="vertical-align: inherit;">がnullである可能性があると</font><font style="vertical-align: inherit;">想定しました</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3119</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オーバーライドされたイベント 'OnNewResult'を呼び出すと、予期しない動作が発生する可能性があります。</font><font style="vertical-align: inherit;">イベントアクセサーを明示的に実装するか、「sealed」キーワードを使用することを検討してください。</font><font style="vertical-align: inherit;">DrawableRuleset.cs 256</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addHitObject</span>(<span class="hljs-params">TObject hitObject</span>)</span><font></font>
{<font></font>
  ....<font></font>
  drawableObject.OnNewResult += (_, r) =&gt; OnNewResult?.Invoke(r);<font></font>
  ....<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">event</span> Action&lt;JudgementResult&gt; OnNewResult;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、オーバーライドされたイベントまたは仮想イベントを使用することの危険性について警告します。</font><font style="vertical-align: inherit;">危険とは正確には何ですか- </font><font style="vertical-align: inherit;">診断の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">読むことをお勧めし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">また、このトピックに関する記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cの仮想イベント＃：問題が発生しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」をかつて書いた</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ことがあります</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コード内の別の同様の安全でない構成：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3119オーバーライドされたイベントを呼び出すと、予期しない動作が発生する可能性があります。</font><font style="vertical-align: inherit;">イベントアクセサーを明示的に実装するか、「sealed」キーワードを使用することを検討してください。</font><font style="vertical-align: inherit;">DrawableRuleset.cs 257</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3123</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-783]たぶん「??」</font><font style="vertical-align: inherit;">演算子は、予期されたものとは異なる方法で動作します。</font><font style="vertical-align: inherit;">その優先順位は、左側にある他の演算子の優先順位よりも低くなっています。</font><font style="vertical-align: inherit;">OsuScreenStack.cs 45</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onScreenChange</span>(<span class="hljs-params">IScreen prev, IScreen next</span>)</span><font></font>
{<font></font>
  parallaxContainer.ParallaxAmount =<font></font>
    ParallaxContainer.DEFAULT_PARALLAX_AMOUNT *<font></font>
      ((IOsuScreen)next)?.BackgroundParallaxAmount ?? <span class="hljs-number">1.0f</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題をよりよく理解するために、コードがどのように機能しているかの総合的な例を示します。</font></font><br>
<br>
<pre><code class="cs hljs">x = (c * a) ?? b;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
*演算子は??演算子よりも優先度が高いため、エラーが発生しました。</font><font style="vertical-align: inherit;">コードの修正バージョン（括弧が追加されました）：</font></font><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onScreenChange</span>(<span class="hljs-params">IScreen prev, IScreen next</span>)</span><font></font>
{<font></font>
  parallaxContainer.ParallaxAmount =<font></font>
    ParallaxContainer.DEFAULT_PARALLAX_AMOUNT *<font></font>
      (((IOsuScreen)next)?.BackgroundParallaxAmount ?? <span class="hljs-number">1.0f</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードの別の同様のエラー：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3123</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-783]おそらく「??」</font><font style="vertical-align: inherit;">演算子は、予期されたものとは異なる方法で動作します。</font><font style="vertical-align: inherit;">その優先順位は、左側にある他の演算子の優先順位よりも低くなっています。</font><font style="vertical-align: inherit;">FramedReplayInputHandler.cs 103</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> inImportantSection<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">return</span> IsImportant(frame) &amp;&amp;<font></font>
      Math.Abs(CurrentTime - NextFrame?.Time ?? <span class="hljs-number">0</span>) &lt;= <font></font>
        AllowedImportantTimeSpan;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、前のコードフラグメントと同様に、演算子の優先度は考慮されていません。</font><font style="vertical-align: inherit;">これで、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Math.Abs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドに渡される式は</font><font style="vertical-align: inherit;">次のように評価されます。</font></font><br>
<br>
<pre><code class="cs hljs">(a – b) ?? <span class="hljs-number">0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修正されたコード：</font></font><br>
<pre><code class="cs hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">bool</span> inImportantSection<font></font>
{<font></font>
  <span class="hljs-keyword">get</span><font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">return</span> IsImportant(frame) &amp;&amp;<font></font>
      Math.Abs(CurrentTime – (NextFrame?.Time ?? <span class="hljs-number">0</span>)) &lt;= <font></font>
        AllowedImportantTimeSpan;<font></font>
  }<font></font>
}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3142</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-561]到達不能コードが検出されました。</font><font style="vertical-align: inherit;">エラーが発生している可能性があります。</font><font style="vertical-align: inherit;">DrawableHoldNote.cs 214</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">OnPressed</span>(<span class="hljs-params">ManiaAction action</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">base</span>.OnPressed(action))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (Result.Type == HitResult.Miss)  <span class="hljs-comment">// &lt;=</span>
    holdNote.hasBroken = <span class="hljs-literal">true</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは</font><font style="vertical-align: inherit;">、2番目の</font><i><font style="vertical-align: inherit;">ifステートメント</font></i><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">始まる</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OnPressed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハンドラー</font><i><font style="vertical-align: inherit;">コード</font></i><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">到達できない</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">主張してい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これは、最初の条件が常にtrueであるという前提に基づいています。つまり、</font><i><font style="vertical-align: inherit;">base.OnPressed</font></i><font style="vertical-align: inherit;">メソッド</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">常に</font><i><font style="vertical-align: inherit;">falseを</font></i><font style="vertical-align: inherit;">返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><i><font style="vertical-align: inherit;">base.OnPressed</font></i><font style="vertical-align: inherit;">メソッドを見てください</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">OnPressed</span>(<span class="hljs-params">ManiaAction action</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (action != Action.Value)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
  <font></font>
  <span class="hljs-keyword">return</span> UpdateResult(<span class="hljs-literal">true</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッドに進みます</font><font style="vertical-align: inherit;">。</font></font><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">UpdateResult</span>(<span class="hljs-params"><span class="hljs-keyword">bool</span> userTriggered</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (Time.Elapsed &lt; <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (Judged)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
  ....<font></font>
<font></font>
  <span class="hljs-keyword">return</span> Judged;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Judged</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティの実装は</font><font style="vertical-align: inherit;">重要ではありません</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。UpdateResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドのロジックは</font><font style="vertical-align: inherit;">、最後の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">returnステートメントが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これ</font><i><font style="vertical-align: inherit;">と</font></i><font style="vertical-align: inherit;">同等であることを示しているためです。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。これにより、スタック上のコードに到達できないコードがあるというエラーが発生します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3146</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [CWE-476]「ルールセット」のnull逆参照の可能性。</font><font style="vertical-align: inherit;">「FirstOrDefault」はデフォルトのnull値を返すことができます。</font><font style="vertical-align: inherit;">APILegacyScoreInfo.cs 24</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> ScoreInfo <span class="hljs-title">CreateScoreInfo</span>(<span class="hljs-params">RulesetStore rulesets</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> ruleset = rulesets.GetRuleset(OnlineRulesetID);<font></font>
<font></font>
  <span class="hljs-keyword">var</span> mods = Mods != <span class="hljs-literal">null</span> ? ruleset.CreateInstance()          <span class="hljs-comment">// &lt;=</span><font></font>
                                   .GetAllMods().Where(....)<font></font>
                                   .ToArray() : Array.Empty&lt;Mod&gt;();<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ruleset.CreateInstance（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出しをunsafeと見なし</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルールセット</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">は、以前は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetRuleset</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を呼び出した結果として値を取得してい</font><i><font style="vertical-align: inherit;">ました</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> RulesetInfo <span class="hljs-title">GetRuleset</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> id</span>)</span> =&gt;<font></font>
  AvailableRulesets.FirstOrDefault(....);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のとおり、呼び出しチェーンには</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FirstOrDefault</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が含まれているため、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返す可能</font><font style="vertical-align: inherit;">性があるため、アナライザーの警告は正当化され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的に、ゲーム「おす！」のプロジェクト少数のエラーに満足しています。それでも、検出された問題に注意を払うことを開発者に勧めます。そして、ゲームがそのファンを喜ばせ続けるようにしましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードをさらに詳しく知りたい場合は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ダウンロード</font></a><font style="vertical-align: inherit;">が簡単なPVS-Studioアナライザーが役立ちます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公式サイトより。</font><font style="vertical-align: inherit;">また、上記のような1回限りのプロジェクトチェックは、実際の作業での静的アナライザーの使用とは関係がないことにも注意してください。</font><font style="vertical-align: inherit;">エラーとの戦いにおける最大の効率は、ビルドサーバーと開発者のコ​​ンピューター（増分分析）の両方でツールを定期的に使用する場合にのみ達成できます。</font><font style="vertical-align: inherit;">この場合、最大のタスクは、エラーがバージョン管理システムに入らないようにし、コードの作成段階ですでに欠陥を修正することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸運と成功！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参考文献</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは2020年の最初の出版物です。</font><font style="vertical-align: inherit;">この機会に、過去1年間のC＃プロジェクトのチェックに関する記事へのリンクを提供します。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Web Services SDK for .NETのソースコードのバグを探す</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roslynのソースコードの確認</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＃8.0のnull可能な参照型と静的分析</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinForms：エラー、ホームズ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioが... PVS-Studioで使用されているライブラリでエラーを検出した方法のストーリー</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioスタティックアナライザーによる.NET Coreライブラリのソースコードの検証</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roslynアナライザーの確認</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telerik UI for UWPをチェックして、PVS-Studioに慣れる</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure PowerShell：「基本的に無害」</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orchard CMSコードのエラーを検索して分析します</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studioを使用したOpenCVでのOpenCvSharpラッパーの確認</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure SDK for .NET：難しいバグ検索のストーリー</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SARIF SDKとそのエラー</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2019年のC＃プロジェクトの上位10のバグ</font></font></a></li>
</ul><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事を英語を話す視聴者と共有したい場合は、翻訳へのリンクを使用してください：Sergey Khrenov。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"osu！"をプレイし</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますが</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、バグに注意してください</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483416/index.html">Powershellを使用してプロセスを自動化しようとしています</a></li>
<li><a href="../ja483418/index.html">チケットシステム：3つの無料OTRSをどのように支払ったのですか？</a></li>
<li><a href="../ja483424/index.html">DBA：PostgreSQLデータベース間でのSEQUENCE値の転送</a></li>
<li><a href="../ja483426/index.html">金曜日タブ調査</a></li>
<li><a href="../ja483428/index.html">電子署名に関する法律の改正が施行された後、電子文書管理はどうなりますか？</a></li>
<li><a href="../ja483440/index.html">最新のDコンパイラ</a></li>
<li><a href="../ja483444/index.html">2019 DORAレポート：DevOpsパフォーマンスを改善する方法</a></li>
<li><a href="../ja483446/index.html">科学者たちは飲料水中の鉄分を下げる新しい方法を発見しました</a></li>
<li><a href="../ja483452/index.html">ディザリング2：ゴールデンセクション行、ブルーノイズ、ハイパスおよびリマップ</a></li>
<li><a href="../ja483454/index.html">キリル文字でファイルを保存して、Atlassian BitbucketでMercurialからGITに切り替える</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>