<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👇🏾 🦗 🧜🏾 构建和自定义CDN 🆗 🦃 🥖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="内容交付网络（CDN）用于站点和应用程序中，主要是为了加快静态元素的加载。发生这种情况是由于在位于不同地理区域的CDN服务器上缓存文件。通过CDN请求数据后，用户从最近的服务器接收数据。
 
 所有内容交付网络的操作原理和功能大致相同。收到下载文件的请求后，CDN服务器一次从原始服务器获取文件并将其...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>构建和自定义CDN</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496910/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容交付网络（CDN）用于站点和应用程序中，主要是为了加快静态元素的加载。发生这种情况是由于在位于不同地理区域的CDN服务器上缓存文件。通过CDN请求数据后，用户从最近的服务器接收数据。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有内容交付网络的操作原理和功能大致相同。收到下载文件的请求后，CDN服务器一次从原始服务器获取文件并将其提供给用户，同时在给定的时间段内进行缓存。从缓存中回答所有后续请求。所有CDN均具有用于预加载文件，清除缓存，设置其保留期限等选项。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
碰巧的是，出于某种原因您需要组织自己的内容交付网络，然后-让我们帮助您制造另一辆自行车。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qf/rw/ss/qfrwss0k86-bdbbbpztdh3d0nkq.jpeg"><br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资料来源：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pikisuperstar创建的信息图矢量-www.freepik.com</font></font></a></i></sup></font><a name="habracut"></a><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您需要自己的CDN时</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考虑启动自己的CDN有意义的情况：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您想省钱时，甚至使用像</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BunnyCDN</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这样的廉价CDN时，运行成本也要</font><font style="vertical-align: inherit;">每月数百美元</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果我们要获得永久性高速缓存或服务器和通道上没有邻居的高速缓存</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您需要的区域中，CDN服务没有服务点</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所需的任何特殊内容传送设置</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们希望通过与生产服务器的用户保持更近的距离来加速动态内容的交付</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">令人担忧的是，第三方CDN服务可能会非法收集或使用有关用户行为的信息（即不符合GDPR的服务）或从事其他非法行为</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在大多数其他情况下，建议使用现有的现成解决方案。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您需要运行什么</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您拥有自己的自治系统（AS），那就太好了。</font><font style="vertical-align: inherit;">使用它，您可以将同一IP分配给多台服务器，并</font><font style="vertical-align: inherit;">在网络级别上</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遵循此说明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将用户定向到最近的服务器。</font><font style="vertical-align: inherit;">值得一提的是，即使使用地址块/ 24，也可以构建内容交付网络。</font><font style="vertical-align: inherit;">某些服务器提供商允许您发布公告，以供其可用的所有区域使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您不是一个IP地址块的所有者，那么要运行简单的CDN，您将需要：</font></font><br>
<br>
<ul>
<li>   </li>
<li>     .     ,   </li>
<li>geoDNS .    ,   ,     </li>
</ul><br>
<br>
<h2>    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用域名注册，一切都很简单-在任何注册商的任何区域中注册。您还可以将子域用于CDN，例如</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.namedomain.com之类的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。实际上，在我们的示例中，我们将这样做。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
至于订购服务器，应在用户读者所在的地区和国家/地区租用服务器。如果该项目是洲际的，则可以方便地选择可以立即为全球提供服务器的托管提供商。示例：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OVH</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaseweb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100Tb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于专用服务器，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vultr</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DigitalOcean</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于虚拟云*。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于我们的专用CDN，我们在不同的大陆订购了3台虚拟服务器。在</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vultr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在服务器上以</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每月5美元的价格</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获得</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25GB的SSD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">空间和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1TB的流量</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">安装时，选择最新的Debian。</font><font style="vertical-align: inherit;">我们的服务器：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/di/f1/jydif1phgm45zpwjbety-fw_d-g.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法兰克福</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，IP：199.247.18.199 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/wh/v1/ukwhv1lwwsr8snoiqc_yyzquo5s.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">芝加哥</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，IP：149.28.121.123 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3f/qk/6e/3fqk6endcgzeybs-yjlkkphep50.png" width="30"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新加坡</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，IP：157.230.240.216 </font></font><br>
<br>
<font color="#B1B1B1"><sup><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Vultr和DigitalOcean承诺在添加付款方式后立即向使用本文链接注册的用户提供100美元的贷款。</font><font style="vertical-align: inherit;">作者还从中得到了一点赞美，这对他现在是非常重要的。</font><font style="vertical-align: inherit;">请谅解。</font></font></i></sup></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置geoDNS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，当用户访问CDN域或子域时，将他定向到所需的服务器（最接近他的服务器），我们需要具有geoDNS功能的DNS服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
geoDNS的原理和过程如下：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义发送DNS请求的客户端的IP或用于处理客户端请求的递归DNS服务器的IP。</font><font style="vertical-align: inherit;">这些递归服务器通常是DNS提供程序。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过IP客户知道他的国家或地区。</font><font style="vertical-align: inherit;">为此，使用了GeoIP基础，今天有许多基础。</font><font style="vertical-align: inherit;">有一些不错的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免费选择</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据客户的位置，他会给他最近的CDN服务器的IP地址。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您可以自己</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有geoDNS功能</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">的</font></a><font style="vertical-align: inherit;"> DNS服务器</font><font style="vertical-align: inherit;">，但是最好将现成的解决方案与世界各地的DNS服务器网络和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anycast</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配合使用：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">louDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 9.95 /月</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，GeoDNS关税，默认情况下有一个DNS故障转移</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zilore</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 25 /每月</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，启用DNS故障转移</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">亚马逊Route 53</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 35 / mo起，</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行50M净地理请求。</font><font style="vertical-align: inherit;">DNS故障转移单独收费</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS轻松</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起价</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ 125 / mo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，共有10个DNS故障转移</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloudflare</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，企业指导中提供的地理导航功能</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
订购geoDNS时，应注意资费中包含的请求数量，并应考虑到对域的实际呼叫数量可能超出预期数倍。数以百万计的蜘蛛，扫描仪，垃圾邮件制造者和其他恶魔不知疲倦地工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
几乎所有DNS服务都包括构建CDN服务必不可少的部分-DNS故障转移。使用它，您可以配置对服务器的监视，并且在没有生命迹象的情况下，可以在DNS答案中用备份服务器自动替换不工作的服务器地址。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了建立我们的CDN，我们将使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClouDNS</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的GeoDNS关税。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在您的帐户中添加一个新的DNS区域，指示您的域。</font><font style="vertical-align: inherit;">如果我们将在子域上构建CDN，并且已经在使用主域，那么在添加区域后，不要忘记添加现有的工作DNS记录。</font><font style="vertical-align: inherit;">下一步是为CDN域/子域创建几个A记录，每个记录将应用于我们设置的区域。</font><font style="vertical-align: inherit;">您可以将大洲或国家/地区指定为区域；美国和加拿大可以使用子区域。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我们的情况下，CDN将在子域的</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cdn.sayt.in</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上</font><b><font style="vertical-align: inherit;">引发</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">添加</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">区域</font><font style="vertical-align: inherit;">，为该子域创建第一个A记录，并将整个北美地区</font><i><font style="vertical-align: inherit;">引</font></i><font style="vertical-align: inherit;">至芝加哥的服务器：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0x/z_/zt/0xz_ztazcrmz8wqlruylrz4iqh4.png" width="500"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对其他区域重复上述操作，记住要为默认区域创建一个条目。</font><font style="vertical-align: inherit;">结果如下：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/js/zy/iojszykgez_pu7wf3mzd8lvmffa.jpeg" width="600"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
屏幕快照中的最后一个默认记录意味着所有未确定的区域（这是欧洲，非洲，卫星Internet用户等）将被发送到法兰克福的服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这样就完成了基本的DNS配置。</font><font style="vertical-align: inherit;">仍然可以访问域名注册商的网站，并用ClouDNS发布的域名替换当前的域名NS。</font><font style="vertical-align: inherit;">在更新NS的同时，我们将准备服务器。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装SSL证书</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的CDN可以在HTTPS上运行，因此，如果您已经拥有域或子域的SSL证书，则将它们上传到所有服务器，例如在目录</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / ssl / yourdomain /中。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
如果没有证书，则可以从Let's Encrypt获得免费的证书。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACME Shell脚本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常适合此操作</font><font style="vertical-align: inherit;">。客户端既方便又易于配置，最重要的是-允许您通过ClouDNS的API验证DNS的域/子域。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们将仅在其中一台服务器（欧洲199.247.18.199）上安装acme.sh，从中将证书复制到所有其他服务器上。要安装，请执行以下操作：</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# wget -O - https://get.acme.sh | bash; source ~/.bashrc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在安装脚本的过程中，将创建CRON任务，以在我们不参与的情况下进一步续订证书。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
颁发证书时的域验证将使用该API使用DNS进行，因此，在Reseller API菜单的ClouDNS个人帐户中，您需要创建一个新的用户API并为其设置密码。</font><font style="vertical-align: inherit;">生成的带有密码的auth-id将写入文件</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">〜/ .acme.sh / dnsapi / dns_cloudns.sh</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（不要与</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dns_clou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dns.sh文件</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">混淆</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">以下是取消注释和编辑的行：</font></font><br>
<br>
<pre><code class="plaintext hljs">CLOUDNS_AUTH_ID=&lt;auth-id&gt;<font></font>
CLOUDNS_AUTH_PASSWORD="&lt;&gt;"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，我们</font><b><font style="vertical-align: inherit;">要求cdn.sayt.in</font></b><font style="vertical-align: inherit;">的SSL证书</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# acme.sh --issue --dns dns_cloudns -d cdn.sayt.in --reloadcmd "service nginx reload"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在将来的参数中，我们指定了一条命令，以在将来每次证书有效期更新后自动重新加载Web服务器配置。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
获取证书的整个过程最多可能需要2分钟，请不要中断它。</font><font style="vertical-align: inherit;">如果发生域验证错误，请尝试再次运行该命令。</font><font style="vertical-align: inherit;">最后，我们将看到证书的上传位置：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l6/qv/16/l6qv16mchqhhaokxuvbwmnnw6xu.png" width="952"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请记住这些路径，将证书复制到其他服务器时以及在Web服务器设置中需要指定它们。</font><font style="vertical-align: inherit;">我们不注意重新加载Nginx配置文件的错误-在完全配置的服务器上，续订证书时将不存在该错误。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通过SSL对我们来说，剩下的就是将接收到的证书复制到另外两个服务器，同时保存文件的路径。</font><font style="vertical-align: inherit;">在每个目录上创建相同的目录并进行复制：</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# mkdir -p /root/.acme.sh/cdn.sayt.in/<font></font>
root@cdn:~# scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了定期更新证书，我们将使用以下命令在两台服务器上创建每日CRON任务：</font></font><br>
<blockquote><code>scp -r root@199.247.18.199:/root/.acme.sh/cdn.sayt.in/* /root/.acme.sh/cdn.sayt.in/ &amp;&amp; service nginx reload</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，必须</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过键</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（即，</font><font style="vertical-align: inherit;">无需输入密码。</font><font style="vertical-align: inherit;">不要忘记这样做。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装和配置Nginx</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要返回静态内容，我们将使用配置为缓存代理服务器的Nginx。</font><font style="vertical-align: inherit;">更新软件包列表，并将其安装在所有三台服务器上：</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# apt update<font></font>
root@cdn:~# apt install nginx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用默认配置，而不是默认配置：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.conf</font></font></b><div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-attribute">user</span> www-data;
<span class="hljs-attribute">worker_processes</span> auto;
<span class="hljs-attribute">pid</span> /run/nginx.pid;<font></font>
<font></font>
<span class="hljs-section">events</span> {
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">4096</span>;
    <span class="hljs-attribute">multi_accept</span> <span class="hljs-literal">on</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-section">http</span> {
    <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nopush</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">tcp_nodelay</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">types_hash_max_size</span> <span class="hljs-number">2048</span>;<font></font>
<font></font>
    <span class="hljs-attribute">include</span> /etc/nginx/mime.types;
    <span class="hljs-attribute">default_type</span> application/octet-stream;<font></font>
<font></font>
    <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;
    <span class="hljs-attribute">error_log</span> /var/log/nginx/error.log;<font></font>
<font></font>
    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_disable</span> <span class="hljs-string">"msie6"</span>;
    <span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">6</span>;
    <span class="hljs-attribute">gzip_proxied</span> any;
    <span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/javascript text/css application/json application/xml text/xml application/rss+xml;
    <span class="hljs-attribute">gunzip</span> <span class="hljs-literal">on</span>;            <font></font>
<font></font>
    <span class="hljs-attribute">proxy_temp_path</span>    /var/cache/tmp;
    <span class="hljs-attribute">proxy_cache_path</span>   /var/cache/cdn levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cdn:<span class="hljs-number">64m</span> max_size=<span class="hljs-number">20g</span> inactive=<span class="hljs-number">7d</span>;
    <span class="hljs-attribute">proxy_cache_bypass</span> <span class="hljs-variable">$http_x_update</span>;<font></font>
<font></font>
<span class="hljs-section">server</span> {
  <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl;
  <span class="hljs-attribute">server_name</span> cdn.sayt.in;<font></font>
<font></font>
  <span class="hljs-attribute">ssl_certificate</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.cer;
  <span class="hljs-attribute">ssl_certificate_key</span> /root/.acme.sh/cdn.sayt.in/cdn.sayt.in.key;<font></font>
<font></font>
  <span class="hljs-attribute">location</span> / {
    <span class="hljs-attribute">proxy_cache</span> cdn;
    <span class="hljs-attribute">proxy_cache_key</span> <span class="hljs-variable">$uri</span><span class="hljs-variable">$is_args</span><span class="hljs-variable">$args</span>;
    <span class="hljs-attribute">proxy_cache_valid</span> <span class="hljs-number">90d</span>;
    <span class="hljs-attribute">proxy_pass</span> https://sayt.in;<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在配置中，编辑：</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max_size-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存大小不超过可用磁盘空间</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非活动状态</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -没有人访问的缓存数据的存储时间</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssl_certificate_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -SSL证书和密钥文件的路径</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存数据的存储时间</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_pass</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -CDN将从中请求缓存文件的原始服务器的地址。</font><font style="vertical-align: inherit;">在我们的示例中，这是</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sayt.in</font></font></i></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，一切都很简单。</font><font style="vertical-align: inherit;">由于</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inactive</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid指令</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的相似性，因此复杂性只能在设置缓存时间时出现</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我们将在示例中对其进行分析。</font><font style="vertical-align: inherit;">这是</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inactive = 7d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proxy_cache_valid 90d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发生的情况</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果在7天内未重复请求，则在此时间段后，数据将从缓存中删除</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果该请求至少每7天重复一次，则缓存中的数据将在90天后被视为过时，并且在下一个请求时，Nginx将通过从原始服务器获取数据来对其进行更新</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nginx.conf的编辑后</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，重新加载配置：</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# service nginx reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们的CDN已完全准备就绪。</font><font style="vertical-align: inherit;">每月$ 15 </font><font style="vertical-align: inherit;">我们在三大洲拥有3 TB的流量，每个站点有1 TB的流量。</font></font><br>
<br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查CDN的操作</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下来自不同地理位置的CDN。</font><font style="vertical-align: inherit;">为此，任何ping服务都适用。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发射点</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主办</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">知识产权</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">平均时间，毫秒</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">德国柏林</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">荷兰，阿姆斯特丹</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法国巴黎</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">英国伦敦</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">199.247.18.199</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加拿大多伦多</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16.2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">美国，旧金山</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">52.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">美国达拉斯</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23.1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">美国，芝加哥</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">美国，纽约</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">149.28.121.123</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新加坡</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日本东京</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74.8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">澳大利亚，悉尼</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛迪网</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">157.230.240.216</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95.9</font></font></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">效果不错。</font><font style="vertical-align: inherit;">现在，我们将测试图像</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">test.jpg</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">放在主站点的根目录中，</font><font style="vertical-align: inherit;">并通过CDN检查其下载速度。</font><font style="vertical-align: inherit;">说快</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">做</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">了</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">内容交付迅速。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果要清除CDN点上的缓存，我们将编写一个小脚本。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">清除</font></font></b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> ]
<span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging all cache"</span><font></font>
    rm -rf /var/cache/cdn/*<font></font>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Purging <span class="hljs-variable">$1</span>"</span>
    FILE=`<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> | md5sum | awk <span class="hljs-string">'{print $1}'</span>`<font></font>
    FULLPATH=/var/cache/cdn/<span class="hljs-variable">${FILE:31:1}</span>/<span class="hljs-variable">${FILE:29:2}</span>/<span class="hljs-variable">${FILE}</span>
    rm -f <span class="hljs-string">"<span class="hljs-variable">${FULLPATH}</span>"</span>
<span class="hljs-keyword">fi</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要删除整个缓存，只需运行它，就可以像这样清除一个单独的文件：</font></font><br>
<br>
<pre><code class="plaintext hljs">root@cdn:~# ./purge.sh /test.jpg</code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后，我想提供一些有用的技巧，以便立即克服这一问题，这一次使我的头发麻了：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了提高CDN容错能力，建议配置DNS故障转移，以帮助在服务器发生故障时快速更改A记录。</font><font style="vertical-align: inherit;">这是在域的DNS记录的控制面板中完成的</font></font></li>
<li>           CDN,    .            CDN,      6-7 : ,   (),   (), , ,   </li>
<li>         CDN. ,          ,       -</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">  </a>,  ,           </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试检查</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从不同位置</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到您的服务器的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ping</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这样您就可以看到最靠近CDN点的区域并正确配置GeoDNS</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据任务的不同，针对特定的缓存要求配置Nginx并考虑服务器上的负载并不是没有道理的。</font><font style="vertical-align: inherit;">有关Nginx缓存的文章- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及重负载下的工作加速：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此处</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">此处</font></a><font style="vertical-align: inherit;">对我有很大帮助。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496886/index.html">伊隆·马斯克（Elon Musk）在特斯拉Model 3的后视镜上揭示了相机的用途</a></li>
<li><a href="../zh-CN496888/index.html">创业公司使用AI搜索有助于对抗冠状病毒的分子</a></li>
<li><a href="../zh-CN496892/index.html">所有Habr集中在一个基地。评论和网络应用</a></li>
<li><a href="../zh-CN496894/index.html">完善的产品积压</a></li>
<li><a href="../zh-CN496900/index.html">通过Apache NiFi导入USRLE。第1步-通过HTTPS下载文件</a></li>
<li><a href="../zh-CN496912/index.html">Windows上的ThinkPad E480英特尔VS Windows上的ThinkPad E495 AMD是否有任何区别？</a></li>
<li><a href="../zh-CN496914/index.html">最短的十进制程序</a></li>
<li><a href="../zh-CN496916/index.html">远程教学，协商和咨询-第3部分：Yealink会议服务器和4个特别优惠</a></li>
<li><a href="../zh-CN496920/index.html">使用ASP.NET Core和Arduino打造智能家居</a></li>
<li><a href="../zh-CN496922/index.html">关于作业NeoQUEST-2020示例的反向客户端-服务器apk指南</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>