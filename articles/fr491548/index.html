<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💹 👩🏼‍⚖️ 🧖🏼 Traitement d'image ReactJS - NodeJS 🤰🏻 👨🏿‍🍳 👨🏼‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journée. 
 
 Je passe le débriefing sur Reactjs (côté client) et Nodejs (côté serveur). 
 
 Récemment, dans mon petit projet, la question s'est ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Traitement d'image ReactJS - NodeJS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491548/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonne journée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je passe le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">débriefing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur </font><b><font style="vertical-align: inherit;">Reactjs</font></b><font style="vertical-align: inherit;"> (côté client) et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nodejs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (côté serveur). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Récemment, dans mon petit projet, la question s'est posée de savoir avec quelle facilité et simplicité il est possible d'échanger des images de type client-serveur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, nous allons apprendre à envoyer des données binaires (en particulier des images) du côté client et à les traiter sur le serveur. </font><font style="vertical-align: inherit;">Bienvenue au chat.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si votre application Web est un réseau social ou un messager ou quelque chose de similaire, vous devrez certainement travailler avec des données binaires, dans la plupart des cas, c'est du traitement d'image. </font><font style="vertical-align: inherit;">Cela sera discuté. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour avoir une idée générale, je vais l'interpréter séquentiellement.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetez un oeil à ce qui suit</font></font></h4><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système de nombres binaires</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">système de</font></a><font style="vertical-align: inherit;"> nombres décimaux</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page de codes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASCII</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unicode</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octet</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format hexadécimal</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier binaire</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampons et threads nodejs</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayBuffer et Uint8Array</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filereader</font></font></a></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système de nombres binaires et système de nombres décimaux. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'un nombre qui est écrit en utilisant deux caractères: les uns et les zéros. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En termes simples, il est de 2 (base) à la puissance de n (le nombre de chiffres), par exemple, le nombre 10001 a 5 chiffres: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4 chiffres = 1; 2 ^ 4 = 16; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3 chiffres = 0; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 chiffres = 0; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 chiffre = 0; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 chiffre = 1; 2 ^ 0 = 1; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1-vrai - faire un calcul; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0-faux - ne calcule pas; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, nous obtenons 16 + 1 = 17; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec l'opération inverse, l'ordinateur présente les données sous forme binaire.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> num = <span class="hljs-number">17</span>; <span class="hljs-comment">//  </span>
<span class="hljs-keyword">const</span> binNum = num.toString(<span class="hljs-number">2</span>); <span class="hljs-comment">//    </span>
<span class="hljs-keyword">const</span> initNum = <span class="hljs-built_in">parseInt</span>(binNum, <span class="hljs-number">2</span>); <span class="hljs-comment">//  </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système numérique décimal est un nombre qui est écrit en utilisant 10 caractères, de 0 à 9. Nous les utilisons tous les jours. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le fait est qu'un ordinateur vit de sa présentation d'informations. </font><font style="vertical-align: inherit;">Si nous écrivons dans notre langue maternelle ou si nous comptons en décimal, alors pour un ordinateur, tout cela est une représentation binaire. </font><font style="vertical-align: inherit;">Vous demandez: «Que signifie la représentation binaire?». </font><font style="vertical-align: inherit;">Comme l’a dit mon professeur d’anglais, «comme vous l’entendez, c’est écrit». </font><font style="vertical-align: inherit;">L'ordinateur présente des fichiers contenant du texte ou autre, ou des calculs dans le système numérique binaire - c'est la représentation binaire. </font><font style="vertical-align: inherit;">La langue de la machine, le nombre "17" est - 10001.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page de codes: ASCII, Unicode</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La question se pose. </font><font style="vertical-align: inherit;">C'est clair avec des chiffres, mais qu'en est-il du texte? </font><font style="vertical-align: inherit;">Comment la machine convertira-t-elle le texte en binaire? </font><font style="vertical-align: inherit;">Tout est simple. </font><font style="vertical-align: inherit;">Pour ce faire, il existe des encodages tels que ASCII ou Unicode. </font><font style="vertical-align: inherit;">Il s'agit d'un tableau simple ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page de codes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), où il y a une correspondance avec notre numéro de caractère, par exemple, le caractère "S" est le numéro 53 selon le tableau ASCII, puis l'ordinateur présentera le numéro 53 sous forme binaire - 110101. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En ce qui concerne Unicode, il s'agit d'un standard puissant qui comprend Encodage UTF-8, qui est très demandé dans l'espace Web et les systèmes de type Unix. </font><font style="vertical-align: inherit;">Le principe de fonctionnement est général.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bit et octet</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un bit est une unité de mesure des informations par un ordinateur. </font><font style="vertical-align: inherit;">Et nous savons déjà comment un ordinateur représente l'information. </font><font style="vertical-align: inherit;">Oui! </font><font style="vertical-align: inherit;">Tu as raison. </font><font style="vertical-align: inherit;">Un bit est 1 ou 0. Pour un ordinateur, 1 ou 0 est quelque chose comme un transistor, vrai ou faux. </font><font style="vertical-align: inherit;">Maintenant, il n'est pas du tout difficile de comprendre ce qu'est un octet - il s'agit de 8 bits, il est aussi appelé octet (du type composé de 8).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format hexadécimal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On passe au format "hex". </font><font style="vertical-align: inherit;">Nous avons parlé du système numérique binaire, du système décimal, entre autres choses, il y a un système numérique hexadécimal, les typographes comprendront ce que je veux dire. </font><font style="vertical-align: inherit;">Il s'agit d'un nombre écrit en utilisant 16 caractères, de 0 à 9 et de af. </font><font style="vertical-align: inherit;">La question se pose: «Pourquoi est-ce si compliqué?». </font><font style="vertical-align: inherit;">Étant donné que l'unité de mémoire est un octet de 8 bits, il est néanmoins plus pratique d'écrire sa valeur sur deux chiffres hexadécimaux. </font><font style="vertical-align: inherit;">De plus, dans la norme Unicode, le numéro de caractère est généralement écrit sous forme hexadécimale en utilisant au moins 4 chiffres. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce format fonctionne comme suit: dans le cas d'un octet 8 bits, il divise 8 bits par sexe, c'est-à-dire 10101011 - 1010 | </font><font style="vertical-align: inherit;">1011, après convertit chaque partie en conséquence. </font><font style="vertical-align: inherit;">1010-a, 1011-b;</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> num = <span class="hljs-number">196</span>; <span class="hljs-comment">//  </span>
<span class="hljs-keyword">const</span> hexNum = num.toString(<span class="hljs-number">16</span>); <span class="hljs-comment">//   hex </span>
<span class="hljs-keyword">const</span> initNum = <span class="hljs-built_in">parseInt</span>(hexNum, <span class="hljs-number">16</span>); <span class="hljs-comment">//     -  </span>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fichier binaire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous passons à l'élément suivant, il est également appelé fichier binaire - c'est un tableau d'octets. </font><font style="vertical-align: inherit;">Pourquoi est binaire? </font><font style="vertical-align: inherit;">Les octets sont constitués de bits, c'est-à-dire de caractères d'un système de nombres binaires, d'où le nom est binaire. </font><font style="vertical-align: inherit;">Absolument tous les fichiers entrent dans la catégorie des fichiers binaires, c'est-à-dire les fichiers contenant du texte, des images - tous ces fichiers sont des fichiers binaires, donc des données binaires, donc des données binaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Souvent, les données binaires sont générées par des caractères de page de codes ASCII, ainsi qu'au format hexadécimal, en particulier des images. </font><font style="vertical-align: inherit;">Je vais vous donner un exemple. </font><font style="vertical-align: inherit;">Nous avons l'image suivante:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regarder la pièce jointe</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/d0/ap/hg/d0aphgteaegsu5_pijvf42axwbk.jpeg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sa visualisation partielle est représentée par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hex-agent-smith</font></font></a> <br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regarder la pièce jointe</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/oo/l-/hlool-oqbpsqucpxrnobdbjpm5k.png"><br>
      ASCII,        hex ,    .<br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayBuffer et Uint8Array</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayBuffer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - objet pour travailler avec des données binaires en javascript. </font><font style="vertical-align: inherit;">Fixe la longueur de la mémoire pour travailler avec le binaire. </font><font style="vertical-align: inherit;">Par exemple: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new ArrayBuffer (256)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - crée un objet de type tableau avec une taille de 256 octets, ni plus ni moins. </font><font style="vertical-align: inherit;">Chaque octet contient des informations spécifiques. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayBuffer n'est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pas un tableau et les méthodes de tableau ne lui sont pas applicables. </font><font style="vertical-align: inherit;">Vous posez une question, comment l'utiliser? </font><font style="vertical-align: inherit;">Un objet </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uint8Array</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> donne une représentation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayBuffer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans un nombre non signé de 8 bits, c'est-à-dire de 0 à 255.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filereader</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileReader</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">C'est le constructeur pour créer les éléments suivants:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span>&gt;</span></code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et après?</font></font></h4><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prenons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
maintenant un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">excellent exemple</font></a><font style="vertical-align: inherit;"> qui illustre le traitement d'image:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Module ReactJS</font></font><br>
 <pre><code class="javascript hljs"><span class="hljs-keyword">import</span> React, {useState, useRef, useCallback} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> UPLOAD_AVATAR = <span class="hljs-string">'http://localhost:8080/api/upload_avatar'</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">//   ref   FileReader</span>
  <span class="hljs-keyword">const</span> fileRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [ loading, setLoading ] = useState(<span class="hljs-literal">false</span>);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> handleSubmit = useCallback( <span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {<font></font>
    event.preventDefault();<font></font>
<font></font>
    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> (uint8Array) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios({
          <span class="hljs-attr">method</span>: <span class="hljs-string">'post'</span>,
          <span class="hljs-attr">url</span>: UPLOAD_AVATAR,
          <span class="hljs-attr">data</span>: [...uint8Array] <span class="hljs-comment">//    JSON,   </span><font></font>
        });<font></font>
<font></font>
        setLoading(<span class="hljs-literal">false</span>);
        <span class="hljs-built_in">console</span>.log(response);<font></font>
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-built_in">console</span>.error(e.message, <span class="hljs-string">'function handleSubmit'</span>)<font></font>
      }<font></font>
    };<font></font>
<font></font>
    <span class="hljs-keyword">if</span>(!fileRef.current) <span class="hljs-keyword">return</span> <span class="hljs-keyword">void</span> <span class="hljs-literal">null</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> FileReader();<font></font>
    reader.onloadend = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(reader.result);<font></font>
      setLoading(<span class="hljs-literal">true</span>);<font></font>
      fetchData(uint8Array);<font></font>
    };<font></font>
<font></font>
<font></font>
    <span class="hljs-comment">//  </span>
    reader.readAsArrayBuffer(fileRef.current[<span class="hljs-number">0</span>]);<font></font>
<font></font>
    <span class="hljs-comment">//  reader.readAsBinaryString(fileRef.current[0]) </span>
    <span class="hljs-comment">//  MDN,</span>
    <span class="hljs-comment">//      File API specification, </span>
    <span class="hljs-comment">//    </span>
    <span class="hljs-comment">//  ,     </span>
    <span class="hljs-comment">//  readAsArrayBuffer</span>
    <span class="hljs-comment">// https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsBinaryString</span><font></font>
  }, []);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> nodeDom = (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> fileRef.current = e.target.files}
          accept="image/*"
          type="file"
          id="button-file"
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>{loading ? '...' : ''}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
  );<font></font>
<font></font>
  <span class="hljs-keyword">return</span> nodeDom<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;<font></font>
<font></font>
               </code></pre><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Module ExpressJS</font></font><br>
 <pre><code class="javascript hljs"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);
<span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">"cors"</span>);<font></font>
<font></font>
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);<font></font>
<font></font>
<span class="hljs-keyword">const</span> PORT = <span class="hljs-number">8080</span>;<font></font>
<font></font>
<span class="hljs-keyword">const</span> app = express();<font></font>
<font></font>
app.use(express.static(<span class="hljs-string">"public"</span>));<font></font>
app.use(express.json({ <span class="hljs-attr">limit</span>: <span class="hljs-string">"50mb"</span> }));<font></font>
app.use(cors());<font></font>
<font></font>
app.post(<span class="hljs-string">"/api/upload_avatar"</span>, (req, res) =&gt; {
  <span class="hljs-built_in">console</span>.log(req.body);
  <span class="hljs-keyword">const</span> randomString = crypto.randomBytes(<span class="hljs-number">5</span>).toString(<span class="hljs-string">'hex'</span>);
  <span class="hljs-keyword">const</span> stream = fs.createWriteStream(<span class="hljs-string">`./public/images/<span class="hljs-subst">${randomString}</span>.png`</span>);<font></font>
<font></font>
  stream.on(<span class="hljs-string">'finish'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'file has been written'</span>);<font></font>
    res.end(<span class="hljs-string">'file has been written'</span>);<font></font>
  });<font></font>
<font></font>
  stream.write(Buffer.from(req.body), <span class="hljs-string">'utf-8'</span>);<font></font>
  stream.end();<font></font>
});<font></font>
<font></font>
app.listen(PORT, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server running at <span class="hljs-subst">${PORT}</span>`</span>));<font></font>
<font></font>
              </code></pre><br>
 </li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total:</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi avons-nous besoin d'encodages</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vue générale des données binaires</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Méthode recommandée pour envoyer des octets</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objet tampon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objet FileReader</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implémentation simple sur les crochets</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr491538/index.html">Lemmes d'étalement pour les langues régulières et sans contexte</a></li>
<li><a href="../fr491540/index.html">Réseaux pour un informaticien débutant. Base obligatoire</a></li>
<li><a href="../fr491542/index.html">Transformation des couleurs: recherches dans les tables d'éclaircie</a></li>
<li><a href="../fr491544/index.html">Que lire le week-end restant - des livres sur les virus, les pirates et l'histoire du cartel "numérique"</a></li>
<li><a href="../fr491546/index.html">Java 14 arrive</a></li>
<li><a href="../fr491550/index.html">Nous générons des paroles avec des chaînes de Markov</a></li>
<li><a href="../fr491552/index.html">Détection d'anomalies Python avec encodeurs automatiques en Python</a></li>
<li><a href="../fr491554/index.html">Nous contournons l'interdiction des messages API Vkontakte via Python</a></li>
<li><a href="../fr491556/index.html">Microservices Java: un guide pratique</a></li>
<li><a href="../fr491558/index.html">Trouvez plus d'oeufs de Pâques rock: des messages mystérieux aux appels pour vous laver les mains et faire vos devoirs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>