<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî´ üÜï üçà Private SNAFU goes to DBA üçÅ üôãüèΩ üìõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For those who don‚Äôt know, SNAFU is a character in military patriotic cartoons created by Americans during the war. This gouging, due to natural idiocy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Private SNAFU goes to DBA</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490282/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ka/2w/rm/ka2wrm9ttuyqxbvu6rfj2ewkmok.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For those who don‚Äôt know, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a character in military patriotic cartoons created by Americans during the war. </font><font style="vertical-align: inherit;">This gouging, due to natural idiocy, falls into catastrophic situations all the time and, as a rule, dies at the end of the series. </font><font style="vertical-align: inherit;">True, in the next series he is again alive - in this sense, he can be considered the distant progenitor of Kenny from South Park.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When recruiting people for the SQL server developer position, I was often submissive to how they answered questions. </font><font style="vertical-align: inherit;">I was ready to tell them YES if I had not been saved by a small one-line task that my colleague suggested. </font><font style="vertical-align: inherit;">It is amazing how much this task can produce in a single SQL string. </font><font style="vertical-align: inherit;">And now the candidate already walks rake enthusiastically. </font><font style="vertical-align: inherit;">A rake, as you will see, there are many. </font><font style="vertical-align: inherit;">Of course, not a single person collected ALL possible rakes. </font><font style="vertical-align: inherit;">But to show them all, I needed SNAFU.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, the task:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">Events</span> <span class="hljs-keyword">where</span> DT=<span class="hljs-string">'2020/02/03'</span></code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What did the author of the code want to do?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why can this not work as I wanted?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to fix it?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My conversation with SNAFU will go further. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Obviously, the query selects data for one day. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And what's wrong with that? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Well, there is an asterisk, it would be better to indicate the fields ... </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And what is stored in the table, what do you think? And what type of field is DT? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Events ... Time of events ... So datetime </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Well? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (after deliberation) aah, so if there‚Äôs time, then the notes will be read only after midnight </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> excellent </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have overcome the first two points and move on to the third. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How to fix it? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where convert (varchar, DT, 102) = '2020/02/03' (Rake # 1 worked) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But doesn‚Äôt it bother you that this can prevent SQL from using the DT index if it is? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where DT between '2020/02/03' and '2020/02/04' (Rake # 2 worked) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Does it bother you that the data for the next number (midnight) will also be included here? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where DT between '2020/02/03' and '2020/02/03 23:59:59' (Rake # 3 worked) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Would you like to deal with a bank in which there is a second when there is money, which you contributed will be lost? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where DT between '2020/02/03' and '2020/02/03 23: 59: 59.999' (Rake # 4 worked) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Do you know that 23: 59: 59.999 will be rounded again until midnight? </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exactly, there the granularity is 13-16ms. Then: where DT between '2020/02/03' and '2020/02/03 23: 59: 59.986' (Rake # 5 worked) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is, if DT becomes smalldatetime or datetime2, will everything stop working? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lr/kh/ra/lrkhravomkrqumtxs4istl3fgei.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I do not know why the transition to the moment below is so difficult. In reality, more than half of the candidates are stupidly desperate. Sometimes you have to prompt. But our SNAFU tortured a solution: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SNAFU:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where DT&gt; = '2020/02/03' and DT &lt;'2020/02/04' </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finally. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNAFU wipes sweat from his forehead. Now is the time for a control shot. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And what else is really bad here? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNAFU is shaking. His hands are shaking. The gaze wanders. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Is it February 3 or March 2?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems to me that such tasks give understanding much faster than the idiotic "test tasks". </font><font style="vertical-align: inherit;">In this case, SNAFU may be a good guy, but he worked little with temporal data, and it is better not to let him into the financial sector.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zm/1e/6p/zm1e6px5ez-u5mdcu1a2p2oomju.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490268/index.html">Small motor respiratory blocking in computer sports (MKM)</a></li>
<li><a href="../en490270/index.html">Subject-oriented design is actually</a></li>
<li><a href="../en490274/index.html">WordPress "Render-Blocking JavaScript and CSS." How to fix it?</a></li>
<li><a href="../en490278/index.html">Secret skills of introverts: an oratory in an IT company</a></li>
<li><a href="../en490280/index.html">ML to the Rescue: AI Developer Tools</a></li>
<li><a href="../en490286/index.html">Seven known to all unpleasant rules of life, which few consider</a></li>
<li><a href="../en490290/index.html">Eight Important Programmer Habits</a></li>
<li><a href="../en490292/index.html">Big red-blue sell</a></li>
<li><a href="../en490294/index.html">Puddle interview</a></li>
<li><a href="../en490296/index.html">Window functions with a ‚Äúwindow‚Äù or how to use a frame</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>