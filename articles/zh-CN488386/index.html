<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☘️ ✌🏻 ⛩️ 应用网络异常分析工具的案例：通过浏览器插件的攻击 🤑 🤰🏻 ✌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="对于浏览器而言，对浏览器的攻击是一种相当流行的媒介，他们通过Internet上浏览程序的各种漏洞或针对它们的受保护程度不强的插件，试图侵入公司和部门网络。这通常始于具有网络犯罪分子所使用的漏洞的完全合法甚至列入白名单的站点。插件，扩展程序，插件（即使出于良好目的而安装）一旦开始就可以监视用户活动，将...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>应用网络异常分析工具的案例：通过浏览器插件的攻击</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/488386/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于浏览器而言，对浏览器的攻击是一种相当流行的媒介，他们通过Internet上浏览程序的各种漏洞或针对它们的受保护程度不强的插件，试图侵入公司和部门网络。这通常始于具有网络犯罪分子所使用的漏洞的完全合法甚至列入白名单的站点。插件，扩展程序，插件（即使出于良好目的而安装）一旦开始就可以监视用户活动，将访问过的网站的历史“合并”给开发人员，在页面中引入烦人的广告，有时甚至是恶意的。用户通常甚至不了解他们在网站页面上看到的广告横幅是由他们安装的插件添加的，它最初不是嵌入在页面上的。有时，此类插件和扩展甚至充当攻击者进入用户计算机的大门，从此开始了企业内部网络的胜利之战。通过这些扩展，攻击者可以安装恶意代码，跟踪数据或窃取它。同时，我们并不总是能够强制所有用户正确配置其浏览器并监视其配置。当只有一个用户可以成为最弱的链接并打开“通向地狱的大门”时，该怎么办？在这种情况下，网络流量监视解决方案可以提供帮助。通过它，胜利的队伍开始在企业的内部网络上。通过这些扩展，攻击者可以安装恶意代码，跟踪数据或窃取它。同时，我们并不总是能够强制所有用户正确配置其浏览器并监视其配置。当只有一个用户可以成为最弱的链接并打开“通向地狱的大门”时，该怎么办？在这种情况下，网络流量监视解决方案可以提供帮助。通过它，胜利的队伍开始在企业的内部网络上。通过这些扩展，攻击者可以安装恶意代码，跟踪数据或窃取它。同时，我们并不总是能够强制所有用户正确配置其浏览器并监视其配置。当只有一个用户可以成为最弱的链接并打开“通向地狱的大门”时，该怎么办？在这种情况下，网络流量监视解决方案可以提供帮助。什么时候只有一个用户可以成为最弱的链接并打开“地狱之门”？在这种情况下，网络流量监视解决方案可以提供帮助。什么时候只有一个用户可以成为最弱的链接并打开“地狱之门”？在这种情况下，网络流量监视解决方案可以提供帮助。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nj/1y/zc/nj1yzcepmgaxbl77ce0_rxtt-uy.png" alt="图片"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
思科的研究部门之一，思科认知智能公司，是在捷克公司Cognitive Security于多年前被收购之后出现的。该公司透露，许多恶意浏览器插件具有独特的特征，可以作为网络流量分析的一部分进行检测和监视。与之前检查的前三个案例（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">泄漏检测</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恶意代码</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">DNSpionage活动）</font></a><font style="vertical-align: inherit;">相比，当前存在的唯一区别</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）-为了检测引入了网络犯罪分子赚钱或合并数据的广告的插件的活动，您需要自己做大量研究（我们花了大约一年的时间分析了数千个插件，以识别行为模式并描述它们）或信任NTA类解决方案的制造商，其中包含这样的机会。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是Cisco Stealthwatch解决方案中的此功能。我们看到，从内部网络的两个地址（分别为10.201.3.45和10.201.3.108）中，记录了与点击欺诈相关的活动，将广告引入页面（广告注入）以及恶意广告。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cv/o9/dz/cvo9dzu9redezchepoc-55esxpk.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
显然，我们要调查此活动：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/c4/8a/lyc48apyvnnmj2spn38if7nfdva.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们看到公司网络中的节点与位于合法Amazon上的域进行了交互（因此，按IP地址进行阻止将无法工作；当然，如果您不是Roskomnadzor，则无法）。但是，将各种机器学习算法应用于流量表明此活动是恶意的。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nj/1y/zc/nj1yzcepmgaxbl77ce0_rxtt-uy.png" alt="图片"><br>
<cut></cut><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
更深入的潜水使我们能够了解有关威胁的更多详细信息。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qz/a6/rv/qza6rvvuqfsoohsxv6pqwefffwu.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，案例＃CADP01与恶意代码AdPeak关联，该恶意代码将AdAdak注入到所访问的网页中，并向攻击者赚钱。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z-/bo/kn/z-boknz8xqnrkx8-qyplmth9e-o.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
案例＃CDPY01与潜在的有害应用程序相关联，该应用程序将广告注入浏览器会话，并可能导致随后感染计算机。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/rj/2o/birj2o4fn1ihs4_zly-5wuktwx8.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于检测到恶意浏览器活动可能表明已经发生感染，因此我们需要进行调查，以显示谁在我们的网络上与受感染的节点进行交互，它是什么类型的节点，它的作用是什么，用户为它工作什么等等。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/aw/bf/ei/awbfeip6zgij6zrijxdts51sdjo.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，提到的节点10.201.3.45属于开发组（开发或软件开发）。我们还将看到与此节点关联的所有数据流以及主要的安全事件。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/d6/fs/lxd6fsxbptliy7eyl_rruwsyw9o.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有趣的是，我们最感兴趣的节点通常与本地DNS服务器进行交互，这导致人们想到可能对DNS或通过DNS进行攻击（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请记住上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一篇文章中描述的DNSpionage或Sea Turtle）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们在安全事件列表中看到了什么？流被拒绝。这是什么？这个问题的答案在很大程度上取决于上下文，因为内部节点与内部节点的连接与内部节点与外部节点的连接有很大不同，并且含义可能完全不同。例如，如果内部节点有许多禁止通过同一端口连接到内部资源的连接（流），则这可能是任何应用程序的错误配置。许多不同端口或内部节点的禁止流动，很可能是侦察，这是任何攻击的第一阶段。从内部到外部Internet站点的阻止流可以表征恶意代码，远程访问实用程序（RAT），信息泄漏以及安全策略定义为禁止的许多其他“有趣”事件的运行。而且由于它们已被您的网络流量分析系统检测到，这意味着您有问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这种情况很有趣，因为它稍微改变了NTA类系统功能的观点，这些功能依赖于Netflow（或其他流协议）在工作中的分析。</font><font style="vertical-align: inherit;">可以看出，这样的系统不仅可以在网络级别上运行，而且还可以使我们上升到更高的水平并在应用程序级别检测攻击，而防火墙或终端设备的保护手段始终无法看到这些攻击。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN488374/index.html">电报+ 1C + Webhooks + Apache +自签名证书</a></li>
<li><a href="../zh-CN488376/index.html">当原则“让所有事情都下地狱，那就去做！” 不起作用：拖拉笔记</a></li>
<li><a href="../zh-CN488378/index.html">简要介绍JS中的命名</a></li>
<li><a href="../zh-CN488380/index.html">通过“一个地方”在STM中最简单的开始</a></li>
<li><a href="../zh-CN488382/index.html">我为我访问的网站增加了3-25秒的延迟</a></li>
<li><a href="../zh-CN488388/index.html">重新登录和HTTP基本身份验证</a></li>
<li><a href="../zh-CN488390/index.html">如何使用OpenId Connect成为Telegram机器人的朋友</a></li>
<li><a href="../zh-CN488392/index.html">适用于k8s的生产就绪图像</a></li>
<li><a href="../zh-CN488404/index.html">2020年值得期待的游戏</a></li>
<li><a href="../zh-CN488406/index.html">IPv6-您做错了</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>