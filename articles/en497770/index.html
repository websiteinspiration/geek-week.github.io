<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå∫ üî≤ ü§≤üèΩ Introducing PyCaret: An Open Low-Code Python Machine Learning Library üëΩ ‚úçÔ∏è üëßüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. Ahead of the start of the Python Neural Networks course , we have prepared for you a translation of another interesting material.
 
 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Introducing PyCaret: An Open Low-Code Python Machine Learning Library</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/497770/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone. </font><font style="vertical-align: inherit;">Ahead of the start of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python Neural Networks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> course </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">, we have</font></a><font style="vertical-align: inherit;"> prepared for you a translation of another interesting material.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/wy/gi/c_/wygic_yo--flcdfigvfuw2ihy4y.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 We are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pleased to</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> introduce </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">PyCaret</font></a><font style="vertical-align: inherit;"> , an open source Python machine learning library for learning and deploying models with and without a teacher in a low-code environment. PyCaret allows you to go from data preparation to model deployment in a few seconds in the notebook environment you choose. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compared to other open machine learning libraries, PyCaret is a low-code alternative that can replace hundreds of lines of code with just a few words. The speed of more efficient experiments will increase exponentially. PyCaret is essentially a Python shell over several machine learning libraries such as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XGBoost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft LightGBM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spaCy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and many others. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyCaret is simple and easy to use. </font><font style="vertical-align: inherit;">All operations performed by PyCaret are sequentially stored in a pipeline fully ready for deployment. </font><font style="vertical-align: inherit;">Whether it‚Äôs adding missing values, converting categorical data, engineering features or optimizing hyperparameters, PyCaret can automate all this. </font><font style="vertical-align: inherit;">To learn a little more about PyCaret, check out this short </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">video</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Getting Started with PyCaret</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 The first stable release of PyCaret version 1.0.0 can be installed using pip. </font><font style="vertical-align: inherit;">Use the command line interface or the notebook environment and run the command below to install PyCaret.</font></font><br>
<br>
<pre><code class="python hljs">pip install pycaret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 If you are using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Notebooks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Colab</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , run the following command:</font></font><br>
<br>
<pre><code class="python hljs">!pip install pycaret</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 When you install PyCaret, all dependencies will be installed automatically. </font><font style="vertical-align: inherit;">You can view the list of dependencies </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It couldn't be easier</font></font></h4><br>
<img src="https://habrastorage.org/webt/jp/an/zj/jpanzjzeukkc6ncvkfqsrrespv4.gif"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Walkthrough</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Data Acquisition</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In this walkthrough, we will use a diabetic dataset, our goal is to predict the patient‚Äôs result (in binary 0 or 1) based on several factors such as pressure, blood insulin level, age, etc. . </font><font style="vertical-align: inherit;">This dataset is available on the PyCaret </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The easiest way to import the dataset directly from the repository is to use the function </font></font><code>get_data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the modules </font></font><code>pycaret.datasets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> pycaret.datasets <span class="hljs-keyword">import</span> get_data<font></font>
diabetes = get_data(<span class="hljs-string">'diabetes'</span>)</code></pre><br>
<br>
<img src="https://habrastorage.org/webt/gi/zv/nr/gizvnrt7xv6gqv6lrsaxhmztuus.png"><br>
 <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyCaret can work directly with pandas </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></b><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">data frames </font></i><b><font style="vertical-align: inherit;">. Setting up the environment</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Any experiment with machine learning in PyCaret starts with setting up the environment by importing the necessary module and initializing </font></font><code>setup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The module that will be used in this example is </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycaret.classification</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After importing the module, it is </font></font><code>setup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initialized by defining a data frame ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'diabetes'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and a target variable ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Class variable'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> pycaret.classification <span class="hljs-keyword">import</span> *<font></font>
exp1 = setup(diabetes, target = <span class="hljs-string">'Class variable'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/4t/7s/5c/4t7s5cobolttbhe1gmki4b6ifti.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All preprocessing takes place in </font></font><code>setup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Using more than 20 functions to prepare data before machine learning, PyCaret creates a pipeline of transformations based on the parameters defined in the function </font></font><code>setup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It automatically builds all the dependencies in the pipeline, so you do not need to manually control the sequential execution of transformations on a test or new (invisible) dataset. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyCaret pipeline can be easily transferred from one environment to another or deployed to production. Below you can familiarize yourself with the preprocessing features that have been available in PyCaret since the first release.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0f/cc/xm/0fccxmeaenodubzhriw4bwpa7za.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data preprocessing steps are mandatory for machine learning, such as adding missing values, coding quality variables, coding labels (yes or no to 1 or 0) and train-test-split, are performed automatically during initialization </font></font><code>setup()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">You can learn more about preprocessing features in PyCaret </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Comparison of models</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
This is the first step that is recommended to be performed when working with teacher training ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regression</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">This function trains all models in the model library and compares the estimated indicator with each other using cross-validation for K-blocks (10 blocks by default). </font><font style="vertical-align: inherit;">Estimated indicators are used as follows:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For classification: Accuracy, AUC, Recall, Precision, F1, Kappa</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For regression: MAE, MSE, RMSE, R2, RMSLE, MAPE</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/kp/pn/zi/kppnzitajpanlilctfnzzm7igpk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, metrics are evaluated using cross-validation over 10 blocks. </font><font style="vertical-align: inherit;">The number of blocks can be changed by changing the value of the parameter </font></font><code>fold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The default table is sorted by ‚ÄúAccuracy‚Äù from the highest value to the lowest. </font><font style="vertical-align: inherit;">Sorting order can also be changed using the option </font></font><code>sort</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Creating a model</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Creating a model in any PyCaret module is so simple that you just need to write it </font></font><code>create_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The function takes one parameter at the input, i.e. </font><font style="vertical-align: inherit;">model name passed as a string. </font><font style="vertical-align: inherit;">This function returns a table with cross-validated scores and a trained model object.</font></font><br>
<br>
<pre><code class="python hljs">adaboost = create_model(<span class="hljs-string">'ada'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/dr/ff/cz/drffczjopi6oagukjd1ivvmc_ns.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"adaboost"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> stores the object of the trained model, which returns a function </font></font><code>create_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that, under the hood, is a scikit-learn evaluator. </font><font style="vertical-align: inherit;">Access to the source attributes of the trained object can be obtained using the function </font></font><code>period ( . )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">after the variable. </font><font style="vertical-align: inherit;">You can find an example of use below. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n8/0i/o6/n80io6mx9ioxio4dlpr_rzmnosu.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyCaret has over 60 open source ready-to-use algorithms. </font><font style="vertical-align: inherit;">A complete list of evaluators / models available in PyCaret can be found </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Model setup</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The function is </font></font><code>tune_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used to automatically configure machine learning model hyperparameters. </font><font style="vertical-align: inherit;">PyCaret uses</font></font><code>random grid search</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in a specific search space. </font><font style="vertical-align: inherit;">The function returns a table with cross-validated estimates and an object of a trained model.</font></font><br>
<br>
<pre><code class="python hljs">tuned_adaboost = tune_model(<span class="hljs-string">'ada'</span>)
</code></pre><br>
<img src="https://habrastorage.org/webt/cq/iv/7o/cqiv7okcgwfy5k8delxn1si3rco.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function </font></font><code>tune_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in non-teacher learning modules such as </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycaret.nlp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycaret.clustering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pycaret.anomaly</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be used in conjunction with teacher learning modules. For example, the NLP module in PyCaret can be used to adjust a parameter </font></font><code>number of topics</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by evaluating an objective function or loss function from a model with a teacher, such as ‚ÄúAccuracy‚Äù or ‚ÄúR2‚Äù. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Ensemble of models</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The function is </font></font><code>ensemble_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used to create an ensemble of trained models. At the input, it takes one parameter - the object of the trained model. The function returns a table with cross-validated estimates and an object of a trained model.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># creating a decision tree model</span>
dt = create_model(<span class="hljs-string">'dt'</span>)
<span class="hljs-comment"># ensembling a trained dt model</span>
dt_bagged = ensemble_model(dt)</code></pre><br>
<img src="https://habrastorage.org/webt/0o/r5/mu/0or5mup7dxfmgcv9-y68p2l3sjs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The "bagging" method is used when creating the ensemble by default, it can be changed to "boosting" using the parameter </font></font><code>method</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the function </font></font><code>ensemble_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PyCaret also provides functions </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">blend_models</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stack_models</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for combining several trained models. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Model visualization.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
You can evaluate the performance and diagnose a trained machine learning model using the function </font></font><code>plot_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It takes the object of the trained model and the type of graph in the form of a string.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># create a model</span>
adaboost = create_model(<span class="hljs-string">'ada'</span>)
<span class="hljs-comment"># AUC plot</span>
plot_model(adaboost, plot = <span class="hljs-string">'auc'</span>)
<span class="hljs-comment"># Decision Boundary</span>
plot_model(adaboost, plot = <span class="hljs-string">'boundary'</span>)
<span class="hljs-comment"># Precision Recall Curve</span>
plot_model(adaboost, plot = <span class="hljs-string">'pr'</span>)
<span class="hljs-comment"># Validation Curve</span>
plot_model(adaboost, plot = <span class="hljs-string">'vc'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/5p/hz/0p/5phz0p5gmvtj7j8sdam6fysvf0g.png"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you can learn more about visualization in PyCaret. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also use the function </font></font><code>evaluate_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to see graphs using the notebook user interface. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/gb/tj/ukgbtjuzwz7tdvmtyiyqr8urcia.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function </font></font><code>plot_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the module </font></font><code>pycaret.nlp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be used to visualize the body of texts and semantic thematic models. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you can learn more about them. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Interpretation of the model</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
When the data is non-linear, which happens in real life quite often, we invariably see that tree-like models work much better than simple Gaussian models. However, this is due to a loss of interpretability, since tree models do not provide simple coefficients, like linear models. PyCaret implements SHAP (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHapley Additive exPlanations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) using a function </font></font><code>interpret_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e8/52/8o/e8528o1kg29xyzpnwgasm8gwzcw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The interpretation of a particular data point in a test dataset can be estimated using the ‚Äúreason‚Äù graph. In the example below, we test the first instance in the test dataset. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bg/_e/pg/bg_epgl05bfa6z_rpj2ukf5jv5w.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Predictive model</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Up to this point, the results we obtained were based on cross-validation by K-blocks on a training dataset (70% by default). In order to see the forecasts and model performance on the test / hold-out dataset, a function is used </font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/uj/6n/niuj6neaihbbowby4cnyquh4ry8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function is </font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used to forecast an invisible dataset. Now we will use the same dataset that we used for training, as a proxy for the new invisible dataset. In practice, the function</font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be used iteratively, each time on a new invisible dataset. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yv/f5/bu/yvf5bumdb8wefda2ypicpeyqse4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function </font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can also make predictions for a sequential chain of models that can be created using the </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stack_models</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_stacknet functions</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The function </font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can also make predictions directly for models hosted on AWS S3 using the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deploy_model</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. Deploying a model</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
One of the ways to use trained models to create forecasts for a new dataset is to use the function</font></font><code>predict_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the same notebook / IDE where the model was trained. </font><font style="vertical-align: inherit;">However, generating a forecast for a new (invisible) dataset is an iterative process. </font><font style="vertical-align: inherit;">Depending on the use case, the frequency of the forecasts can vary from real-time forecasts to batch predictions. </font><font style="vertical-align: inherit;">The function </font></font><code>deploy_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in PyCaret allows you to deploy the entire pipeline, including the trained model in the cloud from the notebook environment.</font></font><br>
<br>
<pre><code class="python hljs">deploy_model(model = rf, model_name = <span class="hljs-string">'rf_aws'</span>, platform = <span class="hljs-string">'aws'</span>, <font></font>
             authentication =  {<span class="hljs-string">'bucket'</span>  : <span class="hljs-string">'pycaret-test'</span>})
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11. Save the model / save the experiment</font></font><br>
</b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
After training, the entire pipeline containing all the preprocessing transformations and the object of the trained model can be saved in a binary pickle-file.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># creating model</span>
adaboost = create_model(<span class="hljs-string">'ada'</span>)
<span class="hljs-comment"># saving model</span>
save_model(adaboost, model_name = <span class="hljs-string">'ada_for_deployment'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/_m/jr/v0/_mjrv06rsoz7ddfkwoiymasqa9e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also save the entire experiment, containing all the intermediate output, as a single binary file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
save_experiment (experiment_name = 'my_first_experiment') </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/tq/zo/sbtqzonqwkzrqprcwklrvy4kwj0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can load saved models and experiments using the functions </font></font><code>load_model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>load_experiment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">available from all PyCaret modules. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12. Next Guide</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the next guide, we will show how to use the trained machine learning model in Power BI to generate batch predictions in a real production environment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also read notepads for beginners in the following modules:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regression</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clustering</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anomaly Search</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Natural Text Processing (NLP)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Associative rules training</font></font></a></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is a development pipeline?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We are actively working to improve PyCaret. </font><font style="vertical-align: inherit;">Our upcoming development pipeline includes a new time series forecasting module, TensorFlow integration and major PyCaret scalability improvements. </font><font style="vertical-align: inherit;">If you want to share your feedback and help us improve, you can fill out a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">form</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the site or leave a comment on our page on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkedIn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Want to know more about a particular module?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Starting with the first release, PyCaret 1.0.0 has the following modules available for use. </font><font style="vertical-align: inherit;">Follow the links below to familiarize yourself with the documentation and examples of work. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Classification </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regression </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clustering </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anomaly Search </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Natural Text Processing (NLP) </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Associative Rules Training</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Important links</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User Guide / Documentation</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub repository</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install PyCaret</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notebook manual</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyCaret Support</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you liked PyCaret, put us Ô∏è on GitHub. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To hear more about PyCaret, you can follow us on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkedIn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Youtube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Learn more about the course.</font></font><br>
</a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497754/index.html">Job Contest Results or Game of Thrones in the Battle of PS4</a></li>
<li><a href="../en497760/index.html">The philosophy of seclusion: how remote identification helps us out in difficult times</a></li>
<li><a href="../en497762/index.html">IT: To leave and not to return</a></li>
<li><a href="../en497764/index.html">How to prepare the game for porting to PC and console</a></li>
<li><a href="../en497768/index.html">Disinfection automation</a></li>
<li><a href="../en497772/index.html">Development at Wargaming - meeting with Maxim Baryshnikov, Head of Platform (Part II)</a></li>
<li><a href="../en497780/index.html">Three years in Latin America: how I left for a dream and returned after a total ‚Äúreset‚Äù</a></li>
<li><a href="../en497782/index.html">All stages of creating a robot to follow the line, or how to collect all the rakes with STM32</a></li>
<li><a href="../en497784/index.html">HiDC solution for building a modern ICT infrastructure of data centers based on Huawei Enterprise equipment</a></li>
<li><a href="../en497786/index.html">Now a shoemaker with boots, or How we got our own style guide</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>