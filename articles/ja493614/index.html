<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛷️ 🐿️ 👩‍👧‍👧 Keras、TensorFlow、Deep Learningを使用してX線でCOVID-19を検出 🌿 🔷 🤱🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="このガイドの助けを借りて、Keras、TensorFlow、およびディープラーニングの助けを借りて、手動でX線データセットからCOVID-19を自動的に決定する方法を学びます 
 
 他の多くの人と同じように、私はCOVID-19について心から心配しています。私は常に自分の状態を分析しているのに気づ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Keras、TensorFlow、Deep Learningを使用してX線でCOVID-19を検出</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/493614/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/bt/gn/albtgnkhy92l7fzrjmwpm6fdu4o.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドの助けを借りて、Keras、TensorFlow、およびディープラーニングの助けを借りて、手動でX線データセットからCOVID-19を自動的に決定する方法を学びます </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の多くの人と同じように、私はCOVID-19について心から心配しています。</font><font style="vertical-align: inherit;">私は常に自分の状態を分析しているのに気づき、病気にかかるかどうか、いつ発症するのか疑問に思っています。</font><font style="vertical-align: inherit;">そして、私がそれについて心配すればするほど、それは心の痛みを伴うゲームに変わり、症状学は心気症と組み合わされます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は朝起きて、痛みと弱さを感じました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベッドから這い出たとき、鼻水を見つけました（</font><font style="vertical-align: inherit;">鼻水</font><font style="vertical-align: inherit;">がCOVID-19の症状で</font><font style="vertical-align: inherit;">は</font><strong><font style="vertical-align: inherit;">ない</font></strong><font style="vertical-align: inherit;">ことは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既にわかっ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てい</font><font style="vertical-align: inherit;">ます）。</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ペーパースカーフを手に入れるためにトイレに着いた時には、すでに咳き込んでいました。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初はあまり気にしませんでした。花粉にアレルギーがあり、米国の東海岸の暖かい気候のため、この春は早春でした。</font><font style="vertical-align: inherit;">ほとんどの場合、これらはアレルギー症状です。</font><font style="vertical-align: inherit;">しかし、日中、私の状態は改善しませんでした。</font><font style="vertical-align: inherit;">私は座って口の中に温度計を置いてこのマニュアルを書きます。</font><font style="vertical-align: inherit;">私は下を向いて37.4°Cを参照してください。</font><font style="vertical-align: inherit;">私の通常の体温は36.3°Cで、他のものよりわずかに低いです。</font><font style="vertical-align: inherit;">37.2°Cを超えるものはすべて、もう少し暑いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
咳とわずかな熱？</font><font style="vertical-align: inherit;">それはCOVID-19かもしれません...または単に私のアレルギーです。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テストなしで見つけることは不可能であり、まさにこの「無知」が状況を人間のレベルで非常に脅かしています。</font></font></strong><br>
<a name="habracut"></a><br>
<blockquote><img src="https://habrastorage.org/webt/fi/0x/4z/fi0x4z2nhcc3-3bdzugakb4csji.png" align="left"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UFOケア分</font></font></h3><br>
     COVID-19 —     ,   SARS-CoV-2 (2019-nCoV).        —    ,      /,   .<br>
<br>
<h4>        </h4><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">C   </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">C </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ()</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></li>
<li>       </li>
</ul><br>
     ,      .</div></div><br>
 ,  ,       .<br>
<br>
  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> </a></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の恐れにもかかわらず、私は合理的に考えようとします。私は30歳を少し上回っており、体調も良好で、免疫力も強いです。万が一に備えて検疫を行い、休んですべてを処理します。 COVID-19は、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">個人の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康</font><font style="vertical-align: inherit;">の観点から私を怖がらせません</font><font style="vertical-align: inherit;">（少なくとも私はそれを私のために立てます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ですから、すでに病気と診断されたすべての人や老人ホームや病院にいる​​人を含む、私の高齢の親族を心配しています。これらの人々は脆弱であり、COVID-19が原因で亡くなると恐ろしいことになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何もせず、病気が原因で家にいることを許さずに（アレルギー、COVID-19、または恐れ）、私はできることを行うことにしました。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コードを書いて実験を行い、実践的な例を使用して、コンピュータビジョンとディープラーニングの使い方を他の人に教えます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは</font><font style="vertical-align: inherit;">私が書い</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も科学的な記事で</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">ない</font></i><font style="vertical-align: inherit;">ことをすぐに言わなければなり</font><font style="vertical-align: inherit;">ません。</font><font style="vertical-align: inherit;">彼女はまったく科学的ではない。</font><font style="vertical-align: inherit;">使用されるメソッドとデータセットは</font><font style="vertical-align: inherit;">公開する価値</font><font style="vertical-align: inherit;">があり</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ません</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、それらは少なくとも</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何かを</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">助け</font><font style="vertical-align: inherit;">たい人のための出発点として</font><font style="vertical-align: inherit;">役立ちます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はあなたとこのコミュニティについて心配しています。</font><font style="vertical-align: inherit;">私ができることを支援したいと思います。この記事は、困難な時代に精神的に対処し、同様の状況で他の人を支援するための私の方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドでは、次のことを学びます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COVID-19が検出された患者のX線画像のオープンソースデータセットを収集する方法。</font></font></li>
<li>   «» (  )    .</li>
<li>      COVID-19      .</li>
<li>      .</li>
</ol><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これについては、既にほのめかしましたが、ここで直接言います。</font><font style="vertical-align: inherit;">ここで説明する手法は、教育目的のみを目的としています。</font><font style="vertical-align: inherit;">これは、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ない</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">厳密な科学的研究、それは雑誌に発表されることはありません。</font><font style="vertical-align: inherit;">この記事は、コンピュータビジョンとディープラーニングに興味があり、実際に学びたい読者、および現在の出来事に触発された読者を対象としています。</font><font style="vertical-align: inherit;">これらすべてを考慮に入れてください。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マニュアルの最初の部分では、肺のX線でCOVID-19を検出する方法について説明します。</font><font style="vertical-align: inherit;">次に、データセット自体について説明します。</font><font style="vertical-align: inherit;">次に、KerasとTensorFlowを使用してモデルをトレーニングし、画像内のCOVID-19を予測する方法を示します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></h3><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このCOVID-19自動検出の記事は、教育目的でのみ作成されています。</font></font></strong><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">信頼できる正確な診断システムCOVID-19について</font></strong></font><i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></strong></i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明し</font></font></strong><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">て</font></strong><i><strong><font style="vertical-align: inherit;">いません</font></strong></i><strong><font style="vertical-align: inherit;">。専門家からも学問的な観点からもテストされていません。</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私の目標は、インスピレーションを与え、コンピュータビジョンとディープラーニングの研究を、医学分野でこの知識を応用して、世界にどのように大きな影響を与えることができるかを示すことです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想像してみてください</font><font style="vertical-align: inherit;">。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医学に影響を与えるのに医学教育は必要ありません</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。今日、ディープトレーニングの専門家は医師や他の医師と緊密に協力して複雑な問題を解決し、命を救い、世界をより良い場所にしています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私のリーダーシップがそうするように促してくれることを願っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これらすべてを考慮すると、研究者、ジャーナルのキュレーター、およびレビューシステムは、疑わしい品質のCOVID-19予測モデルを説明する研究ですでに過負荷になっています。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事のコードやモデルをジャーナルや科学出版物に送らないでください</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><strong><font style="vertical-align: inherit;">混乱を増すだけ</font></strong><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、この記事（またはCOVID-19に関する他の出版物）に基づいて研究を行いたい場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測モデルを説明するためにTRIPODガイドを使用してください。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ご理解のとおり、医療分野での人工知能の使用は非常に深刻な結果をもたらす可能性があります。そのようなモデルを公開して使用するのは、あなたが医療専門家である場合、またはそのような専門家から詳細なアドバイスを受けた場合のみにしてください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X線でCOVID-19を検出するにはどうすればよいですか？</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/8bd/a46/dbb8bda4650156ba71b79b0db4309738.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図1：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19と診断された患者のX線の例。</font><font style="vertical-align: inherit;">これらの画像では、KerasとTensorFlowを使用して分類子を教え、COVID-19を決定できます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19のテストは今や困難です-</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">十分なテスト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はあり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ません</font></a><font style="vertical-align: inherit;">が、迅速に作成することは不可能であり、パニックを増加させるだけです。</font><font style="vertical-align: inherit;">そして、パニックの状況では、他人に金を払い、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">偽のテストを売ろ</font></a><font style="vertical-align: inherit;">うとして</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いる悪ふざけが現れ、ソーシャルネットワークやインスタントメッセンジャーで騙されやすい犠牲者を見つけます。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストの数が限られているため、他の診断方法に依存する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
医師がX線とコンピューター断層撮影の結果を使用して肺炎、肺の炎症、膿瘍、リンパ節腫大を診断するため、私はX線を研究することにしました。ウイルスは気道を覆う上皮細胞を攻撃するため、X線を使用して人間の肺の状態を調べることができます。 X線装置はほとんどどこにでもあるため、画像を使用すると、</font><font style="vertical-align: inherit;">テストキット</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なしで</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 </font><i><font style="vertical-align: inherit;">を</font></i><font style="vertical-align: inherit;">検出できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法の不利な点は、放射線科医の必要性、ならびにかなりの処理時間を含む。そして、人々が世界中で病気になったとき、時間は特に高価です。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">医師の時間を節約するには、自動分析システムを作成する必要があります</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：</font></font></strong></i><i>    ,   ,    COVID-19    .        .  ,  </i><i><strong></strong></i><i> ,  ,   ,     COVID-19,   .</i><br>
<br>
<h3>    COVID-19</h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e99/03e/e2a/e9903ee2a07ec44819bb4821671401fa.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2：</font></font></strong></i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左側は陽性の結果（感染した）の写真、右側は陰性の写真です。</font><font style="vertical-align: inherit;">これらの画像では、TensorFlowとKerasを使用してCOVID-19（つまり、コロナウイルスに起因する疾患）の存在を自動的に予測するモデルを教えます。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで使用されるCOVID-19で使用される患者画像のデータセットは</font><font style="vertical-align: inherit;">、モントリオール大学の大学院生である</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジョセフコーエン博士</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の監督の下で編集されました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">数日前、コーエンはCOVID-19の患者のX線画像の収集を開始</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、GitHubリポジトリに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アップロードし</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました。</font></a><font style="vertical-align: inherit;">そこでは、この病気だけでなく、MERS、SARS、ARDSの例も見つかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データセットを作成するにはI：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リポジトリからmetadata.csvファイルを解析します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての行を選択しました：</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
合計で、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25のショットが</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">得られた</font><strong><font style="vertical-align: inherit;">COVID-19に陽性の結果を</font></strong><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">健康な人の写真を選んでください。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これを行うために、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カグルの肺のX線データセット（肺炎）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を取り、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25人の健康な人の画像</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を選択しました</font><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図2</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">右</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。このデータセットには、ラベルの塗りつぶしが不適切または不適切であることなど、いくつかの欠点がありますが、COVID-19検出器の仮説をテストするための出発点として適しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50枚のショット</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を取得</font><font style="vertical-align: inherit;">しました。COVID-19の患者25人と健康な患者25人です。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><strong><font style="vertical-align: inherit;">リンク</font></strong></a></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からデータセットをダウンロードできます</font></font></strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><strong><font style="vertical-align: inherit;"></font></strong></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さらに、データセットの生成に使用したPythonスクリプトを追加しましたが、この記事ではそれらを考慮しませんでした。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトの構造</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードとデータをダウンロードします。</font><font style="vertical-align: inherit;">そこからファイルを取り出すと、次のディレクトリ構造になります。</font></font><br>
<br>
<pre><code class="python hljs">$ tree --dirsfirst --filelimit <span class="hljs-number">10</span><font></font>
.<font></font>
├── dataset<font></font>
│   ├── covid [<span class="hljs-number">25</span> entries]<font></font>
│   └── normal [<span class="hljs-number">25</span> entries]<font></font>
├── build_covid_dataset.py<font></font>
├── sample_kaggle_dataset.py<font></font>
├── train_covid19.py<font></font>
├── plot.png<font></font>
└── covid19.model<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つのディレクトリ、5つのファイル。</font><font style="vertical-align: inherit;">データセットはdataset /ディレクトリにあり、covid /とnormal /の2つのクラスに分かれています。</font><font style="vertical-align: inherit;">以下では、COVID-19検出器をトレーニングするtrain_covid19.pyスクリプトを確認します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニングスクリプトの実装</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keras、TensorFlow、およびディープラーニングを使用してCOVID-19を自動的に診断する畳み込みニューラルネットワークの微調整に進みましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
train_covid19.pyファイルを開き、次のコードを貼り付けます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># import the necessary packages</span>
<span class="hljs-keyword">from</span> tensorflow.keras.preprocessing.image <span class="hljs-keyword">import</span> ImageDataGenerator
<span class="hljs-keyword">from</span> tensorflow.keras.applications <span class="hljs-keyword">import</span> VGG16
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> AveragePooling2D
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dropout
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Flatten
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model
<span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam
<span class="hljs-keyword">from</span> tensorflow.keras.utils <span class="hljs-keyword">import</span> to_categorical
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> LabelBinarizer
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> classification_report
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> confusion_matrix
<span class="hljs-keyword">from</span> imutils <span class="hljs-keyword">import</span> paths
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> cv2
<span class="hljs-keyword">import</span> os
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このスクリプトは、tensorflow.kerasインポートを選択することにより、TensorFlow 2.0およびKerasライブラリの機能を利用します。</font><font style="vertical-align: inherit;">また、以下を使用します。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scikit-learn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これは</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事実上の</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Python機械学習ライブラリです。</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャート用の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">matplotlib</font></a><font style="vertical-align: inherit;">、</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセット内の画像をアップロードして前処理するための</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">OpenCV</font></a><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TensorFlow 2.0（scikit-learn、OpenCV、matplotlibを含む）のインストール方法については、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubuntu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macOSの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チュートリアルをご覧ください</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、コマンドラインの引数を解析し、ハイパーパラメーターを初期化します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># construct the argument parser and parse the arguments</span><font></font>
ap = argparse.ArgumentParser()<font></font>
ap.add_argument(<span class="hljs-string">"-d"</span>, <span class="hljs-string">"--dataset"</span>, required=<span class="hljs-literal">True</span>,<font></font>
    help=<span class="hljs-string">"path to input dataset"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-p"</span>, <span class="hljs-string">"--plot"</span>, type=str, default=<span class="hljs-string">"plot.png"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
ap.add_argument(<span class="hljs-string">"-m"</span>, <span class="hljs-string">"--model"</span>, type=str, default=<span class="hljs-string">"covid19.model"</span>,<font></font>
    help=<span class="hljs-string">"path to output loss/accuracy plot"</span>)<font></font>
args = vars(ap.parse_args())<font></font>
<font></font>
<span class="hljs-comment"># initialize the initial learning rate, number of epochs to train for,</span>
<span class="hljs-comment"># and batch size</span>
INIT_LR = <span class="hljs-number">1e-3</span>
EPOCHS = <span class="hljs-number">25</span>
BS = <span class="hljs-number">8</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3つの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドライン引数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24-31行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）には、次のものが含まれます。</font></font><br>
<br>
<ul>
<li><code>--dataset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：入力データセットへのパス。</font></font></li>
<li><code>--plot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：学習履歴の終了スケジュールへのオプションのパス。</font><font style="vertical-align: inherit;">コマンドラインで別の名前を指定しない限り、デフォルトでは、グラフはplot.pngと呼ばれます。</font></font></li>
<li><code>--model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：出力COVID-19定義モデルへのオプションのパス。</font><font style="vertical-align: inherit;">デフォルトでは、covid19.modelと呼ばれます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、初期学習頻度、トレーニング期間の数、およびパケットサイズハイパー</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を初期化します（</font><strong><font style="vertical-align: inherit;">35〜37行目</font></strong><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、X線をダウンロードして前処理します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># grab the list of images in our dataset directory, then initialize</span>
<span class="hljs-comment"># the list of data (i.e., images) and class images</span>
print(<span class="hljs-string">"[INFO] loading images..."</span>)<font></font>
imagePaths = list(paths.list_images(args[<span class="hljs-string">"dataset"</span>]))<font></font>
data = []<font></font>
labels = []<font></font>
<font></font>
<span class="hljs-comment"># loop over the image paths</span>
<span class="hljs-keyword">for</span> imagePath <span class="hljs-keyword">in</span> imagePaths:
    <span class="hljs-comment"># extract the class label from the filename</span>
    label = imagePath.split(os.path.sep)[<span class="hljs-number">-2</span>]<font></font>
<font></font>
    <span class="hljs-comment"># load the image, swap color channels, and resize it to be a fixed</span>
    <span class="hljs-comment"># 224x224 pixels while ignoring aspect ratio</span><font></font>
    image = cv2.imread(imagePath)<font></font>
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)<font></font>
    image = cv2.resize(image, (<span class="hljs-number">224</span>, <span class="hljs-number">224</span>))<font></font>
<font></font>
    <span class="hljs-comment"># update the data and labels lists, respectively</span><font></font>
    data.append(image)<font></font>
    labels.append(label)<font></font>
<font></font>
<span class="hljs-comment"># convert the data and labels to NumPy arrays while scaling the pixel</span>
<span class="hljs-comment"># intensities to the range [0, 1]</span>
data = np.array(data) / <span class="hljs-number">255.0</span><font></font>
labels = np.array(labels)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データをロードするために、--datasetディレクトリ内の画像へのすべてのパス（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を取得し、次に各imagePathを取得します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パス（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">49行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）からクラスラベル（covidまたはnormal）</font><font style="vertical-align: inherit;">を抽出し</font><font style="vertical-align: inherit;">ます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像を読み込み、RGBチャネルに変換し、224x224ピクセルのサイズに縮小して、畳み込みニューラルネットワークにフィードします（53〜55 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データとラベルのリストの更新（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58行目と59行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ピクセル強度を範囲にスケーリングし</font></font><code>[0, 1]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、データとラベルをNumPy配列形式に変換します（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行63および64</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ラベルのワンホットコーディングを実行し、データセットをトレーニングセットとテストセットに分割します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># perform one-hot encoding on the labels</span><font></font>
lb = LabelBinarizer()<font></font>
labels = lb.fit_transform(labels)<font></font>
labels = to_categorical(labels); print(labels)<font></font>
<font></font>
<span class="hljs-comment"># partition the data into training and testing splits using 80% of</span>
<span class="hljs-comment"># the data for training and the remaining 20% for testing</span><font></font>
(trainX, testX, trainY, testY) = train_test_split(data, labels,<font></font>
    test_size=<span class="hljs-number">0.20</span>, stratify=labels, random_state=<span class="hljs-number">42</span>)<font></font>
<font></font>
<span class="hljs-comment"># initialize the training data augmentation object</span><font></font>
trainAug = ImageDataGenerator(<font></font>
    rotation_range=<span class="hljs-number">15</span>,<font></font>
    fill_mode=<span class="hljs-string">"nearest"</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユニタリーラベルコーディングは</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">67〜69行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で実行され</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。データは次の形式で表示されます。</font></font><br>
<br>
<pre><code class="python hljs">[[<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 [<span class="hljs-number">0.</span> <span class="hljs-number">1.</span>]<font></font>
 ...<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]<font></font>
 [<span class="hljs-number">1.</span> <span class="hljs-number">0.</span>]]
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法でエンコードされた各ラベルは、要素の1つが「ホット」（1）で、もう1つが「ノー」（0）である2要素の配列で構成されます。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライン73及び74、</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">訓練のための80％、試験のために20％：データセットは2つの部分に分割されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モデルを一般化するために</font><font style="vertical-align: inherit;">、ランダムな画像回転を時計回りに15度に設定するか、それを逆にして、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ拡張</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（データ拡張）</font><font style="vertical-align: inherit;">を実行し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。拡張生成オブジェクトは</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">77-79行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目で初期化され</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VGGNetモデルを初期化し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微調整の</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために準備し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># load the VGG16 network, ensuring the head FC layer sets are left</span>
<span class="hljs-comment"># off</span>
baseModel = VGG16(weights=<span class="hljs-string">"imagenet"</span>, include_top=<span class="hljs-literal">False</span>,<font></font>
    input_tensor=Input(shape=(<span class="hljs-number">224</span>, <span class="hljs-number">224</span>, <span class="hljs-number">3</span>)))<font></font>
<font></font>
<span class="hljs-comment"># construct the head of the model that will be placed on top of the</span>
<span class="hljs-comment"># the base model</span><font></font>
headModel = baseModel.output<font></font>
headModel = AveragePooling2D(pool_size=(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>))(headModel)<font></font>
headModel = Flatten(name=<span class="hljs-string">"flatten"</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">64</span>, activation=<span class="hljs-string">"relu"</span>)(headModel)<font></font>
headModel = Dropout(<span class="hljs-number">0.5</span>)(headModel)<font></font>
headModel = Dense(<span class="hljs-number">2</span>, activation=<span class="hljs-string">"softmax"</span>)(headModel)<font></font>
<font></font>
<span class="hljs-comment"># place the head FC model on top of the base model (this will become</span>
<span class="hljs-comment"># the actual model we will train)</span><font></font>
model = Model(inputs=baseModel.input, outputs=headModel)<font></font>
<font></font>
<span class="hljs-comment"># loop over all layers in the base model and freeze them so they will</span>
<span class="hljs-comment"># *not* be updated during the first training process</span>
<span class="hljs-keyword">for</span> layer <span class="hljs-keyword">in</span> baseModel.layers:<font></font>
    layer.trainable = <span class="hljs-literal">False</span>
</code></pre><br><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライン83及び84</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、VGG16ニューラルネットワークのインスタンスが完全に接続層なしImageNetに予め得られた重みを使用して作成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、我々はPOOL =&gt; FC = SOFTMAX層（からなる完全に接続されたレイヤが作成されます</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">線88-93</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）及びVGG16（の上に場所を</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライン97</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、CONVウェイトをフリーズして</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全に接続されたレイヤー</font><i><font style="vertical-align: inherit;">のみ</font></i><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">トレーニングされるようにします</font><font style="vertical-align: inherit;">（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">101-102行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。これで調整は終了です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、ディープラーニングモデルをコンパイルしてトレーニングする準備ができました。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compile our model</span>
print(<span class="hljs-string">"[INFO] compiling model..."</span>)<font></font>
opt = Adam(lr=INIT_LR, decay=INIT_LR / EPOCHS)<font></font>
model.compile(loss=<span class="hljs-string">"binary_crossentropy"</span>, optimizer=opt,<font></font>
    metrics=[<span class="hljs-string">"accuracy"</span>])<font></font>
<font></font>
<span class="hljs-comment"># train the head of the network</span>
print(<span class="hljs-string">"[INFO] training head..."</span>)<font></font>
H = model.fit_generator(<font></font>
    trainAug.flow(trainX, trainY, batch_size=BS),<font></font>
    steps_per_epoch=len(trainX) // BS,<font></font>
    validation_data=(testX, testY),<font></font>
    validation_steps=len(testX) // BS,<font></font>
    epochs=EPOCHS)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
では</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライン106-108</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンパイルネットワーク</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">減衰スピードトレーニング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とアダム・オプティマイザ。これが2クラスの分類タスクであることを考えると、カテゴリクロスエントロピー（カテゴリクロスエントロピー）ではなく、バイナリクロスエントロピー（binary_crossentropy）の損失関数を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングを開始するには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">fit_generator</font></a><font style="vertical-align: inherit;">を呼び出し</font><font style="vertical-align: inherit;">、データオブジェクト拡張（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">112〜117 </font></a></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を介してX線を与えます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、モデルを評価してみましょう。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># make predictions on the testing set</span>
print(<span class="hljs-string">"[INFO] evaluating network..."</span>)<font></font>
predIdxs = model.predict(testX, batch_size=BS)<font></font>
<font></font>
<span class="hljs-comment"># for each image in the testing set we need to find the index of the</span>
<span class="hljs-comment"># label with corresponding largest predicted probability</span>
predIdxs = np.argmax(predIdxs, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-comment"># show a nicely formatted classification report</span>
print(classification_report(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs,<font></font>
    target_names=lb.classes_))<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、最初にテストスイートに基づいて予測を実行し、予測インデックスを取得します（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">121〜125行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">次に、scikit-learnユーティリティを使用して、分類レポート（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128行目と129行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を生成して表示します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、将来の統計的推定のために混同行列を計算します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># compute the confusion matrix and and use it to derive the raw</span>
<span class="hljs-comment"># accuracy, sensitivity, and specificity</span>
cm = confusion_matrix(testY.argmax(axis=<span class="hljs-number">1</span>), predIdxs)<font></font>
total = sum(sum(cm))<font></font>
acc = (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]) / total<font></font>
sensitivity = cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] / (cm[<span class="hljs-number">0</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>])<font></font>
specificity = cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] / (cm[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>] + cm[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>])<font></font>
<font></font>
<span class="hljs-comment"># show the confusion matrix, accuracy, sensitivity, and specificity</span><font></font>
print(cm)<font></font>
print(<span class="hljs-string">"acc: {:.4f}"</span>.format(acc))<font></font>
print(<span class="hljs-string">"sensitivity: {:.4f}"</span>.format(sensitivity))<font></font>
print(<span class="hljs-string">"specificity: {:.4f}"</span>.format(specificity))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはここにいる：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不正確なマトリックスを生成する（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">133行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この行列を使用して、精度、感度、および特異度を決定し（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">135〜137行目</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、次に、これらのすべてのメトリック（</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行141-143</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を導出します</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、後続の分析のために、精度と損失の変化の履歴をファイルにグラフ形式で表示します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># plot the training loss and accuracy</span><font></font>
N = EPOCHS<font></font>
plt.style.use(<span class="hljs-string">"ggplot"</span>)<font></font>
plt.figure()<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"loss"</span>], label=<span class="hljs-string">"train_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_loss"</span>], label=<span class="hljs-string">"val_loss"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"accuracy"</span>], label=<span class="hljs-string">"train_acc"</span>)<font></font>
plt.plot(np.arange(<span class="hljs-number">0</span>, N), H.history[<span class="hljs-string">"val_accuracy"</span>], label=<span class="hljs-string">"val_acc"</span>)<font></font>
plt.title(<span class="hljs-string">"Training Loss and Accuracy on COVID-19 Dataset"</span>)<font></font>
plt.xlabel(<span class="hljs-string">"Epoch #"</span>)<font></font>
plt.ylabel(<span class="hljs-string">"Loss/Accuracy"</span>)<font></font>
plt.legend(loc=<span class="hljs-string">"lower left"</span>)<font></font>
plt.savefig(args[<span class="hljs-string">"plot"</span>])
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、tf.keras分類子モデルをディスクにシリアル化します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment"># serialize the model to disk</span>
print(<span class="hljs-string">"[INFO] saving COVID-19 detector model..."</span>)<font></font>
model.save(args[<span class="hljs-string">"model"</span>], save_format=<span class="hljs-string">"h5"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KerasとTensorFlowで検出器をトレーニングします</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
train_covid19.pyスクリプトの実装後、自動検出器をトレーニングできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースコード、データセット、事前トレーニング済みモデルをダウンロードします。</font><font style="vertical-align: inherit;">ターミナルを開き、コマンドを実行して検出器をトレーニングします。</font></font><br>
<br>
<pre><code class="python hljs">$ python train_covid19.py --dataset dataset<font></font>
[INFO] loading images...<font></font>
[INFO] compiling model...<font></font>
[INFO] training head...<font></font>
Epoch <span class="hljs-number">1</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">20</span>s <span class="hljs-number">4</span>s/step - loss: <span class="hljs-number">0.7169</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.6590</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">2</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">86</span>ms/step - loss: <span class="hljs-number">0.8088</span> - accuracy: <span class="hljs-number">0.4250</span> - val_loss: <span class="hljs-number">0.6112</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">3</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.6809</span> - accuracy: <span class="hljs-number">0.5500</span> - val_loss: <span class="hljs-number">0.6054</span> - val_accuracy: <span class="hljs-number">0.5000</span>
Epoch <span class="hljs-number">4</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">100</span>ms/step - loss: <span class="hljs-number">0.6723</span> - accuracy: <span class="hljs-number">0.6000</span> - val_loss: <span class="hljs-number">0.5771</span> - val_accuracy: <span class="hljs-number">0.6000</span><font></font>
...<font></font>
Epoch <span class="hljs-number">22</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3271</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2902</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">23</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">0</span>s <span class="hljs-number">99</span>ms/step - loss: <span class="hljs-number">0.3634</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2690</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">24</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">27</span>s <span class="hljs-number">5</span>s/step - loss: <span class="hljs-number">0.3175</span> - accuracy: <span class="hljs-number">0.9250</span> - val_loss: <span class="hljs-number">0.2395</span> - val_accuracy: <span class="hljs-number">0.9000</span>
Epoch <span class="hljs-number">25</span>/<span class="hljs-number">25</span>
<span class="hljs-number">5</span>/<span class="hljs-number">5</span> [==============================] - <span class="hljs-number">1</span>s <span class="hljs-number">101</span>ms/step - loss: <span class="hljs-number">0.3655</span> - accuracy: <span class="hljs-number">0.8250</span> - val_loss: <span class="hljs-number">0.2522</span> - val_accuracy: <span class="hljs-number">0.9000</span><font></font>
[INFO] evaluating network...<font></font>
              precision    recall  f1-score   support<font></font>
<font></font>
       covid       <span class="hljs-number">0.83</span>      <span class="hljs-number">1.00</span>      <span class="hljs-number">0.91</span>         <span class="hljs-number">5</span>
      normal       <span class="hljs-number">1.00</span>      <span class="hljs-number">0.80</span>      <span class="hljs-number">0.89</span>         <span class="hljs-number">5</span><font></font>
<font></font>
    accuracy                           <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
   macro avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span>
weighted avg       <span class="hljs-number">0.92</span>      <span class="hljs-number">0.90</span>      <span class="hljs-number">0.90</span>        <span class="hljs-number">10</span><font></font>
<font></font>
[[<span class="hljs-number">5</span> <span class="hljs-number">0</span>]<font></font>
 [<span class="hljs-number">1</span> <span class="hljs-number">4</span>]]<font></font>
acc: <span class="hljs-number">0.9000</span>
sensitivity: <span class="hljs-number">1.0000</span>
specificity: <span class="hljs-number">0.8000</span>
[INFO] saving COVID<span class="hljs-number">-19</span> detector model...
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動X線診断</font></font></h3><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この部分では、COVID-19を決定する問題を「解決」しません。それは現在の状況の文脈で、そして教育目的のためだけに書かれています。これは、コンピュータビジョンとディープラーニングの実用的なアプリケーションの例です。これにより、通常の精度、感度、特異度（および医療データを操作するときに考慮しなければならないトレードオフ）を含むさまざまなメトリックに慣れることができます。繰り返しますが、</font><font style="vertical-align: inherit;">COVID-19を決定</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題は</font><strong><font style="vertical-align: inherit;">解決していません</font></strong><font style="vertical-align: inherit;">。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
したがって、私たちの自動検出器は、</font><font style="vertical-align: inherit;">X線画像の</font><font style="vertical-align: inherit;">サンプル</font><i><font style="vertical-align: inherit;">のみ</font></i><font style="vertical-align: inherit;">で</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">約90〜92％の</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精度を示しました</font><font style="vertical-align: inherit;">。それ以外の情報は、地理的位置など、人口密度、を含む、モデルを訓練するために使用されなかった</font><font style="vertical-align: inherit;">
我々はまた、受信します</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100％の感度</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80％の特異性</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、手段。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">患者の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持つ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19（真の陽性症例）、モデルを使用して、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々は正確症例の100％において「COVID-19陽性」として同定することができました。</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデルを使用し</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">て</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19 </font><i><font style="vertical-align: inherit;">がなかっ</font></i><font style="vertical-align: inherit;">た患者</font><font style="vertical-align: inherit;">（真の陰性症例）のうち、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80％の症例でのみ「COVID-19陰性」と正確に特定できました。</font></font></strong></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニング履歴グラフが示すよう</font><font style="vertical-align: inherit;">に、トレーニングデータのサイズが</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に小さい</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にもかかわらず、ニューラルネットワークは再トレーニングされません</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/566/c90/eb8/566c90eb8e4b35dd1d5c5293e90084f6.png"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この精度と損失のグラフは、モデルが再学習されていないことを示しています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
COVID-19の検出時に100％の精度を達成したことは素晴らしいことです。ただし、本当に陰性の場合の状況は恥ずかしいです。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際に「COVID-19陽性」である人を「COVID-19陰性」に帰属させたくありません。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私たちは病気の患者が家や家族や友人に帰ることを許したくなく、病気のさらなる拡大に貢献したいと思っています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また</font><font style="vertical-align: inherit;">、偽陽性のケースのシェアについて</font><font style="vertical-align: inherit;">も</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に注意</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する必要があり</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。誰かを病気と誤って数えたり、他の患者と隔離して感染させたりしたくないのです</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感度と特異度のバランスを見つける-</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特に薬の場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">感染症の急速な拡大の場合</font><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">、非常に困難な</font></i><font style="vertical-align: inherit;">作業</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
医療用コンピュータービジョンとディープラーニングについて言えば、予測モデルの作業は非常に深刻な結果をもたらす可能性があることを常に覚えておく必要があり</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
繰り返しますが、この記事の結果は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教育目的でのみ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供さ</font><i><font style="vertical-align: inherit;">れています</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これはジャーナル出版物ではありません。このデータは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、予測モデルの発行に関するTRIPOD</font></a><font style="vertical-align: inherit;">基準</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を</font></a><font style="vertical-align: inherit;">満たしていません</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制限、改善およびさらなる作業</font></font></h3><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/032/a41/702032a4173717d7cc9fddb00d67ee27.jpg"></div><br>
<i><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図4：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日、AIとディープラーニングの専門家は、自動画像認識システムを効果的にトレーニングするための高品質のCOVID-19データを欠いています。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
このマニュアルで説明する方法の主な制限の1つはデータです。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> COVID-19検出器をトレーニングするのに十分な（信頼できる）データがありません。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
病院はすでにこのウイルスの多くの病歴を持っていますが、プライバシーと人権を考えると、医用画像から高品質のデータセットをすばやく組み立てることはさらに困難になります。今後12〜18か月で、より質の高いデータが得られると思います。しかし、今のところ、あなたはあなたが持っているものを使わなければなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンピュータビジョンとディープラーニングの使用に興味がある人のために、限られた時間とリソースの条件でこのガイドを書くように（自分の肉体的および精神的条件を考慮して）試しました。しかし</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、私はプロの医者ではない</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こと</font><strong><font style="vertical-align: inherit;">を</font></strong><font style="vertical-align: inherit;">思い出さ</font><strong><font style="vertical-align: inherit;">せてください</font></strong><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
COVID-19検出器を実際に使用するには、</font><font style="vertical-align: inherit;">ディープラーニングの専門家と協力して実際の医師</font><font style="vertical-align: inherit;">が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">厳密に</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テスト</font><font style="vertical-align: inherit;">する必要が</font><font style="vertical-align: inherit;">あります。私が説明した方法はこれには適していません。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに、モデルが正確に「学習」することに注意する必要があります。</font></font></strong><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Grad-CAMのマニュアルで</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
書いたように</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モデルはCOVID-19に関連しないパターンを学習する可能性が高いですが、2つのデータサンプル（つまり、陽性診断と陰性診断）を区別できるだけです。当社の検出器の結果は、医師によって厳密にテストおよびチェックされる必要があります。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして最後に、将来の（そしてより高度な）検出器はマルチモーダルになります。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
現在は、視覚データ（X線）のみを使用しています。より良い検出器は、他のデータを使用する必要があります：患者のバイタルインジケーター、人口密度、地理的位置など。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常、このような作業には視覚データだけでは不十分です</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらの理由から、私は再度強調したいと思います。このガイドはトレーニング資料の役割を果たすだけであり、信頼できるCOVID-19検出器とは見なされません。</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたまたは誰かがCOVID-19に近いと思う場合は、医療システムの推奨事項に従ってください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドがお役に立てば幸いです。</font><font style="vertical-align: inherit;">また、コンピュータービジョンとディープラーニングを使用してCOVID-19を自動的に決定する方法を探すための出発点となることを期待しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このガイドでは、Keras、TensorFlow、およびディープラーニングを使用して、X線データセットにCOVID-19自動検出器を作成する方法を学びました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日（まだ）この病気の高品質で検証済みの画像データセットはないため</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Joseph Cohenリポジトリ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用する必要があり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは彼の</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データセット</font><strong><font style="vertical-align: inherit;">から25枚の画像を取得し</font></strong><font style="vertical-align: inherit;">、明確に診断された症例の前後の投影に限定しました。</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Kaggle Chest X-Ray Images（Pneumonia）データセット</font></a><font style="vertical-align: inherit;">から</font><strong><font style="vertical-align: inherit;">健康な人の25枚の写真を撮りました</font></strong></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、KerasとTensorFlowの助けを借りて、COVID-19検出器をトレーニングしました。COVID-19検出器は、</font><font style="vertical-align: inherit;">テストサンプルで</font><font style="vertical-align: inherit;">90〜92 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％の精度</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を示し、</font><font style="vertical-align: inherit;">感度は100％、特異度は80％（小さなデータセット）でした。</font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで説明する検出器は、教育目的のみであることを覚えておいてください（本文の注を参照）。</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は、ディープラーニングを使用するように他の人々に刺激を与え、コンピュータビジョンとの組み合わせが</font><font style="vertical-align: inherit;">私たちの生活に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大きな影響を与える</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能性があることを示したかったの</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
楽しんでいただけたでしょうか。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja493596/index.html">急いでいなかった男</a></li>
<li><a href="../ja493598/index.html">電話番号の一部を非表示にする</a></li>
<li><a href="../ja493604/index.html">3月23日から29日までのモスクワでのデジタルイベント</a></li>
<li><a href="../ja493606/index.html">サイバーパンクで味わうクラウドサービスの歴史</a></li>
<li><a href="../ja493610/index.html">DispmanX APIを使用してRaspberry Piでビデオレイヤーをプログラミングする</a></li>
<li><a href="../ja493616/index.html">箱のような写真-中には何がありますか？Yandexでのレポート</a></li>
<li><a href="../ja493618/index.html">（ない）TwitterのOSINTは明らか</a></li>
<li><a href="../ja493620/index.html">ロジスティック曲線。流行はいつ終わりますか？</a></li>
<li><a href="../ja493622/index.html">AngularにRetrowaveを書き込む</a></li>
<li><a href="../ja493626/index.html">Selenoid-何百もの並列UIテストを簡単かつ高速に。パベル・セニン</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>