<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëãüèº ü•ë üí≠ Information Security Automated incident response platform üê∞ üë©üèæ‚Äçüé§ üç≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine a typical situation center for information security in a large company. In an ideal world, software detects suspicious activity, and the team ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Information Security Automated incident response platform</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/technoserv/blog/491384/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagine a typical situation center for information security in a large company. In an ideal world, software detects suspicious activity, and the team of "white hackers" begins to tap their hands on the keyboard. And this happens once a month. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the real world, these are hundreds of false positives and tired support staff. They are forced to deal with each incident when the user has forgotten the password, can not download the game from a torrent, another porn movie in * .exe format, watch the network failures and generally investigate many situations.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIEM systems help organize and correlate events from sources. </font><font style="vertical-align: inherit;">And they generate positives, each of which needs to be dealt with. </font><font style="vertical-align: inherit;">Of these "everyone", the majority are false. </font><font style="vertical-align: inherit;">You can approach the issue on the other hand, having scripts for alarm processing. </font><font style="vertical-align: inherit;">Each time something works, it would be nice to have not just the cause of the alarm, and then climb into four to five systems for different data, and immediately automatically collect the entire diagnosis. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/i6/gj/ori6gjl5xpbbuxru9bq5ehubcwg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We made such an add-on, and it helped a lot to reduce the load on operators. </font><font style="vertical-align: inherit;">Because the scripts for collecting information are immediately launched, and if there are typical actions, they are immediately taken. </font><font style="vertical-align: inherit;">That is, if you start the system ‚Äúin such a situation, we do this and that‚Äù, then the card will open for the operator with the situation already worked out.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is wrong with SIEM systems?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The list of offsets is heavily overloaded with raw data. A specific incident card for filling is transferred to our platform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typical cases have sample reaction flowcharts. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, for example, data analysis reports about user authentication errors:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oe/uw/hq/oeuwhq0v0ztuc1w5o33gnwymxzq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are criteria for false positives: for example, I tried it twice - I went in from the third. The user just receives a letter saying that the password must be typed carefully, the ticket closes. If he tried five or six times, then detailed information is already beginning to gather: what happened next, what happened before, and so on. If he logged in the 10th time, and then went to the knowledge base and started downloading 10 files, then there may be a setting to ‚Äúblock access to the knowledge base until the end of the proceedings and notify the operator‚Äù. Most likely, if the user is not malicious, in this case the IT department will automatically receive an email with the details. Perhaps they will teach the user to enter the password correctly or help to change it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the activity is more dangerous, the level ‚Äúopened the executable file in the mail, and then something began to creep on the Web‚Äù, then an entire segment or subnet may be automatically blocked. </font><font style="vertical-align: inherit;">Yes, SIEM can do this on its own, but without fine-tuning, perhaps, such measures are the limit of automation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Again, in an ideal world, the operator has access to all systems and immediately knows what to do. </font><font style="vertical-align: inherit;">In the real world, he often needs to find someone responsible to clarify something. </font><font style="vertical-align: inherit;">And he is also on vacation or at a meeting. </font><font style="vertical-align: inherit;">Therefore, another important part - in the reaction flowchart should immediately be responsible for specific sections of systems and departments. </font><font style="vertical-align: inherit;">That is, you need not to look for the employee‚Äôs cell phone, the name of his boss and his phone, but to immediately see them in an open card.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What have we done</font></font></h3><br>
<ol>
<li>,     (),         - . </li>
<li>,     (         ),      ,    . </li>
<li> ,     -.     :   ,   ,  .</li>
<li>     ,          . </li>
<li>  .</li>
<li>    ( ,    ,   ). </li>
<li>     .</li>
<li> GUI  -. </li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of our major customers is SIEM QRadar. A good threat detection system, there are actions and steps for each incident, but you cannot give a list of work for a human operator. When it comes to a professional superclass, this is not necessary. When it comes to the operator of the first line, it is very important to give him instructions on what and how to do, and he will be able to cover most of the typical incidents at the level of a cool specialist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That is, we took out all the obviously boring events on the first line and added criteria to the scripts that separate boring from boring ones. Everything atypical, as before, falls on the pros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cases for companies of several tens of thousands of workplaces and with their server capacities in several data centers were worked out and prescribed as a result for about a year (there are difficult relationships between departments, which made integration into different systems difficult). </font><font style="vertical-align: inherit;">But now any sub-task in the card has a specific person in charge, and it is always relevant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The simplicity for the operators can be judged by the fact that upon implementation, the system was first rolled out into regions, and then, after a couple of weeks, official documentation began to be sent. </font><font style="vertical-align: inherit;">So during this time, people have already begun to confidently close incidents.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How did it start?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is SIEM, but it is not clear what is constantly happening. More precisely, QRadar generates a lot of events, they fall into the information security department, and there simply are no hands to disassemble everything correctly and in detail. As a result, reports are simply viewed superficially. The benefit from SIEM with this approach is not very high. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is an asset management system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are servers for scanning the network, very well configured. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The report was going to be excellent, but they looked at him tiredly and put off. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The customer wanted what they bought to start producing results.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We put the service desk for security guards on top (actually a ticket system, as in normal support), visualized data analytics, and wrote the described automation platform on the basis of IBM Resilient + added typical reactions. Resilient comes naked, it's just a framework. We took the correlation rules from QRadar as a basis and finalized response plans for user cases. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2x/gh/2l/2xgh2l0m1gwr3_urudfvy0ljhq4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For several months they did Russification of everything and hung up the correct bundles by API. As soon as we finished, the vendor issued Russification, and we were a little sad.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
About a month they trained and acquainted with the documentation (in particular, how to draw new flowcharts for cards). </font><font style="vertical-align: inherit;">The further they learned, the more simple cases became: at first huge scripts of actions were written, and then it turned out that they became a kind of library of typical cases. </font><font style="vertical-align: inherit;">And one could refer to them in almost any reaction.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reaction comparison</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Incident "Repeated virus infection with the same malware in a short period of time." </font><font style="vertical-align: inherit;">That is, the virus is detected at workstations, but personnel are needed to understand where it gets from. </font><font style="vertical-align: inherit;">The source of infection is active. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classic:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There was a repeated virus infection of the host 192.168.10.5 with the same malware for a short period of time, events were sent to SIEM, and the corresponding rule worked.</font></font></li>
<li>          .</li>
<li>      .</li>
<li>         .</li>
<li>  .</li>
<li>       /CMDB-.</li>
<li>      .</li>
<li>     -    ,       .</li>
<li>  /        .</li>
<li>    Service Desk        .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fills out an application in the Service Desk system based on the results of an investigation to eliminate the vulnerability due to which this host was infected.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">He waits for service Desk applications to be closed, and then checks their execution.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fills out an incident card and closes the incident.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It reports to the management on the results of its work.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The analyst collects incident statistics to analyze the effectiveness of the response process.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On our platform:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There was a repeated virus infection of the host 192.168.10.5 with the same malware in a short period of time, events were sent to SIEM, and the corresponding rule worked.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The operator looks at the incident card, into which information about this host, the status of the anti-virus protection tool and its logs, vulnerabilities on the host, related incidents and the persons responsible for this host have already been downloaded.</font></font></li>
<li>    ,      :          ,   ,    Service Desk          , -     .</li>
<li>    Service Desk       ,     .</li>
<li>  .</li>
<li>        .</li>
</ol><br>
<h3></h3><br>
<img src="https://habrastorage.org/webt/pl/1f/ew/pl1fewcm3t3g2jmhvntehjrr-4o.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It became a little faster. But the main thing is not this, but that it is possible to sort the tasks into ‚Äúthe first-line operator will handle‚Äù and ‚Äúspecial needs‚Äù. That is, on average, the solution for each ticket has become significantly cheaper, and the system is more scalable. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qd/rj/c8/qdrjc8a_rxing6bbcmvtgvnt7go.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to many false positives, there were many duplicates that turned out to be convenient to detect by the system. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gt/na/mk/gtnamkwlpatuo6gyi2oqiungovk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cards do not look like a set of obscure data from a report, but like ‚ÄúVasya did this and that on a host. This is bad. The host is responsible for Petya. That's exactly what happened. We need to go to Petya and say that Vasya‚Äôs computer from the work area cannot be used to show presentations at conferences. ‚Äù</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another important thing in all of this is that based on the collection of primary data, it has become possible to prioritize tickets. That is, the main potential threats pop up and require attention immediately, and not in a live queue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Automation at the interface with IT tickets made it possible not only to collect all the information about the incident, but also to immediately put tickets to the IT department. If you need to change some settings on the router, then now a ticket from IT is automatically generated, for example. Surprisingly, cases began to emerge "forgot to change the account in the service, and he is trying to connect for a month." IT does not see such situations or ignore the infrastructure. And here the IS says - the service cannot log in. And they put a ticket.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to the typing of reaction cards, incidents began to be solved by standard methods. </font><font style="vertical-align: inherit;">Previously, each was decided creatively: different people did different actions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The result is such a good workflow as in modern CRM. </font><font style="vertical-align: inherit;">The incident passes through a funnel. </font><font style="vertical-align: inherit;">Another problem was solved at the last stage: earlier people sometimes closed the ticket simply because it was tired. </font><font style="vertical-align: inherit;">That is, the result was poorly prescribed. </font><font style="vertical-align: inherit;">And now you need to prove to the system that this is a false positive. </font><font style="vertical-align: inherit;">That is, you can close it, as before, but it is clear that, who and under what conditions did it, and it is much easier to open the jambs. </font><font style="vertical-align: inherit;">Not just ‚Äúthe user could not run the file‚Äù, but ‚Äúbrought the game on the USB flash drive, wanted to install it - they explained the rules of life once again‚Äù. </font><font style="vertical-align: inherit;">And it‚Äôs already clear what happened.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versatility</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now there are a couple of integrations in the production (one is very large with QRadar and an asset management system, another one is smaller). </font><font style="vertical-align: inherit;">It is possible to connect with any SIEM using standard APIs, but, of course, integration requires time for connectors, file refinement, and writing down reaction rules for people. </font><font style="vertical-align: inherit;">Nevertheless, it helps a lot to really respond to security incidents and do it relatively quickly and relatively cheaply. </font><font style="vertical-align: inherit;">It is likely that in 10 years SIEM systems themselves will be able to do this, but so far our add-on has shown itself well. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you want to feel it with us or discuss how it might look with you, here is my mail AAMatveev@technoserv.com.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491362/index.html">March 6th Java Digest</a></li>
<li><a href="../en491366/index.html">PostgreSQL Antipatterns: fighting hordes of the ‚Äúdead‚Äù</a></li>
<li><a href="../en491372/index.html">Robot Operating System Meetup - 2020 will be held in Moscow on April 18-19, 2020</a></li>
<li><a href="../en491376/index.html">Study study</a></li>
<li><a href="../en491382/index.html">Google Income Taxes in Belarus</a></li>
<li><a href="../en491388/index.html">Get away from jQuery to Svelte, as it were</a></li>
<li><a href="../en491390/index.html">Seven ITIL 4 Guidelines</a></li>
<li><a href="../en491398/index.html">Tests and comparisons of WS2813, WS2812B, WS2815 and similar digital LED strips</a></li>
<li><a href="../en491404/index.html">Evil at the service of good: Supervillain 3D-printed mask protects children from polluted air</a></li>
<li><a href="../en491406/index.html">STM32 Part 3: First Project</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>