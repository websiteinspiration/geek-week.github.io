<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏼 🛎️ 🤭 Recursos de montagem e entrega de aplicativos iOS 👨‍👨‍👧 🧜🏼 👨🏿‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, Maxim Shestakov, engenheiro de DevOps no estúdio Plarium Krasnodar, compartilha sua experiência na criação e fornecimento de aplicativos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Recursos de montagem e entrega de aplicativos iOS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/plarium/blog/490698/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste artigo, Maxim Shestakov, engenheiro de DevOps no estúdio Plarium Krasnodar, compartilha sua experiência na criação e fornecimento de aplicativos iOS para usuários acumulados durante a depuração de CI / CD.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/eq/j8/lseqj8pl9g9h1yrdm-h-ekpzuno.jpeg"><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treinamento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo mundo conectado ao desenvolvimento de aplicativos para dispositivos Apple já conseguiu apreciar a usabilidade controversa da infraestrutura. </font><font style="vertical-align: inherit;">As dificuldades estão por toda parte: do menu de perfil do desenvolvedor às ferramentas de depuração e montagem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem muitos artigos sobre o básico na rede, portanto, tentaremos destacar o principal. </font><font style="vertical-align: inherit;">Aqui está o que você precisa para criar o aplicativo com sucesso:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conta de desenvolvedor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dispositivo baseado em macOS atuando como um servidor de compilação;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">certificado de desenvolvedor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gerado </font><font style="vertical-align: inherit;">, que será usado para assinar o aplicativo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativo criado com um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exclusivo </font><font style="vertical-align: inherit;">(a importância do Identificador de pacote configurável deve ser observada, porque o uso do ID curinga impossibilita o uso de muitas funções do aplicativo, por exemplo: Domínios Associados, Notificações Push, Login da Apple e outros);</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perfil de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> assinatura do aplicativo.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O certificado de desenvolvedor deve ser gerado através do Keychain em qualquer dispositivo macOS. </font><font style="vertical-align: inherit;">O tipo de certificado é muito importante. </font><font style="vertical-align: inherit;">Dependendo do ambiente do aplicativo (Dev, QA, Staging, Produção), ele será diferente (Desenvolvimento ou Distribuição), bem como o tipo de perfil de assinatura do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os principais tipos de perfis:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desenvolvimento - projetado para assinar o aplicativo da equipe de desenvolvimento, usando o certificado de Desenvolvimento (nome do formulário iPhone Developer: XXXXX);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ad Hoc - destinado à assinatura de um aplicativo de teste e verificação interna pelo departamento de controle de qualidade, usando o certificado de distribuição do desenvolvedor (nome do tipo de distribuição do iPhone: XXXXX);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">App Store - versão lançada para testes externos através do TestFlight e upload para a App Store, usando o certificado de distribuição do desenvolvedor.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao gerar perfis de Desenvolvimento e Ad Hoc, também </font><font style="vertical-align: inherit;">é </font><font style="vertical-align: inherit;">indicada uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de dispositivos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos quais você pode instalar a compilação, o que permite restringir ainda mais o acesso dos usuários. </font><font style="vertical-align: inherit;">O perfil da App Store não possui uma lista de dispositivos, pois o TestFlight é responsável pelo controle de acesso durante o teste beta fechado, que será discutido mais adiante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para maior clareza, você pode apresentar o perfil do desenvolvedor na forma de um tablet abaixo. </font><font style="vertical-align: inherit;">É mais fácil entender quais parâmetros para a montagem precisamos e onde obtê-los.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qd/dt/u9/qddtu9hfklorm9kmotcctpr-hoc.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Montagem</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para facilitar a separação de montagens por projeto e ambiente, usamos os nomes dos perfis da exibição </font></font><code>${ProjectName}_${Instance}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, o nome da instância do projeto + (depende do ambiente do aplicativo: Dev, QA, GD, Staging, Live e assim por diante). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao importar para um servidor de construção, o perfil altera seu nome para um ID exclusivo e move-se para a pasta </font></font><code>/Users/$Username/Library/MobileDevice/Provisioning Profiles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(onde </font></font><code>$Username</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corresponde ao nome da conta do usuário do servidor de construção). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem duas maneiras de criar o arquivo * .ipa - obsoleto (PackageApplication) e moderno (por meio da criação e exportação do XcAchive). </font><font style="vertical-align: inherit;">O primeiro método é considerado obsoleto, pois a partir da versão 8.3, o módulo de empacotamento de arquivos do aplicativo foi removido da distribuição do Xcode. </font><font style="vertical-align: inherit;">Para usá-lo, você precisa copiar o módulo do Xcode antigo (versão 8.2 e anterior) para a pasta: </font></font><br>
<code>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/ </code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, em seguida, execute o comando:</font></font><br>
<br>
<pre><code class="bash hljs">chmod +x /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/*</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, você precisa coletar o arquivo * .app do aplicativo:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-workspace <span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName</span>.xcworkspace \<font></font>
-scheme <span class="hljs-variable">$SchemeName</span> \<font></font>
-sdk iphoneos \<font></font>
build \<font></font>
-configuration Release \<font></font>
-derivedDataPath build \<font></font>
CODE_SIGN_IDENTITY=”<span class="hljs-variable">$DevAccName</span>”\<font></font>
PROVISIONING_PROFILE=”<span class="hljs-variable">$ProfileId</span>”<font></font>
DEPLOYMENT_POSTPROCESSING=YES \<font></font>
SKIP_INSTALL=YES \<font></font>
ENABLE_BITCODE=NO<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Onde: </font></font><br>
<br>
<code>-workspace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- caminho para o arquivo do projeto. </font></font><br>
<br>
<code>-scheme</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- circuito usado especificado no projeto. </font></font><br>
<br>
<code>-derivedDataPath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- o caminho para descarregar o aplicativo montado (* .app). </font></font><br>
<br>
<code>CODE_SIGN_IDENTITY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- o nome da conta de desenvolvedor que pode ser verificada no Keychain (desenvolvedor do iPhone: XXXX XXXXXXX, sem o TeamID entre colchetes). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pm/lk/fe/pmlkfeglfyjjkdndrmzvtzr8bsu.jpeg"><br>
<br>
<code>PROVISIONING_PROFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- O ID do perfil para assinar o aplicativo, que pode ser obtido com o comando:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> <span class="hljs-string">"/Users/<span class="hljs-variable">$Username</span>/Library/MobileDevice/Provisioning Profiles/"</span> &amp;&amp; find *.mobileprovision -<span class="hljs-built_in">type</span> f | xargs grep -li <span class="hljs-string">"&gt;<span class="hljs-variable">${ProjectName}</span>_<span class="hljs-variable">${Instance}</span>&lt;"</span> | sed -e <span class="hljs-string">'s/.mobileprovision//'</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o aplicativo usar um perfil adicional (por exemplo, para notificações push), </font></font><code>PROVISIONING_PROFILE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indique:</font></font><br>
<br>
<pre><code class="bash hljs">APP_PROFILE=”<span class="hljs-variable">$AppProfile</span>” \<font></font>
EXTENSION_PROFILE=”<span class="hljs-variable">$ExtProfile</span>” \</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, o arquivo * .app resultante deve ser empacotado em * .ipa. </font><font style="vertical-align: inherit;">Para fazer isso, você pode usar um comando do formulário:</font></font><br>
<br>
<pre><code class="bash hljs">/usr/bin/xcrun --sdk iphoneos PackageApplication \<font></font>
-v $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/build/Build/Products/Release-iphoneos"</span> -name <span class="hljs-string">"*.app"</span>) \<font></font>
-o <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName_</span><span class="hljs-variable">$Instance</span>.ipa"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, esse método é considerado obsoleto do ponto de vista da Apple. </font><font style="vertical-align: inherit;">É relevante obter * .ipa exportando do arquivo do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro você precisa coletar o arquivo morto com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-workspace <span class="hljs-variable">$ProjectDir</span>/<span class="hljs-variable">$ProjectName</span>.xcworkspace \<font></font>
-scheme <span class="hljs-variable">$SchemeName</span> \<font></font>
-sdk iphoneos \<font></font>
-configuration Release \<font></font>
archive \<font></font>
-archivePath <span class="hljs-variable">$ProjectDir</span>/build/<span class="hljs-variable">$ProjectName</span>.xcarchive \<font></font>
CODE_SIGN_IDENTITY=”<span class="hljs-variable">$DevAccName</span>” \<font></font>
PROVISIONING_PROFILE=”<span class="hljs-variable">$ProfileId</span>”<font></font>
ENABLE_BITCODE=NO \<font></font>
SYNCHRONOUS_SYMBOL_PROCESSING=FALSE</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As diferenças estão no método de montagem e na opção </font></font><code>SYNCHRONOUS_SYMBOL_PROCESSING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que desativa o descarregamento de caracteres durante a montagem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, precisamos gerar um arquivo com configurações de exportação:</font></font><br>
<br>
<pre><code class="bash hljs">ExportSettings=<span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>/exportOptions.plist"</span><font></font>
<font></font>
cat &lt;&lt; EOF &gt; <span class="hljs-variable">$ExportSettings</span>
&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;<font></font>
&lt;!DOCTYPE plist PUBLIC <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;<font></font>
&lt;plist version=<span class="hljs-string">"1.0"</span>&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;compileBitcode&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;uploadBitcode&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;uploadSymbols&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">false</span>/&gt;<font></font>
&lt;key&gt;method&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$Method</span>&lt;/string&gt;<font></font>
&lt;key&gt;provisioningProfiles&lt;/key&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;<span class="hljs-variable">$BundleID</span>&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ProfileId</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;key&gt;signingCertificate&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$DevAccName</span>&lt;/string&gt;<font></font>
&lt;key&gt;signingStyle&lt;/key&gt;<font></font>
&lt;string&gt;manual&lt;/string&gt;<font></font>
&lt;key&gt;stripSwiftSymbols&lt;/key&gt;<font></font>
&lt;<span class="hljs-literal">true</span>/&gt;<font></font>
&lt;key&gt;teamID&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$TeamID</span>&lt;/string&gt;<font></font>
&lt;key&gt;thinning&lt;/key&gt;<font></font>
&lt;string&gt;&lt;none&gt;&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/plist&gt;<font></font>
EOF<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Onde: </font></font><br>
<br>
<code>$Method</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- o método de entrega corresponde ao tipo de perfil de assinatura do aplicativo, ou seja, para Desenvolvimento, o valor será desenvolvimento, para Ad Hoc - ad-hoc e para a App Store - loja de aplicativos. </font></font><br>
<br>
<code>$BundleID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- O ID do aplicativo especificado nas configurações do aplicativo. </font><font style="vertical-align: inherit;">Você pode verificar com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">defaults <span class="hljs-built_in">read</span> <span class="hljs-variable">$ProjectDir</span>/Info CFBundleIdentifier</code></pre><br>
<code>$DevAccName  $ProfileId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- configurações para o nome do desenvolvedor e o ID do perfil de assinatura que foram usados ​​anteriormente e devem corresponder aos valores nas configurações de exportação. </font></font><br>
<br>
<code>$TeamID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ID de dez dígitos entre colchetes após o nome do desenvolvedor, por exemplo: Desenvolvedor do iPhone: ....... (XXXXXXXXXX); </font><font style="vertical-align: inherit;">pode verificar no chaveiro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, usando o comando export, obtemos o arquivo * .ipa necessário:</font></font><br>
<br>
<pre><code class="bash hljs">xcodebuild \<font></font>
-exportArchive \<font></font>
-archivePath <span class="hljs-variable">$ProjectDir</span>/build/<span class="hljs-variable">$ProjectName</span>.xcarchive \<font></font>
-exportPath <span class="hljs-variable">$ProjectDir</span> \<font></font>
-exportOptionsPlist <span class="hljs-variable">$ExportSettings</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrega</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, o arquivo montado deve ser entregue ao usuário final, ou seja, instalado no dispositivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para a distribuição de desenvolvimento e compilações Ad Hoc, existem muitos serviços como HockeyApp, AppBlade e outros, mas neste artigo falaremos sobre um servidor autônomo para distribuição de aplicativos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A instalação do aplicativo para iOS ocorre em 2 etapas:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenção do manifesto de instalação do aplicativo por meio do Serviço de Itens.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instalando o arquivo * .ipa de acordo com as informações especificadas no manifesto via HTTPS.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, para iniciantes, precisamos gerar o manifesto de instalação (tipo de arquivo * .plist) com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">cat &lt;&lt; EOF &gt; <span class="hljs-variable">$manifest</span>
&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;<font></font>
&lt;!DOCTYPE plist PUBLIC <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;<font></font>
&lt;plist version=<span class="hljs-string">"1.0"</span>&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;items&lt;/key&gt;<font></font>
&lt;array&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;assets&lt;/key&gt;<font></font>
&lt;array&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;kind&lt;/key&gt;<font></font>
&lt;string&gt;software-package&lt;/string&gt;<font></font>
&lt;key&gt;url&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ipaUrl</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/array&gt;<font></font>
&lt;key&gt;metadata&lt;/key&gt;<font></font>
&lt;dict&gt;<font></font>
&lt;key&gt;bundle-identifier&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$BundleID</span>&lt;/string&gt;<font></font>
&lt;key&gt;bundle-version&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$AppVersion</span>&lt;/string&gt;<font></font>
&lt;key&gt;kind&lt;/key&gt;<font></font>
&lt;string&gt;software&lt;/string&gt;<font></font>
&lt;key&gt;title&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$ProjectName_</span><span class="hljs-variable">$Instance</span>&lt;/string&gt;<font></font>
&lt;key&gt;subtitle&lt;/key&gt;<font></font>
&lt;string&gt;<span class="hljs-variable">$Instance</span>&lt;/string&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/array&gt;<font></font>
&lt;/dict&gt;<font></font>
&lt;/plist&gt;<font></font>
EOF</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, o manifesto contém quase todos os parâmetros envolvidos na montagem do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A versão do aplicativo ( </font></font><code>$AppVersion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) pode ser verificada com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">defaults <span class="hljs-built_in">read</span> <span class="hljs-variable">$ProjectDir</span>/Info CFBundleVersion</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O parâmetro </font></font><code>$ipaUrl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contém um link direto para baixar o arquivo * .ipa. </font><font style="vertical-align: inherit;">A partir da sétima versão do iOS, o aplicativo deve ser instalado via HTTPS. </font><font style="vertical-align: inherit;">Na oitava versão, o formato do manifesto mudou um pouco: os blocos com configurações para ícones de aplicativos do formulário foram removidos</font></font><br>
<br>
<pre><code class="bash hljs">&lt;images&gt;<font></font>
   &lt;image&gt;...&lt;/image&gt;<font></font>
&lt;/images&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, para instalar o aplicativo, basta uma página html simples com um link do formulário:</font></font><br>
<br>
<pre><code class="bash hljs">itms-services://?action=download-manifest&amp;url=https://<span class="hljs-variable">$ServerUrl</span>/<span class="hljs-variable">$ProjectName</span>/<span class="hljs-variable">$Instance</span>/iOS/<span class="hljs-variable">$AppVersion</span>/manifest.plist</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para as necessidades dos departamentos de desenvolvimento e teste, a Plarium criou seu aplicativo de instalação de compilação, que nos fornece:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autonomia e independência,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controle de acesso centralizado e instalação segura de aplicativos por meio de links "temporários" criados dinamicamente,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funcionalidade extensível (ou seja, a equipe de desenvolvimento, se necessário, pode integrar as funções ausentes em um aplicativo existente).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teste</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, falaremos sobre o teste de aplicativos de pré-lançamento usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TestFlight</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os pré-requisitos para o download são o tipo de perfil de assinatura da App Store e a presença de chaves de API geradas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem várias maneiras de baixar o aplicativo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via Xcode (Organizer),</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">através do altool,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via Application Loader para versões mais antigas do Xcode (agora Transporter).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para carregamento automático, é utilizado altool, que também possui dois métodos de autorização:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senha específica do aplicativo,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chave API</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É preferível fazer o download do aplicativo usando a API Key. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obter a chave da API, siga o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e gere a chave. </font><font style="vertical-align: inherit;">Além da própria chave no formato * .p8, precisaremos de dois parâmetros: IssuerID e KeyID. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7j/el/tr/7jeltrm88wb-m74uokirbdw59xs.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, importamos a chave baixada para o servidor de compilação:</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p ~/.appstoreconnect/private_keys<font></font>
mv ~/Downloads/AuthKey_<span class="hljs-variable">${KeyID}</span>.p8 ~/.appstoreconnect/private_keys/</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de carregar o aplicativo no TestFlight, você precisa validar o aplicativo, faça isso com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool \<font></font>
--validate-app \<font></font>
-t ios \<font></font>
-f $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>"</span> -name <span class="hljs-string">"*.ipa"</span>) \<font></font>
--apiKey “<span class="hljs-variable">$KeyID</span>” \<font></font>
--apiIssuer “<span class="hljs-variable">$IssuerID</span>” </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Onde </font></font><code>apiKey</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>apiIssuer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">possui valores de campo na página de geração de chave da API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, após a validação bem-sucedida, carregamos o aplicativo com um comando </font></font><code>--upload-app</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com os mesmos parâmetros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O aplicativo será testado pela Apple dentro de um a dois dias e depois estará disponível para testadores externos: eles receberão links de e-mail para instalação. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra maneira de baixar o aplicativo através do altool é usar a senha específica do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para obter a senha específica do aplicativo, siga o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e gere-o na seção Segurança. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k6/3k/lk/k63klknhpg0dtwoukakdzmn02om.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, crie um registro do servidor de compilação no Keychain com essa senha. </font><font style="vertical-align: inherit;">A partir da versão 11 do Xcode, isso pode ser feito com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool --store-password-in-keychain-item <span class="hljs-string">"Altool"</span> -u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> -p <span class="hljs-variable">$AppPswd</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Onde: </font></font><br>
<br>
<code>$DeveloperName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é o nome da conta de desenvolvedor do iOS usada para fazer login nos serviços da Apple. </font></font><br>
<br>
<code>$AppPswd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Senha específica do aplicativo gerada. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, obtemos o valor do parâmetro asc-provider e verificamos o sucesso da importação da senha com o comando:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool --list-providers -u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> -p <span class="hljs-string">"@keychain:Altool"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos a conclusão:</font></font><br>
<br>
<pre><code class="bash hljs">Provider listing:<font></font>
- Long Name - - Short Name -<font></font>
XXXXXXX        XXXXXXXXX</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, o valor desejado de Nome Curto (provedor ascendente) corresponde ao parâmetro $ TeamID que usamos ao criar o aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para validar e carregar o aplicativo no TestFlight, use o comando:</font></font><br>
<br>
<pre><code class="bash hljs">xcrun altool \<font></font>
--(validate|upload)-app \  <font></font>
-f $(find <span class="hljs-string">"<span class="hljs-variable">$ProjectDir</span>"</span> -name <span class="hljs-string">"*.ipa"</span>) \<font></font>
-u <span class="hljs-string">"<span class="hljs-variable">$DeveloperName</span>"</span> \<font></font>
-p <span class="hljs-string">"@keychain:Altool"</span> \</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como um valor de parâmetro, </font></font><code>-p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">você pode pegar o valor </font></font><code>$AppPswd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma não criptografada (explícita). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, como já mencionado, do ponto de vista da operabilidade, é melhor selecionar a Chave da API para autorização de altool, pois em diferentes versões do Xcode são encontrados certos problemas (ele não "vê" o Keychain, erros de autorização durante o descarregamento, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso, de fato, é tudo. </font><font style="vertical-align: inherit;">Desejo a todos envolvidos em compilações bem-sucedidas e lançamentos sem problemas na App Store.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt490684/index.html">Seleção de cabos para cabeamento estruturado</a></li>
<li><a href="../pt490686/index.html">Notícias do mundo do OpenStreetMap No. 500 (11.02.2020-17.02.2020)</a></li>
<li><a href="../pt490690/index.html">Criamos o diretório de endereços WEB do PHP + LDAP</a></li>
<li><a href="../pt490694/index.html">Principais comentários no código fonte</a></li>
<li><a href="../pt490696/index.html">Como funciona o Mail for Business - lojas on-line e remetentes principais</a></li>
<li><a href="../pt490700/index.html">Curso de Processamento de Linguagem Natural</a></li>
<li><a href="../pt490704/index.html">Modelos japoneses e californianos Kano</a></li>
<li><a href="../pt490708/index.html">Companhias aéreas finlandesas Finnair: como a tripulação treina e um pouco sobre o interior da cozinha</a></li>
<li><a href="../pt490714/index.html">Como obter 100 mil por código. Guia Completo para Iniciantes</a></li>
<li><a href="../pt490716/index.html">Como garantir a operação de alta qualidade da rede local de uma pequena empresa?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>