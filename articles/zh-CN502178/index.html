<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍪 🍟 🤴🏽 oVirt在2小时内。第3部分。高级设置 ◼️ 📙 👊🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本文中，我们将介绍一些可选但有用的设置：
 
 

- 使用经理的其他名称 ;
- 通过目录Active Directory进行连接认证 ;
- 多情 ;
- 电源管理 ;
- SSL证书替换 ;
- 归档 ;
- 主机管理界面（驾驶舱）；
- VLAN ;
- 专门用于HPE。
 本文是续篇，第...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt在2小时内。第3部分。高级设置</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502178/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本文中，我们将介绍一些可选但有用的设置：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用经理的其他名称</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过目录Active Directory进行连接认证</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多情</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源管理</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL证书替换</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">归档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机管理界面（驾驶舱）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">；</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VLAN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">专门用于HPE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
本文是续篇，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1 </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">第2 </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">部分</font></a><font style="vertical-align: inherit;"> 2小时开始看oVirt </font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介绍</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装管理器（ovirt引擎）和管理程序（主机） </font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级设置-我们在这里</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本操作</font></font></a></li>
</ol><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他管理员设定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了方便起见，我们将提供其他包装：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install bash-completion vim</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要启用自动补全功能，应将bash-completion命令切换为bash。</font></font><br>
<br>
<a name="add-fqdn"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加其他DNS名称</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当您需要通过备用名称（CNAME，别名或只是没有域名后缀的简称）连接到管理器时，这是必需的。</font><font style="vertical-align: inherit;">出于安全原因，管理器仅允许使用允许的名称列表进行连接。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建一个配置文件：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/engine.conf.d/99-custom-sso-setup.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下内容：</font></font><br>
<br>
<pre><code class="cmake hljs">SSO_ALTERNATE_ENGINE_FQDNS=<span class="hljs-string">"ovirt.example.com some.alias.example.com ovirt"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并重新启动管理器：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl restart ovirt-engine</code></pre><br>
<a name="ad-auth"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过AD配置身份验证</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
oVirt具有内置的用户群，但也支持外部LDAP提供程序，包括 </font><font style="vertical-align: inherit;">广告。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
典型配置的最简单方法是启动向导并重新启动管理器：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install ovirt-engine-extension-aaa-ldap-setup<font></font>
$ sudo ovirt-engine-extension-aaa-ldap-setup<font></font>
$ sudo systemctl restart ovirt-engine</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向导示例</font></font></b>
                        <div class="spoiler_text">$ <b>sudo ovirt-engine-extension-aaa-ldap-setup</b><br>
Available LDAP implementations:<br>
…<br>
 3 — Active Directory<br>
…<br>
 Please select: <b>3</b><br>
 Please enter Active Directory Forest name: <b>example.com<br>
</b><br>
 Please select protocol to use (startTLS, ldaps, plain) <b>[startTLS]</b>: <br>
 Please select method to obtain PEM encoded CA certificate (File, URL, Inline, System, Insecure): <b>URL</b><br>
 URL: <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">wwwca.example.com/myRootCA.pem</a></b><br>
 Enter search user DN (for example uid=username,dc=example,dc=com or leave empty for anonymous): <b>CN=oVirt-Engine,CN=Users,DC=example,DC=com</b><br>
 Enter search user password: <b>*password*</b><br>
[ INFO ] Attempting to bind using 'CN=oVirt-Engine,CN=Users,DC=example,DC=com'<br>
 Are you going to use Single Sign-On for Virtual Machines (Yes, No) <b>[Yes]</b>: <br>
 Please specify profile name that will be visible to users <b>[example.com]</b>: <br>
 Please provide credentials to test login flow:<br>
 Enter user name: <b>someAnyUser</b><br>
 Enter user password: <br>
…<br>
[ INFO ] Login sequence executed successfully<br>
…<br>
 Select test sequence to execute (Done, Abort, Login, Search) <b>[Done]</b>: <br>
[ INFO ] Stage: Transaction setup<br>
…<br>
 CONFIGURATION SUMMARY<br>
…<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用向导适合大多数情况。</font><font style="vertical-align: inherit;">对于复杂的配置，这些设置是手动的。</font><font style="vertical-align: inherit;">在oVirt，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户和角色</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档中了解更多信息</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">将Engine成功连接到AD后，其他配置文件将显示在连接窗口中以及</font><font style="vertical-align: inherit;">系统对象</font><font style="vertical-align: inherit;">的“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">权限”</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项卡上</font><font style="vertical-align: inherit;">-可以向用户和AD组颁发权限。</font><font style="vertical-align: inherit;">应该注意的是，用户和组的外部目录不仅可以是AD，还可以是IPA，eDirectory等。</font></font><br>
<br>
<a name="mpath"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多路径</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在生产环境中，存储系统必须通过几个独立的多个I / O路径连接到主机。</font><font style="vertical-align: inherit;">通常，在CentOS（以及oVirt）中，构建多个设备路径没有问题（find_multipaths是）。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中介绍了FCoE的其他设置</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">值得关注存储系统制造商的建议-许多建议使用循环策略，默认情况下，Enterprise Linux 7中使用服务Linux。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如3PAR</font></font></b>
                        <div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">HPE 3PAR Red Hat Enterprise Linux, CentOS Linux, Oracle Linux, and OracleVM Server Implementation Guide</a> EL   Host  Generic-ALUA Persona 2,     /etc/multipath.conf   :<br>
<br>
<pre><code class="plaintext hljs">defaults {<font></font>
           polling_interval      10<font></font>
           user_friendly_names   no<font></font>
           find_multipaths       yes<font></font>
          }<font></font>
devices {<font></font>
          device {<font></font>
                   vendor                   "3PARdata"<font></font>
                   product                  "VV"<font></font>
                   path_grouping_policy     group_by_prio<font></font>
                   path_selector            "round-robin 0"<font></font>
                   path_checker             tur<font></font>
                   features                 "0"<font></font>
                   hardware_handler         "1 alua"<font></font>
                   prio                     alua<font></font>
                   failback                 immediate<font></font>
                   rr_weight                uniform<font></font>
                   no_path_retry            18<font></font>
                   rr_min_io_rq             1<font></font>
                   detect_prio              yes<font></font>
                   fast_io_fail_tmo         10<font></font>
                   dev_loss_tmo             "infinity"<font></font>
                 }<font></font>
}</code></pre><br>
     :<br>
<br>
<pre><code class="bash hljs">systemctl restart multipathd</code></pre><br>
<img src="https://habrastorage.org/webt/ez/1c/fs/ez1cfs3-mar5uivpfekvtgomway.png"><br>
<i>. 1 —   -  .</i><br>
<br>
<img src="https://habrastorage.org/webt/j_/6r/ll/j_6rll3gmnpqzwhwz_uffranfgo.png"><br>
<i>. 2 —   -   .</i><br>
</div>
                    </div><br>
<a name="pwr-mgmt"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源管理设置</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果Engine长时间无法收到主机的响应，则允许您执行计算机的硬件重置。</font><font style="vertical-align: inherit;">通过Fence Agent实施。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
计算-&gt;主机-&gt; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -编辑-&gt;电源管理，然后启用“启用电源管理”并添加代理-“添加Fence代理”-&gt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们指出类型（例如，必须为iLO5指定ilo4），ipmi接口的名称/地址以及用户名/密码。</font><font style="vertical-align: inherit;">建议您创建一个单独的用户（例如oVirt-PM），如果是iLO，请给他授予特权：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登录</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">远程控制台</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虚拟电源和重置</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虚拟媒体</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配置iLO设置</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理用户帐户</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不要问为什么，它是根据经验选择的。</font><font style="vertical-align: inherit;">控制台防护代理要求的权限较小。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置访问控制列表时，应记住，代理程序不是在引擎上运行，而是在“邻居”主机（所谓的电源管理代理）上运行，也就是说，如果集群中只有一个节点，则电源管理</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将无法</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a name="ssl-cert"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL设置</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完整的官方说明在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附录D：oVirt和SSL中-替换oVirt Engine SSL / TLS证书。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
证书可以来自我们的公司CA，也可以来自外部商业证书颁发机构。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要说明：证书旨在连接到管理器，不会影响Engine与节点之间的交互-它们将使用Engine颁发的自签名证书。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要求：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以PEM格式发行的CA的证书，包括到根CA的整个链（从开始的下级发行者到末尾的根）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发行CA颁发的Apache证书（还附有整个CA证书链）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache的私钥，无密码。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
假设我们的发布证书颁发机构正在运行名为subca.example.com的CentOS，并且请求，密钥和证书位于/ etc / pki / tls /目录中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们执行备份并创建一个临时目录：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/pki/ovirt-engine/keys/apache.key.nopass /etc/pki/ovirt-engine/keys/apache.key.nopass.`date +%F`<font></font>
$ sudo cp /etc/pki/ovirt-engine/certs/apache.cer /etc/pki/ovirt-engine/certs/apache.cer.`date +%F`<font></font>
$ sudo mkdir /opt/certs<font></font>
$ sudo chown mgmt.mgmt /opt/certs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
下载证书，从我们的工作站执行证书或以另一种方便的方式进行传输：</font></font><br>
<br>
<pre><code class="bash hljs">[myuser@mydesktop] $ scp -3 causer@subca.example.com:/etc/pki/tls/cachain.pem mgmt@ovirt.example.com:/opt/certs<font></font>
[myuser@mydesktop] $ scp -3 causer@subca.example.com:/etc/pki/tls/private/ovirt.key mgmt@ovirt.example.com:/opt/certs<font></font>
[myuser@mydesktop] $ scp -3 causer@subca.example.com/etc/pki/tls/certs/ovirt.crt mgmt@ovirt.example.com:/opt/certs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，您应该看到所有3个文件：</font></font><br>
<br>
<pre><code class="bash hljs">$ ls /opt/certs<font></font>
cachain.pem  ovirt.crt  ovirt.key</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">证书安装</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们复制文件并更新信任列表：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cp /opt/certs/cachain.pem /etc/pki/ca-trust/<span class="hljs-built_in">source</span>/anchors<font></font>
$ sudo update-ca-trust<font></font>
$ sudo rm /etc/pki/ovirt-engine/apache-ca.pem<font></font>
$ sudo cp /opt/certs/cachain.pem /etc/pki/ovirt-engine/apache-ca.pem<font></font>
$ sudo cp /opt/certs/ovirt03.key /etc/pki/ovirt-engine/keys/apache.key.nopass<font></font>
$ sudo cp /opt/certs/ovirt03.crt /etc/pki/ovirt-engine/certs/apache.cer<font></font>
$ sudo systemctl restart httpd.service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添加/更新配置文件：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/engine.conf.d/99-custom-truststore.conf</code></pre><br>
<pre><code class="plaintext hljs">ENGINE_HTTPS_PKI_TRUST_STORE="/etc/pki/java/cacerts"<font></font>
ENGINE_HTTPS_PKI_TRUST_STORE_PASSWORD=""</code></pre><br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-engine/ovirt-websocket-proxy.conf.d/10-setup.conf</code></pre><br>
<pre><code class="plaintext hljs">SSL_CERTIFICATE=/etc/pki/ovirt-engine/certs/apache.cer<font></font>
SSL_KEY=/etc/pki/ovirt-engine/keys/apache.key.nopass</code></pre><br>
<pre><code class="bash hljs">$ sudo vim /etc/ovirt-imageio-proxy/ovirt-imageio-proxy.conf</code></pre><br>
<pre><code class="plaintext hljs"># Key file for SSL connections<font></font>
ssl_key_file = /etc/pki/ovirt-engine/keys/apache.key.nopass<font></font>
# Certificate file for SSL connections<font></font>
ssl_cert_file = /etc/pki/ovirt-engine/certs/apache.cer</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们重新启动所有受影响的服务：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl restart ovirt-provider-ovn.service<font></font>
$ sudo systemctl restart ovirt-imageio-proxy<font></font>
$ sudo systemctl restart ovirt-websocket-proxy<font></font>
$ sudo systemctl restart ovirt-engine.service</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
做完了！</font><font style="vertical-align: inherit;">现在该连接到管理器并验证该连接是否受到签名的SSL证书的保护了。</font></font><br>
<br>
<a name="backup-mgr"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">封存</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
没有她的地方！</font><font style="vertical-align: inherit;">在本节中，我们将讨论管理器归档； VM归档是一个单独的问题。</font><font style="vertical-align: inherit;">我们将每天制作一次存档副本，并将其放在NFS上，例如，在放置ISO映像的同一系统上-mynfs01.example.com:/exports/ovirt-backup。</font><font style="vertical-align: inherit;">不建议将存档存储在运行Engine的同一台计算机上。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装并启用autofs：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install autofs<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> autofs<font></font>
$ sudo systemctl start autofs</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建一个脚本：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/cron.daily/make.oVirt.backup.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下内容：</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash
</span>
datetime=`date +<span class="hljs-string">"%F.%R"</span>`<font></font>
backupdir=<span class="hljs-string">"/net/mynfs01.example.com/exports/ovirt-backup"</span>
filename=<span class="hljs-string">"<span class="hljs-variable">$backupdir</span>/`hostname --short`.`date +"</span>%F.%R<span class="hljs-string">"`"</span>
engine-backup --mode=backup --scope=all --file=<span class="hljs-variable">$filename</span>.data --<span class="hljs-built_in">log</span>=<span class="hljs-variable">$filename</span>.<span class="hljs-built_in">log</span>
<span class="hljs-comment">#uncomment next line for autodelete files older 30 days </span>
<span class="hljs-comment">#find $backupdir -type f -mtime +30 -exec rm -f {} \;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们使文件可执行：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo chmod a+x /etc/cron.daily/make.oVirt.backup.sh</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，每天晚上我们都会收到管理员设置档案。</font></font><br>
<br>
<a name="cockpit"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主机管理界面</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cockpit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是Linux系统的现代管理界面。</font><font style="vertical-align: inherit;">在这种情况下，它扮演的角色接近ESXi Web界面。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/587/d56/5c8/587d565c8e0250045773c2772b3fb112.png" alt="图片"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">3-面板外观。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它的安装非常简单，您需要驾驶舱软件包和cockpit-ovirt-dashboard插件：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install cockpit cockpit-ovirt-dashboard -y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打开驾驶舱：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo systemctl <span class="hljs-built_in">enable</span> --now cockpit.socket</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
防火墙设置：</font></font><br>
<br>
<pre><code class="bash hljs">sudo firewall-cmd --add-service=cockpit<font></font>
sudo firewall-cmd --add-service=cockpit --permanent</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在您可以连接到主机：https：// [主机IP或FQDN]：9090</font></font><br>
<br>
<a name="vlans"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虚拟局域网</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读有关网络的更多信息</font><font style="vertical-align: inherit;">。有很多可能性，在这里我们描述虚拟网络的连接。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要连接其他子网，必须首先在配置中对其进行描述：网络-&gt;网络-&gt;新建，此处仅名称是必填字段；将打开“虚拟机网络”复选框，该复选框允许机器使用该网络，并要连接标签，请启用“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启用VLAN标签”</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，输入VLAN编号，然后单击“确定”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，您需要转到计算-&gt;主机-&gt; kvmNN-&gt;网络接口-&gt;设置主机网络主机。从未分配的逻辑网络的右侧添加的网络向左拖动在所指派的逻辑网络：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/kn/wn/wqknwnvkf13ojuxjidpxuc6s9fq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图4-添加网络之前。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/2j/ei/gc/2jeigcdyhds6kfqqrvs-2gtt4zk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。 5-添加网络后。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要将多个网络批量连接到主机，可以在创建网络时为它们分配标签，并按标签添加网络非常方便。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建网络后，主机将进入非运行状态，直到将网络添加到群集的所有节点。</font><font style="vertical-align: inherit;">此行为是由创建新网络时“群集”选项卡上的“全部需要”标志引起的。</font><font style="vertical-align: inherit;">如果群集的所有节点上都不需要网络，则可以禁用此症状，然后将网络添加到主机后，在“非必需”部分的右侧，您可以选择是否将其连接到特定主机。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/10/ey/zr10eyeksh3-j_kqd1ezkcgytnw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">图。</font><font style="vertical-align: inherit;">6-选择网络要求的标志。</font></font></i><br>
<br>
<a name="hpe"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定于HPE</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
几乎所有制造商都拥有可提高其产品可用性的工具。</font><font style="vertical-align: inherit;">以HPE为例，AMS（无代理管理服务，iLO5的amsd，iLO4的hp-ams）和SSA（Smart Storage Administrator，与磁盘控制器一起使用）等很有用。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接HPE存储库</font></font></b>
                        <div class="spoiler_text">     HPE:<br>
<br>
<pre><code class="bash hljs">$ sudo rpm --import https://downloads.linux.hpe.com/SDR/hpePublicKey2048_key1.pub<font></font>
$ sudo vim /etc/yum.repos.d/mcp.repo</code></pre><br>
 :<br>
<br>
<pre><code class="plaintext hljs">[mcp]<font></font>
name=Management Component Pack<font></font>
baseurl=http://downloads.linux.hpe.com/repo/mcp/centos/$releasever/$basearch/current/<font></font>
enabled=1<font></font>
gpgkey=file:///etc/pki/rpm-gpg/GPG-KEY-mcp<font></font>
<font></font>
[spp]<font></font>
name=Service Pack for ProLiant<font></font>
baseurl=http://downloads.linux.hpe.com/SDR/repo/spp/RHEL/$releasever/$basearch/current/<font></font>
enabled=1<font></font>
gpgkey=file:///etc/pki/rpm-gpg/GPG-KEY-mcp</code></pre><br>
       ():<br>
<br>
<pre><code class="bash hljs">$ sudo yum --disablerepo=<span class="hljs-string">"*"</span> --enablerepo=<span class="hljs-string">"mcp"</span> list available<font></font>
$ yum info amsd</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
安装和启动：</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install amsd ssacli<font></font>
$ sudo systemctl start amsd</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">磁盘控制器实用程序的示例</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/6_/bh/qw/6_bhqwnjgtqbx7eugqzur06mxxo.png"><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目前为止就这样了。</font><font style="vertical-align: inherit;">在以下文章中，我计划讲一些基本的操作和应用程序。</font><font style="vertical-align: inherit;">例如，如何在oVirt中制作VDI。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN502156/index.html">Rambler诉NGINX案：数字化圆桌会议的刑事风险5月16日</a></li>
<li><a href="../zh-CN502158/index.html">如何组织测试以加速和稳定产品发布。第2部分</a></li>
<li><a href="../zh-CN502160/index.html">定制移动应用程序开发不昂贵：现实还是幻想</a></li>
<li><a href="../zh-CN502166/index.html">幽灵Windows 3.1</a></li>
<li><a href="../zh-CN502176/index.html">前往：输入错误的JSON反序列化，或如何解决API开发人员错误</a></li>
<li><a href="../zh-CN502180/index.html">周界消失的那一天。Microsoft和合作伙伴提供的安全解决方案</a></li>
<li><a href="../zh-CN502182/index.html">关于MikroTik或期待已久的SOCKS5</a></li>
<li><a href="../zh-CN502186/index.html">网络研讨会。信息安全：隔离的SOC</a></li>
<li><a href="../zh-CN502196/index.html">一个世纪前的数学方法中，发现了揭示时间本质的新钥匙。</a></li>
<li><a href="../zh-CN502200/index.html">熵：决策树如何制定决策</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>