<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♎️ 👩🏻‍🏭 🤷🏽 MVCC sebagai salah satu cara untuk memastikan isolasi transaksi 🕴🏾 🙅🏻 ⏪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai, Habr. Nama saya Vladislav Rodin. Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitektur peran...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MVCC sebagai salah satu cara untuk memastikan isolasi transaksi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/504190/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hai, Habr. </font><font style="vertical-align: inherit;">Nama saya Vladislav Rodin. </font><font style="vertical-align: inherit;">Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitektur perangkat lunak. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Khusus untuk permulaan set baru untuk kursus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Arsitek beban tinggi"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya menulis sedikit materi, yang dengan senang hati saya bagikan kepada Anda.</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/hv/fy/ll/hvfyllpmp4nnso0wztz_u0ju278.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terakhir kali,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami berbicara dengan Anda tentang konsekuensi dari melemahnya isolasi transaksi di database. </font><font style="vertical-align: inherit;">Hari ini kita akan membahas secara lebih rinci salah satu cara untuk memastikan isolasi dan penghindaran anomali yang dipertimbangkan ini. </font><font style="vertical-align: inherit;">Seperti yang mungkin Anda perhatikan, dalam artikel terakhir dua pendekatan sering dibedakan: satu didasarkan pada fakta bahwa catatan memiliki beberapa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan yang kedua pada kenyataan bahwa kami akan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memblokir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rekaman dengan satu atau lain cara </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dengan demikian, dua kelas basis data dibedakan: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi dan pemblokir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hari ini kita akan berbicara tentang apa itu pengontrol versi, dan biarkan pertimbangan pemblokir lain kali.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versiioners</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya katakan, salah satu pendekatan didasarkan pada versi. </font><font style="vertical-align: inherit;">Itu juga disebut </font><font style="vertical-align: inherit;">pendekatan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">optimis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MVCC (kontrol konkurensi multiversion)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bahkan, penyimpanan versi untuk transaksi aktif terjadi.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di mana versi disimpan?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementasi mekanisme tergantung pada database. </font><font style="vertical-align: inherit;">Saya akan memberikan contoh beberapa di antaranya.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap transaksi ditandai oleh beberapa id-shnik. Transaksi id-shnik tumbuh secara monoton. Baris mana pun memiliki 2 atribut yang mewakili meta-informasi untuk menyediakan mekanisme: updated_by_id - id transaksi yang terakhir diperbarui catatan ini dan dihapus_by_id - id transaksi yang menghapus catatan ini. Ketika transaksi baru tiba, basis data menentukan id-nicks dari transaksi yang sedang dilakukan, perubahan yang dilakukan oleh transaksi ini akan diabaikan dalam transaksi yang masuk. Ternyata transaksi yang masuk berfungsi seolah-olah dengan versi datanya. Data versi lama disimpan di tempat yang sama dengan yang sekarang. Jika Pembaruan tiba, maka baris lain ditambahkan dan catatan ini menjadi aktif. Juga jelas bahwa untuk operasi yang benar dari skema ini, seorang "pengumpul sampah" diperlukan:jika beberapa catatan telah delete_by_id = 100, dan id-shnik minimum di antara transaksi saat ini adalah 150, maka catatan ini harus dihapus.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL (mesin InnoDB)</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya versi saat ini disimpan dalam database MySQL. </font><font style="vertical-align: inherit;">Ketika Pembaruan tiba, data di dalam file tabel diperbaiki. </font><font style="vertical-align: inherit;">Setelah menyesuaikan data, versi sebelumnya ada di rollback log. </font><font style="vertical-align: inherit;">Ada beberapa rollback log di MySQL (berbeda untuk insert'ov dan update'ov). </font><font style="vertical-align: inherit;">Jika suatu transaksi membutuhkan versi baris sebelumnya, sistem akan membatalkan unduhan dan mengembalikan versi yang diperlukan. </font><font style="vertical-align: inherit;">Versi ini juga ditentukan oleh id transaksi.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peramal</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema ini mirip dengan MySQL: versi saat ini disimpan dalam file data, versi lama dipulihkan berkat batalkan log. </font><font style="vertical-align: inherit;">Undo log in Oracle ditulis ulang secara siklis. </font><font style="vertical-align: inherit;">Oleh karena itu, suatu situasi dimungkinkan ketika suatu transaksi membutuhkan versi catatan yang sangat lama, tetapi dalam uraian itu tidak lagi ada. </font><font style="vertical-align: inherit;">Jika situasi ini terjadi, transaksi akan gagal.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS SQL</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MS SQL memungkinkan masuknya mode versiioner dan pemblokir. Untuk mengaktifkan mode versi dalam pengaturan basis data, Anda harus mengaktifkan snapshot. Dalam MS SQL ada tabel sistem (tempdb), yang dirancang untuk menyimpan tabel sementara. Ini adalah tempdb yang digunakan untuk menyimpan versi lama, sementara tabel berisi versi saat ini. Proses sistem memonitor bahwa dalam tempdb ada versi yang tidak ada yang merujuk, mereka dapat dihapus. Jika transaksi lama, maka versi akan disimpan untuk itu. Tempdb tumbuh, mencapai ukuran maksimumnya, MS SQL mengalokasikan sedikit ruang disk. Jika itu berakhir, maka transaksi dengan isolasi snapshot tidak dapat dilakukan. Jika mode operasi ini digunakan, perlu untuk memantau transaksi panjang,karena kembalinya transaksi seperti itu dalam waktu mungkin biaya sebanyak itu berfungsi, dan mungkin sedikit lebih.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konflik</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendekatan ini disebut optimis, karena kami berharap tidak akan ada konflik jika transaksi penggantian data paralel dijalankan. </font><font style="vertical-align: inherit;">Apa yang terjadi jika terjadi konflik? </font><font style="vertical-align: inherit;">Misalkan transaksi T1 mengubah 10.000 catatan, dan transaksi T2 mengubah 1 catatan secara paralel. </font><font style="vertical-align: inherit;">Jika kebetulan bahwa catatan 1 ini termasuk dalam 10.000 itu, maka salah satu transaksi akan dibatalkan: jika T1 dieksekusi pertama, maka T2 akan dibatalkan, jika tidak sebaliknya.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mekanisme rollback</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mekanisme pengembalian transaksi dalam versi versi tergantung pada implementasinya. </font><font style="vertical-align: inherit;">Sebagai contoh, di PostgreSQL, transaksi ditandai sebagai dievakuasi dan vakum membebaskan ruang disk. </font><font style="vertical-align: inherit;">Mekanisme seperti itu cukup cepat. </font><font style="vertical-align: inherit;">Di Oracle, untuk rollback, data dipulihkan dari undo log. </font><font style="vertical-align: inherit;">Dalam hal ini, waktu operasi meningkat, namun, masih jauh lebih cepat daripada di loker. </font><font style="vertical-align: inherit;">MySQL bekerja dengan cara yang sama seperti Oracle.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendekatan optimis baik karena penulis tidak menghalangi pembaca, pembaca hanya membaca versinya dari data. </font><font style="vertical-align: inherit;">Oleh karena itu, versi bermanfaat jika beban utama adalah membaca daripada menulis (blog, pelaporan, dan kasus-kasus lain di mana Anda perlu sering membaca dan banyak).</font></font><br>
<br>
<hr><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari lebih lanjut tentang kursus di sini.</font></font></a></b><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id504180/index.html">Kisah bagaimana kami menjinakkan BigQuery</a></li>
<li><a href="../id504182/index.html">Reviewix Solution500 C500 3D Scanner</a></li>
<li><a href="../id504184/index.html">Membuat bot perdagangan menggunakan pembelajaran mesin dalam analisis deret waktu</a></li>
<li><a href="../id504186/index.html">Paul Graham: Cara Menulis Teks yang Berguna (Lengkap)</a></li>
<li><a href="../id504188/index.html">Karantina, sistem online, dan ilmu data. Siapa yang berpikir tentang retensi pelanggan?</a></li>
<li><a href="../id504194/index.html">Hasil survei pengembang di Stack Overflow 2020 (+ habraopros)</a></li>
<li><a href="../id504196/index.html">NFC: Parsing Near Field Communication Technology</a></li>
<li><a href="../id504198/index.html">SwiftUI di rak: Animasi. Bagian 1</a></li>
<li><a href="../id504204/index.html">Lokakarya IBM: Quarkus (Ultrafast Java for Microservices), Jakarta EE, dan OpenShift</a></li>
<li><a href="../id504208/index.html">Cara Mengotomasi Pusat Layanan Bersama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>