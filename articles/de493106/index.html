<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèæ üëêüèΩ üâë Wie viel ist neu im Dutzend des Teufels? üßóüèæ üç≤ ü•ì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir sprechen nur √ºber PostgreSQL 13. Am 8. April fand ein "Einfrieren" statt - das Einfrieren von PostgreSQL- Funktionen . Jetzt werden nur die Funkti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wie viel ist neu im Dutzend des Teufels?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/493106/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir sprechen nur √ºber PostgreSQL 13. Am 8. April fand ein "Einfrieren" statt - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Einfrieren von</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PostgreSQL- </font><b><font style="vertical-align: inherit;">Funktionen</font></b><font style="vertical-align: inherit;"> . Jetzt werden nur die Funktionen in diese Version aufgenommen, die vor diesem Datum akzeptiert wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist schwer, eine revolution√§re Version davon zu nennen. </font><font style="vertical-align: inherit;">Es gibt keine wesentlichen konzeptionellen √Ñnderungen. </font><font style="vertical-align: inherit;">Dar√ºber hinaus hatten so wichtige Patches wie Tabelle und Funktionen f√ºr den JSON / SQL-Standard, die ich in PG12 neben dem JSONPath-Patch sehen wollte, keine Zeit, ihn einzugeben. </font><font style="vertical-align: inherit;">Ein vorgefertigter eingebetteter Speicher wurde nicht angezeigt - nur die Schnittstelle wird finalisiert. </font><font style="vertical-align: inherit;">Die Liste der Verbesserungen ist jedoch immer noch beeindruckend. </font><font style="vertical-align: inherit;">Wir haben eine ziemlich vollst√§ndige Zusammenfassung der Patches vorbereitet, die im Devil's Dozen enthalten sind.</font></font></i><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñnderungen an SQL-Befehlen</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE DATABASE ... LOCALE</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dienstprogramme</font></font><code>initdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>createdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und das Team</font></font><code>CREATE COLLATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">haben eine Einstellung</font></font><code>LOCALE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Sie Werte f√ºr das Recht angeben kann</font></font><code>LC_CTYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>LC_COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jetzt erschien die gleiche Gelegenheit im Team</font></font><code>CREATE DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db_koi8r <span class="hljs-keyword">TEMPLATE</span> template0 
    <span class="hljs-keyword">ENCODING</span> <span class="hljs-string">'KOI8R'</span> LOCALE <span class="hljs-string">'ru_RU.KOI8R'</span>;</code></pre><a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER VIEW ... RENAME COLUMN</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Spaltenname in der Ansicht kann jetzt mit dem Befehl ge√§ndert werden</font></font><code>ALTER VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zuvor musste die Ansicht neu erstellt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, Sie haben vergessen, der Spalte einen Namen zu geben:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">current_timestamp</span>, <span class="hljs-built_in">current_timestamp</span> - pg_postmaster_start_time();
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |    ?column?     <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:00.088824+03 | 04:18:24.897856</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es kann behoben werden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> "?column?" <span class="hljs-keyword">TO</span> uptime;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |     uptime      <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:40.726516+03 | 04:19:05.535548</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TABLE ... ALTER COLUMN ... DROP EXPRESSION</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Die generierte Spalte der Tabelle kann jetzt normalisiert werden, dh der Ausdruck wird gel√∂scht, um ihn auszuwerten:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> payments (<font></font>
    id <span class="hljs-type">integer</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    income_tax <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> (amount*<span class="hljs-number">0.13</span>) STORED<font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> payments(id, amount) <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-number">42</span>);<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                                     Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable |                   Default            <font></font>
        <font></font>
------------+---------------+-----------+----------+--------------------------------------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          | generated always as ((amount * 0.13))<font></font>
 stored<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anschlie√üend beschlossen sie, die Einkommenssteuer explizit festzulegen. </font><font style="vertical-align: inherit;">L√∂schen Sie den Ausdruck:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> payments <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> income_tax <span class="hljs-keyword">DROP</span> EXPRESSION;<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                   Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable | Default<font></font>
------------+---------------+-----------+----------+---------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          |<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich sind die vorhandenen Daten aus der Spalte nicht verschwunden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> payments;</code></pre><br>
<pre><code class="plaintext hljs"> id | amount | income_tax<font></font>
----+--------+------------<font></font>
  1 |  42.00 |       5.46</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DROP DATABASE ... FORCE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn Sie f√ºr alle Benutzer zu trennen</font><font style="vertical-align: inherit;">ohne</font><font style="vertical-align: inherit;">warten</font><font style="vertical-align: inherit;">eine Datenbank l√∂schen m√∂chten, k√∂nnen Sie den neuen verwenden</font></font><code>FORCE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl</font><font style="vertical-align: inherit;">Option</font></font><code>DROP DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie eine Verbindung zur neuen Datenbank her:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> dblink;
<span class="hljs-keyword">SELECT</span> dblink_connect(<span class="hljs-string">'dbname=db'</span>);</code></pre><br>
<pre><code class="plaintext hljs"> dblink_connect<font></font>
----------------<font></font>
 OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt werden wir </font></font><code>pg_terminate_backend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offene Verbindungen </font><font style="vertical-align: inherit;">l√∂schen und gewaltsam unterbrechen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DATABASE</span> db <span class="hljs-keyword">WITH</span> (FORCE);</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TYPE ... SET STORAGE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Mit dem Befehl</font></font><code>ALTER TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k√∂nnen grundlegende Datentypen verschiedene Eigenschaften √§ndern, insbesondere die Speicherstrategie. </font><font style="vertical-align: inherit;">Bisher konnte man es nur in einem Team einstellen</font></font><code>CREATE TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Demonstration erstellen wir keinen neuen Basistyp, sondern verwenden den vorhandenen -</font></font><code>tsquery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Erstellen Sie zun√§chst eine separate Datenbank und stellen Sie eine Verbindung dazu her:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;<font></font>
\c db</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Datentyp tsquery wird eine Speicherstrategie verwendet </font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sodass Spalten von Tabellen dieses Typs dieselbe Strategie erhalten:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | p</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | p</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie f√ºr neue Tabellen eine andere Strategie verwenden m√ºssen, k√∂nnen Sie den Basistyp √§ndern:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=<span class="hljs-keyword">external</span>);
<span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Art des Speichers in den neuen Tabellen √§ndert sich ebenfalls:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> new_queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'new_queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sollte bedacht werden, dass eine √Ñnderung einer Strategie, die den Einsatz von TOAST beinhaltet, </font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nicht wieder </font><font style="vertical-align: inherit;">ge√§ndert werden kann in </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=plain);</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  cannot change type's storage to PLAIN</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher wurden die Experimente in einer separaten Datenbank durchgef√ºhrt, was nicht zu l√∂schen ist. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER STATISTICS ... SET STATISTICS Mit dem</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Befehl </font></font><code>CREATE STATISTICS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k√∂nnen Sie Listen der h√§ufigsten Werte f√ºr ausgew√§hlte Kombinationen von Tabellenspalten erfassen. </font><font style="vertical-align: inherit;">Die Anzahl der am h√§ufigsten erfassten Werte wird durch den Parameter bestimmt </font></font><code>default_statistics_target</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der Wert f√ºr bestimmte Statistiken kann jetzt mit dem folgenden Befehl ge√§ndert werden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">STATISTICS</span>  <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATISTICS</span> _;</code></pre><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FETCH FIRST with WITH TIES-Option</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wie Sie wissen, k√∂nnen Sie</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anstelle eines</font><font style="vertical-align: inherit;">Befehls</font></font><code>LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die im SQL-Standard definierte Syntax verwenden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
(2 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt </font></font><code>FETCH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterst√ºtzt es die Phrase </font></font><code>WITH TIES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die der Ausgabe alle "verwandten" Zeilen hinzuf√ºgt (Zeilen, die den bereits ausgew√§hlten entsprechen, wenn nur die Sortierbedingung ber√ºcksichtigt wird):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">WITH</span> TIES;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
 2 | 2.2<font></font>
(3 rows)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrierte Funktionen und Datentypen</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_random_uuid Die</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
neue Funktion</font></font><code>get_random_uuid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt den UUID-Wert der Version 4 (Zufallswert) zur√ºck:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gen_random_uuid();</code></pre><br>
<pre><code class="plaintext hljs">           gen_random_uuid            <font></font>
--------------------------------------<font></font>
 25e02793-80c0-438c-be07-c94b966c43ab</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion ist n√ºtzlich, um eindeutige UUID-Werte in verteilten Systemen zu generieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuvor mussten Sie die Bibliotheken uuid-ossp oder pgcrypto verwenden. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">min_scale und trim_scale f√ºr Werte vom Typ numerisch</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Die Funktion </font></font><code>min_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bestimmt die Anzahl der signifikanten Stellen im Bruchteil der Zahl, und die Funktion </font></font><code>trim_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verwirft </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;">nicht</font></b></a><font style="vertical-align: inherit;"> signifikante </font><font style="vertical-align: inherit;">Nullen:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> n, min_scale(n), trim_scale(n) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">42.42000</span>)) <span class="hljs-keyword">as</span> t(n);</code></pre><br>
<pre><code class="plaintext hljs">    n     | min_scale | trim_scale<font></font>
----------+-----------+------------<font></font>
 42.42000 |         2 |      42.42</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcd und lcm</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nachschub im Abschnitt der mathematischen Funktionen. </font><font style="vertical-align: inherit;">Jetzt k√∂nnen Sie schnell den gr√∂√üten gemeinsamen Teiler (</font></font><code>gcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) und das kleinste gemeinsame Vielfache (</font></font><code>lcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) finden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gcd(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>), lcm(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>);</code></pre><br>
<pre><code class="plaintext hljs"> gcd | lcm<font></font>
-----+-----<font></font>
   6 | 216</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aggregatfunktionen min und max f√ºr Typ pg_lsn</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aggregatfunktionen wurden f√ºr den zus√§tzlichen</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Datentyp</font><font style="vertical-align: inherit;">und</font><font style="vertical-align: inherit;">dass k√∂nnen Sie Abfragen der Form auszuf√ºhren:</font></font><code>pg_lsn</code><font style="vertical-align: inherit;"></font><code>min</code><font style="vertical-align: inherit;"></font><code>max</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> min(restart_lsn) <span class="hljs-keyword">FROM</span> pg_replication_slots;
<span class="hljs-keyword">SELECT</span> min(sent_lsn) <span class="hljs-keyword">FROM</span> pg_stat_replication;</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberpr√ºfen des Typmodifikators des R√ºckgabewerts einer Funktion</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In fr√ºheren Versionen wurde der Typmodifikator nicht auf den R√ºckgabewert der Funktion √ºberpr√ºft. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, es gibt einen Typ zum Speichern von Geldeinheiten und eine Funktion, die den Betrag der Einkommensteuer zur√ºckgibt:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TYPE</span> currency <span class="hljs-keyword">AS</span> (<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    code   <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> income_tax(quantity currency) <span class="hljs-keyword">RETURNS</span> currency
    <span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT quantity.amount * 0.13, quantity.code'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir die Funktion aufrufen, erwarten wir zwei Dezimalstellen, jedoch vier. </font><font style="vertical-align: inherit;">Auch explizites Casting nach einem Funktionsaufruf hilft nicht (dritte Spalte):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]--<font></font>
amount | 5.5146<font></font>
code   | <font></font>
amount | 5.5146</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 13 ist das Ergebnis korrekt:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]<font></font>
amount | 5.51<font></font>
code   | <font></font>
amount | 5.51</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die lokalisierten Namen in to_date () und to_timestamp ()</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Funktionen</font></font><code>to_date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auch</font></font><code>to_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gelernt</font><font style="vertical-align: inherit;">die lokalisierten Namen der Monate und Tage der Woche zu verstehen. </font><font style="vertical-align: inherit;">Bisher konnten nur englische Namen verwendet werden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> to_date(<span class="hljs-string">', 24  2020'</span>, <span class="hljs-string">'TMDay, DD TMMonth YYYY'</span>);</code></pre><br>
<pre><code class="plaintext hljs">  to_date   <font></font>
------------<font></font>
 2020-03-24</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normalisieren und IS NORMALISIERT</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Um dem SQL-Standard zu entsprechen, wurde die Funktion normalize () hinzugef√ºgt, um eine Unicode-Zeichenfolge zu normalisieren, und das Pr√§dikat IS NORMALIZED, um zu √ºberpr√ºfen, ob eine Zeichenfolge normalisiert ist.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> str, normalize(str, NFC) <span class="hljs-keyword">AS</span> nfc,<font></font>
       str <span class="hljs-keyword">IS</span> NFC NORMALIZED <span class="hljs-keyword">AS</span> is_nfc_normalized,<font></font>
       normalize(str, NFKC) <span class="hljs-keyword">AS</span> nfkc,<font></font>
       str <span class="hljs-keyword">IS</span> NFKC NORMALIZED <span class="hljs-keyword">AS</span> is_nfkc_normalized
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">U&amp;'\0032\2075'</span>)) <span class="hljs-keyword">AS</span> vals(str)\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]------+---<font></font>
str                | 2‚Åµ<font></font>
nfc                | 2‚Åµ<font></font>
is_nfc_normalized  | t<font></font>
nfkc               | 25<font></font>
is_nfkc_normalized | f</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lesen Sie mehr</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºber UNICODE-Normalisierungsformulare. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xid8-Typ und xid8_current () -Funktion f√ºr 64-Bit-Transaktionsnummern</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ein neuer xid8-Datentyp f√ºr 64-Bit-Transaktionsnummern wurde hinzugef√ºgt. Aber nein, das bedeutet nicht, dass PostgreSQL auf 64-Bit-Transaktionen umgestellt hat: Alles funktioniert genau wie zuvor. Aber einige Funktionen geben einen neuen Typen, zum Beispiel, wird nun f√ºr die </font><font style="vertical-align: inherit;">Verwendung anstelle der alten Funktionen empfohlen pg_current_xact_id txid_current, die zur√ºck int8, und so weiter. N. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue polymorphe Datentypen anycompatible </font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Familientypen </font><font style="vertical-align: inherit;">hinzugef√ºgt </font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblearray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblenonarray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblerange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Im Gegensatz zu Familientypen k√∂nnen Sie </font></font><code>anyelement</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit neuen Typen nicht genau dieselben, sondern tats√§chlich kompatible Typen verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im folgenden Beispiel die Funktion</font></font><code>maximum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">als Argumente definiert als </font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ºbergeben </font></font><code>integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>numeric</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der R√ºckgabewert wird f√ºr diese beiden Typen in einen gemeinsamen Wert konvertiert:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> maximum(a anycompatible, b anycompatible) <span class="hljs-keyword">RETURNS</span> anycompatible
	<span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT CASE WHEN a &gt; b THEN a ELSE b END'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> f, pg_typeof(f) <span class="hljs-keyword">FROM</span> maximum(<span class="hljs-number">42</span>, <span class="hljs-number">42.42</span>) f;</code></pre><br>
<pre><code class="plaintext hljs">   f   | pg_typeof<font></font>
-------+-----------<font></font>
 42.42 | numeric</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√ºber hinaus sind die Typen anycompatible- und any- zwei unabh√§ngige Artengruppen:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> first_elems(a <span class="hljs-type">anyarray</span>, b anycompatiblearray)
    <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span>(a <span class="hljs-type">anyelement</span>, b anycompatible) <span class="hljs-keyword">AS</span> $$<span class="pgsql">
        <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ROW</span>(a[array_lower(a,<span class="hljs-number">1</span>)], b[array_lower(b,<span class="hljs-number">1</span>)]);
    $$</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">sql</span>;
<span class="hljs-keyword">SELECT</span> first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-keyword">ARRAY</span>[<span class="hljs-string">'a'</span>,<span class="hljs-string">'b'</span>,<span class="hljs-string">'c'</span>]) <span class="hljs-keyword">AS</span> str, <font></font>
       first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>],<span class="hljs-keyword">ARRAY</span>[<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>]) <span class="hljs-type">bool</span>;</code></pre><br>
<pre><code class="plaintext hljs">  str  |  bool   <font></font>
-------+---------<font></font>
 (1,a) | (1.1,t)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verfahrenssprachen</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transformation f√ºr Typ bool in PL / Perl</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Zuletzt wurde TRANSFORM von Ivan Panchenko (Postgres Professional) -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bool_plperl festgeschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Postgres √ºbergibt boolesche Werte an</font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder</font><font style="vertical-align: inherit;">in PL / Perl wie</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aber f√ºr Perl ist es</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kein</font><font style="vertical-align: inherit;">boolescher Wert</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sondern nur der Buchstabe f, d. H. </font><font style="vertical-align: inherit;">in einem logischen Kontext die</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wahrheit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dieses Problem kann auf verschiedene Arten gel√∂st werden (siehe</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Korrespondenz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), aber laut Tom Lane ist es am praktischsten, TRANSFORM f√ºr bool zu erstellen. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnelle Ausf√ºhrung einfacher Ausdr√ºcke in PL / pgSQL</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einfache Ausdr√ºcke (die zumindest keine Tabellenaufrufe enthalten und keine Sperren erfordern) sind schneller. </font><font style="vertical-align: inherit;">Bisher wurde in diesen F√§llen unproduktiv Zeit f√ºr die Kontaktaufnahme mit dem Scheduler in jedem Zyklus aufgewendet.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR REPLACE</span> <span class="hljs-keyword">FUNCTION</span> slow_pi() <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">double</span> <span class="hljs-type">precision</span> <span class="hljs-keyword">AS</span> $$<span class="pgsql">
    <span class="hljs-keyword">DECLARE</span>
        a <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        s <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        r <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">0</span>;
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">FOR</span> i <span class="hljs-keyword">IN</span> <span class="hljs-number">1</span> .. <span class="hljs-number">10000000</span> <span class="hljs-keyword">LOOP</span>
            r := r + s/a; a := a + <span class="hljs-number">2</span>; s := -s;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
        <span class="hljs-keyword">RETURN</span> <span class="hljs-number">4</span>*r;
    <span class="hljs-keyword">END</span>;
    $$</span> <span class="hljs-keyword">LANGUAGE</span> plpgsql;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rufen Sie slow_pi () in PG12 auf:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535898497<font></font>
    (1 row)<font></font>
    Time: 13060,650 ms (00:13,061)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt in PG13:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535897915<font></font>
    (1 row)<font></font>
    Time: 2108,464 ms (00:02,108)</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertrauensw√ºrdige Erweiterungen anstelle von pg_pltemplate</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Das Systemverzeichnis wurde um eine Tabelle verringert. </font><font style="vertical-align: inherit;">Gel√∂scht</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es wurden die Eigenschaften von prozeduralen Sprachen gespeichert, die w√§hrend der Ausf√ºhrung ben√∂tigt werden</font></font><code>CREATE LANGUAGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jetzt haben wir beschlossen, die Eigenschaften in den Skripten der Erweiterungen der entsprechenden Sprachen zu registrieren</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Tabelle selbst zu entfernen. </font><font style="vertical-align: inherit;">Um den Plan zu implementieren, muss dem Datenbankeigent√ºmer (ohne Superuser-Rechte) die M√∂glichkeit einger√§umt werden, eine vertrauensw√ºrdige Sprache aus dem Erweiterungsskript zu erstellen. </font><font style="vertical-align: inherit;">Um beispielsweise beispielsweise plpgsql zu erstellen, muss der Datenbankeigent√ºmer kein Superuser sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie folgt erhalten. </font><font style="vertical-align: inherit;">In der Steuerdatei f√ºr Erweiterungen wurde ein neuer logischer Parameter angezeigt</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn beide Parameter</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>superuser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthalten, dann kann die Erweiterung nicht nur vom Superuser, sondern auch vom Benutzer mit dem Recht </font></font><code>CREATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf die aktuelle Datenbank (und damit deren Eigent√ºmer) erstellt werden. </font><font style="vertical-align: inherit;">Bei der Ausf√ºhrung eines Skripts einer solchen Erweiterung werden die Superuser-Rechte verwendet, mit denen der Cluster initialisiert wurde. </font><font style="vertical-align: inherit;">Die von der Erweiterung erstellten Objekte geh√∂ren dazu, obwohl der Eigent√ºmer der Erweiterung selbst der erstellende Benutzer ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wichtige Folgen dieser √Ñnderungen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertrauensw√ºrdige Erweiterungen erm√∂glichen Drittentwicklern das Erstellen anderer vertrauensw√ºrdiger Sprachen. </font><font style="vertical-align: inherit;">Jetzt sind wir nur noch auf plpgsql, plperl und pltcl beschr√§nkt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es </font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">war schwer zu schreiben, dass sich plpython auf die zweite Version der Sprache bezieht. </font><font style="vertical-align: inherit;">Andernfalls </font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist ein Schritt (notwendig, aber nicht ausreichend) zum √úbergang zu Python 3.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indizes</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komprimierung des B-Baums</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ein wichtiger und lang erwarteter (die Arbeit begann bereits 2015) Patch, der von Anastasia Lubennikova (Postgres Professional) und Peter Geigan (Peter Geoghegan) geschrieben wurde, wird schlie√ülich von Peter kommuniziert. Nastya hat es geschafft,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf der PGconf India dar√ºber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"> sprechen</font></a><font style="vertical-align: inherit;"> . Postgres hat gelernt, die Gr√∂√üe von B-Tree-Indizes durch Deduplizierung, dh Einsparungen bei doppelten Indexschl√ºsseln, erheblich zu reduzieren. Diese Indizes wurden grundlegend √ºberarbeitet, sodass eine Komprimierung ohne Verlust der Kompatibilit√§t mit fr√ºheren Indexversionen m√∂glich ist. Die Idee der Deduplizierung basiert auf einer flexibleren Architektur von Indizes wie</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Reverse Indexes - Generalized Inverted Index).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesen Indizes h√§ufiger als im</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> B-Baum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt eine Situation, in der ein Schl√ºssel einer gro√üen Anzahl von Datens√§tzen entspricht. Beispielsweise wird bei der Textverarbeitung das gleiche Token normalerweise in mehreren Dokumenten gefunden. Und es wird nur einmal im Index gespeichert. Bis vor kurzem wussten B-Tree-Indizes nicht, wie das geht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
B-Tree-Indizes unterscheiden sich von GIN-Indizes haupts√§chlich auf Blattseiten. Abh√§ngig von der Anzahl der Datens√§tze, die sich auf denselben Schl√ºsselwert beziehen, sind Optionen m√∂glich: Die Seite enth√§lt nur eine Buchungsliste - eine Liste von TIDs (Kennungen von indizierten Datens√§tzen), wenn die Liste klein ist und wenn viele TIDs vorhanden sind, werden anstelle einer Liste von Werten gespeichert Neue ‚ÄûBaumzweige‚Äú - Links zu anderen Seiten wie der Buchungsliste oder anderen √Ñsten (sie werden als Buchungsbaum bezeichnet).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine solche Baumstruktur √§hnelt einem B-Baum, unterscheidet sich jedoch in wesentlichen Details: Beispielsweise sind Listen zum Durchbl√§ttern von Seiten derselben Baumebene in der GIN unidirektional und nicht bidirektional. Daher ist (einschlie√ülich) eine gute Kompatibilit√§t neuer, deduplizierter Indizes mit alten Versionen nicht einfach zu erreichen. Und die Verbesserungen haben wirklich mehr als 3 Jahre gedauert. Es war auch notwendig, den Reinigungsmechanismus (Mikrovakuum) und andere Nuancen zu erarbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Leistungstests sind alle Indizes, f√ºr die die Deduplizierung gilt, um das Dreifache geschrumpft. Das Komprimieren von Duplikaten hilft auch bei eindeutigen Indizes, wodurch das Problem der Indexschwellung bei einer hohen Rate von Tabellen√§nderungen beseitigt wird. Neues Verhalten kann auf der Ebene der Indexeinstellungen verbunden und getrennt werden. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein vollst√§ndiger Scan nach GIN-Index wird nicht durchgef√ºhrt, wenn dies nicht erforderlich ist</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesem Patch kann in einigen F√§llen ein vollst√§ndiger Durchlauf des gesamten GIN-Index vermieden werden. </font><font style="vertical-align: inherit;">Einige Vorg√§nge werden, obwohl sie vom GIN-Index unterst√ºtzt werden, durch einen vollst√§ndigen Scan des Index ausgef√ºhrt. </font><font style="vertical-align: inherit;">Nehmen Sie zum Beispiel den Index f√ºr die Volltextspalten-Suche </font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn die Suchabfrage die Form "alles andere als ein bestimmtes Wort" hat, muss der gesamte Index vollst√§ndig gelesen werden. </font><font style="vertical-align: inherit;">Wenn jedoch eine andere Bedingung in der Anforderung vorhanden ist, die keinen vollst√§ndigen Scan des Index erfordert, wird der Index weiterhin vollst√§ndig gescannt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der neuen Optimierung wird zuerst eine genauere Bedingung verwendet, sodass Sie einen Gewinn aus dem Index ziehen k√∂nnen. Anschlie√üend werden die Ergebnisse doppelt √ºberpr√ºft, um eine weitere Einschr√§nkung zu ber√ºcksichtigen. </font><font style="vertical-align: inherit;">Vergleichen Sie die Anzahl der Seiten, die in Version 12 (Puffer) gelesen wurden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5167<font></font>
   Buffers: shared hit=24 read=27405<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=24 read=22238<font></font>
 Planning Time: 0.283 ms<font></font>
 Execution Time: 3258.234 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mit der Anzahl der Puffer in der neuen Version:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
---------------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5156<font></font>
   Buffers: shared hit=5179<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=23<font></font>
 Planning Time: 0.250 ms<font></font>
 Execution Time: 8.779 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine √§hnliche Situation kann auftreten, wenn Trigramme verwendet werden und wenn das Auftreten von Arrays √ºberpr√ºft wird. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter von Operatorklassen</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In PostgreSQL sind viele Indexzugriffsmethoden ein ‚ÄûFramework‚Äú, das eine allgemeine Implementierung des Suchalgorithmus √ºbernimmt und mit Seiten und Sperren sowie dem WAL-Protokoll arbeitet. Die Bindung an bestimmte Datentypen und Operatoren erfolgt mithilfe von Operatorklassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher konnten Operatorklassen keine Parameter haben. Zum Beispiel f√ºr eine Volltextsuche, ein GiST Index mit einer Klasse von Operatoren kann verwendet werden </font></font><code>tsvector_ops</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(√ºber Klassen von GiST Betreibern </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Diese Klasse von Operatoren verwendet einen Signaturbaum, und die Signaturl√§nge wurde festgelegt (124 Byte). Jetzt k√∂nnen Sie die L√§nge explizit angeben, wodurch Sie das Gleichgewicht zwischen der Gr√∂√üe des Index und der Effizienz (der Anzahl der Hash-Kollisionen) steuern k√∂nnen:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> mail_messages <span class="hljs-keyword">USING</span> gist(tsv tsvector_ops(siglen=<span class="hljs-number">1024</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ñhnliche √Ñnderungen wurden f√ºr den Anfang f√ºr andere Klassen von GiST-Operatoren vorgenommen, die einen Signaturbaum verwenden, der f√ºr die Erweiterungen hstore, intarray, ltree und pg_trgm gilt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptidee, f√ºr die diese √Ñnderung konzipiert wurde, ist die M√∂glichkeit, den JSONPath-Ausdruck an den GIN-Index zu √ºbergeben, sodass nicht das gesamte JSON-Dokument indiziert wird, sondern nur der erforderliche Teil davon. In vielen F√§llen wird dadurch die Gr√∂√üe der Indizes radikal reduziert. Diese Arbeit bleibt jedoch noch zu erledigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Idee von Oleg Bartunov, die Umsetzung von Nikita Glukhov und Alexander Korotkov (alle drei Postgres Professional). </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Operator &lt;-&gt; (Feld, Punkt) wurde</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
hinzugef√ºgt. Die fehlende Operation wurde zur Verwendung in kNN f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GiST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SP-GiST hinzugef√ºgt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In PG12 beim Arbeiten mit geometrischen Typen </font></font><code>point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen den Entfernungsoperator verwenden, der </font></font><code>&lt;-&gt;(point, box)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Suche mit den Indizes GiST und SP-GiST beschleunigt. </font><font style="vertical-align: inherit;">Der f√ºr ihn symmetrische Operator </font></font><code>&lt;-&gt;(box, point)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wurde jedoch nicht implementiert, obwohl er </font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Abst√§nde zu komplexeren Typen - Polygonen und Kreisen - bereits verstand.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> points(<span class="hljs-type">point</span> <span class="hljs-type">point</span>);
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> boxes(<span class="hljs-type">box</span> <span class="hljs-type">box</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> points <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'1,2'</span>,<span class="hljs-string">'3,4'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> boxes <span class="hljs-keyword">VALUES</span>(box(<span class="hljs-type">point</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>),<span class="hljs-type">point</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)), box(<span class="hljs-type">point</span>(<span class="hljs-number">13</span>,<span class="hljs-number">14</span>),<span class="hljs-type">point</span>(<span class="hljs-number">15</span>,<span class="hljs-number">16</span>)));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PG12:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs">:    : box &lt;-&gt; point</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn umgekehrt, dann ist alles in Ordnung:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, p.point  &lt;-&gt; b.box distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und in PG13:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GiST- und SP-GiST-Indizes werden bei dieser Operation beschleunigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass in PG13, wenn Sie fragen:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> pg_operator <span class="hljs-keyword">WHERE</span> oprname = <span class="hljs-string">'&lt;-&gt;'</span>;</code></pre><pre><code class="plaintext hljs"> count <font></font>
-------<font></font>
    28</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und wenn wir dasselbe in PG12 tun, erhalten wir 20 Eintr√§ge: In der 13. Version wurde die Liste mit bis zu 8 Operatoren aufgef√ºllt.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Json</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unterst√ºtzung f√ºr die .datetime () -Methode f√ºr jsonpath</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dies ist einer der erfolglosen Patches einer gro√üen Reihe von</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JSONPath-Patches, f√ºr deren Abschluss PG12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keine Zeit hatte. Teil des JSON / SQL-Standards. Das Problem war, dass alle Funktionen in der JSONPath-Patch-Serie unver√§nderlich sind, der Datumsvergleich jedoch die aktuelle Zeitzone ber√ºcksichtigt, die sich w√§hrend der Sitzung √§ndern kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In solchen F√§llen erlauben wir vorhandenen unver√§nderlichen Funktionen, einen Fehler bei nicht unver√§nderlichen Vergleichen auszul√∂sen. Gleichzeitig verf√ºgt dieser Patch √ºber Funktionen mit dem Suffix _tz, die bei Operationen mit Zeitzone stabil funktionieren.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Neue Funktion - jsonb_set_lax Funktion</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen ist lax eine nicht strenge (im Gegensatz zu strengen) Funktionsweise von Funktionen mit jsonb. In diesem Fall ist diese Funktion in einer Situation funktionsf√§hig, in der eines der Argumente NULL ist. Im Gegensatz zur strengen Version - jsonb_set () - gibt es ein zus√§tzliches Argument, das Aktionen im Fall von NULL angibt. Optionen: use_json_null / raise_exception / return_target / delete_key. Von interessierten Benutzern vorgeschlagene Optionen. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige jsonb-Funktionen wurden</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
optimiert. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Viel</font></a><font style="vertical-align: inherit;"> optimiert </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, haupts√§chlich durch die Bem√ºhungen von Nikita Glukhov (Postgres Professional). </font><font style="vertical-align: inherit;">Aber jeden Punkt in diesem Fall zu analysieren ist sinnlos: Erstens wird ihre F√ºlle einen bereits kurzen Artikel aufblasen; </font><font style="vertical-align: inherit;">und zweitens beziehen sich die √Ñnderungen auf das interne Ger√§t, und nicht jeder Benutzer ist interessiert. </font><font style="vertical-align: inherit;">Daher werden wir nur die meisten auflisten:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimierte Funktion JsonbExtractScalar ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimierter Operator # &gt;&gt;, Funktionen jsonb_each_text (), jsonb_array_elements_text ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Erkennung des Typs JsonbContainer in get_jsonb_path_all () ist optimiert.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Abrufen des ersten Tokens vom JsonbIterator-Iterator wird durch das einfache Makro JsonbContainerIsXxx () ersetzt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bequemere Schl√ºsselextraktion - findJsonbKeyInObject ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimierte Speicherung der Ergebnisse findJsonbValueFromContainer () und getIthJsonbValueFromContainer ();</font></font></li>
<li>  get_jsonb_path_all(),     ;<br>
  JsonbValueAsText.</li>
</ol><br>
<i> ,        SQL/JSON: JSON_TABLE  SQL/JSON: functions.       . ,   .      .     PG14.   JSONPath   .</i><br>
<br>
<h3>  </h3><br>
<h4>pgbench</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Dienstprogramm zum Ausf√ºhren von Leistungstests erhielt eine Reihe von Verbesserungen. </font><font style="vertical-align: inherit;">Es gab </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statistiken √ºber die Ausf√ºhrung von</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufgaben in der Initialisierungsphase, eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visuellere Schlussfolgerung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die M√∂glichkeit, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Code integrierter Skripte anzuzeigen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Tests </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an einer partitionierten Kontenliste</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durchzuf√ºhren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√ºber hinaus haben wir einen </font></font><code>\aset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√§hnlichen </font><font style="vertical-align: inherit;">Befehl hinzugef√ºgt </font></font><code>\gset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der jedoch das Festlegen von Werten f√ºr Variablen mehrerer gleichzeitig gesendeter Anforderungen erm√∂glicht. </font><font style="vertical-align: inherit;">Die folgende Zeile, die zur Ausf√ºhrung an den Server gesendet wird, legt beide Variablen </font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und fest </font></font><code>two</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> one \; <span class="hljs-keyword">SELECT</span> <span class="hljs-number">2</span> <span class="hljs-keyword">AS</span> two \aset</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_dump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_dump hat gelernt, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten aus Tabellen von Drittanbietern</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">entladen</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">√úber den Parameter k√∂nnen </font></font><code>--include-foreign-data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie eine Liste von Servern von Drittanbietern angeben, deren Daten aus den Tabellen entladen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie beim Entladen vorsichtig vor. </font><font style="vertical-align: inherit;">Weit davon entfernt, dass die Daten auf einen Drittanbieter-Server hochgeladen werden m√ºssen. </font><font style="vertical-align: inherit;">Dar√ºber hinaus ist es durchaus m√∂glich, dass w√§hrend der Wiederherstellung kein Server eines Drittanbieters verf√ºgbar ist. </font><font style="vertical-align: inherit;">Oder ein Server eines Drittanbieters kann nur das Lesen, aber nicht das Schreiben von Daten zulassen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psql</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Reihe kleiner Patches macht psql komfortabler:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbesserte Tab-Vervollst√§ndigung f√ºr mehrere Teams.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zus√§tzlich zum </font></font><code>\echo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senden einer Zeichenfolge an STDOUT </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>\warn</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendet ein </font><font style="vertical-align: inherit;">neuer Befehl </font><font style="vertical-align: inherit;">eine Zeichenfolge an die Standardfehlerausgabe (STDERR).</font></font></li>
<li> <code>\d</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> toast-</a>       .        <code>\d+</code>        .</li>
<li>  <code>\dt+</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  ¬´Persistence¬ª</a>      (unlogged)   (permanent).</li>
<li>  <code>\e</code>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a>,       <code>;</code> (  <code>\g*</code>). ,       psql      .</li>
<li>         .     <code>PROMPT1</code>  <code>PROMPT2</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> <code>%x</code>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue Befehle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr weitere Informationen √ºber Zugriffsmethoden: </font></font><code>\dAc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>\dAf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>\dAo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>\dAp</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">k√∂nnen</font></a></font><code>\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jetzt </font><font style="vertical-align: inherit;">in Klammern alle unterst√ºtzten Optionen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">angeben</font></font></a><font style="vertical-align: inherit;"></font><code>\pset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie werden nur im aktuellen Team agieren.</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libpq</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kleinere √Ñnderungen im Zusammenhang mit PostgreSQL:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ungenauigkeit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Beschreibung der Host- und Hostadr-Parameter und die daraus resultierende Inkonsistenz in der Ausgabe des </font></font><code>\conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dienstprogrammbefehls psql wurden behoben.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn der Client-Zertifikatschl√ºssel verschl√ºsselt gespeichert ist, k√∂nnen Sie das Kennwort nur im interaktiven Modus eingeben. </font><font style="vertical-align: inherit;">Mit dem neuen Parameter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslpassword k√∂nnen Sie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Schl√ºssel nicht interaktiv entschl√ºsseln.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit zwei neuen Parametern, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslminprotocolversion und sslmaxprotocolversion,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen Sie eine Einschr√§nkung f√ºr die Version des SSL / TCL-Protokolls festlegen, mit der die Verbindung zul√§ssig ist.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reindexdb</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der neue Parameter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--jobs des</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstprogramms </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">reindexdb</font></a><font style="vertical-align: inherit;"> legt die Anzahl der Datenbankverbindungen fest, in denen Indizes gleichzeitig neu erstellt werden.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_rewind</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Einschr√§nkungen des Dienstprogramms werden allm√§hlich aufgehoben, und die M√∂glichkeiten nehmen zu. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens kann pg_rewind </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jetzt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informationen f√ºr die Wiederherstellung aufzeichnen (wie pg_basebackup dies kann) sowie die Wiederherstellung und das anschlie√üende Herunterfahren einer Instanz starten, wenn sie nicht √ºber einen Pr√ºfpunkt gestoppt wurde (dies musste zuvor manuell erfolgen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und zweitens hat pg_rewind gelernt, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem WAL-Archiv zu arbeiten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem das Dienstprogramm den WAL-Divergenzpunkt zwischen den beiden Servern gefunden hat, sollte es eine Liste aller Seiten erstellen, die in den Zielcluster kopiert werden m√ºssen, um die Unterschiede zu beseitigen. </font><font style="vertical-align: inherit;">Dazu ben√∂tigt das Dienstprogramm alle WAL-Dateien ab dem gefundenen Punkt. </font><font style="vertical-align: inherit;">Wenn die erforderlichen WAL-Dateien im Zielcluster nicht verf√ºgbar sind, konnte das Dienstprogramm seine Arbeit zuvor nicht ausf√ºhren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesem Patch von Alexey Kondratov (Postgres Professional) kann pg_rewind die fehlenden WAL-Segmente aus dem Archiv der Protokolldateien mithilfe des Parameters restore_command lesen, wenn ein neuer Schalter -c oder --restore-target-wal angegeben wird.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_waldump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_waldump </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entschl√ºsselt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den vorbereiteten Transaktionsdatensatz.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amcheck</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Amcheck-Erweiterung hat gelernt, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sch√§den</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in B-Tree-Indizes </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">besser zu erkennen</font></a><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úbrigens unterscheiden sich Nachrichten im Serverprotokoll √ºber besch√§digte Seiten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr Indizes und Tabellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pageinspect</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><code>heap_tuple_infomask_flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pageinspect-Erweiterungsfunktion </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entschl√ºsselt die Werte der Felder</font></font></a> <code>infomask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und gibt sie </font></font><code>infomask2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von der Funktion zur√ºck </font></font><code>heap_page_items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">N√ºtzlich bei der Untersuchung von Datenkorruptionssituationen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgres_fdw</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Superuser auf der Ebene der Benutzernamenzuordnung kann </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">regul√§ren Benutzern erm√∂glichen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , eine Verbindung ohne Kennwort zu verwenden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-keyword">MAPPING</span> <span class="hljs-keyword">FOR</span>  <span class="hljs-keyword">SERVER</span> 
    <span class="hljs-keyword">OPTIONS</span> (<span class="hljs-keyword">ADD</span> password_required <span class="hljs-string">'false'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies geschieht unter anderem, damit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslkey und sslcert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Verbindungsparameter verwendet werden k√∂nnen </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adminpack</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Adminpack-Erweiterung hat eine neue Funktion - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>pg_file_sync</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mit dieser Funktion k√∂nnen Sie fsync f√ºr Dateien ausf√ºhren, die vom Server auf die Festplatte geschrieben wurden, z. B. √ºber </font></font><code>pg_file_write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>COPY TO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberwachung</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_slru</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im gemeinsam genutzten Speicher des Servers befindet sich nicht nur ein gro√üer Puffercache, sondern auch eine Reihe anderer, einfacherer Caches (z. B. f√ºr den Transaktionsstatus). </font><font style="vertical-align: inherit;">Sie verwenden einen einfachen Algorithmus zum Verdr√§ngen der am seltensten verwendeten Seiten (einfache, am wenigsten k√ºrzlich verwendete oder SLRU). </font><font style="vertical-align: inherit;">Bisher haben solche Caches ‚Äûnur funktioniert‚Äú, aber sie mussten zun√§chst √ºberwacht werden, damit die Entwickler des PostgreSQL-Kernels herausfinden konnten, ob in ihnen etwas ge√§ndert werden muss. </font><font style="vertical-align: inherit;">Zu diesem Zweck wurde eine neue Ansicht von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_slru angezeigt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_activity</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Ansicht, die </font></font><code>pg_stat_activity</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neue Spalte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">F√ºr Prozesse, die an parallelen Anforderungen teilnehmen, wird die Nummer des f√ºhrenden Prozesses angegeben. </font><font style="vertical-align: inherit;">Und f√ºhrender Prozess </font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist eine Prozessnummer </font></font><code>pid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die folgende Abfrage zeigt, welche Abfragen und welche Prozesse derzeit parallel ausgef√ºhrt werden:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> query, leader_pid, <font></font>
    array_agg(pid) <span class="hljs-keyword">filter</span>(<span class="hljs-keyword">WHERE</span> leader_pid != pid) <span class="hljs-keyword">AS</span> members
  <span class="hljs-keyword">FROM</span> pg_stat_activity
 <span class="hljs-keyword">WHERE</span> leader_pid <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> query, leader_pid;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt √Ñnderungen an der Liste der wartenden Ereignisse. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zwei neue Ereignisse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzugef√ºgt </font><font style="vertical-align: inherit;">: </font></font><code>BackupWaitWalArchive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>RecoveryPause</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Und die anderen beiden erhielten genauere Namen: </font></font><code>RecoveryWalStream -&gt; RecoveryRetrieveRetryInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>RecoveryWalAll -&gt; RecoveryWalStream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwei weitere neue</font></font></a><font style="vertical-align: inherit;"></font><code>RecoveryConflictSnapshot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Warteereignisse, die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">auf dem Replikat auftreten</font></a><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">(Konflikt mit VACUUM, wodurch die erforderliche Version der Zeilen gel√∂scht wurde) und </font></font><code>RecoveryConflictTablespace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Konflikt im Zusammenhang mit dem Entfernen des Tabellenbereichs).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher hat die Erweiterung </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anfragen mit </font></font><code>FOR UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und ohne Phrase als dieselbe Anfrage behandelt. Jetzt werden Anfragen mit </font></font><code>FOR UPDATE</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">separat erfasst</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Menge der gesammelten Informationen hat zugenommen. Von nun an werden nicht nur Informationen zu Ressourcen f√ºr die Ausf√ºhrung von Befehlen aufgezeichnet, sondern auch </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statistiken zu generierten Journaleintr√§gen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Neue Pr√§sentationsspalten: </font></font><code>wal_bytes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Volumen der generierten Datens√§tze, </font></font><code>wal_records</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Anzahl der generierten Datens√§tze, </font></font><code>wal_num_fpw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Anzahl der ganzseitigen Bilder (ganzseitige Schreibvorg√§nge). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√∂glich wurde dies durch die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vorbereitete Infrastruktur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Verfolgung der Nutzung von WAL. Daher wird jetzt </font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit einer neuen Option </font></font><code>WAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">das Volumen der generierten Datens√§tze angezeigt:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t (id <span class="hljs-type">int</span>);
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, WAL, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">SUMMARY</span> <span class="hljs-keyword">OFF</span>)
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>);</code></pre><br>
<pre><code class="plaintext hljs">              QUERY PLAN              <font></font>
--------------------------------------<font></font>
 Insert on t (actual rows=0 loops=1)<font></font>
   WAL:  records=1  bytes=59<font></font>
   -&gt;  Result (actual rows=1 loops=1)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erweiterung </font></font><code>auto_explain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>VACUUM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font><code>VERBOSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, und verwenden Sie </font></font><code>autovacuum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auch die erstellte Infrastruktur und geben Sie Volumina von WAL aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur√ºck zu </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn der neue Parameter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements.track_planning aktiviert ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , werden f√ºr jeden Operator zus√§tzliche Statistiken zum Scheduler aufgezeichnet: Anzahl der Planerstellungen; </font><font style="vertical-align: inherit;">Gesamtplanungszeit; </font><font style="vertical-align: inherit;">minimale und maximale Zeit einer Planung sowie Mittelwert und Standardabweichung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ber√ºcksichtigung der dem Scheduler zugewiesenen Ressourcen spiegelt sich in einem anderen Patch wider, der nicht in Beziehung steht </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dieser Option </font></font><code>BUFFERS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anzahl der in der Planungsphase verwendeten Puffer angezeigt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
    <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> pg_class;</code></pre><br>
<pre><code class="plaintext hljs">                   QUERY PLAN                   <font></font>
------------------------------------------------<font></font>
 Seq Scan on pg_class (actual rows=386 loops=1)<font></font>
   Buffers: shared hit=9 read=4<font></font>
 Planning Time: 0.782 ms<font></font>
   Buffers: shared hit=103 read=11<font></font>
 Execution Time: 0.219 ms</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeitschrift</font></font></h4><br>
<ul>
<li> <code>log_statement_sample_rate</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   SQL,   </a>,      <code>log_min_duration_sample</code>( ).<br>
,    <code>log_min_duration_statement</code>    , ..  <code>log_min_duration_statement</code> ,  <code>log_min_duration_sample</code>,       ,      <code>log_statement_sample_rate</code>.<br>
 ,   <code>log_transaction_sample_rate</code>    ,       ,      .</li>
<li>  ,   (   log_min_error_statement),         .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>log_parameter_max_length_on_error</code></a>.     0,   .<br>
 <code>log_parameter_max_length_on_error</code>          SQL,    ,      .<br>
    (     <code>log_statements</code>  <code>log_duration</code>)   ,  : <code>log_parameter_max_length</code>,     ,   .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen jetzt </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Prozesstyp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>pg_stat_activity.backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) in das </font><font style="vertical-align: inherit;">Serverprotokoll </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">schreiben</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hierzu </font></font><code>log_line_prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ist </font><font style="vertical-align: inherit;">im Parameter </font><font style="vertical-align: inherit;">ein spezielles Symbol vorgesehen </font></font><code>%b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Und wenn das Protokoll im csv ( </font></font><code>log_destination=csvlog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">-Format geschrieben ist </font><font style="vertical-align: inherit;">, ist die Spalte dort </font></font><code>backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bereits enthalten.</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fortschritt</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neue Ansichten </font></font><code>pg_stat_progress_analyze</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auch </font></font><code>pg_stat_progress_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erm√∂glicht es </font><font style="vertical-align: inherit;">Ihnen , </font><font style="vertical-align: inherit;">den Fortschritt zu verfolgen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statistikerfassung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durch das Team </font></font><code>ANALYZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eine Sicherungskopie des erstellen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstprogramm, </font></font><code>pg_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jeweils.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimierung</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berechnung unver√§nderlicher Funktionen in der FROM-Klausel in der Planungsphase</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Patch von Aleksandr Kuzmenkov und Aleksandr Parfyonov (beide von Postgres Professional) hilft in F√§llen, in denen der</font></font><code>FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufruf einen Funktionsaufruf enth√§lt, der tats√§chlich eine Konstante ist. </font><font style="vertical-align: inherit;">In diesem Fall wird anstelle der Verbindung der konstante Wert an den erforderlichen Stellen der Anforderung ersetzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So geschieht dies anhand eines Beispiels f√ºr eine Abfrage im Zusammenhang mit der Volltextsuche:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                              <font></font>
------------------------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, '''tuple'''::tsquery)) DESC<font></font>
   -&gt;  Bitmap Heap Scan on mail_messages<font></font>
         Recheck Cond: (tsv @@ '''tuple'''::tsquery)<font></font>
         -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
               Index Cond: (tsv @@ '''tuple'''::tsquery)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es besteht keine Verbindung, und der Wert 'tuple' :: tsquery wird in der Abfrage bereits in der Planungsphase ersetzt. </font><font style="vertical-align: inherit;">Version 12 hatte ein ganz anderes Bild:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank                            
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q                            
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                          QUERY PLAN                         <font></font>
-----------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, q.q)) DESC<font></font>
   -&gt;  Nested Loop<font></font>
         -&gt;  Function Scan on q<font></font>
         -&gt;  Bitmap Heap Scan on mail_messages<font></font>
               Recheck Cond: (tsv @@ q.q)<font></font>
               -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
                     Index Cond: (tsv @@ q.q)</code></pre><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inkrementelle Sortierung</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn nach vielen Schl√ºsseln sortiert werden muss (k1, k2, k3 ...), kann der Scheduler jetzt das Wissen nutzen, dass die Daten bereits nach mehreren der ersten Schl√ºssel (z. B. k1 und k2) sortiert sind. In diesem Fall k√∂nnen Sie nicht alle Daten erneut sortieren, sondern sie in aufeinanderfolgende Gruppen mit denselben Werten k1 und k2 unterteilen und nach dem Schl√ºssel k3 ‚Äûsortieren‚Äú.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit wird die gesamte Sortierung in mehrere aufeinanderfolgende Arten kleinerer Gr√∂√üe aufgeteilt. Dies reduziert den Speicherbedarf und erm√∂glicht es Ihnen, die ersten Daten auszugeben, bevor die Sortierung abgeschlossen ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Demobase in der Tickets-Tabelle befindet sich beispielsweise ein Index f√ºr die Spalte ticket_id. </font><font style="vertical-align: inherit;">Vom Index empfangene Daten werden nach ticket_id sortiert, sodass bei der folgenden Abfrage eine inkrementelle Sortierung verwendet wird:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                                  QUERY PLAN                                  <font></font>
------------------------------------------------------------------------------<font></font>
 Incremental Sort (actual rows=2949857 loops=1)<font></font>
   Sort Key: ticket_no, passenger_id<font></font>
   Presorted Key: ticket_no<font></font>
   Full-sort Groups: 92184 Sort Method: quicksort Memory: avg=31kB peak=31kB<font></font>
   -&gt;  Index Scan using tickets_pkey on tickets (actual rows=2949857 loops=1)<font></font>
 Planning Time: 2.137 ms<font></font>
 Execution Time: 2230.019 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inkrementelle Sortierfunktionen k√∂nnen mit dem Parameter enable_incrementalsort deaktiviert werden. </font><font style="vertical-align: inherit;">In diesem Fall dauert das Sortieren merklich l√§nger:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SET</span> enable_incrementalsort = <span class="hljs-keyword">off</span>;
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                               <font></font>
-----------------------------------------------------------------------<font></font>
 Gather Merge (actual rows=2949857 loops=1)<font></font>
   Workers Planned: 2<font></font>
   Workers Launched: 2<font></font>
   -&gt;  Sort (actual rows=983286 loops=3)<font></font>
         Sort Key: ticket_no, passenger_id<font></font>
         Sort Method: external merge  Disk: 107024kB<font></font>
         Worker 0:  Sort Method: external merge  Disk: 116744kB<font></font>
         Worker 1:  Sort Method: external merge  Disk: 107200kB<font></font>
         -&gt;  Parallel Seq Scan on tickets (actual rows=983286 loops=3)<font></font>
 Planning Time: 3.994 ms<font></font>
 Execution Time: 12291.844 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Idee der inkrementellen Sortierung wurde bereits 2013 von Alexander Korotkov (Postgres Professional) vorgeschlagen, und jetzt, sieben Jahre sp√§ter, wurde der Patch von James Coleman in einen von der Gemeinde akzeptierten Zustand gebracht. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUNCATE-Beschleunigung</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Beim </font></font><code>TRUNCATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scannen werden </font></font><code>shared_buffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabellenpuffer aus dem gemeinsam genutzten Speicher entfernt. Zuvor wurde f√ºr jede Tabellenebene dreimal gescannt: MAIN (Hauptdatenschicht), FSM (Freiraumkarte), VM (Sichtbarkeitskarte). Jetzt hat sich die Logik ge√§ndert. Statt einer Dreifachoperation werden die Puffer nur einmal gescannt. Bei gro√üen Werten </font></font><code>shared_buffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ergibt sich ein sp√ºrbarer Gewinn. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teildekompression TOAST</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es nicht erforderlich ist, TOAST vollst√§ndig zu lesen und es auf ein Slice am Anfang oder nahe am Anfang zu beschr√§nken, ist es nicht sinnvoll, es vollst√§ndig zu l√∂sen. </font><font style="vertical-align: inherit;">Komprimierter TOAST wird in Iterationen gelesen: Lesen Sie ein St√ºck, wenn keine erforderlichen Daten vorhanden sind, erweitern Sie es und lesen Sie weiter. </font><font style="vertical-align: inherit;">Vorgeschlagen von einem Google Summer of Code-Studenten, Binguo Bao, der ein Beispiel gibt:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> slicingtest (<font></font>
     id <span class="hljs-type">serial</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
     a <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> slicingtest (a) <span class="hljs-keyword">SELECT</span>
    repeat(<span class="hljs-string">'1234567890-=abcdefghijklmnopqrstuvwxyz'</span>, <span class="hljs-number">1000000</span>) <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">FROM</span>
    generate_series(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<font></font>
\<span class="hljs-keyword">timing</span>
<span class="hljs-keyword">SELECT</span> sum(length(substr(a, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>))) <span class="hljs-keyword">FROM</span> slicingtest;</code></pre><br>
<pre><code class="plaintext hljs">Time: 28.123 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Patch eine Gr√∂√üenordnung schneller:</font></font><br>
<br>
<pre><code class="plaintext hljs">Time: 2.306 ms</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paralleles VAKUUM</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In seinem</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Artikel zu diesem Thema</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erkl√§rt Jegor Rogow diesen wichtigen Schritt der Parallelisierung ausf√ºhrlich. Kurzum: ‚ÄûPatch Masahiko Sawada, mit dem Sie die Reinigung parallel durchf√ºhren k√∂nnen. Die Tabelle selbst wird weiterhin von einem (f√ºhrenden) Prozess gel√∂scht. Zum Bereinigen von Indizes k√∂nnen jetzt Hintergrundworkflows gestartet werden, einer f√ºr jeden Index. Im manuellen Modus k√∂nnen Sie so die Bereinigung gro√üer Tabellen mit mehreren Indizes beschleunigen. Die automatische Reinigung nutzt diese Funktion noch nicht. ‚Äú</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Automatische Reinigung beim Einf√ºgen in eine Tabelle</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr diesen Patch (auch als Berserker Auto-Vakuum bekannt) m√ºssen wir uns bei Dorofei Proleskovsky bedanken, der eine L√∂sung f√ºr das folgende Problem vorgeschlagen hat: Die automatische Reinigung wird nicht in die Tabelle nur zum Anh√§ngen aufgenommen, da sie keine "toten" Versionen der Zeilen enth√§lt. Aus diesem Grund wird die Sichtbarkeitskarte nicht aktualisiert, sodass nur Index-Scans unwirksam werden. Wenn eine Bereinigung erfolgt, um ein √úberlaufen des Transaktionsz√§hlers zu verhindern, muss viel Arbeit auf einmal erledigt werden. Jetzt wurde diese Situation behoben: Die automatische Reinigung funktioniert auch beim Hinzuf√ºgen von Zeilen. Es wurden zwei neue Serverparameter ( </font></font><code>autovacuum_vacuum_insert_threshold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>autovacuum_vacuum_insert_scale_factor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) angezeigt, √§hnlich denen f√ºr √Ñnderungen ( </font></font><code>autovacuum_vacuum_threshold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>autovacuum_vacuum_scale_factor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash Aggregate Memory Management</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hash-Aggregation erfordert m√∂glicherweise mehr RAM als vom Scheduler angenommen und als in angegeben </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Zuvor f√ºhrte ein solcher Scheduler-Fehler dazu, dass die Gr√∂√üe </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ignoriert wurde und so viel Speicher zugewiesen wurde, wie f√ºr den Betrieb oder die Ankunft von OOM Killer erforderlich war. Jetzt geht der Algorithmus m√∂glicherweise nicht dar√ºber hinaus </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und verwendet bei Bedarf tempor√§re Dateien auf der Festplatte. Um das Verhalten des Schedulers zu steuern, wurden die folgenden Parameter angezeigt: </font></font><code>enable_groupingsets_hash_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>enable_hashagg_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPDATE f√ºr Tabellen mit generierten Spalten optimieren</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Version 12 wurden die generierten Spalten w√§hrend einer Zeilenaktualisierung neu berechnet, auch wenn diese √Ñnderung sie in keiner Weise beeinflusste. Jetzt werden sie nur dann neu berechnet, wenn sie wirklich ben√∂tigt werden (wenn sich ihre Basisspalten ge√§ndert haben). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Optimierung kann beispielsweise die Aktualisierung von Tabellen mit einer generierten Typspalte erheblich beschleunigen </font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, da die Funktion </font></font><code>to_tsvector()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recht teuer ist. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zugriff vom Trigger auf die Liste der ge√§nderten Spalten</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ein kleiner Patch, </font></font><code>TriggerData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der </font><font style="vertical-align: inherit;">der Struktur eine </font><font style="vertical-align: inherit;">Bitmap der ge√§nderten Spalten </font><font style="vertical-align: inherit;">hinzuf√ºgt </font><font style="vertical-align: inherit;">. Diese Informationen k√∂nnen von allgemeinen Triggerfunktionen wie </font></font><code>tsvector_update_trigger()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder verwendet werden </font></font><code>lo_manage()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um keine unn√∂tigen Arbeiten auszuf√ºhren. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwendung mehrerer erweiterter Statistiken bei der Auswertung</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PG12 konnte der Scheduler nicht mehrere erweiterte Statistiken f√ºr dieselbe Tabelle gleichzeitig verwenden. Stellen Sie sich beispielsweise eine Situation vor, in der zwei erweiterte Statistiken f√ºr verschiedene Spaltengruppen erstellt werden und Spalten aus einer Gruppe und einer anderen an der Abfrage teilnehmen. Jetzt hat der Planer Zugriff auf alle verf√ºgbaren Informationen. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastruktur f√ºr Parallelisierung und KOPIEREN</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (siehe auch </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diesen Patch.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die PostgreSQL-Parallelit√§t funktioniert weiterhin f√ºr schreibgesch√ºtzte Abfragen. </font><font style="vertical-align: inherit;">Es gibt Schwierigkeiten mit Autoren, und eine davon blockiert Prozesse, die gleichzeitig eine Aufgabe ausf√ºhren (in einer gemeinsamen parallelen Gruppe enthalten). </font><font style="vertical-align: inherit;">Es wird angenommen, dass die Sperren solcher Prozesse nicht in Konflikt stehen. Beispielsweise k√∂nnen mehrere Prozesse eine exklusive Sperre f√ºr dieselbe Tabelle enthalten. </font><font style="vertical-align: inherit;">Dies erfordert besondere Sorgfalt von den Kernel-Entwicklern, aber sonst w√ºrden sie st√§ndig Deadlocks haben. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt jedoch zwei Ausnahmen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beziehungserweiterungssperre, die erfasst wird, wenn neue Seiten am Ende der Datendatei hinzugef√ºgt werden, und</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seitensperre, die verwendet wird, wenn GIN-Indexelemente von der Warteliste in den Hauptbaum verschoben werden.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Weitere </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> finden Sie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">in diesem Artikel.</font></a><font style="vertical-align: inherit;"> ) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solche Sperren sollten auch zwischen Prozessen derselben parallelen Gruppe in Konflikt stehen - wodurch dieser Patch implementiert wird. </font><font style="vertical-align: inherit;">Diese Sperren k√∂nnen jedoch niemals zu Deadlocks f√ºhren, sodass sie vom Scan ausgeschlossen werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr den Benutzer √§ndert sich im Allgemeinen nichts, aber dieser Patch ist wichtig, da er zum einen den Weg f√ºr paralleles INSERT und COPY ebnet und zum anderen einen der PostgreSQL-Engp√§sse unter Hochlastbedingungen beseitigt (was </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Bericht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu h√∂ren ist) </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">HL ++</font></a><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheit</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SKH PRH-</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Primzahlen</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"> ersetzt Ersetzte</font></b></a><font style="vertical-align: inherit;"> EDH-Primzahlen (Diffie-Hellman Ephemeral Keys) unter Verwendung des jetzt nicht mehr g√ºltigen SKIP-Protokolls.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initdb: Die Standardeinstellungen f√ºr die Authentifizierung</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
haben sich ge√§ndert. Die Standardzugriffseinstellungen f√ºr lokale und Netzwerkverbindungen haben sich beim Start von initdb ge√§ndert. Jetzt in</font></font><code>pg_hba.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr lokale Verbindungen anstelle des Authentifizierungsmethode</font></font><code>trust</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird</font></font><code>peer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(oder md5</font><font style="vertical-align: inherit;">wenn Peer</font><font style="vertical-align: inherit;">nicht unterst√ºtzt), und</font></font><code>md5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr Netzwerkverbindungen. Zun√§chst wurden liberalere Ma√ünahmen diskutiert: Warnung in der Dokumentation. Dann h√§rter :</font></font><code>scram-sha-256</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Infolgedessen haben wir uns entschlossen, uns auf</font></font><code>peer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und zu beschr√§nken</font></font><code>md5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verwenden von explizit_bzero</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wichtiger Patch. Die Betriebssystemfunktionen bzero () und explic_bzero () schreiben Bytes, die enthalten, in die angegebenen Speicherbereiche </font></font><code>'\0'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(siehe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z. B.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux). Diese Patches sind nur der Anfang: Es gibt viele Speicherbereiche, in denen Kennw√∂rter und andere vertrauliche Informationen verbleiben k√∂nnen. Wir haben uns entschieden, an Orten wie libpq zu beginnen, an denen die gesamte Datei mit Passw√∂rtern nach dem Lesen von .pgpass im Speicher verbleiben kann, und nach dem Schlie√üen der Verbindung zu bereinigen. In be-secure-common.c wird jetzt die eingegebene geheime Phrase in SSL √ºberschrieben, die in der Zeile (dem Pfad) des Fehlers angezeigt wird. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Parameter "password_protocol" wurde zu libpq hinzugef√ºgt</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesem Patch kann libpq steuern, welches Kennwort√ºbertragungsprotokoll w√§hrend der Verbindung verwendet wird. Nach Erhalt dieses Parameters verweigert libpq die Authentifizierung, wenn das Protokoll schw√§cher als das angegebene ist. Standardm√§√üig ist dieser Parameter </font></font><code>plaintext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dh alle Protokolle, geeignet. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obligatorischer Zugriff f√ºr TRUNCATE Mit</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
diesem Patch k√∂nnen Erweiterungen die obligatorische Zugriffssteuerung (MAC) f√ºr einen TRUNCATE-Vorgang einbetten. Die Rechte daran werden nun von der Erweiterung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sepgsql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºberpr√ºft </font><font style="vertical-align: inherit;">. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinux-Referenzrichtlinien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Redhat-basierte Linux-Distributionen unterst√ºtzen die SELinux-√úberpr√ºfung von db_table {truncate} nicht. In diesem Fall wird sepgsql mit 'leugnen_unknown' gleich 1 verwendet, und TRUNCATE schl√§gt fehl. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verf√ºgbarkeit von GUC ssl_passphrase_command</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein einfacher, aber n√ºtzlicher Patch. </font><font style="vertical-align: inherit;">Jetzt wird der Wert des Parameters ssl_passphrase_command nur vom Superuser angezeigt. </font><font style="vertical-align: inherit;">Der Parameter gibt einen externen Befehl an, der aufgerufen wird, wenn zum Entschl√ºsseln einer SSL-Datei ein Kennwort erforderlich ist, z. B. ein privater Schl√ºssel.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lokalisierung</font></font></h3><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versionierung libc-Kollatierungsregeln</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bei ICU-Kollatierungsregeln werden Versionsnummern in der Datenbank gespeichert. Jedes Mal, wenn die Regel verwendet wird (Sortierung, Zeichenvergleich), wird die gespeicherte Versionsnummer mit der aktuellen Version in der ICU-Bibliothek im Betriebssystem √ºberpr√ºft, und bei Unstimmigkeiten wird eine Warnung ausgegeben. Auf diese Weise k√∂nnen Sie feststellen, dass bestimmte Indizes, die gem√§√ü den ge√§nderten Sortierregeln erstellt wurden, m√∂glicherweise falsch sind und neu erstellt werden sollten. Durch die Neuerstellung der Indizes mit dem Befehl</font></font><code>ALTER COLLATION ... REFRESH VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird die Version der Sortierregel in der Datenbank aktualisiert und es werden keine Warnungen mehr ausgegeben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das war aber nur f√ºr die Intensivstation. Jetzt wird die Versionsnummer auch f√ºr libc-Sortierregeln gespeichert:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> collname, collversion <span class="hljs-keyword">FROM</span> pg_collation <span class="hljs-keyword">WHERE</span> collname = <span class="hljs-string">'ru_RU'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> collname | collversion<font></font>
----------+-------------<font></font>
 ru_RU    | 2.27</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dadurch k√∂nnen Warnungen ausgegeben werden, wenn sich eine Bibliothek im Betriebssystem √§ndert. </font><font style="vertical-align: inherit;">Sehr relevant im Hinblick auf den √úbergang zu glibc 2.28, wo sich viele Sortierregeln ge√§ndert haben und die entsprechenden Indizes neu erstellt werden sollten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber bis sie auf 2.28 umgestiegen sind, ist alles ruhig:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLLATION</span> "ru_RU" <span class="hljs-keyword">REFRESH</span> <span class="hljs-keyword">VERSION</span>;</code></pre><br>
<pre><code class="plaintext hljs">NOTICE:  version has not changed<font></font>
ALTER COLLATION</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Volltextsuche</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Volltextsuche nach griechischer Sprache</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Keine Kommentare. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dict_int hat gelernt, mit absoluten Werten</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
umzugehen</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"> .</font></b></a><font style="vertical-align: inherit;"> Das dict_int-Vorlagenw√∂rterbuch (auch bekannt als Erweiterung) hat die M√∂glichkeit hinzugef√ºgt, das Zeichen von einer Zahl zu entfernen.</font></font><br>
<br>
<pre><code class="pgsql hljs">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> dict_int;
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {-123}<font></font>
(1 row)</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TEXT SEARCH</span> <span class="hljs-keyword">DICTIONARY</span> intdict (ABSVAL = <span class="hljs-keyword">true</span>);
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {123}<font></font>
(1 row)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, diesmal wurde der Absolutwert erkannt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partitionierung</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VOR</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Zeilenausl√∂sern</font></font><code>BEFORE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr eine partitionierte Tabelle</font><font style="vertical-align: inherit;">In Version 12 k√∂nnen Sie keine Zeilenausl√∂ser</font><font style="vertical-align: inherit;">f√ºr eine partitionierte Tabelle</font><font style="vertical-align: inherit;">erstellen</font><font style="vertical-align: inherit;">. In separaten Abschnitten - bitte, aber nicht auf einmal auf dem gesamten Tisch. Jetzt wird ein</font></font><code>BEFORE FOR EACH ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trigger, der f√ºr eine partitionierte Tabelle erstellt wurde, automatisch vererbt und funktioniert f√ºr alle Abschnitte. Unter der Bedingung, dass</font></font><code>UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Partitionsschl√ºssel nur innerhalb des aktuellen Abschnitts ge√§ndert werden kann</font><font style="vertical-align: inherit;">, wenn ein Trigger</font><font style="vertical-align: inherit;">aktiviert ist.</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unterst√ºtzung f√ºr partitionierte Tabellen bei der logischen Replikation</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Bisher hat das Einf√ºgen einer partitionierten Tabelle in eine Publikation einen Fehler verursacht:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PUBLICATION</span> pub <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">TABLE</span> p;</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  "p" is a partitioned table<font></font>
DETAIL:  Adding partitioned tables to publications is not supported.<font></font>
HINT:  You can add the table partitions individually.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt funktioniert es. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbesserter Section-JOIN-Algorithmus</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ab der 11. Version kann der Scheduler partitionierte Tabellen abschnittsweise verkn√ºpfen, jedoch nur, wenn die Grenzen der Abschnitte genau √ºbereinstimmen. </font><font style="vertical-align: inherit;">Jetzt wurde der Algorithmus verbessert: Er funktioniert, wenn der Abschnitt einer Tabelle vollst√§ndig im Abschnitt einer anderen Tabelle enthalten ist, auch wenn ihre Gr√∂√üe nicht √ºbereinstimmt (z. B. wenn eine Tabelle nach Tag und die andere nach Monat unterteilt ist). </font><font style="vertical-align: inherit;">Der neue Algorithmus funktioniert f√ºr die Partitionierung nach Bereichen und Listen. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sectional FULL OUTER JOIN Sectionalized Join</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
funktioniert jetzt f√ºr vollst√§ndige √§u√üere Joins, die mit einer Phrase aufgezeichnet wurden </font></font><code>USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem attraktiven und vielversprechenden, aber schwierigen Bereich gibt es keine radikalen Fortschritte in Bezug auf PostgreSQL 12. Es gibt keine vorgefertigten Plug-In-Speicher (wie z. B. </font></font><code>zheap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heap), aber die Arbeit an der API wird fortgesetzt. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine h√∂here Abstraktionsebene bei der Bestimmung der Gr√∂√üe der Tabelle</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Robert Haas hat den Code neu geschrieben und seine Architektur zugunsten abstrakter Ebenen ge√§ndert, um den Code in Zukunft nicht zu duplizieren. Dieses St√ºck bezieht sich auf </font></font><code>estimate_rel_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- die Gr√∂√üe der Schichten (Gabeln) des Tisches. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen Tabellenzugriffsmethoden mit relcache verwenden.</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dieser Patch erweitert die Speicherverwaltungsfunktionen von Tabellenzugriffsmethoden auf die Funktionen von Indexmethoden. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableam und TOAST</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
TOAST sind gr√∂√ütenteils f√ºr die Lagerung konzipiert</font></font><code>heap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daher k√∂nnen Sie beim Erstellen neuer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabellenzugriffsmethoden auf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zwei Arten vorgehen: Entwicklern neuer Methoden helfen, TOAST-Datens√§tze einzuf√ºgen, zu aktualisieren und zu l√∂schen, oder die Arbeit mit TOAST an Code unter Verwendung des traditionellen PostgreSQL-Speicherheaps delegieren. </font><font style="vertical-align: inherit;">Eine Reihe von 5 Patches verwendet Tupel-Slots, um Einf√ºge- / Aktualisierungs- / L√∂schvorg√§nge zu implementieren, und kann denjenigen helfen, die in beide Richtungen gehen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsync</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Behandlung von fsync-Fehlern in pg_receivewal und pg_recvlogical</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Kampf gegen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fsync () geht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weiter. PostgreSQL ist der Ansicht, dass ein erfolgreicher Aufruf von fsync () bedeutet, dass alle Daten in der Datei auf die Festplatte geschrieben wurden. Dies geschieht jedoch nicht immer (betriebssystemabh√§ngig) und kann zu Datenverlust f√ºhren. PG13 entschied, dass es notwendig war, sich mit den Versorgungsunternehmen</font></font><code>pg_receivewal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font><font style="vertical-align: inherit;">zu befassen</font></font><code>pg_recvlogical</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Derzeit lautet das Standardverhalten wie folgt: Diese Dienstprogramme schreiben fsync-Fehler in die Protokolle, stellen die Verbindung wieder her und fahren fort, als w√§re nichts passiert. Infolgedessen enth√§lt die WAL Informationen zu Dateien, die erfolgreich kopiert wurden und die tats√§chlich nicht korrekt auf die Festplatte geschrieben wurden. Es ist daher besser, das Dienstprogramm zu unterbrechen. Das Schicksal von pg_dump, pg_basebackup, pg_rewind und pg_checksums wurde ebenfalls diskutiert, hat sich aber bisher auf diese beiden beschr√§nkt.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutz vor dem Setzen falscher Flags f√ºr fsync ()</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dieser Patch pr√ºft, ob die Flags beim Empfang des Dateideskriptors f√ºr fsync () richtig gesetzt sind - Verzeichnisse sind nur zum Lesen ge√∂ffnet und Dateien zum Schreiben oder beides.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherung und Replikation</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pause w√§hrend der Wiederherstellung vor Erreichen des Wiederherstellungspunkts</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn die WALs w√§hrend der Wiederherstellung beendet wurden, aber</font></font><code>recovery_target_time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die</font><font style="vertical-align: inherit;">angegebene</font><font style="vertical-align: inherit;">nicht erreicht</font><font style="vertical-align: inherit;">haben,</font><font style="vertical-align: inherit;">schlie√üt der Server die Wiederherstellung ab und wechselt in den normalen Betriebsmodus. Jetzt wird es nicht so sein. Der Wiederherstellungsprozess wird angehalten, wie im Protokoll angegeben, und der Administrator hat die M√∂glichkeit, die fehlenden WAL-Segmente einzuf√ºgen und die Wiederherstellung fortzusetzen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Der Parameter ignore_invalid_pages</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wenn der Wiederherstellungsprozess auf einem Replikat einen Link zu einer ung√ºltigen Seite im WAL-Datensatz findet, geschieht</font></font><code>panic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-a. Durch Aktivieren wird der Parameter aktiviert</font></font><code>ignore_invalid_pages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die Wiederherstellung wird mit einem m√∂glichen Verlust an Integrit√§t, Daten und anderen schwerwiegenden Folgen fortgesetzt. Der Parameter ist f√ºr Serverentwickler gedacht und sollte in den F√§llen verwendet werden, in denen Sie noch versuchen m√ºssen, die Wiederherstellung abzuschlie√üen und das Replikat zu starten. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñndern von primary_conninfo ohne Neustart</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
des Patches von Sergey </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;">Kornilov</font></b></a><font style="vertical-align: inherit;"> , mit dem Sie die Einstellungen √§ndern k√∂nnen </font></font><code>primary_conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>primary_slot_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>wal_receiver_create_temp_slot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ohne Neustart des Servers. Aus diesem Grund haben sie die Datei </font></font><code>recovery.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in der 12. Version </font><font style="vertical-align: inherit;">aufgegeben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Pg_basebackup- </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherungsmanifeste</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellen jetzt ein ‚ÄûManifest‚Äú - eine JSON-Datei, die Informationen zur erstellten Sicherung enth√§lt (Dateinamen und -gr√∂√üen, erforderliche WAL-Dateien sowie Pr√ºfsummen f√ºr alles und jedes).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das neue Dienstprogramm pg_validatebackup √ºberpr√ºft die Sicherungen auf √úbereinstimmung mit dem Manifest und √ºberpr√ºft auch die Verf√ºgbarkeit und Richtigkeit der f√ºr die Wiederherstellung erforderlichen WAL-Dateien mit dem Dienstprogramm pg_waldump (dies gilt nur f√ºr WAL-Dateien innerhalb der Sicherung selbst und nicht im Archiv). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise k√∂nnen Sie Situationen erkennen, in denen die Sicherungsdateien besch√§digt wurden oder verschwunden sind oder in denen eine Wiederherstellung aufgrund des Fehlens der erforderlichen Protokolldateien unm√∂glich wurde. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einschr√§nken des Replikationssteckplatzes f√ºr ungelesene Daten Der Replikationssteckplatz</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ist ein praktischer, aber gef√§hrlicher Mechanismus: Wenn der Client die Daten nicht rechtzeitig aus dem Steckplatz liest, k√∂nnen ungelesene WAL-Datens√§tze den gesamten Speicherplatz auf dem Server belegen. Verwenden Sie nun den Parameter</font></font><code>max_slot_wal_keep_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen ein Limit f√ºr den maximalen Speicherplatz festlegen, der von ungelesenen Daten belegt werden kann. </font><font style="vertical-align: inherit;">Wenn sich am n√§chsten Kontrollpunkt herausstellt, dass die Gr√∂√üe √ºberschritten wird, wird der Steckplatz deaktiviert und der Platz freigegeben.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unterst√ºtzung f√ºr Unix-Sockets unter Windows Unix-</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Domain-Sockets werden unter Windows 10 unterst√ºtzt, obwohl sie standardm√§√üig deaktiviert sind.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Dokumentation enth√§lt zwei neue Anwendungen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einer langen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diskussion</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erschien </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anhang M. Glossar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Das Glossar enth√§lt derzeit 101 Begriffe. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die M√∂glichkeit, die Farbe von Diagnosemeldungen von Konsolendienstprogrammen mithilfe einer Variablen hervorzuheben, </font></font><code>PG_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">war fr√ºher. </font><font style="vertical-align: inherit;">Dies ist jetzt </font><font style="vertical-align: inherit;">in </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Anhang N </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumentiert </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Farbunterst√ºtzung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Peter Eisentrouts urspr√ºngliche Absicht in diesem Patch war es, die kolorierte Ausgabe standardm√§√üig zu aktivieren. </font><font style="vertical-align: inherit;">Und f√ºr diejenigen, die dies nicht wollten, wurde vorgeschlagen, die Variable explizit festzulegen</font></font><code>NO_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Es gab jedoch mehr Gegner der Farbdifferenzierung von Nachrichten unter denen, die den Patch diskutierten. </font><font style="vertical-align: inherit;">Daher beschlossen sie, nur die verf√ºgbaren M√∂glichkeiten zu dokumentieren. </font><font style="vertical-align: inherit;">Und wir haben einen neuen Abschnitt der ersten Ebene in der Dokumentation.</font></font><br>
<br>
<hr><br>
<i>        PG13,  ,  PG14     . ,   . .</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493094/index.html">Amazon-Lagerarbeiter alarmieren √ºber die Verbreitung von Coronaviren</a></li>
<li><a href="../de493096/index.html">F√ºgen Sie ein dunkles Thema in iOS hinzu</a></li>
<li><a href="../de493098/index.html">Stellen Sie den ASA VPN-Lastausgleichscluster bereit</a></li>
<li><a href="../de493100/index.html">Wie das Finden einfacher Wege Startups hilft, aggressives Wachstum zu erzielen</a></li>
<li><a href="../de493102/index.html">Globale Automatisierungstrends: RPA-Entwicklung</a></li>
<li><a href="../de493108/index.html">Cloudflare w√§hlt AMD-Prozessoren f√ºr Edgeserver der zehnten Generation aus</a></li>
<li><a href="../de493110/index.html">Delegieren in der Fernarbeit - ein Leitfaden f√ºr Teamleiter und mehr</a></li>
<li><a href="../de493112/index.html">So starten Sie ein neues Unternehmen in 6 Monaten statt in 3 Jahren</a></li>
<li><a href="../de493114/index.html">Wie Data Engineer Daten beobachtete</a></li>
<li><a href="../de493116/index.html">"Mehr Interaktivit√§t!" oder Wie war TeamLead Conf 2020?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>