<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝 👨🏼‍🌾 👑 Combineを使用してSwift 5でHTTPリクエストを作成し、SwiftUIで使用するための最新のコード。パート2.ハッカーニュース 🤷 🛀 😍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ハッカーニュース、API我々はこの記事で使用しようとしているが、社会的なサイトはコンピュータと起業家精神に焦点を当てています。あなたがまだ彼に慣れていないなら、あなたはそこに多くの興味深いものを見つけるでしょう。
 
 
 
 以前の記事では、使用してTMDBの映画 データベース  とNewsAPI...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Combineを使用してSwift 5でHTTPリクエストを作成し、SwiftUIで使用するための最新のコード。パート2.ハッカーニュース</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490486/"><img src="https://habrastorage.org/webt/yp/go/he/ypgohe5omouinjf-e93ilcegdvs.png"><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々はこの記事で使用しようとしているが、社会的なサイトはコンピュータと起業家精神に焦点を当てています。あなたがまだ彼に慣れていないなら、あなたはそこに多くの興味深いものを見つけるでしょう。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/en/tc/m1/entcm1vprul86isvrkmtx3slaeq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前の記事では、使用して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TMDBの</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映画</font></font></a>&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">NewsAPI.orgの</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一例として、ニュースアグリゲータを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;、アプリケーション戦略が発表された&nbsp; </font></font><code>Combine </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">生成するための</font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クエリをし、それらを使用して&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;管理のため</font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の助けを借りて設計されました&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この記事では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュースアグリゲーターとやり取りするアプリケーションを開発するための同じ戦略を正確に再現しますが&nbsp; </font><font style="vertical-align: inherit;">、「外部」パブリッシャーとの作業を追加します&nbsp;</font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単にするために、エラー処理は除外します。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ハッカーニュース</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
リソースの記事の選択は</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> &nbsp;ニュースアグリゲーター</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">はまったく異なるロジックを持っている&nbsp; </font><font style="vertical-align: inherit;">と言わざるを得ませんが、&nbsp; </font><font style="vertical-align: inherit;">クエリの</font><font style="vertical-align: inherit;">実行に基づくテクノロジー</font><font style="vertical-align: inherit;">は、この状況での柔軟性</font><font style="vertical-align: inherit;">を&nbsp; </font><font style="vertical-align: inherit;">完全に示しています。さらに、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ハッカーニュース</font></a><font style="vertical-align: inherit;">ウェブサイトの情報は</font><font style="vertical-align: inherit;">非常に頻繁に更新され、外部の「パブリッシャー」</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用する</font><font style="vertical-align: inherit;">と、サイトに送られる新しいストーリーが自動的に追跡</font><font style="vertical-align: inherit;">され</font><font style="vertical-align: inherit;">ます（</font><font style="vertical-align: inherit;">）。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ハッカーニュース</font></a><font style="vertical-align: inherit;"> &nbsp;アグリゲーター&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>HTTP</code><font style="vertical-align: inherit;"></font><code>Combine</code><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>Timer</code><font style="vertical-align: inherit;"></font><code>Story</code><font style="vertical-align: inherit;"></font><br>
<br>
<code>API</code><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;完全に自由に使用でき、開発者アカウントの登録は必要ありません。これは素晴らしいことです</font></font><code>public APIs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">他のユーザーと同様に、長い登録をしなくてもすぐにコードの作業を開始できるからです</font><font style="vertical-align: inherit;">。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの戦略は、</font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「パブリッシャー」の&nbsp; </font><font style="vertical-align: inherit;">助けを借り</font></font><code>Publisher&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てインターネットからデータを選択</font><font style="vertical-align: inherit;">して作成し</font><font style="vertical-align: inherit;">、それを</font><font style="vertical-align: inherit;">プロパティを</font></font><code>&nbsp;ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持つクラスに&nbsp; </font><font style="vertical-align: inherit;">「サブスクライブ」する</font></font><code>@Published&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことです。その変更は&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自動的に追跡され、完全に再描画され&nbsp; </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの中で&nbsp; </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラス、我々はこれらのいくつかの事実使用して、アプリケーションの特定のビジネスロジックを敷設されている&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;プロパティが直接（ユーザー・インターフェースの任意のこのような「能動的」要素に変更することができる</font></font><code>U</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テキストボックスとしてIのを）</font></font><code>TextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>Steppe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R、</font></font><code>Toggle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または外部の「パブリッシャー」タイプを使用することにより&nbsp; </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、その他&nbsp;</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;反対に、プロパティは「パッシブ」になる可能性があり、「アクティブ」</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;プロパティ</font><font style="vertical-align: inherit;">の同期および/または非同期変換の結果です&nbsp; </font><font style="vertical-align: inherit;">が、これらは最も頻繁に関心があるものです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「アクティブ」</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;プロパティ</font><font style="vertical-align: inherit;">による「パッシブ」依存関係&nbsp; </font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、で</font><font style="vertical-align: inherit;">コントロール</font><font style="vertical-align: inherit;">として機能するクラスで&nbsp; </font><font style="vertical-align: inherit;">使用すること</font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;で&nbsp; </font><font style="vertical-align: inherit;">非常に簡単に説明さ</font><font style="vertical-align: inherit;">れ</font><font style="vertical-align: inherit;">ます。&nbsp; </font><font style="vertical-align: inherit;">
この記事で紹介するアプリケーションの特徴は、外部の「発行元」のおかげで、ユーザーの介入なしにニュースコンテンツが自動的に更新されることです。&nbsp; </font><font style="vertical-align: inherit;">これに専念するために、</font><font style="vertical-align: inherit;">アプリケーションは最大限に簡素化されます。「画像」は含まれません。 （</font></font><code>ObservableObject</code><font style="vertical-align: inherit;"></font><code>View Model&nbsp;</code><font style="vertical-align: inherit;"></font><code>UI</code><font style="vertical-align: inherit;"></font><code>SwiftUI</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>Timer.</code><font style="vertical-align: inherit;"></font><code>UI</code><font style="vertical-align: inherit;"></font><code>images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）さらに、物語の詳細な研究の可能性はありません。</font><font style="vertical-align: inherit;">ただし、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェブサイトに記事が掲載されてからの経過時間は&nbsp; </font><font style="vertical-align: inherit;">常に更新されます。</font><font style="vertical-align: inherit;">新しい各ストーリーの到着はすぐに反映さ</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れ、音声信号が伴います</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8_/hm/ju/8_hmjudnu5sejwnzqhcnzzqg_z0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。4分後、そのような画面が表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1b/0k/3v/1b0k3vncxmtxfj0yai29ytveurw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事のアプリケーションコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Githubにあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ハッカーニュース</font></a><font style="vertical-align: inherit;">データと</font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービス&nbsp; </font><font style="vertical-align: inherit;">モデル</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Service&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;では、最新のトップエンドの最も興味深い記事</font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する情報と</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;、その識別子</font><font style="vertical-align: inherit;">に関する特定の記事</font><font style="vertical-align: inherit;">に関する</font><font style="vertical-align: inherit;">情報&nbsp; </font><font style="vertical-align: inherit;">を選択できます</font></font><code>&nbsp;id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">データモデルは非常にシンプルで、</font><i><font style="vertical-align: inherit;">Story.swift</font></i><font style="vertical-align: inherit;">ファイルにあります</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></i><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">import</span> Foundation<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Story</span>: <span class="hljs-title">Codable</span>, <span class="hljs-title">Identifiable</span> </span>{
  <span class="hljs-keyword">let</span> id: <span class="hljs-type">Int</span>
  <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span>
  <span class="hljs-keyword">let</span> by: <span class="hljs-type">String</span>
  <span class="hljs-keyword">let</span> time: <span class="hljs-type">TimeInterval</span>
  <span class="hljs-keyword">let</span> url: <span class="hljs-type">String</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
物語は&nbsp; </font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;、識別子が含まれます</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、タイトル</font></font><code> title</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、説明&nbsp; </font></font><code>description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、著者</font></font><code> by</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、発行日</font></font><code>time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と&nbsp; </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;話を&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。構造</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は次</font><font style="vertical-align: inherit;">のとおり</font><font style="vertical-align: inherit;">です</font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これにより、1行のコードで文字通りに</font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データをモデルに</font><font style="vertical-align: inherit;">デコードできます</font><font style="vertical-align: inherit;">。の</font><font style="vertical-align: inherit;">リスト&nbsp; </font><font style="vertical-align: inherit;">&nbsp;に</font><font style="vertical-align: inherit;">ストーリーの配列を簡単に表示できるようにする場合は</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;、</font><font style="vertical-align: inherit;">構造&nbsp; </font><font style="vertical-align: inherit;">も必要</font><font style="vertical-align: inherit;">です。プロトコルに</font><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">すでに</font><font style="vertical-align: inherit;">所有</font><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">いる</font><font style="vertical-align: inherit;">プロパティ</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">存在</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">必要がある</font><font style="vertical-align: inherit;">ため、追加の作業は必要ありません。</font><font style="vertical-align: inherit;">
次に、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Hacker News</font></a><font style="vertical-align: inherit;">サービスに&nbsp; </font><font style="vertical-align: inherit;">必要なものを検討&nbsp; </font><font style="vertical-align: inherit;">&nbsp;し、それを</font><i><font style="vertical-align: inherit;">NewsAPI.swift</font></i><font style="vertical-align: inherit;">ファイルに</font><i><font style="vertical-align: inherit;">配置し</font></i><font style="vertical-align: inherit;">ます。&nbsp;</font></font><code>Identifiable</code><font style="vertical-align: inherit;"></font><code>&nbsp;[Story]</code><font style="vertical-align: inherit;"></font><code>List</code><font style="vertical-align: inherit;"></font><code>SwiftUI</code><font style="vertical-align: inherit;"></font><code>Identifiable</code><font style="vertical-align: inherit;"></font><code>Hashable</code><font style="vertical-align: inherit;"></font><code>id</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><code>API </code><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私たちの中心部は</font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;クラスである</font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことを提示から選択データの2つの方法</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュースアグリゲータ&nbsp; </font><font style="vertical-align: inherit;">&nbsp;-小説&nbsp; </font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;固定識別子を持つ&nbsp; </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と私たちに関心の話&nbsp; </font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">によると</font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><code>story (id: Int) -&gt; AnyPublisher&lt;Story, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;識別子付き</font><font style="vertical-align: inherit;">の履歴の選択&nbsp; </font></font><code>&nbsp;id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></li>
<li><code>stories (from endpoint: Endpoint)&nbsp;-&gt; AnyPublisher&lt;[Story], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code> [Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;パラメータに基づく</font><font style="vertical-align: inherit;">ストーリーの選択</font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいフレームワークのコンテキストでは、&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらのメソッドはストーリー</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または一連のストーリーだけ&nbsp; </font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">でなく、対応する「パブリッシャー」も&nbsp; </font><font style="vertical-align: inherit;">返し&nbsp; </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">どちらの「パブリッシャー」もエラーを返しません。</font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">選択またはコーディングエラーが引き続き発生する場合は、ストーリーの空の配列</font></font><code>[Story]()&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または「パブリッシャー」が</font><font style="vertical-align: inherit;">返さ&nbsp; </font><font style="vertical-align: inherit;">れ</font></font><code>Empty</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ます。このストーリーの配列または対応するストーリーが空であることが判明した理由を示すメッセージは表示されません。&nbsp;</font><font style="vertical-align: inherit;">列挙を使用して</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーから選択する情報を</font><font style="vertical-align: inherit;">指定&nbsp; </font><font style="vertical-align: inherit;">します&nbsp; </font></font><code>enum Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Endpoint</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> baseURL = 
                 <span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://hacker-news.firebaseio.com/v0/"</span>)!<font></font>
  <font></font>
  <span class="hljs-keyword">case</span> newstories, topstories, beststories
  <span class="hljs-keyword">case</span> story(<span class="hljs-type">Int</span>)<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> url: <span class="hljs-type">URL</span> {
    <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
    <span class="hljs-keyword">case</span> .newstories:
      <span class="hljs-keyword">return</span> <span class="hljs-type">Endpoint</span>.baseURL.appendingPathComponent(<span class="hljs-string">"newstories.json"</span>)
    <span class="hljs-keyword">case</span> .topstories:
      <span class="hljs-keyword">return</span> <span class="hljs-type">Endpoint</span>.baseURL.appendingPathComponent(<span class="hljs-string">"topstories.json"</span>)
    <span class="hljs-keyword">case</span> .beststories:
      <span class="hljs-keyword">return</span> <span class="hljs-type">Endpoint</span>.baseURL.appendingPathComponent(<span class="hljs-string">"beststories.json"</span>)
    <span class="hljs-keyword">case</span> .story(<span class="hljs-keyword">let</span> id):
      <span class="hljs-keyword">return</span> <span class="hljs-type">Endpoint</span>.baseURL.appendingPathComponent(<span class="hljs-string">"item/\(id).json"</span>)<font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それ：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"></font><code>.newstories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1〜2分で更新される</font><font style="vertical-align: inherit;">最新ニュース&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>.topstories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1〜2時間ごとに更新される</font><font style="vertical-align: inherit;">トップニュース&nbsp;&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も重要なニュースは&nbsp; </font></font><code>.beststories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;1日に数回更新され、</font></font></li>
<li><font style="vertical-align: inherit;"></font><code>.story(Int)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">識別子付きの&nbsp; </font><font style="vertical-align: inherit;">特定のストーリー&nbsp; </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要なオプションの初期化を容易にするために、</font><font style="vertical-align: inherit;">さまざまなタイプのニュースの</font><font style="vertical-align: inherit;">列挙に</font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期化子</font><font style="vertical-align: inherit;">を追加し</font><font style="vertical-align: inherit;">ます</font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">init</span>? (index: <span class="hljs-type">Int</span>) {
           <span class="hljs-keyword">switch</span> index {
           <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-keyword">self</span> = .newstories
           <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">self</span> = .topstories
           <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-keyword">self</span> = .beststories
           <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><font></font>
           }<font></font>
       }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラスで</font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;は</font><font style="vertical-align: inherit;">、識別子に基づいて</font></font><code>story (id: Int) -&gt; AnyPublisher&lt;Story, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリー</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">選択する</font><font style="vertical-align: inherit;">最初の方法</font><font style="vertical-align: inherit;">を&nbsp; </font><font style="vertical-align: inherit;">さらに詳しく検討し&nbsp; </font><font style="vertical-align: inherit;">ます&nbsp; </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6h/jh/dw/6hjhdw9ockzppan0n627d0m5yvk.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「パブリッシャー」を</font></font><code> id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;形成</font></font><code>URL Endpoint.story(id).url&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して使用するリクエスト履歴に</font><font style="vertical-align: inherit;">基づいて</font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、その出力値はタプル</font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ですが、エラー</font></font><code>&nbsp;-&nbsp;URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">介して</font></font><code>map { }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タプルを取る</font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらなる処理のためにのみデータ&nbsp; </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、&nbsp;</font></font></li>
<li> <code>JSON </code><code>&nbsp;data</code>   ,   <code>&nbsp;Story</code>,&nbsp;</li>
<li>  -        «» <code>Empty</code>   «»&nbsp;<code>catch {&nbsp; }</code>,</li>
<li>«»  «»   <code>eraseToAnyPublisher()</code>    <code>AnyPublisher</code>.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストーリーを選択するタスクは</font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、2番目の方法に委ねられ&nbsp; </font></font><code>stories (from endpoint: Endpoint)&nbsp;-&gt; AnyPublisher&lt;[Story], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これは、ピースから収集する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の方法で提示された一連のアクションを繰り返しますが、別の方法で</font></font><code>URL&nbsp;endpoint.url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は... ... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_o/d0/85/_od085kwbg-ybpgtjqjxvhjxevu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...の</font><font style="vertical-align: inherit;">&nbsp;よう</font></font><code> [Int]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に、</font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリー</font><font style="vertical-align: inherit;">の識別子に対応する</font><font style="vertical-align: inherit;">整数の配列を取得し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qs/b_/_m/qsb__mfhpfxyy1sb_trunxytify.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、実際にはさらに多くの-500 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
があり</font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ストーリーのこれらの識別子をストーリー</font><font style="vertical-align: inherit;">自体に変換する</font><font style="vertical-align: inherit;">必要があり</font><font style="vertical-align: inherit;">ます。これを行う</font></font><code>mergedStories (ids:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ために、特定の識別子ごとに</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;「パブリッシャー」の</font><font style="vertical-align: inherit;">履歴を受け取り、</font></font><code>AnyPublisher&lt;Story, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらをすべて組み合わせる</font><font style="vertical-align: inherit;">新しいヘルパーメソッド</font><font style="vertical-align: inherit;">を&nbsp; </font><font style="vertical-align: inherit;">作成します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mergedStories</span><span class="hljs-params">(ids storyIDs: [Int])</span></span> 
                                    -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">Story</span>, <span class="hljs-type">Never</span>&gt;{<font></font>
.  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本的に、このメソッドは</font></font><code>story(id:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列から特定の各識別子</font><font style="vertical-align: inherit;">を呼び出し</font><font style="vertical-align: inherit;">、結果を出力値の単一のストリームに</font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「整列」（</font></font><code>flatten</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、サーバーへの呼び出し回数を減らし</font></font><code>maxStories ids </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、指定されたリストの</font><font style="vertical-align: inherit;">最初の呼び出しのみを使用し</font><font style="vertical-align: inherit;">ます</font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mergedStories</span><span class="hljs-params">(ids storyIDs: [Int])</span></span> 
                                    -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">Story</span>, <span class="hljs-type">Never</span>&gt;{
<span class="hljs-keyword">let</span> storyIDs = <span class="hljs-type">Array</span>(storyIDs.<span class="hljs-keyword">prefix</span>(maxStories))
<span class="hljs-built_in">precondition</span>(!storyIDs.isEmpty)<font></font>
.  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それを使用して、&nbsp; </font><font style="vertical-align: inherit;">リストの</font><font style="vertical-align: inherit;">最初</font><font style="vertical-align: inherit;">のストーリーを選択</font></font><code>story(id:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;する最初の「パブリッシャー」</font></font><code>initialPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成します</font><font style="vertical-align: inherit;">。</font></font><code>Story</code><font style="vertical-align: inherit;"></font><code> id</code><font style="vertical-align: inherit;"></font><code>&nbsp;ids</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mergedStories</span><span class="hljs-params">(ids storyIDs: [Int])</span></span> 
                                    -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">Story</span>, <span class="hljs-type">Never</span>&gt;{
  <span class="hljs-keyword">let</span> storyIDs = <span class="hljs-type">Array</span>(storyIDs.<span class="hljs-keyword">prefix</span>(maxStories))
  <span class="hljs-built_in">precondition</span>(!storyIDs.isEmpty)<font></font>
<font></font>
  <span class="hljs-keyword">let</span> initialPublisher = story(id: storyIDs[<span class="hljs-number">0</span>])
  <span class="hljs-keyword">let</span> remainder = <span class="hljs-type">Array</span>(storyIDs.<span class="hljs-built_in">dropFirst</span>())<font></font>
.  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に</font><font style="vertical-align: inherit;">、残りの</font></font><code>reduce(_:_:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリ</font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を操作する</font><font style="vertical-align: inherit;">標準ライブラリから</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して、</font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次の各「パブリッシャー」と識別子</font></font><code>&nbsp;id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を最初の「パブリッシャー」</font><font style="vertical-align: inherit;">に追加します</font></font><code>initialPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mergedStories</span><span class="hljs-params">(ids storyIDs: [Int])</span></span> 
                                -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">Story</span>, <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-keyword">let</span> storyIDs = <span class="hljs-type">Array</span>(storyIDs.<span class="hljs-keyword">prefix</span>(maxStories))
    <span class="hljs-built_in">precondition</span>(!storyIDs.isEmpty)<font></font>
<font></font>
    <span class="hljs-keyword">let</span> initialPublisher = story(id: storyIDs[<span class="hljs-number">0</span>])
    <span class="hljs-keyword">let</span> remainder = <span class="hljs-type">Array</span>(storyIDs.<span class="hljs-built_in">dropFirst</span>())<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> remainder.<span class="hljs-built_in">reduce</span>(initialPublisher) {<font></font>
                (combined, id) -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">Story</span>, <span class="hljs-type">Never</span>&gt; <span class="hljs-keyword">in</span><font></font>
        combined.merge(with: story(id: id))<font></font>
        .eraseToAnyPublisher()<font></font>
    }<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最終結果は、成功した各ストーリーを「パブリッシュ」し、各ストーリー</font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をサンプリングするときに発生する可能性のあるエラーを無視する</font><font style="vertical-align: inherit;">「パブリッシャー」&nbsp; </font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、ストーリーを選択する方法に戻ることができ&nbsp; </font></font><code>stories (from endpoint: Endpoint)&nbsp;-&gt; AnyPublisher&lt;[Story], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。一連のアクションを繰り返すことで一連の</font></font><code>endpoint.url&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリーIDを取得できるという</font><font style="vertical-align: inherit;">事実に落ち着きました&nbsp; </font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーから対応するストーリーを1つずつ取得するために使用する必要があります&nbsp; </font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stories</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Story</span>], <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: endpoint.url)<font></font>
      .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0.0</span> }<font></font>
      .decode(type: [<span class="hljs-type">Int</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())<font></font>
      .<span class="hljs-keyword">catch</span> { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span> <span class="hljs-type">Empty</span>() } <font></font>
      .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
      .eraseToAnyPublisher()<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のステップでは、いくつかの演算子を使用して不適切なコンテンツを除外し、ストーリーID&nbsp; </font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;を実際のストーリーに変換します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、</font><font style="vertical-align: inherit;">空でない入力パラメーターを提供する</font></font><code>mergedStories(ids:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前提条件がある</font><font style="vertical-align: inherit;">ため、ストーリーIDの空の配列を除外し</font></font><code>precondition</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stories</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Story</span>], <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: endpoint.url)<font></font>
      .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0.0</span> }<font></font>
      .decode(type: [<span class="hljs-type">Int</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())<font></font>
      .<span class="hljs-keyword">catch</span> { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span> <span class="hljs-type">Empty</span>() }<font></font>
      .<span class="hljs-built_in">filter</span> { !$<span class="hljs-number">0</span>.isEmpty }  <font></font>
      .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
      .eraseToAnyPublisher()<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストーリーIDの配列に基づいて、</font></font><code>storyIDs </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際のストーリーを取得し</font></font><code> flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stories</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Story</span>], <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: endpoint.url)<font></font>
      .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0.0</span> }<font></font>
      .decode(type: [<span class="hljs-type">Int</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())<font></font>
      .<span class="hljs-keyword">catch</span> { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span> <span class="hljs-type">Empty</span>() }<font></font>
      .<span class="hljs-built_in">filter</span> { !$<span class="hljs-number">0</span>.isEmpty }<font></font>
      .flatMap { storyIDs <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span>.mergedStories(ids: storyIDs)}  <font></font>
      .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
      .eraseToAnyPublisher()<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、値の連続的なストリームが作成</font></font><code> Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">され、インターネットから選択されると表示されます。</font><font style="vertical-align: inherit;">しかし、私たちは</font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>View Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">やで</font><font style="vertical-align: inherit;">作業する方が便利な</font><font style="vertical-align: inherit;">一連のストーリーの形で結果を得たいと考えてい</font></font><code>SwiftUI View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「パブリッシャー」の個々の値のストリームのそのような値の配列への変換は、非常に便利な演算子によって提供されます</font></font><code>collect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stories</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Story</span>], <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: endpoint.url)<font></font>
      .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0.0</span> }<font></font>
      .decode(type: [<span class="hljs-type">Int</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())<font></font>
      .<span class="hljs-keyword">catch</span> { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span> <span class="hljs-type">Empty</span>() }<font></font>
      .<span class="hljs-built_in">filter</span> { !$<span class="hljs-number">0</span>.isEmpty }<font></font>
      .flatMap { storyIDs <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span>.mergedStories(ids: storyIDs)}<font></font>
      .collect(maxStories)    <font></font>
      .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
      .eraseToAnyPublisher()<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーターを使用して</font><font style="vertical-align: inherit;">、受け取った記事を識別子</font><font style="vertical-align: inherit;">で、実際には年代順に&nbsp; </font><font style="vertical-align: inherit;">並べ替えます&nbsp; </font></font><code>sorted()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュースの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェブサイトに</font><font style="vertical-align: inherit;">&nbsp;新しいストーリーが届い</font><font style="vertical-align: inherit;">たと判断するのに役立ちます&nbsp; </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">stories</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Story</span>], <span class="hljs-type">Never</span>&gt; {
    <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: endpoint.url)<font></font>
      .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0.0</span> }<font></font>
      .decode(type: [<span class="hljs-type">Int</span>].<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">JSONDecoder</span>())<font></font>
      .<span class="hljs-keyword">catch</span> { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span> <span class="hljs-type">Empty</span>() }<font></font>
      .<span class="hljs-built_in">filter</span> { !$<span class="hljs-number">0</span>.isEmpty }<font></font>
      .flatMap { storyIDs <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span>.mergedStories(ids: storyIDs)}<font></font>
      .collect(maxStories)<font></font>
      .<span class="hljs-built_in">map</span> { stories <span class="hljs-keyword">in</span>  stories.sorted (by: {$<span class="hljs-number">0</span>.id &gt; $<span class="hljs-number">1</span>.id})}    <font></font>
      .eraseToAnyPublisher()<font></font>
  }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「パブリッシャー」演算子「erase TYPE」の形成を常に完了するように</font></font><code>eraseToAnyPublisher()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これはすでにあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qj/o7/fs/qjo7fslsls16sndmazgn0x0ywuq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
教室では</font></font><code>NewAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、3つの方法すべてを</font><font style="vertical-align: inherit;">考慮して</font><font style="vertical-align: inherit;">- </font></font><code>story (id: Int)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>storyIDs (from endpoint: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>stories (from endpoint: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-同様の方法で作業して</font><font style="vertical-align: inherit;">、「パブリッシャー」を返す</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前のアプリケーション</font></font></a> &nbsp;<code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">からの使い慣れた方法を使用できます</font><font style="vertical-align: inherit;">。</font></font><code>AnyPublisher&lt;T, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これは与えられた1に基づいて&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非同期に受け取り&nbsp; </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それを直接に情報、デコードと場所を</font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデル</font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y0/zb/di/y0zbdidyjqkny4xxzoyaximi4si.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、特定の「パブリッシャー」を得るために、このコードを使用して</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースデータがあれば</font></font><code>url </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、例えば、ある&nbsp; </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;ために</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービス&nbsp; </font><font style="vertical-align: inherit;">。出力でさまざまなモデルを作成できます-単なるストーリー</font></font><code>&nbsp;Story </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ストーリー</font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の配列または</font><font style="vertical-align: inherit;">ストーリー&nbsp; </font><font style="vertical-align: inherit;">の識別子の配列</font></font><code>[Int]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jk/on/03/jkon03ci9miutbgajlnjue64rey.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法で取得された「パブリッシャー」は、</font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分で「離陸」せず、誰かが「購読」するまで何も配信しません。</font><font style="vertical-align: inherit;">私たちは設計する際にそれらを使用する</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;に&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;して、それらに「購読」&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;自動的に同期データを使ってインターネットから選択されるクラス&nbsp; </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「出版社」</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など</font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の中で</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ストーリー一覧</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェブサイトの最新の記事を表示する特定の例で</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">結果の「パブリッシャー」が</font><font style="vertical-align: inherit;">どのように</font><font style="vertical-align: inherit;">機能する&nbsp; </font><font style="vertical-align: inherit;">かを見てみましょう</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yp/go/he/ypgohe5omouinjf-e93ilcegdvs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
時間の経過とともに</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェブサイトから選択された&nbsp; </font><font style="vertical-align: inherit;">最近の記事のリストは最新の</font><font style="vertical-align: inherit;">状態に保たれる必要があることが</font><font style="vertical-align: inherit;">わかり&nbsp; </font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、さまざまなタイプのストーリーを表示できる必要があります。フレッシュ（</font></font><code>news</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、トップ（</font></font><code>top</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、または最も興味深い（</font></font><code>best</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c9/3z/ig/c93zigswuytycltp7qs9jepspxe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには</font><font style="vertical-align: inherit;">&nbsp;、3つの</font><font style="vertical-align: inherit;">プロパティを</font></font><code>StoriesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持つプロトコル</font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を&nbsp; </font><font style="vertical-align: inherit;">実装する</font><font style="vertical-align: inherit;">非常に単純なクラス</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">作成し&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。 &nbsp;</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y4/sg/p4/y4sgp4fimzjdibm0svzl-o-v3ji.png"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つ&nbsp; </font></font><code>@Published var indexEndpoint: Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はインデックスです</font></font><code>Endpoint </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（その値はでユーザーによって調整されるため、条件付きで「入力」と呼ぶことができます</font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。&nbsp;&nbsp;</font></font></li>
<li>&nbsp;<code>@Published var currentDate: Date</code> —   (    «»,       <code>View</code>&nbsp; «» <code>Timer</code>),&nbsp;&nbsp;</li>
<li>&nbsp;<code>@Published var stories: [Story]&nbsp;</code> —   ( «»,          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Hacker News</a>&nbsp;  &nbsp;<code>currentDate</code>&nbsp;  <code>&nbsp;indexEndpoin</code>t).</li>
</ol><br><font style="vertical-align: inherit;"></font><code>&nbsp;@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;プロパティ&nbsp; </font><font style="vertical-align: inherit;">
を設定する</font></font><code>currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、単純なプロパティ</font></font><code>currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と「パブリッシャー」の&nbsp; </font><font style="vertical-align: inherit;">両方として使用できるようになります&nbsp; </font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラス&nbsp; </font></font><code>StoriesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、関心のあるプロパティを宣言するだけでなく、それらの相互作用のビジネスロジックを指定することもできます。このために、クラスインスタンス</font></font><code>StoriesViewModel&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">初期化するときに、クラスインスタンスの&nbsp; </font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ライフサイクル」全体を通じて機能する「サブスクリプション」を作成し、&nbsp; </font></font><code>StoriesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリーのリストの</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;時間&nbsp; </font></font><code>currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;とインデックス</font><font style="vertical-align: inherit;">への依存を実現でき &nbsp; </font><font style="vertical-align: inherit;">ます</font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うために、</font></font><code> Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々は「発行者」のチェーンを拡張</font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;し、&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出力「出版社」へ</font></font><code>AnyPublisher&lt;[Story], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その価値は物語のリストです。続いて、「サブスクライバー」</font></font><code>sink&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とそのクロージャー&nbsp; </font><font style="vertical-align: inherit;">を使用してサブスクライブし、&nbsp; </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なストーリーのリストを、</font><font style="vertical-align: inherit;">&nbsp;それを定義</font></font><code>stories </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する「出力」</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティ</font><font style="vertical-align: inherit;">として&nbsp; </font><font style="vertical-align: inherit;">取得します</font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、プロパティからではなく、単純にチェーンを引く必要があります</font></font><code>currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、つまり「出版」から</font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誰が作成に関与することになります</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;と、それは我々が外部の「出版社」の助けを借りて、それらを変更することがあり</font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これをどうやって行うのでしょうか？</font><font style="vertical-align: inherit;">クラスにある</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーセナル</font></font><code>stories (from: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">には&nbsp; </font><font style="vertical-align: inherit;">すでに関数があり</font><font style="vertical-align: inherit;">、値</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">応じ</font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">て「パブリッシャー」</font></font><code>AnyPublisher&lt;[Story], Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;&nbsp; </font><font style="vertical-align: inherit;">を返します。「パブリッシャー」&nbsp; </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の値は何らかの方法でのみ使用できます&nbsp;</font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これをこの関数の引数に変換し&nbsp; </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、時間の変化が発生するたびに呼び出します&nbsp; </font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、「パブリッシャー」</font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;とを&nbsp; </font><font style="vertical-align: inherit;">組み合わせ&nbsp; </font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。このためには、</font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレータがあり&nbsp; </font></font><code>Publishers.CombineLates</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。t </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1p/jy/pv/1pjypvxqfqco1xnodbjanegdvxq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Goが右パブリッシャーへ&nbsp; </font></font><code>stories (from: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;の&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレータに助けたちを&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1s/sy/rk/1ssyrkq8pk8g81wxopt89eu5nnw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オペレータは</font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、以前から得られたデータに基づいて、新たな「パブリッシャー」を作成し、「出版社を。」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デザインでのさらなる使用を想定して、結果をメインストリームに配信します</font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/z4/kx/biz4kxsampyo8jws7hnkgu91kq8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、「サブスクライバー」を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">この新たに受信した「パブリッシャー」に「サブスクライブ」し&nbsp; </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;、ロックします。ここで&nbsp; </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、必要なストーリーのリストを取得します&nbsp;</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、私たちは「出版社」値の配列から受信割り当てるために急いではありません&nbsp; </font></font><code>@Published stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ai/wh/qg/aiwhqgzmbednl68yd7ubmkcey5g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、分析</font></font><code> id </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の物語の新しくダウンロードリストから最新話&nbsp; </font></font><code>currentIds.first!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;と</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">履歴リストから最新の物語は、すでに画面上に表示されています</font></font><code> oldIds.first!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。それらが等しくない場合、つまり、サイトに新しい履歴がある場合は</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;、</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;配列に&nbsp; </font><font style="vertical-align: inherit;">新しい値を割り当て、それを</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同時に格納して</font></font><code>oldStories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">音声信号を送信します。そうでない場合は、</font></font><code>@Published stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新されません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私達はちょうど作成した</font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">受信した結果として、それに対して非同期「発行者」と「サブスクライブ」を</font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は変数に保存されます「サブスクリプション」、 </font></font><code>private&nbsp;var subscriptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_l/0n/6c/_l0n6cd5lmgfjxsez7_jjnz8wxc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちが作成した、非同期「発行者」への「サブスクリプション」を</font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クラス</font></font><code>StoriesViewMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lの</font><font style="vertical-align: inherit;">インスタンスの「ライフサイクル」全体にわたって保持されます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
値の変更のための確立された「サブスクリプション」「パブリッシャー」</font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">余分な努力なし</font><font style="vertical-align: inherit;">にストーリーの更新された配列を持ってい&nbsp; </font><font style="vertical-align: inherit;">ます。この&nbsp; </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスは通常と呼ばれ&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ストーリー</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">準備ができたので、ユーザーインターフェイス（</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">作成を開始し</font><font style="vertical-align: inherit;">ましょう</font><font style="vertical-align: inherit;">。では</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">&nbsp;モデル</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と同期</font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するために</font><font style="vertical-align: inherit;">、このモデルのクラスのインスタンスを参照</font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数が</font><font style="vertical-align: inherit;">使用され</font><font style="vertical-align: inherit;">ています。</font><font style="vertical-align: inherit;">のユーザーインターフェイス（</font><font style="vertical-align: inherit;">）の</font><font style="vertical-align: inherit;">変更を制御するの</font><font style="vertical-align: inherit;">は、このペア（&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;クラスと</font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このクラスのインスタンスを参照</font><font style="vertical-align: inherit;">する&nbsp; </font><font style="vertical-align: inherit;">変数</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）です&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加</font></font><code>StoriesView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;の変数を</font></font><code>var model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TYPEで&nbsp; </font><font style="vertical-align: inherit;">新たに作成された構造に&nbsp; </font></font><code>StoriesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、それを置き換える</font></font><code>Text ("Hello, World!")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の物語のリストで&nbsp; </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は話置かれるで</font></font><code>model.stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々から取得する&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i9/zd/hx/i9zdhxoogfip4hyydw1p5dcfovk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、我々は時間の固定電流の瞬間のために記事のリストを取得する</font></font><code>currentDate = Date()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と値を</font></font><code>indexEndpoint = 0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、あること、これは最新ニュースのケースである&nbsp; </font></font><code>.newstories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/op/ch/sy/opchsykxk7pwwmuiwjehnxczy8g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーバー時間、画面上「パブリッシャー」</font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;や&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内で</font><font style="vertical-align: inherit;">は変更しないため、何も変更されません</font></font><code>model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変更</font></font><code>$currentDate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">については、外部の "発行者" </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とそれに対する反応を使用し</font></font><code>onReceive (timer)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/k0/m0/quk0m0fhx6rtjjgiq0wgxv-wo_0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、最新のニュースオプションのストーリーを変更するロジックに従って、ストーリーのリストが変更されます。&nbsp;</font></font><code>.newstories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それは、すべての1~2分で、新しい物語が到着すると、音声信号を伴うされ、更新されます：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xa/cr/xy/xacrxy5gdhrrhhvta56k68e1aje.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我々はまた、「パブリッシャー」を変更することができ</font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は追加した場合、</font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちに</font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/4k/ot/h5/4koth5plt72xthydhkjb0ipsmp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今、私たちは（最新のニュースのための話だけではなくを更新する機会を持っています</font></font><code>news</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）だけでなく、トップストーリー（</font></font><code>top</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）とベストストーリー（</font></font><code>best</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c9/3z/ig/c93zigswuytycltp7qs9jepspxe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのストーリーリストの更新の強さは、オプションによって異なります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのタイトルを追加することができます</font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xv/-m/_v/xv-m_vvykzvsuitst3x7lyg93cy.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ハッカーニュース</font></a><font style="vertical-align: inherit;">サービスの呼び出し回数を減らすためのビューモデルの変更&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
</h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の例</font></font><code> View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーに新しいストーリーが表示されたときにのみ画面が更新さ&nbsp; </font><font style="vertical-align: inherit;">れるようにしましたが、タイマーが起動するたびに</font></font><code> Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、サーバーから、選択した識別子の配列に対応するすべてのストーリーのリストを選択します。つまり、すべてのストーリーを選択してから、新しく選択されたストーリーの識別子と「古い」ストーリーの識別子を比較します。新しい識別子の中に「新しい」ものがさらにある場合は、ストーリーのリストを更新します</font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ap/1c/i4/ap1ci4zxxdkczen8s7iodm8lbhc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、この分析ははるかに早く行うことができます。つまり、</font></font><code>currentIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリー</font><font style="vertical-align: inherit;">識別子のリストを取得するとすぐに</font><font style="vertical-align: inherit;">、この段階で古い識別子</font></font><code>&nbsp;oldIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と新しい</font><font style="vertical-align: inherit;">識別子</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">比較でき</font><font style="vertical-align: inherit;">ます。</font></font><code>currentIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その後、新しい識別子に対応する</font></font><code>currentIds </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">履歴を</font><font style="vertical-align: inherit;">選択します&nbsp; </font><font style="vertical-align: inherit;">。&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、</font></font><code>AnyPublisher&lt;[Int], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリーIDを提供</font><font style="vertical-align: inherit;">する新しい「パブリッシャー」</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">必要</font><font style="vertical-align: inherit;">です。私たちは、関数を使用して、それを受信する&nbsp; </font></font><code>func storyIDs(from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Int], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことを</font><font style="vertical-align: inherit;">
私たちはします</font><font style="vertical-align: inherit;">クラスに入れる</font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ss/4m/la/ss4mlaotknent2nkv6cyvneacp0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは新しいもので、それを使用します</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は名前であろう、</font></font><code>&nbsp;StoriesViewModelID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;と同じ名前のファイル内の場所：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fe/ih/jb/feihjbdzafvozyvmig6errfxk4k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは同じ「入力」と「出力」している&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;のようにプロパティ&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;名&nbsp; </font></font><code>StoriesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、また、同じ「イニシエーター」は「パブリッシャー」</font></font><code>$currentDate&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と&nbsp; </font></font><code> $indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ですが、「サブスクリプション」自体</font></font><code>init() </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は別のシナリオになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
内</font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;で</font><font style="vertical-align: inherit;">動作&nbsp; </font><font style="vertical-align: inherit;">し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーへの最初の1つの呼び出しを&nbsp; </font><font style="vertical-align: inherit;">&nbsp;使用して</font></font><code>self.api.storyIDs (from: Endpoint (index: indexEndpoint )! )</code><font style="vertical-align: inherit;"></font><code>currentIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;新しいストーリー</font><font style="vertical-align: inherit;">の識別子を提供し</font><font style="vertical-align: inherit;">ます。次に、オペレーターで</font></font><code>map </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、古い識別子</font></font><code>oldIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と取得した識別子 &nbsp; </font><font style="vertical-align: inherit;">を比較するロジック</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実装し、&nbsp; </font></font><code>currentIds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際のストーリーを選択して表示することを決定します</font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/uq/um/eauqumdsfbesmhejfduf68ahewo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、次の制限内</font></font><code>&nbsp;flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、</font></font><code>storyIDs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリー</font><font style="vertical-align: inherit;">の識別子を受け取っ</font><font style="vertical-align: inherit;">たら、実際のストーリー</font><font style="vertical-align: inherit;">を選択&nbsp; </font></font><code>Story</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、「パブリッシャー」を使用してストリームを形成し、&nbsp; </font></font><code>mergedStories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">収集します。</font></font><code>[Story]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーターを使用</font><font style="vertical-align: inherit;">してそれらをストーリー配列に</font></font><code>collect</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加し、結果のストーリー配列をフィルター処理して並べ替えます</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6p/wt/vd/6pwtvdgxbw-jxuo4fdnseohy3gi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。次のステップは、受信した「パブリッシャー」に</font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クロージャー&nbsp; </font><font style="vertical-align: inherit;">を付けて「サブスクライブ」する</font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことです。必要なストーリー配列を取得し、&nbsp; </font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その値を割り当てます。</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;property&nbsp; </font></font><code>stories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uk/na/nx/uknanx_2hydixzhu3v-lybnuaxo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果の</font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「サブスクリプション」を変数</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">保存する</font><font style="vertical-align: inherit;">ことを忘れないでください&nbsp; </font></font><code>private&nbsp;var subscriptions</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xc/09/dr/xc09dr72cxvuyhr2tyv0udhftw8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それだけです。</font><font style="vertical-align: inherit;">これで新しい&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">もの&nbsp; </font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">できました。</font><font style="vertical-align: inherit;">
これ</font></font><code>&nbsp;StoriesViewModelID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用するために</font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>StoriesView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの文字を追加する</font><font style="vertical-align: inherit;">必要があり&nbsp; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/he/_l/my/he_lmyxqegmsrn_lw5cwy4-flei.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この例は、それを使用して</font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネスト</font><font style="vertical-align: inherit;">さ</font><font style="vertical-align: inherit;">れた</font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クエリ</font><font style="vertical-align: inherit;">を実装することがいかに簡単かを示してい</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この場合、これらは2つの連続する演算子</font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ニュースアグリゲーターと対話するアプリケーションを作成する&nbsp;&nbsp; </font><font style="vertical-align: inherit;">ために、以前の記事で使用したのとまったく同じテクノロジーを使用して、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">TMDb </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">映画</font></font></a>&nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.orgニュースアグリゲーターを操作しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。記事やストーリーの選択は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リソース</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">呼び出されるため&nbsp; </font><font style="vertical-align: inherit;">、ストーリーの識別子に基づいて完全に異なるロジックを持っていますが、Combineに基づくテクノロジーはその驚くべき柔軟性を示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前回の記事のように、我々は簡単なのコードに依存していた</font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「パブリッシャー」</font></font><code>AnyPublisher&lt;T, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非同期で受け取り、</font></font><code>JSON </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それを直接に情報や場所を</font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モデル</font></font><code> T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;与えられたに基づいて、&nbsp;</font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y0/zb/di/y0zbdidyjqkny4xxzoyaximi4si.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、「パブリッシャー」を取得するためにそれを使用して</font></font><code>&nbsp;AnyPublisher&lt;Story, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1話を公開し、「出版社」&nbsp; </font></font><code>AnyPublisher&lt;[Stories], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の話リストの多様性と「出版社」の出版</font></font><code>AnyPublisher&lt;[Int], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からストーリーリスト識別子を公開</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッカーニュース</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュースアグリゲータ&nbsp; </font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jk/on/03/jkon03ci9miutbgajlnjue64rey.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で得られた「発行者」の仕事の偉大</font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">持つクラスをその</font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティ</font><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">、インターネットから選択されたデータを自動的に同期します&nbsp; </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/y4/sg/p4/y4sgp4fimzjdibm0svzl-o-v3ji.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これ</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">により、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニュースアグリゲータからのニュースコンテンツを常に自動的に更新できます&nbsp; </font><font style="vertical-align: inherit;">。このアップデートの「開始者」は、外部の「発行者」としてのものです</font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;そして、ハッカーニュースウェブサイトでの新しいストーリーの登場、およびユーザーがさまざまなタイプのストーリー（最新、トップ、ベスト）について学習したいという願望。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事のアプリケーションコードは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Githubにあり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンク：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結合：Swiftによる非同期プログラミング</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「SwiftUI＆Combine：Better Together」</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combineの紹介</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">-WWDC 2019-ビデオ-Apple </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Developer。</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">セッション722 </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combine in Practice-WWDC 2019-ビデオ-Apple Developer。</font><font style="vertical-align: inherit;">セッション721</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490474/index.html">STM32パート1：基本</a></li>
<li><a href="../ja490476/index.html">高度な機能を備えた開閉用ワイヤレスセンサー</a></li>
<li><a href="../ja490478/index.html">DIY DIYはんだステーションv2</a></li>
<li><a href="../ja490480/index.html">O Tiling-wmを2語で</a></li>
<li><a href="../ja490484/index.html">Googleアシスタントでスマートホームセンサーを管理する</a></li>
<li><a href="../ja490490/index.html">週末の読書：音の健康への影響に関する10の資料-「騒音衛生」から良い睡眠とGTDまで</a></li>
<li><a href="../ja490492/index.html">倉庫ロボットは非標準のものを分類することを学ぶ</a></li>
<li><a href="../ja490494/index.html">ネズミ、ウィディオット、ゲーマーを購入する：80年代のビデオゲームの危険性に関する宣伝</a></li>
<li><a href="../ja490496/index.html">Nuxt.jsでのオンラインストアの作成2チュートリアルパート1</a></li>
<li><a href="../ja490498/index.html">私がPHPで半分散型の暗号通貨を書いたとき。（パート2-開発）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>