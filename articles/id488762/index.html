<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚫 ✍🏽 🥓 Pemrograman asinkron yang elegan dengan janji-janji 🤞🏽 👨🏿‍🍳 🐣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selamat siang teman! 
 
 Janji (janji) adalah fitur yang relatif baru dari JavaScript yang memungkinkan Anda untuk menunda pelaksanaan suatu tindakan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pemrograman asinkron yang elegan dengan janji-janji</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488762/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selamat siang teman! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Janji (janji) adalah fitur yang relatif baru dari JavaScript yang memungkinkan Anda untuk menunda pelaksanaan suatu tindakan sampai penyelesaian tindakan sebelumnya atau untuk menanggapi eksekusi tindakan yang gagal. </font><font style="vertical-align: inherit;">Ini berkontribusi pada penentuan urutan operasi asinkron yang benar. </font><font style="vertical-align: inherit;">Artikel ini membahas cara kerja janji, bagaimana janji itu digunakan di Web API, dan bagaimana Anda bisa menulis janji Anda sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketentuan: melek komputer dasar, pengetahuan dasar-dasar JS. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan: memahami apa janji itu dan bagaimana janji itu digunakan.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa itu janji?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami meninjau secara singkat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">janji</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">janji</font></a><font style="vertical-align: inherit;"> di artikel pertama kursus, di sini kami akan mempertimbangkannya secara lebih rinci. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intinya, janji adalah objek yang mewakili kondisi perantara operasi - itu "menjanjikan" bahwa hasilnya akan dikembalikan di masa depan. Tidak diketahui pasti kapan operasi akan selesai dan kapan hasilnya akan dikembalikan, tetapi ada jaminan bahwa ketika operasi selesai, kode Anda akan melakukan sesuatu dengan hasil atau dengan anggun menangani kesalahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai aturan, berapa lama waktu yang diperlukan untuk operasi asinkron (tidak terlalu lama!) Tidak terlalu menarik bagi kita daripada kemungkinan tanggapan langsung terhadap penyelesaiannya. Dan, tentu saja, senang mengetahui bahwa sisa kode tidak diblokir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu janji yang paling umum adalah API Web yang mengembalikan janji. Mari kita lihat aplikasi obrolan video hipotetis. Aplikasi memiliki jendela dengan daftar teman-teman pengguna, mengklik tombol di sebelah nama (atau avatar) pengguna memulai panggilan video. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tombol pengendali panggilan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getUserMedia ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk mengakses kamera dan mikrofon pengguna. Dari saat getUserMedia () menghubungi pengguna untuk izin (untuk menggunakan perangkat, perangkat mana yang digunakan jika pengguna memiliki beberapa mikrofon atau kamera, hanya panggilan suara, di antara hal-hal lain), getUserMedia () mengharapkan tidak hanya keputusan pengguna, tetapi juga melepaskan perangkat jika sedang digunakan. Selain itu, pengguna mungkin tidak segera merespons. Semua ini dapat menyebabkan keterlambatan waktu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika permintaan izin untuk menggunakan perangkat dibuat dari utas utama, browser diblokir sampai getUserMedia () selesai. Itu tidak bisa diterima. Tanpa janji, semua yang ada di browser menjadi "tidak dapat diklik" sampai pengguna memberikan izin untuk menggunakan mikrofon dan kamera. Oleh karena itu, alih-alih menunggu keputusan pengguna dan mengembalikan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MediaStream</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk aliran yang dibuat dari sumber (kamera dan mikrofon), getUserMedia () mengembalikan janji yang diproses MediaStream segera setelah tersedia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode aplikasi obrolan video mungkin terlihat seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span> <span class="hljs-title">CallButton</span>(<span class="hljs-params">evt</span>)</span>{<font></font>
    setStatusMessage(<span class="hljs-string">'Calling...'</span>)<font></font>
    navigator.mediaDevices.getUserMedia({<span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span>})<font></font>
    .then(<span class="hljs-function"><span class="hljs-params">chatStream</span> =&gt;</span> {<font></font>
        selfViewElem.srcObject = chatStream<font></font>
        chatStream.getTracks().forEach(<span class="hljs-function"><span class="hljs-params">track</span> =&gt;</span> myPeerConnection.addTrack(track, chatStream))<font></font>
        setStatusMessage(<span class="hljs-string">'Connected'</span>)<font></font>
    }).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {<font></font>
        setStatusMessage(<span class="hljs-string">'Failed to connect'</span>)<font></font>
    })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi dimulai dengan memanggil setStatusMessage (), menampilkan pesan 'Memanggil ...', yang berfungsi sebagai indikator bahwa upaya sedang dilakukan untuk melakukan panggilan. Kemudian getUserMedia () dipanggil, meminta aliran yang berisi trek video dan audio. Setelah aliran terbentuk, elemen video dipasang untuk menampilkan aliran dari kamera yang disebut 'tampilan sendiri', trek audio ditambahkan ke </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebRTC </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RTCPeerConnection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang merupakan koneksi ke pengguna lain. Setelah itu, status diperbarui ke 'Terhubung'. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika getUserMedia () gagal, blok tangkap diluncurkan. Ini menggunakan setStatusMessage () untuk menampilkan pesan kesalahan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan bahwa panggilan untuk mendapatkanUserMedia () dikembalikan bahkan jika aliran video belum diterima. </font><font style="vertical-align: inherit;">Bahkan jika fungsi handleCallButton () mengembalikan kontrol ke kode yang memanggilnya, begitu getUserMedia () menyelesaikan eksekusi, ia akan memanggil penangan. </font><font style="vertical-align: inherit;">Hingga aplikasi "memahami" bahwa siaran telah dimulai, getUserMedia () akan berada dalam mode siaga. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: Anda dapat mempelajari lebih lanjut tentang ini di artikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Sinyal dan panggilan video"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Artikel ini memberikan kode yang lebih lengkap daripada yang kita gunakan dalam contoh.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah Fungsi Panggilan Balik</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memahami mengapa janji adalah solusi yang baik, akan berguna untuk beralih ke cara lama menulis panggilan balik untuk melihat apa masalah mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai contoh, pertimbangkan memesan pizza. </font><font style="vertical-align: inherit;">Pesanan pizza yang berhasil terdiri dari beberapa langkah yang harus dilakukan berurutan, satu demi satu:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilih isian. </font><font style="vertical-align: inherit;">Ini bisa memakan waktu lama jika Anda memikirkannya untuk waktu yang lama, dan gagal jika Anda berubah pikiran dan memesan kari.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memesan. </font><font style="vertical-align: inherit;">Memasak pizza membutuhkan waktu dan mungkin gagal jika restoran kekurangan bahan-bahan yang diperlukan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mendapatkan pizza dan makan. </font><font style="vertical-align: inherit;">Menerima pizza mungkin gagal jika, misalnya, kami tidak dapat membayar pesanan.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pseudocode gaya lama yang menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fungsi callback</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin terlihat seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs">chooseToppings(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">toppings</span>)</span>{<font></font>
    placeOrder(toppings, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">order</span>)</span>{<font></font>
        collectOrder(order, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">pizza</span>)</span>{<font></font>
            eatPizza(pizza)<font></font>
        }, failureCallback)<font></font>
    }, failureCallback)<font></font>
}, failureCallback)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode semacam itu sulit dibaca dan dipelihara (sering disebut "neraka panggilan balik" atau "neraka panggilan balik"). </font><font style="vertical-align: inherit;">Fungsi failureCallback () harus dipanggil di setiap level penyarangan. </font><font style="vertical-align: inherit;">Ada masalah lain.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menggunakan janji</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Janji-janji membuat kode lebih bersih, lebih mudah dipahami dan didukung. </font><font style="vertical-align: inherit;">Jika kita menulis ulang kodesemu menggunakan janji asinkron, kita mendapatkan yang berikut:</font></font><br>
<br>
<pre><code class="javascript hljs">chooseToppings()<font></font>
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">toppings</span>)</span>{
    <span class="hljs-keyword">return</span> placeOrder(toppings)<font></font>
})<font></font>
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">order</span>)</span>{
    <span class="hljs-keyword">return</span> collectOrder(order)<font></font>
})<font></font>
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">pizza</span>)</span>{<font></font>
    eatPizza(pizza)<font></font>
})<font></font>
.catch(failureCallback)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini jauh lebih baik - kita melihat apa yang terjadi, kita menggunakan satu blok .catch () untuk menangani semua kesalahan, fungsinya tidak memblokir aliran utama (sehingga kita bisa bermain video game sambil menunggu pizza), setiap operasi dijamin akan dilakukan setelah yang sebelumnya selesai. </font><font style="vertical-align: inherit;">Karena setiap janji mengembalikan janji, kita dapat menggunakan rantai .then. </font><font style="vertical-align: inherit;">Bagus kan? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan fungsi panah, pseudo-code dapat lebih disederhanakan:</font></font><br>
<br>
<pre><code class="javascript hljs">chooseToppings()<font></font>
.then(<span class="hljs-function"><span class="hljs-params">toppings</span> =&gt;</span><font></font>
    placeOrder(toppings)<font></font>
)<font></font>
.then(<span class="hljs-function"><span class="hljs-params">order</span> =&gt;</span><font></font>
    collectOrder(order)<font></font>
)<font></font>
.then(<span class="hljs-function"><span class="hljs-params">pizza</span> =&gt;</span><font></font>
    eatPizza(pizza)     <font></font>
)<font></font>
.catch(failureCallback)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atau bahkan seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs">chooseToppings()<font></font>
.then(<span class="hljs-function"><span class="hljs-params">toppings</span> =&gt;</span> placeOrder(toppings))<font></font>
.then(<span class="hljs-function"><span class="hljs-params">order</span> =&gt;</span> collectOrder(order))<font></font>
.then(<span class="hljs-function"><span class="hljs-params">pizza</span> =&gt;</span> eatPizza(pizza))<font></font>
.catch(failureCallback)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berfungsi karena () =&gt; x identik dengan () =&gt; {return x}. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda bahkan dapat melakukan ini (karena fungsi hanya melewati parameter, kami tidak perlu layering):</font></font><br>
<br>
<pre><code class="javascript hljs">chooseToppings().then(placeOrder).then(collectOrder).then(eatPizza).catch(failureCallback)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode tersebut lebih sulit dibaca dan tidak dapat digunakan dengan konstruksi yang lebih kompleks daripada di pseudocode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: pseudo-code masih dapat ditingkatkan menggunakan async / menunggu, yang akan dibahas dalam artikel mendatang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada intinya, janji serupa dengan pendengar acara, tetapi dengan beberapa perbedaan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebuah janji hanya terpenuhi satu kali (sukses atau gagal). </font><font style="vertical-align: inherit;">Itu tidak dapat dieksekusi dua kali atau beralih dari sukses ke kegagalan atau sebaliknya setelah operasi selesai.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika janji itu selesai, dan kami menambahkan fungsi callback untuk memproses hasilnya, maka fungsi ini akan dipanggil, terlepas dari kenyataan bahwa peristiwa terjadi sebelum fungsi ditambahkan.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sintaks janji dasar: contoh nyata</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengetahui janji itu penting karena banyak API Web menggunakannya dalam fungsi yang berpotensi melakukan tugas kompleks. Bekerja dengan teknologi web modern melibatkan penggunaan janji. Nanti kita akan belajar bagaimana menulis janji kita sendiri, tetapi untuk sekarang, mari kita lihat beberapa contoh sederhana yang dapat ditemukan di Web API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada contoh pertama, kami menggunakan metode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetch ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mendapatkan gambar dari jaringan, metode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blob ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengonversi konten tubuh respons ke objek </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blob</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan menampilkan objek ini di dalam elemen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;img&gt;</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Contoh ini sangat mirip dengan contoh dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel pertama</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi kami akan melakukannya sedikit berbeda.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan: contoh berikut tidak akan berfungsi jika Anda menjalankannya dari file (mis. Menggunakan file: // URL). Anda perlu menjalankannya melalui </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server lokal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau menggunakan solusi online seperti </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">halaman </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Glitch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Pertama-tama, unggah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gambar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang akan kami terima. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Tambahkan elemen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;script&gt;</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke akhir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;body&gt;</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Di dalam elemen &lt;script&gt;, tambahkan baris berikut:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> promise = fetch(<span class="hljs-string">'coffee.jpg'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode fetch (), yang menggunakan URL gambar sebagai parameter, digunakan untuk mendapatkan gambar dari jaringan. Sebagai parameter kedua, kita dapat menentukan objek dengan pengaturan, tetapi untuk saat ini kita akan membatasi diri pada opsi sederhana. Kami menyimpan janji yang dikembalikan oleh fetch () dalam variabel janji. Seperti disebutkan sebelumnya, janji adalah objek yang mewakili negara perantara - nama resmi untuk negara tertentu sedang menunggu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Untuk bekerja dengan hasil penyelesaian janji yang berhasil (dalam kasus kami, ketika </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Respons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kembali </font><font style="vertical-align: inherit;">), kami memanggil metode </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.then ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fungsi panggilan balik di dalam blok .then () (sering disebut sebagai pelaksana) diluncurkan hanya ketika janji berhasil diselesaikan dan objek Respons dikembalikan - mereka mengatakan bahwa janji telah selesai (terpenuhi, terpenuhi). </font><font style="vertical-align: inherit;">Respons diberikan sebagai parameter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Pengoperasian blok .then () mirip dengan operasi pendengar peristiwa AddEventListener (). </font><font style="vertical-align: inherit;">Itu dipicu hanya setelah peristiwa itu terjadi (setelah memenuhi janji). </font><font style="vertical-align: inherit;">Perbedaan antara keduanya adalah bahwa. Maka () hanya dapat dipanggil sekali, sedangkan pendengar dirancang untuk beberapa panggilan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menerima respons, kami memanggil metode blob () untuk mengubah respons menjadi objek Blob. </font><font style="vertical-align: inherit;">Ini terlihat seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs">response =&gt; response.blob()
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... yang merupakan entri pendek untuk:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>)</span>{
    <span class="hljs-keyword">return</span> response.blob()<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OK, kata-kata yang cukup. </font><font style="vertical-align: inherit;">Tambahkan baris berikut setelah baris pertama:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> promise2 = promise.then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.blob())
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Setiap panggilan ke .then () menciptakan janji baru. </font><font style="vertical-align: inherit;">Ini sangat berguna: karena blob () juga mengembalikan sebuah janji, kita dapat memproses objek Blob dengan memanggil .then () pada janji kedua. </font><font style="vertical-align: inherit;">Mengingat bahwa kita ingin melakukan sesuatu yang lebih rumit daripada memanggil metode dan mengembalikan hasilnya, kita perlu membungkus tubuh fungsi dalam kurung kurawal (jika tidak, pengecualian akan dilemparkan): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan berikut ini di akhir kode:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> promise3 = promise2.then(<span class="hljs-function"><span class="hljs-params">myBlob</span> =&gt;</span> {<font></font>
<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Mari kita isi tubuh fungsi pelaksana. </font><font style="vertical-align: inherit;">Tambahkan baris berikut ke kawat gigi:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> objectURL = URL.createObjectURL(myBlob)
<span class="hljs-keyword">let</span> image = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>)<font></font>
image.src = objectURL<font></font>
<span class="hljs-built_in">document</span>.body.appendChild(image)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita memanggil metode URL.createObjectURL (), meneruskannya sebagai parameter Blob, yang mengembalikan janji kedua. </font><font style="vertical-align: inherit;">Kami mendapatkan tautan ke objek. </font><font style="vertical-align: inherit;">Kemudian kita membuat elemen &lt;img&gt;, mengatur atribut src dengan nilai tautan objek dan menambahkannya ke DOM sehingga gambar muncul di halaman. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda menyimpan HTML dan memuatnya di browser, Anda akan melihat bahwa gambar ditampilkan seperti yang diharapkan. </font><font style="vertical-align: inherit;">Kerja bagus! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Anda mungkin memperhatikan bahwa contoh-contoh ini agak dibuat-buat. </font><font style="vertical-align: inherit;">Anda dapat melakukannya tanpa metode fetch () dan blob () dan menetapkan URL &lt;img&gt; yang sesuai, coffee.jpg. </font><font style="vertical-align: inherit;">Kami menggunakan cara ini untuk menunjukkan bahwa bekerja dengan janji dengan contoh sederhana.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Respon Kegagalan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami lupa sesuatu - kami tidak memiliki penangan kesalahan jika salah satu janji gagal (akan ditolak). </font><font style="vertical-align: inherit;">Kami dapat menambahkan penangan kesalahan menggunakan metode .catch (). </font><font style="vertical-align: inherit;">Ayo lakukan itu:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> errorCase = promise3.catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'There has been a problem with your fetch operation: '</span> + e.message)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk melihat ini dalam tindakan, tentukan URL gambar yang salah dan muat ulang halaman. </font><font style="vertical-align: inherit;">Pesan kesalahan akan muncul di konsol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini, jika kita tidak menambahkan blok .catch (), pesan kesalahan juga akan ditampilkan di konsol. </font><font style="vertical-align: inherit;">Namun .catch () memungkinkan kita untuk menangani kesalahan seperti yang kita inginkan. </font><font style="vertical-align: inherit;">Dalam aplikasi nyata, blok .catch () Anda mungkin mencoba untuk mengambil kembali gambar atau menampilkan gambar default, atau meminta pengguna untuk memilih gambar lain atau melakukan sesuatu yang lain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Tonton </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo langsung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blok penggabungan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faktanya, pendekatan yang kita gunakan untuk menulis kode tidak optimal. </font><font style="vertical-align: inherit;">Kami sengaja menggunakan cara ini sehingga Anda dapat memahami apa yang terjadi di setiap tahap. </font><font style="vertical-align: inherit;">Seperti yang ditunjukkan sebelumnya, kita dapat menggabungkan blok .then () (dan .catch ()). </font><font style="vertical-align: inherit;">Kode kami dapat ditulis ulang sebagai berikut (lihat juga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simple-fetch-chained.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di GitHub):</font></font><br>
<br>
<pre><code class="javascript hljs">fetch(<span class="hljs-string">'coffee.jpg'</span>)<font></font>
.then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.blob())<font></font>
.then(<span class="hljs-function"><span class="hljs-params">myBlob</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> objectURL = URL.createObjectURL(myBlob)
    <span class="hljs-keyword">let</span> image = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>)<font></font>
    image.src = objectURL<font></font>
    <span class="hljs-built_in">document</span>.body.appendChild(image)<font></font>
})<font></font>
.catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'There has been a problem with your fetch operation: '</span> + e.message)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingat bahwa nilai yang dikembalikan oleh janji dilewatkan sebagai parameter ke pelaksana fungsi selanjutnya dari blok .then (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Blok .then () /. Catch () dalam janji-janji adalah ekuivalen asinkron dari blok try ... catch. </font><font style="vertical-align: inherit;">Ingat: coba sinkron ... catch tidak akan berfungsi dalam kode asinkron.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan Terminologi Janji</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita bekal dan menulis panduan singkat yang dapat Anda gunakan di masa depan. </font><font style="vertical-align: inherit;">Untuk menggabungkan pengetahuan, kami menyarankan Anda membaca bagian sebelumnya beberapa kali. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Ketika janji itu dibuat, mereka mengatakan bahwa itu dalam keadaan harapan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Ketika janji itu dikembalikan, mereka mengatakan bahwa itu telah selesai (diselesaikan):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Janji yang berhasil diselesaikan disebut terpenuhi. </font><font style="vertical-align: inherit;">Ini mengembalikan nilai yang bisa diperoleh melalui rantai dari. Kemudian () di akhir janji. </font><font style="vertical-align: inherit;">Fungsi eksekusi di blok .then () berisi nilai yang dikembalikan oleh janji.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Janji yang gagal diselesaikan disebut ditolak. </font><font style="vertical-align: inherit;">Ini mengembalikan alasan, pesan kesalahan yang mengarah pada penolakan janji. </font><font style="vertical-align: inherit;">Alasan ini dapat diperoleh melalui blok .catch () di akhir janji.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jalankan kode setelah beberapa janji</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami belajar dasar-dasar menggunakan janji. Sekarang mari kita lihat fitur yang lebih canggih. Rantai dari .then () baik-baik saja, tetapi bagaimana jika kita ingin memanggil beberapa blok janji satu per satu? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melakukan ini menggunakan metode standar Promise.all (). Metode ini mengambil array janji sebagai parameter dan mengembalikan janji baru ketika semua janji dalam array dipenuhi. Itu terlihat seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">Promise</span>.all([a,b,c]).then(<span class="hljs-function"><span class="hljs-params">values</span> =&gt;</span> {<font></font>
        ...<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika semua janji dipenuhi, pelaksana array blok .then () akan diteruskan sebagai parameter. Jika setidaknya satu dari janji tidak terpenuhi, seluruh blok akan ditolak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini bisa sangat membantu. Bayangkan kami menerima informasi karena secara dinamis mengisi antarmuka pengguna dengan konten di halaman kami. Dalam banyak kasus, lebih masuk akal untuk menerima semua informasi dan menampilkannya pada halaman lebih lambat daripada menampilkan informasi dalam beberapa bagian. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat contoh lain: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Unduh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">templat halaman</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan letakkan tag &lt;script&gt; sebelum tag &lt;/body&gt; penutup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Unduh file sumber ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coffee.jpg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tea.jpg</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">description.txt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) atau ganti dengan milik Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Dalam skrip, pertama-tama kita mendefinisikan fungsi yang mengembalikan janji yang kita berikan ke Promise.all (). </font><font style="vertical-align: inherit;">Ini akan mudah dilakukan jika kita menjalankan Promise.all () setelah menyelesaikan tiga operasi pengambilan (). </font><font style="vertical-align: inherit;">Kita dapat melakukan hal berikut:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> a = fetch(url1)
<span class="hljs-keyword">let</span> b = fetch(url2)
<span class="hljs-keyword">let</span> c = fetch(url3)<font></font>
<font></font>
<span class="hljs-built_in">Promise</span>.all([a, b, c]).then(<span class="hljs-function"><span class="hljs-params">values</span> =&gt;</span> {<font></font>
    ...<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika janji terpenuhi, variabel "nilai" akan berisi tiga objek Respons, satu dari setiap operasi pengambilan () yang diselesaikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, kami tidak menginginkan ini. </font><font style="vertical-align: inherit;">Tidak masalah bagi kami saat operasi fetch () selesai. </font><font style="vertical-align: inherit;">Yang kami inginkan adalah data yang dimuat. </font><font style="vertical-align: inherit;">Ini berarti bahwa kami ingin menjalankan blok Promise.all () setelah menerima gumpalan valid yang mewakili gambar dan string teks yang valid. </font><font style="vertical-align: inherit;">Kita dapat menulis fungsi yang melakukan ini; </font><font style="vertical-align: inherit;">tambahkan berikut ini ke elemen &lt;script&gt; Anda:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchAndDecode</span>(<span class="hljs-params">url, type</span>)</span>{
    <span class="hljs-keyword">return</span> fetch(url).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
        <span class="hljs-keyword">if</span>(type === <span class="hljs-string">'blob'</span>){
            <span class="hljs-keyword">return</span> response.blob()<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(type === <span class="hljs-string">'text'</span>){
            <span class="hljs-keyword">return</span> response.text()<font></font>
        }<font></font>
    }).catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'There has been a problem with your fetch operation '</span> + e.message)<font></font>
    })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu terlihat agak rumit, jadi mari kita pergi melalui kode langkah demi langkah: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Pertama-tama, kita mendeklarasikan suatu fungsi dan meneruskannya URL dan jenis file yang dihasilkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Struktur fungsi ini mirip dengan yang kita lihat pada contoh pertama - kita memanggil fungsi fetch () untuk mendapatkan file di URL tertentu dan kemudian mentransfer file ke janji lain yang mengembalikan tubuh respons (baca) yang diterjemahkan. </font><font style="vertical-align: inherit;">Pada contoh sebelumnya, selalu metode blob (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Ada dua perbedaan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama, janji pengembalian kedua tergantung pada jenis nilai. </font><font style="vertical-align: inherit;">Di dalam fungsi eksekusi, kita menggunakan pernyataan if ... else jika untuk mengembalikan janji tergantung pada jenis file yang perlu kita dekode (dalam hal ini, kita memilih antara gumpalan dan teks, tetapi contohnya dapat dengan mudah diperluas untuk bekerja dengan jenis lain).</font></font></li>
<li>-,     «return»   fetch().       ,     (..   ,  blob()  text(),  ,  ,   ).  ,  return     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Pada akhirnya, kita memanggil metode .catch () untuk menangani kesalahan yang mungkin muncul dalam janji dalam array yang diteruskan ke .all (). Jika salah satu janji ditolak, blok tangkap akan memberi tahu kami dengan janji apa masalahnya. Blok .all () masih akan dieksekusi, tetapi itu tidak akan menampilkan hasil yang ada kesalahannya. Jika Anda ingin .all () ditolak, tambahkan blok .catch () di akhir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode di dalam fungsi asinkron dan didasarkan pada janji, sehingga seluruh fungsi berfungsi seperti janji. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Selanjutnya, kita memanggil fungsi kita tiga kali untuk memulai proses menerima dan mendekode gambar dan teks, dan menempatkan masing-masing janji dalam variabel. Tambahkan yang berikut ini:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> coffee = fetchAndDecode(<span class="hljs-string">'coffee.jpg'</span>, <span class="hljs-string">'blob'</span>)
<span class="hljs-keyword">let</span> tea = fetchAndDecode(<span class="hljs-string">'tea.jpg'</span>, <span class="hljs-string">'blob'</span>)
<span class="hljs-keyword">let</span> description = fetchAndDecode(<span class="hljs-string">'description.txt'</span>, <span class="hljs-string">'text'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Selanjutnya, kami mendeklarasikan blok Promise.all () untuk menjalankan beberapa kode hanya setelah ketiga janji telah dipenuhi. </font><font style="vertical-align: inherit;">Tambahkan blok dengan fungsi eksekutor kosong di dalam .then ():</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">Promise</span>.all([coffee, tea, description]).then(<span class="hljs-function"><span class="hljs-params">values</span> =&gt;</span> {<font></font>
<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat bahwa dibutuhkan sejumlah janji sebagai parameter. </font><font style="vertical-align: inherit;">Kontraktor akan mulai hanya setelah ketiga janji dipenuhi; </font><font style="vertical-align: inherit;">ketika ini terjadi, hasil dari setiap janji (badan respons yang diterjemahkan) akan ditempatkan dalam array, ini dapat direpresentasikan sebagai [hasil kopi, hasil teh, hasil deskripsi]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. Terakhir, tambahkan berikut ini ke pelaksana (di sini kami menggunakan kode sinkron yang cukup sederhana untuk meletakkan hasilnya dalam variabel (membuat objek URL dari gumpalan) dan menampilkan gambar dan teks pada halaman):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.log(values)
<span class="hljs-comment">//       </span>
<span class="hljs-keyword">let</span> objectURL1 = URL.createObjectURL(values[<span class="hljs-number">0</span>])
<span class="hljs-keyword">let</span> objectURL2 = URL.createObjectURL(values[<span class="hljs-number">1</span>])
<span class="hljs-keyword">let</span> descText = values[<span class="hljs-number">2</span>]<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">let</span> image1 = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>)
<span class="hljs-keyword">let</span> image2 = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>)<font></font>
image1.src = objectURL1<font></font>
image2.src = objectURL2<font></font>
<span class="hljs-built_in">document</span>.body.appendChild(image1)
<span class="hljs-built_in">document</span>.body.appendChild(image2)<font></font>
<font></font>
<span class="hljs-comment">//  </span>
<span class="hljs-keyword">let</span> para = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'p'</span>)<font></font>
para.textContent = descText<font></font>
<span class="hljs-built_in">document</span>.body.appendChild(para)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Simpan perubahan dan muat ulang halaman. Anda harus melihat bahwa semua komponen antarmuka pengguna memuat, meskipun ini tidak terlihat sangat menarik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. Jika Anda mengalami kesulitan, Anda dapat membandingkan versi kode dengan versi kami - ini adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo langsung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. Untuk meningkatkan kode ini, Anda dapat mengulang elemen yang ditampilkan, menerima dan mendekodekan masing-masing, dan kemudian mengulang melalui hasil di dalam Promise.all (), meluncurkan fungsi yang berbeda untuk menampilkan setiap hasil tergantung pada jenisnya. Ini akan memungkinkan Anda untuk bekerja dengan sejumlah elemen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, Anda dapat menentukan jenis file yang dihasilkan tanpa harus secara eksplisit menentukan tipe properti. Ini, misalnya, dapat dilakukan dengan</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">response.headers.get ('tipe konten')</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk memeriksa header </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipe Konten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Protokol HTTP.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jalankan kode setelah memenuhi / menolak janji</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seringkali, Anda mungkin perlu mengeksekusi kode setelah janji selesai, terlepas dari apakah itu dieksekusi atau ditolak. </font><font style="vertical-align: inherit;">Sebelumnya, kami harus memasukkan kode yang sama di blok .then () dan .catch (), misalnya:</font></font><br>
<br>
<pre><code class="javascript hljs">myPromise<font></font>
.then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {<font></font>
    doSomething(response)<font></font>
    runFinalCode()<font></font>
})<font></font>
.catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
    returnError(e)<font></font>
    runFinalCode()<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di browser modern, metode .finally () tersedia, yang memungkinkan Anda menjalankan kode setelah janji selesai, yang menghindari pengulangan dan membuat kode lebih elegan. </font><font style="vertical-align: inherit;">Kode dari contoh sebelumnya dapat ditulis ulang sebagai berikut:</font></font><br>
<br>
<pre><code class="javascript hljs">myPromise<font></font>
.then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {<font></font>
    doSomething(response)<font></font>
})<font></font>
.catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
    returnError(e)<font></font>
})<font></font>
.finally(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<font></font>
    runFinalCode()<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat penggunaan pendekatan ini dengan contoh nyata - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo langsung janji-akhirnya.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ini bekerja sama dengan Promise.all () dari contoh sebelumnya, kecuali bahwa kita akhirnya menambahkan () ke akhir rantai di fungsi fetchAndDecode ():</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchAndDecode</span>(<span class="hljs-params">url, type</span>)</span>{
    <span class="hljs-keyword">return</span> fetch(url).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
        <span class="hljs-keyword">if</span>(type === <span class="hljs-string">'blob'</span>){
            <span class="hljs-keyword">return</span> response.blob()<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(type === <span class="hljs-string">'text'</span>){
            <span class="hljs-keyword">return</span> response.text()<font></font>
        }<font></font>
    }).catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`There has been a problem with your fetch operation for resource "<span class="hljs-subst">${url}</span>": <span class="hljs-subst">${e.message}</span>`</span>)<font></font>
    }).finally(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`fetch attempt for "<span class="hljs-subst">${url}</span>" finished.`</span>)<font></font>
    })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menerima pesan tentang selesainya setiap upaya untuk mendapatkan file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">maka () / catch () / akhirnya () adalah ekuivalen asinkron dari try sinkron () / catch () / akhirnya ().</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menulis Janji Anda Sendiri</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berita baiknya adalah Anda sudah tahu cara melakukannya. </font><font style="vertical-align: inherit;">Saat Anda menggabungkan beberapa janji dengan .then (), atau menggabungkannya untuk menyediakan fungsionalitas tertentu, Anda membuat fungsi asinkron dan janji berbasis Anda sendiri. </font><font style="vertical-align: inherit;">Ambil contoh fungsi fetchAndDecode () kami dari contoh sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggabungkan berbagai API berbasis janji untuk membuat fungsionalitas spesifik adalah cara paling umum untuk bekerja dengan janji, yang menunjukkan fleksibilitas dan kekuatan API modern. </font><font style="vertical-align: inherit;">Namun, ada cara lain.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Janji Pembuat ()</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat membuat janji sendiri menggunakan konstruktor Promise (). Ini mungkin diperlukan dalam situasi di mana Anda memiliki kode dari API asinkron yang lama yang perlu Anda "besarkan". Hal ini dilakukan agar dapat bekerja secara simultan baik dengan kode lama, perpustakaan, atau "kerangka kerja" yang ada, dan dengan kode berbasis janji yang baru. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat contoh sederhana - di sini kita bungkus panggilan setTimeout () dengan janji - ini akan memulai fungsinya dalam 2 detik, yang akan memenuhi janji (menggunakan panggilan resol () yang diteruskan) dengan string "Sukses!".</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> timeoutPromise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {<font></font>
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
        resolve(<span class="hljs-string">'Success!'</span>)<font></font>
    }, <span class="hljs-number">2000</span>)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
resolving () dan reject () adalah fungsi yang dipanggil untuk memenuhi atau menolak janji baru. </font><font style="vertical-align: inherit;">Dalam hal ini, janji dipenuhi dengan string "Sukses!". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat Anda menyebut janji ini, Anda bisa menambahkan blok .then () untuknya bekerja lebih jauh dengan Garis "Sukses!". </font><font style="vertical-align: inherit;">Jadi kami dapat menampilkan baris dalam pesan:</font></font><br>
<br>
<pre><code class="javascript hljs">timeoutPromise<font></font>
.then(<span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {<font></font>
    alert(message)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... atau lebih:</font></font><br>
<br>
<pre><code class="javascript hljs">timeoutPromise.then(alert)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tonton </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demo langsung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh yang diberikan tidak terlalu fleksibel - janji hanya dapat dipenuhi dengan garis sederhana, kami tidak memiliki penangan kesalahan - tolak () (sebenarnya setTimeout () tidak memerlukan penangan kesalahan, jadi dalam hal ini tidak masalah). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Mengapa menyelesaikan () daripada memenuhi ()? </font><font style="vertical-align: inherit;">Saat ini, jawabannya adalah ini: sulit untuk dijelaskan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami bekerja dengan penolakan terhadap sebuah janji</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kita dapat membuat janji yang ditolak menggunakan metode tolak () - seperti halnya resol (), tolak () mengambil nilai sederhana, tetapi tidak seperti tekad (), nilai sederhana bukanlah hasilnya, tetapi alasan penolakan, yaitu. </font><font style="vertical-align: inherit;">kesalahan yang diteruskan ke blok .catch (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita kembangkan contoh sebelumnya dengan menambahkan syarat untuk menolak janji, serta kemampuan untuk menerima pesan selain pesan sukses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ambil </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contoh sebelumnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan tulis ulang seperti ini:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">timeoutPromise</span>(<span class="hljs-params">message, interval</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span>(message === <span class="hljs-string">''</span> || <span class="hljs-keyword">typeof</span> message !== <span class="hljs-string">'string'</span>){<font></font>
            reject(<span class="hljs-string">'Message is empty or not a string'</span>)<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(interval &lt; <span class="hljs-number">0</span> || <span class="hljs-keyword">typeof</span> interval !== number){<font></font>
            reject(<span class="hljs-string">'Interval is negative or not a number'</span>)<font></font>
        } <span class="hljs-keyword">else</span>{<font></font>
            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
                resolve(message)<font></font>
            }, interval)<font></font>
        }<font></font>
    })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita menyampaikan dua argumen ke fungsi - pesan dan interval (waktu tunda). </font><font style="vertical-align: inherit;">Dalam suatu fungsi, kami mengembalikan objek Janji. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam konstruktor Janji, kami melakukan beberapa pemeriksaan menggunakan struktur if ... else:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama, kami memeriksa pesannya. </font><font style="vertical-align: inherit;">Jika kosong atau bukan string, maka kami menolak janji itu dan melaporkan kesalahan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kedua, kami memeriksa penundaan waktu. </font><font style="vertical-align: inherit;">Jika itu negatif atau bukan angka, maka kami juga menolak janji itu dan melaporkan kesalahan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya, jika kedua argumen OK, tampilkan pesan setelah waktu tertentu (interval) menggunakan setTimeout ().</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena timeoutPromise () mengembalikan sebuah janji, kita dapat menambahkan .then (), .catch (), dll. Untuk meningkatkan fungsionalitasnya. </font><font style="vertical-align: inherit;">Ayo lakukan itu:</font></font><br>
<br>
<pre><code class="javascript hljs">timeoutPromise(<span class="hljs-string">'Hello there!'</span>, <span class="hljs-number">1000</span>)<font></font>
.then(<span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {<font></font>
    alert(message)<font></font>
}).catch(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Error: '</span> + e)<font></font>
})<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menyimpan perubahan dan menjalankan kode, Anda akan melihat pesan setelah satu detik. </font><font style="vertical-align: inherit;">Sekarang coba lewati string kosong sebagai pesan atau angka negatif sebagai interval. </font><font style="vertical-align: inherit;">Anda akan melihat pesan kesalahan sebagai akibat dari menolak janji. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Catatan. </font><font style="vertical-align: inherit;">Anda dapat menemukan versi kami dari contoh ini di GitHub - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">custom-janji2.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sumber</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh yang lebih realistis.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh yang kami periksa membuatnya mudah untuk memahami konsep, tetapi tidak benar-benar tidak sinkron. Asynchrony dalam contoh disimulasikan menggunakan setTimeout (), meskipun masih menunjukkan kegunaan janji untuk membuat fungsi dengan alur kerja yang masuk akal, penanganan kesalahan yang baik, dll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu contoh aplikasi asinkron yang berguna yang menggunakan konstruktor Promise () adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">idb library (IndexedDB with usability)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jake Archibald. </font><font style="vertical-align: inherit;">Pustaka ini memungkinkan Anda untuk menggunakan API IndexedDB (berdasarkan fungsi panggilan balik API untuk menyimpan dan mengambil data di sisi klien), yang ditulis dalam gaya lama, dengan janji. </font><font style="vertical-align: inherit;">Jika Anda melihat file perpustakaan utama, Anda akan melihat bahwa itu menggunakan teknik yang sama yang kami periksa di atas. </font><font style="vertical-align: inherit;">Kode berikut mengonversi model kueri dasar yang digunakan oleh banyak metode IndexedDB ke model yang kompatibel dengan janji:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">promisifyRequest</span>(<span class="hljs-params">request</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>)</span>{<font></font>
        request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
            resolve(request.result)<font></font>
        }<font></font>
<font></font>
        request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
            reject(request.error)<font></font>
        }<font></font>
    })<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini menambahkan beberapa penangan acara yang memenuhi atau menolak janji, yang sesuai:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika permintaan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berhasil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pawang onsuc memenuhi janji dengan hasil dari permintaan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika permintaan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gagal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , penangan onerror menolak janji dengan kesalahan permintaan.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Janji adalah cara terbaik untuk membuat aplikasi asinkron ketika kita tidak tahu nilai apa yang akan dihasilkan fungsi atau berapa lama waktu yang dibutuhkan. Mereka memungkinkan Anda untuk bekerja dengan urutan operasi asinkron tanpa menggunakan fungsi panggilan balik yang sangat bersarang, dan mereka mendukung gaya penanganan kesalahan dari pernyataan coba-coba catch ... catch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Janji didukung oleh semua browser modern. Satu-satunya pengecualian adalah Opera Mini dan IE11 dan versi sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam artikel ini, kami telah mempertimbangkan jauh dari semua fitur janji, hanya yang paling menarik dan berguna. Anda akan mengenal fitur dan teknik lain jika Anda ingin mempelajari lebih lanjut tentang janji.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagian besar API Web modern didasarkan pada janji, sehingga janji harus diketahui. </font><font style="vertical-align: inherit;">Di antara API Web ini kita dapat memberi nama </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebRTC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Audio Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Media Capture dan Stream</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. Janji-janji akan menjadi semakin populer, sehingga studi dan pemahaman mereka merupakan langkah penting menuju penguasaan JavaScript modern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga lihat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Kesalahan Umum dalam JavaScript Menjanjikan Semua Orang Harus Tahu Tentang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">” </font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih atas perhatian Anda. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kritik konstruktif dipersilahkan.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id488750/index.html">Dinosaur Walk: Dua Komputer Besar abad ke-20</a></li>
<li><a href="../id488752/index.html">Golang + Phaser3 = MMORPG - Kami membuat dasar untuk generasi dunia tanpa akhir</a></li>
<li><a href="../id488754/index.html">Sekaligus: pemeriksaan otomatis ukuran bundel</a></li>
<li><a href="../id488756/index.html">Cara bekerja dengan Google Sheets API (Google Sheets API v4) di R menggunakan paket googlesheets4 baru</a></li>
<li><a href="../id488758/index.html">Konferensi DEFCON 27. Pengakuan Penipuan Internet</a></li>
<li><a href="../id488766/index.html">Seni dan Teknologi: Universitas Massachusetts di Lowell</a></li>
<li><a href="../id488768/index.html">Neraka berdarah, atau Cara bersumpah dalam bahasa Inggris untuk dikira orang yang berbudaya</a></li>
<li><a href="../id488776/index.html">Peningkatan Aksesibilitas di Visual Studio 2019 untuk Mac</a></li>
<li><a href="../id488778/index.html">Struktur data: daftar yang dapat melakukan segalanya *</a></li>
<li><a href="../id488780/index.html">Mozilla hilang dalam perang browser, tetapi masih percaya itu bisa menyelamatkan Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>