<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏿 ⬅️ 👩🏼 O que você precisa saber sobre coleções baseadas em hash 🎅🏿 👂🏽 👩🏾‍🤝‍👩🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Olá a todos. Em contato com Vladislav Rodin. Atualmente, sou o chefe do curso de arquiteto de carga alta da OTUS e também ensino cursos de arquitetura...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>O que você precisa saber sobre coleções baseadas em hash</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/495032/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olá a todos. </font><font style="vertical-align: inherit;">Em contato com Vladislav Rodin. </font><font style="vertical-align: inherit;">Atualmente, sou o chefe do curso de arquiteto de carga alta da OTUS e também ensino cursos de arquitetura de software. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Além do ensino, como você deve ter notado, também estou escrevendo material com direitos autorais para o blog OTUS em Habré e quero dedicar o artigo de hoje ao lançamento de um novo fluxo do curso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Algoritmos para desenvolvedores"</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/uz/cy/uo/uzcyuoeiheb64r-2xjnd8r4ntm4.png"><br>
<hr><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdução</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabelas de hash (HashMap), juntamente com matrizes dinâmicas, são as estruturas de dados mais populares usadas na produção. </font><font style="vertical-align: inherit;">Muitas vezes, você pode ouvir perguntas em entrevistas sobre seus propósitos, recursos de sua estrutura interna e algoritmos relacionados. </font><font style="vertical-align: inherit;">Essa estrutura de dados é clássica e é encontrada não apenas em Java, mas também em muitas outras linguagens de programação.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulação do problema</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos definir uma meta para criar uma estrutura de dados que permita:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contém (elemento Elemento)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica se um elemento está nele ou não, para O (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">add (elemento Element)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adiciona um elemento em O (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete (elemento Element)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exclui um elemento em O (1)</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matriz</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar fazer essas operações sobre uma matriz, que é a estrutura de dados mais simples. </font><font style="vertical-align: inherit;">Concordamos que consideraremos a célula vazia se ela contiver nulo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificação de disponibilidade</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É necessário fazer uma pesquisa linear através da matriz, porque o elemento pode estar potencialmente em qualquer célula. </font><font style="vertical-align: inherit;">Assintoticamente, isso pode ser feito em O (n), onde n é o tamanho da matriz.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se precisarmos adicionar um elemento em qualquer lugar, primeiro precisamos encontrar uma célula vazia e depois gravar o elemento nela. </font><font style="vertical-align: inherit;">Assim, realizamos novamente uma pesquisa linear e obtemos o comportamento assintótico de O (n).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excluir</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para excluir um elemento, você deve primeiro encontrá-lo e depois escrever nulo na célula encontrada. </font><font style="vertical-align: inherit;">Novamente, a pesquisa linear nos leva a O (n).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O conjunto de hash mais simples</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Observe que, a cada operação, primeiro pesquisamos o índice da célula desejada e, em seguida, realizamos a operação, e é a pesquisa que estraga os assintóticos para nós! Se aprendêssemos a obter esse índice para O (1), o problema original seria resolvido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos agora substituir a pesquisa linear pelo seguinte algoritmo: calcularemos o valor de uma determinada função - uma </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">função hash</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que mapeia um objeto de classe para um número inteiro. Depois disso, compararemos o número inteiro resultante com o índice da célula da matriz (isso é bastante fácil, por exemplo, tomar o restante da divisão desse número pelo tamanho da matriz). Se a função hash é escrita de tal maneira que é considerada O (1) (e geralmente é escrita assim), obtemos a implementação mais simples do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de hash</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Uma célula de matriz em termos de um conjunto de hash pode ser chamada de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bucket</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os problemas da implementação mais simples de um conjunto de hash</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não importa como a função hash seja escrita, o número de células na matriz é sempre limitado, enquanto o conjunto de elementos que queremos armazenar na estrutura de dados é ilimitado. </font><font style="vertical-align: inherit;">Afinal, não nos preocuparíamos com a estrutura de dados se houvesse a necessidade de salvar apenas dez elementos conhecidos anteriormente, certo? </font><font style="vertical-align: inherit;">Esse estado de coisas leva a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conflitos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inevitáveis </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Uma colisão é uma situação em que, ao adicionar objetos diferentes, caímos na mesma célula na matriz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dois métodos foram inventados para resolver colisões: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">método de </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">encadeamento</font></b><font style="vertical-align: inherit;"> e </font><b><font style="vertical-align: inherit;">o método de endereçamento aberto</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Método de encadeamento</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O método de encadeamento é o método mais simples para resolver colisões. Na célula da matriz, não armazenaremos os elementos, mas uma lista vinculada desses elementos. Como adicionar ao topo da lista (e não nos importamos com qual parte da lista adicionar o elemento) tem o comportamento assintótico de O (1), não estragaremos o comportamento assintótico geral e permanecerá igual a O (1). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa implementação tem um problema: se as listas crescem muito (como último recurso, podemos considerar uma função hash que retorna uma constante para qualquer objeto), obtemos os assintóticos O (m), em que m é o número de elementos no conjunto, se o tamanho matriz é fixa. Para evitar tais problemas, o conceito </font><b><font style="vertical-align: inherit;">de</font></b><font style="vertical-align: inherit;"> ciclo </font><b><font style="vertical-align: inherit;">de serviço</font></b><font style="vertical-align: inherit;"> é introduzido.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(pode ser igual, por exemplo, 1,5). </font><font style="vertical-align: inherit;">Se ao adicionar um elemento, verifica-se que a fração do número de elementos que estão na estrutura de dados em relação ao tamanho da matriz excede o fator de preenchimento, acontece o seguinte: uma nova matriz é selecionada cujo tamanho excede o tamanho da matriz antiga (por exemplo, 2 vezes) e a estrutura de dados é reconstruída na nova matriz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse método de resolução de colisões é usado em Java e a estrutura de dados é chamada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HashSet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Método de endereçamento aberto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse método, os próprios elementos são armazenados nas células e, no caso de uma colisão, ocorre uma </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequência de amostras</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou seja, começamos a classificar as células usando algum algoritmo na esperança de encontrar um livre. </font><font style="vertical-align: inherit;">Isso pode ser feito por diferentes algoritmos ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sequência linear / quadrática de amostras</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hash duplo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), cada um com seus próprios problemas (por exemplo, o surgimento de </font><b><font style="vertical-align: inherit;">clusters </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primários</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secundários</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De um conjunto de hash para uma tabela de hash (HashMap)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos criar uma estrutura de dados que permita adicionar, excluir, procurar itens, mas por alguma chave, tão rapidamente quanto um conjunto de hash (ou seja, além de O (1)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usaremos a mesma estrutura de dados que o conjunto de hash, mas não armazenaremos elementos, mas pares de elementos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, a inserção (put (Key key, Value value)) será realizada da seguinte forma: calcularemos a célula da matriz por um objeto do tipo Key, obteremos o número de bucket. Vamos percorrer a lista no balde, comparando a chave com a chave em pares armazenados. Se você encontrar a mesma chave - basta extrair o valor antigo, se você não a encontrar - adicione um par.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como um item é recebido pela chave? </font><font style="vertical-align: inherit;">Sim, de acordo com um princípio semelhante: obtemos um balde por chave, examinamos os pares e retornamos o valor em um par, cuja chave é igual à chave na solicitação, se houver um par, e nulo de outra forma. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa estrutura de dados é chamada de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tabela de hash</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perguntas típicas da entrevista</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P: Como o HashSet e o HashMap são organizados? </font><font style="vertical-align: inherit;">Como são realizadas as principais operações nessas coleções? </font><font style="vertical-align: inherit;">Como os métodos equals () e hashCode () são aplicados? </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : As respostas para essas perguntas podem ser encontradas acima. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P: Qual é o contrato para equals () e hashCode ()? </font><font style="vertical-align: inherit;">A que se deve? </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Se os objetos forem iguais, eles deverão ter o hashCode igual. </font><font style="vertical-align: inherit;">Portanto, o hashCode deve ser determinado pela capacidade dos campos envolvidos em iguais. </font><font style="vertical-align: inherit;">A violação deste contrato pode levar a efeitos muito interessantes. </font><font style="vertical-align: inherit;">Se os objetos forem iguais, mas seu hashCode for diferente, talvez você não obtenha o valor correspondente à chave pela qual você acabou de adicionar o objeto ao HashSet ou ao HashMap.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusão</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas entrevistas, eles gostam de perguntar casos diferentes relacionados a essas estruturas de dados. </font><font style="vertical-align: inherit;">Além disso, a decisão de qualquer um deles pode ser deduzida da compreensão dos princípios de seu trabalho sem nenhum "empilhamento".</font></font><br>
<br>
<hr><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso é tudo. </font><font style="vertical-align: inherit;">Se você leu o material até o final, convido </font><font style="vertical-align: inherit;">minha colega Evgeny Volosatov a mostrar </font><b><font style="vertical-align: inherit;">como resolver o problema das olimpíadas usando as idéias da programação dinâmica</font></b><font style="vertical-align: inherit;"> para uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lição gratuita</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre o tema "Segredos da programação dinâmica" </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></b></i><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495014/index.html">Conteúdo on-line aberto do Centro de Ciência da Computação, Parte 2</a></li>
<li><a href="../pt495022/index.html">Escrevendo um controle deslizante JavaScript complicado, mas interessante</a></li>
<li><a href="../pt495024/index.html">Smali cheat sheet em russo</a></li>
<li><a href="../pt495026/index.html">Você está fazendo errado: calculando a profundidade</a></li>
<li><a href="../pt495030/index.html">Como memorizar palavras e frases estrangeiras</a></li>
<li><a href="../pt495036/index.html">Um bot simples do Telegram no Flask com previsão do tempo</a></li>
<li><a href="../pt495038/index.html">Design na Confluence</a></li>
<li><a href="../pt495042/index.html"># 01 - E um byte inteiro não é suficiente ... | O que são introduções?</a></li>
<li><a href="../pt495068/index.html">Primitivas do estilo OpenGL RAII</a></li>
<li><a href="../pt495072/index.html">Escritório em casa em um dispositivo móvel: usando o Samsung DeX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>