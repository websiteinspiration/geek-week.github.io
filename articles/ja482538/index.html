<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏽 🥌 🍜 CTFタスクの解析 🐵 🛌🏿 ✊🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="12月上旬には、情報セキュリティのチーム大会を開催しました。OTUSに加えて、「ホワイトハッカー」のイベントの主催者はVolga CTFとCTF.Moscowでした。たぶん、タスクについて要約して詳細に話す時が来たのでしょう。
 
 まず、イベントが成功しました：
 
 

- ペンテスト、リバース...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CTFタスクの解析</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/482538/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12月上旬には</font><font style="vertical-align: inherit;">、情報セキュリティの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チーム大会</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を開催しました</font><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OTUS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">加えて</font><font style="vertical-align: inherit;">、「ホワイトハッカー」のイベントの主催者は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Volga CTF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CTF.Moscowでした</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たぶん、タスクについて要約して詳細に話す時が来たのでしょう。</font></font><a name="habracut"></a></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まず、イベントが成功しました：</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ペンテスト、リバースエンジニアリング、Linuxセキュリティ、安全な開発の3つの領域で9つのタスクが準備されました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 217チームが参加しました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> フラグを渡す試みが800回以上登録されました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 渡された300を超えるフラグが登録されました。 </font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/wz/hb/ul/wzhbulaaw9vhnblzhk4w9jzpche.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、タスクはそうではない、誰もが問題を解決することができ、複雑さが異なっていた：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2e/uh/v3/2euhv3gwoznv4womber0-o-513w.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すぐにオンラインマラソンの完了後に、私たちが開催された</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3つのウェビナー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は勝者の話正しい答えを与え、最終結果を発表しました：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- CTF結果： 「Linuxセキュリティと安全な開発」;</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5tt8xsAhYBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-CTF結果：ペンテスト;</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6Dm-gk86yJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-CTFの結果：「リバースエンジニアリング」。</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Cx-ALK8laXI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第4に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">条件とその解決策のテキストによる説明</font></b><font style="vertical-align: inherit;">をユーザーの注意に</font><b><font style="vertical-align: inherit;">引き付けます</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">一部のタスクにはファイルが含まれていることに注意してください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向1：ペンテスト</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク1-データベース</font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトはデータベースを積極的に使用しています。 SQLインジェクションを実行してください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトへのリンク：</font></font><code>http://193.41.142.9:8001/shop/login</code></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ストア/ショップ/製品/のメインセクションに移動し、検索フィールドを覗くと、SQLインジェクションが見つかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、下にスクロールし、以前行方不明になった製品を参照してください、フラグはその説明である- 1「OR」1「=」1」を入力します。</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ{5ql_1nject10n_15_t00_51mpl3_f0r_y0u}：旗</font></font></i></b><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク2 -クッキー</font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">150 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の友人は、オンラインストアプラットフォームを開発した彼は、ブラックボックスを求めました。 -testing。Cookieのセキュリティを確認すると、管理者権限を取得できる場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトへのリンク：</font></font><code>http://193.41.142.9:8001/shop/login</code></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ログインしてCookieを確認し、Cookieのシークレットを確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«MTExMTAxMSAxMDAwMTAgMTExMDEwMSAxMTEwMDExIDExMDAxMDEgMTExMDAxMCAxMTAxMTEwIDExMDAwMDEgMTEwMTEwMSAxMTAwMTAxIDEwMDAxMCAxMTEwMTAgMTAwMDEwIDExMTAxMDEgMTExMDAxMSAxMTAwMTAxIDExMTAwMTAgMTAwMDEwIDEwMTEwMCAxMDAwMDAgMTAwMDEwIDExMDEwMDEgMTExMDAxMSAxMDExMTExIDExMDAwMDEgMTEwMDEwMCAxMTAxMTAxIDExMDEwMDEgMTEwMTExMCAxMDAwMTAgMTExMDEwIDEwMDAxMCAxMDAwMTEwIDExMDAwMDEgMTEwMTEwMCAxMTEwMDExIDExMDAxMDEgMTAwMDEwIDExMTExMDE =» </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デコードbase64で、我々はバイナリデータを取得：1111011 100010 1110101 1110011 1100101 1110010 1101110 1100001 1101101 1100101 100010 111010 100010 1110101 1110011 1100101 1110010 100010 101100 100000 100010 1101001 1110011 1011111 1100001 1100100 1101101 1101001 1101110 100010 111010 100010 1000110 1100001 1101100 1110011 1100101 100010 1111101 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはテキストに翻訳して取得します：</font></font><code> {"username":"user", "is_admin":"False"}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、真のデコードバックに変更して偽：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
01111011 00100010 01110101 01110011 01100101 01110010 01101110 01100001 01101101 01100101 00100010 00111010 00100010 01110101 01110011 01100101 01110010 00100010 00101100 00100000 00100010 01101001 01110011 01011111 01100001 01100100 01101101 01101001 01101110 00100010 00111010 00100010 01010100 01110010 01110101 01100101 00100010 01111101</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«MDExMTEwMTEgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDExMDExMTAgMDExMDAwMDEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDAxMDAwMTAgMDAxMDExMDAgMDAxMDAwMDAgMDAxMDAwMTAgMDExMDEwMDEgMDExMTAwMTEgMDEwMTExMTEgMDExMDAwMDEgMDExMDAxMDAgMDExMDExMDEgMDExMDEwMDEgMDExMDExMTAgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDEwMTAxMDAgMDExMTAwMTAgMDExMTAxMDEgMDExMDAxMDEgMDAxMDAwMTAgMDExMTExMDE =» </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変更し、新しいユーザープロファイルに行くにCookieの値。</font></font><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ：フラグ{d0_y0u_l1k3_c00k13s}</font></font></b></i> <br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク3-ファイルの読み取り</font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、ソースのリークと奇妙な作業ロジックが発生します。考えられる攻撃ベクトルは、通常、ファジングによって見つかります。これを行うことをお勧めします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リンク：</font></font><code>http://193.41.142.9:8001/shop/login</code></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
dirbを実行し（common.txtで十分です）、ページ</font></font><code>/shop/_source/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">とを</font><font style="vertical-align: inherit;">見つけます</font></font><code> /shop/files/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ソースに精通して</font></font><code>_source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いるため、パストラバーサルの脆弱性といくつかの単純なフィルターがあることがわかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグを取得するに</font></font><code>/shop/files/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、「file」パラメータを使用して</font><font style="vertical-align: inherit;">POSTリクエストを行う</font><font style="vertical-align: inherit;">必要があります</font></font><code> %2E%2E/%2E%2E/flag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このパラメータの値はでなければなりません</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リクエストに応じて、フラグが表示されます。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ：フラグ{y0u_g0t_0ur_s3cr3t}</font></font></b></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向2：Linuxのセキュリティと安全な開発</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク1-VCS</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
50 </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、お客様は何か特別なものを提供してくれましたか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーカイブには、サイトの一部のソースコードが含まれています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトへのリンク：</font></font><code>http://193.41.142.9:8002/</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：task.7z </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ソースコードにアクセスできます。結局のところ、開発者たちはgitリポジトリにも入れました。 gitログを見て、修正を加えたコミットを確認します。 git show &lt;hash commit&gt;を使用して、変更されたファイルとその内容を確認します。フラグは行の1つに格納されています。</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ{22717297f6a3603608d260c9e5f69e0a}</font></font></b></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク2-アルゴ</font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは新たな挑戦をしています。安全な開発チェックを実行します。顧客は、開発中のサイトのオープン部分をアーカイブに提供しました。彼のハッシュアルゴリズムをテストするために、彼はハッシュを提供しました：666c61677b32646733326473323334327d。逆変換の可能性についてアルゴリズムを確認してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーカイブには、サイトの一部のソースコードが含まれています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトへのリンク：</font></font><code>http://193.41.142.9:8002/</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：task.7z </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ソースコードにはパスワードハッシュアルゴリズムがあります。実際、これはハッシュアルゴリズムではなく、データを文字列形式から16進数に変換するだけです。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonを使用します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> binascii                                                          binascii.unhexlify(<span class="hljs-string">"666c61677b32646733326473323334327d"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグを</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取得し</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><i><b><font style="vertical-align: inherit;">フラグ{2dg32ds2342}</font></b></i></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク3-ファイルファイルファイル</font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">150 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
監査を終了しましょう。</font><font style="vertical-align: inherit;">この脆弱性も見られますか？</font><font style="vertical-align: inherit;">いいよ </font><font style="vertical-align: inherit;">したがって、秘密のファイルを取得するのは簡単です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーカイブには、サイトの一部のソースコードが含まれています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトへのリンク：</font></font><code>http://193.41.142.9:8002/</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：task.7z </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
プログラムのメインモジュールのソースコードで、ファイルのリーダーに気づくことができます（これはこのサービスのメインアプリケーションです）。</font><font style="vertical-align: inherit;">ファイルの存在をチェックする機能は、特殊文字をチェックすることはせず、2行を連結するだけです=&gt;パストラバーサルの脆弱性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、Dockerfileのdocker-compose.ymlでは、ファイルマッピングとコンテナーへのロードの構造を確認できます。</font><font style="vertical-align: inherit;">この知識を使用して、ペイロードを生成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">http://193.41.142.9:8002/files?password=qgzc6!78zxcbkj123fdgd234&amp;filename=../../../../../../src/secret_files/flag.txt</code></pre><br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ{a0a7c3fff21f2aea3cfa1d0316dd816c}</font></font><br>
</b></i><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向3：「リバースエンジニアリング」</font></font></h3><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク1-Snake </font></font></b><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当社は常に保護プログラムを回避しようとしています。</font><font style="vertical-align: inherit;">今回はPythonに対処してください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：task.pyc </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
uncompyle6モジュールによって逆コンパイルされたPythonバイトコードを使用します：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
uncompyle6 task.pyc。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
逆コンパイルして、フラグを取得します</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。flag {w3l1_pyth0n}</font></font><br>
</b></i><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク2-Robot </font></font></b><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">150 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今回は、奇妙なアプリケーションに遭遇しました。ログイン用のパスワードを見つけるのを手伝ってください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：app.apk </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソリューション：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションはAndroid上にあるので、BytecodeViewerなどの静的アナライザーにロードして、復元されたプログラムのソースコードを確認します。これはKotilnであり、この場合のように関数型プログラミングを使用することが多いことに注意してください。逆コンパイルされた匿名関数の1つで、フラグチェック、つまりチェック自体が見つかります。</font></font><br>
<br>
<pre><code class="kotlin hljs">(String)paramFunction1.invoke(<span class="hljs-built_in">Boolean</span>.valueOf(Arrays.equals(paramString, h)));<font></font>
 invoke:<font></font>
((StringBuilder)localObject).append(<span class="hljs-string">"flag{"</span>);<font></font>
      ((StringBuilder)localObject).append(<span class="hljs-keyword">this</span>.$m);<font></font>
      ((StringBuilder)localObject).append(<span class="hljs-string">'}'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数h：{102、97、50、98、102、54、52、54、101、52、57、97、98、53、101、53、54、102、50、98、55、52、52、 56、48、98、97、54、49、48、49、55}。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コード化された印刷文字のように見えます。 Pythonを使用します：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
`` .join（chr（x）for x in [102、97、50、98、102、54、52、54、101、52、57、97、98、53、101、53、54、</font><i><b><font style="vertical-align: inherit;">102、50、98、55、52、52、56、48、98、97、54、49、48、49、55</font></b></i><font style="vertical-align: inherit;"> ]）</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグを</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取得し</font></font><br>
</b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます：</font><i><b><font style="vertical-align: inherit;">フラグ{fa2bf646e49ab5e56f2b74480ba61017}</font></b></i></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク3-Bin </font></font></b><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今回はバイナリファイルを取得しました。タスクは同じで、秘密のパスワードを取得します。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
添付ファイル：タスク</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決策：</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
バイナリファイルが指定されました。逆アセンブラにロードし、C ++で記述された6つの検証関数を確認します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらは同じように実行され、互いに呼び出されて、5つの要素の断片のフラグをチェックします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
逆アセンブラからの情報を使用して、段階的に復元します。</font><font style="vertical-align: inherit;">フラグは部分的に取得されます：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0）長さを確認します</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1）フラグ{ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）feefa </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）_172a </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4）k14sc </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5）_eee} </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フラグを組み合わせて取得します：</font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグ{feefa_172ak14sc_eee}</font></font></b></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以上です、同僚の</font><i><b><font style="vertical-align: inherit;">皆さん</font></b></i><font style="vertical-align: inherit;">！</font><font style="vertical-align: inherit;">参加してくれてありがとう、自分、大切な人、そしてあなたのデータを大切に！</font><font style="vertical-align: inherit;">明けましておめでとうございます！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482526/index.html">ドナルド・クヌースによるジュビリー講演「クリスマスツリーで」</a></li>
<li><a href="../ja482530/index.html">専用：2019年に廃止されたテクノロジー</a></li>
<li><a href="../ja482532/index.html">スプリントパルス：大規模なチーム内で効果的な作業を構築する</a></li>
<li><a href="../ja482534/index.html">もう一度、建築の複雑さと参入の限界について</a></li>
<li><a href="../ja482536/index.html">初心者のためのピクセルアート：使用方法</a></li>
<li><a href="../ja482540/index.html">ソフトウェアVSハードウェア：トレンドは何で、将来は誰ですか？</a></li>
<li><a href="../ja482544/index.html">スタートアップチームに「0」を設定する-最小規模の段階的な手順</a></li>
<li><a href="../ja482546/index.html">VK Tech：Git開発年</a></li>
<li><a href="../ja482548/index.html">Security Week 52 + 1：非標準の今年のトップ3ニュース</a></li>
<li><a href="../ja482550/index.html">神秘的なLyXプログラム。パート2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>