<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíáüèø üíé üåà Como Sports.ru escreveu seu editor WYSIWYG üî¥ ‚úùÔ∏è üì¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em meados de 2018, o Sports.ru pensou em mudar para um novo editor de texto WYSIWYG para postagens de usu√°rios. Desde junho de 2019, o editor est√° no ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como Sports.ru escreveu seu editor WYSIWYG</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sports_ru/blog/492228/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em meados de 2018, o Sports.ru pensou em mudar para um novo </font></font><abbr title="O que voc√™ v√™ √© o que voc√™ recebe"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editor de</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> texto </font><abbr title="What You See Is What You Get"><font style="vertical-align: inherit;">WYSIWYG</font></abbr><font style="vertical-align: inherit;"> para postagens de usu√°rios. </font><font style="vertical-align: inherit;">Desde junho de 2019, o editor est√° no modo beta. </font><font style="vertical-align: inherit;">Durante esse per√≠odo, resolvemos muitos problemas associados ao design da arquitetura de todo o servi√ßo e √† implementa√ß√£o do pr√≥prio editor no navegador baseado na biblioteca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProseMirror</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e decidimos compartilhar nossa experi√™ncia.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wc/2p/ag/wc2pagubhgtlo-bvev4wjyfmrsk.png"><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√çndice</font></font></h1><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Introdu√ß√£o </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">Por que voc√™ precisou do WYSIWYG </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">Descri√ß√£o da tarefa que os desenvolvedores enfrentaram </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Como escolher a ferramenta </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. O que aconteceu </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1. </font><font style="vertical-align: inherit;">Arquitetura de servi√ßo </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2. </font><font style="vertical-align: inherit;">Quais s√£o os desafios </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Resultados dos testes beta</font></font></a><br>
<br>
<a name="Intro"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Introdu√ß√£o</font></font></h2><br>
<a name="Why"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1 </font><font style="vertical-align: inherit;">Por que voc√™ precisava do WYSIWYG</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sports.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© uma m√≠dia sobre esportes com uma audi√™ncia de 20 milh√µes de usu√°rios por m√™s. Nossas principais diferen√ßas em rela√ß√£o √† m√≠dia cl√°ssica s√£o a comunidade e o </font></font><abbr title="Conte√∫do gerado por usu√°rios"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UGC</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . O conte√∫do do usu√°rio - classifica√ß√µes, coment√°rios, chats, postagens - n√£o apenas complementa o valor editorial, mas tamb√©m cria uma plataforma para que os usu√°rios interajam. Todo m√™s, nossos usu√°rios escrevem quase 10 mil posts. Os melhores s√£o enviados para a p√°gina principal do site, juntamente com os editoriais, enviados para aplicativos m√≥veis, redes sociais. O conte√∫do do usu√°rio √© respons√°vel por cerca de 40% de todas as leituras nas p√°ginas do Sports.ru. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Queremos ser a plataforma mais conveniente para autores de esportes, para ajudar a criar conte√∫do e entreg√°-lo a um p√∫blico interessado. 10 anos usamos o editor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TinyMCE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- e, no final, ficou desatualizado, deixou de atender tanto √† equipe quanto aos usu√°rios que estavam acostumados aos editores modernos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ff/ub/ig/ffubigpbednsp8phz7btg-icbm8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">1. A interface do antigo editor baseado no TinyMCE</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dos autores dos blogs recebidos regularmente sobre as seguintes reclama√ß√µes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escrevi por um longo tempo, fechei acidentalmente a guia e tudo se foi;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escrever textos longos √© muito inconveniente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â irritante que, para inserir cada imagem, voc√™ deve primeiro envi√°-la para a hospedagem de imagens.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A equipe tamb√©m teve suas pr√≥prias reclama√ß√µes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no TinyMCE, voc√™ n√£o pode fazer upload de imagens diretamente de um arquivo, voc√™ s√≥ pode anexar links a imagens e, devido ao fato de os usu√°rios n√£o conseguirem fazer upload de imagens em nosso armazenamento, se os links morrerem, n√£o poder√≠amos fazer nada a respeito;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as possibilidades de editar e formatar o texto n√£o s√£o balanceadas. </font><font style="vertical-align: inherit;">Por um lado, n√£o havia estilos suficientes, por exemplo, para cabe√ßalhos internos no texto. </font><font style="vertical-align: inherit;">Por outro lado, foi poss√≠vel usar as ferramentas dispon√≠veis em qualquer combina√ß√£o. </font><font style="vertical-align: inherit;">Como resultado, as postagens n√£o pareciam uniformes (no Sports.ru, come√ßaram os trabalhos de implementa√ß√£o do sistema de design e as postagens dos usu√°rios devem estar de acordo com ele);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o conte√∫do √© criado e armazenado em HTML, por isso √© dif√≠cil gerenciar estilos em postagens em diferentes clientes e apenas fazer altera√ß√µes no layout das postagens.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, √© apresentada uma hist√≥ria sobre como resolvemos o problema de criar um novo editor no front-end. </font><font style="vertical-align: inherit;">√â verdade que tamb√©m haver√° algo sobre o produto, o design e as partes de back-end, porque sem isso ser√° dif√≠cil entender por que uma decis√£o espec√≠fica foi tomada no front-end.</font></font><br>
<br>
<a name="Task"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2 </font><font style="vertical-align: inherit;">Descri√ß√£o da tarefa enfrentada pelos desenvolvedores</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em resumo, a tese da qual nos baseamos inicialmente: blogar no Sports.ru √© uma dor. </font><font style="vertical-align: inherit;">Em princ√≠pio, seria poss√≠vel n√£o criar um novo editor, mas simplesmente adicionar salvamento autom√°tico e a capacidade de fazer upload de fotos para seu pr√≥prio armazenamento - e a maioria das reclama√ß√µes de usu√°rios e funcion√°rios desapareceria. </font><font style="vertical-align: inherit;">Mas eu ainda queria n√£o oferecer suporte √† ferramenta em tecnologias antigas, mas criar um novo editor moderno que possamos facilmente desenvolver e dimensionar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m da interface inconveniente, um dos principais problemas t√©cnicos do editor antigo era que o conte√∫do da postagem era salvo imediatamente como uma string HTML, e as altera√ß√µes na apar√™ncia da publica√ß√£o exigiam a interven√ß√£o de desenvolvedores de back-end ou eram implementadas em tempo de execu√ß√£o no cliente (por exemplo, a coloca√ß√£o de blocos de an√∫ncios no corpo do post). Nossa tarefa, entre outras coisas, era separar os dados de sua apresenta√ß√£o e, consequentemente, deixar o layout e a interface no c√≥digo do cliente e trabalhar com os dados no c√≥digo do servidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como modelo, adotamos o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √†s vezes espionando id√©ias do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Doc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Al√©m de resolver os problemas j√° identificados, decidimos adicionar v√°rios novos recursos que tornariam o uso do editor mais confort√°vel:</font></font><br>
<br>
<ul>
<li>  WYSIWYG, .. what you see is what you get (. ¬´ ,   ¬ª,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>),           ,     .     ,      ;</li>
<li>  (      ,       ,      ,   ,    ; ,           )     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, o pr√≥prio editor n√£o deveria estar vinculado aos recursos do Sports.ru, porque o Sports.ru, embora o projeto principal em nossa empresa, ainda n√£o seja o √∫nico. A empresa tamb√©m est√° desenvolvendo a m√≠dia esportiva internacional </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tribuna</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , uma rede social para entusiastas de apostas Betting </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insider</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e lan√ßou recentemente seu pr√≥prio est√∫dio de produ√ß√£o envolvido em projetos de publicidade. Desenvolver um editor on-line √© caro o suficiente para n√£o querer reutilizar esse c√≥digo em outro site com diferentes tipos de letra e estilos, com seu pr√≥prio conjunto de ferramentas para edi√ß√£o e formata√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos muito conte√∫do de texto e, antes de come√ßar a trabalhar na cria√ß√£o de um novo editor de postagem, pensamos em como esse conte√∫do deveria ser armazenado. O TinyMCE n√£o nos deu uma escolha e o conte√∫do teve que ser armazenado apenas em HTML, que, como mencionado acima, n√£o se adequava √† equipe. Como resultado, criamos nosso pr√≥prio formato para armazenar dados de texto que atendem aos nossos requisitos e chamamos de corpo estruturado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Corpo estruturado √© uma matriz de objetos que reflete a estrutura do conte√∫do. Nesse caso, o conte√∫do √© dividido em elementos que s√£o blocos independentes, por exemplo, par√°grafo, lista, imagem. Um elemento armazena informa√ß√µes sobre que tipo e quais propriedades ele possui. Por exemplo, o bloco de legendas descreve o t√≠tulo no texto, deve conter os campos de texto e n√≠vel. Assim, o texto cont√©m o texto deste cabe√ßalho e o n√≠vel cont√©m o n√≠vel (de 1 a 4). Um corpo estruturado, consistindo em um cabe√ßalho de segundo n√≠vel, pode ter, por exemplo, o seguinte:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> structuredBody = [<font></font>
    {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">type</span>: <span class="hljs-string">'subtitle'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="hljs-attr">value</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    <span class="hljs-attr">text</span>: <span class="hljs-string">'    '</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <span class="hljs-attr">level</span>: <span class="hljs-number">2</span>,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  },<font></font>
    },<font></font>
];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A transi√ß√£o para o corpo estruturado nos permitiu iniciar o processo de separa√ß√£o da l√≥gica de neg√≥cios, dados e sua apresenta√ß√£o. Por fim, queremos que o servidor e os clientes troquem apenas dados. E como e por que exibir esses dados para o usu√°rio final, cada cliente determinar√° independentemente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conte√∫do no formato formatd body √© armazenado em JSON e, para validar seu conte√∫do, criamos um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esquema JSON</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado esquema de corpo estruturado. Este diagrama descreve todos os elementos v√°lidos e suas propriedades. Assim, podemos ter certeza de que sempre que um corpo estruturado for necess√°rio, um conjunto de chaves e valores ser√° usado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, ele permite que equipes diferentes usem os mesmos servi√ßos para processar o conte√∫do nesse formato. Por exemplo, um servi√ßo para gerar HTML a partir de um corpo estruturado para exibir conte√∫do ou um editor para criar conte√∫do. Isso reduz significativamente o custo de desenvolvimento e suporte de todo o n√∫cleo de servi√ßos relacionados √† cria√ß√£o e exibi√ß√£o de conte√∫do.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supunha-se que o novo editor deveria aceitar conte√∫do de entrada e sa√≠da exclusivamente no formato de corpo estruturado. E aqui era necess√°rio levar em conta o ponto sutil: como anteriormente as postagens foram salvas imediatamente em HTML, essa string HTML do banco de dados foi transmitida ao cliente para exibi√ß√£o (a seguir, por cliente, queremos dizer apenas o navegador, a menos que especificado de outra forma). Agora queremos armazenar o conte√∫do de todas as postagens no corpo estruturado, mas os clientes podem processar apenas HTML. Portanto, juntamente com a tarefa de mudar para um novo editor, a tarefa de implementar uma nova maneira de os clientes exibirem postagens para leitura diretamente do corpo estruturado est√° acontecendo simultaneamente. Decidimos que √© melhor comer um elefante aos poucos, ent√£o primeiro voc√™ precisa abandonar completamente o TinyMCE e s√≥ ent√£o assumir a l√≥gica de exibir postagens para leitura. Al√©m disso,nem todas as postagens antigas conseguiram traduzir o conte√∫do para um novo formato, o que significa que essas postagens sempre ser√£o armazenadas apenas em HTML e √© necess√°rio que elas tamb√©m mantenham a capacidade de ler.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total: parte das postagens (todas as novas e antigas que foram transferidas com sucesso para o novo formato) ser√£o armazenadas em dois formatos - HTML e corpo estruturado - at√© que a nova l√≥gica de exibi√ß√£o da leitura seja implementada e o restante (a maioria das antigas e muito muito antigas) posts) permanecer√° apenas em HTML.</font></font><br>
<br>
<a name="How"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Como escolher uma ferramenta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tivemos que perceber a capacidade de editar e criar uma postagem no cliente, levando em considera√ß√£o os recursos e limita√ß√µes acima. Como sempre, voc√™ pode escolher uma solu√ß√£o pronta ou criar a sua pr√≥pria. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, examinamos o que s√£o as bibliotecas prontas para a cria√ß√£o de editores WYSIWYG e se elas s√£o adequadas para n√≥s. Optamos por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slate</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Draft.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ProseMirror</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m de armazenar conte√∫do em uma estrutura de dados, o momento cr√≠tico para n√≥s tamb√©m foi a capacidade de trabalhar com o Vue ou JS puro, porque j√° come√ßamos a mover o site para uma nova pilha tecnol√≥gica usando o Vue + Vuex. Al√©m disso, eu gostaria de expandir os recursos da biblioteca conclu√≠da com a ajuda de novos m√≥dulos (de terceiros ou auto-gravados), se necess√°rio.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aba. </font><font style="vertical-align: inherit;">1. Compara√ß√£o das bibliotecas revisadas pelos par√¢metros mais importantes do Sports.ru</font></font></i><br>
<img src="https://habrastorage.org/webt/fw/hf/xa/fwhfxa6ozwkyfdpdj8t6j5lcbuy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como voc√™ pode ver na tabela, o ProseMirror atendeu totalmente aos nossos requisitos, por isso n√£o consideramos mais a id√©ia de escrever nossa pr√≥pria biblioteca para editar o conte√∫do do texto, mas come√ßamos a estud√°-la com mais detalhes. </font><font style="vertical-align: inherit;">Ainda existe um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quill</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bastante popular </font><font style="vertical-align: inherit;">, que n√£o entrou em nossa compara√ß√£o apenas porque honestamente o esquecemos na fase de sele√ß√£o de uma ferramenta. </font><font style="vertical-align: inherit;">De acordo com nossos principais requisitos, ele tamb√©m passa, mas aconteceu. </font><font style="vertical-align: inherit;">J√° falamos sobre o que √© o ProseMirror e como trabalhar com ele em outro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="What"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. O que aconteceu</font></font></h2><br>
<a name="Architecture"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 </font><font style="vertical-align: inherit;">Arquitetura de Servi√ßo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥prio editor de conte√∫do no cliente est√° longe de tudo. </font><font style="vertical-align: inherit;">Voc√™ precisa colocar o editor em um projeto existente, exibi-lo em algum lugar da p√°gina da web e tamb√©m considerar a intera√ß√£o com o back-end, resolver o problema de oferecer suporte simult√¢neo a dois editores (n√£o era poss√≠vel abandonar imediatamente o antigo) e armazenar o conte√∫do em dois formatos (HTML e estruturado). corpo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas essas tarefas podem ser divididas nas relacionadas ao frontend, backend e sua integra√ß√£o. </font><font style="vertical-align: inherit;">Estamos preocupados principalmente com problemas de front-end e integra√ß√£o, embora tamb√©m mencionemos alguns aspectos importantes das tarefas de back-end. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os servi√ßos de front-end para o editor podem ser divididos em v√°rios n√≠veis:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina da web para criar e editar uma postagem;</font></font></li>
<li>Vue-app,    .  ,  ,   Vue,         -, , , ,       ..,    ,         ,      ;</li>
<li>WYSIWYG-   ProseMirror,      Vue.      ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>;</li>
<li>SB2HTML ‚Äì    HTML  structured body,    .    , structured body ‚Äì       ,    .      ,   ,     ,      .    Sports.ru     HTML  structured body,  -     HTML  .       HTML    Node.Js,        JS-   .<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O processo de salvar a postagem √© mostrado na Fig. </font><font style="vertical-align: inherit;">2. O conte√∫do da postagem no formato do corpo estruturado e seus metadados s√£o transferidos para o back-end. </font><font style="vertical-align: inherit;">O back-end envia conte√∫do para o servi√ßo SB2HTML, recebe HTML pronto na resposta, coloca tudo isso no banco de dados e informa ao cliente que a postagem foi salva com sucesso ou relata um erro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/fp/j8/offpj883_eq2swjl-ogb6jxprks.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">2. Esquema para salvar uma postagem ao criar ou editar em um editor WYSIWYG</font></font></i><br>
<br>
<a name="Difficulties"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 </font><font style="vertical-align: inherit;">Que dificuldades voc√™ enfrentou?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Houve muitas dificuldades, surgiram constantemente e frequentemente nos momentos mais inesperados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como j√° dissemos, o editor de conte√∫do est√° localizado dentro do formul√°rio, o que permite inserir dados adicionais necess√°rios para criar uma postagem, como t√≠tulo, anota√ß√£o etc. Para anota√ß√£o, deve ser poss√≠vel baixar imagens de um arquivo e atrav√©s de um link da Internet. Mas para o conte√∫do tamb√©m queremos carregar imagens de um arquivo e por refer√™ncia, al√©m disso, de acordo com as mesmas regras. E aqui estamos diante de um dilema: por um lado, o conte√∫do da postagem √© editado a partir do formul√°rio externo e editado usando as ferramentas ProseMirror, mas, por outro lado, quero observar o princ√≠pio </font></font><abbr title="N√£o se repita"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DRY</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e n√£o duplique o mesmo c√≥digo. Resolvemos isso da seguinte maneira: descrevemos o carregamento de imagens como um conjunto de m√©todos em um objeto no n√≠vel do formul√°rio Vue e passamos esse objeto como um dos par√¢metros para o construtor do editor WYSIWYG.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As entidades que descrevem o conte√∫do - N√≥ e Fragmento - s√£o definidas no modelo ProseMirror. No entanto, apenas √≠ndices s√£o usados ‚Äã‚Äãpara uma transa√ß√£o para determinar o intervalo de caracteres aos quais essa transa√ß√£o √© aplicada (os √≠ndices s√£o contados desde o in√≠cio do documento e desde o in√≠cio do n√≥ pai). A indexa√ß√£o de caracteres √© um dos conceitos centrais do ProseMirror, mas ao editar e formatar o texto, √© muito mais conveniente pensar em entidades do modelo ProseMirror. Como resultado, para um trabalho confort√°vel com o conte√∫do, escrevemos nossos auxiliares para simplificar a intera√ß√£o com um documento para transa√ß√µes. Ap√≥s o in√≠cio do nosso trabalho, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apareceu a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> biblioteca de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">dicas</font></a><font style="vertical-align: inherit;"> , que √© um conjunto de ajudantes semelhantes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥ximo problema foi que, na fase de cria√ß√£o do esquema, percebemos que j√° possu√≠mos um formato interno aprovado para armazenar conte√∫do - um corpo estruturado que atende √†s nossas necessidades, e o ProseMirror armazena o conte√∫do em seu pr√≥prio formato em uma hist√≥ria. Mudar para o formato ProseMirror foi dif√≠cil e impratic√°vel. Nos encontramos em uma situa√ß√£o em que dados em um formato chegam ao cliente por meio da API e outro precisa ser exibido. Uma situa√ß√£o semelhante surge quando √© necess√°rio salvar o conte√∫do modificado ou criado. Para isso, implementamos um conversor que converte formatos para frente e para tr√°s. Eles escreveram um teste simples para ele, que pega o conte√∫do de uma postagem no formato de corpo estruturado, converte-o no formato ProseMirror, depois volta e j√° compara a vers√£o original com a recebida. Acabou de forma r√°pida e f√°cil.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais tarde, √† medida que o esquema de documentos mudou e, em regra, se tornou mais complicado, ficou claro que a menor altera√ß√£o poderia levar a erros no editor, e esse teste parece dar uma cobertura muito ruim. Como resultado, tive que escrever testes em quase todas as combina√ß√µes de n√≥s e marcas em dois pequenos m√©todos de convers√£o. Agora, sem esses testes, √© imposs√≠vel determinar se a pr√≥xima mudan√ßa no circuito quebrar√° algo ou n√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O pr√≥ximo problema est√° novamente relacionado √† necessidade de compatibilidade com vers√µes anteriores de novas e antigas tecnologias. Nosso editor WYSIWYG √© implementado apenas em navegadores (desktop e, em breve, mobile). Assim, para editar o conte√∫do no cliente √© fornecido em JSON no formato corpo estruturado, no entanto, a leitura de postagens em navegadores √© realizada apenas a partir de HTML. Ao mesmo tempo, a maioria dos aplicativos m√≥veis j√° mudou para a exibi√ß√£o de postagens de usu√°rios diretamente do corpo estruturado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aplicativos m√≥veis, era necess√°rio prever o caso em que o cliente n√£o pode processar algum elemento do corpo estruturado. Por exemplo, se um novo elemento for adicionado ao corpo estruturado, cuja exibi√ß√£o ser√° implementada apenas em uma vers√£o mais recente do aplicativo. Como nem todos os usu√°rios atualizam seus aplicativos ao mesmo tempo, era necess√°rio fornecer um plano ‚ÄúB‚Äù para vers√µes mais antigas: em vez de criar HTML a partir do corpo estruturado, insira um fragmento HTML pronto para o elemento desejado. A presen√ßa de fragmentos HTML para cada elemento n√£o foi fornecida no esquema do corpo estruturado, porque a pr√≥pria id√©ia dessa estrutura era recusar-se a armazenar dados em HTML. Mas, no final, chegamos √† conclus√£o de que precisamos de dois esquemas de corpos estruturados - um para exibi√ß√£o e outro para edi√ß√£o. As diferen√ßas entre os esquemas s√£oque o corpo estruturado para edi√ß√£o cont√©m apenas o conte√∫do do artigo e, para exibi√ß√£o, adicionamos alguns elementos adicionais. Em particular, um fragmento HTML para cada elemento √© criado quando uma postagem √© salva no servi√ßo SB2HTML e √© adicionada apenas ao corpo estruturado para exibir a postagem. Al√©m disso, o corpo estruturado tamb√©m exibe espa√ßo publicit√°rio no conte√∫do para exibi√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando abrimos o conte√∫do para edi√ß√£o em um navegador, basicamente n√£o conseguimos encontrar um elemento desconhecido, porque todas as postagens s√£o criadas e exibidas da mesma maneira. Mas eles decidiram prever esse caso tamb√©m para o futuro. Para fazer isso, adicionamos um elemento stub padr√£o ao esquema ProseMirror. Nomeamos esse elemento como n√£o suportadoBlock. O esbo√ßo aparece no lugar de um item n√£o suportado. N√≥s o estilizamos como um ret√¢ngulo cinza com texto informando que este elemento n√£o √© suportado e n√£o pode ser editado. Quando uma postagem √© salva, esse elemento permanece inalterado no corpo estruturado. O usu√°rio pode alterar sua localiza√ß√£o em rela√ß√£o a outros elementos, mas o conte√∫do interno de um elemento desconhecido n√£o pode ser alterado ou editado. No entanto, o usu√°rio pode excluir esse elemento e, √© claro,n√£o ser√° salvo no documento final.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os problemas descritos estavam relacionados √†s dificuldades de implementar o pr√≥prio editor WYSIWYG. Por√©m, embora existisse no modo beta, n√£o pudemos abandonar o editor antigo no TinyMCE e fomos for√ßados a oferecer suporte a ambos os editores, fornecendo compatibilidade com vers√µes anteriores. Por exemplo, voc√™ pode criar uma postagem no editor WYSIWYG, salvar e edit√°-la no TinyMCE, salvar, abri-la novamente no WYSIWYG e assim por diante. Como resultado, ao abrir no WYSIWYG, vimos o mesmo conte√∫do do salvamento anterior no TinyMCE. Para implementar a compatibilidade com vers√µes anteriores, era necess√°rio enviar o conte√∫do HTML para o TinyMCE, que j√° aprendemos a criar a partir do corpo estruturado e salvar no banco de dados enquanto salvava a postagem. E ao salvar uma postagem atrav√©s do TinyMCE, o conte√∫do criado no servidor √© executado atrav√©s do servi√ßo HTML2SB,Como resultado, podemos salvar HTML fresco e corpo estruturado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML2SB √© o oposto do que SB2HTML faz, ou seja, converte conte√∫do de HTML em corpo estruturado. </font><font style="vertical-align: inherit;">Cronologicamente, esse servi√ßo apareceu mais cedo do que qualquer outra coisa, porque antes da cria√ß√£o do editor WYSIWYG, a √∫nica maneira de obter conte√∫do da postagem no formato de corpo estruturado era a an√°lise direta do HTML. </font><font style="vertical-align: inherit;">O HTML2SB fazia parte da infraestrutura de back-end em torno do editor de postagem, mas depois de abandonar o TinyMCE, ele n√£o era mais necess√°rio.</font></font><br>
<br>
<a name="Results"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Resultados beta</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, o editor WYSIWYG est√° dispon√≠vel para todos os usu√°rios na vers√£o beta e em breve se tornar√° o principal editor de postagens do Sports.ru. </font><font style="vertical-align: inherit;">J√° recebemos uma ferramenta para criar e editar postagens que atendem √† maioria dos nossos requisitos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a interface do editor tornou-se clara, concisa e moderna, escrever posts longos ficou muito mais f√°cil;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora voc√™ pode baixar imagens de um arquivo e por um link que √© imediatamente colocado em nosso armazenamento;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adicionou a op√ß√£o de incorporar incorpora√ß√µes das principais redes sociais e sites de hospedagem de v√≠deo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estilos de formata√ß√£o de texto limpos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os aplicativos para dispositivos m√≥veis j√° mudaram para exibir postagens do corpo estruturado e podem definir seus pr√≥prios estilos de conte√∫do.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, o editor ainda n√£o est√° totalmente depurado, periodicamente detectamos novos bugs. </font><font style="vertical-align: inherit;">As seguintes atualiza√ß√µes est√£o chegando:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salvamento autom√°tico;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o WYSIWYG para usu√°rios com direitos estendidos (administradores, editores em tempo integral);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criar e editar postagens de navegadores m√≥veis;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensagens sobre edi√ß√£o paralela de um documento por v√°rios usu√°rios;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dicas e integra√ß√£o;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">widgets estat√≠sticos para equipes esportivas, partidas e escala√ß√µes.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No momento da reda√ß√£o deste artigo, mais de 13.000 postagens j√° foram publicadas na vers√£o beta do editor, que representa cerca de 20% do n√∫mero total de textos de usu√°rios no Sports.ru no per√≠odo de junho de 2019 a fevereiro de 2020, inclusive. O compartilhamento de postagens criadas e publicadas por meio do novo editor est√° crescendo constantemente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ad/2i/4b/ad2i4b4dubgv9--l-vl7ghh6cnw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. 3. A propor√ß√£o de postagens de usu√°rios criadas e publicadas no novo editor</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que o crescimento org√¢nico na participa√ß√£o de posts de usu√°rios criados e publicados por meio do novo editor √© um sinal de satisfa√ß√£o dos usu√°rios com a atualiza√ß√£o, o que tamb√©m √© confirmado pelo feedback no an√∫ncio de seu lan√ßamento em testes beta (alguns deles s√£o mostrados na Figura 4). </font><font style="vertical-align: inherit;">Portanto, nos pr√≥ximos meses, planejamos transferir completamente a cria√ß√£o de postagens para o novo editor, de modo a focar apenas em seu suporte e desenvolvimento.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, que funcionalidade voc√™ adicionaria ao nosso editor WYSIWYG? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k-/bm/nz/k-bmnzzgoh5wi-nvq516-pca8uk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">4. Coment√°rios do usu√°rio em um post com o an√∫ncio da atualiza√ß√£o do editor WYSIWYG&nbsp;</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492216/index.html">Salvando valores em um aplicativo .Net no Build</a></li>
<li><a href="../pt492218/index.html">Regras de design de √≠cone para lembrar</a></li>
<li><a href="../pt492220/index.html">5 segredos pouco conhecidos dos pandas</a></li>
<li><a href="../pt492222/index.html">Artigo: CTFZone Quals 2019: Chicken</a></li>
<li><a href="../pt492226/index.html">Compara√ß√£o de pre√ßos em Kubernetes gerenciados (2020)</a></li>
<li><a href="../pt492232/index.html">Como as Smartcalls se tornaram o Voximplant Kit - recursos de rebranding e killer</a></li>
<li><a href="../pt492234/index.html">Pesquisa: por que as pessoas est√£o prontas para receber menos em projetos sociais</a></li>
<li><a href="../pt492242/index.html">M5Stack e seus contatos</a></li>
<li><a href="../pt492244/index.html">Remo√ß√£o durante o per√≠odo de coronav√≠rus: "pris√£o" domiciliar ou tempo de oportunidade?</a></li>
<li><a href="../pt492246/index.html">Coronav√≠rus: poss√≠veis implica√ß√µes para a sociedade, economia e medicina</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>