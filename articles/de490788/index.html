<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüíª üë®üèæ‚Äç‚öñÔ∏è üßî Nutzlose REPL. Yandex-Bericht ü§ú üë®üèæ‚ÄçüöÄ üç¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="REPL (read-eval-print loop) ist in Python nutzlos, selbst wenn es sich um magisches IPython handelt. Heute werde ich eine der m√∂glichen L√∂sungen f√ºr d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nutzlose REPL. Yandex-Bericht</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/490788/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REPL (read-eval-print loop) ist in Python nutzlos, selbst wenn es sich um magisches IPython handelt. </font><font style="vertical-align: inherit;">Heute werde ich eine der m√∂glichen L√∂sungen f√ºr dieses Problem anbieten. </font><font style="vertical-align: inherit;">Zuallererst werden der Bericht und meine Erweiterung TheREPL f√ºr diejenigen n√ºtzlich sein, die an einer schnelleren und effizienteren Entwicklung interessiert sind, sowie f√ºr diejenigen, die Stateful-Systeme schreiben.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Mein Name ist Alexander, ich arbeite als Programmierer in Yandex. Wir schreiben in meinem Team in Python, wir haben noch nicht auf Go umgestellt. Aber in meiner Freizeit programmiere und mache ich es seltsamerweise auch in einer sehr dynamischen Sprache - Common Lisp. Es ist vielleicht noch dynamischer als Python. Ihre Besonderheit liegt darin, dass der Entwicklungsprozess selbst etwas anders angeordnet ist. Es ist interaktiver und iterativer, da Sie in REPL auf Lisp alles tun k√∂nnen: neue Module erstellen und alte l√∂schen, Methoden, Klassen hinzuf√ºgen und l√∂schen, Klassen neu definieren usw.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/0p/ld/xo/0pldxop8ymqyuvlwarowoynh_44.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Python ist dies umso schwieriger. Es hat IPython. Nat√ºrlich verbessert IPython REPL in gewisser Weise, f√ºgt die automatische Vervollst√§ndigung hinzu und erm√∂glicht die Verwendung verschiedener Erweiterungen. Aber f√ºr die iterative Entwicklung passt es nicht sehr gut. Darin k√∂nnen Sie den Code herunterladen, ein wenig testen und fertig. Und manchmal m√∂chte er mehr Interaktivit√§t, damit Sie diese REPL wirklich in der Entwicklung verwenden, zwischen Modulen wechseln, Funktionen und Klassen in ihnen √§ndern k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es passiert mir - Sie f√ºhren beispielsweise IPython REPL in der Produktionsumgebung aus und beginnen dort, einige Befehle auszuf√ºhren, etwas zu untersuchen, und dann stellt sich heraus, dass im Modul ein Fehler vorliegt, und Sie m√∂chten ihn schnell beheben. Dies funktioniert jedoch nicht, da Sie ein neues Docker-Image erstellen, es in die Produktion einbinden, erneut in diese REPL wechseln, dort erneut den gew√ºnschten Status erreichen und alles, was darauf fiel, erneut starten m√ºssen. Und im Idealfall m√ºsste ich die Funktion reparieren, sofort ausf√ºhren und sofort das Ergebnis erhalten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was kann man dagegen tun? </font><font style="vertical-align: inherit;">Wie kann ich Code in IPython neu laden? </font><font style="vertical-align: inherit;">Ich habe versucht, Autoreload zu verwenden, und es hat mir aus mehreren Gr√ºnden nicht gefallen. </font><font style="vertical-align: inherit;">Wenn das Modul neu gestartet wird, verliert es zun√§chst den Status, der sich in den globalen Variablen in diesem Modul befand. </font><font style="vertical-align: inherit;">Und es kann einen zwischengespeicherten Wert mit den Ergebnissen einiger Funktionen geben. </font><font style="vertical-align: inherit;">Oder ich k√∂nnte dort beispielsweise Daten √ºber das Netzwerk laden, um sp√§ter schneller damit arbeiten zu k√∂nnen. </font><font style="vertical-align: inherit;">Das hei√üt, das automatische Laden verliert den Status. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher habe ich als Experiment meine einfache Erweiterung f√ºr IPython erstellt und sie TheREPL genannt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich bin mit diesem Bericht zu Ihnen gekommen, um eine Vorstellung davon zu bekommen, was mit REPL in Python getan werden kann. </font><font style="vertical-align: inherit;">Und ich hoffe wirklich, dass Ihnen diese Idee gef√§llt, Sie sie in Ihrem Kopf umsetzen und weiterhin Dinge entwickeln, die Python noch effizienter und bequemer machen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist TheREPL? Dies ist die Erweiterung, die Sie herunterladen. Danach wird in IPython ein Konzept wie der Namespace angezeigt. Sie k√∂nnen zu jedem Python-Modul wechseln, um zu sehen, welche Variablen, Funktionen usw. vorhanden sind. Und was noch wichtiger ist: Sie k√∂nnen def, den Namen der Funktion, direkt schreiben, die Funktion oder Klasse neu definieren und sie √§ndert sich in allen Modulen, in die sie importiert wurde. Gleichzeitig wird das Modul selbst nicht neu gestartet, sodass der Status gespeichert wird. Dar√ºber hinaus k√∂nnen Sie mit TheREPL weitere Artefakte vermeiden, die sich beim automatischen Laden befinden und die wir uns jetzt ansehen werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h0/ob/lo/h0obloylvllg9wciqqyvg3yhqam.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim automatischen Laden erfolgt die Code-Aktualisierung nur, wenn die Datei gespeichert wird. Gleichzeitig m√ºssen Sie jedoch etwas in die REPL selbst eingeben, und erst dann √ºbernimmt das automatische Laden diese √Ñnderungen. Dies ist Problem Nummer 1. Das hei√üt, wenn Sie einen Hintergrundprozess in einem separaten Thread haben (z. B. wenn der Server ausgef√ºhrt wird), k√∂nnen Sie den Code nicht einfach √ºbernehmen und korrigieren. Beim Autoreload werden diese √Ñnderungen erst angewendet, wenn Sie etwas in die IPython-REPL eingeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei meiner Erweiterung dr√ºcken Sie die Verkn√ºpfung rechts im Editor, und die Funktion unter dem Cursor wird sofort angewendet und beginnt zu arbeiten. Das hei√üt, mit TheREPL k√∂nnen Sie den Code genauer √§ndern. Sie k√∂nnen def auch in IPython schreiben.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8c/gf/5h/8cgf5hocolkvqgirby2kq730eus.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Umschalten zwischen Modulen wird, wie gesagt, in keiner Weise unterst√ºtzt. Sie k√∂nnen die Datei nur im Dateisystem finden, √§ndern und hoffen, dass das automatische Laden alles dort aufl√∂st. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h-/4t/sr/h-4tsrp2ncyufazpguvh0qmjxum.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weiter. Autoreload verliert globale Variablen, TheREPL speichert und erm√∂glicht es Ihnen, den Betrieb Ihrer Anwendung weiter zu untersuchen, ihren internen Code zu √§ndern und sie so schnell zu entwickeln.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tb/md/o_/tbmdo_pag196om9zw0heb1rtvy4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autoreload verf√ºgt weiterhin √ºber diese Funktion. Er nimmt sehr geschickt √Ñnderungen an dem Modul vor, das neu geladen wird. Insbesondere macht er dort einen sehr interessanten Trick. Wenn die Funktion in diesem Modul aktualisiert wurde, verwendet er den Garbage Collector, um sie und alle diese Instanzen von Funktionen zu finden und den darin enthaltenen Code zu √§ndern, um sie √ºberall dort zu √§ndern, wo sie importiert wurde. Weiter werden wir uns Beispiele ansehen, wie dies geschieht. Aus diesem Grund √§ndert sich der Funktionscode, auch wenn er in den Verschluss gelangt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wissen Sie, was eine Schlie√üung ist? Dies ist eine sehr n√ºtzliche Sache. JavaScript-Entwickler verwenden dies st√§ndig. Sie haben h√∂chstwahrscheinlich auch einfach nie aufgepasst. Da das automatische Laden jedoch das tut, was ich oben beschrieben habe, befinden Sie sich m√∂glicherweise in einer Situation, in der der alte Code neuen Code verwendet, der m√∂glicherweise anders funktioniert. Beispielsweise kann eine Funktion nicht einen Wert zur√ºckgeben, sondern zwei, Tupel anstelle von Zeichenfolge usw. Der alte Code wird dabei unterbrochen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL macht keine so kniffligen Dinge, um sicherzustellen, dass alles konsistenter ist. Das hei√üt, es √§ndert die Funktion oder Klasse in dem Modul, in dem es definiert ist. Findet diese Klasse in allen anderen Modulen und √§ndert sie auch dort. Danach funktioniert alles auf eine neue Art und Weise.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-j/fv/xo/-jfvxo93yhfdk69oyhb9xsybvom.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie funktioniert das Ersetzen der Funktion beim automatischen Laden? Wir haben zwei Funktionen, eine und zwei. Jede Funktion verf√ºgt √ºber eine Reihe von Attributen: Dokumentation, Code, Argumente usw. Hier auf der Folie finden Sie ein Beispiel f√ºr das Ersetzen der Attribute, in denen der Bytecode gespeichert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem das automatische Laden es ge√§ndert hat, funktioniert die aufgerufene Funktion anders. Aber dies ist ein synthetisches Beispiel, das ich gerade mit meinen H√§nden reproduziert habe, damit Sie verstehen, was passiert. Die Funktion wird auf eine Weise aufgerufen, aber der Code dort ist tats√§chlich anders. Und wenn Sie zerlegen, zeigt es auch, dass es eine Zwei zur√ºckgibt. Was f√ºhrt das? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bt/u7/qt/btu7qtygtpvagsnxat-tngwtvle.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein Beispiel f√ºr eine Schlie√üung. In der zweiten Zeile erstellen wir einen Abschluss, in dem wir die Funktion foo erfassen. Der Abschluss selbst erwartet, dass diese Funktion, die wir √ºbergeben haben, einen String zur√ºckgibt, ihn in utf-8 codiert und alles funktioniert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tu/mx/b8/tumxb8ifcxw_yh5o2veg8sfrtbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, Sie √§ndern das Modul, in dem foo definiert ist, und das automatische Laden √ºbernimmt die √Ñnderung. Und Sie √§ndern es so, dass es keine Zeichenfolge, sondern eine Zahl zur√ºckgibt. Dann funktioniert der Verschluss bereits falsch, da sich die Funktion darin ge√§ndert hat, aber der Verschluss dies nicht erwartet, er hat sich nicht ge√§ndert. Und solche Probleme mit dem automatischen Laden k√∂nnen an unerwarteten Orten "schie√üen". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/eq/k0/mseqk0r8rxsiji38ypx3drsloaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie werden Autorisierungsklassen aktualisiert? Sehr einfach. Es aktualisiert alle Methoden der Klasse auf die gleiche Weise wie Funktionen und aktualisiert auch das Attribut __class__ f√ºr alle Instanzen, sodass die Aufl√∂sung der Methoden (die bestimmt, welche Methode aufgerufen werden soll) auf neue Weise funktioniert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In TheREPL ist alles etwas komplizierter, da sich beim Aktualisieren von _class_ m√∂glicherweise einige Nachkommen, untergeordnete Klassen, herausstellen, die ebenfalls aktualisiert werden m√ºssen, da sich in der Liste der Basisklassen etwas ge√§ndert hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu l√∂sen, k√∂nnen Sie die Klasse neu erstellen. Aber lassen Sie uns zuerst sehen, was beim automatischen Laden passiert, wenn ein Modul neu geladen wird. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p-/xc/jg/p-xcjggcwk7h30knymqvqsl9_ue.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist ein gutes Beispiel. Es gibt zwei Module - a und b. In Modul a wird eine √ºbergeordnete Klasse definiert, in Modul b eine untergeordnete Klasse, und wir erstellen eine Instanz der untergeordneten Klasse. Und Zeile 10 zeigt, dass dies eine Instanz der Foo-Klasse ist, der √ºbergeordneten. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nm/aj/gu/nmajgupfumnuw-igpxdk-_fbvlw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes nehmen und √§ndern wir einfach das Modul a. F√ºgen Sie beispielsweise der Foo-Klasse Dokumentation hinzu. Dann √ºbernimmt das automatische Laden diese √Ñnderungen. Was denkst du, dass er in diesem Fall von Bar zur√ºckkehren wird?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3t/kz/iw/3tkziw2mnozaraudax0vm4ndzii.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und es gibt false zur√ºck, weil das automatische Laden die Foo-Klasse ge√§ndert hat und es sich nun um eine v√∂llig andere Klasse handelt, nicht um die, von der die Bar-Klasse geerbt wird. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jy/o5/mt/jyo5mtiwfcsw1vuvuegmz-ynxbm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und eine √úberraschung! In den beiden Modulen a und b ist die Foo-Klasse eine andere Klasse, und Bar erbt von einer von ihnen. Aufgrund solcher Pfosten ist es sehr schwierig vorherzusagen, wie Ihr Code funktionieren wird, nachdem das automatische Laden etwas darin behoben hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/g3/cj/3e/g3cj3enddiaxo02tzn5zr3jqaa8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So etwas aktualisiert Klassen. Ich werde das Bild kommentieren. Zun√§chst wird die Foo-Klasse in Modul b importiert und bleibt dort. Wenn Sie das automatische Laden ersetzen, wird dieses Modul a verschoben, und dort wird eine neue Klasse angezeigt. In Modul b wird es nicht aktualisiert.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/mg/pk/jamgpkvsohlnphdstlwz9_dbyig.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL macht ein bisschen anders. Er f√ºgt jedem Modul, in das er importiert wurde, eine modifizierte Klasse ein. Daher funktioniert dort alles richtig. Wenn sich Objekte in der Klasse befanden, bleiben diese erhalten. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/72/hk/cq/72hkcql64u5ap4p0dzhiwyoxicc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und so l√∂st TheREPL das Problem mit untergeordneten Klassen. Das hei√üt, wenn sich die √ºbergeordnete Klasse ge√§ndert hat, definiert sie die Liste der Basisklassen √ºber das magische Attribut mro (Reihenfolge der Methodenaufl√∂sung). Dieses Attribut enth√§lt eine Liste von Klassen in der Reihenfolge, in der Sie nach Methoden oder Attributen suchen m√∂chten. Und jedes Mal, wenn Sie beispielsweise die Methode get_name f√ºr Ihr Objekt aufrufen, √ºberpr√ºft Python sie zuerst in der Bar-Klasse, dann in der Foo-Klasse und dann in der Objektklasse, wenn sie nicht gefunden wird. Es handelt sich um das Verfahren zur Reihenfolge der Methodenaufl√∂sung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TheREPL verwendet diesen Chip. </font><font style="vertical-align: inherit;">Es nimmt eine Liste von Basisklassen auf und √§ndert dort die Klasse, die Sie gerade ge√§ndert haben, in eine neue. </font><font style="vertical-align: inherit;">Erstellt einen neuen untergeordneten Typ. Dies ist der zweite Schritt. </font><font style="vertical-align: inherit;">Mit der Typfunktion k√∂nnen Sie tats√§chlich Klassen erstellen. </font><font style="vertical-align: inherit;">Wenn Sie es noch nie benutzt haben - probieren Sie es aus, es macht Spa√ü. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sagen einfach den Namen der Klasse und die Basisklasse. </font><font style="vertical-align: inherit;">Im einfachsten Fall zum Beispiel Objekt. </font><font style="vertical-align: inherit;">Und - ein W√∂rterbuch mit Klassenmethoden und Attributen. </font><font style="vertical-align: inherit;">Alles, Sie haben eine neue Klasse, die Sie wie gewohnt instanziieren k√∂nnen. </font><font style="vertical-align: inherit;">TheREPL nutzt diesen Chip. </font><font style="vertical-align: inherit;">Es generiert eine untergeordnete Klasse und √§ndert Zeiger darauf in allen Objekten der alten Bar-Klasse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe noch eine Demo, schauen wir uns an, wie es funktioniert. </font><font style="vertical-align: inherit;">Schauen wir uns zun√§chst eine so einfache Sache an.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erste Demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich sagte, dass Sie den Code innerhalb des Moduls √§ndern k√∂nnen. Angenommen, wir haben einen Server. Ich werde es jetzt ausf√ºhren. Irgendwann stellen wir fest, dass er aus irgendeinem Grund tempor√§re Verzeichnisse erstellt. Oder er fing an zu erschaffen, aber vorher schuf er nicht. Dann k√∂nnen wir eine Verbindung zu diesem Server herstellen. Wenn Sie davon ausgehen, dass diese Verzeichnisse wahrscheinlich mit der Funktion mkdtemp aus dem Dateimodul erstellt werden, k√∂nnen Sie direkt zu diesem Python-Modul wechseln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Siehe - in der Ecke hat sich der Name des aktuellen Moduls ge√§ndert. Jetzt hei√üt es tempfile. Und ich kann sehen, welche Funktionen es gibt. Wir sehen sie und k√∂nnen sie vor allem neu definieren. Ich habe einen speziellen Wrapper vorbereitet, mit dem Sie jede Funktion so dekorieren k√∂nnen, dass Sie bei all ihren Aufrufen die Ablaufverfolgung sehen k√∂nnen, von der aus sie aufgerufen wird. Jetzt werden wir sie importieren und anwenden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, ich verpacke die Standard-Python-Funktion und habe nicht einmal Zugriff auf den Quellcode f√ºr dieses Modul. </font><font style="vertical-align: inherit;">Ich kann es nehmen und einwickeln. </font><font style="vertical-align: inherit;">Und bei der n√§chsten Ausgabe sehen wir Traceback und finden heraus, woher es aufgerufen wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf die gleiche Weise k√∂nnen diese √Ñnderungen r√ºckg√§ngig gemacht werden, damit sie uns nicht als Spam versenden. </font><font style="vertical-align: inherit;">Das hei√üt, wir sehen, dass dieser Server innerhalb des Workers in der achten Zeile mkdtemp aufruft und weiterhin tempor√§re Verzeichnisse f√ºr uns erstellt, wodurch das Dateisystem √ºberf√ºllt wird. </font><font style="vertical-align: inherit;">Dies ist eine Anwendung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns ein weiteres Beispiel an, warum das automatische Laden manchmal √ºberhaupt nicht gut funktioniert. </font><font style="vertical-align: inherit;">Ich habe einen Telegrammbot vorbereitet:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zweite Demo</font></font></b><div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/w4zabj_GAhg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt aktivieren wir das automatische Laden und sehen, wie es uns hilft. Das war's, jetzt kannst du den Bot starten und mit ihm sprechen. Damit Sie besser sehen k√∂nnen, werden wir einen Dialog mit ihm beginnen. Lerne den Bot kennen. Damit. Es gibt einen Fehler. Ein v√∂llig anderer Fehler wurde erfunden, und ich beschloss, im letzten Moment √Ñnderungen vorzunehmen. Aber es spielt keine Rolle. Jetzt werden wir das Problem beheben. Das automatische Laden hilft uns dabei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir wechseln zum Bot. Und jetzt werde ich dies vor√ºbergehend kommentieren, wenn ja. Ich speichere die Datei. Theoretisch musste die Autoreload diese √Ñnderungen erfassen. Starten Sie den Bot erneut. Der Bot hat mich erkannt. Reden wir mit ihm.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer Fehler. Sie ist bereits gezeugt. Lass es uns reparieren. Ich werde den Bot verlassen, es wird im Hintergrund funktionieren, ich werde zum Editor wechseln und im Editor werden wir diesen Fehler finden. Es ist nur ein Tippfehler und ich habe vergessen, dass meine Variable Benutzername hei√üt. Ich habe die Datei gespeichert. Autoreload sollte sie fangen, und jetzt werden wir es sehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber das automatische Laden, wie ich bereits erw√§hnt habe, wei√ü nichts dar√ºber, dass sich die Datei ge√§ndert hat, bis Sie etwas eingeben. Mit so einem langen Prozess ... Es muss unterbrochen, neu gestartet werden. Erledigt. Geh zur√ºck zu unserem Bot, schreib ihm. Sie sehen, der Bot hat vergessen, dass ich Sasha hei√üe. Warum? Beim automatischen Laden wurde es erneut erstellt, da das gesamte Modul vollst√§ndig neu geladen wird. Und ich muss erneut an den Bot schreiben, um seinen Zustand wiederherzustellen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wenn Sie einen Fehler debuggen, der in einem bestimmten Zustand auftritt, kann der Zustand nicht verloren gehen, da Sie sonst erneut viel Zeit aufwenden, um diesen Zustand zu erreichen. TheREPL hilft in solchen F√§llen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mal sehen, wie der Bot bei Verwendung von TheREPL aktualisiert wird. F√ºr die Reinheit des Experiments werde ich IPython neu starten und wir werden es noch einmal wiederholen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt lade ich TheREPL herunter. Er beginnt sofort, einen bestimmten Port abzuh√∂ren, damit Sie einen Code darin senden k√∂nnen. Dies ist √ºbrigens auch dann m√∂glich, wenn IPython irgendwo auf dem Server ausgef√ºhrt wird und der Editor lokal ausgef√ºhrt wird, was in einigen F√§llen auch hilfreich sein kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir importieren den Bot, starten ihn und schreiben erneut. Hier ist es klar - wir haben Python neu gestartet, daher kann es sich nicht erinnern, wer ich bin. √úberpr√ºfen Sie, ob ein Fehler vorliegt. Ja, es liegt ein Fehler vor. Nun, lass es uns erledigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich wechsle zur√ºck zum Editor, korrigiere den Fehler. Wir m√ºssen die Datei nicht einmal speichern. Ich dr√ºcke Strg-C, Strg-C. Dies ist eine Verkn√ºpfung, mit der Emacs die aktuelle Beschreibung der Funktion direkt unter dem Cursor an den Python-Prozess sendet, mit dem sie verbunden ist. Das ist alles, jetzt k√∂nnen wir √ºberpr√ºfen, wie unser Bot dort auf meine Nachrichten reagiert. Jetzt erinnert er sich, dass ich Sasha bin und antwortet ehrlich, dass er nicht wei√ü wie.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir dort direkt neue Funktionen hinzuzuf√ºgen. Gehen Sie dazu zur√ºck zum Editor. F√ºgen Sie beispielsweise den Befehl help hinzu. Lassen Sie ihn vorerst antworten, dass er nichts √ºber Hilfe wei√ü. Dr√ºcken Sie erneut Strg-C, Strg-C, der Code wird angewendet. Wir gehen zum Bot. Sehen Sie, ob er diesen Befehl versteht. Ja, das Team hat sich beworben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úbrigens hat er noch so etwas, jetzt schauen wir uns an, wie sich die Klasse ver√§ndern wird. Er hat einen Statusbefehl, einen speziellen Debugging-Befehl, um den Status des Bots anzuzeigen. Also haben sich einige Oleg verbunden. Interessant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Bot diesen Befehl ausf√ºhrt, ruft er reply auf, um die Darstellung des Bots anzuzeigen. Wir k√∂nnen diese Antwort zum Beispiel mit etwas anderem korrigieren. Stellen Sie beispielsweise sicher, dass nur die Namen eingegeben werden. Sie k√∂nnen dies tun. Wir kehren zu unserem Boten zur√ºck und f√ºhren den Zustand erneut aus. Und alle. Jetzt funktioniert die Antwort auf eine neue Art und Weise, aber das Objekt ist das gleiche, es hat seinen Zustand beibehalten, da es sich an uns alle erinnert - Oleg, Sasha, kek und "DROP TABLE Users, Alex"! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf diese Weise k√∂nnen Sie Code direkt im laufenden Betrieb schreiben und debuggen, ohne zu diesem Zyklus wechseln zu m√ºssen. Wenn Sie ein Paket sammeln m√ºssen, rollen Sie es irgendwo hin. Sie k√∂nnen schnell etwas testen, alles √§ndern, was Sie ben√∂tigen, und erst dann sollten alle diese √Ñnderungen ordnungsgem√§√ü verpackt und bereitgestellt werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich sollten Sie dies nicht in der realen Produktion tun, denn mit diesem Ansatz kann was f√ºr ein Problem sein. M√∂glicherweise vergessen Sie, dass der Code, den Sie gerade auf dem Server gestartet haben, gespeichert und dann ordnungsgem√§√ü bereitgestellt werden muss. Dieser Ansatz erfordert Disziplin. Bei der Entwicklung und dem Debuggen von Tests ist dies jedoch eine gro√üartige Sache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sicher, dass Sie ein Plugin f√ºr PyCharm erstellen. Wenn es einen Freiwilligen gibt, der mir mit Kotlin und dem PyCharm-Plugin hilft, werde ich gerne sprechen. Schreiben Sie mir </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">per Post</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegramm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* * * </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbinden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zur Entwicklung von TheREPL. </font><font style="vertical-align: inherit;">Es gibt viel mehr Chips, an die Sie denken k√∂nnen. </font><font style="vertical-align: inherit;">Sie k√∂nnen beispielsweise eine M√∂glichkeit finden, Klasseninstanzen beim Upgrade zu aktualisieren, dort neue Attribute hinzuzuf√ºgen oder ihren Status irgendwie zu aktualisieren. </font><font style="vertical-align: inherit;">Ebenso werden wir die Datenbank aktualisieren. </font><font style="vertical-align: inherit;">Nun ist das nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen einen Hot-Reload-Code f√ºr die Produktion erstellen, damit Sie den Server nicht neu starten m√ºssen, wenn neue √Ñnderungen zu Ihnen kommen. </font><font style="vertical-align: inherit;">Sie k√∂nnen sich viel mehr einfallen lassen. </font><font style="vertical-align: inherit;">Dies ist nur eine Idee, und ich m√∂chte, dass Sie sie hier rausholen. </font><font style="vertical-align: inherit;">Wir m√ºssen alles f√ºr uns selbst anpassen und es bequem machen. </font><font style="vertical-align: inherit;">Das ist alles f√ºr mich.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490778/index.html">Menschen, die die Arbeit eines Programmierers verstehen, sind √ºberall zu finden</a></li>
<li><a href="../de490780/index.html">Intel Xeon Scalable Gen2: Gro√üer Verkauf von Kernen</a></li>
<li><a href="../de490782/index.html">AnalogBytes-Konferenz: Roskomnadzor, Medien, Hochlast und alles in allem</a></li>
<li><a href="../de490784/index.html">Ich bin ein Android-Entwickler und wollte keine manuelle Arbeit leisten.</a></li>
<li><a href="../de490786/index.html">Leckanalyse zweiter Ordnung: Wenn es von denen leckt, die Daten von einer Bank stehlen</a></li>
<li><a href="../de490790/index.html">Zip-Dateien: Verlauf, Erl√§uterung und Implementierung</a></li>
<li><a href="../de490792/index.html">VXLAN in NSX-V - Unruhige Unterlage</a></li>
<li><a href="../de490796/index.html">So automatisieren Sie die Sicherheit von Containern im Stil von Policy as Code mithilfe von CRD</a></li>
<li><a href="../de490804/index.html">Wie die Mutter eines Hackers ins Gef√§ngnis kam und den Computer des Chefs infizierte</a></li>
<li><a href="../de490808/index.html">Mathematik in der Astronautik: Rotationsdetonationsmotor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>