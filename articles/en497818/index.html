<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè≠ üëµüèº üèÜ Remote access to VMs with GPU using Citrix ü•Ö üë®üèΩ‚Äç‚úàÔ∏è üè™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This guide details the steps that you must take to prepare for remote access to virtual desktops using the technology that Citrix offers. 
 
 It will ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Remote access to VMs with GPU using Citrix</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497818/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This guide details the steps that you must take to prepare for remote access to virtual desktops using the technology that Citrix offers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It will be useful to those who have recently become familiar with desktop virtualization technology, as it is a collection of useful commands assembled from ~ 10 manuals, many of which are available on the Citrix, Nvidia, Microsoft sites, after authorization. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This implementation contains the steps for preparing remote access to virtual machines (VMs) with Nvidia Tesla M60 graphics accelerators and the Centos 7 operating system.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, let's begin.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparing a hypervisor for hosting virtual machines</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to download and install XenServer 7.4? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to add XenServer to Citrix XenCenter? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to download and install Nvidia driver? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to change Nvidia Tesla M60 mode? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to mount storage?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XenServer 7.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> download link </font><font style="vertical-align: inherit;">is available after authorization on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eb/p2/kr/ebp2kr2edt_ktpzrhsimmkaofbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's install XenServer.iso on a server with 4x NVIDIA Tesla M60 in a regular way. In my case, iso is mounted via IPMI. For Dell servers, the BMC is managed through IDRAC. Installation steps are almost identical to installing Linux-like operating systems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My XenServer c GPU address is 192.168.1.100 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install XenCenter.msi on the local computer from which we will manage hypervisors and virtual machines. Add a server with a GPU and XenServer there by clicking on the ‚ÄúServer‚Äù tab, then ‚ÄúAdd‚Äù. Enter the username and password root specified during the installation of XenServer.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yy/qv/qw/yyqvqwxcbnxhwkj0ho3brs1lqom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In XenCenter, after clicking on the name of the added hypervisor, the Console tab will be available. </font><font style="vertical-align: inherit;">In the menu, select ‚ÄúRemote Service Configuration‚Äù and enable SSH authorization - ‚ÄúEnable / Disable Remote Shell‚Äù.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nvidia driver</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will give free rein to emotions and I will say that for all the time I worked with vGPU I have never </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visited the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">nvid.nvidia.com</font></a><font style="vertical-align: inherit;"> on the first try. </font><font style="vertical-align: inherit;">If authorization does not work, then I recommend Internet Explorer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download zip from vGPU, as well as GPUMode Change Utility: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NVIDIA-gpumodeswitch-2020-01.zip </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/ia/ny/sjianylmppn9as35nnxtrwj-bhw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We follow the versions. </font><font style="vertical-align: inherit;">The name of the downloaded archive shows the version of suitable NVIDIA drivers that can be installed on virtual machines in the future. </font><font style="vertical-align: inherit;">In my case, it is 390.72. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Throw zip-s on XenServer and unpack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Change the GPU mode and install the vGPU driver</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> NVIDIA-gpumodeswitch-2020-01<font></font>
$ gpumodeswitch --listgpumodes<font></font>
$ gpumodeswitch --gpumode graphics<font></font>
$ <span class="hljs-built_in">cd</span> ../NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81<font></font>
$ yum install NVIDIA-vGPU-xenserver-7.4-390.72.x86_64.rpm<font></font>
$ reboot</code></pre><br>
<img src="https://habrastorage.org/webt/qg/0m/lx/qg0mlxigfdyfvxvfpoijuh-sisa.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mount storage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Set up a shared directory using NFS on any computer on the network.</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install epel-release<font></font>
$ yum install nfs-utils libnfs-utils<font></font>
$ systemctl <span class="hljs-built_in">enable</span> rpcbind<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-server<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-lock<font></font>
$ systemctl <span class="hljs-built_in">enable</span> nfs-idmap<font></font>
$ systemctl start rpcbind<font></font>
$ systemctl start nfs-server<font></font>
$ systemctl start nfs-lock<font></font>
$ systemctl start nfs-idmap<font></font>
$ firewall-cmd --permanent --zone=public --add-service=nfs<font></font>
$ firewall-cmd --permanent --zone=public --add-service=mountd<font></font>
$ firewall-cmd --permanent --zone=public --add-service=rpc-bind<font></font>
$ firewall-cmd --reload<font></font>
$ mkdir -p /nfs/store1<font></font>
$ chmod -R 777 /nfs/store1<font></font>
$ touch /nfs/store1/forcheck<font></font>
$ cat /etc/exports<font></font>
  ...<font></font>
  /nfs/store1 192.168.1.0/24(rw,async,crossmnt,no_root_squash,no_all_squash,no_subtree_check)<font></font>
$ systemctl restart nfs-server</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In XenCenter, select XenServer and select ‚ÄúNew SR‚Äù on the ‚ÄúStorage‚Äù tab. </font><font style="vertical-align: inherit;">Specify the type of storage - NFS ISO. </font><font style="vertical-align: inherit;">The path must point to the NFS shared directory.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Master Image Based on Centos 7</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to create a virtual machine with Centos 7? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to prepare a virtual machine to create a directory?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The image of Centos 7</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using XenCenter, we will create a virtual machine with a GPU. </font><font style="vertical-align: inherit;">In the ‚ÄúVM‚Äù tab, click ‚ÄúNew VM‚Äù. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/et/fs/9g/etfs9g7biwgmswos8eazlinr_ba.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We select the necessary parameters: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM template - Other install media </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Name - template </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install from ISO library - Centos 7 ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">download</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), select from the mounted NFS ISO storage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Number of vCPUs - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topology - 1 socket with 4 cores per socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memory - 30 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU type - GRID M60-4Q </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use this virtual disk - 80 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creation, the virtual machine will appear in the vertical list on the left. </font><font style="vertical-align: inherit;">Click on it and go to the "Console" tab. </font><font style="vertical-align: inherit;">We will wait for the Centos 7 installer to load and complete the necessary steps to install the OS with the GNOME shell.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image preparation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It took me a lot of time to prepare the image with Centos 7. </font><font style="vertical-align: inherit;">This resulted in a set of scripts that facilitates the initial setup of Linux and allows you to create a virtual machine catalog using Citrix Machine Creation Services (MCS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The DHCP server installed on ws-ad assigned the IP address 192.168.1.129 to the new virtual machine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following are the basic settings.</font></font><br>
<br>
<pre><code class="bash hljs">$ hostnamectl <span class="hljs-built_in">set</span>-hostname template<font></font>
$ yum install -y epel-release<font></font>
$ yum install -y lsb mc gcc<font></font>
$ firewall-cmd --permanent --zone=dmz --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=external --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=home --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=samba-client<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=mdns<font></font>
$ firewall-cmd --permanent --zone=internal --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=dhcpv6-client<font></font>
$ firewall-cmd --permanent --zone=work --remove-service=ssh<font></font>
$ firewall-cmd --permanent --zone=public --add-service=ssh<font></font>
$ firewall-cmd --complete-reload</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In XenCenter, in the ‚ÄúConsole‚Äù tab, mount guest-tools.iso in the DVD drive of the virtual machine and install XenTools for Linux.</font></font><br>
<br>
<pre><code class="bash hljs">$ mount /dev/cdrom /mnt<font></font>
$ /mnt/Linux/install.sh<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When setting up XenServer, we used the NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81.zip archive downloaded from the NVIDIA website, which, in addition to the NVIDIA driver for XenServer, contains the NVIDIA driver we need for vGPU clients. </font><font style="vertical-align: inherit;">Download and install it on the VM.</font></font><br>
<br>
<pre><code class="bash hljs">$ cat /etc/default/grub<font></font>
  GRUB_TIMEOUT=5<font></font>
  GRUB_DISTRIBUTOR=<span class="hljs-string">"<span class="hljs-subst">$(sed 's, release .*$,,g' /etc/system-release)</span>"</span><font></font>
  GRUB_DEFAULT=saved<font></font>
  GRUB_DISABLE_SUBMENU=<span class="hljs-literal">true</span>
  GRUB_TERMINAL_OUTPUT=<span class="hljs-string">"console"</span>
  GRUB_CMDLINE_LINUX=<span class="hljs-string">"rhgb quiet modprobe.blacklist=nouveau"</span>
  GRUB_DISABLE_RECOVERY=<span class="hljs-string">"true"</span><font></font>
$ grub2-mkconfig -o /boot/grub2/grub.cfg<font></font>
$ wget http://vault.centos.org/7.6.1810/os/x86_64/Packages/kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ yum install kernel-devel-3.10.0-957.el7.x86_64.rpm<font></font>
$ reboot<font></font>
$ init 3<font></font>
$ NVIDIA-GRID-XenServer-7.4-390.72-390.75-391.81/NVIDIA-Linux-x86_64-390.75-grid.run<font></font>
$ cat /etc/nvidia/gridd.conf<font></font>
  ServerAddress=192.168.1.111<font></font>
  ServerPort=7070<font></font>
  FeatureType=1<font></font>
$ reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the Linux Virtual Delivery Agent 1811 (VDA) for Centos 7. The download link for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux VDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is available after authorization on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="bash hljs">$ yum install -y LinuxVDA-1811.el7_x.rpm<font></font>
$ cat /var/xdl/mcs/mcs.conf<font></font>
  <span class="hljs-comment">#!/bin/bash</span><font></font>
  dns1=192.168.1.110<font></font>
  NTP_SERVER=some.ntp.ru<font></font>
  AD_INTEGRATION=winbind<font></font>
  SUPPORT_DDC_AS_CNAME=N<font></font>
  VDA_PORT=80<font></font>
  REGISTER_SERVICE=Y<font></font>
  ADD_FIREWALL_RULES=Y<font></font>
  HDX_3D_PRO=Y<font></font>
  VDI_MODE=Y<font></font>
  SITE_NAME=domain.ru<font></font>
  LDAP_LIST=ws-ad.domain.ru<font></font>
  SEARCH_BASE=DC=domain,DC=ru<font></font>
  START_SERVICE=Y<font></font>
$ /opt/Citrix/VDA/sbin/deploymcs.sh<font></font>
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"exclude=kernel* xorg*"</span> &gt;&gt; /etc/yum.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Citrix Studio, create the Machine Catalog and Delivery group. </font><font style="vertical-align: inherit;">Before this, you must install and configure Windows Server.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server with Domain Controller</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to download and install Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to install Windows Server components? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to configure Active Directory, DHCP and DNS?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows server 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since a virtual machine (VM) with Windows Server does not need a GPU, we will use a server without a GPU as a hypervisor. By analogy with the description above, install another XenServer for hosting system virtual machines. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, create a virtual machine for Windows Server with Active Directory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download Windows Server 2016 from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">. It is better to follow the link using Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using XenCenter, we will create a virtual machine. In the ‚ÄúVM‚Äù tab, click ‚ÄúNew VM‚Äù. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We select the necessary parameters: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM template - Windows Server 2016 (64-bit) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Name - ws-ad.domain.ru </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install from ISO library - WindowsServer2016.iso, select from the mounted NFS ISO storage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Number of vCPUs - 4</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topology - 1 socket with 4 cores per socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memory - 20 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU type - none </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use this virtual disk - 100 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creation, the virtual machine will appear in the vertical list on the left. Click on it and go to the "Console" tab. Wait for the Windows Server installer to load and complete the necessary steps to install the OS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install in XenTools VM. Right-click on VM, then "Install Citrix VM Tools ...". After that, the image that you need to run and install XenTools will be mounted. At the end of the installation, a reboot of the VM will be required. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure the network adapter: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP address - 192.168.1.110 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mask - 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gateway - 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If Windows Server is not activated, then activate. </font><font style="vertical-align: inherit;">The key can be taken in the same place where the image was downloaded.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Set up the computer name. </font><font style="vertical-align: inherit;">In my case, this is ws-ad.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Component Installation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the server manager, select "Add Roles and Features." </font><font style="vertical-align: inherit;">Note the installation of the DHCP server, DNC server, and Active Directory Domain Services. </font><font style="vertical-align: inherit;">Check the box "Reload automatically."</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r2/5c/mk/r25cmkhjpon52zta-7ysbpffyig.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configure Active Directoy</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After rebooting the VM, click "Raise this server to the domain controller level" and add a new domain.ru forest.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DHCP server setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the top panel of the server manager, click on the exclamation mark to save the changes when installing the DHCP server. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's move on to the DHCP server settings. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wf/t6/pg/wft6pgjw4_lxdcvqa0rkphy4hhe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create a new area 192.168.1.120-130. </font><font style="vertical-align: inherit;">We do not change the rest. </font><font style="vertical-align: inherit;">Select ‚ÄúConfigure DHCP settings now‚Äù and enter the ws-ad IP address (192.168.1.110) as the gateway and DNS, which will be specified in the settings of the network adapters of virtual machines from the directory.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS server setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's move on to the DNS server settings. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sg/pc/kc/sgpckcwrrfz4z-6jy5pf0ibbnbo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's create a new zone of direct viewing - primary zone, for all DNS servers in the domain.ru domain. </font><font style="vertical-align: inherit;">Do not change anything else. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Create a new reverse lookup zone by selecting the same options. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the properties of the DNS server, in the "Advanced" tab, check the "Disable recursion" checkbox.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create a test user</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's go to the "Active Directory Administrative Center" </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4s/si/tp4ssidqmpefwnpa1excc5oexii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the "Users" section on the right, click "Create." </font><font style="vertical-align: inherit;">Enter a name, for example test, and click OK below. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/vd/pm/b-vdpmjw8osh9g0tor-ab0jl4sg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We‚Äôll select the created user and select ‚ÄúReset Password‚Äù in the vertical menu on the right. </font><font style="vertical-align: inherit;">Leave the checkmark ‚ÄúRequire password change the next time you log on to the system.‚Äù</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Server with Citrix Delivery Controller</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to download and install Windows Server 2016? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to download and install Citrix Delivery Controller? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to install and configure Citrix License Manager? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to install and configure NVIDIA License Manager?</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows server 2016</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since a virtual machine (VM) with Windows Server does not need a GPU, we will use a server without a GPU as a hypervisor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download Windows Server 2016 from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">. It is better to follow the link using Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9t/u3/br/9tu3brk0d6qqy6k6drtf7gd2sig.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using XenCenter, we will create a virtual machine. In the ‚ÄúVM‚Äù tab, click ‚ÄúNew VM‚Äù. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/ea/yf/imeayf3rgvlrpaq4kqer_ofoei0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select the necessary parameters: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VM template - Windows Server 2016 (64-bit) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Name - ws-dc </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install from ISO library - WindowsServer2016.iso, select from the mounted NFS ISO storage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Number of vCPUs - 4 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Topology - 1 socket with 4 cores per socket </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memory - 20 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPU type - none </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use this virtual disk - 100 Gb </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creation, the virtual machine will appear in the vertical list on the left. Click on it and go to the "Console" tab. We will wait for the Windows Server installer to load and complete the necessary steps to install the OS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install in XenTools VM. Right-click on VM, then "Install Citrix VM Tools ...". After that, the image that you need to run and install XenTools will be mounted. At the end of the installation, a reboot of the VM will be required. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configure the network adapter: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IP address - 192.168.1.111 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mask - 255.255.255.0 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gateway - 192.168.1.1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS1 - 8.8.8.8 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DNS2 - 8.8.4.4 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If Windows Server is not activated, we will activate it. The key can be taken in the same place where the image was downloaded.</font></font><br>
<br>
<pre><code class="bash hljs">[PowerShell]$ slmgr -ipk xxxxx-xxxxx-xxxxx-xxxxx-xxxxx</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Set up the computer name. </font><font style="vertical-align: inherit;">In my case, this is ws-dc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Add the VM to the domain domen.ru, reboot and log in under the domain administrator account DOMEN \ Administrator.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix delivery controller</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download Citrix Virtual Apps and Desktops 1811 at ws-dc.domain.com. </font><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Virtual Apps and Desktops</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> download link </font><font style="vertical-align: inherit;">is available after logging in to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ik/wy/--/ikwy--onnx7q_qlpdy8jjrn9_qi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mount the downloaded iso and run. </font><font style="vertical-align: inherit;">Choose Citrix Virtual Apps and Desktops 7. </font><font style="vertical-align: inherit;">Next, click "Get started". </font><font style="vertical-align: inherit;">A reboot may be required. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/-l/x5/po-lx5nd34-fuw7gibvgajcg42w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my case, it is enough to select the following components for installation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delivery Controller </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Studio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
License Server </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
StoreFront </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do not change anything else and click "Install." </font><font style="vertical-align: inherit;">A reboot will be required more than once, after which the installation will continue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As soon as the installation is complete, Citrix Studio, the Citrix farm management environment, will start.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tp/4q/_x/tp4q_xeo9tdviobu4zaannj-vfk.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Site Setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choose the first section of the three - Site setup. </font><font style="vertical-align: inherit;">When setting, specify the Site Name - domain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the ‚ÄúConnection‚Äù section, we specify the data for connecting the hypervisor with the GPU: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connection address - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">192.168.1.100</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
User name - root </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Password - yourpassword </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connection Name - m60 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Store management - Use storage local to the hypervisor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Name for these resources - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select networks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Select a GPU type and group - GRID M60-4Q.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tuning Citrix Machine Catalogs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When setting up the second section - Machine Catalogs, select Single-session OS (Desktop OS). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Master Image - select the prepared image of the virtual machine and the version of Citrix Virtual Apps and Desktops - 1811. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Choose the number of virtual machines in the directory, for example 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let us indicate the scheme by which the virtual machines will be named, in my case this is desktop ##. </font><font style="vertical-align: inherit;">In this case, 4 VMs with the names desktop01-04 will be created. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Machine Catalog name - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Machine Catalog description - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After creating the Machine Catalog with four VMs, they can be found in the XenCenter vertical list on the left.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix Delivery Group</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The third section begins by selecting the number of VMs to which access should be granted. </font><font style="vertical-align: inherit;">I will indicate all four. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the "Desktops" section, click "Add" to add the VM group to which we will provide access. </font><font style="vertical-align: inherit;">Display name - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delivery group name - m60. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After setting up the three main sections, the main window of Citrix Studio will look something like this</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kb/s3/up/kbs3up5h_utcj8db_caznbwgo_i.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix license manager</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the license file through your personal account on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Citrix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the vertical list on the left, select All Licensing Tools (Legacy). Go to the tab "Activate and Allocate Licenses". Select Citrix VDA licenses and click Continue. Specify the name of our Delivery Controllera - ws-dc.domain.ru and the number of licenses - 4. Click "Continue". Download the generated license file for ws-dc.domain.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-f/6o/tg/-f6otgoimp8n0qh_xdcrfvf5hew.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the left vertical list of Citrix Studio, select the "Licensing" section. In the right vertical list, click "License Management Console". In the browser window that opens, enter the data for authorization of the domain user DOMEN \ Administrator. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Citrix Licensing Manager, go to the ‚ÄúInstall License‚Äù tab. To add a license file, select "Use downloaded license file".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bo/sy/rz/bosyrz3sj4ysmjs0vlwfhcp36ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installation of Citrix components involves the use of several virtual machines, one component - one VM. </font><font style="vertical-align: inherit;">In my case, all Citrix system services operate within the same VM. </font><font style="vertical-align: inherit;">In this regard, I note one bug, the correction of which was especially difficult for me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If after rebooting ws-dc there are problems of a different nature, then I recommend that you check the running services first. </font><font style="vertical-align: inherit;">Here is a list of Citrix services that should automatically start after a VM reboot:</font></font><br>
<br>
<pre><code class="plaintext hljs">SQL Server (SQLEXPRESS)<font></font>
Citrix Configuration Service<font></font>
Citrix Delegated Administration Service<font></font>
Citrix Analytics<font></font>
Citrix Broker Service<font></font>
Citrix Configuration Logging Service<font></font>
Citrix AD Identity Service<font></font>
Citrix Host Service<font></font>
Citrix App Library<font></font>
Citrix Machine Creation Service<font></font>
Citrix Monitor Service<font></font>
Citrix Storefront Service<font></font>
Citrix Trust Service<font></font>
Citrix Environment Test Service<font></font>
Citrix Orchestration Service<font></font>
FlexNet License Server -nvidia</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I encountered a problem that occurs when installing various Citrix services on a single VM. </font><font style="vertical-align: inherit;">After a reboot, not all services start. </font><font style="vertical-align: inherit;">One by one to launch the entire chain was laziness. </font><font style="vertical-align: inherit;">The solution was googled hard, so I bring it here - two parameters should be changed in the registry:</font></font><br>
<br>
<pre><code class="bash hljs">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control<font></font>
Name : ServicesPipeTimeout<font></font>
Value :240000<font></font>
<font></font>
Name : WaitToKillServiceTimeout<font></font>
Value : 20000</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nvidia license manager</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download the NVIDIA License Manager for Windows through your personal account on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . It‚Äôs better to go through Internet Explorer. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/hb/ih/auhbihphsv81hapm3cpgpxjbcmi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install it on ws-dc. To do this, you first need to install </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JAVA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the environment variable JAVA_HOME. After that, you can run setup.exe to install the NVIDIA License Manager. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nv/bd/wu/nvbdwuyf4xtx-fsqqpa2qwzunke.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's create a server, generate and download the license file in your personal account on the site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nvid.nvidia.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Let's transfer the license file for ws-dc. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/ui/zb/r-uizbl706_p1w35j27fk0lv2wu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using a browser, we log in to the NVIDIA license manager web interface, available at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 8080 / licserver and add a license file. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vi/ut/oc/viutocj16sitn-q_diao-oehmfa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Active sessions using vGPU can be viewed in the Licensed Clients section.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote access to the Citrix machine catalog</font></font></h2><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to install Citrix Receiver? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How to connect to a virtual desktop? </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the working computer, open a browser, in my case it‚Äôs Chrome, and go to the address of the web interface of Citrix StoreWeb</font></font><br>
<br>
<pre><code class="bash hljs">http://192.168.1.111/Citrix/StoreWeb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If Citrix Recever is not already installed, then click ‚ÄúDiscover Receiver‚Äù. We </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/iv/nh/riivnhuygym-oivw0iaq0hghr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
carefully read the license agreement, download and install Citrix Receiver. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r3/9b/cd/r39bcddyu-e57s9tpk6gj-o19vg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After installation, go back to the browser and click ‚ÄúContinue.‚Äù </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/vw/dg/iavwdgrxnyukfifcb03b0gvbyf4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, a notification opens in the Chrome browser, click ‚ÄúOpen Citrix Receiver Launcher application‚Äù , and then ‚ÄúDetect again‚Äù or ‚ÄúAlready installed‚Äù. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7o/hs/bx/7ohsbxmdogzv7tvdwji5xwa1xam.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the first connection, we will use the data of the test user test. </font><font style="vertical-align: inherit;">Change the temporary password to a permanent one. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/as/9k/l0/as9kl0vlibg4fmhts2rjgrsupvw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After authorization, go to the ‚ÄúApplications‚Äù tab and select the ‚ÄúM60‚Äù </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j9/fb/md/j9fbmdbevvo42-2su76ifsaisnk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
directory </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Download the proposed file with the extension .ica. </font><font style="vertical-align: inherit;">After double-clicking on it, a window opens in Desktop Veiwer with the Centos 7 desktop</font></font><br>
<br>
<img src="https://habrastorage.org/webt/n2/70/3p/n2703pzygelapwl6ixj7n5wcgfm.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497808/index.html">3D do it yourself. Part 2: it is three-dimensional</a></li>
<li><a href="../en497810/index.html">PVS Studio.VS. Statistical analysis of GCC 10. Independent mini-test</a></li>
<li><a href="../en497812/index.html">Scientists from MIT are developing a device that will allow at least partially control their dreams</a></li>
<li><a href="../en497814/index.html">Five stages of accepting the inevitable, or How we developed a program for automated profiling</a></li>
<li><a href="../en497816/index.html">Russian Railways sends me someone else's tickets</a></li>
<li><a href="../en497820/index.html">Statistical regularization of incorrect inverse problems to them. Turchin (part 1)</a></li>
<li><a href="../en497822/index.html">Man in a bottle</a></li>
<li><a href="../en497826/index.html">How to quickly capture the world or manage a network of windows computers using OPSI</a></li>
<li><a href="../en497828/index.html">2 in 1: encryption with security protection</a></li>
<li><a href="../en497830/index.html">OWASP Moscow 2020/1 Recordings</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>