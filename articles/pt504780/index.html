<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé≤ ü§ö üë©üèΩ‚Äç‚úàÔ∏è NSA, Ghidra e Unic√≥rnios üö∂üèø üßóüèº üîä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Desta vez, a equipe do PVS-Studio foi atra√≠da por Ghidra, uma estrutura grande e maligna para engenharia reversa com a qual voc√™ pode analisar v√°rios ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>NSA, Ghidra e Unic√≥rnios</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/504780/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/zb/b9/po/zbb9pocjsbhx8woze4xo8picks0.png" alt="NSA, Ghidra e Unic√≥rnios"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desta vez, a equipe do PVS-Studio foi atra√≠da por Ghidra, uma estrutura grande e maligna para engenharia reversa com a qual voc√™ pode analisar v√°rios arquivos bin√°rios e fazer todo tipo de coisa assustadora com eles. </font><font style="vertical-align: inherit;">A coisa mais interessante sobre isso n√£o √© que ele √© gratuito para uso ou se estende bem com plug-ins, mas que foi escrito na NSA e publicado no GitHub para todos. </font><font style="vertical-align: inherit;">Por um lado, a NSA parece ter recursos suficientes para manter a base de c√≥digo limpa. </font><font style="vertical-align: inherit;">Por outro lado, novos colaboradores que n√£o estavam muito familiarizados com ele poderiam ter acidentalmente adicionado erros n√£o detectados recentemente. </font><font style="vertical-align: inherit;">Portanto, armados com uma an√°lise est√°tica, decidimos procurar pontos fracos neste projeto.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prel√∫dio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No total, o analisador est√°tico PVS-Studio emitiu 651 avisos altos, 904 m√©dios e 909 baixos na parte Java do projeto Ghidra ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">release 9.1.2, commit 687ce7f</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Entre eles, cerca de metade das respostas altas e m√©dias foram desencadeadas pelo diagn√≥stico </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6022</font></a><font style="vertical-align: inherit;"> .</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O par√¢metro n√£o √© usado dentro do corpo do m√©todo ", que geralmente aparece ap√≥s a refatora√ß√£o, quando algum par√¢metro n√£o era mais necess√°rio ou alguma funcionalidade foi temporariamente desabilitada pelos coment√°rios. Uma r√°pida olhada nesses avisos (h√° muitos deles para exibir cada um como um observador externo ) neste projeto n√£o revelou nada obviamente suspeito. Provavelmente, √© permitido que esse projeto desative temporariamente esse diagn√≥stico nas configura√ß√µes do analisador para n√£o ser distra√≠do por ele. Na pr√°tica, √© poss√≠vel ver erros de digita√ß√£o no nome do par√¢metro setter ou construtor e, de um modo geral, n√£o deve Tenho certeza de que a maioria dos leitores, pelo menos uma vez, encontra um padr√£o desagrad√°vel semelhante:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>{
  <span class="hljs-keyword">private</span> String value;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">A</span><span class="hljs-params">(String val)</span> </span>{ <span class="hljs-comment">// V6022</span>
    <span class="hljs-keyword">this</span>.value = value;<font></font>
  }<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> value.hashCode(); <span class="hljs-comment">// NullPointerException</span><font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais da metade dos avisos baixos foram feitos pelo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diagn√≥stico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">Derefer√™ncia</font></a><font style="vertical-align: inherit;"> nula potencial do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6008</font></a><font style="vertical-align: inherit;"> de 'vari√°vel'" - por exemplo, o valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File.getParentFile ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geralmente </font><i><font style="vertical-align: inherit;">√©</font></i><font style="vertical-align: inherit;"> usado </font><font style="vertical-align: inherit;">sem a verifica√ß√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se o objeto de arquivo no qual esse m√©todo foi chamado foi constru√≠do sem um caminho absoluto, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ser√° retornado </font><font style="vertical-align: inherit;">e a aus√™ncia de verifica√ß√£o poder√° interromper o aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por tradi√ß√£o, analisaremos apenas avisos de n√≠veis alto e m√©dio, uma vez que a maior parte dos erros reais est√° contida neles. Ao trabalhar com relat√≥rios do analisador, sempre recomendamos a an√°lise de avisos em ordem decrescente de confiabilidade.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, consideramos alguns fragmentos indicados pelo analisador que pareciam suspeitos ou interessantes para mim. </font><font style="vertical-align: inherit;">A base de c√≥digo do projeto acabou sendo de tamanho impressionante, e √© quase imposs√≠vel encontrar esses locais manualmente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 1: valida√ß√£o interrompida</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">parseDataTypeTextEntry</span><span class="hljs-params">()</span>
<span class="hljs-keyword">throws</span> InvalidDataTypeException </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">try</span> {<font></font>
    newDataType = parser.parse(selectionField.getText(),<font></font>
                               getDataTypeRootForCurrentText());<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (CancelledException e) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (newDataType != <span class="hljs-keyword">null</span>) {
    <span class="hljs-keyword">if</span> (maxSize &gt;= <span class="hljs-number">0</span>
        &amp;&amp; newDataType.getLength() &gt; newDataType.getLength()) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidDataTypeException(<span class="hljs-string">"data-type larger than "</span>
                                         + maxSize + <span class="hljs-string">" bytes"</span>);<font></font>
    }<font></font>
    selectionField.setSelectedValue(newDataType);<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existem sub-express√µes id√™nticas 'newDataType.getLength ()' √† esquerda e √† direita do operador '&gt;'. DataTypeSelectionEditor.java data66 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta classe fornece um componente gr√°fico para selecionar um tipo de dados que suporta o preenchimento autom√°tico. O desenvolvedor que usa esse componente pode definir o tamanho m√°ximo permitido do tipo de dados selecionado (por meio do campo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ou torn√°-lo ilimitado, definindo um valor negativo. Supunha-se que, ao validar os dados inseridos, exceder o limite gera uma exce√ß√£o, que √© capturada pela pilha de chamadas e o usu√°rio recebe uma mensagem.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que o autor do componente estava distra√≠do no momento em que escrevia esse teste, ou talvez ele pensasse no significado da vida, mas no final, a valida√ß√£o simplesmente n√£o √© realizada, pois o n√∫mero nunca pode ser maior que ele e, consequentemente, ignoramos essa condi√ß√£o. Isso significa que este componente pode fornecer dados inv√°lidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro erro semelhante foi encontrado em mais duas classes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GuidUtil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewGuid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GuidUtil</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GuidInfo <span class="hljs-title">parseLine</span><span class="hljs-params">(...)</span> </span>{<font></font>
    ...<font></font>
    <span class="hljs-keyword">long</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">long</span>[<span class="hljs-number">4</span>];<font></font>
    ...<font></font>
    <span class="hljs-keyword">if</span> (isOK(data)) {
      <span class="hljs-keyword">if</span> (!hasVersion) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> GuidInfo(guidString, name, guidType);<font></font>
      }<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> VersionedGuidInfo(guidString, version, name, guidType);<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
  }<font></font>
  ...<font></font>
  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
      <span class="hljs-keyword">if</span> ((data[i] != <span class="hljs-number">0</span>) || (data[i] != <span class="hljs-number">0xFFFFFFFFL</span>)) { <span class="hljs-comment">// &lt;=</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">A</font></a><font style="vertical-align: inherit;"> express√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6007</font></a><font style="vertical-align: inherit;"> 'data [i]! = 0xFFFFFFFFL' √© sempre verdadeira. GuidUtil.java:200 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O loop </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><font style="vertical-align: inherit;">m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verifica se o mesmo valor n√£o √© igual a dois n√∫meros diferentes ao mesmo tempo. Nesse caso, o GUID √© imediatamente reconhecido como v√°lido. Ou seja, o GUID ser√° inv√°lido apenas se a matriz de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estiver </font><font style="vertical-align: inherit;">vazia, e isso nunca acontece, pois o valor da vari√°vel correspondente √© atribu√≠do apenas uma vez - no in√≠cio do m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parseLine</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Corpo do</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IsOK</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em ambas as classes coincide completamente, o que sugere a id√©ia de outra c√≥pia e colagem de c√≥digo incorreto. </font><font style="vertical-align: inherit;">O que exatamente o autor queria verificar, n√£o tenho certeza, mas posso assumir que esse m√©todo deve ser corrigido da seguinte maneira:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isOK</span><span class="hljs-params">(<span class="hljs-keyword">long</span>[] data)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">if</span> ((data[i] == <span class="hljs-number">0</span>) || (data[i] == <span class="hljs-number">0xFFFFFFFFL</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 2: ocultando exce√ß√µes</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">putByte</span><span class="hljs-params">(<span class="hljs-keyword">long</span> offsetInMemBlock, <span class="hljs-keyword">byte</span> b)</span>
<span class="hljs-keyword">throws</span> MemoryAccessException, IOException </span>{
  <span class="hljs-keyword">long</span> offsetInSubBlock = offsetInMemBlock - subBlockOffset;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (ioPending) {
      <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"Cyclic Access"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
    ioPending = <span class="hljs-keyword">true</span>;<font></font>
    doPutByte(mappedAddress.addNoWrap(offsetInSubBlock / <span class="hljs-number">8</span>),<font></font>
              (<span class="hljs-keyword">int</span>) (offsetInSubBlock % <span class="hljs-number">8</span>), b);<font></font>
  }<font></font>
  <span class="hljs-keyword">catch</span> (AddressOverflowException e) {
    <span class="hljs-keyword">new</span> MemoryAccessException(<span class="hljs-string">"No memory at address"</span>); <span class="hljs-comment">// &lt;=</span><font></font>
  }<font></font>
  <span class="hljs-keyword">finally</span> {<font></font>
    ioPending = <span class="hljs-keyword">false</span>;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6006</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O objeto foi criado, mas n√£o est√° sendo usado. A palavra-chave 'throw' pode estar ausente: 'new MemoryAccessException ("Cyclic Access")'. BitMappedSubMemoryBlock.java:99 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os pr√≥prios objetos de exce√ß√£o, como voc√™ sabe, n√£o fazem nada (ou pelo menos n√£o devem fazer nada). Quase sempre, as suas novas inst√¢ncias s√£o jogados atrav√©s de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lance</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em alguns casos raros - transferido em algum lugar ou talvez colocado em uma cole√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A classe que cont√©m esse m√©todo √© um inv√≥lucro sobre um bloco de mem√≥ria que permite ler e gravar dados. Aqui, devido ao fato de que n√£o s√£o lan√ßadas exce√ß√µes, a restri√ß√£o imposta de acesso ao bloco de mem√≥ria atual com o sinalizador </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioPending pode ser violada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, al√©m disso, um </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AddressOverflowException √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ignorado </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Assim, os dados podem ser corrompidos silenciosamente e, em vez de indicar explicitamente um erro em um local espec√≠fico, o desenvolvedor receber√° artefatos estranhos que precisam ser analisados ‚Äã‚Äãpelo depurador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Havia oito dessas exce√ß√µes perdidas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BitMappedSubMemoryBlock.java: linhas 77, 99, 106, 122</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ByteMappedSubMemoryBlock.java: linhas 52, 73, 92, 114</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â caracter√≠stico que nos mesmos arquivos existam m√©todos extremamente semelhantes nos quais o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">throw est√°</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> presente. </font><font style="vertical-align: inherit;">Provavelmente, um m√©todo foi originalmente escrito de forma semelhante ao fragmento acima, ap√≥s o qual foi copiado v√°rias vezes, de alguma forma encontrou um erro e o corrigiu nos locais em que eles conseguiam se lembrar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 3: campo minado</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processSelection</span><span class="hljs-params">(OptionsTreeNode selectedNode)</span> </span>{
  <span class="hljs-keyword">if</span> (selectedNode == <span class="hljs-keyword">null</span>) {<font></font>
    setViewPanel(defaultPanel, selectedNode); <span class="hljs-comment">// &lt;=</span>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setViewPanel</span><span class="hljs-params">(JComponent component, OptionsTreeNode selectedNode)</span> </span>{<font></font>
  ...<font></font>
  setHelpLocation(component, selectedNode);<font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHelpLocation</span><span class="hljs-params">(JComponent component, OptionsTreeNode node)</span> </span>{<font></font>
  Options options = node.getOptions();<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviso do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PVS-Studio: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6008 Desrefer√™ncia</font></a><font style="vertical-align: inherit;"> nula de 'selectedNode' na fun√ß√£o 'setViewPanel'. OptionsPanel.java:266 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O analisador mentiu um pouco - no momento, chamar o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o leva a uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j√° que esse m√©todo √© chamado apenas duas vezes e, antes de cham√°-lo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verificado explicitamente como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Isso n√£o deve ser feito, pois outro desenvolvedor pode ver que o m√©todo lida explicitamente com o caso </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e decidir que esse √© um valor v√°lido, o que resultar√° na falha do aplicativo. Tais surpresas s√£o especialmente perigosas apenas em projetos abertos, j√° que pessoas que n√£o conhecem a base de c√≥digo participam completamente delas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, devo dizer que todo o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processSelection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parece bastante estranho. </font><font style="vertical-align: inherit;">√â prov√°vel que este seja um erro de copiar e colar, pois no mesmo m√©todo um bloco if com o mesmo corpo √© encontrado duas vezes mais, embora com condi√ß√µes diferentes. </font><font style="vertical-align: inherit;">No entanto, nesse momento, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selectedNode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><i><font style="vertical-align: inherit;">ser√°</font></i><font style="vertical-align: inherit;"> mais </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e a cadeia de chamadas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setViewPanel-setHelpLocation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o resultar√° em uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullPointerException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 4: auto-completar para o mal</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span>[] UNSUPPORTED_OPCODES_LIST = { ... };
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Set&lt;Integer&gt; UNSUPPORTED_OPCODES = <span class="hljs-keyword">new</span> HashSet&lt;&gt;();<font></font>
<font></font>
<span class="hljs-keyword">static</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> opcode : UNSUPPORTED_OPCODES) {<font></font>
    UNSUPPORTED_OPCODES.add(opcode);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A cole√ß√£o √© modificada enquanto a itera√ß√£o est√° em andamento. ConcurrentModificationException pode ocorrer. DWARFExpressionOpCodes.java:205 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o analisador mentiu novamente um pouco - a exce√ß√£o n√£o ser√° lan√ßada, pois a cole√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNSUPPORTED_OPCODES est√°</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sempre vazia e o loop simplesmente n√£o √© executado. Al√©m disso, aconteceu que a cole√ß√£o √© uma multid√£o e a adi√ß√£o de um elemento j√° presente n√£o a alterar√°. Muito provavelmente, o autor digitou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o nome da cole√ß√£o por meio do preenchimento autom√°tico e n√£o percebeu que o campo errado foi proposto. </font><font style="vertical-align: inherit;">A modifica√ß√£o da cole√ß√£o durante a itera√ß√£o √© imposs√≠vel, mas em boas circunst√¢ncias, como neste caso, o aplicativo pode n√£o cair. </font><font style="vertical-align: inherit;">Aqui, esse erro de digita√ß√£o tem um efeito indireto: a m√°quina que analisa arquivos DWARF depende dessa cole√ß√£o para interromper a an√°lise ao encontrar c√≥digos de opera√ß√£o n√£o suportados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A partir do Java 9, vale a pena usar os m√©todos de f√°brica da biblioteca padr√£o para cole√ß√µes constantes: por exemplo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set.of (elementos T ...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o </font><i><font style="vertical-align: inherit;">√©</font></i><font style="vertical-align: inherit;"> apenas muito mais conveniente, mas tamb√©m torna imut√°vel a cole√ß√£o criada imediatamente, o que aumenta a confiabilidade do c√≥digo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 5: h√° tudo</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValueAt</span><span class="hljs-params">(Object aValue, <span class="hljs-keyword">int</span> row, <span class="hljs-keyword">int</span> column)</span> </span>{<font></font>
  ...<font></font>
  <span class="hljs-keyword">int</span> index = indexOf(newName);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {                  <span class="hljs-comment">// &lt;=</span><font></font>
    Window window = tool.getActiveWindow();<font></font>
    Msg.showInfo(getClass(), window, <span class="hljs-string">"Duplicate Name"</span>,
                 <span class="hljs-string">"Name already exists: "</span> + newName);
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
<font></font>
  ExternalPath path = paths.get(row); <span class="hljs-comment">// &lt;=</span><font></font>
  ...<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(String name)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; paths.size(); i++) {<font></font>
    ExternalPath path = paths.get(i);<font></font>
    <span class="hljs-keyword">if</span> (path.getName().equals(name)) {
      <span class="hljs-keyword">return</span> i;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avisos do PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6007</font></a><font style="vertical-align: inherit;"> 'index&gt; = 0' √© sempre verdadeira. </font><font style="vertical-align: inherit;">ExternalNamesTableModel.java:105</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6019</a> Unreachable code detected. It is possible that an error is present. ExternalNamesTableModel.java:109</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O autor pensou sobre isso e, no m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf, em</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vez de "index" -1 para um valor desconhecido, retorna 0 - o √≠ndice do primeiro elemento da cole√ß√£o de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caminhos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mesmo se a cole√ß√£o estiver vazia. Ou talvez o m√©todo tenha sido gerado, mas esqueceu de alterar o valor de retorno padr√£o. Como resultado, o m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descartar√° qualquer valor passado para ele e exibir√° o usu√°rio com um erro "O nome j√° existe", mesmo se n√£o houver um nome existente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o √© usado em nenhum outro lugar, e seu valor √© necess√°rio apenas para determinar se o elemento que voc√™ est√° procurando existe. Talvez, em vez de um m√©todo separado, escreva </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada um</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diretamente em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e fa√ßa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em um item correspondente em vez de jogos com √≠ndices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nota: N√£o foi poss√≠vel reproduzir o alegado erro. </font><font style="vertical-align: inherit;">O m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setValueAt provavelmente</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o √© mais usado ou chamado apenas sob determinadas condi√ß√µes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 6: mantenha o sil√™ncio</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-keyword">final</span> <span class="hljs-keyword">static</span> Map&lt;Character, String&gt; DELIMITER_NAME_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(<span class="hljs-number">20</span>);
<span class="hljs-comment">// Any non-alphanumeric char can be used as a delimiter.</span>
<span class="hljs-keyword">static</span> {<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">' '</span>, <span class="hljs-string">"Space"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'~'</span>, <span class="hljs-string">"Tilde"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'`'</span>, <span class="hljs-string">"Back quote"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"Exclamation point"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'@'</span>, <span class="hljs-string">"At sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'#'</span>, <span class="hljs-string">"Pound sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'$'</span>, <span class="hljs-string">"Dollar sign"</span>);<font></font>
  DELIMITER_NAME_MAP.put(<span class="hljs-string">'%'</span>, <span class="hljs-string">"Percent sign"</span>);<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studio Warning: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6033</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um item com a mesma chave '@' j√° foi adicionado. FilterOptions.java:45 O </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ghidra suporta a filtragem de dados em v√°rios contextos: por exemplo, voc√™ pode filtrar a lista de arquivos do projeto por nome. Al√©m disso, a filtragem por v√°rias palavras-chave ao mesmo tempo √© implementada: '.java, .c' quando o modo 'OR' est√° ativado, exibe todos os arquivos cujo nome cont√©m '.java' ou '.c'. Entende-se que qualquer caractere especial pode ser usado como um separador de palavras (um separador espec√≠fico √© selecionado nas configura√ß√µes de filtro), mas, na realidade, o ponto de exclama√ß√£o n√£o estava dispon√≠vel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nessas folhas de inicializa√ß√£o, √© muito f√°cil selar, pois elas geralmente s√£o escritas usando copiar e colar e, quando voc√™ olha para esse c√≥digo, seus olhos ficam borrados rapidamente. </font><font style="vertical-align: inherit;">E se o erro de digita√ß√£o n√£o estava em duas linhas adjacentes, ent√£o √† m√£o quase certamente ningu√©m ver√°.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 7: o restante da divis√£o √© sempre 0</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setFactorys</span><span class="hljs-params">(FieldFactory[] fieldFactorys,
                 DataFormatModel dataModel, <span class="hljs-keyword">int</span> margin)</span> </span>{<font></font>
  factorys = <span class="hljs-keyword">new</span> FieldFactory[fieldFactorys.length];<font></font>
<font></font>
  <span class="hljs-keyword">int</span> x = margin;
  <span class="hljs-keyword">int</span> defaultGroupSizeSpace = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; factorys.length; i++) {<font></font>
    factorys[i] = fieldFactorys[i];<font></font>
    factorys[i].setStartX(x);<font></font>
    x += factorys[i].getWidth();<font></font>
    <span class="hljs-comment">// add in space between groups</span>
    <span class="hljs-keyword">if</span> (((i + <span class="hljs-number">1</span>) % defaultGroupSizeSpace) == <span class="hljs-number">0</span>) { <span class="hljs-comment">// &lt;=</span><font></font>
      x += margin * dataModel.getUnitDelimiterSize();<font></font>
    }<font></font>
  }<font></font>
  width = x - margin * dataModel.getUnitDelimiterSize() + margin;<font></font>
  layoutChanged();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avisos do PVS-Studio:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6007</font></a><font style="vertical-align: inherit;"> '((i + 1)% defaultGroupSizeSpace) == 0' sempre √© verdadeira. </font><font style="vertical-align: inherit;">ByteViewerLayoutModel.java:66</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V6048</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esta express√£o pode ser simplificada. </font><font style="vertical-align: inherit;">O operando 'defaultGroupSizeSpace' na opera√ß√£o √© igual a 1. ByteViewerLayoutModel.java:66</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O visualizador de byte hexadecimal suporta a escolha do tamanho dos grupos exibidos: por exemplo, voc√™ pode configurar a sa√≠da no formato 'ffff ffff' ou 'ff ff ff ff'. O m√©todo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setFactorys</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© respons√°vel pela localiza√ß√£o desses grupos na interface do usu√°rio </font><font style="vertical-align: inherit;">. Apesar de a personaliza√ß√£o e a exibi√ß√£o funcionarem corretamente, o ciclo neste m√©todo parece extremamente suspeito: o restante da divis√£o por um √© sempre zero, o que significa que a coordenada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aumentar√° a cada itera√ß√£o. A suspeita adiciona propriedades e disponibilidade </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">groupSize</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na configura√ß√£o do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataModel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lixo restante ap√≥s a refatora√ß√£o? Ou talvez os </font><i><font style="vertical-align: inherit;">c√°lculos da</font></i><font style="vertical-align: inherit;"> vari√°vel </font><i><font style="vertical-align: inherit;">defaultGroupSizeSpace</font></i><font style="vertical-align: inherit;"> tenham sido perdidos</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">De qualquer forma, uma tentativa de substituir seu valor por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataModel.getGroupSize ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interrompeu o layout, e talvez apenas o autor desse c√≥digo possa dar uma resposta inequ√≠voca.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento 8: valida√ß√£o interrompida, parte 2</font></font></h2><br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">parseArrayDimensions</span><span class="hljs-params">(String datatype,
                                    List&lt;Integer&gt; arrayDimensions)</span> </span>{<font></font>
  String dataTypeName = datatype;<font></font>
  <span class="hljs-keyword">boolean</span> zeroLengthArray = <span class="hljs-keyword">false</span>;
  <span class="hljs-keyword">while</span> (dataTypeName.endsWith(<span class="hljs-string">"]"</span>)) {
    <span class="hljs-keyword">if</span> (zeroLengthArray) {                   <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// only last dimension may be 0</span><font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> rBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">']'</span>);
    <span class="hljs-keyword">int</span> lBracketPos = dataTypeName.lastIndexOf(<span class="hljs-string">'['</span>);
    <span class="hljs-keyword">if</span> (lBracketPos &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">int</span> dimension;
    <span class="hljs-keyword">try</span> {<font></font>
      dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                          rBracketPos));<font></font>
      <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span><font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">catch</span> (NumberFormatException e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
    }<font></font>
    dataTypeName = dataTypeName.substring(<span class="hljs-number">0</span>, lBracketPos).trim();<font></font>
    arrayDimensions.add(dimension);<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> dataTypeName;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aviso do PVS-Studio: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express√£o V6007 'zeroLengthArray' √© sempre falsa. PdbDataTypeParser.java:278 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse m√©todo analisa a dimens√£o de uma matriz multidimensional e retorna o texto restante ap√≥s a an√°lise ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para dados inv√°lidos. Um coment√°rio ao lado de uma das verifica√ß√µes de valida√ß√£o afirma que apenas o √∫ltimo tamanho de leitura pode ser zero. A an√°lise vai da direita para a esquerda, portanto, entende-se que '[0] [1] [2]' √© um texto de entrada v√°lido e '[2] [1] [0]' n√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, problema: ningu√©m adicionou a verifica√ß√£o de que o pr√≥ximo tamanho √© zero e o analisador consome dados inv√°lidos sem perguntas desnecess√°rias. Voc√™ provavelmente deve corrigir o bloco try da seguinte maneira:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">try</span> {<font></font>
  dimension = Integer.parseInt(dataTypeName.substring(lBracketPos + <span class="hljs-number">1</span>,<font></font>
                                                      rBracketPos));<font></font>
  <span class="hljs-keyword">if</span> (dimension &lt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>; <span class="hljs-comment">// invalid dimension</span>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (dimension == <span class="hljs-number">0</span>) {<font></font>
    zeroLengthArray = <span class="hljs-keyword">true</span>;<font></font>
  }<font></font>
}<font></font>
<span class="hljs-keyword">catch</span> (NumberFormatException e) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, existe a possibilidade de que esse crit√©rio de validade ao longo do tempo seja desnecess√°rio, ou o coment√°rio do autor tenha um significado diferente e √© necess√°rio verificar a leitura da primeira dimens√£o. </font><font style="vertical-align: inherit;">De qualquer forma, a valida√ß√£o de dados √© uma parte cr√≠tica de qualquer aplicativo, que deve ser assumida com total responsabilidade. </font><font style="vertical-align: inherit;">Os erros podem levar a falhas inofensivas do aplicativo, al√©m de falhas de seguran√ßa, vazamento de dados, corrup√ß√£o ou perda de dados (por exemplo, se voc√™ pular a inje√ß√£o de SQL durante a valida√ß√£o de consulta).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um pouco sobre o resto dos avisos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O leitor pode perceber que muitos avisos foram emitidos, mas poucos foram considerados. O cloc n√£o muito bem ajustado no projeto contou cerca de 1,25 milh√£o de linhas de c√≥digo Java (n√£o vazias e sem coment√°rios). O fato √© que quase todos os avisos s√£o extremamente semelhantes: aqui eles se esqueceram de verificar se h√° </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , n√£o exclu√≠ram o c√≥digo legado n√£o utilizado l√°. Eu realmente n√£o quero aborrecer o leitor listando a mesma coisa, e mencionei parte desses casos no in√≠cio do artigo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro exemplo s√£o os cinquenta avisos " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fun√ß√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">V6009</font></a><font style="vertical-align: inherit;"> recebe um argumento estranho" no contexto do uso impreciso do m√©todo de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">substring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CParserUtils.java:280, ComplexName.java:48 e outros) para obter o restante da sequ√™ncia ap√≥s qualquer separador. </font><font style="vertical-align: inherit;">Os desenvolvedores geralmente esperam que esse separador esteja presente na string e esquecem que, caso contr√°rio, o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> retornar√° -1, que √© um valor incorreto para a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">substring</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Naturalmente, se os dados foram validados ou recebidos n√£o de fora, a probabilidade de falha do aplicativo √© significativamente reduzida. </font><font style="vertical-align: inherit;">No entanto, em geral, esses s√£o lugares potencialmente perigosos dos quais queremos ajudar a nos livrar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, Ghidra est√° satisfeito com a qualidade do c√≥digo - nenhum pesadelo especial √© evidente. </font><font style="vertical-align: inherit;">O c√≥digo √© bem formatado e tem um estilo muito consistente: na maioria dos casos, vari√°veis, m√©todos e tudo o mais recebem nomes claros, coment√°rios explicativos s√£o encontrados, um grande n√∫mero de testes est√° presente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, n√£o houve problemas, entre os quais:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo morto, que, provavelmente, permaneceu ap√≥s in√∫meras refatora√ß√µes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muitos javadocs est√£o irremediavelmente desatualizados e, por exemplo, indicam par√¢metros inexistentes;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o h√° possibilidade de desenvolvimento conveniente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ao usar o IntelliJ IDEA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um sistema modular constru√≠do em torno da reflex√£o dificulta a navega√ß√£o em um projeto e a localiza√ß√£o de depend√™ncias entre os componentes.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por favor, n√£o negligencie as ferramentas do desenvolvedor. </font><font style="vertical-align: inherit;">A an√°lise est√°tica, como os cintos de seguran√ßa, n√£o √© uma panac√©ia, mas ajudar√° a evitar alguns desastres antes do lan√ßamento. </font><font style="vertical-align: inherit;">E ningu√©m gosta de usar o software conectado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode ler sobre outros projetos comprovados em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nosso blog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">E tamb√©m temos uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">licen√ßa de teste</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e v√°rias </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">op√ß√µes para</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usar o analisador sem a necessidade de pagar por isso.</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a></p><div style="text-align:center;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/eb2/f9c/3bb/eb2f9c3bb5f32f39239298d36431961c.png"></a></div><p></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ deseja compartilhar este artigo com um p√∫blico que fala ingl√™s, use o link para a tradu√ß√£o: Nikita Lazeba. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSA, Ghidra e Unic√≥rnios</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt504768/index.html">Est√°gio de analista em Yandex: an√°lise de tarefas de teste</a></li>
<li><a href="../pt504770/index.html">Distribui√ß√µes de jogos Linux</a></li>
<li><a href="../pt504772/index.html">Eventos digitais em Moscou, de 1 a 7 de junho</a></li>
<li><a href="../pt504774/index.html">Pesquisa com executivos de TI sobre mudan√ßas nas necessidades de servi√ßos de TI</a></li>
<li><a href="../pt504776/index.html">Escrevendo um mecanismo de jogo em seu primeiro ano: f√°cil! (Quase)</a></li>
<li><a href="../pt504784/index.html">O certificado raiz AddTrust do Sectigo expirou em 30 de maio de 2020, causando problemas nos clientes OpenSSL 1.0.xe GnuTLS</a></li>
<li><a href="../pt504786/index.html">Tudo o que voc√™ precisa saber sobre armazenamento em cache</a></li>
<li><a href="../pt504790/index.html">Uma sele√ß√£o de artigos sobre aprendizado de m√°quina: casos, guias e estudos para maio de 2020</a></li>
<li><a href="../pt504792/index.html">Pens√£o de servi√ßo. Como o NSPK salvou sua sala de servi√ßo de um coronav√≠rus</a></li>
<li><a href="../pt504796/index.html">Udalenka √© legal. Talvez fique para sempre?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>