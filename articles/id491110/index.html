<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßôüèæ üõ∂ üé∫ Konversi rtf ke xml dalam C # üë®‚Äç‚öñÔ∏è üë®üèø‚Äçüéì üóùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam kelanjutan dari serangkaian posting tentang mengkonversi file teks ke xml menggunakan C #, saya mengusulkan untuk pindah ke mengkonversi file rt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Konversi rtf ke xml dalam C #</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491110/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kelanjutan dari serangkaian posting tentang mengkonversi file teks ke xml menggunakan C #, saya mengusulkan untuk pindah ke mengkonversi file </font></font><strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rtf</font></font></em></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampaknya format ini sangat kuno, dan sangat umum, dan jika tidak ada pustaka untuk itu mengkonversi semua data ke format xml dengan memanggil satu metode, maka pasti ada semacam solusi dari Microsoft, setidaknya mirip dengan OpenXML . </font><font style="vertical-align: inherit;">Namun, jika ya, maka artikel ini tidak akan ditulis.</font></font></p><a name="habracut"></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi apa itu file </font></font><strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReachTextFile (rtf)</font></font></em></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">Pada umumnya, isi file sudah terstruktur dan bahkan mengingatkan pada campuran json, xml dan xpath. </font><font style="vertical-align: inherit;">Ini dapat dengan mudah diverifikasi dengan menyimpan beberapa dokumen Word dalam format </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rtf</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan kemudian mencoba membacanya dalam editor teks seperti </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notepad ++</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></p><br>
<p><img src="https://habrastorage.org/webt/8m/b3/li/8mb3li9-qvtjhwpdvf2ftbuhfim.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya menyoroti dalam merah sepotong file yang berisi informasi tentang pengkodean: secara umum, tag dienkripsi dengan pengkodean ansi, dan teks itu sendiri dikodekan dengan ansicpg1251. </font><font style="vertical-align: inherit;">Teks itu sendiri terlihat seperti ini:</font></font></p><br>
<p><img src="https://habrastorage.org/webt/ww/9o/1r/ww9o1rm_ou0vzllefyqgqm8wyc0.png"></p><br>
<p>, ,    ,    ,    ‚Ä¶ ,  ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a>,       ,   <em>php</em>. </p><br>
<p> ,      ,  ,     , , , ,           .      -  . </p><br>
<p>,    ,    ,   rtf   <code>RichTextBox</code>,      : </p><br>
<ul>
<li>-,     <code>Windows.Forms</code>,        . </li>
<li>-,         . , <code>RichTextBox</code>       ,      ,    .</li>
</ul><br>
<p>,   nuget   <strong><em>RtfPipe</em></strong>.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"></a>.</p><br>
<p> <em>RtfPipe</em>     .    <strong>rtf </strong> <strong>html</strong>.           ,         <em>HtmlAgilityPack</em>. </p><br>
<p>,        - ?    : <del> ,  </del>       ,  ,   ,    .     ,     rtf- , ,           ,     ,         ‚Äî , ,     ,   ,      ,    .</p><br>
<p>,   .</p><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-title">Convert</span>(<span class="hljs-params">Stream stream</span>)</span><font></font>
        {<font></font>
            stream.Position = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">string</span> rtf = <span class="hljs-keyword">string</span>.Empty;
            <span class="hljs-keyword">using</span> (StreamReader sr = <span class="hljs-keyword">new</span> StreamReader(stream))<font></font>
            {<font></font>
                rtf = sr.ReadToEnd();<font></font>
            }<font></font>
            <span class="hljs-comment">//      RtfPipe  Core </span><font></font>
            Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);<font></font>
            <span class="hljs-comment">//    RtfPipe  html</span>
            <span class="hljs-keyword">var</span> html = Rtf.ToHtml(rtf);
            <span class="hljs-comment">//  html     ,   xml</span>
            <span class="hljs-keyword">return</span> ClearHtml(html);<font></font>
        }</code></pre><br>
<ol>
<li>       string.       <code>RtfPipe</code>.  ,          </li>
<li>,      .Net Core <u> </u>    <code>Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);</code>.        RtfPipe.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"></a>.<br>
   .Net Framework,          .</li>
<li><code>var html = Rtf.ToHtml(rtf);</code> ‚Äî          html . ,    ,       ,      (     ),     .</li>
</ol><br>
<p><img src="https://habrastorage.org/webt/gi/a9/7x/gia97x3knsms05eekeqlv1nbtgi.png"></p><br>
<p>       <code>string ClearHtml(string html)</code>,     <em>xml</em>:</p><br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">string</span> <span class="hljs-title">ClearHtml</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> html</span>)</span><font></font>
{<font></font>
    <span class="hljs-comment">//  html   HtmlAgilityPack</span>
    HtmlDocument doc = <span class="hljs-keyword">new</span> HtmlDocument();<font></font>
    doc.LoadHtml(html);<font></font>
    <span class="hljs-comment">//    (),     style</span>
    <span class="hljs-keyword">var</span> elementsWithStyleAttribute = doc.DocumentNode.SelectNodes(<span class="hljs-string">"//@style"</span>);
    <span class="hljs-comment">//   ,    </span>
    <span class="hljs-keyword">var</span> excessNodes = doc.DocumentNode.SelectNodes(<span class="hljs-string">"//b|//u|//strong|//br"</span>);
    <span class="hljs-comment">//     html</span>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> excessNodes)<font></font>
    {<font></font>
        element.ParentNode.InnerHtml = element.InnerText;<font></font>
        element.Remove();<font></font>
    }<font></font>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> element <span class="hljs-keyword">in</span> elementsWithStyleAttribute)<font></font>
    {<font></font>
        element.Attributes[<span class="hljs-string">"style"</span>].Remove();<font></font>
    }<font></font>
    <span class="hljs-comment">//    html</span>
    <span class="hljs-keyword">using</span> (StringWriter writer = <span class="hljs-keyword">new</span> StringWriter())<font></font>
    {<font></font>
        doc.Save(writer);<font></font>
        html = writer.ToString();<font></font>
    }<font></font>
    <span class="hljs-comment">//   html  xml</span>
    StringBuilder xml = <span class="hljs-keyword">new</span> StringBuilder();<font></font>
    xml.Append(<span class="hljs-string">"&lt;?xml version=\"1.0\"?&gt;&lt;documents&gt;&lt;document&gt;"</span>);<font></font>
    xml.Append(html);<font></font>
    xml.Append(<span class="hljs-string">"&lt;/documents&gt;&lt;/document&gt;"</span>);
    <span class="hljs-keyword">return</span> xml.ToString();<font></font>
}</code></pre><br>
<ol>
<li> ,    HtmlAgilityPack  nuget</li>
<li>  <code>doc</code>  <code>HtmlDocument</code>     <code>html</code></li>
<li>   , ,     .  ,      <code>style</code>,      ,    ,    ,   .</li>
<li>C     ,   <code>StringBuilder</code>    xml,     .</li>
</ol><br>
<p>   , ,   ,   .</p><br>
<p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"></a></p><br>
<p>   <strong>docx</strong>  <strong>xlsx</strong>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id491100/index.html">Di Wanhao 5S, mereka mencetak boneka dengan tinggi seseorang</a></li>
<li><a href="../id491102/index.html">Bagaimana mengembangkan layanan ketika ada pesaing tangguh di sekitar</a></li>
<li><a href="../id491104/index.html">Bagaimana saya menemukan kesalahan perangkat keras pada tablet Lenovo MiiX 2 10 saya</a></li>
<li><a href="../id491106/index.html">Mengapa Anda perlu replikasi semi-sinkron?</a></li>
<li><a href="../id491108/index.html">Mengatur penyebaran ke banyak lingkungan k8 menggunakan helmfile</a></li>
<li><a href="../id491112/index.html">Jalan Menuju Kepolosan Jaringan - Cisco DNA</a></li>
<li><a href="../id491114/index.html">Relokasi cerdas atau cara memilih perusahaan untuk bekerja dan tidak menyesalinya</a></li>
<li><a href="../id491116/index.html">Standar Identifikasi Modern: OAuth 2.0, OpenID Connect, WebAuthn</a></li>
<li><a href="../id491118/index.html">Developer Heart: Devkits dari generasi ke-5 konsol (Bagian 1)</a></li>
<li><a href="../id491120/index.html">$ mol: 4 tahun kemudian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>