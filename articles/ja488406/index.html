<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝🏽 🏂🏿 🌺 IPv6-あなたはそれを間違っています 👨🏾‍✈️ 🕑 😈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPv6については、多くの誤解や神話があります。多くの場合、ホスティングプロバイダーは、その使用方法を誤解し、IPv4の世界からの古いアプローチを考えています。たとえば、数十億のIPv6アドレスがある場合、ホスティング事業者は、推奨事項から次のように、完全なネットワーク/ 64を割り当てる代わりに、...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IPv6-あなたはそれを間違っています</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/488406/"><img src="https://habrastorage.org/webt/gg/-1/kx/gg-1kxivqjrehg1_oidyoqkphos.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPv6については、多くの誤解や神話があります。多くの場合、ホスティングプロバイダーは、その使用方法を誤解し、IPv4の世界からの古いアプローチを考えています。たとえば、数十億のIPv6アドレスがある場合、ホスティング事業者は、推奨事項から次のように、完全なネットワーク/ 64を割り当てる代わりに、クライアントに個別にアドレスを販売します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホスティング業者は、同じ/ 64ネットワーク内の異なるクライアントにIPv6アドレスを割り当てることがあります。同時に、Googleなどの大規模なサービスは、/ 64の範囲内のすべてのアドレスを1つのクライアントとして認識します。その結果、バンドメイトの活動により、お客様が苦しむ可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IPv6アドレスを使用できるため、完全な外部アドレスをコンテナやVPNクライアントなどの内部リソースに割り当てることができます。</font><font style="vertical-align: inherit;">これを行うには、ホストがクライアントに個別のルーティングされたネットワークを提供する必要があります。</font><font style="vertical-align: inherit;">残念ながら、ほとんど誰もこれを行うことができません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、IPv6プロバイダーの使用における主なエラーを分析します。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストーリーライン：RFC 3177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 2001年に、強調するために推奨されたアドレスの割り当てに関する推奨事項（トートロジーでは申し訳ありませんが、これは重要です）：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/一般的に48</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 64背後にある場合は1つのサブネットのみ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 128デバイスが1つだけの場合</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
：次のように指示に強制準拠のさまざまなレベルのアプリケーションを支配する攻撃的な文書のRFC 2119には、定義は、「推奨」</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、しかし、この方法で動作の異なるラインの選択を行動していない特定の状況では合理的な理由があるかもしれないことを意味する「推奨」言葉「SHOULD」かを結果を十分に理解して行われたバランスの取れた決定でなければなりません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく誰もその時の結果を完全に理解しておらず、おそらく「特定の状況」が定義されていなかったかもしれませんが、いずれにせよ、誰もが推奨事項に従いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般に、このドキュメントの執筆時点では、IPv6トラフィックは非常にまれであり、ほとんどの場合、研究所や好奇心旺盛な個人のネットワークで発見されました。</font><font style="vertical-align: inherit;">いくつかの実際の問題が蓄積し、分析し始めましたが、それは長い時間がかかりました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再考は2005年に始まりました。</font><font style="vertical-align: inherit;">最後に、これらの推奨事項は2011年に廃止されました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題の認識：RFC 6177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいアドレス指定ポリシーでは、/ 48は単なる希望であり、要件ではないと明記しています。具体的な数値の表記はありませんが、通常の状態では/ 64以下で動作することを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブロックの発行サイズを推奨する主なロジック/ 48は、最終消費者に3つの目標を追求しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、割り当てられたアドレス空間は、消費者の目的に十分であり、バーベルスクワットなしで簡単に拡張できる必要があります。はい、それはまさにそれが言うことです、英語版でのみ-フープを飛び越えます。 IPv6に切り替える重要な理由の1つは、既存の宛先サイズを「単一アドレス」から「複数サブネット」に変更することです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二に、プロバイダーの変更は最小限の問題で保持されるべきでした。</font><font style="vertical-align: inherit;">新しいアドレススペースに移動するときに古いサブネットアドレススキームを保存できる場合、これにより多くの作業を節約でき</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ます。3番目に、ブロック/ 48の割り当ては、開発中のコンシューマーのアドレススペースのニーズの増加をカバーする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの条件はすべて満たされましたが、推奨/ 48は、控えめに言っても冗長であることが明らかになりました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題の単位としてのピン/ 64</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配布順序に加えて、他のポイントがありました。</font><font style="vertical-align: inherit;">ネットワークプレフィックスが/ 64でない場合、IPv6の多くの機能が機能しないことがわかりました。</font><font style="vertical-align: inherit;">つまり、これらは機能しません。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">近隣探索（ND）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secure Neighborship Discovery（SEND）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モバイルIPv6の一部</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPv6仲介によるサイトマルチホーミング</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くの異なる小さなこと</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加の要因は、設計されているテクノロジーの多くがそのようなネットワークプレフィックスに正確に依存しているという事実でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新たな基準を破る脅威だけでなく、新しい推奨事項を作成する理由にもなりました。</font><font style="vertical-align: inherit;">疑わしい妥当性についての2つの意見も非常に人気がありました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、多くのデバイスは、松葉杖や自転車を使用してIPv6ルーティングをプログラムで実装しているため、完全に移行する準備が整っていません。</font><font style="vertical-align: inherit;">これによる遅延の可能な増加は、1桁ではないにしても、何倍も増加する可能性があります。</font><font style="vertical-align: inherit;">/ 64サブネットのデフォルトの定義により、これらの遅延が大幅に削減されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二に、新しい標準に切り替えることは、常にテクニカルサポートとシステム管理者にとって苦痛です。</font><font style="vertical-align: inherit;">単一の/ 64プレフィックスは、この痛みを許容できる値に減らすはずでした。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正面の状況</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2001年の初めにすでに起こったように、勧告/ 64は多くの大規模なインターネットプレーヤーによって標準として認識されています。一方でそれは良いことであり、他方ではそれほど良くありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの評価システム、たとえばスパム認識では、1つのブロックのすべてのアドレスが1人のスパマーに属すると見なされます。理論的には、これはユーザーの生活をより簡単にするはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの場合、プロバイダーは一般的な慣行について学ぶようなことを気にしません。住所は、少なくとも星占いであっても、任意の原則に従って発行できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかの典型的な問題があり、それらのすべては、一方ではプロバイダーによる推奨事項への違反、および他方ではいくつかの他の組織によるそれらの厳格な遵守から生じます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1つのブロックから複数のユーザーにアドレスを発行すると、それらすべてが1つの実際のユーザー（組織のネットワーク内のマシンなど）と見なされることになる可能性があります。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このブロックの複数の人々が同時に猫を探し始めた場合、Googleは、このボットネットが検索詐欺またはその他のあまり良くないもののリクエストを送信すると決定する場合があります。彼の観点から、これはすべて1人のユーザーです。論理的な結果はますます複雑なキャプチャです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご存じのとおり、これは架空の詐欺に対する最も無害な答えです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
逆の状況は、異なるブロックからのアドレスを1人のユーザーに発行することです。</font><font style="vertical-align: inherit;">これらのブロックのユーザーが誰かのブラックリストに分類される場合、正直なユーザーのアドレスはそれらに分類されます。</font><font style="vertical-align: inherit;">特に興味深い話：ある広告ネットワークによって禁止されているアドレスもあれば、別の広告ネットワークによって禁止されているアドレスもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、他の不愉快な驚きが可能です。</font><font style="vertical-align: inherit;">たとえば、/ 64ブロックを受け取りましたが、これは動的アドレスとして動的ブロックです-今日2001：DA8：1D01：FA13 :: / 64、明日2001：DA8：1D01：FC15 :: / 64。</font><font style="vertical-align: inherit;">毎日新しい冒険！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
付属肢のこれらの問題と他の空想的に湾曲したレーキのさまざまな組み合わせに遭遇するかなりのチャンスがあります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーからIPv6を発行する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数千のIPアドレスがある場合は、VPNクライアントなどに実際のIPアドレスを付与して、NATなしでインターネットにアクセスし、世界中からの着信接続を受け入れることができるようにしてください。</font><font style="vertical-align: inherit;">すばらしいように聞こえますが、実際にはそれほど簡単ではありません。</font><font style="vertical-align: inherit;">これには</font><font style="vertical-align: inherit;">、サーバーインターフェイスに割り当てられ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IPアドレス</font><b><font style="vertical-align: inherit;">を介して</font></b><font style="vertical-align: inherit;">ルーティングされる別のIPv6ネットワークが必要です</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーにアドレスが割り当てられているとする</font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、VPNクライアントには</font></font><code>2a01:baba:fafa:0f0f::/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、そのアドレスを介してルーティングされる</font><font style="vertical-align: inherit;">など、別のネットワークが必要に</font><font style="vertical-align: inherit;">なります</font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、このようなネットワークをクライアントに発行するツールを備えているホスティングプロバイダーはほとんどないため、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NDプロキシ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの松葉杖を使用する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IETFの推奨事項を読むことは、最も興味深い活動ではありませんが、非常に役立ちます。</font><font style="vertical-align: inherit;">それらを長い冬の夜で満たすことは明らかに価値がありませんが、あなたにとって重要なセクションを読むことを怠ることも望ましくありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロバイダーを選択するときは、彼がこの観点を共有していることを確認してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アドレスの割り当てに対する誤ったアプローチはプロバイダーに害を及ぼさないことを理解する必要があります。ほとんどの契約では、それが補償の基礎になることすらできません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、あなた自身はまだ疑っていませんが、これはあなたにとって重要な要素になるかもしれません。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488386/index.html">ネットワーク異常分析ツールの適用事例：ブラウザープラグインによる攻撃</a></li>
<li><a href="../ja488388/index.html">再ログインとHTTP基本認証</a></li>
<li><a href="../ja488390/index.html">OpenId ConnectでTelegramボットの友達を作る方法</a></li>
<li><a href="../ja488392/index.html">k8sのプロダクション対応イメージ</a></li>
<li><a href="../ja488404/index.html">2020年に待つ価値のあるゲーム</a></li>
<li><a href="../ja488408/index.html">STM32 Ethernet-RS485 IoTゲートウェイ</a></li>
<li><a href="../ja488410/index.html">開発の10年で学んだ7つの教訓</a></li>
<li><a href="../ja488412/index.html">discord.jsに基づくDiscordボットの作成</a></li>
<li><a href="../ja488416/index.html">SLAE-Security Linux Assembly Expert Exam</a></li>
<li><a href="../ja488418/index.html">Spring SecurityとMongoDBを使用したREST API認証</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>