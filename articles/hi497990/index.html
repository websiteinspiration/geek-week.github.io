<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЧ╛я╕П ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСз ЁЯСйЁЯП╜тАНЁЯПн PostgreSQL: C рднрд╛рд╖рд╛ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди (рдлрд╝рдВрдХреНрд╢рди) рдХрд╛ рд╡рд┐рдХрд╛рд╕ ЁЯШЙ ЁЯОВ ЁЯдЩЁЯП╛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рд▓реЗрдЦ рдХреБрдЫ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рдерд╛ рдХрд┐ рдЗрд╕реЗ рдХрд╣рд╛рдБ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рднреВрд▓ рдЧрдпрд╛ред 
 
 рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдПрд╕рдХреНрдпреВрдПрд▓ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди (рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдб) тАЛтАЛ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>PostgreSQL: C рднрд╛рд╖рд╛ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди (рдлрд╝рдВрдХреНрд╢рди) рдХрд╛ рд╡рд┐рдХрд╛рд╕</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tensor/blog/497990/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рд▓реЗрдЦ рдХреБрдЫ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рдерд╛ рдХрд┐ рдЗрд╕реЗ рдХрд╣рд╛рдБ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рднреВрд▓ рдЧрдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдПрд╕рдХреНрдпреВрдПрд▓ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди (рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдб) тАЛтАЛрднрд╛рд╖рд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╕рдордп рд╕реА рднрд╛рд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрд░реНрде рджреЛ рдмрд┐рдВрджреБрдУрдВ: рдкреНрд░рджрд░реНрд╢рди рдФрд░ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рддрдХ рдХрдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдмрд╕, рд╕реА рдореЗрдВ рд▓рд┐рдЦрд╛ рдХреЛрдб рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рдХрд╛рдо рдХрд░реЗрдЧрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рддреНрдпреЗрдХ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ рд▓рд╛рдЦ рдмрд╛рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдХреБрдЫ PostgreSQL рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ C рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рдореЗрдВ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ, рдкреНрд░рдХрд╛рд░ (рд╡рд┐рд╢реЗрд╖рдХрд░ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдорд╛рди </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><strong><font style="vertical-align: inherit;">AnyELEMENT</font></strong><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANYARRAY</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VARIADIC рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ рд╣реИрдВ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд░рд▓ рд╕реА рдлрд╝рдВрдХреНрд╢рди</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдЬреЛ рджреЛ рддрд░реНрдХ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрджрд╛рд╣рд░рдг PostgreSQL рдХреЗ рд▓рд┐рдП рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдереЛрдбрд╝рд╛ рд╕реБрдзрд╛рд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕реЗ рдПрдХрддреНрд░ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдлрд┐рд░ PostgreSQL рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдВ рдФрд░ SQL рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдХреЙрд▓ рд▓рд┐рдЦреЗрдВред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"postgres.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"fmgr.h"</span></span><font></font>
PG_MODULE_MAGIC;<font></font>
PG_FUNCTION_INFO_V1(add_ab);<font></font>
<span class="hljs-function">Datum <span class="hljs-title">add_ab</span><span class="hljs-params">(PG_FUNCTION_ARGS)</span>
</span>{<font></font>
    int32 arg_a = PG_GETARG_INT32(<span class="hljs-number">0</span>);<font></font>
    int32 arg_b = PG_GETARG_INT32(<span class="hljs-number">1</span>);<font></font>
    PG_RETURN_INT32(arg_a + arg_b);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add_func.c</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдлрд╝рд╛рдЗрд▓ </font><font style="vertical-align: inherit;">рдХреЛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирд╛</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include "postgresql.h": рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рдЗрд╕ рд╣реЗрдбрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдмреБрдирд┐рдпрд╛рджреА рдкреНрд░рдХрд╛рд░ рдФрд░ рдХрд╛рд░реНрдп рд╢рд╛рдорд┐рд▓ рд╣реИрдВред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include "fmgr.h": рд╣реЗрдбрд░ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди PG_ * рдореИрдХреНрд░реЛрдЬрд╝ рд╣реЛрддреЗ рд╣реИрдВред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG_MODULE_MAGIC: рдПрдХ рдореИрдХреНрд░реЛ рдЬреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рд╕рдВрд╕реНрдХрд░рдг 8.2 рд╕реЗ рдКрдкрд░ PostgreSQL рдХреЗ рд▓рд┐рдП рдПрдХ рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG_FUNC_INFO_V1: PostgreSQL рдХреЗ рднреАрддрд░ рдПрдХ рдореИрдХреНрд░реЛ рдбрд┐рдлрд╛рдЗрдирд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓рд┐рдВрдЧ рдХрдиреНрд╡реЗрдВрд╢рдиред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдЗрд╕рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдШреЛрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрд╕реНрдХрд░рдг 0, рдЕрдиреНрдпрдерд╛ рд╕рдВрд╕реНрдХрд░рдг 1 рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдкрд░ рдПрдХ рд╕рдордЭреМрддрд╛ рд╣реЛрдЧрд╛ред</font></font></li>
<li>Datum:   . ,     PostgreSQL. -  VARIANT  Microsoft.     ┬л┬╗   - .   ,   .</li>
<li>add_ab(PG_FUNCTION_ARGS):   .    - . ,       .</li>
<li>int32 arg_a = PG_GETARG_INT32(0):       (  ).</li>
<li>PG_RETURN_INT32(arg_a + arg_b):           .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдореЗрдВ рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдФрд░ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЙрдЯрдкреБрдЯ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп (* .so) рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдХрдлрд╛рдЗрд▓ рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдкреНрд░рд▓реЗрдЦрди рдЙрди рдХреБрдВрдЬрд┐рдпреЛрдВ рдФрд░ рд░рд╛рд╕реНрддреЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PGXS</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХрддреНрд░ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рдбреЗрд╡рд▓рдкрд░реНрд╕, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рддрд╛рд╡рд░рдг рд╣реИ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-dev</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-devel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PostgreSQL рдХреЗ рд▓рд┐рдП рд╕рдВрдХреБрд▓ </font><font style="vertical-align: inherit;">рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="bash hljs">MODULES = add_func<font></font>
PG_CONFIG = pg_config<font></font>
PGXS := $(shell $(PG_CONFIG) --pgxs)<font></font>
include $(PGXS)<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо SQL рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рддреЗ рд╣реИрдВ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдПрдХ SQL рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦреЗрдВрдЧреЗ рдЬрд┐рд╕реЗ рд╣рдорд╛рд░реЗ рдкрд╣рд▓реЗ рд╕реЗ рдмрдирд╛рдП рдЧрдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> <span class="hljs-keyword">add</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>)
  <span class="hljs-keyword">RETURNS</span> <span class="hljs-built_in">int</span>
<span class="hljs-keyword">AS</span> <span class="hljs-string">'/usr/lib/postgresql/9.4/lib/add_func'</span>, <span class="hljs-string">'add_ab'</span>
<span class="hljs-keyword">LANGUAGE</span> C <span class="hljs-keyword">STRICT</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╕ рдЗрддрдирд╛ рд╣реА! </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рдкрдирд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рд╕реНрдерд╛рдкрдирд╛ рдХреЛ рдереЛрдбрд╝рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдЬрдм рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рдкрддрд╛ рди рд╣реЛ рдХрд┐ PostgreSQL рдХрд╛ рдХреМрди рд╕рд╛ рд╕рдВрд╕реНрдХрд░рдг рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХрд┐рд╕ рддрд░реАрдХреЗ рд╕реЗ рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрди рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ,</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> <span class="hljs-keyword">add</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>)
  <span class="hljs-keyword">RETURNS</span> <span class="hljs-built_in">int</span>
<span class="hljs-keyword">AS</span> <span class="hljs-string">'MODULE_PATHNAME'</span>, <span class="hljs-string">'add_ab'</span>
<span class="hljs-keyword">LANGUAGE</span> C <span class="hljs-keyword">STRICT</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдХрдлрд╛рдЗрд▓ рдореЗрдВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ </font><font style="vertical-align: inherit;">рдкрдВрдХреНрддрд┐ </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗрдВ </font><font style="vertical-align: inherit;">,</font></font><br>
<br>
<pre><code class="bash hljs">MODULES = add_func<font></font>
DATA_built = add_funcs.sql<font></font>
PG_CONFIG = pg_config<font></font>
PGXS := $(shell $(PG_CONFIG) --pgxs)<font></font>
include $(PGXS)<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдереЛрдбрд╝рд╛ рд╕реБрдзрд╛рд░ рдХрд░реЛ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдЕрдкрдиреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХреБрдЫ рдмрджрд▓рд╛рд╡ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреБрдЫ рд╕реБрдзрд╛рд░ рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд░реНрдХ рдХреА рдЬрд╛рдБрдЪ</font></font></h3><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add (int, int)</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдлрд╝рдВрдХреНрд╢рди рдХреА SQL рдкрд░рд┐рднрд╛рд╖рд╛ рдореЗрдВ рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ </font><font style="vertical-align: inherit;">рд╣рдордиреЗ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STRICT</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреАрд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрджрд┐ рдХрдо рд╕реЗ рдХрдо рдПрдХ рддрд░реНрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL рд╣реИ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рддреЛ рдлрд╝рдВрдХреНрд╢рди рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдФрд░ рдмрд╕ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ SQL рдХрдердиреЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдСрдкрд░реЗрдЯрд░ рдореЗрдВ </font><font style="vertical-align: inherit;">рдХрдо рд╕реЗ рдХрдо рдПрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд░реНрдХ </font><font style="vertical-align: inherit;">рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рдкрд░рд┐рдгрд╛рдо </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣реЛрдЧрд╛ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо SQL рдПрдХрддреНрд░реАрдХрд░рдг рдлрд╝рдВрдХреНрд╢рди </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреЛрдЧ () рдХреЗ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рди рд╣рдорд╛рд░реЗ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдПрдХ рддрд░реНрдХ рдЬрд╛рдВрдЪ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдЬреЛ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдиреЛрдВ рдХреА рдЙрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ </font><em><font style="vertical-align: inherit;">рд╣реИ</font></em><font style="vertical-align: inherit;"> рдФрд░ рдХрд╛рдо рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдХреЛрдИ рддрд░реНрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL рд╣реЛ</font></font></em></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рджреЛрдиреЛрдВ рддрд░реНрдХ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL рд╣реИрдВ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рддреЛ </font><em><font style="vertical-align: inherit;">NULL</font></em><font style="vertical-align: inherit;"> рд╡рд╛рдкрд╕ рдХрд░реЗрдВ</font></font><em><font style="vertical-align: inherit;"></font></em></li>
</ul><br>
<pre><code class="cpp hljs">PG_FUNCTION_INFO_V1(add_ab_null);
<span class="hljs-function">Datum <span class="hljs-title">add_ab_null</span><span class="hljs-params">(PG_FUNCTION_ARGS)</span>
</span>{<font></font>
    int32 not_null = <span class="hljs-number">0</span>;<font></font>
    int32 sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!PG_ARGISNULL(<span class="hljs-number">0</span>))<font></font>
    {<font></font>
        sum += PG_GETARG_INT32(<span class="hljs-number">0</span>);<font></font>
        not_null = <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (!PG_ARGISNULL(<span class="hljs-number">1</span>))<font></font>
    {<font></font>
        sum += PG_GETARG_INT32(<span class="hljs-number">1</span>);<font></font>
        not_null = <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (not_null)<font></font>
    {<font></font>
        PG_RETURN_INT32(sum);<font></font>
    }<font></font>
    PG_RETURN_NULL();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдм рдЗрд╕реЗ рджреЗрдЦреЗрдВ,</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> <span class="hljs-keyword">add</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">int</span>)
 <span class="hljs-keyword">RETURNS</span> <span class="hljs-built_in">int</span>
<span class="hljs-keyword">AS</span> <span class="hljs-string">'$libdir/add_func'</span>, <span class="hljs-string">'add_ab_null'</span>
<span class="hljs-keyword">LANGUAGE</span> C;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">add</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>) <span class="hljs-keyword">AS</span> must_be_null, <span class="hljs-keyword">add</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> must_be_one;<font></font>
-[ RECORD 1 ]+<span class="hljs-comment">--</span><font></font>
must_be_null |<font></font>
must_be_one  | 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдпрд╣рд╛рдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдорд╛рдирдХ PostgreSQL рдЯреВрд▓ рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ,</font></font><br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> (<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> (a <span class="hljs-keyword">IS</span> <span class="hljs-literal">null</span>) <span class="hljs-keyword">AND</span> (b <span class="hljs-keyword">IS</span> <span class="hljs-literal">null</span>)<font></font>
(<span class="hljs-keyword">THEN</span> <span class="hljs-literal">null</span>
<span class="hljs-keyword">ELSE</span> <span class="hljs-keyword">coalesce</span>(a, <span class="hljs-number">0</span>) + <span class="hljs-keyword">coalesce</span>(b,<span class="hljs-number">0</span>)
<span class="hljs-keyword">END</span>)
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>::<span class="hljs-built_in">int</span> <span class="hljs-keyword">AS</span> a, <span class="hljs-literal">null</span>::<span class="hljs-built_in">int</span> <span class="hljs-keyword">AS</span> b) s;<font></font>
-[ RECORD 1 ]<font></font>
 case | 1<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреЛрдИ рднреА рддрд░реНрдХ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦрд╛ рдерд╛, рд╣рдордиреЗ рддрд░реНрдХреЛрдВ рдХрд╛ рдореВрд▓реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдХреНрд░реЛрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХрд┐рд╕реА рднреА рддрд░реНрдХ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрдирдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдПрдХ рд▓реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ,</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (!PG_ARGISNULL(i))<font></font>
{<font></font>
    sum += PG_GETARG_INT32(i);<font></font>
    not_null = <span class="hljs-number">1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдкрдХреЗ рдкрд╛рд╕ рддреБрд░рдВрдд рдПрдХ рдкреНрд░рд╢реНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рддрд░реНрдХреЛрдВ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рдгреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рд╡рд╣реА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ PostgreSQL рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╕реНрдореГрддрд┐ рдкреНрд░рдмрдВрдзрдХ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдХрд╛рд░рдг, рдпрд╣ рдРрд╕рд╛ рдХреЛрдИ рддреБрдЪреНрдЫ рдХрд╛рд░реНрдп рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд╣рд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">PostgreSQL рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди рдореЗрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬрд╣рд╛рдВ рдЯреЗрдХреНрд╕реНрдЯ [] рдХреИрд░реЗрдХреНрдЯрд░ рдРрд░реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдареАрдХ рд╡реИрд╕рд╛ рдирд╣реАрдВ рд╣реИ рдЬреИрд╕рд╛ рд╣рдореЗрдВ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЕрдкрдиреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ,</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"utils/array.h"</span>     <span class="hljs-comment">//       </span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"catalog/pg_type.h"</span> <span class="hljs-comment">// INT4OID</span></span><font></font>
PG_MODULE_MAGIC;<font></font>
<span class="hljs-function">Datum <span class="hljs-title">add_int32_array</span><span class="hljs-params">(PG_FUNCTION_ARGS)</span></span>;<font></font>
PG_FUNCTION_INFO_V1(add_int32_array);<font></font>
<span class="hljs-function">Datum <span class="hljs-title">add_int32_array</span><span class="hljs-params">(PG_FUNCTION_ARGS)</span>
</span>{
    <span class="hljs-comment">//     .</span>
    <span class="hljs-comment">//          ,       int.</span><font></font>
    ArrayType *input_array;<font></font>
    int32 sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">bool</span> not_null = <span class="hljs-literal">false</span>;<font></font>
<font></font>
    Datum *datums;<font></font>
    <span class="hljs-keyword">bool</span> *nulls;
    <span class="hljs-keyword">int</span> count;
    <span class="hljs-keyword">int</span> i;<font></font>
    input_array = PG_GETARG_ARRAYTYPE_P(<span class="hljs-number">0</span>); <span class="hljs-comment">//     .  *_P  </span>
                                            <span class="hljs-comment">//        ,   INT32</span><font></font>
<font></font>
    <span class="hljs-comment">//          INT32 (INT4)</span><font></font>
    Assert(ARR_ELEMTYPE(input_array) == INT4OID);<font></font>
<font></font>
    <span class="hljs-comment">//      </span>
    <span class="hljs-keyword">if</span> (ARR_NDIM(input_array) &gt; <span class="hljs-number">1</span>)<font></font>
        ereport(ERROR, (errcode(ERRCODE_ARRAY_SUBSCRIPT_ERROR), errmsg(<span class="hljs-string">"1-dimensional array needed"</span>)));<font></font>
<font></font>
    deconstruct_array(input_array, <span class="hljs-comment">//  </span>
                      INT4OID,     <span class="hljs-comment">//  </span>
                      <span class="hljs-number">4</span>,           <span class="hljs-comment">//    </span>
                      <span class="hljs-literal">true</span>,        <span class="hljs-comment">// int4   </span>
                      <span class="hljs-string">'i'</span>,         <span class="hljs-comment">//  'i'</span>
                      &amp;datums, &amp;nulls, &amp;count); <span class="hljs-comment">//   </span><font></font>
<font></font>
    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; count; i++)<font></font>
    {<font></font>
        <span class="hljs-comment">//     </span>
        <span class="hljs-keyword">if</span> (nulls[i])
            <span class="hljs-keyword">continue</span>;<font></font>
<font></font>
        <span class="hljs-comment">// ,       </span><font></font>
        sum += DatumGetInt32(datums[i]);<font></font>
        not_null = <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (not_null)<font></font>
        PG_RETURN_INT32(sum);<font></font>
<font></font>
    PG_RETURN_NULL();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдЖрдЗрдП рдХреЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓рддреЗ рд╣реИрдВ,</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрд░реНрдгрд╛рдВрдХ рд╕рд░рдгрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рдХрд╛рд░ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArrayType рдХрд╛</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдЬреЛ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд░рдгреА рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЗ рд╕рд╛рде рд╕рд░рдгреА рдХреЛ рдЖрд░рдореНрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рд╡рд┐рд╢реЗрд╖ рдореИрдХреНрд░реЛ </font><em><font style="vertical-align: inherit;">PG_GETARG_ARRAYTYPE_P рдХрд╛</font></em><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛</font></font><em><font style="vertical-align: inherit;"></font></em></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╕рд░рдгреА рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдЖрдпрд╛рдореА ARR_NDIM рд╣реИ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int4 (= 23) рдХреЗ рд▓рд┐рдП OID рдкреНрд░рдХрд╛рд░ рдХреЛ INT4OID рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк SQL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">select</span> <span class="hljs-keyword">oid</span>, typlen, typbyval, typalign <span class="hljs-keyword">from</span> pg_type
<span class="hljs-keyword">where</span> typname = <span class="hljs-string">'int4'</span>;<font></font>
-[ RECORD 1 ]<font></font>
oid | 23<font></font>
typlen | 4<font></font>
typbyval | t<font></font>
typalign | i<font></font>
</code></pre><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдореЗрдВ рдмрд╕ PostgreSQL рдХреЛ рдПрдХ рд╕рдорд╛рд░реЛрд╣ [рдПрдХ] рддрд░реНрдХ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рдХреЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд┐рдЦрд╛рдирд╛ рд╣реЛрдЧрд╛,]</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> <span class="hljs-keyword">FUNCTION</span> add_arr(<span class="hljs-built_in">int</span>[]) <span class="hljs-keyword">RETURNS</span> <span class="hljs-built_in">int</span>
<span class="hljs-keyword">AS</span> <span class="hljs-string">'$libdir/add_func'</span>, <span class="hljs-string">'add_int32_array'</span>
<span class="hljs-keyword">LANGUAGE</span> C <span class="hljs-keyword">STRICT</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЬрд╛рдБрдЪ рдХрд░реЗрдВ</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> add_arr(<span class="hljs-string">'{1,2,3,4,5,6,7,8,9}'</span>);<font></font>
-[ RECORD 1 ]<font></font>
add_arr | 45<font></font>
<span class="hljs-keyword">SELECT</span> add_arr(<span class="hljs-built_in">ARRAY</span>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-literal">NULL</span>]);<font></font>
-[ RECORD 1 ]<font></font>
add_arr | 3<font></font>
<span class="hljs-keyword">SELECT</span> add_arr(<span class="hljs-built_in">ARRAY</span>[<span class="hljs-literal">NULL</span>::<span class="hljs-built_in">int</span>]);<font></font>
-[ RECORD 1 ]<font></font>
add_arr |<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреБрд╢рдВрд╕рд╛рдПрдБ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЖрдЗрдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдореБрдЦреНрдп рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВред</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдореГрддрд┐ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQL DBMS рдХреЗ рд▓реЗрдЦрдХ рдФрд░ рдирд┐рд░реНрдорд╛рддрд╛ рд╕реНрдореГрддрд┐ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдФрд░ рд▓реАрдХ рдХреЛ рд░реЛрдХрдиреЗ рдкрд░ рд╡рд┐рд╢реЗрд╖ рдзреНрдпрд╛рди рджреЗрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ DBMS рдФрд░ рдЗрд╕рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмреБрдирд┐рдпрд╛рджреА рдирд┐рдпрдореЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрдирдХреЗ рдЕрдкрдиреЗ рдирд┐рд░реНрдгрдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ - рд╕реНрдореГрддрд┐ рдХрд╛ рд╕рдВрджрд░реНрднред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреИрд▓реЛрдХ () рдФрд░ pfree () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PostgreSQL рдХреЗ рд╕рднреА рдореЗрдореЛрд░реА рд╡рд░реНрдХ рдореЗрдВ рдиреЙрди-рд╕реНрдЯреИрдВрдбрд░реНрдб рдлрд╝рдВрдХреНрд╢рдВрд╕ palloc () рдФрд░ pfree () рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдкреНрд░рд╛рд░рдВрдн</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдореЗрд╢рд╛ рдирдИ рдШреЛрд╖рд┐рдд рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреЙрд▓ рдкреЗрд▓реЛрдХ () рдХреЗ рдмрд╛рдж рдореЗрдорд╕реЗрдЯ ()ред</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдиреЗрдХреНрдЯреЗрдб рдлрд╝рд╛рдЗрд▓реЗрдВ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдкрдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рджреЛ рдлрд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП: postgres.h рдФрд░ fmgr.h.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧреА рдХрдбрд╝рд┐рдпрд╛рдБ</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL: рд╕рд░реНрд╡рд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЗрдВрдЯрд░рдлрд╝реЗрд╕</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PostgreSQL: C </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">PostgreSQL рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдиреЗрдЯрд╡рд░реНрдХ </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд╛рд░реНрдп</font></a></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi497980/index.html">рдХрд┐рддрдирд╛ рдкрд╛рдиреА рд▓реАрдХ рд╣реБрдЖ рд╣реИ? рд╣рдо рд╣рд╛рд╕реНрдХреЗрд▓ рдкрд░ рдПрдХ рдЪрд╛рдБрджрд╡реЙрдХ рджреНрд╡рд╛рд░рд╛ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi497982/index.html">рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдгред рдХреИрд╕реЗ рдФрд░ рдХреНрдпрд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░реЗрдВ?</a></li>
<li><a href="../hi497984/index.html">Cloudflare рдореЗрдВ reCAPTCHA рд╕реЗ hCaptcha рдореЗрдВ рдорд╛рдЗрдЧреНрд░реЗрдЯ рдХрд░рдирд╛</a></li>
<li><a href="../hi497986/index.html">рд╡реЗрдмрдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рднреА рдореЗрдореЛрд░реА рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛: performance.measureMemory ()</a></li>
<li><a href="../hi497988/index.html">рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдкреНрд░рджрд░реНрд╢рди рд░реВрдкрд░реЗрдЦрд╛</a></li>
<li><a href="../hi497994/index.html">рднрд╛рд╖рд╛ рдпрд╛рдВрддреНрд░рд┐рдХреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рдмрдЪрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi497996/index.html">рдЖрдк рдкреНрд░рддрд┐рд░рдХреНрд╖рд╛ рдХреЛ рдордЬрдмреВрдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдпрд╛ рдорд╛рдирд╡ рд╢рд░реАрд░ рдХреА рдЪрд░рдо рд╕реАрдорд╛</a></li>
<li><a href="../hi498000/index.html">рдЪреАрдЬреЗрдВ рдореИрдВ рдЕрдкрдиреЗ рдЦреЗрд▓ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛</a></li>
<li><a href="../hi498002/index.html">Z3 рдХреЗ рд▓рд┐рдП рдкреЙрдХреЗрдЯ рдЧрд╛рдЗрдб</a></li>
<li><a href="../hi498004/index.html">рдПрдХ рдбреЙрдХрдЯрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>