<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛳️ ✍🏿 ⛅️ プロバイダーNATの背後でのVPNサーバーの開始 🧒 ☯️ 🈳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="この記事では、ホームプロバイダーのNAT（白いIPアドレスなし）の背後でVPNサーバーを起動する方法について説明します。この実装のパフォーマンスは、プロバイダーだけでなくルーターによって使用されるNATのタイプにも直接依存することを、すぐに言っておく必要があります。
 そのため、Androidスマー...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>プロバイダーNATの背後でのVPNサーバーの開始</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482888/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、ホームプロバイダーのNAT（白いIPアドレスなし）の背後でVPNサーバーを起動する方法について説明します。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この実装</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">パフォーマンスは、プロバイダーだけでなくルーターによって使用されるNATのタイプにも直接依存する</font></b><font style="vertical-align: inherit;">ことを、</font><b><font style="vertical-align: inherit;">すぐに</font></b><font style="vertical-align: inherit;">言っておく必要があり</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、Androidスマートフォンから自宅のコンピューターに接続する必要がありました。両方のデバイスはプロバイダーのNATを介してインターネットに接続されています。さらに、コンピューターはNAT接続を備えたホームルーターを介して接続されています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホワイトIPアドレスでリースされたVPS / VDSを使用する従来のスキーム、およびプロバイダーからホワイトIPアドレスをレンタルすることは、いくつかの理由で考慮されませんでした。</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前の記事</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">経験に</font></a><font style="vertical-align: inherit;">基づいて、</font><font style="vertical-align: inherit;">STUNおよびNATプロバイダーでいくつかの実験を行った。</font><font style="vertical-align: inherit;">OpenWRTファームウェアで実行されているホームルーターでコマンドを実行して、小さな実験を行うことにしました。</font></font><br>
<pre><code class="bash hljs">$ stun stun.sipnet.ru</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果を得た：</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STUNクライアントバージョン0.97 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プライマリ：独立したマッピング、独立したフィルター、ランダムポート、ヘアピン</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
戻り値は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x000002</font></font></b></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リテラル変換：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独立したマッピング-独立した表示</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
独立したフィルター-独立したフィルター</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ランダムポート-ランダムポート</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はヘアピン-ヘアピンがあります</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PCで同様のコマンドを実行すると、次のようになります。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STUNクライアントバージョン0.97 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プライマリ：独立マッピング、ポート依存フィルター、ランダムポート、ヘアピンになります</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
戻り値は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x000006です</font></font></b></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポート依存フィルター-ポート依存フィルター</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドの出力の違いは、ホームルーターが「インターネットからのパケットのブロードキャストプロセスに貢献したことを示しています。これは、コマンドがコンピューターで実行されたときに明らかになりました。</font></font><br>
<pre><code class="bash hljs">stun stun.sipnet.ru -p 11111 -v</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は結果を得ました：</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MappedAddress = XX.1XX.1X4.2XX：4398 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
...</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この時点で、UDPセッションがしばらく開かれ、その時点でUDP要求が送信された場合（例：netcat XX.1XX.1X4.2XX 4398 -u）、要求はホームルーターに到達しました。これは、TCPDumpで実行されていることが確認されましたが、リクエストがコンピューターに到達しなかった-IPtablesはNATトランスレーターとしてルーターにドロップしました。</font></font><br>
<img src="https://habrastorage.org/webt/3y/4f/ly/3y4flytej3u2dzjbcgtjgk_af8s.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、UDP要求がISP NATを通過したという事実は、成功への希望を与えました。ルーターは私の管轄内にあるので、UDP / 11111ポートをコンピューターにリダイレクトすることで問題を解決しました。</font></font><pre><code class="bash hljs">iptables -t nat -A PREROUTING -i eth1 -p udp -d 10.1XX.2XX.XXX --dport 11111 -j DNAT --to-destination 192.168.X.XXX</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、私はUDPセッションを開始し、任意のIPアドレスからインターネットから要求を受信する機会を得ました。</font><font style="vertical-align: inherit;">この時点で、UDP / 11111ポートをリッスンしているOpenVPNサーバーを（構成後）起動しました。スマートフォンには、外部IPアドレスとポート（XX.1XX.1X4.2XX：4398）が示され、スマートフォンからコンピューターに正常に接続されました。</font><font style="vertical-align: inherit;">しかし、この実装では、問題が発生しました。OpenVPNクライアントがサーバーに接続されるまで、UDPセッションを維持する必要がありました。定期的にSTUNクライアントを起動するオプションは好きではありませんでした。STUNサーバーを無駄に使いたくありませんでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エントリー「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウィルヘアピン-ヘアピンがある</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">も</font></a><font style="vertical-align: inherit;">注目を集めた</font><font style="vertical-align: inherit;">このモード</font></font><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘアピニングにより、ローカルネットワーク上の1台のマシンがNATを使用して、ルーターの外部アドレスにある同じネットワーク上の別のマシンにアクセスできます。</font></font></blockquote><br>
<img src="https://habrastorage.org/getpro/habr/post_images/3d0/d9e/d3f/3d0d9ed3f65fcf1f89fde59d4d012eec.jpg" alt="画像"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、UDPセッションを維持するという問題は単純に解決されました。サーバーと同じコンピューターでクライアントを起動しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはこのように機能しました：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ローカルポート11111でSTUNクライアントを起動しました</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外部IPアドレスとポートXX.1XX.1X4.2XXを含む応答を受信しました：4398</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スマートフォンで構成された外部IPアドレスとポートを使用してデータをメールに送信（他のサービスは可能）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UDP / 11111ポートがリスニングしているコンピュータでOpenVPNサーバーを起動しました</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピューターにOpenVPNクライアントを起動し、XX.1XX.1X4.2XX：4398と表示された</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いつでもスマートフォンでOpenVPNクライアントを開始し、IPアドレスとポート（私の場合、IPアドレスは変更されませんでした）を使用して接続しました</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/j3/kt/h0/j3kth0tlfmce8agogmo4cfva57o.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようにして、スマートフォンからコンピューターに接続する機会を得ました。</font><font style="vertical-align: inherit;">この実装により、任意のOpenVPNクライアントに接続できます。</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">練習</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要になるだろう： </font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># apt install openvpn stun-client sendemail</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかのスクリプト、いくつかの構成ファイルを記述し、必要な証明書を生成した後（スマートフォンのクライアントは証明書でのみ機能するため）、OpenVPNサーバーの通常の実装が得られました。 </font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピューターのメインスクリプト</font></font></h3><br>
<pre><code class="bash hljs"><span class="hljs-comment"># cat vpn11.sh</span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
until [[ -n <span class="hljs-string">"<span class="hljs-variable">$iftosrv</span>"</span> ]]; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-subst">$(date)</span>   "</span>; iftosrv=`ip route get 8.8.8.8 | head -n 1 | sed <span class="hljs-string">'s|.*dev ||'</span> | awk <span class="hljs-string">'{print $1}'</span>`; sleep 5; <span class="hljs-keyword">done</span>
ABSOLUTE_FILENAME=`readlink -f <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>`<font></font>
DIR=`dirname <span class="hljs-string">"<span class="hljs-variable">$ABSOLUTE_FILENAME</span>"</span>`<font></font>
localport=11111<font></font>
until [[ <span class="hljs-variable">$a</span> ]]; <span class="hljs-keyword">do</span>
	address=`stun stun.sipnet.ru -v -p <span class="hljs-variable">$localport</span> 2&gt;&amp;1 | grep <span class="hljs-string">"MappedAddress"</span> | sort | uniq | head -n 1 | sed <span class="hljs-string">'s/:/ /g'</span> | awk <span class="hljs-string">'{print $3" "$4}'</span>`<font></font>
        ip=`<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$address</span>"</span> | awk {<span class="hljs-string">'print $1'</span>}`<font></font>
        port=`<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$address</span>"</span> | awk {<span class="hljs-string">'print $2'</span>}`<font></font>
	srv=<span class="hljs-string">"openvpn --config <span class="hljs-variable">$DIR</span>/server.conf --port <span class="hljs-variable">$localport</span> --daemon"</span>
	<span class="hljs-variable">$srv</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-subst">$(date)</span>      <span class="hljs-variable">$ip</span>:<span class="hljs-variable">$port</span>"</span>
	<span class="hljs-variable">$DIR</span>/sendemail.sh <span class="hljs-string">"OpenVPN-Server"</span> <span class="hljs-string">"<span class="hljs-variable">$ip</span>:<span class="hljs-variable">$port</span>"</span><font></font>
	sleep 1<font></font>
	openvpn --config <span class="hljs-variable">$DIR</span>/client.conf --remote <span class="hljs-variable">$ip</span> --port <span class="hljs-variable">$port</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-subst">$(date)</span> C    "</span>
	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `ps xa | grep <span class="hljs-string">"<span class="hljs-variable">$srv</span>"</span> | grep -v grep | awk <span class="hljs-string">'{print $1}'</span>`; <span class="hljs-keyword">do</span>
		<span class="hljs-built_in">kill</span> <span class="hljs-variable">$i</span> &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-subst">$(date)</span>    <span class="hljs-variable">$i</span> (<span class="hljs-variable">$srv</span>)"</span>
		<span class="hljs-keyword">done</span>
	<span class="hljs-built_in">echo</span> <span class="hljs-string">" 15 "</span><font></font>
	sleep 15<font></font>
	<span class="hljs-keyword">done</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メールにデータを送信するためのスクリプト：</font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># cat sendemail.sh </span></code></pre><br>
<pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
from=<span class="hljs-string">" "</span>
pass=<span class="hljs-string">""</span>
to=<span class="hljs-string">""</span>
theme=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
message=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>
server=<span class="hljs-string">"smtp.yandex.ru:587"</span>
sendEmail -o tls=yes -f <span class="hljs-string">"<span class="hljs-variable">$from</span>"</span> -t <span class="hljs-string">"<span class="hljs-variable">$to</span>"</span> -s <span class="hljs-string">"<span class="hljs-variable">$server</span>"</span> -xu <span class="hljs-string">"<span class="hljs-variable">$from</span>"</span> -xp <span class="hljs-string">"<span class="hljs-variable">$pass</span>"</span> -u <span class="hljs-string">"<span class="hljs-variable">$theme</span>"</span> -m <span class="hljs-string">"<span class="hljs-variable">$message</span>"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバー構成ファイル：</font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># cat server.conf</span></code></pre><br>
<pre><code class="plaintext hljs">proto udp<font></font>
dev tun<font></font>
ca      /home/vpn11-srv/ca.crt<font></font>
cert    /home/vpn11-srv/server.crt<font></font>
key     /home/vpn11-srv/server.key<font></font>
dh      /home/vpn11-srv/dh2048.pem<font></font>
server 10.2.0.0 255.255.255.0<font></font>
ifconfig-pool-persist ipp.txt<font></font>
tls-server<font></font>
tls-auth /home/vpn11-srv/ta.key 0<font></font>
tls-timeout 60<font></font>
auth    SHA256<font></font>
cipher  AES-256-CBC<font></font>
client-to-client<font></font>
keepalive 10 30<font></font>
comp-lzo<font></font>
max-clients 10<font></font>
user nobody<font></font>
group nogroup<font></font>
persist-key<font></font>
persist-tun<font></font>
log /var/log/vpn11-server.log<font></font>
verb 3<font></font>
mute 20</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアント構成ファイル：</font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># cat client.conf</span></code></pre><br>
<pre><code class="plaintext hljs">client<font></font>
dev tun<font></font>
proto udp<font></font>
ca      "/home/vpn11-srv/ca.crt"<font></font>
cert    "/home/vpn11-srv/client1.crt"<font></font>
key     "/home/vpn11-srv/client1.key"<font></font>
tls-client<font></font>
tls-auth "/home/vpn11-srv/ta.key" 1<font></font>
auth SHA256<font></font>
cipher AES-256-CBC<font></font>
auth-nocache<font></font>
comp-lzo<font></font>
user nobody<font></font>
group nogroup<font></font>
persist-key<font></font>
persist-tun<font></font>
log /var/log/vpn11-clent.log<font></font>
verb 3<font></font>
mute 20<font></font>
ping 10<font></font>
ping-exit 30</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
証明書の生成は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトの実行：</font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># ./vpn11.sh</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実行可能にした後 </font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># chmod +x vpn11.sh</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スマートフォンの横</font></font></h3><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android用</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font><b><font style="vertical-align: inherit;">OpenVPN</font></b><font style="vertical-align: inherit;">アプリケーション</font><b><font style="vertical-align: inherit;">を</font></b><font style="vertical-align: inherit;">インストール</font><font style="vertical-align: inherit;">し、構成ファイルと証明書をコピーして設定すると、次のようになります。</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スマホでメールチェック</font></font></b><div class="spoiler_text"><img width="300" src="https://habrastorage.org/webt/2g/ff/ay/2gffay6w5q3mlicrafi6co-lx2m.jpeg"><br>
</div></div><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定でポート番号を修正する</font></font></b><div class="spoiler_text"><img width="300" src="https://habrastorage.org/webt/hy/an/u1/hyanu1irl8esgsagi1-j6f67cae.jpeg"><br>
</div></div><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントを起動して接続します</font></font></b><div class="spoiler_text"><img width="300" src="https://habrastorage.org/webt/v9/0_/8g/v90_8gw3qmrvhdaiqalfuulej8k.jpeg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事を書いている最中に、構成をコンピューターからRaspberry Pi 3に転送し、すべてをLTEモデムで実行しようとしましたが、うまくいきませんでした。</font><font style="vertical-align: inherit;">チームの結果</font></font><br>
<pre><code class="bash hljs"><span class="hljs-comment"># stun stun.ekiga.net -p 11111</span></code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STUNクライアントバージョン0.97 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プライマリ：独立マッピング、ポート依存フィルター、ランダムポート、ヘアピンになります</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
戻り値は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x000006です</font></font></b><br>
</blockquote><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port Dependent Filterの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値</font><font style="vertical-align: inherit;">により、システムを起動できませんでした。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、何の問題もなく自宅のプロバイダは、ラズベリーパイ3.上のシステムの実行をさせる</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ためのVLCと、ウェブカメラと組み合わせて</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebカメラからRTSPストリームを作成する</font></font></b><div class="spoiler_text"><pre><code class="bash hljs">$ cvlc v4l2:///dev/video0:chroma=h264 :input-slave=alsa://hw:1,0 --sout <span class="hljs-string">'#transcode{vcodec=x264,venc=x264{preset=ultrafast,profile=baseline,level=31},vb=2048,fps=12,scale=1,acodec=mpga,ab=128,channels=2,samplerate=44100,scodec=none}:rtp{sdp=rtsp://10.2.0.1:8554/}'</span> --no-sout-all --sout-keep</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スマートフォン用のVLC（rtspストリーム：//10.2.0.1：8554 /）を使用すると、離れた場所でもビデオ監視システムが悪くないことがわかりました。Sambaを上げてファイルを交換し、VPN経由でトラフィックをルーティングすることもできます。 </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンピュータをリモート制御する</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/pw/rs/ny/pwrsnya9zl6l99nn4dwbqtqrtbi.png"></div></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などなど…</font></font><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実例で示したように、VPNサーバーを整理するために、外部IPアドレスを支払う必要がなく、レンタルしたVPS / VDSも必要ありません。</font><font style="vertical-align: inherit;">しかし、それはすべてプロバイダーに依存します。</font><font style="vertical-align: inherit;">もちろん、さまざまなプロバイダーと使用されているNATのタイプについての詳細を知りたいと思っていましたが、これはほんの始まりにすぎ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ません</font><font style="vertical-align: inherit;">... </font><font style="vertical-align: inherit;">ご清聴ありがとうございました！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482876/index.html">ヨーロッパの中心にある世帯の自分のニーズに合わせた太陽光発電のコストの計算</a></li>
<li><a href="../ja482878/index.html">「製品」の定義を検索した方法</a></li>
<li><a href="../ja482882/index.html">電磁ブレーキとしてのモーター</a></li>
<li><a href="../ja482884/index.html">夜のレッスン：構文の強調表示を書く</a></li>
<li><a href="../ja482886/index.html">ハブラ分析：出版の長さは重要ですか？</a></li>
<li><a href="../ja482892/index.html">Let vs const-何を使うべきですか？</a></li>
<li><a href="../ja482894/index.html">WaveFunctionCollapseアルゴリズムと事前確率分布を使用した適応型手続き型生成</a></li>
<li><a href="../ja482896/index.html">OSCP-私の経験</a></li>
<li><a href="../ja482898/index.html">モスクワのプロの燃え尽きの歴史-1996年から2017年まで。国営企業のトップマネージャーから研究者までの道のり</a></li>
<li><a href="../ja482900/index.html">オンラインでの自動マーチャンダイジング、または自転車の発明方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>