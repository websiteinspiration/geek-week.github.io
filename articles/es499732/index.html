<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüë¶ üßöüèº üôÄ Desarrollo de blockchain para la industria en marcha. Parte 1 üçñ üèÇüèø üë®üèº‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante cuatro meses, he estado trabajando en un proyecto llamado "Desarrollo de herramientas de seguridad y gesti√≥n de datos basadas en blockchain en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de blockchain para la industria en marcha. Parte 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499732/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durante cuatro meses, he estado trabajando en un proyecto llamado "Desarrollo de herramientas de seguridad y gesti√≥n de datos basadas en blockchain en el gobierno y la industria". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora me gustar√≠a hablar sobre c√≥mo comenc√© este proyecto, y ahora describir√© el c√≥digo del programa en detalle.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/319/86b/9a5/31986b9a5079081f4eb87335330d119c.jpg" alt="imagen"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este es el primer art√≠culo de una serie de art√≠culos. Aqu√≠ describo el servidor y el protocolo. De hecho, el lector puede incluso escribir sus propias versiones de estos elementos blockchain. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero la segunda parte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trata sobre las estructuras de datos de blockchain y las transacciones, as√≠ como sobre el paquete que implementa la interacci√≥n con la base de datos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El a√±o pasado, en el hackathon Digital Break, plantearon la idea de que para la industria y la econom√≠a digital para crear un sistema √∫til para la tecnolog√≠a de los registros distribuidos, el Fondo de Asistencia para la Innovaci√≥n tambi√©n emiti√≥ una subvenci√≥n para el desarrollo (sobre la subvenci√≥n, deber√≠a escribir un art√≠culo separado para aquellos que reci√©n comienzan a hacer startups ), y ahora en orden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El desarrollo se lleva a cabo en Go, y la base de datos en la que se almacenan los bloques es LevelDB.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las partes principales son el protocolo, el servidor (que ejecuta TCP y WebSocket: el primero para sincronizar la cadena de bloques, el segundo para conectar clientes, enviar transacciones y comandos desde JavaScript, por ejemplo).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se mencion√≥, esta cadena de bloques se necesita principalmente para automatizar y proteger el intercambio de productos entre proveedores y clientes, o ambos en una sola persona. No tienen prisa por confiar el uno en el otro. Pero la tarea no es solo hacer una "chequera" con una calculadora incorporada, sino un sistema con automatizaci√≥n de la mayor√≠a de las tareas de rutina que surgen cuando se trabaja con el ciclo de vida del producto. El c√≥digo de bytes que es responsable de este negocio, como es habitual en blockchains, se almacena en las entradas y salidas de las transacciones (las transacciones en s√≠ mismas est√°n en bloques, los bloques en LevelDB est√°n precodificados en el formato GOB). Primero, hablemos sobre el protocolo y el servidor (tambi√©n conocido como nodo).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El protocolo no funciona duro, su objetivo es cambiar al modo de carga de algunos datos, generalmente un bloque o transacci√≥n, en respuesta a una l√≠nea de comando especial, y tambi√©n lo necesita para intercambiar inventario para que el nodo sepa a qui√©n est√° conectado y c√≥mo tienen cosas que hacer (los nodos conectados para la sesi√≥n de sincronizaci√≥n tambi√©n se denominan "vecinos" porque se conoce su IP y sus datos de estado se almacenan en la memoria). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las carpetas (directorios como los llama Linux) se denominan paquetes en la comprensi√≥n de los programadores de Go, por lo que al comienzo de cada archivo con Go-code de este directorio al principio escriben el paquete folder_name_where_sit_this_file. </font><font style="vertical-align: inherit;">De lo contrario, el paquete no se puede alimentar al compilador. </font><font style="vertical-align: inherit;">Bueno, esto no es un secreto para quienes conocen este idioma. </font><font style="vertical-align: inherit;">Estos paquetes son:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Redes (servidor, cliente, protocolo)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Estructuras de datos almacenados y transmitidos (bloque, transacci√≥n)</font></font></li>
<li>   (blockchain)</li>
<li>  (consensus)</li>
<li>    (xvm)</li>
<li>  (crypto, types)  .</li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ hay un enlace a github:</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
esta es una versi√≥n de capacitaci√≥n, carece de comunicaci√≥n entre procesos y varios componentes experimentales, para los cuales la estructura corresponde a la que se est√° desarrollando. </font><font style="vertical-align: inherit;">Si tiene algo que contar en los comentarios, con mucho gusto tendr√© en cuenta el desarrollo posterior. </font><font style="vertical-align: inherit;">Y ahora para el servidor y los paquetes de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, eche un vistazo al servidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La rutina del servidor act√∫a como un servidor de datos que se ejecuta sobre el protocolo TCP utilizando estructuras de datos del paquete de protocolos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La rutina usa los siguientes paquetes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servidor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El paquete en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√≠</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiene la estructura de datos </font><i><font style="vertical-align: inherit;">tcp_server.go </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Serve <span class="hljs-keyword">struct</span> {<font></font>
	Port <span class="hljs-keyword">string</span>
	BufSize <span class="hljs-keyword">int</span><font></font>
	ST *types.Settings<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede tomar los siguientes par√°metros:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Puerto de red a trav√©s del cual se intercambiar√°n datos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Archivo de configuraci√≥n del servidor JSON</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indicador de ejecuci√≥n en modo de depuraci√≥n (blockchain privado)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Progreso:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leer la configuraci√≥n del archivo JSON</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se marca el indicador de modo de depuraci√≥n: si est√° configurado, entonces el programador de sincronizaci√≥n de red no se inicia y la cadena de bloques no se carga</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Inicializando la estructura de datos de configuraci√≥n e iniciando el servidor</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servidor</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Inicia el servidor TCP y la comunicaci√≥n de red de acuerdo con el protocolo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiene una estructura de datos de servicio que consta de un n√∫mero de puerto, un tama√±o de b√∫fer y un puntero a los </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos.</font></font></i></li>
<li>  Run    (     ,           handle   )</li>
<li>  <i>handle</i>      ,        <i>protocol.Choice</i></li>
<li> <i>protocol.Choice</i>  <i>result</i>   . <i>result</i>    <i>protocol.Interprete</i>,   <i>intrpr</i> ‚Äî   <i>InterpreteData</i>,      </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luego, el interruptor es ejecutado por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Commands [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el que se verifica uno de los siguientes: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultado, inv, error</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y hay una secci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">predeterminada</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la secci√≥n de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultados</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">hay un cambio por el valor de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Commands [1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que verifica los valores de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bufferlength</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (en cada caso se llama a la funci√≥n correspondiente)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las </font><i><font style="vertical-align: inherit;">funciones </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BufferLength</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se encuentran en el archivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">srvlib.go</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del paquete del servidor.</font></font><br>
<br>
<pre><code class="go hljs">GetVersion(conn net.Conn, version <span class="hljs-keyword">string</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
simplemente imprime en la consola y env√≠a al cliente la versi√≥n pasada en el par√°metro: </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:"</span> + version))</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funci√≥n</font></font><br>
<br>
<pre><code class="go hljs">BufferLength(conn net.Conn, intrpr *protocol.InterpreteData)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
realiza la carga de un bloque, transacci√≥n u otros datos espec√≠ficos de la siguiente manera:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Imprime en la consola el tipo de datos especificado en el protocolo que debe aceptarse: </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-string">"DataType:"</span>, intrpr.Commands[<span class="hljs-number">2</span>])</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lee el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Body</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la variable num√©rica </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buf_len</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crea un b√∫fer </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newbuf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><font style="vertical-align: inherit;">tama√±o especificado:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, buf_len)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Env√≠a una respuesta correcta: </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:ok"</span>))</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Produce un b√∫fer completo a partir de la secuencia de lectura: </font></font><br>
<br>
<pre><code class="go hljs">io.ReadFull(conn, newbuf)</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Imprime el contenido del b√∫fer en la consola. </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-keyword">string</span>(newbuf))</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y el n√∫mero de bytes le√≠dos </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-string">"Bytes length:"</span>, n)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Env√≠a una respuesta correcta: </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:ok"</span>))</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los m√©todos del paquete del servidor est√°n configurados de tal manera que procesan los datos recibidos con funciones del paquete del </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protocolo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El protocolo sirve como una herramienta que presenta datos durante la comunicaci√≥n de red. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choice (cadena de cadena) (cadena, error)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> realiza el procesamiento inicial de los datos recibidos por el servidor, recibe una representaci√≥n de cadena de los datos y devuelve la cadena preparada para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interpretar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cadena de entrada se divide en cabeza y cuerpo usando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReqParseN2 (str)</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la cabeza se divide en elementos y se coloca en el segmento de comandos usando ReqParseHead (cabeza)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interruptor (comandos [0])</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seleccionamos el comando recibido ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmd, clave, direcci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o se activa la secci√≥n </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">predeterminada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cmd, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verifican</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2 </font><i><font style="vertical-align: inherit;">comandos de cambio (comandos [1]): longitud</font></i><font style="vertical-align: inherit;"> y </font><i><font style="vertical-align: inherit;">getversion</font></i><font style="vertical-align: inherit;"> .</font></font></li>
<li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">length</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comprueba el tipo de datos en los </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comandos [2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y los almacena en el </font><i><font style="vertical-align: inherit;">tipo</font></i><font style="vertical-align: inherit;"> de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">datos</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprueba que el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuerpo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiene un valor de cadena</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-built_in">len</span>(body) &lt; <span class="hljs-number">1</span></code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Devuelve una cadena de respuesta: </font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-string">"result:bufferlength:"</span> + datatype + <span class="hljs-string">"/"</span> + body</code></pre></li>
<li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getversion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devuelve una cadena</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">return</span> <span class="hljs-string">"result:version/auto"</span></code></pre></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interpretar</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contiene la estructura InterpreteData y realiza el procesamiento secundario de la </font><font style="vertical-align: inherit;">cadena </font><font style="vertical-align: inherit;">devuelta por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choice</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la formaci√≥n del objeto </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> InterpreteData <span class="hljs-keyword">struct</span> {<font></font>
	Head <span class="hljs-keyword">string</span>
	Commands []<span class="hljs-keyword">string</span>
	Body <span class="hljs-keyword">string</span>
	IsErr <span class="hljs-keyword">bool</span>
	ErrCode <span class="hljs-keyword">int</span> 
	ErrMessage <span class="hljs-keyword">string</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funci√≥n </font></font><br>
<br>
<pre><code class="go hljs">Interprete(str <span class="hljs-keyword">string</span>) (*InterpreteData, error)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
acepta el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultado de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la cadena </font><font style="vertical-align: inherit;">y crea una referencia al objeto </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Progreso:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Del mismo modo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choice</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recupera la cabeza y el cuerpo usando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReqParseN2 (str)</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la cabeza se divide en elementos usando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReqParseHead (cabeza)</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El objeto </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se inicializa </font><font style="vertical-align: inherit;">y se devuelve un puntero al mismo:</font></font></li>
</ul><br>
<pre><code class="go hljs">res := &amp;InterpreteData{<font></font>
	Head: head,<font></font>
	Commands: commands,<font></font>
	Body: body,<font></font>
}<font></font>
<span class="hljs-keyword">return</span> res, <span class="hljs-literal">nil</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este objeto se usa en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server.go</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del paquete principal.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El paquete del cliente contiene las </font><i><font style="vertical-align: inherit;">funciones </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPConnect</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPResponseData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funci√≥n</font></font><br>
<br>
<pre><code class="go hljs">TCPConnect(s *types.Settings, data []<span class="hljs-keyword">byte</span>, payload []<span class="hljs-keyword">byte</span>)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
funciona de la siguiente manera:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se realiza una conexi√≥n a la conexi√≥n especificada en el objeto de configuraci√≥n transferido </font></font><br>
<br>
<pre><code class="go hljs">net.Dial(<span class="hljs-string">"tcp"</span>, s.Host + <span class="hljs-string">":"</span> + s.Port)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Los datos pasados ‚Äã‚Äãen el par√°metro de datos se transfieren: </font></font><br>
<br>
<pre><code class="go hljs">conn.Write(data)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leer respuesta </font></font><br>
<br>
<pre><code class="go hljs">resp, n, _ := TCPResponseData(conn, s.BufSize)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e impreso en la consola </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-keyword">string</span>(resp[:n]))</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carga √∫til</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se transmite, se transmite</font></font><br>
<br>
<pre><code class="go hljs">conn.Write(payload)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y tambi√©n lee la respuesta del servidor, imprimi√©ndola en la consola</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funci√≥n</font></font><br>
<br>
<pre><code class="go hljs"> TCPResponseData(conn net.Conn, bufsiz <span class="hljs-keyword">int</span>) ([]<span class="hljs-keyword">byte</span>, <span class="hljs-keyword">int</span>, error)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
crea un b√∫fer del tama√±o especificado, lee la respuesta del servidor all√≠ y devuelve este b√∫fer y la cantidad de bytes le√≠dos, as√≠ como un objeto de error.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rutina del cliente</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sirve para transmitir comandos a los servidores del nodo, as√≠ como para obtener breves estad√≠sticas y pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede tomar los siguientes par√°metros: un archivo de configuraci√≥n en formato JSON, datos que se transmitir√°n al servidor como una cadena, una ruta al archivo para enviar a la carga √∫til, un indicador de emulaci√≥n de planificador de nodo, el tipo de datos que se transferir√°n como un valor num√©rico.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Obt√©n la configuraci√≥n </font></font><br>
<br>
<pre><code class="go hljs">st := types.ParseConfig(*config)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si te dan una bandera de la UEM, comienza el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">programador</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si se especifica el indicador f que indica la ruta al archivo, cargue sus datos en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fdb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y env√≠e el contenido al servidor</font></font><br>
<br>
<pre><code class="go hljs">client.TCPConnect(st, []<span class="hljs-keyword">byte</span>(CMD_BUFFER_LENGTH + <span class="hljs-string">":"</span> + strconv.Itoa(*t) + <span class="hljs-string">"/"</span> + strconv.Itoa(fdblen)), fdb)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si no se especifica el archivo, los datos del indicador </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simplemente se env√≠an </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="go hljs">client.TCPConnect(st, []<span class="hljs-keyword">byte</span>(*data), <span class="hljs-literal">nil</span>)</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo esto es una vista simplificada que muestra la estructura del protocolo. </font><font style="vertical-align: inherit;">Durante el desarrollo, la funcionalidad necesaria se agrega a su estructura. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la segunda parte, hablar√© sobre las estructuras de datos para bloques y transacciones, en 3 sobre un servidor WebSocket para conectarse desde JavaScript, en 4 consideraremos un planificador de sincronizaci√≥n, luego una m√°quina de pila que procesa el c√≥digo de bytes de las entradas y salidas, la criptograf√≠a y los grupos de salida.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es499714/index.html">Mundo, c√≥digo, mayo: pasamos vacaciones con informes √∫tiles</a></li>
<li><a href="../es499718/index.html">Entendemos los protocolos VPN</a></li>
<li><a href="../es499720/index.html">Libro de ejercicios de TypeScript</a></li>
<li><a href="../es499722/index.html">De Babel a GraphQL: HolyJS 2019 Moscow Talks</a></li>
<li><a href="../es499728/index.html">Empleos en Google. De Ucrania a Silicon Valley</a></li>
<li><a href="../es499736/index.html">Lo que se ense√±a en el M√°ster en Ingenier√≠a de Software en St. Petersburg HSE</a></li>
<li><a href="../es499740/index.html">"Fuga" de una base de especialistas Habr Careers</a></li>
<li><a href="../es499742/index.html">Tipo de denegaci√≥n de servicio: c√≥mo progresa DDoS</a></li>
<li><a href="../es499744/index.html">Cloud Security Alarm Security Hub</a></li>
<li><a href="../es499750/index.html">C√≥mo escanear todo Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>