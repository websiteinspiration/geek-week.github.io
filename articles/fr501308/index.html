<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèæ üë± üñïüèæ Nous essayons de comprendre StateFlow ü§ôüèæ üò• üëè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. 
 
 Il y a quelques jours, JetBrains a publi√© une nouvelle version de Corutin - 1.3.6 et l'une des innovations a √©t√© la nouvelle sous-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Nous essayons de comprendre StateFlow</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501308/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour √† tous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelques jours, JetBrains a publi√© une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nouvelle version de Corutin - 1.3.6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l'une des innovations a √©t√© la nouvelle sous-esp√®ce de Flow - StateFlow, qui remplace ConflatedBroadcastChannel. </font><font style="vertical-align: inherit;">J'ai d√©cid√© d'essayer StateFlow en action et d'√©tudier la structure interne.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense que beaucoup de ceux qui utilisent Kotlin lors du d√©veloppement pour Android ou MPP connaissent ces termes, qui ne le sont pas - ces entit√©s sont des analogues proches de BehaviorProcessor / BehaviorSubject de RxJava et LiveData / MutableLiveData de Jetpack. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
StateFlow lui-m√™me est une simple extension de l'interface Flow et se pr√©sente sous deux formes:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StateFlow</span>&lt;<span class="hljs-type">out T</span>&gt; : <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">T</span>&gt; </span>{
    <span class="hljs-comment">/**
     * The current value of this state flow.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> value: T<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">MutableStateFlow</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">StateFlow</span>&lt;<span class="hljs-type">T</span>&gt; </span>{
    <span class="hljs-comment">/**
     * The current value of this state flow.
     *
     * Setting a value that is [equal][Any.equals] to the previous one does nothing.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'id√©e est la m√™me que dans LiveData / MutableLiveData - via une interface, elle ne peut lire que l'√©tat actuel, et via l'autre, elle peut √©galement √™tre install√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-ce que StateFlow nous offre par rapport √† ConflatedBroadcastChannel:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Une impl√©mentation interne plus simple et sans d√©chets. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La n√©cessit√© d'un √©l√©ment par d√©faut. </font><font style="vertical-align: inherit;">Null est √©galement possible.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S√©paration en interfaces en lecture seule et en lecture-√©criture. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comparer des √©l√©ments via l'√©galit√© au lieu de comparer des liens. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essayons maintenant d'impl√©menter une utilisation simple de StateFlow. </font><font style="vertical-align: inherit;">Pour ce faire, j'ai cr√©√© un wrapper √©l√©mentaire avec la possibilit√© de d√©finir n'importe quel type avec un √©l√©ment null par d√©faut:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StateFlowRepository</span>&lt;<span class="hljs-type">T</span>&gt;</span>(initialValue: T? = <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> stateFlow = MutableStateFlow(initialValue)<font></font>
<font></font>
    <span class="hljs-keyword">var</span> value: T?
        <span class="hljs-keyword">get</span>() = stateFlow.value
        <span class="hljs-keyword">set</span>(value) {<font></font>
            stateFlow.value = value<font></font>
        }<font></font>
<font></font>
    <span class="hljs-keyword">val</span> stream: Flow&lt;T?&gt; = stateFlow<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous obtenons les donn√©es:</font></font><br>
<br>
<pre><code class="kotlin hljs">lifecycleScope.launch {<font></font>
            simpleRepo.stream.collect {<font></font>
                addData(it.toString())<font></font>
            }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et nous affichons sur l'√©cran avec l'interface la plus simple pour les tests, cela ne pose aucun probl√®me et tout fonctionne comme une horloge: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/cv/_c/pncv_c41cwncgwkfc3hd3wxzfh0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
maintenant regardons √† l'int√©rieur et voyons comment il est impl√©ment√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä ma grande surprise, la mise en ≈ìuvre est vraiment tr√®s simple et ne prend actuellement que 316 lignes, dont 25% de javadoki. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et donc, la classe d'impl√©mentation principale est la classe StateFlowImpl:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StateFlowImpl</span>&lt;<span class="hljs-type">T</span>&gt;</span>(initialValue: Any) : SynchronizedObject(), MutableStateFlow&lt;T&gt;, FusibleFlow&lt;T&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _state = atomic(initialValue) <span class="hljs-comment">// T | NULL</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> sequence = <span class="hljs-number">0</span> <span class="hljs-comment">// serializes updates, value update is in process when sequence is odd</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> slots = arrayOfNulls&lt;StateFlowSlot?&gt;(INITIAL_SIZE)
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> nSlots = <span class="hljs-number">0</span> <span class="hljs-comment">// number of allocated (!free) slots</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> nextIndex = <span class="hljs-number">0</span> <span class="hljs-comment">// oracle for the next free slot index</span><font></font>
<font></font>
. . .<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_state</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - lien atomique pour stocker notre √©tat. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©quence</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - un indicateur auxiliaire qui, en fonction de la parit√© / bizarrerie, rend compte du processus actuel de mise √† jour des </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">emplacements d'</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©tat </font><font style="vertical-align: inherit;">- tableau / pool StateFlowSlot. StateFlowSlot - abstraction auxiliaire de chaque "connexion" √† StateFlow. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nSlots, nextIndex</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - variables d'assistance pour travailler avec les emplacements de tableau extensibles </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rons √† l'avance StateFlowSlot. Il repr√©sente uniquement:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _state = atomic&lt;Any?&gt;(<span class="hljs-literal">null</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus de m√©thodes pour changer les √©tats des emplacements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque emplacement peut √™tre dans l'un des √©tats suivants: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cr√©√©, mais non utilis√© </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AUCUN</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - utilis√© par le collecteur </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PENDING</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - en attendant qu'une nouvelle valeur soit envoy√©e au collecteur </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CancellableContinuationImpl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - √©tat suspendu, proche de la destination avec PENDING, suspendez le collecteur jusqu'√† ce qu'un nouvel √©tat arrive dans StateFlow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consid√©rez ce qui se passe lorsque vous d√©finissez une nouvelle valeur:</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T
        <span class="hljs-keyword">get</span>() = NULL.unbox(_state.value)
        <span class="hljs-keyword">set</span>(value) {
            <span class="hljs-keyword">var</span> curSequence = <span class="hljs-number">0</span>
            <span class="hljs-keyword">var</span> curSlots: Array&lt;StateFlowSlot?&gt; = <span class="hljs-keyword">this</span>.slots <span class="hljs-comment">// benign race, we will not use it</span>
            <span class="hljs-keyword">val</span> newState = value ?: NULL<font></font>
            synchronized(<span class="hljs-keyword">this</span>) {
                <span class="hljs-keyword">val</span> oldState = _state.value
                <span class="hljs-keyword">if</span> (oldState == newState) <span class="hljs-keyword">return</span> <span class="hljs-comment">// Don't do anything if value is not changing</span><font></font>
                _state.value = newState<font></font>
                curSequence = sequence<font></font>
                <span class="hljs-keyword">if</span> (curSequence and <span class="hljs-number">1</span> == <span class="hljs-number">0</span>) { <span class="hljs-comment">// even sequence means quiescent state flow (no ongoing update)</span>
                    curSequence++ <span class="hljs-comment">// make it odd</span><font></font>
                    sequence = curSequence<font></font>
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// update is already in process, notify it, and return</span>
                    sequence = curSequence + <span class="hljs-number">2</span> <span class="hljs-comment">// change sequence to notify, keep it odd</span>
                    <span class="hljs-keyword">return</span><font></font>
                }<font></font>
                curSlots = slots <span class="hljs-comment">// read current reference to collectors under lock</span><font></font>
            }<font></font>
            <span class="hljs-comment">/*
               Fire value updates outside of the lock to avoid deadlocks with unconfined coroutines
               Loop until we're done firing all the changes. This is sort of simple flat combining that
               ensures sequential firing of concurrent updates and avoids the storm of collector resumes
               when updates happen concurrently from many threads.
             */</span>
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">// Benign race on element read from array</span>
                <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> curSlots) {<font></font>
                    col?.makePending()<font></font>
                }<font></font>
                <span class="hljs-comment">// check if the value was updated again while we were updating the old one</span>
                synchronized(<span class="hljs-keyword">this</span>) {
                    <span class="hljs-keyword">if</span> (sequence == curSequence) { <span class="hljs-comment">// nothing changed, we are done</span>
                        sequence = curSequence + <span class="hljs-number">1</span> <span class="hljs-comment">// make sequence even again</span>
                        <span class="hljs-keyword">return</span> <span class="hljs-comment">// done</span><font></font>
                    }<font></font>
                    <span class="hljs-comment">// reread everything for the next loop under the lock</span><font></font>
                    curSequence = sequence<font></font>
                    curSlots = slots<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La t√¢che principale ici est de corriger les changements d'√©tat de StateFlow √† partir de diff√©rents flux pour des appels successifs √† FlowCollector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On distingue plusieurs √©tapes:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©finition d'une nouvelle valeur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettre le marqueur de s√©quence sur une valeur impaire signifie que nous sommes d√©j√† en train de mettre √† jour.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">makePending () - d√©finissant tous les √©tats des emplacements (c'est-√†-dire toutes les connexions) sur PENDING - nous enverrons bient√¥t une nouvelle valeur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La boucle v√©rifie la s√©quence == curSequence que toutes les t√¢ches sont termin√©es et d√©finit la s√©quence sur un nombre pair.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que se passe-t-il dans la m√©thode de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collecte</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="kotlin hljs"><span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-keyword">val</span> slot = allocateSlot()
        <span class="hljs-keyword">var</span> prevState: Any? = <span class="hljs-literal">null</span> <span class="hljs-comment">// previously emitted T!! | NULL (null -- nothing emitted yet)</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// The loop is arranged so that it starts delivering current value without waiting first</span>
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">// Here the coroutine could have waited for a while to be dispatched,</span>
                <span class="hljs-comment">// so we use the most recent state here to ensure the best possible conflation of stale values</span>
                <span class="hljs-keyword">val</span> newState = _state.value
                <span class="hljs-comment">// Conflate value emissions using equality</span>
                <span class="hljs-keyword">if</span> (prevState == <span class="hljs-literal">null</span> || newState != prevState) {<font></font>
                    collector.emit(NULL.unbox(newState))<font></font>
                    prevState = newState<font></font>
                }<font></font>
                <span class="hljs-comment">// Note: if awaitPending is cancelled, then it bails out of this loop and calls freeSlot</span>
                <span class="hljs-keyword">if</span> (!slot.takePending()) { <span class="hljs-comment">// try fast-path without suspending first</span>
                    slot.awaitPending() <span class="hljs-comment">// only suspend for new values when needed</span><font></font>
                }<font></font>
            }<font></font>
        } <span class="hljs-keyword">finally</span> {<font></font>
            freeSlot(slot)<font></font>
        }<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La t√¢che principale consiste √† envoyer la valeur par d√©faut initiale et √† attendre de nouvelles valeurs: </font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous cr√©ons ou r√©utilisons un emplacement pour une nouvelle connexion.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous v√©rifions l'√©tat pour null ou pour un changement d'√©tat. </font><font style="vertical-align: inherit;">Emittim est un nouveau sens.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous v√©rifions s'il y a des emplacements pr√™ts pour la mise √† jour (√©tat PENDING) et sinon, nous suspendons l'emplacement en pr√©vision de nouvelles valeurs.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En g√©n√©ral, c'est tout. </font><font style="vertical-align: inherit;">Nous n'avons pas consid√©r√© comment l'allocation des cr√©neaux horaires et le changement de leurs √©tats se produisent, mais je me suis dit que ce n'√©tait pas important pour l'image globale de StateFlow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remercier.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr501280/index.html">–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –¥–æ–ª–∂–µ–Ω —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –±–∏–∑–Ω–µ—Å–∞</a></li>
<li><a href="../fr501282/index.html">Effet secondaire du coronavirus: les robots occuperont nos emplois encore plus rapidement</a></li>
<li><a href="../fr501298/index.html">Cr√©ation de votre propre r√©f√©rentiel de plugins QGIS</a></li>
<li><a href="../fr501302/index.html">Veuillez ne pas faire de bruit</a></li>
<li><a href="../fr501306/index.html">Cr√©ation d'un pipeline pour fournir Graal Native Image aux utilisateurs finaux</a></li>
<li><a href="../fr501310/index.html">√Ä propos du peroxyde d'hydrog√®ne et du bug des fus√©es</a></li>
<li><a href="../fr501312/index.html">Alpine.js - cadre l√©ger avec une syntaxe pratique</a></li>
<li><a href="../fr501316/index.html">√âtude Microsoft: la formation des employ√©s est l'un des facteurs cl√©s de l'introduction de l'intelligence artificielle dans les entreprises</a></li>
<li><a href="../fr501318/index.html">Comment utiliser Js et Google Sheets pour devenir le voisin du club de golf de Bill Gates</a></li>
<li><a href="../fr501320/index.html">Pilote LED avec un co√ªt de nomenclature inf√©rieur √† 1 $. C'est possible?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>