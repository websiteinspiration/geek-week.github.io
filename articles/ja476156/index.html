<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥¤ ğŸšŠ â™Šï¸ Apache Kafkaã‚’ä½¿ç”¨ã—ãŸåŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ â° ğŸ§‘ğŸ¾â€ğŸ¤â€ğŸ§‘ğŸ½ ğŸŸ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¼ã€ç‰¹ã«Apache Kafkaã¯ã€æœ€è¿‘å¤šãã®æ³¨ç›®ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¼ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ã«ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆã®å§”ä»»ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æœ¬è³ªçš„ã«éåŒæœŸã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€Synchronous Request-Responseã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’å¿…è¦ã¨ã™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Apache Kafkaã‚’ä½¿ç”¨ã—ãŸåŒæœŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476156/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¼</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font><font style="vertical-align: inherit;">ç‰¹ã«</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Kafka</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€æœ€è¿‘å¤šãã®æ³¨ç›®ã‚’é›†ã‚ã¦ã„ã¾ã™ã€‚ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ¼ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ã«ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆã®å§”ä»»ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æœ¬è³ªçš„ã«éåŒæœŸã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Synchronous Request-Responseã®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’å¿…è¦ã¨ã™ã‚‹ç‰¹åˆ¥ãªä½¿ç”¨ã‚·ãƒŠãƒªã‚ª/ãƒ•ãƒ­ãƒ¼ãŒã„ãã¤ã‹ã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚ã“ã®å•é¡Œã§ã¯</font><b><font style="vertical-align: inherit;">ã€Apache The Kafka</font></b><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨ã—</font><b><font style="vertical-align: inherit;">ã¦</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒ£ãƒ¬ãƒ³ã‚¸/ãƒ¬ã‚¹ãƒãƒ³ã‚¹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">@middle_java</font></a></b><font style="vertical-align: inherit;"> 
ã«ã‚ˆã£ã¦ç¿»è¨³ã•ã‚Œ</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã—ãŸ</font></a></b></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></b><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…ƒã®è¨˜äº‹ã®æ—¥ä»˜ï¼š2018å¹´10æœˆ26æ—¥</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apache Kafkaã¯æœ¬è³ªçš„ã«éåŒæœŸã§ã™ã€‚ã—ãŸãŒã£ã¦ã€</font><font style="vertical-align: inherit;">Apache Kafka </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®è¦æ±‚/å¿œç­”</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹</font><font style="vertical-align: inherit;">ã¯è‡ªç„¶ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã ã—ã€ã“ã®èª²é¡Œã¯æ–°ã—ã„ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºçµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦æ±‚-å¿œç­”ã¯ã€</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éåŒæœŸãƒãƒ£ãƒãƒ«ã‚’ä»‹ã—ã¦åŒæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã®ãŸã‚ã®å®Ÿç¸¾ã®ã‚ã‚‹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æä¾›ã—ã¾ã™ï¼š</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ä½æ‰€</font></a></b><font style="vertical-align: inherit;">ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è£œå®Œã™ã‚‹</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">è¦æ±‚-å¿œç­”</font></a></b><font style="vertical-align: inherit;">ã®ãƒ‘ã‚¿ãƒ¼ãƒ³</font><font style="vertical-align: inherit;">ï¼šå¿œç­”ã‚’é€ä¿¡ã™ã¹ãã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¤ºã™ãŸã‚ã«ã€ä¾é ¼è€…ã®ãŸã‚ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’</font><font style="vertical-align: inherit;">
æœ€è¿‘ã«</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">æ˜¥Kafka </font></a><b><font style="vertical-align: inherit;">2.1.3ã®</font></b><font style="vertical-align: inherit;">ã‚µãƒãƒ¼ãƒˆãŒè¿½åŠ è¨­å®šãªã—ã§ã€Œè¦æ±‚å¿œç­”ã€ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³</font><b><font style="vertical-align: inherit;">2.2ã§</font></b><font style="vertical-align: inherit;">è¿½åŠ ã•ã‚Œã¾ã—ãŸ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ww/cy/0h/wwcy0hvrj6iie7amwxpk1twfbui.gif"><br>
<br><font style="vertical-align: inherit;"></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></b><font style="vertical-align: inherit;"></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></b><font style="vertical-align: inherit;"></font><br>
<br>
<img src="https://habrastorage.org/webt/rw/nd/qq/rwndqqxh42kt82xadcbvgjb76wa.gif"><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã®ç²—ã•ã®ä¸€éƒ¨ã¯ç£¨ã‹ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã®ã‚µãƒãƒ¼ãƒˆã®ä»•çµ„ã¿ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼šReplyingKafkaTemplate</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ˆãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŠ½è±¡åŒ–ã¯ã€</font><font style="vertical-align: inherit;">Springã®Request-Replyãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆéƒ¨åˆ†ã®åŸºç¤ã‚’å½¢æˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> ReplyingKafkaTemplate &lt; String, Request, Reply &gt; replyKafkaTemplate(<font></font>
     ProducerFactory &lt; String, Request &gt; pf,<font></font>
     KafkaMessageListenerContainer &lt; String, Reply &gt; lc) {<font></font>
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ReplyingKafkaTemplate &lt; &gt; (pf, lc);<font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã™ã¹ã¦ãŒéå¸¸ã«ç°¡å˜ã§ã™ã€‚</font><font style="vertical-align: inherit;">æ–‡å­—åˆ—ã‚­ãƒ¼ã§è¦æ±‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€æ–‡å­—åˆ—ã‚­ãƒ¼ã§å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡</font><font style="vertical-align: inherit;">ã™ã‚‹</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReplyingKafkaTemplate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’è¨­å®šã—</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ReplyingKafkaTemplateã¯ã€é©åˆ‡ãªã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãŠã‚ˆã³ãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼æ§‹æˆã‚’ä½¿ç”¨ã—ã¦ã€ProducerFactoryè¦æ±‚ã€ConsumerFactoryå¿œç­”ã€ãŠã‚ˆã³MessageListenerContainerã«åŸºã¥ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€å¿…è¦ãªæ§‹æˆã¯ã‹ãªã‚Šé‡ã„ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@Value("${kafka.topic.car.reply}")</span>
 <span class="hljs-keyword">private</span> String replyTopic;<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> Map &lt; String, Object &gt; consumerConfigs() {<font></font>
     Map &lt; String, Object &gt; props = <span class="hljs-keyword">new</span> HashMap &lt; &gt; ();<font></font>
     props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);<font></font>
     props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);<font></font>
     props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, JsonDeserializer.class);<font></font>
     props.put(ConsumerConfig.GROUP_ID_CONFIG, groupId);<font></font>
<font></font>
     <span class="hljs-keyword">return</span> props;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> Map &lt; String, Object &gt; producerConfigs() {<font></font>
     Map &lt; String, Object &gt; props = <span class="hljs-keyword">new</span> HashMap &lt; &gt; ();<font></font>
     props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);<font></font>
     props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);<font></font>
     props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, JsonSerializer.class);<font></font>
     <span class="hljs-keyword">return</span> props;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> ProducerFactory &lt; String, Request &gt; requestProducerFactory() {
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaProducerFactory &lt; &gt; (producerConfigs());<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> ConsumerFactory &lt; String, Reply &gt; replyConsumerFactory() {
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaConsumerFactory &lt; &gt; (consumerConfigs(), <span class="hljs-keyword">new</span> StringDeserializer(),
         <span class="hljs-keyword">new</span> JsonSerializer &lt; Reply &gt; ());<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> KafkaMessageListenerContainer &lt; String, Reply &gt; replyListenerContainer() {<font></font>
     ContainerProperties containerProperties = <span class="hljs-keyword">new</span> ContainerProperties(replyTopic);
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> KafkaMessageListenerContainer &lt; &gt; (replyConsumerFactory(), containerProperties);<font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å ´åˆã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">replyKafkaTemplate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">ä½¿ç”¨</font><font style="vertical-align: inherit;">ã—ã¦åŒæœŸè¦æ±‚ã‚’é€ä¿¡ã—ã€å¿œç­”ã‚’å—ä¿¡ã™ã‚‹æ–¹æ³•ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-meta">@Value("${kafka.topic.car.request}")</span>
<span class="hljs-keyword">private</span> String requestTopic;<font></font>
<font></font>
<span class="hljs-meta">@Value("${kafka.topic.car.reply}")</span>
<span class="hljs-keyword">private</span> String replyTopic;<font></font>
<font></font>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> ReplyingKafkaTemplate &lt; String, Request, Reply &gt; requestReplyKafkaTemplate;<font></font>
<font></font>
...<font></font>
RequestReply request = RequestReply.request(...);<font></font>
<span class="hljs-comment">// producer record</span>
ProducerRecord &lt; String, Request &gt; record = <span class="hljs-keyword">new</span> ProducerRecord &lt; String, Request &gt; (requestTopic, request);
<span class="hljs-comment">//      </span>
record.headers().add(<span class="hljs-keyword">new</span> RecordHeader(KafkaHeaders.REPLY_TOPIC, requestReplyTopic.getBytes()));
<span class="hljs-comment">//     Kafka         </span><font></font>
RequestReplyFuture &lt; String, Request, Reply &gt; sendAndReceive = requestReplyKafkaTemplate.sendAndReceive(record);<font></font>
sendAndReceive.addCallback(<span class="hljs-keyword">new</span> ListenableFutureCallback &lt; ConsumerRecord &lt; String, Reply &gt;&gt; () {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(ConsumerRecord &lt; String, Reply &gt; result)</span> </span>{
        <span class="hljs-comment">//   consumer record</span><font></font>
        Reply reply = result.value();<font></font>
        System.out.println(<span class="hljs-string">"Reply: "</span> + reply.toString());<font></font>
    }<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€å¤šãã®å®šå‹æ–‡ã¨ä½ãƒ¬ãƒ™ãƒ«ã®APIãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã€æœ€æ–°ã®</font><b><font style="vertical-align: inherit;">CompletableFutureã®</font></b><font style="vertical-align: inherit;">ä»£ã‚ã‚Šã«ã€</font><font style="vertical-align: inherit;">ã“ã®æ™‚ä»£é…ã‚Œã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ListenableFuture</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> APIã‚‚ã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><b><font style="vertical-align: inherit;">requestReplyKafkaTemplate</font></b><font style="vertical-align: inherit;">ãŒ</font><b><font style="vertical-align: inherit;">KafkaHeaders.CORRELATION_ID</font></b><font style="vertical-align: inherit;">ãƒ˜ãƒƒãƒ€ãƒ¼ã®ç”Ÿæˆã¨è¨­å®šã‚’å‡¦ç†ã—ã¾ã™</font><font style="vertical-align: inherit;">ãŒ</font><font style="vertical-align: inherit;">ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦</font><b><font style="vertical-align: inherit;">KafkaHeaders.REPLY_TOPIC</font></b><font style="vertical-align: inherit;">ãƒ˜ãƒƒãƒ€ãƒ¼</font><font style="vertical-align: inherit;">ã‚’</font><font style="vertical-align: inherit;">æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€ä¸Šè¨˜ã®</font><b><font style="vertical-align: inherit;">replyListenerContainerã§ã¯</font></b><font style="vertical-align: inherit;">ã€åŒã˜ãƒˆãƒ”ãƒƒã‚¯ã®å›ç­”ãŒæ„å›³çš„ã§ã¯ãªã‹ã£ãŸã“ã¨ã«ã‚‚æ³¨æ„ã—ã¦ãã ã•ã„</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã„ãã¤ã‹ã®æ±šç‰©ã€‚</font><font style="vertical-align: inherit;">æ˜¥ã®æŠ½è±¡åŒ–ã‹ã‚‰ç§ãŒæœŸå¾…ã—ãŸã‚‚ã®ã¨ã¯ã¾ã£ãŸãç•°ãªã‚Šã¾ã™ã€‚</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ¼ãƒãƒ¼å´ï¼š@SendTo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ¼ãƒãƒ¼å´ã§ã¯</font><font style="vertical-align: inherit;">ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ãƒªãƒƒã‚¹ãƒ³</font><font style="vertical-align: inherit;">ã™ã‚‹é€šå¸¸ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KafkaListener</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¯ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ SendTo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã•ã‚‰ã«è£…é£¾ã•ã‚Œ</font><font style="vertical-align: inherit;">ã€å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æä¾›ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒªã‚¹ãƒŠãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦è¿”ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«è‡ªå‹•çš„ã«ãƒ©ãƒƒãƒ—ã•ã‚Œã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORRELATION_IDãŒ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿½åŠ ã•ã‚Œ</font><b><font style="vertical-align: inherit;">ã€</font></b><font style="vertical-align: inherit;">å¿œç­”ã¯</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REPLY_TOPIC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ˜ãƒƒãƒ€ãƒ¼ã§æŒ‡å®šã•ã‚ŒãŸãƒˆãƒ”ãƒƒã‚¯ã§å…¬é–‹ã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> Map &lt; String, Object &gt; consumerConfigs() {<font></font>
     Map &lt; String, Object &gt; props = <span class="hljs-keyword">new</span> HashMap &lt; &gt; ();<font></font>
     props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);<font></font>
     props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);<font></font>
     props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, JsonSerializer.class);<font></font>
     props.put(ConsumerConfig.GROUP_ID_CONFIG, groupId);<font></font>
<font></font>
     <span class="hljs-keyword">return</span> props;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> Map &lt; String, Object &gt; producerConfigs() {<font></font>
     Map &lt; String, Object &gt; props = <span class="hljs-keyword">new</span> HashMap &lt; &gt; ();<font></font>
     props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);<font></font>
     props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);<font></font>
     props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, JsonSerializer.class);<font></font>
<font></font>
     <span class="hljs-keyword">return</span> props;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> ConsumerFactory &lt; String, Request &gt; requestConsumerFactory() {
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaConsumerFactory &lt; &gt; (consumerConfigs(), <span class="hljs-keyword">new</span> StringDeserializer(),
         <span class="hljs-keyword">new</span> JsonSerializer &lt; Request &gt; ());<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> KafkaListenerContainerFactory &lt; ConcurrentMessageListenerContainer &lt; String, Request &gt;&gt; requestListenerContainerFactory() {<font></font>
     ConcurrentKafkaListenerContainerFactory &lt; String, Request &gt; factory =<font></font>
         <span class="hljs-keyword">new</span> ConcurrentKafkaListenerContainerFactory &lt; &gt; ();<font></font>
     factory.setConsumerFactory(requestConsumerFactory());<font></font>
     factory.setReplyTemplate(replyTemplate());<font></font>
     <span class="hljs-keyword">return</span> factory;<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> ProducerFactory &lt; String, Reply &gt; replyProducerFactory() {
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DefaultKafkaProducerFactory &lt; &gt; (producerConfigs());<font></font>
 }<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> KafkaTemplate &lt; String, Reply &gt; replyTemplate() {
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> KafkaTemplate &lt; &gt; (replyProducerFactory());<font></font>
 }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã‚‚ã„ãã¤ã‹ã®æ§‹æˆãŒå¿…è¦ã§ã™ãŒã€ãƒªã‚¹ãƒŠãƒ¼æ§‹æˆã¯ã‚ˆã‚Šå˜ç´”ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@KafkaListener(topics = "${kafka.topic.car.request}", containerFactory = "requestListenerContainerFactory")</span>
 <span class="hljs-meta">@SendTo()</span>
 <span class="hljs-function"><span class="hljs-keyword">public</span> Reply <span class="hljs-title">receive</span><span class="hljs-params">(Request request)</span> </span>{<font></font>
     Reply reply = ...;<font></font>
     <span class="hljs-keyword">return</span> reply;<font></font>
 }</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã—ã‹ã—ã€æ¶ˆè²»è€…ã®è¤‡æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ã©ã†ã§ã™ã‹ï¼Ÿ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒã®ã„ãã¤ã‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã¾ã§ã€ã™ã¹ã¦ãŒæ©Ÿèƒ½ã—ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">è¤‡æ•°ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚‹å ´åˆã¯ã€å¿œç­”ãŒæ­£ã—ã„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">Spring Kafkaã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€å„ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãŒä¸€æ„ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½¿ç”¨ã§ãã‚‹ã‹ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è¿½åŠ ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KafkaHeaders</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ˜ãƒƒãƒ€ãƒ¼å€¤ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨æƒ³å®šã—ã¦ã„ã¾ã™</font><font style="vertical-align: inherit;">ã€‚RESPONSE_PARTITIONã¯ã€æ•´æ•°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç•ªå·ã®BIG-ENDIANè¡¨ç¾ã‚’å«ã‚€4ãƒã‚¤ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã™ã€‚</font><font style="vertical-align: inherit;">ç•°ãªã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«å¯¾ã—ã¦å€‹åˆ¥ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ã«æŸ”è»Ÿæ€§ã«</font><b><font style="vertical-align: inherit;">æ¬ ã‘ã‚‹</font></b><font style="vertical-align: inherit;">ãŸã‚ã€æ˜ç¤ºçš„ãª</font><b><font style="vertical-align: inherit;">REPLY_PARTITION</font></b><font style="vertical-align: inherit;">è¨­å®šã‚’é¸æŠã—ã¾ã™</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ¬¡ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã©ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‹ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€æ˜ç¤ºçš„ãªæ§‹æˆã‚’ä½¿ç”¨ã—ã¦ç‰¹å®šã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’é¸æŠã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã‚Œã‚’ç§ãŸã¡ã®ä¾‹ã«è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@Value("${kafka.topic.car.reply.partition}")</span>
 <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> replyPartition;<font></font>
<font></font>
 ...<font></font>
<font></font>
 <span class="hljs-meta">@Bean</span>
 <span class="hljs-keyword">public</span> KafkaMessageListenerContainer &lt; String, RequestReply &gt; replyListenerContainer() {<font></font>
     ContainerProperties containerProperties = <span class="hljs-keyword">new</span> ContainerProperties(replyTopic);<font></font>
     TopicPartitionInitialOffset initialOffset = <span class="hljs-keyword">new</span> TopicPartitionInitialOffset(replyTopic, replyPartition);
     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> KafkaMessageListenerContainer &lt; &gt; (replyConsumerFactory(), containerProperties, initialOffset);<font></font>
 }<font></font>
 <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] intToBytesBigEndian(<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> data) {
         <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[] {<font></font>
             (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>), (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>),<font></font>
             (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>), (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xff</span>),<font></font>
         };<font></font>
     }<font></font>
<font></font>
     ...<font></font>
     record.headers().add(<span class="hljs-keyword">new</span> RecordHeader(KafkaHeaders.REPLY_TOPIC, requestReplyTopic.getBytes()));<font></font>
 record.headers().add(<span class="hljs-keyword">new</span> RecordHeader(KafkaHeaders.REPLY_PARTITION, intToBytesBigEndian(replyPartition)));<font></font>
 RequestReplyFuture &lt; String, RequestReply, RequestReply &gt; sendAndReceive = requestReplyKafkaTemplate.sendAndReceive(record);<font></font>
 ...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ã¾ã‚Šãã‚Œã„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€å‹•ä½œã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å¿…è¦ãªè¨­å®šã¯åºƒç¯„å›²ã«ã‚ãŸã£ã¦ãŠã‚Šã€APIã¯ä½ãƒ¬ãƒ™ãƒ«ã«è¦‹ãˆã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’æ˜ç¤ºçš„ã«æ§‹æˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæ•°ã‚’å‹•çš„ã«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãŒè¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ˜ã‚‰ã‹ã«ã€ã‚ãªãŸã¯ã‚‚ã£ã¨ä¸Šæ‰‹ã«ã§ãã‚‹ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿œç­”ã¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ”ãƒƒã‚¯å‡¦ç†ã®ã‚«ãƒ—ã‚»ãƒ«åŒ–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãš</font><font style="vertical-align: inherit;">ã€è¿”ä¿¡</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ‰ãƒ¬ã‚¹ã®</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–</font><font style="vertical-align: inherit;">ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’æ¸¡ã—ã¾ã™ã€‚å¿œç­”ã®ãƒˆãƒ”ãƒƒã‚¯ã¯</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RequestReplyTemplateã«</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ¿å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</font><font style="vertical-align: inherit;">ãŸã‚ã€APIã«ã¾ã£ãŸãå­˜åœ¨ã—ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å›ç­”ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«é–¢ã—ã¦ã¯ã€åå¯¾ã®ã“ã¨ã‚’è¡Œã„ã¾ã™ã€‚å›ç­”ã®ãƒˆãƒ”ãƒƒã‚¯ãƒªã‚¹ãƒŠãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’æŠ½å‡ºã—ã€ã“ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•çš„ã«è»¢é€ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã“ã‚Œã‚‰ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å‡¦ç†ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒæ™‚ã«ã€æ¨™æº–ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KafkaTemplate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«é¡ä¼¼ã™ã‚‹ã‚ˆã†ã«APIã‚‚ä½œæˆã—ã¾ã™</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜ç´”åŒ–ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã§</font><b><font style="vertical-align: inherit;">sendAndReceiveï¼ˆï¼‰</font></b><font style="vertical-align: inherit;">ãƒ¡ã‚½ãƒƒãƒ‰</font><b><font style="vertical-align: inherit;">ã‚’</font></b><font style="vertical-align: inherit;">ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒˆãƒ”ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦å¯¾å¿œã™ã‚‹ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼‰ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PartitionAwareReplyingKafkaTemplate</span> &lt; <span class="hljs-title">K</span>, <span class="hljs-title">V</span>, <span class="hljs-title">R</span> &gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">ReplyingKafkaTemplate</span> &lt; <span class="hljs-title">K</span>, <span class="hljs-title">V</span>, <span class="hljs-title">R</span> &gt; </span>{<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PartitionAwareReplyingKafkaTemplate</span><span class="hljs-params">(ProducerFactory &lt; K, V &gt; producerFactory,
        GenericMessageListenerContainer &lt; K, R &gt; replyContainer)</span> </span>{
        <span class="hljs-keyword">super</span>(producerFactory, replyContainer);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">private</span> TopicPartition <span class="hljs-title">getFirstAssignedReplyTopicPartition</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">if</span> (getAssignedReplyTopicPartitions() != <span class="hljs-keyword">null</span> &amp;&amp;<font></font>
            getAssignedReplyTopicPartitions().iterator().hasNext()) {<font></font>
            TopicPartition replyPartition = getAssignedReplyTopicPartitions().iterator().next();<font></font>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isDebugEnabled()) {
                <span class="hljs-keyword">this</span>.logger.debug(<span class="hljs-string">"Using partition "</span> + replyPartition.partition());<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> replyPartition;<font></font>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> KafkaException(<span class="hljs-string">"Illegal state: No reply partition is assigned to this instance"</span>);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">byte</span>[] intToBytesBigEndian(<span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> data) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[] {<font></font>
            (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>), (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span>),<font></font>
            (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>), (<span class="hljs-keyword">byte</span>)((data &gt;&gt; <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0xff</span>),<font></font>
        };<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; sendAndReceiveDefault(<span class="hljs-meta">@Nullable</span> V data) {
        <span class="hljs-keyword">return</span> sendAndReceive(getDefaultTopic(), data);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; sendAndReceiveDefault(K key, <span class="hljs-meta">@Nullable</span> V data) {
        <span class="hljs-keyword">return</span> sendAndReceive(getDefaultTopic(), key, data);<font></font>
    }<font></font>
<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-keyword">public</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; sendAndReceive(String topic, <span class="hljs-meta">@Nullable</span> V data) {<font></font>
        ProducerRecord &lt; K, V &gt; record = <span class="hljs-keyword">new</span> ProducerRecord &lt; &gt; (topic, data);
        <span class="hljs-keyword">return</span> doSendAndReceive(record);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; sendAndReceive(String topic, K key, <span class="hljs-meta">@Nullable</span> V data) {<font></font>
        ProducerRecord &lt; K, V &gt; record = <span class="hljs-keyword">new</span> ProducerRecord &lt; &gt; (topic, key, data);
        <span class="hljs-keyword">return</span> doSendAndReceive(record);<font></font>
    }<font></font>
<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; sendAndReceive(ProducerRecord &lt; K, V &gt; record) {<font></font>
        <span class="hljs-keyword">return</span> doSendAndReceive(record);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">protected</span> RequestReplyFuture &lt; K,<font></font>
    V,<font></font>
    R &gt; doSendAndReceive(ProducerRecord &lt; K, V &gt; record) {<font></font>
        TopicPartition replyPartition = getFirstAssignedReplyTopicPartition();<font></font>
        record.headers()<font></font>
            .add(<span class="hljs-keyword">new</span> RecordHeader(KafkaHeaders.REPLY_TOPIC, replyPartition.topic().getBytes()))<font></font>
            .add(<span class="hljs-keyword">new</span> RecordHeader(KafkaHeaders.REPLY_PARTITION,<font></font>
                intToBytesBigEndian(replyPartition.partition())));<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.sendAndReceive(record);<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ListenableFuture</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ã‚ˆã‚Šæœ€æ–°ã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompletableFutureã«</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é©å¿œã•ã›ã‚‹</font><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CompletableFutureReplyingKafkaTemplate</span> &lt; <span class="hljs-title">K</span>, <span class="hljs-title">V</span>, <span class="hljs-title">R</span> &gt; <span class="hljs-keyword">extends</span> <span class="hljs-title">PartitionAwareReplyingKafkaTemplate</span> &lt; <span class="hljs-title">K</span>, <span class="hljs-title">V</span>, <span class="hljs-title">R</span> &gt; </span>{<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CompletableFutureReplyingKafkaTemplate</span><span class="hljs-params">(ProducerFactory &lt; K, V &gt; producerFactory,
        GenericMessageListenerContainer &lt; K, R &gt; replyContainer)</span> </span>{
        <span class="hljs-keyword">super</span>(producerFactory, replyContainer);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> CompletableFuture &lt; R &gt; requestReplyDefault(V value) {
        <span class="hljs-keyword">return</span> adapt(sendAndReceiveDefault(value));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> CompletableFuture &lt; R &gt; requestReplyDefault(K key, V value) {
        <span class="hljs-keyword">return</span> adapt(sendAndReceiveDefault(key, value));<font></font>
    }<font></font>
<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-keyword">public</span> CompletableFuture &lt; R &gt; requestReply(String topic, V value) {
        <span class="hljs-keyword">return</span> adapt(sendAndReceive(topic, value));<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">public</span> CompletableFuture &lt; R &gt; requestReply(String topic, K key, V value) {
        <span class="hljs-keyword">return</span> adapt(sendAndReceive(topic, key, value));<font></font>
    }<font></font>
<font></font>
    ...<font></font>
<font></font>
    <span class="hljs-keyword">private</span> CompletableFuture &lt; R &gt; adapt(RequestReplyFuture &lt; K, V, R &gt; requestReplyFuture) {<font></font>
        CompletableFuture &lt; R &gt; completableResult = <span class="hljs-keyword">new</span> CompletableFuture &lt; R &gt; () {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">cancel</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> mayInterruptIfRunning)</span> </span>{
                <span class="hljs-keyword">boolean</span> result = requestReplyFuture.cancel(mayInterruptIfRunning);
                <span class="hljs-keyword">super</span>.cancel(mayInterruptIfRunning);
                <span class="hljs-keyword">return</span> result;<font></font>
            }<font></font>
        };<font></font>
        <span class="hljs-comment">//      </span>
        requestReplyFuture.getSendFuture().addCallback(<span class="hljs-keyword">new</span> ListenableFutureCallback &lt; SendResult &lt; K, V &gt;&gt; () {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(SendResult &lt; K, V &gt; sendResult)</span> </span>{
                <span class="hljs-comment">// NOOP</span><font></font>
            }<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Throwable t)</span> </span>{<font></font>
                completableResult.completeExceptionally(t);<font></font>
            }<font></font>
        });<font></font>
        <span class="hljs-comment">//    </span>
        requestReplyFuture.addCallback(<span class="hljs-keyword">new</span> ListenableFutureCallback &lt; ConsumerRecord &lt; K, R &gt;&gt; () {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(ConsumerRecord &lt; K, R &gt; result)</span> </span>{<font></font>
                completableResult.complete(result.value());<font></font>
            }<font></font>
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Throwable t)</span> </span>{<font></font>
                completableResult.completeExceptionally(t);<font></font>
            }<font></font>
        });<font></font>
        <span class="hljs-keyword">return</span> completableResult;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚’ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒ‘ãƒƒã‚¯ã™ã‚‹ã¨ã€Spring </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŸºæœ¬çš„ãªè¨­è¨ˆå“²å­¦ã§ã‚ã‚‹</font><b><font style="vertical-align: inherit;">ã€ŒConvention over Configurationã€ã«</font></b><font style="vertical-align: inherit;">ã¯ã‚‹ã‹ã«æ²¿ã£ãŸAPIãŒã§ãã¾ã—ãŸ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã‚ŒãŒæœ€çµ‚çš„ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="java hljs"> <span class="hljs-meta">@Autowired</span>
 <span class="hljs-keyword">private</span> CompletableFutureReplyingKafkaTemplate &lt; String, Request, Reply &gt; requestReplyKafkaTemplate;<font></font>
<font></font>
 ...<font></font>
<font></font>
 requestReplyKafkaTemplate.requestReply(request).thenAccept(reply - &gt;<font></font>
     System.out.println(<span class="hljs-string">"Reply: "</span> + reply.toString());<font></font>
 );</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ç´„ã™ã‚‹</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ç´„ã™ã‚‹ã¨ã€Spring for Kafka 2.2ã¯ã€</font><font style="vertical-align: inherit;">Apache Kafkaã®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Request-Reply</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Œå…¨ã«æ©Ÿèƒ½çš„ãªå®Ÿè£…ã‚’æä¾›ã—ã¾ã™</font><font style="vertical-align: inherit;">ãŒã€APIã«ã¯ã¾ã ã„ãã¤ã‹ã®å¤§ã¾ã‹ãªã‚¨ãƒƒã‚¸ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å•é¡Œã§ã¯ã€APIã®è¿½åŠ ã®æŠ½è±¡åŒ–ã¨é©å¿œãŒã€ã‚ˆã‚Šè«–ç†çš„ã§é«˜ãƒ¬ãƒ™ãƒ«ã®APIã‚’æä¾›ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­¦å‘Š1ï¼š</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¸»ãªåˆ©ç‚¹ã®1ã¤ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ—ãƒ­ãƒ‡ãƒ¥ãƒ¼ã‚µãƒ¼ã¨ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ã‚’åˆ†é›¢ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ˆã‚ŠæŸ”è»Ÿã§é€²åŒ–ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã§ãã¾ã™ã€‚åŒæœŸã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã€ŒRequest-Responseã€ã®ä½¿ç”¨ã¯ã€è¦æ±‚å´ã¨å¿œç­”å´ãŒå¼·ãé–¢é€£ã—ã¦ã„ã‚‹å ´åˆã¨ã¯æ­£åå¯¾ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€å¿…è¦ãªå ´åˆã«ã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­¦å‘Š2ï¼š</font></font></b> <br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæœŸã®Request-Response</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãŒå¿…è¦ãª</font><font style="vertical-align: inherit;">å ´åˆã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ™ãƒ¼ã‚¹ã®</font><b><font style="vertical-align: inherit;">ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€Apache Kafkaã®ã‚ˆã†ãªéåŒæœŸãƒãƒ£ãƒãƒ«</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’ä½¿ç”¨</font><b><font style="vertical-align: inherit;">ã™ã‚‹</font></b><font style="vertical-align: inherit;">ã‚ˆã‚Šã‚‚ã¯ã‚‹ã‹ã«å˜ç´”ã§åŠ¹ç‡çš„ã§ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kafka</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’</font><b><font style="vertical-align: inherit;">ä»‹ã—</font></b><font style="vertical-align: inherit;">ãŸ</font><b><font style="vertical-align: inherit;">åŒæœŸã®Request-Response</font></b><font style="vertical-align: inherit;">ãŒç†ã«ã‹ãªã£</font><b><font style="vertical-align: inherit;">ã¦</font></b><font style="vertical-align: inherit;">ã„ã‚‹ã‚·ãƒŠãƒªã‚ªã‚‚ã‚ã‚Šã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä»•äº‹ã«æœ€é©ãªãƒ„ãƒ¼ãƒ«ã‚’åˆç†çš„ã«é¸æŠã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Œå…¨ã«æ©Ÿèƒ½ã™ã‚‹ä¾‹ã¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/callistaenterprise/blog-synchronous-kafkaã«ã‚ã‚Š</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ¡ãƒ³ãƒˆ</font></font></h2><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚§ãƒ‡ãƒªã‚³â€¢7ã‹æœˆå‰</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã®ãƒ‹ãƒ¼ã‚ºãŒã‚ã‚‹å ´åˆã€50ï¼…ã®ã‚±ãƒ¼ã‚¹ã§è¦æ±‚/å¿œç­”ãŒå¿…è¦ã§ã€50ï¼…ã®ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ãŒå¿…è¦ã ã¨ã—ã¾ã—ã‚‡ã†ã€‚ã“ã‚Œã©ã†ã‚„ã£ã¦ã‚„ã‚‹ã®ï¼Ÿ Spring Kafkaã«å¿…è¦ãªæ§‹æˆã¯ã‹ãªã‚Šã²ã©ã„ã‚ˆã†ã§ã™ã€‚</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jehanzeb Qayyumâ€¢6ã‹æœˆå‰</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Springã¯ã€å›ç­”ã®1ã¤ã®å…±é€šãƒˆãƒ”ãƒƒã‚¯ã§ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚µãƒãƒ¼ãƒˆã‚’</font><i><font style="vertical-align: inherit;">è¿½åŠ ã—</font></i><font style="vertical-align: inherit;">ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.2ä»¥é™ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€æ§‹æˆã•ã‚ŒãŸå¿œç­”ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ï¼ˆå¿œç­”ã‚³ãƒ³ãƒ†ãƒŠãƒ¼ï¼‰ã‹ã‚‰å¿œç­”ã¾ãŸã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’åˆ¤åˆ¥ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://docs.spring.io/spring-kafka/reference/html/#replying-template </font></font></a><br>
 <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nir rozenbergâ€¢8ã‹æœˆå‰</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Helloã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã®æ®µè½ã§ã¯ã€Kafkaã‚’ä»‹ã—ãŸåŒæœŸã®è¦æ±‚ã¨å¿œç­”ãŒHTTPã¨æ¯”è¼ƒã—ã¦æ„å‘³ãŒã‚ã‚‹å ´åˆãŒã‚ã‚‹ã¨æ›¸ã„ã¦ã„ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®ã‚ˆã†ãªã‚·ãƒŠãƒªã‚ªã®ä¾‹ã‚’æŒ™ã’ã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚ã‚ŠãŒã¨ã†ã€</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nir </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Janne Keskitalo nir rozenbergâ€¢8ã‹æœˆå‰</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å¤§å®¹é‡ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ã„ãã¤ã‹ã®ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã«åˆ†å‰²ã—ã€Kafkaã®ã€ŒRequest-Replyã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦åŒæ§˜ã®å‡¦ç†è¦ªå’Œæ€§ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¦ã„ã¾ã™ã€‚åŸºæœ¬çš„ã«ã€Kafkaã¯ã€1ã¤ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ã™ã¹ã¦ã®å‘¼ã³å‡ºã—ã‚’åŒã˜ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚¿ã‚¤ãƒ—ã®å‡¦ç†ã¯ç·šå½¢åŒ–å¯èƒ½æ€§ã‚’ä¿è¨¼ã—</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã¾ã™</font></a><font style="vertical-align: inherit;">ï¼ˆ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://stackoverflow.com/a/19515375/7430325</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€å› æœé–¢ä¿‚ã€ãã—ã¦åŠ¹ç‡çš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°ã‚‚å¯èƒ½ã«ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">åŸºæœ¬çš„ã«ã€èª¿æ•´ä½œæ¥­ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰Kafkaã«è»¢é€ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’Serializableã®å³å¯†ãªåˆ†é›¢ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã§ãã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã®è©³ç´°ã‚’æ˜ã‚Šä¸‹ã’ã¦ã€ã©ã“ã§ä¸è¶³ã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ã“ã‚Œã¯å˜ãªã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã€‚</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">@middle_java</font></a></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã«ã‚ˆã£ã¦ç¿»è¨³ã•ã‚Œ</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ã—ãŸ</font></font></a></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja476140/index.html">7000èªã¯çŸ¥ã£ã¦ã„ã‚‹ãŒè€³ã§ç†è§£ã§ããªã„å ´åˆã€ãƒªã‚¹ãƒ‹ãƒ³ã‚°ã‚’æ”¹å–„ã™ã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿ</a></li>
<li><a href="../ja476142/index.html">Javaã§ãƒ•ãƒ­ãƒ¼ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã«ä¾‹å¤–ã®ä½¿ç”¨ã‚’é¿ã‘ã‚‹ç†ç”±</a></li>
<li><a href="../ja476144/index.html">ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚µãƒ³ã‚¿ã‚’ãƒ—ãƒ¬ã‚¤ã™ã‚‹ãƒœãƒƒãƒˆã®ä¾‹ã‚’ä½¿ç”¨ã—ã¦ã€ãƒœãƒƒãƒˆã®ãƒãƒ£ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å¿…è¦æ€§ã¨ä¸è¦ãªæ–¹æ³•</a></li>
<li><a href="../ja476146/index.html">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã‚’æ‹¡å¼µã™ã‚‹æ–¹æ³•ã€‚Yandexãƒ¬ãƒãƒ¼ãƒˆ</a></li>
<li><a href="../ja476148/index.html">FreeBSDã§ã®postfix + dovecot + mysql</a></li>
<li><a href="../ja476160/index.html">æ•™è‚²ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®èª•ç”Ÿã¨ãã®æ­´å²ï¼šæ©Ÿæ¢°ã‹ã‚‰æœ€åˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã¾ã§</a></li>
<li><a href="../ja476162/index.html">æœ€æ–°ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çŸ¥è­˜ã¨ä»•äº‹ã®æº–å‚™ã€‚ãƒ‘ãƒ¼ãƒˆ1</a></li>
<li><a href="../ja476164/index.html">ã€Œã“ã‚Œã‚‚ãƒ‡ãƒ¼ã‚¿åˆ†æã§ã™ã€‚ã€ãƒŸãƒã‚¤ãƒ«ãƒ»ã‚²ãƒ«ãƒ•ã‚¡ãƒ³ãƒ‰ã¨ãƒã‚¤ã‚ªã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ã«ã¤ã„ã¦èªã‚‹</a></li>
<li><a href="../ja476166/index.html">ã€Œãƒªã‚¢ãƒ«ã‚¢ã‚¤ã‚¢ãƒ³ãƒãƒ³ã€ã¯é£›è¡Œé€Ÿåº¦ã®è¨˜éŒ²ã‚’å¡—ã‚Šæ›¿ãˆã¾ã—ãŸ</a></li>
<li><a href="../ja476172/index.html">BLACK HAT USAã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã€‚é‡‘æŒã¡ã«ãªã‚‹ã‹æ­»ã¬ã‹ï¼šBlack Hatã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã§ãŠé‡‘ã‚’ç¨¼ãã€‚ãƒ‘ãƒ¼ãƒˆ2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>