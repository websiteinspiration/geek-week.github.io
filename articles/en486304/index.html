<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💖 🧚🏿 😀 Thousands of Forgotten TODOs in Kubernetes Code 👩🏿‍🤝‍👨🏼 👨🏼‍🚀 🎑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Photo by Yancy Min at Unsplash 
 
 Kubernetes is a big project. Not only because it is very in demand , but also from the point of view of the source ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Thousands of Forgotten TODOs in Kubernetes Code</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/486304/"><img src="https://habrastorage.org/webt/9i/vd/zs/9ivdzsopt74drqrndu7ahfmtk-m.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Photo by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yancy Min</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unsplash</font></font></a></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kubernetes is a big project. Not only because it is</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> very in demand</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but also from the point of view of the source code. At the time of this writing, there were more than 86,000 commits, more than 2,000 participants, more than 2,000 open tickets, more than 1,000 open pool requests and 62,800 stars in the</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repository on GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scc</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utility</font><font style="vertical-align: inherit;">counted more than 4.3 million lines of code on Go (more than 5.2 million lines), of which more than 3 million lines of real code and more than 700 thousand lines with comments, a total of more than 16,000 files,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> including a directory</font></font><code>vendor/</code></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We recently developed a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://todos.tickgit.com/browse%3Frepo%3D"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processes TODO comments</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in a codebase to help support such large projects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We decided to set our little parser on Kubernetes sources - and see what happens. </font><font style="vertical-align: inherit;">Here are some results. </font></font><br>
<br>
<code>tickgit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">processed the source code from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9bf52c2 commit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The output in CSV format was then imported into SQLite for query processing. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that the tool finds TODO only in the extracted tree. </font><font style="vertical-align: inherit;">It does not take into account comments that have been added and subsequently deleted. </font><font style="vertical-align: inherit;">Thus, the numbers reflect only TODOs that are still “living” in the code at the time of this commit.</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total (for </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9bf52c2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2380 TODO in 1230 files from 363 authors</font></font><br>
</li>
<li>460 TODO   , , <code>// TODO (patrickdevivo) Fix the ...</code> <br>
</li>
<li>489 TODO   2019 <br>
</li>
<li>  TODO — 860  ( 2,3 )<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">  TODO</a> —  6  2014  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">« »</a>)<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> TODO</a>  9  2019  (   )<br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>   TODO: 33<br>
</li>
<li>deads2k    TODO (git blame): 147<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>    TODO,      : 64</li>
</ul><br>
<h1></h1><br>
<h4>    TODO</h4><br>
<pre>33	cluster/gce/util.sh<font></font>
25	pkg/apis/core/types.go<font></font>
23	staging/src/k8s.io/api/core/v1/types.go<font></font>
21	staging/src/k8s.io/legacy-cloud-providers/aws/aws.go<font></font>
20	staging/src/k8s.io/code-generator/cmd/conversion-gen/generators/conversion.go<font></font>
20	pkg/apis/core/validation/validation.go<font></font>
16	test/e2e/network/service.go<font></font>
16	pkg/kubelet/kubelet.go<font></font>
14	test/e2e/framework/util.go<font></font>
14	pkg/kubelet/kubelet_pods.go</pre><br>
<br>
<h4>    TODO</h4><br>
<pre>deads2k				147<font></font>
Clayton Coleman			105<font></font>
Chao Xu				99<font></font>
Dr. Stefan Schimanski		93<font></font>
Jordan Liggitt			81<font></font>
David Eads			60<font></font>
Random-Liu			54<font></font>
Wojciech Tyczynski		50<font></font>
Yu-Ju Hong			43<font></font>
Prashanth Balasubramanian	38</pre><br>
<br>
<h4>,     TODO (  TODO   )</h4><br>
<pre>64	6a4d5cd7cc58e28c20ca133dab7b0e9e56192fe3<font></font>
19	e01ff1641c7321ac81fe5775f6ccb21aa6775c04<font></font>
19	4fb28dafad121e163fa86dc90067ce3d14415811<font></font>
18	adb75e1fd17b11e6a0256a4984ef9b18957d94ce<font></font>
14	963c85e1c807efcdbb82dd44439dc3c55f6a0bfd<font></font>
14	8b17db7e0c4431cd5fd9a5d9a3ab11b04e2f0a7e<font></font>
13	f0f78299348afcf770d4e8d89dcea82f80811b28<font></font>
11	d0b94538b9744d0c06df6ddec2604be168568f9d<font></font>
10	f1248b9c829e225138ab6d6234221c63092f7592<font></font>
10	cd663d7ad00937cffa8a09e4761acb95d34c89a3</pre><br>
<br>
<h4>  TODO  </h4> <br>
<pre>34	2014<font></font>
249	2015<font></font>
523	2016<font></font>
650	2017<font></font>
435	2018<font></font>
489	2019</pre><br>
<br>
<i>  ,    TODO <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="> </a>: <code>tickgit todos --csv-output</code>.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">SQLite</a>.</i><br>
<br>
<h1>  </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is a pretty cursory look at the TODO comments in Kubernetes source code. We see the most active "task directors", which more or less coincide with the leading </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contributors of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We also see that the attitude to TODO comments is not different from the norm, just because of the large size of the code base there are also a lot of them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An important observation is that there are </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">more TODO comments than Github tickets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (issues). This is interesting because it indicates a significant number of "hidden" tasks that are not immediately visible on GitHub, but are written in the source code.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Probably, the main contributors are well versed in their areas of the code base and clearly present the number of their own TODOs and “hidden work”. But this is not always noticeable to external observers. They are more familiar and understandable to see tickets on GitHub (or in other public trackers).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most developers understand that software projects "live and breathe." </font><font style="vertical-align: inherit;">Frequent changes, a process of improvement, bug fixes and a lot of discussions are taking place. </font><font style="vertical-align: inherit;">It is very important to organize the workflow well, because good code requires constant thought. </font><font style="vertical-align: inherit;">In part, we see this in action through TODO comments in Kubernetes sources. </font><font style="vertical-align: inherit;">Although we have nothing to compare with, the average age of tasks of 2.3 years seems rather high. </font><font style="vertical-align: inherit;">Developers close to the project can more objectively evaluate this indicator. </font><font style="vertical-align: inherit;">It is interesting to compare it with other large open source projects. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A deeper analysis would include </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">all of the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TODOs in history, and not just those that remain at present. </font><font style="vertical-align: inherit;">You can consider the following issues:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How fast do TODOs close?</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the average lifespan of a TODO comment?</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What do popular codebases look like in comparison?</font></font></li>
</ul><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How important is it?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TODO comments usually cover a type of work that is too small for a ticket, but important enough to be noted and described in a comment (although many refer to tickets / issue). </font><font style="vertical-align: inherit;">Because comments are part of the code, they are often “closer” to the work that needs to be done. </font><font style="vertical-align: inherit;">They are easy to add, but it seems just as easy to forget (Kubernetes sources still have over 1800 TODOs added before 2019). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We hope that our </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for analyzing metadata in code will help developers to service projects of any size. </font><font style="vertical-align: inherit;">Raising TODO comments to the surface is only part of what needs to be done.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en486274/index.html">After the market reacts to the conflict between Iran and the United States, is Bitcoin considered a safe asset?</a></li>
<li><a href="../en486278/index.html">Materials from Kafka mitap: СDC connectors, growth problems, Kubernetes</a></li>
<li><a href="../en486288/index.html">Monitoring Apache Ignite. Done right</a></li>
<li><a href="../en486298/index.html">Ketogenic diet: from the treatment of epilepsy to an unhealthy fashion</a></li>
<li><a href="../en486302/index.html">NSIS: problem with $ 0- $ 9, $ R0- $ R9</a></li>
<li><a href="../en486306/index.html">Product Management Digest for December and January</a></li>
<li><a href="../en486310/index.html">How to get a thermoelectric 7 times faster</a></li>
<li><a href="../en486314/index.html">[Workshop] DMA attacks in practice. Exploit through direct memory access</a></li>
<li><a href="../en486318/index.html">How to make money on emotion recognition</a></li>
<li><a href="../en486320/index.html">Domain Driven Design Meetup at Raiffeisenbank: Broadcast + Presentations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>