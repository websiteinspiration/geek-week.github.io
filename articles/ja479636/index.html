<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤˜ğŸ¿ ğŸ…ğŸ¿ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ¿ ç‹¬è‡ªã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒƒã‚¯ã€‚ROSã‚ˆã‚Šè‰¯ã„ã§ã™ã‹ï¼Ÿ â™Œï¸ ğŸŒ¡ï¸ ğŸ‘©â€âš•ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã‚Œã¯ã€Eurobot Openç«¶æŠ€ç”¨ã®è‡ªå¾‹ãƒ­ãƒœãƒƒãƒˆã‚’ä½œæˆã—ã€ã“ã‚Œã«ROSã‚’ä½¿ç”¨ã—ãŸçµŒé¨“ã«é–¢ã™ã‚‹setUPãƒãƒ¼ãƒ ã®2ç•ªç›®ã®è¨˜äº‹ã§ã™ã€‚
 
 æœ€åˆã®è¨˜äº‹ã¯ã€ãƒ­ãƒœãƒƒãƒˆã®åŠ›å­¦ã¨ä¸€èˆ¬çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã¤ã„ã¦ã§ã™ã€‚
 
 ãƒ­ãƒœãƒƒãƒˆã¯å¹³ã‚‰ãªå ´æ‰€ã‚’ç§»å‹•ã—ã€ã»ã¨ã‚“ã©ã®éšœå®³ç‰©ã¯äº‹å‰ã«ã‚ã‹ã£ã¦ã„ã¾ã™ãŒã€æ²¹æ–­ã®ãªã„æ•µã¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ç‹¬è‡ªã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒƒã‚¯ã€‚ROSã‚ˆã‚Šè‰¯ã„ã§ã™ã‹ï¼Ÿ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479636/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€Eurobot Openç«¶æŠ€ç”¨ã®è‡ªå¾‹ãƒ­ãƒœãƒƒãƒˆã‚’ä½œæˆã—ã€ã“ã‚Œã«ROSã‚’ä½¿ç”¨ã—ãŸçµŒé¨“ã«é–¢ã™ã‚‹setUPãƒãƒ¼ãƒ ã®2ç•ªç›®ã®è¨˜äº‹ã§ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åˆã®è¨˜äº‹ã¯ã€ãƒ­ãƒœãƒƒãƒˆã®åŠ›å­¦ã¨ä¸€èˆ¬çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã¤ã„ã¦ã§ã™ã€‚</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ãƒ­ãƒœãƒƒãƒˆã¯å¹³ã‚‰ãªå ´æ‰€ã‚’ç§»å‹•ã—ã€ã»ã¨ã‚“ã©ã®éšœå®³ç‰©ã¯äº‹å‰ã«ã‚ã‹ã£ã¦ã„ã¾ã™ãŒã€æ²¹æ–­ã®ãªã„æ•µã¯ãƒªã‚½ãƒ¼ã‚¹ã‚’ç›—ã‚‚ã†ã¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šï¼ˆå ´åˆã«ã‚ˆã£ã¦ã¯æ•°åå€‹ã®ä½™åˆ†ãªãƒã‚¤ãƒ³ãƒˆã‚’é£Ÿã¹ãŸã„ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼‰ã€ã§ãã‚‹ã ã‘æ—©ãç›®çš„ã®ãƒã‚¤ãƒ³ãƒˆã«ç§»å‹•ã—ã¦éšœå®³ç‰©ã«è§¦ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šã®å¤–éƒ¨ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã€æ•µã®ä½ç½®ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ•µã®ç¾åœ¨ã®ä½ç½®ã‚’æŠŠæ¡ã—ã¾ã™ã€‚ãŸã ã—ã€å½¼ã®ç«‹å ´ã‚’çŸ¥ã‚‹ã ã‘ã§ã¯ä¸ååˆ†ã§ã™ã€‚ã“ã®æƒ…å ±ã‚’ä½¿ç”¨ã§ãã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»Šæ—¥ã¯ã€é‡åŸã§çœ ã‚Šã«è½ã¡ãŸçŒ«ã®å°»å°¾ã«æ²¿ã£ã¦ç§»å‹•ã™ã‚‹ã“ã¨ãªãã€Aåœ°ç‚¹ã‹ã‚‰Båœ°ç‚¹ã¾ã§é‹è»¢ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç‰¹ã«ã€ãƒ«ãƒ¼ãƒˆã‚’æ§‹ç¯‰ã—ã¦ãƒ­ãƒœãƒƒãƒˆã®é€Ÿåº¦ã‚’åˆ¶å¾¡ã™ã‚‹æ–¹æ³•ã€ãŠã‚ˆã³ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ä¸Šã§ã™ã¹ã¦ã‚’é–‹å§‹ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/x0/a6/omx0a6wfefbht9c1pialld-9vqy.png"><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°‘ã—ã®è¡€ã§ã†ã¾ãã‚„ã£ã¦ã„ã</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã¨ãã€å°‚é–€å®¶ã«ã‚ˆã£ã¦æ›¸ã‹ã‚ŒãŸæ—¢è£½ã®è³‡æ–™ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚ãã†ã™ã‚Œã°ã€æ¬¡ã®ã€Œè‡ªè»¢è»Šã€ã®è‹¦ç—›ã‚„ç™ºæ˜ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã‚ªãƒ ãƒ‹ãƒ›ã‚¤ãƒ¼ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¾ã—ãŸãŒã€ROSã®æ—¢æˆã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒŠã‚’ä½¿ç”¨ã™ã‚‹è©¦ã¿ãŒã‚ã‚Šã¾ã—ãŸãŒã€ã„ãã¤ã‹ã®ç†ç”±ã§ã“ã‚Œã¯æœŸå¾…ã§ããªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ä»¥ä¸‹ã«ã€æ¨™æº–çš„ãªã‚°ãƒ©ã‚¤ãƒ€ãƒ¼ã®è¨­è¨ˆè€…ãŒã©ã‚Œã ã‘å¿…è¦ã¨ã™ã‚‹ã‹ã‚’ç¤ºã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/**
   * @class TrajectoryPlanner
   * @brief Computes control velocities for a robot given a costmap, a plan, and the robot's position in the world. 
   */</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrajectoryPlanner</span>{</span>
    <span class="hljs-keyword">friend</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrajectoryPlannerTest</span>;</span> <span class="hljs-comment">//Need this for gtest to work</span>
    <span class="hljs-keyword">public</span>:
      <span class="hljs-comment">/**
       * @brief  Constructs a trajectory controller
       * @param world_model The WorldModel the trajectory controller uses to check for collisions 
       * @param costmap A reference to the Costmap the controller should use
       * @param footprint_spec A polygon representing the footprint of the robot. (Must be convex)
       * @param inscribed_radius The radius of the inscribed circle of the robot
       * @param circumscribed_radius The radius of the circumscribed circle of the robot
       * @param acc_lim_x The acceleration limit of the robot in the x direction
       * @param acc_lim_y The acceleration limit of the robot in the y direction
       * @param acc_lim_theta The acceleration limit of the robot in the theta direction
       * @param sim_time The number of seconds to "roll-out" each trajectory
       * @param sim_granularity The distance between simulation points should be small enough that the robot doesn't hit things
       * @param vx_samples The number of trajectories to sample in the x dimension
       * @param vtheta_samples The number of trajectories to sample in the theta dimension
       * @param pdist_scale A scaling factor for how close the robot should stay to the path
       * @param gdist_scale A scaling factor for how aggresively the robot should pursue a local goal
       * @param occdist_scale A scaling factor for how much the robot should prefer to stay away from obstacles
       * @param heading_lookahead How far the robot should look ahead of itself when differentiating between different rotational velocities
       * @param oscillation_reset_dist The distance the robot must travel before it can explore rotational velocities that were unsuccessful in the past
       * @param escape_reset_dist The distance the robot must travel before it can exit escape mode
       * @param escape_reset_theta The distance the robot must rotate before it can exit escape mode
       * @param holonomic_robot Set this to true if the robot being controlled can take y velocities and false otherwise
       * @param max_vel_x The maximum x velocity the controller will explore
       * @param min_vel_x The minimum x velocity the controller will explore
       * @param max_vel_th The maximum rotational velocity the controller will explore
       * @param min_vel_th The minimum rotational velocity the controller will explore
       * @param min_in_place_vel_th The absolute value of the minimum in-place rotational velocity the controller will explore
       * @param backup_vel The velocity to use while backing up
       * @param dwa Set this to true to use the Dynamic Window Approach, false to use acceleration limits
       * @param heading_scoring Set this to true to score trajectories based on the robot's heading after 1 timestep
       * @param heading_scoring_timestep How far to look ahead in time when we score heading based trajectories
       * @param meter_scoring adapt parameters to costmap resolution
       * @param simple_attractor Set this to true to allow simple attraction to a goal point instead of intelligent cost propagation
       * @param y_vels A vector of the y velocities the controller will explore
       * @param angular_sim_granularity The distance between simulation points for angular velocity should be small enough that the robot doesn't hit things
       */</span><font></font>
      TrajectoryPlanner(WorldModel&amp; world_model, <font></font>
          <span class="hljs-keyword">const</span> costmap_2d::Costmap2D&amp; costmap, 
          <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;geometry_msgs::Point&gt; footprint_spec,
          <span class="hljs-keyword">double</span> acc_lim_x = <span class="hljs-number">1.0</span>, <span class="hljs-keyword">double</span> acc_lim_y = <span class="hljs-number">1.0</span>, <span class="hljs-keyword">double</span> acc_lim_theta = <span class="hljs-number">1.0</span>,
          <span class="hljs-keyword">double</span> sim_time = <span class="hljs-number">1.0</span>, <span class="hljs-keyword">double</span> sim_granularity = <span class="hljs-number">0.025</span>, 
          <span class="hljs-keyword">int</span> vx_samples = <span class="hljs-number">20</span>, <span class="hljs-keyword">int</span> vtheta_samples = <span class="hljs-number">20</span>,
          <span class="hljs-keyword">double</span> pdist_scale = <span class="hljs-number">0.6</span>, <span class="hljs-keyword">double</span> gdist_scale = <span class="hljs-number">0.8</span>, <span class="hljs-keyword">double</span> occdist_scale = <span class="hljs-number">0.2</span>,
          <span class="hljs-keyword">double</span> heading_lookahead = <span class="hljs-number">0.325</span>, <span class="hljs-keyword">double</span> oscillation_reset_dist = <span class="hljs-number">0.05</span>, 
          <span class="hljs-keyword">double</span> escape_reset_dist = <span class="hljs-number">0.10</span>, <span class="hljs-keyword">double</span> escape_reset_theta = M_PI_2,
          <span class="hljs-keyword">bool</span> holonomic_robot = <span class="hljs-literal">true</span>,
          <span class="hljs-keyword">double</span> max_vel_x = <span class="hljs-number">0.5</span>, <span class="hljs-keyword">double</span> min_vel_x = <span class="hljs-number">0.1</span>, 
          <span class="hljs-keyword">double</span> max_vel_th = <span class="hljs-number">1.0</span>, <span class="hljs-keyword">double</span> min_vel_th = <span class="hljs-number">-1.0</span>, <span class="hljs-keyword">double</span> min_in_place_vel_th = <span class="hljs-number">0.4</span>,
          <span class="hljs-keyword">double</span> backup_vel = <span class="hljs-number">-0.1</span>,
          <span class="hljs-keyword">bool</span> dwa = <span class="hljs-literal">false</span>, <span class="hljs-keyword">bool</span> heading_scoring = <span class="hljs-literal">false</span>, <span class="hljs-keyword">double</span> heading_scoring_timestep = <span class="hljs-number">0.1</span>,
          <span class="hljs-keyword">bool</span> meter_scoring = <span class="hljs-literal">true</span>,
          <span class="hljs-keyword">bool</span> simple_attractor = <span class="hljs-literal">false</span>,
          <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt; y_vels = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt;(<span class="hljs-number">0</span>),
          <span class="hljs-keyword">double</span> stop_time_buffer = <span class="hljs-number">0.2</span>,
          <span class="hljs-keyword">double</span> sim_period = <span class="hljs-number">0.1</span>, <span class="hljs-keyword">double</span> angular_sim_granularity = <span class="hljs-number">0.025</span>);
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€é€Ÿåº¦ã¨è»Œé“å…¨ä½“ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ã®ä¾‹ã§ã™ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Œå…¨ãªè¨ˆç®—ã®ãŸã‚ã®é‡è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿world_modelã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ã‚¹ãƒˆãƒãƒƒãƒ—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼šæ½œåœ¨çš„ãªè¡çªã‚’è€ƒæ…®ã—ãŸã€éšœå®³ç‰©ã¨ãã®ã€Œä»®æƒ³æ‹¡å¼µã€ã‚’å«ã‚€ãƒãƒƒãƒ—ã¸ã®ãƒªãƒ³ã‚¯ã€‚ </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¨™æº–ã‚¹ã‚¿ãƒƒã‚¯ã®åˆ©ç‚¹ã®ä¸­ã§ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å¯ç”¨æ€§ã¨ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ã§æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹æ©Ÿèƒ½ã‚’å¼·èª¿ã§ãã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è©³ç´°ã«ã¤ã„ã¦ã¯ã€å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã€‚ROSãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯2è¼ªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ã«ä½œæˆã•ã‚Œã¦ãŠã‚Šã€360åº¦ã¾ã§ç§»å‹•ã™ã‚‹ã¨åˆ©ç”¨å¯èƒ½ãªå›è»¢è§’åº¦ãŒå¢—åŠ ã™ã‚‹ãŸã‚ã€ã‚ªãƒ ãƒ‹å‘ã‘ã«æœ€é©åŒ–ã•ã‚Œã¦</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ã„ã‚‹</font></a><font style="vertical-align: inherit;">ã“ã¨ã¯é‡è¦ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ†æã—ãŸçµæœã€å­¦ç¿’ã‚„è£œå……ãŒå›°é›£ã§ã‚ã‚‹ã ã‘ã§ãªãã€ä¸è¦ãªé‡ã„ãƒãƒƒãƒ—ãŒãŸãã•ã‚“ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã©ã†ã‚„ã‚‰ãã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ç§ãŸã¡ã¯Odroid xu4ï¼ˆSamsung s5ã«ã¾ã æ­è¼‰ã•ã‚Œã¦ã„ãŸãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®çµæœã¯æ†‚é¬±ã§ã€ã‚ˆã‚Šå¼·åŠ›ãªã‚‚ã®ï¼ˆãŠã‚ˆã³ãƒ©ã‚ºãƒ™ãƒªãƒ¼4ã¨jetson nanoãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ï¼‰ã®ã‚¹ãƒšãƒ¼ã‚¹ã¯ã€å½¼ã¨ä¸€ç·’ã«ï¼‰ã„ã„ãˆã€‚</font><font style="vertical-align: inherit;">æ¨™æº–ã‚¹ã‚¿ãƒƒã‚¯ã‚’æ”¾æ£„ã—ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€ãŠã‚ˆã³è»Œé“ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’è‡ªåˆ†ã§ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸ</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ij/qe/es/ijqeesrak1vuhjqfr1ij6exr4_a.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€è»Œé“ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã€ãã®ä»–ã™ã¹ã¦</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç›®çš„åœ°ã¸ã®ãƒ«ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹ã«ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãŠã‚ˆã³ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚°ãƒ©ã‚¤ãƒ€ãƒ¼ãŒå¿…è¦ã§ã™ã€‚ãªãœåˆ†é›¢ãŒå¿…è¦ãªã®ã§ã™ã‹ï¼Ÿãªãœ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A *</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ä¹—ã£ã¦ä¹—ã‚Œãªã„ã®ã§ã™ã‹ï¼ŸåŸå‰‡ã¨ã—ã¦ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã¯ãƒ«ãƒ¼ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹éš›ã«ã€ãƒãƒƒãƒ—å…¨ä½“ã‚’ä½œæ¥­ã«ä½¿ç”¨ã§ãã‚‹ãŸã‚ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯å¯èƒ½ãªé™ã‚Šé«˜é€Ÿã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ç°¡ç´ åŒ–ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«ã™ã‚‹ãŸã‚ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã‚‚ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆã¾ãŸã¯ãƒ­ãƒœãƒƒãƒˆã®å‘¨å›²ã®é™ã‚‰ã‚ŒãŸé ˜åŸŸï¼‰ã®çµæœã«åŸºã¥ã„ã¦ã€ã™ã¹ã¦ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã‚’è€ƒæ…®ã«å…¥ã‚Œã‚ˆã†ã¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ«ãƒ¼ãƒˆã‚’ä½œæˆã—ãŸå¾Œã€ãƒ­ãƒœãƒƒãƒˆãŒã©ã“ã«è¡Œãã¹ãã‹ãŒã‚ã‹ã‚Šã¾ã™ãŒã€ã“ã‚Œã«ã¤ã„ã¦å½¼ã«ã©ã®ã‚ˆã†ã«ä¼ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿã“ã‚Œã‚’è¡Œã†ã«ã¯ã€è»Œé“ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚è»Œè·¡ã‹ã‚‰é€¸è„±ã—ãªã„ã‚ˆã†ã«ã€ç¾æ™‚ç‚¹ã§ãƒ­ãƒœãƒƒãƒˆãŒç§»å‹•ã™ã‚‹é€Ÿåº¦ã¨æ–¹å‘ã‚’è¨ˆç®—ã—ã¾ã™ã€‚å¤šãã®ç‚¹ã§ã€ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€ãƒ­ãƒœãƒƒãƒˆãŒã©ã‚Œã»ã©é€Ÿãã¦ç¾ã—ã„ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®3ã¤ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã«åŠ ãˆã¦ã€4ã¤ç›®ã®ãƒãƒƒãƒ—ã‚µãƒ¼ãƒãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä¸–ç•Œã®çŠ¶æ…‹ã‚’ç°¡å˜ã«å‡¦ç†ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒãƒƒãƒ—ã®è¨˜è¿°æ–¹æ³•ã€ãƒãƒƒãƒ—ã‚’æ“ä½œã™ã‚‹ã¨ãã®å¯èƒ½æ€§ã‚’è¨­å®šã—ã€ã•ã¾ã–ã¾ãªæ–¹æ³•ã§ã‚°ãƒ©ã‚¤ãƒ€ãƒ¼ã®é€Ÿåº¦ã‚’æ±ºå®šã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒƒã‚¯ã®èª¬æ˜ã«é€²ã‚€å‰ã«ã€ãƒãƒƒãƒ—ã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦cost_mapãŒé¸æŠã•ã‚ŒãŸç†ç”±ã®æ¦‚è¦ã‚’èª¬æ˜ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚</font><font style="vertical-align: inherit;">ä¸€èˆ¬çš„ã«ã€ãƒãƒƒãƒ—ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®ã•ã¾ã–ã¾ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è©¦ã—ã¾ã—ãŸï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Occupancy_grid</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grid_map</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cost_map</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ãŒã€å¾Œè€…ã§è§£æ±ºã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŸå› ï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ°å›³ã‚’ä¾¿åˆ©ã«æ“ä½œã—ã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã•ã¾ã–ã¾ãªå½¢å¼ï¼ˆå††å½¢ã€ç·šå½¢ã€é•·æ–¹å½¢ãªã©ï¼‰ã§å¿…è¦ãªã•ã¾ã–ã¾ãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ç•°ãªã‚‹è¤‡æ•°ã®ãƒãƒƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä¿å­˜ã§ãã¾ã™ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å„ªã‚ŒãŸãƒ¡ãƒ¢ãƒªç®¡ç†ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãã—ã¦æœ€ã‚‚é‡è¦ãªã®ã¯ã€ã‚¹ãƒ”ãƒ¼ãƒ‰ã€‚</font><font style="vertical-align: inherit;">ã‚°ãƒªãƒƒãƒ‰ãƒãƒƒãƒ—ã¯doubleã‚¿ã‚¤ãƒ—ã§å‹•ä½œã—ã¾ã™ã€‚ãã®ãŸã‚ã€int8ã‚’ä½¿ç”¨ã—ã¦å‹•ä½œã™ã‚‹ãƒãƒƒãƒ—ã‚µãƒ¼ãƒãƒ¼ã‚ˆã‚Šã‚‚æ•°å€é…ããªã‚Šã¾ã™ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Occupancyã‚°ãƒªãƒƒãƒ‰ã‚‚int8ã§æ©Ÿèƒ½ã™ã‚‹ã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãã‚Œã¯åŒã˜ä½¿ã„ã‚„ã™ã•ã‚’èª‡ã‚‹ã“ã¨ãŒã§ããªã„ã®ã§ã€ç§ã¯ãã‚Œã‚’æ”¾æ£„ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ°å›³ã‹ã‚‰ã€è‡ªç”±ã§å±é™ºãªã€ãŸã¾ã‚‰ãªã„ã‚¾ãƒ¼ãƒ³ãŒã©ã“ã«ã‚ã‚‹ã‹ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šã«ã‚ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ã€è†¨å¼µãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’èª¿æ•´ã§ãã¾ã™ã€‚ã“ã®å€¤ã¯ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¾ã§ã®è·é›¢ã«å¿œã˜ã¦ã€ã‚»ãƒ«ã®é€éæ€§ã‚’ç‰¹å¾´ä»˜ã‘ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚¤ãƒ³ãƒ•ãƒ¬ã¯çŒ«ã®ã—ã£ã½ã§ã‚ã‚Šã€æ°—ã¥ã‹ãªã„ã“ã¨ã¯ç°¡å˜ã§ã™ãŒã€ãã‚Œã‚’éå¸¸ã«é•·ã„é–“å¾Œæ‚”ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ•µã®ãƒ­ãƒœãƒƒãƒˆã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã ã‘ãŒè€ƒæ…®ã«å…¥ã‚Œã‚‹å±é™ºã‚¾ãƒ¼ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã¯ã€éšœå®³ãŒãªã‘ã‚Œã°ã€ã™ã¹ã¦ã®ãƒã‚¤ãƒ³ãƒˆã‚’ç„¡è¦–ã—ã¾ã™ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½¼ã‚‰ãŒãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã§æœ€åˆã«æ›¸ã„ãŸã®ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã‚·ãƒ¼ã‚¿*ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¤ã¾ã‚Šã€ã“ã‚Œã¯ä¿®æ­£ã•ã‚ŒãŸ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A *</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã‚ã‚Šã€ç›´æ¥åˆ°é”ã§ãã‚‹è¦ªãƒãƒ¼ãƒ‰ã®æ¤œç´¢ã«é‡ç‚¹ãŒç½®ã‹ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å½¼å¥³ã«éšœå®³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã§ä½¿ç”¨ã•ã‚Œã‚‹ä¾¿åˆ©ã§ã‚¹ãƒ ãƒ¼ã‚ºãªãƒ‘ã‚¹ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/it/qs/e4/itqse4uuumbbzu8rxws07gapbn8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A *ã¨theta *ã®æ¯”è¼ƒ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã®å ´åˆã€ãƒãƒƒãƒ—ãƒˆãƒ”ãƒƒã‚¯ã¨ã™ã¹ã¦ã®ãƒ­ãƒœãƒƒãƒˆã®å ´æ‰€ã‚’å«ã‚€ãƒˆãƒ”ãƒƒã‚¯ï¼ˆparams / path_planner.yamlï¼‰ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆparams / path_planner.yamlï¼‰ãŒã‚ã‚Šã¾ã™ï¼ˆã€Œnullã€ã¯ã€ç¾åœ¨ã®ãƒ­ãƒœãƒƒãƒˆï¼‰ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"># small robot debug param list</span>
robot_id: <span class="hljs-string">"small"</span><font></font>
<font></font>
###########################<font></font>
# cost_map_server params ##<font></font>
###########################<font></font>
cost_map_server/big_robot_size: <span class="hljs-number">0.45</span>
cost_map_server/little_robot_size: <span class="hljs-number">0.45</span>
cost_map_server/cube_size: <span class="hljs-number">0.11</span>
cost_map_server/inscribed_radius: <span class="hljs-number">0.3</span>
cost_map_server/inflation_radius: <span class="hljs-number">0.3</span>
cost_map_server/inflation_exponential_rate: <span class="hljs-number">0.6</span>
cost_map_server/big_robot1: <span class="hljs-string">"/aruco/big_robot"</span>
cost_map_server/big_robot2: <span class="hljs-string">"/aruco/enemy_robot1"</span>
cost_map_server/small_robot1: <span class="hljs-string">"null"</span> 
cost_map_server/small_robot2: <span class="hljs-string">"/aruco/enemy_robot2"</span>
cost_map_server/collision: <span class="hljs-string">"collision"</span>
cost_map_server/image_resource_name: <span class="hljs-string">"$(find cost_map_server)/param/image_resource.yaml"</span>
cost_map_server/min_diff_points: <span class="hljs-number">0.01</span><font></font>
<font></font>
###########################<font></font>
### path_planner params ###<font></font>
###########################<font></font>
global_planner/path_layer: <span class="hljs-string">"inflation_layer"</span>
global_planner/path_force_layer: <span class="hljs-string">"obstacle_inflation_layer"</span>
global_planner/frame_id: <span class="hljs-string">"map"</span>
global_planner/current_position: <span class="hljs-string">"real_corr"</span>
global_planner/path_filter_epsilon: <span class="hljs-number">0</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€æ¬¡ã®ã“ã¨ã‚‚ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ«ãƒ¼ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«é¸æŠã§ãã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®1ã¤ã€ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ«ãƒ¼ãƒˆè‡ªä½“ã‚’æ§‹ç¯‰ã™ã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰ </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒç™ºè¡Œã•ã‚Œã‚‹ç§ãŸã¡ã®ä½ç½®ã«é–¢ã™ã‚‹ãƒˆãƒ”ãƒƒã‚¯ï¼ˆã“ã®å ´åˆã¯ã€ã‚«ãƒ¡ãƒ©ã‹ã‚‰ã®ä½ç½®ãƒ‡ãƒ¼ã‚¿ã¨ã‚ªãƒ‰ãƒ¡ãƒˆãƒªã®çµ„ã¿åˆã‚ã›ã§ã™ï¼‰ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ã‚¹æ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è‡ªä½“-ã‚·ãƒ¼ã‚¿ã‚¹ã‚¿ãƒ¼-ã¯ã€æ–°ã—ã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã«ã€åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsrc / global_planner.cppï¼‰ã§å¼·èª¿è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">float</span> cost_so_far[<span class="hljs-number">300</span>][<span class="hljs-number">200</span>];<font></font>
PriorityPoint neighbors[<span class="hljs-number">8</span>];<font></font>
PriorityPoint current;<font></font>
<span class="hljs-keyword">int</span> come_from[<span class="hljs-number">300</span>][<span class="hljs-number">200</span>][<span class="hljs-number">2</span>];<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">makePath_ThetaStar</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;cost_map::Index&gt; &amp;path, PriorityPoint start, PriorityPoint goal, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> layer, cost_map::CostMap &amp;cost_map, <span class="hljs-keyword">double</span> grid_cost, <span class="hljs-keyword">bool</span> only_cost)</span>
</span>{
  <span class="hljs-built_in">std</span>::priority_queue&lt;PriorityPoint, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;PriorityPoint&gt;, myCompare&gt; openSet;
  <span class="hljs-keyword">size_t</span> max_x = cost_map.getSize()[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">size_t</span> max_y = cost_map.getSize()[<span class="hljs-number">1</span>];
  <span class="hljs-built_in">std</span>::fill_n(*cost_so_far, max_x * max_y, <span class="hljs-built_in">std</span>::numeric_limits&lt;<span class="hljs-keyword">float</span>&gt;::max());<font></font>
  cost_so_far[start.x][start.y] = <span class="hljs-number">0</span>;<font></font>
  come_from[start.x][start.y][<span class="hljs-number">0</span>] = start.x;<font></font>
  come_from[start.x][start.y][<span class="hljs-number">1</span>] = start.y;<font></font>
  openSet.push(start);<font></font>
  grid_cost=<span class="hljs-number">5</span>;
  <span class="hljs-keyword">while</span> (!openSet.empty())<font></font>
  {<font></font>
    current = openSet.top();<font></font>
    openSet.pop();<font></font>
    <span class="hljs-keyword">if</span> (current == goal)<font></font>
    {<font></font>
      <span class="hljs-keyword">break</span>;<font></font>
    }<font></font>
    current.GetNeighbors(neighbors);<font></font>
    <span class="hljs-keyword">float</span> current_cost = cost_so_far[current.x][current.y];
    <span class="hljs-keyword">int</span> parent_carent[<span class="hljs-number">2</span>] ={come_from[current.x][current.y][<span class="hljs-number">0</span>], come_from[current.x][current.y][<span class="hljs-number">1</span>]};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<font></font>
    {<font></font>
      <span class="hljs-keyword">if</span> (!neighbors[i].OnMap(max_x, max_y))<font></font>
      {<font></font>
        <span class="hljs-keyword">continue</span>;<font></font>
      }<font></font>
      <span class="hljs-keyword">bool</span> onLine = lineOfSight(parent_carent[<span class="hljs-number">0</span>], parent_carent[<span class="hljs-number">1</span>], neighbors[i].x, neighbors[i].y, cost_map, layer, grid_cost + <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (onLine)<font></font>
      {<font></font>
        <span class="hljs-keyword">float</span> new_cost = cost_so_far[parent_carent[<span class="hljs-number">0</span>]][parent_carent[<span class="hljs-number">1</span>]] + HeuristicEvclid(parent_carent, neighbors[i], grid_cost*<span class="hljs-number">10</span>);
        <span class="hljs-keyword">if</span> (new_cost &lt; cost_so_far[neighbors[i].x][neighbors[i].y])<font></font>
        {<font></font>
          cost_so_far[neighbors[i].x][neighbors[i].y] = new_cost;<font></font>
          neighbors[i].priority = HeuristicEvclid(neighbors[i], goal, grid_cost*<span class="hljs-number">10</span>) + new_cost;<font></font>
          openSet.push(neighbors[i]);<font></font>
          come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number">0</span>] = parent_carent[<span class="hljs-number">0</span>];<font></font>
          come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number">1</span>] = parent_carent[<span class="hljs-number">1</span>];<font></font>
        }<font></font>
      }<font></font>
      <span class="hljs-keyword">else</span><font></font>
      {<font></font>
        <span class="hljs-keyword">float</span> neighbor_price = cost_map.at(layer, cost_map::Index({neighbors[i].x, neighbors[i].y})) + neighbors[i].priority;
        <span class="hljs-keyword">float</span> new_cost = current_cost + neighbor_price;
        <span class="hljs-keyword">if</span> (new_cost &lt; cost_so_far[neighbors[i].x][neighbors[i].y])<font></font>
        {<font></font>
          cost_so_far[neighbors[i].x][neighbors[i].y] = new_cost;<font></font>
          neighbors[i].priority =HeuristicEvclid(neighbors[i], goal, grid_cost*<span class="hljs-number">10</span>) + new_cost;<font></font>
          openSet.push(neighbors[i]);<font></font>
          come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number">0</span>] = current.x;<font></font>
          come_from[neighbors[i].x][neighbors[i].y][<span class="hljs-number">1</span>] = current.y;<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (only_cost)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> cost_so_far[current.x][current.y];<font></font>
  }<font></font>
  path.clear();<font></font>
  PriorityPoint temp_point;<font></font>
  <font></font>
  <span class="hljs-keyword">while</span> (current != start)<font></font>
  {<font></font>
    path.push_back({current.x, current.y});<font></font>
    temp_point.x = come_from[current.x][current.y][<span class="hljs-number">0</span>];<font></font>
    temp_point.y = come_from[current.x][current.y][<span class="hljs-number">1</span>];<font></font>
    current = temp_point;<font></font>
  }<font></font>
  path.push_back({current.x, current.y});<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€RamerDouglasPeuckerãƒ‘ã‚¹ã®ä½™åˆ†ãªãƒã‚¤ãƒ³ãƒˆã‚’å‰Šé™¤ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚‚å¼·èª¿è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
éš£æ¥ã™ã‚‹2ã¤ã®ç‚¹ã‚’çµã¶ç·šã‹ã‚‰æ‰€å®šã®è·é›¢ã‚ˆã‚Šã‚‚é ã„å ´åˆã€ãƒ‘ã‚¹ã‹ã‚‰ç‚¹ã‚’å‰Šé™¤ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/en/_9/dw/en_9dw6khdarxbyf7gvrhpqg7b4.jpeg"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 å½¼ã¯æ½œåœ¨çš„ãªåˆ†é‡ã§ã®å‹¾é…é™ä¸‹æ³•ã«åŸºã¥ã„ã¦ç§ãŸã¡ã®ãŸã‚ã«åƒã„ã¦ã„ã¾ã™ã€‚å…¥åŠ›ã¨ã—ã¦ã€ã“ã‚Œã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã‹ã‚‰ã®ãƒ‘ã‚¹ã§ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯å½¼ãŒã§ãã‚‹ã™ã¹ã¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ local_plannerã«ã¯ã€ãƒ‘ã‚¹æ§‹ç¯‰ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ãŸã‚ã®å†…éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚æ“ä½œã«ã¯2ã¤ã®ãƒ¢ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚ãƒãƒƒãƒ—ä¸Šã®è¤‡æ•°ã®ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«æ²¿ã£ã¦ãƒã‚¤ãƒ³ãƒˆã‚’ã‚·ãƒ•ãƒˆã™ã‚‹ãƒ¢ãƒ¼ãƒ‰ã¨ã€2ã¤ã®åº§æ¨™ã®å¢—åˆ†ã‚’ã™ãã«è¨ˆç®—ã—ã¦ãƒã‚¤ãƒ³ãƒˆã‚’ã‚»ãƒ¼ãƒ•ã‚¾ãƒ¼ãƒ³ã®ç«¯ã«ç§»å‹•ã™ã‚‹ã‚·ãƒ•ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚ãƒã‚¤ãƒ³ãƒˆãŒãã®ã‚ˆã†ãªã„ãã¤ã‹ã®ã‚¾ãƒ¼ãƒ³ã«è©²å½“ã™ã‚‹å ´åˆã¯ã€æœ€ã‚‚å®‰å…¨ã§ã‚ã‚‹ãŸã‚ã€äº¤å·®ç‚¹ã®å ´æ‰€ã«ç§»å‹•ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ“ä½œãƒ¢ãƒ¼ãƒ‰ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚å‰ã®åå¾©ã‹ã‚‰ã®ãƒ‘ã‚¹ã«éšœå®³ç‰©ãŒãªã„å ´åˆã¯ã€ãƒ‘ã‚¹ã‚’2 cmã”ã¨ã«åˆ†å‰²ã—ã€å‹¾é…ã«æ²¿ã£ã¦ç§»å‹•ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã¯ã€2ç•ªç›®ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼æ“ä½œãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2ç•ªç›®ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯éå¸¸ã«è»½é‡ã§ã‚ã‚Šã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã®ã‚ˆã†ã«ãƒ—ãƒ­ã‚»ãƒƒã‚µã«ã‚ã¾ã‚Šè² è·ã‚’ã‹ã‘ã¾ã›ã‚“ã€‚ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ã„ãã¤ã‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã€ãƒãƒƒãƒ—ã§ã®ã•ã¾ã–ã¾ãªæ“ä½œã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚ãŸã¨ãˆã°ã€é ‚ç‚¹ãŒ10 cmã”ã¨ã«è¦‹ã¤ã‹ã‚Šã€æœ€å¤§ã§4 cmã‚·ãƒ•ãƒˆã™ã‚‹ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã‚ˆã†ã¨ã—ã¾ã—ãŸã€‚ãã®å¾Œã€å–å¾—ã—ãŸã‚°ãƒ©ãƒ•ã§ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¦æœ€å°è·é›¢ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚ã“ã®å ´åˆã®çµ‚ç‚¹ã¯ã€æœ€ã‚‚è¿‘ã„ã‚ªãƒ•ã‚»ãƒƒãƒˆãƒã‚¤ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãŸã ã—ã€ãã®ã‚ˆã†ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã«é©ã—ã¦ã„ãŸãŸã‚ã€ã“ã®å®Ÿè£…ã‚’ä¸­æ­¢ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãŸã€å‹¾é…é™ä¸‹æ³•ã‚’ä½¿ç”¨ã—ã¦ã€æœ€åˆã‹ã‚‰ãƒ‘ã‚¹æ§‹ç¯‰ã‚’ä½¿ç”¨ã—ã¦ã¿ã¾ã—ãŸã€‚ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€æœ€åˆã«ä½œæˆã™ã‚‹ã“ã¨ã‚’æ±ºã‚ãŸã‚‚ã®ã§ã™ã€‚ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒæ‚ªãï¼ˆãƒ‘ã‚¹ã”ã¨ã«ã‚³ã‚¹ãƒˆãƒãƒƒãƒ—ã‚’ä½¿ç”¨ã—ãŸãŸã‚ã€ç´”ç²‹ãªRAMã®400 mbä»¥ä¸Šã‚’å ã‚ã¦ã„ã¾ã—ãŸï¼‰ã€é€Ÿåº¦ãŒé…ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚æœ€é©åŒ–ãŒä¸ååˆ†ãªãŸã‚ã«å‘¨æ³¢æ•°åˆ¶å¾¡ãŒç„¡åŠ¹ã«ãªã‚Šã€é€Ÿåº¦ã¯1ç§’ã‚ãŸã‚Š30å›æœªæº€ã§ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã®çµæœã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ¬ãƒ¼ãƒŠã®ãƒ‘ã‚¹ã«åŸºã¥ã„ã¦ã€ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å‹¾é…é™ä¸‹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ãã®çµæœã€è»½é‡ã§æ¯”è¼ƒçš„å˜ç´”ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚100ã€œ150 mbã®é ˜åŸŸã§æ¶ˆè²»ã•ã‚Œã‚‹RAMã®é‡ã¯ã€ãƒ‘ã‚¹ã®å“è³ªã€ä½œæ¥­æ™‚é–“ã€ãŠã‚ˆã³é–‹ç™ºã®æœ€åˆã®åå¾©ã‚ˆã‚Šã‚‚æ•°åˆ†ã®1ã§ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/sg/oq/mo/sgoqmogivjs8elhylt74oqjqrdw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒŠãƒ¼ã«ã‚ˆã‚‹ãƒ‘ã‚¹ã‚ªãƒ•ã‚»ãƒƒãƒˆã®ä¾‹</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã€‚global_plannerã¨ã¯ç•°ãªã‚Šã€local_plannerã«ã¯éå¸¸ã«å°‘æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€æœ€ã‚‚é‡è¦ãªã‚¿ã‚¹ã‚¯ãŒã™ã¹ã¦global_plannerã«ã‚ã‚‹ãŸã‚ã€å˜ç´”ã§ã‚ã‚‹ãŸã‚ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">grid_map_server/big_robot1 : <span class="hljs-number">0.4</span>
grid_map_server/big_robot2 : <span class="hljs-number">0.4</span>
grid_map_server/small_robot1 : <span class="hljs-number">0.4</span>
grid_map_server/small_robot2 : <span class="hljs-number">0.4</span>
local_planner/radius : <span class="hljs-number">0.15</span>
global_planner/frame_id : <span class="hljs-string">"map"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®å ´åˆã€ä»¥ä¸‹ã‚’æ§‹æˆã—ã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å„ãƒ­ãƒœãƒƒãƒˆã®ã‚»ãƒ¼ãƒ•ã‚¾ãƒ¼ãƒ³ã®åŠå¾„ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒŠã«ã‚ˆã‚‹æœ€å¤§ãƒ‘ã‚¹ã‚ªãƒ•ã‚»ãƒƒãƒˆã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒãƒƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ¥ã®ã‚¯ãƒ©ã‚¹ã§ã¯ã€ã™ã¹ã¦ã®æœ€ã‚‚é‡è¦ãªæ©Ÿèƒ½ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã€ãã‚Œã¯ãƒ‘ã‚¹ã®å†å¸°çš„ãªå†…è¨³ã§ã‚ã‚Šã€ã‚°ãƒ©ã‚¤ãƒ€ãƒ¼ã®ä½œæˆã¨ä»®æƒ³ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Planner</span>
{</span>
  <span class="hljs-keyword">public</span>:<font></font>
    Planner(<span class="hljs-keyword">double</span> inflation_radius_, <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> frame_id_)<font></font>
    {    <font></font>
      inflation_radius = inflation_radius_;<font></font>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">300</span>; i++)<font></font>
      {<font></font>
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">200</span>; j++)<font></font>
          our_map[i][j] = <span class="hljs-number">3000.0</span>;<font></font>
      }<font></font>
      OurPath-&gt;poses.resize(<span class="hljs-number">50</span>);<font></font>
      <font></font>
      geometry_msgs::Pose pose;<font></font>
      <font></font>
      pose.position.x = <span class="hljs-number">0.0</span>;<font></font>
      pose.position.y = <span class="hljs-number">0.0</span>;<font></font>
    <font></font>
      <span class="hljs-keyword">for</span>( <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++)<font></font>
      {<font></font>
        OurPath-&gt;poses[i].pose = pose;<font></font>
      }<font></font>
      <font></font>
      frame_id = frame_id_;<font></font>
    }<font></font>
    <span class="hljs-keyword">virtual</span> ~Planner() {  } 
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdatePath</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<font></font>
<font></font>
    ros::Publisher move_pub;  <font></font>
    ros::Publisher BigEnemyPub;<font></font>
    ros::Publisher LittleEnemyPub;<font></font>
    ros::Publisher local_path_publisher;<font></font>
    <font></font>
  <span class="hljs-keyword">protected</span>:<font></font>
<font></font>
    <span class="hljs-comment">// virtual double Calculate_Path_Len();</span><font></font>
<font></font>
    <span class="hljs-function">nav_msgs::Path* <span class="hljs-title">recursive_path</span><span class="hljs-params">(nav_msgs::Path *path, <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt; start, <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt; end,
              <span class="hljs-keyword">double</span> epsilon, <span class="hljs-keyword">int</span> &amp;index)</span>
    </span>{
      <span class="hljs-keyword">if</span> (CalcDistance(start, end) &lt; (epsilon) || path-&gt;poses.size() &gt; <span class="hljs-number">200</span>)
        <span class="hljs-keyword">return</span> path;<font></font>
<font></font>
      <span class="hljs-keyword">double</span> start_x = (start.first + end.first) / <span class="hljs-number">2.0</span>;
      <span class="hljs-keyword">double</span> start_y = (start.second + end.second) / <span class="hljs-number">2.0</span>;<font></font>
<font></font>
      index = find_out(path, start);<font></font>
<font></font>
      geometry_msgs::PoseStamped pose;<font></font>
      pose.pose.position.x = start_x;<font></font>
      pose.pose.position.y = start_y;<font></font>
      path-&gt;poses.insert(path-&gt;poses.begin() + index, pose);<font></font>
<font></font>
      recursive_path(path, start, <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;{start_x, start_y}, epsilon, index);<font></font>
      recursive_path(path, <span class="hljs-built_in">std</span>::pair&lt;<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>&gt;{start_x, start_y}, end, epsilon, index);<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find_out</span><span class="hljs-params">(nav_msgs::Path *path, pair_double point)</span>
    </span>{
      <span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; path-&gt;poses.size(); i++)
        <span class="hljs-keyword">if</span> (path-&gt;poses[i].pose.position.x == point.first &amp;&amp;<font></font>
          path-&gt;poses[i].pose.position.y == point.second)<font></font>
          <span class="hljs-keyword">return</span> ++i;
      <span class="hljs-keyword">return</span> index;<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_in_path</span><span class="hljs-params">(nav_msgs::Path* Path, geometry_msgs::PoseStamped pose, <span class="hljs-keyword">int</span>&amp; Index)</span>
    </span>{<font></font>
      Path-&gt;poses[Index % max_size] = pose;<font></font>
      Index++;<font></font>
    }<font></font>
<font></font>
<font></font>
    <span class="hljs-keyword">double</span> inflation_radius;
    <span class="hljs-keyword">double</span> our_map[<span class="hljs-number">300</span>][<span class="hljs-number">200</span>];<font></font>
<font></font>
    <span class="hljs-keyword">int</span> max_size = <span class="hljs-number">49</span>;<font></font>
    <font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> frame_id;<font></font>
<font></font>
    nav_msgs::Path *path = <span class="hljs-keyword">new</span> nav_msgs::Path;<font></font>
    nav_msgs::Path *OurPath = <span class="hljs-keyword">new</span> nav_msgs::Path; <font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LocalPlanningã‚¯ãƒ©ã‚¹ã¯ã“ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰ç¶™æ‰¿ã•ã‚Œã€ã‚°ãƒ©ã‚¤ãƒ€ãƒ¼ã®ã‚³ã‚¢å…¨ä½“ãŒé…ç½®ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒã‚¤ãƒ³ãƒˆã‚’ã‚»ãƒ¼ãƒ•ã‚¾ãƒ¼ãƒ³ã®ç«¯ã«ç§»å‹•ã—ã€ãƒ‘ã‚¹ã‚’ã©ã†å‡¦ç†ã™ã‚‹ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»–ã®ã™ã¹ã¦ã®é–¢æ•°ã¯åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«fichi.hppã§å¼·èª¿è¡¨ç¤ºã•ã‚Œã€gradient descentã¯potential_field.hppã§å¼·èª¿è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä»¥ä¸‹ã¯ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã§ã‚ã‚Šã€cost_mapãƒãƒƒãƒ—ã§æ½œåœ¨çš„ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">CalcAttractivePotential</span><span class="hljs-params">(grid_map::Index index, <span class="hljs-keyword">double</span> goalx, <span class="hljs-keyword">double</span> goaly)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sqrt</span>(<span class="hljs-built_in">pow</span>(index[<span class="hljs-number">0</span>] - goalx, <span class="hljs-number">2</span>) + <span class="hljs-built_in">pow</span>(index[<span class="hljs-number">1</span>] - goaly, <span class="hljs-number">2</span>));<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CalcPotential</span><span class="hljs-params">(<span class="hljs-keyword">double</span> startx, <span class="hljs-keyword">double</span> starty, <span class="hljs-keyword">double</span> goalx, <span class="hljs-keyword">double</span> goaly, cost_map::CostMap &amp;cost_map, <span class="hljs-keyword">double</span> (&amp;our_map)[<span class="hljs-number">300</span>][<span class="hljs-number">200</span>])</span>
</span>{
    <span class="hljs-comment">// Use some magic for normalisation of Field</span>
    <span class="hljs-keyword">double</span> max_distance = (CalcAttractivePotential(grid_map::Index(startx, starty), goalx, goaly) + <span class="hljs-number">15</span>);
    <span class="hljs-keyword">if</span> (max_distance == <span class="hljs-number">0.0</span>)<font></font>
    {<font></font>
        max_distance = <span class="hljs-number">0.01</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">for</span> (cost_map::CircleIterator iterator(cost_map, grid_map::Position(startx / <span class="hljs-number">100.0</span>, starty / <span class="hljs-number">100.0</span>), max_distance / <span class="hljs-number">100.</span>);<font></font>
            !iterator.isPastEnd(); ++iterator)<font></font>
    {<font></font>
        <span class="hljs-keyword">try</span><font></font>
        {<font></font>
            <span class="hljs-function">grid_map::Index <span class="hljs-title">index</span><span class="hljs-params">(*iterator)</span></span>;
            <span class="hljs-keyword">double</span> uf;<font></font>
            uf = cost_map.at(<span class="hljs-string">"obstacle_inflation_layer"</span>, *iterator);<font></font>
<font></font>
            <span class="hljs-comment">// if we on free podouble - field is more less then if it not free podouble</span>
            <span class="hljs-keyword">if</span> ( uf &gt;= <span class="hljs-number">10</span>)<font></font>
            {<font></font>
                uf = <span class="hljs-number">3000.0</span>; <span class="hljs-comment">// CP - is const variable</span><font></font>
            }<font></font>
            <span class="hljs-keyword">else</span>
                uf += CalcAttractivePotential(index, goalx, goaly)/max_distance * <span class="hljs-number">256</span>;<font></font>
<font></font>
            our_map[<span class="hljs-number">299</span>-index(<span class="hljs-number">0</span>)][<span class="hljs-number">199</span>-index(<span class="hljs-number">1</span>)] = uf;<font></font>
        }<font></font>
        <span class="hljs-keyword">catch</span>(<span class="hljs-built_in">std</span>::exception&amp; e)<font></font>
        {<font></font>
            ROS_INFO(<span class="hljs-string">"Exception! %s"</span>, e.what() );<font></font>
        }<font></font>
    }<font></font>
}</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è»Œé“ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€å¾Œã«é‡è¦ãªã®ã¯ã€è»Œé“ãƒ¬ã‚®ãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã™ã€‚å½¼ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ãƒ‘ã‚¹ã‚’ãƒ‘ã‚¹ã«å¤‰æ›ã—ã€ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã®é€Ÿåº¦ã‚’ä¸ãˆã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¦ãƒ¼ãƒ­ãƒœãƒƒãƒˆ2018ã®æ±ºå‹ã§ä½¿ç”¨ã—ãŸæœ€åˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã€åŠ é€Ÿã¨ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ³ã‚°pidã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®æ··åˆã§ã‚ã‚Šã€ãƒ™ã‚¯ãƒˆãƒ«ã¯ã€çµ‚ç‚¹ã¾ã§ã®è·é›¢ã‚’åŸºæº–ã«ã—ã¦ã€ãƒ‘ã‚¹ã®æ¬¡ã®ç‚¹ã«æ­£è¦åŒ–ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ã™ã‚‹ã«ã€Pidã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¯ã‚·ã‚¹ãƒ†ãƒ ã®3ã¤ã®çŠ¶æ…‹ã®åˆè¨ˆã§ã‚ã‚Šã€æ™‚ã€…ç™ºç”Ÿã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã¨ãƒ©ãƒ³ãƒ€ãƒ ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£ã«å½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã‚‰ã®é–¢æ•°ã¯çµŒé¨“çš„ã«é¸æŠã•ã‚Œã€ãƒ‘ã‚¹ã®çµ‚ç‚¹ã¾ã§ã®è·é›¢ã«ä¾å­˜ã—ã¾ã™ï¼ˆ2æ¬¡ã€3æ¬¡ã€é€†ã®å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€2æ¬¡ã§è§£æ±ºã—ã¾ã—ãŸï¼‰ã€‚ã“ã‚Œã¯ã†ã¾ãã„ãã¾ã—ãŸãŒã€ç§ãŸã¡ã«åˆã‚ãªã‹ã£ãŸå”¯ä¸€ã®ã“ã¨ã¯ã€ãƒ­ãƒœãƒƒãƒˆãŒæ¯ç§’0.7ãƒ¡ãƒ¼ãƒˆãƒ«ã‚’è¶…ãˆã‚‹é€Ÿåº¦ã§æ™‚é–“å†…ã«ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ããªã‹ã£ãŸã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ãã®æ™‚ãŒæ¥ãŸã¨ãã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å…¨ä½“ã‚’å†æ§‹ç¯‰ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ–°ã—ã„è»Œé“ã¸ã®é“ã®æœ€åˆã®åå¾©ã¯ã€ã“ã‚Œã‹ã‚‰è¡Œã†ãƒ™ã‚¯ãƒˆãƒ«ã®ç½®ãæ›ãˆã§ã—ãŸã€‚ã“ã‚Œã¯ã€ä¿‚æ•°ãŒç•°ãªã‚‹æ¬¡ã®3ã¤ã®ãƒ™ã‚¯ãƒˆãƒ«ã®åˆè¨ˆã§ã™ã€‚ 2ç•ªç›®ã®åå¾©ã§ã¯ã€Minimum Jerkã‚’ä½œæˆã—ã¾ã—ãŸã€‚ã¤ã¾ã‚Šã€ã“ã‚Œã¯5æ¬¡å¤šé …å¼ã®æ§‹æˆã§ã‚ã‚Šã€xåº§æ¨™ã¨yåº§æ¨™ã¯å„ãƒã‚¤ãƒ³ãƒˆã¸ã®åˆ°ç€æ™‚é–“ã«ä¾å­˜ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ho/mw/hd/homwhdagbnkgdlrigettcc6yook.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å›³ã¯ã€ã„ãšã‚Œã‹ã®åº§æ¨™ã®æ™‚é–“ä¾å­˜æ€§ã¨ã“ã®åº§æ¨™ã«æ²¿ã£ãŸé€Ÿåº¦ã®ã‚°ãƒ©ãƒ•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ã“ã®ã‚¿ã‚¤ãƒ—ã®è»Œé“ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¯ã€ã™ã¹ã¦ã®ä¿‚æ•°ãŒæ™‚é–“ã«åŸºã¥ã„ã¦è¨ˆç®—ã•ã‚ŒãŸå¤šé …å¼ã®å€¤ã§ã‚ã‚‹ãŸã‚ã€ç•°ãªã‚‹ä¿‚æ•°ã®é¸æŠã«ã‚ˆã‚‹æ“ä½œãŒå°‘ãªãã¦æ¸ˆã‚€ãŸã‚ã€ã‚ˆã‚Šé©ã—ã¦ã„ã¾ã™ã€‚ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã¯ã€ç¾åœ¨ã®é€Ÿåº¦ã¨åŠ é€Ÿã€å‡ºåŠ›é€Ÿåº¦ã¨åŠ é€Ÿã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è»Œé“ã‚’æ›¸ãç›´ã—ãŸçµæœã€ãƒ­ãƒœãƒƒãƒˆã®å¹³å‡é€Ÿåº¦ã‚’2å€ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã®2ã¤ã®ã‚±ãƒ¼ã‚¹ã¨åŒæ§˜ã«ã€ç°¡å˜ã«æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã€ã™ã¹ã¦ã®ä¸»è¦ãªæ©Ÿèƒ½ãŒåˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§å¼·èª¿è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šå›ã¯ã€PlannerTrajectoryã‚¯ãƒ©ã‚¹ãŒã€MinimumJerkã«åŸºã¥ã„ã¦è»Œé“ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">State</span> {</span>
    <span class="hljs-keyword">double</span> velocity;
    <span class="hljs-keyword">double</span> acceleration;<font></font>
<font></font>
    State(<span class="hljs-keyword">double</span> v_, <span class="hljs-keyword">double</span> a_) : velocity(v_), acceleration(a_) {}<font></font>
<font></font>
    State() {<font></font>
        velocity = <span class="hljs-number">0</span>;<font></font>
        acceleration = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
};<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PlannerTrajectory</span> {</span>
<span class="hljs-keyword">private</span>:<font></font>
    nav_msgs::Path global_path;<font></font>
    cost_map::CostMap *costmap_ptr;<font></font>
    geometry_msgs::PoseStamped Goal_pred;<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt; trajectory_x;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">double</span>&gt; trajectory_y;<font></font>
<font></font>
    <span class="hljs-keyword">double</span> average_velocity = <span class="hljs-number">80</span>; <span class="hljs-comment">// Defualt or get from param //</span>
    <span class="hljs-keyword">double</span> max_velocity = <span class="hljs-number">100</span>;
    <span class="hljs-keyword">double</span> coef_x[<span class="hljs-number">6</span>];
    <span class="hljs-keyword">double</span> coef_y[<span class="hljs-number">6</span>];
    <span class="hljs-keyword">int</span> frequency = <span class="hljs-number">30</span>; <span class="hljs-comment">// Defualt or get from param //</span>
    <span class="hljs-keyword">int</span> index;<font></font>
<font></font>
<span class="hljs-keyword">public</span>:<font></font>
<font></font>
    PlannerTrajectory(cost_map::CostMap *costmap_, <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> &amp;frequency_, <span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> &amp;max_velocity_,
                      <span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> &amp;average_velocity_) {<font></font>
        average_velocity = average_velocity;;<font></font>
        max_velocity = max_velocity_;<font></font>
        costmap_ptr = costmap_;<font></font>
        frequency = frequency_;<font></font>
        Goal_pred.pose.position.x = <span class="hljs-number">0.0</span>;<font></font>
        Goal_pred.pose.position.y = <span class="hljs-number">0.0</span>;<font></font>
    }</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†™çœŸã¯ã€ä½¿ç”¨ã™ã‚‹ã™ã¹ã¦ã®å®£è¨€ã•ã‚ŒãŸå¤‰æ•°ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆinclude / trajectory_regulator.hï¼‰ã§ã¯ã€ä»–ã®ã™ã¹ã¦ãŒå¼·èª¿è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒˆãƒ”ãƒƒã‚¯ã‹ã‚‰ãƒã‚¤ãƒ³ãƒˆã‚’å—ã‘å–ã‚Šã€æ¬¡ã®ãƒã‚¤ãƒ³ãƒˆã«é€²ã‚€ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ï¼ˆéšœå®³ç‰©ã«ã‚ã‚‹å ´åˆã€ãã‚Œã‹ã‚‰è¡Œãã¾ã›ã‚“ï¼‰ãã—ã¦ã€ã¯ã‚‹ã‹ã«ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROS Melodicã¸ã®ç§»è¡Œ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ˜¨å¹´ã¾ã§ã€ROS-ROS Kineticã®lteãƒªãƒªãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">å½¼ã¯ä¸€èˆ¬çš„ã«ç§ãŸã¡ã«é©ã—ã¦ã„ã¾ã—ãŸãŒã€æ¥å¹´å½¼ã®ã‚µãƒãƒ¼ãƒˆã¯çµ‚äº†ã—ã€ç§ãŸã¡ãŒå¿…è¦ã¨ã™ã‚‹å¤šãã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒROS Melodicå°‚ç”¨ã«å‡ºã¦ãå§‹ã‚ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">ãã—ã¦ã€ä½¿ç”¨ã—ã¦ã„ã‚‹costmap_serverãŒMelodicã®ä¸‹ã«ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ä¸­ã«å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¿ãƒƒã‚¯ã¯ä¼¼ã¦ã„ã¾ã™ãŒã€ãƒãƒƒãƒ—ã®å…ˆé ­ãŒåˆ¥ã®å ´æ‰€ã«ã‚ã‚Šã€ãƒãƒƒãƒ—è‡ªä½“ã®å€¤ãŒ0ã‹ã‚‰1ã¾ã§å¤‰åŒ–ã™ã‚‹ãŸã‚ã€ã‚°ãƒªãƒƒãƒ‰ãƒãƒƒãƒ—ã‚’é¸æŠã—ã¾ã—ãŸã€‚ã“ã‚Œã¯ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒƒã‚¯å…¨ä½“ã§å¤§ããªå•é¡Œã«ãªã£ã¦ã„ã¾ã™ã€‚ä»¥å‰ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ãŒ1ç§’é–“ã«50å›èµ·å‹•ã•ã‚ŒãŸå ´åˆï¼ˆå‘¨æ³¢æ•°åˆ¶é™ãŒã‚ã‚Šã€ã—ãŸãŒã£ã¦ã€1ã¤ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã®åŠåˆ†ã§ã‚‚ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ãŒã‚ã¾ã‚Šä½¿ç”¨ã•ã‚Œãªã‹ã£ãŸï¼‰ã€2ç§’ã”ã¨ã«é“ã‚’é–‹ãã€æ‚ªã„ã¨è¦‹ãªã—ã¾ã—ãŸï¼š1ã¤ã®ã‚³ã‚¢ã‚’å®Œå…¨ã«ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸã€‚ 2ç§’ã§ã€ãƒ­ãƒœãƒƒãƒˆã¯ãƒãƒƒãƒ—å…¨ä½“ã‚’æ¨ªåˆ‡ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ã“ã‚Œã¯ç§ãŸã¡ã«ã¯é©ã—ã¦ãŠã‚‰ãšã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¸¦åˆ—åŒ–ã™ã‚‹è©¦ã¿ã¯å¤±æ•—ã—ã¾ã—ãŸã€‚ãã‚Œä»¥é™ã€ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¯æ®‹ã£ã¦ã„ã¾ã›ã‚“ï¼ˆä¸¦åˆ—åŒ–ã®ã‚³ã‚¹ãƒˆã‚’è€ƒæ…®ã™ã‚‹ã¨ï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å æœ‰ã‚°ãƒªãƒƒãƒ‰ã‚’å„ªå…ˆã—ã¦ã‚°ãƒªãƒƒãƒ‰ãƒãƒƒãƒ—ã‚’ç ´æ£„ã—ã€ã‚¹ã‚¿ãƒƒã‚¯ã‚’å†åº¦å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font><font style="vertical-align: inherit;">æ–°ã—ã„å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸ-è¤‡æ•°ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒãƒƒãƒ—ã‚’åŒæ™‚ã«ä¿å­˜ã§ããªã„ï¼ˆãŸã¨ãˆã°ã€ã™ã¹ã¦ã®éšœå®³ç‰©ãŒã‚ã‚‹å®Œå…¨ãªãƒãƒƒãƒ—ã¨ã€å‹•çš„ãªéšœå®³ç‰©ã®ã¿ãŒã‚ã‚‹é™çš„ãªãƒãƒƒãƒ—ï¼‰ã€‚</font><font style="vertical-align: inherit;">ã‚³ãƒ¼ãƒ‰ã®åŠåˆ†ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸãŒã€ç‰¹ã«ä¿¡é ¼æ€§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã“ã®å•é¡Œã®ä»£æ›¿ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¢ã™ã“ã¨ã«ã—ã¾ã—ãŸã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ã‚¹ãƒˆãƒãƒƒãƒ—ã‚µãƒ¼ãƒãƒ¼</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é•·ã„æ¤œç´¢ã®çµæœã€ãƒ•ã‚©ãƒ¼ã‚¯ãƒãƒƒãƒ—costmap_serverrãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">//github.com/lelongg/cost_map.git-</font></a><font style="vertical-align: inherit;">ãƒ•ã‚©ãƒ¼ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã«éå¸¸ã«å½¹ç«‹ã¡ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/27/rb/oh/27rbohj3kefxprwtjqrg4mwtqjc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã—ã¦ä»Šã€ã‚°ãƒªãƒƒãƒ‰ãƒãƒƒãƒ—ã®ã¿ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ä»£ã‚ã‚Šã«ã€é…ä¿¡ã®ãŸã‚ã«ã€ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®äºˆæ¸¬ã«åŸºã¥ã„ã¦æ•µã®æ¨å®šä½ç½®ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/pm/nz/nipmnzvhcrqdje1cu8glf9quude.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒãƒƒãƒ—ã‚µãƒ¼ãƒãƒ¼ã§æœ€ã‚‚é‡è¦ãªã“ã¨ã®1ã¤ã¯ã€ã™ã¹ã¦ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æœ€åˆã®ä½œæˆã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ã“ã‚Œã¯ã€å¾Œã§ã®ã¿æ›´æ–°ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ãƒã‚¤ãƒŠãƒªpngç”»åƒã§ã€é»’ã¯éšœå®³ç‰©ã§ã€ç™½ã¯ãƒ•ãƒªãƒ¼ã‚¾ãƒ¼ãƒ³ã§ã™ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2b/l5/rg/2bl5rgpuecb7he51heslqpvcazm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cost_map_serveræ§‹æˆç”¨ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ•µã®ãƒã‚¤ãƒ³ãƒˆã€ã‚¤ãƒ³ãƒ•ãƒ¬ã‚¾ãƒ¼ãƒ³ã€æ­£æ–¹å½¢ã®ã‚µã‚¤ã‚ºãªã©ã®ãƒˆãƒ”ãƒƒã‚¯ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ã€æ•µã®å±é™ºãªã‚¾ãƒ¼ãƒ³ã‚’ãƒãƒƒãƒ—ã«é…ç½®ã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">###########################<font></font>
# cost_map_server params ##<font></font>
###########################<font></font>
cost_map_server/big_robot_size: <span class="hljs-number">0.4</span>
cost_map_server/little_robot_size: <span class="hljs-number">0.4</span>
cost_map_server/cube_size: <span class="hljs-number">0.11</span>
cost_map_server/inscribed_radius: <span class="hljs-number">0.25</span>
cost_map_server/inflation_radius: <span class="hljs-number">0.25</span>
cost_map_server/inflation_exponential_rate: <span class="hljs-number">0.6</span>
cost_map_server/big_robot1: <span class="hljs-string">"/aruco/robot1"</span>
cost_map_server/big_robot2: <span class="hljs-string">"/aruco/robot2"</span>
cost_map_server/small_robot1: <span class="hljs-string">"/aruco/robot3"</span> 
cost_map_server/small_robot2: <span class="hljs-string">"/aruco/robot4"</span>
cost_map_server/collision: <span class="hljs-string">"collision"</span>
cost_map_server/image_resource_name: <span class="hljs-string">"$(find cost_map_server)/param/image_resource.yaml"</span>
cost_map_server/min_diff_points: <span class="hljs-number">0.01</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€èª°ã‹ãŒã‚µãƒ–ã‚¹ã‚¯ãƒ©ã‚¤ãƒ–ã—ãŸå ´åˆã«ã®ã¿å…¬é–‹ã•ã‚Œã¾ã™ã€‚</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PublishChanges</span><span class="hljs-params">()</span>
    </span>{<font></font>
        nav_msgs::OccupancyGrid msg;<font></font>
        cost_map_msgs::CostMap cost_map_msg;<font></font>
        <span class="hljs-keyword">if</span> (obstacle_inflation_publisher.getNumSubscribers() &gt; <span class="hljs-number">0</span>)<font></font>
        {<font></font>
            cost_map::toOccupancyGrid(costmap, <span class="hljs-string">"obstacle_layer"</span>, msg);<font></font>
            obstacle_inflation_publisher.publish(msg);<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (inflation_publisher.getNumSubscribers() &gt; <span class="hljs-number">0</span>)<font></font>
        {<font></font>
            cost_map::toOccupancyGrid(costmap, <span class="hljs-string">"inflation_layer"</span>, msg);<font></font>
            inflation_publisher.publish(msg);<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (cost_map_publisher.getNumSubscribers() &gt; <span class="hljs-number">0</span>)<font></font>
        {<font></font>
            cost_map::toMessage(costmap, cost_map_msg);<font></font>
            cost_map_publisher.publish(cost_map_msg);<font></font>
        }<font></font>
    }</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§å®Ÿè¡Œã™ã‚‹</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ã‚¿ãƒƒã‚¯å…¨ä½“ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã“ã¨ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ROSã‚’ç½®ã </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roslaunch cost_map_server cost_map_server_alone.launch-ãƒãƒƒãƒ—ã‚’é–‹å§‹ã—ã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roslaunch global_planner global_planner.launch-ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ¬ãƒ¼ãƒŠã‚’èµ·å‹•ã—ã¾ã™</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosparam load $ï¼ˆlocal_plannerã‚’è¦‹ã¤ã‘ã‚‹ï¼‰/param/param.yaml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosrun local_planner local_planning</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosrun trajectory_regulator trajectory_regulator</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rosrun global_planner mover </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ­ã‚¹ãƒ©ãƒ³ãƒ»ãƒ«ãƒ“ã‚º </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inflation_layerã‚’è¿½åŠ  </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒˆãƒ”ãƒƒã‚¯/ gp /ã‚´ãƒ¼ãƒ«ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€ãƒ­ãƒœãƒƒãƒˆã‚’ç›®çš„ã®ãƒã‚¤ãƒ³ãƒˆã«é€ä¿¡ã—ã¾ã™ </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’èµ·å‹•ã—ãŸçµæœã¨ã—ã¦ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã§ã‚¹ã‚¿ãƒƒã‚¯ã‚’èµ·å‹•ã™ã‚‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æº–å‚™ãŒæ•´ã„ã¾ã™ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…è¦ãªãƒ•ã‚©ãƒ¼ã‚¯</font></font></a><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/iRY5WHgAFns" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“åˆã€ç§ãŸã¡ã¯ãƒ­ãƒœãƒƒãƒˆãŒç¾ã—ãã€è¿…é€Ÿã‹ã¤æ­£ç¢ºã«ã‚ªãƒ ãƒ‹ãƒ›ã‚¤ãƒ¼ãƒ«ã§èµ°è¡Œã™ã‚‹ã®ã‚’åŠ©ã‘ã‚‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã§ã—ãŸã€‚</font><font style="vertical-align: inherit;">å¤§ä¼šã®æº–å‚™ä¸­ã€æ€ªæˆ‘ã‚’ã—ãŸçŒ«ã¯ä¸€äººã‚‚ãŠã‚‰ãšã€ãƒ­ãƒœãƒƒãƒˆã¯ãƒãƒ³ã‚µãƒ ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãã®çµæœã€ãƒ¦ãƒ¼ãƒ­ãƒœãƒƒãƒˆã«ä¼¼ãŸã‚³ãƒ³ãƒ†ã‚¹ãƒˆç”¨ã®è»½é‡ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ãƒƒã‚¯ãŒã§ãã€ã“ã‚Œã¯éå¸¸ã«æº€è¶³ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã«ã¨ã£ã¦ã€ã“ã®ã‚¹ã‚¿ãƒƒã‚¯ã¯æ¨™æº–ã®ã‚‚ã®ã‚ˆã‚Šã‚‚å„ªã‚Œã¦ã„ã¾ã™ãŒã€... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç§ãŸã¡ã®é›»å ±ï¼št.me/SetUpSber </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ç§ãŸã¡ã®å‰µé€ æ€§ã®ãƒªãƒã‚¸ãƒˆãƒª</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/98/gl/4m/98gl4mdibk20qgavmhzkbdppu4w.jpeg"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479620/index.html">é€†è«–ç†</a></li>
<li><a href="../ja479622/index.html">Wavesãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã§ã®åŒ¿åãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ä»•çµ„ã¿</a></li>
<li><a href="../ja479624/index.html">Postgres Professionalã®gendar Oleg BartunovãŒFaride Roslovetsã«PostgreSQLã¨ãƒ­ã‚·ã‚¢ã§ã®ãƒ“ã‚¸ãƒã‚¹ã«ã¤ã„ã¦èªã£ãŸ</a></li>
<li><a href="../ja479626/index.html">ç‰©ç†å­¦è€…ãŒçŸ¥ã‚‰ãªã„ã²ã­ã‚Šã‚’åŠ ãˆãŸå…±æŒ¯å™¨</a></li>
<li><a href="../ja479630/index.html">æ³¨æ„ã®ãŸã‚ã«æˆ¦ã†</a></li>
<li><a href="../ja479642/index.html">ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ¦ã®é£›è¡Œæ©Ÿã‚’è¨­è¨ˆã™ã‚‹ã¨ãã®æ„šã‹ãªæ±ºå®šãŒMacintoshã®ä½œæˆã«ã¤ãªãŒã£ãŸæ–¹æ³•</a></li>
<li><a href="../ja479644/index.html">ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ†ã‚£ãƒƒã‚¯ã«é–¢ã™ã‚‹ç°¡å˜ãªå˜èª</a></li>
<li><a href="../ja479646/index.html">ä¸­ç´šå¾Œã‚‚è‹±èªã‚’å­¦ã³ç¶šã‘ã‚‹ãŸã‚ã®æ‚ªã„ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚„ç†ç”±</a></li>
<li><a href="../ja479650/index.html">ITãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ãƒˆãƒƒãƒ—12</a></li>
<li><a href="../ja479654/index.html">Django vueã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>