<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë¶ üíÑ üèñÔ∏è Optimalisasi rendering untuk Seluler üíáüèΩ üë©üèΩ‚Äçüé® üë≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo pembaca yang budiman, pecinta dan profesional pemrograman grafis! Kami menyampaikan kepada Anda serangkaian artikel yang ditujukan untuk optimali...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Optimalisasi rendering untuk Seluler</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playrix/blog/492874/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo pembaca yang budiman, pecinta dan profesional pemrograman grafis! Kami menyampaikan kepada Anda serangkaian artikel yang ditujukan untuk optimalisasi rendering untuk perangkat seluler: ponsel dan tablet berbasis iOS dan Android. Siklus akan terdiri dari tiga bagian. Pada bagian pertama, kita akan memeriksa fitur-fitur </font><font style="vertical-align: inherit;">arsitektur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GPU yang </font><font style="vertical-align: inherit;">populer di Mobile </font><font style="vertical-align: inherit;">. Dalam yang kedua, kita akan membahas keluarga utama GPU yang disajikan dalam perangkat modern, dan mempertimbangkan kekuatan dan kelemahan mereka. Pada bagian ketiga, kita akan berkenalan dengan fitur optimasi shader. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, mari kita ke bagian pertama.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengembangan kartu video pada desktop dan konsol terjadi tanpa adanya batasan yang signifikan pada konsumsi daya. Dengan munculnya kartu video untuk perangkat seluler, para insinyur dihadapkan dengan tugas untuk memastikan kinerja yang dapat diterima pada resolusi desktop yang sebanding, sementara konsumsi daya kartu video tersebut harus 2 kali lipat lebih rendah.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/51e/4fa/969/51e4fa969a3e5ede3b31064499c33226.png"></div><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solusinya ditemukan dalam arsitektur khusus yang disebut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tile Based Rendering (TBR)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bagi seorang programmer grafis yang berpengalaman dalam pengembangan PC, ketika ia berkenalan dengan pengembangan mobile, semuanya tampak akrab: OpenGL ES API serupa digunakan, struktur yang sama dari pipa grafis. Namun, arsitektur ubin GPU seluler secara signifikan berbeda dari yang digunakan pada konsol </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PC / </font><b><font style="vertical-align: inherit;">Segera</font></b><font style="vertical-align: inherit;"> . Mengetahui kekuatan dan kelemahan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TBR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan membantu Anda membuat keputusan yang tepat dan mendapatkan kinerja hebat dengan Mobile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah ini adalah diagram yang disederhanakan dari pipa grafis klasik yang digunakan pada PC dan konsol untuk dekade ketiga.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/281/67b/5e2/28167b5e2eaa4746ebd1ed45f8aa2dfb.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap pemrosesan geometri, atribut vertex dibaca dari memori video GPU. Setelah berbagai transformasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Vertex Shader),</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primitif siap-render dalam urutan asli (FIFO) diteruskan ke rasterizer, yang membagi primitif menjadi piksel. Setelah itu, langkah pemrosesan fragmen dari setiap piksel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Fragment Shader)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dilakukan </font><font style="vertical-align: inherit;">, dan nilai warna yang diperoleh ditulis ke buffer layar, yang juga terletak di memori video. Fitur arsitektur tradisional </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Mode Segera"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah rekaman hasil Fragmen Shader di bagian sewenang-wenang buffer layar saat memproses satu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panggilan undian.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dengan demikian, untuk setiap panggilan undian, akses ke seluruh buffer layar mungkin diperlukan. Bekerja dengan array memori yang besar membutuhkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bandwidth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bus yang sesuai ( </font><b><font style="vertical-align: inherit;">bandwidth</font></b><font style="vertical-align: inherit;"> ) dan dikaitkan dengan konsumsi daya yang tinggi. Karena itu, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seluler </font><font style="vertical-align: inherit;">mulai mengambil pendekatan yang berbeda. Pada arsitektur ubin khas kartu video seluler, rendering dilakukan dalam sepotong kecil memori yang sesuai dengan bagian layar - ubin. Ukuran ubin yang kecil (mis. 16x16 piksel untuk kartu video Mali, 32x32 untuk PowerVR) memungkinkan Anda untuk menempatkannya langsung pada chip kartu video, yang membuat kecepatan akses sebanding dengan kecepatan akses ke register inti shader, mis. sangat cepat.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/86d/7bf/c65/86d7bfc65e53739ab9be0d5ea1242c0e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, karena primitif dapat jatuh ke bagian sewenang-wenang dari buffer layar, dan ubin hanya mencakup sebagian kecil saja, diperlukan langkah tambahan dalam pipa grafis. </font><font style="vertical-align: inherit;">Berikut ini adalah diagram yang disederhanakan tentang cara kerja pipa dengan arsitektur ubin.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/531/ea5/00c/531ea500c507eb47558676582e20c94c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memproses simpul dan membangun primitif, yang terakhir, bukannya dikirim ke pipa fragmen, jatuh ke dalam apa yang disebut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiler</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Di sini primitif didistribusikan oleh ubin, ke dalam piksel yang jatuh. </font><font style="vertical-align: inherit;">Setelah distribusi seperti itu, yang, sebagai suatu peraturan, mencakup semua panggilan draw yang diarahkan ke satu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frame Buffer Object</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (alias </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Render Target</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), ubin akan secara berurutan dirender. </font><font style="vertical-align: inherit;">Untuk setiap ubin, urutan tindakan berikut dilakukan:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memuat konten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lama </font><font style="vertical-align: inherit;">dari memori sistem ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memuat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuat primitif jatuh ke ubin ini</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengunggah konten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> baru </font><font style="vertical-align: inherit;">ke memori sistem ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Store</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ea/20b/74b/9ea20b74b9fb716af30d5e0fa4ee1b34.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perlu dicatat bahwa </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Load</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat dianggap sebagai superposisi tambahan dari "tekstur layar penuh" tanpa kompresi. </font><font style="vertical-align: inherit;">Jika memungkinkan, hindari operasi ini, mis. </font><font style="vertical-align: inherit;">Jangan izinkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk </font><font style="vertical-align: inherit;">bolak-balik. </font><font style="vertical-align: inherit;">Jika </font><font style="vertical-align: inherit;">semua kontennya dibersihkan </font><font style="vertical-align: inherit;">sebelum rendering di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Load</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak dilakukan. </font><font style="vertical-align: inherit;">Namun, untuk mengirim sinyal yang benar ke pengemudi, parameter pembersihan tersebut harus memenuhi kriteria tertentu:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Harus dinonaktifkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scissor Rect</font></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merekam di semua saluran warna dan alfa harus diizinkan.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mencegah </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk buffer kedalaman dan stensil, mereka juga perlu dibersihkan sebelum dimulainya rendering. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dimungkinkan juga untuk menghindari operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Store</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk buffer kedalaman / stensil. </font><font style="vertical-align: inherit;">Lagi pula, isi buffer ini tidak ditampilkan dengan cara apa pun di layar. </font><font style="vertical-align: inherit;">Sebelum operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glSwapBuffers</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><b><font style="vertical-align: inherit;">Anda</font></b><font style="vertical-align: inherit;"> dapat menghubungi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glDiscardFramebufferEXT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glInvalidateFramebuffer</font></font></b><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> GLenum attachments[] = {GL_DEPTH_ATTACHMENT, GL_STENCIL_ATTACHMENT};<font></font>
glDiscardFramebufferEXT (GL_FRAMEBUFFER, <span class="hljs-number">2</span>, attachments);</code></pre><br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> GLenum attachments[] = {GL_DEPTH_ATTACHMENT, GL_STENCIL_ATTACHMENT};<font></font>
glInvalidateFramebuffer(GL_FRAMEBUFFER, <span class="hljs-number">2</span>, attachments);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada skenario rendering di mana penempatan buffer kedalaman / stensil, serta </font><font style="vertical-align: inherit;">buffer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam memori sistem tidak diperlukan. Misalnya, jika rendering dalam </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan buffer kedalaman kontinu, dan informasi kedalaman dari frame sebelumnya tidak digunakan, maka buffer kedalaman tidak perlu dimuat ke dalam memori petak sebelum dimulainya rendering, atau dibongkar setelah selesai rendering. Oleh karena itu, memori sistem tidak dapat dialokasikan di bawah buffer kedalaman. API grafik modern seperti </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vulkan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memungkinkan Anda untuk secara eksplisit mengatur mode memori untuk rekan-rekan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anda </font><font style="vertical-align: inherit;"> &nbsp;( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MTLStorageModeMemoryless</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metal, VK_IMAGE_USAGE_TRANSIENT_ATTACHMENT_BIT +</font></font></b> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VK_MEMORY_PROPERTY_LAZILY_ALLOCATED_BIT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vulkan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang perlu diperhatikan adalah implementasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada arsitektur ubin. Buffer resolusi tinggi untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak meninggalkan memori ubin dengan memisahkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke ubin lainnya. Misalnya, untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA 2x2,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ubin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16x16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan diselesaikan sebagai </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8x8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> selama </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Store</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mis. Secara total, akan diperlukan untuk memproses ubin 4 kali lebih banyak. Tetapi memori tambahan untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak diperlukan, dan karena rendering dalam memori ubin cepat tidak akan ada batasan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bandwidth yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> signifikan </font><b><font style="vertical-align: inherit;">.</font></b><font style="vertical-align: inherit;"> Namun gunakan</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MSAA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada arsitektur ubin meningkatkan beban pada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiler,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang dapat memengaruhi kinerja rendering adegan secara negatif dengan banyak geometri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meringkas di atas, kami menyajikan skema yang diinginkan bekerja dengan FBO pada arsitektur ubin:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">// 1.   ,    auxFBO</span><font></font>
glBindFramebuffer(GL_FRAMEBUFFER, auxFBO);<font></font>
glDisable(GL_SCISSOR);<font></font>
glColorMask(GL_TRUE, GL_TRUE, GL_TRUE, GL_TRUE);<font></font>
glDepthMask(GL_TRUE);<font></font>
<span class="hljs-comment">// glClear,     </span><font></font>
glClear(GL_COLOR_BUFFER_BIT |&nbsp;GL_DEPTH_BUFFER_BIT |&nbsp;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GL_STENCIL_BUFFER_BIT);<font></font>
<font></font>
renderAuxFBO();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font></font>
<font></font>
<span class="hljs-comment">//   /      </span>
glInvalidateFramebuffer(GL_FRAMEBUFFER, <span class="hljs-number">2</span>, depth_and_stencil);
<span class="hljs-comment">// 2.   mainFBO</span><font></font>
glBindFramebuffer(GL_FRAMEBUFFER, mainFBO);<font></font>
glDisable(GL_SCISSOR);<font></font>
<font></font>
glClear(...);<font></font>
<span class="hljs-comment">//   mainFBO    auxFBO</span><font></font>
renderMainFBO(auxFBO);<font></font>
<font></font>
glInvalidateFramebuffer(GL_FRAMEBUFFER, <span class="hljs-number">2</span>, depth_and_stencil);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda beralih ke rendering </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auxFBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di tengah formasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mainFBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anda bisa mendapatkan </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Load &amp; Store yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak perlu </font><font style="vertical-align: inherit;">, yang secara signifikan dapat meningkatkan waktu pembentukan frame. </font><font style="vertical-align: inherit;">Dalam praktik kami, kami mengalami perlambatan dalam merender bahkan dalam kasus pengaturan FBO idle, mis. </font><font style="vertical-align: inherit;">tanpa membuat aktual di dalamnya. </font><font style="vertical-align: inherit;">Karena arsitektur mesin, sirkuit lama kami tampak seperti ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   mainFBO</span><font></font>
glBindFramebuffer(GL_FRAMEBUFFER, mainFBO);<font></font>
<span class="hljs-comment">//   </span><font></font>
glBindFramebuffer(GL_FRAMEBUFFER, auxFBO);<font></font>
<span class="hljs-comment">//  auxFBO</span><font></font>
renderAuxFBO();<font></font>
<font></font>
glBindFramebuffer(GL_FRAMEBUFFER, mainFBO);<font></font>
<span class="hljs-comment">//   mainFBO</span><font></font>
renderMainFBO(auxFBO);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun kurangnya panggilan gl setelah instalasi pertama </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mainFBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pada beberapa perangkat kami mendapat </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Load &amp; Store</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ekstra </font><font style="vertical-align: inherit;">dan kinerja yang lebih buruk. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk meningkatkan pemahaman kami tentang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">overhead</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perantara </font><font style="vertical-align: inherit;">, kami mengukur kehilangan waktu untuk beralih </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> layar penuh </font><font style="vertical-align: inherit;">menggunakan tes sintetis. Tabel menunjukkan waktu yang dihabiskan untuk </font><font style="vertical-align: inherit;">operasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Store</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ketika beralih </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FBO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beberapa kali </font><font style="vertical-align: inherit;">dalam satu frame (waktu satu operasi seperti itu diberikan). </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ada operasi pemuatan karena </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">glClear</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yaitu </font><font style="vertical-align: inherit;">skenario yang lebih menguntungkan diukur. </font><font style="vertical-align: inherit;">Izin yang digunakan pada perangkat berkontribusi. </font><font style="vertical-align: inherit;">Itu bisa kurang lebih sesuai dengan kekuatan GPU yang diinstal. </font><font style="vertical-align: inherit;">Oleh karena itu, angka-angka ini hanya memberikan gambaran umum tentang seberapa mahal peralihan target pada kartu video seluler dari berbagai generasi.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">milidetik</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPU</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">milidetik</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 320</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 512</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,74</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR G6200</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 615</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-400</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adreno 530</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-t720</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-g51</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,32</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerVR SXG 544</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mali-t830</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,15</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berdasarkan data yang diperoleh, kami dapat merekomendasikan untuk tidak menggunakan lebih dari satu atau dua sakelar FBO per frame, setidaknya untuk kartu video yang lebih lama. Jika game memiliki kode akses terpisah untuk perangkat Low-End, disarankan untuk tidak menggunakan perubahan FBO di sana. Namun, pada Low-End, masalah penurunan resolusi sering menjadi relevan. Di Android, Anda dapat menurunkan resolusi rendering tanpa menggunakan FBO perantara dengan memanggil </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SurfaceHolder.setFixedSize ():</font></font></b><br>
<br>
<pre><code class="java hljs">surfaceView.getHolder().setFixedSize(...)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Metode ini tidak akan berfungsi jika game diberikan melalui </font><font style="vertical-align: inherit;">aplikasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surface</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utama </font><font style="vertical-align: inherit;">(skema khas untuk bekerja dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NativeActivity</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Jika Anda menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permukaan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utama </font><b><font style="vertical-align: inherit;">,</font></b><font style="vertical-align: inherit;"> resolusi lebih rendah dapat ditetapkan dengan memanggil fungsi asli </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANativeWindow_setBuffersGeometry.</font></font></b><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">JNIEXPORT <span class="hljs-keyword">void</span> JNICALL <span class="hljs-title">Java_com_organization_app_AppNativeActivity_setBufferGeometry</span><span class="hljs-params">(JNIEnv *env, jobject thiz, jobject surface, jint width, jint height)</span>
</span>{<font></font>
ANativeWindow* window = ANativeWindow_fromSurface(env, surface);&nbsp;<font></font>
ANativeWindow_setBuffersGeometry(window, width, height, AHARDWAREBUFFER_FORMAT_R8G8B8X8_UNORM);&nbsp;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di Jawa:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBufferGeometry</span><span class="hljs-params">(Surface surface, <span class="hljs-keyword">int</span> width , <span class="hljs-keyword">int</span> height )</span></span>;&nbsp;<font></font>
...<font></font>
<span class="hljs-comment">//   SurfaceHolder.Callback</span>
<span class="hljs-meta">@Override</span> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">surfaceChanged</span><span class="hljs-params">(SurfaceHolder holder, <span class="hljs-keyword">int</span> format, <span class="hljs-keyword">int</span> width, <span class="hljs-keyword">int</span> height)</span>
</span>{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setBufferGeometry(holder.getSurface(), <span class="hljs-number">768</span>, <span class="hljs-number">1366</span>); <span class="hljs-comment">/* ... */</span>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terakhir, kami menyebutkan perintah ADB yang mudah untuk mengendalikan buffer permukaan yang dipilih di Android:</font></font><br>
<br>
<pre><code class="plaintext hljs">adb shell dumpsys surfaceflinger
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda bisa mendapatkan kesimpulan serupa yang memungkinkan Anda memperkirakan konsumsi memori untuk buffer permukaan:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/524/2fe/ea6/5242feea615abe186c6c3538c9d60565.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tangkapan layar menunjukkan sistem menyoroti 3 buffer untuk buffering tiga kali lipat pada </font><font style="vertical-align: inherit;">game </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLSurfaceView</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (disorot dengan warna kuning), serta 2 buffer untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permukaan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utama </font><font style="vertical-align: inherit;">(disorot dengan warna merah). </font><font style="vertical-align: inherit;">Dalam hal rendering melalui Surface utama, yang merupakan skema default saat menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NativeActivity</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alokasi buffer tambahan dapat dihindari.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu saja untuk saat ini. </font><font style="vertical-align: inherit;">Dalam artikel berikut, kami akan mengklasifikasikan GPU seluler, serta menganalisis metode untuk mengoptimalkan shader untuknya.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id492862/index.html">15 tips penyempurnaan kinerja Oracle APEX terbaik untuk pengembang</a></li>
<li><a href="../id492864/index.html">Bisakah saya meretas kapal?</a></li>
<li><a href="../id492866/index.html">Buku "Mesin Belajar tanpa kata-kata"</a></li>
<li><a href="../id492868/index.html">Optimasi string di ClickHouse. Laporan Yandex</a></li>
<li><a href="../id492872/index.html">Bagaimana mengatur akses jarak jauh dan tidak menderita peretas</a></li>
<li><a href="../id492878/index.html">Sandal geek: mencari positif dalam penutupan kantor sementara</a></li>
<li><a href="../id492880/index.html">Apa yang harus kita bangun rumah pintar?</a></li>
<li><a href="../id492884/index.html">Menerima pesan dari siaran youtube + otorisasi google dalam PHP</a></li>
<li><a href="../id492886/index.html">Resep penguji perekrutan massal</a></li>
<li><a href="../id492888/index.html">Mengapa Anda tidak menggunakan WireGuard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>