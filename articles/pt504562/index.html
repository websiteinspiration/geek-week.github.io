<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐯 🎩 👟 Backup incremental do Proxmox VE com VBR 🧔🏻 🎛️ 👩🏽‍🤝‍👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em um dos artigos anteriores da série de hypervisor Proxmox VE, já falamos sobre como fazer backup usando ferramentas regulares. Hoje, mostramos como ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Backup incremental do Proxmox VE com VBR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/504562/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/6u/nl/ol/6unlolfmjashv0lotsjhjbgc1gg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em um dos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigos anteriores</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da série de hypervisor Proxmox VE, já falamos sobre como fazer backup usando ferramentas regulares. </font><font style="vertical-align: inherit;">Hoje, mostramos como usar a excelente ferramenta Veeam® Backup &amp; Replication ™ 10. Para o mesmo objetivo: </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Os backups têm uma essência quântica explícita. </font><font style="vertical-align: inherit;">Até você tentar se recuperar do backup, ele está em superposição. </font><font style="vertical-align: inherit;">Ele é bem sucedido e não. </font><font style="vertical-align: inherit;">(encontrado na Internet)</font></font></i><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isenção de responsabilidade:</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Não, não estou dizendo que esta é a maneira perfeita de fazer backup. Não, não pode ser recomendado para produção. Não, não garanto a perfeita integridade dos backups feitos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, tudo isso funciona e é bastante adequado para muitos usuários e administradores de sistemas iniciantes que dão os primeiros passos no estudo de sistemas de virtualização e backup. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O backup é talvez um dos processos mais importantes dos quais depende o trabalho de qualquer empresa. Não há nada mais caro que os dados armazenados nos sistemas de informações corporativos e nada pior que a falta de capacidade de recuperá-los em caso de falha.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muitas vezes acontece que você precisa pensar na necessidade de backup e escolher uma ferramenta somente após uma emergência que já ocorreu, associada à perda de dados críticos. </font><font style="vertical-align: inherit;">À medida que o desenvolvimento das tecnologias de virtualização, os aplicativos de backup começaram a se concentrar na interação próxima com os hipervisores. </font><font style="vertical-align: inherit;">O Veeam® Backup &amp; Replication ™ não é exceção, com diversas opções de backup em ambientes virtualizados. </font><font style="vertical-align: inherit;">Hoje, mostraremos como configurá-lo para funcionar com o Proxmox VE.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuração do Hypervisor</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usaremos a versão atual do Proxmox no momento da redação deste documento - 6.2-1. </font><font style="vertical-align: inherit;">Esta versão foi lançada em 12 de maio de 2020 e contém muitas alterações úteis, as quais discutiremos em um dos seguintes artigos. </font><font style="vertical-align: inherit;">Por enquanto, vamos começar a preparar o hypervisor. </font><font style="vertical-align: inherit;">A principal tarefa é instalar o Veeam® Agent for Linux em um host redundante com o Proxmox. </font><font style="vertical-align: inherit;">Mas antes disso, damos alguns passos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preparação do sistema</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instalamos </font><font style="vertical-align: inherit;">o </font><font style="vertical-align: inherit;">utilitário </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sudo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que está ausente no sistema se o Proxmox não estiver instalado em um sistema Linux existente, mas como um sistema operacional independente a partir de uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem oficial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Também precisaremos de cabeçalhos de kernel pve. </font><font style="vertical-align: inherit;">Vamos ao servidor através do SSH e adicionamos um repositório que funciona sem uma assinatura de suporte (oficialmente não é recomendado para produção, mas contém os pacotes que precisamos):</font></font><br>
<br>
<pre><code class="plaintext hljs">echo "deb http://download.proxmox.com/debian/pve buster pve-no-subscription" &gt;&gt; /etc/apt/sources.list</code></pre><br>
<pre><code class="plaintext hljs">apt update</code></pre><br>
<pre><code class="plaintext hljs">apt install sudo pve-headers</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Após esse procedimento, reinicie o servidor.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instale o Veeam® Agent</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faça </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> download </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">do pacote deb do</font></a><font style="vertical-align: inherit;"> Veeam® Agent for Linux no site oficial (é necessária uma conta), arme-se com um cliente SFTP e faça o upload do pacote deb recebido no servidor. </font><font style="vertical-align: inherit;">Instale o pacote e atualize a lista de programas nos repositórios que este pacote adiciona:</font></font><br>
<br>
<pre><code class="plaintext hljs">dpkg -i veeam-release-deb_1.x.x_amd64.deb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atualizando os repositórios novamente:</font></font><br>
<br>
<pre><code class="plaintext hljs">apt update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instale o próprio agente:</font></font><br>
<br>
<pre><code class="plaintext hljs">apt install veeam</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos se tudo foi instalado corretamente:</font></font><br>
<br>
<pre><code class="plaintext hljs">dkms status</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A resposta seria algo como isto:</font></font><br>
<br>
<pre><code class="plaintext hljs">veeamsnap, 4.0.0.1961, 5.4.41-1-pve, x86_64: installed</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurando o Veeam® Backup &amp; Replication ™</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionando um repositório</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, você também pode armazenar backups diretamente no servidor com o Veeam® Backup &amp; Replication ™ implantado, mas é mais conveniente usar o armazenamento externo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vá para a seção </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INFRAESTRUTURA DE BACKUP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/n0/do/z9/n0doz9jyudpcf-hayqu6njcstng.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione o item Repositórios de Backup, clique no botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar Repositório</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e selecione </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armazenamento conectado à rede</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na janela que aparece </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ds/le/ew/dsleewxwyfrbxi64ibhnkgbl3hm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, vamos fazer um teste de armazenamento SMB, tenho este é o QNAP usual:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/2v/75/wn2v75pnyilvwfm2wdnez0gff3e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Preencha o nome e a descrição e clique no botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/lu/c1/aeluc1vlc3rjv8yfjkkegksfqak.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Digite o endereço do armazenamento SMB e, se precisar de autorização, clique em Adicionar para adicionar detalhes de acesso:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/5g/5n/ku5g5nrjheqx_loj6dicmfylzmm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Preencha o nome de usuário e a senha para acessar o armazenamento SMB, clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e retorne à janela anterior, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/z5/ty/dqz5tyipy4tpabxyce7azqvwbos.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se tudo for feito sem erros, o programa se conectará ao repositório, solicitará informações sobre o espaço em disco disponível e exibirá a seguinte caixa de diálogo. </font><font style="vertical-align: inherit;">Nele, defina parâmetros adicionais (se necessário) e clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ed/gd/mk/edgdmktah8gzp2ficmybhka_qio.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na próxima janela, você pode deixar todas as configurações padrão e também clicar em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/-5/xh/ob-5xhmenemijzrsdka1lonr4a4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos se os componentes necessários estão instalados e se o status </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">já existe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e clique no botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/0a/gv/ix/0agvixnl2-ev6qlpi1dssnj3esy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse momento, o Veeam® Backup &amp; Replication ™ se conectará novamente ao repositório, determinará os parâmetros necessários e criará um repositório. </font><font style="vertical-align: inherit;">Clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9x/sv/79/9xsv79akohraqucyp83uh6syqo8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos as informações totais sobre o repositório adicionado e clicamos no botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concluir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zo/e6/2g/zoe62g6kxg07rl5_qo95l7y1m9y.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O programa oferecerá automaticamente para salvar seus arquivos de configuração em um novo repositório. </font><font style="vertical-align: inherit;">Como não precisamos disso, respondemos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Não</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tp/vs/9-/tpvs9-do-0wpdyqhf_fzr0sg7nk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repositório adicionado com sucesso:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fp/cy/qy/fpcyqy80-k4ktz59aqchgkg2-9y.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando uma tarefa de backup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na janela principal do Veeam® Backup &amp; Replication ™, clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabalho de backup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">computador Linux</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Escolha o tipo de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">servidor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerenciado pelo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modo de </font><b><font style="vertical-align: inherit;">servidor de backup</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1s/oi/wz/1soiwz1snio9rt2aa8lsuz7xnou.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atribuímos um nome à tarefa e, opcionalmente, adicionamos uma descrição. </font><font style="vertical-align: inherit;">Em seguida, clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hi/ji/fy/hijifygvb4srir_ecso7zii2tvk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, precisamos criar todos os servidores com Proxmox dos quais iremos fazer backup. Para fazer isso, clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computador individual</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Digite o nome do host ou o endereço IP do servidor e os detalhes de acesso. Assim, formamos a lista de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">computadores protegidos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d_/wp/kp/d_wpkp2p_szef1vyd5bwde6blg0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, um ponto muito importante, ou seja, a escolha dos dados a serem adicionados ao backup. Tudo vai depender de onde exatamente suas máquinas virtuais estão localizadas. Se você deseja adicionar apenas qualquer volume lógico, precisará do modo de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backup no nível de Volume</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e selecione o caminho para o volume ou dispositivo lógico, por exemplo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ dev / pve</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Todas as outras ações são idênticas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, mostraremos como o modo de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">backup no nível de arquivo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funciona </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wq/6b/5p/wq6b5psnc7jay48_xbrj2_ureee.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na próxima janela, criamos uma lista de diretórios para backup. Clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e prescreva os diretórios em que os arquivos de configuração da máquina virtual estão armazenados. Por padrão, este é o diretório </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / pve / nodes / pve / qemu-server /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se você usar não apenas máquinas virtuais, mas também contêineres LXC, inclua o diretório </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / pve / nodes / pve / lxc /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No meu caso, também é o diretório </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de formar a lista de diretórios dessa maneira, clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_k/_d/yd/_k_dydc6dnhx4mngj4cuuisokqu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na lista suspensa de repositórios, selecione </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armazenamento</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criado anteriormente. </font><font style="vertical-align: inherit;">Determinamos o comprimento da cadeia para backup incremental. </font><font style="vertical-align: inherit;">Quanto mais pontos houver na </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">política de retenção</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais espaço você economizará. </font><font style="vertical-align: inherit;">Mas junto com isso, a confiabilidade do backup diminuirá. </font><font style="vertical-align: inherit;">A confiabilidade é mais importante para mim do que a quantidade de espaço de armazenamento, por isso coloquei 4 pontos. </font><font style="vertical-align: inherit;">Você pode usar o valor padrão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Continuamos a configurar a tarefa clicando em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avançar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/ae/v5/wkaev5az-3ruj4n-gjuv43oz9vo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui deixamos os parâmetros inalterados, basta ir para a próxima janela:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tt/4p/b-/tt4pb-cw4quxwulze1xcjjohx_4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nós configuramos o planejador. </font><font style="vertical-align: inherit;">Esse é um dos recursos mais interessantes para facilitar a vida do administrador do sistema. </font><font style="vertical-align: inherit;">No exemplo, optei por iniciar automaticamente o backup todos os dias às 2 da manhã. </font><font style="vertical-align: inherit;">Outro ótimo recurso é a capacidade de interromper a tarefa de backup se ultrapassarmos o limite de tempo da "janela de backup" alocada. </font><font style="vertical-align: inherit;">Sua programação exata é configurada através do botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Janela</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e-/7j/7h/e-7j7hfdz5fdru4lft7cul74fr0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Novamente, por exemplo, suponha que realizamos backups apenas fora do horário comercial nos dias úteis e, nos fins de semana, geralmente não temos tempo limitado. </font><font style="vertical-align: inherit;">Formamos uma tabela tão bonita, retornamos à janela anterior e clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplicar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7g/ob/ii/7gobiidnihb8a9jsrbsdt8yp9c8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resta apenas verificar as informações resumidas sobre a tarefa e clicar no botão </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Concluir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2s/mk/6m/2smk6mspmnfayuhhxxi1yjezj3k.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso completa a criação da tarefa de backup.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cópia de segurança</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo é elementar aqui. </font><font style="vertical-align: inherit;">Na janela principal do programa, selecione a tarefa criada e clique em </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iniciar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">O sistema se conectará automaticamente ao nosso servidor (ou vários servidores), verificará a disponibilidade do armazenamento e reservará a quantidade necessária de espaço em disco. </font><font style="vertical-align: inherit;">De fato, o processo de backup começará e, após a conclusão, receberemos informações abrangentes sobre o processo.</font></font><br>
<blockquote><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se ocorrer um problema no formulário </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Falha ao carregar o módulo [veeamsnap] com os parâmetros [zerosnapdata = 1 debuglogging = 0]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> durante o processo de inicialização do backup </font><font style="vertical-align: inherit;">, será necessário reconstruir o módulo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veeamsnap de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> acordo com as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instruções</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i></blockquote><div style="text-align:center;"><img src="https://habrastorage.org/webt/ts/do/cm/tsdocmchujzdj5nxvujwmrroffs.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que é especialmente interessante é que, no próprio servidor, podemos ver não apenas uma lista de todas as tarefas de backup concluídas, mas também observar em tempo real o processo com o comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veeam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/li/lp/tk/lilptkhpxrygvey6krcgbltfvvm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prevendo a questão de por que o console parece tão estranho, direi imediatamente: eu realmente gosto da aparência do console na tela de um monitor de tubo CRT quente. </font><font style="vertical-align: inherit;">Isso é feito usando o emulador de terminal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cool-retro-term</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuperação de dados</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora a pergunta mais importante. </font><font style="vertical-align: inherit;">Mas como recuperar dados se algo irreparável aconteceu? </font><font style="vertical-align: inherit;">Por exemplo, eles excluíram acidentalmente a máquina virtual errada. </font><font style="vertical-align: inherit;">Na GUI do Proxmox, ele desapareceu completamente; nada foi deixado no armazenamento no local da máquina. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O processo de recuperação é simples. </font><font style="vertical-align: inherit;">Vamos ao console do Proxmox e inserimos o comando:</font></font><br>
<br>
<pre><code class="plaintext hljs">veeam</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veremos uma lista de backups concluídos. </font><font style="vertical-align: inherit;">Selecione a seta com as setas e pressione a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tecla </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Em seguida, selecione um ponto de recuperação e pressione </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/du/j8/ltduj8hywtb1zwrmauzoeplnw4c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Após alguns segundos, o ponto de recuperação será montado no diretório </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ mnt / backup</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo o que resta é copiar as unidades virtuais e os arquivos de configuração das máquinas virtuais em seus locais, após o que a máquina "morta" aparecerá automaticamente na GUI do Proxmox VE. </font><font style="vertical-align: inherit;">Você pode executá-lo da maneira usual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para desmontar o ponto de recuperação, você não deve fazer isso manualmente, mas deve pressionar a tecla </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no utilitário </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">veeam</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso é tudo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que a força esteja com você! </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artigos anteriores sobre o hipervisor Proxmox VE:</font></font></i><br>
<br>
<ul>
<li><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> :    Proxmox VE</a></i></li>
<li><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   Proxmox VE</a></i></li>
<li><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  Proxmox VE</a></i></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt504524/index.html">Modelo de desenvolvimento epidêmico típico do COVID-19</a></li>
<li><a href="../pt504554/index.html">Unidade Terrane e mistura de malha</a></li>
<li><a href="../pt504556/index.html">Gerenciamento de gestos: lidando com conflitos de gestos. Parte 3</a></li>
<li><a href="../pt504558/index.html">A vacinação é obrigatória uma nova realidade?</a></li>
<li><a href="../pt504560/index.html">Vamos discutir a face do financiamento coletivo doméstico</a></li>
<li><a href="../pt504564/index.html">Internet das coisas na minha vida. Como criar um escritório inteligente e acompanhar o crescimento de batatas em seu apartamento, graças à IoT</a></li>
<li><a href="../pt504566/index.html">Tabela no Confluence Atlassian com base nos dados de uma solicitação REST</a></li>
<li><a href="../pt504568/index.html">Isaac Asimov: De onde as pessoas obtêm novas idéias?</a></li>
<li><a href="../pt504572/index.html">Fale como Winston Churchill: quem precisa vender sua alma para se comunicar em inglês SO</a></li>
<li><a href="../pt504576/index.html">Como o áudio doméstico se desenvolveu - das noites das músicas aos primeiros jogadores mecânicos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>