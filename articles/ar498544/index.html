<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💆🏼 👩🏾‍✈️ 🤦🏿 تكتيكات الفريق الأحمر: تقنيات مراقبة العمليات المتقدمة في العمليات الهجومية 🈚️ 🏠 📢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="مرحبا مجددا. عشية عيد العنصرة. "اختبار اختبار الاختراق" ترجم مادة أخرى مثيرة للاهتمام بالنسبة لك.
 
 
 
 في هذه المقالة ، سوف نفهم قدرات أدوات مراقبة ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>تكتيكات الفريق الأحمر: تقنيات مراقبة العمليات المتقدمة في العمليات الهجومية</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/498544/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مرحبا مجددا. </font><font style="vertical-align: inherit;">عشية عيد </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العنصرة. </font><font style="vertical-align: inherit;">"اختبار اختبار الاختراق"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ترجم مادة أخرى مثيرة للاهتمام بالنسبة لك.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/av/qe/wo/avqewourhsmerqakgy0q9hqbk-e.png"><br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذه المقالة ، سوف نفهم قدرات أدوات مراقبة العمليات المعروفة جيدًا ونوضح كيفية استخدام التكنولوجيا الكامنة وراء هذه الأدوات لعمليات الهجوم التي يقوم بها الفريق الأحمر. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إن الفهم التقني الجيد للنظام الذي نعتمد عليه هو معيار رئيسي لاتخاذ قرارات حول الخطوة التالية من العملية. يمنحنا جمع البيانات وتحليلها حول العمليات الجارية في الأنظمة المعرضة للخطر ثروة من المعلومات ويساعدنا على فهم كيفية عمل البنية التحتية لتكنولوجيا المعلومات في المنظمة المستهدفة. بالإضافة إلى ذلك ، تساعدنا بيانات العملية المطلوبة بشكل دوري على الاستجابة للتغيرات البيئية وتلقي إشارات الزناد عند بدء التحقيق.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من أجل أن نكون قادرين على جمع البيانات التفصيلية حول العمليات في نقاط النهاية المخترقة ، أنشأنا مجموعة من الأدوات التي جمعت قوة أدوات العمليات المتقدمة وأطر C2 (مثل Cobalt Strike). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العثور على</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الأدوات (ورمز مصدرها) </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">هنا</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أدوات نظام Windows الداخلية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بادئ ذي بدء ، سنكتشف الأدوات المساعدة التي يمكن استخدامها لجمع معلومات حول عمليات الكمبيوتر على Windows. </font><font style="vertical-align: inherit;">ثم نتعرف على كيفية قيام هذه الأدوات المساعدة بجمع المعلومات بحيث يمكن استخدامها لاحقًا في مجموعات أدوات الفريق الأحمر.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نظام التشغيل Windows مجهز بالعديد من الأدوات المساعدة الجاهزة لإدارة النظام. على الرغم من أن معظم الأدوات المتوفرة مناسبة لأغراض إدارة النظام الأساسية ، إلا أن بعضها لا يحتوي على الوظائف اللازمة لاستكشاف الأخطاء وإصلاحها والمراقبة المتقدمة. على سبيل المثال ، يقدم لنا مدير مهام Windows معلومات أساسية حول جميع العمليات التي تعمل في النظام ، ولكن ماذا لو كنا بحاجة إلى معلومات أكثر تفصيلاً ، مثل واصفات الكائنات أو اتصالات الشبكة أو الوحدات النمطية التي تم تحميلها كجزء من عملية معينة؟ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لجمع هذه المعلومات ، هناك أداة أكثر تقدمًا. على سبيل المثال ، أدوات النظام المساعدة لحزمة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sysinternals</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. بصفتي عضوًا في الفريق الأحمر ولديهم خبرة واسعة في إدارة الشبكات والنظام ، فقد كنت دائمًا من المعجبين بكبار Sysinternals. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
عند استكشاف أخطاء نظام خادم يعمل ببطء أو جهاز كمبيوتر عميل مصاب ، غالبًا ما بدأت في استكشاف الأخطاء وإصلاحها باستخدام أدوات مثل Process Explorer أو Procmon. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من وجهة نظر الطب الشرعي الرقمي ، تبدو هذه الأدوات أيضًا مفيدة جدًا لإجراء التحليل الديناميكي الأساسي لعينات البرامج الضارة والبحث عن القطع الأثرية في الأنظمة المصابة. فلماذا تحظى هذه الأدوات بشعبية كبيرة بين مسؤولي النظام وكذلك خبراء الأمن؟ دعونا نكتشف ذلك ، نتعمق في بعض معلومات العملية التي يمكننا الحصول عليها باستخدام أداة Process Explorer.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">باستخدام Process Explorer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أول شيء نراه عند بدء تشغيل </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process Explorer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هو قائمة / شجرة بجميع العمليات الجارية للنظام. </font><font style="vertical-align: inherit;">هذا يعطينا معلومات حول أسماء العمليات ومعرفاتها وسياق المستخدم ومستوى سلامة العملية ومعلومات الإصدار. </font><font style="vertical-align: inherit;">يمكن أن تنعكس المعلومات الإضافية أيضًا عن طريق تعديل الأعمدة وفقًا لذلك. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9d/9s/fk/9d9sfkhmwl222wp8vlzcuhcw85y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
إذا استخدمنا اللوحة السفلية ، فيمكننا عرض جميع الوحدات التي تم تحميلها بعملية معينة ، أو التبديل إلى عرض الواصفات للتعرف على جميع كائنات الواصفات المسماة التي تستخدمها العملية:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/ss/ei/bassei2hnk4jg_kuyl2xd3maihg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يمكن أن يكون استعراض الوحدات مفيدًا عند البحث عن مكتبات ضارة يتم تحميلها في هذه العملية ، أو بالنسبة إلى Red Team ، فهو منتج أمان نشط (على سبيل المثال ، EDR) قام بتنفيذ وحدة للاتصال عبر API في وضع المستخدم. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/f0/sn/lyf0snflh_begeau_5pjbtwhtis.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 يسمح لك التبديل إلى عرض الواصفات بالتعرف على نوع واسم جميع الكائنات المسماة المستخدمة في العملية. يمكن أن يكون هذا مفيدًا لمعرفة الملفات ومفاتيح التسجيل المفتوحة ، والأنابيب المسماة التي يتم استخدامها للاتصال بين العمليات. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 إذا نقرت نقرًا مزدوجًا على اسم العملية ، فستظهر نافذة تحتوي على معلومات أكثر تفصيلاً. دعنا نلقي نظرة على بعض علامات التبويب للتعرف على الخصائص الإضافية للكائن: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mx/cr/k-/mxcrk-tik-hny6ailuno3pksvs4.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 علامة تبويب </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الصورة</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يعرض معلومات حول خيارات المسار الثنائي ودليل العمل وخيارات سطر الأوامر. بالإضافة إلى ذلك ، فإنه يعرض معلومات حول سياق المستخدم ، والعملية الأم ، ونوع الصورة (x86 أو x64) وأكثر من ذلك بكثير. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-i/_o/bu/-i_obubvbxw47snh32g2ysmp7yg.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 و </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المواضيع</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> التبويب </font><font style="vertical-align: inherit;">يحتوي على معلومات حول تشغيل مؤشرات الترابط في العملية. عند تحديد دفق ثم النقر فوقه ، سيعكس زر المكدس مكدس الاستدعاء لهذا الدفق المحدد. لعرض سلاسل العمليات / المكالمات التي تم تشغيلها في وضع kernel ، يستخدم Process Explorer برنامج تشغيل kernel ، والذي يتم تثبيته عند العمل في الوضع المرتفع.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من وجهة نظر DFIR ، تكون معلومات مؤشر الترابط مفيدة للكشف عن الحقن في الذاكرة ، على سبيل المثال ، عندما يكون هناك تهديد للفيروسات الخالية من الملفات. </font><font style="vertical-align: inherit;">وبالتالي ، يمكن أن تشير التدفقات غير المدعومة بالملفات الموجودة على القرص إلى سلوك مريب. </font><font style="vertical-align: inherit;">لمزيد من المعلومات حول سلاسل المحادثات والذاكرة ، أوصي بشدة بالاهتمام بأداة </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process Hacker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/_s/0s/3w_s0sra5w6xq4_jf56lbg7czu4.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 علامة تبويب أخرى مثيرة للاهتمام في Process Explorer هي علامة التبويب TCP / IP. </font><font style="vertical-align: inherit;">ستشاهد عليه جميع اتصالات الشبكة المرتبطة بهذه العملية. </font><font style="vertical-align: inherit;">من وجهة نظر الهجوم ، يمكن أن يكون هذا مفيدًا لفهم متى يتم الاتصال من نظام مخترق. </font><font style="vertical-align: inherit;">قد تشير جلسة RemoteShell البعيدة أو جلسة RDP إلى بدء تحقيق بالفعل.</font></font><br>
 <br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">باستخدام الطرق التي نوقشت للهجوم</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 الآن بعد أن تعلمنا القليل من الأشياء المثيرة للاهتمام حول العمليات ، وحول المعلومات التي يمكننا جمعها عنها باستخدام Process Explorer ، قد تتساءل عن كيفية الوصول إلى هذه المعلومات من أطر C2 المفضلة لدينا. بالطبع ، يمكننا استخدام PowerShell ، لأن هذا سيتيح لنا الفرصة لاستخدام لغة برمجة نصية قوية و Windows API. ومع ذلك ، فإن PowerShell اليوم تحت الإشراف المستمر لخدمة الأمن ، لذلك نحاول تجنب هذه الطريقة. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cobalt Strike ،</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكننا استخدام الأمر ps في سياق المنارات. يعرض هذا الأمر المعلومات الأساسية حول العملية بناءً على جميع العمليات التي يتم تشغيلها في النظام. بالاقتران مع البرنامج النصي </font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">@r3dQu1nn ProcessColor</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، من المحتمل أن تكون هذه الطريقة هي الأفضل للحصول على بيانات العملية.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
يكون الإخراج من الأمر </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ps</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مفيدًا لفرز العمليات الجارية بسرعة ، ولكنها لا تحتوي على معلومات تفصيلية من شأنها مساعدتك على فهم النظام بشكل أفضل. </font><font style="vertical-align: inherit;">لجمع معلومات أكثر تفصيلاً ، أنشأنا أدوات مساعدة خاصة بنا للحصول على معلومات حول العمليات. </font><font style="vertical-align: inherit;">بمساعدتهم ، يمكننا جمع وإثراء المعلومات التي تم الحصول عليها من الأنظمة المخترقة.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أدوات ps </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ليس من السهل تكرار الوظائف والمعلومات التي توفرها أداة مثل Process Explorer. نحتاج أولاً إلى معرفة كيفية عمل هذه الأدوات تحت الغطاء (وفي وضع المستخدم) ، ثم نحتاج إلى فهم كيفية عكس هذه المعلومات بشكل أفضل في وحدة التحكم ، وليس في الواجهة الرسومية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد تحليل شفرة المصدر ، أصبح من الواضح أن العديد من الأدوات منخفضة المستوى لتوفير معلومات النظام تستند إلى حد كبير إلى واجهة برمجة تطبيقات </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NtQuerySystemInformation</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API الأصلية </font><font style="vertical-align: inherit;">. على الرغم من عدم توثيق واجهة برمجة التطبيقات (API) والهياكل المرتبطة بها بشكل كامل ، تتيح لك واجهة برمجة التطبيقات هذه جمع الكثير من المعلومات حول نظام Windows. لذلك باستخدام </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NtQuerySystemInformation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كنقطة انطلاق لجمع المعلومات حول العمليات الجارية في النظام ، سوف نستخدم </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> للعمليات الفردية لجمع معلومات تفصيلية حول كل منها. </font><font style="vertical-align: inherit;">باستخدام واجهة برمجة تطبيقات </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NtQueryInformationProcess ،</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكننا قراءة البنية </font></font><code>PROCESS_BASIC_INFORMATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">باستخدام واصف العملية والعثور عليه </font></font><code>PebBaseAddress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ثم نستخدم </font></font><code>NtReadVirtualMemory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API لقراءة هيكل </font></font><code>RTL_USER_PROCESS_PARAMETERS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">، والتي سوف تسمح لنا لمعرفة المعلمات </font></font><code>ImagePathName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">و </font></font><code>CommandLine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">العملية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
باستخدام واجهات برمجة التطبيقات هذه كأساس لشفرتنا ، قمنا بكتابة الأدوات التالية للحصول على معلومات حول العمليات:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : يعرض قائمة مفصلة بجميع العمليات التي تعمل على النظام.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : يعرض معلومات kernel ، بما في ذلك برامج التشغيل المحملة.</font></font></li>
<li><i>Psc</i>:        TCP-.</li>
<li><i>Psm</i>:          (    , ).</li>
<li><i>Psh</i>:         (,  ,  ).</li>
<li><i>Psw</i>:        .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 كل هذه الأدوات مكتوبة بلغة C كملفات DLL عاكسة ويمكن تضمينها بشكل عكسي في عملية إنتاج باستخدام C2 Framework مثل Cobalt Strike (أو أي إطار عمل آخر يدعم حقن DLL العاكسة). </font><font style="vertical-align: inherit;">بالنسبة لـ Cobalt Strike ، قمنا بإضافة برنامج نصي معتدي يمكن استخدامه لتحميل الأدوات باستخدام مدير البرنامج النصي Cobalt Strike. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نلقي نظرة على كل أداة محددة تم إطلاقها في Cobalt Strike من أجل توضيح الوظائف وإظهار المعلومات التي يمكن جمعها باستخدامها:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psx</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 تعرض هذه الأداة قائمة مفصلة بجميع العمليات التي تعمل على النظام. يمكن مقارنة الإخراج بالمعلومات الموجودة على الشاشة الرئيسية لـ Process Explorer. يعرض Psx اسم العملية ومعرفها ومعرف PID الأصلي ووقت الإنشاء والمعلومات المتعلقة بالملفات الثنائية للعملية (الهندسة المعمارية واسم الشركة والإصدار وما إلى ذلك). كما ترى ، فإنه يعرض أيضًا بعض المعلومات المثيرة للاهتمام من النواة النشطة للنظام ، على سبيل المثال ، العنوان الأساسي للنواة ، والذي يكون مفيدًا عند تشغيل النواة (على سبيل المثال ، لحساب تعويضات أدوات ROP). يمكن جمع كل هذه المعلومات من سياق مستخدم عادي (بدون رفع الامتيازات).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ni/jt/be/nijtbefsyhpct-kkpkxpwdp4pvc.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 إذا كانت لدينا أذونات كافية لفتح واصف العملية ، يمكنك قراءة معلومات إضافية ، مثل سياق المستخدم ومستوى تكامل الرمز المميز الخاص به. </font><font style="vertical-align: inherit;">يسمح لك تعداد PEB والهياكل ذات الصلة بالحصول على معلومات حول مسار الصورة ومعلمات سطر الأوامر: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-d/hu/bm/-dhubmeevabpdhf1_-f_wpq8q9c.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 كما لاحظت ، نقرأ ونعرض معلومات الإصدار من صور المعالجة الثنائية ، على سبيل المثال ، اسم الشركة ووصفها. </font><font style="vertical-align: inherit;">بمعرفة اسم الشركة ، يمكنك بسهولة إدراج جميع منتجات الأمان النشطة في النظام. </font><font style="vertical-align: inherit;">باستخدام هذه الأداة ، نقوم بمقارنة أسماء الشركات لجميع العمليات النشطة بقائمة من الموردين المعروفين لمنتجات الأمان ونعرض النتائج:</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/xv/c4/nf/xvc4nflmu_fzxkgjq8wuq5zkd0m.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بسك</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 تعكس هذه الأداة معلومات حول النواة العاملة ، بما في ذلك جميع وحدات برنامج التشغيل المحملة. </font><font style="vertical-align: inherit;">مثل أداة Psx ، فإنه يوفر أيضًا ملخصًا لجميع وحدات kernel المحملة من منتجات الأمان المعروفة.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oe/mr/ii/oemrii004bpzkatpi1solktzfvq.png"><br>
 <br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ش</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 تستخدم هذه الأداة نفس الأساليب لعرض معلومات حول العمليات النشطة مثل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، باستثناء أنها تعرض العمليات التي لها اتصال شبكة نشط فقط (IPv4 و IPv6 TCP و RDP و ICA):</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/m9/gf/su/m9gfsulxhhfcacdvaofmpmxvdpy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مزمور</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 يمكنك استخدام هذه الأداة للحصول على معلومات تفصيلية حول عملية معينة. </font><font style="vertical-align: inherit;">سيعرض قائمة بجميع الوحدات (DLLs) المستخدمة من قبل العملية واتصال الشبكة:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/5x/wc/yu5xwczhban43kmlv5kjjg7o8v8.png"><br>
 <br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psh</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 مثل </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، ولكن بدلاً من الوحدات النمطية المحملة ، فإنه يعرض قائمة </font><i><font style="vertical-align: inherit;">بواصفات</font></i><font style="vertical-align: inherit;"> العمليات:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-q/ok/nt/-qokntyj-1pdgaetariouoyi15a.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psw</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 أداة </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Psw</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الأخيرة ولكن ليس الأقل أهمية </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ستعرض هذه الأداة قائمة العمليات ذات مقابض النوافذ النشطة ، وتلك المفتوحة على سطح مكتب المستخدم ، بما في ذلك عناوين النوافذ. </font><font style="vertical-align: inherit;">هذا مفيد لتحديد واجهات التطبيق الرسومية التي يفتحها المستخدم دون الحاجة إلى التقاط لقطات شاشة لسطح المكتب:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tj/ah/zg/tjahzg3ck9ed8-9of7hvv0krrl4.png"><br>
 <br>
 <h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استخدم حالات</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 قد تتساءل: "وكيف يساعدنا كل هذا في العمليات الهجومية؟" </font><font style="vertical-align: inherit;">بعد الوصول إلى أحد الأصول المخترقة ، نستخدم هذه المعلومات عادةً للأغراض التالية:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الكشف عن أدوات الأمان على الأصول المعرضة للخطر. </font><font style="vertical-align: inherit;">ليس فقط من خلال معلومات العملية ، ولكن أيضًا من خلال الوحدات النمطية المحملة.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الكشف عن محركات ربط مخصصة.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">البحث عن فرص للمناورات (من خلال جلسات الشبكة) وتصعيد الامتيازات.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
بعد الحل الوسط الأول ، يمكنك طلب معلومات مماثلة بشكل دوري حول العمليات والبدء في إنشاء المشغلات. </font><font style="vertical-align: inherit;">على سبيل المثال ، نقوم تلقائيًا بإدخال هذه المعلومات في </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RedELK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ثم يمكنك إنشاء تنبيهات حول التغييرات المريبة في معلومات العملية ، مثل:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قم بتشغيل أداة تدقيق أمني أو قم بتثبيت منتج أمان جديد للنقطة النهائية.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اتصالات الشبكة الواردة من قسم الأمن من خلال جلسة RDP أو PowerShell عن بعد.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فتح مقبض عن طريق عملية أخرى على أحد القطع الأثرية الضارة لدينا (على سبيل المثال ، ملف يستخدم للحفاظ على التواجد).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">استنتاج</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في هذه المقالة ، أظهرنا كيف يمكن استخدام أدوات مثل Sysinternals Process Explorer للحصول على معلومات تفصيلية حول العمليات التي تعمل على النظام ، وكيف يمكن لهذه المعلومات مساعدة المسؤولين والمتخصصين في مجال الأمن على استكشاف الأخطاء وإصلاحها والتحقق من النظام بحثًا عن مشكلات الأمان أو أداء. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نفس المعلومات ذات صلة ومفيدة أيضًا لفريق Red ، الذي يمكنه الوصول إلى الأنظمة المخترقة أثناء التشغيل. يساعد على فهم النظام والبنية التحتية لتكنولوجيا المعلومات لهدفك بشكل أفضل ، ويسمح الاستجواب الدوري لهذا النظام للفريق الأحمر بالاستجابة للتغيرات المحتملة في البيئة (على سبيل المثال ، تحري التحقيق).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لقد قمنا بتكرار بعض الوظائف التي توفرها أدوات مثل Process Explorer ، حتى نتمكن من استخدام نفس المعلومات في العمليات الهجومية. </font><font style="vertical-align: inherit;">للقيام بذلك ، تم إنشاء العديد من أدوات مراقبة العملية التي يمكن استخدامها كجزء من إطار C2 ، على سبيل المثال Cobalt Strike. </font><font style="vertical-align: inherit;">أظهرنا كيفية استخدام هذه الأدوات والمعلومات التي يمكنك استخدامها لجمعها. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تتوفر هذه الأدوات على </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">صفحة GitHub الخاصة</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بنا </font><font style="vertical-align: inherit;">وهي جاهزة للاستخدام كجزء من Cobalt Strike.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تعلم المزيد عن الدورة.</font></font><br>
</a><br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar498534/index.html">الاعتراف بالوثائق والأشخاص: اتحاد باسم الحرية أم خطوة نحو دكتاتورية رقمية؟</a></li>
<li><a href="../ar498536/index.html">كيفية إعادة استخدام الكود مع حزم symfony 5؟ الجزء 2. نأخذ الرمز في الحزمة</a></li>
<li><a href="../ar498538/index.html">ضفدع الجميل</a></li>
<li><a href="../ar498540/index.html">الرسوم البيانية باستخدام Excel و PowerPoint. الجزء 2</a></li>
<li><a href="../ar498542/index.html">فصل عملي "البحث عن البرامج الضارة في إنترنت الأشياء"</a></li>
<li><a href="../ar498548/index.html">إنشاء الحزمة الخاصة بك ل Laravel Nova: OptimalImage</a></li>
<li><a href="../ar498552/index.html">ما أخطاء المدراء في موقع بعيد</a></li>
<li><a href="../ar498556/index.html">هانز بيتر لون وولادة خوارزمية التجزئة</a></li>
<li><a href="../ar498560/index.html">مكونات الويب في مشروع حقيقي</a></li>
<li><a href="../ar498562/index.html">على عكس الحجر الصحي: كيف نقلنا برامجنا التدريبية إلى تنسيق بعيد</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>