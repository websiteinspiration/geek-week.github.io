<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘©ğŸ½ ğŸ« â—ï¸ Konferensi DEFCON 27 Buttplug: Pengujian Penetrasi Benar. Bagian 2 ğŸ¸ â›´ï¸ ğŸ‘ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Analis percaya bahwa saat ini ada sekitar 10 miliar perangkat dari dunia Internet of Things (IoT). Terkadang perangkat ini mendapatkan tempat mereka d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Konferensi DEFCON 27 Buttplug: Pengujian Penetrasi Benar. Bagian 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/495792/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analis percaya bahwa saat ini ada sekitar 10 miliar perangkat dari dunia Internet of Things (IoT). Terkadang perangkat ini mendapatkan tempat mereka di pasar, benar-benar memanjat manusia. Ternyata, chip radio murah dan berdaya rendah tidak hanya bagus untuk otomatisasi rumah - mereka juga mengubah cara orang berinteraksi dengan mainan seks. Dalam laporan ini, kita akan terjun ke dunia dildonics televisi, teknologi seks pada jarak di mana taktil, suhu dan sensasi lainnya ditransmisikan antara pasangan melalui jalur komunikasi dua arah. Pembicara akan memberi tahu Anda bahwa keamanan mainan seks anal elektronik elektronik Buttplug dapat ditentang oleh penyerang yang menemukan dan mengeksploitasi kerentanan di setiap tingkat tumpukan. Pada akhirnya, ini memungkinkan sextoys sendiri untuk dikompromikan,dan perangkat yang mereka hubungkan.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z5/yr/ar/z5yraruqzcjhhyd_pc_eym4a5ly.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seorang hacker dengan nama panggilan smea, atau Smealum, memulai karirnya sebagai pengembang video game untuk konsol game seperti Nintendo DS, secara bersamaan mencoba memecahkannya. Di beberapa titik, konsol memperoleh sistem keamanan yang serius, dan Smea beralih dari perangkat lunak yang dikembangkan di rumah ke mengembangkan teknik untuk memecahkannya. Smea dikenal karena "bekerja" pada Nintendo 3DS dan Wii U, meskipun ia juga berkontribusi pada pengembangan eksploitasi untuk browser web dan tumpukan virtualisasi yang paling populer. Mungkin, sekarang dia menjadi tertarik membobol colokan anal "pintar".</font></font><a name="habracut"></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konferensi DEFCON 27 Buttplug: Pengujian Penetrasi Benar. Bagian 1</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/xq/wz/de/xqwzdenvl7ovwamxxyxf_byvjiu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tentu saja, Anda dapat mengelola pesan masuk bahkan dengan panjang garis pendek. Misalnya, 30 karakter sudah cukup untuk menjalankan JavaScript berbahaya. Slide ini menunjukkan contoh tag dengan panjang 30 karakter untuk gambar dari sumber yang tidak ada &lt;img src = aerror = 'lansiran (1)'&gt;, yang menyebabkan aplikasi menampilkan pesan kesalahan. Pesan ini akan ditampilkan setiap kali pemuatan gambar benar-benar mustahil. Tangkapan layar menunjukkan bahwa menghubungkan melalui dongle yang dikompromikan memungkinkan Anda untuk mengeksekusi JavaScript berbahaya.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kd/p8/9x/kdp89xy1fdjf_ib5vcifs6wmix4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Batas 32 karakter mengganggu karena sulit untuk menyadari muatan volume, tetapi sangat mungkin. Jadi, Anda melihat bahwa kami telah berhasil mengkompromikan aplikasi menggunakan kunci USB dan sekarang setengah jalan untuk membalikkan peretasan, yaitu, kompromi aplikasi menggunakan bootplag hacker. Meretas situs dongle-komputer dapat terjadi dalam dua cara: melalui komputer, Anda dapat kompromi dongle, dan melalui dongle, Anda dapat kompromi komputer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dongle bertindak sebagai jembatan kecil antara plug boot dan aplikasi. Muncul pertanyaan: apakah mungkin untuk menggunakan kerentanan yang sama untuk mengkompromikan aplikasi pada komputer secara langsung melalui bootplag. Sayangnya, jawaban untuk pertanyaan ini negatif, dan alasannya adalah bahwa ada batasan lain pada panjang karakter pesan yang datang dari plug-in boot ke aplikasi.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bi/xp/_c/bixp_ckg43nxt6acd4aq_px4wae.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dongle hanya mengemas pesan dari plug-in boot dan mengirimkannya ke aplikasi, dan pada langkah ini Anda dapat memasukkan kode HTML Anda ke dalamnya. Namun, pada suatu waktu ia dapat menerima pesan yang panjangnya tidak lebih dari 20 byte, yang tidak cukup untuk melakukan serangan XSS. Namun, ada bug di firmware dongle: tidak ada pemeriksaan untuk terminator nol di akhir baris. Oleh karena itu, jika Anda dapat menempatkan beberapa data yang tidak diinisialisasi setelah akhir string 20 karakter, maka Anda akan dapat mengirim aplikasi lebih dari 20 karakter. Sayangnya, saya tidak menemukan cara untuk menggunakan kerentanan ini dalam praktiknya, tetapi kesempatan seperti itu patut diingat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi masalahnya adalah Anda mungkin tidak dapat menggunakan kerentanan ini untuk memaksa aplikasi untuk mengeksekusi kode yang diterima langsung dari plug-in boot. Sangat menyedihkan, tetapi bahkan lebih menyedihkan bahwa jika Anda melihat firmware dongle, Anda dapat melihat bahwa pada prinsipnya tidak ada hubungannya dengan data yang diterima, tetapi cukup menyalinnya ke baris baru dan mengirimkannya lebih jauh. Oleh karena itu, kami tidak akan dapat menggunakan kerentanannya untuk menyerang melalui buffer overflow. Namun, jika tidak mungkin untuk meretas aplikasi langsung dari plug-in boot, mungkin akan mungkin untuk melakukan ini melalui rantai boot-plug-dongle-komputer? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal yang baik adalah bahwa chip dongle memungkinkan Anda untuk menempatkan kode lebih banyak daripada yang diperlukan untuk program pengembang asli Lovense Hush.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9m/bf/k7/9mbfk7wqpqdoodi2nndnppiirfo.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memori flash dongle berisi area yang disediakan untuk loader DFU, area untuk aplikasi Lovense itu sendiri, dan area SoftDevice tertutup untuk driver perangkat keras untuk chip BLE Nordic Semiconductor. Di sinilah protokol BLE itu sendiri diproses. Misalnya, ketika aplikasi ingin mengirim pesan BLE ke mainan, ia mengakses SoftDevice melalui panggilan SVC. Selain 3 area ini, dongle memiliki area memori flash yang tidak digunakan dengan volume yang cukup besar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menemukan kerentanan dalam tumpukan BLE SoftDevice, Anda perlu menggunakan rekayasa terbalik, karena itu bukan open-source. Saya melakukan hal yang sama untuk menemukan kerentanan plug-in firmware. Dalam hal ini, sangat mudah untuk mengikuti aliran data, karena tidak ada ASLR di sana, dan mudah untuk menentukan kode yang akan memproses pesan-pesan ini.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yh/wq/ch/yhwqchpeynrmburahytjp2gxqd8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sebelah kanan pada slide, Anda melihat pengatur paket yang masuk GATTC (profil atribut umum), yang, pada dasarnya, adalah dongle. Secara khusus, ini adalah handler baca berdasarkan jenis paket respons. Saya bukan spesialis dalam perangkat Bluetooth, tapi saya pikir intinya di sini adalah dongle membaca jenis perangkat periferal dan menggunakan penangan untuk semua varian atribut yang terkait dengan jenis ini. Ini berarti bahwa sebenarnya Anda bisa mendapatkan lebih dari 1 atribut sekaligus, dan ukuran setiap penangan dari sepasang data atribut dikodekan sebagai bidang di dalam paket, yang memungkinkan Anda untuk mengelolanya.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ck/sa/9h/cksa9hsxwiqwgqoyklkgwwhx2pa.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Slide menunjukkan contoh paket semacam itu. Klien GATT dapat mengirim paket permintaan baca dengan jenis yang berisi jenis dan jangkauan deskriptor untuk dibaca. Server yang menanggapi data pengembalian permintaan dengan jenis yang dikaitkan dengan penangan dalam kisaran yang sesuai dengan jenis ini. Jumlah pasangan deskriptor / data ditentukan dengan membagi panjang paket yang tersisa dengan panjang bidang deskriptor / pasangan data, dan bidang ini selalu 0x7 atau 0x15.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/zf/gm/j7zfgmebqqi3va1lslmsmr3pzr8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Slide menunjukkan operasi fungsi yang kami tertarik: Anda melihat bagaimana paket diisi dengan data dari array atribut, dan panjang buffer tetap dialokasikan untuk mereka. Di sinilah nilai deskriptor ditempatkan, dan kemudian pointer yang terkait dengannya. Array atribut adalah data biner yang ditempatkan di dalam buffer dalam format heksadesimal. Data disorot dengan warna biru, dan di sebelahnya adalah deskriptor 0D dan penunjuk terkait 00, disorot dalam warna oranye. Paket penangan kedua dan ketiga terlihat serupa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerentanan adalah sebagai berikut. Jika Anda membaca kode di sebelah kanan, Anda dapat melihat parameter atribut_data_length ditempatkan dalam bingkai ungu - panjang pesan masuk, nilai yang sepenuhnya dikendalikan oleh penyerang potensial. Jika kita menempatkan nilai nol di sana, kita mendapatkan loop tak terbatas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wk/mo/hi/wkmohi2rrehqx3o1mgupqhdseek.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Loop menjadi tak terbatas karena kode tidak memeriksa apakah data yang ditulisnya ke buffer output ada di dalam buffer output ini. Akibatnya, kami mendapatkan tumpukan buffer overflow klasik, karena perangkat tidak memiliki ASLR atau DEP, dan kode segera dieksekusi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menetapkan nilai nol dan mendapatkan loop tak terbatas, Anda benar-benar mengganti semua data RAM dengan sampah. Namun, ini adalah solusi yang tidak berhasil, karena kemungkinan menyebabkan kegagalan perangkat. Tetapi jika Anda menggunakan nilai 1, maka itu akan membatasi jumlah byte yang ada di dalam pesan yang masuk. Ini berarti yang berikut - Anda dapat sedikit melimpahi buffer ini, dan kemudian buffer, yang didasarkan pada stack, akan dapat merusak semua yang ada di sebelahnya.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vg/rf/iy/vgrfiyhiseechjyxntzkrztnp14.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat seperti apa tumpukan itu sebelum meluap. Array atribut buffer yang kita bicarakan disorot dengan warna kuning, register yang disimpan berwarna biru, dan alamat pengirim berwarna oranye. Dengan mengatur panjang atribut ke 0x01, kita bisa menyebabkan banyak pasang pegangan / penunjuk data melimpah. Deskriptor terdiri dari 2 byte, tetapi dua byte teratas dari deskriptor DWORD tidak dihapus. Buffer yang kita tumpangi ada di stack tanpa cookie, tanpa ASLR, tanpa DEP.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/es/oo/ko/esooko6lhrdqef9gglnoyx2ffh8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, kami menguji sistem: mengirim paket penuh 0xDA byte dengan panjang atribut 0x01. Ternyata kami menulis ulang alamat pengirim dengan pointer ke data atribut kami. Karena tidak ada DEP, ini berarti bahwa setiap kali fungsi kembali, kode yang ada di dalam paket kami akan dieksekusi. Satu-satunya batasan adalah bahwa kita memerlukan alamat pengirim agar LSB diatur ke bit yang paling tidak signifikan, sehingga kodenya berjalan dalam mode Thumb, karena prosesor Cortex M0 tidak mendukung mode ARM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/rc/5w/gl/rc5wglu00lbsx5v9gnix6v1as2c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menulis ulang beberapa variabel lokal, sambil memastikan bahwa kami tidak menulis ulang apa pun yang digunakan dalam perjalanan kembali. Pada dasarnya, kami mendapatkan paket backdoor klasik. Jika Anda memperhatikan tumpukan ini, Anda akan melihat bahwa yang ditulis ulang tidak sesuai dengan perbatasan, yang akan menyebabkan program macet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada persyaratan lain tentang register tersimpan. Ini adalah variabel lokal yang juga ditimpa ketika fungsi kembali. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ft/kv/m2/ftkvm2tpkt7iepg-fwtrpx2kkiq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satunya digunakan untuk membatasi perbatasan 32-bit, dan konten yang tidak sesuai dengan perbatasan akan menyebabkan program macet. Karena itu, Anda perlu memastikan bahwa Saved_arg_3 = 0, Saved_arg_4 sesuai dengan DWORD, yaitu, ia berada di dalam perbatasan, dan LSB diatur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena itu, kita perlu memastikan bahwa paket ini berfungsi. Untungnya, ini sangat mudah, karena cara SoftDevice mendistribusikan paket yang masuk ini adalah buffer cincin tanpa persyaratan penyelarasan paksa. Whiteshark memungkinkan untuk memverifikasi bahwa penyelarasan paket selanjutnya dapat dikontrol dengan mengubah panjang paket sebelumnya. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mr/3j/ia/mr3jiaai4k_cnlfzea9a0zyvgqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kuning dan biru menyoroti 2 paket yang dikirim sebelum paket eksploit dikirim. Ini memungkinkan saya untuk mengontrol perataan paket terakhir dan membuatnya sehingga tidak menyebabkan crash program, yang merupakan tujuan kami.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya perhatikan bahwa ada kendala teknis tertentu: Nordic SoftDevice tidak menyediakan antarmuka untuk mengirim paket BLE mentah. </font><font style="vertical-align: inherit;">Untuk menghindarinya, Anda dapat menggunakan 2 opsi: mengimplementasikan tumpukan BLE Anda sendiri atau memecahkan beberapa kait dalam paket asli. </font><font style="vertical-align: inherit;">Karena saya malas, saya memilih opsi 2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengait ini cukup sederhana, tetapi membutuhkan rekayasa balik. </font><font style="vertical-align: inherit;">Metode peretasan dapat ditemukan di github, antarmuka cukup "kotor" dan tidak ada jaminan bahwa ini akan berhasil, tetapi saya berhasil. </font><font style="vertical-align: inherit;">Anda masih lebih baik menggunakan BTLEJack.</font></font><br>
<br>
<pre><code class="plaintext hljs">void ble_outgoing_hook(uint8_t* buffer, uint8_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pointer SoftDevice ini dipanggil setiap kali paket BLE dikirim, sehingga dapat dimodifikasi terlebih dahulu:</font></font><br>
<br>
<pre><code class="plaintext hljs">int ble_incoming_hook(uint8_t* buffer, uint16_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hook ini SoftDevice memanggil setiap kali paket BLE diterima. Nilai kembali menentukan apakah pemrosesan SoftDevice normal harus dilewati.</font></font><br>
<br>
<pre><code class="plaintext hljs">int send_packet(void* handle, void* buffer, uint16_t length);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginilah fungsi pengiriman paket mentah ke koneksi BLE ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana saya bisa memproses lebih dari 4 byte kode sekaligus? Perlu mengirim beberapa paket! Di sebelah kanan Anda melihat buffer cincin dari paket BLE yang masuk. Paket pertama ditampilkan dalam warna hijau: kode shell yang mengeksekusi panggilan fungsi dengan parameter yang dikontrol dan kemudian mengembalikan "bersih". Paket kedua ditunjukkan dengan warna kuning - ini adalah buffer data yang dapat digunakan oleh panggilan fungsi. Paket ketiga ditampilkan dengan warna biru - penyangga yang berisi nilai-nilai parameter panggilan fungsi, dan oranye - paket yang meluncurkan kerentanan menggunakan instruksi C1 E7. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/47/up/ki/47upki5tumqqj_c4ysc09rw2i0g.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah mengembalikan fungsi murni, kami dapat mengirim ulang paket ini. Mengirim 4 paket ini mengeksekusi setiap potongan kode di dalam dongle, dan ini dapat dilakukan berulang-ulang.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z2/hg/jg/z2hgjgfs0udpsjpfcm0l7gppqmw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini nyaman karena dengan cara ini saya benar-benar bisa memanggil memcpy beberapa kali untuk menyalin kode shell biner yang lebih besar ke dalam RAM. Kemudian kita memanggil fungsi ini untuk menambal kode dongle asli dalam memori, dan menggunakannya untuk membahayakan aplikasi yang diinstal pada komputer. Karena muatan XSS besar, kami tidak mengirimkannya, tetapi menghasilkannya dalam kode shell pada dongle itu sendiri. Kode shell adalah sebagai berikut. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/c7/bi/oy/c7bioypcqko4flgvncaxbz8e2qm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasil dari manipulasi ini, berikut ini diperoleh: jika kita dapat mengontrol aplikasi, maka kita dapat mengontrol dongle dan bootplag.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zq/qj/dv/zqqjdv3mounl3az58buw63jinri.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada 2 cara meretas bagian buttplag-dongle: dongle dapat membahayakan mainan, dan buttplag dapat membahayakan dongle dan komputer. Bonusnya adalah kerentanan Nordic BLE hadir tidak hanya di produk Lovense, tetapi juga di perangkat apa pun yang menggunakan SoftDevise S110, S120 atau S130 untuk sisi klien BLE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami memiliki peluang untuk berkompromi dengan aplikasi menggunakan bootplag. Bagaimana ini bisa digunakan? Kami masih mengeksekusi kode JavaScript di dalam aplikasi Lovense, dan pertanyaannya adalah, apa yang diberikannya kepada kami? Ternyata aplikasi lovense.exe berjalan pada Medium IL dan berjalan pada Windows, memberikan kemungkinan yang benar-benar tidak terbatas: bahkan tanpa hak administrator, Anda dapat mengakses file di komputer Anda, Anda dapat mengeksekusi kode arbitrer, Anda dapat mengimplementasikan XSS, dan mengakses jaringan dll.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/zo/ng/zezongcdgttvaxcxleyye2bzrwi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertanyaan selanjutnya: jika Anda dapat membuat program ransomware yang tidak hanya menginfeksi bootplag, tetapi juga komputer pengguna, apakah ada cara untuk menyebarkannya lebih lanjut dengan membuatnya viral? Sekarang kita memiliki peretasan di tingkat lokal, tetapi bagi peretas itu akan jauh lebih bermanfaat untuk mendapatkan kendali atas banyak komputer pengguna melalui Internet. Bagaimana kita melakukan ini? Fungsi sosial mainan, seperti obrolan video, obrolan teks, transfer gambar, dan remote control itu sendiri, secara signifikan memperluas permukaan serangan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remote control adalah tujuan yang sangat baik, karena jika pengembang ingin menggunakan program berpemilik, itu pasti akan memiliki bug dan kerentanan. Bagaimana cara menggunakannya? Misalnya, Anda bisa mengirim mitra objek JSON yang berisi perintah, misalnya, perintah "Getar: 10":</font></font><br>
<br>
<pre><code class="plaintext hljs">{<font></font>
cate: "id",<font></font>
id: {<font></font>
DEADBABEBEEF: {<font></font>
v: 10<font></font>
}<font></font>
}<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini, penerima menganalisis JSON yang masuk, menghasilkan perintah untuk mainan dan mengirimkannya lebih lanjut, dan di sini ada 2 mode. Mode pertama "id:" mengirimkan perintah ke satu sex toy tertentu, mode kedua "semua:" mengirimkan perintah ke semua mainan jarak jauh. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apakah data yang masuk divalidasi dengan benar? Karena JSON sangat fleksibel, kodenya, mengharapkan nomor, bisa mendapatkan seluruh string. Jika kita dapat mengontrol perintah yang dikirim ke mainan, maka kita mungkin dapat menggunakan bug parser dongle. Pada slide berikutnya, bingkai oranye menunjukkan di mana data input digunakan, dan yang biru menunjukkan di mana itu diperiksa.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bug ini adalah bahwa aplikasi tidak memeriksa dengan benar bahwa input untuk perintah seperti getar sebenarnya adalah bilangan bulat. Dalam kasus ini, dalam mode "id:", hanya bahwa indeks intensitas getaran adalah n&gt; = 0 dicentang, dan jika Anda melewati bilangan bulat 12 yang lebih besar dari nol, parameter ini akan lulus tes. Bahkan jika Anda melewatkan sebuah string, yaitu angka dalam tanda kutip â€œ12â€, sistem akan menerimanya. Itu tidak akan hanya menerima string dalam bentuk kombinasi angka dan huruf, misalnya, "12test".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/p3/wo/30/p3wo30wl9o4ep3sbfovnxegq2zw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, pemeriksaan ini tidak memungkinkan kami untuk memasukkan perintah teks. Namun, jika Anda melihat bagian bawah kode, Anda akan melihat pemeriksaan yang sama, hanya saja kali ini aplikasi memeriksa kondisi n &lt;0. Sekarang, jika kita memasukkan "tes 12", maka kita tidak akan lulus ujian, karena aplikasi akan menganggap bahwa ungkapan ini sebagai string tidak kurang dari 0. Tetapi jika kita memasukkan string dengan ketidaksetaraan formulir! ("Tes 12" &lt;0), sistem akan menganggapnya benar , Terlepas dari kenyataan bahwa ini bukan bilangan bulat dan bukan angka sama sekali, tetapi kombinasi alfanumerik. Intinya, ini berarti bahwa kita dapat memasukkan perintah ini ke string acak yang akan dikirim ke dongle. Ini memungkinkan kami untuk mengirim kode exploit dengan cara yang sama seperti yang kami lakukan sebelumnya untuk mengkompromikan dongle melalui parser JSON. Satu-satunya perbedaan adalah bahwa sekarang hal itu dapat dilakukan melalui Internet.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/br/ep/cv/brepcvtjvqntad29bb6yrjzvmqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, berkat bug dalam implementasi filter untuk memeriksa data yang masuk, kami dapat secara jarak jauh melalui Internet melalui aplikasi Lovense untuk mengkompromikan dongle, di mana, pada gilirannya, kami dapat memecahkan komputer pengguna. Meretas dongle adalah hal yang hebat, tetapi syarat untuk sukses adalah persetujuan dari mitra untuk mentransfer kendali jarak jauh atas mainan kepada penyerang yang disamarkan. Ini nyaman untuk serangan yang ditargetkan, tetapi sama sekali tidak cocok untuk serangan virus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, obrolan teks dan gambar tidak memerlukan izin apa pun, yang memungkinkan serangan XSS klasik dengan mengirim kode HTML berbahaya dalam pesan teks obrolan. Mendistribusikan virus menjadi sepele: cukup buat fungsi JavaScript yang tepat dan spam teman Anda.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/l_/8x/khl_8xhfj3bvdiisecommxrbloe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, kita dapat mengeksekusi kode hanya dengan mengirim pesan dan pada dasarnya mencapai tujuan kita. </font><font style="vertical-align: inherit;">Payload XSS terakhir berfungsi seperti ini:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lakukan segala yang seharusnya terjadi pada mesin korban.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ambil objek JavaScript yang memungkinkan Anda mengakses obrolan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kirim payload XSS yang mengunduh skrip ini ke komputer semua teman Anda.</font></font></li>
</ol><br>
<img src="https://habrastorage.org/webt/8_/x5/6c/8_x56cslpr-tywovkeqgo7qbml0.jpeg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami mengkompromikan setiap node jaringan dari plug-in boot ke Internet. </font><font style="vertical-align: inherit;">Sekarang Anda dapat kompromi perangkat apa pun dari perangkat apa pun - kami membuat worm pantat, atau virus yang disebut "worm pantat".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gj/iq/lu/gjiqlujshp5vcsj5tm-hv6cbl8q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya janjikan, sekarang saya akan menunjukkan kepada Anda video langsung. Hal pertama yang akan saya tunjukkan adalah menggunakan jack BTLE untuk mencegat koneksi antara plug-in boot dan mesin virtual Windows biasa yang terhubung dengan dongle. Sekarang saya akan mencoba menyalakan bootplag - Saya harap Anda semua mendengar suara getaran! (tawa). Jadi, itu berhasil, sekarang saya akan mencoba menambahkan mainan saya ke panel kontrol aplikasi. Lihat bahwa programnya menemukan Hush, tetapi tunggu sebentar! Saya lupa memulai proses jack BTLE. Satu-satunya alasan Anda perlu menggunakan jack BTLE dalam mode ini adalah karena itu membuat demo langsung lebih mudah, tetapi dalam praktiknya, Anda dapat mencegat koneksi yang ada tanpa perlu mengendus. Jadi saya meluncurkan hal ini hanya untuk menyederhanakan percobaan. Mari kita ulangi lagi. Anda melihat bahwa sambungan ke mainan dibuat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/nz/v6/_h/nzv6_hy7ygt8gu9nqx7opfjz6-u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sniffer di sebelah kiri menunjukkan bahwa ia menemukan koneksi ini. Jadi, kami memiliki aplikasi yang terkait dengan sex toy kami. Saya tidak tahu apakah Anda mendengar bahwa saya benar-benar dapat mengontrol plug-in boot (smea menggerakkan slider ke atas, setelah itu terdengar suara getaran yang menguat). Sekarang saya mematikan hal ini (memindahkan slider ke bawah, suara getaran menghilang). Sekarang saya perlu meretas koneksi ini. Untuk melakukan ini, saya menyalin beberapa parameter, menempelkannya ke baris smea @ ubuntu dan pada akhirnya saya memasukkan parameter t - perintah untuk mencegat koneksi.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/u4/cm/bo/u4cmbo-uglzsqjur_ikimj7lifg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika ini berhasil, maka itu akan mematikan koneksi dengan aplikasi. Seperti yang Anda lihat, sebuah pesan muncul di jendela aplikasi bahwa koneksi dengan perangkat terputus. Terima kasih BTLE jack untuk alat yang hebat! Bootlog terputus dari aplikasi dan sekarang dikendalikan melalui mesin virtual ubuntu. Secara teoritis, kita harus bisa membuatnya bergetar dari jarak jauh. Saya mengetik tim Vibrate 20, dan seperti yang Anda lihat, semuanya berfungsi - kami dapat mengontrol bootplag dari jarak jauh tanpa bantuan aplikasi resmi (tepuk tangan dari hadirin). Sekarang saya akan meletakkannya dalam mode DFU, dan jika itu berhasil, maka saya harus menghentikan hal ini. Saya memasukkan perintah yang sesuai dan getaran berhenti.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1-/e4/xa/1-e4xaksu_5edfbsymanvlja6ii.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang saya mengambil ponsel cerdas saya dan memeriksa apakah saya dapat menghubungkan kembali mainan melalui aplikasi. Di antara aplikasi saya, saya menemukan pembaruan plug-in firmware dan pilih target DfuTarg - perangkat yang diperlukan untuk memperbarui firmware, tetapi pada kenyataannya - memperkenalkan exploit berbahaya ke dalamnya. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/ft/wt/yjftwtho753czqelp_td1n8gtq4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda melihat bagaimana proses pembaruan berjalan. Muncul pesan di layar bahwa firmware perangkat telah berhasil diperbarui. Sekarang saya akan mencoba lagi untuk menghubungkan bootplag ke aplikasi yang diinstal di komputer saya, dan Anda dapat melihat apa yang terjadi: screensaver ransomware muncul di layar (tepuk tangan dari hadirin)! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o6/fz/tj/o6fztjlfigtenb5mujgp6ukz9ho.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Ups, steker pantatmu dienkripsi! Bayar untuk memulihkan akses ke mainan penting ini dengan $ 50 bitcoin dalam waktu 3 hari, jika tidak dalam seminggu Anda akan kehilangan itu selamanya. â€ Begini cara kerjanya!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, Anda mengeksekusi kode pada dongle, lalu di komputer dan melalui Internet sampai ke plug boot. Seperti yang Anda lihat, dalam hal keamanan, plug butt ini sangat lemah, mungkin itu dibuat oleh Korea Utara. Anda melihat bahwa saya memiliki mesin virtual yang terpasang yang menjalankan aplikasi tanpa terhubung ke dongle atau perangkat keras lainnya. VM ini hanya terhubung ke Internet dan tampaknya terhubung ke komputer teman saya. Jadi kami telah berhasil mencapai penyebaran virus ransomware.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya pikir dari semua yang telah dikatakan, beberapa pelajaran yang berguna dapat dipelajari. Menggunakan perangkat ini sebagai contoh, kami memeriksa seberapa rentan dunia Internet terhadap berbagai hal. Beberapa perangkat digunakan untuk mendukung kehidupan, dan orang-orang tidak menyadari betapa rapuhnya teknologi baru ini. Meretas satu hal "pintar", Anda dapat menghubungkan perangkat "pintar" lainnya di rumah Anda melalui Internet. Saya berharap bahwa hasil penelitian saya berlaku tidak hanya untuk mainan seks. Juga, saya bermaksud mempelajari semua kode untuk hal ini, jadi bergabunglah dengan saya di Twitter. Saya juga akan menerbitkan alat saya di GitHub hari ini jika Anda ingin mulai meretas bootloop Anda sendiri.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/45/wc/wp45wcacsbefq8-9i-6p3k-qqmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingin berterima kasih kepada semua teman saya yang membantu saya dalam pentesting dan memperkenalkan saya ke dunia colokan pertempuran, menjadi gay ekstrim. </font><font style="vertical-align: inherit;">Saya tidak akan memberi nama, tetapi Aaron, Anda sendiri tahu siapa Anda (tertawa). </font><font style="vertical-align: inherit;">Terima kasih teman-teman, itu luar biasa!</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/RnxcPeemHSc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sedikit iklan :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terima kasih untuk tetap bersama kami. Apakah Anda suka artikel kami? Ingin melihat materi yang lebih menarik? Dukung kami dengan melakukan pemesanan atau merekomendasikan kepada teman Anda, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloud VPS untuk pengembang dari $ 4,99</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analog unik dari server entry-level yang diciptakan oleh kami untuk Anda: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seluruh kebenaran tentang VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps mulai dari $ 19 atau cara membagi server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (opsi tersedia dengan RAID1 dan RAID10, hingga 24 core dan hingga 40GB DDR4). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2 kali lebih murah di pusat data Equinix Tier IV di Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hanya kami yang memiliki </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV dari $ 199</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di Belanda!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - mulai dari $ 99! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baca tentang</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cara Membangun Infrastruktur Bldg. </font><font style="vertical-align: inherit;">kelas c menggunakan server Dell R730xd E5-2650 v4 seharga 9.000 euro untuk satu sen?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495782/index.html">Berita FOSS No. 10 - ulasan berita gratis dan sumber terbuka untuk 30 Maret - 5 April 2020</a></li>
<li><a href="../id495784/index.html">SamsPcbGuide, Bagian 14: Teknologi - Pengembangan Mikro dan Teknologi Chip-On-Board</a></li>
<li><a href="../id495786/index.html">Nulling global</a></li>
<li><a href="../id495788/index.html">Perangkat dari coronavirus atau troli lain dari sepotong roti?</a></li>
<li><a href="../id495790/index.html">Tukarkan sebagai alat untuk melindungi risiko: mengapa kita membutuhkan masa depan yang tidak biasa</a></li>
<li><a href="../id495794/index.html">Tentang kata kerja phrasal</a></li>
<li><a href="../id495796/index.html">Memilih Kartu Flash: Panduan Lengkap untuk Mengamankan Varietas Digital</a></li>
<li><a href="../id495798/index.html">Kubernetes dalam 3 hari. Hampir rumit</a></li>
<li><a href="../id495800/index.html">Jika saya mengajar Frontend hari ini. Tips Pemula</a></li>
<li><a href="../id495802/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 409 (30 Maret - 5 April 2020)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>