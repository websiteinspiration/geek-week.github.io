<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฆ ๐ป ๐๐ฟ ุฏููู ุนูู ุนูุณ ุฎุงุฏู ุงูุนููู apk ุนูู ูุซุงู ุงููููุฉ NeoQUEST-2020 ๐ฅข ๐๏ธ ๐ณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูููู ูุฏููุง ุจุฑูุงูุฌ ุบูู (ุณูููู ููุงู ุงููุซูุฑ ูู ูุฌุงูุงุช ุงูุฃูู ุงูุณูุจุฑุงูู ูู ููุช ูุงุญุฏ!): ูููุฑ ูู ูู ุชุฑููุฒ ุชุทุจูู Android ุ ูุงุนุชุฑุงุถ ุญุฑูุฉ ุงููุฑูุฑ ููุญุตูู ุนูู ุนูุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุฏููู ุนูู ุนูุณ ุฎุงุฏู ุงูุนููู apk ุนูู ูุซุงู ุงููููุฉ NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/496922/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f0/7j/vf/f07jvfe9r6534tbgp9bwdruryvy.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููู ูุฏููุง ุจุฑูุงูุฌ ุบูู (ุณูููู ููุงู ุงููุซูุฑ ูู ูุฌุงูุงุช ุงูุฃูู ุงูุณูุจุฑุงูู ูู ููุช ูุงุญุฏ!): ูููุฑ ูู ูู ุชุฑููุฒ ุชุทุจูู Android ุ ูุงุนุชุฑุงุถ ุญุฑูุฉ ุงููุฑูุฑ ููุญุตูู ุนูู ุนูุงููู URL ุ ูุฅุนุงุฏุฉ ุจูุงุก apk ุจุฏูู ุดูุฑุฉ ุงููุตุฏุฑ ุ ูุงูุนูู ูุน ูุญููู ุงูุชุดููุฑ ูุงููุฒูุฏ :) </font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููุง ููุฃุณุทูุฑุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุนุซุฑ ุงูุจุทู ุนูู ุฃุฌุฒุงุก ุฑูุจูุช ูุฏููุฉ ูุฌุจ ุงุณุชุฎุฏุงููุง ููุญุตูู ุนูู ุงูููุชุงุญ. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุจุฏุฃ!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Reversim apk</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุ ูุจููุง ููููุงู ุชูููุง ูู ุงุณุชุฎูุงุตู ูู ุฑูุจูุช ุดุจู ูููู - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุทุจูู apk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฌุจ ุฃู ูุณุงุนุฏูุง ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูู ุงูุญุตูู ุนูู ุงูููุชุงุญ. ูููู ุจุฃูุซุฑ ูุถูุญ: ุชุดุบูู apk ูุฅููุงุก ูุธุฑุฉ ุนูู ูุธุงุฆูู. ูุง ุชุชุฑู ูุงุฌูุฉ ุงูุชุทุจูู ุฃูุซุฑ ูู ุฃุถูู ุงูุญุฏูุฏ - ูุฐุง ุนููู ููู FileDroid ูุฎุตุต ูุณูุญ ูู ุจุชูุฒูู ููู ูู ุฎุงุฏู ุจุนูุฏ. ุญุณููุง ุ ูุจุฏู ุงูุฃูุฑ ุณููุงู. ูููู ุจุชูุตูู ุงููุงุชู ุจุงูุฅูุชุฑูุช ุ ููููู ุจูุญุงููุฉ ุชุฌุฑูุจูุฉ ููุชูุฒูู (ุนูู ุงูููุฑ key.txt - ุญุณููุง ุ ูุงุฐุง ููุ) - ุบูุฑ ูุงุฌุญ ุ ุงูููู ููููุฏ ุนูู ุงูุฎุงุฏู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b4/kf/z3/b4kfz3wd44ev6ckfy664ba0ugho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูู ุฅูู ุงูุญุฏุซ ุงูุชุงูู ูู ุญูุซ ุงูุชุนููุฏ - ูููู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุจูู</font></a><font style="vertical-align: inherit;"> ููู apk ุจุงุณุชุฎุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JADX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญููู ุดูุฑุฉ ุงููุตุฏุฑ ููุชุทุจูู ุ ูุงูุชู ุ ูุญุณู ุงูุญุธ ุ ููุณุช ุบุงูุถุฉ ุนูู ุงูุฅุทูุงู. ูููุชูุง ุงูุญุงููุฉ ูู ููู ุงููููุงุช ุงูุชู ูููุฑูุง ุงูุฎุงุฏู ุงูุจุนูุฏ ููุชูุฒูู ุ ูุชุญุฏูุฏ ุงูููู ุงูุฐู ูุญุชูู ุนูู ุงูููุชุงุญ ููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุจูุฆุฉ com.ctf.filedroid.MainActivity ุ ุงูุชู ุชุญุชูู ุนูู ุทุฑููุฉ onClick () ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ุจุงููุณุจุฉ ููุง ุ ูุงูุชู ุชุชู ูููุง ูุนุงูุฌุฉ ุงูููุฑ ุนูู ุงูุฒุฑ "ุชูุฒูู". ุฏุงุฎู ูุฐู ุงูุทุฑููุฉ ุ ูุชู ุงุณุชุฏุนุงุก ูุฆุฉ ConnectionHandler ูุฑุชูู: ุฃููุงู ุ ูุชู ุงุณุชุฏุนุงุก ุฃุณููุจ ConnectionHandler.getToken () ุ ูุนูุฏูุง ููุท ุ ูุชู ุงุณุชุฏุนุงุก ConnectionHandler.getEncryptedFile () ุ ุงูุฐู ููุฑุฑ ุงุณู ุงูููู ุงูุฐู ูุทูุจู ุงููุณุชุฎุฏู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m5/66/by/m566byk1sozhodekerf1ggpf1hc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนู ุ ูุฐุง ุฃููุงู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุฑูุฒ ูููุฒ! ุณูู ูุฏุฑุณ ุฃูุซุฑ ุจูููู ูุน ุนูููุฉ ุงูุญุตูู ุนูููุง.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฃุฎุฐ ุทุฑููุฉ ConnectionHandler.getToken () ุณุทุฑูู ูู ุงููุฏุฎูุงุช ุ ุซู ุชุฑุณู ุทูุจ GET ุ ูุชูุฑูุฑ ูุฐู ุงูุณุทูุฑ ููุนููุงุช "crc" ู "sign". ูุฑุฏุงู ุนูู ุฐูู ุ ูุฑุณู ุงูุฎุงุฏู ุงูุจูุงูุงุช ุจุชูุณูู JSON ุ ุงูุฐู ูุณุชุฎุฑุฌ ููู ุชุทุจูููุง ุฑูุฒ ุงูุฏุฎูู ููุณุชุฎุฏูู ูุชูุฒูู ุงูููู. ูุฐุง ููู ุ ุจุงูุทุจุน ุ ุฌูุฏ ุ ููู ูุง ูู "crc" ู "sign"ุ </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yn/gy/lg/yngylgy7dstfocghhk0w_eufgcg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูุฐุง ุ ููุชูู ุฃูุซุฑ ูุญู ูุฆุฉ ุงูุดููุงุช ุ ูุฑุฌู ุชูุฏูู ุฃุณุงููุจ badHash () ู badSign (). ุงูุฃูู ูุญุณุจ ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูู classes.dex ู resources.arsc ุ ูุฑุจุท ูุงุชูู ุงููููุชูู ูููููุง ูู Base64 (ุงูุชุจู ููุนูู 10 = NO_WRAP | URL_SAFE ุ ุณูููู ูููุฏูุง). ููุงุฐุง ุนู ุงูุทุฑููุฉ ุงูุซุงููุฉุ ูููุนู ุงูุดูุก ููุณู ูุน ุจุตูุฉ SHA-256 ูุชูููุน ุงูุชุทุจูู. ุฅูู ุ ูุจุฏู ุฃู FileDroid ููุณ ุญุฑูุตูุง ุญููุง ุนูู ุฅุนุงุฏุฉ ุจูุงุฆู :(</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lj/yj/xo/ljyjxoxvrlc8q3pjfxyrerya5ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ูููุชุฑุถ ุฃููุง ุชููููุง ุงูุฑูุฒ ุงููููุฒ. ูุงุฐุง ุจุนุฏุ ูููู ุจุชูุฑูุฑู ุฅูู ุฅุฏุฎุงู ุฃุณููุจ ConnectionHandler.getEncryptedFile () ุ ุงูุฐู ููุญู ุงุณู ุงูููู ุงููุทููุจ ุจุงูุฑูุฒ ููููุฏ ุทูุจ GET ุขุฎุฑ ุ ูุฐู ุงููุฑุฉ ูุน ูุนููุงุช "token" ู "file". ูุฑุณู ุงูุฎุงุฏู ุงุณุชุฌุงุจุฉ (ุจูุงุกู ุนูู ุงุณู ุงูุทุฑููุฉ) ููููุง ูุดูุฑูุง ุ ูุชู ุชุฎุฒููู ุนูู / sdcard /. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุ ูุชูุฎูุต ุงููุฌููุน ุงููุฑุนู ุงูุตุบูุฑ: ูุฏููุง ุฎุจุฑุงู ุ ู ... ููุงููุง ุณูุฆุงู. ุฃููุงู ุ ูุง ูุฏุนู FileDroid ุจุงููุนู ุญูุงุณุชูุง ูุชุนุฏูู apk (ูุชู ุงูุชุญูู ูู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูุงูุชูููุน) ุ ูุซุงูููุง ุ ูุนุฏ ุงูููู ุงููุณุชูู ูู ุงูุฎุงุฏู ุจุชุดููุฑู.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณููุง ุ ุณูููู ุจุญู ุงููุดููุงุช ุจูุฌุฑุฏ ุชููุฑูุง ุ ูุงูุขู ูุดููุชูุง ุงูุฑุฆูุณูุฉ ูู ุฃููุง ูุง ุฒููุง ูุง ูุนุฑู ุงูููู ุงูุฐู ูุญุชุงุฌ ูุชูุฒููู. ููุน ุฐูู ุ ูู ุนูููุฉ ุฏุฑุงุณุฉ ูุฆุฉ ConnectionHandler ุ ูุง ูุณุนูุง ุฅูุง ุฃู ููุงุญุธ ูุฐุง ุงูุญู ุจูู ุทุฑู getToken () ู getEncryptedFile () ุ ูุณู ูุทูุฑู FileDroid ุทุฑููุฉ ุฃุฎุฑู ุฌุฐุงุจุฉ ุฌุฏูุง ุชุณูู ุชุญุฏุซ getListing (). ูุฐุง ุ ูุฏุนู ุงูุฎุงุฏู ูุซู ูุฐู ุงููุธุงุฆู ... ูุจุฏู ุฃู ูุฐุง ูุง ุชุญุชุงุฌู!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fk/xz/v1/fkxzv1ac9ictxo7gy67ku_u44nq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุญุตูู ุนูู ุงููุงุฆูุฉ ุ ุณูุญุชุงุฌ ุฅูู "crc" ู "sign" ุงููุนุฑูููู - ููุณุช ูุดููุฉ ุ ููุญู ูุนุฑู ุจุงููุนู ูู ุฃูู ุฃุชูุง. </font><font style="vertical-align: inherit;">ููุฑุฃ ุงูููู ููุฑุณู ุทูุจ GET ู ... ูุฐุง ุชููู. </font><font style="vertical-align: inherit;">ุฅูู ุฃูู ุณูุฑุณู ุทูุจ GETุ </font><font style="vertical-align: inherit;">ุณูููู ูู ุงูุฌูุฏ ุงูุญุตูู ุนูู ุนููุงู URL ููุฎุงุฏู ุงูุจุนูุฏ ุฃููุงู. </font><font style="vertical-align: inherit;">ุฅูู ุ ูุนูุฏ ุฅูู MainActivity.onClick () ููุฑู ููู ูุชู ุฅูุดุงุก ูุณูุทุงุช netPath ูุงุณุชุฏุนุงุก ุทุฑููุชูู getToken () ู getEncryptedFile ():</font></font><br>
<br>
<pre><code class="coffeescript hljs">Method getSecureMethod = <font></font>
wat.class.getDeclaredMethod("getSecure", <span class="hljs-keyword">new</span> Class[]{String.class});<font></font>
<font></font>
// . . .<font></font>
<font></font>
// netPath --&gt; ConnectionHandler.getToken()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"fnks"})<font></font>
<font></font>
// netPath --&gt; ConnectionHandler. getEncryptedFile()<font></font>
(String) getSecureMethod.invoke((Object) <span class="hljs-literal">null</span>, <span class="hljs-keyword">new</span> Object[]{"qdkm"})
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุฌุจุฑูุง ุชุฑููุจุงุช ุงูุฃุญุฑู ุงูุบุฑูุจุฉ "fnks" ู "qdmk" ุนูู ุงูุชุญูู ุฅูู ูุชูุฌุฉ ูู ุทุฑููุฉ wat.getSecure (). </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุณุฏ: JADX ููุง ูุฐู ุงููุชูุฌุฉ. </font></font></s><br>
<br>
<img src="https://habrastorage.org/webt/-r/ih/gi/-rihgizr3f3kvj0uge_1ekoaxsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุงููุญุต ุงูุฏููู ุ ูุตุจุญ ูู ุงููุงุถุญ ุฃู ูู ูุฐุง ุงููุญุชูู ุบูุฑ ุงููุทูู ุฌุฏูุง ููุทุฑููุฉ ูููู ุงุณุชุจุฏุงูู ุจุญุงูุฉ ุงูุชุจุฏูู ุงููุนุชุงุฏุฉ ูู ูุฐุง ุงูููุน:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-regexp">//</span> . . .
<span class="hljs-keyword">switch</span>(CODE)<font></font>
{<font></font>
    case ยซqdkmยป: <font></font>
        r<span class="hljs-number">.2</span> = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case ยซtkogยป: <font></font>
        r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;<font></font>
    case ยซfnksยป: <font></font>
        String r2 = com.ctf.filedroid.x37AtsW8g.rlieh786d(<span class="hljs-number">0</span>);
	<span class="hljs-keyword">break</span>;<font></font>
}<font></font>
java.lang.StringBuilder r1 = <span class="hljs-keyword">new</span> java.lang.StringBuilder <font></font>
r1.&lt;init&gt;(r2) <font></font>
java.lang.String r0 = r1.toString() <font></font>
java.lang.String r1 = radon(r0)<font></font>
<span class="hljs-keyword">return</span> r1 </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุฃู "fnks" ู "qdmk" ููุณุชุฎุฏูุงู ุจุงููุนู ููุญุตูู ุนูู ุฑูุฒ ูููุฒ ูุชูุฒูู ููู ุ ูุฌุจ ุฃู ูุนุทู "tkog" ุนููุงู URL ุงููุทููุจ ูุทูุจ ูุงุฆูุฉ ุจุงููููุงุช ุงููุชููุฑุฉ ุนูู ุงูุฎุงุฏู. </font><font style="vertical-align: inherit;">ูุจุฏู ุฃู ููุงู ุฃูู ูู ุงูุญุตูู ุนูู ุงููุณุงุฑ ุงููุทููุจ ุจุซูู ุจุฎุณ ... ุฃููุงู ููุจู ูู ุดูุก ุ ุฏุนูุง ูุฑู ููู ูุชู ุชุฎุฒูู ุนูุงููู URL ูู ุงูุชุทุจูู. </font><font style="vertical-align: inherit;">ููุชุญ ูุธููุฉ com.ctf.filedroid.x37AtsW8g.rlieh786d () ููุฑู ุฃู ูู ุนููุงู URL ูุชู ุญูุธู ูุตููู ุจุงูุช ูุดูุฑ ุ ูุฃู ุงููุธููุฉ ููุณูุง ุชุดูู ุณูุณูุฉ ูู ูุฐู ุงูุจุงูุชุงุช ูุชุนูุฏูุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/4e/xz/yt4exza37qeytal-i9snbrlo4co.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุณู. </font><font style="vertical-align: inherit;">ูููู ุจุนุฏ ุฐูู ูุชู ุชูุฑูุฑ ุงูุฎุท ุฅูู ุฏุงูุฉ com.ctf.filedroid.wat.radon () ุ ูุงูุชู ูุชู ุชูุฏูู ุชูููุฐูุง ุฅูู ุงูููุชุจุฉ ุงูุฃุตููุฉ libae3d8oe1.so. </font><font style="vertical-align: inherit;">ุนูุณ ุงูุฐุฑุงุน 64ุ </font><font style="vertical-align: inherit;">ูุญุงููุฉ ุฌูุฏุฉ ุ FileDroid ุ ูููู ูุฃุชู ูู ููุช ุขุฎุฑุ</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. ุงุญุตู ุนูู ุนูุงููู url ููุฎุงุฏู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุญุงูู ุงูุงูุชุฑุงุจ ูู ุงูุฌุงูุจ ุงูุขุฎุฑ: ูุงุนุชุฑุงุถ ุญุฑูุฉ ุงููุฑูุฑ ูุงูุญุตูู ุนูู ุนูุงููู URL ุจูุต ูุงุถุญ (ููููุงูุฃุฉ ุฃูุถูุง ุ ูููู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูุงูุชูููุน!) ุ ููุทุงุจูุชูุง ูุน ุตูุงุฆู ุงูุจุงูุช ูู com.ctf.filedroid.x37AtsW8g.rlieh786d () - ูููู ูู ุงุชุถุญ ุฃู ุงูุชุดููุฑ ูู ุชุดููุฑ ููุตุฑ ุฃู XOR ุงููุนุชุงุฏุ .. ููู ูููู ูู ุงูุตุนุจ ุงุณุชุนุงุฏุฉ ุนููุงู URL ุงูุซุงูุซ ูุชูููุฐ ุงููุงุฆูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุนุงุฏุฉ ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ุ ููููู ุงุณุชุฎุฏุงู ุฃู ูููู ููุงุณุจ ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุงุฒู ุงูููุงู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BURP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุฎ.). ูููู ุจุชูููู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุนูู ุฌูุงุฒ ูุญููู ุ ูุชุซุจูุช ุงูุดูุงุฏุฉ ุงูููุงุณุจุฉ ุ ูุงูุชุญูู ูู ูุฌุงุญ ุงูุงุนุชุฑุงุถ ุ ูุฅุทูุงู FileFroid. ูุญู ูุญุงูู ุชูุฒูู ููู ุชุนุณูู ู ... ุงูุธุฑ "NetworkError". ุญุฏุซ ูุฐุง ุงูุฎุทุฃ ุจุณุจุจ ูุฌูุฏ ุชุซุจูุช ุงูุดูุงุฏุฉ (ุฑุงุฌุน ุฃุณููุจ com.ctf.filedroid.ConnectionHandler.sendRequest): ูุชุญูู ุนููู ุงูููู ูู ุฃู ุงูุดูุงุฏุฉ "ุณูููุฉ" ูู ุงูุชุทุจูู ุชุชูุงูู ูุน ุงูุฎุงุฏู ุงูุฐู ุชุชูุงุนู ูุนู. ุฃุตุจุญ ูู ุงููุงุถุญ ุงูุขู ุณุจุจ ุงูุชุญูู ูู ุณูุงูุฉ ููุงุฑุฏ ุงูุชุทุจูู! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8y/su/ya/8ysuya2vqxuwxdzrmt9xsuajq7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุน ุฐูู ุ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุชู ุชู ุงุนุชุฑุงุถูุง ุ ูููููุง ุฃู ูุฑู ุนูู ุงูุฃูู ุงุณู ูุทุงู ุงูุฎุงุฏู ุงูุฐู ุชู ุงููุตูู ุฅููู ูู ูุจู ุนููู ุงูููู ุ ููุง ูุนูู ุฃู ุงูุฃูู ูู ูู ุชุดููุฑ ุนูุงููู URL ูุง ูุฒุงู!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/im/2w/8l/im2w8l7u7b0optrada1cuhbxcge.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุนูุฏ ุฅูู ูุธููุฉ com.ctf.filedroid.x37AtsW8g.rlieh786d () ูููุงุญุธ ุฃู ุงูุนุดุฑุงุช ุงูููููุฉ ุงูุฃููู ูู ุงูุจุงูุช ุชุชุฒุงูู ูู ุฌููุน ุงููุตูููุงุช:</font></font><br>
<br>
<pre><code class="coffeescript hljs">cArr[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'i'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . .};<font></font>
<font></font>
cArr[<span class="hljs-number">2</span>] = <span class="hljs-keyword">new</span> char[]{<span class="hljs-string">'K'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'Y'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'S'</span>, <span class="hljs-string">'0'</span>, <span class="hljs-string">'t'</span>, <span class="hljs-string">'W'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'k'</span>, <span class="hljs-string">'N'</span>, <span class="hljs-string">'j'</span>, <span class="hljs-string">'8'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'d'</span>, <span class="hljs-string">'K'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'l'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'T'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'3'</span>, <span class="hljs-string">'P'</span>, <span class="hljs-string">'h'</span>, <span class="hljs-string">'V'</span>, <span class="hljs-string">'J'</span>, <span class="hljs-string">'Q'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'L'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'R'</span>, <span class="hljs-string">'5'</span>, <span class="hljs-string">'p'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'j'</span>, . . ., <span class="hljs-string">'='</span>};
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุดูุฑ ุงูุจุงูุช ุงูุฃุฎูุฑ ูู ุงููุตูููุฉ ุงูุซุงูุซุฉ ุฅูู ุฃูู ูู ููู ุฎุงูููุง ูู base64. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุญุงูู ูู ุชุดููุฑ ุงูุจุงูุช ุงููุงุชุฌ ูุน ุฌุฒุก ูุนุฑูู ูู ุนููุงู URL: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8o/mh/1m/8omh1mtmtqzkcdy7mpqyemyiuzw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃูู ูู ููู ุฃู ุดุฎุต ุณุนูุฏูุง ุนูู ุงูุฅุทูุงู ุจุงุณุชุฎุฏุงู ARMag3dd0n! </font><font style="vertical-align: inherit;">ุงูุดูุก ุตุบูุฑ: ูู ุชุดููุฑ ุนูุงููู URL base64 ุจุงูุชุณูุณู ู xorim ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุฐู ุชู ุงูุนุซูุฑ ุนููู. </font><font style="vertical-align: inherit;">ูููู ... ูุฅุฐุง ูู ููู XOR ุ ูููู ุชุดููุฑ ุชุจุงุฏูู ุฐุงุชู ุ ูุง ููููู ุงูุชูุงุทู ุญุชู ูุน ูุงุฆุฉ ูุญุงููุฉุ</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. ุฅุนุงุฏุฉ ุจูุงุก apk ูุน ูุฑูุฏุง</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุฒุก ูู ูุฐู ุงููุชุงุจุฉ ุ ุณููุธุฑ ูู ุทุฑููุฉ ุญู ุฃูุซุฑ ุฅููุงููุง (ููู ุฑุฃููุง ุ ุฃูุซุฑ ุฌูุงููุง) - ุจุงุณุชุฎุฏุงู ุฅุทุงุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุฐู ุณูุณูุญ ููุง ุจุชูููุฐ ุทุฑู ุชุทุจูู apk ุชุนุณููุฉ ุจุงูุญุฌุฌ ุงูุชู ูุญุชุงุฌูุง ูู ููุช ุงูุชุดุบูู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ูุงุชู ูุน ุญููู ุงูุฌุฐุฑ ุฃู ูุญุงูู. </font><font style="vertical-align: inherit;">ููุชุฑุถ ุฎุทุฉ ุงูุนูู ุงูุชุงููุฉ:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑููุจ ููููุงุช ูุฑูุฏุง ุนูู ุฌูุงุฒ ููุจููุชุฑ ููุงุชู ุชุฌุฑูุจู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุนุฏ ุนูุงููู URL ุงููุทุงุจูุฉ ูุฑูุฒ ุฃู ุทูุจุงุช ุงูุฅุฏุฑุงุฌ ููู ุจุชูุฒูู ุงูููู (ุจุงุณุชุฎุฏุงู Frida).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุฑุฌุงุน ููู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูุงูุชูููุน ููุชุทุจูู ุงูุฃุตูู.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุตูู ุนูู ูุงุฆูุฉ ุจุงููููุงุช ุงููุฎุฒูุฉ ุนูู ุงูุฎุงุฏู ูุชุญุฏูุฏ ุงูููู ุงููุทููุจ.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชูุฒูู ุงูููู ููู ุชุดููุฑู.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ุณููุถุญ ุงูุนูุงูุฉ ุจูู ุงููุงุชู ุงูุฌุฐุฑ ู apk. ูููู ุจุชุซุจูุช ุงูุชุทุจูู ูุชุดุบููู ุ ูููู ุนููู ุงููููุงุช ูุง ูุฑูุฏ ุงูุชูููุฏ ุจุงููุงูู ุ ููู ูููุถ ููุท ููุบูู. ูุชุญูู ูู ุงูุฑุณุงุฆู ูู ุฎูุงู logcat - ูุนู ุ ูุดุนุฑ FileDroid ุจุงููุนู ุฃู ุดูุฆูุง ูุง ุฎุงุทุฆ ูููุงูู ูุฏุฑ ุงูุฅููุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vn/8s/2b/vn8s2bzyijssy664hsdgcxqnawc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูู ูุฑุฉ ุฃุฎุฑู ุฅูู ูุฆุฉ MainActivity ููุฌุฏ ุฃู ุทุฑููุฉ doChecks () ุชุณูู onCreate () ุ ูุชุนุฑุถ ุงูุฃุฎุทุงุก ุงูุชุงููุฉ ูู ุงูุณุฌู: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ws/xl/i6/wsxli6hxrjmgqnnkuh6b5a7h8my.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุชุญูู onResume () ุฃูุถูุง ููุนุฑูุฉ ูุง ุฅุฐุง ูุงู ุงููููุฐ ุงููููุฐุฌู ูู Frida ููุชูุญูุง: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-k/df/kv/-kdfkvyea8g0p6y-dkwxpk3flo4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนููู ุงููููุงุช ุงูุฎุงุต ุจูุง ุบูุฑ ูุชุณุงูุญ ููููุงู ุฅูู ุงูุชุตุญูุญ ูุงูุฌุฐุฑ ููุฑูุฏุง ููุณูุง. ูุง ูุชู ุชุถููู ูุฐู ุงููุนุงุฑุถุฉ ุนูู ุงูุฅุทูุงู ูู ุฎุทุทูุง ุ ูุฐูู ูุญุตู ุนูู ุฑูุฒ smali ููุชุทุจูู ุจุงุณุชุฎุฏุงู ุฃุฏุงุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apktool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุงูุชุญ ููู MainActivity.smali ูู ุฃู ูุญุฑุฑ ูุตูุต ุ ูุงุจุญุซ ุนู ุทุฑููุฉ onCreate () ููู ุจุชุญููู ุงุณุชุฏุนุงุก doChecks () ุฅูู ุชุนููู ุบูุฑ ุถุงุฑ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z6/r2/ra/z6r2rautxzhef-0prc9odxmj2ek.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ูุญุฑู ุทุฑููุฉ ุงูุงูุชุญุงุฑ () ูู ุงููุฑุตุฉ ูุฅุบูุงู ุงูุชุทุจูู ุญููุง: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/ti/q6/iutiq6k6idg5_6h7wd1he2mjyem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุฏุนููุง ูุจูู ุชุทุจูููุง ุงููุญุณู ููููุงู ูุฑุฉ ุฃุฎุฑู ุจุงุณุชุฎุฏุงู apktool ูุชูููุน ูู ุนู ุทุฑูู ุชูููุฐ ุงูุฃูุงูุฑ ุงูุชุงููุฉ (ูุฏ ุชุญุชุงุฌ ุฅูู ุญููู ุงููุณุคูู):</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> <span class="hljs-string">"C:\Program Files\Java\jdk-14\bin"</span>
.\keytool -genkey -v -keystore filedroid.keystore -<span class="hljs-built_in">alias</span> filedroid_alias -keyalg RSA -keysize 2048 -validity 10000<font></font>
.\jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore  filedroid.keystore filedroid_patched.apk filedroid_alias<font></font>
.\jarsigner -verify -verbose -certs filedroid_patched.apk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ูุนูุฏ ุชุซุจูุช ุงูุชุทุจูู ุนูู ุงููุงุชู ุ ููุดุบูู - ุนูู ุนุฌู ุ ุงูุชูุฒูู ุจุฏูู ุญูุงุฏุซ ุ ุงูุณุฌู ูุธูู! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qm/u4/k2/qmu4k2ta7zji47msjnyhhq8ibqi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูู ุฅูู ุชุซุจูุช ุฅุทุงุฑ ุนูู Frida ุนูู ุฌูุงุฒ ููุจููุชุฑ ูุฌูุงุฒ ูุญููู:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo pip3 install frida-tools<font></font>
$ wget https://github.com/frida/frida/releases/download/$(frida --version)/frida-server-$(frida --version)-android-arm.xz<font></font>
$ unxz frida-server-$(frida --version)-android-arm.xz<font></font>
$ adb push frida-server-$(frida --version)-android-arm /data/<span class="hljs-built_in">local</span>/tmp/frida-server
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชุดุบูู ุฎุงุฏู ุฅุทุงุฑ ูุฑูุฏุง ุนูู ุฌูุงุฒ ูุญููู:</font></font><br>
<br>
<pre><code class="bash hljs">$ adb shell su - <span class="hljs-string">"chmod 755 /data/local/tmp/frida-server"</span>
$ adb shell su - <span class="hljs-string">"/data/local/tmp/frida-server &amp;"</span>  
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ุจุตุฏุฏ ุฅุนุฏุงุฏ ูุต ุจุฑูุฌู get-urls.js ุจุณูุท ูุณุชุฏุนู wat.getSecure () ูุฌููุน ุฎูุงุฏู ุงูุทูุจุงุช ุงููุฏุนููุฉ:</font></font><br>
<br>
<pre><code class="actionscript hljs">Java.perform(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> 
</span>{
     <span class="hljs-keyword">const</span> wat = Java.use(<span class="hljs-string">'com.ctf.filedroid.wat'</span>);<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"fnks"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"qdmk"</span>));<font></font>
	console.log(wat.getSecure(<span class="hljs-string">"tkog"</span>));<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุทูููุง FileDroid ุนูู ุงูุฌูุงุฒ ุงููุญููู ู "ุงูุชุดุจุซ" ูุน ูุตูุง ููุนูููุฉ ุงูููุงุจูุฉ: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pc/ir/if/pcirifn_grrejaapwi7s-7hg-xe.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงููููุงุช ุงูููุฌูุฏุฉ ุนูู ุงูุฎุงุฏู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃุฎูุฑูุง ุ ุฃุตุจุญ ุงูุฎุงุฏู ุงูุจุนูุฏ ุฃูุฑุจ ุฅูููุง ููููุงู! </font><font style="vertical-align: inherit;">ูุนูู ุงูุขู ุฃู ุงูุฎุงุฏู ูุฏุนู ุงูุทูุจุงุช ุจุงูุทุฑู ุงูุชุงููุฉ:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุชูุนุฉ ูู androidroid.neoquest.ru/api/verifymeุcrc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chedroid.neoquest.ru/api/list_post_apocalyptic_collectionุcrc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุชู ุญูุธู ูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">androidroid.neoquest.ru/api/fileุfile=</font></a><font style="vertical-align: inherit;"> {file} &amp; token = {token}</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุฌู ุงูุญุตูู ุนูู ูุงุฆูุฉ ุจุงููููุงุช ุงููุชููุฑุฉ ุ ูุจูู ุญุณุงุจ ููู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูุงูุชูููุน ููุชุทุจูู ุงูุฃุตูู ุ ุซู ุชุฑููุฒูุง ูู base64. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุณูุญ ูู ูุซู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ูู python3 ุจุงูููุงู ุจุฐูู:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุณุฏ</font></font></b>
                        <div class="spoiler_text"><pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> binascii
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">from</span> asn1crypto <span class="hljs-keyword">import</span> cms, x509
<span class="hljs-keyword">from</span> zipfile <span class="hljs-keyword">import</span> ZipFile<font></font>
<font></font>
<font></font>
def get_info(apk):<font></font>
    with ZipFile(apk, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> zipObj:<font></font>
        classes = zipObj.read(<span class="hljs-string">"classes.dex"</span>)<font></font>
        resources = zipObj.read(<span class="hljs-string">"resources.arsc"</span>)<font></font>
        cert = zipObj.read(<span class="hljs-string">"META-INF/CERT.RSA"</span>)<font></font>
        crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
        <span class="hljs-keyword">return</span> get_full_crc(classes, resources).decode(<span class="hljs-string">"utf-8"</span>), get_sign(cert).decode(<span class="hljs-string">"utf-8"</span>)<font></font>
<font></font>
<font></font>
def get_crc(file):<font></font>
    crc = binascii.crc32(file) &amp; <span class="hljs-number">0xffffffff</span>
    <span class="hljs-keyword">return</span> crc<font></font>
<font></font>
<font></font>
def get_full_crc(classes, resources):<font></font>
    crc = <span class="hljs-string">"%s%s"</span> % (get_crc(classes), get_crc(resources))
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(bytes(crc, <span class="hljs-string">"utf-8"</span>))<font></font>
<font></font>
<font></font>
def get_sign(file):<font></font>
    pkcs7 = cms.ContentInfo.load(file)<font></font>
    data = pkcs7[<span class="hljs-string">'content'</span>][<span class="hljs-string">'certificates'</span>][<span class="hljs-number">0</span>].chosen.dump()<font></font>
    sha256 = hashlib.sha256()<font></font>
    sha256.update(data)<font></font>
    <span class="hljs-keyword">return</span> base64.urlsafe_b64encode(sha256.digest())  <font></font>
<font></font>
get_info(<span class="hljs-string">'filedroid.apk'</span>)
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุฃูุถูุง ูุฏูููุง. ูุนุชุจุฑ CRC32 ูู classes.dex ู resources.arsc ุฃู ุฃุฏุงุฉ ููุงุณุจุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ููุธุงู Linux - ุฃุฏุงุฉ crc32 ุงูููุงุณูุฉ) ุ ูุญุตู ุนูู ุงูููู 1276945813 ู 2814166583 ุนูู ุงูุชูุงูู ุ ููู ุจุฑุจุทูุง (12769458132814166583 ุณุชุฎุฑุฌ) ูุชุฑููุฒ ูู base64 ุ ุนูู ุณุจูู ุงููุซุงู ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wb/ba/km/wbbakmhm-8jmtyyudjhofelaz8s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุฌู ุชูููุฐ ุฅุฌุฑุงุก ููุงุซู ูุชูููุน ุงูุชุทุจูู ุ ูู ูุงูุฐุฉ JADX ุ ุงูุชูู ุฅูู ูุณู "ุชูููุน APK" ุ ุงูุณุฎ ูููุฉ "SHA-256 Fingerprint" ููู ุจุชุฑููุฒูุง ูู base64 ููุฌููุนุฉ ุจุงูุช: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wx/s9/zg/wxs9zgvtahyytsnvxis-k8lq8wg.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงู: ูุงู:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููู apk ุงูุฃุตูู ุ ูุชู ุชูููุฐ ุชุฑููุฒ base64 ุจุนูุงูุฉ URL_SAFE ุ ุฃู </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ุงูุฃุญุฑู "+" ู "/" ู "-" ู "_" ุนูู ุงูุชูุงูู. </font><font style="vertical-align: inherit;">ูู ุงูุถุฑูุฑู ุงูุชุฃูุฏ ูู ุฃูู ุณูุชู ููุงุญุธุฉ ุฐูู ุฃูุถูุง ูุน ุงูุชุฑููุฒ ุงูุฐุงุชู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุนูุฏ ุงูุชุฑููุฒ ุนุจุฑ ุงูุฅูุชุฑูุช ุ ููููู ุงุณุชุจุฏุงู ุงูุฃุจุฌุฏูุฉ ุงููุณุชุฎุฏูุฉ ุจู "ABCDEFGHIJKLMNOPQRSTUVWXYZabcde fghijklmnopqrstuvwxyz0123456789 + /" ุจู "ABCDEFGHIJKLMNOPQRSTUVWxvppc6464.cp.cp.cp64.cp.cp.cp64.cp.cp64.cp </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุฎูุฑูุง ุ ูุฏููุง ุฌููุน ุงูููููุงุช ูุฅุฏุฑุงุฌ ุงููููุงุช ุจูุฌุงุญ:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chedroid.neoquest.ru/api/list_post_apocalyptic_collectionุcrc=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {crc} &amp; sign = {sign}</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crc: MTI3Njk0NTgxMzI4MTQxNjY1ODM =</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณุฌูู ุงูุฏุฎูู: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY =</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐ ุทูุจ GET - ูููุชู ุ ูุงุฆูุชูุง! </font><font style="vertical-align: inherit;">ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุงุณู ุฃุญุฏ ุงููููุงุช ูุชุญุฏุซ ุนู ููุณู - "ููุชูุญ ุฅุฐุง ุฃุฑุฏุช ุฃู ุชูุฑุจ" - ูุจุฏู ุฃููุง ุจุญุงุฌุฉ ุฅููู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/k4/vz/bkk4vzawktgg1ilhn1x06q90ahq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ูุทูุจ ุฑูุฒ ูุตูู ููุฑุฉ ูุงุญุฏุฉ ููููู ุจุชูุฒูู ุงูููู:</font></font><br>
<br>
<pre><code class="coffeescript hljs"><span class="hljs-keyword">import</span> requests<font></font>
<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/verifyme'</span>, <font></font>
    		params={    <span class="hljs-string">'crc'</span>: <span class="hljs-string">'MTI3Njk0NTgxMzI4MTQxNjY1ODM='</span>, 
<span class="hljs-string">'sign'</span>: HeiTSPWdCuhpbmVxqLxW-uhrozfG_QWpTv9ygn45eHY=},<font></font>
verify=False)<font></font>
    <font></font>
token = response.json()[<span class="hljs-string">'token'</span>]
<span class="hljs-built_in">print</span>(token)<font></font>
response = requests.get(<span class="hljs-string">'https://filedroid.neoquest.ru/api/file'</span>, <font></font>
params={<span class="hljs-string">'token'</span>: token, <span class="hljs-string">'file'</span>: <span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>}, verify=False)<font></font>
<font></font>
with open(<span class="hljs-string">"0p3n1fuw4nt2esk4p3.jpg"</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> fd:<font></font>
        fd.write(response.content)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชุญ ุงูููู ุงูุฐู ุชู ุชูุฒููู ููุชุฐูุฑ ุธุฑููุง ุตุบูุฑูุง ุชุฑููุงู ูููุช ูุงุญู:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/dc/rz/ktdcrzjrng635moxnmt5_phu2nu.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. ุฅุถุงูุฉ ูููู ูู ุงูุชุดููุฑ ...</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅูู ุ ูู ุงููุจูุฑ ุฌุฏูุง ุชุฃุฌูู FileDroid. ุฏุนูุง ูุนูุฏ ุฅูู JADX ููุฑู ูุง ุฅุฐุง ูุงู ูุทูุฑู ุนููุงุก ุงูููู ูุฏ ุชุฑููุง ุฃู ุดูุก ูููุฏ ููุง. ูุนู ุ ูุฐุง ูู ุงูุญุงู ุนูุฏูุง ูููู ุชูุธูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุบูุฑ ุดุงุฆุน ุจุดูู ูุงุถุญ: ุชูุชุธุฑ ุทุฑููุฉ decryptFile () ุบูุฑ ุงููุณุชุฎุฏูุฉ ุจูุฏูุก ุงูุชุจุงููุง ูู ูุฆุฉ ConnectionHandler. ูุง ูุฏููุงุ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุดููุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AES</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุถุน </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CBC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ sinhroposylka ุชุญุชู ุฃูู 16 ุจุงูุช ... ุงููุณู - ูุญุฑู ุงูุชูุฏู ุ ููู ุงูุฃูุถู ูุฑุฉ ุฃุฎุฑู ุงุณุชุฎุฏุงู Frida ููู ุดูุฑุฉ 0p3n1fuw4nt2esk4p3.jpg ุฌูุฏูุง. ูููู ูุฌุฑุฏ ุชูุฑูุฑ ูููุชุงุญ ุงูุชุดููุฑุ ูุง ููุฌุฏ ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช ุ ูููู ูุธุฑูุง ููุฌูุฏ ุทุฑููุฉ ุฃุฎุฑู "ููุณูุฉ" savePlainFile (ููู String ุ String token) ุ ูุฅู ุงูุงุฎุชูุงุฑ ูุงุถุญ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญุถูุฑ ุงูุจุฑูุงูุฌ ุงููุตู decrypt.js ุงูุชุงูู ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑูุฒ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุดุฑ ุฅูู ุงููููุฉ ุงููุนููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ "HoHknc572mVpZESSQN1Xa7S9zOidxX1PMbykdoM1EXI = '):</font></font><br>
<br>
<pre><code class="coffeescript hljs">Java.perform(function () {<font></font>
    const JavaString = Java.use(<span class="hljs-string">'java.lang.String'</span>);<font></font>
    const file_name = JavaString.$<span class="hljs-keyword">new</span>(<span class="hljs-string">'0p3n1fuw4nt2esk4p3.jpg'</span>);<font></font>
    const ConnectionHandler = Java.use(<span class="hljs-string">'com.ctf.filedroid.ConnectionHandler'</span>);<font></font>
    const result = ConnectionHandler.savePlainFile(file_name, &lt;token&gt;);<font></font>
    <span class="hljs-built_in">console</span>.log(result);<font></font>
});<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุถุนูุง ุงูููู ุงููุดูุฑ 0p3n1fuw4nt2esk4p3.jpg ุนูู / sdcard / ุ ููู ุจุชุดุบูู FileDroid ูุญูู ุงูุจุฑูุงูุฌ ุงููุตู decrypt.js ุจุงุณุชุฎุฏุงู Frida. </font><font style="vertical-align: inherit;">ุจุนุฏ ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุณูุธูุฑ ููู plainfile.jpg ุนูู / sdcard /. </font><font style="vertical-align: inherit;">ููุชุญู ู ... ุญู ููุท! </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fb/3-/ah/fb3-ahlzcqlnfjsromkmbz9eil0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุชุทูุจ ูุฐู ุงููููุฉ ุงูุตุนุจุฉ ุฃู ูููู ูุฏู ุงููุดุงุฑููู ุงููุนุฑูุฉ ูุงูููุงุฑุงุช ูู ุงูุนุฏูุฏ ูู ูุฌุงูุงุช ุฃูู ุงููุนูููุงุช ูู ููุช ูุงุญุฏ ุ ููุณุนุฏูุง ุฃู ูุนุธู ุงูููุงูุณูู ุชุนุงูููุง ูุนูุง ุจูุฌุงุญ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃูู ุฃู ุฃููุฆู ุงูุฐูู ูู ููู ูุฏููู ุงูููุช ุฃู ุงููุนุฑูุฉ ุงููุงููุฉ ูุจู ุงุณุชูุงู ุงูููุชุงุญ ุณูู ูุฌุชุงุฒูู ุงูุขู ููุงู ููุงุซูุฉ ุจูุฌุงุญ ูู ุฃู CTF :)</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar496910/index.html">ูู ุจุจูุงุก ูุชุฎุตูุต CDN</a></li>
<li><a href="../ar496912/index.html">ThinkPad E480 Intel ุนูู Windows VS ThinkPad E495 AMD ุนูู Ubuntu ูู ููุงู ุฃู ูุฑูุ</a></li>
<li><a href="../ar496914/index.html">ุฃูุตุฑ ุจุฑูุงูุฌ ุนุดุฑู</a></li>
<li><a href="../ar496916/index.html">ุงูุชุฏุฑูุณ ูุงูุชูุงูุถ ูุงูุงุณุชุดุงุฑุงุช ุนู ุจุนุฏ - ุงูุฌุฒุก 3: Yealink Meeting Server ู 4 ุนุฑูุถ ุฎุงุตุฉ</a></li>
<li><a href="../ar496920/index.html">ุฌุนู ุงูููุฒู ุงูุฐูู ูุน ASP.NET Core ู Arduino</a></li>
<li><a href="../ar496924/index.html">ุชูุฌูู ููููุงุช ุงูููุจ</a></li>
<li><a href="../ar496936/index.html">ุฏุนููุง ุชุดููุฑ ุดูุงุฏุงุช SSL ูุน ูุฏูุฑ ุงูุดูุงุฏุฉ ูู Kubernetes</a></li>
<li><a href="../ar496938/index.html">ุงูุญูุงุณูุจ ุงููุงุฆูุฉ ูุชุณูุณู ุงูุฌูููู ูุงุญุชูุงูุงุช ูุฒููุฉ ุงูููุฑูุณ ุงูุชุงุฌู</a></li>
<li><a href="../ar496940/index.html">ููู ูุฎุชุจุฑ ูููุฏุณู GM ุงูุฅููุชุฑูููุงุช</a></li>
<li><a href="../ar496942/index.html">ุงูุฃุญุฏุงุซ ุงูุฑูููุฉ ูู ููุณูู 13-19 ุฃุจุฑูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>