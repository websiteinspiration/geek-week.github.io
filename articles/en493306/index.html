<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôçüèº üë©üèº‚Äçüíº üë©üèª‚Äçüè´ Using Gateway APIs as a Single Entry Point for Web Applications and APIs üò£ ‚õπüèª üßöüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The translation of the article was prepared especially for students of the course ‚ÄúHigh Load Architect‚Äù .
 
 
 
 Introduction
 AWS benefits, such as h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Using Gateway APIs as a Single Entry Point for Web Applications and APIs</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/493306/"><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The translation of the article was prepared especially for students of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúHigh Load Architect‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/di/rs/bc/dirsbcrebdyww6pq5uacvb1nk7o.png"><br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AWS benefits, such as high availability, scalability, and resilience, have already proven their worth for SaaS providers (Software-as-a-Service). With the modernization of SaaS applications, AWS helps smoothly switch to a microservice architecture with providing API access to external applications. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API management tools such as the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon API Gateway</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are the natural choice for providing a secure and scalable external API. However, when moving their applications to the clouds, SaaS providers often face the need to quickly deploy their services to several different clients. And, of course, with the specific requirements of each of them.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Gateway API helps create a multi-tenant microservice architecture. </font><font style="vertical-align: inherit;">In such an architecture, a single instance of a microservice is used to serve different clients, which makes it possible to use resources more optimally and optimize costs. </font><font style="vertical-align: inherit;">In this configuration, for servicing their customers, providers require the support of ‚Äúwhite-label‚Äù domains, as well as the ability to identify a client domain to bind a specific business logic to a specific client in the backend. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This article talks about the reference architecture, which allows you to use the Gateway API as a single entry point for web applications and microservices based on APIs with several external clients, using different subdomains for each of them.</font></font><a name="habracut"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon API Gateway - Single Entry Point</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Building an architecture using a single Gateway API for multiple web applications and microservices is an important factor for component reuse and cost optimization. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Amazon API Gateway provides a highly scalable solution for creating and publishing RESTful APIs and WebSocket APIs. You can select a variety of technologies for the backend: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Lambda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> features </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Step Functions,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or call HTTP endpoints hosted on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWS Elastic Beanstalk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon EC2,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or outside AWS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
API Gateway takes on typical API management tasks such as security, caching, throttling and monitoring. </font><font style="vertical-align: inherit;">Although its main goal is to build an abstract layer on top of your internal API and microservices, it can also simplify your backend applications or provide access to static web pages and documents stored in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon S3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bucket </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the above, the following key API Gateway functions help create the architecture described here.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Support for custom domain names: </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When deploying an API using the Gateway API, the default domain name of the API endpoint is not very convenient for the end user: </font></font><br>
<br>
<pre><code class="plaintext hljs">https://api-id.execute-api.region.amazonaws.com/stage</code></pre><br>
<ul>
<li><code>api-id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gateway API generated </font></font></li>
<li><code>region</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is indicated by you when creating the API; </font></font></li>
<li><code>stage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Specified by you when deploying the API. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The default API endpoint can be difficult to work with. </font><font style="vertical-align: inherit;">But thanks to the integration with AWS Certificate Manager, which allows you to test subdomains based on SSL-certificates, you can give users of your API easier and more intuitive URL, such as, </font></font><code>customer1.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The Gateway API allows you to map multiple subdomains to a single API endpoint, which allows you to use the ‚Äúwhite label‚Äù name in accordance with the requirements of external clients.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Modification of API requests / responses</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Gateway API allows you to configure separate processing for each part of the API endpoint address. </font><font style="vertical-align: inherit;">Thanks to this, it is possible to route API requests to individual endpoint endpoints, and at the same time, change headers in the request / response for more flexible processing of API requests.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The advantages of such an architecture</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The features described in this article are shown in the diagram below. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rk/it/jm/rkitjm-npyu_3zwq7wccli8spcg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the architecture for a typical SaaS provider that offers its services to other organizations and must support ‚Äúwhite-label‚Äù domains for web and API infrastructures. </font><font style="vertical-align: inherit;">A similar architecture is achieved using the following steps:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The domain </font></font><code>example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be registered with a domain registrar, but you can create subdomains through the CNAME-record, for example </font></font><code>customer1.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>customer2.example.com</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This can be done in AWS using the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Route 53 service</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or through any third-party DNS provider.</font></font></li>
<li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">AWS Certificate Manager</a> (ACM)     <code>example.com</code>  <code>*.example.com</code>.       ACM-,   API Gateway.</li>
<li> ,   ACM,        API.      API          .     : <code>customer1.example.com</code>  <code>customer2.example.com</code>.</li>
</ol><br>
<i><b>:</b>    CNAME-  customer1  customer2  DNS,       API Gateway.</i><br>
<br>
<img src="https://habrastorage.org/webt/gu/83/qr/gu83qry13r5dogz6rxj0wvtekhi.png"><br>
<br>
<h3>4. API Endpoint   </h3><br>
<ul>
<li><code>/service1</code> ‚Äî integration type HTTP,       ELB,    ECS</li>
<li><code>/service2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - integration type HTTP, routing traffic to the endpoint of an ELB web application hosted in an EC2 cluster</font></font></li>
<li><code>/docs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - integration type AWS S3, for static documents</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/fr/f6/q_/frf6q_io-v5bojoxt42ptvdiqxg.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. The Gateway API can process the fully qualified domain name (FQDN) in the URL and map it to custom headers or parameters in the query string to send to the corresponding backend.</font></font></h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, we can create a custom ‚ÄúCustomer‚Äù header to redirect customer1 or customer2 to a customer-specific backend application. </font><font style="vertical-align: inherit;">This is done using the Method Request and Integration Request parameters in the Gateway API.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, this is just one example of using the Gateway API as a single entry point for API-based microservices and static web application resources. </font><font style="vertical-align: inherit;">Gateway API allows you to use the infrastructure more efficiently without losing scale while increasing the load on your applications. </font><font style="vertical-align: inherit;">For more information on working with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Gateway API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Route 53 DNS,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> see the AWS documentation and use these features to create architectures that meet your requirements.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493294/index.html">We look inside the Soviet integrated circuit with TTL</a></li>
<li><a href="../en493298/index.html">C ++, metaprogramming and microcontroller registers</a></li>
<li><a href="../en493300/index.html">Calculation of the center of mass for O (1) using integrated images</a></li>
<li><a href="../en493302/index.html">What technologies have already been called on to fight against coronavirus?</a></li>
<li><a href="../en493304/index.html">Developing a hexapod from scratch (part 8) - improved math movement</a></li>
<li><a href="../en493308/index.html">Real experience of transferring almost all employees to a remote site</a></li>
<li><a href="../en493310/index.html">Game of God: Artificial Organisms</a></li>
<li><a href="../en493312/index.html">Geo-tracking in React Native</a></li>
<li><a href="../en493320/index.html">Extend Laravel with our own components</a></li>
<li><a href="../en493322/index.html">IT GRAD: first impressions of the remote work format</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>