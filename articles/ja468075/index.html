<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕳️ 💂🏼 ♟️ 検索におけるシャムニューラルネットワークの使用 🔡 🗣️ 🗝️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="みなさん、こんにちは！この投稿では、Mail.ru Searchでテキストを比較するために使用するアプローチについて説明します。それはなんのためですか？異なるテキストを互いに比較する方法を学ぶとすぐに、検索エンジンはユーザーの要求をよりよく理解できるようになります。
 
 これには何が必要ですか？ま...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>検索におけるシャムニューラルネットワークの使用</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/468075/"><img src="https://habrastorage.org/webt/vz/r1/ch/vzr1ch09luydotrwrqc26ccyn-u.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
みなさん、こんにちは！この投稿では、Mail.ru Searchでテキストを比較するために使用するアプローチについて説明します。それはなんのためですか？異なるテキストを互いに比較する方法を学ぶとすぐに、検索エンジンはユーザーの要求をよりよく理解できるようになります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これには何が必要ですか？まず、タスクを厳密に設定します。類似と考えるテキストと考慮しないテキストを自分で決定し、類似性を自動的に決定するための戦略を策定する必要があります。私たちのケースでは、ユーザークエリのテキストがドキュメントのテキストと比較されます。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テキストの関連性を決定するタスクは、3つの段階で構成されます。まず、最も簡単な方法：2つのテキストで一致する単語を探し、その結果に基づいて類似性について結論を出します。次に、より難しい作業は、同義語を理解して、異なる単語間の関連を検索することです。そして最後に、3番目の段階：文章/テキスト全体の分析、意味の分離、文章/テキストの意味による比較。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/74a/d7d/70e/74ad7d70ea842ca2f2750b954b193c64.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決する1つの方法は、テキストのスペースからより単純なものへのマッピングを見つけることです。たとえば、テキストをベクトル空間に変換して、ベクトルを比較できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に戻って、最も簡単なアプローチを考えてみましょう：クエリとドキュメントで一致する単語を検索します。</font><font style="vertical-align: inherit;">そのようなタスク自体は、すでにかなり複雑です。これをうまく行うには、それ自体は自明ではない通常の形の単語を取得する方法を学ぶ必要があります。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問い合わせ</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメントのタイトル</font></font><br>
</th>
</tr>
<tr>
<td><font color="#fa7566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おとぎ話の</font></font></font> <font color="#018bc7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヒーロー</font></font></font><br>
</td>
<td><font style="vertical-align: inherit;"></font><font color="#fa7566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おとぎ話の</font></font></font> <font style="vertical-align: inherit;"><font color="#018bc7"><font style="vertical-align: inherit;">英雄の</font></font><font style="vertical-align: inherit;"> ABC</font></font><font color="#018bc7"><font style="vertical-align: inherit;"></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おとぎ話のヒーロー</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就学前の文学</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
直接マッピングモデルは大幅に改善できます。 1つの解決策は、条件付き同義語を一致させることです。たとえば、テキスト内の単語の分布に関する確率的な仮定を入力できます。ベクトル表現を使用して、一致しない単語間の関係を暗黙的に分離し、それを自動的に行うことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは検索に従事しているため、いくつかのクエリに応答して特定のドキュメントを受け取ったときのユーザーの行動に関する多くのデータがあります。これらのデータに基づいて、異なる単語間の関係について結論を出すことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つの文章を見てみましょう。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a80/f60/c56/a80f60c569a9a4fb72afc20774a7e787.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クエリとタイトルからの単語の各ペアに重みを割り当てます。これは、最初の単語が2番目の単語にどの程度関連付けられているかを意味します。</font><font style="vertical-align: inherit;">これらの重みの合計のシグモイド変換としてクリックを予測します。</font><font style="vertical-align: inherit;">つまり、ロジスティック回帰のタスクを設定します。このタスクでは、属性はフォームのペアのセット（クエリの単語、ドキュメントのタイトル/テキストの単語）で表されます。</font><font style="vertical-align: inherit;">このようなモデルをトレーニングできれば、類義語である単語をより正確に結び付けることができ、そうでない単語を理解することができます。</font></font><br>
<br>
<p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>&amp;#x412;&amp;#x435;&amp;#x440;&amp;#x43E;&amp;#x44F;&amp;#x442;&amp;#x43D;&amp;#x43E;&amp;#x441;&amp;#x442;&amp;#x44C; &amp;#x43A;&amp;#x43B;&amp;#x438;&amp;#x43A;&amp;#x430;</mtext></mrow><mo>=</mo><mi>&amp;#x03C3;</mi><mrow><mo>(</mo><mrow><mo>&amp;#x2211;</mo><msub><mi>&amp;#x03C6;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></mrow><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>, &amp;#x433;&amp;#x434;&amp;#x435;&amp;#xA0;</mtext></mrow><msub><mi>&amp;#x03C6;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext mathvariant=&quot;bold&quot;>&amp;#xA0;- &amp;#x432;&amp;#x435;&amp;#x441; &amp;#x43F;&amp;#x430;&amp;#x440;&amp;#x44B; &amp;#x441;&amp;#x43B;&amp;#x43E;&amp;#x432; (&amp;#x441;&amp;#x43B;&amp;#x43E;&amp;#x432;&amp;#x43E; &amp;#x437;&amp;#x430;&amp;#x43F;&amp;#x440;&amp;#x43E;&amp;#x441;&amp;#x430;, &amp;#x441;&amp;#x43B;&amp;#x43E;&amp;#x432;&amp;#x43E; &amp;#x434;&amp;#x43E;&amp;#x43A;&amp;#x443;&amp;#x43C;&amp;#x435;&amp;#x43D;&amp;#x442;&amp;#x430;)</mtext></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="86.206ex" height="4.634ex" viewBox="0 -1239.8 37116.4 1995.3" role="img" focusable="false" style="vertical-align: -1.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text><g transform="translate(592,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(974,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1459,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1889,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2373,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2804,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3300,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3731,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4113,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4544,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(5250,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(5788,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6272,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6768,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(7307,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAIN-3D" x="8015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMATHI-3C3" x="9071" y="0"></use><g transform="translate(9810,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJSZ2-28"></use><g transform="translate(597,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJSZ2-2211" x="0" y="0"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMATHI-3C6" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMATHI-69" x="925" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJSZ2-29" x="3207" y="-1"></use></g><g transform="translate(13782,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAINB-2C"></use><g transform="translate(569,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(960,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1396,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g></g><g transform="translate(15811,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMATHI-3C6" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMATHI-69" x="925" y="-213"></use></g><g transform="translate(16810,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAINB-2D" x="250" y="0"></use><g transform="translate(883,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1367,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1750,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2383,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2879,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3309,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(3794,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(4716,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(5099,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(5583,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(6014,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAINB-28" x="6748" y="0"></use><g transform="translate(7196,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(7578,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(8063,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(8493,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(8978,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(9658,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10005,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10435,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(10931,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(11416,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(11846,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(12229,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAINB-2C" x="12660" y="0"></use><g transform="translate(13229,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(13612,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(14096,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(14527,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(15011,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(15692,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(16127,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(16558,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(17096,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(17526,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(18118,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(18501,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(18997,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(19428,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" font-weight="bold" stroke="none" transform="scale(53.819) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/company/mailru/blog/468075/&amp;usg=ALkJrhg4yROLq7Ulp-cmSgbGP8ix0BHiHw#MJMAINB-29" x="19858" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold"> </mtext></mrow><mo>=</mo><mi>σ</mi><mrow><mo>(</mo><mrow><mo>∑</mo><msub><mi>φ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">, &nbsp;</mtext></mrow><msub><mi>φ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mtext mathvariant="bold">&nbsp;-    ( ,  )</mtext></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">\textbf{ } = \sigma \left ( \sum \varphi _{i} \right )\textbf{,  }\varphi _{i}\textbf{ -    ( ,  )}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、適切なデータセットを作成する必要があります。</font><font style="vertical-align: inherit;">ユーザーのクリック履歴を取り、否定的な例を追加するだけで十分であることがわかります。</font><font style="vertical-align: inherit;">否定的な例を混ぜるには？</font><font style="vertical-align: inherit;">データセットに1：1の比率で追加するのが最善です。</font><font style="vertical-align: inherit;">さらに、トレーニングの最初の段階の例自体はランダムに実行できます。クエリとドキュメントのペアの場合、別のランダムドキュメントが見つかり、そのようなペアはネガティブと見なされます。</font><font style="vertical-align: inherit;">トレーニングの後半の段階では、より複雑な例、つまり交差があるもの、およびモデルが類似していると考えるランダムな例（ハードネガティブマイニング）を提供することが有益です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例：「三角形」という単語の同義語。</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元の言葉</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シノニム</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重量</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幾何学</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,55878</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解決する</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.66079</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同等の</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.37966</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OGE</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,51284</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バミューダ語</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.52195</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この段階で、単語に一致する優れた関数をすでに区別することができますが、これは私たちが目指していることではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでニューラルネットワークが役立ちます。テキスト（クエリまたはドキュメント）を受け入れ、類似したテキストに近いベクトルと遠いベクトルがあるようなベクトル表現を生成するエンコーダーを作ってみましょう。たとえば、コサイン距離を類似性の尺度として使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、トレーニングがはるかに簡単なシャムネットワークの装置を使用します。シャムネットワークは、2つ以上のファミリのデータサンプルに適用されるエンコーダと、比較演算（コサイン距離など）で構成されます。エンコーダーを異なるファミリーの要素に適用する場合、同じ重みが使用されます。これ自体が優れた正則化をもたらし、トレーニングに必要な要素の数を大幅に減らします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンコーダーは、テキストからベクトル表現を生成し、類似するテキストの表現間のコサインが最大になり、異なるものの表現間のコサインが最小になるように学習します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/164/235/672/164235672d1048f21bf0ca522703999a.png" width="400"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
意味論的に複雑なDSSMのネットワークは、私たちのタスクに適しています。以下で説明する小さな変更を加えて使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
従来のDSSMのしくみ：リクエストとドキュメントは、トライグラムのバッグの形式で提示され、そこから標準のベクトル表現が取得されます。完全に接続された複数のレイヤーを通過し、ネットワークは、要求に応じてドキュメントの条件付き確率を最大化するようにトレーニングされます。これは、ネットワークを完全に通過することによって得られるベクトル表現間のコサイン距離を最大化することと同じです。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b2a/f6b/71f/b2af6b71f72649de1282e54456bfd695.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Po-Sen Huang Xiaodong He </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jianfeng Gao</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Li Deng Alex Acero Larry Heck。 2013クリックスルーデータを使用したウェブ検索用の深層構造セマンティックモデルの学習</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはほとんど同じように行きました。つまり、クエリ内の各単語はトライグラムのベクトルとして表され、テキストは単語のベクトルとして表されるため、どの単語が立っていたかに関する情報が残ります。次に、単語内の1次元のたたみ込みを使用して、これらの表現を平滑化し、グローバルな最大引き操作を行って、文に関する情報を単純なベクトル表現に集約します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ed0/e1f/fd9/ed0e1ffd98e077ba51c91004485f4d2f.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トレーニングに使用したデータセットは、線形モデルに使用したデータセットとほぼ完全に一致しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはそこで止まりませんでした。</font><font style="vertical-align: inherit;">最初に、彼らは事前訓練モードを思いついた。</font><font style="vertical-align: inherit;">ドキュメントに対するクエリのリストを取得し、どのユーザーがこのドキュメントを操作するかを入力し、そのようなペアを閉じるようにニューラルネットワークをトレーニングします。</font><font style="vertical-align: inherit;">これらのペアは同じファミリーに属しているため、このようなネットワークは学習が容易です。</font><font style="vertical-align: inherit;">さらに、リクエストとドキュメントを比較するときに、戦闘の例を再トレーニングする方が簡単です。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：ユーザーは、リクエストでe.mail.ru/loginにアクセスします：電子メール、電子メール入力、電子メールアドレス、...</font></font></i><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問い合わせ</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資料</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BM25</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ニューロランク</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アスタナトヨタ</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カザフスタンのトヨタ公式サイト</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.839</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詩</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poetry.ru</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.823</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワールドドリームパタヤ</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バンコクドリームワールド</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.818</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spbポテト</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンクトペテルブルクでジャガイモを買う</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.811</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、私たちがまだ苦労しており、ほぼ成功を収めている最後の困難な部分は、要求をいくつかの長いドキュメントと比較するタスクです。</font><font style="vertical-align: inherit;">なぜこの仕事はもっと難しいのですか？</font><font style="vertical-align: inherit;">ここでは、リクエストと長いドキュメントが異なるオブジェクトファミリーに属しているため、シャムネットワークの機構はすでに適していません。</font><font style="vertical-align: inherit;">それでも、アーキテクチャを変更する余裕はほとんどありません。</font><font style="vertical-align: inherit;">単語に従って畳み込みを追加するだけでよく、テキストの最終的なベクトル表現のために、各単語のコンテキストに関するより多くの情報が保存されます。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/845/b2d/bba/845b2dbbac3e32158f085c06af1dc686.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現時点では、アーキテクチャを変更し、データソースとサンプリングメカニズムを実験することにより、モデルの品質を向上させ続けています。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468063/index.html">Angulareact</a></li>
<li><a href="../ja468065/index.html">皆のための精神的な製品管理モデル</a></li>
<li><a href="../ja468067/index.html">アルファ合成のしくみ</a></li>
<li><a href="../ja468071/index.html">Tungsten LabsのCTOであるEduard Medvedev氏：「テクノロジーが大規模な損害を引き起こす可能性があるところまで成長しました」</a></li>
<li><a href="../ja468073/index.html">Andrei Terekhov：「アメリカ人の方がいいと言っていいほど話せますが、車は故障しません」</a></li>
<li><a href="../ja468077/index.html">大人の方法でテストを行います。スペクトル分析</a></li>
<li><a href="../ja468079/index.html">何度も節約してくれたGoogle Analyticsのカスタムディメンション</a></li>
<li><a href="../ja468081/index.html">「匿名データ」または152-FZで計画されているもの</a></li>
<li><a href="../ja468083/index.html">やかんからのAndroid Camera2 API</a></li>
<li><a href="../ja468085/index.html">「Safe DevOps」という本。効率的なシステム運用」</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>