<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☝🏽 👩🏻‍🤝‍👨🏾 👨‍👩‍👧‍👧 3 ways to render large lists in Angular 😜 ✊🏿 🤵🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In 2020, front-end frameworks became better, more efficient and faster. But, even with this in mind, rendering large lists without “freezing” the brow...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>3 ways to render large lists in Angular</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/492506/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In 2020, front-end frameworks became better, more efficient and faster. But, even with this in mind, rendering large lists without “freezing” the browser can still be a daunting task even for the fastest existing frameworks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This is one of those cases where "the framework is fast and the code is slow." </font><font style="vertical-align: inherit;">
There are many approaches that allow you to display a large number of elements without blocking user interaction with the web page. </font><font style="vertical-align: inherit;">
The author of the article, the translation of which we are publishing today, wants to explore the existing methods for displaying large lists on web pages and talk about their areas of application.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/ql/ap/04/qlap04o-7mdhzho6nedwbgz64gk.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although this material is aimed at Angular, what is being discussed here applies to other frameworks and projects that are written in pure JavaScript. </font><font style="vertical-align: inherit;">In particular, the following approaches to rendering large lists will be considered here:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtual scrolling (using Angular CDK).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual rendering.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progressive rendering.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Virtual scrolling</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Virtual scrolling is perhaps the most efficient way to work with large lists. </font><font style="vertical-align: inherit;">True, he has some disadvantages. </font><font style="vertical-align: inherit;">Virtual scrolling, thanks to the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angular CDK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and other plugins, is very easy to implement in any component. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The idea behind virtual scrolling is simple, but it is not always easy to implement. </font><font style="vertical-align: inherit;">The bottom line here is that we have a container and a list of elements. </font><font style="vertical-align: inherit;">An element is rendered only if it is within the visible area of ​​the container. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will use the module </font></font><code>scrolling</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the Angular CDK, which is designed to organize virtual scrolling. </font><font style="vertical-align: inherit;">To do this, you first need to install the CDK:</font></font><br>
<br>
<pre><code class="bash hljs">npm i @angular/cdk
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then you need to import the module:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { ScrollingModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/cdk/scrolling'</span>;<font></font>
@NgModule({<font></font>
&nbsp;...<font></font>
&nbsp;imports: [ ScrollingModule, ...]<font></font>
})<font></font>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> </span>{}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, in the components you can use </font></font><code>cdk-virtual-scroll-viewport</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cdk-virtual-scroll-viewport</span> <span class="hljs-attr">itemSize</span>=<span class="hljs-string">"50"</span>&gt;</span>
&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> *<span class="hljs-attr">cdkVirtualFor</span>=<span class="hljs-string">"let item of items"</span>&gt;</span><font></font>
&nbsp;&nbsp;&nbsp;{{ item }}<font></font>
&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">cdk-virtual-scroll-viewport</span>&gt;</span>
</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an example project that uses this approach to organizing virtual scrolling. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you can see, the standard Angular mechanisms allow you to achieve impressive results without much difficulty. The component in the example renders many thousands of elements without any problems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If virtual scrolling is so good, and if it is so easy to implement, the question arises as to why study other ways to render large lists. I was also interested in this question. As it turned out, this state of affairs has several reasons:</font></font><br>
<br>
<ul>
<li>,      ,     .        ,     . ,      <code>Autocomplete</code> (    ).  , ,    ,   ,  .     —        .</li>
<li>      —    ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are some problems with accessibility and ease of use of the contents of a list with virtual scrolling. </font><font style="vertical-align: inherit;">Hidden elements are not rendered - this means that they will not be available for screen readers, and that they cannot be found on the page using standard browser mechanisms.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Virtual scrolling is ideal in a number of situations (provided that it works):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In that case, if you want to display lists whose size is not known in advance, or those that can be huge (according to a rough estimate, lists that include more than 5 thousand elements, but this greatly depends on the complexity of each element).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the event that you need to organize endless scrolling.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manual rendering</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the ways to work with lists that I tried to speed up the output of a large set of elements is to use manual rendering using the Angular API instead </font></font><code>*ngFor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have a simple template that uses a loop organized using the * directive</font></font><code>ngFor</code><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&nbsp;
*<span class="hljs-attr">ngFor</span>=<span class="hljs-string">"let item of data; trackBy: trackById; let isEven = even; let isOdd = odd"</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">class</span>=<span class="hljs-string">"h-12"</span>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-400</span>]=<span class="hljs-string">"isEven"</span>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-500</span>]=<span class="hljs-string">"isOdd"</span>
&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4"</span>&gt;</span>{{ item.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4 rounded (click)="</span><span class="hljs-attr">remove</span>(<span class="hljs-attr">item</span>)"&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To measure the rendering performance of 10,000 simple elements, I used a benchmark based on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">js-frameworks-benchmark</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First, I examined the performance of a list, which uses a regular loop to output </font></font><code>*ngFor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">As a result, it turned out that the execution of the code (Scripting) took 1099 ms., The rendering (Rendering) took 1553 ms., And the drawing (Painting) - 3 ms.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bdc/65d/617/bdc65d6174798028877e98bdcc7830d8.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A study of the performance of a list, which uses * ngFor to output, List</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
items can be rendered manually using the Angular API:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">ng-container</span> #<span class="hljs-attr">itemsContainer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ng-container</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ng-template</span> #<span class="hljs-attr">item</span> <span class="hljs-attr">let-item</span>=<span class="hljs-string">"item"</span> <span class="hljs-attr">let-isEven</span>=<span class="hljs-string">"isEven"</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"h-12 "</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-400</span>]=<span class="hljs-string">"isEven"</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="hljs-attr">class.bg-gray-500</span>]=<span class="hljs-string">"!isEven"</span>
&nbsp;&nbsp;&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4"</span>&gt;</span>{{ item.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ item.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"py-2 px-4 rounded"</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">"remove(item)"</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ng-template</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's talk about how the controller code has changed. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We declared a template and container:</font></font><br>
<br>
<pre><code class="html hljs xml">@ViewChild('itemsContainer', { read: ViewContainerRef }) container: ViewContainerRef;<font></font>
@ViewChild('item', { read: TemplateRef }) template: TemplateRef<span class="hljs-tag">&lt;<span class="hljs-name">any</span>&gt;</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When generating data, we render them using the </font></font><code>createEmbeddedView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entity </font><font style="vertical-align: inherit;">method </font></font><code>ViewContainerRef</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml">private buildData(length: number) {<font></font>
&nbsp;&nbsp;const start = this.data.length;<font></font>
&nbsp;&nbsp;const end = start + length;<font></font>
<font></font>
&nbsp;&nbsp;for (let n = start; n <span class="hljs-tag">&lt;<span class="hljs-name">=</span> <span class="hljs-attr">end</span>; <span class="hljs-attr">n</span>++) {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">this.container.createEmbeddedView</span>(<span class="hljs-attr">this.template</span>, {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">item:</span> {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">id:</span> <span class="hljs-attr">n</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">label:</span> <span class="hljs-attr">Math.random</span>()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">isEven:</span> <span class="hljs-attr">n</span> % <span class="hljs-attr">2</span> === <span class="hljs-string">0</span>
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;}
}
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, the indicators characterizing the performance of the list were slightly improved. </font><font style="vertical-align: inherit;">Namely, it took 734 ms to execute the code, 1443 ms to render, 2 ms to draw.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a67/3dd/0c5/a673dd0c5ca9c97dc057124d056646e7.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Researching the performance of a list that uses the Angular API to output</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
True, in practice, this means that the list is still extremely slow. </font><font style="vertical-align: inherit;">When you click on the appropriate button, the browser “freezes” for a few seconds. </font><font style="vertical-align: inherit;">If this appeared in production, users would definitely not like it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what it looks like (here I, using the mouse, imitate the loading indicator).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f45/5a3/6bc/f455a36bc281147be801caed867b1f1f.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List Slowing</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Now, to improve manual list rendering, we’ll try to apply progressive rendering technology.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progressive rendering</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The idea of ​​progressive rendering is simple. </font><font style="vertical-align: inherit;">It consists in rendering a subset of elements progressively, postponing the rendering of other elements in the event loop. </font><font style="vertical-align: inherit;">This allows the browser to display all the elements without "slowing down". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The code below that implements progressive list rendering is very straightforward:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, using this </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we establish a regular, every 10 ms. Call to the function that renders 500 elements when called.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After all the elements are deduced, which we determine based on the analysis of the index of the current element, we stop the regular function call and interrupt the cycle.</font></font></li>
</ul><br>
<pre><code class="javascript hljs">private buildData(length: number) {
&nbsp;&nbsp;<span class="hljs-keyword">const</span> ITEMS_RENDERED_AT_ONCE = <span class="hljs-number">500</span>;
&nbsp;&nbsp;<span class="hljs-keyword">const</span> INTERVAL_IN_MS = <span class="hljs-number">10</span>;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">0</span>;<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> nextIndex = currentIndex + ITEMS_RENDERED_AT_ONCE;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> n = currentIndex; n &lt;= nextIndex ; n++) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (n &gt;= length) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clearInterval(interval);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">break</span>;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> context = {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">item</span>: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">id</span>: n,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">label</span>: <span class="hljs-built_in">Math</span>.random()<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">isEven</span>: n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">this</span>.container.createEmbeddedView(<span class="hljs-keyword">this</span>.template, context);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;currentIndex += ITEMS_RENDERED_AT_ONCE;<font></font>
&nbsp;&nbsp;}, INTERVAL_IN_MS);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that the number of elements displayed per call to the function being transferred </font></font><code>setInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as the frequency of the call to this function, are completely dependent on the circumstances. For example, if the elements of the displayed list are very complex, then the output of 500 such elements in one go will be unacceptably slow. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By measuring the performance of this solution, I got results that look worse than those that I received earlier. Code execution - 907 ms., Rendering - 2555 ms., Drawing - 16 ms.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8eb/91e/bdc/8eb91ebdce039a630cb7ff043afdcb38.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Researching the performance of a list, the output of which uses progressive rendering.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
But the user, working with such a list, will experience a much more pleasant experience than before. </font><font style="vertical-align: inherit;">Although the time required to render the list has increased, the user will not notice it. </font><font style="vertical-align: inherit;">We, in one go, render 500 elements. </font><font style="vertical-align: inherit;">In this case, rendering is performed outside the boundaries of the container. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here, some problems may arise due to the fact that the container changes size during rendering, or the position of the content scrolling changes. </font><font style="vertical-align: inherit;">If this happens, you will have to deal with similar problems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what working with such a list looks like.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d85/34a/33c/d8534a33c099a4f62a561802db2ff995.gif"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">List is fast</font></font></font></i><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Manual and progressive rendering techniques for large lists are certainly useful in some situations. </font><font style="vertical-align: inherit;">I used them in cases where virtual scrolling for some reason did not suit me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Given the above, we can say that most often virtual scrolling, built on the basis of a good library, such as the Angular CDK, is the best way to display large lists. </font><font style="vertical-align: inherit;">But if virtual scrolling cannot be used for some reason, the developer has other possibilities. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do you output large lists in your web projects?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en492492/index.html">NikiRobot - an evolution in educational robotics</a></li>
<li><a href="../en492496/index.html">Sample Simple Notes SPA at Mithril.js</a></li>
<li><a href="../en492500/index.html">Science Garage in Russian. Experience translating an American show</a></li>
<li><a href="../en492502/index.html">MIP * = RE: epoch-making evidence from the field of computer science that caused the domino effect in physics and mathematics</a></li>
<li><a href="../en492504/index.html">What happens when a JS module is imported twice?</a></li>
<li><a href="../en492508/index.html">Book Kubernetes for DevOps</a></li>
<li><a href="../en492510/index.html">ES6 modules in the browser: are they ready or not?</a></li>
<li><a href="../en492512/index.html">CSS: adventures in the land of translucency</a></li>
<li><a href="../en492514/index.html">How to establish a legally significant electronic document flow of counterparties in Russia and Kazakhstan?</a></li>
<li><a href="../en492518/index.html">Virus outbreak requires remote work, which means digital signing of documents</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>