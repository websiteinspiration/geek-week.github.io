<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🍳 👨🏿‍🤝‍👨🏻 🚵🏼 JMeter-スイステスターナイフ（パート1） 🛀 🤴🏻 💆🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JMeterについて話しますか？最も可能性が高いのは、あなたがこのテーマに参加している場合、ストレステスト用のこのツールのすべてを既に読んだことです。しかし、私はあなたを驚かせる何かがあります。QAでの3年間、私はJMeterは非常に用途が広く、さまざまな目的に使用できることに気付きました。たとえば...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>JMeter-スイステスターナイフ（パート1）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456928/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JMeterについて話しますか？</font><font style="vertical-align: inherit;">最も可能性が高いのは、あなたがこのテーマに参加している場合、ストレステスト用のこのツールのすべてを既に読んだことです。</font><font style="vertical-align: inherit;">しかし、私はあなたを驚かせる何かがあります。</font><font style="vertical-align: inherit;">QAでの3年間、私はJMeterは非常に用途が広く、さまざまな目的に使用できることに気付きました。</font><font style="vertical-align: inherit;">たとえば、次の場合：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一部のユーザーのために、サイトが落ちるというとらえどころのないバグを検索します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数千の製品ページでの高速キャッシュウォーミング。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モバイルアプリケーションのバックエンドのテスト。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションデータベース内のユーザーデータを含む2000レコードを短時間で作成します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
興味があれば猫へようこそ。</font><font style="vertical-align: inherit;">結構ボリュームがあるので、記事を2つに分けます。</font></font><br>
<a name="habracut"></a><br>
<blockquote><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免責事項：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明らかな理由により、私は実際のプロジェクトのスクリーンショットを記事に挿入しません（またはそれらから重要な情報をすべて抽出しません）。</font><font style="vertical-align: inherit;">イラストは研究および教育目的でのみ提供されています。</font></font></i></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラシックJMeterアプリケーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JMeter-GUIを備えたJavaアプレット。</font><font style="vertical-align: inherit;">テストの場合は、グラフィカルインターフェイスなしで起動します。</font><font style="vertical-align: inherit;">そして、テストスクリプトを書くために、彼はあなたが何でもできるパネルを持っています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/ac5/d62/8d8ac5d625f266f640fe6d65dce8e994.png" alt="JMeterでスクリプトを作成する"></div><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これがスクリプト作成プロセスの外観です（「スペル」という単語もここに収まりません）</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
。スレッドグループがテストの主要な要素であるプロセスコントローラーと要求（HTTP、FTPなど）を使用して投入する一般的なテスト計画が作成されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、パラメータを設定するための追加要素があります。たとえば、HTTPリクエストのデフォルトでは、メインサーバー、ヘッダーを指定し、追加のアセット（画像、スタイル、フォントなど）のダウンロードを有効または無効にできます。それを理解するのは簡単です。そして、このインターフェースからすぐにテストを実行し、結果を確認できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JMeterはそのようなテストケースを記録できます。ローカルマシン上でプロキシとして実行され、ブラウザー（またはアプリケーション）を構成する場合、このプロキシを介してトラフィックを駆動すると、JMeterはすべての要求と応答を記録します。このセットから、ユーザーのアクションを繰り返すテストスクリプトを作成し、いつでもどこでも好きなときに実行できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qy/z7/lq/qyz7lqjkh8y-e9ul3mqi76qceam.png" alt="ユーザーのアクションに基づいてJMeterでスクリプトを作成する"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主な問題は、Java自体のメモリのヒープです。</font><font style="vertical-align: inherit;">それは天井に置かれ、トップエンドのマシンでも50スレッドの同時テストで落下する可能性があります。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
全負荷テストを行うのに十分な電力がマシンにない場合は、サードパーティに問い合わせてください。</font><font style="vertical-align: inherit;">彼らは、サーバーのセットであるインフラストラクチャを展開しました。</font><font style="vertical-align: inherit;">彼らは同じJMeterを得ました。</font><font style="vertical-align: inherit;">有料で、これらの人たちはどんな負荷でもスクリプトを実行します。</font><font style="vertical-align: inherit;">OctoperfとBlazemeterでこのようなサービスを申請しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これはサッカーです。部分的なサーバークラッシュのバグをどのように捉えたか</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは18年間Web開発に携わってきました（乾杯-これで、喫煙して結婚し、ジョンウィックを見ることができます）。一生の間に多くの顧客がありましたが、最大の顧客が最近現れました。たとえば</font><font style="vertical-align: inherit;">、SPWパラダイム（単一ページのWebサイト：ブラウザーページ自体を再読み込みせずにすべてのページを開く）を使用して、英国プレミアリーグのフットボールクラブの1つ</font><font style="vertical-align: inherit;">に</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sitecore</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">サイトを作成しました</font><font style="vertical-align: inherit;">。内部には、ライブマッチページを管理するための管理パネルがあります。これはゲームのテキストによるオンラインブロードキャストです。メインイベント（ゴール、削除、フリーキック）はOptaシステムから自動的にダウンロードされ、ライブ写真が表示されます。サッカークラブのコンテンツマネージャーは、TwitterやInstagramからファンの写真、コメント、再投稿を公開します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
誇りに思います。リリース後、イギリスのメディアは「最後に、フットボールクラブの古いサイトの覇権は終わりました」のような見出しの下で記事を発表しました。</font><font style="vertical-align: inherit;">当時、ほとんどのクラブにはすでにサイトがありました。</font><font style="vertical-align: inherit;">しかし、それらは2000年代の初めに開発されたように見え、それ以降は変更されていません-対応するデザインとUXを備えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開始する前に、全負荷テストを実施し、すべてが正常に機能することを確認しました。</font><font style="vertical-align: inherit;">サーバーの構造は次のようになります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クライアントからのリクエストは負荷分散サーバーに送られます→</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">負荷分散サーバーは8つの</font></font><abbr title="コンテンツ配信、コンテンツ配信サーバー"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CD</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーの</font><font style="vertical-align: inherit;">ステータスをチェックし</font><font style="vertical-align: inherit;">ます→</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">負荷分散サーバーは、最も負荷の少ないCDサーバーにリクエストを送信します→</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CDサーバーはクライアントに応答します。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ローンチの1年後、サイトへのユーザーの大規模な流入中に、クライアントは電話をかけ、サイトがダウンしていると述べました：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-私たちのサイトはダウンしています！まったく動かない！ちょうど白い画面とサイトがダウンしているブラウザからの碑文！ -クライアントは言います。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはパニックでサイトを開いており、それで問題はありません</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントは電話とコンピュータからサイトを開き、そして...すべても大丈夫です！</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- 本当に申し訳ありません。どうやら、ユーザーは問題を抱えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このようなメッセージは最初から表示されないため、調査を実施しました。サーバー密度サーバーのステータスを監視するユーティリティを起動し、サイトへのユーザーの流入中にそれらに何が起こるかを調べまし</font></font><br>
<br>
<img src="https://habrastorage.org/webt/o8/m9/rd/o8m9rd9amg7mcl_vlf8ky2ce1wu.png" alt="サーバーの負荷履歴をサーバー密度で表示する"><br>
<font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た。負荷はありますが、すべてのCDサーバーは同じように見え、</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すぐに物語は繰り返されました-一部のユーザーは完全に壊れたサイトを報告しました。なんらかのエラーやページが見つからなかったのではなく、サーバーがリクエストに応答しなかっただけです。 JMeterの助けを借りて状況を把握することができました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
目標は単純でした。8台すべてのサーバーをロードして、何が起こるかを確認しました。ストレステストは、夜明けがチェリャビンスクで行われたときに行われ、ロンドンでは深い夜でした。非インターフェースモードで複数のマシンを使用しました（同時により多くのスレッドを実行できます）。スクリプトがホームページを際限なく開いたため、これが主な誤りでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g_/fu/c-/g_fuc-c3uungpae4vrrhn2q-c94.png" alt="ループ内の1ページを要求するためのJMeterの最も簡単な負荷テストスクリプト"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでに100回キャッシュされている同じアセットをダウンロードしました。そのため、負荷は軽微でした。その後、アイデアが浮かびました：サイト上-特定の日付のニュースを含むページのキャリッジと小さなカート。いくつかの変数を進め、それらをURLで置き換えると、常にランダムなページが取得されます（たとえば、-... url / news / 2016/08/23 /？Page = 4）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
突然、サーバー密度には、過去の期間のサーバー負荷のグラフに組み込みの「スムージング」があることがわかりました。 5分以内にサーバーの負荷が100％に達した後、0％に低下し、20〜30秒後に90％に増加した場合、この期間の平均値（約80〜90％）が表示されます。したがって、実際のサーバークラッシュは発生しませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ストレステスト中にログを詳細に調査したところ、CDサーバーの1つが100％の負荷で再起動し、それについて誰にも言わなかったことがわかりました（これは内向的です）。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/i5/ie/n6/i5ien6w5zjrwwm1lk23crcj9vn8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロードバランサーは、すべてのサーバーのCPU使用率のみを調べました。</font><font style="vertical-align: inherit;">彼は、そのうちの1つが20％、残りが90％でロードされていることを確認し、ユーザーを最初のユーザーに送りました。</font><font style="vertical-align: inherit;">そして彼は再起動中で、白い画面を表示しました。</font><font style="vertical-align: inherit;">さらに、配信サーバーはユーザーをCookieに公開し、アイドルサーバーにしっかりとバインドしました。</font><font style="vertical-align: inherit;">そのため、更新後もサイトは利用できませんでした。</font><font style="vertical-align: inherit;">8人のユーザーのうち残りの7人は同時に生活を楽しんでおり、すべてが機能していると述べています。</font></font><br>
<br>
<font color="#cc0000"><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論：</font></font></h4></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JMeterはストレステストに使用できると同時に、他のツールを使用したテスト中にサーバーのステータスを分析できることがわかりました。</font><font style="vertical-align: inherit;">一部のユーザーの間でサイトが落ちる問題を "キャッチ"し、ロードバランシングのロジックを修正して状態制御を追加することで解決できました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のパートでは、JMeterの助けを借りて、製品ページのキャッシュプロセスを設定し、アプリケーション自体なしでモバイルアプリケーションの動作をテストし、データベースにアクセスせずにシステムに2000人のユーザーを作成した方法を説明します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja456912/index.html">2019年にサイトを作る方法</a></li>
<li><a href="../ja456916/index.html">Dockerでのクロスコンパイル。何故なの？</a></li>
<li><a href="../ja456920/index.html">Sony Xperia 1 in Russia-価格と予約注文のボーナス</a></li>
<li><a href="../ja456922/index.html">プロセッサの設計と製造方法：コンピュータアーキテクチャの基本</a></li>
<li><a href="../ja456926/index.html">スポーツマスターのやり方</a></li>
<li><a href="../ja456930/index.html">IoTを大衆にもたらす：GeekBrainsとRostelecomによる最初のIoTハッカソンの結果</a></li>
<li><a href="../ja456932/index.html">超近代的なOpenGL。パート1</a></li>
<li><a href="../ja456936/index.html">SwiftUIのアニメーションカード</a></li>
<li><a href="../ja456942/index.html">締め切りの多武装神または分析の広範な使用</a></li>
<li><a href="../ja456944/index.html">JavaScriptで分解を使用する3つの実用的な例</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>