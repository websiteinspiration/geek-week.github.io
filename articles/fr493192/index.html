<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🚒 👨🏽‍✈️ 🛌🏻 Jeu ASCII - un compromis entre authenticité et commodité 👨‍❤️‍💋‍👨 ☘️ ⌛️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous! En développant un jeu stylisé en mode texte, je suis arrivé à la contradiction attendue. D'une part, le jeu doit être saturé de l'espr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Jeu ASCII - un compromis entre authenticité et commodité</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/493192/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour à tous! </font><font style="vertical-align: inherit;">En développant un jeu stylisé en mode texte, je suis arrivé à la contradiction attendue. </font><font style="vertical-align: inherit;">D'une part, le jeu doit être saturé de l'esprit du mode texte, car pour cela je l'aime et, j'espère, les fans de jeux rétro vont l'aimer. </font><font style="vertical-align: inherit;">D'un autre côté, je veux que le gameplay soit aussi agréable et moderne que possible. </font><font style="vertical-align: inherit;">Dans cet article, je décrirai cinq points sur lesquels je me suis écarté du vrai mode texte. </font><font style="vertical-align: inherit;">Ai-je réussi à garder l'ambiance alphanumérique du tube dans le jeu? </font><font style="vertical-align: inherit;">Je demande à exprimer un avis!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3m/au/i_/3maui_cqcqdkfsxpfwj-us8x0e4.jpeg"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Jeu de caractères</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Absolument tous les graphiques du jeu sont créés à l'aide des caractères saisis au clavier. </font><font style="vertical-align: inherit;">Pour être plus précis, les caractères de la table ASCII du 32ème au 126ème caractère sont utilisés. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/11/7_/e7/117_e79lbv7xxuzovttn1i3e7hy.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, les textes du jeu sont localisés en plusieurs langues. </font><font style="vertical-align: inherit;">Maintenant, je soutiens le russe et l'anglais en parallèle, mais je veux en ajouter quelques autres, y compris le chinois. </font><font style="vertical-align: inherit;">Les caractères des tables ASCII, même étendus, ne sont clairement pas suffisants à ces fins. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/du/cl/oa/ducloab5-3du4oldzbmxptnvvja.jpeg"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les boîtes de dialogue du jeu peuvent contenir des caractères n'appartenant pas à la plage authentique. </font><font style="vertical-align: inherit;">Cependant, ces personnages ne sont pas impliqués dans la conception. </font><font style="vertical-align: inherit;">Les graphiques sont en ASCII uniquement.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Précision des sous-caractères</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contrairement aux modes texte, ASCIIDENT utilise la précision des pixels pour déplacer les calques de texte et les sprites mobiles. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/0o/l0/op/0ol0ophebaebco715pyi0kic2e4.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En mode texte, le déplacement d'un sprite d'une position ressemble à un saut notable. Pour un jeu aussi dynamique que ASCIIDENT - c'est inacceptable du point de vue de l'expérience de jeu moderne. Par conséquent, pour les sprites individuels et les calques de texte, qui seront discutés plus tard, j'ai effectué un mouvement fluide. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour maintenir l'authenticité, j'adhère à la règle suivante. À l'intérieur d'un calque de texte, tous les objets statiques sont clairement alignés sur la grille de caractères. De plus, chaque sprite se compose de caractères également alignés sur une grille de caractères.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relativement les uns aux autres, les calques et les objets en mouvement peuvent être situés à une distance sous-symbolique. </font><font style="vertical-align: inherit;">Cela garantit un mouvement fluide et, par conséquent, un gameplay confortable. </font><font style="vertical-align: inherit;">C'est un tel compromis.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Parallaxe</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le jeu a plusieurs couches de texte qui se déplacent à différentes vitesses, réalisant l'effet de parallaxe. </font><font style="vertical-align: inherit;">Les symboles des couches supérieures chevauchent les symboles des couches inférieures. </font><font style="vertical-align: inherit;">Avec une précision de sous-caractère, le critère de chevauchement est une superposition de plus de 50% de la largeur et / ou de la hauteur de la cellule de texte. </font><font style="vertical-align: inherit;">En utilisant un simple z-buffer, ce chevauchement est facile à implémenter. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/tx/6f/sf/tx6fsfikvf90-erih8upoha3ssi.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La parallaxe avec un mouvement fluide des couches est une technique graphique très expressive. </font><font style="vertical-align: inherit;">Oui, cela peut considérablement violer l'authenticité du mode texte. </font><font style="vertical-align: inherit;">Cependant, j'ai décidé d'utiliser la parallaxe. </font><font style="vertical-align: inherit;">Cela se révèle très bien.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Animation</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Animation de sprites individuels dans le jeu "honnête", réalisé strictement en mode texte. La position de chaque caractère est alignée sur la grille de texte. Les animations sont obtenues en remplaçant les caractères dans les cellules. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/rq/-n/bt/rq-nbtwibvurx8nqe48jrl928fw.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouvé qu'il était très important de maintenir l'intégrité des animations de sprites. C'est probablement la principale chose qui rend le jeu si rétro-attractif. De plus, avec ce type d'animation, il devient techniquement très simple de créer et d'éditer des sprites ASCII animés. Je n'ai pas pu résister et j'ai créé un éditeur ASCII intégré dans le jeu. À tout moment, n'importe quel élément graphique peut y être chargé et modifié. Vous pouvez, par exemple, modifier le coffre en ajoutant des cadres d'animation, et après avoir enregistré tous les coffres à tous les endroits du jeu, ils deviendront nouveaux. Tout joueur peut le faire, créant ainsi son propre mod du jeu.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/AZw6BZaF250" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il vous faut parfois une animation fluide! </font><font style="vertical-align: inherit;">Par exemple, dans le jeu, il y a un tel endroit où l'on fait pousser des fibres optiques biologiques. </font><font style="vertical-align: inherit;">Un drone vole au-dessus des lits, ce qui irrigue la fibre optique avec un liquide toxique. </font><font style="vertical-align: inherit;">Le liquide doit couler en douceur, sinon laid. </font><font style="vertical-align: inherit;">Pour implémenter de tels effets, j'ai créé des générateurs de sprites et leur liaison à tous les autres sprites du monde du jeu. </font><font style="vertical-align: inherit;">Techniquement, chaque goutte est un sprite distinct qui peut se déplacer avec une précision sous-pixel. </font><font style="vertical-align: inherit;">Encore un compromis raisonnable.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Lumière, couleur et police</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beaucoup de gens à qui je montre le jeu font remarquer qu'il y a trop de couleurs dans mon jeu. Dans les modes texte, il n'y avait pas une telle richesse de nuances. Le fait est que j'ai implémenté un lightmap plein écran qui calcule un nombre illimité de sources lumineuses. Dans le même temps, la couleur de chaque caractère est de 24 bits (16 777 216 couleurs différentes). Parfois, l'image est colorée. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ta/5h/2i/ta5h2i1ijypt1yhav7kwmikgn1w.gif"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour émuler les modes de couleurs rétro, j'ai fait sept options supplémentaires: trois modes monochromes, deux modes 16 couleurs (DOS / Mac), 2 bits et le mode Game Boy. Le mode police LED est également disponible. Dans ce mode, chaque pixel de chaque caractère est séparé des pixels voisins. La vidéo ci-dessous montre tous les modes - comment ils affectent l'image.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Xnl4sGhA0m0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'algorithme de conversion des couleurs pour les modes monochromes l'a fait. Tout d'abord, je calcule la luminosité des couleurs (R, V, B): </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V = 0,3 * R + 0,59 * G + 0,11 * B </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les moniteurs rétro monochromes ont des tonalités de couleur différentes pour une luminosité de symbole différente. Par conséquent, la teinte doit également changer. J'utilise une telle interpolation linéaire: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RR = sqrt (V) * (monoR1 * (1 - V) + monoR2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GG = sqrt (V) * (monoG1 * (1 - V) + monoG2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BB = sqrt (V ) * (monoB1 * (1 - V) + monoB2 * V) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Couleur finale (RR, GG, BB) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les modes 16 couleurs, j'utilise un algorithme différent. Pour chaque couleur (R, G, B) je recherche la couleur la plus proche dans la palette. C'est tout.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le mode 2 bits et Game Boy n'a que quatre couleurs dans la palette. </font><font style="vertical-align: inherit;">Une simple recherche de la couleur la plus proche donne une image très sombre. </font><font style="vertical-align: inherit;">Par conséquent, avant de chercher une couleur dans la palette, je fais la normalisation: </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
d = 1 / max (R, G, B) </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
normR = d * R, normG = d * G, normB = d * B </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les formules sont schématiques. </font><font style="vertical-align: inherit;">Les contrôles de division par zéro n'ont pas été mentionnés. </font><font style="vertical-align: inherit;">J'espère que tous ceux qui décident de jouer à ASCIIDENT pourront choisir eux-mêmes une palette de couleurs qui réchauffera au maximum son âme rétro.</font></font><br>
 <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Console avec un mode texte honnête</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le processus de création du jeu, l'idée est venue de mettre des terminaux informatiques avec un mode texte honnête dans le monde du jeu. Vous pouvez les approcher, vous connecter et travailler / jouer. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le jeu lui-même est stylisé en mode texte 80x25 avec un défilement fluide et une parallaxe des couches de texte, alors l'écran du terminal intégré a une résolution de 72x20 caractères sans possibilité d'aller au-delà de cette grille. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les applications pour les terminaux embarqués (y compris le chargeur de démarrage) sont écrites dans le langage de programmation DUHASM. Ce langage est similaire à Assembler, mais possède des variables et des tableaux dynamiques. Voici, par exemple, un morceau de code de jeu Pi-astre Hanter: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/fh/gi/yufhgigy6d6il1scdqgmgaaen4q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fonctionnalité amusante est que les boucles sont implémentées dans le cadre de constructions conditionnelles, où LOOP est placé au lieu de END.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au lancement, le jeu charge les applications à partir des fichiers * .duhasm et les compile en code octet. Lorsqu'un joueur active la console, un interprète honnête est lancé. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le moment, j'ai écrit deux jeux sur DUHASM, qui sont déjà disponibles dans la version actuelle. Il est prévu d'écrire un éditeur de code (également sur DUHASM bien sûr) afin que chaque joueur puisse essayer de créer une application / un jeu que tous les autres joueurs verront.</font></font><br>
 <br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xlJWOktA9k0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère que je n'ai pas en vain dépensé beaucoup d'efforts et de temps pour implémenter cette fonctionnalité et qu'il y aura des gens qui l'aimeront. </font><font style="vertical-align: inherit;">Le langage DUHASM a certainement besoin d'être raffiné. </font><font style="vertical-align: inherit;">Je n'aime pas vraiment comment, par exemple, les fonctions sont appelées avec des arguments. </font><font style="vertical-align: inherit;">Selon l'histoire du jeu, le langage DUHASM a proposé un cyborg semi-sensible qui s'est échappé du laboratoire des pirates de l'espace. </font><font style="vertical-align: inherit;">Étonnamment, ce langage de programmation a pris racine à la périphérie de la partie habitée de l'univers.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONCLUSION</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, il y avait beaucoup de compromis - un ensemble de personnages, la précision des sous-personnages, l'animation, les couleurs. </font><font style="vertical-align: inherit;">Mais aussi pour conserver un sentiment d'authenticité au mode texte, j'ai beaucoup entrepris au cours de ces plus de deux ans de développement. </font><font style="vertical-align: inherit;">Pour obtenir plus de commentaires et comprendre si je vais dans la bonne direction, j'ai décidé de démarrer le jeu en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accès anticipé dans Steam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y a quelque chose de magiquement attrayant dans les modes texte. </font><font style="vertical-align: inherit;">Lorsqu'une image peut être tapée avec des caractères sur le clavier, il est parfois difficile de résister et de ne pas démarrer le jeu avec l'éditeur ASCII intégré, et même de ne pas dessiner le prototype d'un nouveau mini-jeu, qui sera ensuite implémenté dans le langage DUHASM. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/0y/i7/se/0yi7sedgucpkb-nstvzouepmo2s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci à tous! </font><font style="vertical-align: inherit;">Jusqu'à!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr493172/index.html">Le plus gros, le pire ou pourquoi la boucle de jeu est importante</a></li>
<li><a href="../fr493178/index.html">Tout est incroyable dans les logiciels, mais tout le monde est mécontent</a></li>
<li><a href="../fr493184/index.html">Contrat de développement de l'électronique. Calcul de projet</a></li>
<li><a href="../fr493186/index.html">Les meilleurs articles liés à l'automobile pour les développeurs sur Habré [170+]</a></li>
<li><a href="../fr493190/index.html">Comment nous avons créé la galerie d'art des réseaux de neurones et pourquoi nous ne donnons pas d'images à copier</a></li>
<li><a href="../fr493196/index.html">Se préparer à ShAD sans quitter la maison</a></li>
<li><a href="../fr493198/index.html">Comment visualiser et animer des modèles (géophysiques). Modèles Voxel et surfaces maillées</a></li>
<li><a href="../fr493200/index.html">Distribution d'un cheval sphérique dans le vide dans toute la Fédération de Russie</a></li>
<li><a href="../fr493202/index.html">RBK.money a publié le premier traitement de paiement open source au monde - créer l'avenir ensemble</a></li>
<li><a href="../fr493204/index.html">Alexey Komissarov à propos de Digital Breakthrough 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>