<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüé® üë©‚Äçüë©‚Äçüëß üé™ Playstation Doom Polygons üëÖ üôèüèº ‚õπüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sony PlayStation
  
 La historia de PlayStation comenz√≥ en 1988 cuando Nintendo y Sony comenzaron a trabajar juntos en un lector de CD-ROM opcional pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Playstation Doom Polygons</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/494398/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98b/897/f95/98b897f955dbdf31ff724bbe1a1841f4.png" alt="imagen"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sony PlayStation</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f7/4aa/015/8f74aa015b0e95be13aac769990538a5.svg"></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La historia de PlayStation comenz√≥ en 1988 cuando Nintendo y Sony comenzaron a trabajar juntos en un lector de CD-ROM opcional para la consola SNES. Seg√∫n los t√©rminos del acuerdo, Sony pudo desarrollar de forma independiente juegos para esta plataforma y retuvo el control del formato Super Disc, dos concesiones inusuales de Nintendo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El proyecto se desarroll√≥ antes de la exposici√≥n CES '91, en la que Sony anunci√≥ una colaboraci√≥n en Play Station. Al d√≠a siguiente, en la misma exposici√≥n, Nintendo, para sorpresa de Sony, anunci√≥ que hab√≠a firmado un acuerdo de asociaci√≥n con Philips (en t√©rminos mucho m√°s favorables). Sony, leal y humillada p√∫blicamente, trat√≥ de apelar ante la junta directiva de Sega, que rechaz√≥ de inmediato la idea. En una entrevista con 2013, el CEO de SEGA, Tom Kalinske, record√≥ la decisi√≥n del consejo.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúEsta es una idea est√∫pida, Sony no sabe c√≥mo desarrollar equipos. </font><font style="vertical-align: inherit;">No saben escribir software. </font><font style="vertical-align: inherit;">¬øPor qu√© nos metemos con ellos? </font><font style="vertical-align: inherit;">- Junta Directiva de SEGA</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y no se equivocaron, Sony realmente ten√≠a poca experiencia trabajando con juegos. </font><font style="vertical-align: inherit;">Casi no mostr√≥ inter√©s en ellos, con la excepci√≥n de la iniciativa de una persona: Ken Kutaragi. </font><font style="vertical-align: inherit;">Desde el momento en que vio a su hija jugar en la Nintendo Famicom, Ken ha estado convenciendo a Sony de que necesita ingresar a este mercado. </font><font style="vertical-align: inherit;">A pesar de las recomendaciones de los vicepresidentes de Sony, incluso desarroll√≥ para Nintendo el chip de audio (SPC700) utilizado en SNES.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La mayor√≠a de los ejecutivos de Sony consideraron esto como una apuesta arriesgada, pero Kutaragi encontr√≥ apoyo en la persona del CEO de Sony, Norio Oga. En junio de 1992, a Ken se le permiti√≥ comenzar a crear un sistema de juegos desde cero. Para calmar a la junta directiva, el "padre de la PlayStation", como comenzaron a llamarlo m√°s tarde, fue transferido a la empresa matriz financieramente independiente Sony Music, y comenz√≥ a trabajar en lo que eventualmente se convertir√≠a en la "PlayStation" (ya sin un espacio en el nombre).</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicialmente, los desarrolladores no pod√≠an decidir si la arquitectura deber√≠a centrarse en gr√°ficos 2D de sprite o gr√°ficos 3D de pol√≠gonos. </font><font style="vertical-align: inherit;">Sin embargo, el √©xito del juego Virtua Fighter lanzado en octubre de 1993 por Sega en m√°quinas arcade japonesas destruy√≥ todas las dudas: la PSX seguir√° el camino 3D. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La culminaci√≥n del proyecto lleg√≥ dos a√±os despu√©s, cuando se cre√≥ Sony Computer Entertainment el 3 de diciembre de 1994 y la consola se lanz√≥ en Jap√≥n. </font><font style="vertical-align: inherit;">Obtuvo √©xito instant√°neo y se vendi√≥ el primer d√≠a con una circulaci√≥n de 100 mil dispositivos, 2 millones de dispositivos despu√©s de seis meses y 102 millones de dispositivos a lo largo de su vida.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b1/727/175/6b1727175f25b80b4309c920c0e23115.webp"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sony PSX (PS1, PlayStation). </font><font style="vertical-align: inherit;">Foto: Wikipedia</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquitectura</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/60b/97c/da3/60b97cda359e2e5c27a9028cc13aa22d.svg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El coraz√≥n de la m√°quina es un procesador RISC R3000A de 32 bits fabricado por MIPS con una frecuencia de 33.8688 MHz </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en combinaci√≥n con 2 MB de DRAM. Es de destacar que este chip tambi√©n tiene un decodificador de movimiento (MDEC), que proporciona reproducci√≥n de video con una resoluci√≥n de 320x240 a una frecuencia de 30 fps. Junto a MDEC, vemos el coprocesador Geometry Transform Engine (GTE) utilizado para realizar operaciones matem√°ticas r√°pidas de punto fijo en vectores y matrices. El sistema en su conjunto no puede trabajar con n√∫meros de coma flotante.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La GPU es una "caja negra" controlada por el procesador central mediante "comandos". Tiene 1 MB de VRAM, no disponible para la CPU. En muchos sentidos, su trabajo se asemeja al trabajo del maravilloso modo Inmediato OpenGL: dibuja pol√≠gonos texturizados que se pueden "sombrear" usando colores de v√©rtice. La tuber√≠a de gr√°ficos es fija y no se puede programar. No hay buffer Z (buffer de profundidad). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La unidad de procesamiento de sonido Unidad de procesamiento de sonido (SPU), como la GPU, es una caja negra. Puede procesar 24 canales, tiene 512 KB de SRAM para almacenar audio (en formato ADPCM) y es capaz de mezclar pistas de audio de CD-ROM con sus canales de audio. La abreviatura SRAM no significa "RAM est√°tica", sino "RAM de sonido".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La decisi√≥n m√°s atrevida de los ingenieros de Sony fue la elecci√≥n del soporte de datos. </font><font style="vertical-align: inherit;">Eligieron no cartuchos, sino un m√≥dulo de CD-ROM de doble velocidad, que redujo el costo de los juegos y aument√≥ significativamente el volumen disponible (hasta aproximadamente 650 MB). </font><font style="vertical-align: inherit;">Las desventajas son la baja velocidad de transferencia (300 KB / s) y el tiempo de instalaci√≥n del cabezal monstruosamente grande (300 ms). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay blitter en la consola. </font><font style="vertical-align: inherit;">El modelo de programaci√≥n de la m√°quina era que los desarrolladores no tocaban el hierro "desnudo". </font><font style="vertical-align: inherit;">Sin embargo, hay un controlador DMA para transmitir datos desde CD / DRAM a VRAM / SRAM.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema de v√≠deo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pesar de que el sistema de video admite color de 24 bits, muy pocos juegos lo han utilizado (con la excepci√≥n de los fondos de Heart Of Darkness </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">En la pr√°ctica, se puede decir con buena conciencia que la mayor√≠a de los juegos usaban colores de 16 bits con una m√°scara de 1 bit.</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img width="300" height="353" src="https://habrastorage.org/getpro/habr/post_images/5ff/164/4dd/5ff1644dd75bfbad9af9b1d61190ebe1.webp"><br>
</td>
<td><img width="300" height="353" src="https://habrastorage.org/getpro/habr/post_images/5ef/828/585/5ef828585512c3315eef5d72087f27b2.png"></td>
</tr>
</tbody></table></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espacio de color PSX con una profundidad de 15 bits por p√≠xel</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Una caracter√≠stica sorprendente del sistema de video es la organizaci√≥n de VRAM, que depende completamente del desarrollador. 1 MB de VRAM se considera una matriz de 1024 x 512 x 16 bits que se puede usar libremente. La aplicaci√≥n de almacenamiento en b√∫fer doble o triple se realiza de manera trivial, porque el √°rea es simplemente suficiente para reservar, dibujar y transferir al sistema de salida. Las texturas tambi√©n est√°n en VRAM, al lado de los b√∫feres de cuadros. Para escribir en el b√∫fer de cuadros, se inician los comandos de GPU para representar tri√°ngulos / cuadr√°ngulos texturizados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las texturas pueden tener varios formatos. Hay dos fuentes directas de colores de 16 bits y 24 bits, as√≠ como fuentes basadas en una paleta llamada Tabla de b√∫squeda de color (CLUT). Se admiten CLUT de 8 y 4 bits.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En t√©rminos de resoluci√≥n, la consola se limit√≥ a los est√°ndares de televisi√≥n NTSC y PAL. </font><font style="vertical-align: inherit;">Para los mercados de EE. UU. Y Jap√≥n, el desarrollador podr√≠a elegir una resoluci√≥n horizontal de 256, 320, 384, 512 o 640 p√≠xeles. </font><font style="vertical-align: inherit;">La resoluci√≥n vertical era 240 p√≠xeles (al omitir cada segunda l√≠nea de trama) o 480 p√≠xeles al alternar. </font><font style="vertical-align: inherit;">Ambos modos verticales funcionan a una frecuencia de 60 Hz. </font><font style="vertical-align: inherit;">La √∫nica diferencia entre NTSC y PAL fue una mayor resoluci√≥n vertical (256/512 en lugar de 240/480) y una frecuencia de actualizaci√≥n m√°s baja (50 Hz).</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modo NTSC (60Hz) PAL (50Hz) Nota</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
=================================================== ========</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0 256 x 240 256 x 256 No entrelazado</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 320 x 240 320 x 256 No entrelazado</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 512 x 240 512 x 256 no entrelazado</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3640 x 240640 x 256 No entrelazado</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4 256 x 480 256 x 512 intercalados</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5 320 x 480 320 x 512 intercalados</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6 512 x 480 512 x 512 intercalados</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7 640 x 480 640 x 512 entrelazado</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8 384 x 240 384 x 256 Sin entrelazar</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9 384 x 480 384 x 512 intercalados</font></font></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Preste atenci√≥n a los modos con una resoluci√≥n horizontal de 384 p√≠xeles (8 y 9), que, a juzgar por su id, se agregaron m√°s tarde.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOOM en PSX</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DOOM fue portado a PSX por Williams Entertainment con el soporte de id Software. </font><font style="vertical-align: inherit;">Un equipo de cinco personas tard√≥ un poco menos de un a√±o </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5] </font></font></sup><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en portar el motor, cambiar los recursos y modificar el juego para que todo funcionara "solo" en 3.5 MB de RAM.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúLos gr√°ficos se han degradado: las texturas se reducen en tama√±o, sprites, monstruos y armas tambi√©n. </font><font style="vertical-align: inherit;">[...] A veces cortamos cuadros de animaci√≥n ". </font><font style="vertical-align: inherit;">- Harry Tisley</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El resultado final fue lanzado el 16 de noviembre de 1995. </font><font style="vertical-align: inherit;">Se considera el mejor puerto de consola del juego, y algunos aspectos incluso superan la versi√≥n para PC debido a las tapas de color y la m√∫sica con calidad de CD.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hasta ahora, este es el mejor DOOM!" </font><font style="vertical-align: inherit;">- John Romero</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plan de estudios</font></font></h2><br>
<div style="text-align:center;"><img width="290" height="301" src="https://habrastorage.org/getpro/habr/post_images/9de/26d/ce5/9de26dce56307a9b22370aa22c0c93e9.svg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido a la naturaleza del desarrollo, la estructura DOOM se basa en un n√∫cleo que utiliza seis subsistemas para E / S. La mayor√≠a de las veces estudi√© las tres partes que me parecieron m√°s interesantes, a saber, el sistema de archivos basado en CD-ROM, el audio basado en SPU y el video basado en GPU, porque son exclusivos de la arquitectura PSX. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo fuente de DOOM para PSX nunca se public√≥, pero result√≥ no ser un problema en absoluto. La informaci√≥n disponible es suficiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera fuente es el impresionante PSY-Q SDK, que era la herramienta "oficial" utilizada por los desarrolladores de PSX de la √©poca. Hay mucha documentaci√≥n, presentada como un conjunto de archivos PDF. Tal abundancia de informaci√≥n solo confirma todo lo bueno que escuch√© sobre la amabilidad de PSX con los desarrolladores. La biblioteca (es decir, libcd, libds) desarrollada por Psygnosis tambi√©n est√° bien documentada. Fue muy agradable ver explicaciones claras, especialmente en comparaci√≥n con la falta casi completa de informaci√≥n sobre otras consolas (s√≠, estoy hablando de SNES). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra fuente de informaci√≥n son las numerosas herramientas externas disponibles en la actualidad. ISOBuster me permiti√≥ abrir el contenido del CD. PSound ayud√≥ a escanear archivos LCD. La sorprendente capacidad del emulador no $ PSX para rastrear comandos de GPU y SPU se ha convertido en oro real.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero quiz√°s estaba m√°s impresionado con el gran amor de DOOM por PSX por parte de la comunidad de fan√°ticos. </font><font style="vertical-align: inherit;">Se realiz√≥ una ingenier√≠a inversa completa del juego. </font><font style="vertical-align: inherit;">PSXDOOM-RE destaca especialmente porque es una base de c√≥digo C que puede compilarse usando el SDK de PSY-Q en un juego completo de PSX. </font><font style="vertical-align: inherit;">El c√≥digo es altamente confiable porque se obtuvo reescribiendo cada funci√≥n del c√≥digo de m√°quina en C.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El asombroso mundo de los CD</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de comenzar a estudiar la implementaci√≥n del sistema de archivos, hice una peque√±a excursi√≥n para comprender mejor el maravilloso mundo de los CD.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante 20 a√±os, de 1980 a 2000, se han publicado varios vol√∫menes de especificaciones que revelan este tema. Juntos, se llaman "Libros del arco iris". El primer libro de la serie, "Libro Rojo", contiene especificaciones para un disco compacto de audio (CD). El "Libro Amarillo" es un complemento del "Libro Rojo", agrega especificaciones de datos para CD-ROM e ISO-9600. El Orange Book ha agregado especificaciones para CD-DA, CD-R (grabable) y CR-WR (regrabable). El Libro Blanco est√° dedicado a Video-CD (VCD). El Libro Verde habla sobre CD-Interactive (CD-I). El Libro Azul presenta datos de CD mejorado (ECD) para soporte multimedia. Scarlet Book est√° dedicado a Super Audio (SACD), que agrega audio de alta definici√≥n. El Libro P√∫rpura enumera la especificaci√≥n de CD de doble densidad (DDCD), que ha aumentado la capacidad del disco de 650 MB a 1.3 GB. Finalmente,Cyan Book detalla las especificaciones del sistema de archivos 9660</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52b/2f6/c60/52b2f6c605024780dcf141bcaf02a6a8.svg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rainbow Books contiene todo lo que sabemos sobre el CD. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como m√≠nimo absoluto, debemos entender que los CD de PSX generalmente consisten en sectores, cada uno de los cuales contiene 2048 bytes de datos. </font><font style="vertical-align: inherit;">Los sectores se agrupan en pistas (que pueden ser datos o sonido). </font><font style="vertical-align: inherit;">Las pistas se agrupan en sesi√≥n. </font><font style="vertical-align: inherit;">La informaci√≥n de las pistas de datos se puede organizar utilizando el sistema de archivos est√°ndar ISO-9660, sin embargo, el juego tambi√©n puede tener direcciones de sector codificadas.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dentro del CD del juego DOOM</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/88b/62c/636/88b62c636572fe1c4617445525220c58.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si mira dentro del CD-ROM usando ISOBuster, puede ver que DOOM consiste en una sesi√≥n que contiene ocho pistas </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Siete de ellos son pistas de sonido con calidad de CD reproducidas entre misiones y en la escena final. </font><font style="vertical-align: inherit;">La pista final (# 7) incluso usa voces de demonios digitalizadas. </font><font style="vertical-align: inherit;">La pista n√∫mero 6 es especialmente notable porque parece haber sido tomada directamente de la fiesta rave. </font><font style="vertical-align: inherit;">Resulta que esta es m√∫sica que se reproduce en la tarjeta s√∫per secreta 59 "Club DOOM" (una tarjeta secreta accesible solo desde una tarjeta secreta) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">D√©jame dejarte apreciar su locura. </font><font style="vertical-align: inherit;">Antes de comenzar, verifique el volumen del sonido.</font></font><br>
<br>
<div class="oembed"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://fabiensanglard.net/doom_psx/Track06.mp3</font></font></a></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pista restante (n√∫mero 1) es ISO-9660, que contiene el motor del juego y la mayor√≠a de los recursos. </font><font style="vertical-align: inherit;">Despu√©s de explorar los muchos puertos DOOM, ingenuamente esperaba un motor llamado DOOM.EXE, un archivo de recursos PSXDOOM.WAD y posiblemente un manifiesto. </font><font style="vertical-align: inherit;">Estaba muy equivocado </font><font style="vertical-align: inherit;">Se encontraron 287 archivos </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[10] </font></font></sup><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[11]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la pista </font><font style="vertical-align: inherit;">, incluidos 60 .WAD, 120 .IMG e innumerables .LCD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los datos se ordenan por nivel (cinco archivos por tarjeta).</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nombre del archivo Descripci√≥n</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
=================================================== =====</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAP01.WAD Geometr√≠a est√°ndar (BSP / Rechazar / ...)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAPTEX01.IMG Texturas de planos / paredes</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAPSPR01.IMG Todos los sprites creados por THINGS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MUSIC / MUSLEV1.LCD M√∫sica reproducible</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNDMAPS1 / MAP01.LCD Todos los sonidos hechos por THINGS</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando se le pregunt√≥ por qu√© todo estaba organizado de una manera nueva, el desarrollador de Crash Bandicoot, Andy Gavin, respondi√≥ parcialmente en una entrevista con Ars Technica. </font><font style="vertical-align: inherit;">[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traducci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Habr√©]</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Se tarda aproximadamente 1/3 de segundo en mover la cabeza a cualquier punto del CD".</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido al hecho de que la velocidad de posicionamiento del cabezal era cercana a los 300 ms (lo que se confirma mediante la documentaci√≥n de PSY-Q </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[12]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), los desarrolladores de Williams Entertainment no pudieron guardar la arquitectura clara del motor DOOM, que almacenaba todos los recursos en un archivo (por ejemplo, DOOM.WAD) y los descarg√≥ a pedido. En la PSX, esto conducir√≠a a una velocidad de cuadro terrible. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los desarrolladores resolvieron el problema lanzando una cantidad aparentemente interminable de bytes en el CD. Todos los recursos necesarios para el nivel se almacenaron en cinco archivos que contienen la geometr√≠a del mapa, la textura. sprites, efectos de sonido y m√∫sica. Esto es muy costoso, pero elimin√≥ la necesidad de acceder al CD durante el proceso del juego. </font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hecho interesante:</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la lista de archivos en la pista de datos hay un archivo llamado PSXDOOM.WAD (4 806 088 bytes), pero se usa solo para cargar paletas y varias im√°genes de men√∫. </font><font style="vertical-align: inherit;">Probablemente m√°s utilizado activamente en el proceso de desarrollo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tome el primer mapa como ejemplo: la cantidad total de datos descargados se ha reducido de 4 MB a 900 KB.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tama√±o del nombre del archivo (en bytes)  </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
=====================================  	</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAP01.WAD 28196</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAPTEX01.IMG 90744</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MAPDIR0 / MAPSPR01.IMG 590344</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√öSICA / MUSLEV1.LCD 61 232</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SNDMAPS1 / MAP01.LCD 143 632</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
=====================================</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total: 914,148</font></font></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sabiendo que los recursos ocupan 914 KB, podr√≠a pensar que quedaba una gran cantidad de DRAM sin usar. Pero debe recordar que tambi√©n ten√≠a que ajustarse a un archivo ejecutable de 428 KB, as√≠ como a una pila que cambia en tiempo de ejecuci√≥n. De hecho, solo aproximadamente 1 MB de DRAM estaba disponible en tiempo de ejecuci√≥n. </font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un hecho interesante:</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al examinar el c√≥digo fuente de PSXDOOM-RE, encontr√© la funci√≥n P_LoadBlocks, que intenta leer desde el CD hasta cuatro veces </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[13]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , despu√©s de lo cual se rinde. Este es uno de los placeres de trabajar con medios que se rayan f√°cilmente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No esperaba que el tiempo de instalaci√≥n del cabezal del CD-ROM afectara tanto la arquitectura del juego. Algunos juegos, como Crash Bandicoot, se crearon desde cero con un sistema de p√°ginas para transmitir datos desde un CD en tiempo de ejecuci√≥n. En el caso de DOOM, el motor no era capaz de esto. El CD no se usa durante el juego, con la excepci√≥n de una canci√≥n en particular (s√≠, desde el nivel Club DOOM). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los chicos de id Software nunca han sido fan√°ticos de la compensaci√≥n entre capacidad y velocidad que ofrec√≠an los CD-ROM.</font></font><br>
<br>
<blockquote>¬´    - .     ,       CD.  - ,     Crash 'n Burn ‚Äî    ?    .  ,     CD      ,  3DO   .   -   CD- DOOM,        ‚Äû  DOOM‚Äú.           ,     .       .<br>
<br>
           ,     CD.       ¬ª. ‚Äî   (ATARI EXPLORER ONLINE, 22  1994 )</blockquote><br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un hecho interesante: los</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eventos dentro del juego DOOM se activaron usando "estr√≠as". </font><font style="vertical-align: inherit;">Al cruzar una l√≠nea con una propiedad especial, se llam√≥ a una funci√≥n especial. </font><font style="vertical-align: inherit;">En la versi√≥n "heredada" del motor no hab√≠a propiedad que le permitiera tocar canciones. </font><font style="vertical-align: inherit;">Para jugar al Club DOOM, se cre√≥ una acci√≥n de definici√≥n de l√≠nea especial (n√∫mero 142)</font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [14]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es sorprendente la cantidad de esfuerzo adicional que se necesit√≥ para crear este nivel. </font><font style="vertical-align: inherit;">Probablemente a los desarrolladores realmente les gustaba divertirse en las raves.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El caso del arzobispo desaparecido</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/daf/8fb/db9/daf8fbdb944deb32c8b6f398615a16ef.webp"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al realizar una investigaci√≥n para mi Game Engine Black Book, no pude entender completamente esta frase del dise√±ador Harry Teesley:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúArchvile ten√≠a el doble de cuadros de animaci√≥n que cualquier otro monstruo, y no pudimos incluirlo en la PSX. </font><font style="vertical-align: inherit;">Ni su ataque ni el efecto de resurrecci√≥n podr√≠an perderse. </font><font style="vertical-align: inherit;">Era demasiado grande ". </font><font style="vertical-align: inherit;">- Harry Tisley (dise√±ador) en una entrevista con doomworld.com</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Era obvio que el problema no era la capacidad de 650 megabytes del CD, pero no entend√≠ cu√°l era el factor limitante: DRAM o VRAM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habiendo entendido las limitaciones del CD-ROM, me di cuenta de que el problema no estaba en almacenar el sprite en un CD, o incluso transferirlo de DRAM a VRAM. </font><font style="vertical-align: inherit;">El problema es encajar todo en DRAM. </font></font><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dato interesante:</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ArchVile se elimina por completo del c√≥digo fuente de PSXDOOM-RE. </font><font style="vertical-align: inherit;">Incluso su #DEFINE est√° comentado </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[15]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_ZOMBIE  <span class="hljs-meta-string">"Zombieman"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_SHOTGUN  <span class="hljs-meta-string">"Shotgun Guy"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_HEAVY  <span class="hljs-meta-string">"Heavy Weapon Dude"</span></span><font></font>
...<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_HELL   <span class="hljs-meta-string">"Hell Knight"</span></span>
<span class="hljs-comment">//#define CC_ARCH "Arch-Vile"</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_SPIDER <span class="hljs-meta-string">"The Spider Mastermind"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_CYBER  <span class="hljs-meta-string">"The Cyberdemon"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CC_HERO   <span class="hljs-meta-string">"Our Hero"</span></span></code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programaci√≥n SPU</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El chip SPU solo comprende un formato, a saber, ADPCM. </font><font style="vertical-align: inherit;">Es capaz de mezclar hasta 24 canales (incluida la pista de audio de CD) y tiene potentes funciones de manipulaci√≥n de audio.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para domar a esta bestia, el DOOM PSX utiliza la biblioteca libWESS (Williams Entertainment Sound System), escrita por el ingeniero de sonido Scott Patterson. </font><font style="vertical-align: inherit;">La biblioteca es bastante poderosa, es capaz de recrear el sistema MiDI, en el que un pesado banco de notas (llamado fuente de sonido) est√° controlado por una partitura musical que ocupa poco espacio. </font><font style="vertical-align: inherit;">Tambi√©n puede manipular atributos de sonido en tiempo real como volumen, tono, velocidad de nota y funciones ADSR (ataque, decaimiento, sostenido y liberaci√≥n). </font><font style="vertical-align: inherit;">Toda la m√∫sica que se reproduce durante el juego se genera usando libWESS. </font><font style="vertical-align: inherit;">Con una excepci√≥n, lo adivin√≥, este es el Club DOOM, que se reproduce desde la pista de CD n√∫mero 6.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WESS utiliza dos formatos de archivo propietarios. </font><font style="vertical-align: inherit;">Estos son archivos .WMD que contienen partituras y efectos de sonido, y archivos .LCD, que tienen formato PSX VAG (sin t√≠tulo) y contienen muestras de ADPCM. </font><font style="vertical-align: inherit;">Cuando se inicia DOOM, la biblioteca libWESS carga todos los efectos de sonido (SFX, 89 piezas) y partituras musicales (19 piezas) almacenadas en un peque√±o archivo (55 KB) llamado DOOMSND.WMD. </font><font style="vertical-align: inherit;">Ella tambi√©n carga en la SRAM "siempre usado" muestras publicadas por el personaje, puertas, etc.</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√öSICA / DOOMSFX.LCD -&gt; SRAM</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√öSICA / DOOMSND.WMD -&gt; DRAM</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de cargar el mapa, libWESS abre MUSIC / MUSLEV% .LCD, que contiene las muestras de ADPCM utilizadas en la m√∫sica de esta tarjeta, y SNDMAPS% / MAP %%. LCD, que contiene las muestras de ADPCM necesarias para los enemigos a este nivel. </font><font style="vertical-align: inherit;">Todas las muestras de ADPCM se cargan directamente en SRAM y no ocupan espacio en DRAM.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOOM en PSX: GPU</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el √°rea de la generaci√≥n de videos, Williams Entertainment necesitaba resolver dos problemas: una peque√±a cantidad de VRAM (volveremos a esto m√°s adelante) y la falta de un mapeo de textura correcto teniendo en cuenta la perspectiva.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAaron Siler y yo trabajamos en versiones para Nintendo 64 (este juego era bastante diferente) y para Playstation. </font><font style="vertical-align: inherit;">Estas fueron las primeras versiones que no fueron escritas en metal desnudo, porque Sony y Nintendo obligaron a los desarrolladores (al menos de terceros) a escribir API y no les dieron documentaci√≥n sobre los registros de hardware. </font><font style="vertical-align: inherit;">Al principio, la cultura SGI limit√≥ particularmente a los desarrolladores, pero gradualmente Nintendo afloj√≥ su control.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una historia divertida sobre el desarrollo de una versi√≥n para Playstation: Aaron y yo comenzamos con una arquitectura de motor diferente, que representaba los tri√°ngulos del mundo, porque la consola les proporcionaba una aceleraci√≥n de hardware completa. </font><font style="vertical-align: inherit;">En el caso de N64, esto funcion√≥ perfectamente, ya que ten√≠a una representaci√≥n correcta en perspectiva con una precisi√≥n de subp√≠xeles (el resultado de la influencia de SGI), pero en el Playstation se realiz√≥ un mapeo de textura afinado con coordenadas enteras, por lo que los grandes tri√°ngulos de pared y piso parec√≠an IMPRESIONANTES ‚Äù. </font><font style="vertical-align: inherit;">- John Carmack (Game Engine Black Book: DOOM)</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para entender cu√°n "terrible" se ve√≠a, debajo mostr√© tres paredes renderizadas con texturas afines y prospectivamente correctas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98b/897/f95/98b897f955dbdf31ff724bbe1a1841f4.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texturas en perspectiva</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/67f/f2a/602/67ff2a6028aea5b8a390b13ecdf23f5c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affine (PSX)</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tenga en cuenta que no hay problema con una pared recta y, a medida que aumenta el √°ngulo de perspectiva, la distorsi√≥n se vuelve m√°s notable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El mismo problema de percepci√≥n se enfrent√≥ a los desarrolladores de Rage Software al portar DOOM a SEGA Saturn.</font></font><br>
<br>
<blockquote>¬´    ,        id Software.      ,      WAD       Saturn,      ,  3D-.   ,           ,          3D-   .     ,    PC.  ,   ,      :  SH2    ,   PC,  68000     .<br>
<br>
   ,      ¬ª ‚Äî   ( DOOM  Saturn)   RetroGamer ‚Ññ134.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tal vez, dado que los desarrolladores de PSX tuvieron m√°s tiempo, pudieron resolver el problema de la asignaci√≥n de textura prospectivamente correcta al convertir el renderizador de pol√≠gonos de GPU en renderizador de l√≠nea.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Dije: haz una copia de seguridad de todo (¬°entonces todav√≠a no hab√≠a sistemas de control de versiones!), Haremos que el juego sea completamente diferente". </font><font style="vertical-align: inherit;">Utilizamos equipos que representaban tri√°ngulos que representaban columnas o filas de un p√≠xel de ancho, al igual que en el c√≥digo del ensamblador en una PC, y funcion√≥ muy bien. </font><font style="vertical-align: inherit;">Result√≥ que la soluci√≥n m√°s com√∫n en Playstation era la teselaci√≥n de la geometr√≠a a lo largo de dos ejes, pero realmente me gust√≥ que Doom pareciera menos "nervioso" que la mayor√≠a de los juegos para Playstation de esa √©poca ". - John Carmack (Game Engine Black Book: DOOM)</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias al proyecto PSXDOOM-RE </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[16],</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> podemos descubrir c√≥mo se implement√≥. </font><font style="vertical-align: inherit;">La canalizaci√≥n de renderizado ha sido completamente reescrita y dividida en dos etapas. </font><font style="vertical-align: inherit;">Esto se discutir√° con m√°s detalle a continuaci√≥n, pero en realidad podemos ver que la funci√≥n de representaci√≥n R_Render_Wall transmite comandos de dibujo codificados con un ancho de 1 p√≠xel.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">R_Render_Wall</span><span class="hljs-params">(...)</span> </span>{<font></font>
  .<font></font>
  <span class="hljs-keyword">int</span> x1 = ... ; <span class="hljs-comment">// Left end of wall.</span>
  <span class="hljs-keyword">int</span> x2 = ... ; <span class="hljs-comment">// Right end of wall.</span><font></font>
  .<font></font>
  <span class="hljs-keyword">while</span>(x1 &lt; x2) {<font></font>
    .<font></font>
    setRGB0(wallpoly);<font></font>
<font></font>
    setXY3(wallpoly,<font></font>
      x1    , ypos1 - <span class="hljs-number">1</span>,<font></font>
      x1 + <span class="hljs-number">1</span>, ypos2 + <span class="hljs-number">1</span>,<font></font>
      x1    , ypos2 + <span class="hljs-number">1</span>);		<font></font>
<font></font>
    setUV3(wallpoly,<font></font>
         upos, v0,<font></font>
         upos, v1,<font></font>
         upos, v1);  <font></font>
    .<font></font>
    x1 += <span class="hljs-number">1</span>;<font></font>
  }<font></font>
}</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los muros se representan en columnas de un p√≠xel de ancho. </font><font style="vertical-align: inherit;">Echa un vistazo a la API, que se parece al modo Inmediato en OpenGL. </font></font></i><br>
<br>
<b><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dato interesante:</font></font></u></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el dise√±ador de hardware de Sony retuvo el i-cache del procesador MIPS, pero desactiv√≥ su d-cache para convertirlo en un scratchpad de alta velocidad de 1K. </font><font style="vertical-align: inherit;">Los procedimientos de representaci√≥n de pared / plano utilizaron este scratchpad ampliamente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesti√≥n de GPU VRAM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aprender c√≥mo se realiza el control VRAM, eleg√≠ una forma curiosa: utilic√© la funci√≥n de ver el emulador VRAM en tiempo real sin $ PSX. </font><font style="vertical-align: inherit;">Esta funci√≥n muestra la matriz completa de p√≠xeles 1024 x 512 x 16 bits (aunque en forma distorsionada). </font><font style="vertical-align: inherit;">La funci√≥n de visualizaci√≥n tambi√©n muestra la lista completa de instrucciones de GPU transmitidas por el procesador central en cada cuadro.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/106/6e1/2c4/1066e12c443fa07e91e8f4793afe655d.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No $ PSX: Dios nos envi√≥ un emulador que le permite mirar dentro de la GPU. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un estudio cuidadoso del primer fotograma de VRAM le permite aprender mucho.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfd/e98/57f/dfde9857f541f946c946445fc5feb1ea.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El primer cuadro del juego se muestra con No $ PSX. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las m√°s obvias son dos √°reas de 256 x 240 x 16 bits en la esquina superior izquierda, que son los b√∫feres de cuadros (por lo tanto, el juego usa doble b√∫fer). </font><font style="vertical-align: inherit;">Vale la pena se√±alar que 256x240 es la resoluci√≥n m√°s baja posible en una PSX. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debajo de los b√∫feres de cuadros hay un conjunto colorido de p√≠xeles: la paleta CLUT. </font><font style="vertical-align: inherit;">Tenga en cuenta los tonos de rojo, significan que cuando la pantalla se vuelve roja cuando el jugador recibe da√±o, se usan paletas precalculadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la esquina superior derecha vemos texturas que est√°n extra√±amente comprimidas horizontalmente y tienen colores "incorrectos". </font><font style="vertical-align: inherit;">Sucedi√≥ porque las texturas usan √≠ndices de 8 bits del CLUT descrito anteriormente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hablemos de fuego en DOOM en PS1 nuevamente</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2018, estudi√© c√≥mo se realiz√≥ el efecto del fuego </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[17]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traducci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Habr√©]. </font><font style="vertical-align: inherit;">Fue genial volver a √©l nuevamente al explorar los comandos de la GPU. </font><font style="vertical-align: inherit;">Observe que ning√∫n $ PSX marca el √°rea de destino de cada comando en rojo. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 1: la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> llama se actualiza en RAM y se carga en VRAM (comando CpuToVram).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d61/e16/8a1/d61e168a1b238160665e78c437c7b2d5.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 2: la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> textura de </font><b><font style="vertical-align: inherit;">la</font></b><font style="vertical-align: inherit;"> llama se dibuja cuatro veces a lo largo de la pantalla (comando QuadTex). </font><font style="vertical-align: inherit;">La textura de la llama tiene un ancho de 32 texels, pero la GPU se usa para dibujarlo con un ancho de 64 p√≠xeles. </font><font style="vertical-align: inherit;">Aqu√≠ no es posible el filtrado bilineal, se muestrean los texels m√°s cercanos.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f1a/08b/a2c/f1a08ba2c51a31bd57bcf9b45827bb23.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etapa 3: la</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> placa final de DOOM (comando QuadTex) se dibuja encima de todo.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7de/30e/f5b/7de30ef5b64d978cf2f632cfe3ac82b4.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fotograma completo, equipo por equipo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un estudio de los comandos transmitidos en el marco mostr√≥ que el motor es completamente diferente de la versi√≥n para PC. En √©l, el mundo estaba rodeado de una corta distancia en la distancia. Primero, se representan todos los muros. En la segunda pasada, se llena un espacio vertical entre ellos (visplane) (incluido el cielo). En el tercer (√∫ltimo) pasaje, se representan los sprites, comenzando por el m√°s lejano. Todo esto se hizo con cero p√≠xeles de redibujado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En PSX, el renderizado es un poco m√°s grosero. Todo se procesa en un solo paso, realizado a partir de lejos. El sistema de visplane que la PC us√≥ para llenar el vac√≠o entre las paredes no est√° aqu√≠. Gracias a un nuevo concepto llamado "hojas", el plano y las paredes se representan en el orden de los subsectores. Dichas operaciones en "verdadero 3D" se hicieron posibles debido al uso activo de las funciones de proyecci√≥n de matriz GPE. Los sprites tambi√©n se representan simult√°neamente con paredes / planos sin controles de superposici√≥n y truncamiento, lo que resulta en una peque√±a cantidad de redibujado.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">R_RenderPlayerView</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
  R_BSP();         <span class="hljs-comment">// Phase 1</span>
  R_RenderSKY();   <span class="hljs-comment">// Phase 2</span>
  <span class="hljs-keyword">for</span> (all subsectors from phase <span class="hljs-number">1</span>) {<font></font>
    R_RenderAll(subsector)<font></font>
  }<font></font>
  R_Render_Hud_Weapons();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Miremos cada paso en detalle, comenzando con el cielo, que primero se representa con CopyRectRaw. no $ PSX muestra VRAM en el momento en que se completa el marco, pero le permite volver al historial de comandos. Los p√≠xeles del cielo son visibles solo porque ning√∫n $ PSX tiene problemas para percibir este truco con columnas de un ancho de p√≠xel (otros emuladores, como ePSXe, no pueden hacer frente mejor </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[18]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), pero todos estos p√≠xeles se reescribir√°n. Tenga en cuenta que bajo las texturas del cielo, todos los marcadores de las llaves de las puertas se recogen en un atlas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d1d/2ae/868/d1d2ae868238f0282a8495a4e2dd6afd.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, el BSP se atraviesa en orden de lejos a cerca. Para cada subsector, se representan todos los muros / planos / sprites. Si est√° familiarizado con DOOM BSP, probablemente recuerde que el compilador de doombsp solo mantuvo segmentos s√≥lidos de subsectores. Para garantizar la representaci√≥n de los planos, se agreg√≥ un nuevo concepto de "hojas" a la versi√≥n de PSX, en la que se almacenaron segmentos de separaci√≥n BPS (invisibles). Estos segmentos se proyectan en el espacio de la pantalla para generar l√≠mites planos. Este es un enfoque mucho m√°s "limpio", porque le permite deshacerse de los hacks con espacio en la pantalla y errores, por ejemplo, del conocido "rastro de babosas".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/558/cde/f1d/558cdef1d6ef68f1272b1e260333fd3b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la pr√≥xima toma VRAM, los planos del mismo subsector que el muro que vimos arriba se representan como tri√°ngulos de 1 p√≠xel de altura. </font><font style="vertical-align: inherit;">Tambi√©n preste atenci√≥n a la textura de las paredes / planos, todos tienen el mismo tama√±o. </font><font style="vertical-align: inherit;">Esta caracter√≠stica simplifica la selecci√≥n de texturas VRAM y evita la fragmentaci√≥n.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/be6/092/6ce/be60926ce5304a264da51ab38a3e2c6a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todav√≠a estamos en el mismo subsector. </font><font style="vertical-align: inherit;">Ahora los sprites se representan como cuadr√°ngulos (Quad). </font><font style="vertical-align: inherit;">Estos sprites incluyen enemigos, proyectiles, paredes parcialmente transparentes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/708/e06/cf6/708e06cf66400378617db2484694433c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por diversi√≥n, mostraremos conchas de plasma.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb4/c5a/ebc/fb4c5aebca255019caa7d8c31140c136.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos estamos acercando al final de los comandos de renderizado. </font><font style="vertical-align: inherit;">Aqu√≠, al mezclar el rect√°ngulo, se renderiza el arma.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac2/061/da0/ac2061da0769c7e614503818d5e59755.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√öltimo paso: Representaci√≥n de interfaz (HUD).</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a34/be3/7e9/a34be37e93d0991d27b5d4fd8a3356c4.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Desbordamiento de VRAM!</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/853/a77/9cc/853a779ccdc0280234e53ab3b6aea59a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trabajar con la GPU fue un ejercicio de asignaci√≥n de espacio en VRAM. En el caso de b√∫feres de trama, CLUT, contenido est√°tico (interfaz) e incluso paredes / planos, la tarea es elemental, porque todos tienen el mismo tama√±o. Pero con los sprites, las cosas son un poco m√°s complicadas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debido al hecho de que los sprites tienen diferentes tama√±os, conducen a la fragmentaci√≥n. Adem√°s, las texturas pueden cubrir grandes √°reas de la pantalla y repetirse, y los sprites son a menudo √∫nicos y puede ser necesario un n√∫mero impredecible de ellos en cada cuadro. En el peor de los casos, un marco requiere una cierta cantidad de sprites que no se pueden colocar en VRAM. Esto se denomina desbordamiento de cach√© de textura y este problema no se puede resolver. Cuando esto sucede, el juego se bloquea y muestra un mensaje de error cr√≠ptico </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[19]</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">record√°ndonos a algunos de nosotros el siniestro "No m√°s visplanes".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fb/4a4/f9f/1fb4a4f9fecf0b6420b198b08ff2f84d.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuantos m√°s sprites veas al mismo tiempo, m√°s VRAM se usa.</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La diferencia entre PAL y NTSC</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conclusi√≥n del cap√≠tulo de video, decid√≠ ver c√≥mo NTSC se convierte a PAL. </font><font style="vertical-align: inherit;">Desafortunadamente, como en muchos otros juegos, el DOOM PSX no tuvo en cuenta el aumento de la resoluci√≥n vertical. </font><font style="vertical-align: inherit;">Al jugar DOOM en PS1 en Europa, viste una imagen comprimida verticalmente con bordes negros notables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de conocer los principios de VRAM, me resulta dif√≠cil culpar a los desarrolladores. </font><font style="vertical-align: inherit;">Si observa detenidamente el esquema VRAM en NTSC, notar√° que aumentar la resoluci√≥n vertical del b√∫fer de trama viola toda la estructura de asignaci√≥n de datos. </font><font style="vertical-align: inherit;">Ser√≠a imposible almacenar texturas debajo de √©l. </font><font style="vertical-align: inherit;">O tendr√≠as que mover CLUT a otra ubicaci√≥n. </font><font style="vertical-align: inherit;">Demasiado costo con relativamente poco beneficio, e incluso a pesar del hecho de que las fronteras negras interfieren con el juego, estoy de acuerdo en que no vali√≥ la pena.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expresiones de gratitud</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias a Eric V√°zquez (autor de PSXDOOM-RE), Samuel Villarreal (uno de los desarrolladores de PSXDOOM-RE) y Dan Leslie (desarrollador profesional de juegos para PlayStation 1) por compartir generosamente sus conocimientos conmigo.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Materiales de referencia</font></font></b><div class="spoiler_text">[ 1] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">The Polygons Of Another World</a><br>
[ 2] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Game Engine Black Book: DOOM</a><br>
[ 3] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Everything You Have Always Wanted to Know about the Playstation</a><br>
[ 4] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">@gmontoir ‚Äî 'Heart of Darkness uses MDEC frames as background bitmaps'.</a><br>
[ 5] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Five years of DOOM, part 1</a><br>
[ 6] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Five years of DOOM, part 2</a><br>
[ 7] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://archive.vn/20121209124333/" rel="nofollow">The Great Books</a><br>
[ 8] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">DOOM PSX tracks</a><br>
[ 9] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">MAP59: Club Doom (PlayStation Doom)</a><br>
[10] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PSXDOOM/tree.txt</a><br>
[11] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PSXDOOM files</a><br>
[12] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PSY-Q SDK, CD Hardware</a><br>
[13] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">P_LoadBlocks</a><br>
[14] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">Linedef #142 plays Club Doom</a><br>
[15] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">//#define CC_ARCH</a><br>
[16] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">PSXDOOM-RE Source code</a><br>
[17] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">How DOOM fire was done</a><br>
[18] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">DOOM on ePSXe</a><br>
[19] : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">I_Error('Texture Cache Overflow');</a></div></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es494380/index.html">Introducci√≥n a la gesti√≥n estrat√©gica de productos</a></li>
<li><a href="../es494384/index.html">Encuesta funcional</a></li>
<li><a href="../es494390/index.html">La impresi√≥n 3D reduce los costos de autoajuste a la mitad</a></li>
<li><a href="../es494394/index.html">Xia Peysu: madre de la inform√°tica china</a></li>
<li><a href="../es494396/index.html">Bienvenido Mat - ahora tambi√©n en ruso</a></li>
<li><a href="../es494400/index.html">Coronavirus e Internet</a></li>
<li><a href="../es494402/index.html">Etapas de madurez estrat√©gica</a></li>
<li><a href="../es494406/index.html">Aprendizaje autom√°tico sin profesor. Extracto del libro.</a></li>
<li><a href="../es494408/index.html">El esquema de falsificaci√≥n, restauraci√≥n y control de frutas en una verduler√≠a. Extracto del libro.</a></li>
<li><a href="../es494410/index.html">Antes de que se generalizara: c√≥mo lanzamos la entrega sin contacto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>