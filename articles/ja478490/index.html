<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬆️ 👰🏼 👩🏾‍🔬 レーベンシュタイン距離とコントローラーの検索 🛎️ 🤾🏻 🔞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="おそらく、トロリーバスがあるベラルーシのすべての都市で、人々がコントローラーの場所を追跡するテレグラムにVKグループまたはチャットがあります。これは主に、旅行の費用を払わず、無料で旅行できるようにするために行われますが、グループの説明には、ほとんどの場合、「旅行の料金」の後書きが含まれています。
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>レーベンシュタイン距離とコントローラーの検索</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478490/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく、トロリーバスがあるベラルーシのすべての都市で、人々がコントローラーの場所を追跡するテレグラムにVKグループまたはチャットがあります。</font><font style="vertical-align: inherit;">これは主に、旅行の費用を払わず、無料で旅行できるようにするために行われますが、グループの説明には、ほとんどの場合、「旅行の料金」の後書きが含まれています。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 VCでは通常、次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ti/eh/cd/tiehcdyeskmccfofp3adt2ko_qe.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的なコメントは次のようになります</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ki/kp/s0/kikps0wwqqptfwyro8hrf81rtzg.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。構造は非常に単純です。</font><font style="vertical-align: inherit;">解説には、コントローラーが現在気づいている停車地の名前があり、それらが立っている方向も</font></font><br>
<br>
<img src="https://habrastorage.org/webt/no/gy/2l/nogy2l1lrraa8gte90lcyuwsume.png" alt="画像"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あります。結果として、コメントは、停車地、時刻、日付、およびそれを識別することができる一意のIDを持つオブジェクトです。</font><font style="vertical-align: inherit;">これにより、コントローラーが現在ある最も可能性の高い場所を計算できます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トレーニング</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 最初に、ターゲットのパブリックを決定する必要があります。そこからデータを解析します。</font><font style="vertical-align: inherit;">グループのコメントにはかなりのアクティビティが必要です。そうしないと、データが少なすぎる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の場合、これは「Gomel Control」グループです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
公式のVKontakte API for Pythonを使用してコメントを解析します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のグループは非公開になっている可能性があるため、ユーザーのアクセスキーを使用して認証し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">コメントへのアクセスは、グループに承認された場合にのみ取得できます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 その後、コメントの抽出を開始できます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> コメントを受け取る</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 開始するには、vk.wall.getCommentsを介してコメントを引き出し、データを保存するDataFrameを初期化するために、グループで最後に利用可能な投稿を取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各コメント投稿には「良い一日を過ごし、運賃を支払い、管理されない」という銘文があるため、コメントをダウンロードし、投稿の内容を確認して、データを取得できるコメントの配列を取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は過去3か月間の投稿からコメントを取りました。毎日1つの投稿が投稿されているからです（現在は11月末、学年は9月に始まり、監督者はこれを考慮して通常の場所を変更する可能性が高いです）。原則として、例えば、時期などの他の兆候を考慮に入れることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一部のコメントには、「Barykinに誰かいますか？」のようなメッセージが詰まっています。</font><font style="vertical-align: inherit;">そのような（不要な）コメントを見ると、いくつかの兆候を強調できます。</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> テキストに「クリーン」、「左」、「誰も」などの単語が含まれている</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 「教えて」「誰」「何」「どう」という言葉</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 絵文字などの記号</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 その後、コメントの配列を調べ、一意のID、テキスト、時刻、日付、曜日をコメントから取り出します。これらは、既に作成されているDataFrameに挿入されます。 </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コメントを受け取る</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<font></font>
<font></font>
<span class="hljs-keyword">import</span> lp
<span class="hljs-keyword">import</span> vk_api
<span class="hljs-keyword">import</span> check_correctness<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">auth</span>():</span><font></font>
    vk_session = vk_api.VkApi(lp.login, lp.password)<font></font>
    vk_session.auth()<font></font>
    vk = vk_session.get_api()<font></font>
    <span class="hljs-keyword">return</span> vk<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getDataFromComments</span>(<span class="hljs-params">vk, groupID</span>):</span><font></font>
<font></font>
    <span class="hljs-comment">#    </span>
    posts = vk.wall.get(owner_id=groupID, offset=<span class="hljs-number">1</span>, count=<span class="hljs-number">90</span>)<font></font>
    print(<span class="hljs-string">"\n"</span>)<font></font>
    data = pd.DataFrame(columns=[<span class="hljs-string">'text'</span>, <span class="hljs-string">'post_id'</span>, <span class="hljs-string">"date"</span>, <span class="hljs-string">"day_in_week"</span>, <span class="hljs-string">"hour"</span>,<span class="hljs-string">"minute"</span>, <span class="hljs-string">"day_in_month"</span>])<font></font>
<font></font>
    <span class="hljs-keyword">for</span> post <span class="hljs-keyword">in</span> posts.get(<span class="hljs-string">"items"</span>):
        <span class="hljs-comment"># id    </span>
        postID = post.get(<span class="hljs-string">"id"</span>)<font></font>
<font></font>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"  ,       "</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> post.get(<span class="hljs-string">"text"</span>):
            <span class="hljs-keyword">continue</span><font></font>
<font></font>
        <span class="hljs-comment">#  commentary      </span>
        comments = vk.wall.getComments(owner_id=groupID, post_id=postID, count=<span class="hljs-number">200</span>)<font></font>
<font></font>
        <span class="hljs-comment">#           dataframe</span>
        <span class="hljs-keyword">for</span> comment <span class="hljs-keyword">in</span> comments.get(<span class="hljs-string">"items"</span>):<font></font>
<font></font>
            text = comment.get(<span class="hljs-string">"text"</span>)<font></font>
            text = re.sub(<span class="hljs-string">r"A-Za-z--0123456789 "</span>, <span class="hljs-string">""</span>, str(text))<font></font>
            commentaryIsNice = check_correctness.detection(text)<font></font>
            <span class="hljs-keyword">if</span> commentaryIsNice:<font></font>
                print(text)<font></font>
                date = comment.get(<span class="hljs-string">"date"</span>)<font></font>
                time_struct = time.gmtime(date)<font></font>
                post_id = comment.get(<span class="hljs-string">"post_id"</span>)<font></font>
                data = data.append({<span class="hljs-string">"text"</span>: text, <span class="hljs-string">"post_id"</span> : post_id,
                                    <span class="hljs-string">"date"</span>: date,<span class="hljs-string">"day_in_week"</span> : time_struct.tm_wday,
                                    <span class="hljs-string">"hour"</span>: (time_struct.tm_hour+<span class="hljs-number">3</span>),
                                    <span class="hljs-string">"minute"</span>: time_struct.tm_min,
                                    <span class="hljs-string">"day_in_month"</span>: time_struct.tm_mday}, ignore_index=<span class="hljs-literal">True</span>)<font></font>
<font></font>
<font></font>
    <span class="hljs-comment"># print(data[:10])</span>
    <span class="hljs-comment"># print(data.info())</span><font></font>
<font></font>
    print(<span class="hljs-string">"dataset is ready"</span>)
    <span class="hljs-keyword">return</span> data</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 したがって、コメントのテキスト、ID、曜日、コメントが書き込まれた時間と分を含むDataFrameを受け取りました。</font><font style="vertical-align: inherit;">必要なのは、曜日、執筆時間、テキストだけです。</font><font style="vertical-align: inherit;">次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cd/hs/cy/cdhscyg3rx4f5kejgvjdguuscui.png" alt="画像"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> データクレンジング</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 次に、データをクリアする必要があります。</font><font style="vertical-align: inherit;">レーベンシュタイン距離を探すときに間違いを少なくするために、解説から方向を取り除く必要があります。</font><font style="vertical-align: inherit;">通常は2番目のストップの名前が後に続くため、「側方」、「行く」、「方法」、「近く」という表現が見つかり、それらの後ろに続くものとともにそれらを削除し、ストップの専門用語の名前を通常のものに置き換えます。 。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データを消去</font></font></b><div class="spoiler_text"><pre><code class="python hljs">
<span class="hljs-keyword">from</span> fuzzywuzzy <span class="hljs-keyword">import</span> process<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clear_commentary</span>(<span class="hljs-params">text</span>):</span>
    <span class="hljs-string">"""    -
       """</span>
    index = <span class="hljs-number">0</span>
    splitted = text.split(<span class="hljs-string">" "</span>)
    <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> enumerate(splitted):
        <span class="hljs-keyword">if</span> len(splitted) == <span class="hljs-number">1</span>:
            <span class="hljs-keyword">return</span> np.NaN
        <span class="hljs-keyword">if</span> (((<span class="hljs-string">""</span> <span class="hljs-keyword">in</span> s) <span class="hljs-keyword">or</span> (<span class="hljs-string">""</span> <span class="hljs-keyword">in</span> s) <span class="hljs-keyword">or</span> (
                <span class="hljs-string">""</span> <span class="hljs-keyword">in</span> s) <span class="hljs-keyword">or</span> (
                     <span class="hljs-string">""</span> <span class="hljs-keyword">in</span> s)) <span class="hljs-keyword">and</span> s <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-string">""</span>):<font></font>
            index = i<font></font>
    <span class="hljs-keyword">if</span> index <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> index &lt; len(splitted) - <span class="hljs-number">2</span>:
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">4</span>):<font></font>
            splitted.remove(splitted[index])<font></font>
        string = <span class="hljs-string">" "</span>.join(splitted)<font></font>
        text = (string.lower())<font></font>
    <span class="hljs-keyword">elif</span> index <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-number">0</span>:<font></font>
        splitted = splitted[:index]<font></font>
        string = <span class="hljs-string">" "</span>.join(splitted)<font></font>
        text = string.lower()<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
        text = <span class="hljs-string">" "</span>.join(splitted).lower()
    <span class="hljs-keyword">return</span> text<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clean_data</span>(<span class="hljs-params">data</span>):</span>
    data.dropna(inplace=<span class="hljs-literal">True</span>)<font></font>
    data[<span class="hljs-string">"text"</span>] = data[<span class="hljs-string">"text"</span>].map(<span class="hljs-keyword">lambda</span> s: clear_commentary(s))<font></font>
    data.dropna(inplace=<span class="hljs-literal">True</span>)<font></font>
    print(<span class="hljs-string">"cleaned"</span>)
    <span class="hljs-keyword">return</span> data</code></pre><br>
</div></div><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レーベンシュタイン距離を使用した変換</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Levenshane距離に直接進みます。</font><font style="vertical-align: inherit;">ちょっとしたヘルプ：Levenshtein距離-1つの文字を挿入し、1つの文字を削除し、1つの文字を別の文字に置き換える操作の最小数。1つの行を別の行に変換するために必要です。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">fuzzywuzzy</font></a></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ライブラリを使用して</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見つけ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">レーベンシュタイン距離をすばやく簡単に計算できます。</font><font style="vertical-align: inherit;">作業をスピードアップするために、ライブラリの作成者はpython-Levenshteinライブラリのインストールも推奨しています。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 コメントからストップを取得するには、ストップのリストが必要です。</font><font style="vertical-align: inherit;">GoTransアプリケーションの開発者であるAlexander Kozlovから提供されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リストを拡張して、そこにないストップをいくつか追加し、より適切に配置されるように名前の一部を変更する必要がありました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ストップ</font></font></b><div class="spoiler_text">stops = ['', '', '', '', '', '',<br>
 '', '', '8 ',<br>
 '  ', ' ', '', '', 'c',<br>
 '', '', '', '', '', '1000 ', '', '',<br>
 ' ', '', '', ' 18', '', '',<br>
 '', '', ' ', ' ', '',<br>
 ' ', '',<br>
 '', ' №1', ' ', '', ' ', ' ',<br>
 '', '', ' ', '', '', '',<br>
 '', '', '', '', '2 ', '',<br>
 ' ', '', ' ', '', '', '',<br>
 '67', '35', '', '50   ', '', '',<br>
 '', '', '', '  ', '',<br>
 ' ', '', ' ', ' ', '', ' ',<br>
 '', '', '', '', '', '', '',<br>
 '', '', '', '', '', '', '',<br>
 ' ', '', '', '', '', '',<br>
 '', ' ', ' ', '9 ', ' ', '',<br>
 ' ', '', '', '', ' ', '',<br>
 '', '', '', '', '', '',<br>
 '', '', '60 ', '', '',<br>
 ' ', ' ', '', '', '', '',<br>
 '', '', '', '', '', '  ',<br>
 '', '', '', '', '', '', '',<br>
 '', '  11', '', '', '', '', '',<br>
 '', '', '', '', '', '',<br>
 '70 ', '', ' ', '', '', '',<br>
 '', '', '', '', '2  ', '', '',<br>
 ' ', '', '', '1 ', ' ',<br>
 '', '', '', '', '', '', '',<br>
 '', ' ', '', '', '', '', '', '',<br>
 '', '', '', ' ', '',<br>
 '', '', '', '', '',<br>
 ' ', '', '', '', '',<br>
 '', ' ', '', ' ', '', '',<br>
 '', '', ' ', '', '',<br>
 ' ', ' 6', '', ' ', ' ',<br>
 ' ', '', ' ', '3 ', '', ' ',<br>
 '', '', '', ' ', '', ' ',<br>
 '', '', ' 21', '', '', '',<br>
 '', '', ' 20', ' ', ' ', '',<br>
 '  ', '', ' ', ' ',<br>
 '', '', '  27', '', '', '',<br>
 '179', '', ' ', '', ' ',<br>
 ' ', '', '', '', '', ' 19']<br>
</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 .mapとfuzzywuzzy.process.extractOneを使用して、リスト内の最小レーベンシュタイン距離のストップを見つけた後、コメントテキストをストップの名前に置き換えます。これにより、ストップの名前でデータセットを取得できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果のデータセットは次のようになります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gd/pd/c8/gdpdc8lwdppzpastghnasxbqsbi.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コメントがストップに変わります</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_category_from_comment</span>(<span class="hljs-params">text</span>):</span>
    <span class="hljs-string">"""        
          """</span><font></font>
    dict = process.extractOne(text.lower(), stops)<font></font>
    <span class="hljs-keyword">if</span> dict[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">75</span>:<font></font>
        text = dict[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span>:<font></font>
        text = np.nan<font></font>
    print(<span class="hljs-string">"wait"</span>)
    <span class="hljs-keyword">return</span> text<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_category_dataset</span>(<span class="hljs-params">data</span>):</span>
    <span class="hljs-string">"""      """</span>
    print(<span class="hljs-string">"remap started. wait"</span>)<font></font>
    data.text = data.text.map(<span class="hljs-keyword">lambda</span> comment: get_category_from_comment(str(comment)))<font></font>
    print(<span class="hljs-string">"remap ends"</span>)<font></font>
<font></font>
    data.dropna(inplace=<span class="hljs-literal">True</span>)<font></font>
    data[<span class="hljs-string">"text"</span>] = data.text.map(<span class="hljs-keyword">lambda</span> s: <span class="hljs-string">""</span> <span class="hljs-keyword">if</span> s==<span class="hljs-string">""</span> <span class="hljs-keyword">else</span> s)<font></font>
    data[<span class="hljs-string">"text"</span>] = data.text.map(<span class="hljs-keyword">lambda</span> s: <span class="hljs-string">""</span> <span class="hljs-keyword">if</span> s==<span class="hljs-string">""</span> <span class="hljs-keyword">else</span> s)<font></font>
    data[<span class="hljs-string">"text"</span>] = data.text.map(<span class="hljs-keyword">lambda</span> s: <span class="hljs-string">" "</span> <span class="hljs-keyword">if</span> s==<span class="hljs-string">""</span> <span class="hljs-keyword">else</span> s)<font></font>
    data[<span class="hljs-string">"text"</span>] = data.text.map(<span class="hljs-keyword">lambda</span> s: <span class="hljs-string">" "</span> <span class="hljs-keyword">if</span> s==<span class="hljs-string">""</span> <span class="hljs-keyword">else</span> s)<font></font>
<font></font>
    <span class="hljs-keyword">return</span> data</code></pre><br>
</div></div><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ出力</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 これで、コントローラが指定された時間に最もありそうな場所を推測できます。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 特定の時間と曜日の結果のデータレコードを調べています。</font><font style="vertical-align: inherit;">たとえば、火曜日の午前9時：</font></font><br>
<br>
<pre><code class="python hljs">&lt;code&gt;data[(data[<span class="hljs-string">"day_in_week"</span>] == day) &amp; (data[<span class="hljs-string">"hour"</span>] == hour)]&lt;/code&gt;</code></pre><br>
<img src="https://habrastorage.org/webt/t4/gg/dg/t4ggdgmwezje8lgllisorbqrqwa.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これはすべてのデータではありません）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
その後、一意のストップの数を見つけ、ストップとその数のみを表示します。</font></font><br>
<br>
<pre><code class="python hljs">df[(df[<span class="hljs-string">"day_in_week"</span>] == <span class="hljs-number">2</span>) &amp; (df[<span class="hljs-string">"hour"</span>] == <span class="hljs-number">9</span>)][<span class="hljs-string">"text"</span>].value_counts()</code></pre><br>
<img src="https://habrastorage.org/webt/yq/az/if/yqazifl3gkclyqw4ifykvemsrky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、火曜日の午前9時になると、管理者は食肉加工工場の停留所で気づく可能性が高いと言えます。</font><font style="vertical-align: inherit;">Lugovaya、BelGUT、TD「オーマ」。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 この方法の主な欠点は、データの不足です。</font><font style="vertical-align: inherit;">すべての日と時間については、ラッシュアワー中に与えられたコメントにエントリがありますが、人々があまり人気のない時間のデータよりも公共交通機関を使用する場合、たとえば、1つのグループのコメントだけでなく、代替グループ、または電報チャットから、エントリの数ですべてが簡単になります。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VK LongPoll APIを備えたボット</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 時間に応じて、コンピューターに縛られることなく、コントローラーの場所に関するデータを受信する機会を与えるために、現在の時間と曜日を指定して、レコード内のストップの数を送信することによってメッセージに応答するVKontakteのグループ用のボットを作成しました。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ボットコード</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint
<span class="hljs-keyword">import</span> vk_api
<span class="hljs-keyword">from</span> requests <span class="hljs-keyword">import</span> *<font></font>
<font></font>
<span class="hljs-keyword">from</span> get_stops_from_data <span class="hljs-keyword">import</span> get_stops_by_time<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">start_bot</span>(<span class="hljs-params">data, token</span>):</span><font></font>
    vk_session = vk_api.VkApi(token=token)<font></font>
    vk = vk_session.get_api()<font></font>
    print(<span class="hljs-string">"bot started"</span>)<font></font>
    longPoll = vk.groups.getLongPollServer(group_id=<span class="hljs-number">183524419</span>)<font></font>
    server, key, ts = longPoll[<span class="hljs-string">'server'</span>], longPoll[<span class="hljs-string">'key'</span>], longPoll[<span class="hljs-string">'ts'</span>]
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        <span class="hljs-comment">#  :   ts</span>
        longPoll = post(<span class="hljs-string">'%s'</span> % server, data={<span class="hljs-string">'act'</span>: <span class="hljs-string">'a_check'</span>,
                                             <span class="hljs-string">'key'</span>: key,
                                             <span class="hljs-string">'ts'</span>: ts,
                                             <span class="hljs-string">'wait'</span>: <span class="hljs-number">25</span>}).json()
        <span class="hljs-keyword">if</span> longPoll[<span class="hljs-string">'updates'</span>] <span class="hljs-keyword">and</span> len(longPoll[<span class="hljs-string">'updates'</span>]) != <span class="hljs-number">0</span>:
            <span class="hljs-keyword">for</span> update <span class="hljs-keyword">in</span> longPoll[<span class="hljs-string">'updates'</span>]:
                <span class="hljs-keyword">if</span> update[<span class="hljs-string">'type'</span>] == <span class="hljs-string">'message_new'</span>:
                    <span class="hljs-comment">#       </span>
                    vk.messages.markAsRead(peer_id=update[<span class="hljs-string">'object'</span>][<span class="hljs-string">'user_id'</span>])<font></font>
                    user = update[<span class="hljs-string">'object'</span>][<span class="hljs-string">"user_id"</span>]<font></font>
                    text = get_stops_by_time(data)<font></font>
<font></font>
                    <span class="hljs-keyword">if</span> text <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> text == {}:<font></font>
                        message = <span class="hljs-string">"íåò çàïèñåé"</span>
                        vk.messages.send(user_id=user, random_id=randint(<span class="hljs-number">-2147483648</span>, <span class="hljs-number">2147483647</span>),<font></font>
                                         message=message)<font></font>
                        print(message)<font></font>
                        ts = longPoll[<span class="hljs-string">'ts'</span>]
                        <span class="hljs-keyword">continue</span><font></font>
<font></font>
                    message = <span class="hljs-string">"   -     \n"</span> \
                              <span class="hljs-string">"\n \n"</span>
                    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> text.items():<font></font>
                        message += i[<span class="hljs-number">0</span>] + <span class="hljs-string">"  "</span>
                        message += str(i[<span class="hljs-number">1</span>])<font></font>
                        message += <span class="hljs-string">"\n"</span>
                    <span class="hljs-comment">#                     </span>
                    vk.messages.send(user_id=user, random_id=randint(<span class="hljs-number">-2147483648</span>, <span class="hljs-number">2147483647</span>),<font></font>
                                     message=message)<font></font>
                    ts = longPoll[<span class="hljs-string">'ts'</span>]</code></pre><br>
</div></div><br>
 <h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 このような仮説の質は、実際に何度も私によってテストされており、すべてがうまく機能しています。</font><font style="vertical-align: inherit;">完全に正しい予測を出すことはできず、成功の確率は100％ではありませんが、基本的には、コントローラーは同じ停止位置にあることがわかりました。</font><font style="vertical-align: inherit;">レーベンシュタイン距離には、単語の誤りの修正から、遺伝子、染色体、タンパク質の比較まで、さまざまな用途がありますが、このような応用問題にも潜在的な可能性があります。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
よい一日をお過ごしください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのボットコードとデータ操作は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開されてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja478474/index.html">パブロ・エスコバー兄弟も柔軟なスマートフォンをリリースしました</a></li>
<li><a href="../ja478480/index.html">人工知能、ITSM、そして一般的に、LEANはどこにありますか？</a></li>
<li><a href="../ja478482/index.html">開発者は開発者向けにバーを開き、Angular、レイアウト、PHPに関するミーティングをホストします</a></li>
<li><a href="../ja478484/index.html">ラズベリーのSCADA：神話か現実か？</a></li>
<li><a href="../ja478486/index.html">10nmチップの時代-誰がそのようなプロセッサを開発し、将来業界に待ち受けているもの</a></li>
<li><a href="../ja478492/index.html">CO2ダイエット中の大腸菌：地球温暖化との戦いにおける新しいツール？</a></li>
<li><a href="../ja478494/index.html">Winnum TRP熱処理ソリューション：セットアップと使用</a></li>
<li><a href="../ja478496/index.html">50年前、部屋番号3420でインターネットが誕生</a></li>
<li><a href="../ja478498/index.html">1. Fortinet Getting Started v 6.0。前書き</a></li>
<li><a href="../ja478500/index.html">なぜ夏に会議が少ないのですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>