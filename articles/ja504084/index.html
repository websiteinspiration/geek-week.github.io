<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👴🏾 🙏🏿 🏌️ ホッパーでiOSのバグを探る 👨🏼‍🏭 👷🏻 ♣️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは！私の名前はAlexander Nikishinです。BadooでiOSアプリケーションを開発しています。この記事では、Appleが6か月間修正したくなかったUIKitのバグをどのように調査したかについて説明します。
 
 
 
 すべては2019年8月にiOS 13の最初のベータ版で始ま...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ホッパーでiOSのバグを探る</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/504084/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは！私の名前はAlexander Nikishinです。BadooでiOSアプリケーションを開発しています。この記事では、Appleが6か月間修正したくなかったUIKitのバグをどのように調査したかについて説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/mh/ea/tmmheaww_pwtz36zltfmiyqgadu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべては2019年8月にiOS 13の最初のベータ版で始まりました。その後、最初に問題が発生しました。 BadooおよびBumbleアプリケーションでは、常にインターフェイスの改善に取り組んでおり、たとえば、退屈で愛されていない登録プロセスを可能な限り最適化しようとしています。キーボードの上の体系的な予測ツールチップは、データを入力するときのユーザーのクリック数を減らすための優れた方法です。しかし、iOSの新しいバージョンでは、電話番号を入力するためのプロンプトが表示されなくなったことに驚きました。</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/qh/qe/tp/qhqetpwinu9_mvbd5gms1dyrvu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GMバージョンが出たとき、問題が修正されていないことに気づきました。そのような明らかなバグは、おそらくAppleが武器庫に持っていた回帰テストで見逃すことはできないように思われ、最初の大きなアップデートパッケージの修正を待ち始めました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の開発者は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">望んだ</font></a><font style="vertical-align: inherit;">。ただし、バージョン13.1のリリースでは何も変更されておらず、10月上旬にレーダーを開くしかありませんでした。時間が経つと、iOS 13.2と13.3が出てきて、バグはまだ修正されていません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2月に、私たちの登録チームはバックログの作業から自由な時間を得たので、この問題をもう少し詳しく調査することにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
掘り始める前に、どのようにそれを行うかを考えなければなりませんでした。ヒントが一部のタイプのキーボードで引き続き機能したため、最初の考えは、iOSのさまざまなバージョンでのビューの階層を調査することでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/mv/sw/px/mvswpxpjqpsfjh2bqdcn1vlz8sk.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iOS 12対iOS 13 iOS 13の</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Appleがキーボード実装をリファクタリングし、別のコントローラーでプロンプトを強調表示することがすぐに明らかになりました（</font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。明らかに、モジュール化と分解への傾向もそれに達しています（ちなみに、最近</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artyom Loenkoが</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちのアプリケーションの経験について</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">話しました</font></a><font style="vertical-align: inherit;">）。ほとんどの場合、これが原因で、機能の低下がありました。検索の輪は狭まり始めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどのiOS開発者は、パブリックドメインでプライベートシステムクラスのインターフェイスを見つけるのは簡単であることを知っていると思います。検索エンジンにクエリを1つ入力するだけです。</font><font style="vertical-align: inherit;">目の前の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスインターフェイスの</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査では</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、</font></a></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのメソッドの1つをキャッチしています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ex/vt/ry/exvtrycfpe8qra7wrgux5khrqka.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
古き良きツールの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スプーフィング実装関数</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Swizzling）</font><font style="vertical-align: inherit;">を使用して、非常に簡単に確認できる手掛かりがあったよう</font><font style="vertical-align: inherit;">です。これを使用して、「疑わしい」関数が常に真の値を返すようにします。</font></font><br>
<br>
<pre><code class="objectivec hljs">+(<span class="hljs-keyword">void</span>)swizzleIsVisibleForInputDelegate {<font></font>
    SEL targetSelector = sel_getUid(<span class="hljs-string">"isVisibleForInputDelegate:inputViews:"</span>);<font></font>
    Class targetClass = <span class="hljs-built_in">NSClassFromString</span>(@”<span class="hljs-built_in">UIPredictionViewController</span>”);
    <span class="hljs-keyword">if</span> (targetClass == <span class="hljs-literal">nil</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (![targetClass instancesRespondToSelector:targetSelector]) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    Method method = class_getInstanceMethod(targetClass, targetSelector);<font></font>
    <span class="hljs-keyword">if</span> (method == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
<font></font>
    IMP originalImplementation = method_getImplementation(method);<font></font>
    IMP newImp = imp_implementationWithBlock(^<span class="hljs-built_in">BOOL</span>(<span class="hljs-keyword">id</span> me, <span class="hljs-keyword">id</span> delegate, <span class="hljs-keyword">id</span> views) {
        <span class="hljs-comment">//   ,        . </span>
        <span class="hljs-built_in">BOOL</span> result = ((<span class="hljs-keyword">bool</span> (*)(<span class="hljs-keyword">id</span>,SEL,<span class="hljs-keyword">id</span>,<span class="hljs-keyword">id</span>))originalImplementation)(me, targetSelector, delegate, views);
        <span class="hljs-keyword">if</span> ([delegate isKindOfClass:[<span class="hljs-built_in">UITextField</span> <span class="hljs-keyword">class</span>]] &amp;&amp; [delegate keyboardType] == <span class="hljs-built_in">UIKeyboardTypePhonePad</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">YES</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> result;<font></font>
    });<font></font>
<font></font>
    method_setImplementation(method, newImp);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
テストプロジェクトを再起動すると、電話のプロンプトがiOS 13に戻り、「通常モード」で動作していることがわかりました。これにより、調査が終了する可能性があり、リリースアセンブリでこの危険で禁じられたAppleガイドラインソリューションを非常に慎重に使用して、一部のユーザーに対してリモートで有効/無効にすることができます（リモート機能管理のオプション</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">については</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、同僚のKaterina Trofimenkoの</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">レポートの記録を</font></a><font style="vertical-align: inherit;">見ることができます</font><font style="vertical-align: inherit;">）。それにもかかわらず、電話タイプのキーボードを使用しているときにこの関数がfalseを返す理由を不思議に思ったことはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実を言うと、関数のソースコードが必要です。明らかに、AppleはiOSコンポーネントコードを左右に配布していないため、グーグルすることはできません。残っている方法は1つだけです-バイナリコードを逆コンパイルするリバースエンジニアリングです。以前、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホッパー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの製品について</font><font style="vertical-align: inherit;">何回か</font><font style="vertical-align: inherit;">聞いたことがありますが</font><font style="vertical-align: inherit;">、システムライブラリの内部をより深く掘り下げるためにその使用についての記事をいくつか読んでいましたが、私自身はそれを使用していません。そしてすぐに私は嬉しいことに驚きました：遊んでツールを学ぶためには、フルバージョンを購入する必要さえないことがわかりました。デモ版には、インデックスを保存してバイナリファイルに変更を加えることができない、30分のエンドレスワークセッションが含まれています。つまり、実験用の優れたプラットフォームです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべて同じから</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開された</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プライベートインターフェイスで</font></font><code>UIPredictionViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、UIKitCoreフレームワークの一部を</font><font style="vertical-align: inherit;">見つけることができます</font><font style="vertical-align: inherit;">。あとは、それを見つけてホッパーにアップロードするだけです。バイナリフレームワークファイルはXcodeの奥にあります。たとえば、ここに必要なUIKitCoreへのフルパスを示します。</font></font><br>
<br>
<pre><code class="plaintext hljs">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Library/Developer/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/PrivateFrameworks/UIKitCore.framework/UIKitCore</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ホッパーでドラッグアンドドロップファイルを作成し、システムダイアログでアクションを確認して、インデックス作成が完了するのを待ちます（UIKitのような大きなフレームワークの場合、これには4〜6分かかります）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラムのインターフェースは非常に単純です。私の研究に必要な主要な要素のみを書きます。</font><font style="vertical-align: inherit;">インターフェースの左側のパネルには、コードがナビゲートされる検索行があります。</font><font style="vertical-align: inherit;">関心のあるクラスの名前を検索することで、関数をすぐに調査し、そのアセンブラコードをメインウィンドウで開きます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gi/qf/94/giqf94bvzg42e1zspxys3880gy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上部のタスクバーには、コード表示モードを切り替えるためのボタンがあります。</font><font style="vertical-align: inherit;">左から右へ：</font></font><br>
<br>
<img width="200" src="https://habrastorage.org/webt/ho/i-/ig/hoi-igmtwupaitvjpqolbwckmya.png"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASMモード-アセンブラコード;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CFGモード-ブロック図（ツリー）の形式のアセンブラーコード。コードの断片がブロックに結合され、遷移が分岐として表示されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">疑似コードモード-生成された疑似コード（以下で詳しく説明します）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16進モードは、バイナリファイル、またはabracadabraの16進数表現であり、これは私たちの研究ではあまり役に立ちません。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、関数内で何が起こるかを調べる必要があります。</font><font style="vertical-align: inherit;">彼女の体はかなり長いので、自分とは言えないASMグルだけが、アセンブラーのコードを見てロジックを理解できます。</font><font style="vertical-align: inherit;">これを行うには、疑似コードモードが役立ちます。ホッパーでは、可能な場合は実際の関数名を置き換え、変数などのレジスタ名を使用して、アセンブリ操作を可能な限り簡略化します。</font><font style="vertical-align: inherit;">これは次のよう</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ph/0w/cy/ph0wcy7eq21kozwiapjtw3mihuu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
になります。関数のロジックを</font><font style="vertical-align: inherit;">調べ</font><font style="vertical-align: inherit;">て、どのブランチに分類されるかを理解するだけです。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">シンボリックブレークポイント</font></a><font style="vertical-align: inherit;">がこれを助けてくれました。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、システムコールにインストールでき、必要なすべての変数と関数呼び出しの結果をXcodeコンソールに同時に出力します。この単純な方法を使用して、サンプルコードブ​​ロックでは条件の1つが機能しないため、関数の実行が早期終了によって中断されることがわかりました。ここで何が起こっているのかを理解しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
少しコンテキスト：rbxレジスタのコードの少し上（簡単にするために省略しました）は、プロトコルを実装するオブジェクトへのリンクです</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">UITextInputTraits_Private</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これはパブリックプロトコルの拡張バージョンです</font></font><code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">UITextInputTraits</a></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、最初の条件は、プロンプトが入力フィールドの構成によって非表示になっていないことを確認することです。デバッグでは、それが実行されていることがわかります：property</font></font><code>hidePrediction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falseを返します。 2番目の条件は、キーボードが「スプリット」モードになっていないことを確認することです（iPadでは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">右下のボタンを上に引き上げ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。このことを知っているユーザーは2〜3％だけです）。これでも、すべてが順調です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
進め。次の段階では、beginでの操作</font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、真実が近くにあることを示唆しています。最初に、現在の</font></font><code>keyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値が0xb（または10進形式では11）以下であることを確認します。 Xcode </font></font><code>UIKeyboardType</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">宣言を開くと、</font><font style="vertical-align: inherit;">13種類のキーボードがあり、そのうちの1つ（</font></font><code>UIKeyboardTypeAlphabet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）は推奨されておらず、別の型への参照として宣言されています。つまり、列挙型には12の型があります。0から開始すると、後者の値は11になります。つまり、コードはオーバーフローチェックの形式で値を検証し、再び成功します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、非常に奇妙な状態</font></font><code>if (!COND)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり、コード内でCOND変数が宣言されていないため、長い間、何がチェックされているのか理解できませんでした。さらに、私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンボリックブレークポイント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、この条件を満たすことができないと、関数が早期に終了することを示しました。そしてここでは、ASMモードに戻り、コードのこの部分をアセンブラー形式で研究する以外に選択肢はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASMリストでこの条件を見つけるには、「コード重複なし」オプションを使用できます。これにより、if-else条件付きのソースコードの形式ではなく、gotoの形式の遷移の一意のブロックの形式で疑似コードが表示されます。この場合、バイナリファイル内のこれらのブロックの先頭の位置を確認し、このポインターを使用してASMモードで検索します。したがって、対象のブロックがfe79f4にあることがわかりました。ASM </font></font><br>
<br>
<img src="https://habrastorage.org/webt/yu/ev/wk/yuevwkuqmhpb5ht5ds2l3mgiz1w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モードに戻ると、このブロックを簡単に見つけることができます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/g1/0e/u4/g10eu4epacglmci1utx7gpue_ii.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も難しい部分に</font><font style="vertical-align: inherit;">到達し</font><font style="vertical-align: inherit;">ます。ここでは、3行のアセンブラコードを解析します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は記憶の最初の行を認識しました（母国語のMIETでのアセンブラーレッスンのおかげで、ついに高等教育が便利になった瞬間が私の人生に来ました！）。ここではすべてが非常に単純です。定数0x930（バイナリ形式では100100110000）がecxレジスタに配置されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2行目には、</font></font><code>exc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">レジスタで実行されたbt命令が表示されています</font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。私たちがすでに知っている1つの値、2番目の値は、前のスクリーンショットで確認できます。- </font></font><code>rax = [rbx keyboardType]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在のキーボードタイプが含まれています。</font></font><code>rax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-これは64ビットレジスタ全体です。- </font></font><code>eax</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これは32ビット部分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データが決定したら、チームのロジックを理解する必要があります。グーグルは私たちを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この説明に</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">導き</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">：</font></font><br>
<blockquote>Selects the bit in a bit string (specified with the first operand, called the bit base) at the bit-position designated by the bit offset operand (second operand) and stores the value of the bit in the CF flag.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この命令は、第2オペランド（キーボードタイプ）で指定された位置にある第1オペランド（定数0x930）からビットを抽出し、CF（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャリーフラグ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に配置します。つまり、結果として、キーボードのタイプに応じて、CFには0または1が含まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、最後の操作に進んで</font></font><code>jb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それは以下の持っている、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明を</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：CF</font></font><br>
<br>
<code>Jump short if below (CF=1)</code> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
が1の場合、関数（早期終了）への移行があることを推測することは容易である</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。この時点で、パズルがアップ追加することから始まります。ビットマスク100100110000（使用可能なキーボードタイプの数に応じて12ビットが含まれています）があり、早期終了の条件を決定します。ここで、すべてのタイプのキーボードのヒントが利用できるかどうかを昇順で確認すると</font></font><code>rawValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべてが</font><font style="vertical-align: inherit;">揃っています</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/gm/xw/yjgmxwjm7pes1dooauar9gksqxm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
iOS 12では、そのようなロジックは見つかりません。そこにあるヒントは、どのタイプのキーボードでも機能します。 iOS 13ではAppleがデジタルキーボードのヒントをオフにすることを決めたのではないかと思います。これは原則として理解可能です。システムが数字を要求する必要があるシナリオを思い付くことができません。明らかに、誤って「ホットハンド」もヒットし</font></font><code>UIKeyboardTypePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。これは通常のテンキーに非常に似ています。同時に、</font></font><code>UIKeyboardTypeNamePhonePad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QWERTYキーボードを組み合わせて電話の連絡先とまったく同じ無効なデジタルキーパッドを検索し、プロンプトを表示し続けました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
驚いたことに、ホッパーとの仕事はとても楽しくて面白いことがわかりました。長い間、私はあまりファンを獲得していませんでした。</font><font style="vertical-align: inherit;">私はその発見をバグ報告でAppleのエンジニアと共有し、そのステータスは時間の経過とともに「潜在的な修正が特定されました-将来のOSアップデートのため」に変更されました。</font><font style="vertical-align: inherit;">この修正がユーザーに今後のアップデートで届くことを願っています。</font><font style="vertical-align: inherit;">同時に、ホッパーを使用して、またはAppleのバグの原因を見つけるだけでなく、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サードパーティのプログラム</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に対するAppleの修正を検出することもできます</font><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja504072/index.html">理想的なユーザー合意：開発者のリスクを最小限に抑える方法</a></li>
<li><a href="../ja504074/index.html">ガラスの悪夢：ハンフォード冷戦時代の核遺産の浄化</a></li>
<li><a href="../ja504076/index.html">ロシアのオープンソースは何ですか？</a></li>
<li><a href="../ja504078/index.html">2020年にHCIEエキスパート認定を取得する方法と理由</a></li>
<li><a href="../ja504080/index.html">AppleとGoogleの従業員が医療関係者がコロナウイルスを一緒に追跡するのをどのように支援するか</a></li>
<li><a href="../ja504088/index.html">高度なWindowsロギング。mimikatzを探しています</a></li>
<li><a href="../ja504092/index.html">最初にJavaScriptレコードとタプルを見てください</a></li>
<li><a href="../ja504098/index.html">Dipfakeビデオ1フレーム</a></li>
<li><a href="../ja504102/index.html">Python Functoolsの概要</a></li>
<li><a href="../ja504104/index.html">危機の際に会社のお金を節約して増やす方法：取引所を使用する3つの方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>