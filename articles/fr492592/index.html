<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👎🏽 👩🏽‍🤝‍👨🏾 👨‍🌾 Chargement différé à l'aide de l'API Intersection Observer 🛏️ 🔰 👨‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour mes amis! 
 
 Dans cet article, nous présenterons l'API Intersection Observer, un nouvel outil puissant pour charger paresseusement des images...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Chargement différé à l'aide de l'API Intersection Observer</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492592/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour mes amis! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, nous présenterons l'API Intersection Observer, un nouvel outil puissant pour charger paresseusement des images et d'autres éléments sur une page, pris en charge par tous les navigateurs modernes. </font><font style="vertical-align: inherit;">Nous pouvons utiliser cet outil pour contrôler la visibilité des éléments en définissant le chargement préliminaire ou différé de notre contenu DOM.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À mesure que le Web évolue, les navigateurs prennent en charge de plus en plus de nouvelles fonctionnalités et API, mais quelque chose blesse toujours les développeurs - le rendu DOM. Lorsque nous commençons à développer une nouvelle application, à créer des composants, à réfléchir à la structure HTML, à styliser les éléments avec CSS, nous pensons également au processus de rendu, à l'apparence générale de notre page et à d'autres choses importantes qui nécessitent une manipulation soigneuse et affectent rendu d'application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci, à son tour, affecte la façon dont nous créons nos éléments, comment notre CSS sera organisé, quelles bibliothèques et frameworks seront utilisés dans le projet, etc. C'est pourquoi le rendu est si important pour les développeurs.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'une des raisons de la popularité de la bibliothèque React dans la communauté des développeurs est le fait qu'elle utilise un DOM virtuel. Il s'agit essentiellement d'une représentation virtuelle du vrai DOM, que vous pouvez contrôler à votre guise. Après toutes les mises à jour, le DOM virtuel décide quelles modifications doivent être apportées au DOM d'origine, et effectue ces changements de manière "transparente"; il n'est pas nécessaire de rafraîchir la page entière lors de la modification d'un élément. C'est l'un des avantages les plus importants de React par rapport aux autres bibliothèques et frameworks. Le rendu DOM est une tâche coûteuse (en termes de performances) que React fait très bien sans aucun problème.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certaines bibliothèques et API nous permettent d'améliorer le rendu des éléments de nos applications. </font><font style="vertical-align: inherit;">Nous allons nous familiariser avec l'un d'eux - l'API Intersection Observer. </font><font style="vertical-align: inherit;">Mais d'abord, découvrons ce qu'est le chargement d'image «paresseux».</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment fonctionne le chargement d'images paresseuses?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le chargement différé est l'une des techniques de rendu du contenu de la page. Le concept de chargement «paresseux» est qu'au lieu de charger complètement la page, nous chargeons uniquement les parties nécessaires et reportons (retardons) le chargement des parties restantes jusqu'à ce que l'utilisateur en ait besoin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple de téléchargement "paresseux", dont vous avez probablement entendu parler ou que vous avez rencontré, est le défilement sans fin de la page. Cela fonctionne comme ceci: l'utilisateur visite la page, le contenu initial est chargé, et seulement après que l'utilisateur a fait défiler la page jusqu'à la fin, la partie suivante du contenu est chargée. Dans ce cas, il n'est pas nécessaire de télécharger tout le contenu à la fois, ce qui facilite grandement l'application.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si un téléchargement «paresseux» sert à télécharger uniquement du contenu «généré par l'utilisateur», comment s'appelle la technique inverse? Certains ont déjà entendu parler de chargement paresseux, mais n'ont pas entendu le contraire. Le contraire du chargement «paresseux» est le chargement «énergique» (les autres options sont impatientes, rapides) - lorsque tout le contenu est rendu immédiatement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Savez-vous qu'il existe des attributs HTML pour le chargement d'images paresseuses? Pour les utiliser, ajoutez simplement loading = "lazy" à l'élément "img" ou "iframe".</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wo/6v/hy/wo6vhy3y4zhzk3kk1edxmtsgmvu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant cette technique, nous obtenons de nombreux avantages: le chargement uniquement des ressources nécessaires réduit la consommation de mémoire et, finalement, le temps de chargement des pages. </font><font style="vertical-align: inherit;">Il empêche également le rendu du code "non réclamé", ce qui optimise l'application pour fonctionner dans des conditions de faible bande passante réseau. </font><font style="vertical-align: inherit;">Cependant, il y a quelques inconvénients: cela peut affecter le classement de la page par les moteurs de recherche. </font><font style="vertical-align: inherit;">De plus, il faut un certain temps pour choisir la bonne bibliothèque ou l'API avec laquelle travailler.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API Intersection Observer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JavaScript se développe si rapidement que nous obtenons une nouvelle API presque chaque année. L'objectif principal des nouvelles API est d'aider à créer des applications et des pages impressionnantes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intersection Observer est une API qui vous permet de surveiller la visibilité et la position des éléments DOM. Le fait est qu'il fonctionne de manière asynchrone, vous permettant de modifier en douceur (imperceptiblement) la visibilité des éléments, en déterminant le chargement préliminaire ou différé du contenu de notre DOM. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h7/yj/qj/h7yjqj1e_xj4luztht-s08hle1e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il y a quelques années, nous n'avions pas d'API ni d'autre outil pour positionner et suivre un élément. Nous avons dû écrire des fonctions folles et énormes, créer des méthodes coûteuses (en termes de performances) qui créaient plus de problèmes. En utilisant l'API Intersection Observer, nous pouvons faire des choses intéressantes comme:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Défilement de page sans fin - créez un défilement sans fin de tableaux, de listes, de conteneurs de grille, etc. </font><font style="vertical-align: inherit;">Cela n'a jamais été aussi facile.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Images - pourquoi télécharger toutes les images à la fois, alors que vous pouvez utiliser le téléchargement "paresseux" et afficher uniquement le contenu dont l'utilisateur a besoin en ce moment? </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surveillance des éléments - vous pouvez surveiller les éléments sur la page. </font><font style="vertical-align: inherit;">Par exemple, vous pouvez recevoir des messages sur la fermeture des publicités.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici où tout commence:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> myFirstObserver = <span class="hljs-keyword">new</span> IntersectionObserver(callback, options)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous initialisons le constructeur IntersectionObserver et lui passons deux paramètres. </font><font style="vertical-align: inherit;">Le premier paramètre est une fonction de rappel, qui est appelée en réponse à l'intersection de notre élément avec la fenêtre d'affichage (c'est-à-dire lorsque l'élément dépasse les limites de la fenêtre d'affichage) ou avec un autre élément. </font><font style="vertical-align: inherit;">Le paramètre options est un objet qui contrôle les conditions de lancement de la fonction de rappel. </font><font style="vertical-align: inherit;">Cet objet a les champs suivants:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root - l'élément parent qui sert de fenêtre d'affichage pour l'élément cible (pour l'élément que nous observons)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootMargin - la marge extérieure autour de l'élément racine (les valeurs de ce champ sont similaires aux valeurs de marge en CSS). </font><font style="vertical-align: inherit;">Ces valeurs peuvent changer pour chaque côté de la racine avant de valider l'intersection.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seuil - un nombre ou un tableau de nombres qui détermine le pourcentage d'intersection de l'élément cible avec l'élément racine, auquel la fonction de rappel est lancée </font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/sp/up/tk/spuptkzkbpv0m30sblumsls7cgy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetons un coup d'œil à l'utilisation de l'API Intersection Observer:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> options = {
    <span class="hljs-attr">root</span>: <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.scroll-list'</span>),
    <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'5px'</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.5</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">let</span> myFirstObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function"><span class="hljs-params">elements</span> =&gt;</span> { elements.forEach(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'element'</span>, element)) }, options)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer à "surveiller" un élément, vous devez déterminer la cible et appeler l'observateur à l'aide de la méthode "observer", en passant la cible comme paramètre:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">let</span> myDivTarget = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.header'</span>)<font></font>
<font></font>
observer.observe(myDivTarget)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il ne faut pas oublier que tous les éléments observés par l'observateur sont des rectangles. </font><font style="vertical-align: inherit;">Les éléments de forme irrégulière s'insèrent dans le plus petit rectangle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'en est-il de la prise en charge du navigateur? </font><font style="vertical-align: inherit;">L'API Intersection Observer est prise en charge par tous les navigateurs modernes tels que Chrome, Edge, Firefox et Opera. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pp/0g/vc/pp0gvc64xhmxpi8ehtktge53zic.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous avez l'intention de travailler avec beaucoup de données, par exemple, avec une table contenant beaucoup d'informations, l'API Intersection Observer vous sera extrêmement utile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'un des avantages de cette API est que pour résoudre ces problèmes, vous n'avez plus besoin d'utiliser de bibliothèque.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons étudié l'API Intersection Observer et son utilisation pour le chargement paresseux, l'observation de la position des éléments DOM, etc. </font><font style="vertical-align: inherit;">Les navigateurs prennent en charge de plus en plus d'API qui réduisent le temps de rendu des pages, principalement pour les utilisateurs ayant une connexion lente, réduisant la taille du projet et affichant uniquement le contenu pertinent. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la part d'un traducteur: l'article m'a semblé insuffisamment informatif, voici donc des liens vers de la littérature supplémentaire:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spécification</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article sur l'API Intersection Observer dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MDN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (russe)</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">CSS Tricks</font></a><font style="vertical-align: inherit;"> (anglais)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article avec des exemples sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envato</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (anglais)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de défilement sans fin de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Google</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">couple de </font><font style="vertical-align: inherit;">plus d' </font><font style="vertical-align: inherit;">exemples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur GitHub</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci de votre attention.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr492572/index.html">L'état actuel du monde Java: tendances et faits pour l'un des langages de programmation les plus populaires</a></li>
<li><a href="../fr492574/index.html">Réflexions sur la probabilité de décollage: Apple AirPods avec Momentum True Wireless 2</a></li>
<li><a href="../fr492580/index.html">Qu'ont en commun le coronavirus et les échecs?</a></li>
<li><a href="../fr492582/index.html">Cisco offre un accès à distance sécurisé</a></li>
<li><a href="../fr492590/index.html">Comment la synthèse vocale est apparue sur PC</a></li>
<li><a href="../fr492594/index.html">Localisation de jeux indépendants: le jeu en vaut-il la chandelle?</a></li>
<li><a href="../fr492596/index.html">L'espace comme base de données</a></li>
<li><a href="../fr492600/index.html">Guide semi-scientifique pour l'hébergement d'un routeur WiFi</a></li>
<li><a href="../fr492604/index.html">Utilisation de View de manière asynchrone à l'aide de coroutine</a></li>
<li><a href="../fr492606/index.html">Problèmes liés à la boîte à outils dans les grands projets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>