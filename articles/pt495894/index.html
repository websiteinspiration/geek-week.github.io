<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✊🏽 🏔️ ⛩️ Medição de desempenho Javascript 🙋🏽 🤸🏿 👁‍🗨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Medir o tempo necessário para executar uma função é uma boa maneira de provar que uma implementação de um mecanismo é mais produtiva que outra. Isso p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Medição de desempenho Javascript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495894/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medir o tempo necessário para executar uma função é uma boa maneira de provar que uma implementação de um mecanismo é mais produtiva que outra. Isso permite garantir que o desempenho da função não sofra após algumas alterações feitas no código. Também ajuda a procurar gargalos no desempenho do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se um projeto da web tiver alto desempenho, isso contribui para a percepção positiva dos usuários. E se os usuários gostaram de trabalhar com o recurso, eles têm a propriedade de retornar. Por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neste</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O estudo mostrou que 88% dos clientes on-line têm menos probabilidade de retornar aos recursos que encontram com qualquer inconveniente. Esses inconvenientes podem muito bem ser causados ​​por problemas de desempenho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É por isso que as ferramentas para ajudar a encontrar gargalos de desempenho e medir os resultados das melhorias feitas no código são importantes no desenvolvimento da Web. Essas ferramentas são especialmente relevantes no desenvolvimento do JavaScript. É importante saber que todas as linhas de código JavaScript podem potencialmente bloquear o DOM, pois o JavaScript é uma linguagem de thread único. </font><font style="vertical-align: inherit;">
Neste artigo, falarei sobre como medir o desempenho das funções e o que fazer com os resultados da medição.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/by/of/jl/byofjlhqvkjueyjzh-cyymte_qg.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você acha que alguns cálculos são muito pesados ​​para serem executados no encadeamento principal, pode decidir movê-los para um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalhador de serviço</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou trabalhador da Web.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Método Performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desempenho</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de interface </font><font style="vertical-align: inherit;">dá acesso a um valor do tipo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMHighResTimeStamp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> através de um método </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Este método retorna um registro de data e hora indicando o tempo em milissegundos decorrido desde que o documento começou a existir. </font><font style="vertical-align: inherit;">Além disso, a precisão desse indicador é de cerca de 5 microssegundos (frações de um milissegundo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para medir o desempenho de um fragmento de código usando o método </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, é necessário executar duas medições de tempo, salvar os resultados dessas medições em variáveis ​​e subtrair os resultados da primeira dos resultados da segunda medição:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> t0 = performance.now();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++)&nbsp;<font></font>
{<font></font>
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-keyword">const</span> t1 = performance.now();
<span class="hljs-built_in">console</span>.log(t1 - t0, <span class="hljs-string">'milliseconds'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Chrome, depois de executar esse código, você pode obter algo assim:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0.6350000001020817</span> <span class="hljs-string">"milliseconds"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox, assim:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">1</span> milliseconds
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, os resultados das medições obtidas em diferentes navegadores são muito diferentes. </font><font style="vertical-align: inherit;">O fato é que, no Firefox 60, a precisão dos resultados retornados pela API Performance é reduzida. </font><font style="vertical-align: inherit;">Falaremos mais sobre isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A interface Performance possui muito mais recursos do que apenas retornar um determinado carimbo de data / hora. </font><font style="vertical-align: inherit;">Estes incluem medir vários aspectos do desempenho representado por essas extensões desta interface como o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desempenho Timeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sincronismo de navegação</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempo do usuário</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sincronismo de recursos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui está o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> material para descobrir mais sobre essas APIs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, estamos falando em medir o desempenho de funções, portanto, temos oportunidades suficientes que o método oferece</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Date.now () e performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui você pode pensar que pode usar o método para medir o desempenho </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Isso é realmente possível, mas essa abordagem tem desvantagens. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O método </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorna o tempo em milissegundos decorrido desde a era Unix (1970-01-01T00: 00: 00Z) e depende do relógio do sistema. </font><font style="vertical-align: inherit;">Isso significa não apenas que esse método não é tão preciso quanto </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas que, ao contrário </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, retorna valores que, sob certas condições, podem ser baseados em indicadores de relógio incorretos. </font><font style="vertical-align: inherit;">Eis o que Rich Gentlekor, um programador relacionado ao mecanismo WebKit, diz: “Talvez os programadores tenham menos probabilidade de pensar que as leituras retornaram ao acessar</font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com base na hora do sistema, é absolutamente impossível chamar o ideal para monitorar aplicativos reais. </font><font style="vertical-align: inherit;">A maioria dos sistemas possui um daemon que sincroniza regularmente o tempo. </font><font style="vertical-align: inherit;">Ajustar o relógio do sistema por alguns milissegundos a cada 15 a 20 minutos é uma coisa comum. </font><font style="vertical-align: inherit;">Com essa frequência, os ajustes do relógio em cerca de 1% das medições de intervalos de 10 segundos serão imprecisos ".</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Método Console.time ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A medição do tempo usando esta API é extremamente simples. </font><font style="vertical-align: inherit;">Suficiente, antes do código cujo desempenho é preciso avaliar, chamar o método </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e após este código - o método </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nesse caso, um e os outros métodos precisam passar o mesmo argumento de string. </font><font style="vertical-align: inherit;">Em uma página, até 10.000 desses temporizadores podem ser usados ​​simultaneamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A precisão das medições de tempo feitas com esta API é a mesma que a API de desempenho, mas a precisão que será alcançada em cada situação específica depende do navegador.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de executar esse código, o sistema emitirá automaticamente informações sobre o tempo decorrido para o console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Chrome, será algo parecido com isto:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">0.766845703125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox, assim:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">2</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, tudo aqui é muito parecido com o que vimos enquanto trabalhamos </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A força do método </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é sua facilidade de uso. </font><font style="vertical-align: inherit;">Ou seja, estamos falando sobre o fato de sua aplicação não exigir a declaração de variáveis ​​auxiliares e encontrar a diferença entre os indicadores registrados nelas.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precisão de tempo reduzida</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você, usando as ferramentas descritas acima, mediu o desempenho do seu código em diferentes navegadores, pode prestar atenção ao fato de que os resultados da medição podem variar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A razão para isso é que os navegadores estão tentando proteger os usuários contra ataques com base no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e contra mecanismos de identificação do navegador ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impressão digital do navegador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Se os resultados da medição do tempo forem muito precisos, isso pode dar aos atacantes a oportunidade, por exemplo, de identificar usuários. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox 60, como já mencionado, a precisão dos resultados da medição de tempo é </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reduzida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Isso é feito configurando o </font></font><code>privacy.reduceTimerPrecision</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor </font><font style="vertical-align: inherit;">da propriedade </font><font style="vertical-align: inherit;">para 2 ms.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algo a ter em mente ao testar o desempenho</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora você tem ferramentas à sua disposição para medir o desempenho das funções JavaScript. </font><font style="vertical-align: inherit;">Mas antes de começar a trabalhar, você precisa considerar alguns dos recursos sobre os quais falaremos agora.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Divida e conquiste</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que, ao filtrar alguns dados, você preste atenção na operação lenta do aplicativo. Mas você não sabe exatamente onde está o gargalo de desempenho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez de especular sobre qual parte do código está sendo executada lentamente, seria melhor descobrir usando os métodos acima. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para ver a imagem geral do que está acontecendo, primeiro você precisa usar </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avaliar o desempenho do bloco de código, que, presumivelmente, tem um efeito ruim no desempenho. Então você precisa observar a velocidade das partes individuais desse bloco. Se um deles parecer visivelmente mais lento que os outros, você precisará prestar atenção especial a ele e como analisá-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto menos código houver entre as chamadas para métodos que medem o tempo, menor a probabilidade de que algo que não seja relevante para a situação do problema seja medido.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍Tenha em consideração as características do comportamento das funções com diferentes valores de entrada</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em aplicações reais, os dados recebidos na entrada de uma função específica podem ser muito diferentes. </font><font style="vertical-align: inherit;">Se você medir o desempenho de uma função que recebeu um conjunto de dados selecionado aleatoriamente, isso não fornecerá informações valiosas que possam esclarecer o que está acontecendo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As funções ao pesquisar desempenho precisam ser chamadas com dados de entrada que se assemelhem aos reais, tanto quanto possível.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Executar funções várias vezes</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que você tenha uma função que itere sobre uma matriz. </font><font style="vertical-align: inherit;">Ela realiza alguns cálculos usando cada elemento da matriz e, em seguida, retorna uma nova matriz com os resultados dos cálculos. </font><font style="vertical-align: inherit;">Pensando em otimizar essa função, você quer saber o que funciona mais rapidamente na sua situação - um loop </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou um loop regular </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui estão duas opções para esse recurso:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testForEach</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-forEach'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];<font></font>
&nbsp;&nbsp;x.forEach(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(value / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;});<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-forEach'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testFor</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-for'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];
&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; x.length; i ++) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(x[i] / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-for'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teste as funções:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> x = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">100000</span>).fill(<span class="hljs-built_in">Math</span>.random());<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de executar o código, obtemos os seguintes resultados:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">27</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O ciclo parecia </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser muito mais lento que o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Afinal, os resultados dos testes indicam exatamente isso? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, após um único teste, é muito cedo para tirar essas conclusões. </font><font style="vertical-align: inherit;">Vamos tentar chamar as funções duas vezes:</font></font><br>
<br>
<pre><code class="javascript hljs">testForEach(x);<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos o seguinte:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">13</span>ms - timer ended<font></font>
test-forEach: <span class="hljs-number">2</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">1</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que a função em que é usada </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, chamada segunda vez, é tão rápida quanto a função em que é usada </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mas, como a primeira </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">função é chamada, a função funciona muito mais devagar, mas pode não valer a pena usá-la.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desempenho de teste em diferentes navegadores</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os testes acima foram realizados no Firefox. </font><font style="vertical-align: inherit;">Mas e se você executá-los no Chrome? </font><font style="vertical-align: inherit;">Os resultados serão completamente diferentes:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">6.156005859375</span>ms<font></font>
test-forEach: <span class="hljs-number">8.01416015625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.371337890625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.31298828125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O fato é que os navegadores Chrome e Firefox são baseados em diferentes mecanismos JavaScript que implementam diferentes otimizações de desempenho. </font><font style="vertical-align: inherit;">É muito útil conhecer essas diferenças. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o Firefox tem uma otimização melhor </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com entradas semelhantes. </font><font style="vertical-align: inherit;">E o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é mais rápido do que </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no Chrome e no Firefox. </font><font style="vertical-align: inherit;">Como resultado, provavelmente é melhor insistir na variante da função c </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este é um bom exemplo, demonstrando a importância de medir o desempenho em diferentes navegadores. </font><font style="vertical-align: inherit;">Se você avaliar o desempenho de algum código apenas no Chrome, poderá concluir que o ciclo </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em comparação com o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, não é tão ruim.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Aplicar limites artificiais aos recursos do sistema</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os valores obtidos em nossas experiências não parecem particularmente grandes. </font><font style="vertical-align: inherit;">Mas lembre-se de que os computadores usados ​​para desenvolvimento geralmente são muito mais rápidos do que, digamos, o telefone celular comum no qual navegam na web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para se colocar no lugar de um usuário que não possui o dispositivo mais rápido, use os recursos do navegador para limitar artificialmente os recursos do sistema. </font><font style="vertical-align: inherit;">Por exemplo - para reduzir o desempenho do processador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com essa abordagem, 10 ou 50 milissegundos podem facilmente se transformar em 500.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">▍ Medir o desempenho relativo</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As medições de desempenho geralmente dependem não apenas do hardware, mas também da carga atual do processador e da carga de trabalho do encadeamento principal do aplicativo JavaScript. </font><font style="vertical-align: inherit;">Portanto, tente confiar em indicadores relativos que caracterizam a mudança no desempenho, pois os indicadores absolutos obtidos ao analisar o mesmo fragmento de código em momentos diferentes podem variar bastante.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumário</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, vimos algumas APIs JavaScript projetadas para medir o desempenho. </font><font style="vertical-align: inherit;">Nós conversamos sobre como usá-los para analisar o código real. </font><font style="vertical-align: inherit;">Acredito que, para realizar algumas medições simples, é mais fácil de usar </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenho a sensação de que muitos desenvolvedores de front-end não prestam atenção suficiente para medir o desempenho de seus projetos. </font><font style="vertical-align: inherit;">E eles devem monitorar constantemente os indicadores relevantes, pois a produtividade afeta o sucesso e a lucratividade dos projetos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queridos leitores! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você monitorar constantemente o desempenho de seus projetos, diga-nos como fazê-lo.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495858/index.html">Remoto e auto-isolamento: experiência espacial para ajudar os terráqueos</a></li>
<li><a href="../pt495884/index.html">Previsão de séries temporais usando redes neurais recorrentes</a></li>
<li><a href="../pt495888/index.html">A PyCon Russia abriu o CFP para futuros palestrantes. Formulários de participação e tópicos esperados</a></li>
<li><a href="../pt495890/index.html">Configurando um pacote Nginx / LetsEncrypt no Docker Swarm</a></li>
<li><a href="../pt495892/index.html">Você realmente sabe o que são matrizes?</a></li>
<li><a href="../pt495896/index.html">Pacote Use-Sound: Efeitos sonoros em aplicativos React</a></li>
<li><a href="../pt495898/index.html">Um guia prático para lidar com vazamentos de memória no Node.js</a></li>
<li><a href="../pt495902/index.html">CAPTCHA: matando a conversão</a></li>
<li><a href="../pt495904/index.html">Uma epidemia pode ser prevista?</a></li>
<li><a href="../pt495908/index.html">O caminho para a recompensa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>