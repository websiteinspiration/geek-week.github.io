<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úäüèΩ üèîÔ∏è ‚õ©Ô∏è Medi√ß√£o de desempenho Javascript üôãüèΩ ü§∏üèø üëÅ‚Äçüó®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Medir o tempo necess√°rio para executar uma fun√ß√£o √© uma boa maneira de provar que uma implementa√ß√£o de um mecanismo √© mais produtiva que outra. Isso p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Medi√ß√£o de desempenho Javascript</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/495894/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Medir o tempo necess√°rio para executar uma fun√ß√£o √© uma boa maneira de provar que uma implementa√ß√£o de um mecanismo √© mais produtiva que outra. Isso permite garantir que o desempenho da fun√ß√£o n√£o sofra ap√≥s algumas altera√ß√µes feitas no c√≥digo. Tamb√©m ajuda a procurar gargalos no desempenho do aplicativo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se um projeto da web tiver alto desempenho, isso contribui para a percep√ß√£o positiva dos usu√°rios. E se os usu√°rios gostaram de trabalhar com o recurso, eles t√™m a propriedade de retornar. Por exemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">neste</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O estudo mostrou que 88% dos clientes on-line t√™m menos probabilidade de retornar aos recursos que encontram com qualquer inconveniente. Esses inconvenientes podem muito bem ser causados ‚Äã‚Äãpor problemas de desempenho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â por isso que as ferramentas para ajudar a encontrar gargalos de desempenho e medir os resultados das melhorias feitas no c√≥digo s√£o importantes no desenvolvimento da Web. Essas ferramentas s√£o especialmente relevantes no desenvolvimento do JavaScript. √â importante saber que todas as linhas de c√≥digo JavaScript podem potencialmente bloquear o DOM, pois o JavaScript √© uma linguagem de thread √∫nico. </font><font style="vertical-align: inherit;">
Neste artigo, falarei sobre como medir o desempenho das fun√ß√µes e o que fazer com os resultados da medi√ß√£o.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/by/of/jl/byofjlhqvkjueyjzh-cyymte_qg.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ acha que alguns c√°lculos s√£o muito pesados ‚Äã‚Äãpara serem executados no encadeamento principal, pode decidir mov√™-los para um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalhador de servi√ßo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou trabalhador da Web.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todo Performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desempenho</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de interface </font><font style="vertical-align: inherit;">d√° acesso a um valor do tipo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOMHighResTimeStamp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atrav√©s de um m√©todo </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Este m√©todo retorna um registro de data e hora indicando o tempo em milissegundos decorrido desde que o documento come√ßou a existir. </font><font style="vertical-align: inherit;">Al√©m disso, a precis√£o desse indicador √© de cerca de 5 microssegundos (fra√ß√µes de um milissegundo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para medir o desempenho de um fragmento de c√≥digo usando o m√©todo </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, √© necess√°rio executar duas medi√ß√µes de tempo, salvar os resultados dessas medi√ß√µes em vari√°veis ‚Äã‚Äãe subtrair os resultados da primeira dos resultados da segunda medi√ß√£o:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> t0 = performance.now();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++)&nbsp;<font></font>
{<font></font>
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-keyword">const</span> t1 = performance.now();
<span class="hljs-built_in">console</span>.log(t1 - t0, <span class="hljs-string">'milliseconds'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Chrome, depois de executar esse c√≥digo, voc√™ pode obter algo assim:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">0.6350000001020817</span> <span class="hljs-string">"milliseconds"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox, assim:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-number">1</span> milliseconds
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode ver, os resultados das medi√ß√µes obtidas em diferentes navegadores s√£o muito diferentes. </font><font style="vertical-align: inherit;">O fato √© que, no Firefox 60, a precis√£o dos resultados retornados pela API Performance √© reduzida. </font><font style="vertical-align: inherit;">Falaremos mais sobre isso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A interface Performance possui muito mais recursos do que apenas retornar um determinado carimbo de data / hora. </font><font style="vertical-align: inherit;">Estes incluem medir v√°rios aspectos do desempenho representado por essas extens√µes desta interface como o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desempenho Timeline</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sincronismo de navega√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempo do usu√°rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sincronismo de recursos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqui est√° o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> material para descobrir mais sobre essas APIs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No nosso caso, estamos falando em medir o desempenho de fun√ß√µes, portanto, temos oportunidades suficientes que o m√©todo oferece</font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Date.now () e performance.now ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui voc√™ pode pensar que pode usar o m√©todo para medir o desempenho </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Isso √© realmente poss√≠vel, mas essa abordagem tem desvantagens. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O m√©todo </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorna o tempo em milissegundos decorrido desde a era Unix (1970-01-01T00: 00: 00Z) e depende do rel√≥gio do sistema. </font><font style="vertical-align: inherit;">Isso significa n√£o apenas que esse m√©todo n√£o √© t√£o preciso quanto </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas que, ao contr√°rio </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, retorna valores que, sob certas condi√ß√µes, podem ser baseados em indicadores de rel√≥gio incorretos. </font><font style="vertical-align: inherit;">Eis o que Rich Gentlekor, um programador relacionado ao mecanismo WebKit, diz: ‚ÄúTalvez os programadores tenham menos probabilidade de pensar que as leituras retornaram ao acessar</font></font><code>Date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com base na hora do sistema, √© absolutamente imposs√≠vel chamar o ideal para monitorar aplicativos reais. </font><font style="vertical-align: inherit;">A maioria dos sistemas possui um daemon que sincroniza regularmente o tempo. </font><font style="vertical-align: inherit;">Ajustar o rel√≥gio do sistema por alguns milissegundos a cada 15 a 20 minutos √© uma coisa comum. </font><font style="vertical-align: inherit;">Com essa frequ√™ncia, os ajustes do rel√≥gio em cerca de 1% das medi√ß√µes de intervalos de 10 segundos ser√£o imprecisos ".</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todo Console.time ()</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A medi√ß√£o do tempo usando esta API √© extremamente simples. </font><font style="vertical-align: inherit;">Suficiente, antes do c√≥digo cujo desempenho √© preciso avaliar, chamar o m√©todo </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e ap√≥s este c√≥digo - o m√©todo </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nesse caso, um e os outros m√©todos precisam passar o mesmo argumento de string. </font><font style="vertical-align: inherit;">Em uma p√°gina, at√© 10.000 desses temporizadores podem ser usados ‚Äã‚Äãsimultaneamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A precis√£o das medi√ß√µes de tempo feitas com esta API √© a mesma que a API de desempenho, mas a precis√£o que ser√° alcan√ßada em cada situa√ß√£o espec√≠fica depende do navegador.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; array.length; i++) {
&nbsp;&nbsp;<span class="hljs-comment">// - </span><font></font>
}<font></font>
<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test'</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de executar esse c√≥digo, o sistema emitir√° automaticamente informa√ß√µes sobre o tempo decorrido para o console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Chrome, ser√° algo parecido com isto:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">0.766845703125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox, assim:</font></font><br>
<br>
<pre><code class="javascript hljs">test: <span class="hljs-number">2</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, tudo aqui √© muito parecido com o que vimos enquanto trabalhamos </font></font><code>performance.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A for√ßa do m√©todo </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© sua facilidade de uso. </font><font style="vertical-align: inherit;">Ou seja, estamos falando sobre o fato de sua aplica√ß√£o n√£o exigir a declara√ß√£o de vari√°veis ‚Äã‚Äãauxiliares e encontrar a diferen√ßa entre os indicadores registrados nelas.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precis√£o de tempo reduzida</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™, usando as ferramentas descritas acima, mediu o desempenho do seu c√≥digo em diferentes navegadores, pode prestar aten√ß√£o ao fato de que os resultados da medi√ß√£o podem variar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A raz√£o para isso √© que os navegadores est√£o tentando proteger os usu√°rios contra ataques com base no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tempo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e contra mecanismos de identifica√ß√£o do navegador ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impress√£o digital do navegador</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Se os resultados da medi√ß√£o do tempo forem muito precisos, isso pode dar aos atacantes a oportunidade, por exemplo, de identificar usu√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No Firefox 60, como j√° mencionado, a precis√£o dos resultados da medi√ß√£o de tempo √© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reduzida</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Isso √© feito configurando o </font></font><code>privacy.reduceTimerPrecision</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valor </font><font style="vertical-align: inherit;">da propriedade </font><font style="vertical-align: inherit;">para 2 ms.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algo a ter em mente ao testar o desempenho</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora voc√™ tem ferramentas √† sua disposi√ß√£o para medir o desempenho das fun√ß√µes JavaScript. </font><font style="vertical-align: inherit;">Mas antes de come√ßar a trabalhar, voc√™ precisa considerar alguns dos recursos sobre os quais falaremos agora.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Divida e conquiste</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que, ao filtrar alguns dados, voc√™ preste aten√ß√£o na opera√ß√£o lenta do aplicativo. Mas voc√™ n√£o sabe exatamente onde est√° o gargalo de desempenho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em vez de especular sobre qual parte do c√≥digo est√° sendo executada lentamente, seria melhor descobrir usando os m√©todos acima. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para ver a imagem geral do que est√° acontecendo, primeiro voc√™ precisa usar </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>console.timeEnd()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avaliar o desempenho do bloco de c√≥digo, que, presumivelmente, tem um efeito ruim no desempenho. Ent√£o voc√™ precisa observar a velocidade das partes individuais desse bloco. Se um deles parecer visivelmente mais lento que os outros, voc√™ precisar√° prestar aten√ß√£o especial a ele e como analis√°-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto menos c√≥digo houver entre as chamadas para m√©todos que medem o tempo, menor a probabilidade de que algo que n√£o seja relevante para a situa√ß√£o do problema seja medido.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñçTenha em considera√ß√£o as caracter√≠sticas do comportamento das fun√ß√µes com diferentes valores de entrada</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em aplica√ß√µes reais, os dados recebidos na entrada de uma fun√ß√£o espec√≠fica podem ser muito diferentes. </font><font style="vertical-align: inherit;">Se voc√™ medir o desempenho de uma fun√ß√£o que recebeu um conjunto de dados selecionado aleatoriamente, isso n√£o fornecer√° informa√ß√µes valiosas que possam esclarecer o que est√° acontecendo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As fun√ß√µes ao pesquisar desempenho precisam ser chamadas com dados de entrada que se assemelhem aos reais, tanto quanto poss√≠vel.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Executar fun√ß√µes v√°rias vezes</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suponha que voc√™ tenha uma fun√ß√£o que itere sobre uma matriz. </font><font style="vertical-align: inherit;">Ela realiza alguns c√°lculos usando cada elemento da matriz e, em seguida, retorna uma nova matriz com os resultados dos c√°lculos. </font><font style="vertical-align: inherit;">Pensando em otimizar essa fun√ß√£o, voc√™ quer saber o que funciona mais rapidamente na sua situa√ß√£o - um loop </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou um loop regular </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√£o duas op√ß√µes para esse recurso:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testForEach</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-forEach'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];<font></font>
&nbsp;&nbsp;x.forEach(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(value / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;});<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-forEach'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testFor</span>(<span class="hljs-params">x</span>) </span>{
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.time(<span class="hljs-string">'test-for'</span>);
&nbsp;&nbsp;<span class="hljs-keyword">const</span> res = [];
&nbsp;&nbsp;<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; x.length; i ++) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.push(x[i] / <span class="hljs-number">1.2</span> * <span class="hljs-number">0.1</span>);<font></font>
&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">'test-for'</span>)
&nbsp;&nbsp;<span class="hljs-keyword">return</span> res;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teste as fun√ß√µes:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> x = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">100000</span>).fill(<span class="hljs-built_in">Math</span>.random());<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de executar o c√≥digo, obtemos os seguintes resultados:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">27</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O ciclo parecia </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser muito mais lento que o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Afinal, os resultados dos testes indicam exatamente isso? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, ap√≥s um √∫nico teste, √© muito cedo para tirar essas conclus√µes. </font><font style="vertical-align: inherit;">Vamos tentar chamar as fun√ß√µes duas vezes:</font></font><br>
<br>
<pre><code class="javascript hljs">testForEach(x);<font></font>
testForEach(x);<font></font>
testFor(x);<font></font>
testFor(x);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos o seguinte:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">13</span>ms - timer ended<font></font>
test-forEach: <span class="hljs-number">2</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">1</span>ms - timer ended<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">3</span>ms - timer ended
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que a fun√ß√£o em que √© usada </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, chamada segunda vez, √© t√£o r√°pida quanto a fun√ß√£o em que √© usada </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mas, como a primeira </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√£o √© chamada, a fun√ß√£o funciona muito mais devagar, mas pode n√£o valer a pena us√°-la.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desempenho de teste em diferentes navegadores</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os testes acima foram realizados no Firefox. </font><font style="vertical-align: inherit;">Mas e se voc√™ execut√°-los no Chrome? </font><font style="vertical-align: inherit;">Os resultados ser√£o completamente diferentes:</font></font><br>
<br>
<pre><code class="javascript hljs">test-forEach: <span class="hljs-number">6.156005859375</span>ms<font></font>
test-forEach: <span class="hljs-number">8.01416015625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.371337890625</span>ms<font></font>
test-<span class="hljs-keyword">for</span>: <span class="hljs-number">4.31298828125</span>ms
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O fato √© que os navegadores Chrome e Firefox s√£o baseados em diferentes mecanismos JavaScript que implementam diferentes otimiza√ß√µes de desempenho. </font><font style="vertical-align: inherit;">√â muito √∫til conhecer essas diferen√ßas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o Firefox tem uma otimiza√ß√£o melhor </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com entradas semelhantes. </font><font style="vertical-align: inherit;">E o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© mais r√°pido do que </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no Chrome e no Firefox. </font><font style="vertical-align: inherit;">Como resultado, provavelmente √© melhor insistir na variante da fun√ß√£o c </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um bom exemplo, demonstrando a import√¢ncia de medir o desempenho em diferentes navegadores. </font><font style="vertical-align: inherit;">Se voc√™ avaliar o desempenho de algum c√≥digo apenas no Chrome, poder√° concluir que o ciclo </font></font><code>forEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, em compara√ß√£o com o ciclo </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n√£o √© t√£o ruim.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Aplicar limites artificiais aos recursos do sistema</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os valores obtidos em nossas experi√™ncias n√£o parecem particularmente grandes. </font><font style="vertical-align: inherit;">Mas lembre-se de que os computadores usados ‚Äã‚Äãpara desenvolvimento geralmente s√£o muito mais r√°pidos do que, digamos, o telefone celular comum no qual navegam na web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para se colocar no lugar de um usu√°rio que n√£o possui o dispositivo mais r√°pido, use os recursos do navegador para limitar artificialmente os recursos do sistema. </font><font style="vertical-align: inherit;">Por exemplo - para reduzir o desempenho do processador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com essa abordagem, 10 ou 50 milissegundos podem facilmente se transformar em 500.</font></font><br>
<br>
<h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ñç Medir o desempenho relativo</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As medi√ß√µes de desempenho geralmente dependem n√£o apenas do hardware, mas tamb√©m da carga atual do processador e da carga de trabalho do encadeamento principal do aplicativo JavaScript. </font><font style="vertical-align: inherit;">Portanto, tente confiar em indicadores relativos que caracterizam a mudan√ßa no desempenho, pois os indicadores absolutos obtidos ao analisar o mesmo fragmento de c√≥digo em momentos diferentes podem variar bastante.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, vimos algumas APIs JavaScript projetadas para medir o desempenho. </font><font style="vertical-align: inherit;">N√≥s conversamos sobre como us√°-los para analisar o c√≥digo real. </font><font style="vertical-align: inherit;">Acredito que, para realizar algumas medi√ß√µes simples, √© mais f√°cil de usar </font></font><code>console.time()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenho a sensa√ß√£o de que muitos desenvolvedores de front-end n√£o prestam aten√ß√£o suficiente para medir o desempenho de seus projetos. </font><font style="vertical-align: inherit;">E eles devem monitorar constantemente os indicadores relevantes, pois a produtividade afeta o sucesso e a lucratividade dos projetos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queridos leitores! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ monitorar constantemente o desempenho de seus projetos, diga-nos como faz√™-lo.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495858/index.html">Remoto e auto-isolamento: experi√™ncia espacial para ajudar os terr√°queos</a></li>
<li><a href="../pt495884/index.html">Previs√£o de s√©ries temporais usando redes neurais recorrentes</a></li>
<li><a href="../pt495888/index.html">A PyCon Russia abriu o CFP para futuros palestrantes. Formul√°rios de participa√ß√£o e t√≥picos esperados</a></li>
<li><a href="../pt495890/index.html">Configurando um pacote Nginx / LetsEncrypt no Docker Swarm</a></li>
<li><a href="../pt495892/index.html">Voc√™ realmente sabe o que s√£o matrizes?</a></li>
<li><a href="../pt495896/index.html">Pacote Use-Sound: Efeitos sonoros em aplicativos React</a></li>
<li><a href="../pt495898/index.html">Um guia pr√°tico para lidar com vazamentos de mem√≥ria no Node.js</a></li>
<li><a href="../pt495902/index.html">CAPTCHA: matando a convers√£o</a></li>
<li><a href="../pt495904/index.html">Uma epidemia pode ser prevista?</a></li>
<li><a href="../pt495908/index.html">O caminho para a recompensa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>