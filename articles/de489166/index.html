<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>◼️ 👭 🏆 Informationen zum Betrieb eines PCs am Beispiel von Windows 10 und der Tastatur von Teil 2 🧝🏾 ⛩️ 🥊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Teil werden wir überlegen, in welche Richtung die Informationen über die gedrückte Taste von der Tastatur zur CPU gelangen. Es werden viele ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Informationen zum Betrieb eines PCs am Beispiel von Windows 10 und der Tastatur von Teil 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489166/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Teil werden wir überlegen, in welche Richtung die Informationen über die gedrückte Taste von der Tastatur zur CPU gelangen. Es werden viele Bilder angezeigt, und dies ist nicht der letzte Teil. Ich werde darüber aus der Sicht eines Programmierers sprechen, der im Benutzermodus schreibt - Benutzerprogramme, Web, mobile Anwendungen - daher kann es zu Ungenauigkeiten kommen. Es ist unwahrscheinlich, dass Menschen, die mit Elektronik zu tun haben, etwas Nützliches für sich finden. Der erste Teil ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wl/me/mo/wlmemoyr_plutwlcq7nhezslr78.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Problem der Hochschulausbildung von Programmierern besteht darin, dass die Schüler einzelne Aspekte, die aus dem Zusammenhang gerissen wurden, detailliert untersuchen, ohne zu verstehen, wie dies alles zusammenpasst. Mehrere Semester höherer Mathematik, um Physik zu verstehen, um Elektrotechnik, Elektrogeräte, Assembler, Betriebssystem, Algorithmen, Systemprogrammierung und eine Reihe anderer Fächer zu verstehen, die in einem Standard-Fünfjahresprogramm zusammengefasst sind. Die Fülle an Details und niemand erklärt, wie dies in das Gesamtbild passt. Es wird davon ausgegangen, dass der Schüler es nach 5 Jahren selbst in seinen Kopf bindet und dann mit .Net arbeitet und niemals den Elektronik- und Kernel-Modus berührt. Ich glaube, dass es nicht notwendig ist, so detailliert über den Betrieb eines Computers Bescheid zu wissen. Es reicht aus, ein allgemeines Verständnis dafür zu haben, was auf dem technologischen Stapel geschieht. Wenn die Personen, aus denen die Ausbildungsprogramme für Universitäten bestehen, Fahrschulen eröffnen,Sie würden Russisch, Kalligraphie und Hydrodynamik lernen, weil Sie mit Inspektoren kommunizieren, Flüssigkeiten wechseln und Erläuterungen schreiben müssen. Der Artikel enthält einige Ungenauigkeiten, sodass er nicht zum Bestehen der Prüfung in speziellen Fächern geeignet ist. Danach ist das PC-Gerät leichter zu verstehen.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unter Katzenverkehr.</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Tastaturtaste ist eine Taste, die die Kontakte schließt und durch die elektrischer Strom fließt. </font><font style="vertical-align: inherit;">Der Mechanismus zum Schließen / Öffnen ist so ausgeführt, dass der Knopf nicht vollständig gedrückt werden muss, da sonst die Finger schnell müde werden und die Tastatur nicht ergonomisch ist. </font><font style="vertical-align: inherit;">Im Abschnitt sieht der Schlüssel so aus. </font><font style="vertical-align: inherit;">Auf der rechten Seite befindet sich der Kontakt, an den die Spannung angelegt wird.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/g5/c1/ay/g5c1aykcd7h6pbxwih_ci_dcsk0.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das „Gehirn“ der Tastatur, das den Tastenanschlag bestimmen kann, ist ein </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrocontroller</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bei dem es sich im Wesentlichen um einen Mini-Computer handelt, dessen Programm jede Taste durch Anlegen einer Spannung überprüft. Wenn sie übergeben wird, wird die Taste gedrückt. Die Beine des Mikrocontrollers haben ihre eigenen Namen und können im Code abgerufen werden. Sie dienen zur Kommunikation mit der Außenwelt. Die Beine können den Betrieb des Mikrocontrollers steuern, den Status des Chips melden oder zum Lesen / Übertragen von Daten dienen.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/ek/uq/om/ekuqom94exvedvmbel6ky6botvm.png"></td>
<td><img src="https://habrastorage.org/webt/mb/wm/14/mbwm14xm-h71gr7plnv5oglrhak.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Programm ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) kann in C oder Assembler geschrieben werden, es wird über den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmierer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf den Mikrocontroller hochgeladen </font><font style="vertical-align: inherit;">. Es ist ein Gerät mit einem Anschluss zum Installieren eines Mikrocontrollers und kann über USB an einen Computer angeschlossen werden, auf dem spezielle Software ausgeführt wird. So sieht der Programmierer im wirklichen Leben aus:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/4q/qz/ut/4qqzutlhi4hlltp4ubcclyv2rtu.png"></td>
<td><img src="https://habrastorage.org/webt/hy/ex/xj/hyexxj5ezr-gkg4jva6rerfkbnw.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durch das Programm kann jeder Zweig eingestellt oder die Spannung gemessen werden. </font><font style="vertical-align: inherit;">Der Algorithmus zum Finden der gedrückten Taste besteht darin, Spannung an einen Zweig anzulegen und auf dem anderen zu messen. Wenn die Taste gedrückt wurde, hat der zweite Zweig ungefähr die gleiche Spannung wie der Eingang. </font><font style="vertical-align: inherit;">In einer Endlosschleife werden also alle Tasten überprüft. </font><font style="vertical-align: inherit;">In der Regel verfügt die Tastatur über 80-110 Tasten und der Kontaktcontroller (Pins) ist viel kleiner. </font><font style="vertical-align: inherit;">Daher verwenden sie einen solchen Ansatz wie die „Tastaturmatrix“ - alle Tasten sind in Spalten und Zeilen verteilt, und der Algorithmus ist darauf reduziert, eine Spalte zu finden, die die Zeile schneidet, an die das Programm Spannung angelegt hat. </font><font style="vertical-align: inherit;">Die Spalten- / Zeilenkorrespondenz zu Kontakten wird hier hervorgehoben.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/3w/yn/dm3wynvz4faugjchr5h94ywdwgq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Wirklichkeit kann die Matrix so aussehen. </font><font style="vertical-align: inherit;">Links ist industriell und rechts ist hausgemacht.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-y/3o/ik/-y3oikaoyykmeihyhgskuihxgoo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Pseudocode kann der Teil des Firmware-Programms, der die gedrückten Tasten bestimmt, so aussehen.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; COLSC; i++) {<font></font>
 	SetPower(columns[i], <span class="hljs-number">3.0</span> f);
  	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; ROWSC; j++) {
    		<span class="hljs-keyword">float</span> power = GetPower(rows[j]);
    		<span class="hljs-keyword">if</span> (power &gt;= <span class="hljs-number">3.0f</span> - THRESHOLD) {<font></font>
      			BYTE key = keys[i, j];<font></font>
      			SendKey(key);<font></font>
    		}<font></font>
  	}<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jeder Schlüssel entspricht einem Scan-Code, ist standardisiert und eine 8-Bit-Zahl, d.h. ein Byte. Wenn die Y-Taste gedrückt wird, muss der Tastaturcontroller daher die Nummer 21 (0x15) und beim Loslassen die Nummer 149 (0x95) senden. Wie erfolgt der Versand? Sicherlich haben Sie mit JSON, Webdiensten oder gesendeten Daten zwischen Prozessen gearbeitet und wissen, dass Sie zum Senden von Daten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serialisieren müssen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d. H. in ein Array von Bytes oder formatiertem Text verwandeln, das der Empfänger </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deserialisieren</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kann </font><font style="vertical-align: inherit;">, d.h. Erstellen Sie ein Objekt in seinem Adressraum neu. Und was kann Daten auf so niedrigem Niveau serialisieren? Wir müssen nur 1 Byte (8 Bit) übertragen. Mit Blick auf die Zukunft werde ich sagen, dass wir Daten Stück für Stück übertragen werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Mathematik gibt es eine Formel, die jede uns bekannte Dezimalzahl in eine Folge von Nullen und Einsen umwandeln kann und umgekehrt. Diese Formel hat Anwendung in der Computertechnologie gefunden. Im ersten Teil erwähnte ich beiläufig, dass die analoge Technologie die Gesetze der Physik ausnutzt, während die digitale auf der Ebene von Nullen und Einsen arbeitet. Dies bedeutet, dass ein analoges Telefon das gesamte Spektrum der menschlichen Stimme in eine Folge elektromagnetischer Wellen codiert und ein digitales Telefon einen Chip verwendet, der die menschliche Stimme beispielsweise in WAV-Dateien in digitale Daten umwandelt und diese dann in einer Folge von Nullen und Einsen in Form elektromagnetischer Wellen überträgt. Nur in diesem Fall müssen anstelle des gesamten Spektrums der Stimme nur zwei Werte dargestellt werden - 0 und 1. Sie können durch Wellen unterschiedlicher Länge, unterschiedlicher Spannungen, dargestellt werden.Lichtimpulse durch die Glasfaser, schwarze und weiße Streifen auf Papier, Löcher in der Lochkarte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Scan-Code der gedrückten Y-Taste in Binärform sieht aus wie 0001 0101. Wir übertragen sie entlang des Mikrocontroller-Abschnitts, der für die Daten ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DATA</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) verantwortlich ist. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die logische Einheit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist 3,3 V oder höher, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logische Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Die Spannung beträgt ca. 0V. Hier ist der Haken: Wie übergebe ich drei Nullen hintereinander? Dazu benötigen wir einen zweiten Abschnitt, den wir CLOCK nennen, wenn auf diesem eine bedeutet, dass die Übertragungssitzung eines Bits begonnen hat und Null beendet ist. Eine solche Änderung der Werte (Spannungen) tritt mit einem bestimmten Zeitintervall auf, beispielsweise 50 Nanosekunden, da sich am anderen Ende ein zweiter Mikrocontroller befindet, der mit seiner eigenen Geschwindigkeit arbeitet und auf die Beine hört, mit denen CLOCK und DATA in einer Endlosschleife verbunden sind. In diesem Beispiel gehe ich davon aus, dass die Tastatur über den unten gezeigten PS2-Anschluss angeschlossen ist. Über den USB-Anschluss unterscheidet sich der Übertragungsalgorithmus. Wie Sie sehen können, verfügt der PS2-Port über Pins namens Data, Clock.Zusätzlich gibt es einen Kontakt, über den der PS2-Port-Controller die für den Betrieb erforderliche 5-V-Spannung auf die Tastatur verteilt, und einen Erdungskontakt, der einfach auf dem Tastaturkörper angezeigt wird. Andere Kontakte werden nicht verwendet.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/8g/ug/g7/8gugg7htfuyfrzclfypvowdzkhq.png"></td>
<td><img src="https://habrastorage.org/webt/dy/zf/_w/dyzf_w-iqlutb2xiju_om0e4abq.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der PS / 2- </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird als </font><i><font style="vertical-align: inherit;">serieller Bus bezeichnet</font></i><font style="vertical-align: inherit;"> , da er nacheinander Bits überträgt (eine Folge von Bits). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der parallele Port</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> überträgt Daten gleichzeitig an mehrere Kontakte und kann beispielsweise ein Byte (8 Bit) gleichzeitig für eine Datenübertragungssitzung übertragen. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist der Unterschied zwischen einem Port, einem Bus und einem Protokoll? Ein Bus ist wie ein Port eine Reihe von Kontakten (Verkabelung) und eine Vereinbarung über deren Verwendung. Nur der Port verfügt über eine Verbindung zum Anschließen externer Geräte, und der Bus wird zur Kommunikation von Komponenten auf der Hauptplatine verwendet. Ein Port ist im Wesentlichen ein Bus mit einem Anschluss in der Mitte. Ein Protokoll ist eine Interaktion durch Kontakte. Im Beispiel mit PS / 2 war dies die Reihenfolge der Datenübertragung über die Clock- und Datenkontakte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuvor war der Intel 8042-Mikrocontroller sehr verbreitet und wurde sowohl in der Tastatur als auch als PS2-Port-Controller verwendet, d. H. Zwei identische Chips tauschten Daten aus. Der PS2-Porttreiber in Windows heißt 8042prt.sys.</font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tatsächlich übertragen wir nicht 8 Bits, sondern 11, da die Daten als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenpaket</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachricht übertragen werden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Zusätzliche 3 Bits geben den Anfang und das Ende der Daten an - eine Null am Anfang und 0 1 am Ende, ein solches Protokoll zum Übertragen von Daten vom Gerät zum Host in PS2. Dies kann wie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SendKey-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">im Pseudocode </font><font style="vertical-align: inherit;">aussehen </font><font style="vertical-align: inherit;">, wenn Sie den Code </font><i><font style="vertical-align: inherit;">besser</font></i><font style="vertical-align: inherit;"> verstehen möchten. Es sendet Daten über die gedrückte Taste über den PS2-Bus.</font></font><br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SendBit</span><span class="hljs-params">(BYTE bit)</span> </span>{
	<span class="hljs-keyword">float</span> power = (bit != <span class="hljs-number">0</span>) ? <span class="hljs-number">3.3f</span> : <span class="hljs-number">0.0f</span>;<font></font>
	SetPower(DATA, power);<font></font>
	SetPower(CLOCK, <span class="hljs-number">3.3f</span>);<font></font>
	Sleep(<span class="hljs-number">50</span>);<font></font>
	SetPower(CLOCK, <span class="hljs-number">0.0f</span>);<font></font>
	Sleep(<span class="hljs-number">50</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SendData</span><span class="hljs-params">(BYTE data)</span> </span>{<font></font>
	SendBit(<span class="hljs-number">0</span>);<font></font>
	<font></font>
	<span class="hljs-keyword">for</span> (BYTE i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(BYTE); i++) {<font></font>
		BYTE bit = (data &gt;&gt; i) &amp; <span class="hljs-number">1</span>;<font></font>
		SendBit(bit);<font></font>
	}<font></font>
<font></font>
	SendBit(<span class="hljs-number">0</span>);<font></font>
	SendBit(<span class="hljs-number">1</span>);<font></font>
}<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist nicht immer erforderlich, die Spannung an jedem Zweig für die Datenübertragung manuell einzustellen. </font><font style="vertical-align: inherit;">In einigen Fällen wird der im Register gespeicherte Wert automatisch auf den Kontakten angezeigt. </font></font><br>
</i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Grafik wird eine solche Datenübertragung wie folgt dargestellt. </font><font style="vertical-align: inherit;">Die Zeit liegt entlang der X-Achse und die Spannung entlang der Y-Achse.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/cy/p8/zscyp8ur1i1t0lmau3n50evbuke.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der analogen Technologie kann das Signal verzerrt sein, d.h. </font><font style="vertical-align: inherit;">Der Draht ist an nichts angeschlossen, aber das Voltmeter zeigt 0,5 V an, da sich in der Nähe ein elektromagnetisches Feld befindet. </font><font style="vertical-align: inherit;">Daher wird das Konzept der Schwellenspannung verwendet. </font><font style="vertical-align: inherit;">Wenn die Spannung kleiner als der Schwellenwert ist, nehmen wir an, dass wir eine logische Null haben, andernfalls Einheit. </font><font style="vertical-align: inherit;">Unter Berücksichtigung möglicher Verzerrungen kann der Scan-Code der gedrückten Y-Taste folgendermaßen aussehen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/u4/3k/slu43kce6evjxlk3qgrzzwpfhmg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir uns genauer ansehen, wie Daten von der Tastatur zur CPU gelangen, wollen wir uns mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrochips</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bussen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Motherboards befassen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikrocontroller und Mikroschaltungen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Mikrocontroller kann ein in ihn eingenähtes Programm ausführen, verfügt über einen bestimmten RAM-Speicher und einen Speicherort für Daten und Programmcode. Im </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chip kann das</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programm bereits in der Entwurfsphase eingestellt werden. Das manuelle Erstellen einer elektrischen Schaltung, die einen Algorithmus implementiert, ist sehr zeitaufwändig und daher kann eine spezielle Programmiersprache namens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VHDL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Hardware Description Language) </font><font style="vertical-align: inherit;">zum Entwerfen von Mikroschaltungen verwendet werden </font><font style="vertical-align: inherit;">. Dies ist eine Programmiersprache auf hoher Ebene, die in einen Schaltplan übersetzt wird. Sie wird durch ein Programm ausgeführt, das die optimale Position der Funkelemente auf der Platine findet und letztendlich in physischer Form erstellt wird. Die Bilder dienen nur zur Veranschaulichung.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/6c/rt/vp/6crtvpo861utguxs56v37-7syx4.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/r8/q7/gkr8q7m78x8ldyxvdxu7tp9pxhc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie werden die Daten und Befehle in Mikrochips und Mikrocontrollern dargestellt? </font><font style="vertical-align: inherit;">Die Basis der Computertechnologie ist ein Transistor, den die Menschheit in mikroskopischen Dimensionen herstellen gelernt hat. </font><font style="vertical-align: inherit;">Ein Transistor ist ein solches Funkelement, das drei Zweige hat: einen Eingang, einen Ausgang und zwischen ihnen eine Steuerung, die einen Strom zwischen zwei Zweigen öffnet oder schließt. </font><font style="vertical-align: inherit;">Die folgende Abbildung zeigt den Betrieb des Transistors, Wasser zeigt den Strom.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/1g/kj/bw/1gkjbwtax3xmpshjmbllzgpvkoo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An den Eingangszweig wird eine Spannung angelegt. Wenn die Steuerung eine Spannung hat, fließt der Strom zum Ausgang, andernfalls liegt 0 V an. </font><font style="vertical-align: inherit;">Mit 8 Transistoren, von denen jeder eine LED an den Ausgangszweig angeschlossen hat, die entweder aufleuchtet oder nicht, können wir uns 256 einzigartige Kombinationen vorstellen (2 hoch 8). </font><font style="vertical-align: inherit;">Lapochki werden von rechts nach links sowie Dezimalzahlen interpretiert. </font><font style="vertical-align: inherit;">Die unteren Ziffern befinden sich rechts.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/bt/gb/9l/btgb9ln9dejdgz-v-e7l_6mjx9u.png"></td>
<td><img src="https://habrastorage.org/webt/vb/js/yg/vbjsygneuovkp0ocaml6yfvoigy.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jene. </font><font style="vertical-align: inherit;">Eine Lampe repräsentiert ein Informationsbit (0 oder 1), und acht solcher Lampen entsprechen einem Byte. </font><font style="vertical-align: inherit;">Es ist möglich, logische Operatoren AND, OR, NOT, XOR auf Transistoren zu erstellen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/rw/gz/wurwgzgga7mny0qhn3daju6hdic.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der UND-Operatorschaltung (links im Bild oben) hat der Ausgang beispielsweise nur dann eine Spannung, wenn beide Eingangsspannungen ungleich Null sind. </font><font style="vertical-align: inherit;">Jemand hat bereits Algorithmen für Addition, Multiplikation, Division und Subtraktion erfunden, die auf bitweisen logischen Operationen und Bitverschiebungen basieren. </font><font style="vertical-align: inherit;">Chiphersteller müssen sie nur implementieren. </font><font style="vertical-align: inherit;">Die Funktionsweise des bitweisen Additionsalgorithmus ist unten dargestellt, wir werden ihn nicht analysieren:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9k/t3/m5/9kt3m5uiw9wp1xk7ferifgngpzi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Nanotransistoren sind mikroskopisch klein und können millionenfach auf der Platine platziert werden. </font><font style="vertical-align: inherit;">Der Intel-Prozessor wird unten gezeigt und wie ungefähr einer seiner Kerne aussehen könnte. </font><font style="vertical-align: inherit;">Das Bild ist illustrativ.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hy/77/gt/hy77gt038gktsayjog-kg9rh65u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mikroschaltungen können einen Mikrocontroller auf derselben Platine und im selben Fall enthalten.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reifen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Lehrbüchern werden Reifen normalerweise als fette Pfeile angezeigt (siehe Abbildung unten). </font><font style="vertical-align: inherit;">Dies geschieht, um nicht alle Verbindungen der Kontakte zu zeichnen, die viele sein können. </font><font style="vertical-align: inherit;">Die Bedienung des PS2-Busses ist sehr einfach. Sie benötigen lediglich drei Pins. </font><font style="vertical-align: inherit;">Es gibt jedoch Busse, die beispielsweise 124 Kontakte für die Datenübertragung haben.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zu/-a/vd/zu-avduvaicswxtkaeihnnwureu.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt folgende Reifentypen:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenbits auf diesen Kontakten werden als Daten interpretiert: Nummer, Symbol, Teil eines Bildes oder andere Binärdaten. </font><font style="vertical-align: inherit;">Die Busbreite beeinflusst den Durchsatz und die Anzahl der pro Sekunde übertragenen Bits</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adressen - Bits auf diesen Pins werden als physikalische Adresse im Speicher interpretiert. </font><font style="vertical-align: inherit;">Die Breite dieses Busses bestimmt die maximal unterstützte RAM-Kapazität.</font></font></li>
<li> —          . CPU         RAM   I/O.</li>
<li>.         ,      .    ATX 24 Pin 12V PSU Connector,       .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/am/cb/mq/amcbmq-jxkqdth45s_79xrg6uwa.png"></div></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Reifen kann aus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Substraten bestehen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d.h. </font><font style="vertical-align: inherit;">Einige Kontakte werden für Daten verwendet, andere für Adressen, andere für die Steuerung und Kontakte, an die Strom übertragen wird. </font><font style="vertical-align: inherit;">Der Ansatz, bei dem dieselben Kontakte abwechselnd zum Übertragen von Daten und Adressen verwendet werden, wird als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multiplexing bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Beispielsweise verfügt der Intel 8086-Prozessor über einen Daten- und Adressbus von 20 Bit. Auf dem Pin-Diagramm sind seine Kontakte mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AD0-AD19</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Abschnitte</font></a><font style="vertical-align: inherit;"> 16-2 und 39-35) gekennzeichnet.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jp/wy/tx/jpwytxl5cbiuv_hky79ledmfzjk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem komplexeren Fall sind möglicherweise mehrere Mikroschaltungen mit denselben Kontakten verbunden. </font><font style="vertical-align: inherit;">Für die normale Kommunikation benötigen sie einen zusätzlichen Chip, der bestimmt, wer zu welchem ​​Zeitpunkt sie verwenden kann. Dieser wird als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buscontroller bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In der folgenden Abbildung ein sphärischer Bus im Vakuum: Vier identische Mikrocontroller übertragen Daten über den Buscontroller an den Consumer-Mikrocontroller. Das rote Kabel ist die Spannung, die der Buscontroller an alle daran angeschlossenen Chips verteilt. Daten werden über die grünen Drähte übertragen und es wird ein „Verhandeln“ mit der Bussteuerung durchgeführt, und die blaue Leitung ist Clock, über die die Bussteuerung die Kommunikation der Steuerungen synchronisiert, da diese mit unterschiedlichen Geschwindigkeiten arbeiten können. Befindet sich die logische Einheit auf dem blauen Draht, kann der Chip, der zur Nutzung des Busses berechtigt ist, einen Interaktionsakt mit der Außenwelt ausführen - zum Beispiel ein bisschen lesen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3a/tc/pq/3atcpqqtqdpmnbvrjho1h1y-bww.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Buscontroller kann als integraler Bestandteil betrachtet werden, da die Kommunikation mit der Außenwelt über ihn erfolgt und es nicht wichtig ist, wie viele Chips oder echte externe Geräte sich tatsächlich auf dem Bus befinden. </font><font style="vertical-align: inherit;">Für die Datenübertragung verfügt das Motherboard über ein umfangreiches Busnetz. </font><font style="vertical-align: inherit;">Trotz der Tatsache, dass es sehr viele Chipsätze gibt, folgen sie größtenteils einem typischen Layout, da alle an das Motherboard angeschlossenen Geräte unterteilt sind in:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Langsam - Tastatur, Festplatte, Netzwerkkarte, Audio usw. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schnell - CPU, RAM, GPU. </font></font></li>
</ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basierend auf dieser Aufteilung verfügt das Motherboard über zwei Hauptchips - die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">South Bridge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die die Arbeit aller langsamen Geräte koordiniert, und die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">North Bridge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Koordination schneller Geräte. In modernen Computern befindet sich die Northbridge in der CPU selbst, und die Southbridge kann als Platform Controller Hub bezeichnet werden, dies ändert jedoch nichts an der Essenz. Beide Brücken sind durch einen Bus miteinander verbunden, über den sie sich gegenseitig über wichtige Ereignisse informieren. Von besonderem Interesse ist der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Taktgenerator,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem der Prozessor, der RAM und die Grafikkarte ihre Arbeit synchronisieren, das gleiche blaue Kabel. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Übertakten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dadurch werden die BIOS-Einstellungen im Wesentlichen geändert, sodass die Synchronisierung häufiger erfolgt, während sich die Hardware, hauptsächlich die CPU, stärker erwärmt, mehr Strom verbraucht und ihre Ressourcen schneller entwickelt. Das Gegenteil ist das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untertakten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wenn die Geschwindigkeit abnimmt, um Batteriestrom zu sparen oder Geräusche zu reduzieren. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Chipsatz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Satz von Chips, die alle so konzipiert sind, dass sie miteinander arbeiten. Sie bieten Kommunikation zwischen Komponenten auf dem Motherboard und Funktionen wie Timer. Der Chipsatz funktioniert nur mit einer Prozessormarke, AMD kann mit dem Intel-Chipsatz nicht in das Motherboard eingesetzt werden, sie haben sogar unterschiedliche Kontakte. Das Motherboard-Diagramm ist unten dargestellt:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><img src="https://habrastorage.org/webt/hd/zk/ld/hdzkldbz0h6vjddegg2iqwir-f0.png"></td>
<td><img src="https://habrastorage.org/webt/2h/sl/-f/2hsl-f2t77a-x4xy0dn5xqo2ua0.png"></td>
</tr>
</tbody></table></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Möchten Sie ein Beispiel für die Hardware-Kapselung? </font><font style="vertical-align: inherit;">Intel-Chipsätze haben einen Chip namens </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Super IO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der in der folgenden Abbildung dargestellt ist und über den LPC-Bus mit der South Bridge verbunden ist. </font><font style="vertical-align: inherit;">LPC ist der intelligente Name für die Verkabelung von CLOCK, DATA, VCC (POWER). </font><font style="vertical-align: inherit;">Dieser Chip enthält die Emulation aller alten Chips, die jemals für Peripheriegeräte verwendet wurden, einschließlich des 8042-Chips, der für den PS2-Port verwendet wurde. </font><font style="vertical-align: inherit;">Es gibt auch einen Port-Controller-Emulator für Floppy und andere Relikte, die den Fortschritt stören. </font><font style="vertical-align: inherit;">Im allgemeinen Diagramm des Motherboards sind oben sowohl Super IO als auch der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LPC-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bus angegeben </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bf/wx/sm/bfwxsm3i9gekd4yjd0uizbusb3u.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der moderne PS2-Port wird direkt mit dem Super I / O-Chip verbunden. </font><font style="vertical-align: inherit;">Grün ist die Tastatur, Lila ist die Maus. </font><font style="vertical-align: inherit;">Zuvor war es mit dem Intel 8042-Mikrocontroller verbunden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/za/tj/aezatje8p9gbwod0uap92v7sv-e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Motherboard besteht aus einem Dielektrikum, d.h. </font><font style="vertical-align: inherit;">Material, das keinen Strom leitet. </font><font style="vertical-align: inherit;">Der Strom kann nur über die auf der Tafel gedruckten Linien fließen. </font><font style="vertical-align: inherit;">Das Motherboard hat viele Ebenen, von denen jede ihre eigenen Kontakte gedruckt hat. Wenn Sie also das Motherboard dort bohren, wo die Linien nicht sichtbar sind, können Sie es verderben, indem Sie die unsichtbaren Kontakte im Board beschädigen. </font><font style="vertical-align: inherit;">Jetzt können Sie sich den Prozess der Verteilung von Daten von der PS2 an die CPU genauer ansehen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Weg von der PS2 zum Prozessor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Regel wird die Computerarchitektur auf dem 8086-Prozessor berücksichtigt. Dies ist zum einen richtig, weil sie im Vergleich zu modernen CPUs recht einfach ist, zum anderen ist sie falsch, weil sie alt ist und nicht die Architektur einer modernen Maschine widerspiegelt. Intel 8086 benötigte keine Bridges, da es so langsam war, dass es mit Peripheriegeräten an einem Bus arbeiten konnte, d. H. bei einer Frequenz. Ich kenne die modernen CPU- und Chipsätze nicht, daher werde ich sie an fiktiven erklären, die echten ähneln. In meinem Beispiel wird es eine fiktive CPU geben, die </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Intel 8086</font></a><font style="vertical-align: inherit;"> sehr ähnlich ist</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Der Super IO-Chip hat mehr als hundert Kontakte und es gibt Dokumentationen im Internet, aber ich sehe keinen Sinn darin, herauszufinden, welche Pins die Tastatur und der LPC-Bus tatsächlich für die Kommunikation mit South Bridge verwenden. Hauptsache das Prinzip, das unterschiedlich umgesetzt werden kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Werfen wir einen kurzen Blick auf das Bild, um uns daran zu erinnern, dass wir bereits bestanden haben. Die grünen Pfeile zeigen den Weg an, den wir nehmen werden.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/82/ic/2e/82ic2e8smxmv-z0epnfxzk1f6n8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Daten von der Tastatur sind also bereits auf den PS2-Port-Controller gelangt, der einst ein Intel 8042-Chip war und jetzt von einem Super IO-Chip emuliert wird. Und jetzt analysieren wir die weitere Vorgehensweise auf meinem fiktiven Motherboard mit einer fiktiven CPU. Der PS2-Controller hat einen Scan-Code der gedrückten Y-Taste empfangen und liefert nun Spannung an das Kontaktsignal (violette Linie, siehe Abbildung unten), auf dem der programmierbare Interrupt-Controller über Daten von der Tastatur benachrichtigen soll. Dieses Signal wird von einem Chip zum anderen übertragen, bis die North Bridge es an den Interrupt-Manager weiterleitet.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zh/jb/jb/zhjbjbwyj8dgyhydsaeryyfyfrm.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmable Interrupt Controller</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel 8259</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chip , </font><font style="vertical-align: inherit;">in dem 8 Beine (ihre Namen IRQ0-IRQ7) sind reserviert für Meldungen von bestimmten Ports empfangen ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nterrupt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uest). Eine Tastatur ist mit dem IRQ1-Pin verbunden, IRQ7 mit einem Drucker, eine Diskette mit einem Pin, einer Soundkarte, parallelen Anschlüssen und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anderen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Natürlich kann es viel mehr als acht Geräte geben, so dass eine Technik wie Kaskadierung verwendet wurde, wenn ein anderer ähnlicher PIC mit einem Bein mit dem Namen IRQ2 verbunden wurde, bei dem die Zählung nicht bei 0, sondern bei 7 begann. Die Maus ist an IRQ12 gebunden, d.h. Fuß IRQ5 auf dem zweiten PIC. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Interrupt-Controller sollte nun die CPU über das Ereignis auf der Tastatur informieren. Dies geschieht wie folgt:</font></font><br>
<ol>
<li>      INT (Interrupt) ,     INTR (<i>Interrupt Request</i>) . CPU            ,        , ..       .     ,       .        exception  .</li>
<li>               INTR,        .</li>
<li>       ( D0-D7)  ,    .      PIC          (   IRQ).<br>
<br>
<i> ,   ?     .               .   —      (x, y, z, w).        .</i></li>
<li>CPU     AD0-AD7  ,  .      IDT (<i>Interrupt Descriptior Table</i>)    ,     ,         .   CPU   .<br>
<br>
<i>             .       .    ,   IDT        C# .</i><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IDT_entry</span>{</span>
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> offset_lowerbits;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> selector;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> zero;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> type_attr;
	<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> <span class="hljs-keyword">int</span> offset_higherbits;<font></font>
};<font></font>
 <font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IDT_entry</span> <span class="hljs-title">IDT</span>[256];</span>
</code></pre></li>
<li>        ,          INTA (<b>Int</b>errupt <b>A</b>cknowledged).<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Tastatur-Interrupt-Handler im einfachsten Code sieht folgendermaßen aus. Es ruft einen Befehl auf, der den Abschluss der Interrupt-Verarbeitung signalisiert, d. H. sendet ein Signal an den INTA-Fuß.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">irq1_handler</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
	  outb(<span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>); <span class="hljs-comment">//EOI</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können mehr darüber erfahren, wie die Interrupt- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vektortabelle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">osdev</font></a><font style="vertical-align: inherit;"> konfiguriert </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ist</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt wissen wir, wie der Interrupt passiert ist, aber wir wissen nicht, wie der Interrupt-Handler Informationen über die gedrückte Taste liest. Aus Softwaresicht besteht der PS2-Port aus zwei Registern, auf die nur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">über die E / A-Portnummer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht über Namen oder Adressen im Speicher zugegriffen werden kann </font><font style="vertical-align: inherit;">. Diese beiden Einzelbyte-Register sind den Ports 0x60 und 0x64 zugeordnet, das erste (0x60) enthält den Scan-Code des Schlüssels. Der zweite Port wird verwendet, um Status und Befehle an den PS2-Port (nicht an die Tastatur!) Zu übertragen. Der x86 - </font><font style="vertical-align: inherit;">Architektur - </font><font style="vertical-align: inherit;">Befehlssatz hat den Befehl </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IN </font></font></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">storeTo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fromPortNum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hiermit wird der Wert vom angegebenen E / A-Port in das angegebene Register gelesen. </font><font style="vertical-align: inherit;">Zum Beispiel IN 0 AL speichert 0x60 die Daten von der Tastatur im AL-Register. </font><font style="vertical-align: inherit;">Es könnte ungefähr so ​​funktionieren:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In dem Prozessor, den wir in Betracht ziehen, gibt es Beine AD0-AD20, die zur Angabe der Adresse und der Daten verwendet werden können. </font><font style="vertical-align: inherit;">Dies ist sowohl ein Datenbus als auch ein Adressbus. </font><font style="vertical-align: inherit;">Zusätzlich zu ihnen gibt es eine Reihe von Steuerzweigen, zum Beispiel Pin Nr. 28 (S2), deren Wert der Nordbrücke anzeigt, wo das Lesen stattfinden wird - aus dem Speicher oder einem Eingabe- / Ausgabegerät. </font><font style="vertical-align: inherit;">Der Befehl IN legt hier den Wert fest, der sich auf das E / A-Gerät bezieht.</font></font></li>
<li>   CPU (-   AD0-AD20)   0110 0000,    0x60.      CPU    ,     .        , -   , - .       0x60        SuperIO ,    -    .</li>
<li>    Super IO            .   0x60        PS2,         . </li>
<li>    .   Intel 8042,     SuperIO,   LPC       ,       . ..        ,    .</li>
<li>     CPU              (- 8   AD0-AD20). </li>
<li> CPU                   AL.         .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser gesamte Algorithmus arbeitet im Nanosekundenbereich und wird daher fast sofort ausgeführt, obwohl der Prozessor einige Zeit auf die E / A-Operation gewartet hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie jetzt verstehen, lesen Sie von externen Geräten, auch von RAM-Speicher mit so weiter. Die CPU ist ziemlich langsam. Diese Langsamkeit kann festgestellt werden, indem ein Programm geschrieben wird, das zeilenweise 10.000 Zeilen in einer Datei druckt, anstatt sie in den Puffer zu kopieren und sofort zu speichern. Die Festplatte ist mit der South Bridge verbunden und darin befindet sich auch ein Controller, der die direkte Platzierung von Daten steuert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der RAM ist über den Bus mit der CPU verbunden und das Lesen dauert einige Zeit. Um die CPU zu beschleunigen, hat sie einen Cache, d.h. In dem Bereich, in dem sich Transistoren befinden, die Daten darstellen, die bald benötigt oder häufig verwendet werden, ist ihr Lesen viel schneller als von der RAM-Karte, die über die North Bridge mit der CPU kommuniziert. RAM wird als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dynamischer Direktzugriffsspeicher bezeichnet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da Kondensatoren zur Darstellung der darin enthaltenen Daten verwendet werden. Ein Kondensator ist ein Funkelement, das wie eine Batterie eine Weile eine Ladung hält, bis sie vollständig entladen ist. Nur hier erfolgt die Entladung sehr schnell. Daher müssen die Kondensatoren aufgeladen werden, dies geschieht sofort, es reicht aus, Spannung anzulegen. Geladener Kondensator - logisch 1, sonst 0. Für den Cache wird Speicher verwendet</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statischer RAM,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d.h. </font><font style="vertical-align: inherit;">es muss nicht aufgeladen werden und arbeitet daher schneller, kostet aber mehr. </font><font style="vertical-align: inherit;">Der Cache ist in 3 Ebenen unterteilt, die während der Suche nach den angeforderten Daten nacheinander überprüft werden, bevor der Prozessor auf den RAM zugreift. </font><font style="vertical-align: inherit;">Auf älteren Prozessoren war der Cache der ersten Ebene (L1) Teil der CPU und arbeitete mit derselben Frequenz damit, wenn sowohl L2- als auch L3-Caches externe Chips waren. </font><font style="vertical-align: inherit;">Jetzt befinden sich alle mit dem Prozessor auf dem gleichen Chip. </font><font style="vertical-align: inherit;">Der L1-Cache ist der schnellste und kleinste Speicher, L2 hat mehr Speicher, ist aber langsamer. </font><font style="vertical-align: inherit;">L3 ist der größte und langsamste Cache, der häufig als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gemeinsam genutzter Cache bezeichnet wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da er Daten für alle CPU-Kerne speichert, während L1 und L2 für jeden einzelnen Kern erstellt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im nächsten Teil werden wir darüber sprechen, wie Windows die empfangenen Daten empfängt und verarbeitet.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de489152/index.html">Petersburg gegen Paris: Wie Museen auffüllen und wie die Öffentlichkeit verkleinern</a></li>
<li><a href="../de489156/index.html">Wer ist schlauer als IDEA?</a></li>
<li><a href="../de489160/index.html">Ergebnisse einer Studie zu Stellenausschreibungen für einen digitalen Produktdesigner. Erster Teil - Ergebnisse und Statistiken</a></li>
<li><a href="../de489162/index.html">Manager wird übergeben</a></li>
<li><a href="../de489164/index.html">Kubernetes Cluster-Upgrade ohne Ausfallzeiten</a></li>
<li><a href="../de489172/index.html">Wir verbinden die ActiveDirectory-Autorisierung mit Keycloak mit Kubernetes</a></li>
<li><a href="../de489174/index.html">Single Responsibility Principle (SRP) mit Laravel</a></li>
<li><a href="../de489178/index.html">GSMout - SMS empfangen und "zu Hause" anrufen</a></li>
<li><a href="../de489188/index.html">Anmelden in einer Microservice .Net-Umgebung in der Praxis</a></li>
<li><a href="../de489190/index.html">RedHat-Studie: Open Source vertreibt proprietäre Software aus dem Unternehmenssegment</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>