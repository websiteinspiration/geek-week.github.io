<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЪ╕ ЁЯЫР ЁЯЪ╖ рдЙрдиреНрдирдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рдиреЗ рдФрд░ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдпрд░рд▓реЗрд╕ рд╕реЗрдВрд╕рд░ ЁЯТЕ ЁЯН┐ ЁЯТ┤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВ рд╣реЗрдмрд░ рдХреЗ рд╕рднреА рдкрд╛рдардХреЛрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ "DIY рдпрд╛ рд╕реНрд╡рдпрдВ рдХрд░реВрдБ" рдЕрдиреБрднрд╛рдЧ рдХреЗ рдкрд╛рдардХреЛрдВ рдХрд╛ рд╕реНрд╡рд╛рдЧрдд рдХрд░рддрд╛ рд╣реВрдБ! рдФрд░ рдЕрдЧрд░ рдореИрдВ рдРрд╕рд╛ рдХреБрдЫ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛, рддреЛ рдореИрдВ рдПрдХ рдЕрд░реНрджреАрдиреЛ рд╣реВрдВ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдЙрдиреНрдирдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рдиреЗ рдФрд░ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдпрд░рд▓реЗрд╕ рд╕реЗрдВрд╕рд░</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490476/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ рд╣реЗрдмрд░ рдХреЗ рд╕рднреА рдкрд╛рдардХреЛрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ "DIY рдпрд╛ рд╕реНрд╡рдпрдВ рдХрд░реВрдБ" рдЕрдиреБрднрд╛рдЧ рдХреЗ рдкрд╛рдардХреЛрдВ рдХрд╛ рд╕реНрд╡рд╛рдЧрдд рдХрд░рддрд╛ рд╣реВрдБ! рдФрд░ рдЕрдЧрд░ рдореИрдВ рдРрд╕рд╛ рдХреБрдЫ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛, рддреЛ рдореИрдВ рдПрдХ рдЕрд░реНрджреАрдиреЛ рд╣реВрдВ, рдореИрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ ... рдореИрдВ рд▓рд┐рдлреНрдЯ рдХреИрдм рдХреЗ рдкреНрд░рдмрдВрдзрди рдХреЗ рдореБрдЦреНрдп рд╡рд┐рд╖рдп рдХреЛ рдирд╣реАрдВ рдЫреВрддрд╛ рд╣реВрдВ :)ред рдХреБрдЫ рд╡рд┐рдЪрд╛рд░ рдХреЗ рдмрд╛рдж, рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдореИрдВ рдПрдХ рдЙрджреНрдШрд╛рдЯрди рдФрд░ рд╕рдорд╛рдкрди рд╕реЗрдВрд╕рд░ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред рдпрд╣ рд╕реЗрдВрд╕рд░, рдореЗрд░реЗ рдмрд╛рдХреА рд╢рд┐рд▓реНрдкреЛрдВ рдХреА рддрд░рд╣, рдЬреЛ рдореИрдВ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдХрд░рддрд╛ рд╣реВрдВ, рдиреЙрд░реНрдбрд┐рдХ рд╕реЗрдореАрдХрдВрдбрдХреНрдЯрд░ рдХреЗ рдЪрд┐рдкреНрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред рд╕реЗрдВрд╕рд░ рдиреЗ рджреЛ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рдПрдХ nRF52840 рдЪрд┐рдк рдкрд░ рдФрд░ рджреВрд╕рд░рд╛ nRF52811 рдЪрд┐рдк рдкрд░ред</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zu/u9/48/zuu948wn8duosrmce4hvtao1une.jpeg"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП nRF52840 рдЪрд┐рдк рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ E73_2G4M08S1C рдХрдВрдкрдиреА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EBYTE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">, verciya рдЪрд┐рдк рдореЙрдбреНрдпреВрд▓ nRF52811 MC50SFA рдХрдВрдкрдиреА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MiNEW рдХреЗ рд▓рд┐рдП</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рд╕рд╕реНрддреА nRF52811 рдЪрд┐рдкреНрд╕ рдХреА рдЦреЛрдЬ рдЕрднреА рднреА рдПрдХ рд╕рд╛рд╣рд╕рд┐рдХ рдХрд╛рд░реНрдп рдерд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдЗрд╕ рд╕рд╛рд╣рд╕рд┐рдХ рдХрд╛рд░реНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, MINEW рд╕реЗ nRF52811 рдЪрд┐рдк рдкрд░ рдореЙрдбреНрдпреВрд▓ рдФрд░ рдЗрди рдореЙрдбреНрдпреВрд▓ рдХреЛ рдорд┐рд▓рд╛рдП рдЧрдП рдЪрд┐рдкреНрд╕ рдХреЗ рдХрдИ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдиреНрд╕ nRF52810 рдФрд░ nRF52832 рд╣реИрдВред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/yx/4l/cnyx4lcnu6q_isgpvrszxy7c9wy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдореБрдЦреНрдп рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд░реАрдб рд╕реНрд╡рд┐рдЪ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЦреЛрд▓рдиреЗ рдФрд░ рдмрдВрдж рдХрд░рдиреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдИрдЦ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рд░реНрдХрд┐рдЯ рдХреЛ рдПрдВрдЯреА-рдмрд╛рдЙрдВрд╕ рдХреЗ рд╕рд╛рде рдлрд┐рд░ рд╕реЗ рдЪрд░рдгрдмрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рд░реНрдХрд┐рдЯ рдЖрд░реЗрдЦ:</font></font><br>
<img src="https://habrastorage.org/webt/o7/io/x-/o7iox-c4oobmvx6zldll_m1vowu.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino рдпреЛрдЬрдирд╛ :)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/j4/au/cy/j4aucyctci1fdwtfdkbiz_exsyi.png"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрджреНрдШрд╛рдЯрди рдФрд░ рд╕рдорд╛рдкрди рдХреЗ рдЗрд╕ рд╕рдВрд╡реЗрджрдХ рдХреА рдореБрдЦреНрдп рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдкрддрд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдЙрдкрдпреБрдХреНрдд рд╣реЛрдЧрд╛, рдЗрд╕ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реБрдП, рдореИрдВрдиреЗ рдпрд╣ рджреЗрдЦрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рдмрд╛рдЬрд╛рд░ рдкрд░ рдХреНрдпрд╛ рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рд▓рдЧрднрдЧ рдХреБрдЫ рднреА рдирд╣реАрдВ рдирд┐рдХрд▓рд╛, рдЙрджреНрдШрд╛рдЯрди рдФрд░ рд╕рдорд╛рдкрди рд╕реЗрдВрд╕рд░ рднреА рдЕрдлреНрд░реАрдХрд╛ рдореЗрдВ рдЙрджреНрдШрд╛рдЯрди рдФрд░ рд╕рдорд╛рдкрди рд╕реЗрдВрд╕рд░ рд╣реИред рд╕рдмрд╕реЗ "рдЙрдиреНрдирдд" рд╕рдорд╛рдзрд╛рди </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">REDMOND</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">ред рдЙрдирдХреЗ BLE рд╕реЗрдВрд╕рд░ рдореЗрдВ (рд╡реИрд╕реЗ, рдиреЙрд░реНрдбрд┐рдХ рдХреА рдПрдХ рдЪрд┐рдк рдкрд░ рднреА), рд░реАрдб рд╕реНрд╡рд┐рдЪ рдХреЗ рдЕрд▓рд╛рд╡рд╛, TTP223 рдЪрд┐рдк рдкрд░ рдПрдХ рдЯреЗрдореНрдкрд░реЗрдЪрд░ рд╕реЗрдВрд╕рд░ рдФрд░ рдПрдХ рдХреИрдкреЗрд╕рд┐рдЯрд┐рд╡ рдмрдЯрди рд╣реИред рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдпрд╣ рдореБрдЭреЗ рдХрд╛рдлреА рдЕрдЪреНрдЫрд╛ рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд▓рдЧ рд░рд╣рд╛ рдерд╛, рджрд░рд╡рд╛рдЬреЗ рдпрд╛ рдЦрд┐рдбрд╝рдХреА рдХреЗ рдкрд╛рд╕ рддрд╛рдкрдорд╛рди рд░реАрдбрд┐рдВрдЧ рдХрд┐рддрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ (рдФрд░ рдХреНрдпрд╛ рдЗрд╕реЗ рдПрдХ рдЪрд┐рдк рджреНрд╡рд╛рд░рд╛ рдорд╛рдкрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ) рдФрд░ рдХрд┐рди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЦрд┐рдбрд╝рдХреА рдпрд╛ рджрд░рд╡рд╛рдЬреЗ рдкрд░ рд▓рдЧреЗ рд╕реЗрдВрд╕рд░ рдкрд░ рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИ (рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ, рдЗрдирдкреБрдЯ :) рдХреЛ рдЫреЛрдбрд╝рдХрд░)ред рдирддреАрдЬрддрди, рдореИрдВрдиреЗ рдЕрдкрдиреЗ рд╕реЗрдВрд╕рд░ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fn/7v/y7/fn7vy79b2eivip0yber_90a_zew.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореБрдЦреНрдп рдЪрдпрди рдорд╛рдирджрдВрдб рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реЗрдВрд╕рд░ рдХреА рдЦрдкрдд рдереА, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рд╕реЗрдВрд╕рд░ рдореЗрдВ рд╕реАрдЖрд░ 2032 рдмреИрдЯрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЙрдореНрдореАрджрд╡рд╛рд░реЛрдВ рдХреЗ рдмреАрдЪ рд╡рд┐рдЬреЗрддрд╛ рджреЛ рд╕реЗрдВрд╕рд░, LIS2DW12 рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдФрд░ DRV5032FB рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдереЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LIS2DW12 рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╢рд╛рдпрдж рд╕рдмрд╕реЗ рдХрд┐рдлрд╛рдпрддреА рддреНрд╡рд░рдХ рд╣реИред рдХрдо рдЦрдкрдд рдореЛрдб рдореЗрдВ, рдпрд╣ рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ 1 ╬╝A ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛рд╢реАрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">рдЦрдкрдд рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред DRV5032FB рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдиреЗ рдЙрддреНрдХреГрд╖реНрдЯ рдЦрдкрдд рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рднреА рджрд┐рдЦрд╛рдпрд╛ред рдЗрд╕рдХреА рдЦрдкрдд рд▓рдЧрднрдЧ 500nA ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛рд╢реАрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢реЙрдХ рд╕реЗрдВрд╕рд░ рдореЛрдб рдореЗрдВ рдФрд░ рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ рдЗрдЪреНрдЫрд┐рдд рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рддрдп рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рдореИрдВ рд╢реЙрдХ рд╕реЗрдВрд╕рд░ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢рд╛рдВрдд рдерд╛, рддреЛ рдПрдХ рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрднреА рднреА рдПрдХ рдЕрддреНрдпрдзрд┐рдХ рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рд╕рдорд╛рдзрд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рддрд╛рдкрдорд╛рди рд╕реЗрдВрд╕рд░ рд╕реЗ рдмреЗрд╣рддрд░ рд╣реИред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/si/ni/64/sini6468k7gc4btzzjjwcaco8y8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХрд╛ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╣рд┐рд╕реНрд╕рд╛ рдореЗрдиреНрд╕реЗрдВрд╕рд░реНрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕реЗрдВрд╕рд░ рдХреЛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдХрдо рд╕реЗ рдХрдо рдЕрднреА рдХреЗ рд▓рд┐рдПред рдирд┐рдЪрд▓реЗ рд╕реНрддрд░ рдкрд░ рдиреЙрд░реНрдбрд┐рдХ рдЪрд┐рдкреНрд╕ (nRF24 (+ atmega 328, stm32f1), nRF51 рдФрд░ nRF52) рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдпреЗрдирд╕рд░реНрд╕ рдиреЙрд░реНрдбрд┐рдХ рдорд╛рд▓рд┐рдХрд╛рдирд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ - рдПрдирд╣реЙрдХ ShockBurst (ESB) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ nRF24 рдФрд░ nRF51-52 рдкрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╕рдВрдЧрддрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддреА рд╣реИред рдореЗрдиреНрд╕реЗрдВрд╕рд░реНрд╕ рдПрдХ рдЦреБрд▓реА рдЕрд░реБрдбрд┐рдиреЛ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рджреБрдирд┐рдпрд╛ рдХреЗ рдХрдИ рджреЗрд╢реЛрдВ рдореЗрдВ рдПрдХ рдмрдбрд╝рд╛ рд╕рдореБрджрд╛рдп рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдмрдирд╛ рд╣реБрдЖ рд╣реИред рд▓реЗрдХрд┐рди nRF52 рдЪрд┐рдкреНрд╕ рдкрд░ рдЕрдЪреНрдЫрд╛ рд╕рдорд╛рдзрд╛рди рдпрд╣ рд╣реИ рдХрд┐ Maysensors (ESB) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред рдпрд╣ рдХреЗрд╡рд▓ рдЬрд╝рд┐рдЧрдмреА рдпрд╛ рдмреАрдПрд▓рдИ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЪрд┐рдкреНрд╕ рдорд▓реНрдЯреА-рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВред ... рдмреАрдПрд▓рдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рдореИрдВ рдереЛрдбрд╝рд╛ рдЦреЛрджреВрдВрдЧрд╛, рдЬреЛ рдПрдХ рд╢рд╛рдирджрд╛рд░ Arduino NANO 33 BLE E73_2G4M08S1C рдореЙрдбреНрдпреВрд▓ рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИредрдореЗрд░реЗ рдиреИрдиреЛ 33 рдХреА рд▓рд╛рдЧрдд $ 4 рд╣реИред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ot/8f/vh/ot8fvhkkqsnzw_vhcqy7rubbgg0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЗрдЪ Arduino рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЕрддрд┐рд░рд┐рдХреНрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ IDE рдХреЛ LIS2DW12 рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдореИрдВрдиреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░рдЬрд┐рд╕реНрдЯрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдереЛрдбрд╝рд╛ рдмрджрд▓ рджрд┐рдпрд╛, рдореЗрд░реЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдпрд╣ рд╕рдмрд╕реЗ рдХрдо рдмрд┐рдЬрд▓реА рдЦрдкрдд рд╡рд┐рдХрд▓реНрдк ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд░реЗ рдЧрд┐рдЯ рдкрд░ рдЙрдкрд▓рдмреНрдз</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдХреЗ </font><font style="vertical-align: inherit;">рд▓рд┐рдП рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде рддреБрд░рдВрдд рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореИрдВ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рддрд░реНрдХ рдХрд╛ рд╡рд░реНрдгрди рдХрд░реВрдВрдЧрд╛ред рдСрдкрд░реЗрд╢рди рдХреЗ рдореБрдЦреНрдп рдореЛрдб рдореЗрдВ, рд╕реЗрдВрд╕рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдмрд╛рд╣рд░реА рдЗрдВрдЯрд░рдкреНрдЯ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдкрдиреЗ рдореЗрдВ рд╣реИ, рдХреЗрд╡рд▓ 4 рд╡реНрдпрд╡рдзрд╛рдиред рд╡реНрдпрд╡рдзрд╛рди рдХреЗ рджреЛ рд╡рд┐рдиреНрдпрд╛рд╕ рд╣реИрдВ; рдкреНрд░реЛрдЧреНрд░рд╛рдо рдСрдкрд░реЗрд╢рди рдХреЗ рджреМрд░рд╛рди рдкреБрди: рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЕрд╡рд░реЛрдзреЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╕реНрд╡рд┐рдЪ рдХреА рд╕реНрдерд┐рддрд┐ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рджрд░рд╡рд╛рдЬрд╛ рдЦреБрд▓рд╛ рд╣реИ, рддреЛ рд╕рджрдореЗ рд╕реЗрдВрд╕рд░ рдФрд░ рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╡рдзрд╛рди рдЕрдХреНрд╖рдо рд╣реИрдВред рдЬреИрд╕реЗ рд╣реА рджрд░рд╡рд╛рдЬрд╛ рдмрдВрдж рд╣реЛрддрд╛ рд╣реИ, рдЗрдирдореЗрдВ рд╕реЗ рджреЛ рд╕реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╡рдзрд╛рди рд╕рдХреНрд░рд┐рдп рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рдореБрдЭреЗ рдЗрд╕ рддрдереНрдп рдХрд╛ рднреА рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛ рдХрд┐ рдЙрджреНрдШрд╛рдЯрди рдХреЗ рджреМрд░рд╛рди рдРрд╕реА рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпрд╛рдВ рдереАрдВ рдЬрдм рд░реАрдб рд╕реНрд╡рд┐рдЪ рд╕реЗ рдкрд╣рд▓реЗ рд╢реЙрдХ рд╕реЗрдВрд╕рд░ рдЪрд╛рд▓реВ рд╣реЛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рд▓реЙрдХ рдЦреЛрд▓рдиреЗ рдХреЗ рджреМрд░рд╛рди рдХрдВрдкрди рд╕реЗ рдЖрдпрд╛ рдерд╛ред рдпрд╣ рд╕рдорд╕реНрдпрд╛ рдХреЗрд╡рд▓ рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдЙрдЪреНрдЪ рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреЗ рд╕рд╛рде рджрд░реНрдЬ рдХреА рдЧрдИ рдереАред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдЦрддреНрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдиреЗ рдкрд░ 2 рд╕реЗрдХрдВрдб рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬрд┐рд╕рдХреЗ рджреМрд░рд╛рди рд░реАрдб рд╕реНрд╡рд┐рдЪ рдХреЗ рдкрд┐рди рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреА рдЬрд╛рддреА рд╣реИред рдпрджрд┐ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХреЗ рджреМрд░рд╛рди рдИрдЦ рд╕реНрд╡рд┐рдЪ рдХреЗ рдкрд┐рди рдкрд░ рдПрдХ рд╕реНрддрд░ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рд╕реЗ рд░реБрдХрд╛рд╡рдЯ рд╕реЗ рдШрдЯрдирд╛ рдХрд╛ рдЖрдЧреЗ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдИрдЦ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдШрдЯрдирд╛ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрдВрд╕рд░ рдореЗрдВ рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЛрдб рд╣реИред рдЬрдм рд╕реЗрд╡рд╛ рдмрдЯрди рджрдмрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реЗрдВрд╕рд░ рд░реБрдХрд╛рд╡рдЯ рдкрд░ рдЙрдарддрд╛ рд╣реИ, рд░реЗрдбрд┐рдпреЛ рдореЙрдбреНрдпреВрд▓ рд╢реНрд░рд╡рдг рдореЛрдб рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпреВрдбреА рдирд┐рдпрдВрддреНрд░рдХ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реА рдХрдорд╛рдВрдб рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдПрдХ рдХрдорд╛рдВрдб рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕реЗрдВрд╕рд░ рдореЗрдореЛрд░реА рдХреЛ рдПрдХ рдирдпрд╛ рдорд╛рди рд▓рд┐рдЦрддрд╛ рд╣реИ рдФрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рдореЛрдб рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рддреБрд░рдВрдд рд╕реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдЕрдЧрд▓реА рдХрдорд╛рдВрдб рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЛрдб рдХрд╛ рд╕рдХреНрд░рд┐рдпрдг рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЛрдб рдореЗрдВ рд╕реЗрдВрд╕рд░ 30 рд╕реЗрдХрдВрдб рдХреЗ рднреАрддрд░ рдХреБрдЫ рднреА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЗрд╕ рд╕рдордп рдХреЗ рдмрд╛рдж рдСрдкрд░реЗрдЯрд┐рдВрдЧ рдореЛрдб рдкрд░ рднреА рд╕реНрд╡рд┐рдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реЛ рдЬрд╛рддрд╛ рд╣реИред рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЛрдб рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реЗрд╡рд╛ рдмрдЯрди рд╕реЗ рдЖрдк рд╕реЗрдВрд╕рд░ рд╕реЗрдВрд╕рд░ рдФрд░ рдлрд╝реИрдХреНрдЯрд░реА рд░реАрд╕реЗрдЯ рдХреА рдкреНрд░рд╕реНрддреБрддрд┐ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╕реЗрдВрд╕рд░ рдЙрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рднреВрд▓ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕реЗ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╕реЗрдВрд╕рд░ рдХрд╛ рдкрдВрдЬреАрдХрд░рдг рдлрд┐рд░ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП)ред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jn/1f/j3/jn1fj3ih6xil_iyk_c5abhzmg8q.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/u-/bt/gd/u-btgdierfsy0aqpvt2yhmimjic.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/gk/mr/ml/gkmrmlazpn6iwyxujq_82tk0ipc.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/do/en/m6/doenm6q7xz4ri8cxv57gipihkbq.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/er/x9/wu/erx9wumdn9jpozoie_o20c_kmqe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arduino IDE рдореЗрдВ рд╕реЗрдВрд╕рд░ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмреЛрд░реНрдбреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реИрдВрдбрдкреАрдорд┐рд╕реНрдЯреНрд░реА / рдЕрд░рдбреНрдпреВрдиреЛ-рдПрдирдЖрд░рдПрдл 5 </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЗрд╕реЗрдиреНрд╕рд░реНрд╕ / рдЕрд░реБрдбрд┐рдиреЛрдмреЛрд░реНрдбреНрд╕</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд▓рд╛рдЗрдмреНрд░реЗрд░реА: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрд╕реЗрдВрд╕рд░ </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIS2DWR</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдкреНрд░реЛрдЧреНрд░рд╛рдорд░: рд╕реЗрдВрдЯ-рд▓рд┐рдВрдХ, рдЬреЗ-рд▓рд┐рдВрдХред</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдХреЗрдЪ рдХрд╛рд░реНрдпрдХреНрд░рдо</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword">bool</span> configMode = <span class="hljs-number">0</span>;
<span class="hljs-keyword">int8_t</span> int_status = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> door_status = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> check;
<span class="hljs-keyword">bool</span> magnet_status = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> nosleep = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> button_flag = <span class="hljs-number">0</span>;
<span class="hljs-keyword">bool</span> onoff = <span class="hljs-number">1</span>;
<span class="hljs-keyword">bool</span> flag_update_transport_param;
<span class="hljs-keyword">bool</span> flag_sendRoute_parent;
<span class="hljs-keyword">bool</span> flag_no_present;
<span class="hljs-keyword">bool</span> flag_nogateway_mode;
<span class="hljs-keyword">bool</span> flag_find_parent_process;
<span class="hljs-keyword">bool</span> flag_fcount;
<span class="hljs-keyword">bool</span> Ack_TL;
<span class="hljs-keyword">bool</span> Ack_FP;
<span class="hljs-keyword">bool</span> PRESENT_ACK;
<span class="hljs-keyword">bool</span> send_a;
<span class="hljs-keyword">bool</span> batt_flag;<font></font>
byte conf_vibro_set = <span class="hljs-number">2</span>;<font></font>
byte err_delivery_beat;<font></font>
byte problem_mode_count;<font></font>
<span class="hljs-keyword">uint8_t</span>  countbatt = <span class="hljs-number">0</span>;
<span class="hljs-keyword">uint8_t</span> batt_cap;
<span class="hljs-keyword">uint8_t</span> old_batt_cap = <span class="hljs-number">100</span>;
<span class="hljs-keyword">uint32_t</span> BATT_TIME;
<span class="hljs-keyword">uint32_t</span> SLEEP_TIME = <span class="hljs-number">10800000</span>;
<span class="hljs-keyword">uint32_t</span> SLEEP_NOGW = <span class="hljs-number">60000</span>;
<span class="hljs-keyword">uint32_t</span> oldmillis;
<span class="hljs-keyword">uint32_t</span> newmillis;
<span class="hljs-keyword">uint32_t</span> previousMillis;
<span class="hljs-keyword">uint32_t</span> lightMillisR;
<span class="hljs-keyword">uint32_t</span> configMillis;
<span class="hljs-keyword">uint32_t</span> interrupt_time;
<span class="hljs-keyword">uint32_t</span> SLEEP_TIME_W;
<span class="hljs-keyword">uint32_t</span> axel_time;
<span class="hljs-keyword">uint32_t</span> axel_time0;
<span class="hljs-keyword">int16_t</span> myid;
<span class="hljs-keyword">int16_t</span> mypar;
<span class="hljs-keyword">int16_t</span> old_mypar = <span class="hljs-number">-1</span>;
<span class="hljs-keyword">bool</span> vibro = <span class="hljs-number">1</span>;
<span class="hljs-keyword">uint32_t</span> PIN_BUTTON_MASK;
<span class="hljs-keyword">uint32_t</span> AXEL_INT_MASK;
<span class="hljs-keyword">uint32_t</span> GERKON_INT_MASK;
<span class="hljs-keyword">uint32_t</span> MAGNET_INT_MASK;
<span class="hljs-keyword">float</span> ODR_1Hz6_LP_ONLY = <span class="hljs-number">1.6f</span>;
<span class="hljs-keyword">float</span> ODR_12Hz5 = <span class="hljs-number">12.5f</span>;
<span class="hljs-keyword">float</span> ODR_25Hz = <span class="hljs-number">25.0f</span>;
<span class="hljs-keyword">float</span> ODR_50Hz = <span class="hljs-number">50.0f</span>;
<span class="hljs-keyword">float</span> ODR_100Hz = <span class="hljs-number">100.0f</span>;
<span class="hljs-keyword">float</span> ODR_200Hz = <span class="hljs-number">200.0f</span>;
<span class="hljs-keyword">volatile</span> byte axelIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte gerkIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte magIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">volatile</span> byte buttIntStatus = <span class="hljs-number">0</span>;
<span class="hljs-keyword">uint16_t</span> batteryVoltage;
<span class="hljs-keyword">int16_t</span> linkQuality;
<span class="hljs-keyword">int16_t</span> old_linkQuality;<font></font>
<font></font>
<span class="hljs-comment">//#define MY_DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MY_DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_DISABLED_SERIAL</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_RADIO_NRF5_ESB</span>
<span class="hljs-keyword">int16_t</span> mtwr;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_TRANSPORT_WAIT_READY_MS (mtwr)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX)</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;MySensors.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"app_gpiote.h"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"nrf_gpio.h"</span></span><font></font>
}<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> APP_GPIOTE_MAX_USERS 1</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">app_gpiote_user_id_t</span> m_gpiote_user_id;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;LIS2DW12Sensor.h&gt;</span></span><font></font>
LIS2DW12Sensor *lis2;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DWS_CHILD_ID 0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> V_SENS_CHILD_ID 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> M_CHILD_ID 2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LEVEL_SENSIV_V_SENS_CHILD_ID 230</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SIGNAL_Q_ID 250</span><font></font>
<font></font>
<span class="hljs-function">MyMessage <span class="hljs-title">dwsMsg</span><span class="hljs-params">(DWS_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">mMsg</span><span class="hljs-params">(M_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">vibroMsg</span><span class="hljs-params">(V_SENS_CHILD_ID, V_TRIPPED)</span></span>;
<span class="hljs-function">MyMessage <span class="hljs-title">conf_vsensMsg</span><span class="hljs-params">(LEVEL_SENSIV_V_SENS_CHILD_ID, V_VAR1)</span></span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SN <span class="hljs-meta-string">"DOOR &amp; WINDOW SENS"</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SV <span class="hljs-meta-string">"1.12"</span></span><font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span> </span>{<font></font>
  board_Init();<font></font>
  happy_init();<font></font>
  delay(<span class="hljs-number">500</span>);<font></font>
  batteryVoltage = hwCPUVoltage();<font></font>
  digitalWrite(BLUE_LED, LOW);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">presentation</span><span class="hljs-params">()</span>
</span>{<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">10</span>);<font></font>
<font></font>
  check = sendSketchInfo(SN, SV);<font></font>
  wait(<span class="hljs-number">30</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">30</span>);<font></font>
    check = sendSketchInfo(SN, SV);<font></font>
    wait(<span class="hljs-number">30</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(DWS_CHILD_ID, S_DOOR, <span class="hljs-string">"STATUS RS SENS"</span>);<font></font>
  wait(<span class="hljs-number">40</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">40</span>);<font></font>
    check = present(DWS_CHILD_ID, S_DOOR, <span class="hljs-string">"STATUS RS SENS"</span>);<font></font>
    wait(<span class="hljs-number">40</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(V_SENS_CHILD_ID, S_VIBRATION, <span class="hljs-string">"STATUS SHOCK SENS"</span>);<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    check = present(V_SENS_CHILD_ID, S_VIBRATION, <span class="hljs-string">"STATUS SHOCK SENS"</span>);<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(M_CHILD_ID, S_DOOR, <span class="hljs-string">"ANTI-MAGNET ALARM"</span>);<font></font>
  wait(<span class="hljs-number">60</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">60</span>);<font></font>
    check = present(M_CHILD_ID, S_DOOR, <span class="hljs-string">"ANTI-MAGNET ALARM"</span>);<font></font>
    wait(<span class="hljs-number">60</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(SIGNAL_Q_ID, S_CUSTOM, <span class="hljs-string">"SIGNAL %"</span>);<font></font>
  wait(<span class="hljs-number">70</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">70</span>);<font></font>
    check = present(SIGNAL_Q_ID, S_CUSTOM, <span class="hljs-string">"SIGNAL %"</span>);<font></font>
    wait(<span class="hljs-number">70</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = present(LEVEL_SENSIV_V_SENS_CHILD_ID, S_CUSTOM, <span class="hljs-string">"SENS LEVEL VIBRO"</span>);<font></font>
  wait(<span class="hljs-number">80</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">80</span>);<font></font>
    check = present(LEVEL_SENSIV_V_SENS_CHILD_ID, S_CUSTOM, <span class="hljs-string">"SENS LEVEL VIBRO"</span>);<font></font>
    wait(<span class="hljs-number">80</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
<font></font>
  check = send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
  wait(<span class="hljs-number">90</span>);
  <span class="hljs-keyword">if</span> (!check) {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    wait(<span class="hljs-number">90</span>);<font></font>
    check = send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
    wait(<span class="hljs-number">90</span>);<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (check) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">10</span>);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{<font></font>
  digitalWrite(BLUE_LED, HIGH);<font></font>
  config_Happy_node();<font></font>
  sensors_Init();<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (flag_update_transport_param == <span class="hljs-number">1</span>) {<font></font>
    update_Happy_transport();<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (flag_sendRoute_parent == <span class="hljs-number">1</span>) {<font></font>
    present_only_parent();<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">if</span> (flag_find_parent_process == <span class="hljs-number">1</span>) {<font></font>
        find_parent_process();<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (configMode == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> ((axelIntStatus == AXEL_INT) || (buttIntStatus == PIN_BUTTON) || (gerkIntStatus == GERKON_INT) || (magIntStatus == MAGNET_INT)) {<font></font>
          nosleep = <span class="hljs-number">1</span>;<font></font>
          newmillis = millis();<font></font>
          interrupt_time = newmillis - oldmillis;<font></font>
          BATT_TIME = BATT_TIME - interrupt_time;<font></font>
          <span class="hljs-keyword">if</span> (BATT_TIME &lt; <span class="hljs-number">60000</span>) {<font></font>
            BATT_TIME = SLEEP_TIME;<font></font>
            batteryVoltage = hwCPUVoltage();<font></font>
            batt_flag = <span class="hljs-number">1</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (gerkIntStatus == GERKON_INT) {<font></font>
            send_Gerkon();<font></font>
            axel_time = millis();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (magIntStatus == MAGNET_INT) {<font></font>
            send_Magnet();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (axelIntStatus == AXEL_INT) {
            <span class="hljs-keyword">if</span> (millis() - axel_time0 &gt;= <span class="hljs-number">2000</span>) {<font></font>
              send_Axel();<font></font>
              nosleep = <span class="hljs-number">0</span>;<font></font>
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == LOW) {<font></font>
                send_Gerkon();<font></font>
                axel_time = millis();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> (buttIntStatus == PIN_BUTTON) {
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">0</span>) {<font></font>
              button_flag = <span class="hljs-number">1</span>;<font></font>
              previousMillis = millis();<font></font>
              ledsOff();<font></font>
            }<font></font>
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">0</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">1750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">70</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(BLUE_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) {<font></font>
                ledsOff();<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">3750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">50</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(GREEN_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">3750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) {<font></font>
                ledsOff();<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">5750</span>)) {
                <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">30</span>) {<font></font>
                  lightMillisR = millis();<font></font>
                  onoff = !onoff;<font></font>
                  digitalWrite(RED_LED, onoff);<font></font>
                }<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> (millis() - previousMillis &gt; <span class="hljs-number">5750</span>) {<font></font>
                ledsOff();<font></font>
              }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">1</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &lt;= <span class="hljs-number">1750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, BLUE_LED);<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
                presentation();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">3750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, GREEN_LED);<font></font>
                configMode = <span class="hljs-number">1</span>;<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                configMillis = millis();<font></font>
                interrupt_Init(<span class="hljs-number">1</span>);<font></font>
                NRF_POWER-&gt;DCDCEN = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
                NRF5_ESB_startListening();<font></font>
                wait(<span class="hljs-number">50</span>);<font></font>
              }<font></font>
<font></font>
              <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">5750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, RED_LED);
                <span class="hljs-comment">//new_device();</span><font></font>
              }<font></font>
<font></font>
              <span class="hljs-keyword">if</span> ((((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">3750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">5750</span>))) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
              {<font></font>
                ledsOff();<font></font>
                nosleep = <span class="hljs-number">0</span>;<font></font>
                button_flag = <span class="hljs-number">0</span>;<font></font>
                buttIntStatus = <span class="hljs-number">0</span>;<font></font>
              }<font></font>
            }<font></font>
          }<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
          batteryVoltage = hwCPUVoltage();<font></font>
          BATT_TIME = SLEEP_TIME;<font></font>
          sendBatteryStatus(<span class="hljs-number">1</span>);<font></font>
          nosleep = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (millis() - configMillis &gt; <span class="hljs-number">30000</span>) {<font></font>
          blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, GREEN_LED);<font></font>
          configMode = <span class="hljs-number">0</span>;<font></font>
          nosleep = <span class="hljs-number">0</span>;<font></font>
          interrupt_Init(<span class="hljs-number">0</span>);<font></font>
          NRF_POWER-&gt;DCDCEN = <span class="hljs-number">1</span>;<font></font>
          wait(<span class="hljs-number">50</span>);<font></font>
        }<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (buttIntStatus == PIN_BUTTON) {
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">0</span>) {<font></font>
          button_flag = <span class="hljs-number">1</span>;<font></font>
          nosleep = <span class="hljs-number">1</span>;<font></font>
          previousMillis = millis();<font></font>
          ledsOff();<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">0</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">0</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">1750</span>)) {
            <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">25</span>) {<font></font>
              lightMillisR = millis();<font></font>
              onoff = !onoff;<font></font>
              digitalWrite(GREEN_LED, onoff);<font></font>
            }<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) {<font></font>
            ledsOff();<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>)) {
            <span class="hljs-keyword">if</span> (millis() - lightMillisR &gt; <span class="hljs-number">25</span>) {<font></font>
              lightMillisR = millis();<font></font>
              onoff = !onoff;<font></font>
              digitalWrite(RED_LED, onoff);<font></font>
            }<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> (millis() - previousMillis &gt; <span class="hljs-number">4000</span>) {<font></font>
            ledsOff();<font></font>
          }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (digitalRead(PIN_BUTTON) == <span class="hljs-number">1</span> &amp;&amp; button_flag == <span class="hljs-number">1</span>) {
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &lt;= <span class="hljs-number">1750</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            blinky(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, BLUE_LED);<font></font>
            button_flag = <span class="hljs-number">0</span>;<font></font>
            buttIntStatus = <span class="hljs-number">0</span>;<font></font>
            check_parent();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
          <span class="hljs-keyword">if</span> ((millis() - previousMillis &gt; <span class="hljs-number">2000</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">4000</span>) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, RED_LED);
            <span class="hljs-comment">//new_device();</span><font></font>
          }<font></font>
<font></font>
          <span class="hljs-keyword">if</span> ((((millis() - previousMillis &gt; <span class="hljs-number">1750</span>) &amp;&amp; (millis() - previousMillis &lt;= <span class="hljs-number">2000</span>)) || ((millis() - previousMillis &gt; <span class="hljs-number">4000</span>))) &amp;&amp; (button_flag == <span class="hljs-number">1</span>))<font></font>
          {<font></font>
            ledsOff();<font></font>
            nosleep = <span class="hljs-number">0</span>;<font></font>
            button_flag = <span class="hljs-number">0</span>;<font></font>
            buttIntStatus = <span class="hljs-number">0</span>;<font></font>
          }<font></font>
        }<font></font>
      } <span class="hljs-keyword">else</span> {<font></font>
        check_parent();<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (_transportSM.failureCounter &gt; <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    _transportConfig.parentNodeId = loadState(<span class="hljs-number">101</span>);<font></font>
    _transportConfig.nodeId = myid;<font></font>
    _transportConfig.distanceGW = loadState(<span class="hljs-number">103</span>);<font></font>
    mypar = _transportConfig.parentNodeId;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
    flag_fcount = <span class="hljs-number">1</span>;<font></font>
    err_delivery_beat = <span class="hljs-number">6</span>;<font></font>
    happy_node_mode();<font></font>
    gateway_fail();<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (nosleep == <span class="hljs-number">0</span>) {<font></font>
    oldmillis = millis();<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    buttIntStatus = <span class="hljs-number">0</span>;<font></font>
    gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
    magIntStatus = <span class="hljs-number">0</span>;<font></font>
    sleep(SLEEP_TIME_W, <span class="hljs-literal">false</span>);<font></font>
    nosleep = <span class="hljs-number">1</span>;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">blinky</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> pulses, <span class="hljs-keyword">uint8_t</span> repit, <span class="hljs-keyword">uint8_t</span> ledColor)</span> </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>; x &lt; repit; x++) {
    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {<font></font>
      wait(<span class="hljs-number">150</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pulses; i++) {
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {<font></font>
        wait(<span class="hljs-number">40</span>);<font></font>
      }<font></font>
      digitalWrite(ledColor, LOW);<font></font>
      wait(<span class="hljs-number">10</span>);<font></font>
      digitalWrite(ledColor, HIGH);<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">board_Init</span><span class="hljs-params">()</span> </span>{<font></font>
  pinMode(PIN_BUTTON, INPUT_PULLUP);<font></font>
  pinMode(MAGNET_INT, INPUT);<font></font>
  pinMode(GERKON_INT, INPUT);<font></font>
  pinMode(AXEL_INT, INPUT);<font></font>
  pinMode(RED_LED, OUTPUT);<font></font>
  pinMode(GREEN_LED, OUTPUT);<font></font>
  pinMode(BLUE_LED, OUTPUT);<font></font>
  ledsOff();<font></font>
  NRF_POWER-&gt;DCDCEN = <span class="hljs-number">1</span>;<font></font>
  wait(<span class="hljs-number">5</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MY_DEBUG</span>
  NRF_UART0-&gt;ENABLE = <span class="hljs-number">0</span>;<font></font>
  wait(<span class="hljs-number">5</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-comment">//NRF_NFCT-&gt;TASKS_DISABLE = 1;</span>
  <span class="hljs-comment">// NRF_NVMC-&gt;CONFIG = 1;</span>
  <span class="hljs-comment">// NRF_UICR-&gt;NFCPINS = 0;</span>
  <span class="hljs-comment">// NRF_NVMC-&gt;CONFIG = 0;</span>
  <span class="hljs-comment">// NRF_SAADC -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM0  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM1  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_PWM2  -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_TWIM1 -&gt;ENABLE = 0;</span>
  <span class="hljs-comment">// NRF_TWIS1 -&gt;ENABLE = 0;</span>
  NRF_RADIO-&gt;TXPOWER = <span class="hljs-number">8</span>;<font></font>
  wait(<span class="hljs-number">5</span>);<font></font>
<font></font>
  conf_vibro_set = loadState(<span class="hljs-number">230</span>);
  <span class="hljs-keyword">if</span> ((conf_vibro_set &gt; <span class="hljs-number">5</span>) || (conf_vibro_set == <span class="hljs-number">0</span>)) {<font></font>
    conf_vibro_set = <span class="hljs-number">2</span>;<font></font>
    saveState(<span class="hljs-number">230</span>, conf_vibro_set);<font></font>
  }<font></font>
<font></font>
  blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ledsOff</span><span class="hljs-params">()</span> </span>{<font></font>
  digitalWrite(RED_LED, HIGH);<font></font>
  digitalWrite(GREEN_LED, HIGH);<font></font>
  digitalWrite(BLUE_LED, HIGH);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">happy_init</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">//hwWriteConfig(EEPROM_NODE_ID_ADDRESS, 255); // ******************** checking the node config reset *************************</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (hwReadConfig(EEPROM_NODE_ID_ADDRESS) == <span class="hljs-number">0</span>) {<font></font>
    hwWriteConfig(EEPROM_NODE_ID_ADDRESS, <span class="hljs-number">255</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (loadState(<span class="hljs-number">100</span>) == <span class="hljs-number">0</span>) {<font></font>
    saveState(<span class="hljs-number">100</span>, <span class="hljs-number">255</span>);<font></font>
  }<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"EEPROM NODE ID: %d\n"</span>), hwReadConfig(EEPROM_NODE_ID_ADDRESS));<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"USER MEMORY SECTOR NODE ID: %d\n"</span>), loadState(<span class="hljs-number">100</span>));<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (hwReadConfig(EEPROM_NODE_ID_ADDRESS) == <span class="hljs-number">255</span>) {<font></font>
    mtwr = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    mtwr = <span class="hljs-number">11000</span>;<font></font>
    no_present();<font></font>
  }<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MY_TRANSPORT_WAIT_MS: %d\n"</span>), mtwr);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">no_present</span><span class="hljs-params">()</span> </span>{<font></font>
  _coreConfig.presentationSent = <span class="hljs-literal">true</span>;<font></font>
  _coreConfig.nodeRegistered = <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">interrupt_Init</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> start)</span> </span>{
  <span class="hljs-comment">//***</span>
  <span class="hljs-comment">//SET</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_NOPULL</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_PULLUP</span>
  <span class="hljs-comment">//NRF_GPIO_PIN_PULLDOWN</span>
  <span class="hljs-comment">//***</span><font></font>
  nrf_gpio_cfg_input(PIN_BUTTON, NRF_GPIO_PIN_PULLUP);<font></font>
  nrf_gpio_cfg_input(AXEL_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  nrf_gpio_cfg_input(GERKON_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  nrf_gpio_cfg_input(MAGNET_INT, NRF_GPIO_PIN_NOPULL);<font></font>
  APP_GPIOTE_INIT(APP_GPIOTE_MAX_USERS);<font></font>
  PIN_BUTTON_MASK = <span class="hljs-number">1</span> &lt;&lt; PIN_BUTTON;<font></font>
  AXEL_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; AXEL_INT;<font></font>
  GERKON_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; GERKON_INT;<font></font>
  MAGNET_INT_MASK = <span class="hljs-number">1</span> &lt;&lt; MAGNET_INT;
  <span class="hljs-comment">//  app_gpiote_user_register(p_user_id, pins_low_to_high_mask, pins_high_to_low_mask, event_handler)</span>
  <span class="hljs-keyword">if</span> (start == <span class="hljs-number">0</span>) {<font></font>
    app_gpiote_user_register(&amp;m_gpiote_user_id, AXEL_INT_MASK | GERKON_INT_MASK, GERKON_INT_MASK | MAGNET_INT_MASK | PIN_BUTTON_MASK, gpiote_event_handler);<font></font>
    wait(<span class="hljs-number">5</span>);<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (start == <span class="hljs-number">1</span>) {<font></font>
    app_gpiote_user_register(&amp;m_gpiote_user_id, GERKON_INT_MASK, GERKON_INT_MASK | MAGNET_INT_MASK | PIN_BUTTON_MASK, gpiote_event_handler);<font></font>
    wait(<span class="hljs-number">5</span>);<font></font>
  }<font></font>
  app_gpiote_user_enable(m_gpiote_user_id);<font></font>
  wait(<span class="hljs-number">5</span>);<font></font>
  axelIntStatus = <span class="hljs-number">0</span>;<font></font>
  buttIntStatus = <span class="hljs-number">0</span>;<font></font>
  gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
  magIntStatus = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gpiote_event_handler</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> event_pins_low_to_high, <span class="hljs-keyword">uint32_t</span> event_pins_high_to_low)</span>
</span>{<font></font>
  MY_HW_RTC-&gt;CC[<span class="hljs-number">0</span>] = (MY_HW_RTC-&gt;COUNTER + <span class="hljs-number">2</span>); <span class="hljs-comment">// Taken from d0016 example code, ends the sleep delay</span><font></font>
<font></font>
  <span class="hljs-keyword">if</span> (PIN_BUTTON_MASK &amp; event_pins_high_to_low) {
    <span class="hljs-keyword">if</span> ((buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>)) {<font></font>
      buttIntStatus = PIN_BUTTON;<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (AXEL_INT_MASK &amp; event_pins_low_to_high) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (door_status == <span class="hljs-number">1</span>)) {<font></font>
        axelIntStatus = AXEL_INT;<font></font>
        axel_time0 = millis();<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> ((GERKON_INT_MASK &amp; event_pins_low_to_high) || (GERKON_INT_MASK &amp; event_pins_high_to_low)) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>)) {<font></font>
        gerkIntStatus = GERKON_INT;<font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (MAGNET_INT_MASK &amp; event_pins_high_to_low) {
      <span class="hljs-keyword">if</span> ((axelIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (buttIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (gerkIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (magIntStatus == <span class="hljs-number">0</span>) &amp;&amp; (door_status == <span class="hljs-number">1</span>)) {<font></font>
        magIntStatus = MAGNET_INT;<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sensors_Init</span><span class="hljs-params">()</span> </span>{<font></font>
  Wire.begin();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
  lis2 = <span class="hljs-keyword">new</span> LIS2DW12Sensor (&amp;Wire);<font></font>
  vibro_Init();<font></font>
  <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == HIGH) {<font></font>
      door_status = <span class="hljs-number">1</span>;<font></font>
      interrupt_Init(<span class="hljs-number">0</span>);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      door_status = <span class="hljs-number">0</span>;<font></font>
      interrupt_Init(<span class="hljs-number">1</span>);<font></font>
    }<font></font>
    send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
<font></font>
    SLEEP_TIME_W = SLEEP_TIME;<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    buttIntStatus = <span class="hljs-number">0</span>;<font></font>
    gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
    magIntStatus = <span class="hljs-number">0</span>;<font></font>
    sendBatteryStatus(<span class="hljs-number">0</span>);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    axel_time = millis();<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    interrupt_Init(<span class="hljs-number">0</span>);<font></font>
    blinky(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, RED_LED);<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">config_Happy_node</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (mtwr == <span class="hljs-number">0</span>) {<font></font>
    myid = getNodeId();<font></font>
    saveState(<span class="hljs-number">100</span>, myid);<font></font>
    mypar = _transportConfig.parentNodeId;<font></font>
    old_mypar = mypar;<font></font>
    saveState(<span class="hljs-number">101</span>, mypar);<font></font>
    saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (mtwr != <span class="hljs-number">0</span>) {<font></font>
    myid = getNodeId();<font></font>
    <span class="hljs-keyword">if</span> (myid != loadState(<span class="hljs-number">100</span>)) {<font></font>
      saveState(<span class="hljs-number">100</span>, myid);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">true</span>) {<font></font>
      mypar = _transportConfig.parentNodeId;<font></font>
      <span class="hljs-keyword">if</span> (mypar != loadState(<span class="hljs-number">101</span>)) {<font></font>
        saveState(<span class="hljs-number">101</span>, mypar);<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (_transportConfig.distanceGW != loadState(<span class="hljs-number">102</span>)) {<font></font>
        saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
      }<font></font>
      present_only_parent();<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (isTransportReady() == <span class="hljs-literal">false</span>)<font></font>
    {<font></font>
      no_present();<font></font>
      flag_fcount = <span class="hljs-number">1</span>;<font></font>
      err_delivery_beat = <span class="hljs-number">6</span>;<font></font>
      _transportConfig.nodeId = myid;<font></font>
      _transportConfig.parentNodeId = loadState(<span class="hljs-number">101</span>);<font></font>
      _transportConfig.distanceGW = loadState(<span class="hljs-number">102</span>);<font></font>
      mypar = _transportConfig.parentNodeId;<font></font>
      happy_node_mode();<font></font>
      gateway_fail();<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Axel</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (millis() - axel_time &gt;= <span class="hljs-number">5000</span>) {<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
    blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
<font></font>
    send_a = send(vibroMsg.<span class="hljs-built_in">set</span>(vibro));<font></font>
    wait(<span class="hljs-number">50</span>);
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
      send_a = send(vibroMsg.<span class="hljs-built_in">set</span>(vibro));<font></font>
      wait(<span class="hljs-number">100</span>);<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
        flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
        err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
        err_delivery_beat++;<font></font>
      }<font></font>
      <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
        <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
          gateway_fail();<font></font>
          CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
        }<font></font>
      }<font></font>
    }<font></font>
    axel_time = millis();<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    axelIntStatus = <span class="hljs-number">0</span>;<font></font>
    nosleep = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Gerkon</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (digitalRead(GERKON_INT) == HIGH) {<font></font>
    door_status = <span class="hljs-number">1</span>;<font></font>
    interrupt_Init(<span class="hljs-number">0</span>);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    door_status = <span class="hljs-number">0</span>;<font></font>
    interrupt_Init(<span class="hljs-number">1</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (door_status == <span class="hljs-number">1</span>) {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, GREEN_LED);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    blinky(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  }<font></font>
  send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
    send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
    wait(<span class="hljs-number">100</span>);
    <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
      send_a = send(dwsMsg.<span class="hljs-built_in">set</span>(door_status));<font></font>
      wait(<span class="hljs-number">150</span>);<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
    err_delivery_beat = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
      flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
      err_delivery_beat++;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
        gateway_fail();<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  gerkIntStatus = <span class="hljs-number">0</span>;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">send_Magnet</span><span class="hljs-params">()</span> </span>{<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, BLUE_LED);<font></font>
  blinky(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, RED_LED);<font></font>
  send_a = send(mMsg.<span class="hljs-built_in">set</span>(magnet_status));<font></font>
  wait(<span class="hljs-number">50</span>);
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">false</span>) {<font></font>
    send_a = send(mMsg.<span class="hljs-built_in">set</span>(magnet_status));<font></font>
    wait(<span class="hljs-number">100</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (send_a == <span class="hljs-literal">true</span>) {<font></font>
    err_delivery_beat = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">1</span>) {<font></font>
      flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: NORMAL GATEWAY MODE\n"</span>));<font></font>
      err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (err_delivery_beat &lt; <span class="hljs-number">6</span>) {<font></font>
      err_delivery_beat++;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span> (err_delivery_beat == <span class="hljs-number">5</span>) {
      <span class="hljs-keyword">if</span> (flag_nogateway_mode == <span class="hljs-number">0</span>) {<font></font>
        gateway_fail();<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: LOST GATEWAY MODE\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  magIntStatus = <span class="hljs-number">0</span>;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">new_device</span><span class="hljs-params">()</span> </span>{<font></font>
  hwWriteConfig(EEPROM_NODE_ID_ADDRESS, <span class="hljs-number">255</span>);<font></font>
  saveState(<span class="hljs-number">100</span>, <span class="hljs-number">255</span>);<font></font>
  wdt_enable(WDTO_15MS);<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update_Happy_transport</span><span class="hljs-params">()</span> </span>{<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: UPDATE TRANSPORT CONFIGURATION\n"</span>));<font></font>
  mypar = _transportConfig.parentNodeId;<font></font>
  <span class="hljs-keyword">if</span> (mypar != loadState(<span class="hljs-number">101</span>))<font></font>
  {<font></font>
    saveState(<span class="hljs-number">101</span>, mypar);<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (_transportConfig.distanceGW != loadState(<span class="hljs-number">102</span>))<font></font>
  {<font></font>
    saveState(<span class="hljs-number">102</span>, _transportConfig.distanceGW);<font></font>
  }<font></font>
  present_only_parent();<font></font>
  wait(<span class="hljs-number">50</span>);<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
  flag_update_transport_param = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">present_only_parent</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (old_mypar != mypar) {<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: SEND LITTLE PRESENT:) WITH PARENT ID\n"</span>));
    <span class="hljs-keyword">if</span> (_sendRoute(build(_msgTmp, <span class="hljs-number">0</span>, NODE_SENSOR_ID, C_INTERNAL, <span class="hljs-number">6</span>).<span class="hljs-built_in">set</span>(mypar))) {<font></font>
      flag_sendRoute_parent = <span class="hljs-number">0</span>;<font></font>
      old_mypar = mypar;<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      flag_sendRoute_parent = <span class="hljs-number">1</span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">happy_node_mode</span><span class="hljs-params">()</span> </span>{<font></font>
  _transportSM.findingParentNode = <span class="hljs-literal">false</span>;<font></font>
  _transportSM.transportActive = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.uplinkOk = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.pingActive = <span class="hljs-literal">false</span>;<font></font>
  _transportSM.failureCounter = <span class="hljs-number">0</span>;<font></font>
  _transportSM.uplinkOk = <span class="hljs-literal">true</span>;<font></font>
  _transportSM.failureCounter = <span class="hljs-number">0u</span>;<font></font>
  _transportSM.failedUplinkTransmissions = <span class="hljs-number">0u</span>;<font></font>
  transportSwitchSM(stReady);<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"TRANSPORT: %d\n"</span>), isTransportReady());<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">gateway_fail</span><span class="hljs-params">()</span> </span>{<font></font>
  flag_nogateway_mode = <span class="hljs-number">1</span>;<font></font>
  flag_update_transport_param = <span class="hljs-number">0</span>;<font></font>
  SLEEP_TIME_W = SLEEP_NOGW;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">check_parent</span><span class="hljs-params">()</span> </span>{<font></font>
  _transportSM.findingParentNode = <span class="hljs-literal">true</span>;<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: SEND FIND PARENT REQUEST, WAIT RESPONSE\n"</span>));<font></font>
  _sendRoute(build(_msg, <span class="hljs-number">255</span>, NODE_SENSOR_ID, C_INTERNAL, <span class="hljs-number">7</span>).<span class="hljs-built_in">set</span>(<span class="hljs-string">""</span>));<font></font>
  wait(<span class="hljs-number">1500</span>, C_INTERNAL, <span class="hljs-number">8</span>);
  <span class="hljs-keyword">if</span> (_msg.sensor == <span class="hljs-number">255</span>) {
    <span class="hljs-keyword">if</span> (mGetCommand(_msg) == <span class="hljs-number">3</span>) {
      <span class="hljs-keyword">if</span> (_msg.type == <span class="hljs-number">8</span>) {<font></font>
        Ack_FP = <span class="hljs-number">1</span>;<font></font>
        CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: PARENT RESPONSE FOUND\n"</span>));<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (Ack_FP == <span class="hljs-number">1</span>) {<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: FIND PARENT PROCESS\n"</span>));<font></font>
    Ack_FP = <span class="hljs-number">0</span>;<font></font>
    transportSwitchSM(stParent);<font></font>
    flag_nogateway_mode = <span class="hljs-number">0</span>;<font></font>
    flag_find_parent_process = <span class="hljs-number">1</span>;<font></font>
    problem_mode_count = <span class="hljs-number">0</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    _transportSM.findingParentNode = <span class="hljs-literal">false</span>;<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: PARENT RESPONSE NOT FOUND\n"</span>));<font></font>
    _transportSM.failedUplinkTransmissions = <span class="hljs-number">0</span>;<font></font>
    CORE_DEBUG(PSTR(<span class="hljs-string">"TRANSPORT: %d\n"</span>), isTransportReady());<font></font>
    nosleep = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (problem_mode_count &lt; <span class="hljs-number">9</span>) {<font></font>
      CORE_DEBUG(PSTR(<span class="hljs-string">"PROBLEM MODE COUNTER: %d\n"</span>), problem_mode_count);<font></font>
      problem_mode_count++;<font></font>
      SLEEP_TIME_W = SLEEP_TIME_W + SLEEP_TIME_W;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">find_parent_process</span><span class="hljs-params">()</span> </span>{<font></font>
  flag_update_transport_param = <span class="hljs-number">1</span>;<font></font>
  flag_find_parent_process = <span class="hljs-number">0</span>;<font></font>
  CORE_DEBUG(PSTR(<span class="hljs-string">"MyS: STANDART TRANSPORT MODE IS RESTORED\n"</span>));<font></font>
  err_delivery_beat = <span class="hljs-number">0</span>;<font></font>
  SLEEP_TIME_W = SLEEP_TIME;<font></font>
  nosleep = <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sendBatteryStatus</span><span class="hljs-params">(<span class="hljs-keyword">bool</span> start)</span> </span>{<font></font>
  batt_cap = battery_level_in_percent(batteryVoltage);<font></font>
  <span class="hljs-keyword">if</span> (start == <span class="hljs-number">1</span>) {
    <span class="hljs-comment">//if (batt_cap &lt; old_batt_cap) {</span>
    sendBatteryLevel(battery_level_in_percent(batteryVoltage), <span class="hljs-number">1</span>);<font></font>
    wait(<span class="hljs-number">1500</span>, C_INTERNAL, I_BATTERY_LEVEL);<font></font>
    old_batt_cap = batt_cap;<font></font>
    <span class="hljs-comment">// }</span>
  } <span class="hljs-keyword">else</span> {<font></font>
    sendBatteryLevel(battery_level_in_percent(batteryVoltage), <span class="hljs-number">1</span>);<font></font>
    wait(<span class="hljs-number">1500</span>, C_INTERNAL, I_BATTERY_LEVEL);<font></font>
  }<font></font>
<font></font>
  linkQuality = calculationRxQuality();<font></font>
  <span class="hljs-keyword">if</span> (linkQuality != old_linkQuality) {<font></font>
    wait(<span class="hljs-number">10</span>);<font></font>
    sendSignalStrength(linkQuality);<font></font>
    wait(<span class="hljs-number">50</span>);<font></font>
    old_linkQuality = linkQuality;<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">sendSignalStrength</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int16_t</span> level, <span class="hljs-keyword">const</span> <span class="hljs-keyword">bool</span> ack)</span>
</span>{
  <span class="hljs-keyword">return</span> _sendRoute(build(_msgTmp, GATEWAY_ADDRESS, SIGNAL_Q_ID, C_SET, V_VAR1,<font></font>
                          ack).<span class="hljs-built_in">set</span>(level));<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">int16_t</span> <span class="hljs-title">calculationRxQuality</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">int16_t</span> nRFRSSI_temp = transportGetReceivingRSSI();
  <span class="hljs-keyword">int16_t</span> nRFRSSI = <span class="hljs-built_in">map</span>(nRFRSSI_temp, <span class="hljs-number">-85</span>, <span class="hljs-number">-40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
  <span class="hljs-keyword">if</span> (nRFRSSI &lt; <span class="hljs-number">0</span>) {<font></font>
    nRFRSSI = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (nRFRSSI &gt; <span class="hljs-number">100</span>) {<font></font>
    nRFRSSI = <span class="hljs-number">100</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> nRFRSSI;<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">receive</span><span class="hljs-params">(<span class="hljs-keyword">const</span> MyMessage &amp; message)</span>
</span>{
  <span class="hljs-keyword">if</span> (message.sensor == LEVEL_SENSIV_V_SENS_CHILD_ID) {
    <span class="hljs-keyword">if</span> (message.type == V_VAR1) {<font></font>
      conf_vibro_set = message.getByte();<font></font>
      vibro_Init();<font></font>
      saveState(<span class="hljs-number">230</span>, conf_vibro_set);<font></font>
      wait(<span class="hljs-number">200</span>);<font></font>
      send(conf_vsensMsg.<span class="hljs-built_in">set</span>(conf_vibro_set));<font></font>
      wait(<span class="hljs-number">200</span>);<font></font>
      blinky(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, GREEN_LED);<font></font>
      configMode = <span class="hljs-number">0</span>;<font></font>
      nosleep = <span class="hljs-number">0</span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vibro_Init</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">1</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_1Hz6_LP_ONLY;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">2</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_12Hz5;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">3</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_25Hz;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">4</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_100Hz;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (conf_vibro_set == <span class="hljs-number">5</span>) {<font></font>
    lis2-&gt;ODRTEMP = ODR_200Hz;<font></font>
  }<font></font>
  lis2-&gt;Enable_X();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
  lis2-&gt;Enable_Wake_Up_Detection();<font></font>
  wait(<span class="hljs-number">100</span>);<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреВрд░реА рд╕реВрдЪреА </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрд┐рдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпреВрдбреА рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЬрд░реНрдбреЛрдореЛ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реВрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рд╡рд░реНрдгрди рдХрд░реВрдБрдЧрд╛ рдХрд┐ UD рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдореЗрдиреНрд╕реЗрдВрд╕рд░реНрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕реЗрдВрд╕рд░ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдЕрд╡рддрд╛рд░ рдореЗрдВ, рд╕реЗрдВрд╕рд░ рд╕реЗ рдбреЗрдЯрд╛ рдпреВрдбреА рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдореЗрдпреЗрдВрд╕рд░реНрд╕ рдЧреЗрдЯрд╡реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдорд╛рдЬрд░реНрдбреЛрдореЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЕрд▓рдЧ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореИрд╕реЗрдВрд╕рд░реНрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓ "рдЙрдкрдХрд░рдг" рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдпреВрдбреА рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдРрдб-рдСрди рдмрд╛рдЬрд╛рд░ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред </font></font><br>
<img src="https://habrastorage.org/webt/22/ho/ia/22hoiaoqgc-wbzualelk3bhxks8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд▓рд╣рд╛рд▓, рдореЗрдЬрд░рдбреЛрдореЛ рдпреВрдбреА рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕рдмрд╕реЗ рдкреВрд░реНрдг, рд╕рдорд░реНрдерд┐рдд рд╣реИ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА mesensors рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OTA рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдореЙрдбреНрдпреВрд▓ (рдорд▓реНрдЯреА-рдЧреЗрдЯ) рдореЗрдВ рдПрдХ рд╕рд╛рде рдХрдИ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рдирд╛, </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SmartSleep рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рд╕рдорд░реНрдерди, </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЙрдбреНрдпреВрд▓ рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕реЗрдВрд╕рд░ рд╕реЗ рдбреЗрдЯрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ, </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрджреЗрд╢ рд╡рд┐рддрд░рдг рдкреБрд╖реНрдЯрд┐рдХрд░рдг рдЕрдиреБрд░реЛрдз, </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрд╡рд╛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди, рдЬреИрд╕реЗ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣, рджрд┐рд▓ рдХреА рдзрдбрд╝рдХрди, рдкреНрд░рд╕реНрддреБрддрд┐, рд░рд┐рдмреВрдЯ,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NodeManager рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╛рдареНрдпрдХреНрд░рдо рдХреА рдЦрд╛рдорд┐рдпрд╛рдВ рд╣реИрдВ, рд╕реАрд░рд┐рдпрд▓ рдЧреЗрдЯрд╡реЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╕рдорд░реНрдерди, рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдкреНрд░рд╛рдХреГрддрд┐рдХ рд╡рд┐рдХрд╛рд╕ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рдореЗрдЬрд░рдбреЛрдореЛ рдиреЗ рдПрдХ рд▓рдВрдмреЗ рдЬреАрд╡рди рдХрд╛ рдЖрджреЗрд╢ рджрд┐рдпрд╛ рдФрд░ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдореБрдЭреЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдлрд╛рдЯрдХреЛрдВ рдХреЛ рдорд╛рдЬрд░реНрдбреЛрдореЛ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХрд╛ рднреА рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓рд╛, рдХреНрдпреЛрдВрдХрд┐ рдореИрд╕реЗрдВрд╕рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдЪрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдЕрдиреБрдкрд▓рдмреНрдз рд╣реЛ рдЧрдИ рдереАред </font><font style="vertical-align: inherit;">рдореЙрдбреНрдпреВрд▓ рдбреЗрд╡рд▓рдкрд░ рдиреЗ рд╕рд┐рддрдВрдмрд░ 2019 рддрдХ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди 19 рд╡реАрдВ рдХреА рдЧрд┐рд░рд╛рд╡рдЯ рдмреАрдд рдЪреБрдХреА рд╣реИ, рдФрд░ рдЧреЗрдЯрд╡реЗ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд▓рд┐рдП рдЕрднреА рднреА рдХреЛрдИ рд╕рдорд░реНрдерди рдирд╣реАрдВ рд╣реИ :(ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдореЗрдЬрд░рдбреЛрдореЛ рдХреЗ рд╕рд╛рде рдореИрд╕реЗрдВрдЬрд░ mqtt рдЧреЗрдЯрд╡реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореИрд╕реЗрдВрдЬрд░ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ MQTT рдореЙрдбреНрдпреВрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрд░реЗ рд╕реЗрдВрд╕рд░ рдореЗрдВ, рд╕рджрдореЗ рдФрд░ рдЪреБрдВрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░ рд╕реЗрдВрд╕рд░ рдХреЗрд╡рд▓ рдПрдХ рдЗрдХрд╛рдИ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ, рдЬрдм рдпрд╣ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдПрдХ рдЫреЛрдЯреА рд╕рдорд╕реНрдпрд╛ рдмрди рдЧрдИред рд╕рд┐рдВрдкрд▓ рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ рдореЙрдбреНрдпреВрд▓ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реЗрдВрд╕рд░ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдмреЗрд╢рдХ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрдВрд╕рд░ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдмрд╣реБрдд рд╕реАрдорд┐рдд рд╣реИред рд╕реЗрдВрд╕рд░ рдЬреЛрдбрд╝рддреЗ рд╕рдордп, рдПрдХ рдЕрд╕рд╣рдЬ рд╕рдорд╕реНрдпрд╛ рдпрд╣ рдереА рдХрд┐ рдЬрдм рдЕрдЧрд▓реА рдЗрдХрд╛рдИ рд╕реЗрдВрд╕рд░ рд╕реЗ рдЖрдИ рдереА, рддреЛ рдореБрдЭреЗ рдПрдХ рд░рд┐рд╡рд░реНрд╕ рдЯрд╛рдЗрдорд░ рд╢реБрд░реВ рдХрд░рдирд╛ рдерд╛ рддрд╛рдХрд┐ рдЯрд╛рдЗрдорд░ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдПрдХ рд╕рдордп рдЕрдВрддрд░рд╛рд▓ рдХреЗ рдмрд╛рдж, рд╢реВрдиреНрдп рдХреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░реЙрдкрд░реНрдЯреА рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рдПред рд▓реЗрдХрд┐рди рдЬрдм рд╕реЗ рд╕рдм рдХреБрдЫ "рд╕реНрдерд┐рддрд┐ рдЕрджреНрдпрддрди" рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддрдм рд╢реВрдиреНрдп рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ, meysensors рдореЙрдбреНрдпреВрд▓ рдПрдХ рдирдпрд╛ рд░рд╛рдЬреНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрд╛ рдореЗрд░реА рдбрд┐рд╡рд╛рдЗрд╕, рдФрд░ рдмрд┐рдВрджреБ рд╢реВрдиреНрдп рд╣реИредрд╕рдмрд╕реЗ рд╕рд░рд▓ рд╕рдорд╛рдзрд╛рди рдореБрдЭреЗ рдПрдХ рдирдИ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рдЧ рд░рд╣рд╛ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░реЙрдкрд░реНрдЯреА 1 рд╕реЗ рдкреНрд░реЙрдкрд░реНрдЯреА 2 рддрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдкреНрд░реЙрдкрд░реНрдЯреА 2 рдХреЛ рд╢реВрдиреНрдп рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯрд╛рдЗрдорд░ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд╕рд░рд▓ рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рдмрдирд╛рдИ рдЧрдИ рдХреЛрдИ рд╡рд╕реНрддреБ рдкреНрд░реЙрдкрд░реНрдЯреА 2 рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдЧреА, рдФрд░ рдкреНрд░реЙрдкрд░реНрдЯреА 1 рдХреЗ рд╕рд╛рде рдореЗрдиреНрд╕реЗрдВрд╕рд░реНрд╕ рдореЙрдбреНрдпреВрд▓ рдореЗрдВред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ne/n0/ui/nen0uibfj0kw4wuupvbxr9z7zoo.png"><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;getProperty(<span class="hljs-string">'value2'</span>) == <span class="hljs-string">'1'</span>){
<span class="hljs-keyword">$this</span>-&gt;setProperty(<span class="hljs-string">'status'</span>,<span class="hljs-string">'1'</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рдЗрдЪреНрдЫрд┐рдд рд╡рд╕реНрддреБ рдХреА рд╕реНрдерд┐рддрд┐ рдЕрджреНрдпрддрди рд╡рд┐рдзрд┐ рдореЗрдВ, рдЖрдкрдХреЛ рдПрдХ рдЯрд╛рдЗрдорд░ рдкреНрд░рд╛рд░рдВрдн рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">if</span> (gg(<span class="hljs-string">"MysensorsSmoke03.status"</span>) == <span class="hljs-string">"1"</span>) {<font></font>
SetTimeOut(<span class="hljs-string">'AlarmShock'</span>,<span class="hljs-string">'sg("MysensorsSmoke03.status","0");'</span>,<span class="hljs-number">10</span>);<font></font>
}<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЬрд░реНрдбреЛрдореЛ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рдореЗрдЬрд╝рд░реЙрдЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ </font><b><font style="vertical-align: inherit;">рд╕реЗрдВрд╕рд░ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд╕рд╛рде рд╡реАрдбрд┐рдпреЛ</font></b><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдореЗрд░рд╛ рд╕реБрдЭрд╛рд╡ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕реЗ рджреЗрдЦреЗрдВ, рдЬрд╣рд╛рдВ рднреА рд╕рдВрднрд╡ рд╣реЛ, рдореБрдЦреНрдп рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреА рдкрд╕рдВрдж рдФрд░ рд╕рджрд╕реНрдпрддрд╛ рдореЗрд░реЗ рдЫреЛрдЯреЗ рдШрд░ рдЪреИрдирд▓ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЕрдореВрд▓реНрдп рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдШрдВрдЯреА рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдЖрдк рдореЗрд░реЗ рдирдП рд╕реЗрдВрд╕рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╡реАрдбрд┐рдпреЛ рдХреЛ рдпрд╛рдж рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ;)</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OmclWv2vLog" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рд╡рд╛рдЗрд╕ рдмреЛрд░реНрдб рдХреЛ рдбреАрдкреНрд░реЗрд╕ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╕рдВрдкрд╛рджрдХ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдиреЗ рдПрдХ рдмрд╛рд░ рдореБрдЭреЗ рдЕрдкрдиреА рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреАред </font><font style="vertical-align: inherit;">рдореИрдВ рдзреНрдпрд╛рди рджреЗрддрд╛ рд╣реВрдВ рдХрд┐ рдореИрдВ рдПрдХ рдкреЗрд╢реЗрд╡рд░ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХреНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░ рдирд╣реАрдВ рд╣реВрдВ, рдорджрд░рдмреЛрд░реНрдб рдХреЗ рдШрд░ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдореЗрд░рд╛ рдЕрдиреБрднрд╡ рдбреЗрдврд╝ рдпрд╛ рджреЛ рд╕рд╛рд▓ рдХрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрди рд╕рднреА рдХреЗ рд▓рд┐рдП рдЬреЛ рдмреНрд░реЗрдбрдмреЛрд░реНрдб рдкрд░ рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдмрдирд╛рддреЗ рд╣реИрдВ, рдореИрдВ рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВ рдХрд┐ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрдкрд╛рджрдХ рдХреЛ рд╕реАрдЦрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, YouTube рд╡реАрдбрд┐рдпреЛ рдореИрдиреБрдЕрд▓ рд╕реЗ рднрд░рд╛ рд╣реИред</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qh/qn/oc/qhqnocyny82yvitjx84lso-irzo.png"><br>
<br>
<img src="https://habrastorage.org/webt/dw/vi/ez/dwviez3dctkm_yuxfawnlto9lrm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрд╕реЗрдВрд╕рд░ рдореЗрдВ nRF5 рдЪрд┐рдкреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рд╕рдВрджреАрдк рдорд┐рд╕реНрддреНрд░реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ - arduino-nRF5ред рд▓реЗрдХрд┐рди рдЗрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ nRF52840, nRF52810 рдЪрд┐рдкреНрд╕ рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирдП nRF52811 рдЪрд┐рдкреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХрд╛ рдЕрднрд╛рд╡ рд╣реИред рдореБрдЭреЗ рдЗрди рдЪрд┐рдкреНрд╕ рдХреЗ рд▓рд┐рдП рдХрд╛рдВрдЯрд╛ рдФрд░ рд╕рдорд░реНрдерди рдЬреЛрдбрд╝рдирд╛ рдерд╛, рдиреЙрд░реНрдбрд┐рдХ рдПрд╕рдбреАрдХреЗ рд╕реЗ рдПрдХ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдФрд░ рдЕрдиреБрдХреВрд▓рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдирд░рдо рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рдореИрд╕реЗрдВрд╕рд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╡рд┐рд╢реЗрд╖ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдФрд░ nRF52840 рдЪрд┐рдкреНрд╕ рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ 1 рдХрд╛ рдХреЛрдИ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдерд╛ред рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдореЗрд░рд╛ рд╢реЛрдз рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд╕реЗрдВрд╕рд░ рд╕рдореБрджрд╛рдп</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдПрдХ рдЕрдиреНрдп </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рд╕рджрд╕реНрдп рдХреЗ</font></a><font style="vertical-align: inherit;"> рдЕрдиреБрд╕рдВрдзрд╛рди </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдХреЛ рдорд┐рд▓рд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛,</font></a><font style="vertical-align: inherit;"> рдФрд░ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, nRF52840 рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА port1 рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдкрд┐рди рд╕рд┐рд░реНрдл рдПрдХ рд╕рдореБрджреНрд░ рдмрди рдЧрдпрд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЙрд▓рд┐рдбрд╡рд░реНрдХреНрд╕ рдХрд╛рд░реНрдпрдХреНрд░рдо рдореЗрдВ рд╕реЗрдВрд╕рд░ рдХреЗ рд▓рд┐рдП рдорд╛рдорд▓рд╛ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рд▓рдЧрднрдЧ рдПрдХ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдпреВрдЯреНрдпреВрдм рдкрд░ рдкрд╛рдареЛрдВ рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдорд╣рд╛рд░рдд рд╣рд╛рд╕рд┐рд▓ рдерд╛ред рдорд╛рдорд▓рд╛ рдХрд┐рд╕реА рднреА FOTON SLA рдкреНрд░рд┐рдВрдЯрд░ рдкрд░ рдореБрджреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдкреНрд░рд┐рдВрдЯ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдФрд░ рд╕рдЯреАрдХрддрд╛ рд╕реЗ рдореИрдВ рдмрд╣реБрдд рдЦреБрд╢ рдерд╛ред рдХреЗрд╡рд▓ рдирдХрд╛рд░рд╛рддреНрдордХ рдпреВрд╡реА рд░реЗрдЬрд┐рди рдХрд╛ рдПрдХ рдЦрд░рд╛рдм рд╡рд┐рдХрд▓реНрдк рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдРрд╕реЗ рдШрд░реЗрд▓реВ рдкреНрд░рд┐рдВрдЯрд░ рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдорд╛рдорд▓реЗ рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдЖрдпрд╛рдо: рд▓рдВрдмреЗ 43 рдорд┐рдореА, рдЪреМрдбрд╝рд╛рдИ 26 рдорд┐рдореА, рдКрдВрдЪрд╛рдИ 12.5 рдорд┐рдореАред рдЪреБрдВрдмрдХ рдХреЗ рд╕рд╛рде рдХреЗрд╕ рдЖрдпрд╛рдо: рд▓рдВрдмрд╛рдИ 37 рдорд┐рдореА, рдЪреМрдбрд╝рд╛рдИ 11 рдорд┐рдореА, рдКрдБрдЪрд╛рдИ 12.5 рдорд┐рдореАред </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/hm/97/myhm97dmggj8d7sdauhlx9oyk5c.png"><br>
<br>
<img src="https://habrastorage.org/webt/wz/9j/cy/wz9jcyajh87x1l7zlncvy_eb1sy.png"><br>
<br>
<img src="https://habrastorage.org/webt/e4/u-/rw/e4u-rwqymkdi701zplhs_b3kn-e.png"><br>
<br>
<img src="https://habrastorage.org/webt/r1/ve/h4/r1veh45ljjnvdwjlappikjgxr_g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рд╕рдкрдиреЗ рдореЗрдВ рд╕реЗрдВрд╕рд░ рдХреА рдЦрдкрдд 4 ╬╝A рд╕реЗ 7 ╬╝A рддрдХ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЪрдпрдирд┐рдд рдЪрд┐рдк рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдореЛрдб рдореЗрдВ рдЙрдкрднреЛрдЧ 8 mA рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрдВрд╕рд░ CR2032 рдмреИрдЯрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд╕рднреА рдорд╛рдк рдЪреАрдиреА "рдорд▓реНрдЯреАрдлрд╝рд┐рд▓реНрдЯрд░" рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдереЗ :) рдЗрд╕рдХреА рдмрдбрд╝реА рд▓рд╛рдЧрдд рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдкреНрд░реЛрдлрд╛рдЗрд▓рд░ рдХреА рдХрдореА рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП :(ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓рд┐рдЦрд┐рдд рд╕реНрдХреЗрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдпрд╛ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рд▓рд┐рдЦреЗрдВред </font><font style="vertical-align: inherit;">рд╕реЗрдВрд╕рд░ рдХреЛ рджреЛрд╣рд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЬреЛ рдХреБрдЫ рднреА рдЪрд╛рд╣рд┐рдП рд╡рд╣ рдореЗрд░реЗ рдЧреАрдереВрдм ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреЗрд░рдмрд░рд╕, рдХреЛрдб, рдХреЗрд╕ рдореЙрдбрд▓</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдкрд░ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдХреЛрдИ рд╡реНрдпрдХреНрддрд┐ ZIGBEE рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рддрд╣рдд рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ, рддреЛ рдореИрдВ рд╕рд╣рд░реНрд╖ рд╕рд╣рдпреЛрдЧ рдХрд░реВрдВрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рддрд╛рд░ рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛, рд╡рд╣рд╛рдБ рд╣рдореЗрд╢рд╛ рди рдХреЗрд╡рд▓ рдорд╛рд╣рд┐рд░ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рд╣реЛ рдЬрд╛рдПрдЧрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maysensors</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдпрд╣ рднреА </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zigbee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BLE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nRF5 рдкрд░, рд╡реЗ рддреБрд░рдВрдд Arduino рдЖрдИрдбреАрдИ рдореЗрдВ nRF52 рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдФрд░ рди рдХреЗрд╡рд▓ рдЙрд╕ рдореЗрдВ рд╕реЗ рд╕рднреА рдореБрджреНрджреЛрдВ рдкрд░ рд╕рд▓рд╛рд╣ рджреЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╣рд╛рдБ рдореИрдВ рд░рд╣рддрд╛ рд╣реВрдБ рдФрд░ рдореЗрд░реЗ рдЬреИрд╕реЗ рд▓реЛрдЧ - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@MYSENSORS_RUS рдЪреИрдЯ рдХрд░рддреЗ рд╣реИрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рднреА рдХреЛ рдЕрдЪреНрдЫрд╛!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi490464/index.html">рдмрд▓рдкреВрд░реНрд╡рдХ рдХреЙрдкреАрд░рд╛рдЗрдЯ рдпрд╛ 68 рдмрд┐рд▓рд┐рдпрди рдзреБрдиреЛрдВ рдХреЛ рднрдВрдЧ рдХрд░рдиреЗ рдХреЗ рдЕрд╕рдлрд▓ рдкреНрд░рдпрд╛рд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреЛ рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛</a></li>
<li><a href="../hi490466/index.html">рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЧрдгрд┐рддреАрдп рдЕрдиреБрд╢рд╛рд╕рди рдХрд╛ рд░реЛрдбрдореИрдк, рднрд╛рдЧ 2 (рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ)</a></li>
<li><a href="../hi490470/index.html">OWASP рдорд╛рд╕реНрдХреЛ 2020/1</a></li>
<li><a href="../hi490472/index.html">рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ PHP рдореЗрдВ рдПрдХ рдЕрд░реНрдз-рд╡рд┐рдХреЗрдиреНрджреНрд░реАрдХреГрдд cryptocurrency рд▓рд┐рдЦрд╛ рд╣реИред (рднрд╛рдЧ 1 - рдкреБрд╕реНрддрдХрд╛рд▓рдп рдПрдХрддреНрд░рд┐рдд рдХрд░рдирд╛)</a></li>
<li><a href="../hi490474/index.html">STM32 рднрд╛рдЧ 1: рдореВрд▓ рдмрд╛рддреЗрдВ</a></li>
<li><a href="../hi490478/index.html">DIY DIY рд╕реЛрд▓реНрдбрд░рд┐рдВрдЧ рд╕реНрдЯреЗрд╢рди v2</a></li>
<li><a href="../hi490480/index.html">2 рд╢рдмреНрджреЛрдВ рдореЗрдВ рдУ рдЯрд╛рдЗрд▓рд┐рдВрдЧ-рдбрдмреНрд▓реНрдпреВрдПрдо</a></li>
<li><a href="../hi490484/index.html">Google рд╕рд╣рд╛рдпрдХ рдХреЗ рд╕рд╛рде рд╕реНрдорд╛рд░реНрдЯ рд╣реЛрдо рд╕реЗрдВрд╕рд░ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдирд╛</a></li>
<li><a href="../hi490490/index.html">рд╕рдкреНрддрд╛рд╣рд╛рдВрдд рдкрдврд╝рдирд╛: рд╕реНрд╡рд╛рд╕реНрдереНрдп рдкрд░ рдзреНрд╡рдирд┐ рдХреЗ рдкреНрд░рднрд╛рд╡ рдкрд░ 10 рд╕рд╛рдордЧреНрд░реА - "рд╢реЛрд░ рд╕реНрд╡рдЪреНрдЫрддрд╛" рд╕реЗ рдЕрдЪреНрдЫреА рдиреАрдВрдж рдФрд░ рдЬреАрдЯреАрдбреА</a></li>
<li><a href="../hi490492/index.html">рд╡реЗрдпрд░рд╣рд╛рдЙрд╕ рд░реЛрдмреЛрдЯ рдЧреИрд░-рдорд╛рдирдХ рдЪреАрдЬреЛрдВ рдХреЛ рд╕реЙрд░реНрдЯ рдХрд░рдирд╛ рд╕реАрдЦрддрд╛ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>