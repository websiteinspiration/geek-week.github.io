<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔅 🔏 🕧 ChipWhisperer：マグマへのエネルギー攻撃 🌯 💧 👆🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="記事の著者： ラクフ
 


 

Digital SecurityでSummer of Hack 2019の一環として、私はパワーアタックに対処し、ChipWhispererと協力しました。
 それは何ですか？
 

エネルギー分析は、サードパーティのチャネルを介した攻撃の一種です。つまり、システ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ChipWhisperer：マグマへのエネルギー攻撃</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事の著者： </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラクフ</font></font></a></p><br>
<p><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digital SecurityでSummer of Hack 2019の一環として、私はパワーアタックに対処し、ChipWhispererと協力しました。</font></font></p><br>
<h2 id="chto-eto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それは何ですか？</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エネルギー分析は、サードパーティのチャネルを介した攻撃の一種です。</font><font style="vertical-align: inherit;">つまり、システムの物理的な実装の結果として表示される情報を使用する攻撃です。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃者に役立つ可能性のある情報：</font></font></p><br>
<ul>
<li>  ;</li>
<li>;</li>
<li> ;</li>
<li>  ..</li>
</ul><br>
<p>     .</p><a name="habracut"></a><br>
<h2 id="pochemu-rabotaet"> ?</h2><br>
<p>  , , RAM         (CMOS).   -    :   .    ,       .             .      ,        , ,       .</p><br>
<h2 id="instrumentariy"></h2><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">ChipWhisperer</a>,     2 :</p><br>
<p><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="ChipWhisperer 2パートバージョン"></p><br>
<p>ChipWhisperer –           embedded .          .</p><br>
<p>   $250.      ,   ,   ,   $30k.    2 :    . </p><br>
<p>   ,    (    ),       ,  , probe         ChipWhisperer   .</p><br>
<p> ChipWhisperer   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  ,   5     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a>  API.             NumPy . </p><br>
<p>       .      AES, DES, TEA.            (   , ,    .).       .</p><br>
<p>   ,     :    ,      .</p><br>
<p>       .</p><br>
<h2 id="analiz"></h2><br>
<p>    :</p><br>
<ul>
<li>  (SPA);</li>
<li>  (DPA);</li>
<li>  (CPA).</li>
</ul><br>
<p>         . ,        ,   ,    ,    .</p><br>
<p><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="パスワード電力分析"></p><br>
<p>      .     ,   ,   .     10  AES.</p><br>
<p><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="AESスパ"></p><br>
<p>  (DPA)    .DPA           .   , ,  ""     .       ,        ,    . </p><br>
<p>    –       .      ,    DPA.      ,  DPA,      .    .</p><br>
<p>        .    ,        .</p><br>
<p>   ,     –   .   –       .     ,   ,   ,      .          .      —     2 .</p><br>
<p>           .        .          1.</p><br>
<p>  CPA     :</p><br>
<ul>
<li>       ;</li>
<li>               (256    );</li>
<li>        .         1;</li>
<li>     .</li>
</ul><br>
<p>    ,   .       ,   2 <sup>8</sup>    . ,   AES — 128,      16    2<sup>12</sup>,   ,     2<sup>128</sup>.</p><br>
<h3 id="analiz-shifra-magma">  </h3><br>
<p> –  ,      34.12-2015,       28147-89,   .    32 ,     .    256 ,       .</p><br>
<p><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="Feistel関数GOST"></p><br>
<p>       CPA.</p><br>
<p>     ,                .      S-box (   1  ,     )  (  )    ( ).</p><br>
<p>      ,      .   ,    DES, AES  32-        2<sup>32</sup>, ,       S-box,          .    S-box:  8,   8, 7    .     8- ,   ,      S-box-.       1 .</p><br>
<p>      :</p><br>
<pre><code class="python hljs">    <span class="hljs-keyword">for</span> kguess <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,  <span class="hljs-number">256</span>):
    <span class="hljs-comment">#Initialize arrays &amp; variables to zero</span><font></font>
    sumnum = np.zeros(numpoint)<font></font>
    sumden1 = np.zeros(numpoint)<font></font>
    sumden2 = np.zeros(numpoint)<font></font>
    hyp = np.zeros(numtraces)<font></font>
    <span class="hljs-keyword">for</span> tnum <span class="hljs-keyword">in</span> range(numtraces):<font></font>
        hyp[tnum] = HW[leak(<span class="hljs-string">"Gost28147_tc26_ParamZ"</span>,  kguess, block2ns(text[tnum])[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>)]</code></pre><br>
<p>  leak,    S-box  .</p><br>
<p>          :</p><br>
<p><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="相関"></p><br>
<pre><code class="python hljs">    cpaoutput = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
    maxcpa = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
        <span class="hljs-comment">#Mean of hypothesis</span><font></font>
        meanh = np.mean(hyp, dtype=np.float64)<font></font>
        <span class="hljs-comment">#Mean of all points in trace</span>
        meant = np.mean(traces, axis=<span class="hljs-number">0</span>, dtype=np.float64)
        <span class="hljs-comment">#For each trace, do the following</span>
        <span class="hljs-keyword">for</span> tnum <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, numtraces):<font></font>
            hdiff = (hyp[tnum] - meanh)<font></font>
            tdiff = traces[tnum,:] - meant<font></font>
            sumnum = sumnum + (hdiff*tdiff)<font></font>
            sumden1 = sumden1 + hdiff*hdiff<font></font>
            sumden2 = sumden2 + tdiff*tdiff<font></font>
        cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 )<font></font>
        maxcpa[kguess] = max(abs(cpaoutput[kguess]))</code></pre><br>
<p>         :</p><br>
<p><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="相関1"></p><br>
<p>      .</p><br>
<pre><code class="python hljs">    <span class="hljs-keyword">for</span> bnum <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<font></font>
        cpaoutput = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
        maxcpa = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
        <span class="hljs-keyword">for</span> kguess <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,  <span class="hljs-number">256</span>):<font></font>
            best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number">8</span>) | best_round<font></font>
            ...</code></pre><br>
<p>   ,       2    .     ,  8  .</p><br>
<p>       .     AES, DES, ,          2<sup>32</sup>.      ,    XORa.         .     .   .            . </p><br>
<p>  ,      ,   :     . ,    ,        (  )     . </p><br>
<p>   DES      ,  «» — ,     S-box .    8-,    «»         , ..     2 S-box,     2 S-box.    S-box,   ,    ,    ,     .</p><br>
<p>  ,            :</p><br>
<div class="spoiler"><b class="spoiler_title">  Python</b><div class="spoiler_text"><pre><code class="python hljs">    <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<font></font>
    path = <span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span>
    traces = np.load(path + <span class="hljs-string">'traces.npy'</span>)<font></font>
    text   = np.load(path + <span class="hljs-string">'textin.npy'</span>)<font></font>
    keys   = np.load(path + <span class="hljs-string">'keylist.npy'</span>)<font></font>
    HW = [bin(n).count(<span class="hljs-string">"1"</span>) <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>)]<font></font>
    SBOXES = {<span class="hljs-string">"Gost28147_tc26_ParamZ"</span>: (<font></font>
            (<span class="hljs-number">12</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">9</span>, <span class="hljs-number">14</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">15</span>, <span class="hljs-number">1</span>),<font></font>
            (<span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">15</span>),<font></font>
            (<span class="hljs-number">11</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">13</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0</span>),<font></font>
            (<span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">13</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">11</span>),<font></font>
            (<span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>),<font></font>
            (<span class="hljs-number">5</span>, <span class="hljs-number">13</span>, <span class="hljs-number">15</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">14</span>, <span class="hljs-number">0</span>),<font></font>
            (<span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">4</span>, <span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-number">13</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>),<font></font>
            (<span class="hljs-number">1</span>, <span class="hljs-number">7</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>),<font></font>
        )}<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_K</span>(<span class="hljs-params">s, _in</span>):</span>
        <span class="hljs-string">""" S-box substitution
        :param s: S-box
        :param _in: 32-bit word
        :returns: substituted 32-bit word
        """</span>
        <span class="hljs-keyword">return</span> (<font></font>
            (s[<span class="hljs-number">0</span>][(_in &gt;&gt; <span class="hljs-number">0</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">0</span>) +<font></font>
            (s[<span class="hljs-number">1</span>][(_in &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">4</span>) +<font></font>
            (s[<span class="hljs-number">2</span>][(_in &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">8</span>) +<font></font>
            (s[<span class="hljs-number">3</span>][(_in &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">12</span>) +<font></font>
            (s[<span class="hljs-number">4</span>][(_in &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">16</span>) +<font></font>
            (s[<span class="hljs-number">5</span>][(_in &gt;&gt; <span class="hljs-number">20</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">20</span>) +<font></font>
            (s[<span class="hljs-number">6</span>][(_in &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">24</span>) +<font></font>
            (s[<span class="hljs-number">7</span>][(_in &gt;&gt; <span class="hljs-number">28</span>) &amp; <span class="hljs-number">0x0F</span>] &lt;&lt; <span class="hljs-number">28</span>)<font></font>
        )<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">block2ns</span>(<span class="hljs-params">data</span>):</span>
        <span class="hljs-string">""" Convert block to N1 and N2 integers
        """</span><font></font>
        data = bytearray(data)<font></font>
        <span class="hljs-keyword">return</span> (<font></font>
            data[<span class="hljs-number">7</span>] | data[<span class="hljs-number">6</span>] &lt;&lt; <span class="hljs-number">8</span> | data[<span class="hljs-number">5</span>] &lt;&lt; <span class="hljs-number">16</span> | data[<span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">24</span>,<font></font>
            data[<span class="hljs-number">3</span>] | data[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span> | data[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">16</span> | data[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">24</span>,<font></font>
        )<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">addmod</span>(<span class="hljs-params">x, y, mod=<span class="hljs-number">2</span> ** <span class="hljs-number">32</span></span>):</span>
        <span class="hljs-string">""" Modulo adding of two integers
        """</span><font></font>
        r = x + int(y)<font></font>
        <span class="hljs-keyword">return</span> r <span class="hljs-keyword">if</span> r &lt; mod <span class="hljs-keyword">else</span> r - mod
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_shift11</span>(<span class="hljs-params">x</span>):</span>
        <span class="hljs-string">""" 11-bit cyclic shift
        """</span>
        <span class="hljs-keyword">return</span> ((x &lt;&lt; <span class="hljs-number">11</span>) &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>)) | ((x &gt;&gt; (<span class="hljs-number">32</span> - <span class="hljs-number">11</span>)) &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">32</span> - <span class="hljs-number">1</span>))
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">round</span>(<span class="hljs-params">sbox, key, data, byte</span>):</span><font></font>
        s = SBOXES[sbox]<font></font>
        _in = addmod(data, key)<font></font>
        sbox_leak = _K(s, _in);<font></font>
        <span class="hljs-keyword">return</span> (sbox_leak &gt;&gt; (<span class="hljs-number">8</span> * byte)) &amp; <span class="hljs-number">0xFF</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Feistel</span>(<span class="hljs-params">sbox, key, data, nround</span>):</span><font></font>
        s = SBOXES[sbox]<font></font>
        w = bytearray(key)<font></font>
        x = [<font></font>
            w[<span class="hljs-number">3</span> + i * <span class="hljs-number">4</span>] |<font></font>
            w[<span class="hljs-number">2</span> + i * <span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">8</span> |<font></font>
            w[<span class="hljs-number">1</span> + i * <span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">16</span> |<font></font>
            w[<span class="hljs-number">0</span> + i * <span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">24</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">8</span>)<font></font>
        ]<font></font>
        n1, n2 = block2ns(data)<font></font>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(nround):<font></font>
            n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1<font></font>
        <span class="hljs-keyword">return</span> n1<font></font>
    numtraces = len(traces)<font></font>
    numpoint = np.shape(traces)[<span class="hljs-number">1</span>]<font></font>
    bestguess = [<span class="hljs-number">0</span>]*<span class="hljs-number">32</span>
    round_data = [<span class="hljs-number">0</span>] * numtraces
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(numtraces):<font></font>
        round_data[i] = [<span class="hljs-number">0</span>] * <span class="hljs-number">8</span>
    <span class="hljs-keyword">for</span> rnum <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>):<font></font>
        best_round = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> tnum_r <span class="hljs-keyword">in</span> range(numtraces):<font></font>
            round_data[tnum_r][rnum] = Feistel(<span class="hljs-string">"Gost28147_tc26_ParamZ"</span>, bestguess, text[tnum_r], rnum)
        <span class="hljs-keyword">for</span> bnum <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>):<font></font>
            cpaoutput = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
            maxcpa = [<span class="hljs-number">0</span>]*<span class="hljs-number">256</span>
            <span class="hljs-keyword">for</span> kguess <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,  <span class="hljs-number">256</span>):
                <span class="hljs-comment">#Initialize arrays &amp; variables to zero</span>
                best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number">8</span>) | best_round<font></font>
                sumnum = np.zeros(numpoint)<font></font>
                sumden1 = np.zeros(numpoint)<font></font>
                sumden2 = np.zeros(numpoint)<font></font>
                hyp = np.zeros(numtraces)<font></font>
                <span class="hljs-keyword">for</span> tnum <span class="hljs-keyword">in</span> range(numtraces):<font></font>
                    hyp[tnum] = HW[round(<span class="hljs-string">"Gost28147_tc26_ParamZ"</span>,  best_round_key, round_data[tnum][rnum], bnum)]
                <span class="hljs-comment">#Mean of hypothesis</span><font></font>
                meanh = np.mean(hyp, dtype=np.float64)<font></font>
                <span class="hljs-comment">#Mean of all points in trace</span>
                meant = np.mean(traces, axis=<span class="hljs-number">0</span>, dtype=np.float64)
                <span class="hljs-comment">#For each trace, do the following</span>
                <span class="hljs-keyword">for</span> tnum <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, numtraces):<font></font>
                    hdiff = (hyp[tnum] - meanh)<font></font>
                    tdiff = traces[tnum,:] - meant<font></font>
                    sumnum = sumnum + (hdiff*tdiff)<font></font>
                    sumden1 = sumden1 + hdiff*hdiff<font></font>
                    sumden2 = sumden2 + tdiff*tdiff<font></font>
                cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 )<font></font>
                maxcpa[kguess] = max(abs(cpaoutput[kguess]))<font></font>
            best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * <span class="hljs-number">8</span>))<font></font>
            bestguess[((rnum + <span class="hljs-number">1</span>) * <span class="hljs-number">4</span>)-bnum - <span class="hljs-number">1</span>] = np.argmax(maxcpa)
    <span class="hljs-keyword">print</span> <span class="hljs-string">"Best Key Guess: "</span>
    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bestguess: <span class="hljs-keyword">print</span> <span class="hljs-string">"%02x "</span>%b,</code></pre></div></div><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    GitHub</a></p><br>
<h2 id="vyvody"></h2><br>
<p>      ChipWhisperer.   ,       (, ),    ChipWhisperer ,        .</p><br>
<p>      ,      ,    ,          . </p><br>
<p> :</p><br>
<ul>
<li>P. Kocher Differential Power Analysis</li>
<li>«Power Analysis Attacks: Revealing the Secrets of Smart Cards»</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   I:    </a> . .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   II:   </a> . .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  ZeroNights 2014</a> . . </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">cryptocoding v2</a>  ZeroNights 2014   .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja477716/index.html">「タグ」の例の数学者は、ランダムさがどのように発生するかを計算します</a></li>
<li><a href="../ja477718/index.html">畳み込み層：Shmuel Vinogradの方法による高速畳み込み</a></li>
<li><a href="../ja477722/index.html">C ++のGoogleスタイルガイド。パート8</a></li>
<li><a href="../ja477724/index.html">HRブランドhabraseminar：才能、狩猟、コンテンツについて</a></li>
<li><a href="../ja477728/index.html">チームが燃え尽きないようにティムリダをどうするか</a></li>
<li><a href="../ja477732/index.html">水中ナビゲーションシステムの誤った指分類</a></li>
<li><a href="../ja477734/index.html">写真アプリでUICollectionViewLayoutを理解する</a></li>
<li><a href="../ja477736/index.html">テスターの道：「ハンドブレーキ」から自動化まで</a></li>
<li><a href="../ja477738/index.html">iKassa、または「デジタルキャッシャー」の手入れ方法</a></li>
<li><a href="../ja477740/index.html">そして、あなたの目でこの望遠鏡をどこに見るのですか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>