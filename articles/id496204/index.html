<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”² ğŸ§™ğŸ¾ ğŸ· Pembaruan Proses CI / CD: Persiapan dan Perencanaan ğŸ‘ğŸ¿ ğŸ‘©ğŸ¾â€ğŸ’¼ ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada tahun 2020, mungkin cukup sulit untuk menemukan proyek dalam deskripsi tumpukan yang tidak akan memiliki salah satu dari kata-kata berikut: IaC, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pembaruan Proses CI / CD: Persiapan dan Perencanaan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496204/"><img src="https://habrastorage.org/webt/vl/jg/11/vljg11dfzemfbyfy8oexvw73eyq.png" alt="gambar"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahun 2020, mungkin cukup sulit untuk menemukan proyek dalam deskripsi tumpukan yang tidak akan memiliki salah satu dari kata-kata berikut: IaC, microservices, kubernetes, buruh pelabuhan, aws / azure / gcloud, blockchain, ML, VR dan sebagainya. </font><font style="vertical-align: inherit;">Dan itu luar biasa! </font><font style="vertical-align: inherit;">Kemajuan tidak berhenti. </font><font style="vertical-align: inherit;">Kami berkembang, proyek kami berkembang bersama kami, alat yang lebih nyaman dan fungsional muncul yang memecahkan masalah modern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halo. Jadi saya ingin memulai artikel ini. Tetapi kemudian saya meninjau beberapa hal, berbicara dengan kolega saya, dan menyadari bahwa saya akan salah. Masih ada proyek yang sudah berusia lebih dari 15 tahun, dengan manajer dan peserta yang beriman lama, dan karenanya proyek ini memiliki tumpukan teknologi kuno yang cukup sulit untuk dipelihara di kebun binatang yang ada. Dan untuk beberapa alasan, proyek ini tidak dapat diperbarui secara global (pelanggan adalah kelaparan, tidak ada pembaruan, proyek sangat besar, dan migrasi tertunda, atau semua orang senang dengan segalanya), dan Anda harus mendukungnya. Bahkan lebih tidak menyenangkan ketika proyek serupa masih aktif dikembangkan. Ini seperti bola salju. Pelanggan dan publik memerlukan fitur, kode membutuhkan pengiriman, server memerlukan perhatian dan perawatan ... Tapi bitpack - jadi secara umum, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berhenti mendukung merkuri</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kasus seperti itu diusulkan untuk dipertimbangkan.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apa yang akan dipertimbangkan: mengubah mercurial-git, memindahkan CI dari CruiseControl.NET ke TeamCity, dari git-deployment ke Octopus dengan </font><font style="vertical-align: inherit;">deskripsi </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kecil</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari keseluruhan proses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Teksnya ternyata banyak, sehingga akan dibagi menjadi beberapa bagian terpisah untuk memudahkan persepsi. </font><font style="vertical-align: inherit;">Akan ada daftar isi. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 1: apa itu, mengapa tidak seperti, perencanaan, sedikit bash. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya akan menyebut bagian ini hampir teknis. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 2: teamcity. </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian 3: penyebaran gurita. </font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian 4: di belakang layar. </font><font style="vertical-align: inherit;">Momen tidak menyenangkan, rencanakan masa depan, mungkin juga FAQ. </font><font style="vertical-align: inherit;">Kemungkinan besar, itu juga bisa disebut dekat-teknis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan menyebut ini sebagai panduan untuk pengulangan karena banyak alasan: kurangnya perendaman dalam proses proyek karena kurangnya waktu, praktik yang tidak memadai dari hal-hal seperti itu, sebuah monolit besar di mana semua sub-proyek saling terkait erat, dan banyak nuansa lain yang membuat Anda terbakar, heran, tahan dengan mereka , tetapi dalam hal apapun jangan harap. </font><font style="vertical-align: inherit;">Dan juga, karena fitur-fitur proyek (ini cukup unik), beberapa langkah akan dirancang khusus untuk kasus ini.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengantar klasik</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami memiliki repositori lincah, 300+ (terbuka!) Brunches, ccnet, ccnet + git lain (untuk penyebaran), dan sejumlah modul proyek dengan konfigurasi dan klien kami sendiri, empat lingkungan dan seluruh kumpulan kumpulan di IIS, serta cmd skrip, SQL, lebih dari lima ratus domain, dua lusin build, dan pengembangan aktif sebagai tambahan. Bukan berarti semua ini perlu, tetapi itu berhasil, dan itu tidak nyaman dan panjang. Satu-satunya hal yang membuat saya prihatin adalah kehadiran proyek lain yang membutuhkan perhatian saya. Tidak ada dalam proses bekerja dengan tugas sebesar ini lebih berbahaya daripada kurangnya konsentrasi dan gangguan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tahu bahwa cepat atau lambat saya harus memperhatikan tugas-tugas lain, dan itulah sebabnya saya menghabiskan banyak waktu mempelajari infrastruktur yang ada sehingga setidaknya tidak ada masalah yang tidak terselesaikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, saya tidak dapat memberikan deskripsi lengkap tentang proyek ini, karena NDA, sehingga poin teknis umum akan dipertimbangkan. Semua nama yang terkait dengan proyek juga akan dilukis. Saya minta maaf atas noda hitam pada tangkapan layar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu fitur utama dari proyek ini adalah bahwa ia memiliki sejumlah modul yang memiliki satu inti, tetapi berbeda dalam konfigurasi. Ada juga modul dengan pendekatan "khusus", yang dirancang untuk pengecer dan terutama pelanggan besar. Satu modul dapat melayani lebih dari satu klien. Klien harus dipahami sebagai organisasi atau kelompok orang yang terpisah yang mendapatkan akses ke modul tertentu. Setiap klien mendapatkan akses di domainnya sendiri, memiliki desain sendiri dan pengaturan default uniknya sendiri. Klien diidentifikasi oleh domain yang digunakannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema umum dari bagian proyek ini dapat direpresentasikan sebagai berikut:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/1p/jp/ft1pjp-5mnyfk2fu07salwryrew.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, intinya digunakan sama di mana-mana, dan ini bisa digunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alasan mengapa tugas muncul untuk meninjau dan memperbarui proses CI / CD:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CruiseControl.NET digunakan sebagai sistem pembangunan. </font><font style="vertical-align: inherit;">Bekerja dengannya adalah prinsip yang meragukan. </font><font style="vertical-align: inherit;">Konfigurasi XML pada beberapa layar, banyak dependensi dan menghubungkan konfigurasi satu sama lain, kurangnya solusi modern untuk masalah modern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa pengembang (terutama prospek) pada proyek harus memiliki akses untuk membangun server, dan mereka terkadang suka mengubah konfigurasi ccnet yang tidak boleh diubah. </font><font style="vertical-align: inherit;">Coba tebak apa yang terjadi selanjutnya. </font><font style="vertical-align: inherit;">Anda perlu memiliki manajemen hak yang sederhana dan nyaman dalam sistem CI, tanpa menghilangkan akses pengembang ke server. </font><font style="vertical-align: inherit;">Sederhananya, tidak ada konfigurasi teks - tidak ada tempat untuk memanjat dengan tangan main-main.</font></font></li>
<li>  - â€¦  CCNET,        git.         (. ).</li>
<li> ,      .     ,      .&nbsp;</li>
<li>-       ,        â€”         (   )       .</li>
<li>   .        ?   ?     ?            .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penggunaan sumber daya secara tidak optimal dan proses perakitan dan pengiriman kode yang ketinggalan zaman.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gambar hingga paragraf 3:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/yk/kv/hcykkvp6zijbax7ykugimj3qwkq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap perencanaan, diputuskan untuk menggunakan Teamcity sebagai sistem pembangunan, dan Gurita sebagai sistem penyebaran. </font><font style="vertical-align: inherit;">Infrastruktur "besi" pelanggan tetap tidak berubah: server khusus yang terpisah untuk pengembangan, pengujian, pementasan dan produksi, serta server pengecer (terutama lingkungan produksi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pelanggan diberikan Bukti Konsep pada contoh salah satu modul, rencana tindakan ditulis, pekerjaan persiapan dilakukan (instalasi, konfigurasi, dll.). </font><font style="vertical-align: inherit;">Mungkin tidak ada gunanya menggambarkan hal ini. </font><font style="vertical-align: inherit;">Cara memasang city team dapat dibaca di situs web resmi. </font><font style="vertical-align: inherit;">Saya akan membahas secara terpisah beberapa persyaratan yang dirumuskan untuk sistem baru:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perawatan mudah dengan semua konsekuensinya (cadangan, pembaruan, penyelesaian masalah, jika ada).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keuniversalan. </font><font style="vertical-align: inherit;">Idealnya, kembangkan skema umum yang dengannya semua modul dirakit dan dikirimkan, dan gunakan sebagai templat.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minimalkan waktu untuk menambahkan konfigurasi dan pemeliharaan gedung baru. </font><font style="vertical-align: inherit;">Klien ditambahkan / dihapus. </font><font style="vertical-align: inherit;">Terkadang menjadi perlu untuk membuat pengaturan baru. </font><font style="vertical-align: inherit;">Sangat penting bahwa saat membuat modul baru seharusnya tidak ada penundaan dengan konfigurasi pengirimannya.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada sekitar titik ini, kami ingat penghentian dukungan untuk repositori lincah dengan bitbucket, dan persyaratan ditambahkan untuk mentransfer repositori ke git sambil mempertahankan cabang dan sejarah komitmen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persiapan: konversi repositori</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya seseorang dengan jelas memecahkan masalah ini di hadapan kita dan bukannya kita. </font><font style="vertical-align: inherit;">Anda hanya perlu menemukan solusi kerja yang sudah jadi. </font><font style="vertical-align: inherit;">Ekspor cepat ternyata tidak terlalu cepat. </font><font style="vertical-align: inherit;">Plus, itu tidak berhasil. </font><font style="vertical-align: inherit;">Sayangnya, tidak ada log dan tangkapan layar yang tersisa. </font><font style="vertical-align: inherit;">Faktanya adalah dia tidak bisa. </font><font style="vertical-align: inherit;">Bitbucket tidak menyediakan konverter sendiri (tetapi bisa). </font><font style="vertical-align: inherit;">Beberapa lagi metode Google, dan juga oleh. </font><font style="vertical-align: inherit;">Saya memutuskan untuk menulis skrip saya sendiri, lagi pula ini bukan satu-satunya repositori lincah, itu akan berguna di masa depan. </font><font style="vertical-align: inherit;">Perkembangan awal akan disajikan di sini (karena mereka masih tetap dalam bentuk yang sama). </font><font style="vertical-align: inherit;">Logika kerja terlihat seperti ini:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengambil ekstensi mercurial hggit sebagai dasar.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mendapatkan daftar semua cabang dari repositori mercurial.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengonversi nama cabang (terima kasih untuk lincah dan pengembang untuk spasi dalam nama cabang, terima kasih khusus untuk umlaut dan karakter lain yang menambah keceriaan untuk kehidupan).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat bookmark (bookmark hg) dan dorong ke repositori perantara. </font><font style="vertical-align: inherit;">Untuk apa? </font><font style="vertical-align: inherit;">Karena bitbucket, dan karena Anda tidak dapat membuat bookmark dengan nama yang sama dengan nama cabang (misalnya, pementasan).&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam repositori (sudah git) yang baru, hapus postfix dari nama cabang dan migrasi hgignore ke gitignore.&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dorong ke repositori utama. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar perintah sesuai dengan poin:</font></font><br>
<br>
<ol>
<li><pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> /path/to/hg/repo<font></font>
$ cat &lt;&lt; EOF &gt;&gt; ./.hg/hgrc<font></font>
[extensions]<font></font>
hggit=<font></font>
EOF<font></font>
</code></pre></li>
<li><pre><code class="bash hljs">$ hg branches &gt; ../branches
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/usr/bin/env bash</span>
hgBranchList=<span class="hljs-string">"./branches"</span>
sed -i <span class="hljs-string">'s/:.*//g'</span> <span class="hljs-variable">${hgBranchList}</span>
symbolsToDelete=$(awk <span class="hljs-string">'{print $NF}'</span> FS=<span class="hljs-string">" "</span> <span class="hljs-variable">${hgBranchList}</span> &gt; sym_to_del.tmp)<font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> hgBranch; <span class="hljs-keyword">do</span>
  hgBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${hgBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${hgBranchList}</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> str; <span class="hljs-keyword">do</span>
  strToDel[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${str}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt; ./sym_to_del.tmp<font></font>
 <font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!strToDel[@]}</span>
<span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-variable">${hgBranches[$i]}</span> | sed <span class="hljs-string">"s/<span class="hljs-variable">${strToDel[$i]}</span>//"</span> &gt;&gt; result.tmp
<span class="hljs-keyword">done</span><font></font>
 <font></font>
sed -i <span class="hljs-string">'s/[ \t]*$//'</span> result.tmp<font></font>
sed <span class="hljs-string">'s/^/"/g'</span> result.tmp &gt; branches_hg<font></font>
sed -i <span class="hljs-string">'s/$/"/g'</span> branches_hg<font></font>
sed <span class="hljs-string">'s/ /-/g'</span> result.tmp &gt; branches_git<font></font>
sed -i <span class="hljs-string">'s/-\/-/\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/-\//\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/\/-/\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/---/-/g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/--/-/g'</span> branches_git<font></font>
rm sym_to_del.tmp<font></font>
rm result.tmp<font></font>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/usr/bin/env bash</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
hgBranchList=<span class="hljs-string">"./branches_hg"</span>
hgRepo=<span class="hljs-string">"/repos/reponame"</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> hgBranch; <span class="hljs-keyword">do</span>
  hgBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${hgBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${hgBranchList}</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>
  gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${gitBranchList}</span><font></font>
 <font></font>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">${hgRepo}</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>
<span class="hljs-keyword">do</span>
  hg bookmark -r <span class="hljs-string">"<span class="hljs-variable">${hgBranches[$i]}</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${gitBranches[$i]}</span>-cnv"</span>
<span class="hljs-keyword">done</span><font></font>
 <font></font>
hg push git+ssh://git@bitbucket.org:username/reponame-temp.git<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Done."</span>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># clone repo, run git branch -a, delete remotes/origin words to leave only branch names, delete -cnv postfix, delete default branch string because we can't delete it</span>
repo=<span class="hljs-string">"/repos/repo"</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
defaultBranch=<span class="hljs-string">"default-cnv"</span>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>   gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>;   i=$((i+<span class="hljs-number">1</span>)); <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$gitBranchList</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$repo</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span> git checkout <span class="hljs-variable">${gitBranches[$i]}</span>-cnv; <span class="hljs-keyword">done</span>
git checkout <span class="hljs-variable">$defaultBranch</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span>
    git branch -m <span class="hljs-variable">${gitBranches[$i]}</span>-cnv <span class="hljs-variable">${gitBranches[$i]}</span>
    git push origin :<span class="hljs-variable">${gitBranches[$i]}</span>-cnv <span class="hljs-variable">${gitBranches[$i]}</span>
    git push origin -u <span class="hljs-variable">${gitBranches[$i]}</span>
<span class="hljs-keyword">done</span>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># clone repo, run git branch -a, delete remotes/origin words to leave only branch names, delete -cnv postfix, delete default branch string because we can't delete it</span>
repo=<span class="hljs-string">"/repos/repo"</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
defaultBranch=<span class="hljs-string">"default"</span>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>   gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>;   i=$((i+<span class="hljs-number">1</span>)); <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$gitBranchList</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$repo</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span>
    git checkout <span class="hljs-variable">${gitBranches[$i]}</span>
    sed -i <span class="hljs-string">'1d'</span> .hgignore<font></font>
    mv .hgignore .gitignore<font></font>
    git add .<font></font>
    git commit -m <span class="hljs-string">"Migrated ignore file"</span>
<span class="hljs-keyword">done</span>
</code></pre></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan mencoba menjelaskan arti dari beberapa tindakan, yaitu penggunaan repositori perantara. Awalnya, dalam repositori setelah konversi, nama-nama cabang berisi postfix "-cnv". Ini karena fitur bookmark hg. Anda perlu menghapus postfix ini, dan juga membuat file gitignore alih-alih hgignore. Semua ini menambah histori, dan karenanya meningkatkan ukuran repositori (dan tidak masuk akal). Sebagai contoh lain, saya bisa mengutip yang berikut: mencoba membuat repositori, dan mendorong komit pertama ke 300M dengan kode ke dalamnya. Kemudian tambahkan ke gitignore, dan dorong tanpa itu. Dia akan tetap dalam sejarah. Sekarang cobalah untuk menghapusnya dari histori (git filter-branch). Dengan jumlah komit tertentu, ukuran repositori yang dihasilkan tidak akan berkurang, tetapi meningkat. Ini diselesaikan dengan optimasi, tetapi tidak dapat dimulai pada bitbucket.Itu dilakukan hanya ketika mengimpor repositori. Oleh karena itu, semua operasi kasar dilakukan dengan perantara, dan kemudian impor ke yang baru dilakukan. Ukuran repositori perantara di final adalah 1,15G, dan ukuran 350M yang dihasilkan.&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seluruh proses migrasi dibagi menjadi beberapa tahap, yaitu:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persiapan (demo kepada pelanggan menggunakan contoh one build, instalasi perangkat lunak, konversi repositori, memperbarui konfigurasi ccnet yang ada);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi CI / CD untuk lingkungan dev dan pengujiannya (sistem lama tetap bekerja secara paralel);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengaturan CI / CD untuk lingkungan yang tersisa (paralel dengan "baik" yang ada) dan pengujian;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dev migrasi, pementasan dan uji;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memigrasi produksi dan mentransfer domain dari instance IIS lama ke yang baru.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deskripsi fase persiapan yang berhasil diselesaikan saat ini sedang diselesaikan. </font><font style="vertical-align: inherit;">Beberapa keberhasilan muluk tidak tercapai di sini, kecuali bahwa sistem yang ada tidak rusak dan repositori lincah di git dimigrasikan. </font><font style="vertical-align: inherit;">Namun, tanpa deskripsi proses ini, tidak akan ada konteks untuk bagian yang lebih teknis. </font><font style="vertical-align: inherit;">Bagian selanjutnya akan menjelaskan proses pengaturan sistem CI berdasarkan teamcity.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id496184/index.html">Teknologi Tampilan LED: Mikro-LED vs. Mini LED</a></li>
<li><a href="../id496188/index.html">Bagaimana menghentikan pesta menonton acara TV dan mulai hidup</a></li>
<li><a href="../id496190/index.html">Tentang Phrasal Verbs-2</a></li>
<li><a href="../id496192/index.html">Panggil fungsi Rust dari Go</a></li>
<li><a href="../id496194/index.html">Pada binarisasi gambar tomografi struktur halus</a></li>
<li><a href="../id496206/index.html">Satu miliar operasi dalam database dalam 0,3 detik. Jangan membandingkan OLTP dengan OLAP, tetapi QuestDB dengan PostgreSQL</a></li>
<li><a href="../id496208/index.html">Bagaimana JIT menguraikan kode C # kami (heuristik)</a></li>
<li><a href="../id496210/index.html">Keanekaragaman hayati mungkin telah berevolusi dari prinsip bermain batu-kertas-gunting</a></li>
<li><a href="../id496212/index.html"># 04 - Dan seluruh byte tidak cukup ... | Ambil BK dengan klakson</a></li>
<li><a href="../id496214/index.html">AdColony: 89% penerbit aplikasi dan game seluler menggunakan video promosi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>