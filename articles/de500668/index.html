<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗯️ 🍭 🗽 Drahtlose Motorsteuerung von Lego mit Steam Controller 👩🏼‍🤝‍👩🏻 🚖 👨‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als ich jung war, wollte ich immer Lego Technics-Kits haben, um alle möglichen coolen Sachen von ihnen zu sammeln. Autonome Panzer mit rotierenden Tür...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Drahtlose Motorsteuerung von Lego mit Steam Controller</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500668/"><img src="https://habrastorage.org/webt/to/-q/fh/to-qfh-f6as72siykacsf0u_8du.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als ich jung war, wollte ich immer Lego Technics-Kits haben, um alle möglichen coolen Sachen von ihnen zu sammeln. Autonome Panzer mit rotierenden Türmen, die Legosteine ​​abfeuern. Aber dann hatte ich kein solches Set. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und selbst die üblichen Steine ​​von Lego waren es nicht. Ich hatte nur einen Freund, dessen Bruder all diese teuren Spielsachen hatte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt habe ich einen Sohn in seinem Alter. Und er baut Panzer, die ... dumm nach vorne ragen, bis sie gegen die Wand </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
stoßen </font><font style="vertical-align: inherit;">:) </font><font style="vertical-align: inherit;">Und jetzt ist die Zeit für ESP32 und die Magie des Lötkolbens gekommen - wir werden die richtige Fernbedienung für sie zusammenbauen!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nein, natürlich weiß ich über die Existenz solcher Fernbedienungen Bescheid. </font><font style="vertical-align: inherit;">Aber keiner von ihnen passt zu mir. </font><font style="vertical-align: inherit;">Sie sind entweder Infrarot mit Technologie der 80er Jahre oder zu groß. </font><font style="vertical-align: inherit;">Oder teuer. </font><font style="vertical-align: inherit;">Und vor allem - ich kann meinem Sohn zu keinem von ihnen sagen: "Ich habe es speziell für dich getan!" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Machen wir also eine neue, verbesserte Fernbedienung, um alle zu regieren!</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/getpro/habr/post_images/ffa/c72/7fd/ffac727fd7f9547d36657745fe7ea3a1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zutaten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP32-WROOM-32D | </font><font style="vertical-align: inherit;">WiFi, BLE und ein Prozessor mit E / A - genug, um zwei </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Motoren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu steuern </font><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DRV8833 | </font><font style="vertical-align: inherit;">Doppel-H-Brücke mit genügend Leistung für Motoren.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TPS62162 | </font><font style="vertical-align: inherit;">Senkung der Spannung auf 17 V sowie zur Unterhaltung beim Löten des Gehäuses WSON-8 2 × 2 mm</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CP2104 | </font><font style="vertical-align: inherit;">zur Programmierung von ESP32</font></font></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"></a>     .      ,   Lego  .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All dies wird sich auf einer eher kleinen Platine befinden - hier ist sein Erscheinungsbild im EasyEDA-Editor: Der </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/3c8/4af/b81/3c84afb81433206ebf31adbfde2b8700.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Draht, der auf dem Header-Foto sichtbar ist, wird nicht benötigt, um Fehler zu beheben, sondern um Strom über USB zu liefern. Es mag nicht genug für den Motor sein, aber leider sind Kontakte aus China immer noch nicht zu mir gekommen. Deshalb überprüfe ich zuerst die Funktion der LEDs. Für die Schönheit auf dem Foto habe ich einfach den Stecker vom Motor auf die Platine gelegt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf Version 1.1 meines Boards (im Gegensatz zu Version 1.2, die bereits auf EasyEDA läuft) gab es keine LEDs, daher habe ich zwei antiparallele Dioden an den Ausgang gelötet, damit das Geschehen sichtbar war. Wenn Sie genau hinschauen, zeigt das Video die alternative Aufnahme eines Paares von 0603-Dioden, die eine Vorwärts- / Rückwärtsbewegung anzeigen.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/UX0iBoP1utU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für das Bedienfeld wollte ich zunächst nur eine zusätzliche Karte mit Tasten und ein weiteres ESP32 - eine klassische Fernbedienung - sammeln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann erinnerte ich mich jedoch daran, dass Steam Controller einen Bluetooth Low Energy Mode (BLE) haben. Ich beschloss, dieses Problem anzugehen, und lernte nach einigen Stunden, wie man Pakete vom Controller empfängt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Suchen Sie dazu einfach nach dem HID-Gerät, das sich SteamController nennt, und stellen Sie eine Verbindung her. Verwenden Sie dann den undokumentierten Dienst von Valve und einige </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">undokumentierte Befehle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die Paketübertragungen ermöglichen. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/2f7/fb5/877/2f7fb5877ff2dae71c57c405b3e4c5d4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Außerdem bin ich auf ein undokumentiertes Berichtsformat gestoßen, das ich manuell analysiert habe.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/22c/8ab/3db/22c8ab3db50e5ac2a0fb6c0c48a2701e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach ungefähr einer Stunde wurde mir die Bedeutung der Flags und Werte klar und ich schaffte es, die LED mit dem Steam-Controller und ESP32 zu blinken. </font><font style="vertical-align: inherit;">¯ \ _ (ツ) _ / ¯</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dateien</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EasyEDA-Platine und Platine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">easyeda.com/EFS-GH/legoremote</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellen für Arduino: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/g3gg0/LegoRemote</font></font></a></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1.0:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> „Testansatz“ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - die erste Option, für die ich den falschen Spannungsregler gewählt habe. TPS62291 erhöht die Spannung nur auf 6 V. Ich habe mehrere Projekte parallel entwickelt und vergessen, dass das Gerät mit 9 V arbeiten muss. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V1.1:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> „gut genug“ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - diese Option ist in der Werbung sichtbar und alles funktioniert </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v1.2:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> „final“. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Dem Ausgang wurden Anzeige-LEDs hinzugefügt und die Größe und Anordnung der Platine optimiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das nächste kurze Video zeigt die Verbindungsphase (1-3 Sekunden nach dem Einschalten) und die Steuerung der Motorausgänge. Der Lego-Anschluss ist noch nicht angeschlossen. Es wird in einen leeren Bereich neben den anderen Anschlüssen verschoben, der mit einem weißen Rechteck markiert ist.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/-2-QGO-eoNQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mein Sohn verwendet diesen Controller jetzt regelmäßig, um die von ihm zusammengebauten Geräte zu steuern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während des Stresstests stieß ich nur auf ein Problem: Ich dachte, dass der „Fast Decay“ -Modus des Motortreibers am besten funktionieren würde, aber aufgrund dessen würde die Motordrehzahl nach einigen Sekunden Betrieb sehr stark sinken. </font><font style="vertical-align: inherit;">Also habe ich den Code so geändert, dass er "Slow Decay" verwendet. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/c1e/e09/921/c1ee09921222a6c99fa4dce4395ca4a7.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher bin ich mir nicht sicher, wie das DRV funktioniert und warum sich der Motor zuerst schnell dreht und nach 10 Sekunden allmählich langsamer wird. </font><font style="vertical-align: inherit;">Vielleicht erwärmen sich die MOSFETs und ihr Widerstand steigt zu stark an.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aIFafodKasQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dieses Beispiel für die mühelose Verwendung von Arduino inspiriert andere Menschen und ermöglicht ihnen, ihre Kinder mit Elektronik vertraut zu machen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de500648/index.html">Was ist ein Architekturmodell der Unternehmensreife?</a></li>
<li><a href="../de500654/index.html">WebRTC unter Android: Aktivieren der Hardware-Codierung auf mehreren Geräten</a></li>
<li><a href="../de500656/index.html">Hierarchische Protokollierung der Anwendung in der Datenbank</a></li>
<li><a href="../de500660/index.html">Eine vereinfachte und sehr kurze Geschichte der Entwicklung von "Wolken"</a></li>
<li><a href="../de500666/index.html">Microsoft Online-Zertifizierung - Sie, Ihr Speicherplatz und Ihr Computer</a></li>
<li><a href="../de500670/index.html">Wie wir unser Produkt herstellen. Erster Teil, Forschung</a></li>
<li><a href="../de500672/index.html">Fortsetzung des Streams für Tester und nicht nur</a></li>
<li><a href="../de500676/index.html">Ankündigung eines Online-Workshops zur Testautomatisierung</a></li>
<li><a href="../de500678/index.html">ClickHouse für fortgeschrittene Benutzer in Fragen und Antworten</a></li>
<li><a href="../de500688/index.html">Arbeiten mit einer Datenbank in Flask: von Juni bis Juni</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>