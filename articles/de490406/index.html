<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüöí üéôÔ∏è üë©‚ÄçüöÄ Unaussprechlich attraktiv: Wie wir einen Haniot geschaffen haben, der nicht entlarvt werden kann üòâ üíÜüèΩ üë©‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", - - ‚Äî , ¬´ ¬ª . , : , . , , , . , , ¬´Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats¬ª. ‚Äî . 
 
  : -
 Die Hauptaufgabe ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unaussprechlich attraktiv: Wie wir einen Haniot geschaffen haben, der nicht entlarvt werden kann</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="Bild"><br>
<i> , -       - ‚Äî ,  ¬´  ¬ª        .    ,      :   ,        .     ,    ,        ,    .  ,   ,      ¬´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</a>¬ª.     ‚Äî   . </i><br>
<a name="habracut"></a><br>
<h3> : -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptaufgabe bei der Erstellung unserer Superfalle bestand darin, zu verhindern, dass wir von Hackern entlarvt werden, die Interesse daran zeigten. </font><font style="vertical-align: inherit;">Dazu musste ich viel arbeiten:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie eine realistische Legende √ºber das Unternehmen, einschlie√ülich Name und Foto der Mitarbeiter, Telefonnummern und E-Mails.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Modell der industriellen Infrastruktur zu erfinden und umzusetzen, das der Legende unseres Unternehmens entspricht. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheiden Sie, welche Netzwerkdienste au√üerhalb verf√ºgbar sein sollen, aber beteiligen Sie sich nicht am √ñffnen anf√§lliger Ports, damit diese nicht wie eine Falle f√ºr Coots aussehen. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisieren Sie das Auftreten von Informationslecks √ºber das anf√§llige System und verbreiten Sie diese Informationen unter potenziellen Angreifern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementieren Sie eine diskrete √úberwachung von Hackern in der Trap-Infrastruktur. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt das Wichtigste zuerst.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Legende erstellen</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cyberkriminelle sind bereits daran gew√∂hnt, dass sie auf viele Manipulationen sto√üen. Daher f√ºhrt der am weitesten fortgeschrittene Teil von ihnen eine eingehende Untersuchung jedes anf√§lligen Systems durch, um sicherzustellen, dass dies keine Falle ist. Aus dem gleichen Grund haben wir uns bem√ºht, nicht nur den Realismus des Hanipot in Bezug auf Design und technische Aspekte zu erreichen, sondern auch das Erscheinungsbild eines echten Unternehmens zu schaffen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns an die Stelle eines hypothetischen Kulhakers gesetzt und einen Verifizierungsalgorithmus entwickelt, der ein reales System von einer Falle unterscheidet. Dazu geh√∂rte die Suche nach IP-Adressen von Unternehmen in Reputationssystemen, die umgekehrte Untersuchung der Geschichte von IP-Adressen, die Suche nach Namen und Schl√ºsselw√∂rtern im Zusammenhang mit dem Unternehmen sowie seinen Gegenparteien und vielen anderen Dingen. Infolgedessen erwies sich die Legende als sehr √ºberzeugend und attraktiv.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns entschlossen, die Fallenfabrik als kleine industrielle Prototyping-Boutique zu positionieren, die f√ºr sehr gro√üe anonyme Kunden aus dem Milit√§r- und Luftfahrtsegment arbeitet. Dadurch wurden die rechtlichen Schwierigkeiten bei der Verwendung einer bestehenden Marke beseitigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes mussten wir uns eine Vision, Mission und einen Namen der Organisation einfallen lassen. Wir haben beschlossen, dass unser Unternehmen ein Startup mit einer kleinen Anzahl von Mitarbeitern sein soll, von denen jeder Gr√ºnder ist. Dies f√ºgte der Legende der Spezialisierung unseres Gesch√§fts Glaubw√ºrdigkeit hinzu, die es ihm erm√∂glicht, mit heiklen Projekten f√ºr gro√üe und wichtige Kunden zu arbeiten. Wir wollten, dass unser Unternehmen in Bezug auf Cybersicherheit schwach aussieht, aber gleichzeitig war es offensichtlich, dass wir mit wichtigen Ressourcen in Zielsystemen arbeiten.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot der MeTech Hanipot-Site. Quelle: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben das Wort MeTech als Firmennamen gew√§hlt. Die Seite wurde auf Basis einer kostenlosen Vorlage erstellt. Die Bilder wurden aus Fotobanken aufgenommen, wobei die unbeliebtesten und raffiniertesten verwendet wurden, um sie weniger erkennbar zu machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir wollten, dass das Unternehmen real aussieht, deshalb mussten wir Mitarbeiter mit professionellen F√§higkeiten hinzuf√ºgen, die dem Profil des Unternehmens entsprechen. Wir haben uns Namen und Pers√∂nlichkeiten f√ºr sie ausgedacht und dann versucht, Bilder aus Fotobanken entsprechend ihrer ethnischen Zugeh√∂rigkeit auszuw√§hlen. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="Bild"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot der MeTech Hanipot-Site. Quelle: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um uns nicht preiszugeben, suchten wir nach qualitativ hochwertigen Gruppenfotos, aus denen wir die Gesichter ausw√§hlen konnten, die wir brauchten. </font><font style="vertical-align: inherit;">Dann haben wir diese Option jedoch aufgegeben, da ein potenzieller Cracker die umgekehrte Bildsuche nutzen und feststellen k√∂nnte, dass unsere ‚ÄûMitarbeiter‚Äú nur in Fotobanken leben. </font><font style="vertical-align: inherit;">Am Ende nutzten wir Fotos von nicht existierenden Personen, die mit neuronalen Netzen erstellt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die auf der Website ver√∂ffentlichten Mitarbeiterprofile enthielten wichtige Informationen zu ihren technischen F√§higkeiten. Wir haben jedoch die Anweisungen bestimmter Bildungseinrichtungen und St√§dte vermieden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Erstellen von Postf√§chern haben wir den Server des Hosting-Anbieters verwendet, dann mehrere Telefonnummern in den USA gemietet und diese zu einer virtuellen Telefonzentrale mit einem Sprachmen√º und einem Anrufbeantworter kombiniert.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanipot-Infrastruktur</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um nicht ausgesetzt zu werden, haben wir uns f√ºr eine Kombination aus realen Industrieanlagen, physischen Computern und sicheren virtuellen Maschinen entschieden. </font><font style="vertical-align: inherit;">Mit Blick auf die Zukunft sagen wir, dass wir das Ergebnis unserer Bem√ºhungen mit der Shodan-Suchmaschine √ºberpr√ºft haben, und er hat gezeigt, dass der Hanipot wie ein echtes Industriesystem aussieht. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Ergebnis des Scannens eines Hanipots mit Shodan. </font><font style="vertical-align: inherit;">Quelle: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben vier SPS als Hardware f√ºr unsere Falle verwendet:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwei AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese SPS wurden aufgrund ihrer Beliebtheit auf dem Weltmarkt f√ºr Steuerungssysteme ausgew√§hlt. </font><font style="vertical-align: inherit;">Und jeder dieser Controller verwendet sein eigenes Protokoll, mit dem wir √ºberpr√ºfen k√∂nnen, welche der SPSen h√§ufiger angreifen und ob sie grunds√§tzlich jemanden interessieren. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ausr√ºstung unserer "Fabrik" -Falle. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben nicht nur Eisenst√ºcke eingelegt und mit dem Internet verbunden. </font><font style="vertical-align: inherit;">Wir haben jeden Controller so programmiert, dass er Aufgaben ausf√ºhrt, darunter:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mischen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brenner- und F√∂rderbandsteuerung,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Palettieren mit einem Roboterarm.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Produktionsprozess realistisch zu gestalten, haben wir die Logik so programmiert, dass die R√ºckkopplungsparameter zuf√§llig ge√§ndert, das Starten und Stoppen von Motoren sowie das Ein- und Ausschalten des Brenners simuliert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Fabrik hatte drei virtuelle Computer und einen physischen. Die virtuellen Maschinen wurden zur Steuerung der Anlage, des Palettierroboters und als automatisierter Arbeitsplatz des SPS-Softwareentwicklers verwendet. Der physische Computer arbeitete als Dateiserver.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neben der √úberwachung von Angriffen auf die SPS wollten wir den Status von Programmen √ºberwachen, die auf unsere Ger√§te heruntergeladen wurden. Zu diesem Zweck haben wir eine Schnittstelle erstellt, mit der wir schnell feststellen k√∂nnen, wie die Zust√§nde unserer virtuellen Aktuatoren und Installationen ge√§ndert wurden. Bereits in der Planungsphase haben wir festgestellt, dass es viel einfacher ist, dies mit Hilfe eines Steuerprogramms umzusetzen als durch direkte Programmierung der Steuerlogik. Wir haben den Zugriff auf die Ger√§teverwaltungsoberfl√§che unseres Hanipots √ºber VNC ohne Passwort ge√∂ffnet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Industrieroboter sind eine Schl√ºsselkomponente der modernen intelligenten Fertigung. In diesem Zusammenhang haben wir beschlossen, einen Roboter und AWP hinzuzuf√ºgen, um ihn in der Ausr√ºstung unserer Fabrikfalle zu steuern. Um die "Fabrik" realistischer zu gestalten, haben wir echte Software auf der AWP-Steuerung installiert, mit der Ingenieure die Roboterlogik grafisch programmieren. Da sich Industrieroboter normalerweise in einem isolierten internen Netzwerk befinden, haben wir beschlossen, den ungesch√ºtzten VNC-Zugriff nur der Workstation-Verwaltung zu √ºberlassen. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RobotStudio-Umgebung mit einem 3D-Modell unseres Roboters. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf einer virtuellen Maschine mit einer Robotersteuerungs-Workstation haben wir die RobotStudio-Programmierumgebung von ABB Robotics installiert. </font><font style="vertical-align: inherit;">Nachdem wir RobotStudio eingerichtet hatten, √∂ffneten wir mit unserem Roboter eine Simulationsdatei, sodass das 3D-Bild auf dem Bildschirm sichtbar war. </font><font style="vertical-align: inherit;">Infolgedessen erhalten Shodan und andere Suchmaschinen, die einen ungesch√ºtzten VNC-Server entdeckt haben, dieses Bild vom Bildschirm und zeigen es denjenigen, die nach Industrierobotern mit offenem Zugang zur Steuerung suchen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bedeutung dieser Liebe zum Detail bestand darin, ein attraktives und realistisches Ziel f√ºr Angreifer zu schaffen, die, nachdem sie es entdeckt hatten, immer wieder darauf zur√ºckkommen w√ºrden.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWP Ingenieur</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die SPS-Logik zu programmieren, haben wir der Infrastruktur einen technischen Computer hinzugef√ºgt. </font><font style="vertical-align: inherit;">Darauf wurde eine industrielle Software f√ºr die SPS-Programmierung installiert:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIA Portal f√ºr Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix f√ºr Allen-Bradley-Controller,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One f√ºr Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben entschieden, dass die Engineering-Workstation au√üerhalb des Netzwerks nicht zug√§nglich ist. </font><font style="vertical-align: inherit;">Stattdessen legen wir f√ºr das Administratorkonto das gleiche Kennwort fest wie auf den Arbeitsstationen der Robotersteuerung und den Arbeitsstationen der Fabrik, auf die √ºber das Internet zugegriffen werden kann. </font><font style="vertical-align: inherit;">Diese Konfiguration ist in vielen Unternehmen weit verbreitet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider hat trotz aller Bem√ºhungen kein einziger Angreifer die AWP des Ingenieurs erreicht.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dateiserver</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir brauchten es als Lockvogel f√ºr Eindringlinge und als Mittel, um unsere eigene ‚ÄûArbeit‚Äú in einer Fallenfabrik zu sichern. Dies erm√∂glichte es uns, Dateien mit unserem Haniot √ºber USB-Ger√§te zu teilen, ohne Spuren in der Netzwerkfalle zu hinterlassen. Als Betriebssystem f√ºr den Dateiserver haben wir Windows 7 Pro installiert, in dem wir einen freigegebenen Ordner zum Lesen und Schreiben f√ºr jedermann zug√§nglich gemacht haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zun√§chst haben wir keine Hierarchie von Ordnern und Dokumenten auf dem Dateiserver erstellt. Dann stellte sich jedoch heraus, dass die Angreifer diesen Ordner aktiv studierten, und wir beschlossen, ihn mit verschiedenen Dateien zu f√ºllen. Zu diesem Zweck haben wir ein Python-Skript geschrieben, das eine Datei mit zuf√§lliger Gr√∂√üe mit einer der angegebenen Erweiterungen erstellt und einen Namen basierend auf dem W√∂rterbuch gebildet hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Skript zum Generieren attraktiver Dateinamen. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Ausf√ºhren des Skripts haben wir das gew√ºnschte Ergebnis in Form eines Ordners erhalten, der mit Dateien mit sehr interessanten Namen gef√ºllt ist. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Ergebnis des Skripts. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberwachungsumgebung</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir uns so viel M√ºhe gegeben hatten, ein realistisches Unternehmen zu schaffen, konnten wir es uns einfach nicht leisten, uns in die Umgebung zu injizieren, um unsere ‚ÄûBesucher‚Äú zu √ºberwachen. Wir mussten alle Daten in Echtzeit abrufen, damit die Angreifer nicht bemerkten, dass sie beobachtet wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben dies mit vier USB-Ethernet-Adaptern, vier SharkTap-Ethernet-Kopplern, Raspberry Pi 3 und einem gro√üen externen Laufwerk implementiert. Das Schema unseres Netzwerks sah folgenderma√üen aus: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schema eines Hanipot-Netzwerks mit √úberwachungsger√§ten. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben drei SharkTap-Taps eingerichtet, um den gesamten externen Datenverkehr zu SPS zu √ºberwachen, auf die nur √ºber das interne Netzwerk zugegriffen werden kann. Der vierte SharkTap verfolgte den Datenverkehr der G√§ste der anf√§lligen virtuellen Maschine.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharkTap Ethernet-Koppler und Sierra Wireless AirLink RV50 Router. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi f√ºhrte eine t√§gliche Erfassung des Datenverkehrs durch. </font><font style="vertical-align: inherit;">Wir haben eine Internetverbindung mit dem Mobilfunkrouter Sierra Wireless AirLink RV50 hergestellt, der h√§ufig in Industrieunternehmen verwendet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider erlaubte dieser Router kein selektives Blockieren von Angriffen, die nicht unseren Pl√§nen entsprachen. Daher haben wir dem Netzwerk die Cisco ASA 5505-Firewall in einem transparenten Modus hinzugef√ºgt, um das Blockieren mit minimalen Auswirkungen auf das Netzwerk durchzuf√ºhren.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkehrsanalyse</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark und tcpdump eignen sich zur schnellen L√∂sung aktueller Probleme, aber in unserem Fall reichten ihre F√§higkeiten nicht aus, da wir viel Gigabyte Verkehr hatten, der von mehreren Personen analysiert wurde. </font><font style="vertical-align: inherit;">Wir haben den von AOL entwickelten Open-Source-Analysator Moloch verwendet. </font><font style="vertical-align: inherit;">In Bezug auf die Funktionalit√§t ist es mit Wireshark vergleichbar, bietet jedoch mehr Funktionen f√ºr die Zusammenarbeit, Beschreibung und Kennzeichnung von Paketen, den Export und andere Aufgaben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir die gesammelten Daten auf den Hanipot-Computern nicht verarbeiten wollten, wurden PCAP-Dumps jeden Tag in das AWS-Repository exportiert, von wo wir sie bereits mit Moloch auf den Computer importiert haben.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bildschirmaufnahme </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Aktionen von Crackern in unserem Hanipot zu dokumentieren, haben wir ein Skript geschrieben, das in einem bestimmten Intervall Screenshots der virtuellen Maschine erstellt und im Vergleich zum vorherigen Screenshot festgestellt hat, ob dort etwas passiert oder nicht. </font><font style="vertical-align: inherit;">Wenn Aktivit√§t erkannt wurde, enthielt das Skript eine Bildschirmaufzeichnung. </font><font style="vertical-align: inherit;">Dieser Ansatz hat sich als der effektivste erwiesen. </font><font style="vertical-align: inherit;">Wir haben auch versucht, den VNC-Verkehr vom PCAP-Dump zu analysieren, um zu verstehen, welche √Ñnderungen im System aufgetreten sind. Am Ende erwies sich die von uns implementierte Bildschirmaufzeichnung jedoch als einfacher und visueller.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberwachen von VNC-Sitzungen</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daf√ºr haben wir Chaosreader und VNCLogger verwendet. </font><font style="vertical-align: inherit;">Beide Dienstprogramme extrahieren Tastenanschl√§ge aus dem PCAP-Speicherauszug, aber VNCLogger behandelt Tasten wie R√ºcktaste, Eingabetaste und Strg korrekter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger hat zwei Nachteile. </font><font style="vertical-align: inherit;">Erstens: Es kann nur Schl√ºssel extrahieren, indem der Datenverkehr auf der Schnittstelle ‚Äûabgeh√∂rt‚Äú wird. Daher mussten wir mit tcpreplay eine VNC-Sitzung daf√ºr simulieren. </font><font style="vertical-align: inherit;">Der zweite Nachteil von VNCLogger ist bei Chaosreader gleich: Beide zeigen den Inhalt der Zwischenablage nicht an. </font><font style="vertical-align: inherit;">Dazu musste ich Wireshark verwenden.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker anlocken</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben einen Hanipot erstellt, der angegriffen werden soll. </font><font style="vertical-align: inherit;">Um dies zu erreichen, haben wir ein Informationsleck inszeniert, das die Aufmerksamkeit potenzieller Cracker auf sich ziehen soll. </font><font style="vertical-align: inherit;">Die folgenden Ports wurden auf dem Hanipot ge√∂ffnet: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="Bild"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der RDP-Port musste kurz nach Arbeitsbeginn geschlossen werden, da aufgrund des enormen </font><font style="vertical-align: inherit;">Scanverkehrs </font><font style="vertical-align: inherit;">in unserem Netzwerk Leistungsprobleme auftraten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNC-Terminals arbeiteten zuerst im "Nur-Ansicht" -Modus ohne Passwort, und dann haben wir sie "f√§lschlicherweise" in den Vollzugriffsmodus geschaltet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Angreifer anzulocken, haben wir zwei Posts mit durchgesickerten Informationen √ºber das verf√ºgbare Industriesystem auf PasteBin ver√∂ffentlicht. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer der Beitr√§ge auf PasteBin, um Angriffe anzuziehen. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anschl√§ge</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Hanipot lebte ungef√§hr sieben Monate online. Der erste Angriff erfolgte einen Monat nach der Ver√∂ffentlichung des Hanipot online. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanner</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es gab viel Verkehr von Scannern bekannter Unternehmen - IP-IP, Rapid, Shadow Server, Shodan, ZoomEye und andere. Es gab so viele von ihnen, dass wir ihre IP-Adressen von der Analyse ausschlie√üen mussten: 610 von 9452 oder 6,45% aller eindeutigen IP-Adressen geh√∂rten v√∂llig legitimen Scannern. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Betr√ºgern</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eines der gr√∂√üten Risiken , die </font><font style="vertical-align: inherit;">wir zu Gesicht hatten , </font><font style="vertical-align: inherit;">war die Verwendung unseres Systems f√ºr kriminelle Zwecke: Smartphones durch ein Teilnehmerkonto, Bargeld aus Airline - </font><font style="vertical-align: inherit;">Meilen mit Geschenkkarten und andere Arten von Betrug kaufen </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Miners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer der ersten Besucher unseres Systems war ein Bergmann. Er hat die Monero-Mining-Software hochgeladen. Aufgrund der geringen Produktivit√§t h√§tte er mit unserem spezifischen System nicht viel verdienen k√∂nnen. Wenn wir jedoch die Anstrengungen mehrerer zehn oder sogar Hunderte solcher Systeme kombinieren, k√∂nnte dies recht gut ausfallen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erpresser</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§hrend des Betriebs des Hanipot sind wir zweimal auf echte Ransomware-Viren gesto√üen. Im ersten Fall war es Crysis. Die Bediener haben sich √ºber VNC am System angemeldet, dann jedoch TeamViewer installiert und bereits weitere Aktionen damit ausgef√ºhrt. Nachdem wir auf eine Ransomware-Nachricht gewartet hatten, in der ein L√∂segeld von 10.000 US-Dollar f√ºr BTC verlangt wurde, nahmen wir Kontakt mit den Kriminellen auf und baten sie, eine der Dateien f√ºr uns zu entschl√ºsseln. Sie erf√ºllten die Bitte und wiederholten die L√∂segeldforderung. Wir haben es geschafft, bis zu 6.000 Dollar zu verhandeln. Danach haben wir das System einfach auf eine virtuelle Maschine neu geladen, weil wir alle notwendigen Informationen erhalten haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die zweite Ransomware war Phobos. Der Hacker, der es eine Stunde lang installiert hat, hat das Dateisystem des Hanipot durchsucht, das Netzwerk gescannt und dann die Ransomware installiert.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der dritte Ransomware-Angriff erwies sich als F√§lschung. </font><font style="vertical-align: inherit;">Ein unbekannter "Hacker" hat die Datei haha.bat auf unser System heruntergeladen. Danach haben wir einige Zeit beobachtet, wie er versucht hat, sie zum Laufen zu bringen. </font><font style="vertical-align: inherit;">Ein Versuch war, haha.bat in haha.rnsmwr umzubenennen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hacker" erh√∂ht die Sch√§dlichkeit der Bat-Datei und √§ndert ihre Erweiterung in .rnsmwr. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Als die Batch-Datei endlich ausgef√ºhrt wurde, wurde sie vom Hacker bearbeitet und das L√∂segeld von 200 USD auf 750 USD erh√∂ht. </font><font style="vertical-align: inherit;">Danach ‚Äûverschl√ºsselte‚Äú er alle Dateien, hinterlie√ü eine Ransomware-Nachricht auf dem Desktop und verschwand, wobei er die Passw√∂rter auf unserem VNC √§nderte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach ein paar Tagen kehrte der Hacker zur√ºck und um sich daran zu erinnern, startete er eine Batch-Datei, die viele Fenster mit einer Pornoseite √∂ffnete. </font><font style="vertical-align: inherit;">Anscheinend versuchte er auf diese Weise, auf seine Forderung aufmerksam zu machen.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
W√§hrend der Studie stellte sich heraus, dass der Hanipot die Aufmerksamkeit auf sich zog und die Aktivit√§t von Tag zu Tag zunahm, sobald Informationen √ºber die Sicherheitsanf√§lligkeit ver√∂ffentlicht wurden. Damit die Falle Aufmerksamkeit erregt, mussten wir viele Sicherheitsverletzungen unserer fiktiven Firma eingestehen. Leider ist diese Situation bei vielen echten Unternehmen, die kein Vollzeitpersonal f√ºr IT und Informationssicherheit haben, alles andere als selten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen sollten Organisationen das Prinzip der geringsten Privilegien anwenden, w√§hrend wir genau das Gegenteil implementiert haben, um Eindringlinge anzuziehen. Und je l√§nger wir die Angriffe beobachteten, desto ausgefeilter wurden sie im Vergleich zu Standard-Penetrationstestmethoden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und vor allem: Alle diese Angriffe w√ºrden fehlschlagen, wenn beim Einrichten des Netzwerks angemessene Sicherheitsma√ünahmen getroffen w√ºrden. </font><font style="vertical-align: inherit;">Unternehmen m√ºssen sicherstellen, dass ihre Ger√§te und Komponenten der industriellen Infrastruktur nicht √ºber das Internet zug√§nglich sind, wie wir es speziell in unserer Falle getan haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl wir keinen einzigen Angriff auf die Workstation des Ingenieurs aufgezeichnet haben, obwohl auf allen Computern dasselbe lokale Administratorkennwort verwendet wurde, sollten wir diese Vorgehensweise vermeiden, um die M√∂glichkeit von Eindringlingen zu minimieren. </font><font style="vertical-align: inherit;">In der Tat dient schlechte Sicherheit als zus√§tzliche Aufforderung, industrielle Systeme anzugreifen, die f√ºr Cyberkriminelle seit langem von Interesse sind.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490392/index.html">Catchain: TON Blockchain-Konsensalgorithmus</a></li>
<li><a href="../de490394/index.html">Commodore Amiga 500+: Lass niemanden beleidigt gehen</a></li>
<li><a href="../de490398/index.html">Red Hogwarts. Offiziere oder warum ein Historiker wie ein Detektiv ist</a></li>
<li><a href="../de490400/index.html">Verwenden der OpenCV-Bibliothek zum Erkennen von elliptischen B√∂gen in 2D-Abschnitten von 3D-Punktwolken</a></li>
<li><a href="../de490404/index.html">Warum und wie 5G alles ver√§ndern wird: Technologie, schrittweise Implementierung und Elementbasis f√ºr Teilnehmerger√§te</a></li>
<li><a href="../de490408/index.html">FreeBSD: Viel besser als GNU / Linux</a></li>
<li><a href="../de490410/index.html">Lebende und k√ºnstliche Neuronen, die √ºber das Internet verbunden sind</a></li>
<li><a href="../de490412/index.html">Vielleicht sollten wir uns mit JavaScript etwas beruhigen?</a></li>
<li><a href="../de490416/index.html">Vorlesungsvideo des Informatikclubs</a></li>
<li><a href="../de490418/index.html">Millennials und Generation Alpha VS Hochschulbildung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>