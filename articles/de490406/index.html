<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🚒 🎙️ 👩‍🚀 Unaussprechlich attraktiv: Wie wir einen Haniot geschaffen haben, der nicht entlarvt werden kann 😉 💆🏽 👩‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=", - - — , « » . , : , . , , , . , , «Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats». — . 
 
  : -
 Die Hauptaufgabe ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unaussprechlich attraktiv: Wie wir einen Haniot geschaffen haben, der nicht entlarvt werden kann</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="Bild"><br>
<i> , -       - — ,  «  »        .    ,      :   ,        .     ,    ,        ,    .  ,   ,      «<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats</a>».     —   . </i><br>
<a name="habracut"></a><br>
<h3> : -</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptaufgabe bei der Erstellung unserer Superfalle bestand darin, zu verhindern, dass wir von Hackern entlarvt werden, die Interesse daran zeigten. </font><font style="vertical-align: inherit;">Dazu musste ich viel arbeiten:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie eine realistische Legende über das Unternehmen, einschließlich Name und Foto der Mitarbeiter, Telefonnummern und E-Mails.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Modell der industriellen Infrastruktur zu erfinden und umzusetzen, das der Legende unseres Unternehmens entspricht. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entscheiden Sie, welche Netzwerkdienste außerhalb verfügbar sein sollen, aber beteiligen Sie sich nicht am Öffnen anfälliger Ports, damit diese nicht wie eine Falle für Coots aussehen. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisieren Sie das Auftreten von Informationslecks über das anfällige System und verbreiten Sie diese Informationen unter potenziellen Angreifern.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementieren Sie eine diskrete Überwachung von Hackern in der Trap-Infrastruktur. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und jetzt das Wichtigste zuerst.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Legende erstellen</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cyberkriminelle sind bereits daran gewöhnt, dass sie auf viele Manipulationen stoßen. Daher führt der am weitesten fortgeschrittene Teil von ihnen eine eingehende Untersuchung jedes anfälligen Systems durch, um sicherzustellen, dass dies keine Falle ist. Aus dem gleichen Grund haben wir uns bemüht, nicht nur den Realismus des Hanipot in Bezug auf Design und technische Aspekte zu erreichen, sondern auch das Erscheinungsbild eines echten Unternehmens zu schaffen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns an die Stelle eines hypothetischen Kulhakers gesetzt und einen Verifizierungsalgorithmus entwickelt, der ein reales System von einer Falle unterscheidet. Dazu gehörte die Suche nach IP-Adressen von Unternehmen in Reputationssystemen, die umgekehrte Untersuchung der Geschichte von IP-Adressen, die Suche nach Namen und Schlüsselwörtern im Zusammenhang mit dem Unternehmen sowie seinen Gegenparteien und vielen anderen Dingen. Infolgedessen erwies sich die Legende als sehr überzeugend und attraktiv.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns entschlossen, die Fallenfabrik als kleine industrielle Prototyping-Boutique zu positionieren, die für sehr große anonyme Kunden aus dem Militär- und Luftfahrtsegment arbeitet. Dadurch wurden die rechtlichen Schwierigkeiten bei der Verwendung einer bestehenden Marke beseitigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes mussten wir uns eine Vision, Mission und einen Namen der Organisation einfallen lassen. Wir haben beschlossen, dass unser Unternehmen ein Startup mit einer kleinen Anzahl von Mitarbeitern sein soll, von denen jeder Gründer ist. Dies fügte der Legende der Spezialisierung unseres Geschäfts Glaubwürdigkeit hinzu, die es ihm ermöglicht, mit heiklen Projekten für große und wichtige Kunden zu arbeiten. Wir wollten, dass unser Unternehmen in Bezug auf Cybersicherheit schwach aussieht, aber gleichzeitig war es offensichtlich, dass wir mit wichtigen Ressourcen in Zielsystemen arbeiten.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot der MeTech Hanipot-Site. Quelle: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben das Wort MeTech als Firmennamen gewählt. Die Seite wurde auf Basis einer kostenlosen Vorlage erstellt. Die Bilder wurden aus Fotobanken aufgenommen, wobei die unbeliebtesten und raffiniertesten verwendet wurden, um sie weniger erkennbar zu machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir wollten, dass das Unternehmen real aussieht, deshalb mussten wir Mitarbeiter mit professionellen Fähigkeiten hinzufügen, die dem Profil des Unternehmens entsprechen. Wir haben uns Namen und Persönlichkeiten für sie ausgedacht und dann versucht, Bilder aus Fotobanken entsprechend ihrer ethnischen Zugehörigkeit auszuwählen. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="Bild"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot der MeTech Hanipot-Site. Quelle: Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um uns nicht preiszugeben, suchten wir nach qualitativ hochwertigen Gruppenfotos, aus denen wir die Gesichter auswählen konnten, die wir brauchten. </font><font style="vertical-align: inherit;">Dann haben wir diese Option jedoch aufgegeben, da ein potenzieller Cracker die umgekehrte Bildsuche nutzen und feststellen könnte, dass unsere „Mitarbeiter“ nur in Fotobanken leben. </font><font style="vertical-align: inherit;">Am Ende nutzten wir Fotos von nicht existierenden Personen, die mit neuronalen Netzen erstellt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die auf der Website veröffentlichten Mitarbeiterprofile enthielten wichtige Informationen zu ihren technischen Fähigkeiten. Wir haben jedoch die Anweisungen bestimmter Bildungseinrichtungen und Städte vermieden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Erstellen von Postfächern haben wir den Server des Hosting-Anbieters verwendet, dann mehrere Telefonnummern in den USA gemietet und diese zu einer virtuellen Telefonzentrale mit einem Sprachmenü und einem Anrufbeantworter kombiniert.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanipot-Infrastruktur</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um nicht ausgesetzt zu werden, haben wir uns für eine Kombination aus realen Industrieanlagen, physischen Computern und sicheren virtuellen Maschinen entschieden. </font><font style="vertical-align: inherit;">Mit Blick auf die Zukunft sagen wir, dass wir das Ergebnis unserer Bemühungen mit der Shodan-Suchmaschine überprüft haben, und er hat gezeigt, dass der Hanipot wie ein echtes Industriesystem aussieht. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Ergebnis des Scannens eines Hanipots mit Shodan. </font><font style="vertical-align: inherit;">Quelle: Trend Micro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben vier SPS als Hardware für unsere Falle verwendet:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siemens S7-1200,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwei AllenBradley MicroLogix 1100,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omron CP1L.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese SPS wurden aufgrund ihrer Beliebtheit auf dem Weltmarkt für Steuerungssysteme ausgewählt. </font><font style="vertical-align: inherit;">Und jeder dieser Controller verwendet sein eigenes Protokoll, mit dem wir überprüfen können, welche der SPSen häufiger angreifen und ob sie grundsätzlich jemanden interessieren. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Ausrüstung unserer "Fabrik" -Falle. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben nicht nur Eisenstücke eingelegt und mit dem Internet verbunden. </font><font style="vertical-align: inherit;">Wir haben jeden Controller so programmiert, dass er Aufgaben ausführt, darunter:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mischen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brenner- und Förderbandsteuerung,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Palettieren mit einem Roboterarm.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Produktionsprozess realistisch zu gestalten, haben wir die Logik so programmiert, dass die Rückkopplungsparameter zufällig geändert, das Starten und Stoppen von Motoren sowie das Ein- und Ausschalten des Brenners simuliert werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unsere Fabrik hatte drei virtuelle Computer und einen physischen. Die virtuellen Maschinen wurden zur Steuerung der Anlage, des Palettierroboters und als automatisierter Arbeitsplatz des SPS-Softwareentwicklers verwendet. Der physische Computer arbeitete als Dateiserver.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neben der Überwachung von Angriffen auf die SPS wollten wir den Status von Programmen überwachen, die auf unsere Geräte heruntergeladen wurden. Zu diesem Zweck haben wir eine Schnittstelle erstellt, mit der wir schnell feststellen können, wie die Zustände unserer virtuellen Aktuatoren und Installationen geändert wurden. Bereits in der Planungsphase haben wir festgestellt, dass es viel einfacher ist, dies mit Hilfe eines Steuerprogramms umzusetzen als durch direkte Programmierung der Steuerlogik. Wir haben den Zugriff auf die Geräteverwaltungsoberfläche unseres Hanipots über VNC ohne Passwort geöffnet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Industrieroboter sind eine Schlüsselkomponente der modernen intelligenten Fertigung. In diesem Zusammenhang haben wir beschlossen, einen Roboter und AWP hinzuzufügen, um ihn in der Ausrüstung unserer Fabrikfalle zu steuern. Um die "Fabrik" realistischer zu gestalten, haben wir echte Software auf der AWP-Steuerung installiert, mit der Ingenieure die Roboterlogik grafisch programmieren. Da sich Industrieroboter normalerweise in einem isolierten internen Netzwerk befinden, haben wir beschlossen, den ungeschützten VNC-Zugriff nur der Workstation-Verwaltung zu überlassen. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RobotStudio-Umgebung mit einem 3D-Modell unseres Roboters. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf einer virtuellen Maschine mit einer Robotersteuerungs-Workstation haben wir die RobotStudio-Programmierumgebung von ABB Robotics installiert. </font><font style="vertical-align: inherit;">Nachdem wir RobotStudio eingerichtet hatten, öffneten wir mit unserem Roboter eine Simulationsdatei, sodass das 3D-Bild auf dem Bildschirm sichtbar war. </font><font style="vertical-align: inherit;">Infolgedessen erhalten Shodan und andere Suchmaschinen, die einen ungeschützten VNC-Server entdeckt haben, dieses Bild vom Bildschirm und zeigen es denjenigen, die nach Industrierobotern mit offenem Zugang zur Steuerung suchen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Bedeutung dieser Liebe zum Detail bestand darin, ein attraktives und realistisches Ziel für Angreifer zu schaffen, die, nachdem sie es entdeckt hatten, immer wieder darauf zurückkommen würden.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWP Ingenieur</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die SPS-Logik zu programmieren, haben wir der Infrastruktur einen technischen Computer hinzugefügt. </font><font style="vertical-align: inherit;">Darauf wurde eine industrielle Software für die SPS-Programmierung installiert:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TIA Portal für Siemens,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroLogix für Allen-Bradley-Controller,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CX-One für Omron.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben entschieden, dass die Engineering-Workstation außerhalb des Netzwerks nicht zugänglich ist. </font><font style="vertical-align: inherit;">Stattdessen legen wir für das Administratorkonto das gleiche Kennwort fest wie auf den Arbeitsstationen der Robotersteuerung und den Arbeitsstationen der Fabrik, auf die über das Internet zugegriffen werden kann. </font><font style="vertical-align: inherit;">Diese Konfiguration ist in vielen Unternehmen weit verbreitet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider hat trotz aller Bemühungen kein einziger Angreifer die AWP des Ingenieurs erreicht.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dateiserver</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir brauchten es als Lockvogel für Eindringlinge und als Mittel, um unsere eigene „Arbeit“ in einer Fallenfabrik zu sichern. Dies ermöglichte es uns, Dateien mit unserem Haniot über USB-Geräte zu teilen, ohne Spuren in der Netzwerkfalle zu hinterlassen. Als Betriebssystem für den Dateiserver haben wir Windows 7 Pro installiert, in dem wir einen freigegebenen Ordner zum Lesen und Schreiben für jedermann zugänglich gemacht haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst haben wir keine Hierarchie von Ordnern und Dokumenten auf dem Dateiserver erstellt. Dann stellte sich jedoch heraus, dass die Angreifer diesen Ordner aktiv studierten, und wir beschlossen, ihn mit verschiedenen Dateien zu füllen. Zu diesem Zweck haben wir ein Python-Skript geschrieben, das eine Datei mit zufälliger Größe mit einer der angegebenen Erweiterungen erstellt und einen Namen basierend auf dem Wörterbuch gebildet hat. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Skript zum Generieren attraktiver Dateinamen. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Ausführen des Skripts haben wir das gewünschte Ergebnis in Form eines Ordners erhalten, der mit Dateien mit sehr interessanten Namen gefüllt ist. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Ergebnis des Skripts. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überwachungsumgebung</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir uns so viel Mühe gegeben hatten, ein realistisches Unternehmen zu schaffen, konnten wir es uns einfach nicht leisten, uns in die Umgebung zu injizieren, um unsere „Besucher“ zu überwachen. Wir mussten alle Daten in Echtzeit abrufen, damit die Angreifer nicht bemerkten, dass sie beobachtet wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben dies mit vier USB-Ethernet-Adaptern, vier SharkTap-Ethernet-Kopplern, Raspberry Pi 3 und einem großen externen Laufwerk implementiert. Das Schema unseres Netzwerks sah folgendermaßen aus: </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schema eines Hanipot-Netzwerks mit Überwachungsgeräten. Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir haben drei SharkTap-Taps eingerichtet, um den gesamten externen Datenverkehr zu SPS zu überwachen, auf die nur über das interne Netzwerk zugegriffen werden kann. Der vierte SharkTap verfolgte den Datenverkehr der Gäste der anfälligen virtuellen Maschine.</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharkTap Ethernet-Koppler und Sierra Wireless AirLink RV50 Router. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Pi führte eine tägliche Erfassung des Datenverkehrs durch. </font><font style="vertical-align: inherit;">Wir haben eine Internetverbindung mit dem Mobilfunkrouter Sierra Wireless AirLink RV50 hergestellt, der häufig in Industrieunternehmen verwendet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider erlaubte dieser Router kein selektives Blockieren von Angriffen, die nicht unseren Plänen entsprachen. Daher haben wir dem Netzwerk die Cisco ASA 5505-Firewall in einem transparenten Modus hinzugefügt, um das Blockieren mit minimalen Auswirkungen auf das Netzwerk durchzuführen.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkehrsanalyse</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tshark und tcpdump eignen sich zur schnellen Lösung aktueller Probleme, aber in unserem Fall reichten ihre Fähigkeiten nicht aus, da wir viel Gigabyte Verkehr hatten, der von mehreren Personen analysiert wurde. </font><font style="vertical-align: inherit;">Wir haben den von AOL entwickelten Open-Source-Analysator Moloch verwendet. </font><font style="vertical-align: inherit;">In Bezug auf die Funktionalität ist es mit Wireshark vergleichbar, bietet jedoch mehr Funktionen für die Zusammenarbeit, Beschreibung und Kennzeichnung von Paketen, den Export und andere Aufgaben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da wir die gesammelten Daten auf den Hanipot-Computern nicht verarbeiten wollten, wurden PCAP-Dumps jeden Tag in das AWS-Repository exportiert, von wo wir sie bereits mit Moloch auf den Computer importiert haben.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bildschirmaufnahme </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Aktionen von Crackern in unserem Hanipot zu dokumentieren, haben wir ein Skript geschrieben, das in einem bestimmten Intervall Screenshots der virtuellen Maschine erstellt und im Vergleich zum vorherigen Screenshot festgestellt hat, ob dort etwas passiert oder nicht. </font><font style="vertical-align: inherit;">Wenn Aktivität erkannt wurde, enthielt das Skript eine Bildschirmaufzeichnung. </font><font style="vertical-align: inherit;">Dieser Ansatz hat sich als der effektivste erwiesen. </font><font style="vertical-align: inherit;">Wir haben auch versucht, den VNC-Verkehr vom PCAP-Dump zu analysieren, um zu verstehen, welche Änderungen im System aufgetreten sind. Am Ende erwies sich die von uns implementierte Bildschirmaufzeichnung jedoch als einfacher und visueller.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überwachen von VNC-Sitzungen</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dafür haben wir Chaosreader und VNCLogger verwendet. </font><font style="vertical-align: inherit;">Beide Dienstprogramme extrahieren Tastenanschläge aus dem PCAP-Speicherauszug, aber VNCLogger behandelt Tasten wie Rücktaste, Eingabetaste und Strg korrekter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLogger hat zwei Nachteile. </font><font style="vertical-align: inherit;">Erstens: Es kann nur Schlüssel extrahieren, indem der Datenverkehr auf der Schnittstelle „abgehört“ wird. Daher mussten wir mit tcpreplay eine VNC-Sitzung dafür simulieren. </font><font style="vertical-align: inherit;">Der zweite Nachteil von VNCLogger ist bei Chaosreader gleich: Beide zeigen den Inhalt der Zwischenablage nicht an. </font><font style="vertical-align: inherit;">Dazu musste ich Wireshark verwenden.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker anlocken</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben einen Hanipot erstellt, der angegriffen werden soll. </font><font style="vertical-align: inherit;">Um dies zu erreichen, haben wir ein Informationsleck inszeniert, das die Aufmerksamkeit potenzieller Cracker auf sich ziehen soll. </font><font style="vertical-align: inherit;">Die folgenden Ports wurden auf dem Hanipot geöffnet: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="Bild"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der RDP-Port musste kurz nach Arbeitsbeginn geschlossen werden, da aufgrund des enormen </font><font style="vertical-align: inherit;">Scanverkehrs </font><font style="vertical-align: inherit;">in unserem Netzwerk Leistungsprobleme auftraten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNC-Terminals arbeiteten zuerst im "Nur-Ansicht" -Modus ohne Passwort, und dann haben wir sie "fälschlicherweise" in den Vollzugriffsmodus geschaltet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Angreifer anzulocken, haben wir zwei Posts mit durchgesickerten Informationen über das verfügbare Industriesystem auf PasteBin veröffentlicht. </font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einer der Beiträge auf PasteBin, um Angriffe anzuziehen. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anschläge</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Hanipot lebte ungefähr sieben Monate online. Der erste Angriff erfolgte einen Monat nach der Veröffentlichung des Hanipot online. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanner</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Es gab viel Verkehr von Scannern bekannter Unternehmen - IP-IP, Rapid, Shadow Server, Shodan, ZoomEye und andere. Es gab so viele von ihnen, dass wir ihre IP-Adressen von der Analyse ausschließen mussten: 610 von 9452 oder 6,45% aller eindeutigen IP-Adressen gehörten völlig legitimen Scannern. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Betrügern</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eines der größten Risiken , die </font><font style="vertical-align: inherit;">wir zu Gesicht hatten , </font><font style="vertical-align: inherit;">war die Verwendung unseres Systems für kriminelle Zwecke: Smartphones durch ein Teilnehmerkonto, Bargeld aus Airline - </font><font style="vertical-align: inherit;">Meilen mit Geschenkkarten und andere Arten von Betrug kaufen </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Miners</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einer der ersten Besucher unseres Systems war ein Bergmann. Er hat die Monero-Mining-Software hochgeladen. Aufgrund der geringen Produktivität hätte er mit unserem spezifischen System nicht viel verdienen können. Wenn wir jedoch die Anstrengungen mehrerer zehn oder sogar Hunderte solcher Systeme kombinieren, könnte dies recht gut ausfallen. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erpresser</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während des Betriebs des Hanipot sind wir zweimal auf echte Ransomware-Viren gestoßen. Im ersten Fall war es Crysis. Die Bediener haben sich über VNC am System angemeldet, dann jedoch TeamViewer installiert und bereits weitere Aktionen damit ausgeführt. Nachdem wir auf eine Ransomware-Nachricht gewartet hatten, in der ein Lösegeld von 10.000 US-Dollar für BTC verlangt wurde, nahmen wir Kontakt mit den Kriminellen auf und baten sie, eine der Dateien für uns zu entschlüsseln. Sie erfüllten die Bitte und wiederholten die Lösegeldforderung. Wir haben es geschafft, bis zu 6.000 Dollar zu verhandeln. Danach haben wir das System einfach auf eine virtuelle Maschine neu geladen, weil wir alle notwendigen Informationen erhalten haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die zweite Ransomware war Phobos. Der Hacker, der es eine Stunde lang installiert hat, hat das Dateisystem des Hanipot durchsucht, das Netzwerk gescannt und dann die Ransomware installiert.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der dritte Ransomware-Angriff erwies sich als Fälschung. </font><font style="vertical-align: inherit;">Ein unbekannter "Hacker" hat die Datei haha.bat auf unser System heruntergeladen. Danach haben wir einige Zeit beobachtet, wie er versucht hat, sie zum Laufen zu bringen. </font><font style="vertical-align: inherit;">Ein Versuch war, haha.bat in haha.rnsmwr umzubenennen. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="Bild"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Hacker" erhöht die Schädlichkeit der Bat-Datei und ändert ihre Erweiterung in .rnsmwr. </font><font style="vertical-align: inherit;">Quelle: Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Als die Batch-Datei endlich ausgeführt wurde, wurde sie vom Hacker bearbeitet und das Lösegeld von 200 USD auf 750 USD erhöht. </font><font style="vertical-align: inherit;">Danach „verschlüsselte“ er alle Dateien, hinterließ eine Ransomware-Nachricht auf dem Desktop und verschwand, wobei er die Passwörter auf unserem VNC änderte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach ein paar Tagen kehrte der Hacker zurück und um sich daran zu erinnern, startete er eine Batch-Datei, die viele Fenster mit einer Pornoseite öffnete. </font><font style="vertical-align: inherit;">Anscheinend versuchte er auf diese Weise, auf seine Forderung aufmerksam zu machen.</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der Studie stellte sich heraus, dass der Hanipot die Aufmerksamkeit auf sich zog und die Aktivität von Tag zu Tag zunahm, sobald Informationen über die Sicherheitsanfälligkeit veröffentlicht wurden. Damit die Falle Aufmerksamkeit erregt, mussten wir viele Sicherheitsverletzungen unserer fiktiven Firma eingestehen. Leider ist diese Situation bei vielen echten Unternehmen, die kein Vollzeitpersonal für IT und Informationssicherheit haben, alles andere als selten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen sollten Organisationen das Prinzip der geringsten Privilegien anwenden, während wir genau das Gegenteil implementiert haben, um Eindringlinge anzuziehen. Und je länger wir die Angriffe beobachteten, desto ausgefeilter wurden sie im Vergleich zu Standard-Penetrationstestmethoden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und vor allem: Alle diese Angriffe würden fehlschlagen, wenn beim Einrichten des Netzwerks angemessene Sicherheitsmaßnahmen getroffen würden. </font><font style="vertical-align: inherit;">Unternehmen müssen sicherstellen, dass ihre Geräte und Komponenten der industriellen Infrastruktur nicht über das Internet zugänglich sind, wie wir es speziell in unserer Falle getan haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl wir keinen einzigen Angriff auf die Workstation des Ingenieurs aufgezeichnet haben, obwohl auf allen Computern dasselbe lokale Administratorkennwort verwendet wurde, sollten wir diese Vorgehensweise vermeiden, um die Möglichkeit von Eindringlingen zu minimieren. </font><font style="vertical-align: inherit;">In der Tat dient schlechte Sicherheit als zusätzliche Aufforderung, industrielle Systeme anzugreifen, die für Cyberkriminelle seit langem von Interesse sind.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de490392/index.html">Catchain: TON Blockchain-Konsensalgorithmus</a></li>
<li><a href="../de490394/index.html">Commodore Amiga 500+: Lass niemanden beleidigt gehen</a></li>
<li><a href="../de490398/index.html">Red Hogwarts. Offiziere oder warum ein Historiker wie ein Detektiv ist</a></li>
<li><a href="../de490400/index.html">Verwenden der OpenCV-Bibliothek zum Erkennen von elliptischen Bögen in 2D-Abschnitten von 3D-Punktwolken</a></li>
<li><a href="../de490404/index.html">Warum und wie 5G alles verändern wird: Technologie, schrittweise Implementierung und Elementbasis für Teilnehmergeräte</a></li>
<li><a href="../de490408/index.html">FreeBSD: Viel besser als GNU / Linux</a></li>
<li><a href="../de490410/index.html">Lebende und künstliche Neuronen, die über das Internet verbunden sind</a></li>
<li><a href="../de490412/index.html">Vielleicht sollten wir uns mit JavaScript etwas beruhigen?</a></li>
<li><a href="../de490416/index.html">Vorlesungsvideo des Informatikclubs</a></li>
<li><a href="../de490418/index.html">Millennials und Generation Alpha VS Hochschulbildung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>