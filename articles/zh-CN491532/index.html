<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ğŸ¾ ğŸˆ¶ ğŸ˜‰ Laravel + Docker + Gitlab ä»å“ªé‡Œå¼€å§‹ ğŸ˜Ÿ ğŸ™‹ğŸ» ğŸ¦€</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘é€šå¸¸æ€»æ˜¯æ²¡æœ‰dockerï¼Œå¹¶è®¤ä¸ºåªæœ‰å¤§å‹å…¬å¸ä¸­çš„å¤§å‹é¡¹ç›®æ‰éœ€è¦dockerã€‚ä½†æ˜¯æœ‰ä¸€å¤©ï¼Œæˆ‘çœ‹åˆ°äº†ç å¤´å·¥äººå¦‚ä½•ä¸æœ‹å‹çš„gitlabååŒå·¥ä½œï¼Œå¹¶æ„è¯†åˆ°æˆ‘ä»ç„¶åº”è¯¥ç ”ç©¶å®ƒã€‚ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘æ‰¾ä¸åˆ°åˆé€‚çš„æ–‡ç« -å®ƒä»¬å¤ªå¤æ‚æˆ–ä¸å®Œæ•´ï¼Œæˆ–æš—ç¤ºå¤§å®¶éƒ½çŸ¥é“ã€‚æˆ‘ä¸å¾—ä¸é•¿æœŸå¯»æ‰¾å„ç§èµ„æºï¼Œå°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œæœ€åæˆ‘è®¾æ³•ä¸ºå…¶ç¼–...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Laravel + Docker + Gitlab ä»å“ªé‡Œå¼€å§‹</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/491532/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘é€šå¸¸æ€»æ˜¯æ²¡æœ‰dockerï¼Œå¹¶è®¤ä¸ºåªæœ‰å¤§å‹å…¬å¸ä¸­çš„å¤§å‹é¡¹ç›®æ‰éœ€è¦dockerã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯æœ‰ä¸€å¤©ï¼Œæˆ‘çœ‹åˆ°äº†ç å¤´å·¥äººå¦‚ä½•ä¸æœ‹å‹çš„gitlabååŒå·¥ä½œï¼Œå¹¶æ„è¯†åˆ°æˆ‘ä»ç„¶åº”è¯¥ç ”ç©¶å®ƒã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘æ‰¾ä¸åˆ°åˆé€‚çš„æ–‡ç« -å®ƒä»¬å¤ªå¤æ‚æˆ–ä¸å®Œæ•´ï¼Œæˆ–æš—ç¤ºå¤§å®¶éƒ½çŸ¥é“ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä¸å¾—ä¸é•¿æœŸå¯»æ‰¾å„ç§èµ„æºï¼Œå°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œæœ€åæˆ‘è®¾æ³•ä¸ºå…¶ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„é¡¹ç›®å’ŒCI / CDã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰€æœ‰å·¥ä½œå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šï¼Œåœ¨hitlabä¸Šå’Œåœ¨æœåŠ¡å™¨ä¸Šã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œå¯¹äºé¡¹ç›®çš„å®æ–½ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªgitlabå¸æˆ·å’Œä¸€ä¸ªå…·æœ‰KVMæˆ–XENè™šæ‹ŸåŒ–åŠŸèƒ½çš„è¿œç¨‹æœåŠ¡å™¨ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬1éƒ¨åˆ†ã€‚æœ¬åœ°è®¡ç®—æœº</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šï¼Œæ‚¨éœ€è¦å®‰è£…dockerã€‚ </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯„è®º</font></font></b><div class="spoiler_text">  . Docker     Linux  ( Ubuntu, ),    Windows  MacOS.   macos     ,     Windows      .   - ,        linux .   - ,           .       VirtualBox.          Ubuntu     <br>
</div></div><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦åœ¨Linuxç¯å¢ƒä¸­å®‰è£…ï¼Œå¿…é¡»è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ é™¤æ—§å®¹å™¨ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get remove docker docker-engine docker.io containerd runc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ–°aptï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get update
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®‰è£…ä»¥ä¸‹è½¯ä»¶åŒ…ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥é€šè¿‡httpsä»å­˜å‚¨åº“ä¸‹è½½dockerï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install \<font></font>
    apt-transport-https \<font></font>
    ca-certificates \<font></font>
    curl \<font></font>
    gnupg-agent \<font></font>
    software-properties-common</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ·»åŠ å®˜æ–¹GPG Dockerå¯†é’¥ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¡®ä¿æ‰“å°æ­£ç¡®ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-key fingerprint 0EBFCD88</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›ç­”ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">pub   rsa4096 2017-02-22 [SCEA]<font></font>
      9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88<font></font>
uid           [ unknown] Docker Release (CE deb) &lt;docker@docker.com&gt;<font></font>
sub   rsa4096 2017-02-22 [S]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹è½½ç¨³å®šç‰ˆï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo add-apt-repository \
   <span class="hljs-string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   <span class="hljs-subst">$(lsb_release -cs)</span> \
   stable"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å†æ¬¡æ›´æ–°aptï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get update</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®‰è£…æœ€æ–°çš„dockerå¼•æ“ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get install docker-ce docker-ce-cli containerd.io</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥dockeræ“ä½œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo docker run hello-world</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æœä¸€åˆ‡æ­£ç¡®ï¼Œå°†å¼€å§‹ä¸‹è½½Hello Worldå›¾åƒã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dockerå®˜æ–¹æ–‡æ¡£ä¸­çš„å®Œæ•´è¯´æ˜</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…docker-composeã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®˜æ–¹è¯´æ˜åœ¨è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å®‰è£…å®ƒï¼Œè¯·åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»èµ„æºåº“ä¸‹è½½ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo curl -L <span class="hljs-string">"https://github.com/docker/compose/releases/download/1.25.4/docker-compose-<span class="hljs-subst">$(uname -s)</span>-<span class="hljs-subst">$(uname -m)</span>"</span> -o /usr/<span class="hljs-built_in">local</span>/bin/docker-compose</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ·»åŠ è¡Œä½¿æƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo chmod +x /usr/<span class="hljs-built_in">local</span>/bin/docker-compose</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç‰ˆæœ¬æ£€æŸ¥ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo docker-compose --version</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å®‰è£…äº†æ³Šåçª—ï¼Œç°åœ¨æœ‰å¿…è¦æ”¶é›†æ˜ åƒã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†digitaloceanç½‘ç«™ä¸Šçš„æ–‡ç« ï¼š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.digitalocean.com/community/tutorials/how-to-set-up-laravel-nginx-and-mysql-with-docker-compose-ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æœ¬æ–‡å°†é‡å°ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½Laravelå¹¶å®‰è£…ä¾èµ–é¡¹</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„Laravelå¹¶å®‰è£…é¡¹ç›®ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬åº”ç”¨ç¨‹åºçº§PHPåŒ…ç®¡ç†å™¨Composerã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ä½¿ç”¨Dockerå®‰è£…è¿™äº›ä¾èµ–é¡¹ï¼Œä»¥å…æ‰§è¡ŒComposerçš„å…¨å±€å®‰è£…ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è½¬åˆ°ä¸»ç›®å½•ï¼Œå¹¶å°†æœ€æ–°ç‰ˆæœ¬çš„Laravelå…‹éš†åˆ°åä¸ºlaravel-appçš„ç›®å½•ä¸­ï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ~<font></font>
git <span class="hljs-built_in">clone</span> https://github.com/laravel/laravel.git laravel-app</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿›å…¥laravel-appç›®å½•ï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> ~/laravel-app</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åå°†Dockerä¸­çš„composeræ˜ åƒæŒ‚è½½åˆ°Laravelé¡¹ç›®æ‰€éœ€çš„ç›®å½•ä¸­ï¼Œä»¥é¿å…å…¨å±€å®‰è£…Composerçš„å¼€é”€ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker run --rm -v $(<span class="hljs-built_in">pwd</span>):/app composer install</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
docker runå‘½ä»¤çš„-vå’Œ--rmæ ‡å¿—åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿå®¹å™¨ï¼Œè¯¥è™šæ‹Ÿå®¹å™¨ç»‘å®šåˆ°å½“å‰ç›®å½•ï¼Œç›´åˆ°å°†å…¶åˆ é™¤ã€‚</font><font style="vertical-align: inherit;">ã€œ/ laravel-appç›®å½•çš„å†…å®¹å°†è¢«å¤åˆ¶åˆ°å®¹å™¨ï¼Œå¹¶ä¸”åœ¨ä¾›åº”å•†æ–‡ä»¶å¤¹å®¹å™¨å†…åˆ›å»ºçš„Composerçš„å†…å®¹å°†è¢«å¤åˆ¶åˆ°å½“å‰ç›®å½•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸­è®¾ç½®æƒé™çº§åˆ«ï¼Œä»¥ä½¿å…¶ç”±æ²¡æœ‰rootç‰¹æƒçš„ç”¨æˆ·æ‹¥æœ‰ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo chown -R <span class="hljs-variable">$USER</span>:<span class="hljs-variable">$USER</span> ~/laravel-app</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å½“æ‚¨ä¸ºåº”ç”¨ç¨‹åºçš„æ˜ åƒç¼–å†™Dockerfileæ—¶ï¼Œè¿™å°†å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå°†å…è®¸æ‚¨ä½¿ç”¨åº”ç”¨ç¨‹åºä»£ç å¹¶åœ¨æ²¡æœ‰rootç‰¹æƒçš„æƒ…å†µä¸‹å¯åŠ¨å®¹å™¨ä¸­çš„è¿›ç¨‹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å·²ç»æ”¾ç½®äº†åº”ç”¨ç¨‹åºä»£ç ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨Docker Composeè¿›è¡ŒæœåŠ¡çš„å®šä¹‰ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨Docker Composeåˆ›å»ºDocker Compose File</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Buildingåº”ç”¨ç¨‹åºå¯ç®€åŒ–åŸºç¡€æ¶æ„ä¸­çš„é…ç½®å’Œç‰ˆæœ¬æ§åˆ¶è¿‡ç¨‹ã€‚ä¸ºäº†è‡ªå®šä¹‰æˆ‘ä»¬çš„Laravelåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªdocker-composeæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«WebæœåŠ¡å™¨æœåŠ¡ï¼Œæ•°æ®åº“å’Œåº”ç”¨ç¨‹åºçš„å®šä¹‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰“å¼€æ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/laravel-app/docker-compose.yml</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨docker-composeæ–‡ä»¶ä¸­å®šä¹‰äº†ä¸‰ä¸ªæœåŠ¡ï¼šappï¼Œwebserverå’Œdbã€‚</font><font style="vertical-align: inherit;">å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶ç”¨æ‚¨é€‰æ‹©çš„å¯†ç æ›¿æ¢å®šä¹‰ä¸ºdbæœåŠ¡ç¯å¢ƒå˜é‡çš„MYSQL_ROOT_PASSWORDçš„æ ¹å¯†ç ï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">version: '3'<font></font>
services:<font></font>
<font></font>
  #PHP Service<font></font>
  app:<font></font>
    build:<font></font>
      context: .<font></font>
      dockerfile: Dockerfile<font></font>
    image: digitalocean.com/php<font></font>
    container_name: app<font></font>
    restart: unless-stopped<font></font>
    tty: true<font></font>
    environment:<font></font>
      SERVICE_NAME: app<font></font>
      SERVICE_TAGS: dev<font></font>
    working_dir: /var/www<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
  #Nginx Service<font></font>
  webserver:<font></font>
    image: nginx:alpine<font></font>
    container_name: webserver<font></font>
    restart: unless-stopped<font></font>
    tty: true<font></font>
    ports:<font></font>
      - "80:80"<font></font>
      - "443:443"<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
  #MySQL Service<font></font>
  db:<font></font>
    image: mysql:5.7.22<font></font>
    container_name: db<font></font>
    restart: unless-stopped<font></font>
    tty: true<font></font>
    ports:<font></font>
      - "3306:3306"<font></font>
    environment:<font></font>
      MYSQL_DATABASE: laravel<font></font>
      MYSQL_ROOT_PASSWORD: your_mysql_root_password<font></font>
      SERVICE_TAGS: dev<font></font>
      SERVICE_NAME: mysql<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
#Docker Networks<font></font>
networks:<font></font>
  app-network:<font></font>
    driver: bridge</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿™é‡ŒåŒ…æ‹¬ä»¥ä¸‹æœåŠ¡ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº”ç”¨ç¨‹åºï¼šæ­¤æœåŠ¡å®šä¹‰åŒ…å«Laravelåº”ç”¨ç¨‹åºï¼Œå¹¶å¯åŠ¨ä¸ªæ€§åŒ–çš„Dockeræ˜ åƒdigitalocean.com/phpã€‚</font><font style="vertical-align: inherit;">è¿˜å°†å®¹å™¨ä¸­çš„working_dirå‚æ•°è®¾ç½®ä¸º/ var / wwwã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç½‘ç»œæœåŠ¡å™¨ï¼šæ­¤æœåŠ¡å®šä¹‰ä»Dockerè·å–nginxï¼šalpineæ˜ åƒï¼Œå¹¶æ‰“å¼€ç«¯å£80å’Œ443ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dbï¼šæ­¤æœåŠ¡å®šä¹‰ä»Dockeræ£€ç´¢mysqlï¼š5.7.22æ˜ åƒï¼Œå¹¶å®šä¹‰æ–°çš„ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬åº”ç”¨ç¨‹åºçš„laravelæ•°æ®åº“å’Œè¯¥æ•°æ®åº“çš„rootå¯†ç ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä½¿ç”¨æ‰€éœ€çš„ä»»ä½•æ•°æ®åº“åç§°ï¼Œè¿˜åº”ä½¿ç”¨è‡ªå·±çš„å¼ºå¯†ç æ›¿æ¢your_mysql_root_passwordã€‚</font><font style="vertical-align: inherit;">æ­¤æœåŠ¡å®šä¹‰è¿˜å°†ä¸»æœºç«¯å£3306æ˜ å°„åˆ°å®¹å™¨ç«¯å£3306ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¯ä¸ªcontainer_nameå±æ€§å®šä¹‰ä¸€ä¸ªä¸æœåŠ¡åç§°ç›¸å¯¹åº”çš„å®¹å™¨åç§°ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨æœªå®šä¹‰æ­¤å±æ€§ï¼Œåˆ™Dockerå°†ä¸ºæ¯ä¸ªå®¹å™¨æä¾›ç”±å†å²äººç‰©çš„åç§°å’Œéšæœºå•è¯ç»„æˆçš„åç§°ï¼Œå¹¶ç”¨ä¸‹åˆ’çº¿åˆ†éš”ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†ç®€åŒ–å®¹å™¨ä¹‹é—´çš„äº¤äº’ï¼ŒæœåŠ¡è¿æ¥åˆ°åä¸ºapp-networkçš„è¿æ¥ç½‘ç»œã€‚è¿æ¥ç½‘ç»œä½¿ç”¨è½¯ä»¶æ¡¥æ¥å™¨ï¼Œè¯¥è½¯ä»¶æ¡¥æ¥å™¨å…è®¸è¿æ¥åˆ°è¯¥ç½‘ç»œçš„å®¹å™¨ç›¸äº’é€šä¿¡ã€‚æ¡¥é©±åŠ¨ç¨‹åºä¼šè‡ªåŠ¨è®¾ç½®ä¸»æœºè§„åˆ™ï¼Œä»¥ä½¿ä¸åŒè¿æ¥ç½‘ç»œä¸Šçš„å®¹å™¨æ— æ³•ç›´æ¥ç›¸äº’é€šä¿¡ã€‚å› ä¸ºåªæœ‰ç›¸å…³çš„æœåŠ¡æ‰èƒ½ç›¸äº’é€šä¿¡ï¼Œæ‰€ä»¥å¯ä»¥æé«˜åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚è¿™ä¹Ÿæ„å‘³ç€æ‚¨å¯ä»¥æŒ‡å®šè¿æ¥åˆ°ç›¸å…³åŠŸèƒ½çš„ä¸åŒç½‘ç»œå’ŒæœåŠ¡ï¼šä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæœåŠ¡å¯ä»¥ä½¿ç”¨å‰ç«¯ç½‘ç»œï¼Œè€ŒæœåŠ¡å™¨æœåŠ¡å¯ä»¥ä½¿ç”¨åç«¯ç½‘ç»œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•æ·»åŠ å·å¹¶å°†ç»‘å®šçš„æ˜ åƒç»‘å®šåˆ°æœåŠ¡å®šä¹‰ä»¥æ°¸ä¹…ä¿å­˜åº”ç”¨ç¨‹åºæ•°æ®ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒä¹…æ•°æ®å­˜å‚¨</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dockerå…·æœ‰å¼ºå¤§è€Œä¾¿æ·çš„æŒä¹…æ•°æ®å­˜å‚¨æ–¹å¼ã€‚</font><font style="vertical-align: inherit;">åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å·å’Œè£…å…¥çš„æ˜ åƒæ°¸ä¹…ä¿å­˜æ•°æ®åº“æ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºå’Œé…ç½®ã€‚</font><font style="vertical-align: inherit;">å·åœ¨å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç»ˆæ­¢æ—¶æä¾›äº†å¤‡ä»½çµæ´»æ€§å’Œä¿å­˜æ€§ï¼Œå¯å®‰è£…çš„å¯å®‰è£…æ˜ åƒé€šè¿‡ç«‹å³åæ˜ å®¹å™¨ä¸­çš„ä¸»æœºæ–‡ä»¶æˆ–ç›®å½•çš„æ›´æ”¹ï¼Œç®€åŒ–äº†å¼€å‘è¿‡ç¨‹ä¸­çš„ä»£ç æ›´æ”¹ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§é€‰æ‹©ã€‚</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­¦å‘Šï¼</font></font></b><div class="spoiler_text">             ,   ,        .      ,       Docker   .       .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨dbæœåŠ¡å®šä¹‰çš„docker-composeæ–‡ä»¶ä¸­å®šä¹‰åä¸ºdbdataçš„å·ï¼Œä»¥ä¿ç•™MySQLæ•°æ®åº“ï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">...<font></font>
#MySQL Service<font></font>
db:<font></font>
  ...<font></font>
    volumes:<font></font>
      - dbdata:/var/lib/mysql<font></font>
    networks:<font></font>
      - app-network<font></font>
  ...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åä¸ºdbdataçš„å·ç”¨äºå°†/ var / lib / mysqlæ–‡ä»¶å¤¹çš„å†…å®¹æ°¸ä¹…ä¿å­˜åœ¨å®¹å™¨å†…ã€‚</font><font style="vertical-align: inherit;">è¿™ä½¿æ‚¨å¯ä»¥åœæ­¢å¹¶é‡æ–°å¯åŠ¨æ•°æ®åº“æœåŠ¡ï¼Œè€Œä¸ä¼šä¸¢å¤±æ•°æ®ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ dbdataå·å®šä¹‰ï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">...<font></font>
#Volumes<font></font>
volumes:<font></font>
  dbdata:<font></font>
    driver: local</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨æ­¤å®šä¹‰ï¼Œæ‚¨å¯ä»¥å°†æ­¤å·ç”¨äºä¸åŒçš„æœåŠ¡ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åå°†å®‰è£…æ˜ åƒç»‘å®šæ·»åŠ åˆ°MySQLé…ç½®æ–‡ä»¶çš„dbæœåŠ¡ï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">...<font></font>
#MySQL Service<font></font>
db:<font></font>
  ...<font></font>
    volumes:<font></font>
      - dbdata:/var/lib/mysql<font></font>
      - ./mysql/my.cnf:/etc/mysql/my.cnf<font></font>
  ...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥æŒ‚è½½çš„æ˜ åƒå°†ã€œ/ laravel-app / mysql / my.cnfæ–‡ä»¶ç»‘å®šåˆ°å®¹å™¨ä¸­çš„/etc/mysql/my.cnfç›®å½•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åå°†å®‰è£…çš„æ˜ åƒæ·»åŠ åˆ°WebæœåŠ¡å™¨æœåŠ¡ã€‚</font><font style="vertical-align: inherit;">å°†æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªç”¨äºåº”ç”¨ç¨‹åºä»£ç ï¼Œå¦ä¸€ä¸ªç”¨äºç¡®å®šNginxé…ç½®</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">#Nginx Service<font></font>
webserver:<font></font>
  ...<font></font>
  volumes:<font></font>
      - ./:/var/www<font></font>
      - ./nginx/conf.d/:/etc/nginx/conf.d/<font></font>
  networks:<font></font>
      - app-network</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¬¬ä¸€ä¸ªå®‰è£…çš„æ˜ åƒå°†ã€œ/ laravel-appç›®å½•ä¸­çš„åº”ç”¨ç¨‹åºä»£ç ç»‘å®šåˆ°å®¹å™¨å†…çš„/ var / wwwç›®å½•ã€‚æ·»åŠ åˆ°ã€œ/ laravel-app / nginx / conf.d /ä¸­çš„é…ç½®æ–‡ä»¶ä¹Ÿå®‰è£…åœ¨å®¹å™¨ä¸­çš„/etc/nginx/conf.d/ä¸­ï¼Œè¯¥æ–‡ä»¶å…è®¸æ‚¨æ ¹æ®éœ€è¦æ·»åŠ å’Œæ›´æ”¹é…ç½®ç›®å½•çš„å†…å®¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ€»ä¹‹ï¼Œå°†ä»¥ä¸‹å·²å®‰è£…çš„æ˜ åƒå®‰è£…æ·»åŠ åˆ°åº”ç”¨ç¨‹åºæœåŠ¡ä¸­çš„åº”ç”¨ç¨‹åºä»£ç å’Œé…ç½®æ–‡ä»¶ï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="xml hljs">#PHP Service<font></font>
app:<font></font>
  ...<font></font>
  volumes:<font></font>
       - ./:/var/www<font></font>
       - ./php/local.ini:/usr/local/etc/php/conf.d/local.ini<font></font>
  networks:<font></font>
      - app-network<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åº”ç”¨ç¨‹åºæœåŠ¡å°†åŒ…å«åº”ç”¨ç¨‹åºä»£ç çš„ã€œ/ laravel-appæ–‡ä»¶å¤¹çš„å®‰è£…æ˜ åƒç»‘å®šåˆ°/ var / wwwæ–‡ä»¶å¤¹ã€‚è¿™å°†åŠ é€Ÿå¼€å‘è¿‡ç¨‹ï¼Œå› ä¸ºæœ¬åœ°åº”ç”¨ç¨‹åºç›®å½•ä¸­çš„ä»»ä½•æ›´æ”¹éƒ½å°†ç«‹å³åæ˜ åœ¨å®¹å™¨ä¸­ã€‚æ‚¨è¿˜å¯ä»¥å°†PHPé…ç½®æ–‡ä»¶ã€œ/ laravel-app / php / local.inié“¾æ¥åˆ°å®¹å™¨ä¸­çš„/usr/local/etc/php/conf.d/local.iniæ–‡ä»¶ã€‚ç¨åï¼Œæ‚¨å°†åˆ›å»ºæœ¬åœ°PHPé…ç½®æ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨çš„docker-composeæ–‡ä»¶ç°åœ¨å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</font></font><br>
<br>
<code>~/laravel-app/docker-compose.yml</code><br>
<br>
<pre><code class="bash hljs">version: <span class="hljs-string">'3'</span><font></font>
services:<font></font>
<font></font>
  <span class="hljs-comment">#PHP Service</span><font></font>
  app:<font></font>
    build:<font></font>
      context: .<font></font>
      dockerfile: Dockerfile<font></font>
    image: digitalocean.com/php<font></font>
    container_name: app<font></font>
    restart: unless-stopped<font></font>
    tty: <span class="hljs-literal">true</span><font></font>
    environment:<font></font>
      SERVICE_NAME: app<font></font>
      SERVICE_TAGS: dev<font></font>
    working_dir: /var/www<font></font>
    volumes:<font></font>
      - ./:/var/www<font></font>
      - ./php/local.ini:/usr/<span class="hljs-built_in">local</span>/etc/php/conf.d/local.ini<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
  <span class="hljs-comment">#Nginx Service</span><font></font>
  webserver:<font></font>
    image: nginx:alpine<font></font>
    container_name: webserver<font></font>
    restart: unless-stopped<font></font>
    tty: <span class="hljs-literal">true</span><font></font>
    ports:<font></font>
      - <span class="hljs-string">"80:80"</span>
      - <span class="hljs-string">"443:443"</span><font></font>
    volumes:<font></font>
      - ./:/var/www<font></font>
      - ./nginx/conf.d/:/etc/nginx/conf.d/<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
  <span class="hljs-comment">#MySQL Service</span><font></font>
  db:<font></font>
    image: mysql:5.7.22<font></font>
    container_name: db<font></font>
    restart: unless-stopped<font></font>
    tty: <span class="hljs-literal">true</span><font></font>
    ports:<font></font>
      - <span class="hljs-string">"3306:3306"</span><font></font>
    environment:<font></font>
      MYSQL_DATABASE: laravel<font></font>
      MYSQL_ROOT_PASSWORD: your_mysql_root_password<font></font>
      SERVICE_TAGS: dev<font></font>
      SERVICE_NAME: mysql<font></font>
    volumes:<font></font>
      - dbdata:/var/lib/mysql/<font></font>
      - ./mysql/my.cnf:/etc/mysql/my.cnf<font></font>
    networks:<font></font>
      - app-network<font></font>
<font></font>
<span class="hljs-comment">#Docker Networks</span><font></font>
networks:<font></font>
  app-network:<font></font>
    driver: bridge<font></font>
<span class="hljs-comment">#Volumes</span><font></font>
volumes:<font></font>
  dbdata:<font></font>
    driver: <span class="hljs-built_in">local</span></code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºDockerfile</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Dockerå…è®¸æ‚¨ä½¿ç”¨Dockerfileåœ¨å•ä¸ªå®¹å™¨å†…å®šä¹‰ç¯å¢ƒã€‚</font><font style="vertical-align: inherit;">Dockerfileå…è®¸æ‚¨åˆ›å»ºä¸ªæ€§åŒ–æ˜ åƒã€‚</font><font style="vertical-align: inherit;">å¯ä»¥ç”¨æ¥å®‰è£…æ‰€éœ€çš„åº”ç”¨ç¨‹åºè½¯ä»¶å¹¶æ ¹æ®éœ€è¦æ›´æ”¹è®¾ç½®ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥å°†åˆ›å»ºçš„æ˜ åƒä¼ è¾“åˆ°Docker Hubæˆ–ä»»ä½•ç§æœ‰æ³¨å†Œè¡¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dockerfileå°†ä½äºã€œ/ laravel-appç›®å½•ä¸­ã€‚</font><font style="vertical-align: inherit;">åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/laravel-app/Dockerfile</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥Dockerfileå°†æŒ‡å®šåŸºæœ¬æ˜ åƒä»¥åŠæ„å»ºLaravelåº”ç”¨ç¨‹åºæ˜ åƒæ‰€éœ€çš„å‘½ä»¤å’Œè¯´æ˜ã€‚</font><font style="vertical-align: inherit;">å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼š</font></font><br>
<br>
<code>~/laravel-app/php/Dockerfile</code><br>
<br>
<pre><code class="xml hljs">FROM php:7.2-fpm<font></font>
<font></font>
# Copy composer.lock and composer.json<font></font>
COPY composer.lock composer.json /var/www/<font></font>
<font></font>
# Set working directory<font></font>
WORKDIR /var/www<font></font>
<font></font>
# Install dependencies<font></font>
RUN apt-get update &amp;&amp; apt-get install -y \<font></font>
    build-essential \<font></font>
    mysql-client \<font></font>
    libpng-dev \<font></font>
    libjpeg62-turbo-dev \<font></font>
    libfreetype6-dev \<font></font>
    locales \<font></font>
    zip \<font></font>
    jpegoptim optipng pngquant gifsicle \<font></font>
    vim \<font></font>
    unzip \<font></font>
    git \<font></font>
    curl<font></font>
<font></font>
# Clear cache<font></font>
RUN apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/*<font></font>
<font></font>
# Install extensions<font></font>
RUN docker-php-ext-install pdo_mysql mbstring zip exif pcntl<font></font>
RUN docker-php-ext-configure gd --with-gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-png-dir=/usr/include/<font></font>
RUN docker-php-ext-install gd<font></font>
<font></font>
# Install composer<font></font>
RUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer<font></font>
<font></font>
# Add user for laravel application<font></font>
RUN groupadd -g 1000 www<font></font>
RUN useradd -u 1000 -ms /bin/bash -g www www<font></font>
<font></font>
# Copy existing application directory contents<font></font>
COPY . /var/www<font></font>
<font></font>
# Copy existing application directory permissions<font></font>
COPY --chown=www:www . /var/www<font></font>
<font></font>
# Change current user to www<font></font>
USER www<font></font>
<font></font>
# Expose port 9000 and start php-fpm server<font></font>
EXPOSE 9000<font></font>
CMD ["php-fpm"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼ŒDockerfileåœ¨phpä¹‹ä¸Šåˆ›å»ºæ˜ åƒï¼š7.2-fpm Dockeræ˜ åƒã€‚è¿™æ˜¯åŸºäºå·²å®‰è£…çš„PHP FastCGI PHP-FPMå®ä¾‹çš„æ˜ åƒã€‚è¯¥æ–‡ä»¶è¿˜ä¼šå®‰è£…Laravelæ‰€éœ€çš„è½¯ä»¶åŒ…ï¼šå¸¦æœ‰composerçš„mcryptï¼Œpdo_mysqlï¼Œmbstringå’Œimagickã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RUNæŒ‡ä»¤æŒ‡å®šç”¨äºæ›´æ–°ï¼Œå®‰è£…å’Œé…ç½®å®¹å™¨å†…éƒ¨å‚æ•°çš„å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤åŒ…æ‹¬ä¸“ç”¨ç”¨æˆ·å’Œåä¸ºwwwçš„ç»„ã€‚ WORKDIRè¯­å¥å°†ç›®å½•/ var / wwwè®¾ç½®ä¸ºåº”ç”¨ç¨‹åºçš„å·¥ä½œç›®å½•ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºå…·æœ‰å—é™è®¿é—®æƒé™çš„å•ç‹¬ç”¨æˆ·å’Œç»„å¯å‡å°‘å¯åŠ¨Dockerå®¹å™¨æ—¶çš„æ¼æ´ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥å®¹å™¨ä»¥rootç‰¹æƒè¿è¡Œã€‚æˆ‘ä»¬æ²¡æœ‰ä»¥rootç”¨æˆ·æƒé™è¿è¡Œæ­¤å®¹å™¨ï¼Œè€Œæ˜¯ä½¿ç”¨å¸¦æœ‰--chownæ ‡å¿—çš„COPYå‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªå¯¹/ var / wwwæ–‡ä»¶å¤¹å…·æœ‰è¯»å†™æƒé™çš„wwwç”¨æˆ·ï¼Œä»¥å¤åˆ¶åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹çš„æƒé™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EXPOSEå‘½ä»¤åœ¨php-fpmæœåŠ¡å™¨çš„å®¹å™¨ä¸­æ‰“å¼€ç«¯å£9000ã€‚ CMDæŒ‡ç¤ºåœ¨åˆ›å»ºå®¹å™¨ååº”è¿è¡Œçš„å‘½ä»¤ã€‚åœ¨æ­¤ï¼ŒCMDè¡¨ç¤ºå¯åŠ¨æœåŠ¡å™¨çš„php-fpmå‘½ä»¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Œæˆæ›´æ”¹åï¼Œä¿å­˜æ–‡ä»¶å¹¶å…³é—­ç¼–è¾‘å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥ç»§ç»­å®šä¹‰PHPé…ç½®ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PHPè®¾ç½®</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å·²ç»åœ¨docker-composeæ–‡ä»¶ä¸­å®šä¹‰äº†åŸºç¡€æ¶æ„ï¼Œç°åœ¨æ‚¨å¯ä»¥å°†PHPæœåŠ¡é…ç½®ä¸ºå……å½“ä¼ å…¥Nginxè¯·æ±‚çš„PHPå¤„ç†å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦é…ç½®PHPï¼Œæ‚¨å°†åœ¨phpæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªlocal.iniæ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ‚¨é“¾æ¥åˆ°ä¸Šé¢å®¹å™¨ä¸­çš„/usr/local/etc/php/conf.d/local.iniæ–‡ä»¶çš„æ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">åˆ›å»ºæ­¤æ–‡ä»¶å°†ä½¿æ‚¨å¯ä»¥å¿½ç•¥PHPåœ¨å¯åŠ¨æ—¶è¯»å–çš„é»˜è®¤php.iniæ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºä¸€ä¸ªphpç›®å½•ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">mkdir ~/laravel-app/php</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åæ‰“å¼€local.iniæ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/laravel-app/php/local.ini</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¼”ç¤ºPHPçš„è®¾ç½®ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä»¥ä¸‹ä»£ç æ¥è®¾ç½®æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼š</font></font><br>
<br>
<code>~/laravel-app/php/local.ini</code><br>
<br>
<pre><code class="xml hljs">upload_max_filesize=40M<font></font>
post_max_size=40M</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
upload_max_filesizeå’Œpost_max_sizeæŒ‡ä»¤è®¾ç½®äº†ä¸Šè½½æ–‡ä»¶çš„æœ€å¤§å…è®¸å¤§å°ï¼Œå¹¶æ˜¾ç¤ºäº†å¦‚ä½•ä»local.iniæ–‡ä»¶è®¾ç½®php.inié…ç½®ã€‚æ‚¨å¯ä»¥åœ¨local.iniæ–‡ä»¶ä¸­æ’å…¥è¦å¿½ç•¥çš„ä»»ä½•PHPé…ç½®å‚æ•°ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é…ç½®Nginx</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
é…ç½®PHPæœåŠ¡æ—¶ï¼Œå¯ä»¥ä¿®æ”¹NginxæœåŠ¡ä»¥å°†PHP-FPMç”¨ä½œFastCGIæœåŠ¡å™¨æ¥æä¾›åŠ¨æ€å†…å®¹ã€‚ FastCGIæœåŠ¡å™¨åŸºäºäºŒè¿›åˆ¶åè®®ï¼Œç”¨äºäº¤äº’ç¨‹åºä¸WebæœåŠ¡å™¨çš„äº¤äº’ã€‚åœ¨æ–‡ç« â€œåœ¨Nginxä¸­ç†è§£å’Œå®ç°FastCGIä»£ç†â€ä¸­å¯ä»¥æ‰¾åˆ°æ›´å¤šä¿¡æ¯ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦é…ç½®Nginxï¼Œæ‚¨å°†ä½¿ç”¨ã€œ/ laravel-app / nginx / conf.d /æ–‡ä»¶å¤¹ä¸­çš„æœåŠ¡é…ç½®åˆ›å»ºä¸€ä¸ªapp.confæ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆåˆ›å»ºnginx / conf.d /ç›®å½•ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p ~/laravel-app/nginx/conf.d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶ååˆ›å»ºapp.confé…ç½®æ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/laravel-app/nginx/conf.d/app.conf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­ä»¥é…ç½®Nginxï¼š</font></font><br>
<br>
<code>~/laravel-app/nginx/conf.d/app.conf</code><br>
<br>
<pre><code class="xml hljs">server {<font></font>
    listen 80;<font></font>
    index index.php index.html;<font></font>
    error_log  /var/log/nginx/error.log;<font></font>
    access_log /var/log/nginx/access.log;<font></font>
    root /var/www/public;<font></font>
    location ~ \.php$ {<font></font>
        try_files $uri =404;<font></font>
        fastcgi_split_path_info ^(.+\.php)(/.+)$;<font></font>
        fastcgi_pass app:9000;<font></font>
        fastcgi_index index.php;<font></font>
        include fastcgi_params;<font></font>
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;<font></font>
        fastcgi_param PATH_INFO $fastcgi_path_info;<font></font>
    }<font></font>
    location / {<font></font>
        try_files $uri $uri/ /index.php?$query_string;<font></font>
        gzip_static on;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœåŠ¡å™¨å—ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤é…ç½®Nginx WebæœåŠ¡å™¨ï¼š</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">listenï¼šæ­¤ä¼ªæŒ‡ä»¤å®šä¹‰æœåŠ¡å™¨ä¾¦å¬ä¼ å…¥è¯·æ±‚çš„ç«¯å£ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error_logå’Œaccess_logï¼šè¿™äº›æŒ‡ä»¤å®šä¹‰ç”¨äºè®°å½•çš„æ–‡ä»¶ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rootï¼šæ­¤ä¼ªæŒ‡ä»¤å°†è·¯å¾„è®¾ç½®ä¸ºæ ¹æ–‡ä»¶å¤¹ï¼Œä»è€Œå½¢æˆæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ä»»ä½•è¯·æ±‚çš„æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨php locationå—ä¸­ï¼Œfastcgi_passæŒ‡ä»¤æŒ‡ç¤ºè¯¥åº”ç”¨æœåŠ¡æ­£åœ¨ä¾¦å¬ç«¯å£9000ä¸Šçš„TCPå¥—æ¥å­—ã€‚ä½¿ç”¨å®ƒï¼ŒPHP-FPMæœåŠ¡å™¨å°†åœ¨ç½‘ç»œä¸Šä¾¦å¬ï¼Œè€Œä¸æ˜¯åœ¨Unixå¥—æ¥å­—ä¸Šä¾¦å¬ã€‚å°½ç®¡Unixå¥—æ¥å­—æ¯”TCPå¥—æ¥å­—åœ¨é€Ÿåº¦ä¸Šæœ‰ä¸€ç‚¹ä¼˜åŠ¿ï¼Œä½†å®ƒæ²¡æœ‰ç½‘ç»œåè®®ï¼Œå¹¶ä¸”ä¼šè·³è¿‡ç½‘ç»œå †æ ˆã€‚å¦‚æœä¸»æœºä½äºåŒä¸€ç³»ç»Ÿä¸Šï¼Œåˆ™å¯ä»¥ä½¿ç”¨Unixå¥—æ¥å­—ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡åœ¨ä¸åŒçš„ä¸»æœºä¸Šè¿è¡Œï¼Œâ€‹â€‹åˆ™TCPå¥—æ¥å­—é€šè¿‡å…è®¸æ‚¨è¿æ¥åˆ°åˆ†å¸ƒå¼æœåŠ¡è€Œå…·æœ‰ä¼˜åŠ¿ã€‚ç”±äºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå’ŒWebæœåŠ¡å™¨å®¹å™¨åœ¨ä¸åŒçš„ä¸»æœºä¸Šè¿è¡Œï¼Œâ€‹â€‹å› æ­¤åœ¨æˆ‘ä»¬çš„é…ç½®ä¸­ä½¿ç”¨TCPå¥—æ¥å­—æ•ˆç‡æ›´é«˜ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Œæˆæ›´æ”¹åï¼Œä¿å­˜æ–‡ä»¶å¹¶å…³é—­ç¼–è¾‘å™¨ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç”±äºå…ˆå‰åˆ›å»ºçš„ç»‘å®šï¼Œnginx / conf.d /æ–‡ä»¶å¤¹ä¸­çš„ä»»ä½•æ›´æ”¹éƒ½ç›´æ¥åæ˜ åœ¨webserverå®¹å™¨ä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹MySQLå‚æ•°ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¾ç½®MySQL</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
è®¾ç½®PHPå’ŒNginxä¹‹åï¼Œæ‚¨å¯ä»¥å°†MySQLæ¿€æ´»ä¸ºåº”ç”¨ç¨‹åºçš„æ•°æ®åº“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦é…ç½®MySQLï¼Œæ‚¨éœ€è¦åœ¨mysqlæ–‡ä»¶å¤¹ä¸­åˆ›å»ºmy.cnfæ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯æ‚¨åœ¨æ•°æ®åº“é…ç½®æ­¥éª¤ä¸­é™„åŠ åˆ°å®¹å™¨å†…çš„/etc/mysql/my.cnfæ–‡ä»¶çš„æ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">å¦‚æœéœ€è¦ï¼Œåœ¨éœ€è¦æ—¶ï¼Œé€šè¿‡æŒ‚è½½æŒ‚è½½çš„æ˜ åƒï¼Œæ‚¨å¯ä»¥å¿½ç•¥ä»»ä½•my.cnfé€‰é¡¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ¼”ç¤ºå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å°†åœ¨my.cnfä¸­æ·»åŠ åŒ…æ‹¬å¸¸è§„è¯·æ±‚æ—¥å¿—çš„è®¾ç½®å¹¶è®¾ç½®æ—¥å¿—æ–‡ä»¶ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºä¸€ä¸ªmysqlç›®å½•ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">mkdir ~/laravel-app/mysql</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºmy.cnfæ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">nano ~/laravel-app/mysql/my.cnf</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­ä»¥æ¿€æ´»æŸ¥è¯¢æ—¥å¿—å¹¶è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„ä½ç½®ï¼š</font></font><br>
<br>
<code>~/laravel-app/mysql/my.cnf</code><br>
<br>
<pre><code class="xml hljs">[mysqld]<font></font>
general_log = 1<font></font>
general_log_file = /var/lib/mysql/general.log</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
my.cnfæ–‡ä»¶é€šè¿‡å°†general_logå‚æ•°è®¾ç½®ä¸º1ï¼ˆå¯ç”¨å¸¸è§„æ—¥å¿—ï¼‰æ¥æ”¯æŒæ—¥å¿—ã€‚</font><font style="vertical-align: inherit;">general_log_fileå‚æ•°æŒ‡å®šæ—¥å¿—çš„å­˜å‚¨ä½ç½®ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯åŠ¨å®¹å™¨å¹¶æ›´æ”¹ç¯å¢ƒè®¾ç½®</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
æ‚¨å·²åœ¨docker-composeæ–‡ä»¶ä¸­å®šä¹‰äº†æ‰€æœ‰æœåŠ¡ï¼Œå¹¶ä¸ºè¿™äº›æœåŠ¡åˆ›å»ºäº†é…ç½®æ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨æ‚¨å¯ä»¥è¿è¡Œå®¹å™¨ã€‚</font><font style="vertical-align: inherit;">æ€»ä¹‹ï¼Œæˆ‘ä»¬å°†åˆ›å»ºLaravelé»˜è®¤åŒ…å«çš„.env.exampleæ–‡ä»¶çš„å‰¯æœ¬ï¼Œå¹¶å°†å…¶å‘½åä¸º.envï¼Œå› ä¸ºLaravelä½¿ç”¨æ­¤ç±»æ–‡ä»¶æ¥ç¡®å®šç¯å¢ƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs">cp .env.example .env</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯åŠ¨å®¹å™¨åï¼Œæˆ‘ä»¬å°†åœ¨æ­¤æ–‡ä»¶ä¸­é…ç½®ç‰¹å®šçš„å®‰è£…å‚æ•°ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‰€æœ‰æœåŠ¡éƒ½åœ¨docker-composeæ–‡ä»¶ä¸­å®šä¹‰ï¼Œæ‚¨åªéœ€è¦è¿è¡Œä¸€ä¸ªå‘½ä»¤å³å¯å¯åŠ¨æ‰€æœ‰å®¹å™¨ï¼Œåˆ›å»ºå·ä»¥åŠé…ç½®å’Œè¿æ¥ç½‘ç»œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose up -d</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–æ¬¡å¯åŠ¨docker-compose upæ—¶ï¼Œå°†ä¸‹è½½æ‰€æœ‰å¿…è¦çš„Dockeræ˜ åƒï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚</font><font style="vertical-align: inherit;">ä¸‹è½½å›¾åƒå¹¶å°†å…¶ä¿å­˜åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šä¹‹åï¼ŒComposeå°†åˆ›å»ºæ‚¨çš„å®¹å™¨ã€‚</font><font style="vertical-align: inherit;">-dæ ‡å¿—å°†è¿›ç¨‹è½¬æ¢ä¸ºå®ˆæŠ¤ç¨‹åºï¼Œå®¹å™¨å°†ç»§ç»­åœ¨åå°è¿è¡Œã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥è¿‡ç¨‹å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š</font></font><br>
<pre><code class="bash hljs">docker ps</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å°†åœ¨åº”ç”¨ç¨‹åºï¼ŒWebæœåŠ¡å™¨å’Œæ•°æ®åº“å®¹å™¨ä¸Šçœ‹åˆ°ä»¥ä¸‹ç»“æœä»¥åŠæ•°æ®ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">Output<font></font>
CONTAINER ID        NAMES               IMAGE                             STATUS              PORTS<font></font>
c31b7b3251e0        db                  mysql:5.7.22                      Up 2 seconds        0.0.0.0:3306-&gt;3306/tcp<font></font>
ed5a69704580        app                 digitalocean.com/php              Up 2 seconds        9000/tcp<font></font>
5ce4ee31d7c0        webserver           nginx:alpine                      Up 2 seconds        0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™äº›ç»“æœä¸­ï¼ŒCONTAINER IDæ˜¯æ¯ä¸ªå®¹å™¨çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”NAMESåˆ—å‡ºäº†æ¯ä¸ªå®¹å™¨çš„æœåŠ¡åç§°ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ ‡è¯†ç¬¦æ¥è®¿é—®å®¹å™¨ã€‚</font><font style="vertical-align: inherit;">IMAGEå®šä¹‰æ¯ä¸ªå®¹å™¨çš„æ˜ åƒåç§°ï¼ŒSTATUSæä¾›æœ‰å…³å®¹å™¨çŠ¶æ€çš„ä¿¡æ¯ï¼šå¯åŠ¨ï¼Œé‡æ–°å¯åŠ¨æˆ–åœæ­¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹åº”ç”¨å®¹å™¨ä¸­çš„.envæ–‡ä»¶ï¼Œä»¥å°†ç‰¹å®šå‚æ•°æ·»åŠ åˆ°ç³»ç»Ÿä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½¿ç”¨docker-compose execæ‰“å¼€æ–‡ä»¶ï¼Œè¿™ä½¿æ‚¨å¯ä»¥åœ¨å®¹å™¨ä¸­è¿è¡Œç‰¹å®šå‘½ä»¤ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥æ‰“å¼€æ–‡ä»¶è¿›è¡Œç¼–è¾‘ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose <span class="hljs-built_in">exec</span> app nano .env</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‰¾åˆ°æŒ‡å®šDB_CONNECTIONçš„å—å¹¶è¿›è¡Œæ›´æ–°ä»¥åæ˜ æ‚¨çš„ç³»ç»Ÿè®¾ç½®ã€‚</font><font style="vertical-align: inherit;">æ‚¨å°†æ›´æ”¹ä»¥ä¸‹å­—æ®µï¼š</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB_HOSTå°†æ˜¯æ‚¨çš„æ•°æ®åº“æ•°æ®åº“å®¹å™¨ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB_DATABASEå°†æ˜¯laravelæ•°æ®åº“ã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB_USERNAMEå°†æ˜¯æ‚¨çš„æ•°æ®åº“çš„ç”¨æˆ·åã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨laraveluserã€‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DB_PASSWORDå°†æ˜¯ä¸ºæ­¤ç”¨æˆ·å¸æˆ·ä¿æŠ¤çš„å¯†ç ã€‚</font></font></li>
</ol><br>
<code>/var/www/.env</code><br>
<br>
<pre><code class="xml hljs">DB_CONNECTION=mysql<font></font>
DB_HOST=db<font></font>
DB_PORT=3306<font></font>
DB_DATABASE=laravel<font></font>
DB_USERNAME=laraveluser<font></font>
DB_PASSWORD=your_laravel_db_password</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿˜éœ€è¦æ›´æ­£.env.exampleæ–‡ä»¶ä¸­çš„ç›¸åŒå˜é‡ï¼Œå› ä¸ºç¨åå°†åœ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨æ—¶ä½¿ç”¨å®ƒã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åä½¿ç”¨php artisané”®ä¸ºLaravelé…ç½®åº”ç”¨ç¨‹åºé”®ï¼šgenerateå‘½ä»¤ã€‚</font><font style="vertical-align: inherit;">æ­¤å‘½ä»¤å°†ç”Ÿæˆä¸€ä¸ªå¯†é’¥å¹¶å°†å…¶å¤åˆ¶åˆ°.envæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°†ä¿æŠ¤ç”¨æˆ·ä¼šè¯å’ŒåŠ å¯†çš„æ•°æ®ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose <span class="hljs-built_in">exec</span> app php artisan key:generate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å…·æœ‰è¿è¡Œè¯¥åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å¿…è¦ç¯å¢ƒè®¾ç½®ã€‚</font><font style="vertical-align: inherit;">è¦å°†è¿™äº›è®¾ç½®ç¼“å­˜åœ¨å¯ä»¥åŠ å¿«åº”ç”¨ç¨‹åºåŠ è½½é€Ÿåº¦çš„æ–‡ä»¶ä¸­ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose <span class="hljs-built_in">exec</span> app php artisan config:cache</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é…ç½®è®¾ç½®å°†è¢«åŠ è½½åˆ°å®¹å™¨ä¸­çš„/var/www/bootstrap/cache/config.phpæ–‡ä»¶ä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœ€åï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç«™ç‚¹</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">Laravelåº”ç”¨ç¨‹åºçš„ä¸»é¡µæ‰“å¼€ã€‚</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºMySQLç”¨æˆ·</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
å®‰è£…MySQLæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»…åˆ›å»ºä¸€ä¸ªå…·æœ‰æ— é™ç‰¹æƒçš„ç®¡ç†æ ¹å¸æˆ·æ¥è®¿é—®æ•°æ®åº“æœåŠ¡å™¨ã€‚</font><font style="vertical-align: inherit;">é€šå¸¸ï¼Œåœ¨ä½¿ç”¨æ•°æ®åº“æ—¶ï¼Œæœ€å¥½é¿å…ä½¿ç”¨ç®¡ç†æ ¹å¸æˆ·ã€‚</font><font style="vertical-align: inherit;">ç›¸åï¼Œæˆ‘ä»¬å°†ä¸ºåº”ç”¨ç¨‹åºçš„Laravelæ•°æ®åº“åˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®åº“ç”¨æˆ·ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦åˆ›å»ºæ–°ç”¨æˆ·ï¼Œè¯·ä½¿ç”¨docker-compose execå‘½ä»¤åœ¨dbå®¹å™¨ä¸­å¯åŠ¨bashäº¤äº’å¼shellï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose <span class="hljs-built_in">exec</span> db bash</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨å®¹å™¨å†…ï¼Œç™»å½•åˆ°MySQLæ ¹ç®¡ç†å¸æˆ·ï¼š</font></font><br>
<br>
<pre><code class="sql hljs">mysql -u root -p</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®‰è£…åœ¨docker-composeæ–‡ä»¶ä¸­æ—¶ï¼Œç³»ç»Ÿå°†æç¤ºæ‚¨è¾“å…¥ä¸ºMySQLæ ¹å¸æˆ·æŒ‡å®šçš„å¯†ç ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¦–å…ˆï¼Œæ£€æŸ¥docker-composeæ–‡ä»¶ä¸­å®šä¹‰çš„laravelæ•°æ®åº“ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œshow databaseå‘½ä»¤ä»¥éªŒè¯ç°æœ‰æ•°æ®åº“ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">show</span> <span class="hljs-keyword">databases</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç»“æœä¸­ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°laravelæ•°æ®åº“ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">Output<font></font>
+--------------------+<font></font>
| Database           |<font></font>
+--------------------+<font></font>
| information_schema |<font></font>
| laravel            |<font></font>
| mysql              |<font></font>
| performance_schema |<font></font>
| sys                |<font></font>
+--------------------+<font></font>
5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶ååˆ›å»ºä¸€ä¸ªå°†è¢«å…è®¸è®¿é—®è¯¥æ•°æ®åº“çš„ç”¨æˆ·å¸æˆ·ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ä½¿ç”¨laraveluserç”¨æˆ·åï¼Œä½†æ‚¨å¯ä»¥å°†å…¶æ›¿æ¢ä¸ºä»»ä½•é¦–é€‰åç§°ã€‚</font><font style="vertical-align: inherit;">åªè¦ç¡®ä¿ç”¨æˆ·åå’Œå¯†ç ä¸ä¸Šä¸€æ­¥ä¸­çš„.envæ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç åŒ¹é…å³å¯ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">ON</span> laravel.* <span class="hljs-keyword">TO</span> <span class="hljs-string">'laraveluser'</span>@<span class="hljs-string">'%'</span> <span class="hljs-keyword">IDENTIFIED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">'your_laravel_db_password'</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ–°ç‰¹æƒä»¥é€šçŸ¥MySQLæœåŠ¡å™¨æ›´æ”¹ï¼š</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">FLUSH</span> <span class="hljs-keyword">PRIVILEGES</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…³é—­MySQLï¼š</font></font><br>
<br>
<pre><code class="sql hljs">EXIT;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€€å‡ºå®¹å™¨ï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">exit</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥è¿›è¡Œè¿ç§»ä»¥æµ‹è¯•æ•°æ®åº“ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker-compose <span class="hljs-built_in">exec</span> app php artisan migrate</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿ç§»ç¡®è®¤çš„ç»“æœå¦‚ä¸‹ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">Output<font></font>
<font></font>
Migration table created successfully.<font></font>
Migrating: 2014_10_12_000000_create_users_table<font></font>
Migrated:  2014_10_12_000000_create_users_table<font></font>
Migrating: 2014_10_12_100000_create_password_resets_table<font></font>
Migrated:  2014_10_12_100000_create_password_resets_table</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬2éƒ¨åˆ†ã€‚Gitlab</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨Hitlabä¸­ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬éœ€è¦å°†é¡¹ç›®ä¿å­˜åœ¨hitlabå­˜å‚¨åº“ä¸­ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œè¯·ä»æœ¬åœ°è®¡ç®—æœºä¸Šçš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­è°ƒç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">git init<font></font>
git remote add origin git@gitlab.com:&lt;&gt;/&lt;&gt;  <font></font>
git remote add origin https://gitlab.com/&lt;&gt;/&lt;&gt;      SSH<font></font>
git add .<font></font>
git commit -m <span class="hljs-string">"Initial commit"</span>
git push -u origin master</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥é¡¹ç›®åº”è¯¥å‡ºç°åœ¨â€œé¡¹ç›®æ¦‚è¿°-&gt;è¯¦ç»†ä¿¡æ¯â€ä¸­ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†æ–¹ä¾¿ç«‹å³è·å¾—å®Œæˆçš„ç¯å¢ƒï¼Œæˆ‘ä»¬å°†ç¯å¢ƒçš„dockeræ˜ åƒä¿å­˜åœ¨å‘½ä¸­åˆ—è¡¨æ³¨å†Œè¡¨ä¸­ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºæ­¤ï¼Œæ‚¨å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker login registry.gitlab.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¹¶å°†å›¾åƒæ‰”åˆ°gitlabä¸Šï¼š</font></font><br>
<br>
<pre><code class="bash hljs">docker build -t registry.gitlab.com/&lt;&gt;/&lt;&gt; .<font></font>
docker push registry.gitlab.com/&lt;&gt;/&lt;&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¯¥å›¾åƒä½äºPackages-&gt; Container Registryã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å®Œæˆgitlabï¼Œæˆ‘ä»¬ç«‹å³è·å¾—gitlab-runnerçš„å¯†é’¥ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œè¯·è½¬è‡³è®¾ç½®-&gt; CI / CD-&gt;è¿è¡Œå™¨ã€‚</font><font style="vertical-align: inherit;">å¯†é’¥ä½äºâ€œæ‰‹åŠ¨é…ç½®â€éƒ¨åˆ†ï¼ˆæ‰‹åŠ¨è®¾ç½®ç‰¹å®šçš„è¿è¡Œå™¨ï¼‰çš„ç¬¬3æ­¥ä¸­ã€‚</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬3éƒ¨åˆ†ã€‚æœåŠ¡å™¨é…ç½®</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VPSæœåŠ¡å™¨å¿…é¡»é‡‡ç”¨è™šæ‹ŸåŒ–ç±»å‹KVMæˆ–XENã€‚</font><font style="vertical-align: inherit;">åƒOpenVZè¿™æ ·çš„è™šæ‹ŸåŒ–åœ¨æ‰€æœ‰ç”¨æˆ·ä¹‹é—´å…±äº«ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå› æ­¤å®ƒæ— æ³•æ›´æ”¹å†…æ ¸å‚æ•°ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘é€‰æ‹©äº†é¢„å…ˆå®‰è£…äº†Dockerçš„KVMæœåŠ¡å™¨ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼ŒæœåŠ¡å™¨ä¸Šå¯èƒ½æ²¡æœ‰æ³Šåçª—ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¿…é¡»æ‰‹åŠ¨å®‰è£…å®ƒã€‚</font><font style="vertical-align: inherit;">è¯¥ç®—æ³•ä¸åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå®‰è£…æ—¶çš„ç®—æ³•ç›¸åŒã€‚</font><font style="vertical-align: inherit;">è¿˜éœ€è¦æ£€æŸ¥phpç‰ˆæœ¬ã€‚</font><font style="vertical-align: inherit;">å¯¹äºLaravelï¼Œæ‚¨è‡³å°‘éœ€è¦7.2ã€‚</font><font style="vertical-align: inherit;">æˆ‘è¿˜å¿…é¡»å•ç‹¬å®‰è£…php ext-mbstringçš„æ‰©å±•åï¼ˆä»¥æˆ‘çš„php 7.3ä¸ºä¾‹ï¼‰ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo apt-get update<font></font>
sudo apt-get install php7.3-mbstring<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…gitlab-runnerã€‚</font><font style="vertical-align: inherit;">Runneræ˜¯ä¸€é¡¹æœåŠ¡ï¼Œå½“æ¥æ”¶åˆ°æ–°ç‰ˆæœ¬æ—¶ï¼Œå®ƒå°†æ¥å—æ¥è‡ªhitlabçš„webhookï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹éƒ¨ç½²åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦å®‰è£…gitlab-runnerï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">curl -L --output /usr/<span class="hljs-built_in">local</span>/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹è½½åï¼Œè®¾ç½®æ‰§è¡Œæƒé™ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo chmod +x /usr/<span class="hljs-built_in">local</span>/bin/gitlab-runner
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œåˆ›å»ºgitlab-runnerç”¨æˆ·å¹¶è¿è¡ŒgitlabRunneræœåŠ¡ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo useradd --comment <span class="hljs-string">'GitLab Runner'</span> --create-home gitlab-runner --shell /bin/bash<font></font>
sudo gitlab-runner install --user=gitlab-runner --working-directory=/home/gitlab-runner<font></font>
sudo gitlab-runner start</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ³¨å†Œè·‘æ­¥è€…ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æœ¬æ–‡ç¬¬2éƒ¨åˆ†ä¸­çš„ä»¤ç‰Œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">sudo gitlab-runner register</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä½œä¸ºå›åº”ï¼Œä»–ä»¬ä¼šè¦æ±‚æ‚¨æä¾›Hitlabçš„åœ°å€ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æŒ‡å®š</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gitlab.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com )<font></font>
https://gitlab.com</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦è¾“å…¥ä»¤ç‰Œã€‚</font><font style="vertical-align: inherit;">è¾“å…¥ç¬¬2éƒ¨åˆ†ä¸­çš„ä»¤ç‰Œã€‚</font></font><br>
<br>
<pre><code class="bash hljs">Please enter the gitlab-ci token <span class="hljs-keyword">for</span> this runner<font></font>
xxx<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼ŒæŒ‡å®šæè¿°å’Œä»¥é€—å·åˆ†éš”çš„æ ‡ç­¾ã€‚</font><font style="vertical-align: inherit;">ç„¶åæˆ‘ä»¬è¢«æä¾›é€‰æ‹©æ‰§è¡Œè€…ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæ‚¨éœ€è¦é€‰æ‹©ä¸€ä¸ªå¤–å£³ï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><font></font>
Please enter the executor:<font></font>
shell</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ®æˆ‘äº†è§£ï¼Œæ‰§è¡Œå™¨æ˜¯ä¸€ä¸ªç¯å¢ƒï¼Œåœ¨å…¶ä¸­æ‰§è¡Œ.gitlab-ci.ymlæ–‡ä»¶ä¸­çš„ä»£ç ã€‚</font><font style="vertical-align: inherit;">æœ‰bashï¼Œsshï¼Œdockerï¼Œparallelsï¼Œvirtualboxå’Œkubernetsä¾›æ‚¨é€‰æ‹©ã€‚</font><font style="vertical-align: inherit;">è¯¥æ–‡æ¡£å»ºè®®ï¼Œå¦‚æœæ‚¨ä¸çŸ¥é“ä½¿ç”¨ä»€ä¹ˆï¼Œè¯·ä½¿ç”¨bashã€‚</font><font style="vertical-align: inherit;">è¿™æ˜¯åœ¨æœåŠ¡å™¨ä¸Šçš„å‘½ä»¤è¡Œä¸Šè¿è¡Œçš„é€šç”¨é€‰é¡¹ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å°†gitlab-runnerç”¨æˆ·æ·»åŠ åˆ°dockerç”¨æˆ·ç»„ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">sudo usermod -aG docker gitlab-runner</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºé¿å…è®¿é—®é”™è¯¯ï¼Œè¯·æ·»åŠ åˆ°sudoers</font></font><br>
<br>
<pre><code class="bash hljs">sudo nano /etc/sudoers</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
çº¿ </font></font><br>
<br>
<pre><code class="bash hljs">gitlab-runner ALL=(ALL) NOPASSWD: ALL</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»º.gitlab-ci.ymlæ–‡ä»¶ã€‚</font><font style="vertical-align: inherit;">æ‰§è¡Œæ‰€è°“çš„ç®¡é“æ˜¯å¿…éœ€çš„ï¼šç”¨äºéƒ¨ç½²é¡¹ç›®çš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºæ­¤ï¼Œè¯·è½¬åˆ°å‘½ä¸­åˆ—è¡¨ä¸Šçš„é¡¹ç›®å­˜å‚¨åº“ï¼Œç„¶åå•å‡»â€œåˆ›å»ºæ–°æ–‡ä»¶â€ã€‚</font><font style="vertical-align: inherit;">Gitlabæœ¬äººå°†æä¾›æ–‡ä»¶æ¨¡æ¿ï¼Œæ‚¨å¿…é¡»åœ¨å…¶ä¸­é€‰æ‹©.gitlab-ci.ymlã€‚</font><font style="vertical-align: inherit;">åœ¨gitlabä¸­åˆ›å»ºæ–‡ä»¶åï¼Œå¯ä»¥ä¸ºæ–‡ä»¶å†…å®¹é€‰æ‹©æ¨¡æ¿ã€‚</font><font style="vertical-align: inherit;">æˆ‘é€‰æ‹©äº†laravelå¹¶ä¸ºè‡ªå·±é‡åšä¸€ç‚¹ï¼š</font></font><br>
<br>
<pre><code class="xml hljs"><font></font>
# This file is a template, and might need editing before it works on your project.<font></font>
# Official framework image. Look for the different tagged releases at:<font></font>
# https://hub.docker.com/r/library/php<font></font>
# .    ,        <font></font>
image: registry.gitlab.com/<span class="hljs-tag">&lt;<span class="hljs-name"></span>&gt;</span>/<span class="hljs-tag">&lt;<span class="hljs-name"></span>&gt;</span>:latest<font></font>
<font></font>
# Pick zero or more services to be used on all builds.<font></font>
# Only needed when using a docker container to run your tests in.<font></font>
# Check out: http://docs.gitlab.com/ce/ci/docker/using_docker_images.html#what-is-a-service<font></font>
services:<font></font>
  - mysql:latest<font></font>
#    <font></font>
variables:<font></font>
  MYSQL_DATABASE: laravel<font></font>
  MYSQL_ROOT_PASSWORD: ***********<font></font>
<font></font>
# This folder is cached between builds<font></font>
# ,      <font></font>
# http://docs.gitlab.com/ce/ci/yaml/README.html#cache<font></font>
cache:<font></font>
  paths:<font></font>
    - vendor/<font></font>
    - node_modules/<font></font>
<font></font>
# This is a basic example for a gem or script which doesn't use<font></font>
# services such as redis or postgres<font></font>
#     <font></font>
before_script:<font></font>
  #   <font></font>
  - sudo apt-get update -yqq<font></font>
  #    nodejs<font></font>
  - sudo apt-get install gnupg -yqq<font></font>
  #  Node   12<font></font>
  - curl -sL https://deb.nodesource.com/setup_12.x | sudo bash -<font></font>
  #  <font></font>
  - sudo apt-get install git nodejs libcurl4-gnutls-dev libicu-dev libmcrypt-dev libvpx-dev libjpeg-dev libpng-dev libxpm-dev zlib1g-dev libfreetype6-dev libxml2-dev libexpat1-dev libbz2-dev libgmp3-dev libldap2-dev unixodbc-dev libpq-dev libsqlite3-dev libaspell-dev libsnmp-dev libpcre3-dev libtidy-dev -yqq<font></font>
  #  composer<font></font>
  - curl -sS https://getcomposer.org/installer | php<font></font>
  - php composer.phar install<font></font>
  - composer install<font></font>
  #   Node<font></font>
  - npm install<font></font>
  # Copy over testing configuration.<font></font>
  # Don't forget to set the database config in .env.testing correctly<font></font>
  - DB_HOST=mysql<font></font>
  - DB_DATABASE=laravel<font></font>
  - DB_USERNAME=root<font></font>
  - DB_PASSWORD=*********<font></font>
  #  .env.example    .env<font></font>
  - cp .env.example .env<font></font>
  #  npm build<font></font>
  - npm run dev<font></font>
  #       laravel<font></font>
  - php artisan key:generate<font></font>
  - php artisan config:cache<font></font>
  - php artisan route:clear<font></font>
  - php artisan config:clear<font></font>
  - php artisan cache:clear<font></font>
  #  .<font></font>
  - docker-compose exec app php artisan migrate<font></font>
  #   <font></font>
  #- docker-compose exec app php artisan db:seed<font></font>
<font></font>
#<font></font>
test:<font></font>
  script:<font></font>
    #  <font></font>
    - php vendor/bin/phpunit --coverage-text --colors=never<font></font>
    #  npm<font></font>
    - npm test<font></font>
<font></font>
#       <font></font>
deploying:<font></font>
  stage: deploy<font></font>
  script:<font></font>
    - echo "Deployed"<font></font>
    - docker-compose stop<font></font>
    - docker-compose up -d<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœåŠ¡å™¨çš„IPåœ°å€æˆåŠŸæ‰§è¡Œç®¡é“ï¼ˆCI / CD-&gt;ç®¡é“ï¼‰åï¼Œæ‚¨åº”è¯¥çœ‹åˆ°laravelé¡µé¢ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦é…ç½®CI / CDï¼Œæˆ‘ä½¿ç”¨äº†Sean Bradleyçš„è¯´æ˜ï¼š</font></font><br>
<br>
<div class="oembed"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://youtu.be/RV0845KmsNI</font></font></a></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">medium.com/@sean_bradley/auto-devops-with-gitlab-ci-and-docker-compose-f931233f080f</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN491520/index.html">åœ¨Cï¼ƒä¸­å°†xlsè½¬æ¢ä¸ºxlsxå’Œxml</a></li>
<li><a href="../zh-CN491522/index.html">å¥³äººä¸ºä»€ä¹ˆå¯¿å‘½æ›´é•¿</a></li>
<li><a href="../zh-CN491524/index.html">Stas Afanasyevã€‚æœ±è¯º åŸºäºio.Reader / io.Writerçš„ç®¡é“ã€‚ç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN491528/index.html">æˆ‘çš„ç»éªŒæ˜¯è¿›è¡Œ1000æ¬¡é¢è¯•ã€‚Yegor Bugaenkoçš„æŠ¥å‘Šæ‘˜è¦</a></li>
<li><a href="../zh-CN491530/index.html">å†æ¬¡å…³äº433 MHzå‘å°„æœºå’Œæ¥æ”¶æœº</a></li>
<li><a href="../zh-CN491534/index.html">ä½¿ç”¨GDBçš„ç®€è¦æŒ‡å—</a></li>
<li><a href="../zh-CN491536/index.html">YouTube-é”™è¯¯ã€‚è¯·ç¨åå†è¯•ã€‚æ’­æ”¾IDï¼š<...></a></li>
<li><a href="../zh-CN491540/index.html">é¢å‘æ–°æ‰‹ITä¸“å®¶çš„ç½‘ç»œã€‚å¼ºåˆ¶æ€§åŸºåœ°</a></li>
<li><a href="../zh-CN491542/index.html">é¢œè‰²è½¬æ¢ï¼šç¨€ç–è¡¨æœç´¢</a></li>
<li><a href="../zh-CN491544/index.html">åœ¨å‰©ä½™çš„å‘¨æœ«é‡Œè¯»äº›ä»€ä¹ˆ-æœ‰å…³ç—…æ¯’ï¼Œé»‘å®¢å’Œâ€œæ•°å­—â€å¡ç‰¹å°”å†å²çš„ä¹¦ç±</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>