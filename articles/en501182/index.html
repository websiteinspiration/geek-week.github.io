<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏼 👨🏿 📇 oVirt in 2 hours. Part 2. Installing the manager and hosts 🎓 👩🏽‍🤝‍👨🏼 👨‍👨‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is the next in a series on oVirt, beginning here .
 
 Articles
 

1. Introduction
2. Installation of the manager (ovirt-engine) and hyper...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>oVirt in 2 hours. Part 2. Installing the manager and hosts</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501182/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This article is the next in a series on oVirt, beginning </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Articles</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introduction</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation of the manager (ovirt-engine) and hypervisors (hosts) - We are here</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additional settings</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic operations</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, we will consider the issues of initial installation of the ovirt-engine and ovirt-host components.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can always see installation processes in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in more detail </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></h2><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install ovirt-engine</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install ovirt-host</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adding a node to oVirtN</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network Interface Setup</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FC setup</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configure FCoE</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISO Image Storage</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First VM</font></font></a></li>
</ol><br>
<a name="setup-engine"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install ovirt-engine</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For Engine, the minimum requirements are 2 cores / 4 GiB of RAM / 25 GiB of storage. Recommended - from 4 cores / 16 GiB of RAM / 50 GiB of storage. We use the Standalone Manager option when the engine runs on a dedicated physical or virtual machine outside a managed cluster. For our installation, let's take a virtual machine, for example, on a separate ESXi </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . It is convenient to use deployment automation tools or cloning from a previously prepared template or installing kickstart. </font></font><br>
<br>
<i><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Note: for a production system this is a bad idea because the manager works without reserve and becomes a bottleneck. In this case, it is better to consider the option Self-hosted Engine.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
If necessary, the procedure for converting Standalone to Self Hosted is described in detail in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In particular, the host needs to be given the reinstall command with support for the Hosted Engine. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install CentOS 7 in the minimal configuration on the VM, then update and reboot the system:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum update -y &amp;&amp; sudo reboot</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a virtual machine, it is useful to install a guest agent:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install open-vm-tools</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for VMware ESXi hosts, or for oVirt:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install ovirt-guest-agent</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We connect the repository and install the manager:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install https://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm<font></font>
$ sudo yum install ovirt-engine<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basic setting:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-setup</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In most cases, the default settings selected are sufficient; for their automatic use, you can start the configuration with the key:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo engine-setup --accept-defaults</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we can connect to our new engine at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ovirt.lab.example.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It's still empty here, so let's move on to installing hypervisors.</font></font><br>
<a name="setup-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install ovirt-host</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Install CentOS 7 in the minimal configuration on the physical host, then connect the repository, update and reboot the system:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo yum install https://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm<font></font>
$ sudo yum update -y &amp;&amp; sudo reboot<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note: it’s convenient to use deployment automation tools or kickstart installation for installation.</font></font></i><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kickstart file example</font></font></b>
                        <div class="spoiler_text">! <b>   !</b>  !<br>
<br>
<pre><code class="plaintext hljs"># System authorization information<font></font>
auth --enableshadow --passalgo=sha512<font></font>
# Use CDROM installation media<font></font>
cdrom<font></font>
# Use graphical install<font></font>
graphical<font></font>
# Run the Setup Agent on first boot<font></font>
firstboot --enable<font></font>
ignoredisk --only-use=sda<font></font>
# Keyboard layouts<font></font>
keyboard --vckeymap=us --xlayouts='us','ru' --switch='grp:alt_shift_toggle'<font></font>
# System language<font></font>
lang ru_RU.UTF-8<font></font>
<font></font>
# Network information<font></font>
network  --bootproto=dhcp --device=ens192 --ipv6=auto --activate<font></font>
network  --hostname=kvm01.lab.example.com<font></font>
<font></font>
# Root password 'monteV1DE0'<font></font>
rootpw --iscrypted $6$6oPcf0GW9VdmJe5w$6WBucrUPRdCAP.aBVnUfvaEu9ozkXq9M1TXiwOm41Y58DEerG8b3Ulme2YtxAgNHr6DGIJ02eFgVuEmYsOo7./<font></font>
# User password 'metroP0!is'<font></font>
user --name=mgmt --groups=wheel --iscrypted --password=$6$883g2lyXdkDLbKYR$B3yWx1aQZmYYi.aO10W2Bvw0Jpkl1upzgjhZr6lmITTrGaPupa5iC3kZAOvwDonZ/6ogNJe/59GN5U8Okp.qx.<font></font>
# System services<font></font>
services --enabled="chronyd"<font></font>
# System timezone<font></font>
timezone Europe/Moscow --isUtc<font></font>
# System bootloader configuration<font></font>
bootloader --append=" crashkernel=auto" --location=mbr --boot-drive=sda<font></font>
# Partition clearing information<font></font>
clearpart --all<font></font>
# Disk partitioning information<font></font>
part /boot --fstype xfs --size=1024 --ondisk=sda  --label=boot<font></font>
part pv.01 --size=45056 --grow<font></font>
volgroup HostVG pv.01 --reserved-percent=20<font></font>
logvol swap --vgname=HostVG --name=lv_swap --fstype=swap --recommended<font></font>
logvol none --vgname=HostVG --name=HostPool --thinpool --size=40960 --grow<font></font>
logvol / --vgname=HostVG --name=lv_root --thin --fstype=ext4 --label="root" --poolname=HostPool --fsoptions="defaults,discard" --size=6144 --grow<font></font>
logvol /var --vgname=HostVG --name=lv_var --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=16536<font></font>
logvol /var/crash --vgname=HostVG --name=lv_var_crash --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=10240<font></font>
logvol /var/log --vgname=HostVG --name=lv_var_log --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=8192<font></font>
logvol /var/log/audit --vgname=HostVG --name=lv_var_audit --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=2048<font></font>
logvol /home --vgname=HostVG --name=lv_home --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=1024<font></font>
logvol /tmp --vgname=HostVG --name=lv_tmp --thin --fstype=ext4 --poolname=HostPool --fsoptions="defaults,discard" --size=1024<font></font>
<font></font>
%packages<font></font>
@^minimal<font></font>
@core<font></font>
chrony<font></font>
kexec-tools<font></font>
<font></font>
%end<font></font>
<font></font>
%addon com_redhat_kdump --enable --reserve-mb='auto'<font></font>
<font></font>
%end<font></font>
<font></font>
%anaconda<font></font>
pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty<font></font>
pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok<font></font>
pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty<font></font>
%end<font></font>
# Reboot when the install is finished.<font></font>
reboot --eject<font></font>
</code></pre><br>
  , .,  <a href="" rel="nofollow">ftp.example.com/pub/labkvm.cfg</a>.           'Install CentOS 7',     ( Tab)    ( ,  )  <br>
<br>
<pre><code class="plaintext hljs">' inst.ks=ftp://ftp.example.com/pub/labkvm.cfg'</code></pre>.<br>
      /dev/sda,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"> </a> (      lsblk).     kvm01.lab.example.com (     hostnamectl set-hostname kvm03.lab.example.com),  IP  — ,   — ,    .<br>
<br>
  root: monteV1DE0,   mgmt: metroP0!is.<br>
<b>!    !  !</b><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repeat (or execute in parallel) on all hosts. </font><font style="vertical-align: inherit;">From turning on the "empty" server to the finished state, taking into account 2 long downloads, it takes about 20 minutes.</font></font><br>
<a name="add-host"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adding a node to oVirt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is very simple: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compute → Hosts → New → ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the wizard, the required fields are Name (display name, for example, kvm03), Hostname (FQDN, for example kvm03.lab.example.com) and the Authentication section - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root user (invariable)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - password or SSH Public Key. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After clicking the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> button, </font><font style="vertical-align: inherit;">you will receive the message </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“You haven't configured Power Management for this Host. Are you sure you want to continue? ”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is normal - we will consider power management later, after a successful host connection. However, if the machines on which the hosts are installed do not support management (IPMI, iLO, DRAC, etc.), I recommend turning it off: Compute → Clusters → Default → Edit → Fencing Ploicy → Enable fencing, uncheck it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the oVirt repository was not connected on the host, the installation will fail, but it's okay - you need to add it, then click Install -&gt; Reinstall. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host connection takes no more than 5-10 minutes.</font></font><br>
<a name="host-nic"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network Interface Setup</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we build a fault-tolerant system, the network connection should also provide a redundant connection, which is done on the tab Compute → Hosts → </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HOST</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> → Network Interfaces - Setup Host Networks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depending on the capabilities of your network equipment and architecture approaches, options are possible. It is best to connect to the stack of top-of-rack switches so that when one fails, network availability is not interrupted. Consider the example of an aggregated LACP channel. To configure the aggregated channel, “take” the 2nd unused adapter with the mouse and “take” it to the 1st. The </font><b><font style="vertical-align: inherit;">Create New Bond</font></b><font style="vertical-align: inherit;"> window opens.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where LACP (Mode 4, Dynamic link aggregation, 802.3ad) is selected by default. </font><font style="vertical-align: inherit;">On the switch side, the normal LACP group configuration is performed. </font><font style="vertical-align: inherit;">If it is not possible to build a switch stack, you can use Active-Backup mode (Mode 1). </font><font style="vertical-align: inherit;">We will consider VLAN settings in the next article, and in more detail with recommendations on network settings in the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planning and Prerequisites Guide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> document </font><font style="vertical-align: inherit;">.</font></font><br>
<a name="host-fc"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FC setup</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fiber Channel (FC) is supported out of the box, its use is straightforward. </font><font style="vertical-align: inherit;">We will not configure the storage network, including the configuration of storage systems and the zoning of fabric switches as part of the oVirt configuration.</font></font><br>
<a name="ovirt-fcoe"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configure FCoE</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FCoE, in my opinion, was not widely used in storage networks, but it is often used on servers as the "last mile", for example, in HPE Virtual Connect.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuring FCoE requires additional simple steps.</font></font></b>
                        <div class="spoiler_text"><h4>Setup FCoE Engine</h4><br>
   Red Hat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">B.3. How to Set Up Red Hat Virtualization Manager to Use FCoE<br>
On the Manager</a>,         :<br>
<br>
<pre><code class="bash hljs">
$ sudo engine-config -s UserDefinedNetworkCustomProperties=<span class="hljs-string">'fcoe=^((enable|dcb|auto_vlan)=(yes|no),?)*$'</span><font></font>
$ sudo systemctl restart ovirt-engine.service<font></font>
</code></pre><br>
<h4>Setup Node FCoE</h4><br>
 oVirt-Host'   <br>
<br>
<pre><code class="bash hljs">$ sudo yum install vdsm-hook-fcoe</code></pre><br>
   FCoE,   Red Hat: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">25.5. Configuring a Fibre Channel over Ethernet Interface</a>.<br>
<br>
 Broadcom CNA   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">User Guide FCoE Configuration for Broadcom-Based Adapters</a>.<br>
<br>
,    (   minimal):<br>
<br>
<pre><code class="bash hljs">$ sudo yum install fcoe-utils lldpad</code></pre><br>
   ( ens3f2  ens3f3   CNA,    ):<br>
<br>
<pre><code class="bash hljs">$ sudo cp /etc/fcoe/cfg-ethx /etc/fcoe/cfg-ens3f2<font></font>
$ sudo cp /etc/fcoe/cfg-ethx /etc/fcoe/cfg-ens3f3<font></font>
$ sudo vim /etc/fcoe/cfg-ens3f2<font></font>
$ sudo vim /etc/fcoe/cfg-ens3f3<font></font>
</code></pre><br>
<b></b>:      DCB/DCBX,  DCB_REQUIRED     no.<br>
<br>
DCB_REQUIRED=«yes» → <b>#</b>DCB_REQUIRED=«yes»<br>
<br>
  ,  adminStatus    ,  ..   FCoE:<br>
<br>
<pre><code class="bash hljs">$ sudo lldptool <span class="hljs-built_in">set</span>-lldp -i ens3f0 adminStatus=disabled<font></font>
...<font></font>
$ sudo lldptool <span class="hljs-built_in">set</span>-lldp -i ens3f3 adminStatus=disabled
</code></pre><br>
    ,   LLDP:<br>
<br>
<pre><code class="bash hljs">$ sudo systemctl start lldpad<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> lldpad
</code></pre><br>
  ,    DCB/DCBX,  DCB_REQUIRED     <b>no</b>      .<br>
<br>
<pre><code class="bash hljs">$ sudo dcbtool sc ens3f2 dcb on<font></font>
$ sudo dcbtool sc ens3f3 dcb on<font></font>
$ sudo dcbtool sc ens3f2 app:fcoe e:1<font></font>
$ sudo dcbtool sc ens3f3 app:fcoe e:1<font></font>
$ sudo ip link <span class="hljs-built_in">set</span> dev ens3f2 up<font></font>
$ sudo ip link <span class="hljs-built_in">set</span> dev ens3f3 up<font></font>
$ sudo systemctl start fcoe<font></font>
$ sudo systemctl <span class="hljs-built_in">enable</span> fcoe
</code></pre><br>
      :<br>
<br>
<pre><code class="bash hljs">$ sudo vim /etc/sysconfig/network-scripts/ifcfg-ens3f2<font></font>
$ sudo vim /etc/sysconfig/network-scripts/ifcfg-ens3f3<font></font>
</code></pre><br>
<pre><code class="plaintext hljs">ONBOOT=yes</code></pre><br>
  FCoE ,      .<br>
<br>
<pre><code class="bash hljs">$ sudo fcoeadm -i</code></pre><br>
  FCoE     FC.<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following is the configuration of storage systems and networks - zoning, SAN hosts, creating and presenting volumes / LUNs, after which the storage can be connected to ovirt-hosts: Storage → Domains → New Domain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Domain Function leave Data, Storage Type - Fiber Channel, Host - any, name - e.g. storNN-volMM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surely your storage system allows the connection is not just a reservation of paths, but also balancing. </font><font style="vertical-align: inherit;">Many modern systems are capable of transmitting data along all paths equally optimally (ALUA active / active). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To enable all paths in an active state, you need to configure multipassing, more on that in the following articles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuring NFS and iSCSI is done in a similar way.</font></font><br>
<a name="host-iso"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ISO Image Storage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To install the OS, you will need their installation files, most often available in the form of ISO images. </font><font style="vertical-align: inherit;">You can use the built-in path, but for working with images in oVirt a special type of storage is developed - ISO, which can be targeted to an NFS server. </font><font style="vertical-align: inherit;">Add it: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Storage → Domains → New Domain, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Domain Function → ISO, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Export Path - e.g. mynfs01.example.com:/exports/ovirt-iso (at the time of connection, the folder should be empty, the manager should be able to write to it), </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Name - e.g. mynfs01-iso. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To store images, the manager will create the structure </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
/ exports / ovirt-iso </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ &lt;some UUID&gt; / images / 11111111-1111-1111-1111-111111111111 /</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you already have ISO images on our NFS server, it’s convenient to link them to this folder instead of copying files to save space.</font></font><br>
<a name="1stVM"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First VM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At this stage, you can already create the first virtual machine, install the OS and application software on it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compute → Virtual Machines → New </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For the new machine, specify a name (Name), create a disk (Instance Images → Create) and connect the network interface (Instantiate VM network interfaces by picking a vNIC profile → choose the only ovirtmgmt from the list so far). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On the client side, you need a modern browser and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPICE client</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to interact with the console. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first machine started successfully. </font><font style="vertical-align: inherit;">However, for a more complete system operation, a number of additional settings are required, which we will continue in the following articles.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en501168/index.html">Orderlies save themselves - do they save, save, burn out?</a></li>
<li><a href="../en501170/index.html">The best way to work with the DOM</a></li>
<li><a href="../en501172/index.html">My Mikrosh computer: continue the week of nostalgia</a></li>
<li><a href="../en501178/index.html">How watching porn affects the productivity of work and study</a></li>
<li><a href="../en501180/index.html">[Post-Question] Do you need an IT movement for FACTS about coronavirus and “side effects”</a></li>
<li><a href="../en501184/index.html">How to configure Apollo to work with GraphQL in Android</a></li>
<li><a href="../en501188/index.html">How to process satellite imagery with Sen2Cor</a></li>
<li><a href="../en501190/index.html">How to start a startup, enter the Chinese market and get 15 million investment</a></li>
<li><a href="../en501192/index.html">Top 5 Tips for Improving Soft Skills in English</a></li>
<li><a href="../en501194/index.html">In the wake of the hot particles. Wilson's Chamber</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>