<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî† üèúÔ∏è üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ How we created the gallery of neural network art and why we do not give pictures to copy üåä üóûÔ∏è üëåüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we launched a virtual gallery where all the pictures are created by a neural network. Its peculiarity is that only one person can take each pict...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>How we created the gallery of neural network art and why we do not give pictures to copy</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/493190/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Today we launched a virtual </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gallery</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where all the pictures are created by a neural network. Its peculiarity is that only one person can take each picture in full size. Almost like in a real gallery. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this post, I will talk about how this idea was born and how we implemented it using two neural networks, one of which is used in Yandex search.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/7w/ge/up/7wgeupvzbfnaze2xnkflpwzjz5g.jpeg"></a><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idea</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We experiment a lot with GANs and tried to find the idea of ‚Äã‚Äãa beautiful and understandable project in which we could show our achievements. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I already had a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganarts</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><font style="vertical-align: inherit;">that I launched for myself and friends. </font><font style="vertical-align: inherit;">It was just a page on which pictures in the form of a print on a t-shirt were endlessly generated. </font><font style="vertical-align: inherit;">They were generated by the StyleGAN neural network, trained on hand-picked art styles with wikiart.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project Gif</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/gh/cj/-l/ghcj-lsrc7_z7dwq_riy_wxnsp8.gif"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We took this idea as a basis. But I didn‚Äôt want to do just another site-generator of pictures. And in the process of discussion, the concept of an art gallery with several thematic rooms appeared, where each picture should have no more than one owner. According to our idea, this should connect the virtual gallery with the more familiar galleries in which each picture has a specific owner. At the same time, being able to generate millions of images, we specifically limited their number so that each user who managed to pick up a picture felt its uniqueness. And we also added a restriction - you can take no more than one picture - so it‚Äôs much more interesting to choose. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementation</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since the Nvidia company posted the code for training the StyleGAN neural network, it is quite difficult to surprise someone with the generated images. Its authors managed to make a fairly universal architecture, which shows good results on different data. A breakthrough was also in the fact that the model could be trained at a sufficiently high resolution (1024 √ó 1024) for an acceptable time and with better quality than that of competitors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enthusiasts "fed" to her everything that comes to hand. If you are interested in looking at such projects, here is a list of the most striking ones. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- People: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thispersondoesnotexist.com</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Anime: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.thiswaifudoesnotexist.net</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Cats: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thesecatsdonotexist.com</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Game of Thrones characters: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nanonets.com/blog/stylegan-got</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Cars: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/SyntopiaDK/status/1094337819659644928</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Logos: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/matthewjarvisw/status/1110548997729452035</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Children's drawings: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/roberttwomey/status/1239050186120282113</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Bugs: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/karim_douieb/status/1229903297378766854</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- comics Garfield: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/willynguen/status/1220382062554898433</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Fonts: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/cyrildiagne/status/1095603397179396098</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Images from the microscope: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/MichaelFriese10/status/1229453681516412928</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- Pokemon: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter.com/MichaelFriese10/status/ 1210305621121064960</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
But progress does not stand still, and at the end of 2019 Nvidia released the second version</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StyleGAN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A detailed overview of all changes can be read </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on Habr√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The main visible improvement is getting rid of characteristic droplet-like artifacts by changing the method of normalizing activations within the network. Having tried the new architecture on our initial dataset, we also noticed an increase in the variety of generated paintings, which could not but rejoice. Our hypothesis: this was due to an increase in the number of parameters in the second version of the architecture, which allowed us to learn more ‚Äúmodes‚Äù in the distribution of data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another nice bonus of the second version of StyleGAN was the ‚Äúsmoother‚Äù latent space. Simply put, this allows you to make smooth flowing between different pictures:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/4dYphfhu-MI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To create the paintings, we used the StyleGAN2 architecture. We taught the neural network on works belonging to different areas of painting: from Fauvism and Cubism to minimalism and street art. In total, there are about 40 thousand paintings in the training set, on the basis of which completely new images are generated.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our gallery has four thematic halls: "People", "Nature", "City" and "Mood". In order to divide the paintings into halls, we used the neural network, which is used in Yandex.Pictures. She learns on user clicks from issuing pictures on a text request. Our internal training dataset is large enough so that this neural network can figure out even the generated patterns. She helped to automatically select images according to our textual requests from a huge number of random pictures. For example, for a room called ‚ÄúPeople,‚Äù paintings were selected at the request of ‚Äúbeauty,‚Äù ‚Äúround dance,‚Äù ‚Äúdate,‚Äù ‚Äúmaster,‚Äù and so on. This created a sense of thematic rooms, and the initial queries served as the names for the paintings. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Result</font></font></b><br>
<br>
<img src="https://habrastorage.org/webt/67/nl/ut/67nlut1rdydjqllagly9il2dto8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
We made a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gallery</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of four thousand paintings, each of which can find its owner. </font><font style="vertical-align: inherit;">With this virtual gallery, we want to further reduce the distance between neural network creativity and more tangible art. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I believe that the process of selecting a picture by the user can also be called a manifestation of creativity. </font><font style="vertical-align: inherit;">And I hope that in the future there will be much more opportunities for creative choice.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493170/index.html">Werf 1.1 release: improvements in the collector today and plans for the future</a></li>
<li><a href="../en493172/index.html">The bigger, the worse or why the game loop matters</a></li>
<li><a href="../en493178/index.html">Everything is amazing in software, but everyone is unhappy</a></li>
<li><a href="../en493184/index.html">Contract development of electronics. Project calculation</a></li>
<li><a href="../en493186/index.html">The best automotive-related articles for developers on Habr√© [170+]</a></li>
<li><a href="../en493192/index.html">ASCII game - a compromise of authenticity and convenience</a></li>
<li><a href="../en493196/index.html">Preparing for ShAD without leaving home</a></li>
<li><a href="../en493198/index.html">How to visualize and animate (geophysical) models. Voxel models and mesh surfaces</a></li>
<li><a href="../en493200/index.html">Distribution of a spherical horse in a vacuum throughout the Russian Federation</a></li>
<li><a href="../en493202/index.html">RBK.money released the world's first open-source payment processing - creating the future together</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>