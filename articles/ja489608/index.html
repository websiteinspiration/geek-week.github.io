<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏼 👨🏾‍🔧 🧖🏾 Postmanユーティリティを使用したSCEFを介したNIDDとの相互作用。SCEFとその機能の概要 🖍️ 🧚🏾 👩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="この記事では、開発を始めたばかりのユーザー、またはすでにNB-IoTテクノロジーを適用しているユーザーが、NB-IoTデバイスとリモートで対話する方法を理解できるようにします。
 
 
 
 短いレビュー
 NB-IoTは2Gに後れをとらず、セルラー通信のエネルギー効率の高い標準としての地位を確立し...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Postmanユーティリティを使用したSCEFを介したNIDDとの相互作用。SCEFとその機能の概要</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489608/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、開発を始めたばかりのユーザー、またはすでにNB-IoTテクノロジーを適用しているユーザーが、NB-IoTデバイスとリモートで対話する方法を理解できるようにします。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hj/ax/eq/hjaxeqtz5llcdmfzbwcv6zosici.png" alt="画像"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">短いレビュー</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NB-IoTは2Gに後れをとらず、セルラー通信のエネルギー効率の高い標準としての地位を確立しており、近い将来、2Gを絞り出すことができるようになり、その位置付けが強化されました。この理由は、デバイスの最も消費量の多い部品の1つである無線送信機のエネルギー消費の問題に柔軟に対応できることです。詳細に触れない場合は、NB-IoTとともに、デバイスの通信スケジュールとデバイスとインターネット上のサーバーとの相互作用を設定することにより、デバイスの動作モードを柔軟に構成する機会があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これと並行して、1つのセルに同時に接続されている加入者デバイスの数、およびこの通信自体の操作性を維持するためのモバイルオペレーターのコストが大幅に増加しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読者はNB-IoTテクノロジーのおおよその理解があり、最小限の対話経験があることが前提となっています。</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事は定期的に更新され、更新されます。</font></font></blockquote><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NB-IoTネットワーク内の問題</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
無線送信機を制御する機能と高いエネルギー効率とともに、サーバーからモジュール（デバイス）の方向にデータを送信するという問題が発生しました。その理由は、何十万ものデバイスにホワイトIPアドレスを提供することが可能であるということですが、これは大量のオーバーヘッドを伴い、その複雑さのためにネットワークの全体的な信頼性を低下させます。モジュールはオペレーターのNATのアドレスを受け取り、デバイスの数が多いため、オペレーターがアドレスを「アウト」に変換することは困難です。たとえば、10万台のデバイスは同じIPアドレス数であり、IPv4のフレームワーク内では、これを実装することは不可能に思われます。 IPv6への移行でこの問題を解決できますが、ネットワーク上のデバイスの「ホワイト」アドレスに料金を支払う必要があります。これは、企業クライアントのポケットに大きな影響を与えます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、一般的なケースでは、サーバーはデータをサーバーに送信することによってのみ、デバイスが一方向モードでしか動作できないことがわかります。これは、サーバーがデバイスに最初に触れたときに事実上サーバーが認識していないためです。</font><font style="vertical-align: inherit;">または、デバイスからサーバーへの接続が確立されてから平均で5分以内にサーバーからデバイスにデータを転送するために使用します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NIDD（非IPデータ配信）-なぜこれが必要なのですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NB-IoTネットワークを使用する場合、コマンドまたは特定のデータを送信するためにデバイスに頼ることは非常に困難です。この問題を解決するために、少量のデータの転送を最適化するメカニズムであるNon-IP Data Delivery（NIDD）が発明されました。</font><font style="vertical-align: inherit;">このメカニズムは、ヘッダーを減らすことにより、送信されるメッセージの全体的なサイズを減らします。</font><font style="vertical-align: inherit;">これは、デバイスの特性にプラスの影響を与えます。つまり、電力消費を削減し、自律性（バッテリー寿命）を向上させます。</font><font style="vertical-align: inherit;">その結果、IPサポートの拒否は、デバイスの安価化、開発時間の短縮、IoTデバイス市場における競争力の向上などにつながります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCEF（Service Capability Exposure Function）-ユーザーへのギフト</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEFは最初に登場した機能的なネットワーク要素であり、3GPPリリース13はモバイルオペレーターの側に配備され、SCS / AS（サービス機能サーバー/アプリケーションサーバー）とNB-IoTデバイス間の安全な通信チャネルを提供します。 SCEFは、NIDDを介してデバイスと通信するときに通信チャネルを提供し、（API T8記述から）単一のアプリケーションプログラミングインターフェイスを介してNB-IoTネットワークの追加のネットワーク機能/サービスへのアクセスを提供します。 3GPPリリース13では、セルラーネットワークインターフェイスとインターフェイスするためのSCEFメカニズムのみが標準化されました。したがって、ネットワーク負荷が最適化され、デバイスとの相互作用が簡素化され、デバイス自体のアルゴリズムが簡素化されます。SCEFは、データ転送のセキュリティに関する高い要件と、双方向でのデータ転送の成功を確認するための要件も満たします。</font></font><br>
<br>
<h3>    </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEFを使用すると、NB-IoTデバイスがeDRXまたはPSMモードにあり、サーバー-&gt;デバイスの方向でのデータ転送に使用できない場合を含め、NB-IoTデバイスとの相互作用の複雑なシステムから抽象化できます。デバイスが登録を受信し、通信スケジュールについてネットワークオペレーターのネットワークに「同意」すると、シンプルなインターフェースを使用して、データをデバイスに転送し、そこからデータを受信し、デバイスとASの特定のイベントへの「サブスクリプション」を管理し、独自のイベントを設定してバインドできますユニバーサルID名など。これらすべてを同じインターフェース-T8 APIを介して行います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバー（AS）は1つではなく複数にすることができ、特定のイベントまたはデバイスのグループについてサーバー間の情報の配布を柔軟に構成できることに注意することが重要です。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使い方</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セルラーネットワークへのデバイスのアクセスを整理するための最も一般的なソリューションは、セルラーモジュールを使用することです。次に例を示します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/f6/yn/xw/f6ynxwxpeypur3-lg6wabxhwyay.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
セルラーネットワークに登録するとき、このようなモジュールは、オペレーターが加入者アカウントに関連付けることができる加入者SIMカードのIMSIまたはオペレーターがオペレーターの個人アカウントにアクセスできる場合は加入者自身を含むいくつかの情報をオペレーターに送信します。 SCEF画面の背後には、デバイスとの次の通信セッションに関する知識が隠されています。オペレーターのネットワークへの非IPデバイスの登録は、SCS / ASからこのデバイスへのサブスクリプションが少なくとも1つある場合にのみ可能です。サブスクリプションなし-NIDDを介してこのデバイスと通信するユーザーはいないため、デバイスはネットワークに登録されません。したがって、次の通信セッションを認識しているSCEFは、指定された配信パラメーターと送信されたメッセージの有効期間に従って、デバイスとの間でデータを転送できます。データ転送と配信制御のステータスをさらに監視する必要はありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">軽さ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データバイトの単位をデバイスからTCPプロトコルにカプセル化し、それをサーバーに転送することは、会社のフリート内の数十万のサブスクライバーデバイスという点でコストがかかります。</font><font style="vertical-align: inherit;">SCEFを使用すると、デバイスのIPを放棄し、信号チャネルを介してIPヘッダーなしで非IPデータのみを転送できます。これにより、送信バイトのコストが大幅に削減され、サービスの使用による追加の利点が得られます。</font><font style="vertical-align: inherit;">さらに、SCEFはデバイスに送信されたデータに変更を加えず、デバイスからのペイロードは透過的に送信されます。</font><font style="vertical-align: inherit;">したがって、NIDDを使用すると、非構造化データだけでなく、JSONなどの理解可能な標準化された形式で「ラップ」されたデータも転送して、AS側のデータ処理を簡素化できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕事の始まり</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postmanの例のURI（Uniform Resource Identifier）の構造</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、オペレーター（M2Mマネージャーサービス）から個人アカウントにアクセスする必要があります。</font><font style="vertical-align: inherit;">MTSの商用実装では、APNを個別に作成し、APIへのログイン/パスワードアクセスを行い、デバイスにScsAsID、extIDという名前を割り当てることができる単一の個人アカウントインターフェイスが提供されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それら。</font><font style="vertical-align: inherit;">少なくとも次のものが必要です。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScsAsID-AS ID</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APN-通常ネットワークとの対話に使用されるものは機能しません</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログイン/パスワード-個人アカウントへのアクセスとSCEFとのやり取りのためのデータ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URI – SCEFから提供されたネットワーク上のHTTPアドレスとポート </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">externalID-デバイスのID</font></font></li>
</ul><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">練習に移りましょう</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SIMCOMワイヤレスソリューション生産モジュールの練習- -理論は、最も興味深い部分の上での動きをみましょう、終わった</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIM7020Eを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ue/d6/_o/ued6_opqiacsy2l1axsi8zch1d0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、NIDDで動作するようにモジュール自体を構成する必要があります。</font><font style="vertical-align: inherit;">これを行うには、まずモジュールをCFUN = 0モードにして構成します。</font></font><br>
<br>
<pre><code class="plaintext hljs">AT+CFUN=0<font></font>
+CPIN: NOT READY<font></font>
<font></font>
OK<font></font>
AT+ENVDM=1,tel_conn_mgr,default_pdn_flag,1,30<font></font>
OK<font></font>
AT*MCGDEFCONT="Non-IP","&lt;APN&gt;"<font></font>
OK<font></font>
AT+CFUN=1<font></font>
OK<font></font>
<font></font>
+CPIN: READY<font></font>
AT+EGACT=1,4,"&lt;APN&gt;"<font></font>
+EGACT:1<font></font>
<font></font>
OK<font></font>
<font></font>
+EGACT:1,1,1,4</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パケットデータネットワークでのモジュールの登録の確認</font></font><br>
<br>
<pre><code class="plaintext hljs">AT+CGREG?<font></font>
+CGREG: 0,1<font></font>
<font></font>
OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NIDDの設定を完了します</font></font><br>
<br>
<pre><code class="plaintext hljs">AT+NIDD=0,"&lt;APN&gt;","&lt;login&gt;","&lt;pass&gt;"<font></font>
+NIDD=0,0<font></font>
<font></font>
OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュールの応答には、ここにaccount_idが含まれます。+ NIDD = 0、&lt;account_id&gt;-これは、モジュールでNIDDをアクティブにするときに便利です。</font></font><br>
<br>
<pre><code class="plaintext hljs">AT+NIDD=1,0<font></font>
+NIDD=1,0<font></font>
<font></font>
OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、account_idは0 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。完了。</font><font style="vertical-align: inherit;">この段階で、モジュールでの作業は完了です。</font><font style="vertical-align: inherit;">SCEFのセットアップに移りましょう。</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要なポイント：SCEFに登録されたサブスクリプションがないと、モジュールはネットワーク上で登録を受け取りません！</font></font></u><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCEF</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API T8</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEFとの相互作用を詳述した特別なドキュメントがあります。</font><font style="vertical-align: inherit;">このAPIは、非IPデータを送信するための一連のデータモデル、リソース、および関連手順を定義します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/nm/zz/ydnmzzwqtgnhqbxt7gnrsdpow00.png"></div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCEFとサービスサブスクリプションの操作-JSON（JavaScript Object Notation）</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEF構成を含み、HTTP / 1.1を介してSCEFに送信されるデータは、JSON形式でエンコードする必要があり、Content-TypeフィールドのHTTPリクエスト自体の本文に「application / json」ヘッダーを含める必要があります。</font><font style="vertical-align: inherit;">同時に、メッセージが受信者に配信され、配信確認が受信された場合-SCEFは適切な構成を削除し、ステータスコード「200 OK」を含むHTTP POST for ASを介してメッセージを送信し、イベントのレポートをオンにする必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">郵便配達</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このユーティリティの使用方法については詳しく説明しません。インターネットでは、多くのレビューを見つけることができます。</font><font style="vertical-align: inherit;">無料版にはいくつかの制限があると言えますが、それほど多くは必要ありません。無料で提供される機能は、私たちのタスクには十分すぎるほどです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ダウンロードして開いた後、最初のタブが表示されます-最初のリクエストを作成するために提供されるランチパッド。拒否はしません。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mf/ej/si/mfejsivr_jj6forivsfp0jhstbu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すぐに新しいデバイスの構成に進みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、GETメソッドを構成し、それをPOSTに切り替えます（少し後で、これが必要な理由が明らかになります）。</font><font style="vertical-align: inherit;">「認証」タブで、手元にある「資格情報」を入力します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/96/ci/zc/96cizcahk44iy5-rpfvcznue3jw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、最初のリクエストを作成します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kp/zj/rp/kpzjrpd26ykmyt5r6xtyyoizk1w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リクエストの本文では、次のことを示します。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"pdnEstablishmentOption"</span>: <span class="hljs-string">"WAIT_FOR_UE"</span>,
    <span class="hljs-attr">"duration"</span>:<span class="hljs-string">"2020-12-31T23:59:59Z"</span>,
    <span class="hljs-attr">"notificationDestination"</span>: <span class="hljs-string">"http://&lt;IP &gt;:&lt;port&gt;"</span>
}</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要！</font></font></b>
                        <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意を払う：</font></font><br>
<ul>
<li>“duration” –      duration     SLA SCEF    (SCSAS/ID)   , SCEF    ,    </li>
<li>“maximumPacketSize” –       / </li>
</ul></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「pdnEstablishmentOption」では次のオプションが使用できることに注意してください。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WAIT_FOR_UE-デバイスが利用できない場合（ネットワークまたはPSMまたは別の状態で登録されていない場合）のバッファー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INDICATE_ERROR-デバイスが利用できない場合、エラーで即座に応答します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SEND_TRIGGER-デバイストリガーサービス（SMSを介した代替配信チャネル）を使用します。</font><font style="vertical-align: inherit;">この記事は考慮されません。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じパラメーターを使用して、デバイスにデータを送信します。</font><font style="vertical-align: inherit;">また、サブスクリプションを作成すると、すぐにデバイスにデータを送信できるため、APIリクエストの数を減らすことができます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべて！</font><font style="vertical-align: inherit;">[送信]ボタンをクリックして、SCEFからの応答を注意深く確認できます。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"duration"</span>: <span class="hljs-string">"2020-12-31T23:59:59Z"</span>,
    <span class="hljs-attr">"notificationDestination"</span>: <span class="hljs-string">"http://&lt;IP &gt;:&lt;port&gt;"</span>,<font></font>
    “reliableDataService<span class="hljs-attr">": false,
    "</span>maximumPacketSize<span class="hljs-attr">": 500,
    "</span>self<span class="hljs-attr">": "</span>/3gpp-nidd/v1/&lt;ScsAsID&gt;/configurations/&lt;ID &gt;<span class="hljs-attr">",
    "</span>status<span class="hljs-attr">": "</span>ACTIVE<span class="hljs-attr">"
}</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自己の行では、主に作成した構成のIDに関心があります。おそらくオペレーターが作成したすべての構成の要求機能をサポートしないため、それを失うことは非常に望ましくありません。</font><font style="vertical-align: inherit;">1つのScsAsIDのフレームワーク内に数千のデバイスが作成されると、すべてのデバイス構成をブロードキャストするには、SCEFサーバーに負荷がかかりすぎます。</font><font style="vertical-align: inherit;">原則として、1つのデバイス= ScsAsIDサービスの一部としての1つのサブスクリプションです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、サーバー上のモジュールからデータを受信することができます。そのIPアドレスとポートは上記で示したものです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールからASへのデータ転送</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバイスからASにデータを転送して、SIM7020Eモジュールに戻ってみましょう。前の章で触れなかった場合やオフにしていない場合は、コマンドを送信します。</font></font><br>
<br>
<pre><code class="plaintext hljs">AT+NIDD=3,&lt;account_id&gt;,"6162636465"<font></font>
OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージはHEXでエンコードされており、「abcde」という単純なシーケンスが含まれていることに注意してください。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどすぐに、ホストであるサーバー（AS）に、次のように表示されます。</font></font><br>
<br>
<pre><code class="xml hljs">POST / HTTP/1.1<font></font>
OCSGHTTPProcessor: 147ff7c6-a43d-4fc9-b303-0ca50f497747<font></font>
X-callback-t8-type: 3<font></font>
X-callback-url: http://<span class="hljs-tag">&lt;<span class="hljs-name">IP</span> &gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><font></font>
X-api-network-service-node: 0<font></font>
Content-Type: application/json<font></font>
Content-Length: 214<font></font>
Host: <span class="hljs-tag">&lt;<span class="hljs-name">IP</span> &gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><font></font>
Connection: Keep-Alive<font></font>
User-Agent: Apache-HttpAsyncClient/4.1.3 (Java/1.8.0_181)<font></font>
<font></font>
{"externalId":"<span class="hljs-tag">&lt;<span class="hljs-name">ID</span> &gt;</span>","niddConfiguration":"/3gpp-nidd/v1/<span class="hljs-tag">&lt;<span class="hljs-name">ScsAsID</span>&gt;</span>/configurations/<span class="hljs-tag">&lt;<span class="hljs-name">ID</span> &gt;</span>","data":"YWJjZGU=","reliableDataService":false}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージ自体は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Base64</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エンコーディングで到着し</font><font style="vertical-align: inherit;">、次のようになります。</font></font><br>
<pre><code class="plaintext hljs">YWJjZGU=</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Base64エンコーディングから変換すると、元のメッセージが表示されます。</font></font><br>
<pre><code class="plaintext hljs">abcde</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASCIIエンコーディングを使用すると一部のデータが失われることがあり、Base64を使用すると転送の信頼性が高まるため、Base64エンコーディングが使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、モジュールから送信された情報はSCEF内に保存されず、HTTP経由ですぐにサーバーに送信されることにも注意してください。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASからモジュールへのデータ転送</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASからモジュールの方向にデータを送信するために、Postmanに戻り、POSTメソッドとBase64エンコーディングを使用して新しいリクエストを作成します。 1234567890（Base64：MTIzNDU2Nzg5MA ==）をモジュール</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wz/mj/mc/wzmjmczcilbscfvrsjryyi5qfr8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
に送信します。「アドレス」フィールドに補遺が表示されていることに注意してください。ここでは、メッセージを送信する構成を示しています。構成に複数のデバイスが含まれている場合、識別子「externalGroupID」を使用すると、すべてのデバイスがこのデータを受信します。もう1つの重要な点は、送信されたメッセージの存続期間であり、秒単位で示され、範囲がかなり広いです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、この時点でデバイスがオンラインでない場合、メッセージはSCEFでバッファリングされ、「maximumLatency」の行は、デバイスがタイマーを設定する前に連絡しなかった場合にメッセージが破棄されるまでの残り秒数を示します。 。</font><font style="vertical-align: inherit;">以下は、要求された現在のSCEF構成がどのようになるかを示しています（GETメカニズムを使用して、以下で詳しく説明します）。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"duration"</span>: <span class="hljs-string">"2020-12-31T23:59:59Z"</span>,
    <span class="hljs-attr">"notificationDestination"</span>: <span class="hljs-string">"http://&lt;IP &gt;:&lt;port&gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"status"</span>: <span class="hljs-string">"ACTIVE"</span>,
    <span class="hljs-attr">"niddDownlinkDataTransfers"</span>: [<font></font>
    {<font></font>
        <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
        <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">"data"</span>: <span class="hljs-string">"MDEyMzQ1Njc4OTA="</span>,
        <span class="hljs-attr">"maximumLatency"</span>: <span class="hljs-number">96</span>,
        <span class="hljs-attr">"priority"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">"self"</span>: <span class="hljs-string">"/3gpp-nidd/v1/&lt;ScsAsID&gt;/configurations/&lt;ID &gt;/downlink-data-deliveries/1"</span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイマーの期限が切れた後、デバイスがまだ接続していない場合、SCEFはサーバー（AS）にタイマーの期限切れのためメッセージが配信されなかったことを通知し、メッセージは削除されます。</font></font><br>
<br>
<pre><code class="xml hljs">POST / HTTP/1.1<font></font>
OCSGHTTPProcessor: 14c8cab8-ecce-4868-a59e-1f784224518b<font></font>
X-callback-t8-type: 4<font></font>
X-callback-url: http://<span class="hljs-tag">&lt;<span class="hljs-name">IP</span> &gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><font></font>
X-api-network-service-node: 0<font></font>
Content-Type: application/json<font></font>
Content-Length: 139<font></font>
Host: <span class="hljs-tag">&lt;<span class="hljs-name">IP</span> &gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><font></font>
Connection: Keep-Alive<font></font>
User-Agent: Apache-HttpAsyncClient/4.1.3 (Java/1.8.0_181)<font></font>
<font></font>
{"niddDownlinkDataTransfer":"/3gpp-nidd/v1/<span class="hljs-tag">&lt;<span class="hljs-name">ScsAsID</span>&gt;</span>/configurations/<span class="hljs-tag">&lt;<span class="hljs-name">ID</span> &gt;</span>/downlink-data-deliveries/1","status":"FAILURE"}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
成功した場合、SCEFはすぐに応答します。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"status"</span>: <span class="hljs-string">"SUCCESS"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージがバッファリングされている場合に、メッセージに優先順位を付ける機能を追加できます。</font><font style="vertical-align: inherit;">「priority」パラメータによって調整されます。</font><font style="vertical-align: inherit;">新しいメッセージがデバイスに送信され、配信バッファーがSCEFによって超過された場合、メッセージは優先度の低いメッセージに置き換えられます。それ以外の場合、メッセージは配信のために受け入れられません。</font><font style="vertical-align: inherit;">バッファからメッセージを削除することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージを配信できず、バッファリングされている場合は、次のメッセージが表示されます。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"self"</span>: <span class="hljs-string">"/3gpp-nidd/v1/&lt;ScsAsID&gt;/configurations/&lt;ID &gt;/downlink-data-deliveries/2"</span>,
   <span class="hljs-attr">"status"</span>: <span class="hljs-string">"BUFFERING"</span>
}</code></pre><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重要！</font></font></b>
                        <div class="spoiler_text">  :<br>
/&lt;ID &gt;/downlink-data-deliveries/<b>1</b><br>
 –      SCEF.  ,    .         .</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージを受信すると、モジュールは次のURCを報告します。</font></font><br>
<br>
<pre><code class="plaintext hljs">+NIDD=4,0,11,0,"3031323334353637383930"</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HEXからASCIIへの変換でどれが私たちのメッセージになります：</font></font><br>
<br>
<pre><code class="plaintext hljs">1234567890</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのままにしておいてください。</font><font style="vertical-align: inherit;">「バッファリングされた」メッセージの配信の通知：</font></font><br>
<br>
<pre><code class="json hljs">{
<span class="hljs-attr">"niddDownlinkDataTransfer"</span>:<span class="hljs-string">"3gpp-nidd/v1/&lt;ScsAsID&gt;/configurations/&lt;ID &gt;/downlink-data-deliveries/1"</span>,
<span class="hljs-attr">"status"</span>:<span class="hljs-string">"SUCCESS"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デバイスステータスのステータスの監視は、「監視イベント（MONTE）」と呼ばれる別のSCEFサービスを通じて可能です。</font><font style="vertical-align: inherit;">MONTE内では、同様のサブスクリプションシステムを使用して、イベントと時間に関する通知（デバイスが使用可能になったときなど）を受信できます。</font><font style="vertical-align: inherit;">しかし、これについてはまた別の機会に話しましょう。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCEFから構成を取得する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEFから現在の構成を取得できることにお気づきでしょう。</font><font style="vertical-align: inherit;">そうしよう。</font><font style="vertical-align: inherit;">すでに気に入っているPostmanを取得し、GETメソッドを使用して次のリクエストを作成します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/i_/jp/j6/i_jpj6tfbbgoxt0u5sf6gl9obnk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それら。</font><font style="vertical-align: inherit;">メッセージの本文自体を空のままにし、アドレスバーで、応答として現在の状態を受信するために作成された構成のIDを指定するだけです。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">"&lt;ID &gt;"</span>,
    <span class="hljs-attr">"duration"</span>: <span class="hljs-string">"2020-12-31T23:59:59Z"</span>,
    <span class="hljs-attr">"notificationDestination"</span>: <span class="hljs-string">" http://&lt;IP &gt;:&lt;port&gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"status"</span>: <span class="hljs-string">"ACTIVE"</span>,
    <span class="hljs-attr">"niddDownlinkDataTransfers"</span>: []<font></font>
}</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCEFの構成の削除</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、最後-私たちが作成した構成を削除します。</font><font style="vertical-align: inherit;">これを行うには、現在の構成と同じアドレスバーを使用しますが、DELETEに変更します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/w_/bt/n5/w_btn5pki3qerymozmgnub-f4ug.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それに応じて、以下を受け取ります。</font></font><br>
<br>
<pre><code class="json hljs">{
    <span class="hljs-attr">"externalId"</span>: <span class="hljs-string">" &lt;ID &gt;"</span>,
    <span class="hljs-attr">"duration"</span>: <span class="hljs-string">"2020-12-31T23:59:59Z"</span>,
    <span class="hljs-attr">" notificationDestination"</span>: <span class="hljs-string">" http://&lt;IP &gt;:&lt;port&gt;"</span>,
    <span class="hljs-attr">"reliableDataService"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">"status"</span>: <span class="hljs-string">"TERMINATED"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「status」の行で、作成した構成が削除されていることがわかります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SCEFの使用については、複数の論文を書くことができます。このトピックは広範で、すぐにすべての分野の多くのM2Mデバイス、特にモノのインターネットに非常に関連するようになります。</font><font style="vertical-align: inherit;">私が伝えたかった主なことは、NIDDとSCEFをすぐに使い始めて、自分で理解できるようにする方法でした。</font><font style="vertical-align: inherit;">しかし、私もいつも喜んでお手伝いします：support@simcom.com（RUSチーム用にマークされています）。手紙には、連絡先の詳細とプロジェクトについてのいくつかの言葉を示す必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の記事では、セルラーモジュールでの作業の他の側面を注意深く分析し、どのトピックに関心があるかをコメントに書き込みます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンバージドソリューションとマルチメディアサービスの上級エキスパートであるSergey Novikovに特に感謝します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サノフ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）記事の作成における非常に貴重な支援のためのMTSから。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用したソース</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NB-IoT：それはどのように機能しますか？</font><font style="vertical-align: inherit;">パート3：SCEF-オペレーター</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ETSI TS 129 122の</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">サービスへの単一アクセスウィンドウ</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja489594/index.html">フレームワークとプラットフォーム：違いは何ですか？</a></li>
<li><a href="../ja489596/index.html">モバイル＃334開発者向けの興味深い資料のダイジェスト（2月17〜23日）</a></li>
<li><a href="../ja489600/index.html">GDC-2020：最大のゲーム開発展示会の1つに期待すること</a></li>
<li><a href="../ja489602/index.html">キャンバス2Dの事前レンダリング</a></li>
<li><a href="../ja489604/index.html">チームリーダーであるプロジェクトを評価するには</a></li>
<li><a href="../ja489610/index.html">新しい建物の完全なホームオートメーション</a></li>
<li><a href="../ja489612/index.html">DEFCON 27会議。アクセスが制限されたメカニカルキーの複製。パート2</a></li>
<li><a href="../ja489614/index.html">1Cでの靴の残りのマーキング。スキャンとHonest Signへのアップロードの問題を解決する</a></li>
<li><a href="../ja489618/index.html">そのようなフォーマットが必要ですか？..といくつかの統計</a></li>
<li><a href="../ja489620/index.html">Scott Hanselmanによる9つのWindowsターミナルのヒント</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>