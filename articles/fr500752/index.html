<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ö ‚ôªÔ∏è üßü MASK-RCNN pour trouver des toits √† partir d'images de drones üë©üèª‚Äçüöí üíã ü§ì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans une ville blanc-blanc sur une rue blanc-blanc il y avait des maisons blanches-blanches ... Et √† quelle vitesse pouvez-vous trouver tous les toits...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>MASK-RCNN pour trouver des toits √† partir d'images de drones</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/500752/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad9/eb5/21e/ad9eb521e7c2fcb232116aa876742ee3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans une ville blanc-blanc sur une rue blanc-blanc il y avait des maisons blanches-blanches ... Et √† quelle vitesse pouvez-vous trouver tous les toits des maisons sur cette photo? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus en plus, on peut entendre parler des plans du gouvernement de proc√©der √† un inventaire complet des biens immobiliers afin de clarifier les donn√©es cadastrales. Pour la solution principale √† ce probl√®me, une m√©thode simple peut √™tre appliqu√©e bas√©e sur le calcul de la surface du toit des b√¢timents d'immobilisations √† partir de photographies a√©riennes et une comparaison plus approfondie avec les donn√©es cadastrales. Malheureusement, la recherche et le calcul manuels prennent beaucoup de temps, et comme les nouvelles maisons sont d√©molies et construites en continu, le calcul doit √™tre r√©p√©t√© encore et encore. L'hypoth√®se se pose imm√©diatement que ce processus peut √™tre automatis√© √† l'aide d'algorithmes d'apprentissage automatique, en particulier, la vision par ordinateur. Dans cet article, je parlerai de notre situation √† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NORBIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r√©solu ce probl√®me et quelles difficult√©s ils ont rencontr√©es.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Spoiler - nous l'avons </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fait</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le service ML d√©velopp√© est bas√© sur un mod√®le d'apprentissage machine profond bas√© sur des r√©seaux de neurones √† convolution. </font><font style="vertical-align: inherit;">Le service accepte en entr√©e des images de v√©hicules a√©riens sans pilote; en sortie, il g√©n√®re un fichier GeoJSON avec le balisage des objets de construction en capital trouv√©s en r√©f√©rence aux coordonn√©es g√©ographiques. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, cela ressemble √† ceci:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ab/892/528/0ab892528db9a5c84fd26d0e30329b5a.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probl√®mes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commen√ßons par les probl√®mes techniques que nous avons rencontr√©s:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il existe une diff√©rence significative entre les photographies a√©riennes d'hiver et d'√©t√© (un mod√®le form√© uniquement aux photographies d'√©t√© est totalement incapable de trouver des toits en hiver);</font></font></li>
<li>            ,       ;</li>
<li>  ,          (  ),     (     )      ,           ;</li>
<li>   ,     ,         (     ).        ;</li>
<li>  (,   )     .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et les drones apportent parfois ces photos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/663/809/821/66380982148bc07c8309f8d106ecfc38.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voudrais √©galement noter les probl√®mes qui auraient pu √™tre, mais ils ne nous concernaient pas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous n'avons eu aucune t√¢che pour effectuer l'inf√©rence pendant un temps limit√© (par exemple, directement au moment du vol), ce qui a imm√©diatement r√©solu tous les probl√®mes de performances possibles;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† l'entr√©e pour le traitement, nous avons imm√©diatement re√ßu des images haute r√©solution de haute qualit√© (en utilisant des objectifs avec une focale de 21 mm √† une hauteur de 250 m, soit 5 cm / px) de notre client, la soci√©t√© Shakhty, pourrait utiliser leur expertise dans la g√©olocalisation des objets sur les cartes, et ils ont √©galement eu l'occasion d'√©tablir un ensemble sp√©cifique d'exigences pour les futurs vols d'UAV, ce qui a finalement consid√©rablement r√©duit la probabilit√© de carreaux tr√®s uniques qui n'√©taient pas dans l'ensemble de formation;</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re solution au probl√®me, l'AVC √† l'aide de la bo√Æte Boundary&nbsp;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelques mots sur les outils que nous avons utilis√©s pour cr√©er la solution.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anaconda est un syst√®me de gestion de paquets pratique pour Python et R.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tensorflow est une biblioth√®que de logiciels d'apprentissage automatique open source d√©velopp√©e par Google.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keras est un module compl√©mentaire pour les frameworks Deeplearning4j, TensorFlow et Theano.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenCV est une biblioth√®que d'algorithmes pour la vision par ordinateur, le traitement d'image et les algorithmes num√©riques open source √† usage g√©n√©ral.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flask est un framework pour cr√©er des applications web dans le langage de programmation Python.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme le syst√®me d'exploitation a utilis√© Ubuntu 18.04. </font><font style="vertical-align: inherit;">Avec les pilotes sur le GPU (NVIDIA) dans Ubuntu, tout est en ordre, donc la t√¢che est g√©n√©ralement r√©solue avec une seule commande:</font></font><br>
<br>
<code>&gt; sudo apt install nvidia-cuda-toolkit</code><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©paration des carreaux</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re t√¢che √† laquelle nous avons √©t√© confront√©s a √©t√© de diviser les images de survol en tuiles (2048x2048 px). </font><font style="vertical-align: inherit;">Vous pouvez √©crire votre propre script, mais vous devrez alors penser √† maintenir l'emplacement g√©ographique de chaque tuile. </font><font style="vertical-align: inherit;">Il √©tait plus facile d'utiliser une solution pr√™te √† l'emploi, par exemple, GeoServer - c'est un logiciel open source qui vous permet de publier des g√©odonn√©es sur le serveur. </font><font style="vertical-align: inherit;">De plus, GeoServer a r√©solu un autre probl√®me pour nous: l'affichage pratique du r√©sultat du marquage automatique sur la carte. </font><font style="vertical-align: inherit;">Cela peut √™tre fait localement, par exemple, dans qGIS, mais pour une commande et une d√©monstration distribu√©es, une ressource Web est plus pratique. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour effectuer le carrelage, vous devez sp√©cifier l'√©chelle et la taille requises dans les param√®tres.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/688/b29/4d1/688b294d129f14dddc810ca0defdef44.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les traductions entre les syst√®mes de coordonn√©es, nous avons utilis√© la biblioth√®que pyproj:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> pyproj <span class="hljs-keyword">import</span> Proj, transform<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Converter</span>:</span>
&nbsp;&nbsp;&nbsp;&nbsp;P3857 = Proj(init=<span class="hljs-string">'epsg:3857'</span>)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;P4326 = Proj(init=<span class="hljs-string">'epsg:4326'</span>)<font></font>
...<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_3857_to_GPS</span>(<span class="hljs-params">self, point</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x, y = point<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> transform(self.P3857, self.P4326, x, y)
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_GPS_to_3857</span>(<span class="hljs-params">self, point</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x, y = point<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> transform(self.P4326, self.P3857, x, y)<font></font>
...</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, il a √©t√© possible de former facilement une grande couche √† partir de tous les polygones et de la d√©poser sur le substrat.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b8/9f6/428/2b89f642889bdc551871a35ba43a7c03.png"></div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour installer le logiciel GeoServer, vous devez effectuer les √©tapes suivantes.</font></font></b>
                        <div class="spoiler_text"><ol>
<li> Java  8.</li>
<li> GeoServer.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a></li>
<li>     , ,&nbsp;<code>/usr/share/geoserver</code></li>
<li>      &nbsp;<br>
<br>
<strong><code>echo ¬´export GEOSERVER_HOME=/usr/share/geoserver¬ª &gt;&gt; ~/.profile</code></strong></li>
<li>   :<br>
<br>
<strong><code>sudo groupadd geoserver</code></strong></li>
<li> ,     ,   :<br>
<br>
<strong><code>sudo usermod -a -G geoserver &lt;user_name&gt;</code></strong></li>
<li> -  :<br>
<br>
<strong><code>sudo chown -R :geoserver /usr/share/geoserver/</code></strong></li>
<li>    :<br>
<br>
<strong><code>sudo chmod -R g+rwx /usr/share/geoserver/</code></strong></li>
<li> GeoServer&nbsp;<br>
<br>
<strong><code>cd geoserver/bin &amp;&amp; sh startup.sh</code></strong></li>
</ol></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GeoServer n'est pas la seule application qui nous permet de r√©soudre notre probl√®me. </font><font style="vertical-align: inherit;">Par exemple, vous pouvez envisager ArcGIS for Server, mais ce produit est propri√©taire, nous ne l'avons donc pas utilis√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, chaque tuile devait trouver tous les toits visibles. </font><font style="vertical-align: inherit;">La premi√®re approche pour r√©soudre le probl√®me a √©t√© d'utiliser la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©tection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">objet</font></a><font style="vertical-align: inherit;"> de l'ensemble mod√®les / recherche Tensorflow. </font><font style="vertical-align: inherit;">De cette fa√ßon, les classes sur les images peuvent √™tre trouv√©es et localis√©es avec une s√©lection rectangulaire (encadr√©).&nbsp;</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balisage des donn√©es de formation&nbsp;</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âvidemment, pour former le mod√®le, vous avez besoin d'un ensemble de donn√©es √©tiquet√©. Par une heureuse co√Øncidence, en plus de tourner autour, dans nos bacs, l'ensemble de donn√©es pour 50 000 toits a √©t√© pr√©serv√© du bon vieux temps, lorsque tous les ensembles de donn√©es pour la formation √©taient toujours dans le domaine public partout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La taille exacte de l'√©chantillon d'apprentissage n√©cessaire pour obtenir une pr√©cision acceptable du mod√®le est assez difficile √† pr√©voir √† l'avance. Il peut varier en fonction de la qualit√© des images, de leur degr√© de dissemblance entre elles et des conditions d'utilisation du mod√®le en production. Nous avons eu des cas o√π 200 pi√®ces √©taient suffisantes, et parfois 50 000 √©chantillons marqu√©s manquaient √©galement. En cas de p√©nurie d'images balis√©es, nous ajoutons g√©n√©ralement des m√©thodes d'augmentation: virages, reflets miroir, d√©grad√©s de couleurs, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe maintenant de nombreux services qui vous permettent de baliser des images - √† la fois avec du code open source pour l'installation sur votre ordinateur / serveur, et des solutions d'entreprise, y compris le travail d'√©valuateurs externes, par exemple Yandex.Toloka. </font><font style="vertical-align: inherit;">Dans ce projet, nous avons utilis√© l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">annotateur d'image VGG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le plus simple </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Alternativement, vous pouvez essayer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coco-annotator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">label-studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nous utilisons g√©n√©ralement ce dernier pour baliser le texte et les fichiers audio.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b1/46b/39c/5b146b39c6413ebde30c1a0a6f25421a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la formation sur le balisage de divers annotateurs, vous devez g√©n√©ralement effectuer un petit d√©calage de champs, un exemple pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VGG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afin de calculer correctement la surface de la toiture tomb√©e dans la zone d'allocation rectangulaire, il est n√©cessaire de respecter plusieurs conditions:</font></font><br>
<br>
<ul>
<li>     /     .          :</li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b0c/41a/80e/b0c41a80e0ae785794143da7b38dfbbf.png"></div><br>
<ul>
<li>,    ,      :</li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/092/1de/dcb/0921dedcbc4effc0430d11cd8dea8401.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour r√©soudre le deuxi√®me probl√®me, vous pouvez essayer de former un mod√®le s√©par√© qui d√©terminerait l'angle de rotation correct de la tuile pour le marquage, mais tout s'est av√©r√© un peu plus facile. </font><font style="vertical-align: inherit;">Les gens eux-m√™mes s'efforcent de r√©duire l'entropie, ils alignent donc toutes les structures artificielles les unes par rapport aux autres, en particulier avec les b√¢timents denses. </font><font style="vertical-align: inherit;">Si vous regardez d'en haut, alors dans une zone localis√©e, les cl√¥tures, les all√©es, les plantations, les serres, les tonnelles seront parall√®les ou perpendiculaires aux limites des toits. </font><font style="vertical-align: inherit;">Il ne reste plus qu'√† trouver toutes les lignes nettes et √† calculer l'angle d'inclinaison le plus courant par rapport √† la verticale. </font><font style="vertical-align: inherit;">Pour cela, OpenCV dispose d'un excellent outil HoughLinesP.&nbsp;</font></font><br>
<br>
<pre><code class="python hljs">...<font></font>
<font></font>
lines = cv2.HoughLinesP(edges, <span class="hljs-number">1</span>, np.pi/<span class="hljs-number">180</span>, <span class="hljs-number">50</span>, minLineLength=minLineLength, maxLineGap=<span class="hljs-number">5</span>)
<span class="hljs-keyword">if</span> lines <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;length = image.shape[<span class="hljs-number">0</span>]<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;angles = []<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> x1, y1, x2, y2 <span class="hljs-keyword">in</span> lines[<span class="hljs-number">0</span>]:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;angle = math.degrees(math.atan2(y2 ‚Äî y1, x2 - x1))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;angles.append(angle)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;parts_angles.append(angles)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;median_angle = np.median(angles)<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">#    &nbsp;</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, image.shape[<span class="hljs-number">0</span>]<span class="hljs-number">-1</span>, image.shape[<span class="hljs-number">0</span>] // count_crops):
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, image.shape[<span class="hljs-number">1</span>]<span class="hljs-number">-1</span>, image.shape[<span class="hljs-number">1</span>] // count_crops):<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get_line(image[x:x+image.shape[<span class="hljs-number">0</span>]//count_crops, y:y+image.shape[<span class="hljs-number">1</span>]//count_crops, :])<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">#      </span><font></font>
<font></font>
np.median([a <span class="hljs-keyword">if</span> a&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">90</span>+a <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> np.array(parts_angles).flatten()])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir trouv√© l'angle, nous faisons pivoter l'image en utilisant la transformation affine:</font></font><br>
<br>
<pre><code class="python hljs">
h, w = image.shape[:<span class="hljs-number">2</span>]<font></font>
image_center = (w/<span class="hljs-number">2</span>, h/<span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-keyword">if</span> size <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;radians = math.radians(angle)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;sin = math.sin(radians)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;cos = math.cos(radians)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;size = (int((h * abs(sin)) + (w * abs(cos))), int((h * abs(cos)) + (w * abs(sin))))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;rotation_matrix = cv2.getRotationMatrix2D(image_center, angle, <span class="hljs-number">1</span>)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;rotation_matrix[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>] += ((size[<span class="hljs-number">0</span>] / <span class="hljs-number">2</span>) ‚Äî image_center[<span class="hljs-number">0</span>])<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;rotation_matrix[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] += ((size[<span class="hljs-number">1</span>] / <span class="hljs-number">2</span>) ‚Äî image_center[<span class="hljs-number">1</span>])
<span class="hljs-keyword">else</span>:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;rotation_matrix = cv2.getRotationMatrix2D(image_center, angle, <span class="hljs-number">1</span>)<font></font>
<font></font>
cv2.warpAffine(image, rotation_matrix, size)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'exemple de code complet est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voici √† quoi √ßa ressemble:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b2/032/15c/2b203215c7a688dc7639e7993643a99e.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/594/423/c1b/594423c1b3e52a8e4fcd383b20a04b05.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√©thode de retournement des tuiles et de marquage avec des rectangles fonctionne plus rapidement que le marquage avec des masques, presque tous les toits sont trouv√©s, mais en production, cette m√©thode n'est utilis√©e que comme auxiliaire en raison de plusieurs inconv√©nients:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il y a beaucoup de survols o√π il y a un grand nombre de toits non rectangulaires, √† cause de cela il y a trop de travail manuel pour affiner la zone,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parfois trouv√© √† la maison avec des orientations diff√©rentes sur la m√™me tuile,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parfois il y a beaucoup de fausses lignes sur les tuiles, ce qui conduit finalement √† un mauvais virage. </font><font style="vertical-align: inherit;">Cela ressemble √† ceci:</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/ba0/30c/6d4ba030c0784c6ee7366486b3a8f03c.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/691/5fd/a10/6915fda10769dc9b5d96522737d6aef6.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La solution finale bas√©e sur Mask-RCNN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxi√®me tentative a consist√© √† rechercher et √† mettre en √©vidence les toits par masques pixel par pixel, puis √† d√©finir automatiquement les contours des masques trouv√©s et √† cr√©er des polygones vectoriels.&nbsp;&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe d√©j√† suffisamment de documents sur les principes de fonctionnement, les types et les t√¢ches des r√©seaux de neurones convolutifs, y compris ceux en russe, nous ne les aborderons donc pas dans cet article. Arr√™tons-nous sur une seule impl√©mentation sp√©cifique, Mask-RCNN - une architecture pour localiser et mettre en √©vidence les contours des objets dans les images. Il existe d'autres excellentes solutions avec leurs avantages et leurs inconv√©nients, par exemple UNet, mais il √©tait possible d'obtenir une meilleure qualit√© sur Mask-RCNN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au cours de son d√©veloppement, il est pass√© par plusieurs √©tapes. La premi√®re version de R-CNN a √©t√© d√©velopp√©e en 2014. Le principe de son travail est de mettre en √©vidence de petites zones de l'image, pour chacune desquelles est estim√©e la probabilit√© de pr√©sence d'un objet cible dans cette zone. R-CNN a fait un excellent travail avec la t√¢che, mais sa vitesse laissait beaucoup √† d√©sirer. Le d√©veloppement logique a √©t√© les r√©seaux Fast R-CNN et Faster R-CNN, qui ont re√ßu des am√©liorations dans l'algorithme d'exploration d'image, ce qui a permis d'augmenter consid√©rablement la vitesse. √Ä la sortie de Faster R-CNN, un marquage appara√Æt avec une s√©lection rectangulaire indiquant les limites de l'objet, ce qui n'est pas toujours suffisant pour r√©soudre le probl√®me.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le masque R-CNN ajoute √©galement une superposition de masque pixel par pixel pour obtenir le contour exact de l'objet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le cadre de d√©limitation et les masques sont clairement visibles sur le r√©sultat de l'op√©ration du mod√®le (le filtre par la surface minimale du b√¢timent est activ√©):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d6e/d0c/756/d6ed0c7567ed2894bbe11161fc91af55.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classiquement, le fonctionnement de ce r√©seau se d√©roule en 4 √©tapes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standard pour tous les r√©seaux de neurones convolutifs, l'allocation de caract√©ristiques dans l'image, telles que les lignes, les virages, les fronti√®res contrast√©es et autres;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le r√©seau de propositions de r√©gion (RPN) scanne de petits fragments de l'image, appel√©s ancres (ancres) et d√©termine si cette ancre contient des signes sp√©cifiques √† la classe cible (dans notre cas, le toit);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Classification des r√©gions d'int√©r√™t et cadre de d√©limitation. </font><font style="vertical-align: inherit;">√Ä ce stade, le r√©seau, sur la base des r√©sultats de l'√©tape pr√©c√©dente, tente de mettre en √©vidence de grandes zones rectangulaires dans la photographie, contenant vraisemblablement l'objet cible;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masques de segmentation. </font><font style="vertical-align: inherit;">A ce stade, le masque de l'objet souhait√© est obtenu √† partir de la zone rectangulaire obtenue en appliquant la bo√Æte fronti√®re.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, la configuration du r√©seau s'est av√©r√©e tr√®s flexible et nous avons pu le reconstruire pour traiter des images avec des couches d'informations suppl√©mentaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilisation d'images exclusivement RVB ne nous a pas permis d'obtenir la pr√©cision de reconnaissance n√©cessaire (le mod√®le a rat√© des b√¢timents entiers, il y avait une erreur moyenne de 15% dans le calcul de la surface du toit), nous avons donc fourni au mod√®le des donn√©es utiles suppl√©mentaires, par exemple, des cartes de hauteur obtenues par </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">photogramm√©trie.</font></font></a>&nbsp;<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cc/801/ac8/7cc801ac8060a3b99a2bb26415d2fe38.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesures utilis√©es pour √©valuer la qualit√© du mod√®le</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour d√©terminer la qualit√© des mod√®les, nous avons le plus souvent utilis√© la m√©trique Intersection over Union (IoU)</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8cc/486/5be/8cc4865be494cc0bee045c618df9ff59.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Exemple de code pour calculer l'IoU √† l'aide de la biblioth√®que geometry.shapely:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> shapely.geometry <span class="hljs-keyword">import</span> Polygon<font></font>
<font></font>
true_polygon = Polygon([(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>), (<span class="hljs-number">2</span>, <span class="hljs-number">6</span>), (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>), (<span class="hljs-number">5</span>, <span class="hljs-number">2</span>)])<font></font>
predicted_polygon = Polygon([(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">3</span>, <span class="hljs-number">7</span>), (<span class="hljs-number">6</span>, <span class="hljs-number">7</span>), (<span class="hljs-number">6</span>, <span class="hljs-number">3</span>)])<font></font>
print(true_polygon.intersection(predicted_polygon).area / true_polygon.union(predicted_polygon).area)<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">0.3333333333333333</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le suivi du processus de formation des mod√®les est facilement contr√¥l√© √† l'aide de Tensorboard, un outil de contr√¥le m√©trique pratique qui vous permet de recevoir des donn√©es en temps r√©el sur la qualit√© du mod√®le et de les comparer avec d'autres mod√®les.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31c/a7a/b20/31ca7ab20d4583360b3058b59277bc10.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tensorboard fournit des donn√©es sur de nombreuses mesures diff√©rentes. </font><font style="vertical-align: inherit;">Les plus int√©ressants pour nous sont:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">val_mrcnn_bbox_loss - montre √† quel point le mod√®le localise les objets (c.-√†-d. impose une bo√Æte fronti√®re);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">val_mrcnn_mask_loss - montre √† quel point le mod√®le segmente les objets (c'est-√†-dire impose un masque).</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formation et validation des mod√®les</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la formation, nous avons utilis√© la pratique standard de diviser au hasard un ensemble de donn√©es en 3 parties - formation, validation et test. Dans le processus d'apprentissage, la qualit√© du mod√®le est √©valu√©e sur un √©chantillon de validation et, √† la fin, r√©ussit le test final sur les donn√©es de test qui en ont √©t√© ferm√©es dans le processus d'apprentissage.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons fait nos premiers d√©marrages d'entra√Ænement sur une petite s√©rie de clich√©s d'√©t√© et, d√©cidant de v√©rifier la qualit√© de notre mod√®le en hiver, nous nous attendions √† un r√©sultat d√©cevant. </font><font style="vertical-align: inherit;">L'option d'utiliser diff√©rents mod√®les pour diff√©rentes saisons, bien s√ªr, est un excellent moyen de sortir de la situation, mais cela entra√Ænerait un certain nombre d'inconv√©nients, nous avons donc d√©cid√© d'essayer de rendre le mod√®le universel. </font><font style="vertical-align: inherit;">En exp√©rimentant diff√©rentes configurations des couches et en fermant √©galement le poids des couches individuelles des changements de poids, nous avons trouv√© la strat√©gie optimale pour entra√Æner le mod√®le en appliquant alternativement des images d'√©t√© et d'hiver √† l'entr√©e.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ation d'un service d'arri√®re-plan pour la reconnaissance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous avons un mod√®le fonctionnel, nous pouvons cr√©er un service d'API en arri√®re-plan √† partir d'un script de reconnaissance qui prend une image en entr√©e et g√©n√®re json avec des polygones de toit trouv√©s en sortie. </font><font style="vertical-align: inherit;">Cela n'affecte pas directement la solution du probl√®me, mais cela peut √™tre utile √† quelqu'un.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubuntu utilise systemd, et un exemple sera donn√© sp√©cifiquement pour ce syst√®me. </font><font style="vertical-align: inherit;">Le code du service lui-m√™me peut √™tre consult√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Les unit√©s utilisateur sont situ√©es dans le r√©pertoire / etc / systemd / system, o√π nous allons cr√©er notre fichier de service. </font><font style="vertical-align: inherit;">
Modifiez le fichier:</font></font><br>
<br>
<code>cd /etc/systemd/system<br>
<br>
sudo touch my_srv.service</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">sudo vim my_srv.service
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'unit√© systemd se compose de trois sections:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Unit√©] - d√©crit l'ordre et la condition du d√©marrage (par exemple, vous pouvez dire au processus d'attendre le d√©marrage d'un certain service et de le d√©marrer ensuite vous-m√™me);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Service] - d√©crit les param√®tres de d√©marrage;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Installer] - d√©crit le comportement du service lors de son ajout au d√©marrage.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, notre fichier ressemblera √† ceci:</font></font><br>
<br>
<pre><code class="bash hljs">[Unit]<font></font>
Description=my_test_unit<font></font>
<font></font>
[Service]<font></font>
WorkingDirectory=/home/user/test_project<font></font>
User=root<font></font>
ExecStart=/home/user/test_project/venv/bin/python3 /home/user/test_project/script.py<font></font>
<font></font>
[Install]<font></font>
WantedBy=multi-user.target<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rechargez maintenant la configuration systemd et ex√©cutez notre service:</font></font><br>
<br>
<pre><code class="bash hljs">sudo systemctl daemon-reload<font></font>
sudo systemctl start my_srv.service<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ceci est un exemple simple d'un processus d'arri√®re-plan, systemd prend en charge de nombreux param√®tres diff√©rents qui vous permettent de configurer de mani√®re flexible le comportement du service, mais rien de plus compliqu√© n'est requis pour notre t√¢che.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©sultats</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le principal r√©sultat du projet a √©t√© la capacit√© de d√©tecter automatiquement les incoh√©rences dans le d√©veloppement r√©el et les informations contenues dans les donn√©es cadastrales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la suite de l'√©valuation de la pr√©cision du mod√®le sur les donn√©es de test, les valeurs suivantes ont √©t√© obtenues: le nombre de toits trouv√©s - 91%, la pr√©cision des polygones de contour de toit - 94%. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il √©tait possible d'obtenir une qualit√© acceptable des mod√®les lors des vols d'√©t√© et d'hiver, mais la qualit√© de reconnaissance peut diminuer dans les images imm√©diatement apr√®s une chute de neige. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, m√™me l'op√©ra de Sydney ne se d√©robera pas aux yeux de notre mod√®le.&nbsp;</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/c1/yl/zsc1yl0dgkkhjahgjk3vssn8swc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous pr√©voyons de mettre ce service avec un mod√®le form√© sur notre demostand. </font><font style="vertical-align: inherit;">Si vous √™tes int√©ress√© √† essayer le service sur vos propres photos, envoyez vos candidatures √† ai@norbit.ru.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500728/index.html">Kubernetes: open source vs fournisseur</a></li>
<li><a href="../fr500732/index.html">L'intelligence artificielle et la crise des th√©ories de la conscience</a></li>
<li><a href="../fr500734/index.html"># GitLab 12.10 publi√© avec gestion des exigences et mise √† l'√©chelle automatique des CI sur AWS Fargate</a></li>
<li><a href="../fr500744/index.html">¬´Pour mieux entendre que toi, mon interlocuteur¬ª: comment mieux diffuser depuis chez soi</a></li>
<li><a href="../fr500746/index.html">Rack de boxe pour SMD et autres petites choses</a></li>
<li><a href="../fr500754/index.html">Comment devenir millionnaire en 30 ans, allong√© sur le canap√©</a></li>
<li><a href="../fr500756/index.html">All-Power √† distance. Comment fonctionne le streaming lors des conf√©rences en ligne du JUG Ru Group?</a></li>
<li><a href="../fr500758/index.html">Tendances cl√©s du march√© de la cybers√©curit√© et de la s√©curit√© de l'information 2020-2021 par rapport aux pr√©visions 2019-2020</a></li>
<li><a href="../fr500760/index.html">Comment tuer des zombies plus efficacement avec ZeroTier</a></li>
<li><a href="../fr500764/index.html">Dessiner un discours: Software Automatic Mouth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>