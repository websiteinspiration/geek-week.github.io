<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯМИ тП╕я╕П ЁЯЫМЁЯП┐ рдЬрд┐рдк рдлрд╛рдЗрд▓реЗрдВ: рдЗрддрд┐рд╣рд╛рд╕, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди ЁЯдШЁЯП╝ ЁЯЧСя╕П ЁЯЪ╕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рд╕реЛрдЪ рд░рд╣рд╛ рдерд╛ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рдХреИрд╕реЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рд╣реИред рдПрдХ рдмрд╛рд░ рдЬрдм рдореИрдВрдиреЗ рдЕрдкрдиреА рдЬрд┐рдЬреНрдЮрд╛рд╕рд╛ рдХреЛ рд╕рдВрддреБрд╖реНрдЯ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛: рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рдЬрд┐рдк рдлрд╛рдЗрд▓реЗрдВ: рдЗрддрд┐рд╣рд╛рд╕, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/490790/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/bo/tw/dr/botwdrbtegpbnpnwmy7id56fbaa.jpeg"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореИрдВ рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рд╕реЛрдЪ рд░рд╣рд╛ рдерд╛ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рдХреИрд╕реЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рд╣реИред рдПрдХ рдмрд╛рд░ рдЬрдм рдореИрдВрдиреЗ рдЕрдкрдиреА рдЬрд┐рдЬреНрдЮрд╛рд╕рд╛ рдХреЛ рд╕рдВрддреБрд╖реНрдЯ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛: рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕рдВрдкреАрдбрд╝рди рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдЬрд╝рд┐рдк рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рд┐рдЦреЗрдВред рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдПрдХ рд░реЛрдорд╛рдВрдЪрдХ рдЕрднреНрдпрд╛рд╕ рдмрди рдЧрдпрд╛ рд╣реИред рдЖрдкрдХреЛ рдбреАрдмрдЧ рдХреА рдЧрдИ рдорд╢реАрди рдмрдирд╛рдиреЗ рд╕реЗ рдмрд╣реБрдд рдЦреБрд╢реА рдорд┐рд▓рддреА рд╣реИ рдЬреЛ рдбреЗрдЯрд╛ рд▓реЗрддреА рд╣реИ, рдЕрдкрдиреЗ рдмрд┐рдЯреНрд╕ рдХреЛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреА рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдЗрдХрдЯреНрдард╛ рдХрд░рддреА рд╣реИред рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЖрдк рднреА рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝рдиреЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдкреА рд▓реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдЦ рдмрд╣реБрдд рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓реЗрдВ рдФрд░ рд╕рдВрдкреАрдбрд╝рди рдпреЛрдЬрдирд╛ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ: LZ77 рд╕рдВрдкреАрдбрд╝рди, рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо, рдбреАрдлрд╝реНрд▓реИрдЯ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдмрд╣реБрдд рдХреБрдЫред рдЖрдк рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рдЬрд╛рдиреЗрдВрдЧреЗ рдФрд░ рд╕реА рдореЗрдВ рдЦрд░реЛрдВрдЪ рд╕реЗ рд▓рд┐рдЦреЗ рдЧрдП рдкреНрд░рднрд╛рд╡реА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЗрдЦреЗрдВрдЧреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд╕реНрд░реЛрдд рдХреЛрдб рдпрд╣рд╛рдБ рд╣реИ: </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">hwzip-1.0.zip</font></a><font style="vertical-align: inherit;"> ред</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореИрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЖрднрд╛рд░реА рд╣реВрдБ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ange рдПрд▓реНрдмрд░реНрдЯрд┐рдиреА</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gynvael Coldwind</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреИрдмрд┐рдпрди Giesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЛрдирд╛рд╕ Skeppstedt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реЗрдм</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primiano Tucci</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдХреЛ рд╡реЗрдмрд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдбреНрд░рд╛рдлреНрдЯ рдкрд░ рдмрд╣реБрдореВрд▓реНрдп рд░рд╛рдп рджреЗ рджреА рд╣реИред</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рдордЧреНрд░реА</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╣рд╛рдиреА</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKZip</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдирдХрд╛рд░реА- zip рдФрд░ zlib</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinZip</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди (LZ77)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрдореИрди рдХреЛрдб</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рджрдо</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрдореИрди рдХреЗ рд╡рд┐рд╣рд┐рдд рдХреЛрдб</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреБрд╢рд▓ рд╣рдлрдореИрди рдбрд┐рдХреЛрдбрд┐рдВрдЧ</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╡рд╛ рдирд┐рдХрд╛рд▓рдирд╛</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯ рд╕реНрдЯреНрд░реАрдо</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдирдкреИрдХрд┐рдВрдЧ (рдореБрджреНрд░рд╛рд╕реНрдлреАрддрд┐)</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╕рдореНрдмрджреНрдз рдЦрдВрдб рдЦрдВрдб</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рдЦрдВрдбрд┐рдд рдХрд░реЗрдВ</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд╛рдпрдиреЗрдорд┐рдХ рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкреАрдбрд╝рди (рдЕрдкрд╕реНрдлреАрддрд┐)</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рд╕реНрд╡рд░реВрдк</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╡рд▓реЛрдХрди</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВ</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЕрдВрдд</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрдВрдЯреНрд░рд▓ рдлрд╝рд╛рдЗрд▓ рд╣реИрдбрд░</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдк рд░реАрдб рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдк рд░рд┐рдХреЙрд░реНрдб рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hwzip</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд╖реНрдХрд░реНрд╖</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрднреНрдпрд╛рд╕</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧреА рд╕рд╛рдордЧреНрд░реА</font></font></a></li>
</ul><br>
<a name="1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╣рд╛рдиреА</font></font></h2><br>
<a name="2"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKZip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрд╕реНрд╕реА рдФрд░ рд╢реБрд░реБрдЖрддреА рдирдмреНрдмреЗ рдХреЗ рджрд╢рдХ рдореЗрдВ, рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рд╡реНрдпрд╛рдкрдХ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдХрдВрдкреНрдпреВрдЯрд░ рдХреЗ рдЙрддреНрд╕рд╛рд╣реА рд▓реЛрдЧреЛрдВ рдиреЗ рдЯреЗрд▓реАрдлреЛрди рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмреБрд▓реЗрдЯрд┐рди рдмреЛрд░реНрдб рд╕рд┐рд╕реНрдЯрдо (рдмреАрдмреАрдПрд╕) рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд╛рдпрд▓-рдЕрдк рдореЛрдбреЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">BBS рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдХрдВрдкреНрдпреВрдЯрд░ рд╕рд┐рд╕реНрдЯрдо рдерд╛ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ, рдЧреЗрдо рдЦреЗрд▓рдиреЗ рдФрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдСрдирд▓рд╛рдЗрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрдВрдкреНрдпреВрдЯрд░, рдореЙрдбреЗрдо рдФрд░ рдПрдХ рдЕрдЪреНрдЫрд╛ BBS рдлрд╝реЛрди рдирдВрдмрд░ рд╣реЛрдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рдерд╛ред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдВрдкреНрдпреВрдЯрд░ рдкрддреНрд░рд┐рдХрд╛рдУрдВ рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдЕрдиреНрдп рдмреАрдмреАрдПрд╕ рдкрд░ </font><font style="vertical-align: inherit;">рдирдВрдмрд░ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдП рдЧрдП рдереЗ</font></a><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╡рд┐рддрд░рдг рдХреА рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЙрдкрдХрд░рдг </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдерд╛ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдкрдХреЛ рдПрдХрд▓ </font><i><font style="vertical-align: inherit;">рд╕рдВрдЧреНрд░рд╣ рдлрд╝рд╛рдЗрд▓</font></i><font style="vertical-align: inherit;"> рдореЗрдВ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рд╣реЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд░реВрдк рд╕реЗ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдпрд╛ рд╕реВрдЪрдирд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдФрд░ рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, рд╕рдВрдЧреНрд░рд╣ рднреА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╕рдВрдЪрд░рдг рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди рдФрд░ рд╕рдордп рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рддрд╛ рд╣реИред рдмреАрдмреАрдПрд╕ рдХреЗ рджрд┐рдиреЛрдВ рдореЗрдВ, рдЖрд░реНрдХ рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ рд▓реЛрдХрдкреНрд░рд┐рдп рдерд╛, рдЬрд┐рд╕реЗ рдЯреЙрдо рд╣рд┐рдВрдбрд░реНрд╕рди рдСрдл рд╕рд┐рд╕реНрдЯрдо рдПрдиреНрд╣рд╛рдВрд╕рдореЗрдВрдЯ рдПрд╕реЛрд╕рд┐рдПрдЯреНрд╕ (рдПрд╕рдИрдП) рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рдПрдХ рдЫреЛрдЯреА рд╕реА рдХрдВрдкрдиреА рдЬрд┐рд╕реЗ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЕрдкрдиреЗ рдмрд╣рдиреЛрдИ рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1980 рдХреЗ рджрд╢рдХ рдХреЗ рдЙрддреНрддрд░рд╛рд░реНрдз рдореЗрдВ, рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдлрд┐рд▓ рдХрд╛рдЯреНрдЬ рдиреЗ рдЖрд░реНрдХ, PKArc рдХрд╛ рдЕрдкрдирд╛ рд╕рдВрд╕реНрдХрд░рдг рдЬрд╛рд░реА рдХрд┐рдпрд╛ред рдпрд╣ рдПрд╕рдИрдП рдЖрд░реНрдХ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рдерд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдиреЗ рдЕрд╕реЗрдВрдмрд▓реА рднрд╛рд╖рд╛ рдореЗрдВ рд▓рд┐рдЦрд┐рдд рд╕рдмрд░реВрдЯреАрдиреНрд╕ рдХреЗ рд▓рд┐рдП рддреЗрдЬреА рд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛ рдФрд░ рдПрдХ рдирдИ рд╕рдВрдкреАрдбрд╝рди рд╡рд┐рдзрд┐ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ред рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реЛ рдЧрдпрд╛, рдХрд╛рдЯреНрдЬрд╝ рдиреЗ рдЕрдкрдиреА рдиреМрдХрд░реА рдЫреЛрдбрд╝ рджреА рдФрд░ рдкреАрдХреЗрд╡реЗрдпрд░ рдХреЛ рдЖрдЧреЗ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ред рдХрд┐рдВрд╡рджрдВрддреА рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЬреНрдпрд╛рджрд╛рддрд░ рдХрд╛рдо рд╡рд┐рд╕реНрдХреЙрдиреНрд╕рд┐рди рдХреЗ рдЧреНрд▓реЗрдирдбреЗрд▓ рдореЗрдВ рдЙрдирдХреА рдорд╛рдВ рдХреА рд░рд╕реЛрдИ рдореЗрдВ рд╣реБрдЖред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1e/50a/990/b1e50a990a86a05045dde9d2a819fbf0.jpg"></div><br>
<i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд┐рд▓реНрд╡реМрдХреА рдкреНрд░рд╣рд░реА рдХреЗ рдПрдХ рд▓реЗрдЦ рд╕реЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд┐рд▓ рдХрд╛рдЯреНрдЬ рджреНрд╡рд╛рд░рд╛ рдлреЛрдЯреЛ </font><font style="vertical-align: inherit;">, 19 рд╕рд┐рддрдВрдмрд░, 1994ред</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрд╕рдИрдП рдХрд╛рдЯреНрдЬ рдХреА рдкрд╣рд▓ рд╕реЗ рдЦреБрд╢ рдирд╣реАрдВ рдерд╛ред рдХрдВрдкрдиреА рдиреЗ рдЙрди рдкрд░ рдЯреНрд░реЗрдбрдорд╛рд░реНрдХ рдФрд░ рдХреЙрдкреАрд░рд╛рдЗрдЯ рдХреЗ рдЙрд▓реНрд▓рдВрдШрди рдХрд╛ рдЖрд░реЛрдк рд▓рдЧрд╛рдпрд╛ред рдмреАрдмреАрдПрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдкреАрд╕реА рдХреА рджреБрдирд┐рдпрд╛ рдореЗрдВ рдореБрдХрджрдореЗрдмрд╛рдЬреА рдФрд░ рд╡рд┐рд╡рд╛рдж рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд░реНрдХ рд╡реЙрд░реНрд╕ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЕрдВрдд рдореЗрдВ, </font><font style="vertical-align: inherit;">рдПрд╕рдИрдП рдХреЗ рдкрдХреНрд╖ рдореЗрдВ </font><font style="vertical-align: inherit;">рд╡рд┐рд╡рд╛рдж рдХрд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдкрдЯрд╛рд░рд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">рдЧрдпрд╛ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрд░реНрдХ рдХреЛ рддреНрдпрд╛рдЧрдХрд░, рдХрд╛рдЯреНрдЬрд╝ рдиреЗ 1989 рдореЗрдВ рдПрдХ рдирдпрд╛ рд╕рдВрдЧреНрд░рд╣ рдкреНрд░рд╛рд░реВрдк рддреИрдпрд╛рд░ рдХрд┐рдпрд╛, рдЬрд┐рд╕реЗ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЬрд╝рд┐рдк рдХрд╣рд╛ рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдирддрд╛ рдХреЗ рд▓рд┐рдП</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрд▓рдмреНрдз рдХрд░рд╛рдпрд╛ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<blockquote> ,   ,        ,      .  ,  ".ZIP",             ,      ,     ,          , , ,                  ,     ,      .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдРрд╕реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдЯрдЬрд╝ рдХреЗ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ PKZip рдХрд╣рд╛ рдЧрдпрд╛ рдФрд░ рдЬрд▓реНрдж рд╣реА рдпрд╣ BBS рдФрд░ PC рдХреА рджреБрдирд┐рдпрд╛ рдореЗрдВ рдлреИрд▓ рдЧрдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╝рд┐рдк рдкреНрд░рд╛рд░реВрдк рдХреА рд╕рдлрд▓рддрд╛ рдореЗрдВ рдпреЛрдЧрджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкрд╣рд▓реБрдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд░рд▓реЗрдЦрди PKZip, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдкреНрд▓реАрдХреЗрд╢рди рдиреЛрдЯ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рде рдЖрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рдкреНрд░рд╛рд░реВрдк рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдиреЗ рджреВрд╕рд░реЛрдВ рдХреЛ рдкреНрд░рд╛рд░реВрдк рд╕реАрдЦрдиреЗ рдФрд░ рдРрд╕реЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬреЛ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВ, рдпрд╛ рдЕрдиреНрдпрдерд╛ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╝рд┐рдк - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреБрдХрд╕рд╛рди рдХреЗ рдмрд┐рдирд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рд╕рдВрдкреАрдбрд╝рди рдкреНрд░рд╛рд░реВрдк </font><font style="vertical-align: inherit;">: рдбреЗрдЯрд╛ рдХреЛ рдЕрдирдкреИрдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╕рдВрдкреАрдбрд╝рди рд╕реЗ рдкрд╣рд▓реЗ рдЬреИрд╕рд╛ рд╣реЛрдЧрд╛ред рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдореЗрдВ рдЕрддрд┐рд░реЗрдХ рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдзрд┐рдХ рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣рд╛рдирд┐рдкреВрд░реНрдг </font><i><font style="vertical-align: inherit;">рд╕рдВрдкреАрдбрд╝рди</font></i><font style="vertical-align: inherit;"> рд╕реЗ рдЕрд▓рдЧ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ JPEG рдФрд░ MP3 рдЬреИрд╕реЗ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: рдЬрдм рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдЬреЛ рдорд╛рдирд╡ рдЖрдВрдЦ рдпрд╛ рдХрд╛рди рдХреЗ рд▓рд┐рдП рдХрдо рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддреА рд╣реИ, рдлреЗрдВрдХ рджреА рдЬрд╛рддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PKZip рдХреЛ рд╢реЗрдпрд░рд╡реЗрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: рдЗрд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдФрд░ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛, рд▓реЗрдХрд┐рди рд▓реЗрдЦрдХ рдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ "рд░рдЬрд┐рд╕реНрдЯрд░" рдХрд░рдиреЗ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">$ 47 рдХреЗ рд▓рд┐рдП, рдЖрдк рдореБрджреНрд░рд┐рдд рдирд┐рд░реНрджреЗрд╢, рдкреНрд░реАрдорд┐рдпрдо рд╕рдорд░реНрдерди рдФрд░ рдРрдк рдХрд╛ рдПрдХ рдмрдврд╝рд╛рдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/031/509/4fc/0315094fc6917b61db8f78b2f776ce13.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PKZip рдХреЗ рдкреНрд░рдореБрдЦ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ 2.04c рдерд╛, рдЬрд┐рд╕реЗ 28 рджрд┐рд╕рдВрдмрд░, 1992 рдХреЛ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдХреБрдЫ рд╣реА рд╕рдордп рдмрд╛рдж </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрд╕реНрдХрд░рдг 2.04g</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">)ред </font><font style="vertical-align: inherit;">рдЗрд╕рдореЗрдВ рдбрд┐рдлреЙрд▓реНрдЯ рдбрд┐рдлреНрд▓реЗрдЯ рдЕрд▓реНрдЧреЛрд░рд┐рджреНрдо рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рд╕рдВрд╕реНрдХрд░рдг рдиреЗ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рд▓реАрдЬ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдкрд┐рдд рд▓реЗрдЦ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдореЗрдВ рд╕рдВрдкреАрдбрд╝рди рдХреЗ рдЖрдЧреЗ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/58e/bd3/69b/58ebd369bf36c272d0c8c7c9515fc670.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрдм рд╕реЗ, рдХрдИ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓ рд╕реНрд╡рд░реВрдкреЛрдВ рдореЗрдВ рдЬрд╝рд┐рдк рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрд╛рд╡рд╛ рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ (.jar), рдПрдВрдбреНрд░реЙрдЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреИрдХреЗрдЬ (.apk), рдФрд░ Microsoft Office .docx рдлрд╛рдЗрд▓реЗрдВ рдЬрд╝рд┐рдк рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХрдИ рдкреНрд░рд╛рд░реВрдк рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдорд╛рди рд╕рдВрдкреАрдбрд╝рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдбреАрдлрд╝реНрд▓реИрдЯ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдХрд╣рддреЗ рд╣реИрдВ, рд╡реЗрдм рдкреЗрдЬ рд╢рд╛рдпрдж рдЖрдкрдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдПрдХ gzip рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ Deflate рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд▓ рдХрд╛рдЯреНрдЬ рдХрд╛ рдирд┐рдзрди 2000 рдореЗрдВ рд╣реБрдЖ рдерд╛ред </font><font style="vertical-align: inherit;">PKWare рдЕрднреА рднреА рдореМрдЬреВрдж рд╣реИ рдФрд░ рдЬрд╝рд┐рдк рдкреНрд░рд╛рд░реВрдк рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХрдВрдкрдиреА рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдбреЗрдЯрд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреА рд╣реИред</font></font><br>
<br>
<a name="3"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╛рдирдХрд╛рд░реА- zip рдФрд░ zlib</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1989 рдореЗрдВ PKZip рдХреА рд░рд┐рд▓реАрдЬрд╝ рдХреЗ рдХреБрдЫ рд╕рдордп рдмрд╛рдж, рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдирдкреИрдХ рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рдХрд╛рд░реНрдпрдХреНрд░рдо рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд▓рдЧреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдирдЬрд╝рд┐рдк</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдЧреНрд░рд╛рдо </font><font style="vertical-align: inherit;">рдЬреЛ рдпреВрдирд┐рдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЕрдирдкреИрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдорд╛рд░реНрдЪ 1990 рдореЗрдВ, Info-ZIP рдирд╛рдордХ рдПрдХ рдореЗрд▓рд┐рдВрдЧ рд╕реВрдЪреА рдмрдирд╛рдИ рдЧрдИ рдереАред </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">Info-ZIP</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд╕рдореВрд╣ </font><font style="vertical-align: inherit;">рдиреЗ рдореБрдлреНрдд рдУрдкрди рд╕реЛрд░реНрд╕ рдкреНрд░реЛрдЧреНрд░рд╛рдо </font><i><font style="vertical-align: inherit;">рдЕрдирдЬрд╝рд┐рдк</font></i><font style="vertical-align: inherit;"> рдФрд░ </font><i><font style="vertical-align: inherit;">рдЬрд╝рд┐рдк</font></i><font style="vertical-align: inherit;"> рдЬрд╛рд░реА рдХрд┐рдП рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдирдкреИрдХ рдХрд░рдиреЗ рдФрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдХреЛрдб рдХреЛ рдХрдИ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдореЗрдВ рдкреЛрд░реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдЕрднреА рднреА рдпреВрдирд┐рдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЬрд┐рдк рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рд╣реИред рдЗрд╕рдиреЗ рдмрд╛рдж рдореЗрдВ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдмрдврд╝рд╛рдиреЗ рдореЗрдВ рдорджрдж рдХреАред </font><font style="vertical-align: inherit;">
рдПрдХ рдмрд╛рд░ рд╕реВрдЪрдирд╛-рдЬрд╝рд┐рдк рдХреЛрдб рдЬрд┐рд╕рдиреЗ рдЕрдкрд╕реНрдлреАрддрд┐ рдФрд░ рдЕрдкрдШрдЯрди рдХреЛ рдЕрдкрд╡рд┐рддреНрд░ рдХрд┐рдпрд╛, рдПрдХ рдЕрд▓рдЧ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдЬрд╝реНрд▓рд┐рдм</font></a><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рд▓реЗ рдЬрд╛рдпрд╛ рдЧрдпрд╛ </font><font style="vertical-align: inherit;">рдЬреЛ рдЙрдиреНрд╣реЛрдВрдиреЗ рд▓рд┐рдЦрд╛ рдерд╛</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреАрди-рд▓реВрдк рдЧреЗрд▓реНрд▓реА</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рд╕рдВрдкреАрдбрд╝рди) рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рд░реНрдХ рдПрдбрд▓рд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдЕрдирдкреИрдХрд┐рдВрдЧ)ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/68b/216/d1d/68b216d1debaffdb2d890067e38bed47.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2009 рдХреЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USENIX STUG рдЕрд╡рд╛рд░реНрдб рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреАрди- </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рд▓рд╛рдЙрдк рдЧреЗрд▓реНрд▓реА</font></a><font style="vertical-align: inherit;"> (рдмрд╛рдПрдВ) рдФрд░ рдорд╛рд░реНрдХ рдПрдбрд▓рд░ (рджрд╛рдПрдВ) </font><font style="vertical-align: inherit;">ред</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рдкреБрд╕реНрддрдХрд╛рд▓рдп рдмрдирд╛рдиреЗ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рдерд╛ рдХрд┐ рдпрд╣ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдФрд░ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рдбреАрдлрд╝реНрд▓реИрдЯ рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рдерд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирдП </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gzip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PNG рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдЗрди рдирдП рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдВрдкреНрд░реЗрд╢рди</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреАрдЖрдИрдПрдл</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдмрджрд▓рдирд╛ рдерд╛ </font><font style="vertical-align: inherit;">, рдЬреЛ рдкреЗрдЯреЗрдВрдЯ-рд╕рдВрд░рдХреНрд╖рд┐рдд рдПрд▓рдЬреЗрдбрдбрдмреНрд▓реНрдпреВ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрди рд╕реНрд╡рд░реВрдкреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рдПрдХ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдкреАрдЯрд░ рдбрд┐рдлреНрд▓реЗрдЯ рдиреЗ рдбрд┐рдлрд▓реЗрдЯ рд╕реНрдкреЗрд╕рд┐рдлрд┐рдХреЗрд╢рди рд▓рд┐рдЦрд╛ рдФрд░ рдЗрд╕реЗ </font><font style="vertical-align: inherit;">рдордИ 1996 рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдВрдЯрд░рдиреЗрдЯ рдЖрд░рдПрдлрд╕реА 1951</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдирд╛рдо рд╕реЗ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдореВрд▓ PKZip рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдиреЛрдЯ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╕реБрд▓рдн рд╡рд┐рд╡рд░рдг рдирд┐рдХрд▓рд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЬ рдЬрд╝рд╛рд▓рд┐рдм рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣рд░ рдЬрдЧрд╣ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╢рд╛рдпрдж рд╡рд╣ рдЕрдм рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рдПрдХ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рдиреЗ рдФрд░ рдЖрдкрдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЕрдирдкреИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдЬ, рдЕрдзрд┐рдХрд╛рдВрд╢ рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓реЗрдВ zlib рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рдФрд░ рд╡рд┐рдШрдЯрд┐рдд рд╣реИрдВред</font></font><br>
<br>
<a name="4"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinZip</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреЛ рд▓реЛрдЧ PKZip рдирд╣реАрдВ рдЦреЛрдЬ рдкрд╛рдП рдЙрдирдореЗрдВ рд╕реЗ рдХрдИ рдиреЗ WinZip рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред рдкреАрд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдбреЙрд╕ рд╕реЗ рд╡рд┐рдВрдбреЛрдЬ рддрдХ, рдФрд░ рдкреАрдХреЗрдЬрд┐рдк рд╕реЗ рд╡рд┐рдирдЬрд┐рдк рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╕рдм рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдирд┐рдХреЛ рдореИрдХ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реБрдЖ, рдЬрд┐рд╕рдиреЗ рдХрдиреЗрдХреНрдЯрд░реНрд╕-рдореИрдирдлреАрд▓реНрдб, рдХрдиреЗрдХреНрдЯрд┐рдХрдЯ рдореЗрдВ рдореИрдиреНрд╕рдлреАрд▓реНрдб рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЧреНрд░реБрдк рдореЗрдВ рдУрдПрд╕ / 2 рдХреЗ рд▓рд┐рдП рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдмрдирд╛рдпрд╛ред Nico рдиреЗ рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рдореИрдиреЗрдЬрд░ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛, рдпрд╣ OS / 2 рдореЗрдВ рдПрдХ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдпреВрдЬрд░ рдЗрдВрдЯрд░рдлреЗрд╕ рд╣реИ, рдФрд░ рд╡рд╣ рдЗрд╕ рдмрд╛рдд рд╕реЗ рдкрд░реЗрд╢рд╛рди рдерд╛ рдХрд┐ рдЙрд╕реЗ рд╣рд░ рдмрд╛рд░ рдЬрдм рд╡рд╣ рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛, рддреЛ рдЙрд╕реЗ рдПрдХ рдлрд╛рдЗрд▓ рдореИрдиреЗрдЬрд░ рд╕реЗ DOS рдХрдорд╛рдВрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореИрдХ рдиреЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг GUI рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓рд┐рдЦрд╛, рдЬреЛ рд╕реАрдзреЗ рдЬрд┐рдк рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░реЗрдЬреЗрдВрдЯреЗрд╢рди рдореИрдиреЗрдЬрд░ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рдерд╛, рдЗрд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMZip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдо рджрд┐рдпрд╛ </font><font style="vertical-align: inherit;">рдФрд░ рдЗрд╕реЗ 1990 рдХреЗ рджрд╢рдХ рдореЗрдВ рд╢реЗрдпрд░рд╡реЗрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рд░реА рдХрд┐рдпрд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдУрдПрд╕ / 2 рд╕рдлрд▓ рдирд╣реАрдВ рд╣реБрдЖ, рдФрд░ рдкреАрд╕реА рджреБрдирд┐рдпрд╛ рдиреЗ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд▓рд┐рдпрд╛ред </font><font style="vertical-align: inherit;">1991 рдореЗрдВ, рдореИрдХ рдиреЗ рд╡рд┐рдВрдбреЛрдЬ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓рд┐рдЦрдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╕реАрдЦрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рдФрд░ рдЙрд╕рдХрд╛ рдкрд╣рд▓рд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЕрдкрдиреЗ рдЬрд╝рд┐рдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рдирдП рдУрдПрд╕ рдореЗрдВ рдкреЛрд░реНрдЯ рдХрд░рдирд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЕрдкреНрд░реИрд▓ 1991 рдореЗрдВ, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinZip 1.00 рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ 21-рджрд┐рд╡рд╕реАрдп рдкрд░реАрдХреНрд╖рдг рдЕрд╡рдзрд┐ рдФрд░ $ 29 рдХреЗ рдкрдВрдЬреАрдХрд░рдг рд╢реБрд▓реНрдХ рдХреЗ рд╕рд╛рде рд╢реЗрдпрд░рд╡реЗрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рд╡рд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреА:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b1/2f4/bcd/0b12f4bcd048691aa0487b9d3a445b39.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WinZip рдХреЗ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, PKZip рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реБрдб рдХреЗ рддрд╣рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди 1993 рдореЗрдВ рд╕рдВрд╕реНрдХрд░рдг 5.0 рд╕реЗ, рдЬрд╝рд┐рдк-рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдкреНрд░рддреНрдпрдХреНрд╖ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП Info-ZIP рдХреЗ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд▓рдЧрд╛ред </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рднреА рдзреАрд░реЗ-рдзреАрд░реЗ рд╡рд┐рдХрд╕рд┐рдд рд╣реБрдЖ рд╣реИред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf4/273/962/bf427396212f63fba9c80db12fdd2132.png"></div><br>
<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinZip 6.3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛рд░реНрдпрд╕рдореВрд╣реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдВрдбреЛрдЬ 3.11 рдХреЗ рддрд╣рддред </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WinZip 1990 рдХреЗ рджрд╢рдХ рдореЗрдВ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рд╢реЗрдпрд░рд╡реЗрдпрд░ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдерд╛ред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЕрдВрдд рдореЗрдВ, рдпрд╣ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХрддрд╛ рдЦреЛ рдЧрдпрд╛ред </font><font style="vertical-align: inherit;">рд╡рд┐рдВрдбреЛрдЬ рдЙрдирдХреЗ рд╕рд╛рде 2001 (рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕рдкреА) рдХреЗ рд░реВрдк рдореЗрдВ "рд╕рдВрдХреБрдЪрд┐рдд рдлрд╝реЛрд▓реНрдбрд░" рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DynaZip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореИрдХ рдХреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдирд┐рдХреЛ рдореИрдХ рдХрдореНрдкреНрдпреВрдЯрд┐рдВрдЧ рдХрд╣рд╛ рдЬрд╛рддрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">2000 рдореЗрдВ, рдЗрд╕рдХрд╛ рдирд╛рдо рдмрджрд▓рдХрд░ WinZip рдХрдореНрдкреНрдпреВрдЯрд┐рдВрдЧ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛, рдФрд░ рдЙрди рд╡рд░реНрд╖реЛрдВ рдХреЗ рджреМрд░рд╛рди рдореИрдХ рдиреЗ рдЗрд╕реЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ред </font><font style="vertical-align: inherit;">2005 рдореЗрдВ,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡реЗрдХреНрдЯрд░ рдХреИрдкрд┐рдЯрд▓ рдиреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрдВрдкрдиреА рдХреЛ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"> рдмреЗрдЪ рджрд┐рдпрд╛</font></a><font style="vertical-align: inherit;"> , рдФрд░ рдЕрдВрдд рдореЗрдВ, рдпрд╣</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Corel рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рдмрди рдЧрдпрд╛</font><font style="vertical-align: inherit;">, рдЬреЛ рдЕрднреА рднреА WinZip рдХреЛ рдПрдХ рдЙрддреНрдкрд╛рдж рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред</font></font><br>
<br>
<a name="5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди (LZ77)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╝рд┐рдк рд╕рдВрдкреАрдбрд╝рди рдореЗрдВ рджреЛ рдореБрдЦреНрдп рддрддреНрд╡ рд╣реЛрддреЗ рд╣реИрдВ: рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди рдФрд░ рд╣рдлрд╝рдореИрди рдХреЛрдбред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╛рда рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдкрд╛рда рдХреЗ рднреАрддрд░ рдЗрди рд╢рдмреНрджреЛрдВ рдХреА рдХрд┐рд╕реНрдореЛрдВ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреЗ рд╕рд╛рде рдЖрдо рд╢рдмреНрджреЛрдВ рдпрд╛ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдмрдирд╛рдИ рдЬрд╛рдП, рдЬрд┐рд╕рдореЗрдВ рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рд▓рд┐рдВрдХ рд╣реЛрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реНрд░реЛрдд рдкрд╛рда рдореЗрдВ рд▓рдВрдмреЗ рд╢рдмреНрдж "рд╕рдВрдкреАрдбрд╝рди" рдХреЛ # 1234 рдХреЗ рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ 1234 рд╕реВрдЪреА рдореЗрдВ рд╢рдмреНрдж рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдХреНрд╢рдирд░реА рдХрдореНрдкреНрд░реЗрд╢рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд╕рдВрдкреАрдбрд╝рди рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рдЗрд╕ рдкрджреНрдзрддрд┐ рдореЗрдВ рдХрдИ рдХрдорд┐рдпрд╛рдВ рд╣реИрдВред рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреНрдпрд╛ рдорд┐рд▓рдирд╛ рдЪрд╛рд╣рд┐рдП? рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рд╡рд┐рднрд┐рдиреНрди рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдорд╛рдирд╡-рдкрдардиреАрдп рдкрд╛рда рднреА рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдФрд░ рдЕрдЧрд░ рд╢рдмреНрджрдХреЛрд╢ рдХреЛ рд╕рдВрдкреАрдбрд╝рди рдФрд░ рд╡рд┐рдШрдЯрди рдХреЗ рдмреАрдЪ рдЕрдЧреНрд░рд┐рдо рдореЗрдВ рд╕рд╣рдорддрд┐ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЗрд╕реЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣реАрдд рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рд╕рдВрдкреАрдбрд╝рди рдХреЗ рд▓рд╛рдн рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдПрдХ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╕рдорд╛рдзрд╛рди рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЛ рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдореЗрдВ </font><font style="vertical-align: inherit;">1977, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЕрдиреБрдХреНрд░рдорд┐рдХ рдбреЗрдЯрд╛ рд╕рдВрдкреАрдбрд╝рди рдХреЗ рд▓рд┐рдП</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдпрд╛рдХреВрдм рдЬреАрд╡ рдФрд░ рдЕрдмреНрд░рд╛рд╣рдо рд▓реЗрдореНрдкреЗрд▓ (рдЬреЛ рдЯреЗрдХреНрдирд┐рдпреЙрди рдореЗрдВ рдХрд╛рдо рдХрд┐рдпрд╛), рдЬрд┐рд╕рдореЗрдВ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рддреНрд░рд┐рдХ рдХреЗ рдПрдХ рджреГрд╢реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдПрдХ рд╕рдВрдкреАрдбрд╝рди рдпреЛрдЬрдирд╛ рдХрд╛ рдкреНрд░рд╕реНрддрд╛рд╡ рд░рдЦрд╛:</font></font><br>
<br>
<pre><code class="cpp hljs">(, , )
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╣рд╛рдБ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реЗ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрдгреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд┐рдЫрдбрд╝реА рд╣реБрдИ рдХрдбрд╝реА рдмрдирд╛рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рдореВрд▓ рдкрд╛рда рдореЗрдВ рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдХреЙрдкреА рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдФрд░ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдЙрддреНрдкрдиреНрди рдбреЗрдЯрд╛ рдореЗрдВ рдЕрдЧрд▓рд╛ рд╡рд░реНрдг рд╣реИред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e5/21e/fdb/5e521efdb5649015f685e26ab308d1b9.jpg"></div><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ce/cfa/2e3/2cecfa2e39798ce3302ff4b48e1a62ef.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдмреНрд░рд╛рд╣рдо рд▓реЗрдореНрдкреЗрд▓ рдФрд░ рдЬреИрдХрдм рдЬрд╝рд┐рд╡ред </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐рдпреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
it was the worst of times,<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреВрд╕рд░реА рдкрдВрдХреНрддрд┐ рдореЗрдВ, рдЕрдиреБрдХреНрд░рдо "t the w рдерд╛" рдХреЛ (26, 10, w) рдХреЗ рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ 26 рд╡рд░реНрдгреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ 10 рд╡рд░реНрдгреЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдХрд░ рдЕрдХреНрд╖рд░ "w" рдореЗрдВ рдкреБрди: рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрди рдкрд╛рддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЕрднреА рддрдХ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рд╣реБрдП рд╣реИрдВ, рд╢реВрдиреНрдп-рд▓рдВрдмрд╛рдИ рд╡рд╛рд▓реЗ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреНрд░рд╛рд░рдВрднрд┐рдХ "I" рдХреЛ (0, 0, I) рдХреЗ рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдпреЛрдЬрдирд╛ рдХреЛ рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди, рдпрд╛ LZ77 рд╕рдВрдкреАрдбрд╝рди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреЗ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ, рдЯреНрд░рд┐рдкрд▓реЗрдЯ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╡рд░реНрдг рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ ( </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">рдЬреЛрдбрд╝реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">(рдпрд╣ рд╡рд┐рдХрд▓реНрдк </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LZSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрдкреАрдбрд╝рди рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">)ред </font><font style="vertical-align: inherit;">рд╢рд╛рдмреНрджрд┐рдХ рдФрд░ рдмреИрдХрд▓рд┐рдВрдХ </font><font style="vertical-align: inherit;">рдХреИрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдиреНрдХреЛрдбреЗрдб рд╣реИрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдореБрджреНрджрд╛ рд╣реИ, рд╣рдо рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рдиреАрдЪреЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдж рдбрд┐рдлреНрд▓реЗрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд▓рд┐рдЦрд╛рд╡рдЯ:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
it was the worst of times,<font></font>
it was the age of wisdom,<font></font>
it was the age of foolishness,<font></font>
it was the epoch of belief,<font></font>
it was the epoch of incredulity,<font></font>
it was the season of Light,<font></font>
it was the season of Darkness,<font></font>
it was the spring of hope,<font></font>
it was the winter of despair,<font></font>
we had everything before us,<font></font>
we had nothing before us,<font></font>
we were all going direct to Heaven,<font></font>
we were all going direct the other way<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдЗрд╕рдореЗрдВ рд╕реЗрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">It was the best of times,<font></font>
i(<span class="hljs-number">26</span>,<span class="hljs-number">10</span>)wor(<span class="hljs-number">27</span>,<span class="hljs-number">24</span>)age(<span class="hljs-number">25</span>,<span class="hljs-number">4</span>)wisdom(<span class="hljs-number">26</span>,<span class="hljs-number">20</span>)<font></font>
foolishnes(<span class="hljs-number">57</span>,<span class="hljs-number">14</span>)epoch(<span class="hljs-number">33</span>,<span class="hljs-number">4</span>)belief(<span class="hljs-number">28</span>,<span class="hljs-number">22</span>)incredulity<font></font>
(<span class="hljs-number">33</span>,<span class="hljs-number">13</span>)season(<span class="hljs-number">34</span>,<span class="hljs-number">4</span>)Light(<span class="hljs-number">28</span>,<span class="hljs-number">23</span>)Dark(<span class="hljs-number">120</span>,<span class="hljs-number">17</span>)<font></font>
spring(<span class="hljs-number">31</span>,<span class="hljs-number">4</span>)hope(<span class="hljs-number">231</span>,<span class="hljs-number">14</span>)inter(<span class="hljs-number">27</span>,<span class="hljs-number">4</span>)despair,
<span class="hljs-function">we had <span class="hljs-title">everyth</span><span class="hljs-params">(<span class="hljs-number">57</span>,<span class="hljs-number">4</span>)</span>before <span class="hljs-title">us</span><span class="hljs-params">(<span class="hljs-number">29</span>,<span class="hljs-number">9</span>)</span><span class="hljs-title">no</span><span class="hljs-params">(<span class="hljs-number">26</span>,<span class="hljs-number">20</span>)</span>
<span class="hljs-title">we</span><span class="hljs-params">(<span class="hljs-number">12</span>,<span class="hljs-number">3</span>)</span>all <span class="hljs-title">go</span><span class="hljs-params">(<span class="hljs-number">29</span>,<span class="hljs-number">4</span>)</span>direct to <span class="hljs-title">Heaven</span>
<span class="hljs-params">(<span class="hljs-number">36</span>,<span class="hljs-number">28</span>)</span><span class="hljs-params">(<span class="hljs-number">139</span>,<span class="hljs-number">3</span>)</span><span class="hljs-params">(<span class="hljs-number">83</span>,<span class="hljs-number">3</span>)</span><span class="hljs-params">(<span class="hljs-number">138</span>,<span class="hljs-number">3</span>)</span>way
</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЧреБрдг рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдУрд╡рд░рд▓реИрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд▓рдВрдмрд╛рдИ рджреВрд░реА рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:</font></font><br>
<br>
<pre><code class="cpp hljs">Fa-la-la-la-la
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">Fa-la(<span class="hljs-number">3</span>,<span class="hljs-number">9</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЖрдкрдХреЛ рдЕрдЬреАрдм рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд┐рдзрд┐ рдХрд╛рдо рдХрд░рддреА рд╣реИ: рдкрд╣рд▓реЗ рддреАрди "-рдмреА" рдХреЗ рдмрд╛рдЗрдЯреНрд╕ рдХреЙрдкреА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдирдП рдЙрддреНрдкрдиреНрди рдмрд╛рдЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЬрд╛рд░реА рд░рд╣рддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рд▓рдВрдмрд╛рдИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдПрдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдХреЛрдбрд┐рдВрдЧ рд╣реИ</font></a><font style="vertical-align: inherit;"> , рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХреЗ рднрд╛рдЧ рдХреЛ рдмрд╛рд░-рдмрд╛рд░ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЧреАрдд рдХреЗ рд▓рд┐рдП Lempel-Ziv рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЗрдВрдЯрд░реЗрдХреНрдЯрд┐рд╡ рдЙрджрд╛рд╣рд░рдг рдХреЙрд▓рд┐рди рдореЙрд░рд┐рд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдкреЙрдк рд▓рд┐рд░рд┐рдХреНрд╕ рдЕрдзрд┐рдХ рджреЛрд╣рд░рд╛рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ? </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реА рдореЗрдВ рдмреИрдХрд▓рд┐рдВрдХ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рдВрднрд╡ рдУрд╡рд░рд▓реИрдк рдХреЗ рдХрд╛рд░рдг, рд╣рдо рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╛ </font></font><code>memmove</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output the (dist,len) backref at dst_pos in dst. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lz77_output_backref</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos,
                                       <span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        assert(dist &lt;= dst_pos &amp;&amp; <span class="hljs-string">"cannot reference before beginning of dst"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++) {<font></font>
                dst[dst_pos] = dst[dst_pos - dist];<font></font>
                dst_pos++;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢рд╛рдмреНрджрд┐рдХ рд╕реГрдЬрди рдЖрд╕рд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдкреВрд░реНрдгрддрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдПрдХ рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output lit at dst_pos in dst. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lz77_output_lit</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos, <span class="hljs-keyword">uint8_t</span> lit)</span>
</span>{<font></font>
        dst[dst_pos] = lit;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдХреЙрд▓рд░ рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ </font></font><code>dst</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрддреНрдкрдиреНрди рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЬрдЧрд╣ рд╣реИ рдФрд░ рдмрдлрд░ рдХреЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдмреИрдХрд▓рд┐рдВрдХ рд╕реНрдерд┐рддрд┐ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдирдкреИрдХрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рдкрд╣рд▓реЗ рдмрдирд╛рдирд╛ рд╣реИред рдпрд╣ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо zlib рд╕реЗ рд╣реИрд╢ рдЯреЗрдмрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдХрд┐ RFC 1951 рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рддреАрди-рд╡рд░реНрдг рдЙрдкрд╕рд░реНрдЧреЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реИрд╢ рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдкрд╣рд▓реЗ рд▓рд╛рдЗрди рдореЗрдВ рдкрд╛рдП рдЧрдП рдереЗ (рдЫреЛрдЯреЗ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреЛрдИ рд▓рд╛рдн рдирд╣реАрдВ рд▓рд╛рддреЗ рд╣реИрдВ)ред Deflate рдкрд┐рдЫрд▓реЗ 32,768 рд╡рд░реНрдгреЛрдВ рдХреЗ рднреАрддрд░ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ - рдЗрд╕реЗ </font><i><font style="vertical-align: inherit;">рд╡рд┐рдВрдбреЛ</font></i><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдпрд╣ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╕рдВрдкреАрдбрд╝рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ: рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдмрд╛рд░ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдмрд╢рд░реНрддреЗ рдХрд┐ рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдХреЗ рд╕рд╛рде рд╡рд┐рдВрдбреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛред рд╣рд╛рд▓рд╛рдБрдХрд┐, рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ рдФрд░ рд╣рдо рдЗрд╕реЗ рдПрдХ рд╕рдордп рдореЗрдВ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЖрдкрдХреЛ рд▓реЗрдЦрд╛рдВрдХрди рдХреЗ рдмрдЬрд╛рдп рд╕рдВрдкреАрдбрд╝рди рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдЯреНрд░реАрдо рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рджреЛ рд╕рд░рдгрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ: </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдирдкреБрдЯ рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рддреАрди-рд╡рд░реНрдг рдЙрдкрд╕рд░реНрдЧ рдХрд╛ рд╣реИрд╢ рдорд╛рди рд╢рд╛рдорд┐рд▓ рд╣реИ, рдФрд░ </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд╣реИрд╢ рдорд╛рди рдХреЗ рд╕рд╛рде рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рдХреА рд╕реНрдерд┐рддрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, </font></font><code>head[h]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдПрдХ рд╣реИрд╢ рдХреЗ рд╕рд╛рде рдЙрдкрд╕рд░реНрдЧ рдкрджреЛрдВ рдХреА рдПрдХ рд▓рд┐рдВрдХ рдХреА рдЧрдИ рд╕реВрдЪреА рдХрд╛ рд╢реАрд░реНрд╖рдХ рд╣реИ </font></font><code>h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ </font><font style="vertical-align: inherit;">рд╕реВрдЪреА рд╕реЗ </font></font><code>prev[x]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ </font></font><code>x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ </font><font style="vertical-align: inherit;">рддрддреНрд╡ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LZ_WND_SIZE 32768</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LZ_MAX_LEN  258</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HASH_SIZE 15</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NO_POS    SIZE_MAX</span><font></font>
<font></font>
<span class="hljs-comment">/* Perform LZ77 compression on the len bytes in src. Returns false as soon as
   either of the callback functions returns false, otherwise returns true when
   all bytes have been processed. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">lz77_compress</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> len,
                   <span class="hljs-keyword">bool</span> (*lit_callback)(<span class="hljs-keyword">uint8_t</span> lit, <span class="hljs-keyword">void</span> *aux),
                   <span class="hljs-keyword">bool</span> (*backref_callback)(<span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">void</span> *aux),
                   <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">size_t</span> head[<span class="hljs-number">1U</span> &lt;&lt; HASH_SIZE];
        <span class="hljs-keyword">size_t</span> prev[LZ_WND_SIZE];<font></font>
<font></font>
        <span class="hljs-keyword">uint16_t</span> h;
        <span class="hljs-keyword">size_t</span> i, j, dist;
        <span class="hljs-keyword">size_t</span> match_len, match_pos;
        <span class="hljs-keyword">size_t</span> prev_match_len, prev_match_pos;<font></font>
<font></font>
        <span class="hljs-comment">/* Initialize the hash table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(head) / <span class="hljs-keyword">sizeof</span>(head[<span class="hljs-number">0</span>]); i++) {<font></font>
                head[i] = NO_POS;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реИрд╢ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдирдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реНрдерд┐рддрд┐ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЗрд╕реЗ рдкрд┐рдЫрд▓реЗ рдПрдХ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert_hash</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> hash, <span class="hljs-keyword">size_t</span> pos, <span class="hljs-keyword">size_t</span> *head, <span class="hljs-keyword">size_t</span> *prev)</span>
</span>{<font></font>
        prev[pos % LZ_WND_SIZE] = head[hash];<font></font>
        head[hash] = pos;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рдЕрдиреБрдХреНрд░рдордг рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдореЛрдбреБрд▓реЛ рдСрдкрд░реЗрд╢рди рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ </font></font><code>prev</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: рд╣рдо рдХреЗрд╡рд▓ рдЙрди рдкрджреЛрдВ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд░реНрддрдорд╛рди рд╡рд┐рдВрдбреЛ рдореЗрдВ рдЖрддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦрд░реЛрдВрдЪ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рддреАрди-рд╡рд░реНрдг рдЙрдкрд╕рд░реНрдЧ рдХреЗ рд▓рд┐рдП рд╣реИрд╢ рдорд╛рди рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдПрдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рдВрдЧ рд╣реИрд╢ рдХрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕реЗ рд▓рдЧрд╛рддрд╛рд░ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВрдЧреЗ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдо рддреАрди рдЕрдХреНрд╖рд░ рдЗрд╕рдХреЗ рдореВрд▓реНрдп рдореЗрдВ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint16_t</span> <span class="hljs-title">update_hash</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> hash, <span class="hljs-keyword">uint8_t</span> c)</span>
</span>{<font></font>
        hash &lt;&lt;= <span class="hljs-number">5</span>;                     <span class="hljs-comment">/* Shift out old bits. */</span>
        hash ^= c;                      <span class="hljs-comment">/* Include new bits. */</span>
        hash &amp;= (<span class="hljs-number">1U</span> &lt;&lt; HASH_SIZE) - <span class="hljs-number">1</span>;  <span class="hljs-comment">/* Mask off excess bits. */</span><font></font>
<font></font>
        <span class="hljs-keyword">return</span> hash;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реИрд╢ рдореИрдк рдХреЛ рддрдм рдПрдХ рдХреНрд░рдо рдХреЗ рд╕рд╛рде рдкрд┐рдЫрд▓реЗ рдореИрдЪреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдЦреЛрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдореИрдЪреЛрдВ рдХреА рдЦреЛрдЬ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрд╕рд╛рдзрди-рдЧрд╣рди рд╕рдВрдкреАрдбрд╝рди рдСрдкрд░реЗрд╢рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕реВрдЪреА рдореЗрдВ рдЦреЛрдЬ рдХреА рдЧрд╣рд░рд╛рдИ рдХреЛ рд╕реАрдорд┐рдд рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рднрд┐рдиреНрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдмрджрд▓рдирд╛, рдЬреИрд╕реЗ рдЙрдкрд╕рд░реНрдЧреЛрдВ рдХреА рд╕реВрдЪреА рдкрд░ рдЦреЛрдЬ рдХреА рдЧрд╣рд░рд╛рдИ рдФрд░ рдиреАрдЪреЗ рд╡рд░реНрдгрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдЖрд▓рд╕реА рддреБрд▓рдирд╛ рдХрд░рдирд╛, рд╕рдВрдкреАрдбрд╝рди рдХреА рдбрд┐рдЧреНрд░реА рдХреЛ рдХрдо рдХрд░рдХреЗ рдЧрддрд┐ рдмрдврд╝рд╛рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдХреЛрдб рдореЗрдВ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ zlib рдореЗрдВ рдЕрдзрд┐рдХрддрдо рд╕рдВрдкреАрдбрд╝рди рд╕реНрддрд░ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЧрдпрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Find the longest most recent string which matches the string starting
 * at src[pos]. The match must be strictly longer than prev_match_len and
 * shorter or equal to max_match_len. Returns the length of the match if found
 * and stores the match position in *match_pos, otherwise returns zero. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">find_match</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> pos, <span class="hljs-keyword">uint16_t</span> hash,
                         <span class="hljs-keyword">size_t</span> prev_match_len, <span class="hljs-keyword">size_t</span> max_match_len,
                         <span class="hljs-keyword">const</span> <span class="hljs-keyword">size_t</span> *head, <span class="hljs-keyword">const</span> <span class="hljs-keyword">size_t</span> *prev,
                         <span class="hljs-keyword">size_t</span> *match_pos)</span>
</span>{
        <span class="hljs-keyword">size_t</span> max_match_steps = <span class="hljs-number">4096</span>;
        <span class="hljs-keyword">size_t</span> i, l;
        <span class="hljs-keyword">bool</span> found;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">/* We want backrefs of length 3 or longer. */</span>
                prev_match_len = <span class="hljs-number">2</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len &gt;= max_match_len) {
                <span class="hljs-comment">/* A longer match would be too long. */</span>
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (prev_match_len &gt;= <span class="hljs-number">32</span>) {
                <span class="hljs-comment">/* Do not try too hard if there is already a good match. */</span>
                max_match_steps /= <span class="hljs-number">4</span>;<font></font>
        }<font></font>
<font></font>
        found = <span class="hljs-literal">false</span>;<font></font>
        i = head[hash];<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (max_match_steps != <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (i == NO_POS) {
                        <span class="hljs-comment">/* No match. */</span>
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                assert(i &lt; pos &amp;&amp; <span class="hljs-string">"Matches should precede pos."</span>);
                <span class="hljs-keyword">if</span> (pos - i &gt; LZ_WND_SIZE) {
                        <span class="hljs-comment">/* The match is outside the window. */</span>
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                l = cmp(src, i, pos, prev_match_len, max_match_len);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l != <span class="hljs-number">0</span>) {<font></font>
                        assert(l &gt; prev_match_len);<font></font>
                        assert(l &lt;= max_match_len);<font></font>
<font></font>
                        found = <span class="hljs-literal">true</span>;<font></font>
                        *match_pos = i;<font></font>
                        prev_match_len = l;<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (l == max_match_len) {
                                <span class="hljs-comment">/* A longer match is not possible. */</span>
                                <span class="hljs-keyword">return</span> l;<font></font>
                        }<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Look further back in the prefix list. */</span><font></font>
                i = prev[i % LZ_WND_SIZE];<font></font>
                max_match_steps--;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!found) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> prev_match_len;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Compare the substrings starting at src[i] and src[j], and return the length
 * of the common prefix. The match must be strictly longer than prev_match_len
 * and shorter or equal to max_match_len. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> i, <span class="hljs-keyword">size_t</span> j,
                  <span class="hljs-keyword">size_t</span> prev_match_len, <span class="hljs-keyword">size_t</span> max_match_len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> l;<font></font>
<font></font>
        assert(prev_match_len &lt; max_match_len);<font></font>
<font></font>
        <span class="hljs-comment">/* Check whether the first prev_match_len + 1 characters match. Do this
         * backwards for a higher chance of finding a mismatch quickly. */</span>
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">0</span>; l &lt; prev_match_len + <span class="hljs-number">1</span>; l++) {
                <span class="hljs-keyword">if</span> (src[i + prev_match_len - l] !=<font></font>
                    src[j + prev_match_len - l]) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        assert(l == prev_match_len + <span class="hljs-number">1</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* Now check how long the full match is. */</span>
        <span class="hljs-keyword">for</span> (; l &lt; max_match_len; l++) {
                <span class="hljs-keyword">if</span> (src[i + l] != src[j + l]) {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        assert(l &gt; prev_match_len);<font></font>
        assert(l &lt;= max_match_len);<font></font>
        assert(<span class="hljs-built_in">memcmp</span>(&amp;src[i], &amp;src[j], l) == <span class="hljs-number">0</span>);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> l;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк </font></font><code>lz77_compress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд┐рдЫрд▓реЗ рдореИрдЪреЛрдВ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХреЛрдб рдХреЗ </font><font style="vertical-align: inherit;">рд╕рд╛рде рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* h is the hash of the three-byte prefix starting at position i. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (len &gt;= <span class="hljs-number">2</span>) {<font></font>
                h = update_hash(h, src[<span class="hljs-number">0</span>]);<font></font>
                h = update_hash(h, src[<span class="hljs-number">1</span>]);<font></font>
        }<font></font>
<font></font>
        prev_match_len = <span class="hljs-number">0</span>;<font></font>
        prev_match_pos = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i + <span class="hljs-number">2</span> &lt; len; i++) {<font></font>
                h = update_hash(h, src[i + <span class="hljs-number">2</span>]);<font></font>
<font></font>
                <span class="hljs-comment">/* Search for a match using the hash table. */</span><font></font>
                match_len = find_match(src, i, h, prev_match_len,<font></font>
                                       min(LZ_MAX_LEN, len - i), head, prev,<font></font>
                                       &amp;match_pos);<font></font>
<font></font>
                <span class="hljs-comment">/* Insert the current hash for future searches. */</span><font></font>
                insert_hash(h, i, head, prev);<font></font>
<font></font>
                <span class="hljs-comment">/* If the previous match is at least as good as the current. */</span>
                <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span> &amp;&amp; prev_match_len &gt;= match_len) {
                        <span class="hljs-comment">/* Output the previous match. */</span>
                        dist = (i - <span class="hljs-number">1</span>) - prev_match_pos;
                        <span class="hljs-keyword">if</span> (!backref_callback(dist, prev_match_len, aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-comment">/* Move past the match. */</span>
                        <span class="hljs-keyword">for</span> (j = i + <span class="hljs-number">1</span>; j &lt; min((i - <span class="hljs-number">1</span>) + prev_match_len,<font></font>
                                                len - <span class="hljs-number">2</span>); j++) {<font></font>
                                h = update_hash(h, src[j + <span class="hljs-number">2</span>]);<font></font>
                                insert_hash(h, j, head, prev);<font></font>
                        }<font></font>
                        i = (i - <span class="hljs-number">1</span>) + prev_match_len - <span class="hljs-number">1</span>;<font></font>
                        prev_match_len = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* If no match (and no previous match), output literal. */</span>
                <span class="hljs-keyword">if</span> (match_len == <span class="hljs-number">0</span>) {<font></font>
                        assert(prev_match_len == <span class="hljs-number">0</span>);
                        <span class="hljs-keyword">if</span> (!lit_callback(src[i], aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Otherwise the current match is better than the previous. */</span><font></font>
<font></font>
                <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Output a literal instead of the previous match. */</span>
                        <span class="hljs-keyword">if</span> (!lit_callback(src[i - <span class="hljs-number">1</span>], aux)) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Defer this match and see if the next is even better. */</span><font></font>
                prev_match_len = match_len;<font></font>
                prev_match_pos = match_pos;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Output any previous match. */</span>
        <span class="hljs-keyword">if</span> (prev_match_len != <span class="hljs-number">0</span>) {<font></font>
                dist = (i - <span class="hljs-number">1</span>) - prev_match_pos;
                <span class="hljs-keyword">if</span> (!backref_callback(dist, prev_match_len, aux)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                i = (i - <span class="hljs-number">1</span>) + prev_match_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Output any remaining literals. */</span>
        <span class="hljs-keyword">for</span> (; i &lt; len; i++) {
                <span class="hljs-keyword">if</span> (!lit_callback(src[i], aux)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХреЛрдб рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рдмреИрдХрд▓рд┐рдВрдХ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдХрд╛рд░реНрдпрдХреНрд░рдо рдпрд╣ рддрдп рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЕрдЧрд▓реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдорд┐рд▓рд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЬрд╝рд╛рд▓рд┐рдм рдореЗрдВ, рдЗрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд▓рд╕реА рддреБрд▓рдирд╛рддреНрдордХ рдореВрд▓реНрдпрд╛рдВрдХрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдЕрднреА рднреА рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд╛рд▓рдЪреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣реИ: рдпрд╣ рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдореИрдЪ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рд╡рд░реНрддрдорд╛рди рдЫреЛрдЯрд╛ рд╡рд╛рд▓рд╛ рдЖрдкрдХреЛ рдмрд╛рдж рдореЗрдВ рдПрдХ рдореИрдЪ рднреА рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдордЬрдмреВрдд рд╕рдВрдкреАрдбрд╝рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди рддреЗрдЬреА рдФрд░ рдзреАрдореА рдЧрддрд┐ рд╕реЗ рджреЛрдиреЛрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zopfli</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрдкреАрдбрд╝рди рдкреНрд░рддрд┐рд╢рдд рдХреЛ рдирд┐рдЪреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╖реНрдЯрддрдо рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рдмрд┐рддрд╛рдпрд╛ред рдпрд╣ рдЙрди рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬреЛ рдПрдХ рдмрд╛рд░ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдкреБрди: рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рд╕реНрдерд┐рд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдПред рдкреИрдорд╛рдиреЗ рдХреЗ рджреВрд╕рд░реА рдУрд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рд░реВрдк рдХрдореНрдкреНрд░реЗрд╕рд░ рд╣реИрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЗрдЬрд╝</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LZ4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ рдкрд┐рдЫрд▓реЗ 4 рдмрд╛рдЗрдЯ рдЙрдкрд╕рд░реНрдЧ рдХреЗ рд╕рд╛рде рд╣реА рддреБрд▓рдирд╛ рдореЗрдВ рдФрд░ рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдХрдореНрдкреНрд░реЗрд╢рди рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ RPC рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХрд┐рд╕реА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдпрд╛ рдбрд┐рд╕реНрдХ рдкрд░ рдбреЗрдЯрд╛ рднреЗрдЬрддреЗ рд╕рдордп рдХрдореНрдкреНрд░реЗрд╢рди рдкрд░ рдЦрд░реНрдЪ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдХреА рдмрдЪрдд рд╣реЛрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдмрд╣реБрдд рд╣реА рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдПрдХ рд╕реНрдерд┐рд░ рд╢рдмреНрджрдХреЛрд╢ рд╕реЗ рднреА рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреНрд░реЗрдЯрд▓реА</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ LZ77 рдЖрдзрд╛рд░рд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рдмрдбрд╝реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░рддрд╛ рд╣реИ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рд╕реНрдерд┐рд░ рд╢рдмреНрджрдХреЛрд╢</font></a><font style="vertical-align: inherit;"> , рдЬреЛ рдЕрдХреНрд╕рд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LZ77 рдХреЛрдб рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lz77.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lz77.c </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдореЗрдВ</font></a><font style="vertical-align: inherit;"> рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<a name="6"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрдореИрди рдХреЛрдб</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рджреВрд╕рд░рд╛ рдЬрд╝рд┐рдк рд╕рдВрдкреАрдбрд╝рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣рдлрд╝рдореИрди рдХреЛрдб рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢рдмреНрдж </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдб</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд┐рд╕реА рдЕрдиреНрдп рд░реВрдк рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рд╕рдВрджрд░реНрдн рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдЙрд╕ рдХреЛрдб рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдЬреЛ рдХрд┐ рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╢рд╛рдмреНрджрд┐рдХ рдФрд░ рдмреИрдХрд▓рд┐рдВрдХ рдХрд╛ рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ, рдЕрдВрдЧреНрд░реЗрдЬреА рдкрд╛рда рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдореЗрд░рд┐рдХрди рд╕реНрдЯреИрдВрдбрд░реНрдб рдХреЛрдб рдлреЙрд░ рдЗрдВрдлреЙрд░реНрдореЗрд╢рди рдЗрдВрдЯрд░рдЪреЗрдВрдЬ (ASCII)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдкреНрд░рдгрд╛рд▓реА рдкреНрд░рддреНрдпреЗрдХ рд╡рд░реНрдг рдХреЛ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕реЗ рдЖрдорддреМрд░ рдкрд░ 8-рдмрд┐рдЯ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдЕрдВрдЧреНрд░реЗрдЬреА рд╡рд░реНрдгрдорд╛рд▓рд╛ рдХреЗ рдмрдбрд╝реЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рд▓рд┐рдП ASCII рдХреЛрдб рд╣реИрдВ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01000001</font></font></td>
<td><strong>N</strong></td>
<td>01001110</td>
</tr>
<tr>
<td><strong>B</strong></td>
<td>01000010</td>
<td><strong>O</strong></td>
<td>01001111</td>
</tr>
<tr>
<td><strong>C</strong></td>
<td>01000011</td>
<td><strong>P</strong></td>
<td>01010000</td>
</tr>
<tr>
<td><strong>D</strong></td>
<td>01000100</td>
<td><strong>Q</strong></td>
<td>01010001</td>
</tr>
<tr>
<td><strong>E</strong></td>
<td>01000101</td>
<td><strong>R</strong></td>
<td>01010010</td>
</tr>
<tr>
<td><strong>F</strong></td>
<td>01000110</td>
<td><strong>S</strong></td>
<td>01010011</td>
</tr>
<tr>
<td><strong>G</strong></td>
<td>01000111</td>
<td><strong>T</strong></td>
<td>01010100</td>
</tr>
<tr>
<td><strong>H</strong></td>
<td>01001000</td>
<td><strong>U</strong></td>
<td>01010101</td>
</tr>
<tr>
<td><strong>I</strong></td>
<td>01001001</td>
<td><strong>V</strong></td>
<td>01010110</td>
</tr>
<tr>
<td><strong>J</strong></td>
<td>01001010</td>
<td><strong>W</strong></td>
<td>01010111</td>
</tr>
<tr>
<td><strong>K</strong></td>
<td>01001011</td>
<td><strong>X</strong></td>
<td>01011000</td>
</tr>
<tr>
<td><strong>L</strong></td>
<td>01001100</td>
<td><strong>Y</strong></td>
<td>01011001</td>
</tr>
<tr>
<td><strong>M</strong></td>
<td>01001101</td>
<td><strong>Z</strong></td>
<td>01011010</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдмрд╛рдЗрдЯ рдкреНрд░рддрд┐ рд╡рд░реНрдг рдкрд╛рда рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рддрд░реАрдХрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдкрд╛рда рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╣рдореЗрд╢рд╛ рд╕реНрдкрд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдПрди рд╡рд░реНрдгреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ рдмрд╛рдЗрдЯреНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдпрд╛ рдПрди рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рдХрд┐рддрдиреЗ рд╡рд░реНрдг рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдмреНрдЬреЗ рд╡рд╛рд▓реА рдЬрдЧрд╣ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдпрд╣ рд╕рдмрд╕реЗ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ, E рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ Z рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдмрд╕реЗ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рд╡реЙрд▓реНрдпреВрдо рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╡рд░реНрдг рдХреЛ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдмрд┐рдЯреНрд╕ рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдИ рдХреЗ рд▓рд┐рдП рдХрдо рдмрд┐рдЯ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдФрд░ рдЬреЗрдб рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдХреЛрдб рдЬреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдВрдмрд╛рдИ рдХреЗ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрд░реЛрдд рд╡рд░реНрдгреЛрдВ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЪрд░-рд▓рдВрдмрд╛рдИ рдХреЛрдб</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ </font><i><font style="vertical-align: inherit;">рд╣реИ</font></i><font style="vertical-align: inherit;"> ред рд╕рдмрд╕реЗ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджрд╛рд╣рд░рдг </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЛрд░реНрд╕ рдХреЛрдб рд╣реИред</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рд┐рддреНрд░ рдХреЛ рдбреЙрдЯреНрд╕ рдФрд░ рдбреИрд╢ рдХреЗ рд╕рд╛рде рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдореВрд▓ рд░реВрдк рд╕реЗ рдЫреЛрдЯреА рдФрд░ рд▓рдВрдмреА рджрд╛рд▓реЛрдВ рдХреЗ рд╕рд╛рде рдЯреЗрд▓реАрдЧреНрд░рд╛рдл рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрди</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв тАв</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв тАв тАв тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЗ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв - тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв - тАв</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрдпреВ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - тАв -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд░</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв тАв</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдл</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв - тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрд╕</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв тАв</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдЪ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв тАв тАв тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпреВ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореИрдВ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реА</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв тАв -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЗ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв - - -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрдмреНрд▓реНрдпреВ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХреНрд╕</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв тАв -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрд▓</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">тАв тАв тАв тАв</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- тАв - -</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдо</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- -</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЗрдб</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- - тАв тАв</font></font></strong></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЛрд░реНрд╕ рдХреЛрдб рдХреА рдХрдорд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рдХреЛрдбрд╡рд░реНрдб рджреВрд╕рд░реЗ рдХрд╛ рдЙрдкрд╕рд░реНрдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, тАв тАв - тАв рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдирд╣реАрдВ рд╣реИ: рдпрд╣ рдПрдл рдпрд╛ рдИрдЖрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдВрдЪрд░рдг рдХреЗ рджреМрд░рд╛рди рдкрддреНрд░реЛрдВ рдХреЗ рдмреАрдЪ рдард╣рд░рд╛рд╡ (рд▓рдВрдмрд╛рдИ рдореЗрдВ рддреАрди рдбреЙрдЯреНрд╕) рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ рдпрджрд┐ рдХреЛрдбрд╡рд░реНрдб рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдХреЗ рдЙрдкрд╕рд░реНрдЧ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдХреЛрдб рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдирд░рд┐рдлрд╛рдЗрдВрдб</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд▓рдВрдмрд╛рдИ рдХрд╛ ASCII рдХреЛрдб рдЕрдкреНрд░рдпреБрдХреНрдд рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреЛрдбрд╡рд░реНрдб рд╣рдореЗрд╢рд╛ рдПрдХ рд╣реА рд▓рдВрдмрд╛рдИ рдХреЗ рд╣реЛрддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдкрд░рд┐рд╡рд░реНрддрдиреАрдп рд▓рдВрдмрд╛рдИ рдХреЛрдб рднреА рдЕрдкреНрд░рдХрд╛рд╢рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдлрд╝реЛрди рдирдВрдмрд░ рдЕрдХреНрд╕рд░ рдЕрдкреНрд░рдпреБрдХреНрдд рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╕реНрд╡реАрдбрди рдореЗрдВ рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдЯреЗрд▓реАрдлреЛрди рдирдВрдмрд░ 112 рдкреЗрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛, 112 рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдирдВрдмрд░реЛрдВ рдХреЛ рдмрджрд▓рдирд╛ рдкрдбрд╝рд╛ред рдФрд░ рдпреВрдПрд╕рдП рдореЗрдВ 911 рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рднреА рдЯреЗрд▓реАрдлреЛрди рдирдВрдмрд░ рдирд╣реАрдВ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдиреНрдХреЛрдб рдХрд┐рдП рдЧрдП рд╕рдВрджреЗрд╢ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдХреНрд╕рд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдореЗрдВ рдЫреЛрдЯреЗ рдХреЛрдбрд╡рд░реНрдб рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╖реНрдЯрддрдо рдХреЛрдб рд╡рд╣ рд╣реЛрдЧрд╛ рдЬреЛ рд╕рдмрд╕реЗ рдХрдо рд╕рдВрднрд╡ рдкрд░рд┐рдгрд╛рдо рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ - рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдХрд╛ рдпреЛрдЧ, рдЙрдирдХреА рдШрдЯрдирд╛ рдХреА рдЖрд╡реГрддреНрддрд┐ рд╕реЗ рдЧреБрдгрд╛, рдиреНрдпреВрдирддрдо рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ </font><font style="vertical-align: inherit;">рддрд░рд╣ рдХреЗ рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреБрд╢рд▓ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рдЖрд╡рд┐рд╖реНрдХрд╛рд░рдХ рдХреЗ рд╕рдореНрдорд╛рди рдореЗрдВ </font><font style="vertical-align: inherit;">, рдЗрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреНрдпреВрдирддрдо рдЕрддрд┐рд░реЗрдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрд╝рдореИрди рдХреЛрдб </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">рдХреЗ рд╕рд╛рде</font></i><font style="vertical-align: inherit;"> рдПрдХ </font><i><font style="vertical-align: inherit;">рдЧреИрд░-рдЙрдкрд╕рд░реНрдЧ рдХреЛрдб</font></i><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<a name="7"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рджрдо</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдордЖрдИрдЯреА рдореЗрдВ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдкрд░ рдЕрдкрдиреЗ рдбреЙрдХреНрдЯрд░реЗрдЯ рд╢реЛрдз рдкреНрд░рдмрдВрдз рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддреЗ рд╕рдордп, рдбреЗрд╡рд┐рдб рд╣рдлрдореИрди рдиреЗ рд░реЙрдмрд░реНрдЯ рдиреИрдиреЛ рджреНрд╡рд╛рд░рд╛ рд╕рд┐рдЦрд╛рдпрд╛ рд╕реВрдЪрдирд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рдкрд░ рдПрдХ рдкрд╛рдареНрдпрдХреНрд░рдо рдореЗрдВ рднрд╛рдЧ рд▓рд┐рдпрд╛ред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд┐рдВрд╡рджрдВрддреА рдХреЗ рдЕрдиреБрд╕рд╛рд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдлрд╝рд╛рдиреЛ рдиреЗ рдЕрдкрдиреЗ рдЫрд╛рддреНрд░реЛрдВ рдХреЛ рдЪреБрдирдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА: рдЕрдВрддрд┐рдо рдкрд░реАрдХреНрд╖рд╛ рдпрд╛ рдкрд╛рдареНрдпрдХреНрд░рдо рд▓рд┐рдЦреЗрдВред рд╣рдлрд╝рдореИрди рдиреЗ рдмрд╛рдж рдХреЛ рдЪреБрдирд╛, рдФрд░ рдЙрдиреНрд╣реЗрдВ рдиреНрдпреВрдирддрдо рдЕрддрд┐рд░реЗрдХ рдХреЗ рд╕рд╛рде рдЙрдкрд╕рд░реНрдЧ рд░рд╣рд┐рдд рдХреЛрдб рдЦреЛрдЬрдиреЗ рдХрд╛ рд╡рд┐рд╖рдп рджрд┐рдпрд╛ рдЧрдпрд╛ред рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рдерд╛ рдХрд┐ рдЙрд╕ рд╕рдордп рдлрд╛рдиреЛ рд╕реНрд╡рдпрдВ рдЗрд╕ рдХрд╛рд░реНрдп рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рдерд╛ (рдЙрди рд╡рд░реНрд╖реЛрдВ рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реИрдирди-рдлрд╝рд╛рдиреЛ рдПрд▓реНрдЧреЛрд░рд┐рдердо</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдмрд╕реЗ рдкреНрд░рд╕рд┐рджреНрдз рд╡рд┐рдзрд┐ рдереА </font><font style="vertical-align: inherit;">)ред рд╣рдлрд╝рдореИрди рдХрд╛ рдХрд╛рдо 1952 рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП-рдореЗрдердб рдлреЙрд░ рдж рдХрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдСрдлрд╝ рдорд┐рдирд┐рдордо-рд░рд┐рдбрдВрдбреЗрдВрд╕реА рдХреЛрдбреНрд╕ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд╣рдд 1952 рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рд╣реБрдЖ рдерд╛ </font><font style="vertical-align: inherit;">ред рддрдм рд╕реЗ рдЗрд╕рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХрд╛ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд▓рдЧрд╛ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf0/4fe/003/cf04fe00303a663594eea8e8db063002.jpg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрд╡рд┐рдб рд╣рдлрд╝рдореИрди </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреВрд╕реА рд╕рд╛рдВрддрд╛ рдХреНрд░реВрдЬрд╝ рдХреЛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рд░рд┐рд▓реАрдЬрд╝ рдХрд┐рдпрд╛</font></a><font style="vertical-align: inherit;"> ред </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЪрд░рд┐рддреНрд░ рд╕реЗрдЯ рдФрд░ рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░реЗрдХ рдХреЛрдб рдХреЗ рд╕рд╛рде рдЕрд╡рд┐рднрд╛рдЬрд┐рдд рдХреЛрдб рдмрдирд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдмрд╛рд░-рдмрд╛рд░ рджреЛ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ - рдХрд╣рддреЗ рд╣реИрдВ, рдПрдХреНрд╕ рдФрд░ рд╡рд╛рдИ - рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдордЧреНрд░ рдЪрд░рд┐рддреНрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрд░реНрде "рдПрдХреНрд╕ рдпрд╛ рд╡рд╛рдИ" рд╕реЗ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдорд┐рд╢реНрд░рд┐рдд рдкреНрд░рддреАрдХ рдХреА рдШрдЯрдирд╛ рдХреА рдЖрд╡реГрддреНрддрд┐ рджреЛ рд╕реНрд░реЛрдд рдкреНрд░рддреАрдХреЛрдВ рдХреА рдЖрд╡реГрддреНрддрд┐рдпреЛрдВ рдХрд╛ рдпреЛрдЧ рд╣реИред </font><font style="vertical-align: inherit;">X рдФрд░ Y рдХреЗ рдХреЛрдбрд╡рд░реНрдб рдХрд┐рд╕реА рднреА рдРрд╕реЗ рдХреЛрдбрд╡рд░реНрдб рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдореВрд▓ рд╡рд░реНрдгреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 0 рдпрд╛ 1 рдХреЗ рдмрд╛рдж рдпреМрдЧрд┐рдХ рд╡рд░реНрдг "X рдпрд╛ Y" рдХреЛ рджрд┐рдП рдЧрдП рд╣реЛрдВред </font><font style="vertical-align: inherit;">рдЬрдм рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдПрдХ рд╡рд░реНрдг рдореЗрдВ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддрд╛ рд╣реИ ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реАрдбрд┐рдпреЛ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдПрдХ рдЫреЛрдЯреЗ рд╡рд░реНрдг рд╕реЗрдЯ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡реГрддреНрддрд┐</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдкрд╣рд▓рд╛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e90/a8f/4e4/e90a8f4e47c49cd14ca3a55f884d55e3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C рдФрд░ D, рджреЛ рджреБрд░реНрд▓рдн рдЪрд┐рд╣реНрдиреЛрдВ рдХреЛ рд╕реЗрдЯ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╕рдордЧреНрд░ рдкреНрд░рддреАрдХ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреА рдЖрд╡реГрддреНрддрд┐ рдЖрд╡реГрддреНрддрд┐рдпреЛрдВ C рдФрд░ D рдХрд╛ рдпреЛрдЧ рд╣реИ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e9/b0b/aed/7e9b0baeda34fc4d368c933bed7e1d15.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╕рдмрд╕реЗ рджреБрд░реНрд▓рдн рдкреНрд░рддреАрдХ B рдФрд░ 5 рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдВрдпреБрдХреНрдд рдкреНрд░рддреАрдХ рд╣реИред рдЙрдиреНрд╣реЗрдВ рд╕реЗрдЯ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ 9 рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдордЧреНрд░ рдкреНрд░рддреАрдХ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bca/94b/ad6/bca94bad698775402e8bab2c6a20f664.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдд рдореЗрдВ, 9 рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде A рдФрд░ рдПрдХ рд╕рдВрдпреБрдХреНрдд рдкреНрд░рддреАрдХ рдХреЛ 15 рдХреЗ рдЖрд╡реГрддреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдирдП рдкреНрд░рддреАрдХ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/260/aa3/800/260aa38005cf701421881214915d859a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреВрд░реЗ рд╕реЗрдЯ рдХреЛ рдПрдХ рд╡рд░реНрдг рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдиреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрдореИрди рдкреЗрдбрд╝</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╛рдордХ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрдирдкреБрдЯ рд╡рд░реНрдг рдкрддреНрддрд┐рдпрд╛рдВ рд╣реИрдВ, рдФрд░ рдПрдХ рд╡рд░реНрдг рдХреА рдЖрд╡реГрддреНрддрд┐ рдЬрд┐рддрдиреА рдЕрдзрд┐рдХ рд╣реЛрддреА рд╣реИ, рдЙрддрдирд╛ рд╣реА рдЙрдЪреНрдЪ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкреЗрдбрд╝ рдХреА рдЬрдбрд╝ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реБрдП, рдЖрдк рдХреНрд░рдорд╢рдГ рдмрд╛рдПрдВ рдпрд╛ рджрд╛рдПрдВ рдЪрд▓рддреЗ рд╕рдордп 0 рдпрд╛ 1 рдЬреЛрдбрд╝рдХрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд╢рдмреНрдж рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдирд┐рдХрд▓рд╛:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЛрдИ рднреА рдХреЛрдбрд╡рд░реНрдб рдХрд┐рд╕реА рдЕрдиреНрдп рдХреЗ рд▓рд┐рдП рдЙрдкрд╕рд░реНрдЧ рдирд╣реАрдВ рд╣реИред рдЬрд┐рддрдиреА рдмрд╛рд░ рдПрдХ рдкреНрд░рддреАрдХ рд╣реЛрддрд╛ рд╣реИ, рдЙрд╕рдХрд╛ рдХреЛрдб рд╢рдмреНрдж рдЙрддрдирд╛ рд╣реА рдЫреЛрдЯрд╛ рд╣реЛрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреЗрдбрд╝ рдХреЛ рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рднреА рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рд╣рдо рдЬрдбрд╝ рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЪрд░рд┐рддреНрд░ рдХреЗ рд╕рд╛рдордиреЗ 0 рдпрд╛ 1 рдХреЗ рд╕рд╛рде рдореВрд▓реНрдп рдХреЗ рд▓рд┐рдП рджрд╛рдПрдВ рдпрд╛ рдмрд╛рдПрдВ рдЬрд╛рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдмреАрдмреАрдП рдореЗрдВ рд▓рд╛рдЗрди 010100 рдХреЛ рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рд╕рдВрдмрдВрдзрд┐рдд рдЯреНрд░реА рдиреЛрдб рдХреА рдЧрд╣рд░рд╛рдИ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ рджреЗрдЦреЗрдВрдЧреЗ, рд╣рдореЗрдВ рдХреЛрдбрд╡рд░реНрдб рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреЗрдбрд╝ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рд╕реНрд╡рдпрдВ рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдЬрд╛рдирдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдлрдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рд╣реЛрдЧреАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪрд░рд┐рддреНрд░ рд╕реЗрдЯ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдФрд░ рдХреБрд╢рд▓рддрд╛ рд╕реЗ рд╕рдмрд╕реЗ рдХрдо рдЖрд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рдЗрдирд░реА рд╣реАрдк</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╣рдо рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреНрдпреВрдирддрдо-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдиреНрдпреВрдирддрдо рдорд╛рди рд╢реАрд░реНрд╖ рдкрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Swap the 32-bit values pointed to by a and b. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swap32</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *a, <span class="hljs-keyword">uint32_t</span> *b)</span>
</span>{
        <span class="hljs-keyword">uint32_t</span> tmp;<font></font>
<font></font>
        tmp = *a;<font></font>
        *a = *b;<font></font>
        *b = tmp;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Move element i in the n-element heap down to restore the minheap property. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">minheap_down</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *heap, <span class="hljs-keyword">size_t</span> n, <span class="hljs-keyword">size_t</span> i)</span>
</span>{
        <span class="hljs-keyword">size_t</span> left, right, min;<font></font>
<font></font>
        assert(i &gt;= <span class="hljs-number">1</span> &amp;&amp; i &lt;= n &amp;&amp; <span class="hljs-string">"i must be inside the heap"</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* While the ith element has at least one child. */</span>
        <span class="hljs-keyword">while</span> (i * <span class="hljs-number">2</span> &lt;= n) {<font></font>
                left = i * <span class="hljs-number">2</span>;<font></font>
                right = i * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>;<font></font>
<font></font>
                <span class="hljs-comment">/* Find the child with lowest value. */</span><font></font>
                min = left;<font></font>
                <span class="hljs-keyword">if</span> (right &lt;= n &amp;&amp; heap[right] &lt; heap[left]) {<font></font>
                        min = right;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Move i down if it is larger. */</span>
                <span class="hljs-keyword">if</span> (heap[min] &lt; heap[i]) {<font></font>
                        swap32(&amp;heap[min], &amp;heap[i]);<font></font>
                        i = min;<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Establish minheap property for heap[1..n]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">minheap_heapify</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> *heap, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        <span class="hljs-comment">/* Floyd's algorithm. */</span>
        <span class="hljs-keyword">for</span> (i = n / <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">1</span>; i--) {<font></font>
                minheap_down(heap, n, i);<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрдгреЛрдВ </font><font style="vertical-align: inherit;">
рдХреА рдЖрд╡реГрддреНрддрд┐ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">, рд╣рдо </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрддреНрд╡реЛрдВ рдХреЗ </font><font style="vertical-align: inherit;">рдПрдХ рд╕рдореВрд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рд░ рдмрд╛рд░ рдПрдХ рд╕рдордЧреНрд░ рдкреНрд░рддреАрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рджреЛрдиреЛрдВ рд╕реНрд░реЛрдд рдкреНрд░рддреАрдХреЛрдВ рдХреЛ "рд▓рд┐рдВрдХ" рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рддреАрдХ рдореЗрдВ рдПрдХ "рд╕рдВрдЪрд╛рд░ рддрддреНрд╡" рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">-Element рдвреЗрд░ рдФрд░ </font><font style="vertical-align: inherit;">рд╕рдВрдЪрд╛рд░ рддрддреНрд╡реЛрдВ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">, рд╣рдо рддрддреНрд╡реЛрдВ рдХреА рдПрдХ рд╕рд░рдгреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЬрдм рдвреЗрд░ рдкрд░ рджреЛ рдкрд╛рддреНрд░реЛрдВ рдХреЛ рдПрдХ рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдирдП рдЪрд░рд┐рддреНрд░ рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рддрддреНрд╡ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдкреНрд░рдмрдВрдз рдЧреАрдЧрд╛рдмрд╛рдЗрдЯреНрд╕ рдСрдлрд╝</font></a><font style="vertical-align: inherit;"> рд╡рд┐рдЯреЗрди, рдореЛрдлрд╝рдд рдФрд░ рдмреЗрд▓ </font><font style="vertical-align: inherit;">рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><code>n</code><font style="vertical-align: inherit;"></font><code>n</code><font style="vertical-align: inherit;"></font><code>n * 2 + 1</code><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдвреЗрд░ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдореЗрдВ, рд╣рдо рдкреНрд░рддреАрдХ рдЖрд╡реГрддреНрддрд┐ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 16 рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдкреНрд░рддреАрдХ рд╕рдВрдЪрд╛рд░ рддрддреНрд╡ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 16 рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯреНрд╕ред рдЙрдЪреНрдЪ рдмрд┐рдЯреНрд╕ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдХрд╛рд░рдг, рдвреЗрд░ рдХреЗ рджреЛ рддрддреНрд╡реЛрдВ рдХреЗ рдмреАрдЪ 32-рдмрд┐рдЯ рдХреА рддреБрд▓рдирд╛ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЖрд╡реГрддреНрддрд┐ рдЕрдВрддрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ рдХрд╛рд░рдг, рд╣рдореЗрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдкрд╛рддреНрд░реЛрдВ рдХреА рдЖрд╡реГрддреНрддрд┐ рд╣рдореЗрд╢рд╛ 16 рдмрд┐рдЯреНрд╕ рдореЗрдВ рдлрд┐рдЯ рд╣реЛрддреА рд╣реИред рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЕрдВрддрд┐рдо рд╕рдВрдпреБрдХреНрдд рдкреНрд░рддреАрдХ рдореЗрдВ рд╕рднреА рд╕рдВрдпреБрдХреНрдд рдкреНрд░рддреАрдХреЛрдВ рдХреА рдЖрд╡реГрддреНрддрд┐ рд╣реЛрдЧреА, рдЕрд░реНрдерд╛рдд, рдЗрд╕ рд░рд╛рд╢рд┐ рдХреЛ 16 рдмрд┐рдЯреНрд╕ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рдорд╛рд░рд╛ рдбрд┐рдлрд╛рд▓реНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди 64,535 рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдХреЗ рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╢реВрдиреНрдп рдЖрд╡реГрддреНрддрд┐ рд╡рд╛рд▓реЗ рдкреНрд░рддреАрдХреЛрдВ рдХреЛ рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рдХреЗ рдХреЛрдб рд╢рдмреНрдж рдкреНрд░рд╛рдкреНрдд рд╣реЛрдВрдЧреЗ рдФрд░ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рд╕рдВрдХрд▓рди рдореЗрдВ рднрд╛рдЧ рдирд╣реАрдВ рд▓реЗрдВрдЧреЗред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рдХреЛрдб рд╢рдмреНрдж рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрдзрд┐рдХрддрдо рдЧрд╣рд░рд╛рдИ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЖрд╡реГрддреНрддрд┐ рд╕реАрдорд╛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдЖрд╡реГрддреНрддрд┐ рд╡рд┐рддрд░рдг рдХреЛ "рд╕реБрдЪрд╛рд░реВ" рдХрд░реЗрдВрдЧреЗ рдФрд░ рдлрд┐рд░ рд╕реЗ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗ (рд╣рд╛рдБ, рдорджрдж рдХреЗ рд╕рд╛рде </font></font><code>goto</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)ред рдЧрд╣рд░рд╛рдИ рддрдХ рд╕реАрдорд┐рдд рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдкрд░рд┐рд╖реНрдХреГрдд рддрд░реАрдХреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рд░рд▓ рдФрд░ рдХреБрд╢рд▓ рд╣реИред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_HUFFMAN_SYMBOLS 288      <span class="hljs-comment">/* Deflate uses max 288 symbols. */</span></span><font></font>
<font></font>
<span class="hljs-comment">/* Construct a Huffman code for n symbols with the frequencies in freq, and
 * codeword length limited to max_len. The sum of the frequencies must be &lt;=
 * UINT16_MAX. max_len must be large enough that a code is always possible,
 * i.e. 2 ** max_len &gt;= n. Symbols with zero frequency are not part of the code
 * and get length zero. Outputs the codeword lengths in lengths[0..n-1]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compute_huffman_lengths</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *freqs, <span class="hljs-keyword">size_t</span> n,
                                    <span class="hljs-keyword">uint8_t</span> max_len, <span class="hljs-keyword">uint8_t</span> *lengths)</span>
</span>{
        <span class="hljs-keyword">uint32_t</span> nodes[MAX_HUFFMAN_SYMBOLS * <span class="hljs-number">2</span> + <span class="hljs-number">1</span>], p, q;
        <span class="hljs-keyword">uint16_t</span> freq;
        <span class="hljs-keyword">size_t</span> i, h, l;
        <span class="hljs-keyword">uint16_t</span> freq_cap = UINT16_MAX;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span>
        <span class="hljs-keyword">uint32_t</span> freq_sum = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                freq_sum += freqs[i];<font></font>
        }<font></font>
        assert(freq_sum &lt;= UINT16_MAX &amp;&amp; <span class="hljs-string">"Frequency sum too large!"</span>);
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        assert((<span class="hljs-number">1U</span> &lt;&lt; max_len) &gt;= n &amp;&amp; <span class="hljs-string">"max_len must be large enough"</span>);<font></font>
<font></font>
try_again:<font></font>
        <span class="hljs-comment">/* Initialize the heap. h is the heap size. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                freq = freqs[i];<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (freq == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>; <span class="hljs-comment">/* Ignore zero-frequency symbols. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (freq &gt; freq_cap) {<font></font>
                        freq = freq_cap; <span class="hljs-comment">/* Enforce the frequency cap. */</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* High 16 bits: Symbol frequency.
                   Low 16 bits:  Symbol link element index. */</span><font></font>
                h++;<font></font>
                nodes[h] = ((<span class="hljs-keyword">uint32_t</span>)freq &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-keyword">uint32_t</span>)(n + h);<font></font>
        }<font></font>
        minheap_heapify(nodes, h);<font></font>
<font></font>
        <span class="hljs-comment">/* Special case for less than two non-zero symbols. */</span>
        <span class="hljs-keyword">if</span> (h &lt; <span class="hljs-number">2</span>) {
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                        lengths[i] = (freqs[i] == <span class="hljs-number">0</span>) ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Build the Huffman tree. */</span>
        <span class="hljs-keyword">while</span> (h &gt; <span class="hljs-number">1</span>) {
                <span class="hljs-comment">/* Remove the lowest frequency node p from the heap. */</span>
                p = nodes[<span class="hljs-number">1</span>];<font></font>
                nodes[<span class="hljs-number">1</span>] = nodes[h--];<font></font>
                minheap_down(nodes, h, <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Get q, the next lowest frequency node. */</span>
                q = nodes[<span class="hljs-number">1</span>];<font></font>
<font></font>
                <span class="hljs-comment">/* Replace q with a new symbol with the combined frequencies of
                   p and q, and with the no longer used h+1'th node as the
                   link element. */</span>
                nodes[<span class="hljs-number">1</span>] = ((p &amp; <span class="hljs-number">0xffff0000</span>) + (q &amp; <span class="hljs-number">0xffff0000</span>))<font></font>
                           | (<span class="hljs-keyword">uint32_t</span>)(h + <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Set the links of p and q to point to the link element of
                   the new node. */</span>
                nodes[p &amp; <span class="hljs-number">0xffff</span>] = nodes[q &amp; <span class="hljs-number">0xffff</span>] = (<span class="hljs-keyword">uint32_t</span>)(h + <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-comment">/* Move the new symbol down to restore heap property. */</span>
                minheap_down(nodes, h, <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Compute the codeword length for each symbol. */</span>
        h = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {
                <span class="hljs-keyword">if</span> (freqs[i] == <span class="hljs-number">0</span>) {<font></font>
                        lengths[i] = <span class="hljs-number">0</span>;
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
                h++;<font></font>
<font></font>
                <span class="hljs-comment">/* Link element for the i'th symbol. */</span><font></font>
                p = nodes[n + h];<font></font>
<font></font>
                <span class="hljs-comment">/* Follow the links until we hit the root (link index 2). */</span>
                l = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">while</span> (p != <span class="hljs-number">2</span>) {<font></font>
                        l++;<font></font>
                        p = nodes[p];<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l &gt; max_len) {
                        <span class="hljs-comment">/* Lower freq_cap to flatten the distribution. */</span>
                        assert(freq_cap != <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-string">"Cannot lower freq_cap!"</span>);<font></font>
                        freq_cap /= <span class="hljs-number">2</span>;
                        <span class="hljs-keyword">goto</span> try_again;<font></font>
                }<font></font>
<font></font>
                assert(l &lt;= UINT8_MAX);<font></font>
                lengths[i] = (<span class="hljs-keyword">uint8_t</span>)l;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╛рдЗрдирд░реА рд╣реАрдк рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдПрдХ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╡рд┐рдХрд▓реНрдк рджреЛ рдХрддрд╛рд░реЛрдВ рдореЗрдВ рдкрд╛рддреНрд░реЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ рдореЗрдВ рд╕реНрд░реЛрдд рд╡рд░реНрдг рд╣реЛрддреЗ рд╣реИрдВ, рдЖрд╡реГрддреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдХреНрд░рдордмрджреНрдзред </font><font style="vertical-align: inherit;">рдЬрдм рдПрдХ рдпреМрдЧрд┐рдХ рдкреНрд░рддреАрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рдмрд╕реЗ рдХрдо рдЖрд╡реГрддреНрддрд┐ рд╡рд╛рд▓рд╛ рдкреНрд░рддреАрдХ рд╣рдореЗрд╢рд╛ рдХрддрд╛рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреА рдкрд╣рд▓реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рд╡рд░реНрдгрди </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрди рд╡реИрди рд▓реАрдЙрд╡реЗрди</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдиреЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрди рдж рдХрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдСрдл рд╣рдлрд╝рдореИрди рдЯреНрд░реАрдЬрд╝</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1976) рдореЗрдВ рдХрд┐рдпрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ рдЧреИрд░-рдЙрдкрд╕рд░реНрдЧ рдХреЛрдб рдХреЗ рд▓рд┐рдП рдЗрд╖реНрдЯрддрдо рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рддрд░реАрдХреЗ рд╣реИрдВ: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрдХрдЧрдгрд┐рдд рдХреЛрдбрд┐рдВрдЧ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╕рдордорд┐рдд рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рдгрд╛рд▓реА</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br>
<br>
<a name="8"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрдореИрди рдХреЗ рд╡рд┐рд╣рд┐рдд рдХреЛрдб</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдКрдкрд░ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдордиреЗ рдПрдХ рд╣рдлрдореИрди рдкреЗрдбрд╝ рдмрдирд╛рдпрд╛:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/260/aa3/800/260aa38005cf701421881214915d859a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрджрд┐ рд╣рдо рд░реВрдЯ рд╕реЗ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдмрд╛рдИрдВ рд╢рд╛рдЦрд╛ рдХреЗ рд▓рд┐рдП 0 рдФрд░ рджрд╛рдИрдВ рдУрд░ 1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдорд┐рд▓рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╛рдИрдВ рд╢рд╛рдЦрд╛ рдХреЗ рд▓рд┐рдП 0 рдФрд░ рджрд╛рдИрдВ рдУрд░ 1 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рдордирдорд╛рдирд╛ рд▓рдЧрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рд╣рдо рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдпрд╣ рдорд┐рд▓рддрд╛ рд╣реИ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">001</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">000</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╢реВрдиреНрдп рдФрд░ рдПрдХ рдХреЗ рд╕рд╛рде рдиреЛрдб рд╕реЗ рдирд┐рдХрд▓рдиреЗ рд╡рд╛рд▓реА рджреЛ рд╢рд╛рдЦрд╛рдУрдВ рдХреЛ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рд▓реЗрдмрд▓ рдЕрд▓рдЧ рд╣реИрдВ), рдФрд░ рдЕрднреА рднреА рдмрд░рд╛рдмрд░ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/29b/acb/499/29bacb4999e9a3f530f22634846a97b7.png"></div><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрдпрд╛рд░рд╣</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">101</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдиреНрдпреВрдирддрдо рдЕрддрд┐рд░реЗрдХ рдХреЗ рд╕рд╛рде рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХреЛрдб рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХреЛрдбрд╡рд░реНрдб рдХреЛ рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХреА рдЧрдИ рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рд╡рд┐рд╣рд┐рдд рд╣рдлрд╝рдореИрди рдХреЛрдб рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрд░реАрдХреЗ рд╕реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рдХреЛрдбрд╡рд░реНрдб рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдкрдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рд╕реНрдЯреЛрд░ рдФрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: рдбрд┐рдХреЛрдбрд░ рдЕрдкрдиреА рд▓рдВрдмрд╛рдИ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреЛрдбрд╡рд░реНрдб рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред рдмреЗрд╢рдХ, рдЖрдк рдкреНрд░рддреАрдХ рдЖрд╡реГрддреНрддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдФрд░ рд╕рдВрдЪрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдбрд┐рдХреЛрдбрд░ рдореЗрдВ рд╣рдлрдореИрди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдбрд┐рдХреЛрдбрд░ рд╕реЗ рдЕрдзрд┐рдХ рдХрд╛рдо рдФрд░ рдЕрдзрд┐рдХ рднрдВрдбрд╛рд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдПрдХ рдФрд░ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдВрдкрддреНрддрд┐ рдпрд╣ рд╣реИ рдХрд┐ рд╡рд┐рд╣рд┐рдд рдХреЛрдб рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреБрд╢рд▓ рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рд╕рдордп рдореЗрдВ рдПрдХ рд╕реЗ рдХрдо, рд╡рд░реНрдгреЛрдВ рдХреЛ рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреЛ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИред рдкрд╣рд▓рд╛ рдХреЛрдб рд╢рдмреНрдж рд╣реИ 0. рдЕрдЧрд▓рд╛ рд╢рдмреНрдж рдкрд┐рдЫрд▓реЗ рд╢рдмреНрдж рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рдПрдХ рд╢рдмреНрдж рд╣реЛрдЧрд╛ред 1. рдПрди рдХреА рд▓рдВрдмрд╛рдИ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛ рд╢рдмреНрдж рдПрди -1 рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдЕрдВрддрд┐рдо рд╢рдмреНрдж рд╕реЗ рдмрдирд╛ рд╣реИ, рдПрдХ рдХреЛ рдЬреЛрдбрд╝рдирд╛ (рдПрдХ рдирдпрд╛ рдХреЛрдб рд╢рдмреНрдж рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) рдФрд░ рдмрд╛рдИрдВ рдУрд░ рдПрдХ рдХрджрдо рд╢рд┐рдлреНрдЯ рдХрд░рдирд╛ (рд▓рдВрдмрд╛рдИ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣реЙрдлрдореИрди рдкреЗрдбрд╝ рдХреА рд╢рдмреНрджрд╛рд╡рд▓реА рдореЗрдВ, рдХреЛрдб рд╢рдмреНрдж рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ, рдПрдХ рд╕рдордп рдореЗрдВ рдПрдХ рд╕реНрддрд░ рдкрд░ рдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрдЧрд▓реЗ рд╕реНрддрд░ рдкрд░ рдЬрд╛рдиреЗ рдкрд░ рдмрд╛рдИрдВ рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ ABCD рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдлрдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдиреЗ 1, 2, 3, рдФрд░ 3 рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рд╛рде рдХреЛрдб рд╢рдмреНрдж рджрд┐рдП рд╣реИрдВред рдкрд╣рд▓рд╛ рд╢рдмреНрдж 0. рд╣реИред рдпрд╣ рд▓рдВрдмрд╛рдИ рдХрд╛ рдЕрдВрддрд┐рдо рд╢рдмреНрдж рднреА рд╣реИред рд▓рдВрдмрд╛рдИ 2 рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрдЧрд▓рд╛ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 0 рд▓рдЧрддрд╛ рд╣реИ рдФрд░ 1 рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЬреЛ рджреЛ-рдмрд┐рдЯ рдХреЛрдб рдХрд╛ рдЙрдкрд╕рд░реНрдЧ рдмрди рдЬрд╛рдПрдЧрд╛ред , рдмрд╛рдИрдВ рдУрд░ рдЬрд╛рдПрдВ рдФрд░ 10. рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рдпрд╣ рдЕрдм рд▓рдВрдмрд╛рдИ рдХрд╛ рдЕрдВрддрд┐рдо рд╢рдмреНрдж рд╣реИред рд▓рдВрдмрд╛рдИ 3 рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо 1 рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рд╢рд┐рдлреНрдЯ рдХрд░рддреЗ рд╣реИрдВ: 110ред рд▓рдВрдмрд╛рдИ 3 рдХреЗ рдЕрдЧрд▓реЗ рд╢рдмреНрдж рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо 1: 111 рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рд╣рд┐рдд рдХреЛрдб рдЬрдирд░реЗрдЯрд░ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Deflate рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо LSB- рдкреНрд░рдердо рд╕рд┐рджреНрдзрд╛рдВрдд (рдкрд╣рд▓реЗ, рд╕рдмрд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреЛрдбрд╡рд░реНрдб рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣реА рд╣реИ, рдХреЛрдбрд╡рд░реНрдб рдХрд╛ рдкрд╣рд▓рд╛ рдмрд┐рдЯ рдХрдо рд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдмрд┐рдЯреНрд╕ рдХреЗ рдХреНрд░рдо рдХреЛ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓реБрдХрдЕрдк рдЯреЗрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_HUFFMAN_BITS 15          <span class="hljs-comment">/* Deflate uses max 15-bit codewords. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">compute_canonical_code</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> *codewords, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                                   <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint16_t</span> count[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">uint16_t</span> code[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">int</span> l;<font></font>
<font></font>
        <span class="hljs-comment">/* Count the number of codewords of each length. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                count[lengths[i]]++;<font></font>
        }<font></font>
        count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">/* Ignore zero-length codes. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Compute the first codeword for each length. */</span>
        code[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {<font></font>
                code[l] = (<span class="hljs-keyword">uint16_t</span>)((code[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Assign a codeword for each symbol. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                l = lengths[i];<font></font>
                <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                codewords[i] = reverse16(code[l]++, l); <span class="hljs-comment">/* Make it LSB-first. */</span><font></font>
        }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Reverse the n least significant bits of x.
   The (16 - n) most significant bits of the result will be zero. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint16_t</span> <span class="hljs-title">reverse16</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> x, <span class="hljs-keyword">int</span> n)</span>
</span>{
        <span class="hljs-keyword">uint16_t</span> lo, hi;
        <span class="hljs-keyword">uint16_t</span> reversed;<font></font>
<font></font>
        assert(n &gt; <span class="hljs-number">0</span>);<font></font>
        assert(n &lt;= <span class="hljs-number">16</span>);<font></font>
<font></font>
        lo = x &amp; <span class="hljs-number">0xff</span>;<font></font>
        hi = x &gt;&gt; <span class="hljs-number">8</span>;<font></font>
<font></font>
        reversed = (<span class="hljs-keyword">uint16_t</span>)((reverse8_tbl[lo] &lt;&lt; <span class="hljs-number">8</span>) | reverse8_tbl[hi]);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> reversed &gt;&gt; (<span class="hljs-number">16</span> - n);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдЗрд╕реЗ рд╕рдм рдПрдХ рд╕рд╛рде рд░рдЦреЗрдВ рдФрд░ рдПрдирдХреЛрдбрд░ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЛрдб рд▓рд┐рдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_encoder_t</span> <span class="hljs-title">huffman_encoder_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_encoder_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> codewords[MAX_HUFFMAN_SYMBOLS]; <span class="hljs-comment">/* LSB-first codewords. */</span>
        <span class="hljs-keyword">uint8_t</span> lengths[MAX_HUFFMAN_SYMBOLS];    <span class="hljs-comment">/* Codeword lengths. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize a Huffman encoder based on the n symbol frequencies. */</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">huffman_encoder_init</span><span class="hljs-params">(<span class="hljs-keyword">huffman_encoder_t</span> *e, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *freqs, <span class="hljs-keyword">size_t</span> n,
                          <span class="hljs-keyword">uint8_t</span> max_codeword_len)</span>
</span>{<font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        assert(max_codeword_len &lt;= MAX_HUFFMAN_BITS);<font></font>
<font></font>
        compute_huffman_lengths(freqs, n, max_codeword_len, e-&gt;lengths);<font></font>
        compute_canonical_code(e-&gt;codewords, e-&gt;lengths, n);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рдЧрдгрдирд╛ рдХреА рдЧрдИ рдХреЛрдб рд▓рдВрдмрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдирдХреЛрдбрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Initialize a Huffman encoder based on the n codeword lengths. */</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">huffman_encoder_init2</span><span class="hljs-params">(<span class="hljs-keyword">huffman_encoder_t</span> *e, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                           <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                e-&gt;lengths[i] = lengths[i];<font></font>
        }<font></font>
        compute_canonical_code(e-&gt;codewords, e-&gt;lengths, n);<font></font>
}<font></font>
</code></pre><br>
<a name="9"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреБрд╢рд▓ рд╣рдлрдореИрди рдбрд┐рдХреЛрдбрд┐рдВрдЧ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрд╝рдореИрди рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдкреЗрдбрд╝ рдХреЛ рдЬрдбрд╝ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реИ, рдПрдХ рд╕рдордп рдореЗрдВ рдПрдХ рд╕рд╛ рдЗрдирдкреБрдЯ рдкрдврд╝рдирд╛ рдФрд░ рдпрд╣ рддрдп рдХрд░рдирд╛ рдХрд┐ рдХреМрди рд╕реА рд╢рд╛рдЦрд╛ рдХреЛ рдЕрдЧрд▓реЗ, рдмрд╛рдПрдБ рдпрд╛ рджрд╛рдПрдБ рд▓реЗрдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЬрдм рдПрдХ рдкрддреНрддрд╛ рдиреЛрдб рддрдХ рдкрд╣реБрдБрдЪ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдбреАрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╡рд░реНрдг рд╣реЛрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рдЕрдХреНрд╕рд░ рд╡рд┐рд╢реНрд╡рд╡рд┐рджреНрдпрд╛рд▓рдпреЛрдВ рдФрд░ рдкреБрд╕реНрддрдХреЛрдВ рдореЗрдВ рдкрдврд╝рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рд░рд▓ рдФрд░ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╕рдордп рдореЗрдВ рдПрдХ рдмрд┐рдЯ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдмрд╣реБрдд рдзреАрдорд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реБрдХрдЕрдк рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рдХреЛрдб рдХрд░рдирд╛ рдЕрдзрд┐рдХ рддреЗрдЬрд╝ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдЕрдзрд┐рдХрддрдо рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рддреАрди рдмрд┐рдЯреНрд╕ рд╣реИ, рдЖрдк рдирд┐рдореНрди рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯреНрд╕</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ</font></font></strong></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдП</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">резреж</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> реж</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">резреж</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рез</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></strong></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХреЗрд╡рд▓ рдЪрд╛рд░ рд╡рд░реНрдг рд╣реИрдВ, рд╣рдореЗрдВ рддреАрди рд╕рдВрднрд╡ рд╕рдВрдпреЛрдЬрди рдХреЛ рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрда рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рддреАрди рдмрд┐рдЯреНрд╕ рд╕реЗ рдЫреЛрдЯреЗ рдХреЛрдбрд╡рд░реНрдб рд╡рд╛рд▓реЗ рдкреНрд░рддреАрдХреЛрдВ рдореЗрдВ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдХрдИ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 10 рд╢рдмреНрдж "рдкреВрд░рдХ" </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 рдХреЗ рд╕рд╛рде рдерд╛ред 10. рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рддреАрди-рдмрд┐рдЯ рд╕рдВрдпреЛрдЬрдиреЛрдВ рдХреЛ рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рддрд░рд╣ рд╕реЗ рдбреАрдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреАрди рдЗрдирдкреБрдЯ рдмрд┐рдЯреНрд╕ рдХреЗ рд╕рд╛рде рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рддреБрд░рдВрдд рд╕рдВрдмрдВрдзрд┐рдд рд╡рд░реНрдг рдФрд░ рдЙрд╕рдХреЗ рдХреЛрдб рд╢рдмреНрдж рдХреА рд▓рдВрдмрд╛рдИ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рд▓рдВрдмрд╛рдИ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдЧрд▓реЗ рддреАрди рдмрд┐рдЯреНрд╕ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╣рдореЗрдВ рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рд╕рдорд╛рди рдЗрдирдкреБрдЯ рдмрд┐рдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЦреЛрдЬ рддрд╛рд▓рд┐рдХрд╛-рдЖрдзрд╛рд░рд┐рдд рд╡рд┐рдзрд┐ рдмрд╣реБрдд рддреЗрдЬрд╝реА рд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдПрдХ рдЦрд╛рдореА рд╣реИ: рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯ рдХреЗ рд╕рд╛рде рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЖрдХрд╛рд░ рджреЛрдЧреБрдирд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣реА рд╣реИ, рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рддреЗрдЬреА рд╕реЗ рдзреАрдорд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЕрдЧрд░ рдпрд╣ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреИрд╢ рдореЗрдВ рдлрд┐рдЯ рд╣реЛрдирд╛ рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╡рд┐рдзрд┐ рдзреАрд░реЗ-рдзреАрд░реЗ рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╡рдЬрд╣ рд╕реЗ, рд▓реБрдХрдЕрдк рдЯреЗрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдорддреМрд░ рдкрд░ рдХреЗрд╡рд▓ рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд▓рдВрдмрд╛рдИ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдФрд░ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рд╢рдмреНрдж рдПрдХ рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд▓реЗрддреЗ рд╣реИрдВред рдЬрд┐рд╕ рддрд░рд╣ рд╣рдлрдореИрди рдХреЛрдбрд┐рдВрдЧ рдХрдо рдХреЛрдбрд╡рд░реНрдб рдХреЛ рдЕрдзрд┐рдХ рдмрд╛рд░ рд╡рд░реНрдгреЛрдВ рдХреЛ рдЕрд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ, рд╡реИрд╕реЗ рд╣реА рд╢реЙрд░реНрдЯ рдХреЛрдбрд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рд▓реБрдХрдЕрдк рдЯреЗрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдПрдХ рдЙрддреНрдХреГрд╖реНрдЯ рдЕрдиреБрдХреВрд▓рди рд╣реИред </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝рд╛рд▓рд┐рдм рдореЗрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЦреЛрдЬ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рдХрдИ рд╕реНрддрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдкрд╣рд▓реА рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдХреЛрдбрд╡рд░реНрдб рдмрд╣реБрдд рд▓рдВрдмрд╛ рд╣реИ, рддреЛ рдЦреЛрдЬ рд╢реЗрд╖ рдмрд┐рдЯреНрд╕ рдХреЛ рдЕрдиреБрдХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреНрд╡рд┐рддреАрдпрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЬрд╛рдПрдЧреАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдХрд┐рди рдПрдХ рдФрд░, рдмрд╣реБрдд рд╣реА рд╕реБрдВрджрд░ рд╡рд┐рдзрд┐ рд╣реИ, рдЬреЛ рдХреИрдиреЛрдирд┐рдХрд▓ рд╣рдлрдореИрди рдХреЛрдб рдХреЗ рдЧреБрдгреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреНрдпреВрдирддрдо рдЕрддрд┐рд░реЗрдХ рдЙрдкрд╕рд░реНрдЧ рд╕рдВрд╣рд┐рддрд╛рдУрдВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдореЛрдлрд╝рдд рдФрд░ рдЯрд░реНрдкрд┐рди, 1997) </font><i><font style="vertical-align: inherit;">рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░</font></i><font style="vertical-align: inherit;"> рд╡рд░реНрдгрд┐рдд рд╣реИ </font><font style="vertical-align: inherit;">, рдФрд░ рдЗрд╕реЗ </font><font style="vertical-align: inherit;">рдЪрд╛рд░реНрд▓реНрд╕ рдмреНрд▓реВрдо рдХреЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдж рд▓реЙрд╕реНрдЯ рд╣рдлрд╝рдореИрди рдкреЗрдкрд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рднреА рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП рд╡рд┐рд╣рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдХреЛрдб рд╢рдмреНрдж рд▓реЗрддреЗ рд╣реИрдВ: 0, 10, 110, 111ред рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд▓рдВрдмрд╛рдИ рдХреЗ рдкрд╣рд▓реЗ рдХреЛрдб рд╢рдмреНрджреЛрдВ рдФрд░ рд╕рд╛рде рд╣реА рд╕рд╛рдорд╛рдиреНрдп рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдХреЛрдб рд╢рдмреНрдж рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдЯреНрд░реИрдХ рдХрд░реЗрдВрдЧреЗ - "рдкреНрд░рддреАрдХ рд╕реВрдЪрдХрд╛рдВрдХ"ред</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдХреЛрдбрд╡рд░реНрдб</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рдЪрд░рд┐рддреНрд░ рд╕реВрдЪрдХрд╛рдВрдХ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 (рдП)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 (рдмреА)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 (рд╕реА)</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ рдХреЛрдб рд╢рдмреНрдж рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдЕрд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЕрдЧрд░ рд╣рдореЗрдВ рдмрд┐рдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЙрдкрд░реЛрдХреНрдд рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпреЗ рдмрд┐рдЯреНрд╕ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рддреАрди-рдмрд┐рдЯ 111 рдХреЗ рд▓рд┐рдП рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдЗрд╕ рд▓рдВрдмрд╛рдИ (110) рдХреЗ рдкрд╣рд▓реЗ рдХреЛрдбрд╡рд░реНрдб рд╕реЗ рдПрдХ рдСрдлрд╕реЗрдЯ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕ рд▓рдВрдмрд╛рдИ рдХрд╛ рдкрд╣рд▓рд╛ рд╡рд░реНрдг рд╕реВрдЪрдХрд╛рдВрдХ 3 рд╣реИ, рдФрд░ рдПрдХ рдХреА рдПрдХ рдСрдлрд╕реЗрдЯ рд╣рдореЗрдВ 4 рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рджреЗрддрд╛ рд╣реИред рдПрдХ рдЕрдиреНрдп рддрд╛рд▓рд┐рдХрд╛ рдЪрд░рд┐рддреНрд░ рд╕реВрдЪрдХрд╛рдВрдХ рдХреА рддреБрд▓рдирд╛ рдЪрд░рд┐рддреНрд░ рдХреЗ рд╕рд╛рде рдХрд░рддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs">sym_idx = d-&gt;first_symbol[len] + (bits - d-&gt;first_code[len]);<font></font>
sym = d-&gt;syms[sym_idx];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдереЛрдбрд╝рд╛ рдЕрдиреБрдХреВрд▓рди: рдкрд╣рд▓реЗ рд╡рд░реНрдг рд╕реВрдЪрдХрд╛рдВрдХ рдФрд░ рдкрд╣рд▓реЗ рдХреЛрдб рд╢рдмреНрдж рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдкрд╣рд▓реЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЛ рдкрд╣рд▓реЗ рдХреЛрдб рд╢рдмреНрдж рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">sym_idx = d-&gt;offset_first_sym_idx[len] + bits;<font></font>
sym = d-&gt;syms[sym_idx];<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрд┐рддрдиреЗ рдмрд┐рдЯреНрд╕ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╣рдо рдлрд┐рд░ рд╕реЗ рдХреЛрдб рдЕрдиреБрдХреНрд░рдо рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╕рднреА рдорд╛рдиреНрдп рдПрдХ-рдмрд┐рдЯ рдХреЛрдбрд╡рд░реНрдб рдХрдбрд╝рд╛рдИ рд╕реЗ 1 рд╕реЗ рдХрдо рд╣реИрдВ, рджреЛ-рдмрд┐рдЯ - рд╕рдЦреНрддреА рд╕реЗ 11 рд╕реЗ рдХрдо, рддреАрди-рдмрд┐рдЯ - 1000 рд╕реЗ рдХрдо (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╕рднреА рддреАрди-рдмрд┐рдЯ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣реА)ред </font><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдорд╛рдиреНрдп рдПрди-рдмрд┐рдЯ рдХреЛрдбрд╡рд░реНрдб рдкрд╣рд▓реЗ рдПрди-рдмрд┐рдЯ рдХреЛрдбрд╡рд░реНрдб рдФрд░ рдПрди-рдмрд┐рдЯ рдХреЛрдбрд╡рд░реНрдб рдХреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдХрдбрд╝рд╛рдИ рд╕реЗ рдХрдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдЗрди рд╕реАрдорд╛рдУрдВ рдХреЛ рдмрд╛рдИрдВ рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рд╕рднреА рддреАрди-рдмрд┐рдЯ рдЪреМрдбрд╝реЗ рд╣реЛрдВред </font><font style="vertical-align: inherit;">рдЪрд▓реЛ рдЗрд╕реЗ </font><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рдмрд┐рдЯреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯреНрд╕ рд╕реАрдорд┐рдд рдХрд░реЗрдВ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">110</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1000</font></font></td>
</tr>
</tbody></table></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рдВрдмрд╛рдИ 3 рдХреЗ рд▓рд┐рдП рд╕реАрдордХ 4 рдмрд┐рдЯреНрд╕ рдкрд░ рдмрд╣ рдирд┐рдХрд▓рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдорддрд▓рдм рдХреЗрд╡рд▓ рдпрд╣реА рд╣реИ рдХрд┐ рдХреЛрдИ рднреА рддреАрди-рдмрд┐рдЯ рд╢рдмреНрдж рдХрд░реЗрдЧрд╛ред </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рддреАрди-рдмрд┐рдЯ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреЗ рдмреАрдЪ рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рдмрд┐рдЯреНрд╕ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдХреЗ рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░рд╛ рдХреЛрдб рд╢рдмреНрдж рдХрд┐рддрдирд╛ рд▓рдВрдмрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЗрдирдкреБрдЯ рдмрд┐рдЯреНрд╕ рдХреЛ рд╢рд┐рдлреНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдХреЗрд╡рд▓ рдЙрдирдХреА рд╕рд╣реА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╡рд░реНрдг рд╕реВрдЪрдХрд╛рдВрдХ рдкрд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">for</span> (len = <span class="hljs-number">1</span>; len &lt;= <span class="hljs-number">3</span>; len++) {
        <span class="hljs-keyword">if</span> (bits &lt; d-&gt;sentinel_bits[len]) {<font></font>
                bits &gt;&gt;= <span class="hljs-number">3</span> - len;  <span class="hljs-comment">/* Get the len most significant bits. */</span><font></font>
                sym_idx = d-&gt;offset_first_sym_idx[len] + bits;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕рдордп рдЬрдЯрд┐рд▓рддрд╛ рдХреЛрдб рд╢рдмреНрджреЛрдВ рдореЗрдВ рдмрд┐рдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рд░реИрдЦрд┐рдХ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрдЧрд╣ рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдЦрд░реНрдЪ рдХреА рдЬрд╛рддреА рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдкрд░ рдХреЗрд╡рд▓ рд▓реЛрдбрд┐рдВрдЧ рдФрд░ рддреБрд▓рдирд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдЪреВрдВрдХрд┐ рдХрдо рдХреЛрдб рд╢рдмреНрдж рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХрдИ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрдкреАрдбрд╝рди рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреВрд░реНрдг рдбрд┐рдХреЛрдбрд░ рдХреЛрдб:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HUFFMAN_LOOKUP_TABLE_BITS 8  <span class="hljs-comment">/* Seems a good trade-off. */</span></span><font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_decoder_t</span> <span class="hljs-title">huffman_decoder_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">huffman_decoder_t</span> {</span>
        <span class="hljs-comment">/* Lookup table for fast decoding of short codewords. */</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
                <span class="hljs-keyword">uint16_t</span> sym : <span class="hljs-number">9</span>;  <span class="hljs-comment">/* Wide enough to fit the max symbol nbr. */</span>
                <span class="hljs-keyword">uint16_t</span> len : <span class="hljs-number">7</span>;  <span class="hljs-comment">/* 0 means no symbol. */</span>
        } table[<span class="hljs-number">1U</span> &lt;&lt; HUFFMAN_LOOKUP_TABLE_BITS];<font></font>
<font></font>
        <span class="hljs-comment">/* "Sentinel bits" value for each codeword length. */</span>
        <span class="hljs-keyword">uint16_t</span> sentinel_bits[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* First symbol index minus first codeword mod 2**16 for each length. */</span>
        <span class="hljs-keyword">uint16_t</span> offset_first_sym_idx[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* Map from symbol index to symbol. */</span>
        <span class="hljs-keyword">uint16_t</span> syms[MAX_HUFFMAN_SYMBOLS];
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span>
        <span class="hljs-keyword">size_t</span> num_syms;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Get the n least significant bits of x. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">lsb</span><span class="hljs-params">(<span class="hljs-keyword">uint64_t</span> x, <span class="hljs-keyword">int</span> n)</span>
</span>{<font></font>
        assert(n &gt;= <span class="hljs-number">0</span> &amp;&amp; n &lt;= <span class="hljs-number">63</span>);
        <span class="hljs-keyword">return</span> x &amp; (((<span class="hljs-keyword">uint64_t</span>)<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Use the decoder d to decode a symbol from the LSB-first zero-padded bits.
 * Returns the decoded symbol number or -1 if no symbol could be decoded.
 * *num_used_bits will be set to the number of bits used to decode the symbol,
 * or zero if no symbol could be decoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">huffman_decode</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">uint16_t</span> bits,
                                 <span class="hljs-keyword">size_t</span> *num_used_bits)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> lookup_bits;
        <span class="hljs-keyword">size_t</span> l;
        <span class="hljs-keyword">size_t</span> sym_idx;<font></font>
<font></font>
        <span class="hljs-comment">/* First try the lookup table. */</span><font></font>
        lookup_bits = lsb(bits, HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
        assert(lookup_bits &lt; <span class="hljs-keyword">sizeof</span>(d-&gt;table) / <span class="hljs-keyword">sizeof</span>(d-&gt;table[<span class="hljs-number">0</span>]));
        <span class="hljs-keyword">if</span> (d-&gt;table[lookup_bits].len != <span class="hljs-number">0</span>) {<font></font>
                assert(d-&gt;table[lookup_bits].len &lt;= HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
                assert(d-&gt;table[lookup_bits].sym &lt; d-&gt;num_syms);<font></font>
<font></font>
                *num_used_bits = d-&gt;table[lookup_bits].len;<font></font>
                <span class="hljs-keyword">return</span> d-&gt;table[lookup_bits].sym;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Then do canonical decoding with the bits in MSB-first order. */</span><font></font>
        bits = reverse16(bits, MAX_HUFFMAN_BITS);<font></font>
        <span class="hljs-keyword">for</span> (l = HUFFMAN_LOOKUP_TABLE_BITS + <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {
                <span class="hljs-keyword">if</span> (bits &lt; d-&gt;sentinel_bits[l]) {<font></font>
                        bits &gt;&gt;= MAX_HUFFMAN_BITS - l;<font></font>
<font></font>
                        sym_idx = (<span class="hljs-keyword">uint16_t</span>)(d-&gt;offset_first_sym_idx[l] + bits);<font></font>
                        assert(sym_idx &lt; d-&gt;num_syms);<font></font>
<font></font>
                        *num_used_bits = l;<font></font>
                        <span class="hljs-keyword">return</span> d-&gt;syms[sym_idx];<font></font>
                }<font></font>
        }<font></font>
<font></font>
        *num_used_bits = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд┐рдХреЛрдбрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рд╣рд┐рдд рдХреЛрдбреЛрдВ рдХреА рдкреВрд░реНрд╡ рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">huffman_encoder_init рдХреЗ рд▓рд┐рдП</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдФрд░ рд╡рд┐рднрд┐рдиреНрди рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рднрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Initialize huffman decoder d for a code defined by the n codeword lengths.
   Returns false if the codeword lengths do not correspond to a valid prefix
   code. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">huffman_decoder_init</span><span class="hljs-params">(<span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lengths,
                          <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint16_t</span> count[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">uint16_t</span> code[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint32_t</span> s;
        <span class="hljs-keyword">uint16_t</span> sym_idx[MAX_HUFFMAN_BITS + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">int</span> l;<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NDEBUG</span><font></font>
        assert(n &lt;= MAX_HUFFMAN_SYMBOLS);<font></font>
        d-&gt;num_syms = n;<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
        <span class="hljs-comment">/* Zero-initialize the lookup table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">sizeof</span>(d-&gt;table) / <span class="hljs-keyword">sizeof</span>(d-&gt;table[<span class="hljs-number">0</span>]); i++) {<font></font>
                d-&gt;table[i].len = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Count the number of codewords of each length. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                assert(lengths[i] &lt;= MAX_HUFFMAN_BITS);<font></font>
                count[lengths[i]]++;<font></font>
        }<font></font>
        count[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  <span class="hljs-comment">/* Ignore zero-length codewords. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Compute sentinel_bits and offset_first_sym_idx for each length. */</span>
        code[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<font></font>
        sym_idx[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (l = <span class="hljs-number">1</span>; l &lt;= MAX_HUFFMAN_BITS; l++) {
                <span class="hljs-comment">/* First canonical codeword of this length. */</span>
                code[l] = (<span class="hljs-keyword">uint16_t</span>)((code[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>]) &lt;&lt; <span class="hljs-number">1</span>);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (count[l] != <span class="hljs-number">0</span> &amp;&amp; code[l] + count[l] - <span class="hljs-number">1</span> &gt; (<span class="hljs-number">1U</span> &lt;&lt; l) - <span class="hljs-number">1</span>) {
                        <span class="hljs-comment">/* The last codeword is longer than l bits. */</span>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                s = (<span class="hljs-keyword">uint32_t</span>)((code[l] + count[l]) &lt;&lt; (MAX_HUFFMAN_BITS - l));<font></font>
                d-&gt;sentinel_bits[l] = (<span class="hljs-keyword">uint16_t</span>)s;<font></font>
                assert(d-&gt;sentinel_bits[l] == s &amp;&amp; <span class="hljs-string">"No overflow."</span>);<font></font>
<font></font>
                sym_idx[l] = sym_idx[l - <span class="hljs-number">1</span>] + count[l - <span class="hljs-number">1</span>];<font></font>
                d-&gt;offset_first_sym_idx[l] = sym_idx[l] - code[l];<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Build mapping from index to symbol and populate the lookup table. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                l = lengths[i];<font></font>
                <span class="hljs-keyword">if</span> (l == <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                d-&gt;syms[sym_idx[l]] = (<span class="hljs-keyword">uint16_t</span>)i;<font></font>
                sym_idx[l]++;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (l &lt;= HUFFMAN_LOOKUP_TABLE_BITS) {<font></font>
                        table_insert(d, i, l, code[l]);<font></font>
                        code[l]++;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">table_insert</span><span class="hljs-params">(<span class="hljs-keyword">huffman_decoder_t</span> *d, <span class="hljs-keyword">size_t</span> sym, <span class="hljs-keyword">int</span> len,
                         <span class="hljs-keyword">uint16_t</span> codeword)</span>
</span>{
        <span class="hljs-keyword">int</span> pad_len;
        <span class="hljs-keyword">uint16_t</span> padding, index;<font></font>
<font></font>
        assert(len &lt;= HUFFMAN_LOOKUP_TABLE_BITS);<font></font>
<font></font>
        codeword = reverse16(codeword, len); <span class="hljs-comment">/* Make it LSB-first. */</span><font></font>
        pad_len = HUFFMAN_LOOKUP_TABLE_BITS - len;<font></font>
<font></font>
        <span class="hljs-comment">/* Pad the pad_len upper bits with all bit combinations. */</span>
        <span class="hljs-keyword">for</span> (padding = <span class="hljs-number">0</span>; padding &lt; (<span class="hljs-number">1U</span> &lt;&lt; pad_len); padding++) {<font></font>
                index = (<span class="hljs-keyword">uint16_t</span>)(codeword | (padding &lt;&lt; len));<font></font>
                d-&gt;table[index].sym = (<span class="hljs-keyword">uint16_t</span>)sym;<font></font>
                d-&gt;table[index].len = (<span class="hljs-keyword">uint16_t</span>)len;<font></font>
<font></font>
                assert(d-&gt;table[index].sym == sym &amp;&amp; <span class="hljs-string">"Fits in bitfield."</span>);<font></font>
                assert(d-&gt;table[index].len == len &amp;&amp; <span class="hljs-string">"Fits in bitfield."</span>);<font></font>
        }<font></font>
}<font></font>
</code></pre><br>
<a name="10"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╡рд╛ рдирд┐рдХрд╛рд▓рдирд╛</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deflate рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо, 1993 рдореЗрдВ PKZip 2.04c рдореЗрдВ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЖрдзреБрдирд┐рдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдПрдХ рдорд╛рдирдХ рд╕рдВрдкреАрдбрд╝рди рд╡рд┐рдзрд┐ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ gzip, PNG рдФрд░ рдХрдИ рдЕрдиреНрдп рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ LZ77 рд╕рдВрдкреАрдбрд╝рди рдФрд░ рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рдЗрд╕ рдЦрдВрдб рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗ рдФрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deflate рд╕реЗ рдкрд╣рд▓реЗ, PKZip рдиреЗ Shrink, Reduce, рдФрд░ Implode рд╕рдВрдкреАрдбрд╝рди рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЖрдЬ рд╡реЗ рджреБрд░реНрд▓рдн рд╣реИрдВ, рд╣рд╛рд▓рд╛рдБрдХрд┐ рдбреЗрдлрд▓реЗрдЯ рдХреЗ рдмрд╛рдж рднреА рдХреБрдЫ рд╕рдордп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдореЗрдВ рдереЗ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдХрдо рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрднреЛрдЧ рдХрд░рддреЗ рдереЗред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рд╣рдо рдЙрди рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<a name="11"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯ рд╕реНрдЯреНрд░реАрдо</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрд▓рдПрд╕рдмреА-рдкреНрд░рдердо рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╣рдлрд╝рдореИрди рдХреЛрдбрд╡рд░реНрдб рдХреЛ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рдкрд╣рд▓рд╛ рдмрд┐рдЯ рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯ рдХреЗ рдХрдо рд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ (рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ рдкрдврд╝реЗрдВ) 1-0-0-1-1ред рдЬрдм рдЗрд╕реЗ рдПрд▓рдПрд╕рдмреА-рдкрд╣рд▓реЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдмрд╛рдЗрдЯ рдорд╛рди 0b00011001 (рдмрд╛рдЗрдирд░реА) рдпрд╛ 0x19 (рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓) рдмрди рдЬрд╛рддрд╛ рд╣реИред рдРрд╕рд╛ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдзрд╛рд░рд╛ рдХреЛ рдХреЗрд╡рд▓ рдкреАрдЫреЗ рдХреА рдУрд░ (рдПрдХ рдЕрд░реНрде рдореЗрдВ, рдпрд╣ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ) рд╣реИ, рд▓реЗрдХрд┐рди рдлрд╛рдпрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдХрдВрдкреНрдпреВрдЯрд░ рд╢рдмреНрдж рд╕реЗ рдкрд╣рд▓рд╛ рдПрди рдмрд┐рдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдЖрд╕рд╛рди рд╣реИ: рд╣рдо рдмрд╕ рдПрди рдХрдо рд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯреНрд╕ рдХреЛ рдЫрд┐рдкрд╛рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рд▓реА рдЧрдИ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Input bitstream. */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">istream_t</span> <span class="hljs-title">istream_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">istream_t</span> {</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src;  <span class="hljs-comment">/* Source bytes. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *end;  <span class="hljs-comment">/* Past-the-end byte of src. */</span>
        <span class="hljs-keyword">size_t</span> bitpos;       <span class="hljs-comment">/* Position of the next bit to read. */</span>
        <span class="hljs-keyword">size_t</span> bitpos_end;   <span class="hljs-comment">/* Position of past-the-end bit. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize an input stream to present the n bytes from src as an LSB-first
 * bitstream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">istream_init</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        is-&gt;src = src;<font></font>
        is-&gt;end = src + n;<font></font>
        is-&gt;bitpos = <span class="hljs-number">0</span>;<font></font>
        is-&gt;bitpos_end = n * <span class="hljs-number">8</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░реЗ рд╣рдлрд╝рдореИрди рдбрд┐рдХреЛрдбрд░ рдХреЛ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмрд┐рдЯреНрд╕ рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рд╕рдВрднрд╡ рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рдХреЛрдбрд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдмрд┐рдЯреНрд╕), рдФрд░ рдлрд┐рд░ рдбрд┐рдХреЛрдб рдХрд┐рдП рдЧрдП рдкреНрд░рддреАрдХ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдмрд┐рдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреНрд╡рд╛рд░рд╛ рд╕реНрдЯреНрд░реАрдо рдЬрд╛рд░реА рд░рдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ISTREAM_MIN_BITS (64 - 7)</span><font></font>
<font></font>
<span class="hljs-comment">/* Get the next bits from the input stream. The number of bits returned is
 * between ISTREAM_MIN_BITS and 64, depending on the position in the stream, or
 * fewer if the end of stream is reached. The upper bits are zero-padded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">istream_bits</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">istream_t</span> *is)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *next;
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">int</span> i;<font></font>
<font></font>
        next = is-&gt;src + (is-&gt;bitpos / <span class="hljs-number">8</span>);<font></font>
<font></font>
        assert(next &lt;= is-&gt;end &amp;&amp; <span class="hljs-string">"Cannot read past end of stream."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (is-&gt;end - next &gt;= <span class="hljs-number">8</span>) {
                <span class="hljs-comment">/* Common case: read 8 bytes in one go. */</span><font></font>
                bits = read64le(next);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">/* Read the available bytes and zero-pad. */</span>
                bits = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; is-&gt;end - next; i++) {<font></font>
                        bits |= (<span class="hljs-keyword">uint64_t</span>)next[i] &lt;&lt; (i * <span class="hljs-number">8</span>);<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> bits &gt;&gt; (is-&gt;bitpos % <span class="hljs-number">8</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Advance n bits in the bitstream if possible. Returns false if that many bits
 * are not available in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">istream_advance</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">size_t</span> n)</span> </span>{
        <span class="hljs-keyword">if</span> (is-&gt;bitpos + n &gt; is-&gt;bitpos_end) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        is-&gt;bitpos += n;<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓рдмреНрдмреЛрд▓реБрдЖрдм рдпрд╣ рд╣реИ рдХрд┐ 64-рдмрд┐рдЯ рдорд╢реАрдиреЛрдВ рдкрд░ </font></font><code>istream_bits</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдЖрдорддреМрд░ рдкрд░ рдПрдХрд▓-рдмреВрдЯ рдирд┐рд░реНрджреЗрд╢ рдФрд░ рдХреБрдЫ рдЕрдВрдХрдЧрдгрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рддрддреНрд╡ </font></font><code>istream_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╣реИрдВред </font><font style="vertical-align: inherit;">read64le рдмрд┐рдЯреНрд╕ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧрдпрд╛ рд╣реИред</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдЖрдзреБрдирд┐рдХ рд╕рдВрдХрд▓рдХ рдЗрд╕реЗ рдЫреЛрдЯреЗ-рдПрдВрдбрд┐рдпрди рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ 64-рдмрд┐рдЯ рдбрд╛рдЙрдирд▓реЛрдб рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╣реИрдВ):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Read a 64-bit value from p in little-endian byte order. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">uint64_t</span> <span class="hljs-title">read64le</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p)</span>
</span>{
        <span class="hljs-comment">/* The one true way, see
         * https://commandcenter.blogspot.com/2012/04/byte-order-fallacy.html */</span>
        <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">0</span>)  |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-number">8</span>)  |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">16</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">3</span>] &lt;&lt; <span class="hljs-number">24</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">32</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">5</span>] &lt;&lt; <span class="hljs-number">40</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">6</span>] &lt;&lt; <span class="hljs-number">48</span>) |<font></font>
               ((<span class="hljs-keyword">uint64_t</span>)p[<span class="hljs-number">7</span>] &lt;&lt; <span class="hljs-number">56</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдореЗрдВ рдЕрдЧрд▓реЗ рдмрд╛рдЗрдЯ рдХреА рд╕реАрдорд╛ рддрдХ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Round x up to the next multiple of m, which must be a power of 2. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">round_up</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> x, <span class="hljs-keyword">size_t</span> m)</span>
</span>{<font></font>
        assert((m &amp; (m - <span class="hljs-number">1</span>)) == <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">"m must be a power of two"</span>);
        <span class="hljs-keyword">return</span> (x + m - <span class="hljs-number">1</span>) &amp; (<span class="hljs-keyword">size_t</span>)(-m); <span class="hljs-comment">/* Hacker's Delight (2nd), 3-1. */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Align the input stream to the next 8-bit boundary and return a pointer to
 * that byte, which may be the past-the-end-of-stream byte. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">istream_byte_align</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *byte;<font></font>
<font></font>
        assert(is-&gt;bitpos &lt;= is-&gt;bitpos_end &amp;&amp; <span class="hljs-string">"Not past end of stream."</span>);<font></font>
<font></font>
        is-&gt;bitpos = round_up(is-&gt;bitpos, <span class="hljs-number">8</span>);<font></font>
        byte = is-&gt;src + is-&gt;bitpos / <span class="hljs-number">8</span>;<font></font>
        assert(byte &lt;= is-&gt;end);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> byte;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдХреЗ рд▓рд┐рдП, рд╣рдо рд░реАрдб-рдореЙрдбрд┐рдлрд╛рдИ-рд░рд╛рдЗрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд┐рдЯреНрд╕ рд▓рд┐рдЦрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рддреНрд╡рд░рд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЖрдк 64-рдмрд┐рдЯ рд░реАрдб, рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд┐рдЯ рдСрдкрд░реЗрд╢рди рдФрд░ 64-рдмрд┐рдЯ рд▓реЗрдЦрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдереЛрдбрд╝рд╛ рд▓рд┐рдЦ тАЛтАЛрд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output bitstream. */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ostream_t</span> <span class="hljs-title">ostream_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ostream_t</span> {</span>
        <span class="hljs-keyword">uint8_t</span> *dst;
        <span class="hljs-keyword">uint8_t</span> *end;
        <span class="hljs-keyword">size_t</span> bitpos;
        <span class="hljs-keyword">size_t</span> bitpos_end;<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize an output stream to write LSB-first bits into dst[0..n-1]. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ostream_init</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os, <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        os-&gt;dst = dst;<font></font>
        os-&gt;end = dst + n;<font></font>
        os-&gt;bitpos = <span class="hljs-number">0</span>;<font></font>
        os-&gt;bitpos_end = n * <span class="hljs-number">8</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Get the current bit position in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">ostream_bit_pos</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">ostream_t</span> *os)</span>
</span>{
        <span class="hljs-keyword">return</span> os-&gt;bitpos;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Return the number of bytes written to the output buffer. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">ostream_bytes_written</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os)</span>
</span>{
        <span class="hljs-keyword">return</span> round_up(os-&gt;bitpos, <span class="hljs-number">8</span>) / <span class="hljs-number">8</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Write n bits to the output stream. Returns false if there is not enough room
 * at the destination. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ostream_write</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os, <span class="hljs-keyword">uint64_t</span> bits, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint64_t</span> x;
        <span class="hljs-keyword">int</span> shift, i;<font></font>
<font></font>
        assert(n &lt;= <span class="hljs-number">57</span>);<font></font>
        assert(bits &lt;= ((<span class="hljs-keyword">uint64_t</span>)<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-string">"Must fit in n bits."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (os-&gt;bitpos_end - os-&gt;bitpos &lt; n) {
                <span class="hljs-comment">/* Not enough room. */</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;os-&gt;dst[os-&gt;bitpos / <span class="hljs-number">8</span>];<font></font>
        shift = os-&gt;bitpos % <span class="hljs-number">8</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (os-&gt;end - p &gt;= <span class="hljs-number">8</span>) {
                <span class="hljs-comment">/* Common case: read and write 8 bytes in one go. */</span><font></font>
                x = read64le(p);<font></font>
                x = lsb(x, shift);<font></font>
                x |= bits &lt;&lt; shift;<font></font>
                write64le(p, x);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">/* Slow case: read/write as many bytes as are available. */</span>
                x = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; os-&gt;end - p; i++) {<font></font>
                        x |= (<span class="hljs-keyword">uint64_t</span>)p[i] &lt;&lt; (i * <span class="hljs-number">8</span>);<font></font>
                }<font></font>
                x = lsb(x, shift);<font></font>
                x |= bits &lt;&lt; shift;<font></font>
                <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; os-&gt;end - p; i++) {<font></font>
                        p[i] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; (i * <span class="hljs-number">8</span>));<font></font>
                }<font></font>
        }<font></font>
<font></font>
        os-&gt;bitpos += n;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Write a 64-bit value x to dst in little-endian byte order. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write64le</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">uint64_t</span> x)</span>
</span>{<font></font>
        dst[<span class="hljs-number">0</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">0</span>);<font></font>
        dst[<span class="hljs-number">1</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">8</span>);<font></font>
        dst[<span class="hljs-number">2</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">16</span>);<font></font>
        dst[<span class="hljs-number">3</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">24</span>);<font></font>
        dst[<span class="hljs-number">4</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">32</span>);<font></font>
        dst[<span class="hljs-number">5</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">40</span>);<font></font>
        dst[<span class="hljs-number">6</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">48</span>);<font></font>
        dst[<span class="hljs-number">7</span>] = (<span class="hljs-keyword">uint8_t</span>)(x &gt;&gt; <span class="hljs-number">56</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдореЗрдВ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдХреБрд╢рд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рд┐рдЦрдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдмреЗрд╢рдХ, рдЖрдк рдмрд╛рд░-рдмрд╛рд░ 8-рдмрд┐рдЯ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд╣реБрдд рддреЗрдЬрд╝ рд╣реЛрдЧрд╛ </font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Align the bitstream to the next byte boundary, then write the n bytes from
   src to it. Returns false if there is not enough room in the stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ostream_write_bytes_aligned</span><span class="hljs-params">(<span class="hljs-keyword">ostream_t</span> *os,
                                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src,
                                               <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">if</span> (os-&gt;bitpos_end - round_up(os-&gt;bitpos, <span class="hljs-number">8</span>) &lt; n * <span class="hljs-number">8</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        os-&gt;bitpos = round_up(os-&gt;bitpos, <span class="hljs-number">8</span>);
        <span class="hljs-built_in">memcpy</span>(&amp;os-&gt;dst[os-&gt;bitpos / <span class="hljs-number">8</span>], src, n);<font></font>
        os-&gt;bitpos += n * <span class="hljs-number">8</span>;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="12"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдирдкреИрдХрд┐рдВрдЧ (рдореБрджреНрд░рд╛рд╕реНрдлреАрддрд┐)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЪреВрдВрдХрд┐ рд╕рдВрдкреАрдбрд╝рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдлреНрд▓реИрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">- </font><i><font style="vertical-align: inherit;">рдЙрдбрд╝рд╛рдирд╛</font></i><font style="vertical-align: inherit;"> , рдХрд┐рд╕реА рдЪреАрдЬ рд╕реЗ рд╣рд╡рд╛ рдирд┐рдХрд╛рд▓рдирд╛ - рдЕрдирдкреИрдХрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрднреА-рдХрднреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрджреНрд░рд╛рд╕реНрдлреАрддрд┐</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдЖрдк рдкрд╣рд▓реА рдмрд╛рд░ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╕рдордЭреЗрдВрдЧреЗ рдХрд┐ рдкреНрд░рд╛рд░реВрдк рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЖрдк рдХреЛрдб рдХреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deflate.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deflate.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tables.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tables.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">Generate_tables.c</font></a><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрддреНрдкрдиреНрди</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deflate рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рдбреЗрдЯрд╛ рдХреЛ </font><i><font style="vertical-align: inherit;">рдмреНрд▓реЙрдХ</font></i><font style="vertical-align: inherit;"> рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ 3-рдмрд┐рдЯ рд╣реЗрдбрд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкрд╣рд▓рд╛ (рд╕рдмрд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг) рдмрд┐рдЯ рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ рдпрджрд┐ рдпрд╣ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдЕрдВрддрд┐рдо рдмреНрд▓реЙрдХ рд╣реИ, рдФрд░ рдЕрдиреНрдп рджреЛ рдмрд┐рдЯреНрд╕ рдЗрд╕рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/875/b36/1fd/875b361fd3414431d2a20d1ab0b6ef8b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдмреНрд▓реЙрдХ рд╣реИрдВ: рдЕрд╕рдореНрдкреАрдбрд┐рдд (0), рдирд┐рд╢реНрдЪрд┐рдд рд╣рдлрд╝рдореИрди рдХреЛрдб (1) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдФрд░ "рдбрд╛рдпрдиреЗрдорд┐рдХ" рд╣рдлрд╝рдореИрди рдХреЛрдб (2) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдкреАрдбрд╝рд┐рддред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХреЛрдб рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдмреНрд▓реЙрдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдирдкреИрдХрд┐рдВрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рдмрд╛рдж рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> {<font></font>
        HWINF_OK,   <span class="hljs-comment">/* Inflation was successful. */</span>
        HWINF_FULL, <span class="hljs-comment">/* Not enough room in the output buffer. */</span>
        HWINF_ERR   <span class="hljs-comment">/* Error in the input data. */</span>
} <span class="hljs-keyword">inf_stat_t</span>;<font></font>
<font></font>
<span class="hljs-comment">/* Decompress (inflate) the Deflate stream in src. The number of input bytes
   used, at most src_len, is stored in *src_used on success. Output is written
   to dst. The number of bytes written, at most dst_cap, is stored in *dst_used
   on success. src[0..src_len-1] and dst[0..dst_cap-1] must not overlap.
   Returns a status value as defined above. */</span>
<span class="hljs-function"><span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">hwinflate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len, <span class="hljs-keyword">size_t</span> *src_used,
                     <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_used)</span>
</span>{
        <span class="hljs-keyword">istream_t</span> is;
        <span class="hljs-keyword">size_t</span> dst_pos;
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">bool</span> bfinal;
        <span class="hljs-keyword">inf_stat_t</span> s;<font></font>
<font></font>
        istream_init(&amp;is, src, src_len);<font></font>
        dst_pos = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">do</span> {
                <span class="hljs-comment">/* Read the 3-bit block header. */</span><font></font>
                bits = istream_bits(&amp;is);<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(&amp;is, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                bfinal = bits &amp; <span class="hljs-number">1</span>;<font></font>
                bits &gt;&gt;= <span class="hljs-number">1</span>;<font></font>
<font></font>
                <span class="hljs-keyword">switch</span> (lsb(bits, <span class="hljs-number">2</span>)) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">/* 00: No compression. */</span><font></font>
                        s = inf_noncomp_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">/* 01: Compressed with fixed Huffman codes. */</span><font></font>
                        s = inf_fixed_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">/* 10: Compressed with "dynamic" Huffman codes. */</span><font></font>
                        s = inf_dyn_block(&amp;is, dst, dst_cap, &amp;dst_pos);<font></font>
                        <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>: <span class="hljs-comment">/* Invalid block type. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (s != HWINF_OK) {
                        <span class="hljs-keyword">return</span> s;<font></font>
                }<font></font>
        } <span class="hljs-keyword">while</span> (!bfinal);<font></font>
<font></font>
        *src_used = (<span class="hljs-keyword">size_t</span>)(istream_byte_align(&amp;is) - src);<font></font>
<font></font>
        assert(dst_pos &lt;= dst_cap);<font></font>
        *dst_used = dst_pos;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="13"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╕рдореНрдмрджреНрдз рдЦрдВрдб рдЦрдВрдб</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпреЗ "рд╕рдВрдЧреНрд░рд╣рд┐рдд" рдмреНрд▓реЙрдХ рд╣реИрдВ, рд╕рдмрд╕реЗ рд╕рд░рд▓ рдкреНрд░рдХрд╛рд░ред </font><font style="vertical-align: inherit;">рдпрд╣ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдХреА рдЕрдЧрд▓реА 8-рдмрд┐рдЯ рд╕реАрдорд╛ рдХреЗ рд╕рд╛рде 16-рдмрд┐рдЯ рд╢рдмреНрдж (рд▓реЗрди) рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдмреНрд▓реЙрдХ рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдкреАрдЫреЗ рдПрдХ рдФрд░ 16-рдмрд┐рдЯ рд╢рдмреНрдж (рдПрдирдПрд▓рдПрди) рд╣реИ, рдЬреЛ рдЬреЗрди рд╢рдмреНрдж рдХрд╛ рд╕рдВрдХрд▓рди (рдмрд┐рдЯреНрд╕ рдХрд╛ рдХреНрд░рдо рдЙрд▓реНрдЯрд╛) рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдирдПрд▓рдПрди рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд▓реЗрди рдЪреЗрдХрд╕рдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ: рдпрджрд┐ рдлрд╝рд╛рдЗрд▓ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рд╣реИ, рддреЛ рдорд╛рди рд╢рд╛рдпрдж рдкреВрд░рдХ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдПрдХ рддреНрд░реБрдЯрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0e1/eb8/15b/0e1eb815b2dfec1edb50eeafd1291cc5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрди рдФрд░ nlen рдХреЗ рдмрд╛рдж рдбреЗрдЯрд╛ рдЕрд╕рдореНрдкреАрдбрд┐рдд рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдмреНрд▓реЙрдХ рдХреА рд▓рдВрдмрд╛рдИ 16-рдмрд┐рдЯ рдорд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ 65,535 рдмрд╛рдЗрдЯреНрд╕ рддрдХ рд╕реАрдорд┐рдд рд╣реИред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_noncomp_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                    <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint16_t</span> len, nlen;<font></font>
<font></font>
        p = istream_byte_align(is);<font></font>
<font></font>
        <span class="hljs-comment">/* Read len and nlen (2 x 16 bits). */</span>
        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">32</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* Not enough input. */</span><font></font>
        }<font></font>
        len  = read16le(p);<font></font>
        nlen = read16le(p + <span class="hljs-number">2</span>);<font></font>
        p += <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (nlen != (<span class="hljs-keyword">uint16_t</span>)~len) {
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!istream_advance(is, len * <span class="hljs-number">8</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* Not enough input. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (dst_cap - *dst_pos &lt; len) {
                <span class="hljs-keyword">return</span> HWINF_FULL; <span class="hljs-comment">/* Not enough room to output. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">memcpy</span>(&amp;dst[*dst_pos], p, len);<font></font>
        *dst_pos += len;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="14"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рдЦрдВрдбрд┐рдд рдХрд░реЗрдВ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдВрдХреБрдЪрд┐рдд рдЦрдВрдбрди рдЦрдВрдб HZman рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ LZ77 рд╢рд╛рдмреНрджрд┐рдХ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдмреНрд▓реЙрдХ рдПрдВрдб рдорд╛рд░реНрдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреЛ рддреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╢рд╛рдмреНрджрд┐рдХ, рдмреИрдХрд▓рд┐рдВрдХ рд▓рдВрдмрд╛рдИ рдФрд░ рдорд╛рд░реНрдХрд░ рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдЯрд▓рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ </font><i><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдФрд░ рдмреИрдХрд▓рд┐рдВрдХ рджреВрд░реА рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рд╕реНрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c35/0e1/a8c/c350e1a8c73f69203949ccc534141497.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓рд┐рдЯрд▓реЗрди 0-285 рдХреА рд╕реАрдорд╛ рдореЗрдВ рдорд╛рдиреЛрдВ рдХреЛ рдПрдирдХреЛрдб рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдорд╛рди 0-255 рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢рд╛рдмреНрджрд┐рдХ рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, 256 рдЕрдВрдд-рдСрдл-рдмреНрд▓реЙрдХ рдорд╛рд░реНрдХрд░ рд╣реИ, рдФрд░ 257-285 рдмреИрдХрд▓рд┐рдВрдХ рд▓рдВрдмрд╛рдИ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреИрдХрд▓рд┐рдВрдХреНрд╕ 3-258 рдмрд╛рдЗрдЯреНрд╕ рд▓рдВрдмреЗ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд▓рд┐рдЯрд▓реЗрди рдореВрд▓реНрдп рдЖрдзрд╛рд░ рдХреА рд▓рдВрдмрд╛рдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ </font><font style="vertical-align: inherit;">рдиреАрдЪреЗ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдкреВрд░реНрдг рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font><font style="vertical-align: inherit;">рдзрд╛рд░рд╛ рд╕реЗ рд╢реВрдиреНрдп рдпрд╛ рдЕрдзрд┐рдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 269 рдХреЗ рдПрдХ рд▓рд┐рдЯрд▓рди рдорд╛рди рдХрд╛ рдЕрд░реНрде рд╣реИ рдЖрдзрд╛рд░ рдХреА рд▓рдВрдмрд╛рдИ 19 рдФрд░ рджреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕ред </font><font style="vertical-align: inherit;">рдзрд╛рд░рд╛ рд╕реЗ рджреЛ рдмрд┐рдЯреНрд╕ рдХрд╛ рдЬреЛрдбрд╝ 19 рд╕реЗ 22 рддрдХ рдЕрдВрддрд┐рдо рд▓рдВрдмрд╛рдИ рджреЗрддрд╛ рд╣реИред</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Litlen</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рдВрдмрд╛рдИ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">258</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">259</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">260</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">261</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">262</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">263</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">264</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">265</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11-12</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">266</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13-14</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">267</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15-16</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">268</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17-18</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">269</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19-22</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">270</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23-26</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">271</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27-30</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">272</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">31-34</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">273</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">35-42</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">274</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">43-50</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">275</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">51-58</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">276</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">59-66</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">277</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">67-82</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">278</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">83-98</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">279</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99-114</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">280</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">115-130</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">281</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">131-162</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">282</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">163-194</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">283</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">195-226</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">284</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">227-257</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">285</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">258</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ 284 рдкреНрд▓рд╕ 5 рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕ рдХрд╛ рдПрдХ рд▓рд┐рдЯрд▓рди рдорд╛рди 227 рд╕реЗ 258 рддрдХ рдХреА рд▓рдВрдмрд╛рдИ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд▓рдВрдмрд╛рдИ 258 - рдмреИрдХрд▓рд┐рдВрдХ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ - рдПрдХ рдЕрд▓рдЧ рд▓рд┐рдЯреНрд▓рд┐рди рдореВрд▓реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджрд░реНрд╢рд╛рдИ рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣ рдЙрди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдХреЛрдбрд┐рдВрдЧ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдЕрдХреНрд╕рд░ рд╕рд╛рдордирд╛ рд╣реЛрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбреАрдХрдВрдкреНрд░реЗрд╕рд░ рд▓рд┐рдЯрд▓рди рдорд╛рди (рдмреЗрд╕ 257) рд╕реЗ рдмреЗрд╕ рдХреА рд▓рдВрдмрд╛рдИ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Table of litlen symbol values minus 257 with corresponding base length
   and number of extra bits. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">litlen_tbl_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> base_len : <span class="hljs-number">9</span>;
        <span class="hljs-keyword">uint16_t</span> ebits : <span class="hljs-number">7</span>;<font></font>
};<font></font>
<span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">litlen_tbl_t</span> <span class="hljs-title">litlen_tbl</span>[29] = {</span>
<span class="hljs-comment">/* 257 */</span> { <span class="hljs-number">3</span>, <span class="hljs-number">0</span> },
<span class="hljs-comment">/* 258 */</span> { <span class="hljs-number">4</span>, <span class="hljs-number">0</span> },<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 284 */</span> { <span class="hljs-number">227</span>, <span class="hljs-number">5</span> },
<span class="hljs-comment">/* 285 */</span> { <span class="hljs-number">258</span>, <span class="hljs-number">0</span> }<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрд╝рдореИрди рдХрд╛ рдирд┐рд╢реНрдЪрд┐рдд рд▓рд┐рдЯрд▓рди рдХреЛрдб рдХреИрдиреЛрдирд┐рдХрд▓ рд╣реИ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (286-287 рдорд╛рдиреНрдп рд▓рд┐рдЯрд▓рди рдорд╛рди рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдХреЛрдб рдкреАрдврд╝реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ):</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдЯрд▓рди рдорд╛рди</font></font></strong></td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-143</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">144-255</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">256-279</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">280-287</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбреАрдХрдВрдкреНрд░реЗрд╕рд░ рдЗрди рд▓рдВрдмрд╛рдИ рдХреЛ рд╕рдВрдЪрд░рдг рдХреЗ рд▓рд┐рдП рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ </font></font><code>huffman_decoder_init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> fixed_litlen_lengths[<span class="hljs-number">288</span>] = {
<span class="hljs-comment">/*   0 */</span> <span class="hljs-number">8</span>,
<span class="hljs-comment">/*   1 */</span> <span class="hljs-number">8</span>,<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 287 */</span> <span class="hljs-number">8</span>,<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреИрдХрд▓рд┐рдВрдХ рдХреА рджреВрд░реА 1 рд╕реЗ 32,768 рддрдХ рд╣реЛрддреА рд╣реИред рд╡реЗ рдПрдХ рдРрд╕реА рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреЛрдбреЗрдб рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рд▓рдВрдмрд╛рдИ рдХреЛрдбрд┐рдВрдЧ рдпреЛрдЬрдирд╛ рдХреЗ рд╕рдорд╛рди рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдлрд╝рдореИрди рдХреЛрдб рдбрд┐рд╕реНрдЯреНрд░реЗрд╕ рдорд╛рдиреЛрдВ рдХреЛ 0 рд╕реЗ 29 рддрдХ рдПрдиреНрдХреЛрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЖрдзрд╛рд░ рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЕрдВрддрд┐рдо рджреВрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕ рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рд▓рд╛</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рдЯреНрд╕</font></font></strong></td>
<td width="200"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд░рд┐рдпрд╛рдВ</font></font></strong></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5-6</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7-8</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9-12</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13-16</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17-24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25-32</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">33-48</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрдпрд╛рд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">49-64</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">65-96</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЗрд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">97-128</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">129-192</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдВрджреНрд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">193-256</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЛрд▓рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">257-384</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">385-512</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдард╛рд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">513-768</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдиреНрдиреАрд╕</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">769-1024</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреАрд╕</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1025-1536</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1537-2048</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2049-3072</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3073-4096</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрдпрд╛рд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4097-6144</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреНрдпрд╛рд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6145-8192</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,193-12,288</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12,289-16,384</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЗрд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16,385-24,576</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">29 рд╡реЗрдВ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддреЗрд░рд╣</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24,577-32,768</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрдореИрди рдХрд╛ рдирд┐рд╢реНрдЪрд┐рдд рдХреЛрдб рдбрд┐рд╕реНрдЯреЗрдВрд╕рд┐рдХ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рднреА рдХреЛрдбрд╡рд░реНрдб 5 рдмрд┐рдЯ рд▓рдВрдмреЗ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдпрд╣ рд╕рд░рд▓ рд╣реИ, рдбреАрдХрдВрдкреНрд░реЗрд╕рд░ рдХреЛрдб рдХреЛ рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font></font><code>huffman_decoder_init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рдбрд┐рд╕реНрдЯ рдорд╛рди 30-31 рд╕рд╣реА рдирд╣реАрдВ рд╣реИрдВред рдпрд╣ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рд╣рдлрд╝рдореИрди рдХреЛрдб рдХреА рдкреАрдврд╝реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕рдХрд╛ рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реИ):</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> fixed_dist_lengths[<span class="hljs-number">32</span>] = {
<span class="hljs-comment">/*  0 */</span> <span class="hljs-number">5</span>,
<span class="hljs-comment">/*  1 */</span> <span class="hljs-number">5</span>,<font></font>
<font></font>
...<font></font>
<font></font>
<span class="hljs-comment">/* 31 */</span> <span class="hljs-number">5</span>,<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдкрдШрдЯрди рдпрд╛ рдЕрдирдкреИрдХрд┐рдВрдЧ рдХреЛрдб - рдирд┐рд╢реНрдЪрд┐рдд рд╣рдлрдореИрди рдХреЛрдбреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдб рдХреЛ рдЦрдВрдбрд┐рдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_fixed_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                  <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">huffman_decoder_t</span> litlen_dec, dist_dec;<font></font>
<font></font>
        huffman_decoder_init(&amp;litlen_dec, fixed_litlen_lengths,<font></font>
                             <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths) /
                             <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths[<span class="hljs-number">0</span>]));<font></font>
        huffman_decoder_init(&amp;dist_dec, fixed_dist_lengths,<font></font>
                             <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths) /
                             <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths[<span class="hljs-number">0</span>]));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> inf_block(is, dst, dst_cap, dst_pos, &amp;litlen_dec, &amp;dist_dec);<font></font>
}<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_EOB 256</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_MAX 285</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LITLEN_TBL_OFFSET 257</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_LEN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_LEN 258</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DISTSYM_MAX 29</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_DISTANCE 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_DISTANCE 32768</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_cap,
                            <span class="hljs-keyword">size_t</span> *dst_pos,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *litlen_dec,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_decoder_t</span> *dist_dec)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">size_t</span> used, used_tot, dist, len;
        <span class="hljs-keyword">int</span> litlen, distsym;
        <span class="hljs-keyword">uint16_t</span> ebits;<font></font>
<font></font>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">/* Read a litlen symbol. */</span><font></font>
                bits = istream_bits(is);<font></font>
                litlen = huffman_decode(litlen_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                used_tot = used;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (litlen &lt; <span class="hljs-number">0</span> || litlen &gt; LITLEN_MAX) {
                        <span class="hljs-comment">/* Failed to decode, or invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (litlen &lt;= UINT8_MAX) {
                        <span class="hljs-comment">/* Literal. */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">if</span> (*dst_pos == dst_cap) {
                                <span class="hljs-keyword">return</span> HWINF_FULL;<font></font>
                        }<font></font>
                        lz77_output_lit(dst, (*dst_pos)++, (<span class="hljs-keyword">uint8_t</span>)litlen);
                        <span class="hljs-keyword">continue</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (litlen == LITLEN_EOB) {
                        <span class="hljs-comment">/* End of block. */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* It is a back reference. Figure out the length. */</span><font></font>
                assert(litlen &gt;= LITLEN_TBL_OFFSET &amp;&amp; litlen &lt;= LITLEN_MAX);<font></font>
                len   = litlen_tbl[litlen - LITLEN_TBL_OFFSET].base_len;<font></font>
                ebits = litlen_tbl[litlen - LITLEN_TBL_OFFSET].ebits;<font></font>
                <span class="hljs-keyword">if</span> (ebits != <span class="hljs-number">0</span>) {<font></font>
                        len += lsb(bits, ebits);<font></font>
                        bits &gt;&gt;= ebits;<font></font>
                        used_tot += ebits;<font></font>
                }<font></font>
                assert(len &gt;= MIN_LEN &amp;&amp; len &lt;= MAX_LEN);<font></font>
<font></font>
                <span class="hljs-comment">/* Get the distance. */</span>
                distsym = huffman_decode(dist_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                used_tot += used;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (distsym &lt; <span class="hljs-number">0</span> || distsym &gt; DISTSYM_MAX) {
                        <span class="hljs-comment">/* Failed to decode, or invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                dist  = dist_tbl[distsym].base_dist;<font></font>
                ebits = dist_tbl[distsym].ebits;<font></font>
                <span class="hljs-keyword">if</span> (ebits != <span class="hljs-number">0</span>) {<font></font>
                        dist += lsb(bits, ebits);<font></font>
                        bits &gt;&gt;= ebits;<font></font>
                        used_tot += ebits;<font></font>
                }<font></font>
                assert(dist &gt;= MIN_DISTANCE &amp;&amp; dist &lt;= MAX_DISTANCE);<font></font>
<font></font>
                assert(used_tot &lt;= ISTREAM_MIN_BITS);<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(is, used_tot)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Bounds check and output the backref. */</span>
                <span class="hljs-keyword">if</span> (dist &gt; *dst_pos) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (round_up(len, <span class="hljs-number">8</span>) &lt;= dst_cap - *dst_pos) {<font></font>
                        output_backref64(dst, *dst_pos, dist, len);<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len &lt;= dst_cap - *dst_pos) {<font></font>
                        lz77_output_backref(dst, *dst_pos, dist, len);<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> HWINF_FULL;<font></font>
                }<font></font>
                (*dst_pos) += len;<font></font>
        }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдЕрдиреБрдХреВрд▓рди рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ: рдЬрдм рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдмрдлрд░ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЬрдЧрд╣ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ рд╣рдо рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдЬрд╛рд░реА рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рдмрд╛рд░ рдореЗрдВ 64 рдмрд┐рдЯреНрд╕ рдХреЛ рдХреЙрдкреА рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЗрд╕ рдЕрд░реНрде рдореЗрдВ "рдЧрдбрд╝рдмрдбрд╝" рд╣реИ рдХрд┐ рдпрд╣ рдЕрдХреНрд╕рд░ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд╛рдЗрдЯреНрд╕ (8 рдХреЗ рдЕрдЧрд▓реЗ рдХрдИ рддрдХ) рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </font></font><code>lz77_output_backref</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрдо рдЪрдХреНрд░реАрдп рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдФрд░ рдореЗрдореЛрд░реА рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрдм рдЫреЛрдЯреЗ рдмреИрдХрд▓рд┐рдВрдХреНрд╕ рдХреЛ рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рдмреНрд░рд╛рдВрдЪрд┐рдВрдЧ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реИред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Output the (dist,len) backref at dst_pos in dst using 64-bit wide writes.
   There must be enough room for len bytes rounded to the next multiple of 8. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">output_backref64</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">size_t</span> dst_pos, <span class="hljs-keyword">size_t</span> dist,
                             <span class="hljs-keyword">size_t</span> len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint64_t</span> tmp;<font></font>
<font></font>
        assert(len &gt; <span class="hljs-number">0</span>);<font></font>
        assert(dist &lt;= dst_pos &amp;&amp; <span class="hljs-string">"cannot reference before beginning of dst"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (len &gt; dist) {
                <span class="hljs-comment">/* Self-overlapping backref; fall back to byte-by-byte copy. */</span><font></font>
                lz77_output_backref(dst, dst_pos, dist, len);<font></font>
                <span class="hljs-keyword">return</span>;<font></font>
        }<font></font>
<font></font>
        i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">do</span> {
                <span class="hljs-built_in">memcpy</span>(&amp;tmp, &amp;dst[dst_pos - dist + i], <span class="hljs-number">8</span>);
                <span class="hljs-built_in">memcpy</span>(&amp;dst[dst_pos + i], &amp;tmp, <span class="hljs-number">8</span>);<font></font>
                i += <span class="hljs-number">8</span>;<font></font>
        } <span class="hljs-keyword">while</span> (i &lt; len);<font></font>
}<font></font>
</code></pre><br>
<a name="15"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд╛рдпрдиреЗрдорд┐рдХ рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд╛рдпрдирд╛рдорд┐рдХ рд╣рдлрд╝рдореИрди рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ рдЦрдВрдбрд┐рдд рдХрд░рдирд╛ рдЙрд╕реА рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╣реИред рд▓реЗрдХрд┐рди litlen рдФрд░ dist рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреЛрдб рдХреЗ рдмрдЬрд╛рдп, рд╡реЗ рдмреНрд▓реЙрдХ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реА Deflate рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдирд╛рдо рд╢рд╛рдпрдж рдЕрд╕рдлрд▓ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЧрддрд┐рд╢реАрд▓ рд╣рдлрд╝рдореИрди рдХреЛрдб рдХреЛ рдХреЛрдбрд┐рдВрдЧ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХреЛрдбрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдмрджрд▓ рдЬрд╛рддреЗ рд╣реИрдВ - рдпрд╣ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреБрдХреВрд▓реА рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ рд╣реИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдпрд╣рд╛рдБ рд╡рд░реНрдгрд┐рдд рдХреЛрдб рдХрд╛ рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдХреЛрдИ рд▓реЗрдирд╛-рджреЗрдирд╛ рдирд╣реАрдВ рд╣реИред рд╡реЗ рдХреЗрд╡рд▓ рдЗрд╕ рдЕрд░реНрде рдореЗрдВ рдЧрддрд┐рд╢реАрд▓ рд╣реИрдВ рдХрд┐ рд╡рд┐рднрд┐рдиреНрди рдмреНрд▓реЙрдХ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд╛рдпрдиреЗрдорд┐рдХ рд▓рд┐рдЯреНрд▓рди рдФрд░ рдбрд┐рд╕реНрдЯ рдХреЛрдб рдХреЛ рдЬрдирд░реЗрдЯ рдХрд░рдирд╛ рдбрд┐рдлрд▓реЗрдЯ рдкреНрд░рд╛рд░реВрдк рдХрд╛ рд╕рдмрд╕реЗ рдХрдард┐рди рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред рд▓реЗрдХрд┐рди рдЬреИрд╕реЗ рд╣реА рдХреЛрдб рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рд╡рд┐рдШрдЯрди рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИ, рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП </font></font><code>inf_block</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">inf_dyn_block</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is, <span class="hljs-keyword">uint8_t</span> *dst,
                                <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_pos)</span>
</span>{
        <span class="hljs-keyword">inf_stat_t</span> s;
        <span class="hljs-keyword">huffman_decoder_t</span> litlen_dec, dist_dec;<font></font>
<font></font>
        s = init_dyn_decoders(is, &amp;litlen_dec, &amp;dist_dec);<font></font>
        <span class="hljs-keyword">if</span> (s != HWINF_OK) {
                <span class="hljs-keyword">return</span> s;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> inf_block(is, dst, dst_cap, dst_pos, &amp;litlen_dec, &amp;dist_dec);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд╛рдпрдиреЗрдорд┐рдХ рдбрд┐рд▓реЗрдЯ рдмреНрд▓реЙрдХ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЯрд▓рди рдФрд░ рдбрд┐рд╕реНрдЯ рдХреЛрдб рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рддреАрд╕рд░реЗ рд╣рдлрд╝рдореИрди рдХреЛрдб - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдбреЗрд▓рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рдВрдмрд╛рдИ рд╕реНрд╡рдпрдВ рдПрдиреНрдХреЛрдбреЗрдб рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдХреЛрдб рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ ( </font></font><code>codelen_lens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд </font><font style="vertical-align: inherit;">рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдмреНрд▓реЙрдХ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВ (рдХреНрдпрд╛ рдореИрдВрдиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдореБрд╢реНрдХрд┐рд▓ рд╣реИ)ред</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/84e/1fc/0e3/84e1fc0e3d3cfcb56ff215702d14f73d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрд╛рдпрдирд╛рдорд┐рдХ рдмреНрд▓реЙрдХ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ 14 рдмрд┐рдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд▓рд┐рдЯрд▓реЗрди рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ-, рдбрд┐рд╕реНрдЯ- рдФрд░ рдХреЛрдбреЗрд▓-рд▓реЗрдВрдб рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рдЬрд┐рдиреНрд╣реЗрдВ рдмреНрд▓реЙрдХ рд╕реЗ рдкрдврд╝рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_CODELEN_LENS 4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_CODELEN_LENS 19</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_LITLEN_LENS 257</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_LITLEN_LENS 288</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MIN_DIST_LENS 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_DIST_LENS 32</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_MAX_LIT 15</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY 16</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY_MIN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_COPY_MAX 6</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS 17</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS_MIN 3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS_MAX 10</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2 18</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2_MIN 11</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CODELEN_ZEROS2_MAX 138</span><font></font>
<font></font>
<span class="hljs-comment">/* RFC 1951, 3.2.7 */</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> codelen_lengths_order[MAX_CODELEN_LENS] =<font></font>
{ <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span> };<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inf_stat_t</span> <span class="hljs-title">init_dyn_decoders</span><span class="hljs-params">(<span class="hljs-keyword">istream_t</span> *is,
                                    <span class="hljs-keyword">huffman_decoder_t</span> *litlen_dec,
                                    <span class="hljs-keyword">huffman_decoder_t</span> *dist_dec)</span>
</span>{
        <span class="hljs-keyword">uint64_t</span> bits;
        <span class="hljs-keyword">size_t</span> num_litlen_lens, num_dist_lens, num_codelen_lens;
        <span class="hljs-keyword">uint8_t</span> codelen_lengths[MAX_CODELEN_LENS];
        <span class="hljs-keyword">uint8_t</span> code_lengths[MAX_LITLEN_LENS + MAX_DIST_LENS];
        <span class="hljs-keyword">size_t</span> i, n, used;
        <span class="hljs-keyword">int</span> sym;
        <span class="hljs-keyword">huffman_decoder_t</span> codelen_dec;<font></font>
<font></font>
        bits = istream_bits(is);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of litlen codeword lengths (5 bits + 257). */</span>
        num_litlen_lens = lsb(bits, <span class="hljs-number">5</span>) + MIN_LITLEN_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">5</span>;<font></font>
        assert(num_litlen_lens &lt;= MAX_LITLEN_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of dist codeword lengths (5 bits + 1). */</span>
        num_dist_lens = lsb(bits, <span class="hljs-number">5</span>) + MIN_DIST_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">5</span>;<font></font>
        assert(num_dist_lens &lt;= MAX_DIST_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Number of code length lengths (4 bits + 4). */</span>
        num_codelen_lens = lsb(bits, <span class="hljs-number">4</span>) + MIN_CODELEN_LENS;<font></font>
        bits &gt;&gt;= <span class="hljs-number">4</span>;<font></font>
        assert(num_codelen_lens &lt;= MAX_CODELEN_LENS);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">5</span> + <span class="hljs-number">5</span> + <span class="hljs-number">4</span>)) {
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░ рдХреЛрдбреЗрд▓ рдХреЛрдб рдХреЗ рд▓рд┐рдП рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдЖрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпреЗ рд▓рдВрдмрд╛рдИ рд╕рд╛рдорд╛рдиреНрдп рддреАрди-рдмрд┐рдЯ рдорд╛рди рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╡рд┐рд╢реЗрд╖ рдХреНрд░рдо рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ </font></font><code>codelen_lengths_order</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ 19 рд▓рдВрдмрд╛рдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдХреЗрд╡рд▓ рдзрд╛рд░рд╛ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рдПрдЧрд╛ </font></font><code>num_codelen_lens</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЕрд╢рдХреНрдд рд╣реИред </font><font style="vertical-align: inherit;">рд▓рдВрдмрд╛рдИ рдХреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдХреНрд░рдо рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рд╕реВрдЪреА рдХреЗ рдЕрдВрдд рдореЗрдВ рдЧрд┐рд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рдФрд░ рдмреНрд▓реЙрдХ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рди рд╣реЛред</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* Read the codelen codeword lengths (3 bits each)
           and initialize the codelen decoder. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_codelen_lens; i++) {<font></font>
                bits = istream_bits(is);<font></font>
                codelen_lengths[codelen_lengths_order[i]] =<font></font>
                        (<span class="hljs-keyword">uint8_t</span>)lsb(bits, <span class="hljs-number">3</span>);
                <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
        }<font></font>
        <span class="hljs-keyword">for</span> (; i &lt; MAX_CODELEN_LENS; i++) {<font></font>
                codelen_lengths[codelen_lengths_order[i]] = <span class="hljs-number">0</span>;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (!huffman_decoder_init(&amp;codelen_dec, codelen_lengths,<font></font>
                                  MAX_CODELEN_LENS)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЛрдбреЗрд▓рди рдбрд┐рдХреЛрдбрд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ, рд╣рдо рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рд▓рд┐рдЯреНрд▓рди рдФрд░ рдзрд╛рд░рд╛ рд╕реЗ рджреВрд░ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-comment">/* Read the litlen and dist codeword lengths. */</span>
        i = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (i &lt; num_litlen_lens + num_dist_lens) {<font></font>
                bits = istream_bits(is);<font></font>
                sym = huffman_decode(&amp;codelen_dec, (<span class="hljs-keyword">uint16_t</span>)bits, &amp;used);<font></font>
                bits &gt;&gt;= used;<font></font>
                <span class="hljs-keyword">if</span> (!istream_advance(is, used)) {
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (sym &gt;= <span class="hljs-number">0</span> &amp;&amp; sym &lt;= CODELEN_MAX_LIT) {
                        <span class="hljs-comment">/* A literal codeword length. */</span>
                        code_lengths[i++] = (<span class="hljs-keyword">uint8_t</span>)sym;<font></font>
                }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
16, 17 рдФрд░ 18 рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓рдВрдмрд╛рдИ рдирд╣реАрдВ рд╣реИрдВ, рд╡реЗ рд╕рдВрдХреЗрддрдХ рд╣реИрдВ рдХрд┐ рдкрд┐рдЫрд▓реА рд▓рдВрдмрд╛рдИ рдХреЛ рдХрдИ рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╛ рдЖрдкрдХреЛ рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рдХреЛ рджреЛрд╣рд░рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs">               <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_COPY) {
                        <span class="hljs-comment">/* Copy the previous codeword length 3--6 times. */</span>
                        <span class="hljs-keyword">if</span> (i &lt; <span class="hljs-number">1</span>) {
                                <span class="hljs-keyword">return</span> HWINF_ERR; <span class="hljs-comment">/* No previous length. */</span><font></font>
                        }<font></font>
                        n = lsb(bits, <span class="hljs-number">2</span>) + CODELEN_COPY_MIN; <span class="hljs-comment">/* 2 bits + 3 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">2</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_COPY_MIN &amp;&amp; n &lt;= CODELEN_COPY_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i] = code_lengths[i - <span class="hljs-number">1</span>];<font></font>
                                i++;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS) {
                        <span class="hljs-comment">/* 3--10 zeros. */</span>
                        n = lsb(bits, <span class="hljs-number">3</span>) + CODELEN_ZEROS_MIN; <span class="hljs-comment">/* 3 bits + 3 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">3</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_ZEROS_MIN &amp;&amp;<font></font>
                               n &lt;= CODELEN_ZEROS_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i++] = <span class="hljs-number">0</span>;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS2) {
                        <span class="hljs-comment">/* 11--138 zeros. */</span>
                        n = lsb(bits, <span class="hljs-number">7</span>) + CODELEN_ZEROS2_MIN; <span class="hljs-comment">/* 7 bits +138 */</span>
                        <span class="hljs-keyword">if</span> (!istream_advance(is, <span class="hljs-number">7</span>)) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        assert(n &gt;= CODELEN_ZEROS2_MIN &amp;&amp;<font></font>
                               n &lt;= CODELEN_ZEROS2_MAX);<font></font>
                        <span class="hljs-keyword">if</span> (i + n &gt; num_litlen_lens + num_dist_lens) {
                                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">while</span> (n--) {<font></font>
                                code_lengths[i++] = <span class="hljs-number">0</span>;<font></font>
                        }<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-comment">/* Invalid symbol. */</span>
                        <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
                }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓рд┐рдЯрд▓реЗрди рдФрд░ рдбрд┐рд╕реНрдЯ рд▓рдореНрдмрд╛рдИ рдХреЛ рдПрдХ-рдПрдХ рдХрд░рдХреЗ рд╕рд░рдгреА рдореЗрдВ рдкрдврд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><code>code_lengths</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдЙрдиреНрд╣реЗрдВ рдЕрд▓рдЧ рд╕реЗ рдирд╣реАрдВ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЛрдб рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рдЕрдВрддрд┐рдо рд▓рд┐рдЯрд▓реЗрди рдХреА рд▓рдВрдмрд╛рдИ рд╕реЗ рдкрд╣рд▓реЗ рджреВрд░ рдХреА рд▓рдВрдмрд╛рдИ рддрдХ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рд╣рдлрд╝рдореИрди рдбрд┐рдХреЛрдбрд░реНрд╕ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдмреНрджрд┐рдХ рд░реВрдк рд╕реЗ рдбрд┐рдХреЛрдбрд┐рдВрдЧ рдХреЗ рдХрд╛рд░реНрдп рдкрд░ рд╡рд╛рдкрд╕ рд▓реМрдЯ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">       <span class="hljs-keyword">if</span> (!huffman_decoder_init(litlen_dec, &amp;code_lengths[<span class="hljs-number">0</span>],<font></font>
                                  num_litlen_lens)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
        <span class="hljs-keyword">if</span> (!huffman_decoder_init(dist_dec, &amp;code_lengths[num_litlen_lens],<font></font>
                                  num_dist_lens)) {<font></font>
                <span class="hljs-keyword">return</span> HWINF_ERR;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> HWINF_OK;<font></font>
}<font></font>
</code></pre><br>
<a name="16"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкреАрдбрд╝рди (рдЕрдкрд╕реНрдлреАрддрд┐)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд┐рдЫрд▓реЗ рднрд╛рдЧреЛрдВ рдореЗрдВ, рд╣рдордиреЗ рдбреАрдлрд╝рд▓реНрдЯ рд╕рдВрдкреАрдбрд╝рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рднреА рдЙрдкрдХрд░рдг рдмрдирд╛рдП: рд▓реИрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡, рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ, рдмрд┐рдЯ рд╕реНрдЯреНрд░реАрдо рдФрд░ рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдбреАрдлрд╝реНрд▓реИрдЯ рдмреНрд▓реЙрдХреЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдгред рдФрд░ рдЗрд╕ рднрд╛рдЧ рдореЗрдВ рд╣рдо рд╕рднреА рдХреЛ рдПрдХ рд╕рд╛рде рдорд┐рд▓рдХрд░ Deflate Compression рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдВрдкреАрдбрд╝рди рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЛ рдмреИрдХрд▓рд┐рдВрдХ рдФрд░ рд╢рд╛рдмреНрджрд┐рдХ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдХреНрд░рдо рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдкрд┐рдЫрд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ, рдбрд┐рдХреНрд▓реЗрдЯ рдмреНрд▓реЙрдХ рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡рд┐рднрд╛рдЬрди рд╡рд┐рдзрд┐ рдХрд╛ рдЪрдпрди рдЕрдХреНрд╕рд░ </font><i><font style="vertical-align: inherit;">рдЕрд╡рд░реБрджреНрдз</font></i><font style="vertical-align: inherit;"> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдПрдХ рддрд░рдл, рдкреНрд░рддреНрдпреЗрдХ рдирдП рдмреНрд▓реЙрдХ рдХрд╛ рдорддрд▓рдм рдХрд┐рд╕реА рддрд░рд╣ рдХрд╛ рдУрд╡рд░рд╣реЗрдб рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреА рдорд╛рддреНрд░рд╛ рдмреНрд▓реЙрдХ рдФрд░ рдЙрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдХрдо рдмреНрд▓реЙрдХ - рдХрдо рдУрд╡рд░рд╣реЗрдбред </font><font style="vertical-align: inherit;">рджреВрд╕рд░реА рдУрд░, рдПрдХ рдирдпрд╛ рдмреНрд▓реЙрдХ рдмрдирд╛рдиреЗ рдХреА рдпреЗ рд▓рд╛рдЧрдд рдЪреБрдХрд╛рдиреА рдкрдбрд╝ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдбреЗрдЯрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдЖрдкрдХреЛ рд╣рдлрд╝рдореИрди рдХреЛрдбрд┐рдВрдЧ рдХреЛ рдЕрдзрд┐рдХ рдХреБрд╢рд▓рддрд╛ рд╕реЗ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ рдФрд░ рдЙрддреНрдкрдиреНрди рдбреЗрдЯрд╛ рдХреА рдХреБрд▓ рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд░рддреА рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреНрд▓реЙрдХ рдХрд░рдирд╛ рдПрдХ рдХрдард┐рди рдЕрдиреБрдХреВрд▓рди рдХрд╛рд░реНрдп рд╣реИред </font><font style="vertical-align: inherit;">рдХреБрдЫ рдХрдВрдкреНрд░реЗрд╢рд░реНрд╕ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝реЛрдлрд╝рд▓реА</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рджреВрд╕рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмреЗрд╣рддрд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЬреНрдпрд╛рджрд╛рддрд░ рдмрд╕ рдПрдХ рд▓рд╛рд▓рдЪреА рджреГрд╖реНрдЯрд┐рдХреЛрдг рд▓реЗрддреЗ рд╣реИрдВ: рд╡реЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╣реА рдмреНрд▓реЙрдХ рдЬрд╛рд░реА рдХрд░рддреЗ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдмреНрд▓реЙрдХреЛрдВ рдХреЗ рдЕрдкрдиреЗ рдЖрдХрд╛рд░ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИрдВ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╕рдореНрдмрджреНрдз рдмреНрд▓реЙрдХ рдореЗрдВ 65,535 рд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рдЗрдЯреНрд╕ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдлрд╝рдореИрди рдирд┐рд╢реНрдЪрд┐рдд рдХреЛрдб рдХрд╛ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдирд╣реАрдВ рд╣реИред</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд╛рдпрдиреЗрдорд┐рдХ рд╣рдлрд╝рдореИрди рдХреЛрдб рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдлрд╝рдореИрди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ 16-рдмрд┐рдЯ рд╡рд░реНрдг рдХреНрд░рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ, рд╣рдо 65,535 рд╡рд░реНрдгреЛрдВ рддрдХ рд╕реАрдорд┐рдд рд╣реИрдВред</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдмреНрд▓реЙрдХ рдХрд╛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдирдХреЗ рдЖрдХрд╛рд░ рдХреЛ 65,534 рдмрд╛рдЗрдЯреНрд╕ рддрдХ рд╕реАрдорд┐рдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* The largest number of bytes that will fit in any kind of block is 65,534.
   It will fit in an uncompressed block (max 65,535 bytes) and a Huffman
   block with only literals (65,535 symbols including end-of-block marker). */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_BLOCK_LEN_BYTES 65534</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдВрдкреАрдбрд╝рди рдХреЗ рджреМрд░рд╛рди рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдФрд░ рд╡рд░реНрддрдорд╛рди рдмреНрд▓реЙрдХ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">deflate_state_t</span> <span class="hljs-title">deflate_state_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">deflate_state_t</span> {</span>
        <span class="hljs-keyword">ostream_t</span> os;<font></font>
<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *block_src; <span class="hljs-comment">/* First src byte in the block. */</span><font></font>
<font></font>
        <span class="hljs-keyword">size_t</span> block_len;       <span class="hljs-comment">/* Number of symbols in the current block. */</span>
        <span class="hljs-keyword">size_t</span> block_len_bytes; <span class="hljs-comment">/* Number of src bytes in the block. */</span><font></font>
<font></font>
        <span class="hljs-comment">/* Symbol frequencies for the current block. */</span>
        <span class="hljs-keyword">uint16_t</span> litlen_freqs[LITLEN_MAX + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint16_t</span> dist_freqs[DISTSYM_MAX + <span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
                <span class="hljs-keyword">uint16_t</span> distance;    <span class="hljs-comment">/* Backref distance. */</span>
                <span class="hljs-keyword">union</span> {
                        <span class="hljs-keyword">uint16_t</span> lit; <span class="hljs-comment">/* Literal byte or end-of-block. */</span>
                        <span class="hljs-keyword">uint16_t</span> len; <span class="hljs-comment">/* Backref length (distance != 0). */</span><font></font>
                } u;<font></font>
        } block[MAX_BLOCK_LEN_BYTES + <span class="hljs-number">1</span>];<font></font>
};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">reset_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s)</span>
</span>{<font></font>
        s-&gt;block_len = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block_len_bytes = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">memset</span>(s-&gt;litlen_freqs, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(s-&gt;litlen_freqs));
        <span class="hljs-built_in">memset</span>(s-&gt;dist_freqs, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(s-&gt;dist_freqs));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд╛рд░реНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><code>lz77_compress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░, рд╣рдо рдмреНрд▓реЙрдХ рдХреЛ рдмрд┐рдЯрд╕реНрдЯреНрд░реАрдо рдкрд░ рд▓рд┐рдЦреЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">lit_callback</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> lit, <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> *s = aux;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (s-&gt;block_len_bytes + <span class="hljs-number">1</span> &gt; MAX_BLOCK_LEN_BYTES) {
                <span class="hljs-keyword">if</span> (!write_block(s, <span class="hljs-literal">false</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                s-&gt;block_src += s-&gt;block_len_bytes;<font></font>
                reset_block(s);<font></font>
        }<font></font>
<font></font>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block[s-&gt;block_len++].u.lit = lit;<font></font>
        s-&gt;block_len_bytes++;<font></font>
<font></font>
        s-&gt;litlen_freqs[lit]++;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">backref_callback</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> dist, <span class="hljs-keyword">size_t</span> len, <span class="hljs-keyword">void</span> *aux)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> *s = aux;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (s-&gt;block_len_bytes + len &gt; MAX_BLOCK_LEN_BYTES) {
                <span class="hljs-keyword">if</span> (!write_block(s, <span class="hljs-literal">false</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                s-&gt;block_src += s-&gt;block_len_bytes;<font></font>
                reset_block(s);<font></font>
        }<font></font>
<font></font>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = (<span class="hljs-keyword">uint16_t</span>)dist;<font></font>
        s-&gt;block[s-&gt;block_len++].u.len = (<span class="hljs-keyword">uint16_t</span>)len;<font></font>
        s-&gt;block_len_bytes += len;<font></font>
<font></font>
        assert(len &gt;= MIN_LEN &amp;&amp; len &lt;= MAX_LEN);<font></font>
        assert(dist &gt;= MIN_DISTANCE &amp;&amp; dist &lt;= MAX_DISTANCE);<font></font>
        s-&gt;litlen_freqs[len2litlen[len]]++;<font></font>
        s-&gt;dist_freqs[distance2dist[dist]]++;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдмреНрд▓реЙрдХреЛрдВ рдХреА рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдмреНрд▓реЙрдХ рд╕рдВрдХреБрдЪрд┐рдд рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_uncomp_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> len_nlen[<span class="hljs-number">4</span>];<font></font>
<font></font>
        <span class="hljs-comment">/* Write the block header. */</span>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, (<span class="hljs-number">0x0</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>, <span class="hljs-number">3</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        len_nlen[<span class="hljs-number">0</span>] = (<span class="hljs-keyword">uint8_t</span>)(s-&gt;block_len_bytes &gt;&gt; <span class="hljs-number">0</span>);<font></font>
        len_nlen[<span class="hljs-number">1</span>] = (<span class="hljs-keyword">uint8_t</span>)(s-&gt;block_len_bytes &gt;&gt; <span class="hljs-number">8</span>);<font></font>
        len_nlen[<span class="hljs-number">2</span>] = ~len_nlen[<span class="hljs-number">0</span>];<font></font>
        len_nlen[<span class="hljs-number">3</span>] = ~len_nlen[<span class="hljs-number">1</span>];<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write_bytes_aligned(&amp;s-&gt;os, len_nlen, <span class="hljs-keyword">sizeof</span>(len_nlen))) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write_bytes_aligned(&amp;s-&gt;os, s-&gt;block_src,<font></font>
                                         s-&gt;block_len_bytes)) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рд╕реНрдерд┐рд░ рд╣рдлрд╝рдореИрди рдмреНрд▓реЙрдХ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рд▓рд┐рдЯрд▓рди рдФрд░ рдбрд┐рд╕реНрдЯ рдХреЛрдб рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╣рд┐рдд рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рд╣рдо рдЗрди рдХреЛрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рд▓рд┐рдЦрддреЗ рд╣реБрдП рдмреНрд▓реЙрдХ рдХреЛ рдкреБрди: рдЯрд╛рдЗрдк рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_static_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">huffman_encoder_t</span> litlen_enc, dist_enc;<font></font>
<font></font>
        <span class="hljs-comment">/* Write the block header. */</span>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, (<span class="hljs-number">0x1</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>, <span class="hljs-number">3</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        huffman_encoder_init2(&amp;litlen_enc, fixed_litlen_lengths,<font></font>
                              <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths) /
                              <span class="hljs-keyword">sizeof</span>(fixed_litlen_lengths[<span class="hljs-number">0</span>]));<font></font>
        huffman_encoder_init2(&amp;dist_enc, fixed_dist_lengths,<font></font>
                              <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths) /
                              <span class="hljs-keyword">sizeof</span>(fixed_dist_lengths[<span class="hljs-number">0</span>]));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> write_huffman_block(s, &amp;litlen_enc, &amp;dist_enc);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_huffman_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, nbits;
        <span class="hljs-keyword">uint64_t</span> distance, dist, len, litlen, bits, ebits;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; s-&gt;block_len; i++) {
                <span class="hljs-keyword">if</span> (s-&gt;block[i].distance == <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Literal or EOB. */</span><font></font>
                        litlen = s-&gt;block[i].u.lit;<font></font>
                        assert(litlen &lt;= LITLEN_EOB);<font></font>
                        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os,<font></font>
                                           litlen_enc-&gt;codewords[litlen],<font></font>
                                           litlen_enc-&gt;lengths[litlen])) {<font></font>
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                        }<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Back reference length. */</span><font></font>
                len = s-&gt;block[i].u.len;<font></font>
                litlen = len2litlen[len];<font></font>
<font></font>
                <span class="hljs-comment">/* litlen bits */</span><font></font>
                bits = litlen_enc-&gt;codewords[litlen];<font></font>
                nbits = litlen_enc-&gt;lengths[litlen];<font></font>
<font></font>
                <span class="hljs-comment">/* ebits */</span><font></font>
                ebits = len - litlen_tbl[litlen - LITLEN_TBL_OFFSET].base_len;<font></font>
                bits |= ebits &lt;&lt; nbits;<font></font>
                nbits += litlen_tbl[litlen - LITLEN_TBL_OFFSET].ebits;<font></font>
<font></font>
                <span class="hljs-comment">/* Back reference distance. */</span><font></font>
                distance = s-&gt;block[i].distance;<font></font>
                dist = distance2dist[distance];<font></font>
<font></font>
                <span class="hljs-comment">/* dist bits */</span>
                bits |= (<span class="hljs-keyword">uint64_t</span>)dist_enc-&gt;codewords[dist] &lt;&lt; nbits;<font></font>
                nbits += dist_enc-&gt;lengths[dist];<font></font>
<font></font>
                <span class="hljs-comment">/* ebits */</span><font></font>
                ebits = distance - dist_tbl[dist].base_dist;<font></font>
                bits |= ebits &lt;&lt; nbits;<font></font>
                nbits += dist_tbl[dist].ebits;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмреЗрд╢рдХ, рд╣рдлрд╝рдореИрди рдбрд╛рдпрдиреЗрдорд┐рдХ рдмреНрд▓реЙрдХ рд▓рд┐рдЦрдирд╛ рдХрдард┐рди рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрдирдореЗрдВ рд▓рд┐рдЯреНрд▓реАрди рдФрд░ рдбрд┐рд╕реНрдЯ рдХреЛрдб рдХреЗ рдЯреНрд░рд┐рдХреА рдХреЛрдбрд┐рдВрдЧ рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдЗрд╕ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">codelen_sym_t</span> <span class="hljs-title">codelen_sym_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">codelen_sym_t</span> {</span>
        <span class="hljs-keyword">uint8_t</span> sym;
        <span class="hljs-keyword">uint8_t</span> count; <span class="hljs-comment">/* For symbols 16, 17, 18. */</span><font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рд▓рд┐рдЯрд▓реЗрди рдФрд░ рдбрд┐рд╕реНрдЯрд░реНрдб рдХреЛрдбрд╡рд░реНрдб рдХреА рдЙрдирдХреА рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рдХреА рдкреВрдВрдЫ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдмрд╛рдж рдХреЗ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рдпрдорд┐рдд рд╕рд░рдгреА рдореЗрдВ рдХреЙрдкреА рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдо рд╕рднреА рд╢реВрдиреНрдп рдХреЛ рдирд╣реАрдВ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: рдпрджрд┐ рдПрдХ рднреА рдбрд┐рд╕реНрдЯ рдХреЛрдб рдирд╣реАрдВ рд╣реИ рддреЛ рдбрд┐рдлрд▓реЗрдЯ рдмреНрд▓реЙрдХ рдХреЛ рдПрдирдХреЛрдб рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред </font><font style="vertical-align: inherit;">257 рд╕реЗ рдХрдо рд▓рд┐рдЯрд▓реЗрди рдХреЛрдб рд╣реЛрдирд╛ рднреА рдЕрд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣рдореЗрд╢рд╛ рдмрд╛рдЗрдЯ рдПрдВрдбрд┐рдВрдЧ рдорд╛рд░реНрдХрд░ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП 256 рдХреЗ рд╡рд░реНрдг рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдПрдХ рдЧреИрд░-рд╢реВрдиреНрдп рдХреЛрдб рд▓рдВрдмрд╛рдИ рд╣реЛрдЧреАред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Encode litlen_lens and dist_lens into encoded. *num_litlen_lens and
   *num_dist_lens will be set to the number of encoded litlen and dist lens,
   respectively. Returns the number of elements in encoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">encode_dist_litlen_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *litlen_lens,
                                      <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *dist_lens,
                                      <span class="hljs-keyword">codelen_sym_t</span> *encoded,
                                      <span class="hljs-keyword">size_t</span> *num_litlen_lens,
                                      <span class="hljs-keyword">size_t</span> *num_dist_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, n;
        <span class="hljs-keyword">uint8_t</span> lens[LITLEN_MAX + <span class="hljs-number">1</span> + DISTSYM_MAX + <span class="hljs-number">1</span>];<font></font>
<font></font>
        *num_litlen_lens = LITLEN_MAX + <span class="hljs-number">1</span>;<font></font>
        *num_dist_lens = DISTSYM_MAX + <span class="hljs-number">1</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero litlen lengths. */</span>
        assert(litlen_lens[LITLEN_EOB] != <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">"EOB len should be non-zero."</span>);
        <span class="hljs-keyword">while</span> (litlen_lens[*num_litlen_lens - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>) {<font></font>
                (*num_litlen_lens)--;<font></font>
        }<font></font>
        assert(*num_litlen_lens &gt;= MIN_LITLEN_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero dist lengths, keeping at least one. */</span>
        <span class="hljs-keyword">while</span> (dist_lens[*num_dist_lens - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span> &amp;&amp; *num_dist_lens &gt; <span class="hljs-number">1</span>) {<font></font>
                (*num_dist_lens)--;<font></font>
        }<font></font>
        assert(*num_dist_lens &gt;= MIN_DIST_LENS);<font></font>
<font></font>
        <span class="hljs-comment">/* Copy the lengths into a unified array. */</span>
        n = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; *num_litlen_lens; i++) {<font></font>
                lens[n++] = litlen_lens[i];<font></font>
        }<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; *num_dist_lens; i++) {<font></font>
                lens[n++] = dist_lens[i];<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> encode_lens(lens, n, encoded);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рд╕рд░рдгреА рдореЗрдВ рдХреЛрдб рд▓рдВрдмрд╛рдИ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рд╕рдорд╛рди рдХреЛрдб рд▓рдВрдмрд╛рдИ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдбрд┐рдВрдЧ рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Encode the n code lengths in lens into encoded, returning the number of
   elements in encoded. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">encode_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *lens, <span class="hljs-keyword">size_t</span> n, <span class="hljs-keyword">codelen_sym_t</span> *encoded)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, j, num_encoded;
        <span class="hljs-keyword">uint8_t</span> count;<font></font>
<font></font>
        i = <span class="hljs-number">0</span>;<font></font>
        num_encoded = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (i &lt; n) {
                <span class="hljs-keyword">if</span> (lens[i] == <span class="hljs-number">0</span>) {
                        <span class="hljs-comment">/* Scan past the end of this zero run (max 138). */</span>
                        <span class="hljs-keyword">for</span> (j = i; j &lt; min(n, i + CODELEN_ZEROS2_MAX) &amp;&amp;<font></font>
                                    lens[j] == <span class="hljs-number">0</span>; j++);<font></font>
                        count = (<span class="hljs-keyword">uint8_t</span>)(j - i);<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (count &lt; CODELEN_ZEROS_MIN) {
                                <span class="hljs-comment">/* Output a single zero. */</span>
                                encoded[num_encoded++].sym = <span class="hljs-number">0</span>;<font></font>
                                i++;<font></font>
                                <span class="hljs-keyword">continue</span>;<font></font>
                        }<font></font>
<font></font>
                        <span class="hljs-comment">/* Output a repeated zero. */</span>
                        <span class="hljs-keyword">if</span> (count &lt;= CODELEN_ZEROS_MAX) {
                                <span class="hljs-comment">/* Repeated zero 3--10 times. */</span><font></font>
                                assert(count &gt;= CODELEN_ZEROS_MIN &amp;&amp;<font></font>
                                       count &lt;= CODELEN_ZEROS_MAX);<font></font>
                                encoded[num_encoded].sym = CODELEN_ZEROS;<font></font>
                                encoded[num_encoded++].count = count;<font></font>
                        } <span class="hljs-keyword">else</span> {
                                <span class="hljs-comment">/* Repeated zero 11--138 times. */</span><font></font>
                                assert(count &gt;= CODELEN_ZEROS2_MIN &amp;&amp;<font></font>
                                       count &lt;= CODELEN_ZEROS2_MAX);<font></font>
                                encoded[num_encoded].sym = CODELEN_ZEROS2;<font></font>
                                encoded[num_encoded++].count = count;<font></font>
                        }<font></font>
                        i = j;<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-comment">/* Output len. */</span><font></font>
                encoded[num_encoded++].sym = lens[i++];<font></font>
<font></font>
                <span class="hljs-comment">/* Scan past the end of the run of this len (max 6). */</span>
                <span class="hljs-keyword">for</span> (j = i; j &lt; min(n, i + CODELEN_COPY_MAX) &amp;&amp;<font></font>
                            lens[j] == lens[i - <span class="hljs-number">1</span>]; j++);<font></font>
                count = (<span class="hljs-keyword">uint8_t</span>)(j - i);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (count &gt;= CODELEN_COPY_MIN) {
                        <span class="hljs-comment">/* Repeat last len 3--6 times. */</span><font></font>
                        assert(count &gt;= CODELEN_COPY_MIN &amp;&amp;<font></font>
                               count &lt;= CODELEN_COPY_MAX);<font></font>
                        encoded[num_encoded].sym = CODELEN_COPY;<font></font>
                        encoded[num_encoded++].count = count;<font></font>
                        i = j;<font></font>
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> num_encoded;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рд╣рдлрд╝рдореИрди рдХреЛрдб - рдХреЛрдбрд▓реЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рдХреЛрдбреЗрд▓рди рдХреЛрдб рд╕реЗ рдХреЛрдбрд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рдо рдореЗрдВ рдмреНрд▓реЙрдХ рдХреЛ рд▓рд┐рдЦреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ рд╢реВрдиреНрдп рд▓рдВрдмрд╛рдИ рдЕрдВрдд рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреА рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рддрдиреА рд▓рдВрдмрд╛рдИ рд▓рд┐рдЦреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> codelen_lengths_order[<span class="hljs-number">19</span>] =<font></font>
{ <span class="hljs-number">16</span>, <span class="hljs-number">17</span>, <span class="hljs-number">18</span>, <span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">9</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">3</span>, <span class="hljs-number">13</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span> };<font></font>
<font></font>
<span class="hljs-comment">/* Count the number of significant (not trailing zeros) codelen lengths. */</span>
<span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">count_codelen_lens</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *codelen_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> n = MAX_CODELEN_LENS;<font></font>
<font></font>
        <span class="hljs-comment">/* Drop trailing zero lengths. */</span>
        <span class="hljs-keyword">while</span> (codelen_lens[codelen_lengths_order[n - <span class="hljs-number">1</span>]] == <span class="hljs-number">0</span>) {<font></font>
                n--;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* The first 4 lengths in the order (16, 17, 18, 0) cannot be used to
           encode any non-zero lengths. Since there will always be at least
           one non-zero codeword length (for EOB), n will be &gt;= 4. */</span><font></font>
        assert(n &gt;= MIN_CODELEN_LENS &amp;&amp; n &lt;= MAX_CODELEN_LENS);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> n;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рд▓рд┐рдЯрд▓рди рдФрд░ рдбрд┐рд╕реНрдЯ рдХреЛрдб рд╕реЗрдЯ рдХрд░ рджрд┐рдП рд╣реИрдВ, рдЙрдирдХреЗ рдХреЛрдб рд╢рдмреНрджреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдФрд░ рдЗрди рд▓рдВрдмрд╛рдИ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЛрдб рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╕реЗрдЯ рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдЕрдм рд╣рдо рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд╣рдлрд╝рдореИрди рдмреНрд▓реЙрдХ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_dynamic_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>,
                                <span class="hljs-keyword">size_t</span> num_litlen_lens, <span class="hljs-keyword">size_t</span> num_dist_lens,
                                <span class="hljs-keyword">size_t</span> num_codelen_lens,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *codelen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">codelen_sym_t</span> *encoded_lens,
                                <span class="hljs-keyword">size_t</span> num_encoded_lens,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                                <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i;
        <span class="hljs-keyword">uint8_t</span> codelen, sym;
        <span class="hljs-keyword">size_t</span> nbits;
        <span class="hljs-keyword">uint64_t</span> bits, hlit, hdist, hclen, count;<font></font>
<font></font>
        <span class="hljs-comment">/* Block header. */</span>
        bits = (<span class="hljs-number">0x2</span> &lt;&lt; <span class="hljs-number">1</span>) | <span class="hljs-keyword">final</span>;<font></font>
        nbits = <span class="hljs-number">3</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hlit (5 bits) */</span><font></font>
        hlit = num_litlen_lens - MIN_LITLEN_LENS;<font></font>
        bits |= hlit &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">5</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hdist (5 bits) */</span><font></font>
        hdist = num_dist_lens - MIN_DIST_LENS;<font></font>
        bits |= hdist &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">5</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* hclen (4 bits) */</span><font></font>
        hclen = num_codelen_lens - MIN_CODELEN_LENS;<font></font>
        bits |= hclen &lt;&lt; nbits;<font></font>
        nbits += <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen lengths. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_codelen_lens; i++) {<font></font>
                codelen = codelen_enc-&gt;lengths[codelen_lengths_order[i]];<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, codelen, <span class="hljs-number">3</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* Litlen and dist code lengths. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_encoded_lens; i++) {<font></font>
                sym = encoded_lens[i].sym;<font></font>
<font></font>
                bits = codelen_enc-&gt;codewords[sym];<font></font>
                nbits = codelen_enc-&gt;lengths[sym];<font></font>
<font></font>
                count = encoded_lens[i].count;<font></font>
                <span class="hljs-keyword">if</span> (sym == CODELEN_COPY) { <span class="hljs-comment">/* 2 ebits */</span><font></font>
                        bits |= (count - CODELEN_COPY_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">2</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS) { <span class="hljs-comment">/* 3 ebits */</span><font></font>
                        bits |= (count - CODELEN_ZEROS_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">3</span>;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sym == CODELEN_ZEROS2) { <span class="hljs-comment">/* 7 ebits */</span><font></font>
                        bits |= (count - CODELEN_ZEROS2_MIN) &lt;&lt; nbits;<font></font>
                        nbits += <span class="hljs-number">7</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!ostream_write(&amp;s-&gt;os, bits, nbits)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> write_huffman_block(s, litlen_enc, dist_enc);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЙрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо рдмрд┐рдЯреНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдЕрд╕рдореНрдкреАрдбрд┐рдд рдмреНрд▓реЙрдХ рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдЧрдгрдирд╛ рдЬрд▓реНрджреА рд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for an uncompressed block, including header. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">uncomp_block_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s)</span>
</span>{
        <span class="hljs-keyword">size_t</span> bit_pos, padding;<font></font>
<font></font>
        <span class="hljs-comment">/* Bit position after writing the block header. */</span>
        bit_pos = ostream_bit_pos(&amp;s-&gt;os) + <span class="hljs-number">3</span>;<font></font>
        padding = round_up(bit_pos, <span class="hljs-number">8</span>) - bit_pos;<font></font>
<font></font>
        <span class="hljs-comment">/* Header + padding + len/nlen + block contents. */</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">3</span> + padding + <span class="hljs-number">2</span> * <span class="hljs-number">16</span> + s-&gt;block_len_bytes * <span class="hljs-number">8</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдлрд╝рдореИрди рдПрдиреНрдХреЛрдбреЗрдб рдмреНрд▓реЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП, рдЖрдк рд▓рд┐рдЯрд▓реЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢рд░реАрд░ рдХреА рд▓рдВрдмрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ- рдФрд░ рд╡рд░реНрдг рдФрд░ рдХреЛрдбрд╡рд░реНрдб рд▓рдВрдмрд╛рдИ рдХреА рдлрд╝реНрд░реАрдХреНрд╡реЗрдВрд╕реА:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for a Huffman encoded block body. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">huffman_block_body_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s,
                                     <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *litlen_lens,
                                     <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *dist_lens)</span>
</span>{
        <span class="hljs-keyword">size_t</span> i, freq, len;<font></font>
<font></font>
        len = <span class="hljs-number">0</span>;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt;= LITLEN_MAX; i++) {<font></font>
                freq = s-&gt;litlen_freqs[i];<font></font>
                len += litlen_lens[i] * freq;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (i &gt;= LITLEN_TBL_OFFSET) {<font></font>
                        len += litlen_tbl[i - LITLEN_TBL_OFFSET].ebits * freq;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt;= DISTSYM_MAX; i++) {<font></font>
                freq = s-&gt;dist_freqs[i];<font></font>
                len += dist_lens[i] * freq;<font></font>
                len += dist_tbl[i].ebits * freq;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> len;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдереИрддрд┐рдХ рдмреНрд▓реЙрдХ рдХреА рдХреБрд▓ рд▓рдВрдмрд╛рдИ рд╣реЗрдбрд░ рдХреЗ 3 рдмрд┐рдЯреНрд╕ рдФрд░ рд╢рд░реАрд░ рдХреА рд▓рдВрдмрд╛рдИ рд╣реИред </font><font style="vertical-align: inherit;">рдбрд╛рдпрдирд╛рдорд┐рдХ рдмреНрд▓реЙрдХ рдХреЗ рд╣реЗрдбрд░ рдЖрдХрд╛рд░ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рдХрд╛рдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Calculate the number of bits for a dynamic Huffman block. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">dyn_block_len</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">size_t</span> num_codelen_lens,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> *codelen_freqs,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *codelen_enc,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *litlen_enc,
                            <span class="hljs-keyword">const</span> <span class="hljs-keyword">huffman_encoder_t</span> *dist_enc)</span>
</span>{
        <span class="hljs-keyword">size_t</span> len, i, freq;<font></font>
<font></font>
        <span class="hljs-comment">/* Block header. */</span>
        len = <span class="hljs-number">3</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Nbr of litlen, dist, and codelen lengths. */</span>
        len += <span class="hljs-number">5</span> + <span class="hljs-number">5</span> + <span class="hljs-number">4</span>;<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen lengths. */</span>
        len += <span class="hljs-number">3</span> * num_codelen_lens;<font></font>
<font></font>
        <span class="hljs-comment">/* Codelen encoding. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; MAX_CODELEN_LENS; i++) {<font></font>
                freq = codelen_freqs[i];<font></font>
                len += codelen_enc-&gt;lengths[i] * freq;<font></font>
<font></font>
                <span class="hljs-comment">/* Extra bits. */</span>
                <span class="hljs-keyword">if</span> (i == CODELEN_COPY) {<font></font>
                        len += <span class="hljs-number">2</span> * freq;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == CODELEN_ZEROS) {<font></font>
                        len += <span class="hljs-number">3</span> * freq;<font></font>
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == CODELEN_ZEROS2) {<font></font>
                        len += <span class="hljs-number">7</span> * freq;<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> len + huffman_block_body_len(s, litlen_enc-&gt;lengths,<font></font>
                                            dist_enc-&gt;lengths);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рд░рдЦреЗрдВрдЧреЗ рдФрд░ рдмреНрд▓реЙрдХ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдХрд╛рд░реНрдп рдмрдирд╛рдПрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write the current deflate block, marking it final if that parameter is true,
   returning false if there is not enough room in the output stream. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">write_block</span><span class="hljs-params">(<span class="hljs-keyword">deflate_state_t</span> *s, <span class="hljs-keyword">bool</span> <span class="hljs-keyword">final</span>)</span>
</span>{
        <span class="hljs-keyword">size_t</span> old_bit_pos, uncomp_len, static_len, dynamic_len;
        <span class="hljs-keyword">huffman_encoder_t</span> dyn_litlen_enc, dyn_dist_enc, codelen_enc;
        <span class="hljs-keyword">size_t</span> num_encoded_lens, num_litlen_lens, num_dist_lens;
        <span class="hljs-keyword">codelen_sym_t</span> encoded_lens[LITLEN_MAX + <span class="hljs-number">1</span> + DISTSYM_MAX + <span class="hljs-number">1</span>];
        <span class="hljs-keyword">uint16_t</span> codelen_freqs[MAX_CODELEN_LENS] = {<span class="hljs-number">0</span>};
        <span class="hljs-keyword">size_t</span> num_codelen_lens;
        <span class="hljs-keyword">size_t</span> i;<font></font>
<font></font>
        old_bit_pos = ostream_bit_pos(&amp;s-&gt;os);<font></font>
<font></font>
        <span class="hljs-comment">/* Add the end-of-block marker in case we write a Huffman block. */</span>
        assert(s-&gt;block_len &lt; <span class="hljs-keyword">sizeof</span>(s-&gt;block) / <span class="hljs-keyword">sizeof</span>(s-&gt;block[<span class="hljs-number">0</span>]));<font></font>
        assert(s-&gt;litlen_freqs[LITLEN_EOB] == <span class="hljs-number">0</span>);<font></font>
        s-&gt;block[s-&gt;block_len  ].distance = <span class="hljs-number">0</span>;<font></font>
        s-&gt;block[s-&gt;block_len++].u.lit = LITLEN_EOB;<font></font>
        s-&gt;litlen_freqs[LITLEN_EOB] = <span class="hljs-number">1</span>;<font></font>
<font></font>
        uncomp_len = uncomp_block_len(s);<font></font>
<font></font>
        static_len = <span class="hljs-number">3</span> + huffman_block_body_len(s, fixed_litlen_lengths,<font></font>
                                                fixed_dist_lengths);<font></font>
<font></font>
        <span class="hljs-comment">/* Compute "dynamic" Huffman codes. */</span><font></font>
        huffman_encoder_init(&amp;dyn_litlen_enc, s-&gt;litlen_freqs,<font></font>
                             LITLEN_MAX + <span class="hljs-number">1</span>, <span class="hljs-number">15</span>);<font></font>
        huffman_encoder_init(&amp;dyn_dist_enc, s-&gt;dist_freqs, DISTSYM_MAX + <span class="hljs-number">1</span>, <span class="hljs-number">15</span>);<font></font>
<font></font>
        <span class="hljs-comment">/* Encode the litlen and dist code lengths. */</span><font></font>
        num_encoded_lens = encode_dist_litlen_lens(dyn_litlen_enc.lengths,<font></font>
                                                   dyn_dist_enc.lengths,<font></font>
                                                   encoded_lens,<font></font>
                                                   &amp;num_litlen_lens,<font></font>
                                                   &amp;num_dist_lens);<font></font>
<font></font>
        <span class="hljs-comment">/* Compute the codelen code. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_encoded_lens; i++) {<font></font>
                codelen_freqs[encoded_lens[i].sym]++;<font></font>
        }<font></font>
        huffman_encoder_init(&amp;codelen_enc, codelen_freqs, MAX_CODELEN_LENS, <span class="hljs-number">7</span>);<font></font>
        num_codelen_lens = count_codelen_lens(codelen_enc.lengths);<font></font>
<font></font>
        dynamic_len = dyn_block_len(s, num_codelen_lens, codelen_freqs,<font></font>
                                    &amp;codelen_enc, &amp;dyn_litlen_enc,<font></font>
                                    &amp;dyn_dist_enc);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (uncomp_len &lt;= dynamic_len &amp;&amp; uncomp_len &lt;= static_len) {
                <span class="hljs-keyword">if</span> (!write_uncomp_block(s, <span class="hljs-keyword">final</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == uncomp_len);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (static_len &lt;= dynamic_len) {
                <span class="hljs-keyword">if</span> (!write_static_block(s, <span class="hljs-keyword">final</span>)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == static_len);<font></font>
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (!write_dynamic_block(s, <span class="hljs-keyword">final</span>, num_litlen_lens,<font></font>
                                         num_dist_lens, num_codelen_lens,<font></font>
                                         &amp;codelen_enc, encoded_lens,<font></font>
                                         num_encoded_lens, &amp;dyn_litlen_enc,<font></font>
                                         &amp;dyn_dist_enc)) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                assert(ostream_bit_pos(&amp;s-&gt;os) - old_bit_pos == dynamic_len);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдд рдореЗрдВ, рд╕рдВрдкреВрд░реНрдг рд╕рдВрдкреАрдбрд╝рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрд░рдВрднрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП, рд▓реЗрдореНрдкреЗрд▓-рдЬрд╝рд┐рд╡ рд╕рдВрдкреАрдбрд╝рди рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдореА рдмреНрд▓реЙрдХ рд▓рд┐рдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Compress (deflate) the data in src into dst. The number of bytes output, at
   most dst_cap, is stored in *dst_used. Returns false if there is not enough
   room in dst. src and dst must not overlap. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">hwdeflate</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len, <span class="hljs-keyword">uint8_t</span> *dst,
               <span class="hljs-keyword">size_t</span> dst_cap, <span class="hljs-keyword">size_t</span> *dst_used)</span>
</span>{
        <span class="hljs-keyword">deflate_state_t</span> s;<font></font>
<font></font>
        ostream_init(&amp;s.os, dst, dst_cap);<font></font>
        reset_block(&amp;s);<font></font>
        s.block_src = src;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!lz77_compress(src, src_len, &amp;lit_callback,<font></font>
                           &amp;backref_callback, &amp;s)) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!write_block(&amp;s, <span class="hljs-literal">true</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-comment">/* The end of the final block should match the end of src. */</span><font></font>
        assert(s.block_src + s.block_len_bytes == src + src_len);<font></font>
<font></font>
        *dst_used = ostream_bytes_written(&amp;s.os);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="17"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рд╕реНрд╡рд░реВрдк</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдКрдкрд░, рд╣рдордиреЗ рдЬрд╛рдВрдЪ рдХреА рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдбреАрдлрд╝реНрд▓реИрдЯ рд╕рдВрдкреАрдбрд╝рди рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓ рд╕реНрд╡рд░реВрдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реА? </font><font style="vertical-align: inherit;">рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рд╣рдо рдЗрд╕рдХреА рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЬрд╛рдБрдЪ рдХрд░реЗрдВрдЧреЗред </font><font style="vertical-align: inherit;">рдХреЛрдб </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zip.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<a name="18"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд╡рд▓реЛрдХрди</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рд░реВрдк PKZip </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдиреЛрдЯ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИ </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓, рдпрд╛ рд╕рдВрдЧреНрд░рд╣ рдЖрдЗрдЯрдо, рдЖрдЗрдЯрдо рдХреЗ </font><font style="vertical-align: inherit;">рдмрд╛рд░реЗ рдореЗрдВ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде </font><font style="vertical-align: inherit;">рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font></li>
<li><i> </i>   .         ,      ,    ,      Zip-.</li>
<li>  ,     <i>   </i>.       ,        .     Zip-.</li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/821/bba/6ce/821bba6cede767c834da639e00d7d6ba.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрдЧреНрд░рд╣ рдЖрдЗрдЯрдо рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдФрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рднрд▓реЗ рд╣реА рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмреАрдЪ рдореИрдЪ рд╣реЛрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рдВрдкреАрдбрд╝рди рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреНрдпрд╛рди рдирд╣реАрдВ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдд рдореЗрдВ рдХреЗрдВрджреНрд░реАрдп рдХреИрдЯрд▓реЙрдЧ рдХрд╛ рд╕реНрдерд╛рди рдЖрдкрдХреЛ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдзреАрд░реЗ-рдзреАрд░реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЬреИрд╕реЗ рд╣реА рдлрд╝рд╛рдЗрд▓ рддрддреНрд╡ рд╕рдВрдкреАрдбрд╝рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕реВрдЪрдХрд╛рдВрдХ рд╕рднреА рд╕рдВрдкреАрдбрд╝рд┐рдд рдЖрдХрд╛рд░реЛрдВ рдХреЗ рдмрд╛рдж рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рд╕рднреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдСрдлрд╕реЗрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдореМрдЬреВрджрд╛ рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ, рдЗрд╕реЗ рдЕрдВрддрд┐рдо рддрддреНрд╡ рдХреЗ рдмрд╛рдж рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдзреАрд░реЗ-рдзреАрд░реЗ рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрдИ рдлреНрд▓реЙрдкреА рдбрд┐рд╕реНрдХ рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рдкрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдкреНрд░рд╕рд╛рд░ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдереАред рдЬреИрд╕реЗ рд╣реА рдпрд╣ рд╕рдВрдХреБрдЪрд┐рдд рд╣реБрдЖ, PKZip рдиреЗ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирдП рдбрд┐рд╕реНрдХреЗрдЯ рдбрд╛рд▓реЗрдВ, рдФрд░ рдЕрдВрддрд┐рдо (рдЕрдВрддрд┐рдо) рд╡рд╛рд▓реЛрдВ рдХреЛ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд▓рд┐рдЦреЗрдВред рдорд▓реНрдЯреА-рд╡реЙрд▓реНрдпреВрдо рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдЕрдирдЬрд╝рд┐рдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреАрдХреЗрдЬрд╝рд┐рдк рдиреЗ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЖрдЦрд┐рд░реА рдбрд┐рд╕реНрдХреЗрдЯ рдХреЛ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛, рдФрд░ рдлрд┐рд░ рдмрд╛рдХреА рдбрд┐рд╕реНрдХреЗрдЯ рдХреЛ рдЕрдиреБрд░реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдерд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЖрдкрдХреЛ рдЖрд╢реНрдЪрд░реНрдпрдЪрдХрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдПрдХ рд╣реА рдирд╛рдо рдХреЗ рд╕рд╛рде рдХрдИ рдлрд╛рдЗрд▓реЗрдВ рд░рдЦрдиреЗ рдкрд░ рдХреЛрдИ рдирд┐рдпрдо рдирд╣реАрдВ рдерд╛ред рдпрд╣ рдЕрдирдкреИрдХ рдХрд░рддреЗ рд╕рдордп рдмрд╣реБрдд рднреНрд░рдо рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ: рдпрджрд┐ рдПрдХ рд╣реА рдирд╛рдо рд╡рд╛рд▓реА рдХрдИ рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдХреМрди рд╕рд╛ рдЕрдирдкреИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? рдмрджрд▓реЗ рдореЗрдВ, рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддрд╛ рд╣реИред Android рдореЗрдВ "рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА" рдмрдЧ рдХреЗ рдХрд╛рд░рдг (</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2013-4787</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">рдмреНрд▓реИрдХ рд╣реИрдЯ рдкрд░ рд░рд┐рдкреЛрд░реНрдЯ рд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрд▓рд╛рдЗрдб</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реАрдбрд┐рдпреЛ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╕рдордп </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░</font></a><font style="vertical-align: inherit;"> рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЪреЗрдХ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдПрдВрдбреНрд░реЙрдЗрдб рдкреНрд░реЛрдЧреНрд░рд╛рдо </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдкреАрдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╛рдЗрд▓реЛрдВ </font><font style="vertical-align: inherit;">рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рдЬреЛ рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВред рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛, рдЕрдЧрд░ рдПрдкреАрдХреЗ рдореЗрдВ рдПрдХ рд╣реА рдирд╛рдо рд╡рд╛рд▓реА рдХрдИ рдлрд╛рдЗрд▓реЗрдВ рдереАрдВ, рддреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рдХреЛрдб рдиреЗ </font><font style="vertical-align: inherit;">рдЙрд╕реА рдирд╛рдо рдХреЗ рд╕рд╛рде </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдВрддрд┐рдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рдХрд╛ </font><font style="vertical-align: inherit;">рдЪрдпрди рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">, рдФрд░ рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдиреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рдХрд╛ </font><font style="vertical-align: inherit;">рдЪрдпрди рдХрд┐рдпрд╛ </font><font style="vertical-align: inherit;">, рдЕрд░реНрдерд╛рдд, рд╕рддреНрдпрд╛рдкрди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рджреЛ рдЬрд╝рд┐рдк рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЗрд╕ рдЫреЛрдЯреЗ рдЕрдВрддрд░ рдиреЗ рдкреВрд░реЗ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдмрдирд╛ рджрд┐рдпрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдпрд╛ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">рдЬрд╛рджреВ рдирдВрдмрд░ рдХреЗ</font></a><font style="vertical-align: inherit;"> рд╕рд╛рде рд╢реБрд░реВ рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдЗрдВрдЧрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХрд┐рд╕реА рднреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рддрд░реАрдХреЗ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЖрдкрдХреЛ рдРрд╕реА рдлрд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ рдЬрд╝рд┐рдк рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдПрдХ рдЕрд▓рдЧ рдкреНрд░рд╛рд░реВрдк - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░реВрдк рдореЗрдВ рдорд╛рдиреНрдп рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реНрд╡рдпрдВ-рдирд┐рдХрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗ рдЬрд╝рд┐рдк рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pkz204g.exe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдЖрдорддреМрд░ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рджреЛрдиреЛрдВ рд╣реИрдВ: рдкрд╣рд▓рд╛ рднрд╛рдЧ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рдж рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ (рдЬреЛ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рднрд╛рдЧ рджреНрд╡рд╛рд░рд╛ рдЕрдирдкреИрдХ рдХреА рдЧрдИ рд╣реИ)ред рдУрдПрд╕ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрд╝рд┐рдк рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЗрд╕реЗ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдЦреЛрд▓ рджреЗрдЧрд╛ред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдВрдХрд┐ рдРрд╕реА рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдлрд╛рдЗрд▓реЗрдВ рд╕реНрдорд╛рд░реНрдЯ рд╣реЛрддреА рд╣реИрдВ, рд╡реЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддреА рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЛ рдЪрдХрдорд╛ рджреЗ рд╕рдХрддреА рд╣реИрдВ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдерд╛рди рдкрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GIFAR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╛рдЗрд▓реЗрдВ, рдЬреЛ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ GIF рдЪрд┐рддреНрд░ рдФрд░ рдЬрд╛рд╡рд╛ рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ (JAR, рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЗрдВ) рд╕рд╣реА рд╣реИрдВред рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд╝рд╛рдЗрд▓ рдХреЛ рджреБрд░реНрд╡реНрдпрд╡рд╣рд╛рд░</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░рддреЗ рд╣реБрдП рдЖрд▓реЗрдЦ рджреЗрдЦреЗрдВ </font><font style="vertical-align: inherit;">(рдкреГрд╖реНрда 18 рдкрд░ рд╢реБрд░реВ)ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдиреАрдЪреЗ рджреЗрдЦреЗрдВрдЧреЗ, рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЗрдВ 32-рдмрд┐рдЯ рдлрд╝реАрд▓реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдСрдлрд╝рд╕реЗрдЯреНрд╕ рдФрд░ рдЖрдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рдЖрдХрд╛рд░ рдФрд░ рдЗрд╕рдХреЗ рддрддреНрд╡реЛрдВ рдХреЛ рдЪрд╛рд░ рдЧреАрдЧрд╛рдмрд╛рдЗрдЯ рддрдХ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреА рд╣реИрдВред рдореЗрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡реЗрджрди рдиреЛрдЯ 4.5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKWare рдиреЗ 64-рдмрд┐рдЯ рдСрдлрд╝рд╕реЗрдЯ рдФрд░ рдЖрдХрд╛рд░реЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реБрдП рдкреНрд░рд╛рд░реВрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреЛрдбрд╝ рджрд┐рдП рд╣реИрдВред рдЗрди рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдлрд╛рдЗрд▓реЗрдВ рдЬрд╝рд┐рдк 64 рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо рдЙрди рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред</font></font><br>
<br>
<a name="19"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВ</font></font></h3><br>
<a name="20"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЕрдВрдд</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ (рдИрдУрд╕реАрдбреАрдЖрд░) рдХрд╛ рдЕрдВрдд рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реБрд░реБрдЖрддреА рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рд╕реНрдерд╛рди рдФрд░ рдЖрдХрд╛рд░, рд╕рд╛рде рд╣реА рдкреВрд░реЗ рд╕рдВрдЧреНрд░рд╣ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡реИрдХрд▓реНрдкрд┐рдХ рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрдИ рдбрд┐рд╕реНрдХреЗрдЯ - рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ - рдИрдУрд╕реАрдбреАрдЖрд░ рдореЗрдВ рдпрд╣ рднреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдХрд┐ рд╣рдо рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХрд┐рд╕ рдбрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕ рдбрд┐рд╕реНрдХ рдкрд░ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рдЖрджрд┐ред рдЖрдЬ, рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢рд╛рдпрдж рд╣реА рдХрднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдХреЛрдб рдРрд╕реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EOCDR рд╣рд╕реНрддрд╛рдХреНрд╖рд░ 'P' K 'рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рдж рдмрд╛рдЗрдЯреНрд╕ 5 рдФрд░ 6. рдЗрд╕рдХреЗ рдмрд╛рдж рдиреАрдЪреЗ рдХреА рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИ, рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЛ рдЫреЛрдЯреЗ-рдПрдВрдбрд┐рдпрди рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* End of Central Directory Record. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> {</span>
        <span class="hljs-keyword">uint16_t</span> disk_nbr;        <span class="hljs-comment">/* Number of this disk. */</span>
        <span class="hljs-keyword">uint16_t</span> cd_start_disk;   <span class="hljs-comment">/* Nbr. of disk with start of the CD. */</span>
        <span class="hljs-keyword">uint16_t</span> disk_cd_entries; <span class="hljs-comment">/* Nbr. of CD entries on this disk. */</span>
        <span class="hljs-keyword">uint16_t</span> cd_entries;      <span class="hljs-comment">/* Nbr. of Central Directory entries. */</span>
        <span class="hljs-keyword">uint32_t</span> cd_size;         <span class="hljs-comment">/* Central Directory size in bytes. */</span>
        <span class="hljs-keyword">uint32_t</span> cd_offset;       <span class="hljs-comment">/* Central Directory file offset. */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;     <span class="hljs-comment">/* Archive comment length. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;   <span class="hljs-comment">/* Archive comment. */</span><font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдИрдУрд╕реАрдбреАрдЖрд░ рдлрд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдЪреВрдВрдХрд┐ рдЗрд╕рдХреА рдкреВрдВрдЫ рдореЗрдВ рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ 16-рдмрд┐рдЯ рд▓рдВрдмрд╛рдИ рдХреА рдЯрд┐рдкреНрдкрдгреА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд┐рддрд┐ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Read 16/32 bits little-endian and bump p forward afterwards. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ16(p) ((p) += 2, read16le((p) - 2))</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> READ32(p) ((p) += 4, read32le((p) - 4))</span><font></font>
<font></font>
<span class="hljs-comment">/* Size of the End of Central Directory Record, not including comment. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EOCDR_BASE_SZ 22</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EOCDR_SIGNATURE 0x06054b50  <span class="hljs-comment">/* "PK\5\6" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">find_eocdr</span><span class="hljs-params">(struct eocdr *r, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len)</span>
</span>{
        <span class="hljs-keyword">size_t</span> comment_len;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (comment_len = <span class="hljs-number">0</span>; comment_len &lt;= UINT16_MAX; comment_len++) {
                <span class="hljs-keyword">if</span> (src_len &lt; EOCDR_BASE_SZ + comment_len) {
                        <span class="hljs-keyword">break</span>;<font></font>
                }<font></font>
<font></font>
                p = &amp;src[src_len - EOCDR_BASE_SZ - comment_len];<font></font>
                signature = READ32(p);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (signature == EOCDR_SIGNATURE) {<font></font>
                        r-&gt;disk_nbr = READ16(p);<font></font>
                        r-&gt;cd_start_disk = READ16(p);<font></font>
                        r-&gt;disk_cd_entries = READ16(p);<font></font>
                        r-&gt;cd_entries = READ16(p);<font></font>
                        r-&gt;cd_size = READ32(p);<font></font>
                        r-&gt;cd_offset = READ32(p);<font></font>
                        r-&gt;comment_len = READ16(p);<font></font>
                        r-&gt;comment = p;<font></font>
                        assert(p == &amp;src[src_len - comment_len] &amp;&amp;<font></font>
                               <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
                        <span class="hljs-keyword">if</span> (r-&gt;comment_len == comment_len) {
                                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
                        }<font></font>
                }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EOCDR рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдЖрд╕рд╛рди рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрддрд╛ рд╣реИ рдФрд░ рд▓рд┐рдЦреА рдЧрдИ рдмрд╛рдЗрдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write 16/32 bits little-endian and bump p forward afterwards. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE16(p, x) (write16le((p), (x)), (p) += 2)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WRITE32(p, x) (write32le((p), (x)), (p) += 4)</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_eocdr</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct eocdr *r)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, EOCDR_SIGNATURE);<font></font>
        WRITE16(p, r-&gt;disk_nbr);<font></font>
        WRITE16(p, r-&gt;cd_start_disk);<font></font>
        WRITE16(p, r-&gt;disk_cd_entries);<font></font>
        WRITE16(p, r-&gt;cd_entries);<font></font>
        WRITE32(p, r-&gt;cd_size);<font></font>
        WRITE32(p, r-&gt;cd_offset);<font></font>
        WRITE16(p, r-&gt;comment_len);<font></font>
        assert(p - dst == EOCDR_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (r-&gt;comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, r-&gt;comment, r-&gt;comment_len);<font></font>
                p += r-&gt;comment_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="21"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЗрдВрдЯреНрд░рд▓ рдлрд╝рд╛рдЗрд▓ рд╣реИрдбрд░</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдХреЗрдВрджреНрд░реАрдп рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрдЧреНрд░рд╣ рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЗ рдмрд╛рдж рдПрдХ рд▓рд┐рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдкреНрд░рддреНрдпреЗрдХ рд╢реАрд░реНрд╖рдХ 'P', 'K', 1, 2 рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕ рддрд░рд╣ рдХреА рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EXT_ATTR_DIR (1U &lt;&lt; 4)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> EXT_ATTR_ARC (1U &lt;&lt; 5)</span><font></font>
<font></font>
<span class="hljs-comment">/* Central File Header (Central Directory Entry) */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> {</span>
        <span class="hljs-keyword">uint16_t</span> made_by_ver;    <span class="hljs-comment">/* Version made by. */</span>
        <span class="hljs-keyword">uint16_t</span> extract_ver;    <span class="hljs-comment">/* Version needed to extract. */</span>
        <span class="hljs-keyword">uint16_t</span> gp_flag;        <span class="hljs-comment">/* General purpose bit flag. */</span>
        <span class="hljs-keyword">uint16_t</span> method;         <span class="hljs-comment">/* Compression method. */</span>
        <span class="hljs-keyword">uint16_t</span> mod_time;       <span class="hljs-comment">/* Modification time. */</span>
        <span class="hljs-keyword">uint16_t</span> mod_date;       <span class="hljs-comment">/* Modification date. */</span>
        <span class="hljs-keyword">uint32_t</span> crc32;          <span class="hljs-comment">/* CRC-32 checksum. */</span>
        <span class="hljs-keyword">uint32_t</span> comp_size;      <span class="hljs-comment">/* Compressed size. */</span>
        <span class="hljs-keyword">uint32_t</span> uncomp_size;    <span class="hljs-comment">/* Uncompressed size. */</span>
        <span class="hljs-keyword">uint16_t</span> name_len;       <span class="hljs-comment">/* Filename length. */</span>
        <span class="hljs-keyword">uint16_t</span> extra_len;      <span class="hljs-comment">/* Extra data length. */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;    <span class="hljs-comment">/* Comment length. */</span>
        <span class="hljs-keyword">uint16_t</span> disk_nbr_start; <span class="hljs-comment">/* Disk nbr. where file begins. */</span>
        <span class="hljs-keyword">uint16_t</span> int_attrs;      <span class="hljs-comment">/* Internal file attributes. */</span>
        <span class="hljs-keyword">uint32_t</span> ext_attrs;      <span class="hljs-comment">/* External file attributes. */</span>
        <span class="hljs-keyword">uint32_t</span> lfh_offset;     <span class="hljs-comment">/* Local File Header offset. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;     <span class="hljs-comment">/* Filename. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *extra;    <span class="hljs-comment">/* Extra data. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;  <span class="hljs-comment">/* File comment. */</span><font></font>
};<font></font>
</code></pre><br>
<code>made_by_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>extract_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдЖрдЗрдЯрдо рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдУрдПрд╕ рдФрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдиреНрдХреЛрдб рдХрд░реЗрдВ, рд╕рд╛рде рд╣реА рдЗрд╕реЗ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЖрда рдмрд┐рдЯреНрд╕ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдПрдирдХреЛрдб рдХрд░рддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 0 рдХрд╛ рдЕрд░реНрде рд╣реИ рдбреЙрд╕, 3 рдХрд╛ рдЕрд░реНрде рд╣реИ рдпреВрдирд┐рдХреНрд╕, 10 рдХрд╛ рдорддрд▓рдм рд╣реИ рд╡рд┐рдВрдбреЛрдЬ рдПрдирдЯреАрдПрдлрдПрд╕), рдФрд░ рдирд┐рдЪрд▓реЗ рдЖрда рдмрд┐рдЯреНрд╕ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдПрдирдХреЛрдб рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рджрд╢рдорд▓рд╡ рдорд╛рди рдХреЛ 20 рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ PKZip 2.0 рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрддрд╛ред </font></font><br>
<br>
<code>gp_flag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрд▓рдЧ рдЭрдВрдбреЗ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╣рдореЗ рд░реВрдЪрд┐ рд╣реИ:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рдЯ 0, рддрддреНрд╡ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рддрдереНрдп рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ (рд╣рдо рдЗрд╕ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдмрд┐рдЯреНрд╕ 1 рдФрд░ 2, Deflate рд╕рдВрдкреАрдбрд╝рди рдХреЗ рд╕реНрддрд░ рдХреЛ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ (0 - рд╕рд╛рдорд╛рдиреНрдп, 1 - рдЕрдзрд┐рдХрддрдо, 2 - рддреЗрдЬ, 3 - рдмрд╣реБрдд рддреЗрдЬ)ред</font></font></li>
</ul><br>
<code>method</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рдВрдкреАрдбрд╝рди рд╡рд┐рдзрд┐ рд╕рд╛рдВрдХреЗрддрд┐рдХ рд╢рдмреНрджреЛрдВ рдореЗрдВ рдмрджрд▓рдирд╛ред 0 - рдбреЗрдЯрд╛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдирд╣реАрдВ, 8 - рд╡рд┐рд▓рдВрдмрд┐рдд рд▓рд╛рдЧреВред рдЕрдиреНрдп рдореВрд▓реНрдп рдкреБрд░рд╛рдиреЗ рдпрд╛ рдирдП рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ, рд▓реЗрдХрд┐рди рд▓рдЧрднрдЧ рд╕рднреА рдЬрд╝рд┐рдк рдЗрди рджреЛ рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </font></font><br>
<br>
<code>mod_time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;">MS-DOS рдкреНрд░рд╛рд░реВрдк</font></a></font><code>mod_date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдП рдЧрдП рджрд┐рдирд╛рдВрдХ рдФрд░ рд╕рдордп рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ </font><font style="vertical-align: inherit;">ред рдЗрд╕ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо </font><font style="vertical-align: inherit;">MS-DOS рдкреНрд░рд╛рд░реВрдк </font><font style="vertical-align: inherit;">рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп C рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк </font><font style="vertical-align: inherit;">рдХреЛ рдФрд░ </font><font style="vertical-align: inherit;">рдЙрд╕рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВрдЧреЗ </font><font style="vertical-align: inherit;">:</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>time_t</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Convert DOS date and time to time_t. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">time_t</span> <span class="hljs-title">dos2ctime</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> dos_date, <span class="hljs-keyword">uint16_t</span> dos_time)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> <span class="hljs-title">tm</span> = {</span><span class="hljs-number">0</span>};<font></font>
<font></font>
        tm.tm_sec = (dos_time &amp; <span class="hljs-number">0x1f</span>) * <span class="hljs-number">2</span>;  <span class="hljs-comment">/* Bits 0--4:  Secs divided by 2. */</span>
        tm.tm_min = (dos_time &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0x3f</span>; <span class="hljs-comment">/* Bits 5--10: Minute. */</span>
        tm.tm_hour = (dos_time &gt;&gt; <span class="hljs-number">11</span>);      <span class="hljs-comment">/* Bits 11-15: Hour (0--23). */</span><font></font>
<font></font>
        tm.tm_mday = (dos_date &amp; <span class="hljs-number">0x1f</span>);          <span class="hljs-comment">/* Bits 0--4: Day (1--31). */</span>
        tm.tm_mon = ((dos_date &gt;&gt; <span class="hljs-number">5</span>) &amp; <span class="hljs-number">0xf</span>) - <span class="hljs-number">1</span>; <span class="hljs-comment">/* Bits 5--8: Month (1--12). */</span>
        tm.tm_year = (dos_date &gt;&gt; <span class="hljs-number">9</span>) + <span class="hljs-number">80</span>;       <span class="hljs-comment">/* Bits 9--15: Year-1980. */</span><font></font>
<font></font>
        tm.tm_isdst = <span class="hljs-number">-1</span>;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> mktime(&amp;tm);<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* Convert time_t to DOS date and time. */</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ctime2dos</span><span class="hljs-params">(<span class="hljs-keyword">time_t</span> t, <span class="hljs-keyword">uint16_t</span> *dos_date, <span class="hljs-keyword">uint16_t</span> *dos_time)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">tm</span> = <span class="hljs-title">localtime</span>(&amp;<span class="hljs-title">t</span>);</span><font></font>
<font></font>
        *dos_time = <span class="hljs-number">0</span>;<font></font>
        *dos_time |= tm-&gt;tm_sec / <span class="hljs-number">2</span>;    <span class="hljs-comment">/* Bits 0--4:  Second divided by two. */</span>
        *dos_time |= tm-&gt;tm_min &lt;&lt; <span class="hljs-number">5</span>;   <span class="hljs-comment">/* Bits 5--10: Minute. */</span>
        *dos_time |= tm-&gt;tm_hour &lt;&lt; <span class="hljs-number">11</span>; <span class="hljs-comment">/* Bits 11-15: Hour. */</span><font></font>
<font></font>
        *dos_date = <span class="hljs-number">0</span>;<font></font>
        *dos_date |= tm-&gt;tm_mday;             <span class="hljs-comment">/* Bits 0--4:  Day (1--31). */</span>
        *dos_date |= (tm-&gt;tm_mon + <span class="hljs-number">1</span>) &lt;&lt; <span class="hljs-number">5</span>;   <span class="hljs-comment">/* Bits 5--8:  Month (1--12). */</span>
        *dos_date |= (tm-&gt;tm_year - <span class="hljs-number">80</span>) &lt;&lt; <span class="hljs-number">9</span>; <span class="hljs-comment">/* Bits 9--15: Year from 1980. */</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд╝реАрд▓реНрдб </font></font><code>crc32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ </font><font style="vertical-align: inherit;">рдЕрд╕рдореНрдкреАрдбрд┐рдд рдбреЗрдЯрд╛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЗ рдЪрдХреНрд░реАрдп рдирд┐рд░рд░реНрдердХ рдХреЛрдб рдХрд╛ рдорд╛рди</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рдж рдбреЗрдЯрд╛ рдЕрдЦрдВрдбрддрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crc32.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br>
<br>
<code>comp_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>uncomp_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдЗрдЯрдо рдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛ рдХреЗ рд╕рдВрдХреБрдЪрд┐рдд рдФрд░ рдЕрд╕рдореНрдкреАрдбрд┐рдд рдЖрдХрд╛рд░ рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреАрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╢реАрд░реНрд╖рдХ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдирд╛рдо, рдЯрд┐рдкреНрдкрдгреА рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдХреА рд▓рдВрдмрд╛рдИ рд╣реЛрддреА рд╣реИред </font></font><code>disk_nbr_start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдИ рдбрд┐рд╕реНрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ред </font></font><br>
<br>
<code>int_attrs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ </font></font><code>ext_attrs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрдВрддрд░рд┐рдХ рдФрд░ рдмрд╛рд╣рд░реА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░реЗрдВред рдЖрдВрддрд░рд┐рдХ рд▓реЛрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХрдо рд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХреЗрд╡рд▓ рдкрд╛рда рд╣реИред рдмрд╛рд╣рд░реА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╕реЗ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓ рдЫрд┐рдкреА рд╣реБрдИ рд╣реИ, рдХреЗрд╡рд▓-рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрджрд┐ред рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА OS рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдкрд░</font></font><code>made_by_ver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдбреЙрд╕ рдореЗрдВ, рдирд┐рдЪрд▓реЗ 8 рдмрд┐рдЯреНрд╕ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╢реЗрд╖рддрд╛ рдмрд╛рдЗрдЯ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕реЗ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int 21 / AX = 4300h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмрд┐рдЯ 4 рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╣реИ, рдФрд░ рдмрд┐рдЯ 5 рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ "рд╕рдВрдЧреНрд░рд╣" рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗрдЯ рд╣реИ (рдбреЙрд╕ рдореЗрдВ рдЕрдзрд┐рдХрд╛рдВрд╢ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдЪ рд╣реИ)ред рдЬрд╣рд╛рдВ рддрдХ тАЛтАЛрдореИрдВ рд╕рдордЭрддрд╛ рд╣реВрдВ, рд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рдпреЗ рдмрд┐рдЯреНрд╕ рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдЕрдиреНрдп рдУрдПрд╕ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд╣реИрдВред рдпреВрдирд┐рдХреНрд╕ рдкрд░, рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдЙрдЪреНрдЪ 16 рдмрд┐рдЯ рдлрд╝рд╛рдЗрд▓ рдореЛрдб рдмрд┐рдЯреНрд╕ рдХрд┐ рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреЗрдЯ (2)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ </font></font><code>st_mode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font></font><br>
<br>
<code>lfh_offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╢реАрд░реНрд╖рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдБ рджреЗрдЦрдирд╛ рд╣реИред </font></font><code>name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдлрд╝рд╛рдЗрд▓ рдирд╛рдо (рд╕реА-рд▓рд╛рдЗрди), рдФрд░ </font></font><code>comment</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- рдЗрд╕ рд╕рдВрдЧреНрд░рд╣ рддрддреНрд╡ (рд╕реА-рд▓рд╛рдЗрди) рдХреЗ рд▓рд┐рдП рд╡реИрдХрд▓реНрдкрд┐рдХ рдЯрд┐рдкреНрдкрдгреАред </font></font><code>extra</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реИрдХрд▓реНрдкрд┐рдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдпреВрдирд┐рдХреНрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА, рдкрд░рд┐рд╡рд░реНрддрди рдХреА рд╕рд╣реА рддрд╛рд░реАрдЦ рдФрд░ рд╕рдордп, рдпрд╛ рдЬрд╝рд┐рдк 64 рдлрд╝реАрд▓реНрдбред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдХреЗрдВрджреНрд░реАрдп рд╢реАрд░реНрд╖рдХреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Size of a Central File Header, not including name, extra, and comment. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CFH_BASE_SZ 46</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CFH_SIGNATURE 0x02014b50 <span class="hljs-comment">/* "PK\1\2" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">read_cfh</span><span class="hljs-params">(struct cfh *cfh, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len,
                     <span class="hljs-keyword">size_t</span> offset)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (offset &gt; src_len || src_len - offset &lt; CFH_BASE_SZ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;src[offset];<font></font>
        signature = READ32(p);<font></font>
        <span class="hljs-keyword">if</span> (signature != CFH_SIGNATURE) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        cfh-&gt;made_by_ver = READ16(p);<font></font>
        cfh-&gt;extract_ver = READ16(p);<font></font>
        cfh-&gt;gp_flag = READ16(p);<font></font>
        cfh-&gt;method = READ16(p);<font></font>
        cfh-&gt;mod_time = READ16(p);<font></font>
        cfh-&gt;mod_date = READ16(p);<font></font>
        cfh-&gt;crc32 = READ32(p);<font></font>
        cfh-&gt;comp_size = READ32(p);<font></font>
        cfh-&gt;uncomp_size = READ32(p);<font></font>
        cfh-&gt;name_len = READ16(p);<font></font>
        cfh-&gt;extra_len = READ16(p);<font></font>
        cfh-&gt;comment_len = READ16(p);<font></font>
        cfh-&gt;disk_nbr_start = READ16(p);<font></font>
        cfh-&gt;int_attrs = READ16(p);<font></font>
        cfh-&gt;ext_attrs = READ32(p);<font></font>
        cfh-&gt;lfh_offset = READ32(p);<font></font>
        cfh-&gt;name = p;<font></font>
        cfh-&gt;extra = cfh-&gt;name + cfh-&gt;name_len;<font></font>
        cfh-&gt;comment = cfh-&gt;extra + cfh-&gt;extra_len;<font></font>
        assert(p == &amp;src[offset + CFH_BASE_SZ] &amp;&amp; <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_len - offset - CFH_BASE_SZ &lt;<font></font>
            cfh-&gt;name_len + cfh-&gt;extra_len + cfh-&gt;comment_len) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_cfh</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct cfh *cfh)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, CFH_SIGNATURE);<font></font>
        WRITE16(p, cfh-&gt;made_by_ver);<font></font>
        WRITE16(p, cfh-&gt;extract_ver);<font></font>
        WRITE16(p, cfh-&gt;gp_flag);<font></font>
        WRITE16(p, cfh-&gt;method);<font></font>
        WRITE16(p, cfh-&gt;mod_time);<font></font>
        WRITE16(p, cfh-&gt;mod_date);<font></font>
        WRITE32(p, cfh-&gt;crc32);<font></font>
        WRITE32(p, cfh-&gt;comp_size);<font></font>
        WRITE32(p, cfh-&gt;uncomp_size);<font></font>
        WRITE16(p, cfh-&gt;name_len);<font></font>
        WRITE16(p, cfh-&gt;extra_len);<font></font>
        WRITE16(p, cfh-&gt;comment_len);<font></font>
        WRITE16(p, cfh-&gt;disk_nbr_start);<font></font>
        WRITE16(p, cfh-&gt;int_attrs);<font></font>
        WRITE32(p, cfh-&gt;ext_attrs);<font></font>
        WRITE32(p, cfh-&gt;lfh_offset);<font></font>
        assert(p - dst == CFH_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;name_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;name, cfh-&gt;name_len);<font></font>
                p += cfh-&gt;name_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;extra_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;extra, cfh-&gt;extra_len);<font></font>
                p += cfh-&gt;extra_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (cfh-&gt;comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, cfh-&gt;comment, cfh-&gt;comment_len);<font></font>
                p += cfh-&gt;comment_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="22"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрдЧреНрд░рд╣ рддрддреНрд╡ рдХрд╛ рдбреЗрдЯрд╛ рдПрдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░ рд╕реЗ рдкрд╣рд▓реЗ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдХреЗрдВрджреНрд░реАрдп рд╣реЗрдбрд░ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рджреЛрд╣рд░рд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЗрдВрджреНрд░реАрдп рдФрд░ рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рджреЛрд╣рд░рд╛рд╡ рдХреЛ рд╕рдВрднрд╡рддрдпрд╛ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рддрд╛рдХрд┐ рдкреАрдХреЗрдЬрд┐рдк рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рдирд╣реАрдВ рд░рдЦрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдЬреИрд╕рд╛ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓ рдирд┐рдХрд╛рд▓реА рдЬрд╛рддреА рд╣реИ, рдЙрд╕рдХрд╛ рдирд╛рдо рдФрд░ рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рд╕реЗ рдкрдврд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рдЬрд╝рд┐рдк рдЕрднрд┐рд▓реЗрдЦрд╛рдЧрд╛рд░ рд╕реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдХреЗрдВрджреНрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЧрд╛рдпрдм рдпрд╛ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рд╣реЛрддреА рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рдЕрддрд┐рд░реЗрдХ рдЕрдирд┐рд╢реНрдЪрд┐рддрддрд╛ рдХрд╛ рдореБрдЦреНрдп рд╕реНрд░реЛрдд рднреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдХреЗрдВрджреНрд░реАрдп рдФрд░ рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗ рд╣реИрдВ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛? рдпрд╣ рдЕрдХреНрд╕рд░ рдмрдЧ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрдВрдЯреНрд░рд▓ рд╣реИрдбрд┐рдВрдЧ рд╕реЗ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓реЗ рдлрд╝реАрд▓реНрдбред </font><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рддреАрд╕рд░рд╛ рдХрдо рд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдЯ </font></font><code>gp_flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(рд╕реАрдЖрд░рд╕реА -32) </font><font style="vertical-align: inherit;">рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдФрд░ рдЕрд╕рдореНрдкреАрдбрд┐рдд рдлрд╝реАрд▓реНрдб рд╢реВрдиреНрдп рдкрд░ рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ, рдФрд░ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмреНрд▓реЙрдХ </font><font style="vertical-align: inherit;">рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рдж рд╣реА рдорд┐рд▓ рд╕рдХрддреА рд╣реИ (рд╣рдо рдЗрд╕ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ)ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЖрдкрдХреЛ рддрддреНрд╡ рдХрд╛ рдлрд╝рд╛рдЗрд▓ рдЖрдХрд╛рд░ рдЬреНрдЮрд╛рдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдпрд╣ рдХрд┐рд╕ рдЖрдХрд╛рд░ рдореЗрдВ рд╕рдВрдкреАрдбрд╝рд┐рдд рд╣реЛрдЧрд╛, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ 'P', 'K', 3, 4 рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕ рддрд░рд╣ рдХреА рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Local File Header. */</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> {</span>
        <span class="hljs-keyword">uint16_t</span> extract_ver;
        <span class="hljs-keyword">uint16_t</span> gp_flag;
        <span class="hljs-keyword">uint16_t</span> method;
        <span class="hljs-keyword">uint16_t</span> mod_time;
        <span class="hljs-keyword">uint16_t</span> mod_date;
        <span class="hljs-keyword">uint32_t</span> crc32;
        <span class="hljs-keyword">uint32_t</span> comp_size;
        <span class="hljs-keyword">uint32_t</span> uncomp_size;
        <span class="hljs-keyword">uint16_t</span> name_len;
        <span class="hljs-keyword">uint16_t</span> extra_len;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *extra;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпреЗ рдлрд╝рдВрдХреНрд╢рди рд╕реНрдерд╛рдиреАрдп рд╣реЗрдбрд░ рдХреЛ рдкрдврд╝рддреЗ рд╣реИрдВ рдФрд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЕрдиреНрдп рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рддрд░рд╣:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Size of a Local File Header, not including name and extra. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LFH_BASE_SZ 30</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LFH_SIGNATURE 0x04034b50 <span class="hljs-comment">/* "PK\3\4" little-endian. */</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">read_lfh</span><span class="hljs-params">(struct lfh *lfh, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len,
                     <span class="hljs-keyword">size_t</span> offset)</span>
</span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">uint32_t</span> signature;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (offset &gt; src_len || src_len - offset &lt; LFH_BASE_SZ) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        p = &amp;src[offset];<font></font>
        signature = READ32(p);<font></font>
        <span class="hljs-keyword">if</span> (signature != LFH_SIGNATURE) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        lfh-&gt;extract_ver = READ16(p);<font></font>
        lfh-&gt;gp_flag = READ16(p);<font></font>
        lfh-&gt;method = READ16(p);<font></font>
        lfh-&gt;mod_time = READ16(p);<font></font>
        lfh-&gt;mod_date = READ16(p);<font></font>
        lfh-&gt;crc32 = READ32(p);<font></font>
        lfh-&gt;comp_size = READ32(p);<font></font>
        lfh-&gt;uncomp_size = READ32(p);<font></font>
        lfh-&gt;name_len = READ16(p);<font></font>
        lfh-&gt;extra_len = READ16(p);<font></font>
        lfh-&gt;name = p;<font></font>
        lfh-&gt;extra = lfh-&gt;name + lfh-&gt;name_len;<font></font>
        assert(p == &amp;src[offset + LFH_BASE_SZ] &amp;&amp; <span class="hljs-string">"All fields read."</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_len - offset - LFH_BASE_SZ &lt; lfh-&gt;name_len + lfh-&gt;extra_len) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">size_t</span> <span class="hljs-title">write_lfh</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">const</span> struct lfh *lfh)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p = dst;<font></font>
<font></font>
        WRITE32(p, LFH_SIGNATURE);<font></font>
        WRITE16(p, lfh-&gt;extract_ver);<font></font>
        WRITE16(p, lfh-&gt;gp_flag);<font></font>
        WRITE16(p, lfh-&gt;method);<font></font>
        WRITE16(p, lfh-&gt;mod_time);<font></font>
        WRITE16(p, lfh-&gt;mod_date);<font></font>
        WRITE32(p, lfh-&gt;crc32);<font></font>
        WRITE32(p, lfh-&gt;comp_size);<font></font>
        WRITE32(p, lfh-&gt;uncomp_size);<font></font>
        WRITE16(p, lfh-&gt;name_len);<font></font>
        WRITE16(p, lfh-&gt;extra_len);<font></font>
        assert(p - dst == LFH_BASE_SZ);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (lfh-&gt;name_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, lfh-&gt;name, lfh-&gt;name_len);<font></font>
                p += lfh-&gt;name_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (lfh-&gt;extra_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">memcpy</span>(p, lfh-&gt;extra, lfh-&gt;extra_len);<font></font>
                p += lfh-&gt;extra_len;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">size_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="23"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдк рд░реАрдб рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрдврд╝рдиреЗ рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╕рдВрдЧреНрд░рд╣ рддрддреНрд╡реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">size_t</span> <span class="hljs-keyword">zipiter_t</span>; <span class="hljs-comment">/* Zip archive member iterator. */</span><font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zip_t</span> <span class="hljs-title">zip_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zip_t</span> {</span>
        <span class="hljs-keyword">uint16_t</span> num_members;    <span class="hljs-comment">/* Number of members. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;  <span class="hljs-comment">/* Zip file comment (not terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;    <span class="hljs-comment">/* Zip file comment length. */</span>
        <span class="hljs-keyword">zipiter_t</span> members_begin; <span class="hljs-comment">/* Iterator to the first member. */</span>
        <span class="hljs-keyword">zipiter_t</span> members_end;   <span class="hljs-comment">/* Iterator to the end of members. */</span><font></font>
<font></font>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src;
        <span class="hljs-keyword">size_t</span> src_len;<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Initialize zip based on the source data. Returns true on success, or false
   if the data could not be parsed as a valid Zip file. */</span>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">zip_read</span><span class="hljs-params">(<span class="hljs-keyword">zip_t</span> *zip, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *src, <span class="hljs-keyword">size_t</span> src_len)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> <span class="hljs-title">eocdr</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">size_t</span> i, offset;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comp_data;<font></font>
<font></font>
        zip-&gt;src = src;<font></font>
        zip-&gt;src_len = src_len;<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!find_eocdr(&amp;eocdr, src, src_len)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (eocdr.disk_nbr != <span class="hljs-number">0</span> || eocdr.cd_start_disk != <span class="hljs-number">0</span> ||<font></font>
            eocdr.disk_cd_entries != eocdr.cd_entries) {<font></font>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Cannot handle multi-volume archives. */</span><font></font>
        }<font></font>
<font></font>
        zip-&gt;num_members = eocdr.cd_entries;<font></font>
        zip-&gt;comment = eocdr.comment;<font></font>
        zip-&gt;comment_len = eocdr.comment_len;<font></font>
<font></font>
        offset = eocdr.cd_offset;<font></font>
        zip-&gt;members_begin = offset;<font></font>
<font></font>
        <span class="hljs-comment">/* Read the member info and do a few checks. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; eocdr.cd_entries; i++) {
                <span class="hljs-keyword">if</span> (!read_cfh(&amp;cfh, src, src_len, offset)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (cfh.gp_flag &amp; <span class="hljs-number">1</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* The member is encrypted. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.method != ZIP_STORED &amp;&amp; cfh.method != ZIP_DEFLATED) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Unsupported compression method. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.method == ZIP_STORED &amp;&amp;<font></font>
                    cfh.uncomp_size != cfh.comp_size) {<font></font>
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (cfh.disk_nbr_start != <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Cannot handle multi-volume archives. */</span><font></font>
                }<font></font>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">memchr</span>(cfh.name, <span class="hljs-string">'\0'</span>, cfh.name_len) != <span class="hljs-literal">NULL</span>) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Bad filename. */</span><font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (!read_lfh(&amp;lfh, src, src_len, cfh.lfh_offset)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
                }<font></font>
<font></font>
                comp_data = lfh.extra + lfh.extra_len;<font></font>
                <span class="hljs-keyword">if</span> (cfh.comp_size &gt; src_len - (<span class="hljs-keyword">size_t</span>)(comp_data - src)) {
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">/* Member data does not fit in src. */</span><font></font>
                }<font></font>
<font></font>
                offset += CFH_BASE_SZ + cfh.name_len + cfh.extra_len +<font></font>
                          cfh.comment_len;<font></font>
        }<font></font>
<font></font>
        zip-&gt;members_end = offset;<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдКрдкрд░ рдмрддрд╛рдпрд╛, рддрддреНрд╡ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпрд╛рдБ рдХреЗрдВрджреНрд░реАрдп рдлрд╝рд╛рдЗрд▓ рд╢реАрд░реНрд╖ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рдмрд╕ рдСрдлрд╝рд╕реЗрдЯ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдк рддрддреНрд╡ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> { ZIP_STORED = <span class="hljs-number">0</span>, ZIP_DEFLATED = <span class="hljs-number">8</span> } <span class="hljs-keyword">method_t</span>;<font></font>
<font></font>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zipmemb_t</span> <span class="hljs-title">zipmemb_t</span>;</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">zipmemb_t</span> {</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *name;      <span class="hljs-comment">/* Member name (not null terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> name_len;        <span class="hljs-comment">/* Member name length. */</span>
        <span class="hljs-keyword">time_t</span> mtime;             <span class="hljs-comment">/* Modification time. */</span>
        <span class="hljs-keyword">uint32_t</span> comp_size;       <span class="hljs-comment">/* Compressed size. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comp_data; <span class="hljs-comment">/* Compressed data. */</span>
        <span class="hljs-keyword">method_t</span> method;          <span class="hljs-comment">/* Compression method. */</span>
        <span class="hljs-keyword">uint32_t</span> uncomp_size;     <span class="hljs-comment">/* Uncompressed size. */</span>
        <span class="hljs-keyword">uint32_t</span> crc32;           <span class="hljs-comment">/* CRC-32 checksum. */</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *comment;   <span class="hljs-comment">/* Comment (not null terminated). */</span>
        <span class="hljs-keyword">uint16_t</span> comment_len;     <span class="hljs-comment">/* Comment length. */</span>
        <span class="hljs-keyword">bool</span> is_dir;              <span class="hljs-comment">/* Whether this is a directory. */</span>
        <span class="hljs-keyword">zipiter_t</span> next;           <span class="hljs-comment">/* Iterator to the next member. */</span><font></font>
};<font></font>
<font></font>
<span class="hljs-comment">/* Get the Zip archive member through iterator it. */</span>
<span class="hljs-function"><span class="hljs-keyword">zipmemb_t</span> <span class="hljs-title">zip_member</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">zip_t</span> *zip, <span class="hljs-keyword">zipiter_t</span> it)</span>
</span>{
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">bool</span> ok;
        <span class="hljs-keyword">zipmemb_t</span> m;<font></font>
<font></font>
        assert(it &gt;= zip-&gt;members_begin &amp;&amp; it &lt; zip-&gt;members_end);<font></font>
<font></font>
        ok = read_cfh(&amp;cfh, zip-&gt;src, zip-&gt;src_len, it);<font></font>
        assert(ok);<font></font>
<font></font>
        ok = read_lfh(&amp;lfh, zip-&gt;src, zip-&gt;src_len, cfh.lfh_offset);<font></font>
        assert(ok);<font></font>
<font></font>
        m.name = cfh.name;<font></font>
        m.name_len = cfh.name_len;<font></font>
        m.mtime = dos2ctime(cfh.mod_date, cfh.mod_time);<font></font>
        m.comp_size = cfh.comp_size;<font></font>
        m.comp_data = lfh.extra + lfh.extra_len;<font></font>
        m.method = cfh.method;<font></font>
        m.uncomp_size = cfh.uncomp_size;<font></font>
        m.crc32 = cfh.crc32;<font></font>
        m.comment = cfh.comment;<font></font>
        m.comment_len = cfh.comment_len;<font></font>
        m.is_dir = (cfh.ext_attrs &amp; EXT_ATTR_DIR) != <span class="hljs-number">0</span>;<font></font>
<font></font>
        m.next = it + CFH_BASE_SZ +<font></font>
                 cfh.name_len + cfh.extra_len + cfh.comment_len;<font></font>
<font></font>
        assert(m.next &lt;= zip-&gt;members_end);<font></font>
<font></font>
        <span class="hljs-keyword">return</span> m;<font></font>
}<font></font>
</code></pre><br>
<a name="24"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рдк рд░рд┐рдХреЙрд░реНрдб рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдореЗрдореЛрд░реА рдмрдлрд░ рдореЗрдВ рдЬрд┐рдк рдлрд╛рдЗрд▓ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдпрд╣ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреА рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреА рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдЪреВрдБрдХрд┐ рд╣рдо рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдХрд┐рддрдирд╛ рдбреЗрдЯрд╛ рдХрдВрдкреНрд░реЗрд╕ рдХрд░реЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЕрд╕рдореНрдкреАрдбрд┐рдд рддрддреНрд╡реЛрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдКрдкрд░реА рд╕реАрдорд╛ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Compute an upper bound on the dst size required by zip_write() for an
 * archive with num_memb members with certain filenames, sizes, and archive
 * comment. Returns zero on error, e.g. if a filename is longer than 2^16-1, or
 * if the total file size is larger than 2^32-1. */</span>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">zip_max_size</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> num_memb, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames,
                      <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint32_t</span> *file_sizes, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment)</span>
</span>{
        <span class="hljs-keyword">size_t</span> comment_len, name_len;
        <span class="hljs-keyword">uint64_t</span> total;
        <span class="hljs-keyword">uint16_t</span> i;<font></font>
<font></font>
        comment_len = (comment == <span class="hljs-literal">NULL</span> ? <span class="hljs-number">0</span> : <span class="hljs-built_in">strlen</span>(comment));
        <span class="hljs-keyword">if</span> (comment_len &gt; UINT16_MAX) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        total = EOCDR_BASE_SZ + comment_len; <span class="hljs-comment">/* EOCDR */</span><font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                assert(filenames[i] != <span class="hljs-literal">NULL</span>);<font></font>
                name_len = <span class="hljs-built_in">strlen</span>(filenames[i]);
                <span class="hljs-keyword">if</span> (name_len &gt; UINT16_MAX) {
                        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
                }<font></font>
<font></font>
                total += CFH_BASE_SZ + name_len; <span class="hljs-comment">/* Central File Header */</span>
                total += LFH_BASE_SZ + name_len; <span class="hljs-comment">/* Local File Header */</span>
                total += file_sizes[i];          <span class="hljs-comment">/* Uncompressed data size. */</span><font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (total &gt; UINT32_MAX) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">uint32_t</span>)total;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдХреЛрдб рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЗ рдЕрдкрд╕реНрдлреАрддрд┐ рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓рд┐рдЦрддрд╛ рд╣реИ, рдЙрдирдХрд╛ рдЖрдХрд╛рд░ рдХрдо рдХрд░рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* Write a Zip file containing num_memb members into dst, which must be large
   enough to hold the resulting data. Returns the number of bytes written, which
   is guaranteed to be less than or equal to the result of zip_max_size() when
   called with the corresponding arguments. comment shall be a null-terminated
   string or null. callback shall be null or point to a function which will
   get called after the compression of each member. */</span>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">zip_write</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *dst, <span class="hljs-keyword">uint16_t</span> num_memb,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-keyword">const</span> *file_data,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint32_t</span> *file_sizes,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">time_t</span> *mtimes,
                   <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment,
                   <span class="hljs-keyword">void</span> (*callback)(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">uint32_t</span> size,
                                    <span class="hljs-keyword">uint32_t</span> comp_size))</span>
</span>{
        <span class="hljs-keyword">uint16_t</span> i;
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eocdr</span> <span class="hljs-title">eocdr</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cfh</span> <span class="hljs-title">cfh</span>;</span>
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfh</span> <span class="hljs-title">lfh</span>;</span>
        <span class="hljs-keyword">bool</span> ok;
        <span class="hljs-keyword">uint16_t</span> name_len;
        <span class="hljs-keyword">uint8_t</span> *data_dst;
        <span class="hljs-keyword">size_t</span> comp_sz;
        <span class="hljs-keyword">uint32_t</span> lfh_offset, cd_offset, eocdr_offset;<font></font>
<font></font>
        p = dst;<font></font>
<font></font>
        <span class="hljs-comment">/* Write Local File Headers and deflated or stored data. */</span>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                assert(filenames[i] != <span class="hljs-literal">NULL</span>);<font></font>
                assert(<span class="hljs-built_in">strlen</span>(filenames[i]) &lt;= UINT16_MAX);<font></font>
                name_len = (<span class="hljs-keyword">uint16_t</span>)<span class="hljs-built_in">strlen</span>(filenames[i]);<font></font>
<font></font>
                data_dst = p + LFH_BASE_SZ + name_len;<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (hwdeflate(file_data[i], file_sizes[i], data_dst,<font></font>
                              file_sizes[i], &amp;comp_sz) &amp;&amp;<font></font>
                                comp_sz &lt; file_sizes[i]) {<font></font>
                        lfh.method = ZIP_DEFLATED;<font></font>
                        assert(comp_sz &lt;= UINT32_MAX);<font></font>
                        lfh.comp_size = (<span class="hljs-keyword">uint32_t</span>)comp_sz;<font></font>
                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-built_in">memcpy</span>(data_dst, file_data[i], file_sizes[i]);<font></font>
                        lfh.method = ZIP_STORED;<font></font>
                        lfh.comp_size = file_sizes[i];<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (callback != <span class="hljs-literal">NULL</span>) {<font></font>
                        callback(filenames[i], file_sizes[i], lfh.comp_size);<font></font>
                }<font></font>
<font></font>
                lfh.extract_ver = (<span class="hljs-number">0</span> &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-number">20</span>; <span class="hljs-comment">/* DOS | PKZIP 2.0 */</span>
                lfh.gp_flag = (lfh.method == ZIP_DEFLATED ? (<span class="hljs-number">0x1</span> &lt;&lt; <span class="hljs-number">1</span>) : <span class="hljs-number">0x0</span>);<font></font>
                ctime2dos(mtimes[i], &amp;lfh.mod_date, &amp;lfh.mod_time);<font></font>
                lfh.crc32 = crc32(file_data[i], file_sizes[i]);<font></font>
                lfh.uncomp_size = file_sizes[i];<font></font>
                lfh.name_len = name_len;<font></font>
                lfh.extra_len = <span class="hljs-number">0</span>;<font></font>
                lfh.name = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>*)filenames[i];<font></font>
                p += write_lfh(p, &amp;lfh);<font></font>
                p += lfh.comp_size;<font></font>
        }<font></font>
<font></font>
        assert(p - dst &lt;= UINT32_MAX);<font></font>
        cd_offset = (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
<font></font>
        <span class="hljs-comment">/* Write the Central Directory based on the Local File Headers. */</span>
        lfh_offset = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_memb; i++) {<font></font>
                ok = read_lfh(&amp;lfh, dst, SIZE_MAX, lfh_offset);<font></font>
                assert(ok);<font></font>
<font></font>
                cfh.made_by_ver = lfh.extract_ver;<font></font>
                cfh.extract_ver = lfh.extract_ver;<font></font>
                cfh.gp_flag = lfh.gp_flag;<font></font>
                cfh.method = lfh.method;<font></font>
                cfh.mod_time = lfh.mod_time;<font></font>
                cfh.mod_date = lfh.mod_date;<font></font>
                cfh.crc32 = lfh.crc32;<font></font>
                cfh.comp_size = lfh.comp_size;<font></font>
                cfh.uncomp_size = lfh.uncomp_size;<font></font>
                cfh.name_len = lfh.name_len;<font></font>
                cfh.extra_len = <span class="hljs-number">0</span>;<font></font>
                cfh.comment_len = <span class="hljs-number">0</span>;<font></font>
                cfh.disk_nbr_start = <span class="hljs-number">0</span>;<font></font>
                cfh.int_attrs = <span class="hljs-number">0</span>;<font></font>
                cfh.ext_attrs = EXT_ATTR_ARC;<font></font>
                cfh.lfh_offset = lfh_offset;<font></font>
                cfh.name = lfh.name;<font></font>
                p += write_cfh(p, &amp;cfh);<font></font>
<font></font>
                lfh_offset += LFH_BASE_SZ + lfh.name_len + lfh.comp_size;<font></font>
        }<font></font>
<font></font>
        assert(p - dst &lt;= UINT32_MAX);<font></font>
        eocdr_offset = (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
<font></font>
        <span class="hljs-comment">/* Write the End of Central Directory Record. */</span>
        eocdr.disk_nbr = <span class="hljs-number">0</span>;<font></font>
        eocdr.cd_start_disk = <span class="hljs-number">0</span>;<font></font>
        eocdr.disk_cd_entries = num_memb;<font></font>
        eocdr.cd_entries = num_memb;<font></font>
        eocdr.cd_size = eocdr_offset - cd_offset;<font></font>
        eocdr.cd_offset = cd_offset;<font></font>
        eocdr.comment_len = (<span class="hljs-keyword">uint16_t</span>)(comment == <span class="hljs-literal">NULL</span> ? <span class="hljs-number">0</span> : <span class="hljs-built_in">strlen</span>(comment));<font></font>
        eocdr.comment = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>*)comment;<font></font>
        p += write_eocdr(p, &amp;eocdr);<font></font>
<font></font>
        assert(p - dst &lt;= zip_max_size(num_memb, filenames, file_sizes,<font></font>
                                       comment));<font></font>
<font></font>
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">uint32_t</span>)(p - dst);<font></font>
}<font></font>
</code></pre><br>
<a name="25"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hwzip</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдХреИрд╕реЗ рдкрдврд╝рдирд╛ рдФрд░ рд▓рд┐рдЦрдирд╛ рд╣реИ, рдЙрдирдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╕реЗ рд╕рдВрдкреАрдбрд╝рд┐рдд рдФрд░ рд╡рд┐рдШрдЯрд┐рдд рдХрд░рдирд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдм рдЖрдЗрдП рдЗрди рд╕рднреА рд╕рд╛рдзрдиреЛрдВ рд╕реЗ рдпреБрдХреНрдд рдПрдХ рд╕рд░рд▓ рдЬрд┐рдк рдкреНрд░реЛрдЧреНрд░рд╛рдо рд▓рд┐рдЦреЗрдВред </font><font style="vertical-align: inherit;">рдХреЛрдб </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwzip.c</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╕рд╛рдзрд╛рд░рдг рддреНрд░реБрдЯрд┐ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореИрдХреНрд░реЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЪреЗрдХ рдХрд┐рдП рдЧрдП рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЗ рд▓рд┐рдП рдХрдИ рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рдХрд░реЗрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PERROR_IF(cond, msg) <span class="hljs-meta-keyword">if</span> (cond) { perror(msg); exit(1); }</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">xmalloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> size)</span>
</span>{
        <span class="hljs-keyword">void</span> *ptr = <span class="hljs-built_in">malloc</span>(size);<font></font>
        PERROR_IF(ptr == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"malloc"</span>);
        <span class="hljs-keyword">return</span> ptr;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> *<span class="hljs-title">xrealloc</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *ptr, <span class="hljs-keyword">size_t</span> size)</span>
</span>{<font></font>
        ptr = <span class="hljs-built_in">realloc</span>(ptr, size);<font></font>
        PERROR_IF(ptr == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"realloc"</span>);
        <span class="hljs-keyword">return</span> ptr;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рджреЛ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">read_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">size_t</span> *file_sz)</span>
</span>{<font></font>
        FILE *f;<font></font>
        <span class="hljs-keyword">uint8_t</span> *buf;
        <span class="hljs-keyword">size_t</span> buf_cap;<font></font>
<font></font>
        f = fopen(filename, <span class="hljs-string">"rb"</span>);<font></font>
        PERROR_IF(f == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"fopen"</span>);<font></font>
<font></font>
        buf_cap = <span class="hljs-number">4096</span>;<font></font>
        buf = xmalloc(buf_cap);<font></font>
<font></font>
        *file_sz = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (feof(f) == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (buf_cap - *file_sz == <span class="hljs-number">0</span>) {<font></font>
                        buf_cap *= <span class="hljs-number">2</span>;<font></font>
                        buf = xrealloc(buf, buf_cap);<font></font>
                }<font></font>
<font></font>
                *file_sz += fread(&amp;buf[*file_sz], <span class="hljs-number">1</span>, buf_cap - *file_sz, f);<font></font>
                PERROR_IF(ferror(f), <span class="hljs-string">"fread"</span>);<font></font>
        }<font></font>
<font></font>
        PERROR_IF(fclose(f) != <span class="hljs-number">0</span>, <span class="hljs-string">"fclose"</span>);
        <span class="hljs-keyword">return</span> buf;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">write_file</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *data, <span class="hljs-keyword">size_t</span> n)</span>
</span>{<font></font>
        FILE *f;<font></font>
<font></font>
        f = fopen(filename, <span class="hljs-string">"wb"</span>);<font></font>
        PERROR_IF(f == <span class="hljs-literal">NULL</span>, <span class="hljs-string">"fopen"</span>);<font></font>
        PERROR_IF(fwrite(data, <span class="hljs-number">1</span>, n, f) != n, <span class="hljs-string">"fwrite"</span>);<font></font>
        PERROR_IF(fclose(f) != <span class="hljs-number">0</span>, <span class="hljs-string">"fclose"</span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░рд╛ рдЬрд╝рд┐рдк рдкреНрд░реЛрдЧреНрд░рд╛рдо рддреАрди рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ: рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рдПрдХ рд╕реВрдЪреА рдмрдирд╛рдПрдБ рдФрд░ рдЙрд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдПрдБред </font><font style="vertical-align: inherit;">рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдХрд╣реАрдВ рд╕рд░рд▓ рдирд╣реАрдВ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">list_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">size_t</span> zip_sz;
        <span class="hljs-keyword">zip_t</span> z;
        <span class="hljs-keyword">zipiter_t</span> it;
        <span class="hljs-keyword">zipmemb_t</span> m;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Listing ZIP archive: %s\n\n"</span>, filename);<font></font>
<font></font>
        zip_data = read_file(filename, &amp;zip_sz);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!zip_read(&amp;z, zip_data, zip_sz)) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Failed to parse ZIP file!\n"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (z.comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n\n"</span>, (<span class="hljs-keyword">int</span>)z.comment_len, z.comment);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (it = z.members_begin; it != z.members_end; it = m.next) {<font></font>
                m = zip_member(&amp;z, it);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n"</span>, (<span class="hljs-keyword">int</span>)m.name_len, m.name);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-built_in">free</span>(zip_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рд╖реНрдХрд░реНрд╖рдг рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдХреЗ рд╢реВрдиреНрдп рд╕рдорд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдЗрд╕реЗ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </font></font><code>fopen</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) рдФрд░ рдЕрдирдкреИрдХрд┐рдВрдЧ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">char</span> *<span class="hljs-title">terminate_str</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *str, <span class="hljs-keyword">size_t</span> n)</span>
</span>{
        <span class="hljs-keyword">char</span> *p = xmalloc(n + <span class="hljs-number">1</span>);
        <span class="hljs-built_in">memcpy</span>(p, str, n);<font></font>
        p[n] = <span class="hljs-string">'\0'</span>;
        <span class="hljs-keyword">return</span> p;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-title">inflate_member</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">zipmemb_t</span> *m)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *p;
        <span class="hljs-keyword">size_t</span> src_used, dst_used;<font></font>
<font></font>
        assert(m-&gt;method == ZIP_DEFLATED);<font></font>
<font></font>
        p = xmalloc(m-&gt;uncomp_size);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (hwinflate(m-&gt;comp_data, m-&gt;comp_size, &amp;src_used, p, m-&gt;uncomp_size,<font></font>
                      &amp;dst_used) != HWINF_OK) {<font></font>
                <span class="hljs-built_in">free</span>(p);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (src_used != m-&gt;comp_size || dst_used != m-&gt;uncomp_size) {
                <span class="hljs-built_in">free</span>(p);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> p;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдорд╛рд░рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рд╕рдВрдЧреНрд░рд╣ рддрддреНрд╡ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рддрдерд╛рдХрдерд┐рдд </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрде рдЯреНрд░реИрд╡рд░реНрд╕рд▓ рд╣рдорд▓реЛрдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдмрд╛рд╣рд░ рд╕реЗ рдлрд╛рдЗрд▓ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Info-ZIP FAQ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкрдврд╝реЗрдВ </font><font style="vertical-align: inherit;">ред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">extract_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span>
</span>{
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">size_t</span> zip_sz;
        <span class="hljs-keyword">zip_t</span> z;
        <span class="hljs-keyword">zipiter_t</span> it;
        <span class="hljs-keyword">zipmemb_t</span> m;
        <span class="hljs-keyword">char</span> *tname;
        <span class="hljs-keyword">uint8_t</span> *inflated;
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *uncomp_data;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Extracting ZIP archive: %s\n\n"</span>, filename);<font></font>
<font></font>
        zip_data = read_file(filename, &amp;zip_sz);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (!zip_read(&amp;z, zip_data, zip_sz)) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Failed to read ZIP file!\n"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (z.comment_len != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%.*s\n\n"</span>, (<span class="hljs-keyword">int</span>)z.comment_len, z.comment);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (it = z.members_begin; it != z.members_end; it = m.next) {<font></font>
                m = zip_member(&amp;z, it);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (m.is_dir) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (Skipping dir: %.*s)\n"</span>,<font></font>
                               (<span class="hljs-keyword">int</span>)m.name_len, m.name);
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">memchr</span>(m.name, <span class="hljs-string">'/'</span>,  m.name_len) != <span class="hljs-literal">NULL</span> ||
                    <span class="hljs-built_in">memchr</span>(m.name, <span class="hljs-string">'\\'</span>, m.name_len) != <span class="hljs-literal">NULL</span>) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (Skipping file in dir: %.*s)\n"</span>,<font></font>
                               (<span class="hljs-keyword">int</span>)m.name_len, m.name);
                        <span class="hljs-keyword">continue</span>;<font></font>
                }<font></font>
<font></font>
                assert(m.method == ZIP_STORED || m.method == ZIP_DEFLATED);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">" %s: %.*s"</span>,<font></font>
                       m.method == ZIP_STORED ? <span class="hljs-string">"Extracting"</span> : <span class="hljs-string">" Inflating"</span>,<font></font>
                       (<span class="hljs-keyword">int</span>)m.name_len, m.name);<font></font>
                fflush(<span class="hljs-built_in">stdout</span>);<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (m.method == ZIP_STORED) {<font></font>
                        assert(m.uncomp_size == m.comp_size);<font></font>
                        inflated = <span class="hljs-literal">NULL</span>;<font></font>
                        uncomp_data = m.comp_data;<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                        inflated = inflate_member(&amp;m);<font></font>
                        <span class="hljs-keyword">if</span> (inflated == <span class="hljs-literal">NULL</span>) {
                                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error: inflation failed!\n"</span>);
                                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                        }<font></font>
                        uncomp_data = inflated;<font></font>
                }<font></font>
<font></font>
                <span class="hljs-keyword">if</span> (crc32(uncomp_data, m.uncomp_size) != m.crc32) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Error: CRC-32 mismatch!\n"</span>);
                        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                }<font></font>
<font></font>
                tname = terminate_str((<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*)m.name, m.name_len);<font></font>
                write_file(tname, uncomp_data, m.uncomp_size);<font></font>
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
                <span class="hljs-built_in">free</span>(inflated);
                <span class="hljs-built_in">free</span>(tname);<font></font>
        }<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
        <span class="hljs-built_in">free</span>(zip_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрд╝рд┐рдк рд╕рдВрдЧреНрд░рд╣ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрдирдкреБрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝реЗрдВрдЧреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдлреАрдб рдХрд░реЗрдВрдЧреЗ </font></font><code>zip_write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЪреВрдВрдХрд┐ рдорд╛рдирдХ рд╕реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓ рд╕рдВрд╢реЛрдзрди рд╕рдордп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рд╣рдо рд╡рд░реНрддрдорд╛рди рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдореИрдВ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рд╣реЛрдорд╡рд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдбрд╝рддрд╛ рд╣реВрдВ)ред</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">zip_callback</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">uint32_t</span> size, <span class="hljs-keyword">uint32_t</span> comp_size)</span>
</span>{
        <span class="hljs-keyword">bool</span> deflated = comp_size &lt; size;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">" %s: %s"</span>, deflated ? <span class="hljs-string">"Deflated"</span> : <span class="hljs-string">"  Stored"</span>, filename);
        <span class="hljs-keyword">if</span> (deflated) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">" (%u%%)"</span>, <span class="hljs-number">100</span> - <span class="hljs-number">100</span> * comp_size / size);<font></font>
        }<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">create_zip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *zip_filename, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *comment,
                       <span class="hljs-keyword">uint16_t</span> n, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *filenames)</span>
</span>{
        <span class="hljs-keyword">time_t</span> mtime;
        <span class="hljs-keyword">time_t</span> *mtimes;
        <span class="hljs-keyword">uint8_t</span> **file_data;
        <span class="hljs-keyword">uint32_t</span> *file_sizes;
        <span class="hljs-keyword">size_t</span> file_size, zip_size;
        <span class="hljs-keyword">uint8_t</span> *zip_data;
        <span class="hljs-keyword">uint16_t</span> i;<font></font>
<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Creating ZIP archive: %s\n\n"</span>, zip_filename);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (comment != <span class="hljs-literal">NULL</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n\n"</span>, comment);<font></font>
        }<font></font>
<font></font>
        mtime = time(<span class="hljs-literal">NULL</span>);<font></font>
<font></font>
        file_data = xmalloc(<span class="hljs-keyword">sizeof</span>(*file_data) * n);<font></font>
        file_sizes = xmalloc(<span class="hljs-keyword">sizeof</span>(*file_sizes) * n);<font></font>
        mtimes = xmalloc(<span class="hljs-keyword">sizeof</span>(*mtimes) * n);<font></font>
<font></font>
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {<font></font>
                file_data[i] = read_file(filenames[i], &amp;file_size);<font></font>
                <span class="hljs-keyword">if</span> (file_size &gt;= UINT32_MAX) {
                        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s is too large!\n"</span>, filenames[i]);
                        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
                }<font></font>
                file_sizes[i] = (<span class="hljs-keyword">uint32_t</span>)file_size;<font></font>
                mtimes[i] = mtime;<font></font>
        }<font></font>
<font></font>
        zip_size = zip_max_size(n, filenames, file_sizes, comment);<font></font>
        <span class="hljs-keyword">if</span> (zip_size == <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"zip writing not possible"</span>);
                <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<font></font>
        }<font></font>
<font></font>
        zip_data = xmalloc(zip_size);<font></font>
        zip_size = zip_write(zip_data, n, filenames,<font></font>
                             (<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *<span class="hljs-keyword">const</span> *)file_data,<font></font>
                             file_sizes, mtimes, comment, zip_callback);<font></font>
<font></font>
        write_file(zip_filename, zip_data, zip_size);<font></font>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-built_in">free</span>(zip_data);
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; n; i++) {
                <span class="hljs-built_in">free</span>(file_data[i]);<font></font>
        }<font></font>
        <span class="hljs-built_in">free</span>(mtimes);
        <span class="hljs-built_in">free</span>(file_sizes);
        <span class="hljs-built_in">free</span>(file_data);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдВрдд рдореЗрдВ, рдпрд╣ </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХреЗ рддрд░реНрдХреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдирд┐рд░реНрдгрдп рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_usage</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *argv0)</span>
</span>{
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Usage:\n\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s list &lt;zipfile&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s extract &lt;zipfile&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  %s create &lt;zipfile&gt; [-c &lt;comment&gt;] &lt;files...&gt;\n"</span>, argv0);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>{
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"HWZIP "</span> VERSION <span class="hljs-string">" -- A very simple ZIP program "</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"from https://www.hanshq.net/zip.html\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);<font></font>
<font></font>
        <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"list"</span>) == <span class="hljs-number">0</span>) {<font></font>
                list_zip(argv[<span class="hljs-number">2</span>]);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argc == <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"extract"</span>) == <span class="hljs-number">0</span>) {<font></font>
                extract_zip(argv[<span class="hljs-number">2</span>]);<font></font>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (argc &gt;= <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">1</span>], <span class="hljs-string">"create"</span>) == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">if</span> (argc &gt;= <span class="hljs-number">5</span> &amp;&amp; <span class="hljs-built_in">strcmp</span>(argv[<span class="hljs-number">3</span>], <span class="hljs-string">"-c"</span>) == <span class="hljs-number">0</span>) {<font></font>
                        create_zip(argv[<span class="hljs-number">2</span>], argv[<span class="hljs-number">4</span>], (<span class="hljs-keyword">uint16_t</span>)(argc - <span class="hljs-number">5</span>),<font></font>
                                   (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *)&amp;argv[<span class="hljs-number">5</span>]);<font></font>
                } <span class="hljs-keyword">else</span> {<font></font>
                        create_zip(argv[<span class="hljs-number">2</span>], <span class="hljs-literal">NULL</span>, (<span class="hljs-keyword">uint16_t</span>)(argc - <span class="hljs-number">3</span>),<font></font>
                                   (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-keyword">const</span> *)&amp;argv[<span class="hljs-number">3</span>]);<font></font>
                }<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
                print_usage(argv[<span class="hljs-number">0</span>]);
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
</code></pre><br>
<a name="26"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХрддреНрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрд░реЛрдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдПрдХ рдкреВрд░рд╛ рд╕реЗрдЯ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwzip-1.0.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд▓рд┐рдирдХреНрд╕ рдпрд╛ рдореИрдХ рдХреЗ рддрд╣рдд HWZip рдХреЛ рдХреИрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="cpp hljs">$ clang generate_tables.c &amp;&amp; ./a.out &gt; tables.c<font></font>
$ clang -O3 -DNDEBUG -march=native -o hwzip crc32.c deflate.c huffman.c \<font></font>
        hwzip.c lz77.c tables.c zip.c<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╡рд┐рдВрдбреЛрдЬ рдкрд░, рдбреЗрд╡рд▓рдкрд░ рдХреЗ рдкреНрд░реЙрдореНрдкреНрдЯ рдкрд░ рд╡рд┐рдЬреБрдЕрд▓ рд╕реНрдЯреВрдбрд┐рдпреЛ рдореЗрдВ (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡рд┐рдЬреБрдЕрд▓ рд╕реНрдЯреВрдбрд┐рдпреЛ рдирд╣реАрдВ рд╣реИ, рддреЛ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд┐рд▓реНрдб рдЯреВрд▓реНрд╕</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="cpp hljs">cl /TC generate_tables.c &amp;&amp; generate_tables &gt; tables.c<font></font>
cl /O2 /DNDEBUG /MT /Fehwzip.exe /TC crc32.c deflate.c huffman.c hwzip.c<font></font>
        lz77.c tables.c zip.c /link setargv.obj<font></font>
</code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рддрд░реНрдХреЛрдВ рдХреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
рд▓рд┐рдП Setargv.obj </font><font style="vertical-align: inherit;">ред)</font></font><br>
<br>
<a name="27"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд╖реНрдХрд░реНрд╖</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рддреЗрдЬреА рд╕реЗ рдФрд░ рдзреАрд░реЗ-рдзреАрд░реЗ рд╡рд┐рдХрд╕рд┐рдд рд╣реЛ рд░рд╣реА рд╣реИред </font><font style="vertical-align: inherit;">рдкрдЪрд╛рд╕ рдФрд░ рд╕рддреНрддрд░ рдХреЗ рджрд╢рдХ рдХреА рддрдХрдиреАрдХ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ 30 рд╕рд╛рд▓ рдкрд╣рд▓реЗ рдЬрд┐рдк рдкреНрд░рд╛рд░реВрдк рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдФрд░ рд╣рд╛рд▓рд╛рдВрдХрд┐ рддрдм рд╕реЗ рдмрд╣реБрдд рдХреБрдЫ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ, рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓реЗрдВ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╡рд╣реА рдмрдиреА рд╣реБрдИ рд╣реИрдВ рдФрд░ рдЖрдЬ рдкрд╣рд▓реЗ рд╕реЗ рдХрд╣реАрдВ рдЕрдзрд┐рдХ рдЖрдо рд╣реИрдВред </font><font style="vertical-align: inherit;">рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдХрд┐ рд╡реЗ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред</font></font><br>
<br>
<a name="28"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрднреНрдпрд╛рд╕</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HWZip рдХреЛ рдЙрд╕ рд╕рдордп рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдВ, рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдмрдЬрд╛рдп рд╡рд░реНрддрдорд╛рди рд╕рдордп рдХреЗ рд╕рдВрдЧреНрд░рд╣ рдХреЛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рд▓рд┐рдирдХреНрд╕ рдкрд░ рдореИрдХ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ рдореИрдХ рдФрд░ </font><font style="vertical-align: inherit;">рд╡рд┐рдВрдбреЛрдЬ рдкрд░ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetFileTime рдХрд╛</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╛ рдПрдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдзреНрд╡рдЬ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд╝рд╛рдЗрд▓ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</font></font></li>
<li>              gzip-.   тАФ    ,    Deflate (   ).    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RFC 1952</a>.</li>
<li>    Zip-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">   </a>.  HWZip ,   <code>read_file</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">mmap(2)</a>  Linux  Mac  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">CreateFileMapping</a>  Windows.</li>
<li> HWZip ,          Zip64.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> appnote.txt</a>.</li>
</ul><br>
<a name="29"></a><h2> </h2><br>
<ul>
<li>  BBS-   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">BBS: The Documentary</a>.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="> YouTube</a>.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Part 8: Compression</a>    SEA  PKWare.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">  </a>.</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">A better Zip bomb</a>    Zip-,    ┬л┬╗    .</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Zip Files All The Way Down</a> ,   <i>Zip-</i> тАФ ,    .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ascii-zip</a> тАФ  ,  Deflate-   ASCII-.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Rosetta Flash</a>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Ten Thousand Security Pitfalls: the Zip File Format</a> тАФ        .</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Reading bits in far too many ways part 1</a>, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">part 2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">part 3</a> тАФ       .</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Understanding Compression</a>      .</li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi490780/index.html">рдЗрдВрдЯреЗрд▓ Xeon рд╕реНрдХреЗрд▓реЗрдмрд▓ Gen2: рдХрд░реЛрдбрд╝реЛрдВ рдХреА рдмрдбрд╝реА рдмрд┐рдХреНрд░реА</a></li>
<li><a href="../hi490782/index.html">рдПрдирд╛рд▓реЙрдЧрдмрд╛рдЗрдЯреНрд╕ рд╕рдореНрдореЗрд▓рди: рд░реЛрд╕рдХреЛрдореНрдирд╛рдбрдЬрд╝реЛрд░, рдореАрдбрд┐рдпрд╛, рд╣рд╛рдИрд▓реЛрдб рдФрд░ рдСрд▓-рдСрд▓</a></li>
<li><a href="../hi490784/index.html">рдореИрдВ рдПрдХ Android рдбреЗрд╡рд▓рдкрд░ рд╣реВрдВ рдФрд░ рдореБрдЭреЗ рдореИрдиреНрдпреБрдЕрд▓ рдХрд╛рдо рдХрд░рдирд╛ рдкрд╕рдВрдж рдирд╣реАрдВ рд╣реИред</a></li>
<li><a href="../hi490786/index.html">рджреВрд╕рд░рд╛ рдЖрджреЗрд╢ рд░рд┐рд╕рд╛рд╡ рд╡рд┐рд╢реНрд▓реЗрд╖рдг: рдЬрдм рдпрд╣ рдЙрди рд▓реЛрдЧреЛрдВ рд╕реЗ рд▓реАрдХ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдмреИрдВрдХ рд╕реЗ рдбреЗрдЯрд╛ рдЪреЛрд░реА рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi490788/index.html">рдмреЗрдХрд╛рд░ REPLред рдпреИрдВрдбреЗрдХреНрд╕ рд░рд┐рдкреЛрд░реНрдЯ</a></li>
<li><a href="../hi490792/index.html">NSX-V рдореЗрдВ VXLAN - рдкрд░реЗрд╢рд╛рди рдЕрдВрдбрд░рд▓реЗ</a></li>
<li><a href="../hi490796/index.html">рд╕реАрдЖрд░рдбреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдХреА рдиреАрддрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi490804/index.html">рдХреИрд╕реЗ рдПрдХ рд╣реИрдХрд░ рдХреА рдорд╛рдБ рдЬреЗрд▓ рдореЗрдВ рдЧрдИ рдФрд░ рдмреЙрд╕ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░ рджрд┐рдпрд╛</a></li>
<li><a href="../hi490808/index.html">рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рддреНрд░рд┐рдпреЛрдВ рдореЗрдВ рдЧрдгрд┐рдд: рдШреВрд░реНрдгреА рд╡рд┐рд╕реНрдлреЛрдЯ рдЗрдВрдЬрди</a></li>
<li><a href="../hi490812/index.html">рд╕реНрдкреНрд░рд┐рдВрдЧ рдкреНрд░реЛрдлреЗрд╢рдирд▓ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрд╢рди 5 рд╕рдмрдорд┐рд╢рди рдХрд╛ рдЕрдиреБрднрд╡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>