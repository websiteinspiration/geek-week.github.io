<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‼️ 🌘 ⏰ テーブルとスティックから品質管理サービスを作成する方法 👉🏽 👨‍✈️ 🖍️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブル！多くの場合、パイロットを開始することを考えると、マネージャは状況を複雑にし、ロードマップを作成し、自分でアイデアを受け入れてテストするのではなく、開発者からのMVPを待ちます。カットの下では、Googleフォーム、VK、数十行のコードに基づいて品質管理サービスを作成し、開発者を傷...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>テーブルとスティックから品質管理サービスを作成する方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/472856/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こんにちは、ハブル！</font><font style="vertical-align: inherit;">多くの場合、パイロットを開始することを考えると、マネージャは状況を複雑にし、ロードマップを作成し、自分でアイデアを受け入れてテストするのではなく、開発者からのMVPを待ちます。</font><font style="vertical-align: inherit;">カットの下では、Googleフォーム、VK、数十行のコードに基づいて品質管理サービスを作成し、開発者を傷つけることなく、マーケティング担当者を1人だけ作成した話を共有したいと思います。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z0/h1/0h/z0h10hxua4cagzjcovtbf5t8oja.png"><br>
<a name="habracut"></a><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">免責事項</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：この記事では、質問、疑問、恐らく流血の涙や失明を引き起こすコードの例を待っています。</font><font style="vertical-align: inherit;">正当化すると言うべきことは1つだけあります。このコードはPapa Carloのように機能し、その使命を100％果たしましたが、一部のスクリプトはまだ機能しています。</font></font></blockquote><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファーストドードーピザプレイスの評価</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの会社の主要な原則の1つ- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">測定できないものは存在しません</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ピザが存在します。つまり、ピザの品質を何らかの形で評価する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはすべて2013年に始まりました。</font><font style="vertical-align: inherit;">当時、ネットワーク上には7つのピザ屋がありました。</font><font style="vertical-align: inherit;">その後、ドードーでは、製品の品質と規格を管理するプロジェクトを立ち上げることを決定しました。これは、すべてのパートナーが利用できるピザ屋の評価です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼はそのように見えました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/c9/rq/qj/c9rqqjnm6lxlqahi13lral5y7ni.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
データは顧客からの問い合わせ、ソーシャルメディアのレビューから取得されました。</font><font style="vertical-align: inherit;">ネットワークと少しのDodo IS（私たちの情報システム）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当時の明らかなプラス-格付けは、経営するピザ屋が最高になるために品質に取り組むように駆り立て始めました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2番目のミステリーショップピッツェリア評価</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
約1年後、私たちは製品自体を評価する必要があることに気付き、有名なモデル「ミステリーショッパー」を採用しました。</font><font style="vertical-align: inherit;">その瞬間、私たちは飛躍的な進歩を遂げました-ロシアで最初に、私たちの顧客はミステリーショッパーになると決定しました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クローズドグループVKの登場</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、そのようなサービスを提供する代理店のミステリーショッパーとどのように連携するかを知りました。</font><font style="vertical-align: inherit;">確認のため、メールまたは直接電話で連絡していることがわかりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このオプションはすぐに私たちを誘惑しませんでした。</font><font style="vertical-align: inherit;">私たちにとってそれは長い間だったので、私たちは間違いなく電話するつもりはありませんでしたが、クライアントにとってはそれは苦痛であり、スパムと同等でした。</font><font style="vertical-align: inherit;">メールは大量メール送信に使用されましたが、すぐに見捨てられました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは思いついた：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シークレットエージェントとの通信やチェックの調整には、VKの通常のページを使用しました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">写真レポートを収集するために、彼らはVKで壁を開けてグループを作りました。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、サービス調査では、Googleフォームを選択しました。</font><font style="vertical-align: inherit;">そして何？</font><font style="vertical-align: inherit;">便利なことに、別のサービスを切断する必要がなく、携帯電話にうまく表示されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手順はすべてGoogleドキュメントに記載されていました。 </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてが膝の上にあります。</font><font style="vertical-align: inherit;">スタートアップにとってはすべてがそうです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0x/bu/2u/0xbu2ung5j6no9ltwyi_re80aqe.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミステリーショッパーの写真。</font><font style="vertical-align: inherit;">はい、定規で幅を測定し、ピザの縁をカットして、生地の焼き上がりと品質を示しました。</font></font></i><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2015年の写真レポートのその他の例はこちらです。</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/-v/fx/nh/-vfxnheu2wvm1gxfcc2epiwqyxw.jpeg"><br>
<img src="https://habrastorage.org/webt/zd/kk/d0/zdkkd0crvk0xqgdidv9roxanw_c.jpeg"><br>
<img src="https://habrastorage.org/webt/qk/co/fz/qkcofzsjt7iz2qm0czous0dw84o.jpeg"><br>
<img src="https://habrastorage.org/webt/ca/zq/5a/cazq5atxyea8vjvdtmprmwnstly.jpeg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
評価は常に変化し、新しい評価基準が追加されました。</font><font style="vertical-align: inherit;">たとえば、Abakan-1ピッツェリアを評価する場合、これは131ポイントです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x9/6c/lj/x96cljo2g-fkxgmsrbbqy8_bcxe.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロセス全体の問題は、ポイント内のすべての違反が手動で記録され、自動化されなかったことです。</font><font style="vertical-align: inherit;">そして、これはすべて1人の従業員によって行われました。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Googleスプレッドシートの魔法</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2016年、人類がSUM以外の機能を長い間発明してきたことを学びました（成熟した）。</font><font style="vertical-align: inherit;">そして、スクリプトとテーブル間のデータインポート機能を使用して何ができるか...直接CRMビルド。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、表の各ピッツェリアを評価するためのシートがあり、その中に評価基準とスコアがありました。</font><font style="vertical-align: inherit;">1ピッツェリア= 1葉。</font><font style="vertical-align: inherit;">ピッツェリアが多いほど、シートも多くなります。</font><font style="vertical-align: inherit;">毎週新しいサイン。</font><font style="vertical-align: inherit;">マジックボタンを押すと、表のテンプレートシートが120枚に拡大されました。</font><font style="vertical-align: inherit;">わあ、なんて良いのだ！</font></font><br>
<br>
<img src="https://habrastorage.org/webt/k-/s9/fv/k-s9fvqwy1wnaomulahpgn7a7no.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動化のこの段階「Dodo Controlling」には約6か月かかりました。</font><font style="vertical-align: inherit;">私たちは段階的に移動しました：私たちは新しいことを学びました-実装されました、私たちは他に新しい何かを学びました-再び紹介されました</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">進歩のドライバーとしての制限</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初から、VKの個人アカウントに代わってミステリーショッパーと話しました。</font><font style="vertical-align: inherit;">そして、個人ページの解決不可能な問題に直面した日が来ました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">友達の数は10,000人に制限されています。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッセージの送信には制限があります。VKが「送信したメッセージが多すぎます。明日来てください」という言葉でブロックされたため、メッセージを送信できないことがあります。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、VKは16:00頃にメッセージの送信をブロックしました。</font><font style="vertical-align: inherit;">チームが休むことができたのは幸せな時間でした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
徐々に、VKのほぼすべての制限に遭遇し、このサイトを愛することをやめました。</font><font style="vertical-align: inherit;">しかし奇跡が起こり、VKはグループにメッセージウィジェット、チャットボット、その他の便利な機能を接続する機会を与えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、この可能性は2016年12月より前でしたが、重大な制限がありました。グループがクライアントから最後のメッセージを送信した瞬間から10日以内にしかメッセージに返信できませんでした。</font><font style="vertical-align: inherit;">彼らがこの制限を取り除いたとき、私たちのチームの生活は新しい色で輝き始めました。</font><font style="vertical-align: inherit;">それ以来、VK APIとGoogleスプレッドシートを使用した自動化の道を歩み始めました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザースクリプトにおける恐怖と嫌悪</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初は、ミステリーショッパーになるには、フォームに記入し、グループに申し込んで、コードワードを書き、返答を待つ必要がありました。</font><font style="vertical-align: inherit;">この待機は最大48時間続く可能性があります。</font><font style="vertical-align: inherit;">結構長く、登録後のチェック意欲は薄れました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しい知識のストアで、登録の自動化に取り掛かりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはいくつかのAPIメソッド、1つのフォーム、数十のテーブル、ランディングページ、PHPのボット、最もクールなマーケターのDodoと1人のDodoの最初のCFO、さまざまな状況での数十のメッセージテンプレートによって書かれたテーブル内のスクリプトを用意しました。</font><font style="vertical-align: inherit;">次に、これがユーザースクリプトと呼ばれているとは思いもしませんでした。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミステリーショッパーが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンケートに回答しました</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これは古いバージョンであり、現在は機能しません）。</font></font></li>
<li>      ,    .           ,           ,     ).</li>
<li>        : «,     ()     «»».</li>
<li>             «».       :<br>
–    ,      ;<br>
–  ,     ,         «/ »; <br>
–          .     ,        .        ;<br>
–       ,          .</li>
</ol><br>
<img src="https://habrastorage.org/webt/so/ty/se/sotysezhht_urug1ax9cnrvc9-g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは登録の自動化です。これで手順全体がほぼシンプルで理解しやすくなりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、すべてが時計仕掛けのようになりました。テーブルから直接PMにグループメッセージを介してシークレットエージェントにメッセージを送信できることが明らかになりました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zn/px/nd/znpxndqiyuxkqp0y6mnhov7fooc.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、たった46行のコードがありました！</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> range = SpreadsheetApp.getActiveSpreadsheet().getActiveRange();
  <span class="hljs-keyword">var</span> ss = range.getValues();
  <span class="hljs-keyword">var</span> carray = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">-2</span>).getValues();
  <span class="hljs-keyword">var</span> marray = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>).getValues();
  <span class="hljs-keyword">var</span> iarray = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>).getValues();<font></font>
  ss.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">r, i</span>) </span>{
  <span class="hljs-keyword">var</span> tt = range.getRowIndex();
  <span class="hljs-keyword">var</span> add = tt + i;
    <span class="hljs-keyword">var</span> check = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange(<span class="hljs-string">'L'</span> + add).getValue();
    <span class="hljs-keyword">if</span> (check != <span class="hljs-string">''</span>) {<font></font>
      SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange(<span class="hljs-string">'K'</span> + add).setValue(<span class="hljs-string">""</span>).setBackground(<span class="hljs-string">"#ffff00"</span>);
      <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
   <span class="hljs-keyword">var</span> payload = <font></font>
   {<font></font>
     <span class="hljs-string">"message"</span> : marray[i][<span class="hljs-number">0</span>],
     <span class="hljs-string">"user_id"</span> : r[<span class="hljs-number">0</span>],
     <span class="hljs-string">"access_token"</span> : <span class="hljs-string">"    "</span>,
     <span class="hljs-string">"v"</span> : <span class="hljs-string">"5.74"</span><font></font>
   };<font></font>
<font></font>
   <span class="hljs-keyword">var</span> options = <font></font>
   { <span class="hljs-comment">//   http-</span>
     <span class="hljs-string">"method"</span> : <span class="hljs-string">"post"</span>,
     <span class="hljs-string">"header"</span> : <span class="hljs-string">"Content-type: application/x-www-form-urlencoded"</span>,
     <span class="hljs-string">"payload"</span> : payload,
     <span class="hljs-string">"muteHttpExceptions"</span> : <span class="hljs-literal">true</span>,<font></font>
   };<font></font>
  <font></font>
<font></font>
  <span class="hljs-keyword">var</span> jsonData = <span class="hljs-built_in">JSON</span>.parse(UrlFetchApp.fetch(<span class="hljs-string">"https://api.vk.com/method/messages.send"</span>, options).getContentText());
    <span class="hljs-keyword">if</span> (jsonData[<span class="hljs-string">'error'</span>] != <span class="hljs-literal">undefined</span>) {<font></font>
<font></font>
      SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange(<span class="hljs-string">'K'</span> + add).setValue(<span class="hljs-string">""</span>).setBackground(<span class="hljs-string">"#ff0000"</span>);<font></font>
    }<font></font>
  Logger.log(jsonData);<font></font>
    <span class="hljs-keyword">var</span> log = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(<span class="hljs-string">'Log'</span>);
    <span class="hljs-keyword">var</span> int = log.getRange(<span class="hljs-string">'A1'</span>).getValue();
    <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();<font></font>
    log.getRange(<span class="hljs-string">'B'</span> + int).setValue(d);<font></font>
    log.getRange(<span class="hljs-string">'C'</span> + int).setValue(r[<span class="hljs-number">0</span>] + <span class="hljs-string">""</span>);<font></font>
    log.getRange(<span class="hljs-string">'A1'</span>).setValue(int + <span class="hljs-number">1</span>);<font></font>
  Utilities.sleep(<span class="hljs-number">400</span>);<font></font>
  });<font></font>
 }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
表では、メッセージテキスト自体を生成し、idページを使用してパーソナライズされたメールを作成しました。</font><font style="vertical-align: inherit;">また、メッセージのコピーと送信を手動で停止しました。</font><font style="vertical-align: inherit;">ピーク時には、テーブルを使用して45分で最大3000のメッセージを送信できました。</font><font style="vertical-align: inherit;">これを手作業で行った場合、私はこの記事を書きませんが、メッセージを送信し続けます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、そのような奇跡のタブレットの例を挙げます。</font><font style="vertical-align: inherit;">私は明確で機能的なUX / UIを作るために一生懸命に努力しました。</font><font style="vertical-align: inherit;">赤いボタンをクリックすることにより、メッセージの配布が開始され、秘密チェックを実施する提案が出されました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/be/ix/htbeixa27tdtlix28xnzhsmh6xg.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">地獄のプロセスを自動化するその他の機能</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同社には、ピザ屋から継続的にいくつかの指標を収集するのに役立つ多くのGoogleフォームがあります。各フォームには、最新の状態に保つ必要のあるピザ屋のリストがあります。このようなフォームは合計で53個あり、それぞれ手動で更新されていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような作業に少し疲れたので、このビジネスを自動化できることに気づきました。私は再びマーケターに目を向けました。1〜2時間後、すべての準備が整い、コードはわずか47行でした。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myFunction</span>(<span class="hljs-params"></span>) </span>{
 <span class="hljs-keyword">var</span> ss = SpreadsheetApp.getActiveSpreadsheet();
 <span class="hljs-keyword">var</span> range = ss.getActiveRange();
 <span class="hljs-keyword">var</span> forms = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>).getValues();
 <span class="hljs-keyword">var</span> items = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>).getValues();
 <span class="hljs-keyword">var</span> sources = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).getValues();
 <span class="hljs-keyword">var</span> ranges = range.offset(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>).getValues();<font></font>
  forms.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">r,i</span>) </span>{
  <span class="hljs-keyword">var</span> form = FormApp.openById(forms[i]);
  <span class="hljs-keyword">var</span> values = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sources[i]).getRange(ranges[i]).getValues();
  <span class="hljs-keyword">var</span> arr = [];<font></font>
  values.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">el,ei</span>) </span>{
    <span class="hljs-keyword">if</span> (el[<span class="hljs-number">0</span>] != <span class="hljs-string">''</span>) {<font></font>
      arr.push(el[<span class="hljs-number">0</span>]);<font></font>
    }<font></font>
  });<font></font>
  <span class="hljs-keyword">var</span> item = form.getItems()[<span class="hljs-built_in">Number</span>(items[i])].asListItem();<font></font>
  item.setChoiceValues(arr);<font></font>
  Logger.log(item.getTitle());<font></font>
  });<font></font>
 <font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> ss = SpreadsheetApp.getActiveSpreadsheet();
  <span class="hljs-keyword">var</span> range = ss.getSheetByName(<span class="hljs-string">"    "</span>).getRange(<span class="hljs-string">"A2:C"</span>).getValues();<font></font>
  Logger.log(range);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onOpen</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> ui = SpreadsheetApp.getUi();
  <span class="hljs-comment">// Or DocumentApp or FormApp.</span>
  ui.createMenu(<span class="hljs-string">'Custom Menu'</span>)<font></font>
      .addItem(<span class="hljs-string">'Change'</span>, <span class="hljs-string">'myFunction'</span>)<font></font>
      .addToUi();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> ss = SpreadsheetApp.getActiveSpreadsheet();
  <span class="hljs-keyword">var</span> range = ss.getSheetByName(<span class="hljs-string">" "</span>).getRange(<span class="hljs-string">"A2:A"</span>);<font></font>
  range.activate();<font></font>
  myFunction();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createTimeDrivenTriggers</span>(<span class="hljs-params"></span>) </span>{<font></font>
  ScriptApp.newTrigger(<span class="hljs-string">'update'</span>).timeBased().everyDays(<span class="hljs-number">1</span>).create();<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
フォームは異なり、ピッツェリアのリストとフォーム内のピッツェリアのリストの場所が異なります。</font><font style="vertical-align: inherit;">外国が必要なところ、ロシアからのところ。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/h8/g2/wqh8g2jyt3gmwqopaicz4h2u_h8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
列BとCは、更新するフォームとフォームにリストを表示する場所をスクリプトに指示します。</font><font style="vertical-align: inherit;">そして、列DとEから、更新するためにリストを取得する必要があるシートと範囲。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、スクリプトを1日に1回実行するトリガーを設定しました。これにより、まず部門全体、次に会社全体でフォームを更新するという地獄のプロセスを打ち負かすことができました。</font><font style="vertical-align: inherit;">このスクリプトはまだ機能しています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も難しいカタツムリケース</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配達小切手から音声録音を受け取りたいと思ったとき。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
音声録音の出所：ミステリーショッパーは、宅配便業者のクライアントとのミーティングをVKの音声メッセージとして録音しました。</font><font style="vertical-align: inherit;">通常、これは10〜15秒の音声録音です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入手方法：彼らは、BKミステリーショッパーのIDで最後の20件のメッセージを取得し、その中で「Ulica」という単語を検索して、1つのメッセージを後退させ、音声録音へのリンクを取得しました。</font><font style="vertical-align: inherit;">（ネタバレ：最高の言葉ではない、彼らはしばしば「カタツムリ」という言葉を私たちに書いた）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すでにより多くのコード行があります。準備してください。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLastAudio</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> ss = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  <span class="hljs-keyword">var</span> token = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> range = ss.getActiveRange().getValues();
  <span class="hljs-keyword">var</span> tt = ss.getActiveRange().getRowIndex();<font></font>
  range.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">r,i</span>) </span>{
    <span class="hljs-keyword">var</span> ri = tt + i;
   <span class="hljs-keyword">var</span> cuid = r[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">var</span> ci = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">var</span> payload1 = <font></font>
   {<font></font>
     <span class="hljs-string">"q"</span> : <span class="hljs-string">''</span>,
     <span class="hljs-string">'peer_id'</span> : r[<span class="hljs-number">0</span>],
     <span class="hljs-string">"access_token"</span> : token,
     <span class="hljs-string">"v"</span> : <span class="hljs-string">"5.73"</span>,<font></font>
   };<font></font>
<font></font>
   <span class="hljs-keyword">var</span> options1 = <font></font>
   { <span class="hljs-comment">//   http-</span>
     <span class="hljs-string">"method"</span> : <span class="hljs-string">"post"</span>,
     <span class="hljs-string">"header"</span> : <span class="hljs-string">"Content-type: application/x-www-form-urlencoded"</span>,
     <span class="hljs-string">"payload"</span> : payload1,
     <span class="hljs-string">"muteHttpExceptions"</span> : <span class="hljs-literal">true</span><font></font>
   };<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> jsonData = <span class="hljs-built_in">JSON</span>.parse(UrlFetchApp.fetch(<span class="hljs-string">"https://api.vk.com/method/messages.search"</span>, options1).getContentText());<font></font>
    Logger.log(jsonData);<font></font>
    <span class="hljs-keyword">if</span> (jsonData[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>] == <span class="hljs-literal">undefined</span>) {<font></font>
      ss.getRange(<span class="hljs-string">"B"</span> + ri).setValue(<span class="hljs-string">' '</span>).setBackground(<span class="hljs-string">'#f00'</span>);
      <span class="hljs-keyword">return</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">var</span> cmid = jsonData[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'id'</span>];
    <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>((jsonData[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'date'</span>]*<span class="hljs-number">1000</span>));
    <span class="hljs-keyword">var</span> fdate = Utilities.formatDate(date, <span class="hljs-string">"GMT+3"</span>, <span class="hljs-string">"dd-MM-yyyy HH:mm:ss"</span>);<font></font>
    ss.getRange(<span class="hljs-string">"B"</span> + ri).setValue(fdate);
          <span class="hljs-keyword">var</span> payload2 = <font></font>
   {<font></font>
     <span class="hljs-string">"user_id"</span> : cuid,
     <span class="hljs-string">"count"</span> : <span class="hljs-string">'20'</span>,
     <span class="hljs-string">"access_token"</span> : token,
     <span class="hljs-string">"v"</span> : <span class="hljs-string">"5.73"</span>,<font></font>
   };<font></font>
<font></font>
   <span class="hljs-keyword">var</span> options2 = <font></font>
   { <span class="hljs-comment">//   http-</span>
     <span class="hljs-string">"method"</span> : <span class="hljs-string">"post"</span>,
     <span class="hljs-string">"header"</span> : <span class="hljs-string">"Content-type: application/x-www-form-urlencoded"</span>,
     <span class="hljs-string">"payload"</span> : payload2,
     <span class="hljs-string">"muteHttpExceptions"</span> : <span class="hljs-literal">true</span><font></font>
   };<font></font>
  <font></font>
  <span class="hljs-keyword">var</span> jsonData2 = <span class="hljs-built_in">JSON</span>.parse(UrlFetchApp.fetch(<span class="hljs-string">"https://api.vk.com/method/messages.getHistory"</span>, options2).getContentText());<font></font>
    Logger.log(jsonData2);<font></font>
      jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">r,i</span>) </span>{
        <span class="hljs-keyword">if</span> (r[<span class="hljs-string">'id'</span>] == cmid) {<font></font>
          ci = i + <span class="hljs-number">1</span>;<font></font>
          Logger.log(jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci]);
          <span class="hljs-keyword">if</span> (jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci] == <span class="hljs-literal">undefined</span>) {<font></font>
            ss.getRange(<span class="hljs-string">"C"</span> + ri).setValue(<span class="hljs-string">" "</span>);<font></font>
          }<font></font>
          <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci] != <span class="hljs-literal">undefined</span> &amp;&amp; jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci][<span class="hljs-string">'attachments'</span>] != <span class="hljs-literal">undefined</span> &amp;&amp; jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci][<span class="hljs-string">'attachments'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'doc'</span>] != <span class="hljs-literal">undefined</span> &amp;&amp; jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci][<span class="hljs-string">'attachments'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'doc'</span>][<span class="hljs-string">'url'</span>] != <span class="hljs-literal">undefined</span>) {<font></font>
              ss.getRange(<span class="hljs-string">"C"</span> + ri).setValue(jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci][<span class="hljs-string">'attachments'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'doc'</span>][<span class="hljs-string">'url'</span>]);<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> {<font></font>
              ss.getRange(<span class="hljs-string">"C"</span> + ri).setValue(jsonData2[<span class="hljs-string">'response'</span>][<span class="hljs-string">'items'</span>][ci][<span class="hljs-string">'body'</span>]);<font></font>
            }<font></font>
          }<font></font>
        }<font></font>
      });<font></font>
  });<font></font>
}<font></font>
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グーグルのスプレッドシートはゴムがないわけではなく、私はまあまあのエンコーダです</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
つまり、2018年の初めまでにミステリーショッパーが6万人に成長するまで、すべてが回転し続けていました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、すでにテーブルの制限に直面しています。</font><font style="vertical-align: inherit;">その場合、1つのテーブルに200万個以下のセルを含めることができ、最も忙しい部門ラベルの1つで160万個のセルを使用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのようなバックエンド。</font><font style="vertical-align: inherit;">すべてがひどく遅くなり、何人かの人々が一緒に働いたとき、プレートは「ドキュメントはあまりにも人気があり、後で戻ってきます」と言いました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、私が悪いエンコーダであることが明らかになりました。システムが負荷を保持しておらず、交換する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして、本当の開発者がやってきました...</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、これはまったく別の話であり、後でそれについて書きます。これらの例が、多くの地獄のようなプロセスが存在するプロジェクトのマネージャーに役立つことを願っています。プロセスは自動化することができ、自動化する必要があります。テーブルとzapier（これも使用しました）の両方が役立ち、リソースがある場合はソリューションを格納します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
社内にスクリプトについて何か知っている人がいれば、タブレットで地獄のプロセスを整理するのに適しています。もしあなたがこのようなことを学びたいのなら、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はこれのための優れたチャネルを持っています。そこから私は関数とスクリプトについての情報を取得しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、すべてのマネージャーのマストヘッド-毎日テーブルを知っていることで、データを扱うときの時間を節約でき、少なくとも開発者がデータを使って何をするか、一般的にデータを使って何ができるかを考え、理解することができます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja472840/index.html">ソフトウェアデファインドストレージ、または何が恐竜を殺したのか？</a></li>
<li><a href="../ja472848/index.html">ITキャリアについての考察</a></li>
<li><a href="../ja472850/index.html">職業または生活：恐れることがなければ、Netologyコースを勝ち取ってください</a></li>
<li><a href="../ja472852/index.html">GitLabはクラウドおよび商用製品のユーザーのために変更を加えます</a></li>
<li><a href="../ja472854/index.html">Unity UIプロファイリング：誰が私のバッチ処理を台無しにするか？</a></li>
<li><a href="../ja472858/index.html">Pythonおよび高速HTTPクライアント</a></li>
<li><a href="../ja472860/index.html">カスケードキャッシュの無効化。パート1</a></li>
<li><a href="../ja472862/index.html">カスケードキャッシュの無効化。パート2</a></li>
<li><a href="../ja472864/index.html">チェックポイント：CPUとRAMの最適化</a></li>
<li><a href="../ja472866/index.html">安定したコミュニケーションのためのタリスマン</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>