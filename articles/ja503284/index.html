<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏯️ 🚤 🎶 REST APIセキュリティAからPI 👐🏼 👨🏿‍🤝‍👨🏽 👶🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前書き 
 有能なREST APIを実装する機能は、現時点では有用なスキルです。 APIを介して機能を提供するサービスが増えています。ただし、REST APIの開発は、特定のスタイルでのHTTP要求の実装と、仕様に応じた応答の形成に限定されません。 REST APIを保護するタスクは、たとえばデータ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>REST APIセキュリティAからPI</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503284/"><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有能なREST APIを実装する機能は、現時点では有用なスキルです。 APIを介して機能を提供するサービスが増えています。ただし、REST APIの開発は、特定のスタイルでのHTTP要求の実装と、仕様に応じた応答の形成に限定されません。 REST APIを保護するタスクは、たとえばデータベースを保護するほど明確ではありませんが、その必要性はそれほど重要ではありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、多くのオンラインシステムはAPIを使用して、医療や財務などのプライベートユーザーデータを転送しています。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Comnewsによると</font></a><font style="vertical-align: inherit;">、Webアプリケーションの現在のセキュリティ状況は非常に悲しいです。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">約70％には重大な脆弱性が含まれています。</font><font style="vertical-align: inherit;">したがって、オンラインシステムの設計、実装、およびテストに関わるすべての人が、既存の脅威の概要と、システム全体と使用するREST APIの両方のセキュリティを確保する方法を理解することが重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、読者が全体像を把握できるように、REST APIの既存の脆弱性に関する情報を要約しようとしました。</font><font style="vertical-align: inherit;">この図は、最新のクライアント/サーバーアーキテクチャと、潜在的なセキュリティリスクを伴う一般化されたREST APIリクエストを示しています。</font><font style="vertical-align: inherit;">次に、これらの脅威と、それらに対する保護を技術的に実装する方法について詳しく説明します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_r/a2/w5/_ra2w5quruh_u2uyn_8x2nmrc7o.png" alt="画像"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全基準</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
標準から始めましょう。</font><font style="vertical-align: inherit;">APIセキュリティ要件のリストの作成に役立つ標準がいくつかあります</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。OWASP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Open Web Application Security Project）は、さまざまなソフトウェアテクノロジーにおけるリスクリストで知られています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「API開発における最も危険な10の脆弱性」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のリストに興味が</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">あります</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API1：2019壊れたオブジェクトレベルの承認。</font><font style="vertical-align: inherit;">このリスクの別名：安全でない直接オブジェクト参照。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API2：2019壊れたユーザー認証</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API3：2019年の過剰なデータ露出</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API4：2019リソース不足とレート制限</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API5：2019壊れた機能レベルの承認</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API6：2019一括割り当て</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API7：2019セキュリティの誤設定</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API8：2019インジェクション</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API9：2019不適切な資産管理</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API10：2019不十分なロギングとモニタリング</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Top10</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">含まれていない</font></a><font style="vertical-align: inherit;">が、トピックに関連</font><font style="vertical-align: inherit;">
するアイテムを追加します</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">交通安全でない</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（安全でないトランスポート層）</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないパスワード</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">安全でない</font></a><font style="vertical-align: inherit;">パスワード）</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既知の脆弱性を持つコンポーネントの使用</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">既知の脆弱性を持つコンポーネントの</font></a><font style="vertical-align: inherit;">使用）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、他の組織のリストの脆弱性Common Weakness Enumeration（CWE）：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWE Top 25 Most Dangerous Software Errors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWE-79クロスサイトスクリプティング（XSS）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWE-352クロスサイトリクエストフォージェリ（CSRF）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、他のリストからいくつかのアイテムが見つかりました：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないCookieとローカルストレージ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないHTTPヘッダー（安全でないHTTPヘッダー）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不適切なクロスオリジンリソース共有</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリックジャッキング</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結果は、私の意見では、現在のAPIセキュリティ問題を完全に反映したリストです。</font><font style="vertical-align: inherit;">リストが一般的で、すべてのテクノロジーに適用できることが判明したことを確認するために、インターネットで公開されているAPIセキュリティの推奨事項を使用しました（リンクは記事の最後にあります）。</font><font style="vertical-align: inherit;">次に、リストされているすべての項目を検討します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API2：2019-壊れたユーザー認証</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー認証のトピックはOWASPリストの2番目の場所にありますが、私は最初にそれを入れました。</font><font style="vertical-align: inherit;">それはすべてそれから始まります。</font><font style="vertical-align: inherit;">私は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、OAuth 2.0、OpenID Connect、WebAuthn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関する記事で、最新の認証と承認の標準をすでに検討し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ここでは、主なセキュリティスキームについて簡単に説明し、現時点で最も信頼性の高いトークンベースのスキームについて詳しく説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIキー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 APIキーは、クライアントがサーバーへのリクエストで渡す文字列です。</font><font style="vertical-align: inherit;">認証に成功するには、文字列がクライアントとサーバーで一致する必要があります。</font><font style="vertical-align: inherit;">このスキームは、APIの不正使用に対する保護を提供し、たとえば、API使用制限の検証を可能にします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本認証</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
基本認証は、ログイン/パスワードなどの2行認証を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
情報を転送するには、HTTPヘッダー「Authorization」をキーワードBasicの後にスペースとbase64でエンコードされた文字列のユーザー名：パスワードを付けて使用します。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<pre><code class="xml hljs">Authorization: "Basic dXNlcm5hbWU6cGFzc3dvcmQ="</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cookieベースの認証</font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cookieベースの認証では、HTTP要求でCookie転送メカニズムを使用します。</font><font style="vertical-align: inherit;">クライアントの要求に応じて、サーバーはSet-Cookieヘッダーを送信します。このヘッダーには、Cookieの名前と値、および有効期限、ドメイン、パス、セキュア、httponlyなどの追加の属性が含まれています。</font><font style="vertical-align: inherit;">Cookieの送信例：</font></font><br>
<br>
<pre><code class="xml hljs">Authorization: Set-Cookie: JSESSIONID=123456789; Path=/; HttpOnly</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、クライアントはリクエストごとにCookieヘッダーを自動的に送信します。</font></font><br>
<br>
<pre><code class="xml hljs">Cookie: JSESSIONID=123456789</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメカニズムを実装するには、サーバー上のユーザーセッションの保存と検証を整理する必要があります。</font><font style="vertical-align: inherit;">Cookieの使用については、「安全でないCookieとローカルストレージ」セクションで詳しく説明します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンベースの認証 </font></font></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベアラー認証とも呼ばれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンベースの認証では、サーバーが署名したトークン（ベアラートークン）を使用します。クライアントは、ベアラーキーワードを含むAuthorization HTTPヘッダーまたはリクエスト本文でサーバーに送信します。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<pre><code class="xml hljs">Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IjI4Y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
トークンを受信すると、サーバーはトークンの有効性をチェックする必要があります。つまり、ユーザーが存在するか、使用時間が経過していないかなどです。</font><font style="vertical-align: inherit;">トークンベースの認証はOAuth 2.0またはOpenID Connectプロトコルの一部として使用でき、サーバー自体がトークンを生成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
どの認証方法でも、データを暗号化する安全な使用のために、HTTPSなどのHTTPヘッダーとURLのプロトコルを使用する必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンベースの認証アルゴリズム</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に説明したスキームについて詳しく見てみましょう。</font><font style="vertical-align: inherit;">この図は、「Googleアカウントでログイン」機能の実装例での簡略化されたトークンベースの認証アルゴリズムを示しています</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uq/im/wy/uqimwysxx0fhnwgzpu3jvkjjsdy.png" alt="画像"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーがサイトにログオンし、[Googleアカウントでログイン]ボタンをクリックします</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーはGoogleにリクエストを送信します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Googleはユーザーにログインフォームを表示します。</font></font></li>
<li>  /.</li>
<li>Google  /       access token  refresh token.</li>
<li>    token       Google API.</li>
<li>      ,               «    ».   : Local Storage, Session Storage  Cookies,        .&nbsp;OWASP   Cookies     : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">JSON Web Token Cheat Sheet</a>.&nbsp;    «session token»,       —    ,    . </li>
<li>          access token  ,         Google       .</li>
<li>    access    refresh    .</li>
</ol><br>
<b>  Token-Based Authentication   :</b><br>
<br>
<ol>
<li>        ,       Insecure Passwords.</li>
<li>                 Google   .</li>
<li>   ,    :</li>
</ol><br>
<ul>
<li>  /              ,      ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークンは、Cookieのように自動的にサードパーティのサイトに移動することはありません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cookieベースの認証は、クロスサイトリクエストフォージェリ（CSRF）攻撃の影響を受けやすいため、追加の保護メカニズムを使用する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーセッションをサーバーに保存することはできませんが、Googleで毎回トークンを確認してください。</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つのマイナスが見られ</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ます。トークンの傍受の場合、攻撃者はしばらくの間、トークンの所有者になりすますことができます。</font><font style="vertical-align: inherit;">したがって、トークンを転送するには、HTTPSを使用する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API1：2019壊れたオブジェクトレベルの承認</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このリスクの別名は次のとおりです。安全でない直接オブジェクト参照。</font><font style="vertical-align: inherit;">これは、現在最も一般的なAPIの問題です。</font><font style="vertical-align: inherit;">説明のために、私はAPIを提供します。このAPIは、今後さらにいくつかの脆弱性の例に使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
userIDを持つ1人のユーザーを取得します。</font></font><br>
<br>
<pre><code class="xml hljs">GET /users/{userID}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのユーザーを取得（管理者のみが取得可能）： </font></font><br>
<br>
<pre><code class="xml hljs">GET /users</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーcのユーザーIDを削除：DELETE / users / {userID} </font></font><br>
<br>
<pre><code class="xml hljs">DELETE /users/1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ユーザーの削除コマンドが呼び出された場合：</font></font><br>
<br>
<pre><code class="xml hljs">DELETE /users/1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、このコマンドをユーザー1または管理者のみが呼び出すことができ、たとえばユーザー2は呼び出せないことを確認するために必要です。コマンドコールでID値を変更するだけです。</font><font style="vertical-align: inherit;">このような問題を回避するには、以下が必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リクエストごとにオブジェクトへのアクセス権を確認してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログインしたユーザーが許可されたオブジェクトにのみアクセスできることを確認してください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オブジェクトIDは、単純なシーケンス1、2、3ではなく、たとえばUUIDの形式で選択するのが難しいはずです。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OWASPでは</font><font style="vertical-align: inherit;">、以下のアクセス制御モデル</font><font style="vertical-align: inherit;">（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセス制御チートシート</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">推奨してい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">役割ベースのアクセス制御（RBAC）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">随意アクセス制御（DAC）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必須アクセス制御（MAC）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">権限ベースのアクセス制御</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API5：2019壊れた機能レベルの承認</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIユーザーの役割間のアクセス制御の明確なシステムを開発する必要があります。</font><font style="vertical-align: inherit;">たとえば、役割：通常のユーザーと役割：管理者があります。</font><font style="vertical-align: inherit;">管理者だけがコマンドを呼び出してすべてのユーザーを表示できます。</font></font><br>
<br>
<pre><code class="xml hljs">GET /users/all</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドが呼び出されるたびに、一般ユーザーがフォーマットを変更するだけではコマンドを呼び出せないように、許可検査が必要です。 </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API3：2019年の過剰なデータ露出</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、アイテムは呼び出されます-冗長データを提供しますが、同時に機密データまたは個人データが開示される可能性があります。</font><font style="vertical-align: inherit;">どう？</font><font style="vertical-align: inherit;">クライアントの要求に応じて、サーバーは原則としてデータベースへのクエリを形成し、データベースへのクエリはレコードまたはレコードのリストを返します。</font><font style="vertical-align: inherit;">多くの場合、このデータはチェックなしでJSONでシリアル化され、クライアントが必要なデータをフィルター処理することを前提としてクライアントに送信されます。</font><font style="vertical-align: inherit;">しかし問題は、クライアントがリクエストを送信できるだけでなく、攻撃者が直接サーバーに送信して機密データを受信できることです。</font><font style="vertical-align: inherit;">たとえば、ID 1のユーザーデータに対する無害なリクエスト：</font></font><br>
<br>
<pre><code class="xml hljs">GET /users/1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
名前/年齢だけでなく、登録時にユーザーが尋ねた秘密の質問への回答も返すことができます。</font></font><br>
<br>
<pre><code class="json hljs">{<span class="hljs-attr">"userName"</span>:<span class="hljs-string">"Alex"</span>,<span class="hljs-attr">"age"</span>:<span class="hljs-number">25</span>,<span class="hljs-attr">"secretAnswer"</span>:<span class="hljs-string">"HelloWorld"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは過剰なデータ転送と呼ばれます。</font><font style="vertical-align: inherit;">この問題は、ボリューム内のデータが多すぎる可能性があるという事実によって悪化します。</font><font style="vertical-align: inherit;">負荷が高い場合、これはネットワークの問題につながります。</font><font style="vertical-align: inherit;">したがって、APIを開発する場合、クライアントでのデータのフィルタリングに依存することはできません。すべてのデータはサーバーでフィルタリングする必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API6：2019一括割り当て</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、状況は前の段落の逆の「過剰なデータの露出」です。過剰なデータは、値の不正な置換を目的としてサーバーに転送されます。</font><font style="vertical-align: inherit;">どういう意味ですか？</font><font style="vertical-align: inherit;">次のデータを持つID 1のハッカーユーザーがいるとします。</font></font><br>
<br>
<pre><code class="json hljs">{<span class="hljs-attr">"userName"</span>:<span class="hljs-string">"Alex"</span>,<span class="hljs-attr">"age"</span>:<span class="hljs-number">25</span>,<span class="hljs-attr">"balance"</span>:<span class="hljs-string">"150"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーは、自分の年齢など、レコードの一部のフィールドを自分で正当に変更できます。</font><font style="vertical-align: inherit;">そして、バランスのようなフィールドは、外部システムをセットアップする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、私たちのサーバーは大量割り当て攻撃の影響を受けやすく、ソースチェックなしですべての受信データを記録します。</font><font style="vertical-align: inherit;">ハッカーユーザーは、サーバーに年齢を変更するリクエストを送信できます。サーバーには、残高属性を追加します。</font></font><br>
<br>
<pre><code class="xml hljs">POST /users/1</code></pre><br>
<pre><code class="json hljs">{<span class="hljs-attr">"userName"</span>:<span class="hljs-string">"Alex"</span>,<span class="hljs-attr">"age"</span>:<span class="hljs-number">26</span>,<span class="hljs-attr">"balance"</span>:<span class="hljs-string">"1000000"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、実際のお金を稼ぐことなく、残高が増加します。</font><font style="vertical-align: inherit;">この攻撃を防ぐには、次のことを行う必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">着信データの自動逆シリアル化を許可しません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが変更できる属性のリストを制限します。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API4：2019リソース不足とレート制限</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
総当たり攻撃からサーバーを保護する必要があります。</font><font style="vertical-align: inherit;">これを行うには、次の制限を実装します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーごとの認証試行の失敗回数を制限します。</font><font style="vertical-align: inherit;">オプションとして、reCaptureまたは同様のメカニズムを使用します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPからの失敗した試行の数がすべてのユーザーの特定の値を超える場合、IPをブロックします。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
JSには、このようなチェックを自動的に実行できるツール（たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レートリミッター</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）があり、サーバーをロードせずに「429 Too Many Requests」という回答をすぐに送信できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サービス拒否（DoS攻撃）からサーバーを保護する必要がある</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定の時間における1人のユーザーまたは1つのリソースからのリクエスト数を制限します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービス拒否攻撃は、意図的に大きい値の送信に基づいている場合もあります。</font></font></li>
</ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> たとえば、サーバーはサイズパラメータのエントリ数を予期します。</font></font><br>
<br>
<pre><code class="xml hljs">/api/users?page=1&amp;size=100</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーが最大値のサイズをチェックしない場合、攻撃者がパラメーター（たとえば、1,000,000）を渡すと、サーバーのメモリを使い果たし、サービス拒否を引き起こす可能性があります。</font><font style="vertical-align: inherit;">したがって、クライアントにそのようなチェックがある場合でも、すべてのパラメーター値が有効かどうかをサーバーでチェックする必要があります。</font><font style="vertical-align: inherit;">結局のところ、誰もAPIを直接呼び出す必要はありません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API7：2019セキュリティの誤設定</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のアクションはセキュリティの問題につながる可能性があるため、回避する必要があります。</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でない可能性があるアプリケーションのデフォルト設定が使用されます。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンデータウェアハウスが使用されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オープンソースは、システム構成やアクセス設定などの機密情報にアクセスできます。</font></font></li>
<li>   ,     ReDoS (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Regular expression Denial of Service</a>)</li>
<li>  HTTP  (      «Insecure HTTP Headers»).</li>
<li>  (/, , apiKey)   URL.  , ..   URL      .</li>
<li>     Cross-Origin Resource Sharing (CORS) (      ).</li>
<li>  HTTPS ( HTTPS    «Insecure Transport»).</li>
<li>     ,     . </li>
<li>     , ,  .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラウドサービスの構成にも注意を払う必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーが必要なアクセス権のみを確立するため。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なネットワークポートのみを開きます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全なバージョンのOSパッチとアプリケーションをインストールします（詳細については、既知の脆弱性のあるコンポーネントの使用セクションをご覧ください）。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API8：2019インジェクション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実装とは、システムによって提供されないプログラムコードの実行です。</font><font style="vertical-align: inherit;">実装をデプロイします。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLコマンド</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSコマンド</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーがチェックなしで受信したコマンドを実行する場合、攻撃は成功します。</font><font style="vertical-align: inherit;">これは「安全でないデシリアライゼーション」を連想させ、追加の属性だけでなく、SQLコードやOSコマンドも使用されます。</font><font style="vertical-align: inherit;">SQLインジェクションの結果として、データへの不正アクセスが可能になります。</font><font style="vertical-align: inherit;">OSコマンドを挿入することで、サーバーにアクセスしたり、サーバーを無効にしたりできます。</font><font style="vertical-align: inherit;">たとえば、入力行でユーザーがディレクトリ「name」の名前を入力すると、コマンドがサーバーに送信されます。</font></font><br>
<br>
<pre><code class="xml hljs">GET /run</code></pre><br>
<pre><code class="json hljs">{<span class="hljs-attr">"mkdir"</span>:<span class="hljs-string">"name"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーがチェックなしでコマンドを実行する場合、攻撃者は次のコマンドをサーバー障害の可能性が高い状態で送信できます。</font></font><br>
<br>
<pre><code class="xml hljs">GET /run</code></pre><br>
<pre><code class="json hljs">{<span class="hljs-attr">"mkdir"</span>:<span class="hljs-string">"name &amp;&amp; format C:/"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような攻撃を防ぐには：</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入力したデータを直接コマンドに送信することはできません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これがない場合は、可能なすべてのチェック、クリーニング、フィルタリング、およびデータの検証を行う必要があります。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API9：2019不適切な資産管理</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIは、バージョンと機能が異なる複数のエントリポイント（エンドポイント）を持つことができます。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<pre><code class="xml hljs">http://localhost:5000/myAPI/v1</code></pre><br>
<pre><code class="xml hljs">http://localhost:5000/myAPI/v2</code></pre><br>
<pre><code class="xml hljs">http://localhost:5000/myTestAPI/v1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アカウンティングおよびバージョン管理APIを提供する必要があります。 </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">利用可能なAPI、そのバージョン、目的（本番、テスト、開発）、およびそれらにアクセスできるユーザー（パブリック、内部、パートナー）のリストを保持する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIライフサイクルを管理し、タイムリーに新しいバージョンを起動し、古いバージョンをサポートから削除する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在のバージョンのAPIのみをオープンアクセスで開いてください。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デバッグ用のエンドポイントを開いたままにしないでください。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのような制御が提供されていない場合、予期しない目的でAPIを使用することが可能です。</font><font style="vertical-align: inherit;">たとえば、攻撃者は、セキュリティの脆弱性があったバージョンのAPIで動作中のエンドポイントを発見しましたが、新しい安全なバージョンに移行することはできましたが、運用は継続されていました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API10：2019不十分なロギングとモニタリング</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃または疑わしいユーザーの動作を特定するには、システムを監視し、十分な詳細レベルでイベントをログに記録する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">失敗したすべての認証試行、アクセス拒否、入力検証エラーをログに記録します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログの整合性を確保して、改ざんの可能性を防ぎます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アプリケーションとAPI呼び出しだけでなく、インフラストラクチャ、ネットワークアクティビティ、OSロードも監視する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">監視だけでなく、システムの通常動作の違反を迅速に通知することも保証する必要があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的な監視のヒントについては、「</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">正しく行われた監視</font></a><font style="vertical-align: inherit;">」を参照してください</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でない輸送</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クライアントとサーバー間のトラフィックが暗号化されていない場合、すべてのHTTPデータとヘッダーはクリアテキストで送信されます。</font><font style="vertical-align: inherit;">データ漏洩を防ぐには、HTTPS（Hyper Text Transfer Protocol Secure）プロトコルを使用するか、暗号化を自分で実装する必要があります。</font><font style="vertical-align: inherit;">HTTPSを使用するには、SSL証明書が必要です。</font><font style="vertical-align: inherit;">インターネット上のサイトは、CA（認証局）のトラストセンターでこのような証明書を受け取る必要があります。</font><font style="vertical-align: inherit;">しかし、クライアントとサーバーの間でデータを暗号化するために、もっと簡単なことができます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自分でいわゆる自己署名証明書を生成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーで、HTTPSプロトコルの使用を構成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">httpsで始まるクライアントフォームリクエストから。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ブラウザーはサーバー証明書が署名されていることは誰にも知られていませんが、私たちは自分自身を信頼することができますと誓います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTPSサポートは、Apache、Nginx、またはその他のWebサーバーを使用して提供することもできます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないパスワード</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このトピックでは、すべてが簡単です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーパスワードは非常に複雑で長いものにする必要があります。</font><font style="vertical-align: inherit;">現在、統一されたパスワード要件はなく、すべてがビジネスによって決定されます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーはユーザーパスワードをクリアテキストで保存できません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーには、信頼できるアルゴリズム（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Argon2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">など）によって計算されたパスワードハッシュのみを格納します</font><font style="vertical-align: inherit;">。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないCookieとローカルストレージ（安全でないCookieとローカルストレージのデータ）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cookieは安全に使用する必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルト名は使用できません。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cookieを作成するときは、次のオプションを設定する必要があります。</font></font></li>
</ul><br>
<pre><code class="xml hljs"><font></font>
secure -    cookies   HTTPS .<font></font>
httpOnly -    cookies   HTTP  HTTPS       JavaScript,    Cross-site Scripting (XSS).<font></font>
domain -  domain cookie.<font></font>
path -  path cookie.<font></font>
expires -    cookies.<font></font>
SameSite -    cookies   ,   .<font></font>
</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヨーロッパのサイトで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ユーザーにCookieの使用許可を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">明示的に要求</font></a><font style="vertical-align: inherit;">する必要があります。</font><font style="vertical-align: inherit;">たとえば、サイトでのユーザーアクションのシーケンスをCookieに記録した場合、これはすでに個人情報と見なされます。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cookieとローカルストレージの一般的な安全規則： </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーからの重要な情報を保存することはできません。</font><font style="vertical-align: inherit;">ユーザーが利用できます。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーの個人情報を保存することはできません。</font><font style="vertical-align: inherit;">他のコンピュータユーザーが利用できるようになる場合があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">したがって、暗号化されたデータまたはサービス情報のみを保存できます。</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">既知の脆弱性を持つコンポーネントの使用（既知の脆弱性を持つコンポーネントの使用）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリやフレームワークなどのコンポーネントは、アプリケーションと同じ特権で実行されます。</font><font style="vertical-align: inherit;">したがって、使用するライブラリに安全でないコンポーネントがある場合、サーバーのハイジャックまたは損傷につながる可能性があります。</font><font style="vertical-align: inherit;">コンポーネントのセキュリティをチェックするには、特別なアプリケーションが使用されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">たとえば、JavaScriptに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWE-79クロスサイトスクリプティング（XSS）（クロスサイトスクリプティング）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クロスサイトスクリプティングは、最も危険なWeb攻撃と見なされています。</font><font style="vertical-align: inherit;">その本質は、悪意のあるスクリプトが私たちのページに埋め込まれる可能性があり、実行の結果が機密データの漏洩やサーバーの損傷につながる可能性があることです。</font><font style="vertical-align: inherit;">攻撃から身を守るには、リクエストにHTTPヘッダーを含める必要があります。これには、クロスサイトスクリプティング（XSS）フィルターが含まれています。</font></font><br>
<br>
<pre><code class="xml hljs">X-XSS-Protection : 1; mode=block</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または </font></font><br>
<br>
<pre><code class="xml hljs">Content-Security-Policy: script-src 'self'</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CWE-352クロスサイトリクエストフォージェリ（CSRF）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃の本質を理解するために、例を挙げます。オンラインアカウントを持つ金融機関があるとします。</font><font style="vertical-align: inherit;">Cookieはユーザーが記憶しているため、ログイン時にユーザー名とパスワードを毎回入力する必要はありません。</font><font style="vertical-align: inherit;">ユーザーが誤って、金融機関に送金するトランザクションを送信する攻撃者のサイトにログインします。このサイトでは、ブラウザが保存されたCookieから自動的にデータを配置します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
金融サイトは、Cookieの有効性を正常にチェックし、不正なトランザクションを実行します。</font><font style="vertical-align: inherit;">CSRF攻撃から保護するには、次のことを行う必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーで、CSRFトークンメカニズムを実装します。</font><font style="vertical-align: inherit;">これは、ユーザーセッションごとに新しいトークンが生成され、サーバーがクライアントからの要求についてそのトークンの有効性をチェックする場合のメカニズムです。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーで、要求元のアドレスを含むOriginヘッダーとRefererヘッダーを確認します。</font><font style="vertical-align: inherit;">ただし、これらのヘッダーが欠落している可能性があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">また、ユーザーにパスワードまたは2番目の認証要素を入力して重要なアクションを確認することを常に要求することもできますが、そのような対策の可能性はビジネスによって異なります。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cookieを作成するときは、SameSiteパラメータを設定しますが、すべてのブラウザがこのメカニズムをサポートしているわけではありません。 </font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クロスオリジンリソースシェアリング（CORS）</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CORSは、サーバーがAPIのアクセスルールを設定できるようにするセキュリティメカニズムです。</font><font style="vertical-align: inherit;">たとえば、サーバーにヘッダーを設定した場合：</font></font><br>
<br>
<pre><code class="xml hljs">Access-Control-Allow-Origin: *</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、APIを制限なしで使用できるようになります。</font><font style="vertical-align: inherit;">これがパブリックAPIでない場合、セキュリティのために、APIへのアクセスが許可されるOriginsを明示的にインストールする必要があります。次に例を示します。</font></font><br>
<br>
<pre><code class="xml hljs">Access-Control-Allow-Origin: https://example.com:8080</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIへのアクセスに使用できるHTTPメソッドを制限することもできます。 </font></font><br>
<br>
<pre><code class="xml hljs">Access-Control-Allow-Methods: GET, POST, DELETE, PUT</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、サーバーが受け入れることができるヘッダーのリストを設定します：</font></font><br>
<br>
<pre><code class="xml hljs">Access-Control-Allow-Headers: Origin, Content-Type, Authorization</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全でないHTTPヘッダー</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTPプロトコルには、HTTPリクエスト/レスポンスで使用できる多数のヘッダーが含まれています。</font><font style="vertical-align: inherit;">セキュリティの観点から最も重要なヘッダーを特定するために、いくつかのリストを使用しました。</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OWASPセキュアヘッダープロジェクト</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明示的な推奨事項：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制作のベストプラクティス</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、メインヘッダーを検討します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-Powered-By</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このヘッダーは一部のサーバーによって自動的に挿入されます。これにより、攻撃者がどのサーバーを処理しているかが攻撃者に明らかになります。次に例を示します。</font></font><br>
<br>
<pre><code class="xml hljs">X-Powered-By: Express</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、このタイトルがなくても誰も止められませんが、すぐにそのようなヒントを与えるべきではありません。</font><font style="vertical-align: inherit;">したがって、このヘッダーの送信は禁止する必要があります。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP Strict Transport Security（HSTS）</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Strict-Transport-Securityヘッダーは、ブラウザーがHTTPプロトコルを介してリソースにアクセスするのを防ぎます。HTTPSのみです。</font></font><br>
<br>
<pre><code class="xml hljs">Strict-Transport-Security: max-age=31536000</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
max-age = 31536000は秒単位の年です。</font><font style="vertical-align: inherit;">この見出しを次のように設定することをお勧めします </font><font style="vertical-align: inherit;">これは、ブラウザにHTTPプロトコルへの切り替えを強制し、情報（Cookieなど）の平文での送信を開始することに関連する攻撃を防ぎます。攻撃者はこれを傍受できます。</font><font style="vertical-align: inherit;">HTTPを介したサーバーへのリクエストと攻撃は、サーバーへの最初のアクセス時にのみ可能です。その後のアクセスでは、ブラウザーはStrict-Transport-Security設定を記憶し、HTTPSを介してのみアクセスします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-Frame-Options（クリックジャッキング保護）</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クリックジャッキング攻撃に対する保護を可能にします。</font><font style="vertical-align: inherit;">これは、攻撃者がボタンまたは入力フィールドを透明なフレームに配置し、ユーザーが目的のボタンをクリックするか安全にデータを入力したとユーザーが考えるときのテクノロジの名前ですが、実際には、侵入型の広告があるサイトなど、攻撃者にとって有用な別のリソースへのリダイレクトがあります。</font><font style="vertical-align: inherit;">クリックジャッキングから保護するために、サーバーはフレーム内のページの使用をまったく禁止する必要があります。</font></font><br>
<br>
<pre><code class="xml hljs">X-Frame-Options: deny</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または私たちのドメインでのみ使用を許可：</font></font><br>
<br>
<pre><code class="xml hljs">X-Frame-Options: sameorigin</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、より最新のメカニズムを使用してクリックジャッキング攻撃を防止し、適切な</font><b><font style="vertical-align: inherit;">コンテンツセキュリティポリシー</font></b><font style="vertical-align: inherit;">を設定することをお勧めします</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツセキュリティポリシー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クロスサイトスクリプティング攻撃およびクリックジャッキングを含む他のクロスサイトインジェクションから身を守ることができます。</font><font style="vertical-align: inherit;">慎重な設定が必要です。</font><font style="vertical-align: inherit;">多くのパラメータがあります。</font><font style="vertical-align: inherit;">ただし、クロスサイトスクリプティング攻撃の可能性を防ぐために、少なくともデフォルトのポリシーを設定する必要があります。</font></font><br>
<br>
<pre><code class="xml hljs">Content-Security-Policy: default-src 'self'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳細には、Content-Security-Policyヘッダーの値は、たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照によって</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">逆アセンブル</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">されます</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X-Content-Type-Options</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このヘッダーを設定すると、ブラウザー自体が送信されたファイルのタイプを解釈できなくなり、Content-Typeヘッダーで送信されたファイルのみを使用するように強制されます。</font><font style="vertical-align: inherit;">これがないと、たとえば、外観が無害なtxtファイルが送信され、その中で悪意のあるスクリプトとブラウザがテキストファイルとしてではなくスクリプトとして実行するという状況が発生する可能性があります。</font><font style="vertical-align: inherit;">したがって、以下を確立します。</font></font><br>
<br>
<pre><code class="xml hljs">X-Content-Type-Options: nosniff</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャッシュ制御</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cache-Controlを使用すると、クライアント側でキャッシュを管理できます。プライベートデータが誤ってキャッシュに残らないように、キャッシュを無効にすることをお勧めします。</font></font><br>
<br>
<pre><code class="xml hljs">Cache-Control: no-store</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、APIの動作中に待機する脅威とその対処方法について説明しました。</font><font style="vertical-align: inherit;">結論として、いくつかの一般的な結論を示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">循環防御を維持し、すべての面で防御する必要があります。</font><font style="vertical-align: inherit;">どのように聞こえても、システムのセキュリティは最も弱いリンクによって決定されます。</font><font style="vertical-align: inherit;">ほんのわずかな部分を保護するのを忘れた場合、結果は非常に悲しいものになる可能性があります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API開発者は、プログラムを実行できるだけでなく、システムとアプリケーションのセキュリティを理解できる必要があります。</font><font style="vertical-align: inherit;">または、チームにはセキュリティ担当者が必要です。</font></font></li>
<li>       , ..       ,        . </li>
</ul><br>
<h2>   :</h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">API Security Top 10</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Top 25 Most Dangerous Software Errors</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> RedHat: API security</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> Express: Production Best Practices</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> Node.js: Security Checklist</a></li>
</ul><br>
<i><b>  ,   API! )</b></i><br>
<br>
<b><font color="#B22222">It's only the beginning!</font></b></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja503270/index.html">.pre-commitフックをDjangoプロジェクトに統合する</a></li>
<li><a href="../ja503272/index.html">かんばん方式におけるService Delivery Manager（SDM）の役割：SDMの採用方法</a></li>
<li><a href="../ja503276/index.html">動作ゲーミフィケーション：Octalysisフレームワーク</a></li>
<li><a href="../ja503280/index.html">都市とビジネスのデジタル環境のためのクイックソリューションは、Startup Village Livestream'20カンファレンスで議論されました</a></li>
<li><a href="../ja503282/index.html">車両監視デバイスでModbusプロトコルを使用する</a></li>
<li><a href="../ja503288/index.html">機械学習を使用して候補者を検索する方法</a></li>
<li><a href="../ja503290/index.html">DJI Matrice 300 RTK産業用クワドロコプターのレビュー</a></li>
<li><a href="../ja503296/index.html">Gett and GeekBrains Product Management Analytics：Brand Management Product Management Quarter</a></li>
<li><a href="../ja503300/index.html">本「リックとモーティ。すべての銀河の最も素晴らしい漫画へのガイド»</a></li>
<li><a href="../ja503302/index.html">CMake + GCCでのプロジェクトビルドの高速化：ヘッダーファイルのプリコンパイル</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>