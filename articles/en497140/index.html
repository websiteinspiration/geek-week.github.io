<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¶üèΩ üó∫Ô∏è üë©üèΩ‚Äçüîß Decryption of data in the CAN bus VW Polo sedan ‚¨õÔ∏è üçπ üë®üèª‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about methods for decrypting CAN bus data using the example of a 2019 VW Polo Sedan car. On the Internet, such articles are often c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Decryption of data in the CAN bus VW Polo sedan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497140/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Today we will talk about methods for decrypting CAN bus data using the example of a 2019 VW Polo Sedan car. </font><font style="vertical-align: inherit;">On the Internet, such articles are often called CAN Bus Hacks, but I don‚Äôt like this name. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The article describes the methods of finding the necessary data in the CAN bus of the car, examples of the application of these techniques on the VW Polo Sedan. </font><font style="vertical-align: inherit;">Vega MTX is used as equipment for connecting to a CAN bus. </font><font style="vertical-align: inherit;">Let's talk a little more about telematics. </font><font style="vertical-align: inherit;">Under the cut a lot of pictures on the topic, several gifs and videos.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A few words about yourself. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
My name is Alexey Fokin, at the moment I work for Vega Absolute</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vega_absolute</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The central office in Novosibirsk, but I work in Moscow. One of our directions is telematics. We make equipment for tracking commercial vehicles, car sharing, taxis, etc. My job is that I collect data from cars and turn them into settings for our equipment. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now to the car. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connection to the CAN bus was made in two places: behind the dashboard (500 Kbit / s bus) and behind the radio (100 Kbit / s). There is also one redundant connection - connecting to the OBDII connector directly on the connector (500 Kbit / s). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From the tools used: Vega MTX vehicle monitoring unit equipped with a CAN scanner. To configure it on a PC, the Configurator 1.27.14 program.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
More information about connecting to a car and MTX can be found in the video at the end of the article. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When connected to all CAN buses, we will see the following picture: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/z4/j3/ad/z4j3ad0zxuso-cm1kzaa1omjpp8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this data stream, you need to find those bits and bytes that are responsible for the parameters we need. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The screenshot below shows how many sensors are currently registered in the telematics block, and this is not a complete list. You can go even deeper and look for even more sensors. Some of these sensors in real time sends readings to the server, which allows you to see the status of your car at any time. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Telematics is a topic for a separate article, so we will not dwell on this here in detail.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kz/qr/_p/kzqr_pzavnxnqpai7jt42tsvrwa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The question immediately arises - why do I need to search for data in a stream if I can see it through ELM327 or other diagnostic devices? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The question here is why we need this data. In our case, we need the data for telematics, and in order not to interfere with the CAN bus and not send any data to it, we look for them in the stream. Vega MTX has a special mode for working with the CAN bus - the ‚Äúlistening‚Äù mode. The mode speaks for itself, the equipment only listens to the bus and does not send anything to it, thereby minimizing any impact on the regular car system.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, a sensor for opening a door. If we ask him a request, then we can only do this with the ignition on. After the ignition is turned off and the CAN bus falls asleep, this sensor will not be available to us. If we find this sensor in the CAN stream, then we will see it all the time when the CAN bus is working. And, when you open the door, CAN will wake up automatically. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It should also be understood that all of the examples below are only relevant for the Polo Sedan connect. In others, the equipment may not have any of the sensors listed, but for other makes and models of cars the data will be in completely different IDs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I draw your attention to the fact that by default in the Configurator there is a display of values ‚Äã‚Äãin the HEX format. </font><font style="vertical-align: inherit;">In the future, we will have to translate data from the HEX format to decimal values ‚Äã‚Äãmore than once. </font><font style="vertical-align: inherit;">The easiest way to do this is to use the Calculator application built into Windows 10. </font><font style="vertical-align: inherit;">We translate it into the ‚Äúprogrammer‚Äù mode and we have a choice in which number system to enter data, and they are duplicated in other number systems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By the search method, I divide all the sensors in the car into several types:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Binary sensors. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quickly changing sensors. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temperature sensors. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Car mileage.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Level sensors. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indication sensors</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensors with requests. </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's move on to the methods with which you can find each type of sensor. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Binary sensors</font></font></b></h3> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Let's start with the simplest binary sensors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These sensors include door sensors, seat belts, brake (whether brake lights are on), hand brake, buttons are pressed, etc. </font><font style="vertical-align: inherit;">Their value is placed in 1 bit, that is, it can be 0 (the door is closed) or 1 (the door is open). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finding them is simple, but requires care. </font><font style="vertical-align: inherit;">To search for a driver‚Äôs door, open / close the door and watch what changes in the CAN bus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The configurator highlights in red those data in which there have been changes in the last few seconds. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/8x/jp/zf8xjpvzhahuxhbdadj6tsmmtum.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, the driver‚Äôs door is responsible for the zero bit of the first byte of the message with ID 470. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the same byte are the sensors of all the other doors + trunk sensor.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Quickly changing sensors</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quickly changing sensors are similar to binary sensors, only their value is more than 1 bit. We can act on these sensors and immediately see changes in the CAN bus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These sensors include most position sensors: gas pedal position, glass position, automatic transmission position, ignition key position. In addition to these, these are sensors of speed, revolutions, sensors of acceleration of the steering wheel, acceleration of the gas pedal, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To begin with, we‚Äôll deal with position sensors using the example of the gas pedal position sensor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To do this, we turn off the car, turn on the ignition and, without starting the engine, press the gas pedal and monitor the change in the CAN bus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a rule, when the gas pedal is released, the value of this sensor is 0, and, as you press the gas pedal, it increases to some value. We see such a parameter in the first CAN in ID 280. The fifth byte changes from 0 (the pedal is released) to FA (the pedal is pressed ‚Äúto the floor‚Äù). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we translate FA from HEX to DEC, then we get the number 250. Therefore, to get the accelerator pedal pressed in percent (from 0 to 100), we need to multiply our value by 0.4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's move on to sensors that do not fit into one byte, for example, to engine speed. We gradually increase and decrease the engine speed, while watching what changes in the CAN bus. Engine revs are in the same ID as the gas pedal.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dx/k2/x9/dxk2x98zuq3b7bsbuv70t9yzzow.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Having worked with the gas pedal, you can understand that the data here are in the reverse order. That is, the oldest part is in the 3rd byte (count bytes from zero), and the youngest in the second byte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, you need to transfer the data from HEX to DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/ev/zh/ohevzhgaspocuc3h3mp1o3z8ciw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we need to evaluate the real revolutions by the tachometer, or by diagnostic instruments. In my case, the needle was at about 1600 rpm on the tachometer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, we divide the data from CAN in decimal format (6508) by the engine speed from the tachometer (1600), we get 4.0675. Given the error in determining the revolutions by eye, round off the divider to 4. After this, you need to check the readings at several points. To do this, set the engine speed at different speeds and check them with data from the CAN bus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the configurator, you can substitute all the coefficients in the sensor settings and watch the changes in speed in real time. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thus, a large number of sensors are sought: brake forces, steering wheel position, steering wheel acceleration, vehicle speed, etc.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Temperature sensors</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It was very difficult to find the temperature in Polo Sedan. To begin with, a byte was found, which slowly changed upwards when the car was heated. After that, the search for the necessary coefficients began. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We connect the diagnostics, select the engine temperature, and compare the readings of the CAN bus and the data from the diagnostics. We build a correspondence table and select the coefficients. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result of the selection of coefficients, a formula for calculating the temperature appeared. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
XX * 0.75 - 48 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where XX is the value of 1 byte from ID 288 in the DEC. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hy/vj/nf/hyvjnf90gsz8naskw2ep1q7ifsa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
According to the formula, it can be calculated that the screenshot had a temperature of </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
179 * 0.75 - 48 = 86.25 ¬∞ C. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
where 179 is the decimal number B3 from the first byte of ID 288.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But this is a difficult case, in many cars the temperature is much easier to find. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since it is difficult to transmit a negative number in the bus, manufacturers accept the value -40 ¬∞ C, -48 ¬∞ C or -58 ¬∞ C as 0 measurements. Therefore, we connect the diagnostics and see what the temperature is now. Add 40 (48 or 58) to this, and translate it to HEX. We are looking for the resulting number in the stream. We are waiting for the temperature of the machine to change by one degree and check with the found value. If its value also increased by 1, then this is the sensor we need.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important not to confuse the values ‚Äã‚Äãfrom the CAN bus with the values ‚Äã‚Äãof the diagnostic queries. If you simultaneously search for readings on the bus and the diagnostic tool is connected, then answers to diagnostic requests will also appear in the bus. They can be identified by ID. Usually all that goes over 700 IDs are diagnostic requests and answers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, the temperature of the coolant can always be made a request, about this method will be described below in the section on sensors with requests. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can use another method to search for temperature: physically we find the coolant temperature sensor (DTOZH) on the engine, turn it off and connect a variable resistor to the car wiring. Then, rotating the resistor and following the CAN bus according to the method of searching for rapidly changing data, you can find the engine temperature readings.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In practice, I didn‚Äôt use this method, since ALT was always either in the stream, or they asked the machine for a request. </font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Car mileage</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the most important parameters for telematics. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First you need to evaluate what size we are looking for a number. </font><font style="vertical-align: inherit;">If you take 2 bytes (16 bits) of data, then the maximum number FF FF = 65,535 will fit into them. The car can clearly travel over 65 thousand, which means that the vehicle must have a minimum of 24 bits long. </font><font style="vertical-align: inherit;">There will already fit 16 million km., Which is clearly enough for a run. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But then again, in different cars in different ways. </font><font style="vertical-align: inherit;">In Polo Sedan, the mileage is written in km, in some French it is transmitted with an accuracy of 100 meters. </font><font style="vertical-align: inherit;">then the number can occupy 32 and more bits. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further for the search you should take the mileage from the dashboard of the car and transfer it to HEX.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_g/y1/s6/_gy1s64ytgtjtxrkpxqccunxe2w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, it is 5732 km. We translate it into HEX and get 16 64. Next, search you need to find the line where this combination will occur. You need to search by one byte, that is, first search for 16, then in the options found, see if there is also the number 64 next to the number 16. The number 64 can be either to the left or to the right of the number 16. Since the mileage in this car is not large, then most likely, next to the number 64 there will also be 00. In the Configurator there is a convenient search (CTRL + F), if you use another tool, you will have to manually search for this data. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In our case, the mileage was found in 520 ID </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/qs/0l/ktqs0lxxwbl7frstr8vjz9qvc54.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
00 16 64 = 5732 km. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To check, it is advisable to drive a few more kilometers and check the value of the sensor found.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the same way mileage is searched before refueling. </font><font style="vertical-align: inherit;">In this car, the dashboard does not transfer the mileage to the gas station to the tire, so it is made by request.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Level sensors</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The second most important sensor for telematics is the fuel level sensor. You can find it either in the stream, which is preferable, or by request (less preferable, but in some cars it will not work differently). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
First you need to find the fuel level readings in the diagnostic tool. My fuel level was found in the instrument cluster (17 block). In the instrument cluster, the readings from the level sensor are in liters. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now the car has 21 liters of fuel. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/t6/r-/rq/t6r-rq-pcbo-urm-pmfurhg7iwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We translate 21 from DEC to HEX and get the number 15. By searching, we try to find it. The stream contains the given number in ID 320. If the number is not found, then you should try to look for values ‚Äã‚Äãone or more. In some cars, fuel comes with an accuracy of half a liter, so you need to look for a value 2 times larger.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l-/mn/tw/l-mntw35tvcsswdhb_kh8sicrb4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Once the fuel level is found, it is necessary to pour a few liters of fuel into the car and look at the result. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can also disassemble the gas tank, pull out the FLS from the tank and move it, following the CAN bus readings. Or remove the connector from the FLS and connect a variable resistor there. Rotating it and following the changes you can find the fuel level sensor. If you decide to disassemble, then the fuel level should be sought by the method of searching for rapidly changing sensors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, when searching, data with IDs over 700 should not be taken into account. These are diagnostic queries. After disconnecting the diagnostic equipment, this data will disappear. We will deal with the requests in more detail below. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, the answer to the queries of the diagnostic equipment of the fuel level from the dashboard looks like this.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, the fuel level (in percent) can be found in standard OBDII queries, but on the VAG group they do not always show the correct data. </font><font style="vertical-align: inherit;">On the Skoda Rapid and Skoda Oktavia with a full tank, the diagnostics show a fuel level of 85%.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/bc/hg/cpbchg8ntk3n1qjolnygoq5zr_c.png"><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Indication sensors</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indication sensors are very similar to binary sensors, and they should be searched by the same method. These sensors include a variety of icons on the dashboard. For example, the status of the Check Engine icon is in the first byte of ID 480. When the ignition is turned on in this sensor 2C. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/sx/de/8rsxdelhyjgtedcykc0f4utt71s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After starting, when the Check Engine (CE) icon goes out, there will be 00 in this sensor. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8r/uq/su/8ruqsurccmkip9yhssm-8flrp00.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now the question remains, which bit is responsible for the CE icon. We translate 2C to BIN and get the number 0010 1100. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, copy the entire 480 ID, change the first byte to 2C (0010 1100) and try to send this packet to the car. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sending data to the car is not always safe, you can break something, or wind up the mileage. </font><font style="vertical-align: inherit;">It is worth resorting to this method only if the sensor could not be found by searching for binary sensors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In my case, I sent to a wound-up car (which is not recommended) and my CE and EPC icon blinks on my tidy. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fj/ci/gb/fjcigbvg8hop-hhliayqzsz81fy.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Then we send instead of 2C (0010 1100) 08 (0000 1000). </font><font style="vertical-align: inherit;">On tidy CE blinks. </font><font style="vertical-align: inherit;">Therefore, 3 bits is responsible for this icon. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kl/tl/up/kltlupgvkuuktk8bxujsft2shb8.gif"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you send 04 (0000 0100), the EPC icon blinks.</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Sensors with requests</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Not all data can be found in the stream. For example, in a diesel VW Transporter T4 there is no engine temperature in the stream. She is not on the tidy. Therefore, you have to ask the car about these parameters. The same applies to the fuel level on the Rio \ Solaris. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this example, let's try to ask the fuel level of the Polo Sedan. We go to block 17, as we did in the paragraph about the search for the fuel level, and ask the dashboard. After analyzing the requests, we see that the diagnosis asks for the fuel level with the following command: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p4/xo/qg/p4xoqgno99-xktykwtl5gagpo1y.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And in response it comes to her: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/il/mj/pn/ilmjpn6qr8tru39qmxufwwwnpso.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, copy ID 714, turn off the diagnostic tool and try to send a request to the car. If ID 77E receives the same answer as it was when the diagnostics were connected, then we received a packet with a fuel level (4 bytes. HEX 15 = DEC 21) 21 liters.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vega MTX has built-in tools for working with sensors with queries. There you can configure that requests would be sent after the ignition is turned on at a certain interval or under certain conditions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This concludes with the methodology for searching data in the CAN bus. If anyone else knows what methods to find the necessary data on the CAN bus or share their experience, then I will listen to them with pleasure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before writing this article, I made a video on this topic. The video contains more information on connecting to the vehicle‚Äôs CAN bus, working with the Configurator and the file server</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DkdOdCKI9HQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link to the Configurator</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
The server has settings for some cars, trucks and agricultural machinery. </font><font style="vertical-align: inherit;">All files are encrypted, you can see which sensors are visible in the vehicle‚Äôs CAN. </font><font style="vertical-align: inherit;">When connected, the sensor values ‚Äã‚Äãwill be visible, but it will not work to see the addresses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To be continued.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en497116/index.html">Starsky Robotics unmanned trucks come to an end</a></li>
<li><a href="../en497118/index.html">[Forecast] Will all unmanned trucks come to an end or only Starsky Robotics?</a></li>
<li><a href="../en497126/index.html">Backlog scoring and prioritization techniques</a></li>
<li><a href="../en497132/index.html">#SaveFirst Initiative to Support Socially Important Projects</a></li>
<li><a href="../en497136/index.html">‚ÄúSave Concord‚Äù or a report from the tests of the Russian radar system for searching for foreign objects on the runway</a></li>
<li><a href="../en497142/index.html">How we added Harmony OS support to the inDriver Android application</a></li>
<li><a href="../en497144/index.html">Wedge by wedge: use of the PIV5 virus to create a vaccine against MERS-CoV and possibly against SARS-CoV-2</a></li>
<li><a href="../en497146/index.html">Applied cryptography. How we restored bitcoins for 300 thousand dollars</a></li>
<li><a href="../en497148/index.html">Creating a desktop application using Golang and Fyne</a></li>
<li><a href="../en497152/index.html">Where Product Heart Lives: Metrics for Measuring Happiness</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>