<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèª üò¶ üöè Trolley Robot 2.0. Teil 1. Autonome Navigation eines Heimroboters basierend auf ROS üë®üèø‚Äç‚öñÔ∏è üôà üë©üèø‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Projekt wurde auf der Grundlage eines anderen in seinen Kreisen bekannten Projekts erstellt - Linorobot (linorobot.org), wobei Komponenten verwend...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Trolley Robot 2.0. Teil 1. Autonome Navigation eines Heimroboters basierend auf ROS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502076/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Projekt wurde auf der Grundlage eines anderen in seinen Kreisen bekannten Projekts erstellt - Linorobot (linorobot.org), wobei Komponenten verwendet wurden, die einem einfachen Laien zur Verf√ºgung stehen. </font><font style="vertical-align: inherit;">Die gesetzten Ziele: Autonome Bewegung des Roboters zu Hause mit kosteng√ºnstigen Komponenten zu erreichen, die Leistung von Mini-PCs f√ºr die angegebenen Zwecke zu bewerten, den Navigationsstapel so zu konfigurieren, dass er sich in den engen R√§umen des Chruschtschows bewegt.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/OGxB34-heds" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eisen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Liste der Komponenten in den Festk√∂rpern lautet wie folgt:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Himbeer pi 3b - 2800 r.;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lidar rplidar a1 - 7500 p.;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kraftbr√ºcken l298n -2pcs - 400 rub .;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Radsatz mit Encodern Typ A und B - 2000 r. </font><font style="vertical-align: inherit;">(210 U / min - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teenzy 3,2 - 2100 r.;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imu 9250 (entweder 9150 oder 6050) - 240 p.;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power Bank bei 10000mH - 1500 r.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 Batterien 18650 und Halter -600 p.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abw√§rtswandler DC-DC C 5V bis 3,3V - 20p.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein St√ºck Sperrholz, Parkett -? </font><font style="vertical-align: inherit;">reiben.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gesamt: 17160 p. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* Die Kosten k√∂nnen reduziert werden, indem Teenzy durch Arduino Mega 2560 (600 S.) und Lidar durch Ersetzen von Kinect v.1 (1000 S.) ersetzt </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ec/vb/v4/ecvbv42ipnldzd5vhureodavsqi.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
werden. Es ist jedoch zu beachten, dass der erste Kinect eine minimale Sichtbarkeit (blinder Bereich) von 0,5 m hat. Dies kann die Navigation unter beengten Bedingungen negativ beeinflussen und ist ziemlich sperrig. </font><font style="vertical-align: inherit;">Der Lidar hat eine Blindzone von weniger als 0,2 m. Kinect v.2 passt nicht zu Himbeere 3b (es hat keinen USB 3.0). </font><font style="vertical-align: inherit;">Arduino Mega ist der Gr√∂√üe (und einigen Eigenschaften) unterlegen, au√üerdem m√ºssen Sie den Code leicht √ºberarbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen sieht das ‚ÄûDesign‚Äú so aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ou/ru/x9/ourux9icibrxsh4ruai61e3wkx4.jpeg"><br>
<br>
<img src="https://habrastorage.org/webt/yg/bh/0h/ygbh0hlvz8juq6qi4e9tarrhznq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier gibt es nat√ºrlich keine Sch√∂nheit, aber es geht nicht darum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zum Roboter selbst ist es √§u√üerst w√ºnschenswert, einen externen PC zu haben, auf dem grafische H√ºllen zur Visualisierung der Aktionen des Roboters (rviz, Pavillon) gestartet werden.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robotermontage</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist detailliert auf der Projektwebsite dargestellt - ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lassen Sie uns also auf die Punkte </font><font style="vertical-align: inherit;">eingehen </font><font style="vertical-align: inherit;">, die Schwierigkeiten verursachen. </font><font style="vertical-align: inherit;">Zuerst m√ºssen Sie ber√ºcksichtigen, dass die Encoder am Radsatz mit 3,3 V betrieben werden und bei Anlegen von 5 V einwandfrei ausfallen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Linorobot-Installationsskript wurde erfolgreich auf Ubuntu 16.04, Ubuntu 18.04 installiert. </font><font style="vertical-align: inherit;">ROS-Versionen: ROS kinetisch oder ROS melodisch. </font><font style="vertical-align: inherit;">Auf Himbeere 3b m√ºssen Sie zuerst eine Auslagerungsdatei erstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der wichtigste Teenzy-Code ist unterwegs:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware/lib/config<font></font>
nano lino_base_config.h<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und mit dem Befehl hineingegossen:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/teensy/firmware<font></font>
platformio run --target upload<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die oben genannten Befehlsb√ºndel werden h√§ufig verwendet, daher ist es sinnvoll, sie zu Aliasnamen hinzuzuf√ºgen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aufgrund der Schwierigkeiten bei der Montage des Roboters kann die korrekte Korrelation der verbundenen Kontakte von l298n zu teenzy problematisch sein. </font><font style="vertical-align: inherit;">Trotz des √§u√üerst klaren Anschlussdiagramms k√∂nnen sich die R√§der unterschiedlich verhalten und m√ºssen experimentieren, indem sie die richtige Pinbelegung im Code ausw√§hlen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In meinem Fall stellte sich Folgendes heraus:</font></font><br>
<br>
<pre><code class="bash hljs">/// ENCODER PINS
<span class="hljs-comment">#define MOTOR1_ENCODER_A 14</span>
<span class="hljs-comment">#define MOTOR1_ENCODER_B 15 </span><font></font>
<font></font>
<span class="hljs-comment">#define MOTOR2_ENCODER_A 11</span>
<span class="hljs-comment">#define MOTOR2_ENCODER_B 12 </span><font></font>
//MOTOR PINS<font></font>
<span class="hljs-comment">#ifdef USE_L298_DRIVER</span>
  <span class="hljs-comment">#define MOTOR_DRIVER L298</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR1_PWM 21</span>
  <span class="hljs-comment">#define MOTOR1_IN_A 1</span>
  <span class="hljs-comment">#define MOTOR1_IN_B 20</span><font></font>
<font></font>
  <span class="hljs-comment">#define MOTOR2_PWM 5</span>
  <span class="hljs-comment">#define MOTOR2_IN_A 8</span>
  <span class="hljs-comment">#define MOTOR2_IN_B 6</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Punkt besteht darin, die Spezifikation der Roboterr√§der vorzuschreiben:</font></font><br>
<br>
<pre><code class="bash hljs">//define your robot<span class="hljs-string">' specs here
#define MAX_RPM 210               // motor'</span>s maximum RPM
<span class="hljs-comment">#define COUNTS_PER_REV 1365       // wheel encoder's no of ticks per rev</span>
<span class="hljs-comment">#define WHEEL_DIAMETER 0.065       // wheel's diameter in meters</span>
<span class="hljs-comment">#define PWM_BITS 8                // PWM Resolution of the microcontroller</span>
<span class="hljs-comment">#define LR_WHEELS_DISTANCE 0.235  // distance between left and right wheels</span>
<span class="hljs-comment">#define FR_WHEELS_DISTANCE 0.30   // distance between front and rear wheels. Ignore this if you're on 2WD/ACKERMANN</span>
<span class="hljs-comment">#define MAX_STEERING_ANGLE 0.415  // max steering angle. This only applies to Ackermann st</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Drehzahl ist in der Radspezifikation angegeben, aber CPR (COUNTS_PER_REV) ist der berechnete Wert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPR = PPR x 4. PPR unserer R√§der 341. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR kann entweder in der Spezifikation angezeigt werden oder der Code auf dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roslaunch Linorobot Minimal.Starten Sie den Roboter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und drehen Sie das Rad um 360 Grad. PPR entspricht dem numerischen Wert, der nach der Raddrehung auf dem Bildschirm angezeigt wird: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/7z/ks/be7zksecqhlyuyv-e_dkxqdyrwe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PPR = abs (RECENT_COUNT - INITIAL_COUNT). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPR = 1364. Sie m√ºssen au√üerdem WHEEL_DIAMETER und LR_WHEELS_DISTANCE in Metern festlegen. Dar√ºber hinaus ist LR_WHEELS_DISTANCE der Abstand zwischen den Mittelachsen der R√§der und nicht von Kante zu Kante. Andere Anzeigen k√∂nnen ignoriert werden, wenn der Roboter ein zweir√§driges Differential ist (nicht omni). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der dritte Punkt, der Schwierigkeiten verursachen kann - die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imu-Kalibrierung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dazu muss der Roboter gem√§√ü den Anweisungen in bestimmten Positionen fixiert werden. Die Hinweise befinden sich im Code, wenn das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skript rosrun imu_calib do_calib ausgef√ºhrt wird</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gg/fj/9e/ggfj9eg71ilp0baj7rvshjl-fmw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Abschluss wird imu_calib.yaml mit Einstellungen generiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist besser, eine Kalibrierung durchzuf√ºhren, obwohl es eine Standarddatei mit IMU-Einstellungen gibt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* Au√üerdem stellte sich heraus, dass die Imu-Kalibrierung die Bewegungsrichtung des Roboters durch Teleop beeinflussen kann (links statt rechts und umgekehrt, w√§hrend die Hin- und Herbewegung korrekt war). Die Situation wurde nicht durch Neuanordnung der Pins im Code gel√∂st. Imu selbst wurde fixiert und mit umgedrehten Klammern kalibriert auf der R√ºckseite der Roboterbasis befestigt. Sein (imu) weiterer Flip ohne Neukalibrierung l√∂ste das Problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vierter Punkt - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PID-Kalibrierung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Projektwebsite wird das Verfahren zur Durchf√ºhrung der Anpassung ausf√ºhrlich beschrieben - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Anf√§nger wird es jedoch schwierig sein, herauszufinden, was es ist und wie man damit arbeitet. </font><font style="vertical-align: inherit;">Im Allgemeinen ist eine PID-Regulierung erforderlich, um sicherzustellen, dass sich der Roboter gleichm√§√üig bewegt, ohne zu ruckeln / pl√∂tzlich zu bremsen. </font><font style="vertical-align: inherit;">Daf√ºr sind drei Parameter verantwortlich: p, i, d. </font><font style="vertical-align: inherit;">Ihre Werte sind im Hauptcode enthalten, der auf teenzy hochgeladen wurde:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define K_P 2.0 // P constant angle</span>
<span class="hljs-comment">#define K_I 0.3 // I constant</span>
<span class="hljs-comment">#define K_D 0.1 // D constant</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen mit ihnen experimentieren, indem Sie auf dem Roboter laufen:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot minimal.launch
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weiter auf dem externen PC in drei verschiedenen Terminals:</font></font><br>
<br>
<pre><code class="bash hljs">rosrun lino_pid pid_configure<font></font>
rosrun teleop_twist_keyboard teleop_twist_keyboard.py<font></font>
rqt<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch Bewegen der Schieberegler p, d, i im rqt-Terminal und anschlie√üendes Steuern des Roboters im teleop_twist_keyboard-Terminal k√∂nnen Sie die erforderlichen Ergebnisse erzielen, ohne den Code jedes Mal in teenzy mit den neuen pid-Parametern herunterladen zu m√ºssen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/9m/ef/qr9mefipf7mqz9vwqqyqkktkeug.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, alles geschieht </font><font style="vertical-align: inherit;">im laufenden Betrieb </font><font style="vertical-align: inherit;">und zu diesem Zeitpunkt in der Firmware Teenzy kann v√∂llig unterschiedliche Bedeutungen haben. </font><font style="vertical-align: inherit;">* Sie k√∂nnen sich nicht auf Diagramme konzentrieren, weil </font><font style="vertical-align: inherit;">visuell, und so wird verstanden, wie der Roboter f√§hrt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie empfehlen, mit der Einstellung der Werte p = 1,0, d = 0,1, i = 0,1 zu beginnen. </font><font style="vertical-align: inherit;">In unserem Fall sind die Werte wie folgt (experimentell erhalten) p = 2,0, i = 0,3, d = 0,1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als n√§chstes m√ºssen diese Werte im Code festgelegt und in Teenzy gef√ºllt werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie auch nicht, den Code einzugeben (DEBUG 0 anstelle von DEBUG 1):</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment">#define DEBUG 0</span></code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kilometerz√§hler</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Orientierung des Roboters und zur anschlie√üenden Navigation werden Lidar-Daten, IMU- und Radgeberdaten verwendet. Wenn die IMU-Kalibrierung korrekt durchgef√ºhrt wird, das Lidar korrekt installiert ist und die Encoderwerte korrekt sind, sollte es keine Probleme mit der Kilometerz√§hler geben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Richtigkeit der Kilometerz√§hler zu √ºberpr√ºfen, m√ºssen Sie ein wenig √ºber Teleop auf dem Roboter fahren und die Werte im Thema Kilometerz√§hler sehen. Dies steht auf der Projektseite - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen Sie sich auch die visuelle H√ºlle von rviz an: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rr/td/si/rrtdsilkdlggf3ifjhk1uhl8bz0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Zelle in rviz ist 1 m gro√ü. Daher ist es ratsam, dass der Roboter dieses Messger√§t sowohl im visuellen Editor als auch in Form von Sachleistungen passiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich wird die zur√ºckgelegte Strecke in der Anzeige w angezeigt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/i1/oj/l6/i1ojl6vg5jyugymjwgk-5cfsrlm.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sollte auch zu 1 m tendieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gleiches gilt f√ºr die Drehwinkel des Roboters:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/l0/uf/bv/l0ufbvhsko99na50frablnrvsc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* In rviz und live muss sich der Roboter im gleichen Winkel drehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kilometerz√§hler von einem Lidar werden auf √§hnliche Weise definiert - eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbindung: Der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abstand vom Lidar zur n√§chsten Wand, sowohl live als auch in rviz, sollte √ºbereinstimmen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TF</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In ROS wird besonderes Augenmerk auf Transformationen gelegt - tf. </font><font style="vertical-align: inherit;">Im Allgemeinen beschreibt dieses Konzept die Korrelation von Objekten relativ zueinander im Raum. </font><font style="vertical-align: inherit;">Damit Objekte nicht in der Luft h√§ngen und das Programm versteht, wie sie relativ zueinander dargestellt werden, muss auf die Einstellung tf geachtet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Projekt sind alle tf-Verbindungen bereits relativ zueinander konfiguriert, und Sie m√ºssen nur die Anzeigen anpassen, um beispielsweise anzuzeigen, wie sich das Lidar befindet. </font><font style="vertical-align: inherit;">Dies ist notwendig, damit der Roboter versteht, dass das Hindernis nicht direkt vor ihm entstanden ist, sondern vor dem Lidar, der in einem bestimmten Abstand von der Mitte des Roboters getrennt ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen wir zum entsprechenden Verzeichnis:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch<font></font>
nano bringup.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Basis selbst befindet sich in einem Abstand von 0,065 m vom Boden:</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_footprint_to_base_link"</span> args=<span class="hljs-string">"0 0 0.065 0 0 0  /base_footprint /base_link "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In laser.launch m√ºssen Sie die Position des Lidars relativ zur Mitte der Roboterbasis festlegen:</font></font><br>
<br>
<pre><code class="bash hljs">roscd linorobot/launch/include<font></font>
nano laser.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In meinem Fall ist der Lidar entlang der x-Achse verschoben: -0,08, y: 0,04 und "steigt" √ºber die Basis (z-Achse): 0,08 m:</font></font><br>
<br>
<pre><code class="bash hljs">&lt;node pkg=<span class="hljs-string">"tf2_ros"</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">"static_transform_publisher"</span> name=<span class="hljs-string">"base_link_to_laser"</span>
args=<span class="hljs-string">"-0.08 0.04 0.08 0 0 0  /base_link /laser "</span>/&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In rviz kann dieser Ort visuell beobachtet werden: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/1v/rz/gj/1vrzgjmhx-gf-jar7jxfbhcovte.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl er nicht weit vom Lidar entfernt ist, </font><font style="vertical-align: inherit;">passen wir </font><font style="vertical-align: inherit;">seine Frequenz so an, dass mehr Punkte </font><font style="vertical-align: inherit;">ausgegeben werden (standardm√§√üig 4 KB </font><font style="vertical-align: inherit;">). Dies hilft beim Erstellen der Karte:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">cd</span> linorobot/launch/include/lidar<font></font>
nano rplidar.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter hinzuf√ºgen:</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"scan_mode"</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Boost"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und √§ndern </font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"angle_compensate"</span>    <span class="hljs-attr">type</span>=<span class="hljs-string">"bool"</span>   <span class="hljs-attr">value</span>=<span class="hljs-string">"false"</span>/&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt stehen uns 8k zur Verf√ºgung: Die </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zf/u0/fq/zfu0fqd4d7nwmuv50am1qhwqxbm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
physische Position des Lidars auf dem Roboter ist ebenfalls wichtig:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/46/mw/vq/46mwvqq3kj7nxpskvoadm7xe738.jpeg"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen einer 2D-Raumkarte</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Projektwebsite wird vorgeschlagen, eine Raumkarte zu erstellen, indem zwei Terminals gestartet werden:</font></font><br>
<br>
<pre><code class="bash hljs">roslaunch linorobot bringup.launch<font></font>
roslaunch linorobot slam.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Praxis hat jedoch gezeigt, dass Slam, das standardm√§√üig mit dem Projekt geliefert wird, nicht funktioniert, wenn der Lidar-Modus 8 KB betr√§gt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/xa/a5/zexaa5f_1byvgcvvvkvcr7cowbi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im 4 KB-Modus sind die Karten nicht sehr erfolgreich, sie sind jedoch sehr laut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher ist es besser, einen anderen Slam zu verwenden - Hector-Slam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie installiert man </font><font style="vertical-align: inherit;">es angezeigt ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Installation ist das Verfahren zum Erstellen einer Karte dieselbe, aber anstelle von roslaunch linorobot slam.launch f√ºhren Sie roslaunch my_hector_mapping my_launch.launch aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maps sind sauberer. Sie k√∂nnen sie jedoch besser in einem grafischen Editor √§ndern und unn√∂tige Karten entfernen, insbesondere wenn der Lidar beim Erstellen der Karte mit Spiegeln kollidiert : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cn/zo/jv/cnzojvfwpkwgldoo3mylfwwh-yg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie nicht, die Raumkarte zu speichern:</font></font><br>
<br>
<pre><code class="bash hljs">rosrun map_server map_saver -f my-map
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* Karten werden besser in einer angenehmen D√§mmerung erhalten, dies wird das Beste aus dem Budget-Lidar herausholen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortsetzung folgt.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502052/index.html">Best Practices von Kubernetes. Erstellen Sie kleine Container</a></li>
<li><a href="../de502054/index.html">Faltungsneurales Netzwerk und seine Integration in iOS (Teil 2)</a></li>
<li><a href="../de502068/index.html">110 Volt an Ihrem Computer</a></li>
<li><a href="../de502070/index.html">Die Geschichte von Pentax (Artikel plus Video)</a></li>
<li><a href="../de502072/index.html">Andocken der ISS mit JavaScript und Kompass</a></li>
<li><a href="../de502080/index.html">Kanban-Methode: Beispiel PNZ Nr. 1, der Messstudienprozess in einem Startup</a></li>
<li><a href="../de502084/index.html">√úberpr√ºfung des Portals der regionalen √∂ffentlichen Dienste unter Last durch Puppenspieler</a></li>
<li><a href="../de502086/index.html">Richten Sie Minio so ein, dass der Benutzer nur mit seinem Eimer arbeiten kann</a></li>
<li><a href="../de502088/index.html">Eine Geschichte von √úberma√ü und Zeitverlust. Nach py3</a></li>
<li><a href="../de502092/index.html">Technologische und regulatorische Unterst√ºtzung f√ºr digitale Vertrauensdienste in der Russischen F√∂deration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>