<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇 🎿 👩🏽‍🤝‍👨🏿 深層強化学習：クモに歩き方を教える方法 ✒️ 🎡 🚵🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今日は、強化ディープラーニングアルゴリズムを適用してロボットを制御する方法について説明します。要するに、入力でロボットアーキテクチャを受け入れ、出力で制御できるアルゴリズムを出力する「ニューラルネットワークを備えたブラックボックス」を作成する方法を説明します。
 

ソリューションの中核は、一般化さ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>深層強化学習：クモに歩き方を教える方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483078/"><iframe width="560" height="315" src="https://www.youtube.com/embed/rxWmEnWR3jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今日は、強化ディープラーニングアルゴリズムを適用してロボットを制御する方法について説明します。</font><font style="vertical-align: inherit;">要するに、入力でロボットアーキテクチャを受け入れ、出力で制御できるアルゴリズムを出力する「ニューラルネットワークを備えたブラックボックス」を作成する方法を説明します。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソリューションの中核は、</font><b><font style="vertical-align: inherit;">一般化されたアドバンテージ推定</font></b><font style="vertical-align: inherit;">（GAE）</font><font style="vertical-align: inherit;">による</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アドバンテージ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スコアを</font><font style="vertical-align: inherit;">使用した</font><b><font style="vertical-align: inherit;">Advantage Actor Critic</font></b><font style="vertical-align: inherit;">（A2C）</font><font style="vertical-align: inherit;">アルゴリズム</font><font style="vertical-align: inherit;">です。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カット、数学、TensorFlowの実装、および歩行アルゴリズムの種類に関する多くのデモが行われました。</font></font></p><br>
<a name="habracut"></a><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ：</font></font></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">課題</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ強化学習なのか？</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">問題の説明強化学習</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポリシーの勾配</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対角ガウスポリシー</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">批評を追加することで差異を減らす</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
 - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">落とし穴</font></font></a><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></a></p><br>
<a name="problem"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕事</font></font></h2><br>
<p>         MuJoCo.         Python   , ..    .  ,       MuJoCo   MuJoCo-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Gym OpenAI</a>.</p><br>
<p>        MuJoCo:  ,  , ,    ,  ..    ~800 .  Deep Learning     ,      . ,        ,    ,    .</p> <br>
<p>    18  —    ,     ,    .</p><br>
<p> ,       (<b>reward</b>)  .   ,       3000  (15 ).        :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi mathvariant=&quot;normal&quot;>&amp;#x0394;</mi><mi>x</mi><mo>&amp;#x2217;</mo><mn>1000</mn><mo>+</mo><mn>0.5</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.895ex" height="2.384ex" viewBox="0 -809.3 8996.6 1026.6" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="1084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-394" x="2141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-78" x="2974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2217" x="3769" y="0"></use><g transform="translate(4492,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1501" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="6716" y="0"></use><g transform="translate(7717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-35" x="779" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi mathvariant="normal">Δ</mi><mi>x</mi><mo>∗</mo><mn>1000</mn><mo>+</mo><mn>0.5</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">\newcommand{\E}{\mathop{\mathbb{E}}}\newcommand{\R}{\mathop{\mathbb{R}}}r_t = \Delta x * 1000 + 0.5</script></p><p>..       <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.509ex" viewBox="0 -540.2 572.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">x</script>      .</p><br>
<p>,  : <b>  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>:</mo><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>800</mn></mrow></msup><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>18</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.814ex" height="2.509ex" viewBox="0 -970.7 6378.1 1080.4" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3A" x="851" y="0"></use><g transform="translate(1407,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><g transform="translate(722,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-38"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="3569" y="0"></use><g transform="translate(4847,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><g transform="translate(722,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-38" x="500" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>:</mo><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mn>800</mn></mrow></msup><mo stretchy="false">→</mo><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mn>18</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3">\pi:\R^{800}\to\R^{18}</script>,       </b>.   , ? :) ,      <b>Deep Reinforcement Learning</b>.</p><br>
<a name="why-rl"></a><h2> Reinforcement Learning?</h2><br>
<p>               <b>optimal control</b>  <b>trajectory optimization</b>: LQR, QP,  . : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  Boston Dynamics   Atlas</a>.</p><br>
<p>     «»,          .      —   « ».</p><br>
<p>  , Reinforcement Learning ( RL)      ,       .</p><br>
<a name="rl-formulation"></a><h2>  Reinforcement Learning</h2><br>
<img src="https://habrastorage.org/webt/i8/gl/yf/i8glyfujascwmexl2qu6sypmpt0.png"><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><i></i></a></p><br>
<p>  RL          <b>(state, reward)</b>     — <b>action</b>.</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><msub><mi>a</mi><mn>0</mn></msub></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy=&quot;false&quot;>)</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub></mpadded></mover><mo>.</mo><mo>.</mo><mo>.</mo><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub></mpadded></mover><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>n</mi></msub><mo>,</mo><msub><mi>r</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.564ex" height="3.759ex" viewBox="0 -1293.7 14881.7 1618.6" role="img" focusable="false" style="vertical-align: -0.755ex; margin-top: -0.257ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="1312" y="0"></use><g transform="translate(1980,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="-85" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="264" y="0"></use><g transform="translate(28,740)"><g transform="translate(233,150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="748" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="3523" y="0"></use><g transform="translate(3912,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="4836" y="0"></use><g transform="translate(5281,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6186" y="0"></use><g transform="translate(6853,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="-85" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="264" y="0"></use><g transform="translate(28,729)"><g transform="translate(233,150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="748" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="8119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="8564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="9009" y="0"></use><g transform="translate(9454,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="-85" y="0"></use><g transform="translate(362.92822001752086,0) scale(1.148778461331114,1)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="954" y="0"></use><g transform="translate(28,770)"><g transform="translate(233,150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><g transform="translate(374,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="1379" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="11687" y="0"></use><g transform="translate(12076,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="13070" y="0"></use><g transform="translate(13516,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="14492" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mover><mo>→</mo><mpadded width="+0.611em" lspace="0.278em" voffset=".15em"><msub><mi>a</mi><mn>0</mn></msub></mpadded></mover><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mover><mo>→</mo><mpadded width="+0.611em" lspace="0.278em" voffset=".15em"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></mpadded></mover><mo>.</mo><mo>.</mo><mo>.</mo><mover><mo>→</mo><mpadded width="+0.611em" lspace="0.278em" voffset=".15em"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub></mpadded></mover><mo stretchy="false">(</mo><msub><mi>s</mi><mi>n</mi></msub><mo>,</mo><msub><mi>r</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">(s_0)\xrightarrow{a_0}(s_1,r_1)\xrightarrow{a_{1}}...\xrightarrow{a_{n-1}}(s_n,r_n)</script></p><p> :</p><br>
<ul>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.76ex" height="2.634ex" viewBox="0 -809.3 3341.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="573" y="0"></use><g transform="translate(963,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="1848" y="0"></use><g transform="translate(2126,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="2951" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">\pi(a_t|s_t)</script> — <b>policy</b>,   ,  ,</li>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.506ex" height="2.634ex" viewBox="0 -809.3 4953.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="1162" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="2219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="2792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-22C5" x="3182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="3460" y="0"></use><g transform="translate(3739,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="4564" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>t</mi></msub><mo>∼</mo><mi>π</mi><mo stretchy="false">(</mo><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">a_t\sim\pi(\cdot|s_t)</script> — <b>action</b>       <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.332ex" height="1.509ex" viewBox="0 -540.2 573.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">\pi</script>, <br>
 <i>    policy   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>:</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>s</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>A</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.47ex" height="2.134ex" viewBox="0 -809.3 9244.1 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3A" x="851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-53" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="2053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="2414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="2944" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-65" x="3305" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="3772" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="4519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="5797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-63" x="6548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="6981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-69" x="7343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6F" x="7688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="8174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="8774" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>:</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>s</mi><mo stretchy="false">→</mo><mi>A</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\pi:States\to Actions</script>,       ,   <b>exploration</b>. ..         ,   . </i></li>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.202ex" height="1.509ex" viewBox="0 -540.2 517.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>τ</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">\tau</script> — ,  ,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.611ex" height="2.634ex" viewBox="0 -809.3 6290.9 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="1312" y="0"></use><g transform="translate(1758,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-32" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="3126" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="3571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2E" x="4016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="4462" y="0"></use><g transform="translate(4907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5901" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>s</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">(s_1, s_2, ..., s_n) </script>.</li>
</ul><br>
<p>  —  <b>expected return</b>:</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></munder><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.346ex" height="7.384ex" viewBox="0 -1831.9 13496.3 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1023" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="1596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2263" y="0"></use><g transform="translate(3320,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="327" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1296" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5B" x="4641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="4920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="6069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5D" x="6976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="7532" y="0"></use><g transform="translate(8589,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="327" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1296" y="0"></use></g></g><g transform="translate(9910,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5B"></use><g transform="translate(583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(142,-1090)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1140" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="721" y="1627"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5D" x="3001" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>π</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><mi>π</mi></mrow></munder><mo>⁡</mo><mo stretchy="false">[</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><mi>π</mi></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-11">J(\pi)=\E_{\tau\sim\pi}[R(\tau)]=\E_{\tau\sim\pi} \left[\sum_{t=0}^n r_t\right]</script></p><p>     RL, :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mi>&amp;#x03C0;</mi></munder><mo>&amp;#x2061;</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.868ex" height="3.759ex" viewBox="0 -809.3 8123.7 1618.6" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2217" x="812" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="1306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="2362" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="2891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-67" x="3343" y="0"></use><g transform="translate(3990,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-78" x="1408" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1113" y="-866"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="6137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="6771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="7160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7734" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>π</mi><mo>∗</mo></msup><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><munder><mrow class="MJX-TeXAtom-OP"><mi>m</mi><mi>a</mi><mi>x</mi></mrow><mi>π</mi></munder><mo>⁡</mo><mi>J</mi><mo stretchy="false">(</mo><mi>π</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-12">\pi^* = arg \mathop {max} _ \pi J(\pi)</script></p><p> <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.388ex" height="2.009ex" viewBox="0 -755.5 1028.4 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2217" x="812" y="513"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>π</mi><mo>∗</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-13"> \pi^* </script> —   policy.</p><br>
<p>    OpenAI: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> OpenAI Spinning Up</a>.</p><br>
<a name="policy-gradient"></a><h2>Policy gradient</h2><br>
<p>,     RL           ,  <b> </b>.  ,    ,    <b>  expected return   </b>: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.548ex" height="2.634ex" viewBox="0 -809.3 3680.5 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1898" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3290" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14">\nabla_\theta J(\pi_\theta)</script>.   ,      :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo>=</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>+</mo><mi>&amp;#x03B1;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.535ex" height="2.634ex" viewBox="0 -809.3 8841.5 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="747" y="0"></use><g transform="translate(1803,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-64" x="784" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="3519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B1" x="4520" y="0"></use><g transform="translate(5161,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="6426" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="7060" y="0"></use><g transform="translate(7449,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="8452" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>θ</mi><mo>=</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>+</mo><mi>α</mi><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-15">\theta = \theta_{old} + \alpha\nabla_\theta J(\pi_\theta)</script></p><p>        <b>policy gradient</b>.       .     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">    OpenAI</a>.    :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.091ex" height="7.384ex" viewBox="0 -1831.9 18122.5 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1898" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3958" y="0"></use><g transform="translate(5014,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="478" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><g transform="translate(916,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g></g></g><g transform="translate(6639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5B"></use><g transform="translate(583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(142,-1090)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1140" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use></g><g transform="translate(3043,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(4489,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5491" y="0"></use><g transform="translate(5881,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="6766" y="0"></use><g transform="translate(7045,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="8259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="9019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="9408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="9926" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5D" x="10899" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-16">\nabla_\theta J(\pi_\theta)=\E_{\tau\sim\pi_\theta}\left[\sum_{t=0}^T \nabla_\theta \log \pi_\theta(a_t|s_t) R(\tau)\right]</script></p><p>  <b>loss</b>    :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.608ex" height="2.634ex" viewBox="0 -809.3 11886.9 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="3057" y="0"></use><g transform="translate(4002,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5281" y="0"></use><g transform="translate(5671,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="6673" y="0"></use><g transform="translate(7063,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="7948" y="0"></use><g transform="translate(8226,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="9051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="9441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="9830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="10590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="10979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="11497" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-17">loss = -\log(\pi_\theta(a_t|s_t))R(\tau)</script></p><p>,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi>r</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.516ex" height="3.259ex" viewBox="0 -1024.6 6680.3 1403.3" role="img" focusable="false" style="vertical-align: -0.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="1666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2333" y="0"></use><g transform="translate(3390,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1140" y="0"></use></g></g><g transform="translate(5873,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">R(\tau) = \sum_{t=0}^T r_t</script>,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.757ex" height="2.634ex" viewBox="0 -809.3 3770.2 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1002" y="0"></use><g transform="translate(1391,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="2277" y="0"></use><g transform="translate(2555,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3380" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">\pi_\theta(a_t|s_t)</script> —       ,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.916ex" height="1.759ex" viewBox="0 -540.2 825.1 757.5" role="img" focusable="false" style="vertical-align: -0.505ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">s_t</script>.     ,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.471ex" height="2.009ex" viewBox="0 -755.5 633.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">J</script>.               <b>variance</b>(     ).</p><br>
<p>   ,  <b>REINFORCE</b>.         . , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">«CartPole-v1»</a>.</p><br>
<p>  :</p><br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActorNetworkDiscrete</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-literal">None</span>, observation_space])<font></font>
        l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number">20</span>, activation=tf.nn.relu)<font></font>
        output_linear = tf.layers.dense(l1, units=action_space)<font></font>
<font></font>
        output = tf.nn.softmax(output_linear)<font></font>
        self.action_op = tf.squeeze(tf.multinomial(logits=output_linear,num_samples=<span class="hljs-number">1</span>), <font></font>
                                    axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
        <span class="hljs-comment"># Training</span><font></font>
        output_log = tf.nn.log_softmax(output_linear)<font></font>
<font></font>
        self.weight_ph = tf.placeholder(shape=[<span class="hljs-literal">None</span>], dtype=tf.float32)<font></font>
        self.action_ph = tf.placeholder(shape=[<span class="hljs-literal">None</span>], dtype=tf.int32)<font></font>
<font></font>
        action_one_hot = tf.one_hot(self.action_ph, action_space)<font></font>
        responsible_output_log = tf.reduce_sum(output_log * action_one_hot, axis=<span class="hljs-number">1</span>)<font></font>
        self.loss = -tf.reduce_mean(responsible_output_log * self.weight_ph)<font></font>
<font></font>
        optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate)<font></font>
        self.update_op = optimizer.minimize(self.loss)<font></font>
<font></font>
actor = ActorNetworkDiscrete()<font></font>
</code></pre><br>
<p>      : (observation_space, 10, action_space)[ CartPole  (4, 10, 2)]. <b>tf.multinomial</b>     .     :</p><br>
<pre><code class="python hljs">action = sess.run(actor.action_op, <font></font>
                  feed_dict={actor.state_ph: observation})<font></font>
</code></pre><br>
<p>     :</p><br>
<pre><code class="python hljs">batch_generator = generate_batch(environments,<font></font>
                                 batch_size=batch_size)<font></font>
<font></font>
<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> tqdm_notebook(range(epochs_number)):<font></font>
    batch = next(batch_generator)<font></font>
<font></font>
    <span class="hljs-comment"># Remainder: batch item consists of [state, action, total reward]</span>
    <span class="hljs-comment"># Train actor</span><font></font>
    _, actor_loss = sess.run([actor.update_op, actor.loss], <font></font>
                             feed_dict={actor.state_ph: batch[:, <span class="hljs-number">0</span>],<font></font>
                                        actor.action_ph: batch[:, <span class="hljs-number">1</span>],<font></font>
                                        actor.weight_ph: batch[:, <span class="hljs-number">2</span>]})
</code></pre><br>
<p>          .      : <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.625ex" height="2.634ex" viewBox="0 -809.3 5435.6 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="1214" y="0"></use><g transform="translate(1659,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="2990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="3749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="4139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="4656" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5046" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">(s_t, a_t, R(\tau))</script>.</p> <br>
<p>   —  ,    —    <b>sess.run()</b>       ( MuJoCo).       ,      ,     . <b>              .</b></p><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">    DummyVecEnv  OpenAI baselines</b>
                        <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Vectorized environments with gym-like interface</span>
<span class="hljs-keyword">from</span> baselines.common.vec_env.subproc_vec_env <span class="hljs-keyword">import</span> SubprocVecEnv
<span class="hljs-keyword">from</span> baselines.common.vec_env.dummy_vec_env <span class="hljs-keyword">import</span> DummyVecEnv<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_env</span>(<span class="hljs-params">env_id, seed</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_f</span>():</span><font></font>
        env = gym.make(env_name)<font></font>
        env.reset()<font></font>
<font></font>
        <span class="hljs-comment"># Desync environments</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(<span class="hljs-number">200</span> * seed // environments_count)):<font></font>
            env.step(env.action_space.sample())<font></font>
        <span class="hljs-keyword">return</span> env
    <span class="hljs-keyword">return</span> _f<font></font>
<font></font>
envs = [make_env(env_name, seed) <span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> range(environments_count)]<font></font>
<font></font>
<span class="hljs-comment"># Can be switched to SubprocVecEnv to parallelize on cores </span>
<span class="hljs-comment"># (for computationally heavy envs)</span><font></font>
envs = DummyVecEnv(envs)<font></font>
<font></font>
<font></font>
<span class="hljs-comment"># Source: </span>
<span class="hljs-comment"># https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">discount_cumsum</span>(<span class="hljs-params">x, coef</span>):</span>
    <span class="hljs-string">"""
    magic from rllab for computing discounted cumulative sums of vectors.
    input: 
        vector x, 
        [x0, 
         x1, 
         x2]
    output:
        [x0 + discount * x1 + discount^2 * x2,  
         x1 + discount * x2,
         x2]
    """</span>
    <span class="hljs-keyword">return</span> scipy.signal.lfilter([<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, float(-coef)], x[::<span class="hljs-number">-1</span>], axis=<span class="hljs-number">0</span>)[::<span class="hljs-number">-1</span>]<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">generate_batch</span>(<span class="hljs-params">envs, batch_size, replay_buffer_size</span>):</span><font></font>
    envs_number = envs.num_envs<font></font>
    observations = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(observation_space)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(envs_number)]<font></font>
    <font></font>
    <span class="hljs-comment"># [state, action, discounted reward-to-go]</span>
    replay_buffer = np.empty((<span class="hljs-number">0</span>,<span class="hljs-number">3</span>), np.float32)<font></font>
    <font></font>
    <span class="hljs-comment"># [state, action, reward] rollout lists for every environment instance</span>
    rollouts = [np.empty((<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(envs_number)]<font></font>
<font></font>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<font></font>
        history = {<span class="hljs-string">'reward'</span>: [], <span class="hljs-string">'max_action'</span>: []}<font></font>
        replay_buffer = replay_buffer[batch_size:]<font></font>
        <font></font>
        <span class="hljs-comment"># Main sampling cycle</span>
        <span class="hljs-keyword">while</span> len(replay_buffer) &lt; replay_buffer_size:
            <span class="hljs-comment"># Here policy acts in environments. Note that it chooses actions for all</span>
            <span class="hljs-comment"># environments in one batch, therefore expensive sess.run is called once.</span><font></font>
            actions = sess.run(actor.action_op, <font></font>
                               feed_dict={actor.state_ph: observations})<font></font>
            observations_old = observations<font></font>
            observations, rewards, dones, _ = envs.step(actions)<font></font>
            <font></font>
            history[<span class="hljs-string">'max_action'</span>].append(np.abs(actions).max())<font></font>
            <font></font>
            time_point = np.array(list(zip(observations_old, actions, rewards)))<font></font>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(envs_number):
                <span class="hljs-comment"># Regular python-like append</span>
                rollouts[i] = np.append(rollouts[i], [time_point[i]], axis=<span class="hljs-number">0</span>) <font></font>
            <font></font>
            <span class="hljs-comment"># Process done==True environments</span>
            <span class="hljs-keyword">if</span> dones.all():<font></font>
                print(<span class="hljs-string">'WARNING: envs are in sync!! This makes sampling inefficient!'</span>)<font></font>
<font></font>
            done_indexes = np.arange(envs_number)[dones]<font></font>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> done_indexes:<font></font>
                rewards_trajectory = rollouts[i][:, <span class="hljs-number">2</span>].copy()<font></font>
                history[<span class="hljs-string">'reward'</span>].append(rewards_trajectory.sum())<font></font>
<font></font>
                rollouts[i][:, <span class="hljs-number">2</span>] = discount_cumsum(rewards_trajectory,<font></font>
                                                    coef=discount_factor)<font></font>
                replay_buffer = np.append(replay_buffer, rollouts[i], axis=<span class="hljs-number">0</span>)<font></font>
                rollouts[i] = np.empty((<span class="hljs-number">0</span>, <span class="hljs-number">3</span>))<font></font>
        <font></font>
        <span class="hljs-comment"># Shuffle before yield to become closer to i.i.d.</span><font></font>
        np.random.shuffle(replay_buffer)<font></font>
        <font></font>
        <span class="hljs-comment"># Truncate replay_buffer to get the most relevant feedback from environment</span><font></font>
        replay_buffer = replay_buffer[:replay_buffer_size]<font></font>
        <span class="hljs-keyword">yield</span> replay_buffer[:batch_size], history<font></font>
<font></font>
<span class="hljs-comment"># Make a test yield</span>
a = generate_batch(envs, <span class="hljs-number">8</span>, <span class="hljs-number">64</span>)
<span class="hljs-comment"># Makes them of equal lenght</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):<font></font>
    next(a)<font></font>
next(a)[<span class="hljs-number">0</span>]
</code></pre></div>
                    </div><br>
<p>       <b>  </b>.       . ,  ,     <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mi>n</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.897ex" height="2.134ex" viewBox="0 -809.3 1247.1 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="1021" y="581"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-23">\R^n</script>,  <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.509ex" viewBox="0 -540.2 600.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">n</script> —   . (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">            </a>)</p><br>
<a name="diagonal-gaussian-policies"></a><h2>Diagonal Gaussian Policies</h2><br>
<p>  <b>Diagonal Gaussian Policies</b>  ,     n-  ,   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BC;</mi><mi>&amp;#x03B8;</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.405ex" height="2.009ex" viewBox="0 -540.2 1035.5 865.1" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3BC" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="853" y="-219"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>μ</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">\mu_\theta</script> — .   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C3;</mi><mi>&amp;#x03B8;</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.331ex" height="1.884ex" viewBox="0 -540.2 1003.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="808" y="-219"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>σ</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">\sigma_\theta</script> —  . <b>      ,             .</b>  ,     &nbsp;<math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mi>n</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.897ex" height="2.134ex" viewBox="0 -809.3 1247.1 918.9" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6E" x="1021" y="581"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">\R^n</script>    .  ,      ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.538ex" height="2.634ex" viewBox="0 -809.3 5828.7 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1279" y="0"></use><g transform="translate(1669,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="2671" y="0"></use><g transform="translate(3060,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="3946" y="0"></use><g transform="translate(4224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5439" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">\log(\pi_\theta(a_t|s_t))</script> , , policy gradient.</p><br>
<p>:   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C3;</mi><mi>&amp;#x03B8;</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.331ex" height="1.884ex" viewBox="0 -540.2 1003.5 811.3" role="img" focusable="false" style="vertical-align: -0.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="808" y="-219"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>σ</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">\sigma_\theta</script>  ,     .  ,      , , ,  .</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">   policy</a>.</p><br>
<p> :</p><br>
<pre><code class="python hljs">epsilon = <span class="hljs-number">1e-8</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gaussian_loglikelihood</span>(<span class="hljs-params">x, mu, log_std</span>):</span>
    pre_sum = <span class="hljs-number">-0.5</span> * (((x - mu) / (tf.exp(log_std) + epsilon))**<span class="hljs-number">2</span> + <span class="hljs-number">2</span> * log_std + np.log(<span class="hljs-number">2</span> * np.pi))
    <span class="hljs-keyword">return</span> tf.reduce_sum(pre_sum, axis=<span class="hljs-number">1</span>)<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActorNetworkContinuous</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-literal">None</span>, observation_space])<font></font>
<font></font>
        l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number">100</span>, activation=tf.nn.tanh)<font></font>
        l2 = tf.layers.dense(l1, units=<span class="hljs-number">50</span>, activation=tf.nn.tanh)<font></font>
        l3 = tf.layers.dense(l2, units=<span class="hljs-number">25</span>, activation=tf.nn.tanh)<font></font>
        mu = tf.layers.dense(l3, units=action_space)<font></font>
<font></font>
        log_std = tf.get_variable(name=<span class="hljs-string">'log_std'</span>, <font></font>
                                  initializer=<span class="hljs-number">-0.5</span> * np.ones(action_space,  dtype=np.float32))<font></font>
        std = tf.exp(log_std)<font></font>
<font></font>
        self.action_op = mu + tf.random.normal(shape=tf.shape(mu)) * std<font></font>
<font></font>
        <span class="hljs-comment"># Training</span>
        self.weight_ph = tf.placeholder(shape=[<span class="hljs-literal">None</span>], dtype=tf.float32)<font></font>
        self.action_ph = tf.placeholder(shape=[<span class="hljs-literal">None</span>, action_space], dtype=tf.float32)<font></font>
<font></font>
        action_logprob = gaussian_loglikelihood(self.action_ph, mu, log_std)<font></font>
        self.loss = -tf.reduce_mean(action_logprob * self.weight_ph)<font></font>
        <font></font>
        optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate)<font></font>
        self.update_op = optimizer.minimize(self.loss)<font></font>
</code></pre><br>
<p>     .</p><br>
<p> , ,  ,  REINFORCE    .      —  .</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/eH8cFxYHhQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p>,      .</p><br>
<h3>Reward-to-go</h3><br>
<p>,       .      <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="1.884ex" viewBox="0 -701.7 361.5 811.3" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">t</script>         <b>  </b>.  ,       .  ,   ?   </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub></mrow><mo>]</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.804ex" height="7.384ex" viewBox="0 -1831.9 18859.9 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1898" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3958" y="0"></use><g transform="translate(5014,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="478" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><g transform="translate(916,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g></g></g><g transform="translate(6639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5B"></use><g transform="translate(583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(142,-1090)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1140" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use></g><g transform="translate(3043,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(4489,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5491" y="0"></use><g transform="translate(5881,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="6766" y="0"></use><g transform="translate(7045,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7870" y="0"></use><g transform="translate(8426,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(38,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use></g><g transform="translate(10037,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5D" x="11636" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-31">\nabla_\theta J(\pi_\theta)=\E_{\tau\sim\pi_\theta}\left[\sum_{t=0}^T \nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{t'=0}^T r_{t'}\right]</script></p><p>  </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub></mrow><mo>]</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.804ex" height="7.384ex" viewBox="0 -1831.9 18859.9 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-4A" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1898" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3958" y="0"></use><g transform="translate(5014,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="478" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><g transform="translate(916,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g></g></g><g transform="translate(6639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5B"></use><g transform="translate(583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(142,-1090)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1140" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use></g><g transform="translate(3043,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(4489,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5491" y="0"></use><g transform="translate(5881,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="6766" y="0"></use><g transform="translate(7045,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7870" y="0"></use><g transform="translate(8426,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(87,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use></g><g transform="translate(10037,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ4-5D" x="11636" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>J</mi><mo stretchy="false">(</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><msub><mi>π</mi><mi>θ</mi></msub></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-32">\nabla_\theta J(\pi_\theta)=\E_{\tau\sim\pi_\theta}\left[\sum_{t=0}^T \nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{t'=t}^T r_{t'}\right]</script></p><p> 10  :)</p><br>
<p>          ,     .           ,   <b>  </b>.</p><br>
<p>    reward .            :</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8sN-VaQsnVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="add-critic"></a><h2> variance   </h2><br>
<p>      (variance),  -     .</p><br>
<p>     <b>,      </b>,  ,    <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.509ex" viewBox="0 -540.2 469.5 649.8" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">s</script>   , .. Value-.</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow><mtext>&amp;#xA0;- Value function</mtext></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.939ex" height="3.759ex" viewBox="0 -809.3 18056.8 1618.6" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1720" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2857" y="0"></use><g transform="translate(3913,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="327" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1296" y="0"></use></g></g><g transform="translate(5235,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="1666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="2056" y="0"></use><g transform="translate(2334,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="4591" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5D" x="5339" y="0"></use></g><g transform="translate(10853,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-56" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="1584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C" x="2084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="2363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-65" x="2919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-66" x="3614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="3920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="4477" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-63" x="5033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="5478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-69" x="5867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="6146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="6646" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><mi>π</mi></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow><mtext>&nbsp;- Value function</mtext></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-34">V^\pi(s)=\E_{\tau\sim\pi}\left[R(\tau)|s_0=s\right]\text{ - Value function}</script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C4;</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></munder><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow><mtext>&amp;#xA0;- Action-Value function</mtext></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="59.327ex" height="3.759ex" viewBox="0 -809.3 25543.3 1618.6" role="img" focusable="false" style="vertical-align: -1.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1119" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1297" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="2601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3797" y="0"></use><g transform="translate(4854,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="327" y="0"></use><g transform="translate(0,-602)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="517" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1296" y="0"></use></g></g><g transform="translate(6176,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="1666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="2056" y="0"></use><g transform="translate(2334,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="4591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="5061" y="0"></use><g transform="translate(5506,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="6767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="7824" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5D" x="8632" y="0"></use></g><g transform="translate(15086,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-41" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-63" x="1584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="2028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-69" x="2418" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="2696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="3197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2D" x="3753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-56" x="4087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="4837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C" x="5338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="5616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-65" x="6173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-66" x="6867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="7174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="7730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-63" x="8287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="8731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-69" x="9121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="9399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="9900" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mi>τ</mi><mo>∼</mo><mi>π</mi></mrow></munder><mo>⁡</mo><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow><mtext>&nbsp;- Action-Value function</mtext></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-35">Q^\pi(s, a)=\E_{\tau\sim\pi}\left[R(\tau)|s_0=s, a_0=a\right]\text{ - Action-Value function}</script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;- Advantage function</mtext></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.019ex" height="2.634ex" viewBox="0 -809.3 21535.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1061" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1256" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="2560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3756" y="0"></use><g transform="translate(4813,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1119" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="6110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="6499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="6969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="7414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="8555" y="0"></use><g transform="translate(9556,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="10887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="11276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="11746" y="0"></use><g transform="translate(12135,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-41" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-64" x="1584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-76" x="2140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="2669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="3169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="4115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-65" x="5116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-66" x="5811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="6117" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="6674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-63" x="7230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="7675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-69" x="8064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="8343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="8843" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>A</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mtext>&nbsp;- Advantage function</mtext></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-36">A^\pi(s, a)=Q^\pi(s, a)-V^\pi(s)\text{ - Advantage function}</script></p><p>Value-  expected return,   policy     .     Q-,      .</p><br>
<h3> </h3><br>
<p>     reward-to-go:</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.93ex" height="7.384ex" viewBox="0 -1831.9 9442 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><g transform="translate(1432,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(2878,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="3880" y="0"></use><g transform="translate(4270,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="5155" y="0"></use><g transform="translate(5433,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6259" y="0"></use><g transform="translate(6815,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(87,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use></g><g transform="translate(8426,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-37">\nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{t'=t}^T r_{t'}</script></p><p>        ,   Value-.</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mo>&amp;#x223C;</mo><msup><mi>V</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.016ex" height="7.384ex" viewBox="0 -1831.9 6895.8 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(87,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use><g transform="translate(1611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-223C" x="2904" y="0"></use><g transform="translate(3960,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5291" y="0"></use><g transform="translate(5681,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6506" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>∼</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-38">\sum_{t'=t}^T r_{t'} \sim V^\pi(s_t)</script></p><p>       -  ,    . <b>   Value- - ,   ,      ,     variance.</b>    <b> (Critic)</b>       policy.  ,     :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mo>&amp;#x2248;</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>V</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C4;</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.572ex" height="7.384ex" viewBox="0 -1831.9 20051.9 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use><g transform="translate(1432,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(2878,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="3880" y="0"></use><g transform="translate(4270,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="5155" y="0"></use><g transform="translate(5433,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6259" y="0"></use><g transform="translate(6815,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(87,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use></g><g transform="translate(8426,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2248" x="9719" y="0"></use><g transform="translate(10776,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2207" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="1178" y="-219"></use></g><g transform="translate(12208,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6C"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="779" y="0"></use></g><g transform="translate(13654,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B8" x="806" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="14656" y="0"></use><g transform="translate(15046,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-7C" x="15931" y="0"></use><g transform="translate(16209,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="17035" y="0"></use><g transform="translate(17424,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="18755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C4" x="19144" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="19662" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo>≈</mo><msub><mi mathvariant="normal">∇</mi><mi>θ</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>π</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>a</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>τ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-39">\nabla_\theta \log \pi_\theta(a_t|s_t) \sum_{t'=t}^T r_{t'} \approx \nabla_\theta \log \pi_\theta(a_t|s_t) V^\pi(\tau)</script></p><p>  variance,        <b>bias</b>   ,         .       .       <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">bias-variance tradeoff</a></b>.</p><br>
<p>   Value-    reward-to-go,   .      MSE. .. loss   :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>V</mi></mrow><mi>&amp;#x03C8;</mi><mi>&amp;#x03C0;</mi></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.722ex" height="7.384ex" viewBox="0 -1831.9 11074.6 3179.3" role="img" focusable="false" style="vertical-align: -3.13ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="3057" y="0"></use><g transform="translate(3446,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="581"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C8" x="825" y="-381"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="4777" y="0"></use><g transform="translate(5166,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="6603" y="0"></use><g transform="translate(7604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(87,-1155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="669" y="1627"></use></g><g transform="translate(9215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g><g transform="translate(10231,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-32" x="550" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi>V</mi></mrow><mi>ψ</mi><mi>π</mi></msubsup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-40">loss = ({V}^\pi_\psi(s_t)-\sum_{t'=t}^T r_{t'})^2</script></p><p> :</p><br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CriticNetwork</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-literal">None</span>, observation_space])<font></font>
<font></font>
        l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number">100</span>, activation=tf.nn.tanh)        <font></font>
        l2 = tf.layers.dense(l1, units=<span class="hljs-number">50</span>, activation=tf.nn.tanh)<font></font>
        l3 = tf.layers.dense(l2, units=<span class="hljs-number">25</span>, activation=tf.nn.tanh)<font></font>
        output = tf.layers.dense(l3, units=<span class="hljs-number">1</span>)<font></font>
        <font></font>
        self.value_op = tf.squeeze(output, axis=<span class="hljs-number">-1</span>)<font></font>
<font></font>
        <span class="hljs-comment"># Training</span>
        self.value_ph = tf.placeholder(shape=[<span class="hljs-literal">None</span>], dtype=tf.float32)<font></font>
        <font></font>
        self.loss = tf.losses.mean_squared_error(self.value_ph, self.value_op)<font></font>
        <font></font>
        optimizer = tf.train.AdamOptimizer(learning_rate=critic_learning_rate)<font></font>
        self.update_op = optimizer.minimize(self.loss)<font></font>
</code></pre><br>
<p>    :</p><br>
<pre><code class="python hljs">batch_generator = generate_batch(envs,<font></font>
                                 batch_size=batch_size)<font></font>
<font></font>
<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> tqdm_notebook(range(epochs_number)):<font></font>
    batch = next(batch_generator)<font></font>
<font></font>
    <span class="hljs-comment"># Remainder: batch item consists of [state, action, value, reward-to-go]</span>
    <span class="hljs-comment"># Train actor</span><font></font>
    _, actor_loss = sess.run([actor.update_op, actor.loss], <font></font>
                             feed_dict={actor.state_ph: batch[:, <span class="hljs-number">0</span>],<font></font>
                                        actor.action_ph: batch[:, <span class="hljs-number">1</span>],<font></font>
                                        actor.weight_ph: batch[:, <span class="hljs-number">2</span>]})<font></font>
    <font></font>
    <span class="hljs-comment"># Train critic</span>
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):<font></font>
        _, critic_loss = sess.run([critic.update_op, critic.loss], <font></font>
                                  feed_dict={critic.state_ph: batch[:, <span class="hljs-number">0</span>],<font></font>
                                             critic.value_ph: batch[:, <span class="hljs-number">3</span>]})
</code></pre><br>
<p>     , value,    .<br>
..   : <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msubsup><mi>V</mi><mi>&amp;#x03C8;</mi><mi>&amp;#x03C0;</mi></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>t</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.082ex" height="3.634ex" viewBox="0 -1024.6 10368.7 1564.8" role="img" focusable="false" style="vertical-align: -1.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="1214" y="0"></use><g transform="translate(1659,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2544" y="0"></use><g transform="translate(2990,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="499"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C8" x="825" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="4320" y="0"></use><g transform="translate(4710,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="5535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="5925" y="0"></use><g transform="translate(6370,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-54" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="513"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1434" y="0"></use></g></g><g transform="translate(8963,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2032" x="511" y="500"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="9979" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msubsup><mi>V</mi><mi>ψ</mi><mi>π</mi></msubsup><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>,</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></munderover><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41"> (s_t, a_t, V^\pi_\psi(s_t), \sum_{t'=t}^T r_{t'}) </script>.</p><br>
<p>       <b>   </b>,      ,     Value-   bias.       ,   . <b>    policy  .</b>          ,      ,    policy  ,       .      <b>on-policy</b>.</p><br>
<h3>Baselines in Policy Gradients</h3><br>
<p> ,      Value-         <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="1.884ex" viewBox="0 -701.7 361.5 811.3" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">t</script>.    <b>baselines</b>. (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">  </a>)        :</p><br>
<img src="https://habrastorage.org/webt/c8/ah/l7/c8ahl70po6_pgcud0jxdfbmubi8.png"><br>
<p><i>: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">GAE paper</a>.</i></p><br>
<p>        .      <b>Advantage-</b>   .</p><br>
<p>     .    Advantage,     ,           .       ,  <b>   </b>.             Advantage  0 , ,    0.</p><br>
<h3> Advantage  Value-</h3><br>
<p>  Advantage:</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mi>&amp;#x03C0;</mi></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;- Advantage function</mtext></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.019ex" height="2.634ex" viewBox="0 -809.3 21535.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1061" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="1256" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="1645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="2560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="3756" y="0"></use><g transform="translate(4813,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-51" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1119" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="6110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="6499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="6969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="7414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="8555" y="0"></use><g transform="translate(9556,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="1167" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="10887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="11276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="11746" y="0"></use><g transform="translate(12135,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-41" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-64" x="1584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-76" x="2140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="2669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="3169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="3726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-61" x="4115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-67" x="4616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-65" x="5116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-66" x="5811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-75" x="6117" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="6674" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-63" x="7230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-74" x="7675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-69" x="8064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6F" x="8343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-6E" x="8843" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>A</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>Q</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>−</mo><msup><mi>V</mi><mi>π</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mtext>&nbsp;- Advantage function</mtext></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-43">A^\pi(s, a)=Q^\pi(s, a)-V^\pi(s)\text{ - Advantage function}</script></p><p> ,     .    ,    Advantage-   Value-.</p><br>
<p> <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>&amp;#x03B4;</mi><mi>t</mi><mi>V</mi></msubsup><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.33ex" height="3.009ex" viewBox="0 -916.9 11336.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="641" y="510"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="628" y="-395"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="1375" y="0"></use><g transform="translate(2431,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="3461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="4461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5231" y="0"></use><g transform="translate(5620,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="7962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="8962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="9732" y="0"></use><g transform="translate(10121,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="10946" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>t</mi><mi>V</mi></msubsup><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">\delta_t^V = r_t+V(s_{t+1})-V(s_t)</script> — Temporal Difference residual (<b>TD-residual</b>).   ,     Advantage:</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mo>&amp;#x2061;</mo><mrow><mo>[</mo><msubsup><mi>&amp;#x03B4;</mi><mi>t</mi><mi>V</mi></msubsup><mo>]</mo></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow><mo>=</mo><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow></mrow><mo>&amp;#x2061;</mo><mrow><mo>[</mo><mrow><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow><mo>=</mo><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.27ex" height="3.134ex" viewBox="0 -916.9 28963.4 1349.5" role="img" focusable="false" style="vertical-align: -1.005ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="0" y="0"></use><g transform="translate(667,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ1-5B"></use><g transform="translate(417,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="641" y="510"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="628" y="-395"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ1-5D" x="1515" y="-1"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="2878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="3934" y="0"></use><g transform="translate(4601,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="2030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="2799" y="0"></use><g transform="translate(3189,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="4918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="5530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="6531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="7300" y="0"></use><g transform="translate(7690,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="8515" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5D" x="9183" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="14341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-45" x="15397" y="0"></use><g transform="translate(16065,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="791" y="0"></use><g transform="translate(1181,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="2006" y="0"></use><g transform="translate(2451,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="3336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="3948" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="4948" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5718" y="0"></use><g transform="translate(6107,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="6932" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-5D" x="7600" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="24222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="25278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="26029" y="0"></use><g transform="translate(26418,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="27243" y="0"></use><g transform="translate(27688,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="28573" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mo>⁡</mo><mrow><mo>[</mo><msubsup><mi>δ</mi><mi>t</mi><mi>V</mi></msubsup><mo>]</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mo>⁡</mo><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">E</mi></mrow></mrow><mo>⁡</mo><mrow><mo>[</mo><mrow><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><mo>]</mo></mrow><mo>=</mo><mi>A</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-45">\E\left[\delta^V_t\right] = \E\left[r_t+V(s_{t+1})-V(s_t)\right] = \E\left[Q(s_t, a_t)-V(s_t)\right]=A(s_t, a_t)</script></p><p>          .    Value-      policy  Advantage.</p><br>
<p>   <b>Advantage Actor-Critic</b>.</p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">estimate_advantage</span>(<span class="hljs-params">states, rewards</span>):</span><font></font>
    values = sess.run(critic.value_op, feed_dict={critic.state_ph: states})<font></font>
    deltas = rewards - values<font></font>
    deltas = deltas + np.append(values[<span class="hljs-number">1</span>:], np.array([<span class="hljs-number">0</span>]))<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> deltas, values
</code></pre><br>
<p>          :</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/GCbPl3dOLmQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3>Generalized Advantage Estimation</h3><br>
<p>    (2018) "<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">High-dimensional continuous control using generalized advantage estamation</a>"      Advantage  Value-.   variance  :</p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>A</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>G</mi><mi>A</mi><mi>E</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mo>,</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msubsup><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow><mi>V</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.573ex" height="6.884ex" viewBox="0 -1670.4 10579.9 2964.1" role="img" focusable="false" style="vertical-align: -3.005ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="0" y="0"></use><g transform="translate(750,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-41" x="786" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-45" x="1537" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="2301" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B3" x="2691" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2C" x="3234" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3BB" x="3513" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="4096" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="1061" y="-395"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="4300" y="0"></use><g transform="translate(5356,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJSZ2-2211" x="0" y="0"></use><g transform="translate(164,-1110)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="298" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1077" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-221E" x="521" y="1627"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="6801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B3" x="7190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3BB" x="7734" y="0"></use><g transform="translate(8317,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="550" y="583"></use></g><g transform="translate(9018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="641" y="510"></use><g transform="translate(444,-328)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-6C" x="1140" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msubsup><mi>A</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>G</mi><mi>A</mi><mi>E</mi><mo stretchy="false">(</mo><mi>γ</mi><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></munderover><mo stretchy="false">(</mo><mi>γ</mi><mi>λ</mi><msup><mo stretchy="false">)</mo><mi>l</mi></msup><msubsup><mi>δ</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mi>l</mi></mrow><mi>V</mi></msubsup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-46">A_t^{GAE(\gamma,\lambda)} = \sum_{l=0}^\infty (\gamma\lambda)^l\delta^V_{t+l}</script></p><p>:</p><br>
<ul>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>&amp;#x03B4;</mi><mi>t</mi><mi>V</mi></msubsup><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.33ex" height="3.009ex" viewBox="0 -916.9 11336.5 1295.7" role="img" focusable="false" style="vertical-align: -0.88ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B4" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="641" y="510"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="628" y="-395"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3D" x="1375" y="0"></use><g transform="translate(2431,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="3461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="4461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="5231" y="0"></use><g transform="translate(5620,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2B" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="7350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2212" x="7962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-56" x="8962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-28" x="9732" y="0"></use><g transform="translate(10121,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-29" x="10946" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>δ</mi><mi>t</mi><mi>V</mi></msubsup><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-47">\delta_t^V = r_t+V(s_{t+1})-V(s_t)</script> — TD-residual,</li>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.009ex" viewBox="0 -540.2 543.5 865.1" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3B3" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">\gamma</script> — discount- (),</li>
<li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BB;</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.009ex" viewBox="0 -755.5 583.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3BB" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>λ</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">\lambda</script> — .</li>
</ul><br>
<p>     .</p><br>
<p>:</p><br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">discount_cumsum</span>(<span class="hljs-params">x, coef</span>):</span>
    <span class="hljs-comment"># Source: </span>
    <span class="hljs-comment"># https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py</span>
    <span class="hljs-string">"""
    magic from rllab for computing discounted cumulative sums of vectors.
    input: 
        vector x, 
        [x0, 
         x1, 
         x2]
    output:
        [x0 + discount * x1 + discount^2 * x2,  
         x1 + discount * x2,
         x2]
    """</span>
    <span class="hljs-keyword">return</span> scipy.signal.lfilter([<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, float(-coef)], x[::<span class="hljs-number">-1</span>], axis=<span class="hljs-number">0</span>)[::<span class="hljs-number">-1</span>]<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">estimate_advantage</span>(<span class="hljs-params">states, rewards</span>):</span><font></font>
    values = sess.run(critic.value_op, feed_dict={critic.state_ph: states})<font></font>
    deltas = rewards - values<font></font>
    deltas = deltas + discount_factor * np.append(values[<span class="hljs-number">1</span>:], np.array([<span class="hljs-number">0</span>]))<font></font>
    <font></font>
    advantage = discount_cumsum(deltas, coef=lambda_factor * discount_factor)<font></font>
    <span class="hljs-keyword">return</span> advantage, values
</code></pre><br>
<p>          .       ,   :</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3f4rRbqnuxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p>       ,     .   ,    ,   —    :</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/O5aJoj16ZDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p> ,      .   ,        .          ,    :</p><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xT9KKnpxxo8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="pitfalls"></a><h2> </h2><br>
<p>     ,   ,      .  RL      .</p><br>
<img src="https://habrastorage.org/webt/rq/w0/fl/rqw0flwtyhb3getoyjwyraaf7na.png"><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><i></i></a></p><br>
<p>   ,      .</p><br>
<ol>
<li>    .        learning rate  3e-4  1e-4.     —       ,    .</li>
<li>    ,     DL.   image classification       32-256        ,      ,     3000.        .</li>
<li>    ,   random seed  .</li>
<li>        ,     . ,    8 , 3       .             gym.<img src="https://habrastorage.org/webt/ol/ml/yx/olmlyxvpvt8lroty8kllva2igz4.png"></li>
<li>                . (  )</li>
</ol><br>
<p>   Deep RL     : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Deep Reinforcement Learning Doesn't Work Yet</a>.</p><br>
<a name="conclusion"></a><h2></h2><br>
<p>     .   <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>:</mo><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>800</mn></mrow></msup><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><msup><mrow class=&quot;MJX-TeXAtom-OP&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>18</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.814ex" height="2.509ex" viewBox="0 -970.7 6378.1 1080.4" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMATHI-3C0" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-3A" x="851" y="0"></use><g transform="translate(1407,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><g transform="translate(722,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-38"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-30" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-2192" x="3569" y="0"></use><g transform="translate(4847,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJAMS-52" x="0" y="0"></use><g transform="translate(722,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=https://habr.com/ru/post/483078/&amp;usg=ALkJrhhlloH6unOh32qOBfh50zp2wXJmxg#MJMAIN-38" x="500" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo>:</mo><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mn>800</mn></mrow></msup><mo stretchy="false">→</mo><msup><mrow class="MJX-TeXAtom-OP"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow></mrow><mrow class="MJX-TeXAtom-ORD"><mn>18</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-50">\pi:\R^{800}\to\R^{18}</script>,     .</p><br>
<p>      A2C,  PPO  TRPO.   <b>sample efficiency</b>, ..   ,      .  PPO + Automatic Domain Randomization  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">    </a>.</p><br>
<p>     : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"></a>.</p><br>
<p>,       ,     Deep Reinforcement Learning.</p><br>
<p><b>  !</b></p><br>
<h2> :</h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Welcome to Spinning Up in Deep RL!</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS 294：深層強化学習、2017年秋</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS 285：深層強化学習、意思決定、および制御</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般化された利点推定を使用した高次元の連続制御</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAIベースライン：強化学習アルゴリズムの高品質な実装</font></font></a></li>
</ul><br>
<p><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">感謝 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pinkotter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヴァンバラ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">andrey_probochkin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pollyfom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suriknik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトの支援のため。</font></font></i><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヴァンバラ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> そして </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">andrey_probochkin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> クールなMuJoCo環境を作成するため。</font></font></i></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja483058/index.html">休日調査結果</a></li>
<li><a href="../ja483064/index.html">すべてのカノンで最小の別名小さなブログのVue</a></li>
<li><a href="../ja483066/index.html">ビル・ゲイツの伝統的な5冊の本</a></li>
<li><a href="../ja483068/index.html">人気のアンチチートBattlEyeのリバースエンジニアリング</a></li>
<li><a href="../ja483074/index.html">TensorRT 6.xxx-ディープラーニングモデルの高性能推論（オブジェクト検出とセグメンテーション）</a></li>
<li><a href="../ja483082/index.html">脆弱性ハンティングは7％効果的</a></li>
<li><a href="../ja483084/index.html">トラッキング機能付きカメラ</a></li>
<li><a href="../ja483086/index.html">2019年の結果：ロシアの投資家にとって最も収益性の高い資産はどれか</a></li>
<li><a href="../ja483094/index.html">マイクロソフトのロシアのオフィスを訪問したとき、どのようにして私の夢を実現しましたか</a></li>
<li><a href="../ja483104/index.html">2つの機能：Neolineレーダー検出器を備えたDVR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>