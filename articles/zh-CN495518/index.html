<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍑 🙏🏾 ㊙️ 响应表单开发。实践中的KISS，YAGNI，DRY原则 👝 🦀 🎅🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="您好，在本教程中，我们将研究如何在React中开发一个非常简单但可控制的表单，重点是代码的质量。
 
 在开发表格时，我们将遵循“ KISS”，“ YAGNI”，“ DRY”的原则。要成功完成本教程，您不需要了解这些原理，我将在此过程中进行解释。但是，我相信您对现代javascript有很好的掌握，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>响应表单开发。实践中的KISS，YAGNI，DRY原则</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495518/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您好，在本教程中，我们将研究如何在React中开发一个非常简单但可控制的表单，重点是代码的质量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在开发表格时，我们将遵循“ KISS”，“ YAGNI”，“ DRY”的原则。</font><font style="vertical-align: inherit;">要成功完成本教程，您不需要了解这些原理，我将在此过程中进行解释。</font><font style="vertical-align: inherit;">但是，我相信您对现代javascript有很好的掌握，并且可以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在React中考虑</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><a name="habracut"></a> <br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教程结构：</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了事业！</font><font style="vertical-align: inherit;">使用KISS和YAGNI编写简单的表格</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重构和干</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有什么可以做的？</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不好了！</font><font style="vertical-align: inherit;">请不要这样做！</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现</font></font></a></li>
</ul><br>
<br>
<hr><br>
<a name="react-form-with-kiss-and-yagni"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了事业！</font><font style="vertical-align: inherit;">使用KISS和YAGNI编写简单的表格</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，让我们假设我们有一个任务来实现授权表单：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> logInData = {
  <span class="hljs-attr">nickname</span>: <span class="hljs-string">'Vasya'</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'pupkin@gmail.com'</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'Reac5$$$'</span>,<font></font>
};<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/um/1u/vm/um1uvmjncpnlgaabmaui6rscw0s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们通过分析KISS和YAGNI的原理开始我们的开发，暂时忘记了其余的原理。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
吻-“让代码简单明了。”我认为您熟悉简单代码的概念。但是“哑”代码是什么意思？以我的理解，这是使用最少数目的抽象来解决问题的代码，而这些抽象之间的嵌套也很少。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
YAGNI-“您将不需要它。”该代码应该只能执行其编写的内容。我们不会创建以后可能需要的任何功能，也不会创建使我们认为更好的应用程序。我们仅执行任务执行所需的特定工作。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们严格遵循以下原则，但还要考虑：</font></font><br>
<br>
<ul>
<li><code>initialData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>onSubmit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于</font></font><code>LogInForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自顶部（这是一种有用的技术，尤其是当形式应该能够处理</font></font><code>create</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>update</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在同一时间）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个领域都必须有 </font></font><code>label</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另外，让我们错过样式化，因为它对我们而言并不有趣且有效，因为这是单独教程的主题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
请按照上述原则自行实施表格。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我的表格执行</font></font></b><div class="spoiler_text"> <div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text"> <pre><code class="javascript hljs"><span class="hljs-keyword">const</span> LogInForm = <span class="hljs-function">(<span class="hljs-params">{ initialData, onSubmit }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [logInData, setLogInData] = useState(initialData);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
    e.preventDefault();<font></font>
    onSubmit(logInData);<font></font>
  };<font></font>
<font></font>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
        Enter your nickname
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.nickname}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, nickname: e.target.value })}
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
        Enter your email
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, email: e.target.value })}
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
        Enter your password
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, password: e.target.value })}
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
  );<font></font>
};<font></font>
    </code></pre><br>
 </div></div><br>
 <img src="https://habrastorage.org/webt/kv/i6/l0/kvi6l0hduiubopcittxuxczjqby.png"><br>
</div></div><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您的决定很可能会有所不同，因为每个开发人员的想法都不相同。</font><font style="vertical-align: inherit;">您可以为每个字段创建自己的状态，或将处理程序函数放在单独的变量中，无论如何这都不重要。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果立即为所有字段创建了一个处理函数，那么这将不再是解决该问题的“最笨拙”的方法。</font><font style="vertical-align: inherit;">我们现阶段的目标是创建最简单，最“笨”的代码，以便以后我们可以查看整个图片并选择最佳的抽象。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您使用的代码完全相同，那么这很酷，这意味着我们的想法会融合！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此外，我们将使用此代码。</font><font style="vertical-align: inherit;">这很简单，但仍远非理想。</font></font><br>
<br>
<hr><br>
<a name="refactoring-and-dry"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重构和干</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在是应对DRY原则的时候了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DRY，简化的措词-“请勿重复您的代码。” </font><font style="vertical-align: inherit;">该原理看起来很简单，但是有一个陷阱：要摆脱代码重复，您需要创建抽象。</font><font style="vertical-align: inherit;">如果这些抽象不够好，我们将违反KISS原则。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同样重要的是要了解不需要DRY即可更快地编写代码。</font><font style="vertical-align: inherit;">它的任务是简化对我们解决方案的阅读和支持。</font><font style="vertical-align: inherit;">因此，不要急于立即创建抽象。</font><font style="vertical-align: inherit;">最好对代码的某些部分进行简单的实现，然后分析您需要创建哪些抽象，以简化代码的读取并减少需要更改的地方的数量。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正确抽象的清单：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抽象的名称与其目的完全一致</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抽象执行特定的，可理解的任务</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取从中提取了抽象的代码得到了改进</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，让我们开始重构。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而且我们已经声明了重复的代码：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  &lt;label&gt;<font></font>
    Enter your email<font></font>
    &lt;input<font></font>
      type=<span class="hljs-string">"email"</span><font></font>
      value={logInData.email}<font></font>
      onChange={e =&gt; setLogInData({ ...logInData, <span class="hljs-attr">email</span>: e.target.value })}<font></font>
    /&gt;<font></font>
  &lt;/label&gt;<font></font>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
    Enter your password
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, password: e.target.value })}
    /&gt;
  <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/sl/u5/1t/slu51tnyjsk5ki1kowgso6qx5mk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此代码复制了2个元素的组成：</font></font><code>label</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、、</font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">让我们将它们合并为一个新的抽象</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  &lt;label&gt;<font></font>
    Enter your email<font></font>
    &lt;input<font></font>
      type=<span class="hljs-string">"email"</span><font></font>
      value={logInData.email}<font></font>
      onChange={e =&gt; setLogInData({ ...logInData, <span class="hljs-attr">email</span>: e.target.value })}<font></font>
    /&gt;<font></font>
  &lt;/label&gt;<font></font>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
    Enter your password
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, password: e.target.value })}
    /&gt;
  <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/ff/wi/j5/ffwij5ors822a6fu8n7_ciuwe3w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我们的</font></font><code>LogInForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">看起来像这样：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> LogInForm = <span class="hljs-function">(<span class="hljs-params">{ initialData, onSubmit }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [logInData, setLogInData] = useState(initialData);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
    e.preventDefault();<font></font>
    onSubmit(logInData);<font></font>
  };<font></font>
<font></font>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your nickname"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.nickname}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, nickname: e.target.value })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, email: e.target.value })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setLogInData({ ...logInData, password: e.target.value })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
  );<font></font>
};<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/ns/ah/yi/nsahyidxew9tz3tqub5mcz09184.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
阅读变得更加容易。</font><font style="vertical-align: inherit;">抽象的名称与它要解决的任务相对应。</font><font style="vertical-align: inherit;">该组件的目的很明显。</font><font style="vertical-align: inherit;">代码变得更少了。</font><font style="vertical-align: inherit;">因此，我们正朝着正确的方向前进！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在很明显，</font></font><code>InputField.onChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">逻辑是重复的。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
那里发生的事情可以分为两个阶段：</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> stage1 = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.target.value;
<span class="hljs-keyword">const</span> stage2 = <span class="hljs-function"><span class="hljs-params">password</span> =&gt;</span> setLogInData({ ...logInData, password });
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/n-/_o/dq/n-_odqnut4_5zg9-48xvusajjlg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第一个功能描述了从事件获取值的详细信息</font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我们可以选择2种抽象来存储此逻辑：</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code>LogInForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了正确地确定我们需要引用我们的代码的抽象，我们必须转向DRY原理的完整表述：“知识的每个部分在系统中都应具有唯一，一致和权威的表示形式。” </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
具体示例中的部分知识是知道如何从中的事件获取价值</font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。如果我们将这些知识存储在我们的知识中</font></font><code>LogInForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么很明显，在使用我们的</font><font style="vertical-align: inherit;">知识</font><font style="vertical-align: inherit;">时</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在另一种形式中，我们将不得不复制我们的知识，或者将其转化为单独的抽象并从那里使用它。</font><font style="vertical-align: inherit;">并且基于KISS原则，我们应该具有尽可能少的抽象数。</font><font style="vertical-align: inherit;">的确，如果我们只需将这种逻辑放入我们的逻辑中</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而外部代码将不了解输入内部的工作方式</font><font style="vertical-align: inherit;">，那么为什么需要创建另一个抽象</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它只是具有现成的含义，就像它向内传递一样。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果您对将来可能需要举办的活动感到困惑，请记住YAGNI原则。</font><font style="vertical-align: inherit;">您可以随时</font></font><code>onChangeEvent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向我们的组件</font><font style="vertical-align: inherit;">添加一个额外的道具</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此之前，</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它将看起来像这样：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> InputField = <span class="hljs-function">(<span class="hljs-params">{ label, type, value, onChange }</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
    {label}
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> onChange(e.target.value)}
    /&gt;
  <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><font></font>
);<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/cz/bc/bg/czbcbgp-xlbirtjno8_5enjc9lk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，在向组件输入和输出期间观察到类型的一致性，并且隐藏了外部代码所发生事件的真实本质。</font><font style="vertical-align: inherit;">如果将来我们需要另一个ui组件，例如checkbox或select，那么在其中我们还将保持输入输出的类型统一性。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这种方法为我们提供了更大的灵活性，因为我们的表单可以与任何输入输出源一起使用，而无需为每个输入源生成其他唯一的处理程序。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
默认情况下，许多框架中都内置了这种启发式技巧。</font><font style="vertical-align: inherit;">例如，这是</font><font style="vertical-align: inherit;">许多人都喜欢</font><font style="vertical-align: inherit;">的主要思想</font></font><code>v-model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>Vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因为它易于使用表单。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们回到业务上，</font></font><code>LogInForm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据中的更改</font><font style="vertical-align: inherit;">更新我们的组件</font></font><code>InputField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> LogInForm = <span class="hljs-function">(<span class="hljs-params">{ initialData, onSubmit }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [logInData, setLogInData] = useState(initialData);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
    e.preventDefault();<font></font>
    onSubmit(logInData);<font></font>
  };<font></font>
<font></font>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your nickname"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.nickname}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{nickname</span> =&gt;</span> setLogInData({ ...logInData, nickname })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{email</span> =&gt;</span> setLogInData({ ...logInData, email })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{password</span> =&gt;</span> setLogInData({ ...logInData, password })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
  );<font></font>
};<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/6b/cq/wb/6bcqwbfusg_fmw1pqbc8yxhxlsy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它看起来已经不错，但我们可以做得更好！</font></font><br>
<br>
<code>Callback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">传入的</font></font><code>onChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总是做相同的事情。</font><font style="vertical-align: inherit;">其中只有密钥被更改：密码，电子邮件，昵称。</font><font style="vertical-align: inherit;">因此，我们可以将其替换为对函数的调用：</font></font><code>handleChange('password')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们实现这个功能：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-function"><span class="hljs-params">fieldName</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldValue</span> =&gt;</span> {<font></font>
    setLogInData({<font></font>
      ...logInData,<font></font>
      [fieldName]: fieldValue,<font></font>
    });<font></font>
  };<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/z7/po/o5/z7poo5vlkkdxtc939hzlt1gendk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，该函数接收参数并将其存储在处理程序的闭包中，处理程序立即返回到外部代码。</font><font style="vertical-align: inherit;">似乎一次调用一个参数的函数也称为curried。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们看一下结果代码：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> LogInForm = <span class="hljs-function">(<span class="hljs-params">{ initialData, onSubmit }</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> [logInData, setLogInData] = useState(initialData);<font></font>
  <font></font>
    <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
      e.preventDefault();<font></font>
      onSubmit(logInData);<font></font>
    };<font></font>
  <font></font>
    <span class="hljs-keyword">const</span> handleChange = <span class="hljs-function"><span class="hljs-params">fieldName</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldValue</span> =&gt;</span> {<font></font>
      setLogInData({<font></font>
        ...logInData,<font></font>
        [fieldName]: fieldValue,<font></font>
      });<font></font>
    };<font></font>
  <font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your nickname"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.nickname}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">nickname</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">email</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">password</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
    );<font></font>
  };<font></font>
  <font></font>
  <span class="hljs-comment">// InputField.js</span>
  <span class="hljs-keyword">const</span> InputField = <span class="hljs-function">(<span class="hljs-params">{ type, label, value, onChange }</span>) =&gt;</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
      {label}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> onChange(e.target.value)} /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><font></font>
  );<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/bm/nu/td/bmnutdzasqokociudliqjyhli_k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该代码是任务的简短，简洁和适度的声明式实现。</font><font style="vertical-align: inherit;">我认为，在任务中进行进一步的重构是没有意义的。</font></font><br>
<br>
<hr><br>
<a name="what-else-can-we-do"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有什么可以做的？</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果项目中有很多表单，则可以将handleChange计算放在单独的钩子中</font></font><code>useFieldChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-comment">// hooks/useFieldChange.js</span>
  <span class="hljs-keyword">const</span> useFieldChange = <span class="hljs-function"><span class="hljs-params">setState</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldName</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldValue</span> =&gt;</span> {<font></font>
    setState(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> ({<font></font>
      ...state,<font></font>
      [fieldName]: fieldValue,<font></font>
    }));<font></font>
  };<font></font>
  <span class="hljs-comment">// LogInForm.js</span>
  <span class="hljs-keyword">const</span> handleChange = useFieldChange(setLogInData);
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/eb/b8/eg/ebb8egvqobm-n27dn3tsuflcvly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于这是一个纯函数（意味着第一次调用它，因为它总是返回相同的函数），因此它不必是一个钩子。</font><font style="vertical-align: inherit;">但是从概念上讲，该挂钩看起来是React的更正确，更自然的解决方案。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
您还可以添加</font></font><code>callback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就地</font><font style="vertical-align: inherit;">支持</font></font><code>fieldValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全复制通常行为</font></font><code>setState</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code>React</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> isFunc = <span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">"function"</span>;<font></font>
<font></font>
  <span class="hljs-keyword">const</span> useFieldChange = <span class="hljs-function"><span class="hljs-params">setState</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldName</span> =&gt;</span> <span class="hljs-function"><span class="hljs-params">fieldValue</span> =&gt;</span> {<font></font>
    setState(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> ({<font></font>
      ...state,<font></font>
      [fieldName]: isFunc(fieldValue) ? fieldValue(state[fieldName]) : fieldValue,<font></font>
    }));<font></font>
  };<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/fz/t5/pd/fzt5pdldmj5gdy7duoycglqqrfe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与我们的表单一起使用的示例：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> LogInForm = <span class="hljs-function">(<span class="hljs-params">{ initialData, onSubmit }</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> [logInData, setLogInData] = useState(initialData);
    <span class="hljs-keyword">const</span> handleChange = useFieldChange(setLogInData);<font></font>
  <font></font>
    <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {<font></font>
      e.preventDefault();<font></font>
      onSubmit(logInData);<font></font>
    };<font></font>
  <font></font>
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your nickname"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.nickname}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">nickname</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">email</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{logInData.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">password</span>')}
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
    );<font></font>
  };<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/os/zb/ua/oszbuaygonezp9c2epw4st-msqy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，如果您的应用程序只有一种形式，则无需执行所有这些操作！</font><font style="vertical-align: inherit;">因为它与YAGNI原则相矛盾，因此我们不应该执行解决特定问题所需的操作。</font><font style="vertical-align: inherit;">如果您只有一种形式，那么这种运动的真正好处是不够的。</font><font style="vertical-align: inherit;">毕竟，我们仅将组件的代码减少了三行，但是引入了一个额外的抽象，隐藏了某种形式的逻辑，最好保留在表面上。</font></font><br>
<br>
<hr><br>
<a name="do-not-do-that-please"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不好了！</font><font style="vertical-align: inherit;">请不要这样做！</font></font></h2><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异型配置表单</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
锁定的配置类似于webpack的配置，仅用于表单。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最好举个例子，看下面的代码：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> Form = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your nickname"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{state.nickname}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">nickname</span>')}
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{state.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">email</span>')}
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Enter your password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{state.password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(</span>'<span class="hljs-attr">password</span>')}
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
  );<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/0t/ro/cn/0trocndcco4vp8yld7cl6qfc0pa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
似乎有些代码在这里重复了，因为我们调用了相同的InputField组件，并在其中传递了相同的标签，值和onChange参数。</font><font style="vertical-align: inherit;">并且他们开始将自己的代码干燥-yav，以避免虚构的重复。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他们经常这样做：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword">const</span> fields = [<font></font>
  {<font></font>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'nickname'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'Enter your nickname'</span>,<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">'email'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'email'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'Enter your email'</span>,<font></font>
  },<font></font>
  {<font></font>
    <span class="hljs-attr">type</span>: <span class="hljs-string">'password'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'password'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'Enter your password'</span>,<font></font>
  },<font></font>
];<font></font>
<font></font>
<span class="hljs-keyword">const</span> Form = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
    {fields.map(({ type, name, label }) =&gt; (
      <span class="hljs-tag">&lt;<span class="hljs-name">InputField</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">{label}</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{state[name]}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange(name)}</span>
      /&gt;</span>
    ))}
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span><font></font>
);<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/qi/f4/b4/qif4b4hwl1wjsinh3d7pi5xtv74.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，使用17行jsx代码，我们获得16行配置。</font><font style="vertical-align: inherit;">太棒了！</font><font style="vertical-align: inherit;">这就是我对DRY的了解。</font><font style="vertical-align: inherit;">如果这里有100个输入，则分别得到605和506行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，结果，我们得到了更复杂的代码，违反了KISS原则。</font><font style="vertical-align: inherit;">确实，现在它包含2个抽象：字段和算法（是的，算法也是抽象），将其转变为反应元素树。</font><font style="vertical-align: inherit;">阅读此代码时，我们将不得不在这些抽象之间不断跳转。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是此代码的最大问题是它的支持和扩展。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
想象一下，如果发生以下情况，他会怎么做：</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将添加更多具有不同可能属性的字段类型</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段是否根据其他字段的输入进行渲染</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改时某些字段需要一些其他处理</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择中的值取决于先前的选择</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
此列表可以持续很长时间... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要实现此目的，您将始终必须在配置中存储一些功能，并且呈现配置的代码将逐渐变成科学怪人，需要使用许多不同的道具并将它们扔到不同的组件上。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据组件的组成，之前编写的代码将根据您的需要悄悄地扩展，更改，而不会由于缺乏中间抽象而变得非常复杂-一种从我们的配置中构建React元素树的算法。</font><font style="vertical-align: inherit;">此代码不是重复的。</font><font style="vertical-align: inherit;">它只是遵循某种设计模式，因此看起来是“有图案的”。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无用的优化</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在React中出现钩子之后，有一种将所有处理程序和组件随意包装在</font></font><code>useCallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和中的趋势</font></font><code>memo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">请不要那样做！</font><font style="vertical-align: inherit;">这些钩子不是由React开发人员提供的，因为React速度很慢，所有东西都需要优化。</font><font style="vertical-align: inherit;">它们为您在遇到性能问题时优化应用程序提供了空间。</font><font style="vertical-align: inherit;">即使遇到此类问题，也无需将整个项目包装在</font></font><code>memo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和中</font></font><code>useCallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profiler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">识别问题，然后在正确的位置进行记录。</font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记忆总是会使您的代码更复杂，但并不总是能提高效率。</font></font></u><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们来看一个真实项目中的代码。</font><font style="vertical-align: inherit;">比较带有</font></font><code>useCallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和不</font><font style="vertical-align: inherit;">带有该函数的外观</font><font style="vertical-align: inherit;">：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  <span class="hljs-keyword">const</span> applyFilters = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newSelectedMetrics = <span class="hljs-built_in">Object</span>.keys(selectedMetricsStatus).filter(
      <span class="hljs-function"><span class="hljs-params">metric</span> =&gt;</span> selectedMetricsStatus[metric],<font></font>
    );<font></font>
    onApplyFilterClick(newSelectedMetrics);<font></font>
  }, [selectedMetricsStatus, onApplyFilterClick]);<font></font>
<font></font>
  <span class="hljs-keyword">const</span> applyFilters = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newSelectedMetrics = <span class="hljs-built_in">Object</span>.keys(selectedMetricsStatus).filter(
      <span class="hljs-function"><span class="hljs-params">metric</span> =&gt;</span> selectedMetricsStatus[metric],<font></font>
    );<font></font>
    onApplyFilterClick(newSelectedMetrics);<font></font>
  };<font></font>
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/nh/iq/r1/nhiqr1y0yajlgo101b-dytdcq0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
删除包装后，代码的可读性明显提高，因为理想的代码是缺少代码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该代码的性能并未提高，因为该函数的用法如下：</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制代码</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs">  &lt;RightFooterButton onClick={applyFilters}&gt;APPLY&lt;/RightFooterButton&gt;
</code></pre></div></div><br>
<img src="https://habrastorage.org/webt/wb/-7/a3/wb-7a33k1c2cjctumjl9wqi7ztu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
位置</font></font><code>RightFooterButton</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-仅</font></font><code>styled.button</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自</font></font><code>styled-components</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，它将很快更新。</font><font style="vertical-align: inherit;">但是内存消耗增加了我们的应用程序，因为React将始终保留在内存中</font></font><code>selectedMetricsStatus</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>onApplyFilterClick</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且函数的版本与</font></font><code>applyFilters</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这些依赖项相关。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如果这些参数对您来说还不够，请阅读</font><font style="vertical-align: inherit;">讨论该主题</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<hr><br>
<a name="conclusions"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发现</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反应形式很容易。</font><font style="vertical-align: inherit;">由于开发人员本身和React文档的缘故，它们出现了问题，在该主题中没有足够详细地公开此主题。</font></font><br>
 </li>
<li>           aka value  onChange  .      useFieldChange,  ,     ,      <code>v-model</code>  <code>Vue</code>   .<br>
 </li>
<li>         KISS  YAGNI.    DRY,  ,      .</li>
<li>       ,         ,        React-    .<br>
 </li>
<li>  ,      .</li>
</ul><br>
<br>
<hr><br>
<h3>P.S.</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初，我计划撰写有关复杂嵌套表单的声明式验证的文章。</font><font style="vertical-align: inherit;">但是，最后，我决定让观众为此做好准备，以便使图片尽可能完整。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下教程将关于验证本教程中实现的简单表单。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
非常感谢阅读到底的每个人！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不论您如何编写代码或做什么都无关紧要，主要是享受它。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN495500/index.html">Alexey Klyanin：“直到2018年，我仅将OSM用作博客的基础”</a></li>
<li><a href="../zh-CN495504/index.html">金士顿KC600 512GB：固体火箭</a></li>
<li><a href="../zh-CN495508/index.html">浏览器需要语音吗？</a></li>
<li><a href="../zh-CN495512/index.html">加热披萨的最佳方法是什么？</a></li>
<li><a href="../zh-CN495516/index.html">对于Kotlin，Visitor模板已弃用，但值得一提</a></li>
<li><a href="../zh-CN495520/index.html">建筑师清单</a></li>
<li><a href="../zh-CN495524/index.html">学习哪种编程语言，以便HR大公司为您服务</a></li>
<li><a href="../zh-CN495526/index.html">通过Fortinet进行远程访问的组织</a></li>
<li><a href="../zh-CN495530/index.html">硬件转换器HDMI-RGB（18/24位）</a></li>
<li><a href="../zh-CN495532/index.html">大型IT公司如何将其员工转移到远程工作</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>