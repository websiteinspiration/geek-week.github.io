<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹️ 👼🏾 🤽🏽 CI TeamCity - Automatisierung von Build-Prozessen für Android- und UI-Tests 💅🏽 👨🏻‍🚀 ⛺️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel mache ich Sie auf Anweisungen zur Installation und Konfiguration von TeamCity aufmerksam, um das Zusammenstellen und Testen von Andr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CI TeamCity - Automatisierung von Build-Prozessen für Android- und UI-Tests</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502436/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Artikel mache ich Sie auf Anweisungen zur Installation und Konfiguration von TeamCity aufmerksam, um das Zusammenstellen und Testen von Android-Projekten unter Windows zu automatisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde auch auf die Funktionen zum Einrichten der Umgebung für das Android-Projekt (die ich im Forschungsprozess gefunden habe) und auf verschiedene Dinge achten, die dem unerfahrenen Tester und Entwickler das Leben erleichtern können.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziele:</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Aktualisieren des Projektcodes sollte Folgendes auftreten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projekt automatisch erstellen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Führen Sie UI-Autotests aus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exportieren von Debug- und Release-APK-Dateien für nachfolgende manuelle Tests</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benachrichtigen Sie alle Mitglieder des Entwicklungsteams über die Ergebnisse</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Planen:</font></font></h4><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und konfigurieren Sie das Java JDK</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und konfigurieren Sie das Android SDK</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Festlegen eines separaten Gradles für das Debuggen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorbereiten eines Android-Projekts</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren Sie TeamCity Server und Build Agent</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einrichten von TeamCity Project → Build für die Projekterstellung und Abrufen der Installations-APK</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren Sie Build-Schritte mit UI-Autotests</font></font></li>
</ol><a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hauptteil </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und Konfigurieren von Java JDK</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Entgegen der weit verbreiteten Meinung, die neueste Version von Java zu installieren, veröffentlicht JetBrains auf seiner offiziellen Website die empfohlene Version des Java SDK: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Installiert die empfohlene Version: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Installiert auch Umgebungsvariablen:</font></font><br>
<br>
<ul>
<li><code>JAVA_HOME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Pfad zum Ordner mit SKD Java für die Verwendung von CI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>C:\Java\jdk1.8.0_181</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Besser Systemvariablen eingeben.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pfad - Pfad zum Ordner mit Java SKD zur Verwendung über die Befehlszeile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>C:\Java\jdk1.8.0_181\bin</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Besser Benutzervariablen eingeben.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir überprüfen die Installation: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der CMD in einem beliebigen Verzeichnis, das wir eingeben: </font></font><code> java -version </code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Java sollte antworten, dass es sich um </font><b><font style="vertical-align: inherit;">Folgendes</font></b><font style="vertical-align: inherit;"> handelt: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jr/sr/6f/jrsr6flrr8_x5nphn3pyeh4spwk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren und Konfigurieren des Android SDK</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Wir werden die Android SDK-Tools nicht separat installieren. Android hat verboten, Projekte über die Befehlszeile zu erstellen. Es ist auch bequemer, mögliche Fehler zu debuggen, wenn wir Android Studio sofort installieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installieren Sie die neueste Version: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">link</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Installieren Sie auch Umgebungsvariablen: </font></font><br>
<br>
<code>ANDROID_HOME</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><code>C:\Users\1\AppData\Local\Android\Sdk</code><br>
<br>
<code>ANDROID_AVD_HOME</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><code>C:\Users\1\.android\avd</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pfad: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><code>C:\Users\1\AppData\Local\Android\Sdk\platform-tools\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Starten Sie die Dienstprogramme von uns und CI über die Konsole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Überprüfen Sie: Geben </font></font><code>adb --help</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie </font><font style="vertical-align: inherit;">CMD ein: </font><font style="vertical-align: inherit;">Informationen zur aktuellen Version und den verfügbaren Befehlen abrufen: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dh/ax/nl/dhaxnlpo3zycmxk39upb7vdmht4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pfad: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel:</font></font><code> C:\Users\1\AppData\Local\Android\Sdk\emulator\</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Starten Sie den Emulator von uns und CI aus über die Konsole. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Überprüfen Sie: Wir geben CMD ein. </font></font><code>emulator -version</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten Informationen zur aktuellen Version: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qn/dn/jt/qndnjtqddivhsoab-x4thjvng1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gradle-Installation Gradle</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ist in Android Studio enthalten, aber wir werden ein weiteres für das Debug von der Konsole aus einfügen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Version ist nicht wichtig, weil Es wird davon ausgegangen, dass das Projekt über den Gradle-Wrapper gestartet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich schlage vor, eine ähnliche Version wie im Projekt zu installieren, z. B. Gradle 3.3. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir installieren auch Umgebungsvariablen: </font></font><br>
<br>
<code>GRADLE_HOME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Es besteht keine Notwendigkeit, weil CI wird Gradle Android Studio verwenden. </font></font><br>
<br>
<code>GRADLE_USER_HOME</code> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><code>c:/gradle-cache</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsächlich für Windows Server, as Ohne sie werden während der Montage des Projekts alle heruntergeladenen Gradle-Bibliotheken in gespeichert</font></font><code>C:\Windows\System32\config\systemprofile\.gradle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weitere CI können nicht auf diese Dateien zugreifen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pfad: </font></font><br>
<br>
<code>C:\Gradle\gradle-3.3\bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Der Pfad zum Gradle-Ordner zur bequemen Verwendung über die Befehlszeile. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Check: Wir geben CMD ein </font></font><code>gradle -v</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir erhalten Informationen zur aktuellen Version: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5d/oz/sz/5dozszxuoyliwdu4cc7kbsqks5m.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorbereitung des Android-Projekts</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
4.1. Erstellen Sie ein Testprojekt in Android Studio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Typ Aktivität - Untere Navigationsaktivität. Es wird später nützlich sein, um einen UI-Test zu erstellen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.2. Deaktivieren Sie Gradle Daemon fortlaufend, damit Gradle Daemon nicht in CI erscheint: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Datei </font></font><code>gradle.properties:</code><br>
<code>add org.gradle.daemon=false</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.3 hinzufügen. Wir ergänzen die Datei auch </font></font><code>.gitignore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(nach Ihrem Geschmack), </font><font style="vertical-align: inherit;">
damit keine zusätzlichen Dateien in VCS verbleiben. </font><font style="vertical-align: inherit;">
4.4. Erstellen Sie einen Keystore (oder verwenden Sie einen vorhandenen) im Projektordner. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Link</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<code>.gradle<br>
.idea<br>
/build/<br>
local.properties</code><br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.5. Fügen Sie Links zum Keystore zu Gradle hinzu, damit wir eine vollwertige APK erstellen können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel:</font></font><br>
<br>
<pre><code class="plaintext hljs">android{  <font></font>
    ... //  <font></font>
    signingConfigs {<font></font>
        release {<font></font>
            storeFile file("keystorefile.jks") //        <font></font>
            storePassword "Password" //  <font></font>
            keyAlias "android" // keyAlias,     <font></font>
            keyPassword "Password" //  APK<font></font>
        }<font></font>
    }<font></font>
<font></font>
    ... //  <font></font>
     buildTypes {<font></font>
        release {<font></font>
            ... //  <font></font>
            signingConfig signingConfigs.release //  APK<font></font>
        }<font></font>
    }<font></font>
} </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.6. Um den Zustand des Systems zu testen, werden wir über die Befehlszeile ein neues Projekt zusammenstellen. Geben Sie CMD ein: </font></font><br>
<br>
<code>cd &lt;  &gt;</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zum Beispiel: </font></font><code>C:\Users\1\Documents\GitHub\Command2</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie zum Projekt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enter: Wir </font></font><br>
<br>
<code>gradlew assembleDebug</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
warten auf den Abschluss der Montage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn alles in Ordnung ist, erhalten wir das Ergebnis BUILD SUCCESSFUL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uf/dr/x7/ufdrx77tmdj5e1xlin8depxema0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen zum Projektordner: </font></font><code>app\build\outputs\apk\debug</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Er enthält eine neue APK-Datei, die auf dem Gerät installiert werden kann, und prüft, ob alles funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7. Wir werden auch prüfen, ob die SDK-Tools und der AVD-Manager gestartet sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7.1. Starten Sie Android Studio und erstellen Sie einen Emulator. Sie können es natürlich in der Befehlszeile erstellen, aber wir haben die installierte UI-Shell. Es ist eine Sünde, sie nicht zu verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tools → AVD Manager: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ib/k7/k5/ibk7k5w33zp2jh4rxcts51ioifu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die SDK-Version des erstellten Emulators muss mindestens so groß sein wie unser SDK-Projekt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7.2. Emulator erstellt. Lassen Sie uns den Start von der Konsole aus überprüfen. Wir geben über die Befehlszeile ein: </font></font><br>
<br>
<code>start /min emulator -avd &lt; &gt;</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>start /min emulator -avd Pixel_2_API_25</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass wir eine Funktion verwenden </font></font><code>/min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, um den Emulator im Hintergrund zu starten. Andernfalls hätte er keine neuen Befehle in die CMD eingeben dürfen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Gerät läuft: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wj/go/ia/wjgoiap9s77ujejq-pn_fahputw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7.3. Wir überprüfen die Installation der gesammelten APK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir geben in die CMD ein: </font></font><br>
<br>
<code>adb install &lt;path_to_apk&gt;</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>adb install C:\Users\1\Documents\GitHub\Command2\app\release\app-release.apk</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erfolgreich: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-l/gf/ze/-lgfze9zuuhlvlzlecbgp9clwue.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7.4. Wir überprüfen den Start der installierten APK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir geben die CMD ein: </font></font><br>
<br>
<code>adb shell monkey -p &lt;     &gt; -c android.intent.category.LAUNCHER 1</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: Die </font></font><br>
<br>
<code>adb shell monkey -p com.panarik.command -c android.intent.category.LAUNCHER 1</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anwendung wurde gestartet: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kc/dl/pu/kcdlpuz9f0bc16c5dulf14rsyd4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4.7.5. Wir laden das Projekt in ein Remote-Repository hoch, beispielsweise auf GitHub. Überprüfen Sie, ob das Projekt heruntergeladen wird: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installieren Sie Git BASH (wenn wir Git VCS verwenden). </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir klonen das Projekt von einem Remote-Repo. Geben Sie in die Konsole Git BASH ein: </font></font><br>
<br>
<code>git clone &lt;  .git&gt;</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>git clone https://github.com/panarik/Command2.git</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen das Ergebnis. Das Projekt wurde in einen lokalen Ordner kopiert: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2m/mc/3u/2mmc3upb1vs0_rurcfes7yeyrai.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist bereit, TeamCity zu installieren und zu konfigurieren. Warum machen wir Übungen mit der Kommandozeile und installieren TeamCity nicht sofort. Es ist viel bequemer, im Voraus sicherzustellen, dass das Projekt funktioniert, damit es in Zukunft einfacher sein wird, mögliche Fehler in der Erstellungsphase in TeamCity zu lokalisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installieren von TeamCity Server und Build Agent</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ich werde den Installationsprozess nicht im Detail beschreiben. Er ist im offiziellen Führer und vielen anderen Quellen. TeamCity-Server-Port Ich schlage vor, Nicht-Standard-Port festzulegen, damit es schwieriger ist, Port-Scans zu berechnen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TeamCity-Projekt konfigurieren → Erstellen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den allgemeinen Einstellungen müssen Sie nur den Pfad zur APK-Ausgabe festlegen: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>app\build\outputs\apk\release\app-release.apk</code><br>
<br>
<img src="https://habrastorage.org/webt/4o/ca/_0/4oca_0ess7vbx4awyid4q7ldv3a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.1. Einrichten von TeamCity VCS Roots </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alles ist Standard. In unserem Projekt verwenden wir Git, also geben wir es ein und einen Link zum Remote-Repo. Beispiel: </font></font><br>
<br>
<code>https://github.com/panarik/Command2.git</code><br>
<br>
<img src="https://habrastorage.org/webt/ko/p9/d1/kop9d17wvkt7gwcgxxpuaoglio0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6.2. TeamCity-Build-Konfiguration </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fügen Sie einen Build-Schritt hinzu, der das Projekt kompiliert und die APK anzeigt. In unserem Projekt verwenden wir Gradle. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geben Sie in das Feld Gradle-Aufgaben </font></font><br>
<br>
<code>clean build assembleDebug --no-daemon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Folgendes ein </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">(--no-daemon für alle Fälle, und dies sollte als Index für die Datei funktionieren, die wir in Abschnitt 4.2 erstellt haben.) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/za/wt/cm/zawtcmqdtqqsvpwjzpn_4e0bwvc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie auf Ausführen. Wir erhalten die APK. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurieren von Build-Schritten mit UI-Autotests Wir</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
haben den interessantesten Teil erreicht, nämlich den automatischen Start von UI-Tests.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Schritte werden mit .BAT-Dateien gestartet. Es ist viel bequemer, Code zu schreiben, ihn im laufenden Betrieb zu ändern, ohne die TeamCity-Benutzeroberfläche aufrufen zu müssen usw. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.1. Erstellen Sie zunächst einen Build-Schritt bei laufendem Emulator. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können die URL zum BATnik vollständig erstellen. Der Einfachheit halber habe ich die Umgebung in TeamCity </font></font><code>BAT_FILES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit dem Pfad zum Ordner mit den BATs erstellt: Wir </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hm/mz/hx/hmmzhx2i5rdyb3eafa3gyczn1ue.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
schreiben den Emulator- </font><font style="vertical-align: inherit;">Startcode </font><font style="vertical-align: inherit;">in die Datei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispiel: </font></font><br>
<br>
<code>start /min "emulator" /D "C:\Users\1\AppData\Local\Android\Sdk\emulator" emulator.exe -avd Pixel_2_API_25 -no-snapshot-save -no-boot-anim</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liste der Befehle und Parameter an einem externen Standort: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.2. Erstellen Sie einen Erstellungsschritt mit einer Pause, während der Emulator geladen wird. Sie können den ersten Schritt sofort in .BAT registrieren, aber es wird klarer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel für ein solches Team, das das Internet ausspioniert hat: Auf </font></font><br>
<br>
<code>adb wait-for-device shell 'while [[ -z $(getprop sys.boot_completed) ]]; do sleep 1; done; input keyevent 82'</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
der Benutzeroberfläche sieht es folgendermaßen aus: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/uh/0r/pouh0rl3u3g9kfwxyu1h5dcpbxy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liste aller Teams auf der Off-Site: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.3. </font><font style="vertical-align: inherit;">Führen Sie den Test aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch über die Kommandozeile. </font><font style="vertical-align: inherit;">Hier ist alles individuell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispielbefehl: </font></font><br>
<br>
<code>gradlew connectedDebugAndroidTest</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7.4. </font><font style="vertical-align: inherit;">Wir stoppen den Emulator. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispielbefehl: </font></font><br>
<br>
<code>adb -s emulator-5554 emu kill</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prozess abgeschlossen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können den Bericht auch in einem separaten Schritt hochladen. </font><font style="vertical-align: inherit;">Standardmäßig wird es im Projektordner gespeichert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihre Aufmerksamkeit! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn jemand Ratschläge zur Verbesserung des Codes für Schritte und Verbesserungsvorschläge hat, bin ich sehr dankbar.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502414/index.html">FOSS News Nr. 16 - eine Überprüfung der freien und Open-Source-Software für den 11. bis 17. Mai 2020</a></li>
<li><a href="../de502416/index.html">SQL ergänzen. Teil 1. Die Komplexität des Parsens. Geschichten zum Finalisieren der ANTLR-Datei</a></li>
<li><a href="../de502418/index.html">3D-Bildmonitor</a></li>
<li><a href="../de502420/index.html">Interessante CSS-Funde im Twitter-Design</a></li>
<li><a href="../de502432/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 415 (11.-17. Mai 2020)</a></li>
<li><a href="../de502438/index.html">Material Python. Benutzerdefinierte Karten mit OpenGL-Effekten</a></li>
<li><a href="../de502440/index.html">Erstellen von Anwendungen mit Mediapipe</a></li>
<li><a href="../de502442/index.html">PHP Digest Nr. 180 (4. - 18. Mai 2020)</a></li>
<li><a href="../de502448/index.html">IBM wöchentliche Seminare - Mai 2020</a></li>
<li><a href="../de502450/index.html">Moderation von Kommentaren 2. Können wir den Benutzern dennoch vertrauen? (Fortsetzung)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>