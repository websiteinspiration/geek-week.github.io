<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☂️ 🧓🏾 🧑🏾‍🤝‍🧑🏻 Python仮想マシンの内部。パート2 🙅🏽 🧝🏽 📦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちは、ハブル。この記事の翻訳には、予想よりもはるかに長い時間がかかりました。私は本当にすべてを質的にそして詐欺なしでやりたかったです、しかしあなたが不正確を見つけたら、私はそれらについて聞いてうれしいです。以前の記事の誤りがどこかで間違っていることが判明した場合は、それをもう一度読んで修正しま...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Python仮想マシンの内部。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501920/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ph/sh/nd/phshndfwok7fnu2ex5x1i_s4d8e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こんにちは、ハブル。</font><font style="vertical-align: inherit;">この記事の翻訳には、予想よりもはるかに長い時間がかかりました。</font><font style="vertical-align: inherit;">私は本当にすべてを質的にそして詐欺なしでやりたかったです、しかしあなたが不正確を見つけたら、私はそれらについて聞いてうれしいです。</font><font style="vertical-align: inherit;">以前の記事の誤りがどこかで間違っていることが判明した場合は、それをもう一度読んで修正します。</font><font style="vertical-align: inherit;">このボリュームの4〜5の記事はまだ翻訳していないので、気に入ったら私の作品を評価してください。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目次</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1部</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2部</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonソースコードのコンパイル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonは通常、コンパイルされた言語とは見なされませんが、実際にはそうです。</font><font style="vertical-align: inherit;">コンパイル時に、Pythonで記述されたソースコードがバイトコードに変換され、仮想マシンによって実行されます。</font><font style="vertical-align: inherit;">ただし、Pythonのコンパイルプロセスは非常に単純で、複雑な手順は多くありません。</font><font style="vertical-align: inherit;">この手順は、次の手順で構成されています。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースPythonコードを解析ツリーに変換します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構文解析ツリーを抽象構文ツリー（AST）に変換します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字テーブルの生成。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASTからコードオブジェクトを作成します。</font><font style="vertical-align: inherit;">このステップには以下が含まれます。</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASTを制御フローグラフに変換します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御フローグラフからコードオブジェクトを取得します。</font></font></li>
</ul></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解析ツリーを作成し、それらをASTに変換することは標準的なプロセスです。</font><font style="vertical-align: inherit;">Pythonは複雑なニュアンスを導入していません。そのため、この章では、ASTを制御フローグラフに変換し、このグラフからコードオブジェクトを取得する方法について説明します。</font><font style="vertical-align: inherit;">木を解析したりASTを生成したりすることに興味がある人のために</font><font style="vertical-align: inherit;">、より詳細なツアーデフォースを提供する</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ドラゴン」の本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります。</font><font style="vertical-align: inherit;">フランス語から：「大きな努力」]これらのトピックの両方で。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースから構文解析ツリーへ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonパーサーは</font><font style="vertical-align: inherit;">、ドラゴンの本で説明されている原則に基づい</font><font style="vertical-align: inherit;">た</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LL（1）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font><font style="vertical-align: inherit;">です。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文法/文法</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールに</font><font style="vertical-align: inherit;">は、Python文法仕様の拡張バッカスナウアフォーム（EBNF）が含まれてい</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この仕様の抜粋をリスト3.0に示します。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  stmt: simple_stmt | compound_stmt
 <span class="hljs-number">2</span>  simple_stmt: small_stmt (<span class="hljs-string">';'</span> small_stmt)* [<span class="hljs-string">';'</span>] NEWLINE
 <span class="hljs-number">3</span>  small_stmt: (expr_stmt | del_stmt | pass_stmt | flow_stmt |
 <span class="hljs-number">4</span>          import_stmt | global_stmt | nonlocal_stmt | assert_stmt)
 <span class="hljs-number">5</span>  expr_stmt: testlist_star_expr (augassign (yield_expr|testlist) |
 <span class="hljs-number">6</span>                  (<span class="hljs-string">'='</span> (yield_expr|testlist_star_expr))*)
 <span class="hljs-number">7</span>  testlist_star_expr: (test|star_expr) (<span class="hljs-string">','</span> (test|star_expr))* [<span class="hljs-string">','</span>]
 <span class="hljs-number">8</span>  augassign: (<span class="hljs-string">'+='</span> | <span class="hljs-string">'-='</span> | <span class="hljs-string">'*='</span> | <span class="hljs-string">'@='</span> | <span class="hljs-string">'/='</span> | <span class="hljs-string">'%='</span> | <span class="hljs-string">'&amp;='</span> | <span class="hljs-string">'|='</span> | <span class="hljs-string">'^='</span> 
 <span class="hljs-number">9</span>          | <span class="hljs-string">'&lt;&lt;='</span> | <span class="hljs-string">'&gt;&gt;='</span> | <span class="hljs-string">'**='</span> | <span class="hljs-string">'//='</span>)
<span class="hljs-number">10</span>      
<span class="hljs-number">11</span>  del_stmt: <span class="hljs-string">'del'</span> exprlist
<span class="hljs-number">12</span>  pass_stmt: <span class="hljs-string">'pass'</span>
<span class="hljs-number">13</span>  flow_stmt: break_stmt | continue_stmt | return_stmt | raise_stmt | 
<span class="hljs-number">14</span>          yield_stmt
<span class="hljs-number">15</span>  break_stmt: <span class="hljs-string">'break'</span>
<span class="hljs-number">16</span>  continue_stmt: <span class="hljs-string">'continue'</span>
<span class="hljs-number">17</span>  return_stmt: <span class="hljs-string">'return'</span> [testlist]
<span class="hljs-number">18</span>  yield_stmt: yield_expr
<span class="hljs-number">19</span>  raise_stmt: <span class="hljs-string">'raise'</span> [test [<span class="hljs-string">'from'</span> test]]
<span class="hljs-number">20</span>  import_stmt: import_name | import_from
<span class="hljs-number">21</span>  import_name: <span class="hljs-string">'import'</span> dotted_as_names
<span class="hljs-number">22</span>  import_from: (<span class="hljs-string">'from'</span> ((<span class="hljs-string">'.'</span> | <span class="hljs-string">'...'</span>)* dotted_name | (<span class="hljs-string">'.'</span> | <span class="hljs-string">'...'</span>)+)
<span class="hljs-number">23</span>          <span class="hljs-string">'import'</span> (<span class="hljs-string">'*'</span> | <span class="hljs-string">'('</span> import_as_names <span class="hljs-string">')'</span> | import_as_names))
<span class="hljs-number">24</span>  import_as_name: NAME [<span class="hljs-string">'as'</span> NAME]
<span class="hljs-number">25</span>  dotted_as_name: dotted_name [<span class="hljs-string">'as'</span> NAME]
<span class="hljs-number">26</span>  import_as_names: import_as_name (<span class="hljs-string">','</span> import_as_name)* [<span class="hljs-string">','</span>]
<span class="hljs-number">27</span>  dotted_as_names: dotted_as_name (<span class="hljs-string">','</span> dotted_as_name)*
<span class="hljs-number">28</span>  dotted_name: NAME (<span class="hljs-string">'.'</span> NAME)*
<span class="hljs-number">29</span>  global_stmt: <span class="hljs-string">'global'</span> NAME (<span class="hljs-string">','</span> NAME)*
<span class="hljs-number">30</span>  nonlocal_stmt: <span class="hljs-string">'nonlocal'</span> NAME (<span class="hljs-string">','</span> NAME)*
<span class="hljs-number">31</span>  assert_stmt: <span class="hljs-string">'assert'</span> test [<span class="hljs-string">','</span> test]
<span class="hljs-number">32</span>     
<span class="hljs-number">33</span>  ...</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.0。</font><font style="vertical-align: inherit;">Python BNF構文スニペット</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンドラインでインタープリターに渡されたモジュールを実行する</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">PyParser_ParseFileObjectが呼び出され</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この関数は、ファイルの解析を開始します。</font><font style="vertical-align: inherit;">また、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyTokenizer_FromFile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トークン化</font><b><font style="vertical-align: inherit;">関数を</font></b><font style="vertical-align: inherit;">呼び出し、</font><font style="vertical-align: inherit;">モジュールファイルの名前を引数として渡します。</font><font style="vertical-align: inherit;">Pythonのトークン化関数は、モジュールのコンテンツを正しいトークンに分解するか、無効なトークンを検出した場合は例外をスローします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pythonトークン</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonソースコードはトークンで構成されています。</font><font style="vertical-align: inherit;">たとえば、returnという単語はキートークンで、リテラルは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数値などです。</font><font style="vertical-align: inherit;">解析の最初のタスクは、ソースコードをコンポーネントトークンに分解してトークン化することです。</font><font style="vertical-align: inherit;">Pythonにはいくつかのタイプのトークンがあります。</font></font><br>
<br>
<ol>
<li><b></b> —  ,   .    , ,   ..      ,    python.</li>
<li><b></b> —   ,  : <b>+</b>  <b>*</b>,        - .</li>
<li><b></b> —      ,   .      : <b>(, ), {,}, =, *=</b>  ..</li>
<li><b></b> —  ,       .       ,   «Fred»  b«Fred»,  ,  :  ,   <b>2</b>,    : <b>1e100</b>   : <b>10j</b>.</li>
<li><b></b> —   ,     <b>#</b>.     «»  .</li>
<li><b>NEWLINE</b> —   ,    «» .</li>
<li><b>INDENT</b>  <b>DEDENT</b> —       ,   .</li>
</ol><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NEWLINE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
で区切られたトークングループは、</font><font style="vertical-align: inherit;">python命令にマップする論理行を形成します。つまり、Pythonプログラムは一連の論理行で構成され、それぞれが</font><b><font style="vertical-align: inherit;">NEWLINE</font></b><font style="vertical-align: inherit;">トークンで区切られていると</font><b><font style="vertical-align: inherit;">言え</font></b><font style="vertical-align: inherit;">ます</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これらの各論理行は、いくつかの物理的な行で構成されており、その行は改行文字で終わります。しかし、Pythonでは、論理行は物理行と一致することが多いため、ほとんどの場合、論理行は行末文字で区切られていると言えます。図3.0に示すように、複合命令は複数の物理行にまたがることができます。論理行は、暗黙的に（括弧、角括弧、または中括弧で式を囲むことにより）、またはバックスラッシュ文字を使用して明示的に形成できます。インデントは、Pythonステートメントのグループ化でも中心的な役割を果たします。したがって、Python文法の行の1つは次のようになります</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。suite：simple_stmt | NEWLINE INDENT stmt + DEDENT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。その結果、Pythonトークナイザーの主なタスクの1つは、解析ツリーに追加されるインデントトークンと逆インデントトークンを生成することです。トークナイザーはスタックを使用してインデントを追跡し、リスト3.1のアルゴリズムを使用します。</font></font><br>
<br>
<pre><code class="xml hljs">    0.<font></font>
        :<font></font>
   A.     <font></font>
       <font></font>
       1.        .<font></font>
       2.   INDENT.<font></font>
   B.      <font></font>
       <font></font>
       1.   <font></font>
          ,    ,   .<font></font>
       2.        ,   <font></font>
         .<font></font>
           a.       .<font></font>
           b.    DEDENT.<font></font>
   C.    .<font></font>
    ,  0,   DEDENT.</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード表示3.1：INDENTトークンとDEDENTトークンを生成するためのPythonアルゴリズム。</font></font></i><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Parser / parsetok.cモジュール</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyTokenizer_FromFile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">ソースPythonファイルを左から右にスキャンし、コンテンツをトークン化してトップダウンします。スペース文字（ターミネーター以外）はトークンを区切る役割を果たしますが、必須ではありません。 2 + 2などのあいまいさがある場合、トークナイザーは、右から左に読み取るときに正当なトークンを形成する最も長い行を強調表示しようとします。この例では、トークンはリテラル</font><b><font style="vertical-align: inherit;">2</font></b><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">+</font></b><font style="vertical-align: inherit;">演算子、</font><font style="vertical-align: inherit;">および別のリテラル</font><b><font style="vertical-align: inherit;">2</font></b><font style="vertical-align: inherit;">です。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
生成されたトークンはパーサーに渡され、パーサーはそれらから構文解析ツリーを構築しようとします（Python文法に従って、そのサブセットをリスト3.0に示します）。アナライザーが文法に違反するトークンを検出すると、SyntaxError例外がスローされます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュール</font><font style="vertical-align: inherit;">は、特定のPythonコードのツリーへの限定的なアクセスを提供し、構文ツリーの例を取得するためにリスト3.2で使用されます。</font></font><br>
<br>
<pre><code class="python hljs"> <span class="hljs-number">1</span>  &gt;&gt;&gt;code_str = <span class="hljs-string">"""def hello_world():
 2                      return 'hello world'
 3                """</span>
 <span class="hljs-number">4</span>  &gt;&gt;&gt; <span class="hljs-keyword">import</span> parser
 <span class="hljs-number">5</span>  &gt;&gt;&gt; <span class="hljs-keyword">from</span> pprint <span class="hljs-keyword">import</span> pprint 
 <span class="hljs-number">6</span>  &gt;&gt;&gt; st = parser.suite(code_str)
 <span class="hljs-number">7</span>  &gt;&gt;&gt; pprint(parser.st2list(st))
 <span class="hljs-number">8</span>  [<span class="hljs-number">257</span>,
 <span class="hljs-number">9</span>  [<span class="hljs-number">269</span>,
<span class="hljs-number">10</span>  [<span class="hljs-number">294</span>,
<span class="hljs-number">11</span>  [<span class="hljs-number">263</span>,
<span class="hljs-number">12</span>      [<span class="hljs-number">1</span>, <span class="hljs-string">'def'</span>],
<span class="hljs-number">13</span>      [<span class="hljs-number">1</span>, <span class="hljs-string">'hello_world'</span>],
<span class="hljs-number">14</span>      [<span class="hljs-number">264</span>, [<span class="hljs-number">7</span>, <span class="hljs-string">'('</span>], [<span class="hljs-number">8</span>, <span class="hljs-string">')'</span>]],
<span class="hljs-number">15</span>      [<span class="hljs-number">11</span>, <span class="hljs-string">':'</span>],
<span class="hljs-number">16</span>      [<span class="hljs-number">303</span>,
<span class="hljs-number">17</span>      [<span class="hljs-number">4</span>, <span class="hljs-string">''</span>],
<span class="hljs-number">18</span>      [<span class="hljs-number">5</span>, <span class="hljs-string">''</span>],
<span class="hljs-number">19</span>      [<span class="hljs-number">269</span>,
<span class="hljs-number">20</span>      [<span class="hljs-number">270</span>,
<span class="hljs-number">21</span>      [<span class="hljs-number">271</span>,
<span class="hljs-number">22</span>          [<span class="hljs-number">277</span>,
<span class="hljs-number">23</span>          [<span class="hljs-number">280</span>,
<span class="hljs-number">24</span>          [<span class="hljs-number">1</span>, <span class="hljs-string">'return'</span>],
<span class="hljs-number">25</span>          [<span class="hljs-number">330</span>,
<span class="hljs-number">26</span>          [<span class="hljs-number">304</span>,
<span class="hljs-number">27</span>              [<span class="hljs-number">308</span>,
<span class="hljs-number">28</span>              [<span class="hljs-number">309</span>,
<span class="hljs-number">29</span>              [<span class="hljs-number">310</span>,
<span class="hljs-number">30</span>              [<span class="hljs-number">311</span>,
<span class="hljs-number">31</span>                  [<span class="hljs-number">314</span>,
<span class="hljs-number">32</span>                  [<span class="hljs-number">315</span>,
<span class="hljs-number">33</span>                  [<span class="hljs-number">316</span>,
<span class="hljs-number">34</span>                  [<span class="hljs-number">317</span>,
<span class="hljs-number">35</span>                      [<span class="hljs-number">318</span>,
<span class="hljs-number">36</span>                      [<span class="hljs-number">319</span>,
<span class="hljs-number">37</span>                      [<span class="hljs-number">320</span>,
<span class="hljs-number">38</span>                      [<span class="hljs-number">321</span>,
<span class="hljs-number">39</span>                          [<span class="hljs-number">322</span>, [<span class="hljs-number">323</span>, [<span class="hljs-number">3</span>, <span class="hljs-string">'"hello world"'</span>]]]]]]]]]]]]]]]]]]]],
<span class="hljs-number">40</span>      [<span class="hljs-number">4</span>, <span class="hljs-string">''</span>]]],
<span class="hljs-number">41</span>      [<span class="hljs-number">6</span>, <span class="hljs-string">''</span>]]]]],
<span class="hljs-number">42</span>  [<span class="hljs-number">4</span>, <span class="hljs-string">''</span>],
<span class="hljs-number">43</span>  [<span class="hljs-number">0</span>, <span class="hljs-string">''</span>]]
<span class="hljs-number">44</span>  &gt;&gt;&gt;  </code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.2。</font><font style="vertical-align: inherit;">パーサーモジュールを使用してPythonでツリーを取得する</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.2 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parser.suite（ソース）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、ソースコードからの構文解析ツリーの中間表現で</font><font style="vertical-align: inherit;">あるツリー（</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">オブジェクトを返し</font><font style="vertical-align: inherit;">ます（ソースコードは構文的に正しいと想定されています）。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parser.st2list</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">は、Pythonリストとして表される実際の構文ツリーを返します。</font><font style="vertical-align: inherit;">リストの最初の要素は、Python文法の生成規則を識別する整数です。</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私が生産規則という用語を正しく理解していれば...</font></font></b>
                        <div class="spoiler_text">    —  ,       .<br>
</div>
                    </div><br>
<br>
<img src="https://habrastorage.org/webt/tn/4e/5q/tn4e5q3tcnl4volizk1lb9iob_8.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.0：リスト3.2のための構文解析ツリー（リターン文字列'ハロー世界という機能）</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
図3.0は、リスト3.2から同じツリーを示すツリー図であるが、いくつかのトークンを除去し、コマンドの一部を合わせて、文字列の記述に置き換えられました数値。これらの製品ルールはすべて、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Include / token.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Include / graminit.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヘッダーファイルにリストされています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CPython仮想マシンは、ツリーのようなデータ構造を使用して解析ツリーを表します。各プロダクションルールはその中のノードです。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Include / node.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">からのノード（node）のデータ構造を</font><font style="vertical-align: inherit;">リスト3.3に示し</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-number">1</span>  <span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">node</span> {</span>
<span class="hljs-number">2</span>      <span class="hljs-keyword">short</span> n_type;
<span class="hljs-number">3</span>      <span class="hljs-keyword">char</span>	*n_str;
<span class="hljs-number">4</span>      <span class="hljs-keyword">int</span> n_lineno;
<span class="hljs-number">5</span>      <span class="hljs-keyword">int</span> n_col_offset;
<span class="hljs-number">6</span>      <span class="hljs-keyword">int</span> n_nchildren;
<span class="hljs-number">7</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">node</span> *<span class="hljs-title">n_child</span>;</span>
<span class="hljs-number">8</span>  } node;</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.3：仮想マシンのノードデータ構造</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
解析ツリーをたどるとき、ノードは、タイプ、子要素（存在する場合）、ソースファイルの行番号（このノードの作成につながった）などでクエリできます。</font><font style="vertical-align: inherit;">解析ツリーノードと対話するためのマクロも、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Include / node.hファイルで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定義されてい</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構文解析ツリーから抽象構文ツリーへ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonでのコンパイルプロセスの次のステップは、解析ツリーを</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抽象構文ツリー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（AST）</font><font style="vertical-align: inherit;">に変換すること</font><font style="vertical-align: inherit;">です。抽象構文ツリーは、Python構文の複雑さに依存しないコード表現です。たとえば、図3.0の構文解析ツリーには、コロンノードが含まれています。関数宣言コロン]は構文構文であるためですが、リスト3.4に示すように、ASTにはそのような「詳細」は含まれません。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">1</span>  &gt;&gt;&gt; <span class="hljs-keyword">import</span> ast
<span class="hljs-number">2</span>  &gt;&gt;&gt; <span class="hljs-keyword">import</span> pprint
<span class="hljs-number">3</span>  &gt;&gt;&gt; node = ast.parse(code_str, mode=<span class="hljs-string">"exec"</span>)
<span class="hljs-number">4</span>  &gt;&gt;&gt; ast.dump(node)
<span class="hljs-number">5</span>  (<span class="hljs-string">"Module(body=[FunctionDef(name='hello_world', args=arguments(args=[], "</span>
<span class="hljs-number">6</span>  <span class="hljs-string">'vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), '</span>
<span class="hljs-number">7</span>  <span class="hljs-string">"body=[Return(value=Str(s='hello world'))], decorator_list=[], "</span>
<span class="hljs-number">8</span>  <span class="hljs-string">'returns=None)])'</span>)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.4 astモジュールを使用してPythonソースコードのASTを制御する</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さまざまなASTノード定義が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parser / Python.asdlファイルにあります</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ほとんどのAST定義は、ifステートメントや属性検索などの特定のソース構成に一致します。 astモジュールは、Pythonインタープリターとともに、ASTを操作する機能を提供します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codegen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などのツール</font><font style="vertical-align: inherit;">は、特定のASTのpythonソースコードを</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">出力</font></a><font style="vertical-align: inherit;">できます。 CPythonの実装では、ASTノードはC構造体で表され、これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Include / Python-ast.hで</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定義されてい</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。これらの構造は、実際にはPythonコードによって生成されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パーサ/ asdl_c.pyモジュールは、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ASDLのASTの定義からこのファイルを生成します。たとえば、以下は</font><b><font style="vertical-align: inherit;">ステートメント</font></b><font style="vertical-align: inherit;">ノード定義の一部です。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これはリスト3.5に示されています。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">stmt</span> {</span>
 <span class="hljs-number">2</span>      <span class="hljs-keyword">enum</span> _stmt_kind kind;
 <span class="hljs-number">3</span>      <span class="hljs-keyword">union</span> {
 <span class="hljs-number">4</span>          <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
 <span class="hljs-number">5</span>              identifier name;
 <span class="hljs-number">6</span>              arguments_ty args;
 <span class="hljs-number">7</span>              asdl_seq *body;
 <span class="hljs-number">8</span>              asdl_seq *decorator_list;
 <span class="hljs-number">9</span>              expr_ty returns;
<span class="hljs-number">10</span>          } FunctionDef;
<span class="hljs-number">11</span> 
<span class="hljs-number">12</span>          <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
<span class="hljs-number">13</span>              identifier name;
<span class="hljs-number">14</span>              arguments_ty args;
<span class="hljs-number">15</span>              asdl_seq *body;
<span class="hljs-number">16</span>              asdl_seq *decorator_list;
<span class="hljs-number">17</span>              expr_ty returns;
<span class="hljs-number">18</span>          } AsyncFunctionDef;
<span class="hljs-number">19</span> 
<span class="hljs-number">20</span>          <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
<span class="hljs-number">21</span>              identifier name;
<span class="hljs-number">22</span>              asdl_seq *bases;
<span class="hljs-number">23</span>              asdl_seq *keywords;
<span class="hljs-number">24</span>              asdl_seq *body;
<span class="hljs-number">25</span>              asdl_seq *decorator_list;
<span class="hljs-number">26</span>          } ClassDef;
<span class="hljs-number">27</span>          ...
<span class="hljs-number">28</span>      }v;
<span class="hljs-number">29</span>      <span class="hljs-keyword">int</span> lineno;
<span class="hljs-number">30</span>      <span class="hljs-keyword">int</span> col_offset
<span class="hljs-number">31</span>  }</code></pre><br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.5の</font><b><font style="vertical-align: inherit;">Union</font></b><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、</font><b><font style="vertical-align: inherit;">union</font></b><font style="vertical-align: inherit;">自体にリストされているタイプのいずれかを取ることができる属性を作成するために使用される</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーワード</font><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">Python / ast.cモジュール</font></b><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">PyAST_FromNode</font></b><font style="vertical-align: inherit;">関数</font><font style="vertical-align: inherit;">は、</font><font style="vertical-align: inherit;">この解析ツリーからASTを生成します。</font><font style="vertical-align: inherit;">次に、生成されたASTからバイトコードを作成します。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャラクターテーブルビル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ASTを作成した後の次のステップは、文字テーブルを生成することです。</font><font style="vertical-align: inherit;">シンボルテーブルは、名前が示すように、コードブロックおよびその他のコンテキストで使用される名前のセットです。</font><font style="vertical-align: inherit;">シンボルテーブルを作成するプロセスには、名前（コードブロックに含まれる）を分析し、そのような名前を正しいスコープに割り当てることが含まれます。</font><font style="vertical-align: inherit;">おそらく、シンボルテーブルの作成の複雑さを説明する前に、Pythonで名前とバインディングを繰り返す価値があります。</font></font><br>
<blockquote><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名前と関連</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonでは、オブジェクトは名前で参照されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「名前」</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はC ++またはJavaの変数に似ていますが、これは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全には</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当てはまり</font><b><font style="vertical-align: inherit;">ません</font></b><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>x = <span class="hljs-number">5</span></code></pre><br>
    <b>x</b> —  ,    : <b>5</b>.      <b>5</b>  <b>x</b>  .    ,      ,         .     , ,   , ,   ,        ..  ,   —        ,    . <b>    ,     </b>.<br>
<br>
<h3> </h3><br>
      Python              Python.   —    ,    Python   .     ,   . ,      REPL,      <b>-c</b>,    .      ,   . ,         <b>global</b>,           <b>local</b>, -  <b>global</b>.<br>
<br>
<h3> </h3><br>
  (namespace)  ,   -     .   Python    .      namespace,              <b>__builtins__.__dict__</b>   (    ).       ,     ,   .   namespace          . ,                 .           ,    namespace,    .    ,          .       namespace  .<br>
<br>
<h3> </h3><br>
  —   ,     ( )        . [. ,         globals()].          :<br>
<br>
<ol>
<li> «»  ,   </li>
<li>  ,           «».</li>
<li>    </li>
<li> ,    </li>
</ol><br>
  python  ,          (  )           ,  . Python     (     ).  ,            .<br>
<br>
<h3></h3><br>
 Python      ,           .      UnboundLocalError.    :<br>
<br>
<pre><code class="python hljs">    &gt;&gt;&gt; a = <span class="hljs-number">1</span>
    &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc_a</span>():</span> a += <span class="hljs-number">2</span><font></font>
    ... <font></font>
    &gt;&gt;&gt; inc_a()<font></font>
    Traceback (most recent call last):<font></font>
     File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
     File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> inc_a<font></font>
    UnboundLocalError: local variable <span class="hljs-string">'a'</span> referenced before assignment</code></pre><br>
<i> A3.0.      </i><br>
<br>
  «»    ,     <b>global</b>   :<br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>a = <span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc_a</span>():</span>
<span class="hljs-meta">... </span>    <span class="hljs-keyword">global</span> a
<span class="hljs-meta">... </span>    a += <span class="hljs-number">1</span>
<span class="hljs-meta">... </span>
<span class="hljs-meta">&gt;&gt;&gt; </span>inc_a()
<span class="hljs-meta">&gt;&gt;&gt; </span>a
<span class="hljs-number">2</span></code></pre><br>
<i> A3.1.    global      </i><br>
<br>
Python     nonlocal.  ,    ,   ,  « »  .         (  <b></b>).      <b>nonlocal</b>    ,      :<br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_counter</span>():</span>
<span class="hljs-meta">... </span>    count = <span class="hljs-number">0</span>
<span class="hljs-meta">... </span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">counter</span>():</span>
<span class="hljs-meta">... </span>        <span class="hljs-keyword">nonlocal</span> count <span class="hljs-comment">#capture count binding from enclosing not global scope</span>
<span class="hljs-meta">... </span>        count += <span class="hljs-number">1</span>
<span class="hljs-meta">... </span>        <span class="hljs-keyword">return</span> count
<span class="hljs-meta">... </span>    <span class="hljs-keyword">return</span> counter
<span class="hljs-meta">... </span>
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_1 = make_counter()
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_2 = make_counter()
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_1()
<span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_1()
<span class="hljs-number">2</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_2()
<span class="hljs-number">1</span>
<span class="hljs-meta">&gt;&gt;&gt; </span>counter_2()
<span class="hljs-number">2</span></code></pre><br>
<i> A3.2.    </i><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一連の関数呼び出しrun_mod-&gt; PyAST_CompileObject-&gt; PySymtable_BuildObjectは、シンボルテーブルの作成プロセスを開始します。 PySymtable_BuildObject関数への2つの引数は、以前に生成されたASTとモジュール名です。シンボルテーブルを作成するアルゴリズムは、2つの部分に分かれています。 1つ目は、各ASTノードを「訪問」して、ASTで使用される文字のコレクションを作成します。このプロセスの非常に簡単な説明をリスト3.6に示します。このプロセスで使用される用語は、シンボルテーブルの作成に使用されるデータ構造について説明すると明らかになります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> AST
    <span class="hljs-keyword">if</span>  == __:
        <span class="hljs-number">1.</span> C      <font></font>
                <font></font>
        <span class="hljs-number">2.</span>  <span class="hljs-string">"push"</span>    st_stack.
        <span class="hljs-number">3.</span>      <font></font>
             .<font></font>
        <span class="hljs-number">4.</span>      
        <span class="hljs-number">5.</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> __:<font></font>
            a.     <font></font>
               <span class="hljs-string">"symtable_visit_XXX"</span>,  <span class="hljs-string">"XXX"</span>   .
        <span class="hljs-number">6.</span>    ,    <font></font>
             .<font></font>
        <span class="hljs-number">7.</span>  <span class="hljs-string">"pop"</span>     <font></font>
                  .<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
            -.</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.6 ASTからのシンボルテーブルの作成</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アルゴリズムの最初のパスの後、シンボルテーブルにはモジュールで使用されたすべての名前が含まれていますが、それらに関するコンテキスト情報は含まれていません。たとえば、インタープリターは、特定の変数がグローバル、ローカル、またはフリーであるかどうかを判別できません。</font><font style="vertical-align: inherit;">Parser / symtable.cから</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">symtable_analyze</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数を呼び出すと</font><font style="vertical-align: inherit;">、シンボルテーブルの生成の2番目のフェーズが開始されます。アルゴリズムのこのフェーズでは、最初のステージで受信した文字のスコープ（ローカル、グローバル、またはフリー）を決定します。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parser / symtable.cファイル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内のコメント</font><b><font style="vertical-align: inherit;">は</font></b><font style="vertical-align: inherit;">非常に有益であり、シンボルテーブルを構築するプロセスの第2段階のアイデアを提供するために以下に言い換えます：</font></font><br>
<br>
<ul>
<li>        .    «»  AST   symtable_visit_ *,     «»      PySTEntryObject,    .</li>
<li>     ,      ,     .   ,  :   non-local     . ,    non-local,        —   ,   .          ,    .</li>
<li>     :   .      global.    —   ,            .      ,  .<br>
 Python      xxx_NAME    ,     .       ,     «».      .</li>
<li>    .         c  «  »,     .     runtime   ,     .  -      ,       .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
モジュール内のコメントは、理解しやすい言語でシンボルテーブルを作成するプロセスを説明しようとしていますが、いくつかの混乱する点があります。</font><font style="vertical-align: inherit;">例：親は、その子に表示されるすべてのバインダーのセットを渡しますが、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それらは具体的にどの親およびどの子に参照しますか？</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これを理解するには、シンボルテーブルの作成プロセスで使用されるデータ構造を確認する必要があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字テーブルのデータ構造</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シンボルテーブルの生成の中心となる2つのデータ構造があります。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字テーブル</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のデータ構造</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字テーブルエントリ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のデータ構造</font><font style="vertical-align: inherit;">。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
シンボルテーブルのデータ構造をリスト3.7に示します。これは、レコードで構成され、このモジュールのさまざまなコードブロックで使用される名前に関する情報を含むテーブルと考えることができます。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">symtable</span> {</span>
 <span class="hljs-number">2</span>      PyObject *st_filename;          <span class="hljs-comment">/* name of file being compiled */</span>
 <span class="hljs-number">3</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">symtable_entry</span> *<span class="hljs-title">st_cur</span>;</span> <span class="hljs-comment">/* current symbol table entry */</span>
 <span class="hljs-number">4</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">symtable_entry</span> *<span class="hljs-title">st_top</span>;</span> <span class="hljs-comment">/* symbol table entry for module */</span>
 <span class="hljs-number">5</span>      PyObject *st_blocks;            <span class="hljs-comment">/* dict: map AST node addresses
 6                                      *       to symbol table entries */</span>
 <span class="hljs-number">7</span>      PyObject *st_stack;             <span class="hljs-comment">/*list: stack of namespace info */</span>
 <span class="hljs-number">8</span>      PyObject *st_global;            <span class="hljs-comment">/*borrowed ref to 
 9                                      st_top-&gt;ste_symbols*/</span>
<span class="hljs-number">10</span>      <span class="hljs-keyword">int</span> st_nblocks;                 <span class="hljs-comment">/* number of blocks used. kept for
11                                      consistency with the corresponding
12                                      compiler structure */</span>
<span class="hljs-number">13</span>      PyObject *st_private;           <span class="hljs-comment">/* name of current class or NULL */</span>
<span class="hljs-number">14</span>      PyFutureFeatures *st_future;    <span class="hljs-comment">/* module's future features that 
15                                      affect the symbol table */</span>
<span class="hljs-number">16</span>      <span class="hljs-keyword">int</span> recursion_depth;            <span class="hljs-comment">/* current recursion depth */</span>
<span class="hljs-number">17</span>      <span class="hljs-keyword">int</span> recursion_limit;            <span class="hljs-comment">/* recursion limit */</span>
<span class="hljs-number">18</span>  };</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.7文字テーブルのデータ構造。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pythonモジュールには、複数のコードブロック（たとえば、複数の関数定義）を含めることができます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st_blocks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド</font><font style="vertical-align: inherit;">は、既存のすべてのコードブロックをシンボルテーブルの1つの要素にマッピングしたものです。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st_top</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブル</font><b><font style="vertical-align: inherit;">エントリ</font></b><font style="vertical-align: inherit;">は、コンパイルされたモジュールのシンボルテーブル（モジュールもコードのブロックであることを思い出してください）であるため、グローバルモジュールの名前空間で定義された名前が含まれます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">st_cur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールド</font><font style="vertical-align: inherit;">は、現在処理されているコードブロックのシンボルテーブルのエントリを参照します。 「モジュールコードブ​​ロック」内の各コードブロックには、このコードブロックで定義された文字を含む独自の文字テーブルエントリがあります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/el/gr/1a/elgr1ajwa_cenmpdkjc1g_mfmnw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.1：文字とその中のエントリの表。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この場合も、</font><font style="vertical-align: inherit;">インクルード/ symtable.hファイル</font><font style="vertical-align: inherit;">の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_symtable_entry</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ</font><b><font style="vertical-align: inherit;">構造</font></b><font style="vertical-align: inherit;">を</font><b><font style="vertical-align: inherit;">確認</font></b><font style="vertical-align: inherit;">すると、その</font><b><font style="vertical-align: inherit;">仕組み</font></b><font style="vertical-align: inherit;">を理解するのに非常に役立ちます。このデータ構造をリスト3.8に示します。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">symtable_entry</span> {</span>
 <span class="hljs-number">2</span>      PyObject_HEAD
 <span class="hljs-number">3</span>      PyObject *ste_id;               <span class="hljs-comment">/* int: key in ste_table-&gt;st_blocks */</span>
 <span class="hljs-number">4</span>      PyObject *ste_symbols;          <span class="hljs-comment">/* dict: variable names to flags */</span>
 <span class="hljs-number">5</span>      PyObject *ste_name;             <span class="hljs-comment">/* string: name of current block */</span>
 <span class="hljs-number">6</span>      PyObject *ste_varnames;         <span class="hljs-comment">/* list of function parameters */</span>
 <span class="hljs-number">7</span>      PyObject *ste_children;         <span class="hljs-comment">/* list of child blocks */</span>
 <span class="hljs-number">8</span>      PyObject *ste_directives;       <span class="hljs-comment">/* locations of global and nonlocal 
 9                                       statements */</span>
<span class="hljs-number">10</span>      _Py_block_ty ste_type;          <span class="hljs-comment">/* module, class, or function */</span>
<span class="hljs-number">11</span>      <span class="hljs-keyword">int</span> ste_nested;                 <span class="hljs-comment">/* true if block is nested */</span>
<span class="hljs-number">12</span>      <span class="hljs-keyword">unsigned</span> ste_free : <span class="hljs-number">1</span>;          <span class="hljs-comment">/*true if block has free variables*/</span>
<span class="hljs-number">13</span>      <span class="hljs-keyword">unsigned</span> ste_child_free : <span class="hljs-number">1</span>;    <span class="hljs-comment">/* true if a child block has free 
14                                      vars including free refs to globals*/</span>
<span class="hljs-number">15</span>      <span class="hljs-keyword">unsigned</span> ste_generator : <span class="hljs-number">1</span>;     <span class="hljs-comment">/* true if namespace is a generator */</span>
<span class="hljs-number">16</span>      <span class="hljs-keyword">unsigned</span> ste_varargs : <span class="hljs-number">1</span>;       <span class="hljs-comment">/* true if block has varargs */</span>
<span class="hljs-number">17</span>      <span class="hljs-keyword">unsigned</span> ste_varkeywords : <span class="hljs-number">1</span>;   <span class="hljs-comment">/* true if block has varkeywords */</span>
<span class="hljs-number">18</span>      <span class="hljs-keyword">unsigned</span> ste_returns_value : <span class="hljs-number">1</span>; <span class="hljs-comment">/* true if namespace uses return with
19                                          an argument */</span>
<span class="hljs-number">20</span>      <span class="hljs-keyword">unsigned</span> ste_needs_class_closure : <span class="hljs-number">1</span>; <span class="hljs-comment">/* for class scopes, true if a
21                                              closure over __class__
22                                              should be created */</span>
<span class="hljs-number">23</span>      <span class="hljs-keyword">int</span> ste_lineno;          <span class="hljs-comment">/* first line of block */</span>
<span class="hljs-number">24</span>      <span class="hljs-keyword">int</span> ste_col_offset;      <span class="hljs-comment">/* offset of first line of block */</span>
<span class="hljs-number">25</span>      <span class="hljs-keyword">int</span> ste_opt_lineno;      <span class="hljs-comment">/* lineno of last exec or import * */</span>
<span class="hljs-number">26</span>      <span class="hljs-keyword">int</span> ste_opt_col_offset;  <span class="hljs-comment">/* offset of last exec or import * */</span>
<span class="hljs-number">27</span>      <span class="hljs-keyword">int</span> ste_tmpname;         <span class="hljs-comment">/* counter for listcomp temp vars */</span>
<span class="hljs-number">28</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">symtable</span> *<span class="hljs-title">ste_table</span>;</span>
<span class="hljs-number">29</span>  } PySTEntryObject;</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.8データ構造_symtable_entry</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ソースコード内のコメントは、各フィールドの機能を説明しています。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ste_symbols</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドに</font><font style="vertical-align: inherit;">は、コードブロックの分析時に検出される文字/名前のマッピングが含まれています。文字がマッピングされているフラグは、文字/名前が使用されているコンテキストに関する情報を提供する数値です。たとえば、シンボルは関数の引数やグローバル演算子の定義などです。 Include / symtable.hモジュールで定義されたこれらのフラグのいくつかの例をリスト3.9に示します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-number">1</span>  <span class="hljs-comment">/* Flags for def-use information */</span>
<span class="hljs-number">2</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEF_GLOBAL 1           <span class="hljs-comment">/* global stmt */</span></span>
<span class="hljs-number">3</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEF_LOCAL 2            <span class="hljs-comment">/* assignment in code block */</span></span>
<span class="hljs-number">4</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEF_PARAM 2&lt;&lt;1         <span class="hljs-comment">/* formal parameter */</span></span>
<span class="hljs-number">5</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEF_NONLOCAL 2&lt;&lt;2      <span class="hljs-comment">/* nonlocal stmt */</span></span>
<span class="hljs-number">6</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEF_FREE 2&lt;&lt;4          <span class="hljs-comment">/* name used but not defined in 
7                                    nested block */</span></span></code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.9名前を決定するためのコンテキストを定義するフラグ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
シンボルテーブルの説明に戻りましょう。リスト3.10のコードを含むモジュールがコンパイルされているとします。文字テーブルが作成された後、3つの文字テーブルエントリがあります。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_counter</span>():</span>
    count = <span class="hljs-number">0</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">counter</span>():</span>
        <span class="hljs-keyword">nonlocal</span> count <font></font>
        count += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> count
    <span class="hljs-keyword">return</span> counter</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.10。</font><font style="vertical-align: inherit;">単純なPython関数</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
最初のmake_counterエントリーはモジュールクロージャーであり、ローカルスコープによって定義されます。</font><font style="vertical-align: inherit;">シンボルテーブルの次のエントリは、make_counter関数に、countとcounterという名前がローカルとしてマークされていることです。</font><font style="vertical-align: inherit;">最後の文字テーブルエントリは、counterサブルーチンに関するものです。</font><font style="vertical-align: inherit;">無料としてマークされたカウント変数があります。</font><font style="vertical-align: inherit;">make_counterは文字テーブルエントリでローカルとして定義されていますが、* st_globalが* st_top文字（この場合は末尾のモジュールの文字）を指しているため、モジュールコードブ​​ロック自体ではグローバルと見なされることに注意してください。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASTからコードオブジェクトへ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイラの次のステップは、ASTとシンボルテーブルのおかげで取得した情報からコードオブジェクトを生成することです。これを担当する関数は、Python / compile.cモジュールに実装されています。コードオブジェクトを作成するプロセスは、複数の段階に分かれています。最初のステップでは、ASTが</font><font style="vertical-align: inherit;">Pythonバイトコード命令の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベースブロックに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変換され</font><font style="vertical-align: inherit;">ます。変換アルゴリズムは、シンボルテーブルの生成に使用されるものと似ています。compiler_visit_xx（xxはノードのタイプ）という名前の関数は、各ノードを再帰的に訪問し、バイトコード命令の基本ブロックを生成します。ベースブロックとそれらの間の接続は、グラフの形で表されます- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制御フローのグラフ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [約</font><b><font style="vertical-align: inherit;">CFG</font></b><font style="vertical-align: inherit;">とも呼ばれます</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-制御フローグラフ]。プログラムの実行中に使用できるコードパスを示します。 2番目の段階では、生成された制御フローのグラフは、深度グラフ検索（DFS）を使用して「平滑化」されます。グラフが平滑化された後、遷移オフセットが計算され、</font><font style="vertical-align: inherit;">バイトコードの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ジャンプ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令の引数として使用されます</font><font style="vertical-align: inherit;">。この命令セットからコードオブジェクトが生成されます。このプロセスをよりよく理解するために、リスト3.11のfizzbuzz関数を検討してください。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-number">1</span>     <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fizzbuzz</span>(<span class="hljs-params">n</span>):</span>
<span class="hljs-number">2</span>         <span class="hljs-keyword">if</span> n % <span class="hljs-number">3</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> n % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>:
<span class="hljs-number">3</span>             <span class="hljs-keyword">return</span> <span class="hljs-string">'FizzBuzz'</span>
<span class="hljs-number">4</span>         <span class="hljs-keyword">elif</span> n % <span class="hljs-number">3</span> == <span class="hljs-number">0</span>:
<span class="hljs-number">5</span>             <span class="hljs-keyword">return</span> <span class="hljs-string">'Fizz'</span>
<span class="hljs-number">6</span>         <span class="hljs-keyword">elif</span> n % <span class="hljs-number">5</span> == <span class="hljs-number">0</span>:
<span class="hljs-number">7</span>             <span class="hljs-keyword">return</span> <span class="hljs-string">'Buzz'</span>
<span class="hljs-number">8</span>         <span class="hljs-keyword">else</span>:
<span class="hljs-number">9</span>             <span class="hljs-keyword">return</span> str(n)</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.11</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この関数</font><i><font style="vertical-align: inherit;">の単純なpython</font></i><font style="vertical-align: inherit;"> AST </font><i><font style="vertical-align: inherit;">関数</font></i><font style="vertical-align: inherit;">を図3.2に示します。</font></font><br>
<img src="https://habrastorage.org/webt/bw/j0/rg/bwj0rglts7capafb7f9dytkpmku.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.2：リスト3.2の非常に単純なAST。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
図3.2のこのASTは、CFGにコンパイルされると、図3.3に示すようなグラフを返します。図中の空ブロックは省略しています。このグラフを調べると、基本ブロックの背後に隠されているものに関する情報が得られます。基本ユニットには1つのエントリポイントがありますが、複数の出力を持つことができます。これらのブロックについては、以下で詳しく説明します。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fc/93/xt/fc93xtxbvcmzwwkfkr_x_bf46r0.jpeg"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.3：リスト3.11のfizzbuzz関数の制御フローグラフ。</font><font style="vertical-align: inherit;">直線は通常の簡単なコード実行を表し、曲線は「ジャンプ」を表します。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下の説明には、実際の手順のみが含まれています。</font><font style="vertical-align: inherit;">一部の命令には引数が必要ですが、現在は興味がないため、削除されました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロック1には、図3.2のASTのBoolOpノードである命令が含まれています。</font><font style="vertical-align: inherit;">このブロックの命令は、次の11個のコマンドセットを使用して、n％3 == 0およびn％5 == 0の演算を実装します。</font></font><br>
<br>
<pre><code class="python hljs">LOAD_FAST               <font></font>
LOAD_CONST              <font></font>
BINARY_MODULO<font></font>
LOAD_CONST              <font></font>
COMPARE_OP              <font></font>
JUMP_IF_FALSE_OR_POP    <font></font>
LOAD_FAST               <font></font>
LOAD_CONST              <font></font>
BINARY_MODULO<font></font>
LOAD_CONST              <font></font>
COMPARE_OP</code></pre><br>
,     if ( ,  ,     )     .    ,     .     3.3,       :      ,      2   JUMP_IF_FALSE_OR_POP.</li>
<li> 2     if,   if   .      :<br>
<br>
<pre><code class="cpp hljs">POP_JUMP_IF_FALSE<font></font>
LOAD_CONST<font></font>
RETURN_VALUE<font></font>
JUMP_FORWARD</code></pre><br>
     ,     -   if,                  -,           .   POP_JUMP_IF_FALSE   .    ,      .   :     BoolOp   if    ?    ,  python      .  ,   n%3==0  false,  n%5==0    .          JUMP_IF_FALSE_OR_POP    .       jump,  ,  « ».            . JUMP_IF_FALSE_OR_POP   «»,    ,       «»  -       POP_JUMP_IF_FALSE    if.    «»  ,     if   .      ,       BoolOp,    ,     if.<br>
</li>
<li> 3    <b>orElse</b>  AST    9 :<br>
<br>
<pre><code class="cpp hljs">LOAD_FAST<font></font>
LOAD_CONST<font></font>
BINARY_MODULO<font></font>
LOAD_CONST<font></font>
COMPARE_OP<font></font>
POP_JUMP_IF_FALSE<font></font>
LOAD_CONST<font></font>
return_value<font></font>
JUMP_FORWARD</code></pre><br>
,    elif,  n%3==0,        .   ,   .      —  «»   if,          ,     ,      if  .</li>
<li> 4       3    ,     .</li>
<li> 5     orElse    4 :<br>
<br>
<pre><code class="cpp hljs">LOAD_GLOBAL<font></font>
LOAD_FAST<font></font>
call_function<font></font>
return_value</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LOAD_GLOBAL関数は、従来のstr関数を引数として取り、それを値スタックにロードします。</font><font style="vertical-align: inherit;">LOAD_FASTは引数nをスタックにロードし、return_valueはCALL_FUNCTIONを通じて受け取った値を返します。</font><font style="vertical-align: inherit;">str（n）命令を介して。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前のセクションと同様に、このプロセスをよりよく理解するために、基本ブロックの構築に使用されるデータ構造を検討します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ構造：コンパイラ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
図3.4は、制御フローグラフを構成する基本ブロックを生成するプロセスで使用される主なデータ構造間の関係を示しています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gu/vi/he/guvihekbyxdqstvud3wv98lldqw.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">図3.4：コードオブジェクトの作成に使用される4つの基本的なデータ構造 </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最高レベルは、グローバルモジュールのコンパイルプロセスを担当するコンパイラデータ構造です。</font><font style="vertical-align: inherit;">このデータ構造はリスト3.12で定義されています。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">compiler</span> {</span>
 <span class="hljs-number">2</span>      PyObject *c_filename;
 <span class="hljs-number">3</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">symtable</span> *<span class="hljs-title">c_st</span>;</span>
 <span class="hljs-number">4</span>      PyFutureFeatures *c_future; <span class="hljs-comment">/* pointer to module's __future__ */</span>
 <span class="hljs-number">5</span>      PyCompilerFlags *c_flags;
 <span class="hljs-number">6</span>          
 <span class="hljs-number">7</span>      <span class="hljs-keyword">int</span> c_optimize;              <span class="hljs-comment">/* optimization level */</span>
 <span class="hljs-number">8</span>      <span class="hljs-keyword">int</span> c_interactive;           <span class="hljs-comment">/* true if in interactive mode */</span>
 <span class="hljs-number">9</span>      <span class="hljs-keyword">int</span> c_nestlevel;
<span class="hljs-number">10</span>          
<span class="hljs-number">11</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">compiler_unit</span> *<span class="hljs-title">u</span>;</span> <span class="hljs-comment">/* compiler state for current block */</span>
<span class="hljs-number">12</span>      PyObject *c_stack;           <span class="hljs-comment">/* Python list holding compiler_unit 
13                                  ptrs */</span>
<span class="hljs-number">14</span>      PyArena *c_arena;            <span class="hljs-comment">/* pointer to memory allocation arena */</span>
<span class="hljs-number">15</span>  };</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.12 </font><font style="vertical-align: inherit;">コンパイラーのデータ構造</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ここで私たちにとって重要なフィールドは次のとおりです。</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* c_st-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前のセクションで作成されたシンボルテーブルへのリンク。</font></font></li>
<li><b>*u</b> —     <b>compiler unit</b>.         .     compiler unit    .</li>
<li><b>*c_stack</b> —      compiler_unit.     ,         compile_unit    .       ,    ,   compiler_enter_scope()  «push»  compiler_unit (*u)   *c_stack,      compiler_unit      .     ,   «pop»   *c_stack,      .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイラー構造は、コンパイルされたモジュールごとに初期化されます。</font><font style="vertical-align: inherit;">使用されるモジュールごとにASTが生成されるのと同じように、compiler_unit構造もASTのコードブロックごとに作成されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ構造：compiler_unit</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下のリスト3.13に示すcompiler_unitデータ構造は、必要なバイトコード命令をコードブロックで生成するために必要な情報を収集します。</font><font style="vertical-align: inherit;">compiler_unitで定義されているほとんどのフィールドは、コードオブジェクトを調べるときに検出されます。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">compiler_unit</span> {</span>
 <span class="hljs-number">2</span>      PySTEntryObject *u_ste;
 <span class="hljs-number">3</span>        
 <span class="hljs-number">4</span>      PyObject *u_name;
 <span class="hljs-number">5</span>      PyObject *u_qualname;  <span class="hljs-comment">/* dot-separated qualified name (lazy) */</span>
 <span class="hljs-number">6</span>      <span class="hljs-keyword">int</span> u_scope_type;
 <span class="hljs-number">7</span>      
 <span class="hljs-number">8</span>      <span class="hljs-comment">/* The following fields are dicts that map objects to
 9      the index of them in co_XXX.      The index is used as
10      the argument for opcodes that refer to those collections.
11      */</span>
<span class="hljs-number">12</span>      PyObject *u_consts;    <span class="hljs-comment">/* all constants */</span>
<span class="hljs-number">13</span>      PyObject *u_names;     <span class="hljs-comment">/* all names */</span>
<span class="hljs-number">14</span>      PyObject *u_varnames;  <span class="hljs-comment">/* local variables */</span>
<span class="hljs-number">15</span>      PyObject *u_cellvars;  <span class="hljs-comment">/* cell variables */</span>
<span class="hljs-number">16</span>      PyObject *u_freevars;  <span class="hljs-comment">/* free variables */</span>
<span class="hljs-number">17</span>         
<span class="hljs-number">18</span>      PyObject *u_private;        <span class="hljs-comment">/* for private name mangling */</span>
<span class="hljs-number">19</span>            
<span class="hljs-number">20</span>      Py_ssize_t u_argcount;        <span class="hljs-comment">/* number of arguments for block */</span>
<span class="hljs-number">21</span>      Py_ssize_t u_kwonlyargcount; <span class="hljs-comment">/* number of keyword only arguments 
22                                      for block */</span>
<span class="hljs-number">23</span>      <span class="hljs-comment">/* Pointer to the most recently allocated block.  By following b_list
24      members, you can reach all early allocated blocks. */</span>
<span class="hljs-number">25</span>      basicblock *u_blocks;
<span class="hljs-number">26</span>      basicblock *u_curblock; <span class="hljs-comment">/* pointer to current block */</span>
<span class="hljs-number">27</span>            
<span class="hljs-number">28</span>      <span class="hljs-keyword">int</span> u_nfblocks;
<span class="hljs-number">29</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">fblockinfo</span> <span class="hljs-title">u_fblock</span>[<span class="hljs-title">CO_MAXBLOCKS</span>];</span>
<span class="hljs-number">30</span>          
<span class="hljs-number">31</span>      <span class="hljs-keyword">int</span> u_firstlineno; <span class="hljs-comment">/* the first lineno of the block */</span>
<span class="hljs-number">32</span>      <span class="hljs-keyword">int</span> u_lineno;          <span class="hljs-comment">/* the lineno for the current stmt */</span>
<span class="hljs-number">33</span>      <span class="hljs-keyword">int</span> u_col_offset;      <span class="hljs-comment">/* the offset of the current stmt */</span>
<span class="hljs-number">34</span>      <span class="hljs-keyword">int</span> u_lineno_set;  <span class="hljs-comment">/* boolean to indicate whether instr
35                          has been generated with current lineno */</span>
<span class="hljs-number">36</span>  };</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.13 </font></font></i><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Compiler_unit </font></b><i><font style="vertical-align: inherit;">データ構造</font></i><b><font style="vertical-align: inherit;">u_blocks</font></b><font style="vertical-align: inherit;">と</font><b><font style="vertical-align: inherit;">u_curblockフィールドが</font></b><font style="vertical-align: inherit;">一緒にコンパイルされたコードブロックを構成するベースブロックを指します。</font><b><font style="vertical-align: inherit;">* u_steフィールドは、</font></b><font style="vertical-align: inherit;">コンパイルされたコードブロックの文字テーブルのエントリへの参照です。</font><font style="vertical-align: inherit;">残りのフィールドには、それ自体がわかるかなり明確な名前があります。</font><font style="vertical-align: inherit;">コンパイル中、コードブロックを構成するさまざまなノードはバイパスされます。</font><font style="vertical-align: inherit;">このタイプのユニットが新しいベースユニットを開始するかどうかに応じて、ベースユニットが作成されるか（これらのノードの命令を含む）、またはノードの命令が既存のベースユニットに追加されます。</font><font style="vertical-align: inherit;">新しい基本ユニットを開始できる最も一般的なタイプのノードは次のとおりです。</font></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能ノード。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ジャンプ」を行う必要があるノード。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例外ハンドラ。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブール演算など</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic_blockおよび命令データ構造</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ベースユニットのデータ構造は、制御フローグラフを生成するプロセスフローの一部として非常に興味深いものです。</font><font style="vertical-align: inherit;">基本ユニットは、1つのエントリポイントを持つが、いくつかの出口ポイントを持つ一連の命令です。</font><font style="vertical-align: inherit;">Python仮想マシンで使用される</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic_block</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ構造の定義を</font><font style="vertical-align: inherit;">リスト3.14に示します。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  <span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">basicblock_</span> {</span>
 <span class="hljs-number">2</span>      <span class="hljs-comment">/* Each basicblock in a compilation unit is linked via b_list in the
 3      reverse order that the block are allocated.  b_list points to the next
 4      block, not to be confused with b_next, which is next by control flow. */</span>
 <span class="hljs-number">5</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">basicblock_</span> *<span class="hljs-title">b_list</span>;</span>
 <span class="hljs-number">6</span>      <span class="hljs-comment">/* number of instructions used */</span>
 <span class="hljs-number">7</span>      <span class="hljs-keyword">int</span> b_iused;
 <span class="hljs-number">8</span>      <span class="hljs-comment">/* length of instruction array (b_instr) */</span>
 <span class="hljs-number">9</span>      <span class="hljs-keyword">int</span> b_ialloc;
<span class="hljs-number">10</span>      <span class="hljs-comment">/* pointer to an array of instructions, initially NULL */</span>
<span class="hljs-number">11</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">instr</span> *<span class="hljs-title">b_instr</span>;</span>
<span class="hljs-number">12</span>      <span class="hljs-comment">/* If b_next is non-NULL, it is a pointer to the next
13      block reached by normal control flow. */</span>
<span class="hljs-number">14</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">basicblock_</span> *<span class="hljs-title">b_next</span>;</span>
<span class="hljs-number">15</span>      <span class="hljs-comment">/* b_seen is used to perform a DFS of basicblocks. */</span>
<span class="hljs-number">16</span>      <span class="hljs-keyword">unsigned</span> b_seen : <span class="hljs-number">1</span>;
<span class="hljs-number">17</span>      <span class="hljs-comment">/* b_return is true if a RETURN_VALUE opcode is inserted. */</span>
<span class="hljs-number">18</span>      <span class="hljs-keyword">unsigned</span> b_return : <span class="hljs-number">1</span>;
<span class="hljs-number">19</span>      <span class="hljs-comment">/* depth of stack upon entry of block, computed by stackdepth() */</span>
<span class="hljs-number">20</span>      <span class="hljs-keyword">int</span> b_startdepth;
<span class="hljs-number">21</span>      <span class="hljs-comment">/* instruction offset for block, computed by assemble_jump_offsets() */</span>
<span class="hljs-number">22</span>      <span class="hljs-keyword">int</span> b_offset;
<span class="hljs-number">23</span>  } basicblock;</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.14 </font><font style="vertical-align: inherit;">basicblock_データ構造</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
前述のように、CFGは主に基本ブロックとそれらの間の接続「パス」で構成されます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィールドb_instr *は、</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の配列を指す</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ構造</font><font style="vertical-align: inherit;">と、これらのデータ構造のそれぞれは、命令バイトコードを含んでいます。</font><font style="vertical-align: inherit;">これらのバイトコードは、インクルード/ opcode.hヘッダーファイルにあります。</font><font style="vertical-align: inherit;">命令のデータ構造をリスト3.15に示します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-number">1</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">instr</span> {</span>
<span class="hljs-number">2</span>      <span class="hljs-keyword">unsigned</span> i_jabs : <span class="hljs-number">1</span>;
<span class="hljs-number">3</span>      <span class="hljs-keyword">unsigned</span> i_jrel : <span class="hljs-number">1</span>;
<span class="hljs-number">4</span>      <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> i_opcode;
<span class="hljs-number">5</span>      <span class="hljs-keyword">int</span> i_oparg;
<span class="hljs-number">6</span>      <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">basicblock_</span> *<span class="hljs-title">i_target</span>;</span> <span class="hljs-comment">/* target block (if jump instruction) */</span>
<span class="hljs-number">7</span>      <span class="hljs-keyword">int</span> i_lineno;
<span class="hljs-number">8</span>  };</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.15命令のデータ構造</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
fizzbuzz関数のCFGをもう一度見てください。ブロック1からブロック2に移動するには、実際には2つの方法があることがわかります。1つ目は通常の実行で、ブロック1のすべての命令が実行されるため、実行フローはブロック2で自動的に続行されます。2つ目は遷移命令です。最初の比較操作の直後にこれを確認しました。このようなジャンプ命令の「目標」は別の基本単位ですが、実際には、仮想マシンは基本単位について何も知らないコードオブジェクトを実行します。コードブロックには、オフセットを使用してインデックスが付けられたバイトコードストリームのみが含まれます。ジャンプの「目標」を持つブロックを取得して、それらを命令配列のオフセットに置き換える必要があることがわかりました。これは、基本ブロックを構築する構築プロセスが行うことです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベースユニット組立</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CFGが生成された後、ベースブロックにはASTを表すバイトコード命令が含まれます。</font><font style="vertical-align: inherit;">ただし、ブロックは線形に並べられておらず、遷移命令には、コマンドのフロー内の相対または絶対オフセットではなく、遷移の目標として基本ブロックが含まれています。</font><font style="vertical-align: inherit;">アセンブル関数は、CFGの線形化とCFGからのコードオブジェクトの作成を処理します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、基本ブロックアセンブリ関数は</font><font style="vertical-align: inherit;">、RETURNステートメントなしで終了するすべてのブロックに</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">return Noneステートメント</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">追加します</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これで、RETURNを追加せずにメソッドを定義できる理由がわかりました。</font><font style="vertical-align: inherit;">これに続いて、ブロックを「滑らかにする」ために、CFGグラフの予備のポストオーダートラバーサル（子はルートノードの前に訪問されます）が続きます。</font></font><br>
<br>
<blockquote><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">走査を数える</font></font></h3><br>
<img src="https://habrastorage.org/webt/bv/wy/rd/bvwyrdhnlct4wx-u_rl-1b-xv-e.png"><br>
 post-order depth-first         ,       ,    .      3.5,       ,    H -&gt; D -&gt; I -&gt; J -&gt; E -&gt; B -&gt; K -&gt; L -&gt; F -&gt; G -&gt; C -&gt; A.   pre-order ,    A -&gt; B -&gt; D -&gt; H -&gt; E -&gt; I -&gt; J -&gt; C -&gt; F -&gt; K -&gt; L -&gt; G.     in-order,    : H -&gt; D -&gt; B -&gt; I -&gt; E -&gt; J -&gt; A -&gt; K -&gt; L -&gt; F -&gt; C -&gt; G<br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リスト3.3のfizzbuzz関数のCFGはかなり単純なグラフであるため、ポストオーダートラバーサルの結果は次のようになります。ブロック5-&gt;ブロック4-&gt;ブロック3-&gt;ブロック2-&gt;ブロック1.グラフが線形化されると（つまり、 E.スムーズ）、「ジャンプ」のオフセットは、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assemble_jump_offsets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数を呼び出し</font><font style="vertical-align: inherit;">て受信したグラフに渡す</font><font style="vertical-align: inherit;">ことで計算でき</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ジャンプオフセットの計算は2段階で行われます。リスト3.16のフラグメントに示すように、最初の段階で、命令配列内の各命令のオフセットが計算されます。これは、平滑化された配列の最後から実行され、0からのオフセットを作成する単純なループです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-number">1</span>  ...
<span class="hljs-number">2</span>  totsize = <span class="hljs-number">0</span>;
<span class="hljs-number">3</span>  <span class="hljs-keyword">for</span> (i = a-&gt;a_nblocks - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
<span class="hljs-number">4</span>      b = a-&gt;a_postorder[i];
<span class="hljs-number">5</span>      bsize = blocksize(b);
<span class="hljs-number">6</span>      b-&gt;b_offset = totsize;
<span class="hljs-number">7</span>      totsize += bsize;
<span class="hljs-number">8</span>  }
<span class="hljs-number">9</span>  ...</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.16バイトコードオフセットの計算</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
2番目のステップでは、リスト3.17に示すように、遷移命令のジャンプターゲットが計算されます。遷移中の相対変位が計算され、それらの絶対値が置き換えられます。</font></font><br>
<br>
<pre><code class="cpp hljs"> <span class="hljs-number">1</span>  ...
 <span class="hljs-number">2</span>   <span class="hljs-keyword">for</span> (b = c-&gt;u-&gt;u_blocks; b != <span class="hljs-literal">NULL</span>; b = b-&gt;b_list) {
 <span class="hljs-number">3</span>      bsize = b-&gt;b_offset;
 <span class="hljs-number">4</span>      <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; b-&gt;b_iused; i++) {
 <span class="hljs-number">5</span>          <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">instr</span> *<span class="hljs-title">instr</span> = &amp;<span class="hljs-title">b</span>-&gt;<span class="hljs-title">b_instr</span>[<span class="hljs-title">i</span>];</span>
 <span class="hljs-number">6</span>          <span class="hljs-keyword">int</span> isize = instrsize(instr-&gt;i_oparg);
 <span class="hljs-number">7</span>          <span class="hljs-comment">/* Relative jumps are computed relative to
 8             the instruction pointer after fetching
 9             the jump instruction.
10          */</span>
<span class="hljs-number">11</span>          bsize += isize;
<span class="hljs-number">12</span>          <span class="hljs-keyword">if</span> (instr-&gt;i_jabs || instr-&gt;i_jrel) {
<span class="hljs-number">13</span>              instr-&gt;i_oparg = instr-&gt;i_target-&gt;b_offset;
<span class="hljs-number">14</span>              <span class="hljs-keyword">if</span> (instr-&gt;i_jrel) {
<span class="hljs-number">15</span>                  instr-&gt;i_oparg -= bsize;
<span class="hljs-number">16</span>              }
<span class="hljs-number">17</span>              instr-&gt;i_oparg *= <span class="hljs-keyword">sizeof</span>(_Py_CODEUNIT);
<span class="hljs-number">18</span>              <span class="hljs-keyword">if</span> (instrsize(instr-&gt;i_oparg) != isize) {
<span class="hljs-number">19</span>                  extended_arg_recompile = <span class="hljs-number">1</span>;
<span class="hljs-number">20</span>              }
<span class="hljs-number">21</span>          }
<span class="hljs-number">22</span>      }
<span class="hljs-number">23</span>  }
<span class="hljs-number">24</span>  ...</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスト3.17 </font><font style="vertical-align: inherit;">遷移オフセットのアセンブリ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
計算された「ジャンプ」オフセットは、線形化中の走査と逆の順序で平滑化されたグラフに追加されます。</font><font style="vertical-align: inherit;">逆ポストオーダーは、CFGのトポロジカルソートです。</font><font style="vertical-align: inherit;">これは、頂点</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から頂点</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">までの各エッジで</font><font style="vertical-align: inherit;">、uがvの前にソート順に移動</font><font style="vertical-align: inherit;">することを意味し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">この理由は明白です。別の場所にジャンプするノードは、常に「遷移目標」の前にある必要があります。</font><font style="vertical-align: inherit;">バイトコード転送の完了後、受信したバイトコードとシンボルテーブルからの情報を使用して、コードブロックごとにコードオブジェクトを収集できます。</font><font style="vertical-align: inherit;">生成されたコードオブジェクトは呼び出し側の関数に返され、コンパイルプロセスの終了を示します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja501904/index.html">常に手袋を着用すると、皮膚はどうなりますか</a></li>
<li><a href="../ja501906/index.html">DINS QA EVENING（オンライン）：WebRTCベースのサービスをテストするケースと、不安定なテストの実行を回避する方法</a></li>
<li><a href="../ja501910/index.html">ユーザーはこのすべてを必要としません！Linuxの宣伝をやめる</a></li>
<li><a href="../ja501914/index.html">最新のWebライブ2020のストリーミング-無期限のベストUXプラクティス</a></li>
<li><a href="../ja501918/index.html">本「ゲームデザイン。スーパーマリオやドゥームからアサシンクリードまで、最高のコンピューターゲームを成功させるためのレシピ»</a></li>
<li><a href="../ja501922/index.html">待っていなかったIoT。開発とテスト（パート1）</a></li>
<li><a href="../ja501924/index.html">50円のベン図を作成する方法は？セットの可視化と私のオープンソースPythonプロジェクトの歴史</a></li>
<li><a href="../ja501928/index.html">PMオンラインmitap、Atlassian（Jira）、Wrike、およびProductboardのスピーカー</a></li>
<li><a href="../ja501930/index.html">Springはその動作をカスタマイズするためにどのような機会を提供しますか？</a></li>
<li><a href="../ja501932/index.html">SegezhaフォレストホールディングでのAIプロジェクトの実装を加速</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>