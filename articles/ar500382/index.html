<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฑ๏ธ ๐ข ๐ง๐ฟโ๐คโ๐ง๐ฟ ุชูุงูู Aviasales API ูุน Amazon Kinesis ูุงูุจุณุงุทุฉ ุจุฏูู ุฎุงุฏู ๐ถ๐พ ๐๏ธ ๐ซ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุงุจุฑ! 
 
 ูู ุชุญุจ ุฃู ุชุทูุฑ ุงูุทุงุฆุฑุงุชุ ุฃูุง ุฃุญุจ ุฐูู ุ ูููู ุนูู ุงูุนุฒูุฉ ุงูุฐุงุชูุฉ ุ ุฃุญุจุจุช ุฃูุถูุง ุชุญููู ุจูุงูุงุช ุงูุณูุฑ ุงูุฌูู ูููุฑุฏ ูุงุญุฏ ูุนุฑูู - Aviasales....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุชูุงูู Aviasales API ูุน Amazon Kinesis ูุงูุจุณุงุทุฉ ุจุฏูู ุฎุงุฏู</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500382/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุญุจุง ูุง ูุงุจุฑ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุชุญุจ ุฃู ุชุทูุฑ ุงูุทุงุฆุฑุงุชุ </font><font style="vertical-align: inherit;">ุฃูุง ุฃุญุจ ุฐูู ุ ูููู ุนูู ุงูุนุฒูุฉ ุงูุฐุงุชูุฉ ุ ุฃุญุจุจุช ุฃูุถูุง ุชุญููู ุจูุงูุงุช ุงูุณูุฑ ุงูุฌูู ูููุฑุฏ ูุงุญุฏ ูุนุฑูู - Aviasales. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููู ุณูููู ุจุชุญููู ุนูู Amazon Kinesis ุ ูุจูุงุก ูุธุงู ุฏูู ูุน ุชุญูููุงุช ูู ุงูููุช ุงูุญูููู ุ ููุถุน ูุงุนุฏุฉ ุจูุงูุงุช Amazon DynamoDB NoSQL ููุฎุฒู ุจูุงูุงุช ุฑุฆูุณู ูุฅุนุฏุงุฏ ุชูุจููุงุช SMS ูุชุฐุงูุฑ ูุซูุฑุฉ ููุงูุชูุงู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุชูุงุตูู ุชุญุช ุงููุทุน! </font><font style="vertical-align: inherit;">ุงุฐูุจ!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-n/qn/yn/-nqnynmwzv61pmiq2ocatoxseme.jpeg"></div><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏูุฉ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชุงุฌ ุฅูู ุงููุตูู ุฅูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviasales API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุชู ุชูููุฑ ุงููุตูู ุฅููู ูุฌุงููุง ูุจุฏูู ูููุฏ ุ ูุง ุนููู ุณูู ุงูุชุณุฌูู ูู ูุณู "ุงููุทูุฑูู" ููุญุตูู ุนูู ุฑูุฒ API ุงูุฎุงุต ุจู ูููุตูู ุฅูู ุงูุจูุงูุงุช.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุบุฑุถ ุงูุฑุฆูุณู ูู ูุฐู ุงูููุงูุฉ ูู ุฅุนุทุงุก ููู ุนุงู ูุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุชุฏูู ูู AWS ุ ููุฌุนู ูู ุบูุฑ ุงููุณุชุจุนุฏ ุฃู ุงูุจูุงูุงุช ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุณุชุฎุฏูุฉ ููุณุช ุฐุงุช ุตูุฉ ุตุงุฑูุฉ ููุชู ููููุง ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุงูุชู ูุชู ุฅูุดุงุคูุง ุงุณุชูุงุฏูุง ุฅูู ุนูููุงุช ุงูุจุญุซ ุนู ูุณุชุฎุฏูู ููุงูุน Aviasales.ru ู Jetradar.com ุขุฎุฑ 48 ุณุงุนุฉ. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณูุชู ุชุญููู ุจูุงูุงุช ุชุฐูุฑุฉ ุทูุฑุงู ูููู Kinesis ุงููุณุชููุฉ ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงููุซุจุชุฉ ุนูู ุฌูุงุฒ ุงูููุชุฌ ุชููุงุฆููุง ูููููุง ุฅูู ุงูุชุฏูู ุงููุทููุจ ูู ุฎูุงู Kinesis Data Analytics. </font><font style="vertical-align: inherit;">ุณุชุชู ูุชุงุจุฉ ูุณุฎุฉ ุบูุฑ ูุนุงูุฌุฉ ูู ูุฐุง ุงูุฏูู ูุจุงุดุฑุฉ ุฅูู ุงููุณุชูุฏุน. </font><font style="vertical-align: inherit;">ุงููุดุฑ ูู DynamoDB ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฎุงู ุณูุณูุญ ุจุชุญููู ุฃูุซุฑ ุชุนููุง ููุชุฐุงูุฑ ูู ุฎูุงู ุฃุฏูุงุช BI ุ ูุซู AWS Quick Sight. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณููุธุฑ ูู ุฎูุงุฑูู ููุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงููุงูู:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏููู - ูู ุฎูุงู ูุญุฏุฉ ุชุญูู ุฅุฏุงุฑุฉ AWS ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ููุฏ Terraform - ููููุฏุณู ุงูุฃุชูุชุฉ ุงูุจุทูุฆุฉ ุ</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจููุฉ ุงููุธุงู ููุฏ ุงูุชุทููุฑ</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vt/ss/mx/vtssmx0accvfcphkjvmzwdf4udg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูููููุงุช ุงููุณุชุฎุฏูุฉ:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aviasales API</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุณูุชู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฐู ูุฌููุน ุงูุฃุนูุงู ุงููุงุญูุฉ ุ</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุซูู ููุชุฌ EC2</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุฌูุงุฒ ุงูุชุฑุงุถู ููุชุธู ูู ุงูุณุญุงุจุฉ ุณูุชู ุฅูุดุงุก ุฏูู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุนููู:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู Kinesis</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุชุทุจูู Java ูุซุจุช ูุญูููุง ูููุฑ ุทุฑููุฉ ุณููุฉ ูุฌูุน ุงูุจูุงูุงุช ูุฅุฑุณุงููุง ุฅูู Kinesis (Kinesis Data Streams ุฃู Kinesis Firehose). </font><font style="vertical-align: inherit;">ูุฑุงูุจ ุงููููู ุจุงุณุชูุฑุงุฑ ูุฌููุนุฉ ูู ุงููููุงุช ูู ุงูุฏูุงุฆู ุงููุญุฏุฏุฉ ููุฑุณู ุจูุงูุงุช ุฌุฏูุฏุฉ ุฅูู Kinesis ุ</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caller API Script</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูุต ุจุฑูุฌู Python ูุฌุนู ุทูุจุงุช API ููุถุน ุงูุงุณุชุฌุงุจุฉ ูู ูุฌูุฏ ูุฑุงูุจู ุนุงูู Kinesis ุ</font></font></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b>Kinesis Data Streams</b></a> โ            ;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b>Kinesis Analytics</b></a> โ  ,        . Amazon Kinesis Data Analytics              ;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b>AWS Lambda</b></a> โ ,        .        ;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b>Amazon DynamoDB</b></a> โ    ยซโยป  ,     10      .   DynamoDB    - ,       . DynamoDB   ,        .       ;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><b>Amazon SNS</b></a> โ        ยซ โ ยป (Pub/Sub),      ,     . SNS           push-, SMS-   .</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฏุฑูุจ ุงููู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุญุงูุงุฉ ุชุฏูู ุงูุจูุงูุงุช ุ ูุฑุฑุช ุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุทูุฑุงู ุงูุชู ุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ Aviasales API. </font><font style="vertical-align: inherit;">ุชุญุชูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุซุงุฆู ุนูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงุฆูุฉ ุดุงููุฉ ุฅูู ุญุฏ ูุง ูู ุงูุทุฑู ุงููุฎุชููุฉ ุ ุฎุฐ ูุงุญุฏุฉ ูููุง - "ุชูููู ุงูุฃุณุนุงุฑ ููุดูุฑ" ุ ุงูุฐู ูุนูุฏ ุงูุฃุณุนุงุฑ ููู ููู ูู ุงูุดูุฑ ุ ูุฌูุนุฉ ุญุณุจ ุนุฏุฏ ุงูุชุญูููุงุช. </font><font style="vertical-align: inherit;">ุฅุฐุง ูู ุชุฑุณู ุดูุฑ ุงูุจุญุซ ูู ุงูุทูุจ ุ ูุณูุชู ุฅุฑุฌุงุน ุงููุนูููุงุช ููุดูุฑ ุงูุฐู ููู ุงูุดูุฑ ุงูุญุงูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐุง ุ ุณุฌู ุ ุงุญุตู ุนูู ุฑูุฒู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุทูุจ ุงููุซุงู ุฃุฏูุงู:</font></font><br>
<br>
<pre><code class="bash hljs">http://api.travelpayouts.com/v2/prices/month-matrix?currency=rub&amp;origin=LED&amp;destination=HKT&amp;show_to_affiliates=<span class="hljs-literal">true</span>&amp;token=TOKEN_API</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณุชุนูู ุงูุทุฑููุฉ ุงููุฐููุฑุฉ ุฃุนูุงู ูุชููู ุงูุจูุงูุงุช ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุน ุงูุฑูุฒ ุงููููุฒ ูู ุงูุทูุจ ุ ููููู ุฃูุถู ุชูุฑูุฑ ุฑูุฒ ุงูุฏุฎูู ุนุจุฑ ุงูุฑุฃุณ ุ ูุฐูู ุณูุณุชุฎุฏู ูุฐู ุงูุทุฑููุฉ ูู ุงูุจุฑูุงูุฌ ุงููุตู api_caller.py. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฌูุงุจ ุงููุซุงู:</font></font><br>
<br>
<pre><code class="json hljs">{{
   <span class="hljs-attr">"success"</span>:<span class="hljs-literal">true</span>,
   <span class="hljs-attr">"data"</span>:[{
      <span class="hljs-attr">"show_to_affiliates"</span>:<span class="hljs-literal">true</span>,
      <span class="hljs-attr">"trip_class"</span>:<span class="hljs-number">0</span>,
      <span class="hljs-attr">"origin"</span>:<span class="hljs-string">"LED"</span>,
      <span class="hljs-attr">"destination"</span>:<span class="hljs-string">"HKT"</span>,
      <span class="hljs-attr">"depart_date"</span>:<span class="hljs-string">"2015-10-01"</span>,
      <span class="hljs-attr">"return_date"</span>:<span class="hljs-string">""</span>,
      <span class="hljs-attr">"number_of_changes"</span>:<span class="hljs-number">1</span>,
      <span class="hljs-attr">"value"</span>:<span class="hljs-number">29127</span>,
      <span class="hljs-attr">"found_at"</span>:<span class="hljs-string">"2015-09-24T00:06:12+04:00"</span>,
      <span class="hljs-attr">"distance"</span>:<span class="hljs-number">8015</span>,
      <span class="hljs-attr">"actual"</span>:<span class="hljs-literal">true</span><font></font>
   }]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุถุญ ูุซุงู ุฑุฏ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ุฃุนูุงู ุชุฐูุฑุฉ ูู ุณุงูุช ุจุทุฑุณุจุฑุบ ุฅูู ุจูู ... ุฃูู ุ ูุง ุงูุฐู ุชุญูู ุจู ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุฃููู ูู ูุงุฒุงู ุ ูููููุช "ูุญูู ุจูุง ููุท" ุงูุขู ุ ุณูุจุญุซ ุนู ุชุฐุงูุฑ ูู ุณุงูุช ุจุทุฑุณุจุฑุบ ุฅูู ูุงุฒุงู.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุชุฑุถ ุฃู ูุฏูู ุจุงููุนู ุญุณุงุจ AWS. </font><font style="vertical-align: inherit;">ุฃุฑูุฏ ุฃู ุฃูุชุจู ุจุดูู ุฎุงุต ููุฑูุง ุฅูู ุฃู Kinesis ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุฑุณุงุฆู ุงููุตูุฑุฉ ูุง ูุชู ุชุถูููููุง ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณุชูู ุงููุฌุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุณููู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">(ุงูุงุณุชุฎุฏุงู ุงููุฌุงูู)</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูููู ุนูู ุงูุฑุบู ูู ุฐูู ุ ูุน ุฃุฎุฐ ุฏููุงุฑูู ูู ุงูุงุนุชุจุงุฑ ุ ููู ุงููููู ุชูุงููุง ุจูุงุก ุงููุธุงู ุงูููุชุฑุญ ูุงููุนุจ ุจู. </font><font style="vertical-align: inherit;">ูุจุงูุทุจุน ุ ูุง ุชูุณ ุญุฐู ุฌููุน ุงูููุงุฑุฏ ุจุนุฏ ุฃู ุชุตุจุญ ุบูุฑ ุถุฑูุฑูุฉ.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุณู ุงูุญุธ ุ ุณุชููู ูุธุงุฆู DynamoDb ู lambda ูุฌุงููุฉ ุจุงููุณุจุฉ ููุง ุฅุฐุง ุจููุช ุถูู ุงูุญุฏูุฏ ุงูุดูุฑูุฉ ุงููุฌุงููุฉ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ูู DynamoDB: 25 ุฌูุฌุง ุจุงูุช ูู ุงูุชุฎุฒูู ุ 25 WCU / RCU ู 100 ููููู ุทูุจ. </font><font style="vertical-align: inherit;">ูููููู ููุงููุฉ ููุธุงุฆู ูุงูุฏุง ูู ุงูุดูุฑ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุงู ุงููุดุฑ ุงููุฏูู</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุนุฏุงุฏ ุชุฏููุงุช ุจูุงูุงุช Kinesis</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชูู ุฅูู ุฎุฏูุฉ Kinesis Data Streams ููู ุจุฅูุดุงุก ุชุฏูููู ุฌุฏูุฏูู ุ ุฌุฒุก ูุงุญุฏ ููู ููููุง.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูู ุงููุดุฑุฉุ</font></font></b>
                        <div class="spoiler_text"> โ       Amazon Kinesis.         1 /       2 /.     1000  PUT  .         . ,       .          2 /       4 /    2000  PUT  .<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุง ุฒุงุฏ ุนุฏุฏ ุงูุฃุฌุฒุงุก ูู ุงูุชุฏูู ุ ุฒุงุฏ ูุนุฏู ุฅูุชุงุฌูุง. </font><font style="vertical-align: inherit;">ูู ุญูุซ ุงููุจุฏุฃ ุ ูุชู ููุงุณ ุงูุชุฏููุงุช ุจูุฐู ุงูุทุฑููุฉ ุจุฅุถุงูุฉ ุดุธุงูุง. </font><font style="vertical-align: inherit;">ูููู ูููุง ูุงู ูุฏูู ุดุธุงูุง ุฃูุซุฑ ุ ุงุฑุชูุน ุงูุณุนุฑ. </font><font style="vertical-align: inherit;">ุชุจูุบ ุชูููุฉ ูู ูุทุนุฉ 1.5 ุณูุชูุง ูู ุงูุณุงุนุฉ ู 1.4 ุณูุชูุง ุฅุถุงูููุง ููู ููููู ูุญุฏุฉ ุญูููุฉ PUT. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุดุฆ ุฎูุทูุง ุฌุฏูุฏูุง ุจุงุณู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flight_tickets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูููู ูุทุนุฉ ูุงุญุฏุฉ ูุฐูู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/f8/5p/jg/f85pjg59pxlsbjio2_yzpz1wng4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูู ุจุฅูุดุงุก ุฏูู ุขุฎุฑ ูุณูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">special_stream</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4l/_t/eo/4l_teoxvvwv5pablkpfnv-tlnac.jpeg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุนุฏุงุฏ ุงูููุชุฌ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุชุฌ ุจูุงูุงุช ูุชุญููู ูููุฉ ุ ูููู ุงุณุชุฎุฏุงู ูุซูู EC2 ุนุงุฏู. </font><font style="vertical-align: inherit;">ูุง ูุฌุจ ุฃู ุชููู ุขูุฉ ุงูุชุฑุงุถูุฉ ุจุงูุธุฉ ุงูุซูู ูููุฉ ุ ุจูุนุฉ t2.micro ููุงุณุจุฉ ุชูุงููุง. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงุญุธุฉ ูููุฉ: ุนูู ุณุจูู ุงููุซุงู ุ ูุฌุจ ุนููู ุงุณุชุฎุฏุงู ุงูุตูุฑุฉ - Amazon Linux AMI 2018.03.0 ุ ูุน ูุฌูุฏ ุฅุนุฏุงุฏุงุช ุฃูู ูุชุดุบูู ูููู Kinesis ุจุณุฑุนุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชูู ุฅูู ุฎุฏูุฉ EC2 ุ ูุฃูุดุฆ ุฌูุงุฒูุง ุงูุชุฑุงุถููุง ุฌุฏูุฏูุง ุ ูุญุฏุฏ AMI ุงููุทููุจ ูุน ููุน t2.micro ุ ูุงููุถูู ูู ุงููุณุชูู ุงููุฌุงูู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3q/rg/gt/3qrggtrxqistnkvgzn0bwkfdvbk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ูุชููู ุงูุฌูุงุฒ ุงูุธุงูุฑู ุงูุฐู ุชู ุฅูุดุงุคู ุญุฏูุซูุง ูู ุงูุชูุงุนู ูุน ุฎุฏูุฉ Kinesis ุ ูุฌุจ ุนููู ููุญู ุงูุญู ูู ุงูููุงู ุจุฐูู. </font><font style="vertical-align: inherit;">ุฃูุถู ุทุฑููุฉ ููููุงู ุจุฐูู ูู ุชุนููู ุฏูุฑ IAM. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูู ุดุงุดุฉ ุงูุฎุทูุฉ 3: ุชูููู ุชูุงุตูู ุงููุซูู ุ ุญุฏุฏ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุฏูุฑ IAM ุฌุฏูุฏ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุฃุฏูุงุฑ IAM ูู EC2</font></font></b>
                        <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/_p/rm/xv/_prmxvgp0iv148grjwdpunwaela.jpeg"></div><br>
  , ,      EC2     Permissions:<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zv/as/nn/zvasnnl8ootjsr6rojjfhmjtfiw.jpeg"></div><br>
             ,     : AmazonKinesisFullAccess  CloudWatchFullAccess.<br>
<br>
 -     , : EC2-KinesisStreams-FullAccess.  ,     ,     :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/jh/rj/38/jhrj38s8czngu9ri77mu26lh_o0.jpeg"></div><br>
    ,         :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yn/he/23/ynhe23lg4gfpfbjvlphntvfypyw.jpeg"></div><br>
           . <br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุชุฑู ูุนููุงุช ุงููุฑุต ุงูุซุงุจุช ุงูุชุฑุงุถููุง ุ ูุงูุนูุงูุงุช ุฃูุถูุง (ุนูู ุงูุฑุบู ูู ุฃูู ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุงูุนูุงูุงุช ุ ุนูู ุงูุฃูู ูู ุจุชุณููุฉ ุงุณู ุงููุซูู ูุชุญุฏูุฏ ุงูุจูุฆุฉ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ุงูุขู ูู ุงูุฎุทูุฉ 6: ุชูููู ุนูุงูุฉ ุงูุชุจููุจ ูุฌููุนุฉ ุงูุฃูุงู ุ ุญูุซ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุงุญุฏุฉ ุฌุฏูุฏุฉ ุฃู ุชุญุฏูุฏ ูุฌููุนุฉ ุงูุฃูุงู ุงูููุฌูุฏุฉ ูุฏูู ุ ููุง ูุณูุญ ูู ุจุงูุงุชุตุงู ุนุจุฑ ssh (ุงููููุฐ 22) ุจุงููุซูู. </font><font style="vertical-align: inherit;">ุญุฏุฏ ุงููุตุฏุฑ -&gt; IP ุงูุฎุงุต ุจู ููุงู ูููููู ุชุดุบูู ุงููุซูู.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/y7/cd/z9/y7cdz9fllra7haynrf6gyu0jkdq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจูุฌุฑุฏ ุฏุฎููู ูู ุญุงูุฉ ุงูุชุดุบูู ุ ููููู ูุญุงููุฉ ุงูุงุชุตุงู ุจู ุนุจุฑ ssh. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุชููู ูู ุงูุนูู ูุน ูููู Kinesis ุ ุจุนุฏ ุงุชุตุงู ูุงุฌุญ ุจุงูุฌูุงุฒ ุ ูุฌุจ ุนููู ุฅุฏุฎุงู ุงูุฃูุงูุฑ ุงูุชุงููุฉ ูู ุงููุญุฏุฉ ุงูุทุฑููุฉ:</font></font><br>
<br>
<pre><code class="bash hljs">sudo yum -y update<font></font>
sudo yum install -y python36 python36-pip<font></font>
sudo /usr/bin/pip-3.6 install --upgrade pip<font></font>
sudo yum install -y aws-kinesis-agent<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุฅูุดุงุก ูุฌูุฏ ูุญูุธ ุงุณุชุฌุงุจุงุช API:</font></font><br>
<br>
<pre><code class="bash hljs">sudo mkdir /var/<span class="hljs-built_in">log</span>/airline_tickets</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจู ุจุฏุก ุชุดุบูู ุงููููู ุ ุชุญุชุงุฌ ุฅูู ุชูููู ุงูุชูููู ุงูุฎุงุต ุจู:</font></font><br>
<br>
<pre><code class="bash hljs">sudo vim /etc/aws-kinesis/agent.json</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุฃู ุชุจุฏู ูุญุชููุงุช ููู agent.json ููุง ููู:</font></font><br>
<br>
<pre><code class="json hljs">{
  <span class="hljs-attr">"cloudwatch.emitMetrics"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">"kinesis.endpoint"</span>: <span class="hljs-string">""</span>,
  <span class="hljs-attr">"firehose.endpoint"</span>: <span class="hljs-string">""</span>,<font></font>
<font></font>
  <span class="hljs-attr">"flows"</span>: [<font></font>
    {<font></font>
      <span class="hljs-attr">"filePattern"</span>: <span class="hljs-string">"/var/log/airline_tickets/*log"</span>,
      <span class="hljs-attr">"kinesisStream"</span>: <span class="hljs-string">"airline_tickets"</span>,
      <span class="hljs-attr">"partitionKeyOption"</span>: <span class="hljs-string">"RANDOM"</span>,
      <span class="hljs-attr">"dataProcessingOptions"</span>: [<font></font>
         {<font></font>
            <span class="hljs-attr">"optionName"</span>: <span class="hljs-string">"CSVTOJSON"</span>,
            <span class="hljs-attr">"customFieldNames"</span>: [<span class="hljs-string">"cost"</span>,<span class="hljs-string">"trip_class"</span>,<span class="hljs-string">"show_to_affiliates"</span>,
                <span class="hljs-string">"return_date"</span>,<span class="hljs-string">"origin"</span>,<span class="hljs-string">"number_of_changes"</span>,<span class="hljs-string">"gate"</span>,<span class="hljs-string">"found_at"</span>,
                <span class="hljs-string">"duration"</span>,<span class="hljs-string">"distance"</span>,<span class="hljs-string">"destination"</span>,<span class="hljs-string">"depart_date"</span>,<span class="hljs-string">"actual"</span>,<span class="hljs-string">"record_id"</span>]<font></font>
         }<font></font>
      ]<font></font>
    }<font></font>
  ]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุชุฑู ูู ููู ุงูุชููุฆุฉ ุ ูููู ุงููููู ุจูุฑุงูุจุฉ ุงููููุงุช ุฐุงุช ุงูุงูุชุฏุงุฏ .log ูู ุงูุฏููู / var / log / airline_tickets / ุ ูุชุญููููุง ูููููุง ุฅูู ุชุฏูู ุดุฑูุฉ ุงูุฎุทูุท ุงูุฌููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนูุฏ ุชุดุบูู ุงูุฎุฏูุฉ ููุชุฃูุฏ ูู ุฃููุง ุชุจุฏุฃ ูุชุนูู:</font></font><br>
<br>
<pre><code class="bash hljs">sudo service aws-kinesis-agent restart</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูู ุจุชูุฒูู ุจุฑูุงูุฌ Python ุงููุตู ุงูุฐู ุณูุทูุจ ุจูุงูุงุช ูู API:</font></font><br>
<br>
<pre><code class="bash hljs">REPO_PATH=https://raw.githubusercontent.com/igorgorbenko/aviasales_kinesis/master/producer<font></font>
<font></font>
wget <span class="hljs-variable">$REPO_PATH</span>/api_caller.py -P /home/ec2-user/<font></font>
wget <span class="hljs-variable">$REPO_PATH</span>/requirements.txt -P /home/ec2-user/<font></font>
sudo chmod a+x /home/ec2-user/api_caller.py<font></font>
sudo /usr/<span class="hljs-built_in">local</span>/bin/pip3 install -r /home/ec2-user/requirements.txt
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุทูุจ ุงูุจุฑูุงูุฌ ุงููุตู api_caller.py ุจูุงูุงุช ูู Aviasales ููุญูุธ ุงูุงุณุชุฌุงุจุฉ ุงููุณุชููุฉ ูู ุงูุฏููู ุงูุฐู ูููู ูููู Kinesis ุจูุญุตู. </font><font style="vertical-align: inherit;">ุชูููุฐ ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ููุงุณู ุฅูู ุญุฏ ูุง ุ ููุงู TicketsApi ูุฆุฉ ุ ูุณูุญ ูู ุจุณุญุจ API ุจุดูู ุบูุฑ ูุชุฒุงูู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงููุฆุฉ ุ ููุฑุฑ ุงูุฑุฃุณ ูุน ุงูุฑูุฒ ุงููููุฒ ููุนููุงุช ุงูุทูุจ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TicketsApi</span>:</span>
    <span class="hljs-string">"""Api caller class."""</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, headers</span>):</span>
        <span class="hljs-string">"""Init method."""</span><font></font>
        self.base_url = BASE_URL<font></font>
        self.headers = headers<font></font>
<font></font>
    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_data</span>(<span class="hljs-params">self, data</span>):</span>
        <span class="hljs-string">"""Get the data from API query."""</span><font></font>
        response_json = {}<font></font>
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> ClientSession(headers=self.headers) <span class="hljs-keyword">as</span> session:
            <span class="hljs-keyword">try</span>:<font></font>
                response = <span class="hljs-keyword">await</span> session.get(self.base_url, data=data)<font></font>
                response.raise_for_status()<font></font>
                LOGGER.info(<span class="hljs-string">'Response status %s: %s'</span>,<font></font>
                            self.base_url, response.status)<font></font>
                response_json = <span class="hljs-keyword">await</span> response.json()
            <span class="hljs-keyword">except</span> HTTPError <span class="hljs-keyword">as</span> http_err:<font></font>
                LOGGER.error(<span class="hljs-string">'Oops! HTTP error occurred: %s'</span>, str(http_err))
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<font></font>
                LOGGER.error(<span class="hljs-string">'Oops! An error ocurred: %s'</span>, str(err))
            <span class="hljs-keyword">return</span> response_json<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">prepare_request</span>(<span class="hljs-params">api_token</span>):</span>
    <span class="hljs-string">"""Return the headers and query fot the API request."""</span>
    headers = {<span class="hljs-string">'X-Access-Token'</span>: api_token,
               <span class="hljs-string">'Accept-Encoding'</span>: <span class="hljs-string">'gzip'</span>}<font></font>
<font></font>
    data = FormData()<font></font>
    data.add_field(<span class="hljs-string">'currency'</span>, CURRENCY)<font></font>
    data.add_field(<span class="hljs-string">'origin'</span>, ORIGIN)<font></font>
    data.add_field(<span class="hljs-string">'destination'</span>, DESTINATION)<font></font>
    data.add_field(<span class="hljs-string">'show_to_affiliates'</span>, SHOW_TO_AFFILIATES)<font></font>
    data.add_field(<span class="hljs-string">'trip_duration'</span>, TRIP_DURATION)
    <span class="hljs-keyword">return</span> headers, data<font></font>
<font></font>
<font></font>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-string">"""Get run the code."""</span>
    <span class="hljs-keyword">if</span> len(sys.argv) != <span class="hljs-number">2</span>:<font></font>
        print(<span class="hljs-string">'Usage: api_caller.py &lt;your_api_token&gt;'</span>)<font></font>
        sys.exit(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span>
    api_token = sys.argv[<span class="hljs-number">1</span>]<font></font>
    headers, data = prepare_request(api_token)<font></font>
<font></font>
    api = TicketsApi(headers)<font></font>
    response = <span class="hljs-keyword">await</span> api.get_data(data)
    <span class="hljs-keyword">if</span> response.get(<span class="hljs-string">'success'</span>, <span class="hljs-literal">None</span>):<font></font>
        LOGGER.info(<span class="hljs-string">'API has returned %s items'</span>, len(response[<span class="hljs-string">'data'</span>]))
        <span class="hljs-keyword">try</span>:<font></font>
            count_rows = log_maker(response)<font></font>
            LOGGER.info(<span class="hljs-string">'%s rows have been saved into %s'</span>,<font></font>
                        count_rows,<font></font>
                        TARGET_FILE)<font></font>
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<font></font>
            LOGGER.error(<span class="hljs-string">'Oops! Request result was not saved to file. %s'</span>,<font></font>
                         str(e))<font></font>
    <span class="hljs-keyword">else</span>:<font></font>
        LOGGER.error(<span class="hljs-string">'Oops! API request was unsuccessful %s!'</span>, response)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงุฎุชุจุงุฑ ุงูุฅุนุฏุงุฏุงุช ุงูุตุญูุญุฉ ููุงุจููุฉ ุชุดุบูู ุงููููู ุ ุณูุฌุฑู ุงุฎุชุจุงุฑูุง ูููุต ุงูุจุฑูุฌู api_caller.py:</font></font><br>
<br>
<pre><code class="bash hljs">sudo ./api_caller.py TOKEN</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/17/rr/u817rrbmcgutepqlpx-aa7k2mo4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ูุธุฑุฉ ุนูู ูุชูุฌุฉ ุงูุนูู ูู ุณุฌูุงุช ุงููููู ูุนูู ุนูุงูุฉ ุงูุชุจููุจ ุงููุฑุงูุจุฉ ูู ุชุฏูู ุจูุงูุงุช ุดุฑูุฉ ุงูุฎุทูุท ุงูุฌููุฉ:</font></font><br>
<br>
<pre><code class="bash hljs">tail -f /var/<span class="hljs-built_in">log</span>/aws-kinesis-agent/aws-kinesis-agent.log</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/5r/oy/ep5royv-vndczuzfhaufx2duuau.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/g3/pi/ya/g3piyaltiksnogpxwm0temjdpz4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุชุฑู ุ ูุนูู ูู ุดูุก ููุฑุณู ูููู Kinesis ุงูุจูุงูุงุช ุฅูู ุงูุฏูู ุจูุฌุงุญ. </font><font style="vertical-align: inherit;">ุงูุขู ุชูููู ุงููุณุชููู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุนุฏุงุฏ ุชุญูููุงุช ุจูุงูุงุช Kinesis</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ููุชูู ุฅูู ุงููููู ุงููุฑูุฒู ูููุธุงู ุจุฃูููู - ุฅูุดุงุก ุชุทุจูู ุฌุฏูุฏ ูู Kinesis Data Analytics ูุณูู kinesis_analytics_airlines_app:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dp/0s/4a/dp0s4aesniewnc3j7envuvi2lqa.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชูุญ Kinesis Data Analytics ุชุญูููุงุช ุงูุจูุงูุงุช ูู ุงูููุช ุงูุญูููู ูู Kinesis Streams ุจุงุณุชุฎุฏุงู SQL. </font><font style="vertical-align: inherit;">ูุฐู ุฎุฏูุฉ ูุงุจูุฉ ููุชุทููุฑ ุชููุงุฆููุง ุจุงููุงูู (ุนูู ุนูุณ ุชูุงุฑุงุช Kinesis) ุ ูุงูุชู:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูุญ ูู ุจุฅูุดุงุก ุชุฏููุงุช ุฌุฏูุฏุฉ (ุฏูู ุงูุฅุฎุฑุงุฌ) ุจูุงุกู ุนูู ุงูุงุณุชุนูุงูุงุช ุงูุฎุงุตุฉ ุจุจูุงูุงุช ุงููุตุฏุฑ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฑ ุฏูู ูุน ุงูุฃุฎุทุงุก ุงูุชู ุญุฏุซุช ุฃุซูุงุก ุนูููุฉ ุงูุชุทุจูู (ุฏูู ุงูุฎุทุฃ) ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุชุญุฏูุฏ ูุฎุทุท ุจูุงูุงุช ุงูุฅุฏุฎุงู ุชููุงุฆููุง (ูููู ุฅุนุงุฏุฉ ุชุนุฑููู ูุฏูููุง ุฅุฐุง ูุฒู ุงูุฃูุฑ).</font></font></li>
</ol><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐู ุฎุฏูุฉ ุจุงูุธุฉ ุงูุซูู - 0.11 ุฏููุงุฑ ุฃูุฑููู ููุณุงุนุฉ ุ ูุฐุง ูุฌุจ ุนููู ุงุณุชุฎุฏุงููุง ุจุนูุงูุฉ ูุฅุฒุงูุชูุง ุนูุฏ ุงูุงูุชูุงุก ูู ุงูุนูู.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชูุตูู ุงูุชุทุจูู ุจูุตุฏุฑ ุงูุจูุงูุงุช:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2x/sc/g6/2xscg6tquygvrr4dxhjofyxjx-m.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุฎุชุฑ ุงููุฌููุนุฉ ุงูุชู ุชุฑูุฏ ุงูุงุชุตุงู ุจูุง (ุฎุทูุท ุทูุฑุงู):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/y1/c7/ma/y1c7ma8a_9n3wwwokqleszry-qa.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุฅุฑูุงู ุฏูุฑ IAM ุงูุฌุฏูุฏ ุญุชู ูุชููู ุงูุชุทุจูู ูู ุงููุฑุงุกุฉ ูู ุงูุฏูู ูุงููุชุงุจุฉ ุฅูู ุงูุฏูู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูููู ุนุฏู ุชุบููุฑ ุฃู ุดูุก ูู ูุชูุฉ ุฃุฐููุงุช ุงููุตูู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/96/wq/dg96wq1hgmmd0ouhxpxs8r0tjss.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุทูุจ ุงูุขู ุงูุชุดุงู ูุฎุทุท ุงูุจูุงูุงุช ูู ุงูุฏูู ุ ูุฐูู ูููุฑ ุนูู ุงูุฒุฑ "ุงูุชุดุงู ุงููุฎุทุท". </font><font style="vertical-align: inherit;">ููุชูุฌุฉ ูุฐูู ุ ุณูุชู ุชุญุฏูุซ ุฏูุฑ IAM (ุณูุชู ุฅูุดุงุก ุฏูุฑ ุฌุฏูุฏ) ูุณูุชู ุฅุทูุงู ุงูุชุดุงู ุงููุฎุทุท ูู ุงูุจูุงูุงุช ุงูุชู ูุตูุช ุจุงููุนู ูู ุงูุฏูู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5e/co/6r/5eco6ro21kgrevovywr-2ulfysw.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฃูุช ุจุญุงุฌุฉ ููุฐูุงุจ ุฅูู ูุญุฑุฑ SQL. </font><font style="vertical-align: inherit;">ุนูุฏ ุงูููุฑ ููู ูุฐุง ุงูุฒุฑ ุ ุณุชุธูุฑ ูุงูุฐุฉ ุจูุง ุณุคุงู ุญูู ุชุดุบูู ุงูุชุทุจูู - ุงุฎุชุฑ ูุง ูุฑูุฏ ุชุดุบููู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/oc/ta/ktoctaokxjgsxbosk5eu8-yw_e0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุงูุฐุฉ ูุญุฑุฑ SQL ุ ูู ุจุฅุฏุฑุงุฌ ูุซู ูุฐุง ุงูุงุณุชุนูุงู ุงูุจุณูุท ูุงููุฑ ููู ุญูุธ ูุชุดุบูู SQL:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> STREAM <span class="hljs-string">"DESTINATION_SQL_STREAM"</span> (<span class="hljs-string">"cost"</span> <span class="hljs-keyword">DOUBLE</span>, <span class="hljs-string">"gate"</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">16</span>));<font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR</span> <span class="hljs-keyword">REPLACE</span> PUMP <span class="hljs-string">"STREAM_PUMP"</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">"DESTINATION_SQL_STREAM"</span>
<span class="hljs-keyword">SELECT</span> STREAM <span class="hljs-string">"cost"</span>, <span class="hljs-string">"gate"</span>
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"SOURCE_SQL_STREAM_001"</span>
<span class="hljs-keyword">WHERE</span> <span class="hljs-string">"cost"</span> &lt; <span class="hljs-number">5000</span>
    <span class="hljs-keyword">and</span> <span class="hljs-string">"gate"</span> = <span class="hljs-string">'Aeroflot'</span>;
</code></pre><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุงุนุฏ ุงูุจูุงูุงุช ุงูุนูุงุฆููุฉ ุ ุชุนูู ูุน ุงูุฌุฏุงูู ุจุงุณุชุฎุฏุงู ุนุจุงุฑุงุช INSERT ูุฅุถุงูุฉ ุงูุณุฌูุงุช ูุนุจุงุฑุฉ SELECT ุฅูู ุจูุงูุงุช ุงูุงุณุชุนูุงู. </font><font style="vertical-align: inherit;">ูู Amazon Kinesis Data Analytics ุ ุฃูุช ุชุนูู ูุน ุงูุชุฏููุงุช (STREAM) ู "ุงููุถุฎุงุช" (PUMP) - ุทูุจุงุช ุงูุฅุฏุฑุงุฌ ุงููุณุชูุฑ ุงูุชู ุชุฏุฑุฌ ุงูุจูุงูุงุช ูู ุฏูู ูุงุญุฏ ูู ุชุทุจูู ูู ุฏูู ุขุฎุฑ.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงุณุชุนูุงู SQL ุฃุนูุงู ุ ูุชู ุงูุจุญุซ ุนู ุชุฐุงูุฑ Aeroflot ุจุฃุณุนุงุฑ ุฃูู ูู ุฎูุณุฉ ุขูุงู ุฑูุจู. </font><font style="vertical-align: inherit;">ุณูุชู ูุถุน ุฌููุน ุงูุณุฌูุงุช ุงูุชู ุชูุฏุฑุฌ ุชุญุช ูุฐู ุงูุดุฑูุท ูู ุฏูู DESTINATION_SQL_STREAM.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/l7/zk/8l/l7zk8ltrlivhjnmj3u1xcvazwai.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุชูุฉ ุงููุฌูุฉ ุ ุญุฏุฏ ุฏูู special_stream ุ ููู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ุงุณู ุฏูู ุฏุงุฎู ุงูุชุทุจูู DESTINATION_SQL_STREAM:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5r/5s/7r/5r5s7rpwfezpiyjokrby1jkmcly.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชูุฌุฉ ูุฌููุน ุงูุชูุงุนุจุงุช ุ ูุฌุจ ุฃู ูุธูุฑ ุดูุก ูุดุงุจู ููุตูุฑุฉ ุฃุฏูุงู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4c/o3/_b/4co3_blpb57-arskyc7jwsc2d_i.jpeg"></div><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ูุงูุงุดุชุฑุงู ูู ููุถูุน SNS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุชูู ุฅูู ุฎุฏูุฉ ุงูุฅุนูุงู ุงูุจุณูุท ูุฃูุดุฆ ููุถูุนูุง ุฌุฏูุฏูุง ุจุงุณู ุดุฑูุงุช ุงูุทูุฑุงู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/su/ur/zr/suurzrkeqmmm7jk3-j5iuqaiar8.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ูุดุชุฑููู ูู ูุฐุง ุงูููุถูุน ุ ุญูุซ ูุดูุฑ ุฅูู ุฑูู ุงููุงุชู ุงููุญููู ุงูุฐู ุณุชุตู ุฅููู ุฅุดุนุงุฑุงุช ุงูุฑุณุงุฆู ุงููุตูุฑุฉ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/gc/sz/epgcszgapjrsl4-jhx7vktgi7fi.jpeg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุฌุฏูู ูู DynamoDB</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฃูููุฉ ุงูุฎุงุตุฉ ุจุชุฏูู ุชุฐุงูุฑ ุงูุทูุฑุงู ุงูุฎุงุตุฉ ุจูู ุ ูู ุจุฅูุดุงุก ุฌุฏูู ูู DynamoDB ุจููุณ ุงูุงุณู. </font><font style="vertical-align: inherit;">ูููุชุงุญ ุฃุณุงุณู ุ ุณูู ูุณุชุฎุฏู record_id:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/t7/td/4e/t7td4eq2asrdur1arxzbmsuthdk.jpeg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ูุธููุฉ ุฌุงูุน ูุงูุฏุง</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ููุดุฆ ูุธููุฉ ูุงูุฏุง ุชุณูู Collector ุ ููููุชูุง ุงุณุชุทูุงุน ุฑุฃู ุชูุงุฑ ุดุฑูุฉ ุงูุฎุทูุท ุงูุฌููุฉ ุ ูุฅุฐุง ูุงูุช ููุงู ุณุฌูุงุช ุฌุฏูุฏุฉ ููุงู ุ ูุฃุฏุฎู ูุฐู ุงูุณุฌูุงุช ูู ุฌุฏูู DynamoDB. </font><font style="vertical-align: inherit;">ูู ุงููุงุถุญ ุฃูู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุญููู ุงูุงูุชุฑุงุถูุฉ ุ ูุฌุจ ุฃู ูููู ูุฏู ูุงูุฏุง ุญู ุงููุตูู ููุฑุงุกุฉ ุฏูู ุจูุงูุงุช Kinesis ูุงููุชุงุจุฉ ุฅูู DynamoDB.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุฏูุฑ IAM ููุธููุฉ ุฌุงูุน ูุงูุฏุง</font></font></b>
                        <div class="spoiler_text">    IAM      Lambda-TicketsProcessingRole:<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s9/sv/_f/s9sv_fh7p4flqdklnzh5rohd9ws.jpeg"></div><br>
       AmazonKinesisReadOnlyAccess  AmazonDynamoDBFullAccess,     :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/f_/v0/zy/f_v0zyuhd3h9y5e9tiuurfbpqnq.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/78/db/ge/78dbgeqrxjuuh6rzlqd-k1qdgee.jpeg"></div></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุชุดุบูู ูุงูุฏุง ูุฐู ูู ุฎูุงู ูุดุบู Kinesis ุนูุฏูุง ุชุตู ุงูุฅุฏุฎุงูุงุช ุงูุฌุฏูุฏุฉ ุฅูู ุชุฏูู ุดุฑูุฉ ุงูุฎุทูุท ุงูุฌููุฉ ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ูุดุบู ุฌุฏูุฏ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qt/h0/gg/qth0ggplzpl1afpad4shlgl_tbu.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/we/2c/ip/we2cipjv713dvyo10ry4wmyrdi0.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุฅุฏุฎุงู ุงูููุฏ ูุญูุธ ูุงูุฏุง.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-string">"""Parsing the stream and inserting into the DynamoDB table."""</span>
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> boto3
<span class="hljs-keyword">from</span> decimal <span class="hljs-keyword">import</span> Decimal<font></font>
<font></font>
DYNAMO_DB = boto3.resource(<span class="hljs-string">'dynamodb'</span>)<font></font>
TABLE_NAME = <span class="hljs-string">'airline_tickets'</span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TicketsParser</span>:</span>
    <span class="hljs-string">"""Parsing info from the Stream."""</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, table_name, records</span>):</span>
        <span class="hljs-string">"""Init method."""</span><font></font>
        self.table = DYNAMO_DB.Table(table_name)<font></font>
        self.json_data = TicketsParser.get_json_data(records)<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_json_data</span>(<span class="hljs-params">records</span>):</span>
        <span class="hljs-string">"""Return deserialized data from the stream."""</span>
        decoded_record_data = ([base64.b64decode(record[<span class="hljs-string">'kinesis'</span>][<span class="hljs-string">'data'</span>])
                                <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> records])<font></font>
        json_data = ([json.loads(decoded_record)<font></font>
                      <span class="hljs-keyword">for</span> decoded_record <span class="hljs-keyword">in</span> decoded_record_data])
        <span class="hljs-keyword">return</span> json_data<font></font>
<font></font>
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_item_from_json</span>(<span class="hljs-params">json_item</span>):</span>
        <span class="hljs-string">"""Pre-process the json data."""</span><font></font>
        new_item = {<font></font>
            <span class="hljs-string">'record_id'</span>: json_item.get(<span class="hljs-string">'record_id'</span>),
            <span class="hljs-string">'cost'</span>: Decimal(json_item.get(<span class="hljs-string">'cost'</span>)),
            <span class="hljs-string">'trip_class'</span>: json_item.get(<span class="hljs-string">'trip_class'</span>),
            <span class="hljs-string">'show_to_affiliates'</span>: json_item.get(<span class="hljs-string">'show_to_affiliates'</span>),
            <span class="hljs-string">'origin'</span>: json_item.get(<span class="hljs-string">'origin'</span>),
            <span class="hljs-string">'number_of_changes'</span>: int(json_item.get(<span class="hljs-string">'number_of_changes'</span>)),
            <span class="hljs-string">'gate'</span>: json_item.get(<span class="hljs-string">'gate'</span>),
            <span class="hljs-string">'found_at'</span>: json_item.get(<span class="hljs-string">'found_at'</span>),
            <span class="hljs-string">'duration'</span>: int(json_item.get(<span class="hljs-string">'duration'</span>)),
            <span class="hljs-string">'distance'</span>: int(json_item.get(<span class="hljs-string">'distance'</span>)),
            <span class="hljs-string">'destination'</span>: json_item.get(<span class="hljs-string">'destination'</span>),
            <span class="hljs-string">'depart_date'</span>: json_item.get(<span class="hljs-string">'depart_date'</span>),
            <span class="hljs-string">'actual'</span>: json_item.get(<span class="hljs-string">'actual'</span>)<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> new_item<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""Batch insert into the table."""</span>
        <span class="hljs-keyword">with</span> self.table.batch_writer() <span class="hljs-keyword">as</span> batch_writer:
            <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> self.json_data:<font></font>
                dynamodb_item = TicketsParser.get_item_from_json(item)<font></font>
                batch_writer.put_item(dynamodb_item)<font></font>
<font></font>
        print(<span class="hljs-string">'Has been added '</span>, len(self.json_data), <span class="hljs-string">'items'</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">lambda_handler</span>(<span class="hljs-params">event, context</span>):</span>
    <span class="hljs-string">"""Parse the stream and insert into the DynamoDB table."""</span>
    print(<span class="hljs-string">'Got event:'</span>, event)<font></font>
    parser = TicketsParser(TABLE_NAME, event[<span class="hljs-string">'Records'</span>])<font></font>
    parser.run()<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ููุจู ุฏุงูุฉ ูุงูุฏุง</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชู ุฅูุดุงุก ูุธููุฉ ูุงูุฏุง ุงูุซุงููุฉ ุ ุงูุชู ุณุชุฑุงูุจ ุงูุฏูู ุงูุซุงูู (special_stream) ูุฅุฑุณุงู ุฅุดุนุงุฑ ุฅูู SNS ุ ุจููุณ ุงูุทุฑููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฌุจ ุฃู ูููู ูุฏู lambda ุญู ุงููุตูู ูููุฑุงุกุฉ ูู Kinesis ูุฅุฑุณุงู ุฑุณุงุฆู ุฅูู ููุถูุน SNS ุงููุญุฏุฏ ุ ูุงูุฐู ูุชู ุฅุฑุณุงูู ุจุนุฏ ุฐูู ุจูุงุณุทุฉ ุฎุฏูุฉ SNS ุฅูู ุฌููุน ุงููุดุชุฑููู ูู ูุฐุง ุงูููุถูุน (ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุงูุฑุณุงุฆู ุงููุตูุฑุฉ ููุง ุฅูู ุฐูู).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุดุงุก ุฃุฏูุงุฑ IAM</font></font></b>
                        <div class="spoiler_text">  IAM  Lambda-KinesisAlarm   ,         alarm_notifier:<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zm/fn/ru/zmfnru75p-tp0y1fqzxaoea2xos.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/vp/u0/ypvpu0jl74aak54hl-d4wf7r1kc.jpeg"></div></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌุจ ุฃู ุชุนูู ูุงูุฏุง ูุฐู ููููุง ูููุดุบู ูุฅุฏุฎุงูุงุช ุฌุฏูุฏุฉ ููุฏุฎูู ุฅูู ุชูุงุฑ ุฎุงุต ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุชูููู ุงูุฒูุงุฏ ุจููุณ ุงูุทุฑููุฉ ุงูุชู ูุนููุง ุจูุง ูุงูุจุฑุช ุฌุงูุน. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุฌู ุฑุงุญุฉ ุชูููู ูุงูุฏุง ูุฐู ุ ููุฏู ูุชุบูุฑ ุจูุฆุฉ ุฌุฏูุฏ - TOPIC_ARN ุ ุญูุซ ูุถุน ููุถูุน ANR (Amazon Recourse Names) ูุดุฑูุงุช ุงูุทูุฑุงู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/43/nn/qf/43nnqfmsnahbfu30k5mqadhbuhi.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃุฏุฎู ุฑูุฒ ูุงูุฏุง ุ ุงูุฃูุฑ ุจุณูุท ููุบุงูุฉ:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> boto3
<span class="hljs-keyword">import</span> base64
<span class="hljs-keyword">import</span> os<font></font>
<font></font>
SNS_CLIENT = boto3.client(<span class="hljs-string">'sns'</span>)<font></font>
TOPIC_ARN = os.environ[<span class="hljs-string">'TOPIC_ARN'</span>]<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">lambda_handler</span>(<span class="hljs-params">event, context</span>):</span>
    <span class="hljs-keyword">try</span>:<font></font>
        SNS_CLIENT.publish(TopicArn=TOPIC_ARN,<font></font>
                           Message=<span class="hljs-string">'Hi! I have found an interesting stuff!'</span>,<font></font>
                           Subject=<span class="hljs-string">'Airline tickets alarm'</span>)<font></font>
        print(<span class="hljs-string">'Alarm message has been successfully delivered'</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:<font></font>
        print(<span class="hljs-string">'Delivery failure'</span>, str(err))
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุฃู ูุฐุง ูููู ุชูููู ุงููุธุงู ุงููุฏูู. </font><font style="vertical-align: inherit;">ูุจูู ููุท ููุงุฎุชุจุงุฑ ูุงูุชุฃูุฏ ูู ุชูููู ูู ุดูุก ุจุดูู ุตุญูุญ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดุฑ ูู ุฑูุฒ Terraform</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญุถูุฑ ุงููุงุฒู</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terraform</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุฃุฏุงุฉ ููุชูุญุฉ ุงููุตุฏุฑ ูุฑูุญุฉ ููุบุงูุฉ ููุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. </font><font style="vertical-align: inherit;">ูุญุชูู ุนูู ุจูุงุก ุฌููุฉ ุฎุงุต ุจู ุณูู ุงูุชุนูู ูุงูุนุฏูุฏ ูู ุงูุฃูุซูุฉ ุนูู ููููุฉ ูุดุฑู ููุงุฐุง. </font><font style="vertical-align: inherit;">ููุงู ุงูุนุฏูุฏ ูู ุงูููููุงุช ุงูุฅุถุงููุฉ ุงูููุงุณุจุฉ ูู ูุญุฑุฑ Atom ุฃู Visual Studio Code ูุงูุชู ุชุณูู ุงูุนูู ูุน Terraform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุชูุฒูู ูุฌููุนุฉ ุงูุชูุฒูุน </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุชุญููู ููุตู ูุฌููุน ููุฒุงุช Terraform ุฎุงุฑุฌ ูุทุงู ูุฐู ุงูููุงูุฉ ุ ูุฐูู ุณููุชุตุฑ ุนูู ุงูููุงุท ุงูุฑุฆูุณูุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุชุจุฏุฃ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุงููุดุฑูุน ุงููุงูู ููุฌูุฏ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุณุชูุฏุนู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุญู ูุณุชูุณุฎ ูุณุชูุฏุนูุง ูุฃููุณูุง. </font><font style="vertical-align: inherit;">ูุจู ุงูุจุฏุก ุ ุชุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃูู ููุช ุจุชุซุจูุช ูุชูููู AWS CLI ุ ูุซู </font><font style="vertical-align: inherit;">ุณูุจุญุซ Terraform ุนู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู ููู ~ / .aws / ุจูุงูุงุช ุงูุงุนุชูุงุฏ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูููุงุฑุณุงุช ุงูุฌูุฏุฉ ูุดุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงููุงูู ูุจู ุชุดุบูู ุฃูุฑ ุงูุฎุทุฉ ููุนุฑูุฉ ูุง ูููู Terraform ุจุฅูุดุงุฆู ููุง ูู ุงูุณุญุงุจุฉ:</font></font><br>
<br>
<pre><code class="bash hljs">terraform.exe plan</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุณููุทูุจ ููู ุฅุฏุฎุงู ุฑูู ูุงุชู ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุฅููู. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงููุฑุญูุฉ ุ ูู ุงุฎุชูุงุฑู.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e3/-i/ps/e3-ipsgvy03inzbw_26haktayk4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุชุญููู ุฎุทุฉ ุนูู ุงูุจุฑูุงูุฌ ุ ูููููุง ุงูุจุฏุก ูู ุฅูุดุงุก ุงูููุงุฑุฏ:</font></font><br>
<br>
<pre><code class="bash hljs">terraform.exe apply</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฅุฑุณุงู ูุฐุง ุงูุฃูุฑ ุ ุณููุทูุจ ููู ูุฑุฉ ุฃุฎุฑู ุฅุฏุฎุงู ุฑูู ูุงุชู ุ ุงูุชุจ "ูุนู" ุนูุฏูุง ูุชู ุนุฑุถ ุงูุณุคุงู ุญูู ุงูุชูููุฐ ุงููุนูู ููุฅุฌุฑุงุกุงุช. </font><font style="vertical-align: inherit;">ุณูุณูุญ ูู ูุฐุง ุจุฑูุน ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุงููุงูู ุ ูุชูููุฐ ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงููุงุฒูุฉ ูู EC2 ุ ููุดุฑ ูุธุงุฆู ูุงูุฏุง ุ ููุง ุฅูู ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฅูุดุงุก ุฌููุน ุงูููุงุฑุฏ ุจูุฌุงุญ ูู ุฎูุงู ุฑูุฒ Terraform ุ ุชุญุชุงุฌ ุฅูู ุงูุฏุฎูู ูู ุชูุงุตูู ุชุทุจูู Kinesis Analytics (ููุฃุณู ุ ูู ุฃุฌุฏ ููููุฉ ุงูููุงู ุจุฐูู ูุจุงุดุฑุฉ ูู ุงูุดูุฑุฉ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุฏุก ุชุทุจูู:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qx/ns/qc/qxnsqcjpbkiaradzqomahtxzhnu.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ูุฌุจ ุนููู ุชุนููู ุงุณู ุงูุฏูู ุฏุงุฎู ุงูุชุทุจูู ุจุดูู ุตุฑูุญ ุนู ุทุฑูู ุงูุงุฎุชูุงุฑ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ki/m5/pl/kim5plwariaz8bp-qo-qonli4yu.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hg/69/kf/hg69kfwwtwhwkzxlpnb7g3k2ctm.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ูู ุดูุก ุฌุงูุฒ ููุฐูุงุจ.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฎุชุจุงุฑ ุงูุชุทุจูู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุบุถ ุงููุธุฑ ุนู ููููุฉ ูุดุฑ ุงููุธุงู ุ ูุฏูููุง ุฃู ูู ุฎูุงู ุฑูุฒ Terraform ุ ูุณูุนูู ุจููุณ ุงูุทุฑููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชูู ุนุจุฑ SSH ุฅูู ุงูุฌูุงุฒ ุงูุธุงูุฑู EC2 ุญูุซ ุชู ุชุซุจูุช ูููู Kinesis ูุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู api_caller.py</font></font><br>
<br>
<pre><code class="bash hljs">sudo ./api_caller.py TOKEN</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุงูุชุธุงุฑ ุฑุณุงูุฉ SMS ุฅูู ุฑููู: </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/98/ui/mc/98uimcirxv_n6pglm2qz5jtkvf4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฑุณุงูุฉ ูุตูุฉ ูุตูุฑุฉ - ุชุตู ุงูุฑุณุงูุฉ ุนูู ุงููุงุชู ูู ุฏูููุฉ ูุงุญุฏุฉ ุชูุฑูุจูุง: </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kg/u7/dj/kgu7djc9xgex84h349dlpfukivg.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุฃู ูุฑู ูุง ุฅุฐุง ุชู ุญูุธ ุงูุณุฌูุงุช ูู ูุงุนุฏุฉ ุจูุงูุงุช DynamoDB ูุชุญููููุง ูุงุญููุง ูุฃูุซุฑ ุชูุตููุงู. </font><font style="vertical-align: inherit;">ูุญุชูู ุฌุฏูู ุชุฐุงูุฑ ุงูุทูุฑุงู ุนูู ุดูุก ูุซู ูุฐุง:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/dj/vc/gqdjvcmx0q45o_sgqc_l5po_l-c.jpeg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชูุชุงุฌ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุณูุงู ุงูุนูู ุงูููุฌุฒ ุ ุชู ุจูุงุก ูุธุงู ููุนุงูุฌุฉ ุงูุจูุงูุงุช ุนุจุฑ ุงูุฅูุชุฑูุช ูุนุชูุฏ ุนูู Amazon Kinesis. </font><font style="vertical-align: inherit;">ููุฏ ุฏุฑุณูุง ุฎูุงุฑุงุช ุงุณุชุฎุฏุงู ูููู Kinesis ุจุงูุงุดุชุฑุงู ูุน ุฏูู ุจูุงูุงุช Kinesis ูุชุญูููุงุช ุงูููุช ุงูุญูููู ูู Kinesis Analytics ุจุงุณุชุฎุฏุงู ุฃูุงูุฑ SQL ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูุงุนู Amazon Kinesis ูุน ุฎุฏูุงุช AWS ุงูุฃุฎุฑู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุดุฑูุง ุงููุธุงู ุฃุนูุงู ุจุทุฑููุชูู: ูุฏูู ุทููู ุจูุง ููู ุงูููุงูุฉ ูุณุฑูุน ูู ุฑูุฒ Terraform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุงููุตุฏุฑ ุงููุงูู ูููุดุฑูุน ูุชุงุญ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุณุชูุฏุนู ุนูู GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฃูุชุฑุญ ุนููู ุงูุชุนุฑู ุนููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุง ุนูู ุงุณุชุนุฏุงุฏ ูููุงูุดุฉ ุงูููุงู ุจุณุฑูุฑ ุ ุฃูุง ูู ุงูุชุธุงุฑ ุชุนูููุงุชูู. </font><font style="vertical-align: inherit;">ุขูู ูู ุงูููุฏ ุงูุจูุงุก. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃุชููู ูู ุงููุฌุงุญ!</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar500364/index.html">ุชูุณูุน ุจูุงุจุฉ ุงูุชุนูู ุงููุฏุฑุณู ุนูู ูููุฏู ู BigBlueButton</a></li>
<li><a href="../ar500368/index.html">ุชูููุฏ ุชุณูุณูุงุช ุนุดูุงุฆูุฉ ูููู ุงูุชูุจุค ุจูุง: ููุฌ ูุฎุชูู ููุชุจุฏูู</a></li>
<li><a href="../ar500370/index.html">10 ูููุงุช ุจูุฏูุงุณุช ูููุฏุฉ ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ูููุจุฑูุฌูู ุชุณุชุญู ุงูุงุดุชุฑุงู ูููุง ูู ุนุงู 2020</a></li>
<li><a href="../ar500378/index.html">ุงูุจุญุซ ุงููุนุงู ุนู ุงููุนูููุงุช ูู ุงูุนูู</a></li>
<li><a href="../ar500380/index.html">ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ุนู ุจุนุฏ: ุงููุฎุงุทุฑ ูุงูุนูุงูุจ ุงููุญุชููุฉ</a></li>
<li><a href="../ar500384/index.html">ุญุตู ุฑูุงุฏ ุงุณุชูุฏูููุงุช Pixar ุนูู ุฌุงุฆุฒุฉ ุชูุฑููุฌ ู 1 ููููู ุฏููุงุฑ</a></li>
<li><a href="../ar500386/index.html">ุชูููู ุญู ุนููู ุงูุญุงูู ูุน SwiftUI. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar500390/index.html">ุงูููุงุฐุฌ ุงููุนููุฉ ููุชูุทูู ุงููุบูู ูู ูุฌุงู ุชูููููุฌูุง ุงููุนูููุงุช ูุงูุงุชุตุงูุงุช ุงูุฑูููุฉ. ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar500396/index.html">ูุดุงูู ุฃูุธูุฉ ุงูุชุญูู ูู ุงููุตูู ุงููุณุชููุฉ - ุญูุซ ูู ูุชููุนูุง</a></li>
<li><a href="../ar500398/index.html">ุฃุณุจูุน ุงููุงุฑุงุซูู ุงูุจุนูุฏ 3: ุงูุนูููุงุช ุบูุฑ ุงูุนูููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>