<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèΩ üéå ü§µüèº BazarBackdoor: New Entry Point to Enterprise Systems üöµüèø üõ¢Ô∏è üõ∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In mid-March, the number of brute force attacks on RDP connections increased sharply . The purpose of these attacks was to take advantage of the sudde...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BazarBackdoor: New Entry Point to Enterprise Systems</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504996/"><img src="https://habrastorage.org/webt/bo/vu/xz/bovuxzgjxojkzfcbu7vvnswq6-o.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In mid-March, the number of brute force attacks on </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RDP connections</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> increased sharply </font><font style="vertical-align: inherit;">. The purpose of these attacks was to take advantage of the sudden increase in the number of remote workers and gain control of their corporate computers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Information security experts have discovered a new </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">phishing campaign</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that promotes a hidden backdoor called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BazarBackdoor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the new malware from TrickBot operators), which can be used to hack and gain full access to corporate networks.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">91% of cyber attacks</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , this attack begins with a phishing email. </font><font style="vertical-align: inherit;">Various topics are used to personalize emails: customer complaints, salary reports on the topic of coronavirus, or employee lay-off lists. </font><font style="vertical-align: inherit;">All of these letters contain links to documents hosted by Google Docs. </font><font style="vertical-align: inherit;">Cyber ‚Äã‚Äãcriminals use the Sendgrid marketing platform to send malicious emails. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6n/ga/31/6nga31imgphwv8h0dikwy86lx3a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This campaign uses the so-called ‚Äúspear phishing‚Äù, which means that the criminals have made every effort to make the websites linked to in emails seem legitimate and relevant to the subject of emails.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malicious Documents</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next step in the campaign with BazarBackdoor is to get the victim to download the document. </font><font style="vertical-align: inherit;">These ‚Äúdummy‚Äù websites have problems displaying files in Word, Excel or PDF format, and therefore users are prompted to download a document so that they can view it locally on their computer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the victim clicks on the link, an executable file is downloaded that uses the icon and name associated with the type of document displayed on the website. </font><font style="vertical-align: inherit;">For example, using the ‚ÄúPayroll Report during COVID-19" link, a document called PreviewReport.doc.exe will be downloaded. Since Windows does not show file extensions by default, most users will simply see PreviewReport.doc and open this file, believing that it is legitimate document.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hidden backdoor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The executable file hidden in this malicious document is the bootloader for BazarBackdoor. </font><font style="vertical-align: inherit;">When a user launches a malicious document, the bootloader remains hidden for a short time before connecting to an external management server to download BazarBackdoor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To obtain the address of the management server, BazarLoader will use the Emercoin </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">decentralized DNS service</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to obtain various host names using the bazar domain. </font><font style="vertical-align: inherit;">The bazar domain can only be used on Emercoin DNS servers, and since it is decentralized, it makes it difficult (if not impossible) for law enforcement agencies to trace the required host. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host names used for management servers:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forgame.bazar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bestgame.bazar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thegame.bazar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newgame.bazar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">portgame.bazar</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As soon as the IP address of the management server is received, the bootloader will first connect to one C2 and complete the registration. According to experts who tested this backdoor, this request always returned an HTTP 404 error code. The </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tc/kf/po/tckfpoziq8kfyj4ygrhuxzfoxaw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
second request, C2, however, loads the encrypted XOR payload, which is a malicious program, the BazarBbackdoor backdoor. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fz/to/mc/fztomcqx60zhbxwd-noefk3fbio.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the payload is loaded, it will be embedded in a fileless way into the process C: \ Windows \ system32 \ svchost.exe. Safety researcher </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vitali Kremez</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , who published the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">technical report</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , told BleepingComputer that this is done using the Process Hollowing and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process Doppelg√§nging</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> methods </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ea/mw/dl/eamwdlemm39br0jale1srvkrgoq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As Windows users get used to the svchost.exe processes running in the Task Manager, another svchost.exe process is unlikely to arouse suspicion among most users. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The scheduled task will also be configured to start the bootloader when the user logs into Windows, which will allow you to regularly download new versions of the backdoor and enter them into the svchost.exe process. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sy/er/nt/syernth1huhiafrxdu9ao7l2e6s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Later, security researchers Kremez and James reported that the backdoor downloads and executes a Cobalt Strike penetration test and a special set of utilities for the subsequent operation of this machine on the victim‚Äôs computer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cobalt Strike is a legitimate information security application that is promoted as an ‚Äúadversary modeling platform‚Äù and is designed to perform a network security assessment against a simulated complex threat that an attacker is trying to keep on the network. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, attackers often use hacked versions of Cobalt Strike as part of their toolkit when spreading threats across the network, stealing credentials, and deploying malware. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When implementing Cobalt Strike, it‚Äôs obvious that this hidden backdoor is used to secure positions in corporate networks so that cryptographers can be introduced, steal data or sell network access to other attackers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similarities between BazarBackdoor and TrickBot</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BazarBackdoor is an enterprise class malware. </font><font style="vertical-align: inherit;">Information security researchers believe that this backdoor was most likely developed by the same team that developed the TrickBot Trojan: both malicious programs have parts of the same code, as well as the same delivery methods and working principles.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The dangers of backdoors</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In any complex attack, whether it is extortion, industrial espionage or the extraction of corporate data, the availability of this kind of access is extremely important. </font><font style="vertical-align: inherit;">If a cybercriminal manages to install BazarBackdoor in the company's IT system, this can be a serious danger, and given the volume of emails sent using this backdoor, this is a common threat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As we have seen, BazarBackdoor can be an entry point for a wide range of criminal tools and tools. </font><font style="vertical-align: inherit;">In this regard, it is imperative that enterprises are reliably </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protected</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in order to prevent potential damage from threats of this kind. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BleepingComputer</font></font><br>
</a></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en504972/index.html">Where are Big Data technologies applied today?</a></li>
<li><a href="../en504976/index.html">Pedestrians vs Autonomous Emergency Braking System</a></li>
<li><a href="../en504980/index.html">The practice of state supervision of algorithmic systems on the example of Canada and the EU</a></li>
<li><a href="../en504986/index.html">Hard qigong with conventional signs or why you need a geometry generator</a></li>
<li><a href="../en504988/index.html">Interview with Analyst - Denis Sobolev, Product Manager, Head of B2B analytics Skyeng</a></li>
<li><a href="../en505016/index.html">Free Education Courses: Administration</a></li>
<li><a href="../en505018/index.html">How Selenium Works: Episodes 1 - 2</a></li>
<li><a href="../en505024/index.html">YouTrack now with a knowledge base</a></li>
<li><a href="../en505026/index.html">Control an external device in the car using the buttons on the steering wheel</a></li>
<li><a href="../en505034/index.html">LED aging test</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>