<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖ ‚ôäÔ∏è üßùüèæ Create a CRUD API on Express and MySQL: Part Two üÜë üîå üë©üèø‚Äçü§ù‚Äçüë©üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. In anticipation of the start of the course "Developer Node.js" , we want to share the continuation of the material that was written by...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Create a CRUD API on Express and MySQL: Part Two</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/491786/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello everyone. </font><font style="vertical-align: inherit;">In anticipation of the start of the course </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Developer Node.js"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we want to share the continuation of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">material</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that was written by our freelance author.</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/ly/hi/h2/lyhih2n_wa-5o-ot-lsa-ly7wgy.png"><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hello again to everyone. </font><font style="vertical-align: inherit;">We return to creating an application on Node.js and MySQL for a small todo - application on Node.js for React. </font><font style="vertical-align: inherit;">Since the last time, I revised the structure of our application a bit, and now I decided to add an additional column to the database under the name </font></font><code>inner_key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which we will need to draw unique keys for each individual case (in the list of React repeating elements, we need a unique key for each element to process it in Virtual DOM. If this still raises questions for you, you should study </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/webt/yp/sh/qe/ypshqew81mzi4zodmrbvkmsbigq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We can add a column using the following command in MySQL:</font></font><br>
<br>
<pre><code class="sql hljs">  <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABlE</span> TODO <span class="hljs-keyword">ADD</span> inner_key <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yes, it‚Äôs probably not worth it </font></font><code>timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(namely, with the help of which </font></font><code>Date.now()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I create the keys for my business in React) put in a column </font></font><code>varchar</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but I hope that it will not be difficult to fix it if someone will of course optimize our application. </font><font style="vertical-align: inherit;">On the other hand, I am not going to use timestamp to work with time in my application, I only need a unique value. </font><font style="vertical-align: inherit;">So for now, this is not a problem.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Minor updates to our model</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Further, in connection with these changes, the very model of our application has changed. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now our instance constructor at the beginning of our model looks different; it has a new property:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> Deal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">deal</span>) </span>{
  <span class="hljs-keyword">this</span>.text = deal.text;
  <span class="hljs-keyword">this</span>.inner_key = deal.inner_key;<font></font>
};<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I changed the operation to create a case in Model purely cosmetically. </font><font style="vertical-align: inherit;">But the operations of getting the case on </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">had </font><font style="vertical-align: inherit;">to </font><font style="vertical-align: inherit;">be changed quite a lot, because now we are getting the case on </font></font><code>inner_key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The only thing is, I did not begin to change the parameters </font></font><code>res dealId</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but in principle, this does not greatly cut the readability of the code:</font></font><br>
<br>
<pre><code class="plaintext hljs">Deal.findById = (dealId, result) =&gt; {<font></font>
  sql.query(`SELECT * FROM TODO WHERE inner_key = '${dealId}'`, (err, res) =&gt; {<font></font>
<font></font>
	//   ,     <font></font>
<font></font>
    if (res.length) {<font></font>
      console.log(" : ", res[0]);<font></font>
      result(null, res[0]);<font></font>
      return;<font></font>
    }<font></font>
    //     <font></font>
    result({ kind: "not_found" }, null);<font></font>
  });<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to it, a request for all the data from the table underwent a small mutation. </font><font style="vertical-align: inherit;">For my React - applications are not needed </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from the database, I need </font></font><code>inner_key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Therefore, the request itself has changed a bit:</font></font><br>
<br>
<pre><code class="javascript hljs">Deal.getAll = <span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
   <span class="hljs-keyword">const</span> queryAll = <span class="hljs-string">"SELECT text, inner_key FROM TODO"</span>;<font></font>
  sql.query(queryAll, (err, res) =&gt; {<font></font>
<span class="hljs-comment">//  </span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method, </font><font style="vertical-align: inherit;">we also now update the case by </font></font><code>innerkey</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the same thing happens in the delete method:</font></font><br>
<br>
<pre><code class="javascript hljs">Deal.updateById = <span class="hljs-function">(<span class="hljs-params">inner_key, deal, result</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> queryUpdate = <span class="hljs-string">"UPDATE TODO SET text = ? WHERE inner_key = ?"</span>;<font></font>
  sql.query(<font></font>
    queryUpdate,<font></font>
    [deal.text, inner_key],<font></font>
    (err, res) =&gt; {<font></font>
<font></font>
<span class="hljs-comment">//  </span><font></font>
      }<font></font>
      <span class="hljs-comment">//  </span>
     <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">const</span> queryDelete = <span class="hljs-string">"DELETE FROM TODO WHERE inner_key = ?"</span>;<font></font>
  sql.query(queryDelete, inner_key, (err, res) =&gt; {<font></font>
	<span class="hljs-comment">//  </span><font></font>
    }<font></font>
</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As you noticed, I have incomplete code here, because even curly brackets do not close, but I don‚Äôt see the full code to give the full code. </font><font style="vertical-align: inherit;">If, after all, something is not clear, then you can see it </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Creating Your Controller </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the controller, we export the functions that we created in the model. </font><font style="vertical-align: inherit;">If in general, then each time we validate the request by checking whether an empty body has been sent (if you plan to transform the API into an open one, then it must have, and indeed it is useful). </font><font style="vertical-align: inherit;">Further actions differ depending on whether you need to read </font></font><code>res.id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to complete the request, or if this is not a refined request. </font><font style="vertical-align: inherit;">In the method, </font></font><code>findAll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I left resolving all response headers in order to simplify testing my API.</font></font><br>
<br>
<pre><code class="javascript hljs">    
<span class="hljs-keyword">const</span> Deal = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../models/deal.model.js"</span>);<font></font>
<font></font>
<span class="hljs-comment">//    </span>
exports.create = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">//   </span>
  <span class="hljs-keyword">if</span> (!req.body) {<font></font>
    res.status(<span class="hljs-number">400</span>).send({
      <span class="hljs-attr">message</span>: <span class="hljs-string">"      "</span><font></font>
    });<font></font>
  }<font></font>
<font></font>
  <span class="hljs-comment">//   </span><font></font>
<font></font>
  <span class="hljs-keyword">const</span> deal = <span class="hljs-keyword">new</span> Deal({
    <span class="hljs-attr">text</span>: req.body.text,
    <span class="hljs-attr">inner_key</span>: req.body.inner_key
    <span class="hljs-comment">//        id,     </span>
    <span class="hljs-comment">//     React</span><font></font>
  });<font></font>
<font></font>
<font></font>
  Deal.create(deal, (err, data) =&gt; {<font></font>
    <span class="hljs-keyword">if</span> (err)<font></font>
      res.status(<span class="hljs-number">500</span>).send({
        <span class="hljs-attr">message</span>:<font></font>
          err.message || <span class="hljs-string">"     "</span><font></font>
      });<font></font>
    <span class="hljs-keyword">else</span> res.send(data);<font></font>
  });<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//      </span>
exports.findAll = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {<font></font>
  Deal.getAll(<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (err)<font></font>
      res.status(<span class="hljs-number">500</span>).send({
        <span class="hljs-attr">message</span>:<font></font>
          err.message || <span class="hljs-string">"-      "</span><font></font>
      });<font></font>
    <span class="hljs-keyword">else</span> 
    res.setHeader(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, <span class="hljs-string">'*'</span>);<font></font>
    res.setHeader(<span class="hljs-string">'Access-Control-Allow-Headers'</span>, <span class="hljs-string">'origin, content-type, accept'</span>);
    <span class="hljs-comment">//   ,   ,   ,          origin</span>
    <span class="hljs-comment">//     open API -,    </span><font></font>
    res.send(data);<font></font>
  });<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will cram the rest of the code under the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spoiler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , because we will only test the above functions. </font><font style="vertical-align: inherit;">However, the rest of the code is also working, but it is technically different only in arguments from what has already been voiced:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the rest of the code</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment">//       inner_id</span>
exports.findOne = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {<font></font>
  Deal.findById(req.params.dealId, (err, data) =&gt; {<font></font>
    <span class="hljs-keyword">if</span> (err) {
      <span class="hljs-keyword">if</span> (err.kind === <span class="hljs-string">"not_found"</span>) {<font></font>
        res.status(<span class="hljs-number">404</span>).send({
          <span class="hljs-attr">message</span>: <span class="hljs-string">`   id <span class="hljs-subst">${req.params.dealId}</span>.`</span><font></font>
        });<font></font>
      } <span class="hljs-keyword">else</span> {<font></font>
        res.status(<span class="hljs-number">500</span>).send({
          <span class="hljs-attr">message</span>: <span class="hljs-string">"     id"</span> + req.params.dealId<font></font>
        });<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> res.send(data);<font></font>
  });<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//    inner_id</span>
exports.update = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">//  </span>
  <span class="hljs-keyword">if</span> (!req.body) {<font></font>
    res.status(<span class="hljs-number">400</span>).send({
      <span class="hljs-attr">message</span>: <span class="hljs-string">"    "</span><font></font>
    });<font></font>
  }<font></font>
<font></font>
<span class="hljs-comment">//    "" -    inner_key</span><font></font>
  Deal.updateById(<font></font>
    req.params.dealId,<font></font>
    <span class="hljs-keyword">new</span> Deal(req.body),<font></font>
    (err, data) =&gt; {<font></font>
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-keyword">if</span> (err.kind === <span class="hljs-string">"not_found"</span>) {<font></font>
          res.status(<span class="hljs-number">404</span>).send({
            <span class="hljs-attr">message</span>: <span class="hljs-string">`    id <span class="hljs-subst">${req.params.dealId}</span>.`</span><font></font>
          });<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
          res.status(<span class="hljs-number">500</span>).send({
            <span class="hljs-attr">message</span>: <span class="hljs-string">"Error updating deal with id "</span> + req.params.dealId<font></font>
          });<font></font>
        }<font></font>
      } <span class="hljs-keyword">else</span> res.send(data);<font></font>
    }<font></font>
  );<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//    inner_key</span>
exports.delete = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {<font></font>
  Deal.remove(req.params.dealId, (err, data) =&gt; {<font></font>
    <span class="hljs-keyword">if</span> (err) {
      <span class="hljs-keyword">if</span> (err.kind === <span class="hljs-string">"not_found"</span>) {<font></font>
        res.status(<span class="hljs-number">404</span>).send({
          <span class="hljs-attr">message</span>: <span class="hljs-string">`    <span class="hljs-subst">${req.params.dealId}</span>.`</span><font></font>
        });<font></font>
      } <span class="hljs-keyword">else</span> {<font></font>
        res.status(<span class="hljs-number">500</span>).send({
          <span class="hljs-attr">message</span>: <span class="hljs-string">"     "</span> + req.params.dealId<font></font>
        });<font></font>
      }<font></font>
    } <span class="hljs-keyword">else</span> res.send({ <span class="hljs-attr">message</span>: <span class="hljs-string">`   `</span> });<font></font>
  });<font></font>
};<font></font>
<font></font>
<span class="hljs-comment">//     </span>
exports.deleteAll = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {<font></font>
  Deal.removeAll(<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (err)<font></font>
      res.status(<span class="hljs-number">500</span>).send({
        <span class="hljs-attr">message</span>:<font></font>
          err.message || <span class="hljs-string">"-        "</span><font></font>
      });<font></font>
    <span class="hljs-keyword">else</span> res.send({ <span class="hljs-attr">message</span>: <span class="hljs-string">`   `</span> });<font></font>
  });<font></font>
};<font></font>
<font></font>
  </code></pre><br>
</div></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Routing </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's move on to the sweetest and easiest: a description of the routing, which you must then remember to import later into server.js itself. </font><font style="vertical-align: inherit;">Using the described ways and methods, we will be able to receive and add data. </font><font style="vertical-align: inherit;">In our app folder, create a routes subfolder in which we need a file </font></font><code>deals.routes.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In it you need to write the following:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> {
 <span class="hljs-comment">//  ,         </span><font></font>
<font></font>
    <span class="hljs-keyword">const</span> deals = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../controllers/deal.controller.js"</span>);<font></font>
  <font></font>
    <span class="hljs-comment">//      post</span>
    app.post(<span class="hljs-string">"/deals"</span>, deals.create);<font></font>
  <font></font>
    <span class="hljs-comment">//    </span>
    app.get(<span class="hljs-string">"/deals"</span>, deals.findAll);<font></font>
  <font></font>
    <span class="hljs-comment">//    id (      inner_key),      </span>
    app.get(<span class="hljs-string">"/deal/:dealId"</span>, deals.findOne);<font></font>
  <font></font>
    <span class="hljs-comment">//    id</span>
    <span class="hljs-comment">//     inner_key</span>
    app.put(<span class="hljs-string">"/deal/:dealId"</span>, deals.update);<font></font>
  <font></font>
    <span class="hljs-comment">//   id</span>
    app.delete(<span class="hljs-string">"/deal/:dealId"</span>, deals.delete);<font></font>
  <font></font>
    <span class="hljs-comment">//    </span>
    app.delete(<span class="hljs-string">"/deals"</span>, deals.deleteAll);<font></font>
  };<font></font>
 <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After that, open our file </font></font><code>server.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and add the following over the wiretap of the port:</font></font><br>
<br>
<pre><code class="javascript hljs">  <span class="hljs-built_in">require</span>(<span class="hljs-string">"./app/routes/deals.routes.js"</span>)(app);<font></font>
<font></font>
 </code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directly using our API </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most of these articles end up testing the API using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POSTMAN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is really a great tool that you should master if you plan to at least do a little professional development of the API (and it is not so important for which platform and in which language). </font><font style="vertical-align: inherit;">If you have finished writing your application, and you forgot to turn on your database, now you can start the application itself:</font></font><br>
<br>
<pre><code class="plaintext hljs">&lt;node server.js&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are completely new, then you will be interested to hear about a package </font></font><code>nodemon</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that restarts your application if there have been changes in the project files:</font></font><br>
<br>
<pre><code class="plaintext hljs">  npm i nodemon -g<font></font>
  nodemon server.js<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now it will be much easier to debug errors that occur. But we were going to test this in a real React application. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I have at hand a simple react-todo that an attentive reader may have noticed in the deployment article of the react application on Heroku of this blog. However, I will not rewrite the entire back-end to our react-application (although this is not at all difficult, but I do not want to over-lengthen the article). Therefore, I will run the React application on the embedded server</font></font><code>create-react-app</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">under port 3000, and our application runs under port 5003. Now let the difficult CRS stand in our way, we can easily get our data at least all todo. I almost completely took an example of the work of our requests from the official React documentation, which is devoted to fetch requests. Requests in React applications are usually carried out after rendering the component in componentDidMount, and it is in it that you need to make requests to remote resources:</font></font><br>
<br>
<pre><code class="javascript hljs">   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span></span>{
    <span class="hljs-keyword">constructor</span>(){
      <span class="hljs-keyword">super</span>()
      <span class="hljs-keyword">this</span>.state ={
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">isLoaded</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">items</span>:[],
        <span class="hljs-attr">currentItem</span>: {<span class="hljs-attr">text</span>:<span class="hljs-string">" "</span>, <span class="hljs-attr">inner_key</span>:<span class="hljs-string">"firstItem"</span>}<font></font>
        <font></font>
      }<font></font>
    }<font></font>
    componentDidMount() {<font></font>
      fetch(<span class="hljs-string">"http://localhost:5003/deals"</span>)<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.json())<font></font>
        .then(<font></font>
          <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
            <span class="hljs-keyword">this</span>.setState({
              <span class="hljs-comment">//   ,     </span>
              <span class="hljs-attr">isLoaded</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">items</span>: result<font></font>
            });<font></font>
          },<font></font>
          <span class="hljs-comment">// :     ,     catch(),</span>
          <span class="hljs-comment">//         .</span><font></font>
          (error) =&gt; {<font></font>
            <span class="hljs-keyword">this</span>.setState({
              <span class="hljs-attr">isLoaded</span>: <span class="hljs-literal">true</span>,<font></font>
              error<font></font>
            });<font></font>
          }<font></font>
        )<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now we have things to do that are pulled from the database: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dh/_f/uw/dh_fuwjeag3lohk39_lztugufou.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Everything works in the application itself: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tc/r_/eh/tcr_ehblld5-tmt3liepqslbf1a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our application works to get all the cases. </font><font style="vertical-align: inherit;">However, the React application has not yet described methods for either deleting or adding cases. </font><font style="vertical-align: inherit;">To simplify cors requests, you should add a React js-build service in the node application, and then describe the methods for adding cases by </font></font><code>inner_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, deleting them and updating them. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thank you all for your attention. </font><font style="vertical-align: inherit;">By tradition, some useful links: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A little interesting from the express documentation about the operation of middleware, in particular body-express </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Writing asynchronous requests for React without axios is no longer fashionable at all. </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And a little bit about setting up cors in Express, since it was discussed</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en491750/index.html">We write substring search better than in textbooks</a></li>
<li><a href="../en491760/index.html">Telegram. Taxi for 200 lines of code</a></li>
<li><a href="../en491778/index.html">Looking for footprints in the sand of fathers and children</a></li>
<li><a href="../en491780/index.html">GitLab 12.8 Released with Log Browser, NuGet and Compliance Dashboard</a></li>
<li><a href="../en491782/index.html">LANIT launches Testing School in Moscow, Penza, Sochi and Novorossiysk</a></li>
<li><a href="../en491788/index.html">What my commit in Angular taught me</a></li>
<li><a href="../en491792/index.html">Wireless HiFiMan as a stage in the evolution of isodynamic headphones</a></li>
<li><a href="../en491796/index.html">Healthy person interview</a></li>
<li><a href="../en491800/index.html">Why everyone should think about it: answers to the most pressing questions about the Covid-19 coronavirus</a></li>
<li><a href="../en491806/index.html">Vitamin B12: how to find out your level and where does brain aging</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>