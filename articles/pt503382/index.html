<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîü üëµ üòà Fa√ßa uma caminhada em um campo limpo ou como coletar endere√ßos MAC de dispositivos Wi-Fi pr√≥ximos üì• üóΩ üßó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Come√ßo todos os meus discursos p√∫blicos (felizmente, n√£o existem muitos) mencionando expl√≠cita ou implicitamente a tese ‚ÄúNosso setor √© complexo, os pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fa√ßa uma caminhada em um campo limpo ou como coletar endere√ßos MAC de dispositivos Wi-Fi pr√≥ximos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503382/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Come√ßo todos os meus discursos p√∫blicos (felizmente, n√£o existem muitos) mencionando expl√≠cita ou implicitamente a tese ‚ÄúNosso setor √© complexo, os problemas podem ser revelados a qualquer momento, mesmo o mais √≥bvio, e √© otimista presumir que tudo ser√° simples e f√°cil - ing√™nuo‚Äù . Curiosamente, essa id√©ia simples, obtida por muitos anos de cones recheados, √†s vezes √© uma revela√ß√£o para especialistas mais experientes, embora pare√ßa que todo o entusiasmo fren√©tico e a cren√ßa na infalibilidade de suas pr√≥prias id√©ias e pr√°ticas devam ter sido resistidos por um longo tempo. Vou contar uma hist√≥ria sobre isso, um exemplo de um projeto simples, √† primeira vista.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um belo dia, um amigo me lan√ßou um link para uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startup interessante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Os caras sugeriram que representantes de pequenas empresas do setor de servi√ßos e vendas estabelecessem um ponto de acesso (com um portal cativo) para seus clientes para distribuir a Internet, coletando simultaneamente os endere√ßos MAC dos smartphones das pessoas que passavam. O objetivo desta a√ß√£o √© muito simples: um grande n√∫mero de redes de publicidade permite segmentar a lista de endere√ßos de dispositivos; portanto, direcionando a empresa de publicidade para os usu√°rios que passarem, provavelmente receberemos novos visitantes (porque √© perto e "em algum lugar que eu j√° vi") . Essa. tal distribui√ß√£o de folhetos virtuais. Um amigo perguntou como isso √© feito e se podemos fazer isso novamente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma r√°pida pesquisa no t√≥pico revelou o mecanismo dessa coleta de dados. O adaptador WiFi foi iniciado no modo de escuta a√©rea e percorreu os canais, capturando pacotes, analisando-os e agregando os dados recebidos. Tamb√©m havia utilit√°rios abertos prontos para isso, por exemplo, airodump-ng do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aircrack-ng</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Essa. para repeti√ß√£o, precisamos apenas executar esse utilit√°rio, de prefer√™ncia em um dispositivo compacto e port√°til, e inserir os dados recebidos no banco de dados, a partir do qual obtemos listas prontas de endere√ßos MAC para redes de an√∫ncios. Parece que a tarefa √© simples, resolvida em uma, no m√°ximo - duas noites de trabalho descontra√≠do, quase tudo est√° pronto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Claro, isso nunca foi o caso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ sabe, o que √© permitido a J√∫piter n√£o √© permitido ao touro. </font><font style="vertical-align: inherit;">E quando os pagadores √∫nicos s√£o usados, √© necess√°rio sacrificar, antes de tudo, recursos de computa√ß√£o e mem√≥ria. </font><font style="vertical-align: inherit;">Al√©m disso, o sacrif√≠cio de recursos √© seguido pelo sacrif√≠cio da conveni√™ncia de desenvolvimento e depura√ß√£o - nem todo sistema permite arrastar ferramentas de compila√ß√£o para o dispositivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicialmente, quer√≠amos algo simples e barato, por exemplo, caixas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orange Pi Zero</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, coloque airodump-ng l√° e encaminhe os dados cuspidos pelo utilit√°rio para o servidor, onde eles podem ser colocados com seguran√ßa no banco de dados. </font><font style="vertical-align: inherit;">Eu tinha experi√™ncia em trabalhar com esses sistemas distribu√≠dos com um centro dedicado (embora, l√°, as m√°quinas virtuais agissem como cavalos de trabalho levantados pela API da nuvem atrav√©s do mesmo centro necess√°rio, mas n√£o o ponto), ent√£o parte do c√≥digo foi migrado com sucesso para um novo projeto .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A ferramenta para encaminhar dados para o servidor foi o aplicativo Erlang mais simples escrito, que deveria extrair dados do amortecedor ether (an√°lise), serializ√°-los (serializa√ß√£o nativa de Erlang) e transferi-los via soquete da web para o servidor via HTTPS (sem causar suspeitas) Sistemas DPI e n√£o inventando seus pr√≥prios protocolos). Os processadores Allwinner H2 + usados ‚Äã‚Äãno Orange Pi s√£o poderosos o suficiente para montar e depurar diretamente no dispositivo. Novamente, em teoria, est√° tudo bem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pr√°tica come√ßou.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. como se viu, o WiFi embutido no Orange Pi era bom apenas para pegar um ponto de acesso e lan√ßar dados no servidor. Bem, mais precisamente, n√£o o pr√≥prio adaptador, mas o suporte de seu chipset no kernel. Para a maioria dos projetos de IoT, isso provavelmente seria suficiente. No entanto, est√°vamos prontos para esse golpe, porque um estudo preliminar do site aircrack-ng deu uma clara e amb√≠gua ambi√ß√£o: "n√£o funcionar√° em todos os lugares; se n√£o for nossa culpa, anexaremos uma lista de chipsets testados". Quase todos os dispositivos Atheros (comprados pela Qualcomm) e Ralink (comprados pela MediaTek) foram encontrados na lista, o que inspirou algumas perspectivas no caso de uma transi√ß√£o de vorazes ARMs chineses para MIPS mais asc√©ticos de chipsets para roteadores.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas, enquanto tudo isso vai do ranho e do pau, ou seja, prototipado - voc√™ precisa resolver o problema aqui e agora. Portanto, aproveitamos esses ex√≥ticos em nosso tempo tecnol√≥gico (quando a comunica√ß√£o sem fio √© mais leve) como um adaptador USB Wi-Fi. Estudar a lista de compatibilidade e compar√°-la com a variedade da loja mais pr√≥xima deu uma v√≠tima - o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLink DWA-160</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na revis√£o C1 (isso √© importante porque outras revis√µes de hardware usavam um chip diferente e causavam dor de cabe√ßa em termos de execu√ß√£o do trabalho). Banda dupla, que n√£o exige dan√ßa com o motorista, j√° que o apoio est√° no centro, esse apito veio a calhar mais tarde em outros projetos, ent√£o eu os comprei, provavelmente todos (cinco pe√ßas) dispon√≠veis em nossa cidade provincial.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bl/7t/z7/bl7tz7yaohb2gfeh1ekkjha31us.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de me certificar de que o dispositivo estava funcionando, eu o conectei a um dispositivo de placa √∫nica e desliguei o adaptador WiFi embutido com a expectativa de que a Internet estivesse dispon√≠vel atrav√©s da interface Ethernet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cy/em/nk/cyemnk-n5d2lzg1aximnuzddg4q.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo porco foi colocado por aerodin√¢mica. Este conjunto de utilit√°rios foi criado com o objetivo de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hackear.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifica√ß√µes de penetra√ß√£o de WiFi, ou seja, foi escrito por hackers para hackers. N√£o sei, gra√ßas a qual l√≥gica eles preferiram usar o dumper et√©reo sem fio, n√£o na forma de uma abordagem unix-way tradicional, para cuspir texto estruturado para processamento adicional, mas para criar uma interface completa para exibir informa√ß√µes quase em tempo real (e levando em considera√ß√£o as configura√ß√µes do terminal) por redes e dispositivos descobertos, mas eles fizeram exatamente isso. Sim, eu achei a API Python de um grau desconhecido de prontid√£o para tudo isso, mas, novamente, a aranha de prototipagem que vivia em minha cabe√ßa proibiu estritamente arrastar outra linguagem, mudar para outra (lembramos, a parte do servidor j√° estava parcialmente pronta e escrita estava longe de Python-e) ou, Deus n√£o permita, implementar o airodump-ng com base no tcpdump. E consequentemente,Eu tive que procurar solu√ß√µes alternativas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Felizmente, os hackers sem fio come√ßaram a suspeitar que algo constantemente est√∫pido na interface √© uma atividade desse tipo; portanto, eles implementaram o upload peri√≥dico de tudo o que foi encontrado e agregado na forma de arquivos CSV. Com um intervalo definido. Voc√™ j√° pode viver com isso. Obviamente, a op√ß√£o ing√™nua - executar o utilit√°rio e reler o arquivo em um timer - foi imediatamente fornecida √† m√£o. Trabalhando em um laptop, ao transferir para uma placa √∫nica, ele come√ßou a falhar no processo de leitura do arquivo por raz√µes √≥bvias - √†s vezes o utilit√°rio simplesmente n√£o tinha tempo para descarregar tudo e alguns dados eram irremediavelmente perdidos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A solu√ß√£o para isso foi o mecanismo de inotifica√ß√£o no kernel, notificando as opera√ß√µes do arquivo - assim que meu c√≥digo viu as altera√ß√µes no arquivo de dados, ele iniciou sua leitura com um pequeno atraso (em vez disso, tendo um valor puramente psicol√≥gico, tranquilize seu autor). As experi√™ncias mostraram que, neste caso, falhas de leitura e perda de dados n√£o ocorrem. Bem, legal, CSV parsim, coloque em estruturas internas e envie para o servidor. N√≥s o salvamos no servidor no PostgreSQL (obrigado pelo jsonb) e depois disso j√° √© poss√≠vel fazer consultas, descarregamentos de formul√°rios etc. Adicionaremos a autoriza√ß√£o mais simples usando uma chave sim√©trica, para n√£o empacotarmos o lixo l√° e podermos vincular os dados ao ponto em que o dispositivo est√° instalado, e tudo parece estar bem, voc√™ pode ir para a batalha.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, agora como. A montagem de teste dessa cadeia (e a reda√ß√£o e depura√ß√£o do c√≥digo realmente levou algumas noites) revelou um fato engra√ßado - o n√∫mero de endere√ßos capturados por dia em nosso escrit√≥rio, longe o suficiente de locais p√∫blicos pass√≠veis de flutua√ß√£o, em torno de milhares de pe√ßas. Sim, √© claro, havia um pequeno hotel por perto (estava em per√≠odo de isolamento de pr√©-quarentena, n√£o se surpreenda), mas ainda assim h√° muito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atualizando o conhecimento da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estrutura do endere√ßo MAC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e lembrando que os dispositivos m√≥veis geralmente geram endere√ßos locais para ocultar seus verdadeiros endere√ßos MAC, modifiquei a parte do servidor com um filtro simples que limpa todos os endere√ßos locais e de broadcast na entrada. A lista foi reduzida por uma ordem de magnitude e j√° parecia a verdade. Tudo estava pronto para testes de campo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ sabe, ao mudar de local de um escrit√≥rio acolhedor e confort√°vel para condi√ß√µes de combate cru√©is, os prot√≥tipos tendem a deixar de funcionar normalmente; portanto, o processo de implementa√ß√£o deve ser acompanhado pelo fornecimento de um engenheiro de bolso que corrija todos os problemas emergentes. Por outro lado, tamb√©m √© sabido que um dispositivo que n√£o requer dan√ßa adicional com um pandeiro no in√≠cio da opera√ß√£o provavelmente quebrar√° em breve e de forma irrevog√°vel. Isso, com certeza, foi refletido nas leis de Murphy, mas, infelizmente, o autor dessas linhas √© muito pregui√ßoso para verificar qual delas, portanto, concordaremos com o termo "lei da maldade". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira instala√ß√£o imediatamente revelou um monte de falhas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em primeiro lugar, a maioria das placas de prototipagem chinesas vem com mem√≥ria microSD de longo prazo, em oposi√ß√£o aos chips flash NAND / NOR. Uma exce√ß√£o √© feita apenas para SoC poderoso, claramente redundante para esta tarefa. Infelizmente, o MicroSD √© a dor de cabe√ßa imediata do operador - oxida√ß√£o dos pads, falha dos cart√µes SD, depend√™ncia dos contatos na temperatura dentro do gabinete (o que √© consider√°vel, os chips chineses n√£o s√£o muito eficientes em termos de energia e as placas s√£o frequentemente calculadas completamente com base em consumo de energia de pico, portanto, sem um radiador adicional, bem, de jeito nenhum). Portanto, quando a energia foi retirada do dispositivo, o sistema entrou em estado inoper√°vel - os arquivos com o bytecode ERTS foram danificados, ap√≥s a reinicializa√ß√£o, o aplicativo se recusou a funcionar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo momento desagrad√°vel - no ponto de instala√ß√£o, a Internet era fornecida por um roteador LTE e era, para dizer o m√≠nimo, de qualidade med√≠ocre, diferente de um fio de escrit√≥rio. A rede constantemente disparava, o aplicativo geralmente era reconectado ou at√© morria de mensagens acumuladas nas filas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, os dois problemas s√£o super√°veis, por exemplo, a perda de dados seria eliminada pela busca da combina√ß√£o ideal de boas configura√ß√µes de cart√£o microSD e sistema de arquivos, e a instabilidade da conex√£o poderia ser compensada pela agrega√ß√£o preliminar de dados, sess√µes curtas de envio, tempo limite, etc. Mas os problemas que foram revelados s√£o uma ocasi√£o para refletir se o caminho certo foi escolhido. A necessidade de uma conex√£o permanente com o servidor p√µe fim √† coleta de dados do evento, quando o dispositivo √© pendurado em uma bateria externa e jogado em uma mochila, cujo propriet√°rio vai para um evento em massa, onde, √© claro, voc√™ n√£o pode esperar estabilidade da conex√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consequentemente, o pr√≥ximo passo foi abandonar a parte do servidor e localizar o data warehouse diretamente no dispositivo. Al√©m disso, para evitar experimentos longos e muito tristes com cart√µes SD, foi decidido usar modelos de placa de ensaio com chips flash na pr√≥xima itera√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naquele momento, lembrei que em minha cole√ß√£o havia uma maravilhosa placa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carambola 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dos camaradas lituanos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8Devices</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . E se voc√™ for ao site deles, poder√° encontrar um dispositivo ainda mais compacto no mesmo chip chamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Centipede</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Experi√™ncias anteriores com essa classe de dispositivos mostraram que Erlang se encaixa completamente nos 16 MB de mem√≥ria flash alocados (e resta um pouco para o aplicativo). O √∫nico ponto negativo (que √© um pouco mais) √© o MIPS de baixa pot√™ncia e a necessidade de compila√ß√£o cruzada, o que torna a constru√ß√£o de um aplicativo Erlang um pouco mais trivial. Mas j√° era uma rota bem conhecida, ent√£o pedi duas centop√©ias e at√© agora portuei a vers√£o existente que funciona com o servidor para Carambol.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ll/x6/sq/llx6sqtfo4vwd4bvbi8tvvcmzsg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando os componentes chegaram, uma nova fase come√ßou. O chip AR9331 foi suportado com sucesso pelo aircrack-ng, os dados podem ser retirados da interface Ethernet, as √∫ltimas vers√µes do OpenWRT e ERTS foram coletadas e testadas com sucesso. O aplicativo foi reescrito - parte do c√≥digo foi movido para o c√≥digo do dispositivo, os dados foram acumulados em um processo separado e periodicamente despejados em um arquivo na forma de um termo Erlang serializado. Para isso foi desenhada a interface baseada na web mais simples que recebe dados via websocket. As portas para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inotify</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec s√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compiladas com seguran√ßa com o OpenWRT.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apenas uma coisa confusa - 300 kilobytes permaneceram nos dados. N√£o √© t√£o pequeno se voc√™ armazena apenas os endere√ßos MAC dos dispositivos clientes, mas o airodump-ng fornece informa√ß√µes muito mais interessantes, incluindo endere√ßos de pontos de acesso, seus ESSIDs e assim por diante, o que tamb√©m seria bom lembrar. Apenas no caso de. Ok, vamos agir de acordo com as circunst√¢ncias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s coletamos, verificamos. Um problema √© revelado em tempo real. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openwrt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como todos sabemos, essa √© uma vers√£o Linux minimalista, projetada especificamente para dispositivos com mem√≥ria limitada. Como resultado, jogou fora de l√° que era poss√≠vel jogar sem dor e simplificou o que poderia ser simplificado, incluindo o modo multiplayer. Essa. √â uma pr√°tica comum quando o c√≥digo come√ßa na raiz e funciona com o m√°ximo de privil√©gios, o que, √© claro, facilita os problemas relacionados a grupos, usu√°rios e controle de suas a√ß√µes. Sim, sim, a letra S na abrevia√ß√£o IoT √© respons√°vel pela seguran√ßa. O problema √© que a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erlexec</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que eu costumava executar e gerenciar airodump-ng, n√£o pode executar opera√ß√µes sob a raiz - para isso, ele precisa de um usu√°rio adicional, em nome do qual gerar√° os processos atribu√≠dos a ele. E ao criar um usu√°rio adicional com um n√≠vel de privil√©gio diferente ... corretamente, impede que o airodump alcance o dispositivo de rede. Desaparafusar essa restri√ß√£o da biblioteca parecia um processo lento, ent√£o o erlexec foi substitu√≠do por ports - o mecanismo interno para iniciar processos de terceiros em Erlang. Um pouco, mas desagrad√°vel.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, os dispositivos s√£o recebidos, reflorestados e at√© funcionam em condi√ß√µes de estufa. Pegamos a bateria, jogamos a caixa na mochila, vamos ao shopping. No dia seguinte, olhamos para o resultado - um fiasco, um arquivo de dados de comprimento zero - ou n√£o havia espa√ßo suficiente ou uma distor√ß√£o do poder n√£o funcionou em um momento muito bom. Corrigimos o c√≥digo para que o salvamento ocorra em dois est√°gios - primeiro um arquivo tempor√°rio foi criado, depois substituiu o atual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, as m√£os n√£o conseguiram verificar a operacionalidade dessa op√ß√£o - o pr√≥ximo brinquedo - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onion Omega2 +</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no Mediatek 7688 foi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exibido.Como</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seus irm√£os, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">o designer do LinkIt Smart 7688</font></a><font style="vertical-align: inherit;"> , havia </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muitas coisas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas o mais importante √© o dobro da mem√≥ria flash, o que significa que voc√™ n√£o pode mais se preocupar com a falta de espa√ßo para armazenamento de dados. OK </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s pedimos, espere. M√™s. Dois. A paci√™ncia explode - escrevemos aos americanos sobre o assunto "onde est√£o os bens, Zin". Sil√™ncio. Abra uma disputa no PayPal. Os americanos est√£o acordando. Eles dizem: "Oh, nosso sistema de aceita√ß√£o de pedidos falhou, agora enviaremos tudo". Eles enviam, esperamos tr√™s semanas. Fuh, o dispositivo est√° dispon√≠vel e at√© funciona.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yb/3a/ph/yb3aphpjdskqkkfcqlzw25pobuc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui precisamos fazer uma pequena digress√£o - apesar de eu ter v√°rias placas LinkIt Smart a uma curta dist√¢ncia, n√£o as considerei uma plataforma, porque no in√≠cio da saga uma tentativa de us√°-las como dispositivos de captura falhou. Em seguida, os drivers do chip foram fornecidos na forma de m√≥dulos montados para vers√µes espec√≠ficas do kernel e, aparentemente, isso se tornou a causa da inoperabilidade. Nas vers√µes mais recentes do OpenWRT, o suporte nativo ao 7688 e um driver aberto apareceram; portanto, √© uma ocasi√£o para reconsiderar a abordagem desses dispositivos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, era costume usar o WiFi diretamente no chip para a finalidade a que se destina - afinal, o dispositivo precisa de pelo menos alguma interface de controle e tamb√©m em campo, pelo menos para entender se est√° funcionando ou n√£o. Analisar os dados obtidos tamb√©m seria √∫til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dessa forma, combinamos as abordagens anteriores - usamos a √∫nica interface USB exibida no MiniDoc como um apito de WiFi para escanear o espa√ßo e o WiFi incorporado - para controlar o dispositivo como um ponto de acesso de baixa energia. Coletamos, verificamos, tudo funciona.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o apetite vem com a comida. Para come√ßar, o arquivo de dados na forma de serializa√ß√£o Erlang √© um monte de man√≠acos reais, e uma gama um pouco maior de profissionais especialmente treinados precisa de algo mais simples. Mais uma vez, al√©m de adicionar dados do airodump, tamb√©m gostaria do tempo exato de medi√ß√£o e, de prefer√™ncia, pelo menos algum tipo de refer√™ncia √† localiza√ß√£o do dispositivo no espa√ßo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Incorporamos entre um apito de WiFi e um dispositivo de hub USB. As configura√ß√µes (e elas dependem da posi√ß√£o do dispositivo no barramento no caso do OpenWRT) s√£o florestadas, mas s√£o pequenas insignific√¢ncias. Corrigir. Retiramos o receptor USB-GPS dos escombros, felizmente, j√° testados pelo tempo e com o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">c√≥digo</font></a><font style="vertical-align: inherit;"> escrito</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An√°lise NMEA-0183 (o c√≥digo, √© claro, teve que ser corrigido de qualquer maneira). Verificamos - o dispositivo n√£o √© detectado com seguran√ßa pelo sistema, h√° claramente uma falta de drivers. Coletamos os drivers USB Serial e os soltamos no dispositivo - tamb√©m em sil√™ncio. Depois, lembramos que em sistemas grandes o apito do GPS foi detectado n√£o como ttyUSBx, mas como ttyACMx, ou seja, Modem USB GSM. Bem, tudo bem, a segunda chamada para adicionar drivers, sucesso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pegamos o c√≥digo, integramos ao aplicativo. </font><font style="vertical-align: inherit;">Adicione sqlite3 ao aplicativo como armazenamento. </font><font style="vertical-align: inherit;">Agora n√£o ser√° necess√°rio verificar a disponibilidade do registro no estado e, em geral, o trabalho com dados √© simplificado para um pequeno n√∫mero de linhas. </font><font style="vertical-align: inherit;">Juntando tudo, ensinamos ao adicionar dados para fazer leituras de GPS, corrigimos o c√≥digo JS no rosto para exibir no caso de um conjunto de dados incompleto (isso pode acontecer quando o GPS ainda n√£o capturou sat√©lites e os dados da varredura a√©rea j√° est√£o chegando). </font><font style="vertical-align: inherit;">Verificamos o trabalho - ele parece viver. </font><font style="vertical-align: inherit;">Voc√™ pode declarar uma vit√≥ria provis√≥ria.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ly/vd/fg/lyvdfgr98fqlrow-vtmumb4ucbw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por algumas semanas de trabalho ininterrupto - muitos dados nas esta√ß√µes no ar e nos clientes. </font><font style="vertical-align: inherit;">Agora, estou com a tenta√ß√£o de oferecer esse dispositivo a especialistas em seguran√ßa da informa√ß√£o para controlar a transmiss√£o nos territ√≥rios confiados e ao Estado para controlar o movimento dos telefones dos cidad√£os. </font><font style="vertical-align: inherit;">√â uma piada, √© claro, eles mesmos j√° sabem tudo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, todas as prova√ß√µes descritas acima s√£o apenas um projeto de estima√ß√£o com complexidade muito baixa (ficou quase imediatamente claro o que fazer e como), a falta de desenvolvimento de hardware (ol√°, f√≠sica) e o acesso a um produto um pouco mais ou menos completo. </font><font style="vertical-align: inherit;">N√£o, √© claro, n√£o se pode descartar que o autor dessas linhas seja um amador denso, e gurus de verdade seguem esse caminho em uma noite entre o ch√° da tarde e um copo de conhaque, mas at√© agora a experi√™ncia mostrou apenas uma coisa: a TI √© complicada e o otimismo √© punido financeiramente. e motivacionalmente, e aqueles que dizem "tudo √© simples" s√£o g√™nios ou vigaristas, e o segundo √© mais prov√°vel.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt503364/index.html">HandsAppMVP: arquitetura iOS para terceiriza√ß√£o de desenvolvimento de est√∫dio</a></li>
<li><a href="../pt503366/index.html">Por que um tra√ßo est√° se tornando uma pergunta? Ou problemas com a codifica√ß√£o de dados no SQL</a></li>
<li><a href="../pt503368/index.html">Gigantomania: por que os jogos modernos pesam tanto?</a></li>
<li><a href="../pt503372/index.html">Ethereum 2.0 pode ser adiado novamente devido a erros, problemas e concorrentes</a></li>
<li><a href="../pt503380/index.html">Trabalhos ass√≠ncronos no Django com aipo</a></li>
<li><a href="../pt503386/index.html">Pessoa saud√°vel de treinador √°gil</a></li>
<li><a href="../pt503388/index.html">Digitaliza√ß√£o do p√¢nico: DIT de Moscou contra moscovitas - mesa-redonda em 23 de maio</a></li>
<li><a href="../pt503390/index.html">Por que a Intel est√° apostando no desenvolvimento de chips para o g√™nio de Jim Keller?</a></li>
<li><a href="../pt503394/index.html">Experi√™ncia em Investimento em A√ß√µes</a></li>
<li><a href="../pt503398/index.html">Como fazer modelagem tem√°tica de um f√≥rum rapidamente ou o que incomoda as pessoas com doen√ßa cel√≠aca</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>