<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÖüèº üöô üë®üèª‚Äçüéì New version of Apple & Google Contact Tracing Protocol üïò üë∂üèø üßî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On April 24, 2020, Apple and Google announced an update to the jointly developed Contact & Tracing Protocol (Apple & Google Contact Tracing Protocol),...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>New version of Apple & Google Contact Tracing Protocol</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500316/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kk/cd/g2/kkcdg2jygjpkziplem0xyl8woqg.png" alt="Apple &amp; Google" width="229"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> On April 24, 2020, Apple and Google announced an update to the jointly developed Contact &amp; Tracing Protocol (Apple &amp; Google Contact Tracing Protocol), which they now call the Exposure Notification Technology, as the name describes the protocol better.</font></font><br>
</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On April 29, iOS 13.5 beta was released</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the first implementation of this protocol. </font><font style="vertical-align: inherit;">Beta aims to test developers a new API and get feedback. </font><font style="vertical-align: inherit;">Access to the API is planned to be issued only to applications officially associated with state medical institutions.</font></font><br>
</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This article will talk about what caused the changes in the protocol, whether the vulnerabilities remained after the update, and whether Apple and Google were able to respond to criticism (often unreasonable).</font></font><br>
</p><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name change</font></font></h2><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As companies note, contact tracing is, although necessary, but just part of the protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The objective of the solution being developed is to notify people in advance that could potentially be infected with COVID-19 in order to reduce the spread of the disease.</font></font><br>
</p><br>
<img src="https://habrastorage.org/webt/fc/1p/no/fc1pno8ktwdkkywknp9qksefrbw.png"><br>
<br>
<p>   ,      ,   ,     COVID-19 (    14 ),   ,  ,       ,     .<br>
<br>
           ,       ,    .<br>
<br>
      .           ,  Apple  Google    .<br>
</p><br>
<p>      ,        .<br>
</p><br>
<h2>   </h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7u/xc/7l/7uxc7lm0tdhdxqn7jqwccunm59u.png" width="281" alt="The working scheme of the old Apple / Google protocol"></div><br>
<p>     iOS  Android  ,   Apple &amp; Google Contact Tracing API   .<br>
</p><br>
<p>        : <br>
</p><br>
<ol>
<li>    Tracing Key.</li>
<li>         Daily Tracing Key  HKDF  Tracing Key    .</li>
<li>     10    Rolling Proximity ID  HMAC  Daily Tracing Key    .</li>
<li>     Bluetooth Low Energy.  ,  ,    .</li>
<li> - ,     14      ,   14 ,  Rolling Proximity ID‚Äôs    14       . </li>
<li>  ,       .</li>
</ol><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=">        .</a><br>
</p><br>
<h2>   </h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xt/js/hs/xtjshs9xs6yvaw_wb0sifavz260.png" width="353" alt="The working scheme of the new Apple / Google protocol"></div><br>
<ol>
<li><p>     16-    Exposure Key.<br>
       Rolling Proximity Key (RPIKey)     Associated Encrypted Metadata Key (AEMKey):<br>
</p><br>
<pre><code class="plaintext hljs">RPIKey = HKDF(ExpKey, NULL, UTF8("EN-RPIK"),16)</code></pre><br>
<pre><code class="plaintext hljs">AEMKey = HKDF(ExpKey, NULL, UTF8("EN-AEMK"),16)</code></pre><br>
<p>:</p><br>
<ul>
<li><code>HKDF</code> ‚Äì  -   <code>HKDF(Key, Salt, Info, OutputLength)</code>   RFC 5869,     SHA-256</li>
<li><code>NULL</code> ‚Äì  ,   <br>
<code>UTF8("EN-RPIK")</code> ‚Äì  ,   EN-RPIK   UTF8<br>
</li>
</ul><br>
<p>Bluetooth LE     MAC   15-20 ,      .<br>
<br>
     MAC      Rolling Proximity ID (RPID)<br>
</p><br>
<pre><code class="plaintext hljs">RPID = AES128(RPIKey, UTF8("EN-RPI") || 0x000000000000 || Ti)</code></pre><br>
<p>:</p><br>
<ul>
<li><code>AES128(Key, Data)</code> ‚Äì  - AES  128- .      128- </li>
<li><code>RPIKey</code> ‚Äì Rolling Proximity Key    </li>
<li> <code>||</code> ‚Äì ,    :<br>
 <ul>
<li><code>UTF8("EN-RPI")</code> ‚Äì   6 ,   EN-RPI   UTF8</li>
<li><code>0x000000000000</code> ‚Äì 6   (    128-  )</li>
<li><code>Ti</code> ‚Äì 4-   10-   ,   <code>unix_timestamp div (60 * 10)</code>,  div ‚Äì   </li>
</ul></li>
</ul><br>
<p>  4   Associated Encrypted Metadata (AEM).   ,    . ,     .<br>
<br>
        .<br>
</p><br>
<pre><code class="plaintext hljs">AEM = AES128‚àíCTR(AEMKey, RPID,  Metadata)
</code></pre><br>
<p>:<br>
<code>AES128‚àíCTR(Key, IV, Data)</code> ‚Äì - AES-CTR, 128-   AEMKey.      ,      .<br>
<br>
    IV  Rolling Proximity Key.<br>
</p><br>
<p>   Rolling Proximity ID    Associated Encrypted Metadata ,     BLE Payload:</p><br>
<br>
<img src="https://habrastorage.org/webt/rg/ae/4d/rgae4dwyh6zde46wehazpkedojq.png"><br>
<br>
<p>    Bluetooth Low Energy.  ,  ,   .</p></li>
<li> - ,     14  .   ,   14 ,  Rolling Proximity ID‚Äôs    14       . <br>
</li>
</ol><br>
<h2>   </h2><br>
<h3></h3><br>
<p> ‚Äú ‚Äù    Apple  Google. <br>
<br>
          Apple  Google    .  ,   ,  ,     .    (,       )      .<br>
</p><br>
<h3>  </h3><br>
<p>   Tracing Key,        Daily Tracing Key‚Äôs,  .<br>
<br>
    Exposure Key ( Daily Tracing Key)  , ..        . <br>
<br>
      DP-3T,    .          .<br>
</p><br>
<p>Apple / Google     ,    2-  :</p><br>
<ul>
<li>      ,     Tracing Key.   ,            .</li>
<li>     Daily Tracing Key         Tracing Key,      ,         BLE         (   Tracing Key).</li>
</ul><br>
<h3>AES  HMAC-SHA-256</h3><br>
<p>   AES  HMAC-SHA-256    . <br>
<br>
     10    ,            . <br>
<br>
,   -        10K .<br>
<br>
 140K    140K*144 ~ 20   (   144   24*60/10),     .<br>
<br>
  ,       ,         ,      ,     . ,       10   , .. 140   2 ,   140*10K=1,4M ,    .<br>
<br>
 AES       ,          .<br>
</p><br>
<h3>  MAC  RPI</h3><br>
<p>       .<br>
<br>
      ,    Rolling Proximity Identifier   10 ,     MAC  Bluetooth LE       15-20 . <br>
<br>
 , RPI  MAC   ,     RPI  MAC    MAC  RPI.<br>
<br>
       ,    ,  Bluetooth .<br>
<br>
    MAC  RPI .<br>
<br>
:<br>
</p><blockquote>The key schedule is fixed and defined by operating system components, preventing applications from including static or predictable information that could be used for tracking. <br>
</blockquote><br>
<p>,    ,      ,    MAC  RPI   .<br>
<br>
   DP-3T  OpenCovidTrace        Bluetooth LE     .<br>
</p><br>
<h3>Associated Metadata</h3><br>
<p>   ‚Äì      .    ,          ,    .<br>
</p><br>
<b>     :</b><br>
<br>
<ul>
<li>-,          15-20 ,    4 .<br>
<br>
  : 1)    , 2) , 3)  (, ..  4 ), 4) , 5)   , 6) , ID,    ,  .<br>
</li>
<li>-,      (  )       ,         .<br>
<br>
 ,    ,      .  ,   ,     , ..       (     ,       ). ,  ,    .<br>
</li>
<li>  ,        ,          ,            .<br>
<br>
,       .<br>
</li>
</ul><br>
<b>,   : </b><br>
<br>
<ul>
<li>     Bluetooth ,    .</li>
<li>   /,  ,  ,   .</li>
<li> ,   ,     ID,          ,      .               ,  ,  ID  . <br>
<br>
        ID        . <br>
</li>
</ul><br>
<h2></h2><br>
<p> ,          .<br>
<br>
      ,      ,       .  ,       .<br>
</p><br>
<p>   ‚Äì  IT              ‚Äì      .<br>
</p><br>
<p>  OpenCovidTrace   ,          open-source,         .<br>
</p><br>
<p><img src="https://habrastorage.org/webt/rp/3x/w-/rp3xw-ahaouj0xjdlqm7315crz0.png" width="90" align="left"><br>
    open-source  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">OpenCovidTrace</a>,    DP-3T    Apple/Google   ,   iOS.<br>
</p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">    Github! </a><br>
<br>
        ,          .<br>
</p><br>
<p>    OpenCovidTrace,        .</p><br>
<p>  ,  .</p><br>
<h2></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  Apple &amp; Google</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">C  open-source </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">C    Github</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">Github   DP-3T,    </a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en500304/index.html">Understanding CSS Grid (Part 2): Grid Lines</a></li>
<li><a href="../en500308/index.html">Digital events in Moscow from May 4 to 10</a></li>
<li><a href="../en500310/index.html">Automation of identification of modifications in the image of contract documents using the N-gram model</a></li>
<li><a href="../en500312/index.html">Writing a JavaScript note taking application</a></li>
<li><a href="../en500314/index.html">PHP Digest No. 179 (April 21 - May 4, 2020)</a></li>
<li><a href="../en500318/index.html">HP Elite Dragonfly - what kind of Athena laptop are you?</a></li>
<li><a href="../en500320/index.html">Own game engines: a little research</a></li>
<li><a href="../en501090/index.html">K8S Multicluster Journey</a></li>
<li><a href="../en501092/index.html">About the search for promising June and "udalenka". Redmadrobot Technical Support Manager Experience</a></li>
<li><a href="../en501098/index.html">SmartLi Smart Battery Solutions for Modular UPS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>