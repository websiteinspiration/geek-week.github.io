<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👩🏻 🧔🏻 👨‍👩‍👧‍👧 Qu'est-ce qu'Azure Stack HCI et comment ça marche 💀 🛥️ 🐁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Aujourd'hui, nous voulons parler de la plate-forme Azure Stack HCI. Y compris ce qu'il est en général, à partir de quel matériel est as...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Qu'est-ce qu'Azure Stack HCI et comment ça marche</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/496766/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour, Habr! </font><font style="vertical-align: inherit;">Aujourd'hui, nous voulons parler de la plate-forme Azure Stack HCI. </font><font style="vertical-align: inherit;">Y compris ce qu'il est en général, à partir de quel matériel est assemblé, quel logiciel contient, comment il fonctionne, et c'est tout. </font><font style="vertical-align: inherit;">Adhérer maintenant!</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ms/a8/ns/msa8nsszbolcqdqftfpzhmhkkci.png"><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est un post invité des gars d'AltaStor. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AltaStor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un intégrateur de systèmes spécialisé dans la création de solutions pour un stockage fiable des données. </font><font style="vertical-align: inherit;">Grâce à l'expertise accumulée dans la création de clusters de basculement et de HCI, une solution individuelle est sélectionnée pour chaque client le mieux adapté à ses tâches.</font></font></blockquote><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que Azure Stack HCI?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'agit d'une solution hyperconvergée qui combine plusieurs produits:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matériel d'un partenaire OEM certifié Microsoft.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Système d'exploitation Windows Server 2019 Datacenter.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logiciel Windows Admin Center.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Services Microsoft Azure si nécessaire.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette solution existe depuis longtemps sur le marché et certains de nos clients l'utilisent depuis longtemps et avec succès. </font><font style="vertical-align: inherit;">Cependant, ils ne publient pas les résultats des tests de performances de leur installation. </font><font style="vertical-align: inherit;">Nous avons décidé de combler cette lacune et de parler de notre expérience d'utilisation d'Azure Stack HCI avec un exemple spécifique. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour obtenir de la documentation et des informations générales sur Azure Stack HCI, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cliquez ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disposition du stand</font></font></h2>&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/086/5d0/047/0865d0047d86f46f5e2999f9abac8409.jpg"><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Équipement</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La création d'une solution nécessite une plate-forme matérielle recommandée par Microsoft. Les principaux fabricants de matériel serveur - HPE, Dell EMC, Fujitsu, Hitachi, Lenovo, etc. - ont développé leurs configurations, les ont testées pour la compatibilité et certifiés pour Azure Stack HCI. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une liste complète des équipements compatibles est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon les types de lecteurs utilisés, les composants de la plate-forme varient. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous préférons construire de telles solutions sur la base de serveurs Fujitsu avec le système d'exploitation Windows Server 2019 Datacenter préinstallé. Ce fabricant après la vente prend en charge l'ensemble du complexe logiciel et matériel en tant que solution complète, et pas seulement son matériel. Ceci est important pour nous, en tant que partenaires, et pour le client final.</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Actuellement, Fujitsu dispose de cinq configurations certifiées pour différents types de disques, modèles de serveurs et nombre de nœuds. Le nombre maximal de nœuds pour Azure Stack HCI est de 16, le minimum est de 2, mais certaines configurations sont limitées à 4. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les configurations Fujitsu compatibles peuvent être consultées </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour l'installation, nous avons choisi la configuration la plus efficace parmi celles actuellement certifiées - Fujitsu Primergy avec des disques SSD pour le stockage des données, et des modules de mémoire ultra-rapides Intel Optane connectés via l'interface NVMe comme cache système. Nous nous attendons à obtenir une baie 100% Flash définie par logiciel avec des performances comparables au stockage classique avec des disques SSD et un cache NVMe.</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les systèmes de stockage 100% Flash des leaders de l'industrie ont des configurations de type de support similaires. </font><font style="vertical-align: inherit;">Nous savons quels IOPS et mesures de latence peuvent être obtenus dans la pratique à partir de systèmes similaires et attendons avec impatience des performances similaires d'Azure Stack HCI basées sur la configuration Fujitsu sélectionnée. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/097/a99/1f1/097a991f1f820647f030183802c834e3.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'architecture de cette solution Fujitsu est décrite en détail dans un document disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous vous recommandons de vous familiariser avec celui-ci avant l'installation. </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/468/866/9ae/4688669aee12df9248e368a88c758af0.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le document décrit les limites de l'architecture, les schémas de connexion typiques et de nombreuses autres informations utiles au stade de la mise en œuvre.</font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/9b5/f47/26c/9b5f4726c82a82d0d12d6dafd967e443.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commutateurs</font></font></h2>&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La solution de Fujitsu utilise son propre commutateur Ethernet PSWITCH. </font><font style="vertical-align: inherit;">Pour nous, nous avons noté les avantages suivants:&nbsp;</font></font><br>
&nbsp;<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les interrupteurs de cette série sont très productifs, à faible coût.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les commutateurs sont assez simples à configurer et à utiliser l'interface de type CISCO. </font><font style="vertical-align: inherit;">Les ingénieurs n'ont rencontré aucune difficulté lors de l'installation.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a aucun excès de propriété dans l'administration et une documentation compétente est disponible.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'équipement de commutation Fujitsu est l'un des leaders de l'industrie au Japon. </font><font style="vertical-align: inherit;">Il est récemment devenu disponible sur le marché russe, mais est déjà régulièrement utilisé dans les projets de nos architectes et autres partenaires Fujitsu. </font><font style="vertical-align: inherit;">Un nombre limité de modèles sont actuellement disponibles.&nbsp;</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En savoir plus sur les commutateurs Fujitsu sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site officiel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serveur</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'intérieur du serveur, les cartes mémoire Intel Optane occupent une partie importante de l'espace.&nbsp; </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/895/742/c12/895742c127ddef9ed35f44ddbfc2b6fa.jpg"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/5bb/1dd/77f/5bb1dd77f0079b9babe09973b132156b.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Intel accorde une grande attention aux performances en cas de forte demande de chaleur. D'une part, pour un refroidissement de qualité maximale, de grands radiateurs sont utilisés. En revanche, cela limite le flux d'air de refroidissement à l'intérieur de l'ensemble du serveur.&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est l'un des points clés qui est pris en compte lors de la certification de la configuration - il est nécessaire de considérer tous les scénarios possibles dans lesquels, en raison d'un refroidissement insuffisant, les serveurs sont capables de surchauffer le module Optane, ou vice versa.</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du déménagement de la salle des serveurs, nos clients ont plus d'une fois été confrontés à une situation où le système de climatisation n'était pas encore mis en service. Par conséquent, nous avons décidé de vérifier à quel point cette installation est exigeante pour le système de refroidissement et de mesurer la durée de vie de la plate-forme sous charge à l'extérieur de la salle des serveurs refroidie.&nbsp;&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les tests ont été effectués à température ambiante, mais nous n'avons rencontré aucune limitation thermique, ni diminution des performances, ni apparition d'erreurs dues à une surchauffe. Nous avons vu de notre propre expérience que les serveurs testés prennent en charge la capacité de travail déclarée à une température ambiante allant jusqu'à +45 degrés Celsius.&nbsp; </font></font><br>
&nbsp;<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette expérience ne doit pas être considérée comme une recommandation d'abandonner l'utilisation de salles de serveurs spéciales avec une ventilation de haute qualité. </font><font style="vertical-align: inherit;">Lorsque vous choisissez un fournisseur de solutions matérielles, assurez-vous de faire attention au package de température maximale.</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblage de plate-forme matérielle</font></font></h2>&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vue avant: Vue </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/7b5/53b/5eb/7b553b5eb67aaa8405b3aec5eb7ddfd7.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
arrière: </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/1db/a71/be8/1dba71be8bf20b34a2874dfb64d2e758.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un seul interrupteur a été utilisé dans le test. </font><font style="vertical-align: inherit;">Pour une utilisation commerciale, nous vous recommandons toujours de réserver des chemins d'accès en utilisant au moins deux commutateurs. </font><font style="vertical-align: inherit;">Selon nos statistiques, la défaillance matérielle la plus courante dans les clusters est une rupture accidentelle de câble ou un contact rompu dans le connecteur.&nbsp;</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fujitsu RX1330 a été utilisé comme serveur avec un logiciel de contrôle. </font><font style="vertical-align: inherit;">Il s'est également vu confier les fonctions d'arbitre et de serveur de quorum.</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déploiement de cluster</font></font></h2>&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première étape a consisté en l'installation physique des composants matériels, la connexion des câbles d'interface, etc. </font><font style="vertical-align: inherit;">Cela a été suivi par la configuration du logiciel, comme </font><font style="vertical-align: inherit;">Le système d'exploitation est déjà préinstallé. </font><font style="vertical-align: inherit;">Nous avons déployé Storage Space Direct sur chaque serveur et construit un cluster de 2 nœuds et un arbitre. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons ensuite utilisé l'utilitaire Fujitsu Infrastructure Manager, une extension </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows Admin Center</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui s'intègre étroitement avec le matériel du serveur Fujitsu et contient tous les outils de gestion d'Azure, tels que:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Site Recovery fournit une haute disponibilité et une reprise après sinistre en tant que service (DRaaS).</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Azure Monitor est un site centralisé pour surveiller le fonctionnement des applications, des réseaux et de l'infrastructure avec des analyses approfondies basées sur l'IA.</font></font><br>
</li>
<li>«-»   Azure          .<br>
</li>
<li> Azure Backup     ,      -.<br>
</li>
<li> «  Azure»          Windows,   Azure    .<br>
</li>
<li>  Azure          Azure  VPN-  « — ».<br>
</li>
<li> «  Azure»     .&nbsp;<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'extension vous permet d'automatiser un certain nombre de tâches qui peuvent également être effectuées directement dans le centre d'administration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pool de stockage rassemblé, créé des volumes dedans. </font><font style="vertical-align: inherit;">Ces volumes sont par la suite localisés des machines virtuelles pour lesquelles nous avons effectué des tests de performances. </font><font style="vertical-align: inherit;">Les volumes et les machines virtuelles sont gérés de manière pratique à partir d'une seule fenêtre. </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/f25/a14/7cf/f25a147cf1d43eb65ce7afab6c5f2e6a.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grâce à Fujitsu Infrastructure Manager, il est également pratique de faire beaucoup de choses sur la maintenance planifiée et les mises à jour du microcode. </font><font style="vertical-align: inherit;">L'état de tous les équipements est clairement affiché, beaucoup peut être automatisé. </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/364/a36/bed/364a36bed36a81528668e7d705699c11.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe deux versions de l'utilitaire Fujitsu Infrastructure Manager - payantes et gratuites:</font></font><br>
&nbsp;<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gratuit. </font><font style="vertical-align: inherit;">Disponible en téléchargement sur le site Web du fabricant, il suffit amplement pour la gestion du serveur.</font></font><br>
</li>
<li>.       Microsoft Azure HCI —      Windows Server     .<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour une intégration profonde de Primergy avec Microsoft Azure Stack HCI, vous avez besoin d'un plug-in de gestion de serveur à partir de Windows Server, qui n'est disponible que dans la version payante. Par conséquent, la solution FUJITSU Integrated System PRIMEFLEX pour Microsoft Azure Stack HCI en fait partie.&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus vous avez d'installation, plus l'automatisation fournie par l'utilitaire est précieuse. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a que 2 nœuds dans notre stand et nous pourrions faire tout le travail manuellement. Si vous avez 4 nœuds ou plus, le logiciel réduira considérablement vos efforts d'installation et d'administration. Le coût des services publics représente moins de 1% du projet, mais accélère considérablement la mise en service des équipements. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le Centre d'administration Windows, Fujitsu Infrastructure Manager Orchestra est un pack d'extension:</font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/03b/747/11d/03b74711d36cdbe8d7809619e3b38e6f.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La même capture d'écran montre la composition du sous-système de disques du serveur: deux modules Optane sont utilisés comme extension de cache et cinq disques SSD comme pool de stockage de niveau 1.</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les points importants</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la création d'une solution, plusieurs nuances doivent être prises en compte: </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
vous pouvez gérer Microsoft Azure Stack HCI de deux manières: via le Centre d'administration Windows ou Fujitsu Infrastructure Manager.&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Admin Center a également ses avantages - vous pouvez le déployer sur n'importe quoi, même sur un ordinateur portable; Il est possible de contrôler à partir de la ligne de commande. Avec lui, l'administrateur peut faire presque n'importe quoi.&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il existe également Cluster Manager - un outil indispensable pour tout problème avec le cluster.&nbsp; </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du déploiement de Witness (serveur de quorum), il est important de l'ajouter à Active Directory et de vérifier sa disponibilité sur tous les nœuds. Les exigences pour cette tâche sont minimes et peuvent être placées sur n'importe quel serveur de base.</font></font><br>
<img src="https://habrastorage.org/getpro/habr/post_images/081/cfc/f9b/081cfcf9b862e035a65600f1138f5dfe.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du point de vue de Windows Server, il existe trois types de périphériques de disque: NVMe, SSD et HDD. La logique du travail est la suivante: les périphériques NVMe sont le cache de lecture / écriture, le SSD est le niveau de stockage de niveau 1; HDD - Niveau de stockage Tier-2. Ensuite, vous pouvez configurer des stratégies pour déplacer des données entre des pools. Les NVDIMM peuvent également être utilisés comme cache. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La taille de bloc par défaut pour la déchirure est 4K, mais peut varier en fonction du type de système de fichiers dans la machine virtuelle. Cela affectera par la suite les performances. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous utilisons des modules NVMe comme cache, donc la vitesse de lecture et d'écriture des données sera très différente - cela sera clairement visible dans les tests de performances:</font></font><br>
&nbsp;<br>
<ul>
<li>                 ( ),    SSD (Tier-1,  ).<br>
</li>
<li>       NVMe    ,       ,       .    .<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de créer un cluster, la validation et tous les tests dans le gestionnaire de cluster de basculement doivent être terminés. </font><font style="vertical-align: inherit;">Le rapport doit être enregistré, car sans lui, il ne sera pas possible d'ouvrir un appel de service dans le support Microsoft, si nécessaire. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de l'ajout de nouveaux nœuds à un cluster existant, les nœuds seront automatiquement ajoutés au pool de stockage. </font><font style="vertical-align: inherit;">Après 15 minutes, le cluster reconstruira, reconstruira et équilibrera automatiquement le pool de stockage. </font><font style="vertical-align: inherit;">Cela peut affecter les performances lors de la reconstruction.</font></font><br>
&nbsp;<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des tests de performance</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant à la partie la plus intéressante - les tests de charge. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Configuration de test:</font></font><br>
&nbsp;<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux serveurs Fujitsu PRIMERGY RX2540 assemblés en cluster;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chaque serveur dispose de deux modules de mémoire de classe de stockage Intel Optane installés, utilisés pour étendre le cache de lecture / écriture;</font></font><br>
</li>
<li>      SSD,      ,<br>
</li>
<li>      erasure coding ( RAID-5).<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, il s'agit d'un système de stockage défini par logiciel exécutant Windows Server 2019 Azure Stack HCI. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous commençons le premier test avec 12 machines virtuelles exécutées sur les deux nœuds. Le profil de chargement en lecture / écriture est 70:30, la taille du bloc = 8k. La taille de bloc a été choisie en fonction du fait que la plupart des bases de données transactionnelles et des charges OLTP modernes utilisent exactement une telle taille de bloc et approximativement le même rapport de lecture / écriture. </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/6b2/d7c/9da/6b2d7c9dac708b1f4d5330e3f0742e00.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les performances du cluster en régime permanent sont de 428 000 IOPS avec un retard de 0,487 ms. C'est un résultat vraiment digne, qui est tout à fait comparable à ce que vous pouvez obtenir sur un système de stockage 100% flash spécialisé de nombreux fabricants.&nbsp;</font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Des tests indépendants avec un profil de charge similaire sont fournis sur la ressource spcresults.org - il s'agit du test SPC-1. La différence avec notre configuration réside uniquement dans la taille du bloc - elle est de 4k. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous simplifions considérablement la méthodologie de comparaison des résultats, nous pouvons diviser en deux indicateurs IOPS obtenus pour les systèmes de stockage 100% flash et les comparer avec les chiffres que nous avons reçus au même temps de réponse. Les résultats obtenus sur notre cluster de deux serveurs de niveau intermédiaire sont assez comparables à la plupart des systèmes de stockage.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, une telle comparaison n'est pas très correcte, car dans notre cas, une augmentation du nombre de disques affectera les performances et les retards différemment qu'avec un système de stockage spécialisé. Mais, même en tenant compte de toutes ces hypothèses, on peut dire qu'il y a quelques années, de telles performances n'étaient visibles que sur un système de stockage externe multi-contrôleurs d'un niveau moyen voire supérieur. Aujourd'hui, cela est réalisable sur une solution hyperconvergée. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'image des performances change considérablement lorsque la déduplication et les mesures sont activées avec la taille de bloc précédente = 8k. Si vous activez simplement la déduplication sur le même profil de charge, les performances seront inférieures à 300 000 IOPS.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous exécutons deux profils de charge avec un bloc de 8 Ko où un profil est 100% lu et l'autre 100% écrit, alors ci-dessous sont les meilleurs chiffres que nous avons pu obtenir: </font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ed8/e3d/5e3/ed8e3d5e3a387044eb8b52b8fa45ca41.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons d'excellents résultats de lecture, surtout si nous prenons en compte un retard de 12 μs. </font><font style="vertical-align: inherit;">Ici, Optane fait vraiment un excellent travail en tant que cache de lecture avec des algorithmes proactifs pour le transfert prédictif de données vers le cache. </font><font style="vertical-align: inherit;">Oui, et le pool de stockage lui-même, situé sur le SSD, affiche également de très bons nombres de lecture. </font></font><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais la vitesse d'écriture est très différente. </font><font style="vertical-align: inherit;">Voici quelques facteurs sérieux:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'architecture de la solution, lorsque des données tombant dans le cache d'un nœud sont copiées sur le réseau vers le cache du deuxième nœud.</font></font><br>
</li>
<li>  :         —  ,         Optane.          . <br>
<br>
            45%,            ,      — ,     .       .<br>
</li>
<li>   SSD       SSD —    3D-NAND ,         3D-NAND.<br>
</li>
</ul><br>
<h2></h2><br>
<ul>
<li> OLTP-      –       8k    .&nbsp;&nbsp;<br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La déduplication peut être activée à tout moment, mais elle réduit considérablement les performances. </font><font style="vertical-align: inherit;">L'efficacité de la déduplication dans nos tests était de 45% avec une baisse de performance de plus de 25%.&nbsp;</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela vous donne la liberté de choix - soit des performances de stockage supérieures, soit presque deux fois plus de capacité. </font><font style="vertical-align: inherit;">En outre, beaucoup dépendra du profil de charge et de la capacité de compresser les données enregistrées.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En raison de l'architecture de la solution, les opérations d'écriture séquentielle augmentent considérablement le temps de réponse.&nbsp;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce n'est pas en vain que Microsoft vous oblige à construire une solution uniquement sur la base de configurations validées de partenaires OEM - cela vous permet d'éviter de nombreux problèmes à la fois lors de l'installation initiale et lors de travaux ultérieurs.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Travailler avec le matériel de Fujitsu, comme toujours, n'a laissé qu'une impression positive. </font><font style="vertical-align: inherit;">Il s'agit d'une documentation judicieuse et de nombreux ajouts utiles d'Infrastructure Manager - ce progiciel simplifie considérablement la gestion du système. </font><font style="vertical-align: inherit;">Ceci est particulièrement important lors de l'augmentation du nombre de nœuds.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La solution PRIMEFLEX de Fujitsu comprend un ensemble de scripts qui accélère le processus de déploiement. </font><font style="vertical-align: inherit;">Ils facilitent le démarrage et la configuration en général, et les serveurs Fujitsu PRIMERGY en particulier.</font></font><br>
</li>
</ul><br>
<img src="https://habrastorage.org/getpro/habr/post_images/fdc/a11/060/fdca11060f83e478d5edd39134097dfa.jpg"><br>
&nbsp;<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ceux qui ne souhaitent pas régler automatiquement la solution, il est possible de conclure un contrat de solution technique avec Fujitsu. </font><font style="vertical-align: inherit;">Dans ce cas, les spécialistes techniques du fournisseur déploieront tout sur une base clé en main et fourniront un support supplémentaire.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr496756/index.html">AWS Lambda en action. Partie 2: se familiariser avec les outils de développement et de test</a></li>
<li><a href="../fr496758/index.html">Soins de santé médiévaux numériques. Transformation technologique mondiale après COVID-19</a></li>
<li><a href="../fr496760/index.html">Flux d'utilisateurs: comment créer des applications et des sites populaires</a></li>
<li><a href="../fr496762/index.html">Simulation d'érosion de surface basée sur les particules</a></li>
<li><a href="../fr496764/index.html">Petit mais fier: DuckDuckGo vs Ad Monsters</a></li>
<li><a href="../fr496768/index.html">Oubliez RVB et HEX</a></li>
<li><a href="../fr496770/index.html">Appartement d'ingénieur automatisé. Partie 1: énoncé du problème, choix du fer</a></li>
<li><a href="../fr496772/index.html">Les véhicules sans pilote devraient «garder à l'esprit» les marques de voitures conduites par les conducteurs les plus exigeants</a></li>
<li><a href="../fr496774/index.html">Nous élevons notre serveur de jeu Minecraft à part entière avec des mini-jeux. Partie 3. Installer des mini-jeux</a></li>
<li><a href="../fr496776/index.html">Piratage de véhicules sans pilote: qui en sera responsable (étude RAND Corporation)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>