<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍿 😭 🕐 これまでに会ったことのない役立つPythonのヒント。パート2 👩‍🚒 👨🏾‍🏭 ⏳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="最近、Pythonプログラマーに役立つヒントを提供する資料の翻訳を公開しました。その素材には、今日私たちが注目する続編があります。
 
 
 
 スライス機能を使用したスライスの命名
 インデックスで指定された多くの値を操作すると、サポートの面でもコードの可読性の面でも、すぐに混乱に陥る可能性があり...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>これまでに会ったことのない役立つPythonのヒント。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/485646/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最近</font><font style="vertical-align: inherit;">、Pythonプログラマーに役立つヒントを提供</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">資料の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">翻訳を</font></a><font style="vertical-align: inherit;">公開しました</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">その素材には、今日私たちが注目する続編があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/-w/3e/jo/-w3ejolwnxhzruyjir_ojkjy2bk.jpeg"></a><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スライス機能を使用したスライスの命名</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インデックスで指定された多くの値を操作すると、サポートの面でもコードの可読性の面でも、すぐに混乱に陥る可能性があります。</font><font style="vertical-align: inherit;">状況を改善する1つの方法は、インデックスで指定された値に定数を使用することです。</font><font style="vertical-align: inherit;">しかし、質の高いコードを書くためのより良い方法があります：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ID    First Name &nbsp; &nbsp; Last Name</span>
line_record = <span class="hljs-string">"2&nbsp; &nbsp; &nbsp; &nbsp; John         Smith"</span><font></font>
<font></font>
ID = slice(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>)<font></font>
FIRST_NAME = slice(<span class="hljs-number">9</span>, <span class="hljs-number">21</span>)<font></font>
LAST_NAME = slice(<span class="hljs-number">22</span>, <span class="hljs-number">27</span>)<font></font>
<font></font>
name = <span class="hljs-string">f"<span class="hljs-subst">{line_record[FIRST_NAME].strip()}</span> <span class="hljs-subst">{line_record[LAST_NAME].strip()}</span>"</span>
<span class="hljs-comment"># name == "John Smith"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、関数を使用してスライサーに名前を付け、</font></font><code>slice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらの名前を使用して文字列のフラグメントを取得することで、複雑なインデックスを取り除くことができたことがわかります。</font><font style="vertical-align: inherit;">オブジェクトの詳細については、</font></font><code>slice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その属性を使用して見つけることができる</font></font><code>.start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>.stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>.step</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムの実行中にユーザーにパスワードを要求する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くのコマンドラインツールまたはスクリプトでは、機能するためにユーザー名とパスワードが必要です。</font><font style="vertical-align: inherit;">そのようなプログラムを書かなければならないなら、あなたはそのモジュールが役に立つと思うかもしれません</font></font><code>getpass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> getpass<font></font>
<font></font>
user = getpass.getuser()<font></font>
password = getpass.getpass()<font></font>
<span class="hljs-comment">#   ...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この非常にシンプルなパッケージを使用すると、ユーザーにパスワードを要求するだけでなく、ユーザーがログオンしている名前を取得してユーザー名を取得できます。</font><font style="vertical-align: inherit;">ただし、パスワードを使用する場合は、すべてのシステムがパスワードの非表示をサポートしているわけではないことに注意してください。</font><font style="vertical-align: inherit;">Pythonが通知を試みます。</font><font style="vertical-align: inherit;">この場合、対応する警告がコマンドラインに表示されます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列内で一致するものを見つける</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、Python標準ライブラリのもう少し神秘的な機能について説明します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レーベンシュタインの距離</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">などの概念を使用して</font><font style="vertical-align: inherit;">、特定の入力行のように見える単語をリストから見つける</font><font style="vertical-align: inherit;">必要がある状況にいるとします</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この問題は、モジュールを使用して解決できます</font></font><code>difflib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> difflib<font></font>
difflib.get_close_matches(<span class="hljs-string">'appel'</span>, [<span class="hljs-string">'ape'</span>, <span class="hljs-string">'apple'</span>, <span class="hljs-string">'peach'</span>, <span class="hljs-string">'puppy'</span>], n=<span class="hljs-number">2</span>)
<span class="hljs-comment"># returns ['apple', 'ape']</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッド</font></font><code>difflib.get_close_matches</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、「十分な」最良の一致を検索します。</font><font style="vertical-align: inherit;">このメソッドの最初の引数は検索文字列を設定し、2番目の引数は検索が実行されるリストを設定します。</font><font style="vertical-align: inherit;">このメソッドには、</font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返される一致の最大数を設定</font><font style="vertical-align: inherit;">するオプションの引数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">渡すことができます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このメソッドは、オプションの名前付き引数もサポートします</font></font><code>cutoff</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（デフォルトではに設定されて</font></font><code>0.6</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">います）。これにより、一致を評価するためのしきい値を設定できます。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IPアドレスを使用する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pythonでネットワークを操作するためのプログラムを作成する必要がある場合、これはモジュールが非常に役立つことを意味します</font></font><code>ipaddress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これを使用するためのオプションの1つは、CIDR形式（クラスレスドメイン間ルーティング、クラスレスアドレス指定）で指定されたアドレスの範囲からIPアドレスのリストを生成することです。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> ipaddress<font></font>
net = ipaddress.ip_network(<span class="hljs-string">'74.125.227.0/29'</span>)&nbsp; <span class="hljs-comment">#      IPv6</span>
<span class="hljs-comment"># IPv4Network('74.125.227.0/29')</span><font></font>
<font></font>
<span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> net:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;print(addr)<font></font>
<font></font>
<span class="hljs-comment"># 74.125.227.0</span>
<span class="hljs-comment"># 74.125.227.1</span>
<span class="hljs-comment"># 74.125.227.2</span>
<span class="hljs-comment"># 74.125.227.3</span>
<span class="hljs-comment"># ...</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモジュールのもう1つの便利な機能は、特定のネットワークに属するIPアドレスをチェックすることです。</font></font><br>
<br>
<pre><code class="python hljs">ip = ipaddress.ip_address(<span class="hljs-string">"74.125.227.3"</span>)<font></font>
<font></font>
ip <span class="hljs-keyword">in</span> net
<span class="hljs-comment"># True</span><font></font>
<font></font>
ip = ipaddress.ip_address(<span class="hljs-string">"74.125.227.12"</span>)<font></font>
ip <span class="hljs-keyword">in</span> net
<span class="hljs-comment"># False</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このモジュールに</font></font><code>ipaddress</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ここでは触れない他の多くの興味深い機能があります。</font><font style="vertical-align: inherit;">詳しくは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちらをご覧ください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">確かに、このモジュールを使用して、ネットワークプログラミングに関連する他のモジュールとの共同作業に関する制限を考慮してください。</font><font style="vertical-align: inherit;">たとえば、インスタンス</font></font><code>IPv4Network</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をアドレス文字列として</font><font style="vertical-align: inherit;">使用することはできません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このための同様のオブジェクトは、最初にを使用して文字列に変換する必要があります</font></font><code>str</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドラインでのプログラムのデバッグ</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IDEを使いたくない人で、VimやEmacsでコードを書く場合、IDEのようなデバッガーが必要になる可能性があります。</font><font style="vertical-align: inherit;">そして、あなたは何を知っていますか？</font><font style="vertical-align: inherit;">あなたはすでにそのようなデバッガーを持っています。</font><font style="vertical-align: inherit;">使用するには、ビューデザインを使用してプログラムを実行します</font></font><code>python3.8 -i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このフラグ</font></font><code>-i</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">により、プログラムの完了時にインタラクティブシェルを起動できます。</font><font style="vertical-align: inherit;">これを使用すると、変数を調べて関数を呼び出すことができます。</font><font style="vertical-align: inherit;">これは興味深い機能ですが、実際のデバッガ（pdb）はどうですか？</font><font style="vertical-align: inherit;">次の簡単なプログラムを試してみましょう。コードはファイル内にあります</font></font><code>script.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span> / <span class="hljs-number">0</span><font></font>
<font></font>
func()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンド</font></font><code>python3.8 -i script.py</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して実行し</font><font style="vertical-align: inherit;">、以下を取得します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#   ...</span><font></font>
<font></font>
Traceback (most recent call last):<font></font>
&nbsp;&nbsp;File <span class="hljs-string">"script.py"</span>, line <span class="hljs-number">4</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;func()<font></font>
&nbsp;&nbsp;File <span class="hljs-string">"script.py"</span>, line <span class="hljs-number">2</span>, <span class="hljs-keyword">in</span> func
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span> / <span class="hljs-number">0</span><font></font>
ZeroDivisionError: division by zero<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> pdb
<span class="hljs-meta">&gt;&gt;&gt; </span>pdb.pm()&nbsp; <span class="hljs-comment">#     </span>
&gt; script.py(<span class="hljs-number">2</span>)func()<font></font>
-&gt; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> / <span class="hljs-number">0</span>
(Pdb)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラッシュが発生したプログラムの場所がわかります。</font><font style="vertical-align: inherit;">ブレークポイントを設定します。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func</span>():</span>
&nbsp;&nbsp;&nbsp;&nbsp;breakpoint()&nbsp; <span class="hljs-comment"># import pdb; pdb.set_trace()</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span> / <span class="hljs-number">0</span><font></font>
<font></font>
func()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトを再度実行します。</font><font style="vertical-align: inherit;">
ほとんどの状況では、スクリプトをデバッグするには、コマンド</font><font style="vertical-align: inherit;">とトレースの結果で</font><font style="vertical-align: inherit;">十分</font><font style="vertical-align: inherit;">ですが、複雑な障害に対処するために、プログラムを詳しく調べて、何が起こっているのかを理解する必要があります。</font><font style="vertical-align: inherit;">このような場合、ブレークポイントがコードに設定され、プログラムが検査されます。</font><font style="vertical-align: inherit;">たとえば、関数の引数を調べたり、式を評価したり、変数の値を確認したり、上記のように、ステップバイステップのコードを実行したりします。</font><font style="vertical-align: inherit;">Pdbは完全に機能するPythonシェルです。</font><font style="vertical-align: inherit;">このシェルでは、ほとんど何でもできます。</font><font style="vertical-align: inherit;">作業の過程で、いくつかの特定のデバッガーコマンドが役立ち</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">そのヘルプは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ここにあります</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<code>script.py(3)func()<br>
-&gt; return 0 / 0<br>
(Pdb)&nbsp; #  <br>
(Pdb) step<br>
ZeroDivisionError: division by zero<br>
&gt; script.py(3)func()<br>
-&gt; return 0 / 0<br>
(Pdb)</code><br><font style="vertical-align: inherit;"></font><code>print</code><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスで複数のコンストラクターを宣言する</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数のオーバーロードは、さまざまなプログラミング言語で広く使用されている機能の1つですが、Pythonでは使用できません。また、Pythonでは通常の関数をオーバーロードすることはできませんが、クラスメソッドを使用してコンストラクターをオーバーロードするようなものを使用できます。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> datetime<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Date</span>:</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, year, month, day</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.year = year<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.month = month<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.day = day<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;@classmethod<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">today</span>(<span class="hljs-params">cls</span>):</span><font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t = datetime.datetime.now()<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> cls(t.year, t.month, t.day)<font></font>
<font></font>
d = Date.today()<font></font>
print(<span class="hljs-string">f"<span class="hljs-subst">{d.day}</span>/<span class="hljs-subst">{d.month}</span>/<span class="hljs-subst">{d.year}</span>"</span>)
<span class="hljs-comment"># 14/9/2019</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
代わりにクラスメソッドを使用してのこのような状況で、あなたは代替コンストラクタのすべてのロジックを置くように誘惑される</font></font><code>__init__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と使用して問題を解決し</font></font><code>*args</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>**kwargs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして表現がたくさん</font></font><code>if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">結果は正常に機能するコードになる可能性がありますが、このコードは読み取りや保守が困難になります。</font><font style="vertical-align: inherit;">ここでは、最小限のロジックを配置し、</font></font><code>__init__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての操作を個別のメソッド/コンストラクターで実行</font><font style="vertical-align: inherit;">することをお勧めし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">このアプローチにより、このコードの作成者とこのコードを使用する人の両方にとって便利なクリーンなコードが自由に使えるようになります。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デコレータを使用した関数呼び出し結果のキャッシュ</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
長い読み取り/書き込み操作を実行する関数を記述したことはありますか、それとも再帰的な計算が遅くなったことがありますか？同時に、結果をキャッシュしてもそのような機能を損なうことはないと思いましたか？</font></font><code>lru_cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールの</font><font style="vertical-align: inherit;">デコレータを使用して、関数呼び出しの結果をキャッシュ（メモ）でき</font><font style="vertical-align: inherit;">ます</font></font><code>functools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache
<span class="hljs-keyword">import</span> requests<font></font>
<font></font>
<span class="hljs-meta">@lru_cache(maxsize=32)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_with_cache</span>(<span class="hljs-params">url</span>):</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">try</span>:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = requests.get(url)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> r.text
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">except</span>:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-string">"Not Found"</span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> [<span class="hljs-string">"https://google.com/"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"https://martinheinz.dev/"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"https://reddit.com/"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"https://google.com/"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"https://dev.to/martinheinz"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"https://google.com/"</span>]:<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;get_with_cache(url)<font></font>
<font></font>
print(get_with_cache.cache_info())<font></font>
<span class="hljs-comment"># CacheInfo(hits=2, misses=4, maxsize=32, currsize=4)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例では、結果がキャッシュされるGETリクエストを実行します（最大32件の結果をキャッシュできます）。</font><font style="vertical-align: inherit;">ここで、メソッドを使用して関数キャッシュに関する情報を取得していることがわかります</font></font><code>cache_info</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">さらに、デコレータは</font></font><code>clear_cache</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、キャッシュを無効にするために使用される</font><font style="vertical-align: inherit;">メソッドを提供し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">ここで、副作用のある関数や、呼び出しのたびに変更可能なオブジェクトを作成する関数ではキャッシュを使用できないことにも注意してください。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反復可能なオブジェクトで最も頻繁に見つかるアイテムを見つける</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他の要素よりも頻繁に見つかるそのような要素のリストを見つけることは、非常に一般的な作業です。</font><font style="vertical-align: inherit;">これは、たとえば、</font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同一の要素の数に関する情報を収集</font><font style="vertical-align: inherit;">するサイクル</font><font style="vertical-align: inherit;">と辞書</font><font style="vertical-align: inherit;">を使用して解決できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">しかし、そのようなアプローチは時間の無駄です。</font><font style="vertical-align: inherit;">実際には</font></font><code>Counter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、モジュールの</font><font style="vertical-align: inherit;">クラスを使用して、このような問題を解決でき</font><font style="vertical-align: inherit;">ます</font></font><code>collections</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter<font></font>
<font></font>
cheese = [<span class="hljs-string">"gouda"</span>, <span class="hljs-string">"brie"</span>, <span class="hljs-string">"feta"</span>, <span class="hljs-string">"cream cheese"</span>, <span class="hljs-string">"feta"</span>, <span class="hljs-string">"cheddar"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"parmesan"</span>, <span class="hljs-string">"parmesan"</span>, <span class="hljs-string">"cheddar"</span>, <span class="hljs-string">"mozzarella"</span>, <span class="hljs-string">"cheddar"</span>, <span class="hljs-string">"gouda"</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">"parmesan"</span>, <span class="hljs-string">"camembert"</span>, <span class="hljs-string">"emmental"</span>, <span class="hljs-string">"camembert"</span>, <span class="hljs-string">"parmesan"</span>]<font></font>
<font></font>
cheese_count = Counter(cheese)<font></font>
print(cheese_count.most_common(<span class="hljs-number">3</span>))
<span class="hljs-comment"># : [('parmesan', 4), ('cheddar', 3), ('gouda', 2)]</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラスの内部メカニズムは、</font></font><code>Counter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素の対応とリスト内のエントリ数を格納する辞書に基づいています。</font><font style="vertical-align: inherit;">したがって、対応するオブジェクトは通常のオブジェクトとして使用できます</font></font><code>dict</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="python hljs">print(cheese_count[<span class="hljs-string">"mozzarella"</span>])
<span class="hljs-comment"># : 1</span><font></font>
<font></font>
cheese_count[<span class="hljs-string">"mozzarella"</span>] += <span class="hljs-number">1</span><font></font>
<font></font>
print(cheese_count[<span class="hljs-string">"mozzarella"</span>])
<span class="hljs-comment"># : 2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに</font></font><code>Counter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、を</font></font><code>update(more_words)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用する場合、カウンターに新しい要素を追加する</font><font style="vertical-align: inherit;">ためのメソッドを自由に</font><font style="vertical-align: inherit;">使用できます。</font><font style="vertical-align: inherit;">もう1つの便利な機能</font></font><code>Counter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、このクラスのインスタンスを操作するときに数学演算（加算および減算）を使用できることです。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今日のヒントのほとんどは、ほぼ毎日、Pythonで書く人にも十分に利用できると思います。</font><font style="vertical-align: inherit;">それらの中からあなたに役立つものを見つけていただければ幸いです。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">興味深いPythonプログラミングトリックを知っていますか？</font><font style="vertical-align: inherit;">もしそうなら、それらを共有してください。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja485636/index.html">CRISPR耐性ウイルスは、DNA侵入酵素からゲノムを保護するためのシェルターを構築します</a></li>
<li><a href="../ja485638/index.html">見ることを学ぶ</a></li>
<li><a href="../ja485640/index.html">Webページを隠す方法</a></li>
<li><a href="../ja485642/index.html">Angularアプリケーションの動作が遅い主な理由</a></li>
<li><a href="../ja485644/index.html">WebGPUアプリケーション開発</a></li>
<li><a href="../ja485648/index.html">forへのpythonicアプローチ：range（）とenumerate（）ループ</a></li>
<li><a href="../ja485650/index.html">Dockerイメージ削減テクニック</a></li>
<li><a href="../ja485652/index.html">Confluenceインラインコメント統計</a></li>
<li><a href="../ja485654/index.html">物理学からのアイデアは、AIがより高い次元で機能するのに役立ちます。</a></li>
<li><a href="../ja485656/index.html">機械のスカイネット：工場には労働者なしで未来はありませんか？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>