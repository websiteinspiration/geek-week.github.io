<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฌ๏ธ ๐ง๐ฝ ๐ฉ๐ปโ๐ง ุฌููุน ูุฑุงุญู ุฅูุดุงุก ุฑูุจูุช ููุชุงุจุนุฉ ุงูุฎุท ุ ุฃู ููููุฉ ุฌูุน ุฌููุน ุงูููุงุจุณ ูุน STM32 ๐จ๐ปโ๐พ ๐พ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุงุจุฑ! 
 
 ููุงูุด ูุฐุง ุงูููุดูุฑ ุชุฌุฑุจุชู ูู ุฅูุดุงุก ุฑูุจูุช ูููุณุงุจูุงุช ุ ุฃู ุงุชุจุงุน ุงูุฎุท. ุณุฃุญุงูู ุฃู ุฃุฎุจุฑ ูู ุงููุฑุงุญู ูู ุชุตููู ุงูุฏูุงุฆุฑ ูุทูุจ ููุญุฉ ุฏูุงุฆุฑ ูุทุจูุน...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ุฌููุน ูุฑุงุญู ุฅูุดุงุก ุฑูุจูุช ููุชุงุจุนุฉ ุงูุฎุท ุ ุฃู ููููุฉ ุฌูุน ุฌููุน ุงูููุงุจุณ ูุน STM32</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/497782/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุญุจุง ูุง ูุงุจุฑ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงูุด ูุฐุง ุงูููุดูุฑ ุชุฌุฑุจุชู ูู ุฅูุดุงุก ุฑูุจูุช ูููุณุงุจูุงุช ุ ุฃู ุงุชุจุงุน ุงูุฎุท. </font><font style="vertical-align: inherit;">ุณุฃุญุงูู ุฃู ุฃุฎุจุฑ ูู ุงููุฑุงุญู ูู ุชุตููู ุงูุฏูุงุฆุฑ ูุทูุจ ููุญุฉ ุฏูุงุฆุฑ ูุทุจูุนุฉ ุฅูู ุฎูุงุฑุฒููุฉ ูุจุฑูุงูุฌ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุทุงููุง ูุงู ุณุจุงู ุงูุฑูุจูุชุงุช ุนูู ุทูู ุงูุฎุท ุงุฎุชุจุงุฑูุง ุฃุณุงุณููุง ููุฑูุจูุชุงุช ุงููุจุชุฏุฆุฉ. </font><font style="vertical-align: inherit;">ุชุดูู ุฌููุน ุงููุณุงุจูุงุช ุงูุฅูููููุฉ ูุงูุฏูููุฉ ุชูุฑูุจูุง ูุฐุง ุงูุงุชุฌุงู ุ ูุฐุง ููููู ุตูุน ุฑูุจูุช ูุงุญุฏ ููููู ุงููุดุงุฑูุฉ ูู ูู ููุงู ุชูุฑูุจูุง. </font><font style="vertical-align: inherit;">ูู ุงูุณูุฉ ุงูุฃููู ูู ุงูุฌุงูุนุฉ ุ ูุงูุช ูุฐู ูู ุงููููุฉ ุงูุชุงููุฉ ุจุนุฏ ูููุถ LED ุงูุฃูู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุตูุงุบุฉ ุงููุดููุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏุฃ ุฃู ุชุทูุฑ ุจูููุฉ ุชูููุฉ ุ ูู ุญุงูุชูุง ุ ูุชู ุงุณุชุฎุฏุงู ููุงุฆุญ ุงูููุงูุณุฉ ูู ูุณุงุจูุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Robofinist ููุนุงุฑู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูููุฏูุฉ </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุญู ููุชููู ุจูุชุทูุจุงุช ุงูุฃุจุนุงุฏ (ูุง ูุฒูุฏ ุนู 25x25x25 ุณู) ููุฒู ุงูุฑูุจูุช (ูุง ูุฒูุฏ ุนู 1 ูุฌู) ุ ุจุงูุฅุถุงูุฉ ุฅูู ุดูู ุงููุณุงุฑ ูุนุฑุถู 1.5 ุณู. ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููููุฉ ูุงุถุญุฉ ุ ูุญุชุงุฌ ุฅูู ุฑูุจูุช ูุงุฏุฑ ุนูู ุงูุชุดุงู ุงูุฎุท ูุงูููุงุฏุฉ ุนูู ุทููู ูู ุงูุจุฏุงูุฉ ุฅูู ุงูููุงูุฉ ูู ุฃูู ููุช ูููู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุงูุชุตููู</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฌููุฑ ุงูุฑูุจูุช ูู ูุชุญูู STM32F103C8T6 ุ ููู ููุฑุฃ ูุนูููุงุช ุงููุณุงุฑ ุจุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุงูุจุตุฑูุฉ QRE1113 ููุชุญูู ูู ุงููุญุฑูุงุช ูู ุฎูุงู ุจุฑูุงูุฌ ุชุดุบูู A3906. ูู ุฃุฌู ุงููุถูุญ ุ ูุชู ุชุนููู ูู ุฌูุงุฒ ุงุณุชุดุนุงุฑ ุฎุงุต ุจู LED ุ ุจูุฌุฑุฏ ุฃู "ูุฑู" ุงููุณุชุดุนุฑ ุงูุฎุท ุงูุฃุณูุฏ ุ ูุถูุก LED ุ ููุฐุง ูุจุณุท ุฅูู ุญุฏ ูุจูุฑ ุนูููุฉ ุงูุชุตุญูุญ. ููุตุฏุฑ ููุทุงูุฉ ุ ุชู ุงุฎุชูุงุฑ ุจุทุงุฑูุฉ Li-po ูู ุงูููุน 18650 ุจุฌูุฏ 3.7 ูููุช ูุดุฑูุญุฉ ุดุญู LTC4054ES5. ูููู ูู ุฃุฌู ุงูุชุดุบูู ุงูุตุญูุญ ูููุญุฑูุงุช ุ ููุงู ุญุงุฌุฉ ุฅูู 6 ูููุช ุนูู ุงูุฃูู ุ ูุฐูู ุ ููุช ุจุชุซุจูุช ูุญูู ุงูุฌูุฏ DC-DC ุงูุตุงุนุฏ LM2577 ุ ู LM1117 ุงูุฎุทู ุจููุฏุงุฑ 3.3 ูููุช ูุชุดุบูู ุงูุฌุฒุก ุงูููุทูู.</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/getpro/habr/post_images/aa5/0a0/ddf/aa50a0ddf75671c4ee28137f1fbf8c47.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุงู ุงูููุช ููุญุฏูุซ ุนู ุงูุฃุฎุทุงุก ุงูุฃููู. ุจุดูู ุบูุฑ ุฏููู ุ ููุช ุจุฎูุท ุฒูุฌ ูุงุญุฏ ูู ุฏุจุงุจูุณ ุงูุทุงูุฉ ูุชุญูู ุ ูุนูุฏ ุจุฏุก ุงูุชุดุบูู ูุถูุช ุนุฏุฉ ุณุงุนุงุช ูู ุงูุจุญุซ ุนู ูุดููุฉ ุ ููุชูุฌุฉ ูุฐูู ุงุถุทุฑุฑุช ุฅูู ุนุถูุง. ุซู ูุดุฃุช ุงููุดููุฉ ุฃูู ูู ุชุชูุงุนู ุฌููุน ุงููุณุชุดุนุฑุงุช ูุน ุงูุฎุท ุ ููุงู ุฑุฏ ูุนูู ุงูุฃูู ูู ุฃููู ุฃุญุฑูุช ูุญุฏุฉ ุงูุชุญูู ุงูุฏูููุฉ ุฃู ุงูุฃุฑุฌู ุงูููุณูุฑุฉ ููุตุฏุฑ ุงูุทุงูุฉ ูู ุงููุฑุญูุฉ ุงูุฃุฎูุฑุฉ ูู ุชูู ุฒุงุฆุฏุฉ ุนูู ุงูุฅุทูุงู ุ ุฃู ุฃููู ููุช ุจุญู ุฌูุงุช ุงูุงุชุตุงู ุจุดูู ุณูุฆ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุณุชุฎุฏุงู ุฑุงุณู ุงูุฐุจุฐุจุงุช ุ ูุฌุฏุช ุฃู ุงููุดููุฉ ูุงูุช ูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ููุณูุง ุ ูู ุฃุตู 10 ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ 4 ูู ุชุนูู ุ ูุงุณุชุจุฏุงููุง ุจุฃุฌูุฒุฉ ุฌุฏูุฏุฉ ุธูุฑุช ุงููุดููุฉ ุงูุชุงููุฉ - ูู ุชุนูู ุซูุงุซุฉ ูุคุดุฑุงุช LED PB3 ู PB4 ู PA15. ุจุนุฏ ุฅุนุงุฏุฉ ุงููุชุงุจุฉ ูุงูุจุญุซ ูู ุฌููุน ุงูููุฏ ุงูุฎุงุต ุจู ุ ูู ุฃุฌุฏ ุงุฎุชูุงูุงุช ูู ุชููุฆุฉ ุงูููุงูุฐ ุบูุฑ ุงูุนุงููุฉ ูุงูุนูู ูู ูู ููุงู ุชู ุชูููู Push Pull ู 10 MHz ูุชู ุชูููู ุงูุณุงุนุฉ. ุจุนุฏ ุฃู ูุธุฑุช ุฅูู ุงูุชุฐุจุฐุจ ุ ูุงุญุธุช ุฃู ุฏุจูุณูุง ูุงุญุฏูุง ููุฌุฐุจ ุฅูู ุฒุงุฆุฏ ูุญุชู ูู ูุถุน ุงูุชุตุญูุญ ูู ุชุชู ุฅุนุงุฏุฉ ุถุจุทู ุ ุฃุฏุฑูุช ุฃู ุงููููุฑููููุชุฑููุฑ ุชู ุญุฑูู. ุนูุฏ ุฅุบูุงู ูุฑูุฉ ุงูุจูุงูุงุช ุ ูุงุญุธุช ุฃูู ุนู ุทุฑูู ุงูุตุฏูุฉ ุงูุบุฑูุจุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงูุฏุจุงุจูุณ ูู JTAG ุ ูุฃูุง ุฃุณุชุฎุฏู SWD ุ ูููู ุจุนุฏ ุฃู ูุฑุฑุช ุฃููุง ูู ุชุณูุก ุ ุจุฏุฃุช ูู googog ููููุฉ ุชุนุทูู JTAG ูุณุงุนุฏุช ุญููุง (ุงูุธุฑ ุฃุฏูุงู).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงุณุชูุชุงุฌ ุตุบูุฑ ุ ุชุญูู ูู ุงูุชุบุฐูุฉ ุงูุตุญูุญุฉ ูู ุฌููุน ุงููุฑุงุญู ุญุชู ูุง ุชุนุชูุฏ ุฃู ุดูุฆูุง ูุง ุชู ุญุฑูู ูุงุญููุง ุฃู ุฃูู ูุง ูุนูู ูุฃุณุจุงุจ ุฃุฎุฑู.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุญุชุงุฌ ุฅูู ุชุญุณูู ูู ุงููุฎุทุท</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฎููุช ุฃู ุฃุถุน ุฑูุงูุฉ ุงูุดุญู ุ ููููู ูุณูุช ุงูุชูุฑูุบ ุ ุนูู ุงูุฑุบู ูู ุฃูู ููุณ ุฃูู ุฃูููุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฃูู ูู ุนุงู 2020 ุฃุถุน USB ุตุบูุฑูุง ุจุฏูุงู ูู ุงูููุน C. ุฃูุฏ ุงุณุชุฎุฏุงู ูุชุญูู ููุฑุงูุจุฉ ุดุญู ุงูุจุทุงุฑูุฉ ุ ูููู ูู ููู ูุฏูู ุฃู ุฏุจุงุจูุณ ADC ูุชุจููุฉ. </font><font style="vertical-align: inherit;">ุนูุฏ ุงุฎุชูุงุฑ ุณุงุฆู ุ ุงุนุชูุฏุช ุนูู ุฎุตุงุฆุต ุงููุญุฑู 6 ูููุช ู 700 ูููู ุฃูุจูุฑ ุ ูููู ูู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฃู ุฃูุตู ุฌูุฏ ูู ูู 9 ูููุช ุ ูููู ุฃูุฏ 12 ูููุช.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุตููู ุซูุงุฆู ุงูููููู ูุชุนุฏุฏ ุงููููุฑ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชูุฑุฑ ุชุญุฏูุฏ ุญุฌู ูุดูู PP ูุงูููุตุฉ ุจุฏูุงู ุฌุฒุฆู ููุฑูุจูุช. ูุฐูุฑ ุฃูู ููููุง ูููุงุฆุญ ุ ูุฌุจ ุฃูุง ุชุชุฌุงูุฒ ุงูุฃุจุนุงุฏ 25x25 ุณู ุ ูููู ูู ุงูุฌุฏูุฑ ุฃูุถูุง ุงูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุฃูู ุนูุฏ ุทูุจ ุจุฑูุงูุฌ ูู ูุตูุน (PCBWay) ูู ุงูุตูู ุ ุชุฒูุฏ ุงูุฃููุงุญ ุงูุชู ุชุฒูุฏ ุนู 10x10 ุณู ุจุดูู ูุจูุฑ ูู ุงูุณุนุฑ. ุฃุนุชูุฏ ุฃู ุงุฎุชูุงุฑ ุงูุฃุจุนุงุฏ ูุงุถุญ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ุฐูู ุ ูุฌุจ ุนููู ุชูุฒูุน ุงููุณุชุดุนุฑุงุช ุจุดูู ูุชูุงุธุฑ (ูู ุฃุณูู ุงูููุญุฉ) ุ ูุน ูุฑุงุนุงุฉ ุนุฑุถ ุงูุฎุท ุ ุซู ุฃุซูู ุงูุนูุงุตุฑ ุ ูุซู ุงููุญุฑูุงุช ูุงูุจุทุงุฑูุฉ. ูุชู ุชุฑููุจ ูุตุงุจูุญ LED ุนูู ููุณ ุงููุญูุฑ ูุซู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุงูููุงุจูุฉ ุ ุนูู ุงูุฌุงูุจ ุงูุขุฎุฑ ูู ุงูููุญุฉ. ูู ุฃุฌู ุงูุฑุงุญุฉ ุ ูููู ุจุชุซุจูุช ููุชุงุญ ุงูุทุงูุฉ ูููุตู ุดุญู ุงูุจุทุงุฑูุฉ ูู ุงูุฌุฒุก ุงูุฎููู ูู ุงููุธุงู ุงูุฃุณุงุณู. ูุชู ุชุนููู ุงูุนูุงุตุฑ ุงููุชุจููุฉ ุฃูุฑุจ ุฅูู ุงููุฑูุฒ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุจุนุฏ ูุทุน ุงูุญูุงู ุงููุงุฑุบุฉ ูููุญุฉ ุจุฏูุงู ูู ูุฑุจุน ุ ูุชู ุงูุญุตูู ุนูู ุตูุฑุฉ ูุงุฆูุฉ ุชูุงููุง ูููุตุฉ ุงูุฑูุจูุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุงูุช ุงูููุญุฉ ุจุณูุทุฉ ููุบุงูุฉ ูุธุฑูุง ูููุฉ ุนุฏุฏ ุงูุนูุงุตุฑ ุงููุฑูุฏุฉ. </font><font style="vertical-align: inherit;">ูุฌููุน 2 ุทุจูุงุช ุณูู ุงููุณุงุฑ ุงูุฃุฏูู 0.25 ูู. </font><font style="vertical-align: inherit;">ุจุนุฏ ุญูุธ ุงูููุญุฉ ุงูุฃู ุจุชูุณูู Gerber ุ ุฃุฑุณูุชูุง ุฅูู ุงููุตูุน ุนู ุทุฑูู ุชุญุฏูุฏ ุงูููู ุงูุฃุจูุถ ููููุงุน ุ ุซู ูู ููู ูุฏู ุฃู ูุดุงูู ุฎุงุตุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/57e/f74/2c8/57ef742c8e35e324720908b0758200cc.jpg" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนุฑุถ ุซูุงุซู ุงูุฃุจุนุงุฏ ูููุญุฉ ูุน ุงูุนูุงุตุฑ. </font><font style="vertical-align: inherit;">ุณุชููู ุงูุตูุฑุฉ ุงูุญูุฉ ูู ุงูููุงูุฉ.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/37f/a8b/65d/37fa8b65d80595744c2e2436490b304e.jpg" alt="ุตูุฑุฉ"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูุฌุจ ูุถุน ุงูููุณุงุช ุงูุฃุฎูุฑุฉ ุนููู ูู ุงููุฌูุณ</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ููุช ุจุชุซุจูุช ุจุนุถ ุงูุนูุงุตุฑ ุจุงููุฑุจ ูู ุงูุบูุงู ุงูุจูุงุณุชููู ููุจุทุงุฑูุฉ ููุงู ูู ุงูุตุนุจ ูุญุงููุง ุ ุจู ูุฃูุซุฑ ุตุนูุจุฉ ูู ุงููุญุงู. </font><font style="vertical-align: inherit;">ููุฏ ูุณูุช ุงูุชูููุน ุนูู ุฏุจูุณ ููุตู ุงูุจุฑูุฌุฉ SWD ู UART ูุงููุญุฑูุงุช ูุชูุฌุฉ ูุฐูู ุ ูุง ุจุฏ ูู ูู ุงููุธุฑ ูู ุงูุฏุงุฆุฑุฉ.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฑุงุก ุงูููููุงุช</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุทูุจ ุชุทููุฑ ูู ุดูุก ุฌุฏูุฏ ุฃุนูู ุงูุชูุงููู ุงููุณุจูุฉ ููู ูุญุฏุฉ ูู ุงูุณูุน ุ ููููู ููุฌุจ ุฃู ุชุญุงูู ุงูุชูููุฑ ุ ูููู ุถูู ุญุฏูุฏ ูุนูููุฉ ุ ูุฐุง ูุฅู ุทูุจ ูุณุชุดุนุฑุงุช ุงูุฎุท ูู Aliexpress 4.5 ูุฑุงุช ุฃุฑุฎุต ูู ูุชุฌุฑ ุฅููุชุฑูููุงุช ุ ุฏูุนุช ูุญูููุฉ ุฃู ุญูุงูู 40 ูช ูููุง ุชุจูู ุฃููุง ูุง ูุนูู ุ ููุฐุง ูู ุงูููุช ุงูููุงุณุจ ููุนุซูุฑ ุนูู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง. </font><font style="vertical-align: inherit;">ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูู ุฃูู ุฃุฑุบุจ ูู ุดุฑุงุก ุดุฑูุญุฉ LM2577 ููุงุจู 460 ุฑูุจู ุ ุจูููุง ุชููู ุงููุญุฏุฉ ูุน ุฌููุน ุงูุฃุดุฑุทุฉ 100 ุฑูุจู. </font><font style="vertical-align: inherit;">ุทูุจุช ุฌุฒุกูุง ูู ุงูุฃุฌุฒุงุก ุฅูู ุนูู ุ ูุฌุฒุกูุง ุขุฎุฑ ูู ูุชุฌุฑ ูุญูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅููู ุชูุงููู ุงูููููุงุช ุงูููุฏุฑุฉ:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุญุฑูุงุช ูุงูุนุฌูุงุช - 800 ุฑูุจู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจุทุงุฑูุฉ ูุงูุญุงูุฉ - 400 ุฑูุจู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุงุญู - 300 ุฑูุจู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญูู ูุณุงุฆู - 200 ุฑูุจู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุซุจุชุงุช - 400 ุฑูุจู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุณูู 10 ูุญุฏุงุช ูุน ุงูุชุณููู 2400/10 = 240 ุฑูุจู ููู ูุญุฏุฉ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจููุฉ ุงูุญุฒุงู - 150 ุฑูุจู.</font></font></li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุฌูุงูู:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4650 ุฑูุจู ุฅุฌูุงูู ุงูุชูุงููู ููููููุงุช ุ ุฃู 2490 ุฅุฐุง ููุช ุจุทุฑุญ ุณุนุฑ ุงูุฃููุงุญ ุงูุชุณุนุฉ ุงููุชุจููุฉ ุบูุฑ ุงููุณุชุฎุฏูุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: ููุฏ ุจุฏุฃุช ูู ุญุณุงุจ ุชูููุฉ ุงูุฃููุงุญ ูุชุฑููุจ ุงูููููุงุช ูููู ุฏูุนุฉ ูู 10 ูุญุฏุงุช. </font><font style="vertical-align: inherit;">ุงุฑุชูุน ุงูุณุนุฑ ุฅูู 16000 ุฑูุจู. </font><font style="vertical-align: inherit;">ููุงู ุฃููุงุฑ ุญูู ููููุฉ ุงูุชุญุณูู ูููู ูุฐู ุงููุฑุฉ ุฃุฎุฑู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฐุช ุงูุฎูุงุฑุฒููุฉ ุฃุจุณุท ุ ุฅุฐุง ุชุจูู ุฃู ุงูุฎุท ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ุงูุฌุงูุจ ุงูุฃููู ุ ูุฅู ุงููุญุฑู ุงูุฃููู ุณูุจุฏุฃ ูู ุงูุฅุจุทุงุก ููููุง ุงูุชุฑุจ ุงูุฎุท ูู ุงูุญุงูุฉ ุ ูููุง ูุงู ุงููุญุฑู ุฃุจุทุฃ ุ ุญุชู ูุชููู ุชูุงููุง ุ ุจูููุง ูุนูู ุงููุญุฑู ุงูุฃูุณุฑ ุจุฃูุตู ุณุฑุนุฉ ุชุญุงูู ุงูุงูุนุทุงู ูุญู ุงูุฎุท. </font><font style="vertical-align: inherit;">ูููู ููุงุซู ุฅุฐุง ูุงู ุงูุฎุท ุนูู ุงูุฌุงูุจ ุงูุฃูุณุฑ. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูุญุงูู ุงูุฑูุจูุช ุงูุงุณุชูุฑุงุฑ ุ ูุฅุนุงุฏุฉ ุงูุฎุท ุฅูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุงููุฑูุฒูุฉ.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/22b/07d/9ab/22b07d9ab0c0795c33cda8c42236e18f.jpg" alt="ุตูุฑุฉ"><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎูุงุฑุฒููุฉ ูู ุงูุตูุฑ</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ae3/234/6c5/ae32346c5611292cf0b7fc155317da5a.jpg" alt="image"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/b47/403/545/b47403545480435eed6c7b362dbad0bd.jpg" alt="image"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/5d8/55b/68c/5d855b68c11937aa1196d6d281c5c939.jpg" alt="image"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/42c/481/545/42c4815453ca35de5c6dc32570e09506.jpg" alt="image"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/587/7ee/4db/5877ee4db1610d2aab5ace1af4cd27b3.jpg" alt="image"><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุงูุถุฑูุฑู ุฃูุถูุง ุชููุน ุงูููุงูู ุงูุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุงูุชุดูุช ุฌููุน ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุฎุทูุง ุ ููุฐุง ูุนูู ุนูู ุงูุฃุฑุฌุญ ุฃููุง ูุนุจุฑ ุงูุชูุงุทุน ูุนูู ุงูุฃุฑุฌุญ ุฃููุง ุจุญุงุฌุฉ ุฅูู ุงููุถู ูุฏููุง. </font><font style="vertical-align: inherit;">ุฃู ุฅุฐุง ุงูุชุดูุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุงููุชุทุฑูุฉ ููุท ุงูุฎุท ุ ููุฏ ูุตููุง ุฅูู ุฎุท ุงูููุงูุฉ ูุนูููุง ุงูุชููู.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฑูุฌุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงููุฑุญูุฉ ุ ุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุงูุฏู ูุงูุถุฑุจ ููู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุชุจ ูู Atollic True Studio ูุณุชุฎุฏู ููุท CMSIS ู FreeRTOS. ูุถูุช ูุตู ุฃุณุจูุน ูุฅุทูุงู FreeRTOS ุ ูุนูุช ูู ุดูุก ููููุง ููุชุนูููุงุช ุ ูููู ุชู ุงูุชุดุงู ุฃุฎุทุงุก ุฃุซูุงุก ุนูููุฉ ุงูุชุฌููุน ุ ุธูุฑ ุซุงุจุช 1 ุ 63 ุ ุฃู ูู ุชูู ููุงู ุฃุฎุทุงุก ุ ูููู ุชุนุทูุช ูุญุฏุฉ ุงูุชุญูู. ูู ูุฑุญูุฉ ูุง ุ ุฃุฏุฑูุช ุฃู ูุณุชูู ูุฏู ... ูุตู ุฅูู ุงุฑุชูุงุนุงุช ุบูุฑ ูุณุจููุฉ ูุญุงู ุงูููุช ููุชูููุฑ ูู ูุง ููุช ุฃูุนูู ููุง ููุช ุฃูุนูู. ุจูุถู ุฑูุงู ูู ุงููุฌุชูุน ุ ุจุฏุฃุช ูู ุงูุญูุฑ ูู ุงูุงุชุฌุงู ุงูุตุญูุญ ููู ุงููุซูุฑ ูู ุงููุตุงุฏุฑ ุงููุนุงุฏ ุฑุณููุง ูุฌุฏุช ุงูุนุฏูุฏ ูู ุงููุตุงุฏุฑ ุงูุชู ุณุงุนุฏุชูู (ุงูุธุฑ ุฃุฏูุงู). ููุชูุฌุฉ ูุฐูู ุ ุชูููุช ูู ูุฒููุฉ FreeRTOS ูุญุชู ุงูุขู ุงุณุชุฎุฏูุชู ุจูุณุจุฉ 0 ูช ุ ูุฃููู ูุถุนุช ูู ุดูุก ูู ูููุฉ ูุงุญุฏุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุฏุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฐู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุฏุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณุงุนุฏุชูู ุนูู ุงูุฃูุซุฑ </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุงู ุงูุชูููุช ุ ูุง ุฒูุช ุบูุฑ ูุชุฃูุฏ ููุง ุฅุฐุง ูุงู ูุนูู ููุง ููุจุบู. ุจุนุฏ ุถุจุท ุชุฑุฏุฏ ุงููุธุงู ูู ุฎูุงู PLL ุฅูู 48 ููุฌุงูุฑุชุฒ ุ ุฑุฃูุช 24 ููุฌุงูุฑุชุฒ (/ 2) ุนูู ุณูุญ MCO ุ ูุง ุ ุฑุฃูุช ุฅุดุงุฑุฉ 22-25 ููุฌุงูุฑุชุฒ ุชุดุจู ุนู ุจุนุฏ ุฌูุจูุง. ูู ุงูููุช ููุณู ุ ููุช ุจุชุนููู 48 ููุฌุงูุฑุชุฒ ูู ุชูููู FreeRTOS ูููุช ุจุชุนููู ุงูุชุฃุฎูุฑ ุฅูู 500 ูููู ุซุงููุฉ ูุชุดุบููู ุ ูุฑุฃูุช ุฃู 500 ูููู ุซุงููุฉ ุชุญููุช ุฅูู 300 ุ ูุฎุถุนุช ูุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงูููููุฉ ุ ููุงุญุธุช ุฃููู ุฃุญุตู ุนูู ุงููุฏู 500 ูููู ุซุงููุฉ ููุท ุนูุฏ ุชุณุฌูู ุงูุณุงุนุฉ ูู ุงููููุฏ ุงูุฏุงุฎูู ุฅูู 8 ููุฌุงูุฑุชุฒ ุ ููููุฉ ุงูุชุฑุฏุฏ ูู ูุคุซุฑ ุชูููู FreeRTOS ุนูู ุงูุฅุทูุงู ุ ูู ุจุชุนููู ูู ูู 1 ูุฑุชุฒ ู 48 ุฌูุฌุงูุฑุชุฒ. ูุฑุฑุช ุฅุนุงุฏุฉ 48 ููุฌุงูุฑุชุฒ ูุงูุนูู ูุน 300 ูููู ุซุงููุฉ ุ ูุจุนุฏ ุฐูู ููุช ุจุฅุนุงุฏุฉ ุชุดุบูู True Studio ุนู ุทุฑูู ุงูุฎุทุฃ ูุนููุช ุจุดูู ุฑุงุฆุน ููุง ุงุนุชูุฏุช ุ ูููุฐ ุงูุจุฏุงูุฉ ุฃุดุฑุช ุจุงููุนู ุฅูู ุฌููุน ูุณุงุฑุงุช ุงููููุงุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชู ุงูุนุซูุฑ ุนูู ูุดููุฉ JTAG ููุตุงุจูุญ LED ุ ุงูููุถุญุฉ ุฃุนูุงู ุ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญุชุงุฌ ููุท ุฅูู ุชุนุทููู ุ ูุจุงูุชุงูู ุชุญุฑูุฑ ุงููุตูู ุฅูู ุงููุณุงููุฑ PB3 ู PB4 ู PA15.</font></font><br>
<br>
<pre><code class="cpp hljs">AFIO-&gt;MAPR |= AFIO_MAPR_SWJ_CFG_JTAGDISABLE;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงููุดุฑูุน ุชูุฑูุจุง ููุง ููู:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุซูุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ</font></font></b>
                        <div class="spoiler_text">1.   ;<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RCC_Init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{						<span class="hljs-comment">// Quartz 16 MHz</span><font></font>
<font></font>
	RCC-&gt;CFGR |= RCC_CFGR_PLLXTPRE;	<span class="hljs-comment">// PLLXTPRE set divider (/2) = 8 MHz</span><font></font>
<font></font>
	RCC-&gt;CR |= RCC_CR_HSEON;			<span class="hljs-comment">// On HSE</span>
	<span class="hljs-keyword">while</span> (!(RCC-&gt;CR &amp; RCC_CR_HSERDY)) {<font></font>
	};<font></font>
<font></font>
	RCC-&gt;CFGR |= (RCC_CFGR_PLLMULL6);     <span class="hljs-comment">// Setup PLLMULL set multiplier (x6) = 48 MHz</span><font></font>
<font></font>
	RCC-&gt;CFGR |= RCC_CFGR_PLLSRC;		<span class="hljs-comment">// PLLSRC set HSE</span><font></font>
<font></font>
	RCC-&gt;CR |= RCC_CR_PLLON;			<span class="hljs-comment">// ON PLL</span>
	<span class="hljs-keyword">while</span> (!(RCC-&gt;CR &amp; RCC_CR_PLLRDY)) {<font></font>
	};<font></font>
<font></font>
	FLASH-&gt;ACR &amp;= ~FLASH_ACR_LATENCY;	<span class="hljs-comment">// Setup FLASH</span><font></font>
	FLASH-&gt;ACR |= FLASH_ACR_LATENCY_1;<font></font>
<font></font>
	RCC-&gt;CFGR |= RCC_CFGR_HPRE_DIV1; 	<span class="hljs-comment">// Set not divider (AHB) = 48 MHz</span>
	RCC-&gt;CFGR |= RCC_CFGR_PPRE1_DIV2; 	<span class="hljs-comment">// Set divider (/2) (APB1) = 24 MHz</span>
	RCC-&gt;CFGR |= RCC_CFGR_PPRE2_DIV1; 	<span class="hljs-comment">// Set not divider (APB2) = 48 MHz</span><font></font>
<font></font>
	RCC-&gt;CFGR &amp;= ~RCC_CFGR_SW; 		<span class="hljs-comment">// Setup SW, select PLL</span><font></font>
	RCC-&gt;CFGR |= RCC_CFGR_SW_PLL;<font></font>
<font></font>
<span class="hljs-comment">//	RCC-&gt;CFGR |= RCC_CFGR_MCO_SYSCLK;</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
2.  ,      ,     ,      Push Pull;<br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GPIO_Init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	RCC-&gt;APB2ENR |=	(RCC_APB2ENR_IOPAEN | RCC_APB2ENR_IOPBEN | RCC_APB2ENR_AFIOEN); <span class="hljs-comment">// Enable clock portA, portB and Alternative function</span><font></font>
<font></font>
	AFIO-&gt;MAPR |= AFIO_MAPR_SWJ_CFG_JTAGDISABLE;	<span class="hljs-comment">// Disable JTAG for pins B3,B4 and A15</span><font></font>
<font></font>
	<span class="hljs-comment">//---------------LED: (B3 to B9; A11, A12, A15); Output mode: Push Pull, max 10 MHz---------------//</span><font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF3 | GPIO_CRL_MODE3);	<span class="hljs-comment">// Setup B3 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE3_0;<font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF4 | GPIO_CRL_MODE4);	<span class="hljs-comment">// Setup B3 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE4_0;<font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF5 | GPIO_CRL_MODE5);	<span class="hljs-comment">// Setup B4 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE5_0;<font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF6 | GPIO_CRL_MODE6);	<span class="hljs-comment">// Setup B5 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE6_0;<font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF7 | GPIO_CRL_MODE7);	<span class="hljs-comment">// Setup B6 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE7_0;<font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF8 | GPIO_CRH_MODE8);	<span class="hljs-comment">// Setup B7 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRH |= GPIO_CRH_MODE8_0;<font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF9 | GPIO_CRH_MODE9);	<span class="hljs-comment">// Setup B8 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRH |= GPIO_CRH_MODE9_0;<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF11 | GPIO_CRH_MODE11);	<span class="hljs-comment">// Setup A11 pins PP, 10MHz</span><font></font>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE11_0;<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF12 | GPIO_CRH_MODE12);	<span class="hljs-comment">// Setup A12 pins PP, 10MHz</span><font></font>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE12_0;<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF15 | GPIO_CRH_MODE15);	<span class="hljs-comment">// Setup A15 pins PP, 10MHz</span><font></font>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE15_0;<font></font>
<font></font>
	<span class="hljs-comment">//--Motors: (A8 to A10; B12 to B15); Output and input (B12, B13) mode: Alternative function, PWM - Push Pull, max 10 MHz--//</span><font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF12 | GPIO_CRH_MODE12);		<span class="hljs-comment">// Setup B12 pins analog input</span><font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF13 | GPIO_CRH_MODE13);		<span class="hljs-comment">// Setup B13 pins analog input</span><font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF14   | GPIO_CRH_MODE14);	<span class="hljs-comment">// Setup B14 pins PP, 10MHz</span><font></font>
	GPIOB-&gt;CRH |=  GPIO_CRH_MODE14_0;<font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF15   | GPIO_CRH_MODE15);	<span class="hljs-comment">// Setup B15 pins PP, AF, 10MHz</span><font></font>
	GPIOB-&gt;CRH |=  (GPIO_CRH_CNF15_1 | GPIO_CRH_MODE15_0);<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF8 | GPIO_CRH_MODE8);		<span class="hljs-comment">// Setup A10 pins PP, 10MHz</span><font></font>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE8_0;<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF9    | GPIO_CRH_MODE9);		<span class="hljs-comment">// Setup A9 pins PP, AF, 10MHz</span><font></font>
	GPIOA-&gt;CRH |=  (GPIO_CRH_CNF9_1  | GPIO_CRH_MODE9_0);<font></font>
<font></font>
	GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_CNF10 | GPIO_CRH_MODE10);		<span class="hljs-comment">// Setup A10 pins PP, 10MHz</span><font></font>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE10_0;<font></font>
<font></font>
	<span class="hljs-comment">//--UART3: (B10 - TX; B11 - RX); Output mode: Alternative function, UART - Push Pull, max 10 MHz--//</span><font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF10   | GPIO_CRH_MODE10);	<span class="hljs-comment">// Setup B10 pins PP, AF, 10MHz</span><font></font>
	GPIOB-&gt;CRH |=  (GPIO_CRH_CNF10_1 | GPIO_CRH_MODE10_0);<font></font>
<font></font>
	GPIOB-&gt;CRH &amp;= ~(GPIO_CRH_CNF11   | GPIO_CRH_MODE11);	<span class="hljs-comment">// Setup B11 pins PP, AF, 10MHz</span><font></font>
	GPIOB-&gt;CRH |=  (GPIO_CRH_CNF11_1 | GPIO_CRH_MODE11_0);<font></font>
<font></font>
	<span class="hljs-comment">//--Optical sensors: (B0, B1, A0 - A7); Input mode: Analog--//</span><font></font>
<font></font>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF0 | GPIO_CRL_MODE0);	<span class="hljs-comment">// Setup B0 pins analog input</span>
	GPIOB-&gt;CRL &amp;= ~(GPIO_CRL_CNF1 | GPIO_CRL_MODE1);	<span class="hljs-comment">// Setup B1 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF0 | GPIO_CRL_MODE0);	<span class="hljs-comment">// Setup A0 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF1 | GPIO_CRL_MODE1);	<span class="hljs-comment">// Setup A1 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF2 | GPIO_CRL_MODE2);	<span class="hljs-comment">// Setup A2 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF3 | GPIO_CRL_MODE3);	<span class="hljs-comment">// Setup A3 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF4 | GPIO_CRL_MODE4);	<span class="hljs-comment">// Setup A4 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF5 | GPIO_CRL_MODE5);	<span class="hljs-comment">// Setup A5 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF6 | GPIO_CRL_MODE6);	<span class="hljs-comment">// Setup A6 pins analog input</span>
	GPIOA-&gt;CRL &amp;= ~(GPIO_CRL_CNF7 | GPIO_CRL_MODE7);	<span class="hljs-comment">// Setup A7 pins analog input</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
3.       DMA,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>;<br>
<br>
<pre><code class="cpp hljs">
<span class="hljs-keyword">extern</span> <span class="hljs-keyword">uint16_t</span> adc_buf[<span class="hljs-number">10</span>];<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ADC_Init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	 RCC-&gt;AHBENR |= RCC_AHBENR_DMA1EN;<font></font>
	 DMA1_Channel1-&gt;CPAR = (<span class="hljs-keyword">uint32_t</span>) &amp;ADC1-&gt;DR;		<span class="hljs-comment">//   </span>
	 DMA1_Channel1-&gt;CMAR = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>) adc_buf;   	<span class="hljs-comment">//    </span><font></font>
<font></font>
	 DMA1_Channel1-&gt;CNDTR = <span class="hljs-number">10</span>;			  				<span class="hljs-comment">//    </span>
	 DMA1_Channel1-&gt;CCR &amp;= ~DMA_CCR_EN;			   		<span class="hljs-comment">//   </span>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_MSIZE_0;		  		<span class="hljs-comment">//   16 bit</span>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_PSIZE_0;		 		<span class="hljs-comment">//   16 bit</span>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_MINC;			  	<span class="hljs-comment">// memory increment mode</span><font></font>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_CIRC;<font></font>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_TCIE;				<span class="hljs-comment">//    </span>
	 DMA1_Channel1-&gt;CCR |= DMA_CCR_EN;				  	<span class="hljs-comment">//  </span>
	 NVIC_SetPriority(DMA1_Channel1_IRQn, <span class="hljs-number">10</span>);<font></font>
	 NVIC_EnableIRQ(DMA1_Channel1_IRQn);<font></font>
<font></font>
	 RCC-&gt;CFGR &amp;= ~RCC_CFGR_ADCPRE;<font></font>
	 RCC-&gt;CFGR |= RCC_CFGR_ADCPRE_DIV8;<font></font>
	 RCC-&gt;APB2ENR |= RCC_APB2ENR_ADC1EN;<font></font>
<font></font>
	 ADC1-&gt;SQR3 = <span class="hljs-number">0</span>;			<span class="hljs-comment">// 1</span>
	 ADC1-&gt;SQR3 |= <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">5</span>;		<span class="hljs-comment">// 2     </span>
	 ADC1-&gt;SQR3 |= <span class="hljs-number">2</span> &lt;&lt; <span class="hljs-number">10</span>;		<span class="hljs-comment">// 3</span>
	 ADC1-&gt;SQR3 |= <span class="hljs-number">3</span> &lt;&lt; <span class="hljs-number">15</span>;		<span class="hljs-comment">// 4</span>
	 ADC1-&gt;SQR3 |= <span class="hljs-number">4</span> &lt;&lt; <span class="hljs-number">20</span>;		<span class="hljs-comment">// 5</span>
	 ADC1-&gt;SQR3 |= <span class="hljs-number">5</span> &lt;&lt; <span class="hljs-number">25</span>;		<span class="hljs-comment">// 6</span>
	 ADC1-&gt;SQR2 = <span class="hljs-number">6</span>;			<span class="hljs-comment">// 7</span>
	 ADC1-&gt;SQR2 |= <span class="hljs-number">7</span> &lt;&lt; <span class="hljs-number">5</span>;		<span class="hljs-comment">// 8</span>
	 ADC1-&gt;SQR2 |= <span class="hljs-number">8</span> &lt;&lt; <span class="hljs-number">10</span>;		<span class="hljs-comment">// 9</span>
	 ADC1-&gt;SQR2 |= <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">15</span>;		<span class="hljs-comment">// 10</span><font></font>
<font></font>
	 ADC1-&gt;CR2 = ADC_CR2_EXTSEL_0 | ADC_CR2_EXTSEL_1 | ADC_CR2_EXTSEL_2<font></font>
	 | ADC_CR2_EXTTRIG;<font></font>
	 ADC1-&gt;SMPR1 = <span class="hljs-number">0</span>;					 		<span class="hljs-comment">//   </span>
	 ADC1-&gt;SMPR2 = <span class="hljs-number">0</span>;					 		<span class="hljs-comment">//</span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">0</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 0,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">1</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 1,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">2</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 2,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">3</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 3,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">4</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 4,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">5</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 5,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">6</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 6,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">7</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 7,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">8</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 8,   6 </span>
	 ADC1-&gt;SMPR2 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">9</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 9,   6 </span>
	 ADC1-&gt;SMPR1 |= (<span class="hljs-keyword">uint32_t</span>) (<span class="hljs-number">6</span> &lt;&lt; (<span class="hljs-number">0</span> * <span class="hljs-number">3</span>)); 	<span class="hljs-comment">// 10,   6 </span><font></font>
<font></font>
	 ADC1-&gt;CR2 |= ADC_CR2_ADON;<font></font>
<font></font>
	 ADC1-&gt;CR2 |= ADC_CR2_RSTCAL;<font></font>
	 <span class="hljs-keyword">while</span> ((ADC1-&gt;CR2 &amp; ADC_CR2_RSTCAL) == ADC_CR2_RSTCAL) {<font></font>
	 }<font></font>
<font></font>
	 ADC1-&gt;CR2 |= ADC_CR2_CAL;<font></font>
<font></font>
	 <span class="hljs-keyword">while</span> ((ADC1-&gt;CR2 &amp; ADC_CR2_RSTCAL) == ADC_CR2_CAL) {<font></font>
	 }<font></font>
<font></font>
	 ADC1-&gt;SQR1 |= <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">20</span>;						<span class="hljs-comment">//  </span>
	 ADC1-&gt;CR1 |= ADC_CR1_SCAN;					<span class="hljs-comment">//  </span>
	 ADC1-&gt;CR2 |= ADC_CR2_DMA;				  	<span class="hljs-comment">// DMA on</span>
	 <span class="hljs-comment">// ADC1-&gt;CR2 |= ADC_CR2_CONT;</span><font></font>
<font></font>
	 <span class="hljs-comment">//  ADC1-&gt;CR2 |= ADC_CR2_SWSTART;</span><font></font>
	 ADC1-&gt;CR2 |= ADC_CR2_ADON;<font></font>
<font></font>
}<font></font>
</code></pre><br>
4.        ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"></a>;<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TIM1_Init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	<span class="hljs-comment">/*************** Enable TIM1 (CH1) ***************/</span><font></font>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_TIM1EN;<font></font>
	TIM1-&gt;CCER = <span class="hljs-number">0</span>;										<span class="hljs-comment">//  CCER ( )</span>
	TIM1-&gt;ARR = <span class="hljs-number">1000</span>; 									<span class="hljs-comment">//  ,     </span>
	TIM1-&gt;PSC = <span class="hljs-number">48</span> - <span class="hljs-number">1</span>;                					<span class="hljs-comment">// </span>
	TIM1-&gt;BDTR |= TIM_BDTR_MOE;     					<span class="hljs-comment">//     </span><font></font>
<font></font>
	TIM1-&gt;CCR2 = <span class="hljs-number">0</span>; 									<span class="hljs-comment">//       (  0  TIM1-&gt;ARR)</span>
	TIM1-&gt;CCMR1 |= TIM_CCMR1_OC2M_1 | TIM_CCMR1_OC2M_2; <span class="hljs-comment">//     </span>
	TIM1-&gt;CCER |= (TIM_CCER_CC2P |TIM_CCER_CC2E); 		<span class="hljs-comment">//        </span>
														<span class="hljs-comment">//   -   3</span>
	TIM1-&gt;CCR3 = <span class="hljs-number">0</span>; 									<span class="hljs-comment">//       (  0  TIM1-&gt;ARR)</span>
	TIM1-&gt;CCMR2 |= TIM_CCMR2_OC3M_1 | TIM_CCMR2_OC3M_2; <span class="hljs-comment">//     </span>
	TIM1-&gt;CCER |= TIM_CCER_CC3NE; 						<span class="hljs-comment">//        </span><font></font>
	TIM1-&gt;CCER &amp;= ~TIM_CCER_CC3NP;<font></font>
<font></font>
	TIM1-&gt;CR1 |= TIM_CR1_CEN;<font></font>
}<font></font>
</code></pre><br>
5.  UART  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"> </a>     ;<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">UART3_Init</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	RCC-&gt;APB1ENR |= RCC_APB1ENR_USART3EN;<font></font>
<font></font>
	USART3-&gt;BRR = <span class="hljs-number">0xD0</span>;						<span class="hljs-comment">// Speed = 115200; (24 000 000 + (115200 / 2)) / 115200 = 208 -&gt; 0xD0</span><font></font>
<font></font>
	USART3-&gt;CR1 |= USART_CR1_TE | USART_CR1_RE | USART_CR1_UE;<font></font>
<font></font>
<span class="hljs-comment">//	USART3-&gt;CR1 |= USART_CR1_RXNEIE;</span>
<span class="hljs-comment">//	NVIC_EnableIRQ(USART3_IRQn);</span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">UART3_Send</span><span class="hljs-params">(<span class="hljs-keyword">char</span> chr)</span> </span>{
	<span class="hljs-keyword">while</span> (!(USART3-&gt;SR &amp; USART_SR_TC))<font></font>
		;<font></font>
	USART3-&gt;DR = chr;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">UART3_Send_String</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* str)</span> </span>{
	<span class="hljs-keyword">uint8_t</span> i = <span class="hljs-number">0</span>;<font></font>
<font></font>
	<span class="hljs-keyword">while</span> (str[i])<font></font>
		UART3_Send(str[i++]);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">UART3_Send_Number_Float</span><span class="hljs-params">(<span class="hljs-keyword">float</span> data)</span></span>{<font></font>
<font></font>
	<span class="hljs-keyword">char</span> str[<span class="hljs-number">100</span>];<font></font>
<font></font>
	<span class="hljs-keyword">char</span> *tmpSign = (data &lt; <span class="hljs-number">0</span>) ? <span class="hljs-string">"-"</span> : <span class="hljs-string">""</span>;
	<span class="hljs-keyword">float</span> tmpVal = (data &lt; <span class="hljs-number">0</span>) ? -data : data;<font></font>
<font></font>
	<span class="hljs-keyword">int</span> tmpInt1 = tmpVal;                  <span class="hljs-comment">// Get the integer (678).</span>
	<span class="hljs-keyword">float</span> tmpFrac = tmpVal - tmpInt1;      <span class="hljs-comment">// Get fraction (0.0123).</span>
	<span class="hljs-keyword">int</span> tmpInt2 = trunc(tmpFrac * <span class="hljs-number">10</span>);  <span class="hljs-comment">// Turn into integer (123).	int tmpInt2 = trunc(tmpFrac * 10000)</span><font></font>
<font></font>
	<span class="hljs-comment">// Print as parts, note that you need 0-padding for fractional bit.</span><font></font>
<font></font>
	<span class="hljs-built_in">sprintf</span> (str, <span class="hljs-string">"%s%d.%01d"</span>, tmpSign, tmpInt1, tmpInt2);<font></font>
<font></font>
	UART3_Send_String(str);<font></font>
}<font></font>
</code></pre><br>
6.     FreeRtos config<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*
 * FreeRTOS Kernel V10.3.1
 * Copyright (C) 2020 Amazon.com, Inc. or its affiliates.  All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * http://www.FreeRTOS.org
 * http://aws.amazon.com/freertos
 *
 * 1 tab == 4 spaces!
 */</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> FREERTOS_CONFIG_H</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FREERTOS_CONFIG_H</span><font></font>
<font></font>
<span class="hljs-comment">/* Library includes. */</span>
<span class="hljs-comment">//#include "stm32f10x_lib.h"</span>
<span class="hljs-comment">/*-----------------------------------------------------------
 * Application specific definitions.
 *
 * These definitions should be adjusted for your particular hardware and
 * application requirements.
 *
 * THESE PARAMETERS ARE DESCRIBED WITHIN THE 'CONFIGURATION' SECTION OF THE
 * FreeRTOS API DOCUMENTATION AVAILABLE ON THE FreeRTOS.org WEB SITE. 
 *
 * See http://www.freertos.org/a00110.html
 *----------------------------------------------------------*/</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> vPortSVCHandler SVC_Handler		<span class="hljs-comment">// fix problem</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xPortPendSVHandler PendSV_Handler</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> vPortSVCHandler SVC_Handler</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xPortSysTickHandler SysTick_Handler</span><font></font>
<font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_PREEMPTION		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_IDLE_HOOK			0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_TICK_HOOK			1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configCPU_CLOCK_HZ			( ( unsigned long ) 48000000 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configTICK_RATE_HZ			( ( TickType_t ) 1000 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configMAX_PRIORITIES		( 5 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configMINIMAL_STACK_SIZE	( ( unsigned short ) 32 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configTOTAL_HEAP_SIZE		( ( size_t ) ( 17 * 1024 ) )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configMAX_TASK_NAME_LEN		( 16 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_TRACE_FACILITY	0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_16_BIT_TICKS		0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configIDLE_SHOULD_YIELD		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_MUTEXES			1</span><font></font>
<font></font>
<span class="hljs-comment">/* Co-routine definitions. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configUSE_CO_ROUTINES 		0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configMAX_CO_ROUTINE_PRIORITIES ( 2 )</span><font></font>
<font></font>
<span class="hljs-comment">/* Set the following definitions to 1 to include the API function, or zero
 to exclude the API function. */</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskPrioritySet		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_uxTaskPriorityGet		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskDelete				1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskCleanUpResources	0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskSuspend			1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskDelayUntil			1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INCLUDE_vTaskDelay				1</span><font></font>
<font></font>
<span class="hljs-comment">/* This is the raw value as per the Cortex-M3 NVIC.  Values can be 255
 (lowest) to 0 (1?) (highest). */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configKERNEL_INTERRUPT_PRIORITY 		255</span>
<span class="hljs-comment">/* !!!! configMAX_SYSCALL_INTERRUPT_PRIORITY must not be set to zero !!!!
 See http://www.FreeRTOS.org/RTOS-Cortex-M3-M4.html. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configMAX_SYSCALL_INTERRUPT_PRIORITY 	191 <span class="hljs-comment">/* equivalent to 0xb0, or priority 11. */</span></span><font></font>
<font></font>
<span class="hljs-comment">/* This is the value being used as per the ST library which permits 16
 priority values, 0 to 15.  This must correspond to the
 configKERNEL_INTERRUPT_PRIORITY setting.  Here 15 corresponds to the lowest
 NVIC value of 255. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> configLIBRARY_KERNEL_INTERRUPT_PRIORITY	15</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* FREERTOS_CONFIG_H */</span></span><font></font>
<font></font>
</code></pre><br>
7.    main;<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"main.h"</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vTaskUART2</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *argument)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vTaskConvADC</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *argument)</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">Motor</span><span class="hljs-params">(<span class="hljs-keyword">int32_t</span> which, <span class="hljs-keyword">int32_t</span> speed, <span class="hljs-keyword">int32_t</span> turn)</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IndicatorLED</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> number, <span class="hljs-keyword">uint32_t</span> status)</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-comment">//define      typedef enum :)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MotorLeft		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MotorRight		0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MoveBack		0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MoveForward		1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MaxSpeedMotor	1000</span><font></font>
<font></font>
<span class="hljs-keyword">uint16_t</span> adc_buf[<span class="hljs-number">10</span>];				<span class="hljs-comment">// Buffer DMA ADC sensors</span>
<span class="hljs-keyword">uint16_t</span> SensWhiteOrBlack[<span class="hljs-number">10</span>];		<span class="hljs-comment">// Buffer sensors white or black</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	RCC_Init();<font></font>
	GPIO_Init();<font></font>
	TIM1_Init();<font></font>
	UART3_Init();<font></font>
	ADC_Init();<font></font>
<font></font>
	xTaskCreate(vTaskUART2, <span class="hljs-string">"UART"</span>, <span class="hljs-number">512</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">NULL</span>);<font></font>
	xTaskCreate(vTaskConvADC, <span class="hljs-string">"ADC"</span>, <span class="hljs-number">128</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">NULL</span>);<font></font>
<font></font>
	UART3_Send_String(<span class="hljs-string">"Start program\r\n"</span>);<font></font>
<font></font>
	GPIOA-&gt;BSRR |= GPIO_BSRR_BS10;	<span class="hljs-comment">// Motor enable</span><font></font>
<font></font>
	vTaskStartScheduler();<font></font>
<font></font>
	<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {<font></font>
<font></font>
	}<font></font>
}<font></font>
<span class="hljs-comment">/*************************************Tasks***************************************/</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vTaskUART2</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *argument)</span> </span>{<font></font>
<font></font>
	<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {<font></font>
<font></font>
<span class="hljs-comment">//-------------------Read sensors from buff DMA ADC, and print to UART3-------------//</span><font></font>
<font></font>
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">uint32_t</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i++)<font></font>
		{<font></font>
<font></font>
			<span class="hljs-keyword">if</span> (adc_buf[i] &lt;= <span class="hljs-number">300</span>)		<span class="hljs-comment">// value sens is white</span><font></font>
			{<font></font>
				IndicatorLED(i, <span class="hljs-number">0</span>);<font></font>
				SensWhiteOrBlack[i] = <span class="hljs-number">0</span>;<font></font>
			} <span class="hljs-keyword">else</span>						<span class="hljs-comment">// else value sens is black</span><font></font>
			{<font></font>
				IndicatorLED(i, <span class="hljs-number">1</span>);<font></font>
				SensWhiteOrBlack[i] = <span class="hljs-number">1</span>;<font></font>
			}<font></font>
<font></font>
<span class="hljs-comment">//			UART3_Send_Number_Float(SensWhiteOrBlack[i]);</span>
<span class="hljs-comment">//			UART3_Send_String("\t");</span><font></font>
		}<font></font>
<span class="hljs-comment">///		UART3_Send_String("\r\n");</span><font></font>
<font></font>
<span class="hljs-comment">//-----------------------------------------Move-----------------------------------------//</span><font></font>
<font></font>
<font></font>
		<span class="hljs-comment">//----Normal mode----//</span>
		<span class="hljs-keyword">float</span> devMotorLeft  = <span class="hljs-number">1</span>;
		<span class="hljs-keyword">float</span> devMotorRight = <span class="hljs-number">1</span>;
		<span class="hljs-keyword">uint32_t</span> flagSizeBuf = <span class="hljs-number">0</span>;<font></font>
<font></font>
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int32_t</span> i = <span class="hljs-number">6</span>; i &lt;= <span class="hljs-number">9</span>; i++)<font></font>
		{<font></font>
			<span class="hljs-keyword">if</span> (SensWhiteOrBlack[i])<font></font>
			{<font></font>
				flagSizeBuf = <span class="hljs-number">1</span>;<font></font>
<font></font>
				<span class="hljs-keyword">if</span>(i == <span class="hljs-number">6</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorRight = <span class="hljs-number">0.75</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">7</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorRight = <span class="hljs-number">0.5</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">8</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorRight = <span class="hljs-number">0.25</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">9</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorRight = <span class="hljs-number">0.0</span>;<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
<font></font>
		<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int32_t</span> i = <span class="hljs-number">5</span>; i &gt;= <span class="hljs-number">0</span>; i--)<font></font>
		{<font></font>
			<span class="hljs-keyword">if</span>(SensWhiteOrBlack[i])<font></font>
			{<font></font>
				flagSizeBuf = <span class="hljs-number">1</span>;<font></font>
<font></font>
				<span class="hljs-keyword">if</span>(i == <span class="hljs-number">3</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorLeft = <span class="hljs-number">0.75</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">2</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorLeft = <span class="hljs-number">0.5</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">1</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorLeft = <span class="hljs-number">0.25</span>;<font></font>
				}<font></font>
				<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i == <span class="hljs-number">0</span> &amp;&amp; SensWhiteOrBlack[i] == <span class="hljs-number">1</span>)<font></font>
				{<font></font>
					devMotorLeft = <span class="hljs-number">0.0</span>;<font></font>
				}<font></font>
			}<font></font>
		}<font></font>
<font></font>
		<span class="hljs-keyword">if</span>(!flagSizeBuf)<font></font>
		{<font></font>
			devMotorLeft  = <span class="hljs-number">0</span>;<font></font>
			devMotorRight = <span class="hljs-number">0</span>;<font></font>
		}<font></font>
<font></font>
		Motor(MotorRight, (<span class="hljs-keyword">int32_t</span>)(MaxSpeedMotor * (<span class="hljs-keyword">float</span>)devMotorRight), MoveForward);<font></font>
		Motor(MotorLeft,  (<span class="hljs-keyword">int32_t</span>)(MaxSpeedMotor * (<span class="hljs-keyword">float</span>)devMotorLeft),  MoveForward);<font></font>
<font></font>
<font></font>
<span class="hljs-comment">/*
		if (adc_buf[0] &gt; 1000)
		{
			Motor(MotorLeft, 500, MoveBack);
		}
		else if (adc_buf[0] &lt;= 1000)
		{
			Motor(MotorLeft, 0, MoveForward);
		}

		if (adc_buf[9] &gt; 1000)
		{
			Motor(MotorRight, 500, MoveBack);//Motor(0, 500, 1);	MotorRight	MoveBack
		}
		else if (adc_buf[9] &lt;= 1000)
		{
			Motor(MotorRight, 0, MoveForward);
		}
*/</span><font></font>
<font></font>
		vTaskDelay(<span class="hljs-number">50</span>);<font></font>
	}<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">vTaskConvADC</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *argument)</span> </span>{<font></font>
<font></font>
	<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {<font></font>
<font></font>
		<span class="hljs-comment">// just void :)</span><font></font>
<font></font>
		vTaskDelay(<span class="hljs-number">5000</span>);<font></font>
	}<font></font>
<font></font>
}<font></font>
<span class="hljs-comment">/**********************************Function*************************************/</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">IndicatorLED</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> number, <span class="hljs-keyword">uint32_t</span> status)</span> </span>{<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">0</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS9;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">0</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR9;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">1</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS8;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">1</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR8;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">2</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS7;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">2</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR7;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">3</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS6;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">3</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR6;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">4</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS5;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">4</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR5;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">5</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS4;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">5</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR4;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">6</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BS3;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">6</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOB-&gt;BSRR |= GPIO_BSRR_BR3;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">7</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BS15;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">7</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BR15;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">8</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BS12;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">8</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BR12;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (number == <span class="hljs-number">9</span> &amp;&amp; status == <span class="hljs-number">0</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BS11;<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number == <span class="hljs-number">9</span> &amp;&amp; status == <span class="hljs-number">1</span>) {<font></font>
		GPIOA-&gt;BSRR |= GPIO_BSRR_BR11;<font></font>
	}<font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">uint32_t</span> <span class="hljs-title">Motor</span><span class="hljs-params">(<span class="hljs-keyword">int32_t</span> which, <span class="hljs-keyword">int32_t</span> speed, <span class="hljs-keyword">int32_t</span> turn)</span> </span>{<font></font>
<font></font>
	<span class="hljs-keyword">if</span> (which == <span class="hljs-number">0</span>)	<span class="hljs-comment">//Right motor</span><font></font>
	{<font></font>
		UART3_Send_Number_Float(speed);<font></font>
		UART3_Send_String(<span class="hljs-string">"\t"</span>);<font></font>
<font></font>
		<span class="hljs-keyword">if</span> (speed &gt; <span class="hljs-number">0</span> &amp;&amp; speed &lt;= <span class="hljs-number">1000</span>)<font></font>
		{<font></font>
			TIM1-&gt;CCR3 = speed;<font></font>
			<span class="hljs-keyword">if</span> (turn == <span class="hljs-number">0</span>) 	<span class="hljs-comment">// back</span><font></font>
			{<font></font>
				GPIOB-&gt;BSRR |= GPIO_BSRR_BS14;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span>			<span class="hljs-comment">//forward</span><font></font>
			{<font></font>
				GPIOB-&gt;BSRR |= GPIO_BSRR_BR14;<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-keyword">else</span>		<span class="hljs-comment">//disable motor</span><font></font>
		{<font></font>
			TIM1-&gt;CCR3 = <span class="hljs-number">0</span>;<font></font>
			GPIOB-&gt;BSRR |= GPIO_BSRR_BR14;<font></font>
<font></font>
		}<font></font>
<font></font>
	}<font></font>
<font></font>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (which == <span class="hljs-number">1</span>)	<span class="hljs-comment">//left motor</span><font></font>
	{<font></font>
		UART3_Send_Number_Float(speed);<font></font>
		UART3_Send_String(<span class="hljs-string">"\r\n"</span>);<font></font>
<font></font>
		<span class="hljs-keyword">if</span> (speed &gt; <span class="hljs-number">0</span> &amp;&amp; speed &lt;= <span class="hljs-number">1000</span>)<font></font>
		{<font></font>
			TIM1-&gt;CCR2 = speed;<font></font>
			<span class="hljs-keyword">if</span> (turn == <span class="hljs-number">1</span>) 	<span class="hljs-comment">// back</span><font></font>
			{<font></font>
				GPIOA-&gt;BSRR |= GPIO_BSRR_BS8;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span>			<span class="hljs-comment">//forward</span><font></font>
			{<font></font>
				GPIOA-&gt;BSRR |= GPIO_BSRR_BR8;<font></font>
			}<font></font>
		}<font></font>
		<span class="hljs-keyword">else</span>		<span class="hljs-comment">//disable motor</span><font></font>
		{<font></font>
			TIM1-&gt;CCR2 = <span class="hljs-number">0</span>;<font></font>
			GPIOA-&gt;BSRR |= GPIO_BSRR_BS8;<font></font>
<font></font>
		}<font></font>
<font></font>
	}<font></font>
<font></font>
<font></font>
<font></font>
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/*************************************IRQ***************************************/</span>
<span class="hljs-comment">/*
 void USART2_IRQHandler(void) {

 if (USART2-&gt;SR &amp; USART_CR1_RXNEIE) {

 USART2-&gt;SR &amp;= ~USART_CR1_RXNEIE;

 if (USART2-&gt;DR == '0') {
 UART2_Send_String("OFF\r\n");
 GPIOC-&gt;BSRR = GPIO_BSRR_BS13;
 } else if (USART2-&gt;DR == '1') {
 UART2_Send_String("ON\r\n");
 GPIOC-&gt;BSRR = GPIO_BSRR_BR13;
 } else if (USART2-&gt;DR == '2') {
 uint16_t d0 = ADC1-&gt;DR;
 float Vdd = 1.2 * 4069 / d0;
 UART2_Send(Vdd);
 GPIOC-&gt;BSRR = GPIO_BSRR_BR13;
 }
 }
 }
 */</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DMA1_Channel1_IRQHandler</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{<font></font>
<font></font>
	DMA1-&gt;IFCR = DMA_IFCR_CGIF1 | DMA_IFCR_CTCIF1;	<span class="hljs-comment">// clear DMA interrupt flags</span>
	DMA1_Channel1-&gt;CCR &amp;= ~DMA_CCR_EN;					<span class="hljs-comment">//  </span>
	<span class="hljs-comment">/*
	 * Code
	 */</span>
	DMA1_Channel1-&gt;CCR |= DMA_CCR_EN;			   <span class="hljs-comment">//  </span><font></font>
	ADC1-&gt;CR2 |= ADC_CR2_ADON;<font></font>
}<font></font>
<font></font>
</code></pre><br>
</div>
                    </div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู ููููุง</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุธู ูุฐุง ุงููุดุฑูุน ูุนููุงู ุนูู ุฎุทุทู ูุนุฏุฉ ุณููุงุช ูุชู ุชุฃุฌููู ุทูุงู ุงูููุช ุ ูููู ุงูุขู ูุตููุง ูุนูุงู ุฅูู ููุงูุชู ุงูููุทููุฉ ุ ุงูุชู ูุณุนุฏูู ุฌุฏูุง ุงูุงูุชูุงุก ูููุง ุ ูุฃูุฏ ุฃู ุฃุฌุนูู ููุชูุญูุง ุฌุฒุฆููุง ูุฃุจูุนู ูููุตุฉ / ููุดุฆ ุขุฎุฑ ุ ุฅู ุฃููู ุ ุซู ุฑูุจูุช ุงูุณููู ููุณ ุจุจุนูุฏ ุ ูุณูุฐูุจ ุขุฎุฑูู. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุชูู ููุงู ุฎุทุท ููุชุงุจุฉ ููุงู ุ ูููู ุงููุดุงุฑูุฉ ูู ุงููุณุงุจูุฉ ุชุชุทูุจ ุฐูู. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ูุณูุช ุงูุตูุฑุฉ ุชูุฑูุจูุง ุ ููู ุชุตู ุจุนุถ ุงูููููุงุช ุจุนุฏ ุ ูุงูููุนุฏ ุงูููุงุฆู ูููุณุงุจูุฉ ูู ุงูุบุฏ ุ ูุฐูู ูุงู ุนูู ุงุณุชุฎุฏุงู DIY ููุณ ูู ุฃูุถู ุฃุฏุงุก ููุง.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุตูุฑุฉ ุงูุฑูุจูุช</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/6f6/961/400/6f6961400a8062733354fd8ac85b41a0.jpg" alt="image"><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅููู ููุฏูู ุงุฎุชุจุงุฑ ูุตุบุฑ</font></font><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Hk-FURUHLvc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar497764/index.html">ููููุฉ ุชุญุถูุฑ ุงููุนุจุฉ ูููููุง ุฅูู ุฌูุงุฒ ุงูููุจููุชุฑ ููุญุฏุฉ ุงูุชุญูู</a></li>
<li><a href="../ar497768/index.html">ุฃุชูุชุฉ ุงูุชุทููุฑ</a></li>
<li><a href="../ar497770/index.html">ุชูุฏูู PyCaret: ููุชุจุฉ ุชุนูู ุขูุฉ Python ููุฎูุถุฉ ุงูุชูููุฉ ููุชูุญุฉ</a></li>
<li><a href="../ar497772/index.html">ุงูุชุทููุฑ ูู Wargaming - ููุงุก ูุน ููุณูู ุจุงุฑูุดููููู ุ ุฑุฆูุณ ุงูููุตุฉ (ุงูุฌุฒุก ุงูุซุงูู)</a></li>
<li><a href="../ar497780/index.html">ุซูุงุซ ุณููุงุช ูู ุฃูุฑููุง ุงููุงุชูููุฉ: ููู ุบุงุฏุฑุช ูุญูู ูุนุงุฏุช ุจุนุฏ "ุฅุนุงุฏุฉ ุชุนููู" ูุงููุฉ</a></li>
<li><a href="../ar497784/index.html">ุญู HiDC ูุจูุงุก ุจููุฉ ุชุญุชูุฉ ุญุฏูุซุฉ ูุชูููููุฌูุง ุงููุนูููุงุช ูุงูุงุชุตุงูุงุช ููุฑุงูุฒ ุงูุจูุงูุงุช ุนูู ุฃุณุงุณ ูุนุฏุงุช Huawei Enterprise</a></li>
<li><a href="../ar497786/index.html">ุงูุขู ุตุงูุน ุฃุญุฐูุฉ ูุน ุญุฐุงุก ุ ุฃู ููู ุญุตููุง ุนูู ุฏููู ุฃุณููุจูุง ุงูุฎุงุต</a></li>
<li><a href="../ar497788/index.html">ุฃูุถู 10 ููุญูุงุช ูุฑูู ูููุตูููู</a></li>
<li><a href="../ar497790/index.html">ูุฏุนูู ุฅูู DINS QA EVENING: ูุชุญุฏุซ ุนู Postman ูุทุฑู ุชูููู ุชุบุทูุฉ ุงูุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar497792/index.html">ุฃุฏูุงุช ูุณุชุซูุฑ ุงูุฃุณูู ุงููุจุชุฏุฆ: ุงุฎุชุจุงุฑ ุงููุตูู ุ ุจุฏุก ุงูุชุนุฑููุฉ ุ ููุตุฉ ุงูุชุฏุงูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>