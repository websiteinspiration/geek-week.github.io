<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§•ğŸ½ ğŸ–‡ï¸ ğŸ‘ƒğŸ¾ Lemmatize lebih cepat (PyMorphy2, PyMystem3 dan beberapa sihir) ğŸ§—ğŸ» ğŸ‘€ â²ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya bekerja sebagai programmer, termasuk pembelajaran mesin dalam kaitannya dengan analisis teks. Saat memproses bahasa alami, persiapan awal dokumen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Lemmatize lebih cepat (PyMorphy2, PyMystem3 dan beberapa sihir)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503420/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya bekerja sebagai programmer, termasuk pembelajaran mesin dalam kaitannya dengan analisis teks. </font><font style="vertical-align: inherit;">Saat memproses bahasa alami, persiapan awal dokumen diperlukan, dan salah satu metodenya adalah lemasiisasi - membawa semua kata teks ke bentuk normal, dengan mempertimbangkan konteksnya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baru-baru ini, kami dihadapkan dengan masalah biaya waktu yang besar untuk proses ini. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam tugas khusus ada lebih dari 100.000 dokumen, panjang rata-rata sekitar 1000 karakter, dan itu perlu untuk menerapkan pemrosesan pada komputer lokal biasa, dan bukan pada server kami untuk perhitungan. </font><font style="vertical-align: inherit;">Kami tidak dapat menemukan solusi di Internet, tetapi kami menemukannya sendiri, dan saya ingin membagikannya - untuk menunjukkan analisis komparatif dari dua perpustakaan lemmatization paling populer di artikel ini.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/t_/f9/wqt_f9iudgj6iemgovbkss1lkq4.png"><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pymorphy2</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Salah satu yang paling populer adalah PyMorphy2 - ditemukan di hampir setiap solusi yang dapat ditemukan di jaringan. </font><font style="vertical-align: inherit;">Kami juga menggunakan perpustakaan ini, dan itu menunjukkan dirinya dengan sempurna, sampai diperlukan untuk melakukan lemmatization untuk seluruh database (seperti yang saya tulis di atas, ini lebih dari 100 ribu dokumen kecil). </font><font style="vertical-align: inherit;">Untuk menganalisis volume dokumen seperti itu, PyMorphy2 akan memakan waktu hampir 10 jam, sementara prosesor memuat selama ini rata-rata sekitar 30% (Intel Core i7 7740X).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pymystem3</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam mencari solusi lain, kami menganalisis perpustakaan dari Yandex PyMystem3, tetapi hasilnya hampir dua kali lebih buruk (dalam waktu) daripada PyMorphy2: butuh 16 jam untuk memproses 100 ribu dokumen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa keajaiban</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya aneh bagi kami bahwa beban prosesor hampir nol. Aneh juga bahwa untuk mendapatkan hasil dari satu teks, bahkan yang besar (3-4 ribu karakter), PyMystem3 membutuhkan waktu sekitar 1 detik. Oleh karena itu, kami memutuskan untuk menggabungkan teks-teks dengan menambahkan beberapa pemisah di antara mereka, yang menurutnya kami dapat mengembalikan struktur daftar dokumen kami dan memberikannya untuk lemmatization. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode solusi Python:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkExecTimeMystemOneText</span>(<span class="hljs-params">texts</span>):</span>
    lol = <span class="hljs-keyword">lambda</span> lst, sz: [lst[i:i+sz] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(lst), sz)]<font></font>
    txtpart = lol(texts, <span class="hljs-number">1000</span>)<font></font>
    res = []<font></font>
    <span class="hljs-keyword">for</span> txtp <span class="hljs-keyword">in</span> txtpart:<font></font>
        alltexts = <span class="hljs-string">' '</span>.join([txt + <span class="hljs-string">' br '</span> <span class="hljs-keyword">for</span> txt <span class="hljs-keyword">in</span> txtp])<font></font>
<font></font>
        words = mystem.lemmatize(alltexts)<font></font>
        doc = []<font></font>
        <span class="hljs-keyword">for</span> txt <span class="hljs-keyword">in</span> words:
            <span class="hljs-keyword">if</span> txt != <span class="hljs-string">'\n'</span> <span class="hljs-keyword">and</span> txt.strip() != <span class="hljs-string">''</span>:
                <span class="hljs-keyword">if</span> txt == <span class="hljs-string">'br'</span>:<font></font>
                    res.append(doc)<font></font>
                    doc = []<font></font>
                <span class="hljs-keyword">else</span>:<font></font>
                    doc.append(txt)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengambil masing-masing 1000 dokumen untuk serikat pekerja, pemisah di antara mereka adalah "br" (harus dicatat bahwa teks-teks dalam bahasa Rusia, dan alfabet Latin dan karakter khusus, kami sebelumnya dihapus). </font><font style="vertical-align: inherit;">Solusi ini secara signifikan mempercepat lemmatisasi: rata-rata, ternyata sekitar 25 menit untuk semua 100 ribu dokumen, beban prosesor adalah 20-40%. </font><font style="vertical-align: inherit;">Benar, solusi ini memuat lebih banyak RAM: rata-rata, sekitar 3-7GB, tetapi ini adalah hasil yang baik. </font><font style="vertical-align: inherit;">Jika tidak ada memori yang cukup, maka Anda dapat mengubah jumlah dokumen yang akan digabungkan, meskipun ini akan memperlambat pemrosesan, itu masih akan jauh lebih cepat daripada satu teks pada suatu waktu. </font><font style="vertical-align: inherit;">Juga, jika jumlah memori memungkinkan, maka Anda dapat meningkatkan nilai ini dan mendapatkan hasilnya lebih cepat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabel menunjukkan perbandingan perpustakaan selama pemrosesan di komputer lokal (Intel Core i7 7740X, RAM 32 GB):</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">metode</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waktu</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM (Mb)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persen</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pymorphy2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ 9,5 jam</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">500 - 600</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 - 30%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyMystem3 dengan 1 kalimat</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ 16 jam</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">500 - 700</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 - 1%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyMystem3 dengan 1000 penawaran</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26 menit</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2000 - 7000</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">25 - 40%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sangat menarik untuk mengetahui pendapat spesialis lain. </font><font style="vertical-align: inherit;">Mungkin seseorang menemukan cara yang lebih efisien waktu untuk meng-lemmatizing teks pendek? </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Kabakov, Insinyur Perangkat Lunak Senior, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anna Mikhailova, Kepala </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penambangan </font><font style="vertical-align: inherit;">Data </font><font style="vertical-align: inherit;">, Konsorsium Codex</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id503406/index.html">Semantik dan aktivitas</a></li>
<li><a href="../id503408/index.html">Toko Online Sisi Klien Blazor: Bagian 7 - Diperbarui untuk merilis versi 3.2.0 dan tampilan gambar yang ditambahkan</a></li>
<li><a href="../id503410/index.html">Poligon Dunia Lain: Sega Genesis</a></li>
<li><a href="../id503412/index.html">Project Loom: Java virtual threads sudah dekat</a></li>
<li><a href="../id503414/index.html">Retas Kotak. Walkthrough Rope. PWN. Memformat string dan ROP menggunakan pwntools</a></li>
<li><a href="../id503426/index.html">44,2 Tb / s lebih dari serat - bagaimana cara kerjanya?</a></li>
<li><a href="../id503428/index.html">Cara Meningkatkan Bahasa Inggris Tertulis untuk Komunikasi di Luar Negeri: Proyek Bisnis Linguix</a></li>
<li><a href="../id503430/index.html">Gateway MS Desktop Jarak Jauh, menebak HAProxy dan kata sandi</a></li>
<li><a href="../id503432/index.html">Cross-platform multi-threaded TCP / IP server di C ++</a></li>
<li><a href="../id503446/index.html">Di mana Anda dapat membuka rekening bank untuk perusahaan non-residen dari kategori berisiko tinggi pada tahun 2020?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>