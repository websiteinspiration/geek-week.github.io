<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ â„¢ï¸ ğŸ‘©â€âš–ï¸ ãã‚Œã»ã©å¤§ããªãƒ‡ãƒ¼ã‚¿ã§ã¯ãªã„ âœŒğŸ» ğŸ•µï¸ ğŸ£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã“ã®è¨˜äº‹ã§ã¯ã€PostgreSQLã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³12ã®çµ„ã¿è¾¼ã¿ã¾ãŸã¯å®£è¨€å‹ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹æ©Ÿèƒ½ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€HighLoad ++ Siberia 2019ä¼šè­°ã§åŒã˜åå‰ã®ãƒ¬ãƒãƒ¼ãƒˆç”¨ã«æº–å‚™ã•ã‚Œã¾ã—ãŸï¼ˆæ›´æ–°ï¼šãƒ¬ãƒãƒ¼ãƒˆã®ãƒ“ãƒ‡ã‚ªãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼‰ã€‚
 
 ã™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ãã‚Œã»ã©å¤§ããªãƒ‡ãƒ¼ã‚¿ã§ã¯ãªã„</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/456716/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®è¨˜äº‹ã§ã¯ã€PostgreSQLã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³12ã®çµ„ã¿è¾¼ã¿ã¾ãŸã¯å®£è¨€å‹ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹æ©Ÿèƒ½ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯</font><font style="vertical-align: inherit;">ã€HighLoad ++ Siberia 2019ä¼šè­°ã§</font><font style="vertical-align: inherit;">åŒã˜åå‰ã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¬ãƒãƒ¼ãƒˆ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨ã«æº–å‚™ã•ã‚Œã¾ã—ãŸ</font><font style="vertical-align: inherit;">ï¼ˆæ›´æ–°ï¼š</font><font style="vertical-align: inherit;">ãƒ¬ãƒãƒ¼ãƒˆã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ“ãƒ‡ã‚ªãŒè¡¨ç¤ºã•</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚Œã¾ã—ãŸï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ä¾‹ã¯ã€æœ€è¿‘ç™»å ´ã—ãŸãƒ™ãƒ¼ã‚¿ç‰ˆã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> version();
</code></pre><pre><code class="plaintext hljs">                                                     version                                                      <font></font>
------------------------------------------------------------------------------------------------------------------<font></font>
 PostgreSQL 12beta1 on i686-pc-linux-gnu, compiled by gcc (Ubuntu 5.4.0-6ubuntu1~16.04.10) 5.4.0 20160609, 32-bit<font></font>
(1 row)</code></pre><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¾‹ã§ã¯ã€ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®äºˆç´„ãŠã‚ˆã³ãƒã‚±ãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">äºˆç´„ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ã€2017å¹´6æœˆã‹ã‚‰8æœˆã¾ã§ã®3ã‹æœˆé–“ã®ã‚¨ãƒ³ãƒˆãƒªãŒå«ã¾ã‚Œã¦ãŠã‚Šã€æ¬¡ã®æ§‹é€ ã«ãªã£ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; \d bookings</code></pre><pre><code class="plaintext hljs"><font></font>
                        Table "bookings.bookings"<font></font>
    Column    |           Type           | Collation | Nullable | Default <font></font>
--------------+--------------------------+-----------+----------+---------<font></font>
 book_ref     | character(6)             |           | not null | <font></font>
 book_date    | timestamp with time zone |           | not null | <font></font>
 total_amount | numeric(10,2)            |           | not null | <font></font>
Indexes:<font></font>
    "bookings_pkey" PRIMARY KEY, btree (book_ref)<font></font>
Referenced by:<font></font>
    TABLE "tickets" CONSTRAINT "tickets_book_ref_fkey" FOREIGN KEY (book_ref) REFERENCES bookings(book_ref)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äºˆç´„ã«ã¯è¤‡æ•°ã®ãƒã‚±ãƒƒãƒˆãŒå«ã¾ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒã‚±ãƒƒãƒˆã®ã‚ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ§‹é€ ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; \d tickets</code></pre><pre><code class="plaintext hljs">                        Table "bookings.tickets"<font></font>
     Column     |         Type          | Collation | Nullable | Default <font></font>
----------------+-----------------------+-----------+----------+---------<font></font>
 ticket_no      | character(13)         |           | not null | <font></font>
 book_ref       | character(6)          |           | not null | <font></font>
 passenger_id   | character varying(20) |           | not null | <font></font>
 passenger_name | text                  |           | not null | <font></font>
 contact_data   | jsonb                 |           |          | <font></font>
Indexes:<font></font>
    "tickets_pkey" PRIMARY KEY, btree (ticket_no)<font></font>
Foreign-key constraints:<font></font>
    "tickets_book_ref_fkey" FOREIGN KEY (book_ref) REFERENCES bookings(book_ref)<font></font>
Referenced by:<font></font>
    TABLE "ticket_flights" CONSTRAINT "ticket_flights_ticket_no_fkey" FOREIGN KEY (ticket_no) REFERENCES tickets(ticket_no)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®æƒ…å ±ã¯ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åŒ–ã—ã‚ˆã†ã¨ã™ã‚‹ä¾‹ã‚’ç†è§£ã™ã‚‹ã®ã«ååˆ†ãªã¯ãšã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
â†’ãƒ‡ãƒ¢ãƒ™ãƒ¼ã‚¹ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¯„å›²åˆ†å‰²</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã¾ãšã€äºˆç´„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ—¥ä»˜ç¯„å›²ã§ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åŒ–ã—ã¦ã¿ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ã¯æ¬¡ã®ã‚ˆã†ã«ä½œæˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range (<font></font>
       book_ref     <span class="hljs-type">character</span>(<span class="hljs-number">6</span>),<font></font>
       book_date    <span class="hljs-type">timestamptz</span>,<font></font>
       total_amount <span class="hljs-type">numeric</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)<font></font>
   ) <span class="hljs-keyword">PARTITION BY RANGE</span>(book_date);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å„æœˆã®å€‹åˆ¥ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range_201706 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_range 
       <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2017-06-01'</span>::<span class="hljs-type">timestamptz</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2017-07-01'</span>::<span class="hljs-type">timestamptz</span>);<font></font>
=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range_201707 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_range 
       <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2017-07-01'</span>::<span class="hljs-type">timestamptz</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2017-08-01'</span>::<span class="hljs-type">timestamptz</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å¢ƒç•Œã‚’ç¤ºã™ã«ã¯ã€å®šæ•°ã ã‘ã§ãªãã€é–¢æ•°å‘¼ã³å‡ºã—ãªã©ã®å¼ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">å¼ã®å€¤ã¯ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã€ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã‚‹ã¨ãã«è¨ˆç®—ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range_201708 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_range 
       <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (to_timestamp(<span class="hljs-string">'01.08.2017'</span>,<span class="hljs-string">'DD.MM.YYYY'</span>)) 
                    <span class="hljs-keyword">TO</span> (to_timestamp(<span class="hljs-string">'01.09.2017'</span>,<span class="hljs-string">'DD.MM.YYYY'</span>));
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ãƒ¼ãƒ–ãƒ«ã®èª¬æ˜ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; \d+ bookings_range</code></pre><pre><code class="plaintext hljs"><font></font>
                                   Partitioned table "bookings.bookings_range"<font></font>
    Column    |           Type           | Collation | Nullable | Default | Storage  | Stats target | Description <font></font>
--------------+--------------------------+-----------+----------+---------+----------+--------------+-------------<font></font>
 book_ref     | character(6)             |           |          |         | extended |              | <font></font>
 book_date    | timestamp with time zone |           |          |         | plain    |              | <font></font>
 total_amount | numeric(10,2)            |           |          |         | main     |              | <font></font>
Partition key: RANGE (book_date)<font></font>
Partitions: bookings_range_201706 FOR VALUES FROM ('2017-06-01 00:00:00+03') TO ('2017-07-01 00:00:00+03'),<font></font>
            bookings_range_201707 FOR VALUES FROM ('2017-07-01 00:00:00+03') TO ('2017-08-01 00:00:00+03'),<font></font>
            bookings_range_201708 FOR VALUES FROM ('2017-08-01 00:00:00+03') TO ('2017-09-01 00:00:00+03')</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚‚ã†ã„ã„ã€‚</font><font style="vertical-align: inherit;">ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æŒ¿å…¥ã™ã‚‹ãŸã‚ã®ãƒˆãƒªã‚¬ãƒ¼ã¯ãªãã€CHECKåˆ¶ç´„ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">CONSTRAINT_EXCLUSIONãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚‚ä¸è¦ã§ã™ã€‚ã‚ªãƒ•ã«ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SET</span> constraint_exclusion = <span class="hljs-keyword">OFF</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è‡ªå‹•ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§åŸ‹ã‚ã‚‹ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_range <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings;</code></pre><pre><code class="plaintext hljs">INSERT 0 262788</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®£è¨€çš„ãªæ§‹æ–‡ã¯ç¶™æ‰¿ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ãŸã‚ã€ã‚¯ã‚¨ãƒªã«ã‚ˆã£ã¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®æ–‡å­—åˆ—ã®åˆ†å¸ƒã‚’ç¢ºèªã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span>, count(*) <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> tableoid;</code></pre><pre><code class="plaintext hljs">       tableoid        | count  <font></font>
-----------------------+--------<font></font>
 bookings_range_201706 |   7303<font></font>
 bookings_range_201707 | 167062<font></font>
 bookings_range_201708 |  88423<font></font>
(3 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">ONLY</span> bookings_range;
</code></pre><pre><code class="plaintext hljs"> book_ref | book_date | total_amount <font></font>
----------+-----------+--------------<font></font>
(0 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®é™¤å¤–ã‚’ç¢ºèªã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">WHERE</span> book_date = <span class="hljs-string">'2017-07-01'</span>::<span class="hljs-type">timestamptz</span>;
</code></pre><pre><code class="plaintext hljs">                                 QUERY PLAN                                 <font></font>
----------------------------------------------------------------------------<font></font>
 Seq Scan on bookings_range_201707<font></font>
   Filter: (book_date = '2017-07-01 00:00:00+03'::timestamp with time zone)<font></font>
(2 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äºˆæƒ³ã©ãŠã‚Šã€1ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ä¾‹ã§ã¯ã€å®šæ•°ã®ä»£ã‚ã‚Šã«å¤‰å‹•ã‚«ãƒ†ã‚´ãƒªSTABLEã‚’æŒ‡å®šã—ã¦to_timestampé–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">WHERE</span> book_date = to_timestamp(<span class="hljs-string">'01.07.2017'</span>,<span class="hljs-string">'DD.MM.YYYY'</span>);
</code></pre><pre><code class="plaintext hljs">                                     QUERY PLAN                                     <font></font>
------------------------------------------------------------------------------------<font></font>
 Append<font></font>
   Subplans Removed: 2<font></font>
   -&gt;  Seq Scan on bookings_range_201707<font></font>
         Filter: (book_date = to_timestamp('01.07.2017'::text, 'DD.MM.YYYY'::text))<font></font>
(4 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é–¢æ•°ã®å€¤ã¯ã€ã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ãŒåˆæœŸåŒ–ã•ã‚Œã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸€éƒ¨ãŒè¡¨ç¤ºã‹ã‚‰é™¤å¤–ã•ã‚Œã‚‹ã¨ãã«è¨ˆç®—ã•ã‚Œã¾ã™ï¼ˆã‚µãƒ–ãƒ—ãƒ©ãƒ³ãŒå‰Šé™¤ã•ã‚ŒãŸè¡Œï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€ã“ã‚Œã¯SELECTã«å¯¾ã—ã¦ã®ã¿æ©Ÿèƒ½ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹ã¨ãã€STABLEé–¢æ•°ã®å€¤ã«åŸºã¥ãã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®é™¤å¤–ã¯ã¾ã å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">WHERE</span> book_date = to_timestamp(<span class="hljs-string">'01.07.2017'</span>,<span class="hljs-string">'DD.MM.YYYY'</span>);
</code></pre><pre><code class="plaintext hljs">                                     QUERY PLAN                                     <font></font>
------------------------------------------------------------------------------------<font></font>
 Delete on bookings_range<font></font>
   Delete on bookings_range_201706<font></font>
   Delete on bookings_range_201707<font></font>
   Delete on bookings_range_201708<font></font>
   -&gt;  Seq Scan on bookings_range_201706<font></font>
         Filter: (book_date = to_timestamp('01.07.2017'::text, 'DD.MM.YYYY'::text))<font></font>
   -&gt;  Seq Scan on bookings_range_201707<font></font>
         Filter: (book_date = to_timestamp('01.07.2017'::text, 'DD.MM.YYYY'::text))<font></font>
   -&gt;  Seq Scan on bookings_range_201708<font></font>
         Filter: (book_date = to_timestamp('01.07.2017'::text, 'DD.MM.YYYY'::text))<font></font>
(10 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ãŸãŒã£ã¦ã€å®šæ•°ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">WHERE</span> book_date = <span class="hljs-string">'2017-07-01'</span>::<span class="hljs-type">timestamptz</span>;
</code></pre><pre><code class="plaintext hljs">                                    QUERY PLAN                                    <font></font>
----------------------------------------------------------------------------------<font></font>
 Delete on bookings_range<font></font>
   Delete on bookings_range_201707<font></font>
   -&gt;  Seq Scan on bookings_range_201707<font></font>
         Filter: (book_date = '2017-07-01 00:00:00+03'::timestamp with time zone)<font></font>
(4 rows)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä¸¦ã¹æ›¿ãˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ã•ã¾ã–ã¾ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰å–å¾—ã—ãŸçµæœã‚’ä¸¦ã¹æ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã‚¯ã‚¨ãƒªãƒ—ãƒ©ãƒ³ã§ã¯ã€SORTãƒãƒ¼ãƒ‰ã¨ãƒ—ãƒ©ãƒ³ã®é«˜ã„åˆæœŸã‚³ã‚¹ãƒˆãŒã‚ã‹ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_date;
</code></pre><pre><code class="plaintext hljs">                                        QUERY PLAN                                        <font></font>
------------------------------------------------------------------------------------------<font></font>
 Sort  (cost=24649.77..25077.15 rows=170952 width=52)<font></font>
   Sort Key: bookings_range_201706.book_date<font></font>
   -&gt;  Append  (cost=0.00..4240.28 rows=170952 width=52)<font></font>
         -&gt;  Seq Scan on bookings_range_201706  (cost=0.00..94.94 rows=4794 width=52)<font></font>
         -&gt;  Seq Scan on bookings_range_201707  (cost=0.00..2151.30 rows=108630 width=52)<font></font>
         -&gt;  Seq Scan on bookings_range_201708  (cost=0.00..1139.28 rows=57528 width=52)<font></font>
(6 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
book_dateã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">å˜ä¸€ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä»£ã‚ã‚Šã«ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ä½œæˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> book_date_idx <span class="hljs-keyword">ON</span> bookings_range(book_date);
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; \di bookings_range*</code></pre><pre><code class="plaintext hljs">                                    List of relations<font></font>
  Schema  |                Name                 | Type  |  Owner  |         Table         <font></font>
----------+-------------------------------------+-------+---------+-----------------------<font></font>
 bookings | bookings_range_201706_book_date_idx | index | student | bookings_range_201706<font></font>
 bookings | bookings_range_201707_book_date_idx | index | student | bookings_range_201707<font></font>
 bookings | bookings_range_201708_book_date_idx | index | student | bookings_range_201708<font></font>
(3 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸¦ã¹æ›¿ãˆã®ã‚ã‚‹ä»¥å‰ã®ã‚¯ã‚¨ãƒªã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€ã•ã¾ã–ã¾ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®çµæœã‚’ä¸¦ã¹æ›¿ãˆã‚‰ã‚ŒãŸå½¢å¼ã§ã™ãã«è¿”ã™ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">SORTãƒãƒ¼ãƒ‰ã¯ä¸è¦ã§ã‚ã‚Šã€çµæœã®æœ€åˆã®è¡Œã‚’ç”Ÿæˆã™ã‚‹ã«ã¯æœ€å°ã‚³ã‚¹ãƒˆãŒå¿…è¦ã§ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_range <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_date;
</code></pre><pre><code class="plaintext hljs">                                                           QUERY PLAN                                                           <font></font>
--------------------------------------------------------------------------------------------------------------------------------<font></font>
 Append  (cost=1.12..14880.88 rows=262788 width=52)<font></font>
   -&gt;  Index Scan using bookings_range_201706_book_date_idx on bookings_range_201706  (cost=0.28..385.83 rows=7303 width=52)<font></font>
   -&gt;  Index Scan using bookings_range_201707_book_date_idx on bookings_range_201707  (cost=0.42..8614.35 rows=167062 width=52)<font></font>
   -&gt;  Index Scan using bookings_range_201708_book_date_idx on bookings_range_201708  (cost=0.42..4566.76 rows=88423 width=52)<font></font>
(4 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®æ–¹æ³•ã§ä½œæˆã•ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ã€ä¸€å…ƒçš„ã«ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹ã¨ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒè‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€1ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> bookings_range_201706_book_date_idx;
</code></pre><pre><code class="plaintext hljs">ERROR:  cannot drop index bookings_range_201706_book_date_idx because index book_date_idx requires it<font></font>
HINT:  You can drop index book_date_idx instead.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å…¨ä½“ã§ã®ã¿ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> book_date_idx;
</code></pre><pre><code class="plaintext hljs">DROP INDEX</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ...åŒæ™‚ã«</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹å ´åˆã€CONCURRENTLYã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãŸã ã—ã€æ¬¡ã®ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">æœ€åˆã«ã€ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã®ã¿ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ç„¡åŠ¹ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> book_date_idx <span class="hljs-keyword">ON</span> <span class="hljs-keyword">ONLY</span> bookings_range(book_date);
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> indisvalid <span class="hljs-keyword">FROM</span> pg_index <span class="hljs-keyword">WHERE</span> indexrelid::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span> = <span class="hljs-string">'book_date_idx'</span>;
</code></pre><pre><code class="plaintext hljs"> indisvalid <font></font>
------------<font></font>
 f<font></font>
(1 row)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€CONCURRENTLYã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã™ã¹ã¦ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">CONCURRENTLY</span> book_date_201706_idx <span class="hljs-keyword">ON</span> bookings_range_201706 (book_date);<font></font>
=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">CONCURRENTLY</span> book_date_201707_idx <span class="hljs-keyword">ON</span> bookings_range_201707 (book_date);<font></font>
=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">CONCURRENTLY</span> book_date_201708_idx <span class="hljs-keyword">ON</span> bookings_range_201708 (book_date);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«æ¥ç¶šã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">INDEX</span> book_date_idx <span class="hljs-keyword">ATTACH PARTITION</span> book_date_201706_idx;<font></font>
=&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">INDEX</span> book_date_idx <span class="hljs-keyword">ATTACH PARTITION</span> book_date_201707_idx;<font></font>
=&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">INDEX</span> book_date_idx <span class="hljs-keyword">ATTACH PARTITION</span> book_date_201708_idx;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ¥ç¶šã«ä¼¼ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã¤ã„ã¦ã¯ã€å¾Œã§èª¬æ˜ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã™ã¹ã¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæ¥ç¶šã•ã‚Œã‚‹ã¨ã™ãã«ã€ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒå¤‰æ›´ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> indisvalid <span class="hljs-keyword">FROM</span> pg_index <span class="hljs-keyword">WHERE</span> indexrelid::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span> = <span class="hljs-string">'book_date_idx'</span>;
</code></pre><pre><code class="plaintext hljs"> indisvalid <font></font>
------------<font></font>
 t<font></font>
(1 row)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ¥ç¶šã¨åˆ‡æ–­</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è‡ªå‹•ä½œæˆã¯æä¾›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åŒ–ã‚­ãƒ¼ã®æ–°ã—ã„å€¤ã‚’æŒã¤ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ ã™ã‚‹å‰ã«ã€äº‹å‰ã«ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»–ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ“ä½œã—ã¦ã„ã‚‹é–“ã«æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€åŒæ™‚ã«ãƒ­ãƒƒã‚¯ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">BEGIN</span>;<font></font>
=&gt; <span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> bookings_range
    <span class="hljs-keyword">WHERE</span> book_date = to_timestamp(<span class="hljs-string">'01.07.2017'</span>,<span class="hljs-string">'DD.MM.YYYY'</span>);
</code></pre><pre><code class="plaintext hljs"> count <font></font>
-------<font></font>
     5<font></font>
(1 row)<font></font>
</code></pre><pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> relation::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span>, mode <span class="hljs-keyword">FROM</span> pg_locks 
    <span class="hljs-keyword">WHERE</span> pid = pg_backend_pid() <span class="hljs-keyword">AND</span> relation::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'bookings%'</span>;
</code></pre><pre><code class="plaintext hljs">       relation        |      mode       <font></font>
-----------------------+-----------------<font></font>
 bookings_range_201708 | AccessShareLock<font></font>
 bookings_range_201707 | AccessShareLock<font></font>
 bookings_range_201706 | AccessShareLock<font></font>
 bookings_range        | AccessShareLock<font></font>
(4 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®å†’é ­ã§ã€ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã€ã™ã¹ã¦ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«AccessShareLockãƒ­ãƒƒã‚¯ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚ to_timestampé–¢æ•°ã®è¨ˆç®—ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®é™¤å¤–ã¯å¾Œã§è¡Œã‚ã‚Œã¾ã™ã€‚é–¢æ•°ã®ä»£ã‚ã‚Šã«å®šæ•°ãŒä½¿ç”¨ã•ã‚ŒãŸå ´åˆã€ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã¨bookings_range_201707ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€å¯èƒ½ã§ã‚ã‚Œã°ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§å®šæ•°ã‚’æŒ‡å®šã—ã¾ã™ã€‚ãã†ã—ãªã„ã¨ã€pg_locksã®è¡Œæ•°ãŒã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ•°ã«æ¯”ä¾‹ã—ã¦å¢—åŠ ã—ã€max_locks_per_transactionã‚’å¢—ã‚„ã™å¿…è¦ãŒç”Ÿã˜ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å‰ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Œäº†ã›ãšã«ã€æ–°ã—ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§9æœˆã®æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">    || =&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range_201709 (<span class="hljs-keyword">LIKE</span> bookings_range);<font></font>
    || =&gt; <span class="hljs-keyword">BEGIN</span>;<font></font>
    || =&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> bookings_range <span class="hljs-keyword">ATTACH PARTITION</span> bookings_range_201709
          <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2017-09-01'</span>::<span class="hljs-type">timestamptz</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2017-10-01'</span>::<span class="hljs-type">timestamptz</span>);<font></font>
    || =&gt; <span class="hljs-keyword">SELECT</span> relation::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span>, mode <span class="hljs-keyword">FROM</span> pg_locks 
          <span class="hljs-keyword">WHERE</span> pid = pg_backend_pid() <span class="hljs-keyword">AND</span> relation::<span class="hljs-type">regclass</span>::<span class="hljs-type">text</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'bookings%'</span>;
</code></pre><pre><code class="plaintext hljs">              relation               |           mode           <font></font>
-------------------------------------+--------------------------<font></font>
 bookings_range_201709_book_date_idx | AccessExclusiveLock<font></font>
 bookings_range                      | ShareUpdateExclusiveLock<font></font>
 bookings_range_201709               | ShareLock<font></font>
 bookings_range_201709               | AccessExclusiveLock<font></font>
(4 rows)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ–°ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã¨ã€AccessShareLockã¨äº’æ›æ€§ã®ã‚ã‚‹ShareUpdateExclusiveLockãƒ­ãƒƒã‚¯ãŒãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã«èª²ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹æ“ä½œã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã™ã‚‹ã‚¯ã‚¨ãƒªã¨ç«¶åˆã—ã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">COMMIT</span>;</code></pre><br>
<pre><code class="pgsql hljs">    || =&gt; <span class="hljs-keyword">COMMIT</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®åˆ‡æ–­ã¯ã€ALTER TABLE ... DETACH PARTITIONã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³è‡ªä½“ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“ãŒã€ç‹¬ç«‹ã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãã“ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚Šã€å‰Šé™¤ã—ãŸã‚Šã€å¿…è¦ã«å¿œã˜ã¦å†æ¥ç¶šã—ãŸã‚Šã§ãã¾ã™ï¼ˆATTACH PARTITIONï¼‰ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¡åŠ¹ã«ã™ã‚‹åˆ¥ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€DROP TABLEã‚³ãƒãƒ³ãƒ‰ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ®‹å¿µãªãŒã‚‰ã€DROP TABLEã¨DETACH PARTITIONã®ä¸¡æ–¹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã§AccessExclusiveLockãƒ­ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒã¾ã ä½œæˆã•ã‚Œã¦ã„ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã®å‹•ä½œãŒæœ›ã¾ã—ããªã„å ´åˆã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_range_default <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_range <span class="hljs-keyword">DEFAULT</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã¨ãã«ã€ãƒŸãƒ¬ãƒ‹ã‚¢ãƒ ã‚’æŒ‡å®šã›ãšã«æ—¥ä»˜ã‚’æ··åŒã™ã‚‹ã¨ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_range <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'XX0000'</span>, <span class="hljs-string">'0017-09-01'</span>::<span class="hljs-type">timestamptz</span>, <span class="hljs-number">0</span>) 
   <span class="hljs-keyword">RETURNING</span> tableoid::<span class="hljs-type">regclass</span>, *;
</code></pre><pre><code class="plaintext hljs">        tableoid        | book_ref |          book_date           | total_amount <font></font>
------------------------+----------+------------------------------+--------------<font></font>
 bookings_range_default | XX0000   | 0017-09-01 00:00:00+02:30:17 |         0.00<font></font>
(1 row)<font></font>
<font></font>
INSERT 0 1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RETURNINGã¨ã„ã†å¥ã¯æ–°ã—ã„è¡Œã‚’è¿”ã™ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¾åœ¨ã®æ—¥ä»˜ã‚’è¨­å®šï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã‚’å¤‰æ›´ï¼‰ã—ãŸå¾Œã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯è‡ªå‹•çš„ã«ç›®çš„ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ç§»å‹•ã—ã¾ã™ã€‚ãƒˆãƒªã‚¬ãƒ¼ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">UPDATE</span> bookings_range <span class="hljs-keyword">SET</span> book_date = <span class="hljs-string">'2017-09-01'</span>::<span class="hljs-type">timestamptz</span> <span class="hljs-keyword">WHERE</span> book_ref = <span class="hljs-string">'XX0000'</span> 
   <span class="hljs-keyword">RETURNING</span> tableoid::<span class="hljs-type">regclass</span>, *;
</code></pre><pre><code class="plaintext hljs">       tableoid        | book_ref |       book_date        | total_amount <font></font>
-----------------------+----------+------------------------+--------------<font></font>
 bookings_range_201709 | XX0000   | 2017-09-01 00:00:00+03 |         0.00<font></font>
(1 row)<font></font>
<font></font>
UPDATE 1</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å€¤ãƒªã‚¹ãƒˆã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒ–</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã¯ã€book_refåˆ—ã¯ã€bookingsãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸»ã‚­ãƒ¼ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€é¸æŠã—ãŸãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã‚¹ã‚­ãƒ¼ãƒ ã§ã¯ã€ãã®ã‚ˆã†ãªã‚­ãƒ¼ã‚’ä½œæˆã§ãã¾ã›ã‚“ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> bookings_range <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PRIMARY KEY</span>(book_ref);
</code></pre><pre><code class="plaintext hljs">ERROR:  insufficient columns in PRIMARY KEY constraint definition<font></font>
DETAIL:  PRIMARY KEY constraint on table "bookings_range" lacks column "book_date" which is part of the partition key.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¯ä¸»ã‚­ãƒ¼ã«å«ã¾ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æœˆã”ã¨ã«åˆ†é¡ã—ã€ä¸»ã‚­ãƒ¼ã«book_refã‚’å¼•ãç¶šãå«ã‚ã‚‹ã«ã¯ã€å€¤ã®ãƒªã‚¹ãƒˆã«å¾“ã£ã¦ã€bookingsãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆ†å‰²ã™ã‚‹åˆ¥ã®ã‚¹ã‚­ãƒ¼ãƒ ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ—ã¨ã—ã¦å†—é•·ãªåˆ—book_monthã‚’è¿½åŠ ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_list (<font></font>
       book_ref     <span class="hljs-type">character</span>(<span class="hljs-number">6</span>),<font></font>
       book_month   <span class="hljs-type">character</span>(<span class="hljs-number">6</span>),<font></font>
       book_date    <span class="hljs-type">timestamptz</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<font></font>
       total_amount <span class="hljs-type">numeric</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),
       <span class="hljs-keyword">PRIMARY KEY</span> (book_ref, book_month)<font></font>
   ) <span class="hljs-keyword">PARTITION BY LIST</span>(book_month);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
äºˆç´„ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦å‹•çš„ã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å½¢æˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">WITH</span> dates <span class="hljs-keyword">AS</span> (
       <span class="hljs-keyword">SELECT</span> date_trunc(<span class="hljs-string">'month'</span>,min(book_date)) min_date, <font></font>
              date_trunc(<span class="hljs-string">'month'</span>,max(book_date)) max_date 
         <span class="hljs-keyword">FROM</span> bookings<font></font>
   ), <span class="hljs-keyword">partition</span> <span class="hljs-keyword">AS</span> (
       <span class="hljs-keyword">SELECT</span> to_char(g.month, <span class="hljs-string">'YYYYMM'</span>) <span class="hljs-keyword">AS</span> book_month 
         <span class="hljs-keyword">FROM</span> dates, <font></font>
              generate_series(dates.min_date, dates.max_date, <span class="hljs-string">'1 month'</span>::<span class="hljs-type">interval</span>) <span class="hljs-keyword">AS</span> g(month)<font></font>
   ) <font></font>
   <span class="hljs-keyword">SELECT</span> format(<span class="hljs-string">'CREATE TABLE %I PARTITION OF bookings_list FOR VALUES IN (%L)'</span>,
                  <span class="hljs-string">'bookings_list_'</span> || <span class="hljs-keyword">partition</span>.book_month, <span class="hljs-keyword">partition</span>.book_month) 
     <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">partition</span>\gexec
</code></pre><pre><code class="plaintext hljs">CREATE TABLE<font></font>
CREATE TABLE<font></font>
CREATE TABLE</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚ŒãŒèµ·ã“ã£ãŸã“ã¨ã§ã™ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; \d+ bookings_list
</code></pre><pre><code class="plaintext hljs">                                    Partitioned table "bookings.bookings_list"<font></font>
    Column    |           Type           | Collation | Nullable | Default | Storage  | Stats target | Description <font></font>
--------------+--------------------------+-----------+----------+---------+----------+--------------+-------------<font></font>
 book_ref     | character(6)             |           | not null |         | extended |              | <font></font>
 book_month   | character(6)             |           | not null |         | extended |              | <font></font>
 book_date    | timestamp with time zone |           | not null |         | plain    |              | <font></font>
 total_amount | numeric(10,2)            |           |          |         | main     |              | <font></font>
Partition key: LIST (book_month)<font></font>
Indexes:<font></font>
    "bookings_list_pkey" PRIMARY KEY, btree (book_ref, book_month)<font></font>
Partitions: bookings_list_201706 FOR VALUES IN ('201706'),<font></font>
            bookings_list_201707 FOR VALUES IN ('201707'),<font></font>
            bookings_list_201708 FOR VALUES IN ('201708')</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ–­é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®å¡—ã‚Šã¤ã¶ã—ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_list(book_ref,book_month,book_date,total_amount) 
   <span class="hljs-keyword">SELECT</span> book_ref,to_char(book_date, <span class="hljs-string">'YYYYMM'</span>),book_date,total_amount
   <span class="hljs-keyword">FROM</span> bookings;
</code></pre><pre><code class="plaintext hljs">INSERT 0 262788
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒªãƒˆãƒªãƒ¼ãƒˆã¨ã—ã¦ã€‚</font><font style="vertical-align: inherit;">book_monthã‚’è‡ªå‹•çš„ã«åŸ‹ã‚ã‚‹ã«ã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³12ã®æ–°æ©Ÿèƒ½ã§ã‚ã‚‹GENERATED ALWAYSåˆ—ã‚’ä½¿ç”¨ã—ãŸããªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€æ®‹å¿µãªãŒã‚‰ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€æœˆã‚’åŸ‹ã‚ã‚‹ã‚¿ã‚¹ã‚¯ã¯ä»–ã®æ–¹æ³•ã§è§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CHECKã‚„NOT NULLãªã©ã®æ•´åˆæ€§åˆ¶ç´„ã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä½œæˆã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ç¶™æ‰¿ã¨åŒæ§˜ã«ã€INHERIT / NOINHERITã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¯ã€ã™ã¹ã¦ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ã§åˆ¶é™ã‚’ç¶™æ‰¿ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¤ºã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç¶™æ‰¿ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> bookings_range <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> book_date <span class="hljs-keyword">SET</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; \d bookings_range
</code></pre><pre><code class="plaintext hljs">               Partitioned table "bookings.bookings_range"<font></font>
    Column    |           Type           | Collation | Nullable | Default <font></font>
--------------+--------------------------+-----------+----------+---------<font></font>
 book_ref     | character(6)             |           |          | <font></font>
 book_date    | timestamp with time zone |           | not null | <font></font>
 total_amount | numeric(10,2)            |           |          | <font></font>
Partition key: RANGE (book_date)<font></font>
Indexes:<font></font>
    "book_date_idx" btree (book_date)<font></font>
Number of partitions: 5 (Use \d+ to list them.)<font></font>
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; \d bookings_range_201706
</code></pre><pre><code class="plaintext hljs">                  Table "bookings.bookings_range_201706"<font></font>
    Column    |           Type           | Collation | Nullable | Default <font></font>
--------------+--------------------------+-----------+----------+---------<font></font>
 book_ref     | character(6)             |           |          | <font></font>
 book_date    | timestamp with time zone |           | not null | <font></font>
 total_amount | numeric(10,2)            |           |          | <font></font>
Partition of: bookings_range FOR VALUES FROM ('2017-06-01 00:00:00+03') TO ('2017-07-01 00:00:00+03')<font></font>
Indexes:<font></font>
    "book_date_201706_idx" btree (book_date)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EXCLUDEåˆ¶ç´„ã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã§ãƒ­ãƒ¼ã‚«ãƒ«ã«ã®ã¿ä½œæˆã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
book_refãŒæœ€åˆã«ãƒªã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†äº‹å®Ÿã®ãŠã‹ã’ã§ã€book_refã‚’æ¤œç´¢ã™ã‚‹ã¨ã™ã¹ã¦ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒæ¤œç´¢ã•ã‚Œã¾ã™ãŒã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ˆã£ã¦æ¤œç´¢ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
   <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_list <span class="hljs-keyword">WHERE</span> book_ref = <span class="hljs-string">'00000F'</span>;
</code></pre><pre><code class="plaintext hljs">                                QUERY PLAN                                <font></font>
--------------------------------------------------------------------------<font></font>
 Append<font></font>
   -&gt;  Index Scan using bookings_list_201706_pkey on bookings_list_201706<font></font>
         Index Cond: (book_ref = '00000F'::bpchar)<font></font>
   -&gt;  Index Scan using bookings_list_201707_pkey on bookings_list_201707<font></font>
         Index Cond: (book_ref = '00000F'::bpchar)<font></font>
   -&gt;  Index Scan using bookings_list_201708_pkey on bookings_list_201708<font></font>
         Index Cond: (book_ref = '00000F'::bpchar)<font></font>
(7 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
book_refã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç¯„å›²ã‚’æ¤œç´¢ã™ã‚‹ã¨ã€æŒ‡å®šã•ã‚ŒãŸç¯„å›²ã®ã¿ãŒæ¤œç´¢ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
   <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_list <span class="hljs-keyword">WHERE</span> book_ref = <span class="hljs-string">'00000F'</span> <span class="hljs-keyword">AND</span> book_month = <span class="hljs-string">'201707'</span>;
</code></pre><pre><code class="plaintext hljs">                                    QUERY PLAN                                     <font></font>
-----------------------------------------------------------------------------------<font></font>
 Index Scan using bookings_list_201707_pkey on bookings_list_201707<font></font>
   Index Cond: ((book_ref = '00000F'::bpchar) AND (book_month = '201707'::bpchar))<font></font>
(2 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
INSERT ... ON CONFLICTã‚³ãƒãƒ³ãƒ‰ã¯ã€ç›®çš„ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ­£ã—ãè¦‹ã¤ã‘ã€æ›´æ–°ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_list <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'XX0001'</span>,<span class="hljs-string">'201708'</span>,<span class="hljs-string">'2017-08-01'</span>,<span class="hljs-number">0</span>)
   <span class="hljs-keyword">RETURNING</span> tableoid::<span class="hljs-type">regclass</span>, *;
</code></pre><pre><code class="plaintext hljs">       tableoid       | book_ref | book_month |       book_date        | total_amount <font></font>
----------------------+----------+------------+------------------------+--------------<font></font>
 bookings_list_201708 | XX0001   | 201708     | 2017-08-01 00:00:00+03 |         0.00<font></font>
(1 row)<font></font>
<font></font>
INSERT 0 1<font></font>
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_list <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'XX0001'</span>,<span class="hljs-string">'201708'</span>,<span class="hljs-string">'2017-08-01'</span>,<span class="hljs-number">100</span>)
   <span class="hljs-keyword">ON</span> <span class="hljs-keyword">CONFLICT</span>(book_ref,book_month) <span class="hljs-keyword">DO</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">SET</span> total_amount = <span class="hljs-number">100</span>
   <span class="hljs-keyword">RETURNING</span> tableoid::<span class="hljs-type">regclass</span>, *;
</code></pre><pre><code class="plaintext hljs">       tableoid       | book_ref | book_month |       book_date        | total_amount <font></font>
----------------------+----------+------------+------------------------+--------------<font></font>
 bookings_list_201708 | XX0001   | 201708     | 2017-08-01 00:00:00+03 |       100.00<font></font>
(1 row)<font></font>
<font></font>
INSERT 0 1</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤–éƒ¨ã‚­ãƒ¼</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã¯ã€ãƒã‚±ãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã¯äºˆç´„ã‚’å‚ç…§ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¤–éƒ¨ã‚­ãƒ¼ã‚’å¯èƒ½ã«ã™ã‚‹ã«ã¯ã€book_monthåˆ—ã‚’è¿½åŠ ã—ã€åŒæ™‚ã«ã€bookings_listã ã‘ã§ãªãã€ãã‚Œã‚’æœˆã”ã¨ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†å‰²ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> tickets_list (<font></font>
       ticket_no <span class="hljs-type">character</span>(<span class="hljs-number">13</span>),<font></font>
       book_month <span class="hljs-type">character</span>(<span class="hljs-number">6</span>),<font></font>
       book_ref  <span class="hljs-type">character</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<font></font>
       passenger_id <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<font></font>
       passenger_name <span class="hljs-type">text</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<font></font>
       contact_data <span class="hljs-type">jsonb</span>,
       <span class="hljs-keyword">PRIMARY KEY</span> (ticket_no, book_month),
       <span class="hljs-keyword">FOREIGN KEY</span> (book_ref, book_month) <span class="hljs-keyword">REFERENCES</span> bookings_list (book_ref, book_month)<font></font>
   ) <span class="hljs-keyword">PARTITION BY LIST</span> (book_month);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FOREIGN KEYåˆ¶ç´„ã¯ã€ã‚ˆãè¦‹ã‚‹ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä¸€æ–¹ã§ã€ã“ã‚Œã¯</font><font style="vertical-align: inherit;">ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ãƒ†ãƒ¼ãƒ–ãƒ«</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‹ã‚‰</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã®å¤–éƒ¨ã‚­ãƒ¼</font><font style="vertical-align: inherit;">ï¼ˆtickets_listï¼‰ã§ã‚ã‚Šã€ä»–æ–¹ã§ã€ã“ã‚Œã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆbookings_listï¼‰</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¸ã®</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚­ãƒ¼</font><font style="vertical-align: inherit;">ã§ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³è¡¨ã®å¤–éƒ¨ã‚­ãƒ¼ã¯ä¸¡æ–¹å‘ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">WITH</span> dates <span class="hljs-keyword">AS</span> (
       <span class="hljs-keyword">SELECT</span> date_trunc(<span class="hljs-string">'month'</span>,min(book_date)) min_date,<font></font>
              date_trunc(<span class="hljs-string">'month'</span>,max(book_date)) max_date 
         <span class="hljs-keyword">FROM</span> bookings<font></font>
   ), <span class="hljs-keyword">partition</span> <span class="hljs-keyword">AS</span> (
       <span class="hljs-keyword">SELECT</span> to_char(g.month, <span class="hljs-string">'YYYYMM'</span>) <span class="hljs-keyword">AS</span> book_month 
         <span class="hljs-keyword">FROM</span> dates,<font></font>
              generate_series(dates.min_date, dates.max_date, <span class="hljs-string">'1 month'</span>::<span class="hljs-type">interval</span>) <span class="hljs-keyword">AS</span> g(month)<font></font>
   ) <font></font>
   <span class="hljs-keyword">SELECT</span> format(<span class="hljs-string">'CREATE TABLE %I PARTITION OF tickets_list FOR VALUES IN (%L)'</span>,
                  <span class="hljs-string">'tickets_list_'</span> || <span class="hljs-keyword">partition</span>.book_month, <span class="hljs-keyword">partition</span>.book_month) 
     <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">partition</span>\gexec
</code></pre><pre><code class="plaintext hljs">CREATE TABLE<font></font>
CREATE TABLE<font></font>
CREATE TABLE<font></font>
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; \d+ tickets_list
</code></pre><pre><code class="plaintext hljs">                                    Partitioned table "bookings.tickets_list"<font></font>
     Column     |         Type          | Collation | Nullable | Default | Storage  | Stats target | Description <font></font>
----------------+-----------------------+-----------+----------+---------+----------+--------------+-------------<font></font>
 ticket_no      | character(13)         |           | not null |         | extended |              | <font></font>
 book_month     | character(6)          |           | not null |         | extended |              | <font></font>
 book_ref       | character(6)          |           | not null |         | extended |              | <font></font>
 passenger_id   | character varying(20) |           | not null |         | extended |              | <font></font>
 passenger_name | text                  |           | not null |         | extended |              | <font></font>
 contact_data   | jsonb                 |           |          |         | extended |              | <font></font>
Partition key: LIST (book_month)<font></font>
Indexes:<font></font>
    "tickets_list_pkey" PRIMARY KEY, btree (ticket_no, book_month)<font></font>
Foreign-key constraints:<font></font>
    "tickets_list_book_ref_book_month_fkey" FOREIGN KEY (book_ref, book_month) REFERENCES bookings_list(book_ref, book_month)<font></font>
Partitions: tickets_list_201706 FOR VALUES IN ('201706'),<font></font>
            tickets_list_201707 FOR VALUES IN ('201707'),<font></font>
            tickets_list_201708 FOR VALUES IN ('201708')</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¨˜å…¥ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> tickets_list<font></font>
       (ticket_no,book_month,book_ref,passenger_id,passenger_name,contact_data)<font></font>
       <span class="hljs-keyword">SELECT</span> t.ticket_no,b.book_month,t.book_ref,<font></font>
              t.passenger_id,t.passenger_name,t.contact_data<font></font>
       <span class="hljs-keyword">FROM</span> bookings_list b <span class="hljs-keyword">JOIN</span> tickets t <span class="hljs-keyword">ON</span> (b.book_ref = t.book_ref);
</code></pre><pre><code class="plaintext hljs">INSERT 0 366733
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">VACUUM</span> <span class="hljs-keyword">ANALYZE</span> tickets_list;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ç·šã®åˆ†å¸ƒï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span>, count(*) <span class="hljs-keyword">FROM</span> tickets_list <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> tableoid;
</code></pre><pre><code class="plaintext hljs">      tableoid       | count  <font></font>
---------------------+--------<font></font>
 tickets_list_201706 |  10160<font></font>
 tickets_list_201707 | 232755<font></font>
 tickets_list_201708 | 123818<font></font>
(3 rows)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥ç¶šãŠã‚ˆã³é›†ç´„è¦æ±‚</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒã˜æ–¹æ³•ã§åˆ†å‰²ã•ã‚ŒãŸ2ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµåˆã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">SELECT</span> b.*
     <span class="hljs-keyword">FROM</span> bookings_list b <span class="hljs-keyword">JOIN</span> tickets_list t 
          <span class="hljs-keyword">ON</span> (b.book_ref = t.book_ref <span class="hljs-keyword">and</span> b.book_month = t.book_month);
</code></pre><pre><code class="plaintext hljs">                                 QUERY PLAN                                 <font></font>
----------------------------------------------------------------------------<font></font>
 Hash Join<font></font>
   Hash Cond: ((t.book_ref = b.book_ref) AND (t.book_month = b.book_month))<font></font>
   -&gt;  Append<font></font>
         -&gt;  Seq Scan on tickets_list_201706 t<font></font>
         -&gt;  Seq Scan on tickets_list_201707 t_1<font></font>
         -&gt;  Seq Scan on tickets_list_201708 t_2<font></font>
   -&gt;  Hash<font></font>
         -&gt;  Append<font></font>
               -&gt;  Seq Scan on bookings_list_201706 b<font></font>
               -&gt;  Seq Scan on bookings_list_201707 b_1<font></font>
               -&gt;  Seq Scan on bookings_list_201708 b_2<font></font>
(11 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ç¶šã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€å„ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã¾ãšã‚¯ã‚¨ãƒªæ¡ä»¶ã«è©²å½“ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’çµåˆã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã—ã‹ã—ã€æœ€åˆã«ä¸¡æ–¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¯¾å¿œã™ã‚‹æœˆæ¬¡ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›ã€æ¬¡ã«çµæœã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€enable_partitionwise_joinãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SET</span> enable_partitionwise_join = <span class="hljs-keyword">ON</span>;<font></font>
=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) 
   <span class="hljs-keyword">SELECT</span> b.*
     <span class="hljs-keyword">FROM</span> bookings_list b <span class="hljs-keyword">JOIN</span> tickets_list t
          <span class="hljs-keyword">ON</span> (b.book_ref = t.book_ref <span class="hljs-keyword">and</span> b.book_month = t.book_month);
</code></pre><pre><code class="plaintext hljs">                                        QUERY PLAN                                        <font></font>
------------------------------------------------------------------------------------------<font></font>
 Append<font></font>
   -&gt;  Hash Join<font></font>
         Hash Cond: ((t.book_ref = b.book_ref) AND (t.book_month = b.book_month))<font></font>
         -&gt;  Seq Scan on tickets_list_201706 t<font></font>
         -&gt;  Hash<font></font>
               -&gt;  Seq Scan on bookings_list_201706 b<font></font>
   -&gt;  Hash Join<font></font>
         Hash Cond: ((t_1.book_ref = b_1.book_ref) AND (t_1.book_month = b_1.book_month))<font></font>
         -&gt;  Seq Scan on tickets_list_201707 t_1<font></font>
         -&gt;  Hash<font></font>
               -&gt;  Seq Scan on bookings_list_201707 b_1<font></font>
   -&gt;  Hash Join<font></font>
         Hash Cond: ((t_2.book_ref = b_2.book_ref) AND (t_2.book_month = b_2.book_month))<font></font>
         -&gt;  Seq Scan on tickets_list_201708 t_2<font></font>
         -&gt;  Hash<font></font>
               -&gt;  Seq Scan on bookings_list_201708 b_2<font></font>
(16 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã“ã§ã€ã¾ãš2ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¯¾å¿œã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒçµåˆã•ã‚Œã€æ¬¡ã«çµåˆã®çµæœãŒçµåˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é›†ç´„ã«é–¢ã™ã‚‹åŒæ§˜ã®çŠ¶æ³ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) <span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> bookings_list;
</code></pre><pre><code class="plaintext hljs">                            QUERY PLAN                             <font></font>
-------------------------------------------------------------------<font></font>
 Finalize Aggregate<font></font>
   -&gt;  Gather<font></font>
         Workers Planned: 2<font></font>
         -&gt;  Partial Aggregate<font></font>
               -&gt;  Parallel Append<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201707<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201708<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201706<font></font>
(8 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ£ãƒ³ã¯ä¸¦è¡Œã—ã¦å®Ÿè¡Œã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">ã—ã‹ã—ã€æœ€åˆã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒé›†ã¾ã‚Šã€ãã‚Œã‹ã‚‰åˆã‚ã¦é›†ç´„ãŒå§‹ã¾ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã¯ã€å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§é›†è¨ˆã‚’å®Ÿè¡Œã—ã€çµæœã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SET</span> enable_partitionwise_aggregate = <span class="hljs-keyword">ON</span>;<font></font>
=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>) <span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> bookings_list;
</code></pre><pre><code class="plaintext hljs">                            QUERY PLAN                             <font></font>
-------------------------------------------------------------------<font></font>
 Finalize Aggregate<font></font>
   -&gt;  Gather<font></font>
         Workers Planned: 2<font></font>
         -&gt;  Parallel Append<font></font>
               -&gt;  Partial Aggregate<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201707<font></font>
               -&gt;  Partial Aggregate<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201708<font></font>
               -&gt;  Partial Aggregate<font></font>
                     -&gt;  Parallel Seq Scan on bookings_list_201706<font></font>
(10 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸€éƒ¨ãŒå¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã‚ã‚‹å ´åˆã€ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã¯ç‰¹ã«é‡è¦ã§ã™ã€‚</font><font style="vertical-align: inherit;">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ä¸¡æ–¹ã¨ã‚‚ç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">é–¢é€£ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ã€è¨ˆç”»ã®ä½œæˆã«ã‹ã‹ã‚‹æ™‚é–“ã«å½±éŸ¿ã—ã¾ã™ãŒã€å¸¸ã«ä½¿ç”¨ã•ã‚Œã‚‹ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒãƒƒã‚·ãƒ¥åˆ†å‰²</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆ†å‰²ã™ã‚‹3ç•ªç›®ã®æ–¹æ³•ã¯ã€ãƒãƒƒã‚·ãƒ¥åˆ†å‰²ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_hash (<font></font>
       book_ref     <span class="hljs-type">character</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
       book_date    <span class="hljs-type">timestamptz</span>  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<font></font>
       total_amount <span class="hljs-type">numeric</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)<font></font>
   ) <span class="hljs-keyword">PARTITION BY HASH</span>(book_ref);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®book_refã§ã¯ã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼ã¨ã—ã¦ã€ãã‚Œã‚’ä¸»ã‚­ãƒ¼ã¨ã—ã¦ã™ãã«å®£è¨€ã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†å‰²ã—ã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_hash_p0 
       <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_hash <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">WITH</span> (MODULUS <span class="hljs-number">3</span>, REMAINDER <span class="hljs-number">0</span>);<font></font>
=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_hash_p1 
       <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_hash <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">WITH</span> (MODULUS <span class="hljs-number">3</span>, REMAINDER <span class="hljs-number">1</span>);<font></font>
=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> bookings_hash_p2 
       <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> bookings_hash <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">WITH</span> (MODULUS <span class="hljs-number">3</span>, REMAINDER <span class="hljs-number">2</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è‡ªå‹•ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§åŸ‹ã‚ã‚‹ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> bookings_hash <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings;
</code></pre><pre><code class="plaintext hljs">INSERT 0 262788</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³å†…ã®ç·šã®åˆ†å¸ƒã¯å‡ç­‰ã«ç™ºç”Ÿã—ã¾ã™ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">partition</span>, count(*) <span class="hljs-keyword">FROM</span> bookings_hash <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> tableoid;
</code></pre><pre><code class="plaintext hljs">    partition     | count <font></font>
------------------+-------<font></font>
 bookings_hash_p0 | 87649<font></font>
 bookings_hash_p1 | 87651<font></font>
 bookings_hash_p2 | 87488<font></font>
(3 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ†å‰²ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¡¨ç¤ºã™ã‚‹æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; \dP+ 
</code></pre><pre><code class="plaintext hljs">                                      List of partitioned relations<font></font>
  Schema  |        Name        |  Owner  |       Type        |     Table      | Total size | Description <font></font>
----------+--------------------+---------+-------------------+----------------+------------+-------------<font></font>
 bookings | bookings_hash      | student | partitioned table |                | 13 MB      | <font></font>
 bookings | bookings_list      | student | partitioned table |                | 15 MB      | <font></font>
 bookings | bookings_range     | student | partitioned table |                | 13 MB      | <font></font>
 bookings | tickets_list       | student | partitioned table |                | 50 MB      | <font></font>
 bookings | book_date_idx      | student | partitioned index | bookings_range | 5872 kB    | <font></font>
 bookings | bookings_hash_pkey | student | partitioned index | bookings_hash  | 5800 kB    | <font></font>
 bookings | bookings_list_pkey | student | partitioned index | bookings_list  | 8120 kB    | <font></font>
 bookings | tickets_list_pkey  | student | partitioned index | tickets_list   | 19 MB      | <font></font>
(8 rows)<font></font>
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">VACUUM</span> <span class="hljs-keyword">ANALYZE</span> bookings_hash;
</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚µãƒ–ã‚¯ã‚¨ãƒªã¨ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ«ãƒ¼ãƒ—çµåˆ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®Ÿè¡Œæ™‚ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®é™¤å¤–ã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ«ãƒ¼ãƒ—æ¥ç¶šã§å¯èƒ½ã§ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æœ€åˆã®10ä»¶ã®äºˆç´„ã®åˆ†å¸ƒï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">WITH</span> top10 <span class="hljs-keyword">AS</span> (
     <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">partition</span>, * <span class="hljs-keyword">FROM</span> bookings_hash <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_ref <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>
   ) <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">partition</span>, count(*) <span class="hljs-keyword">FROM</span> top10 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>;
</code></pre><pre><code class="plaintext hljs">    partition     | count <font></font>
------------------+-------<font></font>
 bookings_hash_p0 |     3<font></font>
 bookings_hash_p1 |     3<font></font>
 bookings_hash_p2 |     4<font></font>
(3 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
bookings_hashãƒ†ãƒ¼ãƒ–ãƒ«ã¨å‰ã®ã‚µãƒ–ã‚¯ã‚¨ãƒªã‚’çµåˆã—ãŸã‚¯ã‚¨ãƒªå®Ÿè¡Œãƒ—ãƒ©ãƒ³ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>,<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>,<span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
     <span class="hljs-keyword">WITH</span> top10 <span class="hljs-keyword">AS</span> (
         <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">partition</span>, * <span class="hljs-keyword">FROM</span> bookings <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_ref <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>
   ) <span class="hljs-keyword">SELECT</span> bh.* <span class="hljs-keyword">FROM</span> bookings_hash bh <span class="hljs-keyword">JOIN</span> top10 <span class="hljs-keyword">ON</span> bh.book_ref = top10.book_ref;
</code></pre><pre><code class="plaintext hljs">                                             QUERY PLAN                                              <font></font>
-----------------------------------------------------------------------------------------------------<font></font>
 Nested Loop (actual rows=10 loops=1)<font></font>
   -&gt;  Limit (actual rows=10 loops=1)<font></font>
         -&gt;  Index Only Scan using bookings_pkey on bookings (actual rows=10 loops=1)<font></font>
               Heap Fetches: 0<font></font>
   -&gt;  Append (actual rows=1 loops=10)<font></font>
         -&gt;  Index Scan using bookings_hash_p0_pkey on bookings_hash_p0 bh (actual rows=1 loops=3)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p1_pkey on bookings_hash_p1 bh_1 (actual rows=1 loops=3)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p2_pkey on bookings_hash_p2 bh_2 (actual rows=1 loops=4)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
 Planning Time: 0.632 ms<font></font>
 Execution Time: 0.278 ms<font></font>
(13 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ç¶šã¯ã€ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ«ãƒ¼ãƒ—ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦è¡Œã‚ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ä¸€èˆ¬çš„ãªãƒ†ãƒ¼ãƒ–ãƒ«å¼ã«ã‚ˆã‚‹å¤–å´ã®ãƒ«ãƒ¼ãƒ—ã¯10å›å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã ã—ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆãƒ«ãƒ¼ãƒ—ï¼‰ã®å‘¼ã³å‡ºã—å›æ•°ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><font style="vertical-align: inherit;">å¤–éƒ¨ãƒ«ãƒ¼ãƒ—ã®å„book_refå€¤ã«ã¤ã„ã¦ã€ã“ã®å€¤ãŒbookings_hashãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ãŒã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¡åŠ¹ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®é™¤å¤–ã¨æ¯”è¼ƒã—ã¦ãã ã•ã„ï¼š</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">SET</span> enable_partition_pruning <span class="hljs-keyword">TO</span> <span class="hljs-keyword">OFF</span>;<font></font>
=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>,<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>,<span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
     <span class="hljs-keyword">WITH</span> top10 <span class="hljs-keyword">AS</span> (
         <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">partition</span>, * <span class="hljs-keyword">FROM</span> bookings <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_ref <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">10</span>
   ) <span class="hljs-keyword">SELECT</span> bh.* <span class="hljs-keyword">FROM</span> bookings_hash bh <span class="hljs-keyword">JOIN</span> top10 <span class="hljs-keyword">ON</span> bh.book_ref = top10.book_ref;
</code></pre><pre><code class="plaintext hljs">                                              QUERY PLAN                                              <font></font>
------------------------------------------------------------------------------------------------------<font></font>
 Nested Loop (actual rows=10 loops=1)<font></font>
   -&gt;  Limit (actual rows=10 loops=1)<font></font>
         -&gt;  Index Only Scan using bookings_pkey on bookings (actual rows=10 loops=1)<font></font>
               Heap Fetches: 0<font></font>
   -&gt;  Append (actual rows=1 loops=10)<font></font>
         -&gt;  Index Scan using bookings_hash_p0_pkey on bookings_hash_p0 bh (actual rows=0 loops=10)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p1_pkey on bookings_hash_p1 bh_1 (actual rows=0 loops=10)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p2_pkey on bookings_hash_p2 bh_2 (actual rows=0 loops=10)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
 Planning Time: 0.886 ms<font></font>
 Execution Time: 0.771 ms<font></font>
(13 rows)<font></font>
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">RESET</span> enable_partition_pruning;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é¸æŠã‚’1ã¤ã®äºˆç´„ã«æ¸›ã‚‰ã™ã¨ã€2ã¤ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã¾ã£ãŸãè¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>,<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>,<span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
     <span class="hljs-keyword">WITH</span> top <span class="hljs-keyword">AS</span> (
         <span class="hljs-keyword">SELECT</span> tableoid::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">partition</span>, * <span class="hljs-keyword">FROM</span> bookings <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> book_ref <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span>
   ) <span class="hljs-keyword">SELECT</span> bh.* <span class="hljs-keyword">FROM</span> bookings_hash bh <span class="hljs-keyword">JOIN</span> top <span class="hljs-keyword">ON</span> bh.book_ref = top.book_ref;
</code></pre><pre><code class="plaintext hljs">                                            QUERY PLAN                                             <font></font>
---------------------------------------------------------------------------------------------------<font></font>
 Nested Loop (actual rows=1 loops=1)<font></font>
   -&gt;  Limit (actual rows=1 loops=1)<font></font>
         -&gt;  Index Only Scan using bookings_pkey on bookings (actual rows=1 loops=1)<font></font>
               Heap Fetches: 0<font></font>
   -&gt;  Append (actual rows=1 loops=1)<font></font>
         -&gt;  Index Scan using bookings_hash_p0_pkey on bookings_hash_p0 bh (actual rows=1 loops=1)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p1_pkey on bookings_hash_p1 bh_1 (never executed)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p2_pkey on bookings_hash_p2 bh_2 (never executed)<font></font>
               Index Cond: (book_ref = bookings.book_ref)<font></font>
 Planning Time: 0.250 ms<font></font>
 Execution Time: 0.090 ms<font></font>
(13 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚µãƒ–ã‚¯ã‚¨ãƒªã®ä»£ã‚ã‚Šã«ã€å¤‰å‹•STABLEã®ã‚«ãƒ†ã‚´ãƒªã‚’æŒã¤ã‚»ãƒƒãƒˆã‚’è¿”ã™é–¢æ•°ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR REPLACE</span> <span class="hljs-keyword">FUNCTION</span> get_book_ref(top <span class="hljs-type">int</span>) <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">SETOF</span> bookings <span class="hljs-keyword">AS</span> $$<span class="pgsql">
       <span class="hljs-keyword">BEGIN</span>
           <span class="hljs-keyword">RETURN QUERY</span> <span class="hljs-keyword">EXECUTE</span> <span class="hljs-string">'SELECT * FROM bookings ORDER BY book_ref LIMIT $1'</span> 
                        <span class="hljs-keyword">USING</span> top;
       <span class="hljs-keyword">END</span>;$$</span> <span class="hljs-keyword">LANGUAGE</span> plpgsql <span class="hljs-keyword">STABLE</span>;
</code></pre><br>
<pre><code class="pgsql hljs">=&gt; <span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>,<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>,<span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
       <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> bookings_hash bh <span class="hljs-keyword">JOIN</span> get_book_ref(<span class="hljs-number">10</span>) f <span class="hljs-keyword">ON</span> bh.book_ref = f.book_ref;
</code></pre><pre><code class="plaintext hljs">                                             QUERY PLAN                                              <font></font>
-----------------------------------------------------------------------------------------------------<font></font>
 Nested Loop (actual rows=10 loops=1)<font></font>
   -&gt;  Function Scan on get_book_ref f (actual rows=10 loops=1)<font></font>
   -&gt;  Append (actual rows=1 loops=10)<font></font>
         -&gt;  Index Scan using bookings_hash_p0_pkey on bookings_hash_p0 bh (actual rows=1 loops=3)<font></font>
               Index Cond: (book_ref = f.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p1_pkey on bookings_hash_p1 bh_1 (actual rows=1 loops=3)<font></font>
               Index Cond: (book_ref = f.book_ref)<font></font>
         -&gt;  Index Scan using bookings_hash_p2_pkey on bookings_hash_p2 bh_2 (actual rows=1 loops=4)<font></font>
               Index Cond: (book_ref = f.book_ref)<font></font>
 Planning Time: 0.175 ms<font></font>
 Execution Time: 0.843 ms<font></font>
(11 rows)</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¦‚è¦</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ç´„ã™ã‚‹ã¨ã€PostgreSQL 12ã®çµ„ã¿è¾¼ã¿ã¾ãŸã¯å®£è¨€å‹ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã«ã¯è±Šå¯Œãªæ©Ÿèƒ½ã‚»ãƒƒãƒˆãŒã‚ã‚Šã€ç¶™æ‰¿ã«ã‚ˆã£ã¦ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã‚’ç½®ãæ›ãˆã‚‹ã“ã¨ã‚’å®‰å…¨ã«æ¨å¥¨ã§ãã¾ã™ã€‚</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja456700/index.html">GeekUniversityãŒè£½å“ç®¡ç†å­¦éƒ¨ã«æ¡ç”¨æƒ…å ±ã‚’å…¬é–‹</a></li>
<li><a href="../ja456704/index.html">ãƒ†ã‚¹ã‚¿ãƒ¼ãŒãƒ¡ãƒªãƒƒãƒˆã‚’äº«å—ã§ãã‚‹6ã¤ã®æ–¹æ³•ï¼ˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆä»¥å¤–ï¼‰</a></li>
<li><a href="../ja456710/index.html">ãƒ­ãƒ¼ã‚³ãƒ¼ãƒ‰/ã‚³ãƒ¼ãƒ‰ãªã—ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨CRMã€CRM +ã€ERPã¨ã¯</a></li>
<li><a href="../ja456712/index.html">SOAPã‚µãƒ¼ãƒ“ã‚¹ã®é¸æŠçš„ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ­ã‚®ãƒ³ã‚°</a></li>
<li><a href="../ja456714/index.html">æµ®å‹•å°æ•°ç‚¹æ•°ã«ã¤ã„ã¦ï¼ˆãƒ‘ãƒ¼ãƒˆ0ï¼‰</a></li>
<li><a href="../ja456722/index.html">PostgreSQLãƒ¬ã‚·ãƒ”ï¼šéåŒæœŸã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©</a></li>
<li><a href="../ja456724/index.html">VueJSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¤§å¹…ã«ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—ã™ã‚‹5ã¤ã®éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªæ–¹æ³•</a></li>
<li><a href="../ja456730/index.html">æœ¬ã€Œ{JSã®ã“ã¨ã¯ã‚ã‹ã‚‰ãªã„}ã®ã‚¿ã‚¤ãƒ—ã¨æ–‡æ³•æ§‹æ–‡ã€</a></li>
<li><a href="../ja456732/index.html">ãƒ¡ãƒ³ã‚¿ãƒ¼ã«ãªã‚‹</a></li>
<li><a href="../ja456736/index.html">PostgreSQLãƒ¬ã‚·ãƒ”ï¼šcURLï¼šå–å¾—ã€æŠ•ç¨¿ã€...ãƒ¡ãƒ¼ãƒ«</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>