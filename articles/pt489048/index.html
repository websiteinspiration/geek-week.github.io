<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öïÔ∏è üï¶ üßõ Log e rastreamento de consultas s√£o pr√°ticas recomendadas. Relat√≥rio Yandex üì© üë©üèΩ‚Äçüíº üåÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Yandex.Market possui uma grande arquitetura de microsservi√ßo. A solicita√ß√£o do navegador da p√°gina principal do Market gera dezenas de solicita√ß√µes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Log e rastreamento de consultas s√£o pr√°ticas recomendadas. Relat√≥rio Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/489048/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Yandex.Market possui uma grande arquitetura de microsservi√ßo. </font><font style="vertical-align: inherit;">A solicita√ß√£o do navegador da p√°gina principal do Market gera dezenas de solicita√ß√µes incorporadas em diferentes servi√ßos (back-end) desenvolvidos por pessoas diferentes. </font><font style="vertical-align: inherit;">Nesse sistema, pode ser dif√≠cil entender por que motivo a solicita√ß√£o caiu ou demorou muito tempo para processar.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_l1qP0DyBcA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anatoly Ostrovsky </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">megat√≥lia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">explica como sua equipe resolveu esse problema e compartilha pr√°ticas espec√≠ficas para o mercado, mas geralmente relevantes para qualquer √≥timo servi√ßo. Seu relat√≥rio √© baseado em sua pr√≥pria experi√™ncia de implantar um novo mercado em um tempo bastante curto. Por v√°rios anos, Tolya liderou a equipe de desenvolvimento de interfaces no mercado e agora mudou-se para a dire√ß√£o de ve√≠culos n√£o tripulados.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Todos os nossos mercados s√£o constru√≠dos de acordo com princ√≠pios gerais. Este √© um grande sistema √∫nico. Mas se falamos sobre o frontend, do ponto de vista do usu√°rio, os aplicativos s√£o completamente diferentes. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/cx/bk/xfcxbk6d4xsoxdb3l7clfzw5yza.jpeg"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao mesmo tempo, nossos frontends v√£o para muitos backends. √Äs vezes, esses back-end s√£o semelhantes entre si (inst√¢ncias diferentes do mesmo aplicativo). E, √†s vezes, eles s√£o exclusivos para o servi√ßo (cobran√ßa especial). A estrutura desse sistema pode ser considerada uma arquitetura cl√°ssica de microsservi√ßo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sempre h√° um problema em um servi√ßo grande - √© dif√≠cil entender o que exatamente est√° acontecendo nele. Ou, por exemplo, o que acontece no momento em que ocorre um erro de pagamento com o usu√°rio. Suponha que aconteceu ontem na casa dele e hoje precisamos entender o que aconteceu.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b3/nz/p2/b3nzp2buowpixe2wnv1-r-ymj7m.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O back-end 2 pode "queimar" para um produto espec√≠fico, ou em um hor√°rio espec√≠fico, ou para usu√°rios espec√≠ficos. Precisamos ser capazes de responder a qualquer situa√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pv/wu/-w/pvwu-wguspmalhce4hxtbvhqznu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos muitos back-ends e, como eu disse, eles podem andar por conta pr√≥pria. Se isso for apresentado na forma de um gr√°fico, ser√° bastante confuso. Na vida real, pode haver centenas de microsservi√ßos. Imagine quantas conex√µes haver√° entre eles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem muitas etapas para abordar esse t√≥pico. Vou falar brevemente sobre cada um deles.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/nf/hq/qunfhq8cdqgbtqtmikv0maf1tpc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antes de tudo, concorde com colegas do back-end em um sistema comum de marca√ß√£o de solicita√ß√µes - √© mais f√°cil encontr√°-los mais tarde. </font><font style="vertical-align: inherit;">Em seguida, voc√™ precisa poder reproduzir rapidamente o problema. </font><font style="vertical-align: inherit;">Suponha que ocorreu um erro de pagamento - tente entender rapidamente como isso aconteceu e em qual back-end. </font><font style="vertical-align: inherit;">Armazene logs n√£o apenas em arquivos, mas tamb√©m no banco de dados para que as agrega√ß√µes possam ser feitas. </font><font style="vertical-align: inherit;">E, √© claro, uma parte importante do processo s√£o gr√°ficos e monitoramento. </font><font style="vertical-align: inherit;">Em seguida, em ordem.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema de identifica√ß√£o de solicita√ß√£o unificada</font></font></h2><br>
<img src="https://habrastorage.org/webt/1z/lc/cl/1zlccllwyct_nesu28sa4kh0za0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa √© uma das ferramentas mais f√°ceis de entender o que est√° acontecendo com o servi√ßo. Concorde com os colegas que, por exemplo, seu front-end gera algum tipo de solicita√ß√£o de ID (a vari√°vel requestId na figura) e, em seguida, lan√ßa-o em todos os pontos de extremidade dos back-ends. E o back-end em si n√£o reinventa nada. Ele pega o requestId que chegou e o encaminha mais adiante nos pedidos aos seus back-ends. Ao mesmo tempo, ele pode especificar seu prefixo, para que, entre o requestId id√™ntico, seja poss√≠vel encontrar esse back-end espec√≠fico. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/qo/sk/ohqoskth2c-8o9h2btju58-tg04.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, quando voc√™ devora seus logs, certificando-se de que digam, por exemplo, que o back-end √© quinhentos, pode haver duas op√ß√µes. Voc√™ fornecer√° esse ID de solicita√ß√£o aos seus colegas e eles o examinar√£o nos registros deles ou voc√™ ver√° por si mesmo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/cf/1m/pqcf1m-t3srhcoorgfwnnpohbqg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os nossos logs s√£o marcados com esse ID, n√£o apenas para entender o que aconteceu e em que momento, mas tamb√©m para manter o contexto dessa solicita√ß√£o. </font><font style="vertical-align: inherit;">√â ass√≠ncrono; posteriormente, pode adicionar algo ao log. </font><font style="vertical-align: inherit;">E se voc√™ morder a requestId, nada de bom resultar√° disso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ondula√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para reproduzir o problema, usamos o utilit√°rio cURL. Este √© um utilit√°rio de console que faz solicita√ß√µes de rede - http e https. O cURL suporta muitos mais protocolos diferentes, mas ao fazer o desenvolvimento da Web, √© mais f√°cil assumir que essa √© uma ferramenta para trabalhar com solicita√ß√µes de http (s). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/75/mr/uh/75mruhc0hnm0q7qtllafjtnz8ak.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para se familiarizar com a equipe do cURL, voc√™ pode acessar qualquer site, acessar a Rede e copiar qualquer solicita√ß√£o no formato cURL. O resultado √© uma linha t√£o grande: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jl/mn/fx/jlmnfxdobmhcqctl-uviygpzij8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
se voc√™ tentar descobrir, n√£o h√° com o que se preocupar. Vamos tentar desmontar. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j5/88/xz/j588xz0r-jh48xp1rphfqoljlvk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° uma solicita√ß√£o para market.yandex.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gv/6v/_d/gv6v_dz188tviqfjs5siyf9lt8e.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um agente do usu√°rio foi adicionado aqui, o que j√° ocupa muito espa√ßo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1j/a_/sd/1ja_sdx_in4dcwudr64xjdezf98.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, o resto s√£o cookies. Existem muitos deles no c√≥digo Yandex. Na forma serializada, eles t√™m uma apar√™ncia muito formid√°vel. De fato, n√£o h√° mais nada al√©m deles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, para que √© √∫til o cURL? Se voc√™ o copiou e executou, viu a mesma p√°gina market.yandex.ru que eu fiz - apenas o computador em que estava sendo executado seria diferente. Certamente, alguns efeitos colaterais podem causar diferen√ßas nos endere√ßos IP, mas em geral eles seriam os mesmos pedidos. N√≥s reproduzir√≠amos o mesmo cen√°rio. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lh/gd/sg/lhgdsguqkolxs1vrjusxnshjnmg.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para n√£o inventar essas consultas cURL a cada vez, voc√™ pode usar o npm-package format-curl.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yj/in/fk/yjinfkjpv0bgzbhfmi8shr7qyno.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele recebe todos os par√¢metros de solicita√ß√£o que a fun√ß√£o normalmente aceita - ou seja, neste caso, apenas cabe√ßalhos e URL. </font><font style="vertical-align: inherit;">Mas ele tamb√©m sabe como consultar, corpo, etc. E a sa√≠da √© apenas uma string com uma solicita√ß√£o cURL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xx/4l/h8/xx4lh8tvvwmvzw1-aflbg7ophvq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, todos os nossos logs no ambiente de desenvolvimento tamb√©m cont√™m solicita√ß√µes cURL. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wu/iq/f6/wuiqf6p5bzxdgiom430q364yuw4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© registramos solicita√ß√µes cURL de back-end diretamente no navegador para ver imediatamente como acessamos nossos back-end sem olhar para o console do navegador. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0o/l3/ay/0ol3ay03w7toau9tyabduyiu1-m.jpeg"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que as solicita√ß√µes cURL envolvem a transfer√™ncia de cookies de sess√£o - isso √© ruim. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ me recusou a solicita√ß√£o cURL em market.yandex.ru, eu poderia entrar no Market e em qualquer outro servi√ßo Yandex no seu login. </font><font style="vertical-align: inherit;">Portanto, n√£o armazenamos essas solicita√ß√µes em nenhum lugar e as registramos apenas em bancos de teste para n√≥s mesmos - esses dados n√£o podem ser vazados.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clickhouse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, falarei sobre logs estruturados. Aqui, lembrarei do banco de dados ClickHouse espec√≠fico, mas voc√™ pode escolher qualquer. O ClickHouse √© um DBMS colunar, √© mais conveniente selecionar entre uma enorme quantidade de dados e receber grandes quantidades de dados. √â bom que voc√™ salve uma grande parte do log e depois, por exemplo, fa√ßa algum tipo de agrega√ß√£o de um bilh√£o de registros. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rx/yq/hx/rxyqhxvdpvjetfh9jmkw4hfkwvu.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesse caso, o exemplo de sele√ß√£o ClickHouse √© SQL simples. Aqui, mostramos o n√∫mero de solicita√ß√µes de c√≥digos de status para hoje. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oi/5v/je/oi5vje-sgh204x5-w1fjywdjyk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, teremos 180 mil duzentos e setecentos e os demais c√≥digos de status, por exemplo, n√£o s√£o interessantes para n√≥s. Mas como podemos usar isso de maneira interessante?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ed/r6/gp/edr6gpqetfffuhjo6uc2hwznb4s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos dizer que a propor√ß√£o de duzentos e a propor√ß√£o do n√∫mero total de respostas √© o Indicador de N√≠vel de Servi√ßo, que responde √† pergunta de qu√£o bem nosso aplicativo funciona em termos de c√≥digos de status. Embora simples, ele j√° est√° falando sobre algo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/y3/vr/vq/y3vrvqez5ghx9umed2htpzgeurm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com base em nosso indicador, podemos criar o primeiro SLI, ou seja, por exemplo, que 99% de nossas solicita√ß√µes devem ser aceit√°veis. E aqui podemos comparar que realizamos nosso SLI. Se eles n√£o tivessem conclu√≠do, poder√≠amos ter tentado fazer alguns dos √∫ltimos pedidos que seriam quinhentos ou simplesmente coisas cr√≠ticas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hf/0i/vf/hf0ivf6posnoebmrwayqz4wni5c.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, erros de pagamento s√£o cr√≠ticos para n√≥s, mas, neste caso, eles retornar√£o zero - √© uma sorte :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5c/0i/yh/5c0iyhrkfdxbgd0psywb7jvv8si.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como voc√™ pode fazer seus logs de uma forma t√£o conveniente e que eles podem ser obtidos via SQL?</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7b/7m/hx/7b7mhxhtlyos6qbomnnm2p6xcko.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um t√≥pico para outro grande relat√≥rio e tudo depende da sua infraestrutura. </font><font style="vertical-align: inherit;">Mas parece que existem duas maneiras. </font><font style="vertical-align: inherit;">Primeiro: envie os metadados diretamente para o tempo de execu√ß√£o, diretamente no banco de dados. </font><font style="vertical-align: inherit;">Fazemos isso de maneira diferente, da segunda maneira: seguimos o arquivo de log e enviamos peda√ßos no banco de dados ou em um local intermedi√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso funciona para n√≥s em v√°rias camadas - enviamos logs de uma inst√¢ncia espec√≠fica para um servidor de armazenamento remoto desses logs.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solicitar rastreamento</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o h√° conceito de "rastreamento de consulta". Este termo foi cunhado pelo Google. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/au/mc/cf/aumccfspkkp7eieqgesgk8awnn4.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ pesquisar na Internet por "rastreamento de consulta", ver√° o comando traceroute. Talvez isso seja semelhante ao rastreamento de consultas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w0/no/pv/w0nopvgiuihtlc2x8b7fdist7lm.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existe at√© um programa de console, e aqui eu o executei para o site bringly.ru (um servi√ßo que desenvolvemos na primavera passada). Ajuda a entender que tipo de m√°quinas e servidores a solicita√ß√£o passa antes de chegar ao balanceador, que responder√° com o layout ou com outra coisa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9g/n9/ax/9gn9axljm2rabdxvowa3p8gsjec.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° o nosso balanceador. Por rastreamento de consulta, n√£o queremos dizer isso, mas tudo o que acontece dentro do nosso balanceador - como a solicita√ß√£o permanece mais dentro do aplicativo node.js.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fh/rh/rr/fhrhrr6j0ujdnvdivmn0dwobnlc.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos isso na forma de uma linha do tempo, onde o tempo horizontal √© exibido e a sequ√™ncia vertical de solicita√ß√µes. Nesse caso, temos uma solicita√ß√£o para o cart√£o do produto, onde √© poss√≠vel ver que essa √© uma solicita√ß√£o para o back-end de nossa autoriza√ß√£o. Ap√≥s sua decis√£o, tr√™s longas filas foram - este √© um pedido ao nosso principal back-end para uma cesta, cart√£o de produto e produtos similares. Ent√£o, temos um rastro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/m8/sl/4a/m8sl4atplnknyq_5wefl8b2wgw0.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui voc√™ v√™ o mesmo pedido de autoriza√ß√£o e, em seguida, o back-end foi. Nesse caso, o back-end n√£o se comporta de maneira ideal, porque possui muitas consultas consecutivas no banco de dados. Provavelmente, essa consulta pode ser otimizada.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ru/ah/bz/ruahbzfg8qzvgzi1s2gbexvm0og.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E aqui est√° um exemplo de rastreamento, quando n√£o acessamos nenhum back-end, mas imediatamente fornecemos o status 500. Como esse rastreamento √© √∫til para n√≥s? </font><font style="vertical-align: inherit;">N√£o precisamos incomodar colegas. </font><font style="vertical-align: inherit;">Temos o ID dessa solicita√ß√£o, para que possamos procurar nos logs e descobrir o que est√° acontecendo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wq/nm/0g/wqnm0gw9rgznoe7rswqshty_u1a.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° a situa√ß√£o oposta. </font><font style="vertical-align: inherit;">Backend disse que algo estava errado e, ao mesmo tempo, escreveu na meta-informa√ß√£o o que exatamente aconteceu - algum tipo de rastreamento de pilha apareceu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/uc/lb/ck/uclbck5ju2ri2l2qyhjxkwnvxpk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como se tornar a mesma ferramenta? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A coisa mais importante aqui √© o banco de dados. </font><font style="vertical-align: inherit;">Se voc√™ tiver o "INSERT INTO" mais simples no banco de dados de algumas a√ß√µes com o servi√ßo, mais tarde poder√° pelo menos usar o SQL para encontrar os eventos necess√°rios. </font><font style="vertical-align: inherit;">E, se necess√°rio, voc√™ pode fazer uma interface para isso.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gr√°ficos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© um t√≥pico muito interessante, n√£o vou me aprofundar em detalhes hoje, √© claro, :) </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mo/tc/5p/motc5p8irltrzn7aqlsffemkdza.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos falar sobre o log. </font><font style="vertical-align: inherit;">Temos muitos gr√°ficos, olhamos para eles quando lan√ßamos algo - e nos intervalos h√° tanto barulho. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/vn/ku/lovnkuij1s2d39nszmdwvwsde78.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os gr√°ficos ajudam a ver visualmente que algo est√° errado. </font><font style="vertical-align: inherit;">E ent√£o voc√™ ainda precisa examinar os logs e entender o que h√° de errado com eles. </font><font style="vertical-align: inherit;">Nesse caso, o aumento imediatamente ap√≥s a libera√ß√£o significa pelo menos que essa libera√ß√£o precisa ser revertida imediatamente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Monitoramento</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma parte ainda mais importante e um maior grau de imers√£o neste t√≥pico √© o monitoramento. Ao monitorar, entendo, em primeiro lugar, o monitoramento autom√°tico de gr√°ficos e, em segundo lugar, quaisquer regras automatizadas para monitorar algo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wn/1f/r9/wn1fr9r0fnzl-r4kbkgbj3pwz6w.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Monitoramos a propor√ß√£o de quinhentos em rela√ß√£o ao n√∫mero total de respostas por minuto. Tamb√©m monitoramos quatrocentos, a presen√ßa de uma carga no servi√ßo, verificando o bot√£o de verifica√ß√£o de integridade, que puxa o bot√£o de ping de cada um dos back-ends, etc.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/be/ts/j0betsujurv192dkwhrvk_cvegk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, temos pain√©is de monitoramento que inclu√≠mos nas telas pr√≥ximas √†s esta√ß√µes de trabalho. </font><font style="vertical-align: inherit;">Ent√£o, imediatamente vemos qual dos monitoramentos "cora". </font><font style="vertical-align: inherit;">Por exemplo, aqui √© um dos principais, onde o front-end e nosso back-end principal s√£o vis√≠veis. </font><font style="vertical-align: inherit;">Aqui voc√™ pode ver que algum monitoramento acende no back-end. </font><font style="vertical-align: inherit;">Isso significa que, naquele momento, a pessoa respons√°vel por esse servi√ßo receber√° uma mensagem no Telegram, ou talvez at√© ligue para ele - isso depende das configura√ß√µes de monitoramento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um √∫nico requestId ajudar√° voc√™ a encontrar problemas com mais facilidade em um servi√ßo que consiste em v√°rios aplicativos. </font><font style="vertical-align: inherit;">A cURL correta permitir√° reproduzir com mais precis√£o os problemas e ver como voc√™ mesmo, por exemplo, envia dados para o back-end. </font><font style="vertical-align: inherit;">Os logs estruturados permitem criar o SLI e s√£o mais convenientes do que os logs de texto comuns. </font><font style="vertical-align: inherit;">E n√£o esque√ßa de seguir os gr√°ficos e realizar o monitoramento. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu recomendo a leitura </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do livro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Engenharia de confiabilidade </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">do</font></a><font style="vertical-align: inherit;"> site do Google, se voc√™ estiver interessado em assuntos de infraestrutura.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt489038/index.html">O livro "Concorr√™ncia Java na Pr√°tica"</a></li>
<li><a href="../pt489040/index.html">AI do Contact Center: boa conversa com terceiros</a></li>
<li><a href="../pt489042/index.html">Grande reabertura da loja: carregamento de dados no Android usando corotina</a></li>
<li><a href="../pt489044/index.html">F√≠sica do texto. Parte 1. S√≠mbolos</a></li>
<li><a href="../pt489046/index.html">Monster Truck GAZ66 aut√¥nomo 1/16</a></li>
<li><a href="../pt489050/index.html">Windows vs Sysmon</a></li>
<li><a href="../pt489058/index.html">Conjuntos de redes neurais com PyTorch e Sklearn</a></li>
<li><a href="../pt489060/index.html">An√°lise: qual a diferen√ßa entre investimentos de alto e baixo risco</a></li>
<li><a href="../pt489062/index.html">Incr√≠vel desempenho paralelo de E / S do Apache Parquet em Python</a></li>
<li><a href="../pt489068/index.html">Imortalidade digital - uma abordagem de engenharia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>