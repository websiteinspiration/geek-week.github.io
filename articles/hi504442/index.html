<!doctype html>
<html class="no-js" lang="hi">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯев ЁЯФЯ ЁЯд╢ЁЯП┐ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ ЁЯСйЁЯП╜тАНЁЯдЭтАНЁЯСиЁЯП╗ тЬ│я╕П ЁЯФХ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рдо рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░реЗрдВрдЧреЗ - рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдХреЗ рд╕реНрдерд╛рди рдореЗрдВ рдПрдХ рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ, рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдбрд╛рд▓реЗрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред рдРрд╕рд╛ рдХрд░рдиреЗ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/504442/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рдо рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░реЗрдВрдЧреЗ - рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рдХреЗ рд╕реНрдерд╛рди рдореЗрдВ рдПрдХ рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ, рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдбрд╛рд▓реЗрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рдореЗрдВ рд╣рдо рдлрд╝рдВрдХреНрд╢рди рдлреВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХреА рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рдПрдЧрд╛, рдлрд┐рд░, рдореЙрдбреНрдпреВрд▓_alloc рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ, рдкреВрд░реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдореЗрдорд╕реАрдкреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рдг рджреЗрдВред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдБ рдпрд╣ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ:</font></font><br>
<a name="habracut"></a><br>
<pre><code class="plaintext hljs">static noinline int foo(int ret)<font></font>
{<font></font>
	return (ret + 2);<font></font>
}<font></font>
<font></font>
static int exe_init(void)<font></font>
{<font></font>
	int ret = 0;<font></font>
	int (*new_foo)(int);<font></font>
<font></font>
	ret = foo(0);<font></font>
	printk(KERN_INFO "ret=%d\n", ret);<font></font>
<font></font>
	new_foo = module_alloc(PAGE_SIZE);<font></font>
	set_memory_x((unsigned long)new_foo, 1);<font></font>
<font></font>
	printk(KERN_INFO "foo=%lx new_foo=%lx\n",<font></font>
		(unsigned long)foo, (unsigned long)new_foo);<font></font>
<font></font>
	memcpy((void *)new_foo, (const void *)foo, PAGE_SIZE);<font></font>
<font></font>
	ret = new_foo(1);<font></font>
	printk(KERN_INFO "ret=%d\n", ret);<font></font>
<font></font>
	vfree(new_foo);<font></font>
	return 0;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рдореЙрдбреНрдпреВрд▓ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ exe_init рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╣рдо рдХрд░реНрдиреЗрд▓ рд▓реЙрдЧ рдореЗрдВ рдХрд╛рдо рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">[ 6972.522422] ret=2<font></font>
[ 6972.522443] foo=ffffffffc0000000 new_foo=ffffffffc0007000<font></font>
[ 6972.522457] ret=3<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдм рдХреБрдЫ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдФрд░ рдЕрдм рд╣рдо рддрд░реНрдХ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП foo рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">static noinline int foo(int ret)<font></font>
{<font></font>
	printk(KERN_INFO "ret=%d\n", ret);<font></font>
	return (ret + 2);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЗрд╕реЗ рдкрд╛рд╕ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ new_foo () рдлрд╝рдВрдХреНрд╢рди рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ 25 рдмрд╛рдЗрдЯреНрд╕ рдбрдВрдк рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">	memcpy((void *)new_foo, (const void *)foo, PAGE_SIZE);<font></font>
	dump((unsigned long)new_foo);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдбрдВрдк рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</font></font><br>
<br>
<pre><code class="plaintext hljs">static inline void dump(unsigned long x)<font></font>
{<font></font>
	int i;<font></font>
	for (i = 0; i &lt; 25; i++) \<font></font>
		pr_cont("%.2x ", *((unsigned char *)(x) + i) &amp; 0xFF); \<font></font>
	pr_cont("\n");<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдореЙрдбреНрдпреВрд▓ рдХреЛ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд▓реЙрдЧ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрджреЗрд╢ рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд░реНрдШрдЯрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">[ 8482.806092] ret=0<font></font>
[ 8482.806092] ret=2<font></font>
[ 8482.806111] foo=ffffffffc0000000 new_foo=ffffffffc0007000<font></font>
[ 8482.806113] 53 89 fe 89 fb 48 c7 c7 24 10 00 c0 e8 e8 3d 0b c1 8d 43 02 5b c3 66 2e 0f <font></font>
[ 8482.806135] invalid opcode: 0000 [#1] SMP NOPTI<font></font>
[ 8482.806639] CPU: 0 PID: 5081 Comm: insmod Tainted: G           O      5.4.27 #12<font></font>
[ 8482.807669] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBox 12/01/2006<font></font>
[ 8482.808560] RIP: 0010:irq_create_direct_mapping+0x79/0x90<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХрд┐рд╕реА рддрд░рд╣, рд╣рдо irq_create_direct_mapping рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдП, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдореЗрдВ рдкреНрд░рд┐рдВрдЯрдХ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдерд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдХреНрдпрд╛ рд╣реБрдЖред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдлреВ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрд╕рдВрддреБрд╖реНрдЯ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред </font><font style="vertical-align: inherit;">рдЗрд╕реЗ objdump -d рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">Disassembly of section .text:<font></font>
<font></font>
0000000000000000 &lt;foo&gt;:<font></font>
   0:	53                   	push   %rbx<font></font>
   1:	89 fe                	mov    %edi,%esi<font></font>
   3:	89 fb                	mov    %edi,%ebx<font></font>
   5:	48 c7 c7 00 00 00 00 	mov    $0x0,%rdi<font></font>
   c:	e8 00 00 00 00       	callq  11 &lt;foo+0x11&gt;<font></font>
  11:	8d 43 02             	lea    0x2(%rbx),%eax<font></font>
  14:	5b                   	pop    %rbx<font></font>
  15:	c3                   	retq   <font></font>
  16:	66 2e 0f 1f 84 00 00 	nopw   %cs:0x0(%rax,%rax,1)<font></font>
  1d:	00 00 00 <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлреВ рдлрд╝рдВрдХреНрд╢рди рдкрд╛рда рдЕрдиреБрднрд╛рдЧ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдСрдлрд╝рд╕реЗрдЯ 0xC рдкрд░, рдкрд╛рд╕ рдХреЙрд▓ рдХрдорд╛рдВрдб e8 рдХрд╛ opcode рд╕реНрдерд┐рдд рд╣реИ - рдирд┐рдХрдЯ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рд╡рд░реНрддрдорд╛рди рдХреЛрдб рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЪрдпрдирдХрд░реНрддрд╛ рдорд╛рди рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИред рдЕрдЧрд▓реЗ 4 рдмрд╛рдЗрдЯреНрд╕ рдЖрд░рдЖрдИрдкреА рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдореВрд▓реНрдп рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдСрдлрд╕реЗрдЯ рд╣реИрдВ, рдЬрд┐рд╕ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЕрд░реНрдерд╛рддред RIP = RIP + рдСрдлрд╕реЗрдЯ, Intel рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг (Intel 64 рдФрд░ IA-32 рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдбреЗрд╡рд▓рдкрд░ рдХреЗ рдореИрдиреБрдЕрд▓, рдирд┐рд░реНрджреЗрд╢ рд╕реЗрдЯ рд╕рдВрджрд░реНрдн AZ) рдХреЗ рдЕрдиреБрд╕рд╛рд░:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд░рд┐рд╢реНрддреЗрджрд╛рд░ рдСрдлрд╕реЗрдЯ (rel16 рдпрд╛ rel32) рдЖрдо рддреМрд░ рдкрд░ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдХреЛрдб рдореЗрдВ рдПрдХ рд▓реЗрдмрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдорд╢реАрди рдХреЛрдб рд╕реНрддрд░ рдкрд░, рдпрд╣ рдПрдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд, 16- рдпрд╛ 32-рдмрд┐рдЯ рддрддреНрдХрд╛рд▓ рдореВрд▓реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдПрдиреНрдХреЛрдбреЗрдб рд╣реИред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдорд╛рди EIP (RIP) рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдорд╛рди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">64-рдмрд┐рдЯ рдореЛрдб рдореЗрдВ рд╕рд╛рдкреЗрдХреНрд╖ рдСрдлрд╝рд╕реЗрдЯ рд╣рдореЗрд╢рд╛ рдПрдХ 32-рдмрд┐рдЯ рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рдорд╛рди рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рд▓рдХреНрд╖реНрдп рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП RIP рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдореВрд▓реНрдп рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ 64-рдмрд┐рдЯ рддрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рдлрд╝рдВрдХреНрд╢рди рдлреВ рдХрд╛ рдкрддрд╛ рдЬрд╛рдирддреЗ рд╣реИрдВ, рдпрд╣ 0xffffffffc0000000 рд╣реИ, рдЗрд╕рд▓рд┐рдП RIP = 0xffffffcc0000000 + 0xc + 0x5 = 0xffffffffc00000011 (0xc, e8 рдирд┐рд░реНрджреЗрд╢ рдкрд░ рдСрдлрд╝рд╕реЗрдЯ рд╣реИ, рдирд┐рд░реНрджреЗрд╢ рдХреЗ 1 рдмрд╛рдЗрдЯ рдФрд░ рдСрдлрд╝рд╕реЗрдЯ рдСрдлрд╝ 4 рдмрд╛рдЗрдЯреНрд╕)ред </font><font style="vertical-align: inherit;">рд╣рдо рдСрдлрд╕реЗрдЯ рдЬрд╛рдирддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ </font><font style="vertical-align: inherit;">рд╢рд░реАрд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдмрд╛рдзрд╛ред </font><font style="vertical-align: inherit;">рдЖрдЗрдП рдЧрдгрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдлрдВрдХреНрд╢рди рдлреВ рдореЗрдВ рд╣рдореЗрдВ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд╣рд╛рдВ рднреЗрдЬреЗрдЧрд╛:</font></font><br>
<br>
<pre><code class="plaintext hljs">0xffffffffc00000011 + 0xffffffffc10b3de8 = 0xffffffff810b3df9
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рдкреНрд░рд┐рдВрдЯ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд╣реИ:</font></font><br>
<pre><code class="plaintext hljs"># cat /proc/kallsyms | grep ffffffff810b3df9  <font></font>
ffffffff810b3df9 T printk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдЕрдм рд╡рд╣реА new_foo рдХреЗ рд▓рд┐рдП рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдкрддрд╛ 0xffffffcc0007000 рд╣реИ</font></font><br>
<br>
<pre><code class="plaintext hljs">0xffffffffc0007011 + 0xffffffffc10b3de8 = 0xffffffff810badf9
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдХреЙрд▓реНрд╕ рдЬрд┐рдо рдореЗрдВ рдРрд╕рд╛ рдХреЛрдИ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди 0xffffffff810badf9 рд╣реИ - 0x79 = 0xffffffff810bad80</font></font><br>
<pre><code class="plaintext hljs"># cat /proc/kallsyms | grep ffffffff810bad80<font></font>
ffffffff810bad80 T irq_create_direct_mapping<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╡рд╣реА рдХрд╛рд░реНрдп рд╣реИ рдЬрд┐рд╕ рдкрд░ рджреБрд░реНрдШрдЯрдирд╛ рд╣реБрдИ рдереАред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рджреБрд░реНрдШрдЯрдирд╛ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдирдП_рдлреВ рдлрдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЛ рдЬрд╛рдирдХрд░, рдСрдлрд╕реЗрдЯ рдХреЛ рдкреБрдирд░реНрдЧрдгрдирд╛ рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">memcpy((void *)new_foo, (const void *)foo, PAGE_SIZE);<font></font>
unsigned int delta = (unsigned long)printk - (unsigned long)new_foo - 0x11;<font></font>
*(unsigned int *)((void *)new_foo + 0xD) = delta;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕реБрдзрд╛рд░ рдХреЗ рдмрд╛рдж, рдХреЛрдИ рджреБрд░реНрдШрдЯрдирд╛ рдирд╣реАрдВ рд╣реЛрдЧреА, new_foo рдлрд╝рдВрдХреНрд╢рди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдФрд░ рдирд┐рдпрдВрддреНрд░рдг рд╡рд╛рдкрд╕ рдХрд░реЗрдЧрд╛ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдорд╕реНрдпрд╛ рд╕реБрд▓рдЭ рдЧрдИ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдХреЗрд╡рд▓ рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИ рдХрд┐ рдИ 8 рдУрдкрдХреЛрдб рд╢реВрдиреНрдп рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдСрдлрд╕реЗрдЯ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдбрд┐рд╕реНрд╕реЗрдореНрдмрд▓рд░ рдореЗрдВ рдХреНрдпреЛрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдбрдВрдк рдореЗрдВ рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рдирд╣реАрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреНрдпрд╛ рд╣реИрдВ рдФрд░ рдХрд░реНрдиреЗрд▓ рдЙрдирдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ, рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдИрдПрд▓рдПрдл рдХрд╛ рдЕрд░реНрде рд╣реИ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдкреНрд░рд╛рд░реВрдк - рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рд╕рдВрдпреЛрдЬрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдкреНрд░рд╛рд░реВрдкред рдПрдХ рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рд╡рд░реНрдЧреЛрдВ рдХрд╛ рдПрдХ рд╕рдВрдЧреНрд░рд╣ рд╣реИред рдЕрдиреБрднрд╛рдЧ рд▓рд┐рдВрдХрд░ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдЫрд╡рд┐ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ - рдирд┐рд░реНрджреЗрд╢, рдбреЗрдЯрд╛, рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛рдУрдВ, рд░рд┐рд▓реЗрд╢рдВрд╕ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдЖрджрд┐ред рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрднрд╛рдЧ рдХрд╛ рд╢реАрд░реНрд╖рдХ рджреНрд╡рд╛рд░рд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╕рднреА рд╣реЗрдбрд░ рдХреЛ рд╣реЗрдбрд░ рдХреА рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдПрдХ рд╕рд░рдгреА рд╣реЛрддреА рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХрд╛ рдПрдХ рдЗрдВрдбреЗрдХреНрд╕ рд╣реЛрддрд╛ рд╣реИред рд╕реЗрдХреНрд╢рди рд╣реЗрдбрд░ рдореЗрдВ рд╕реЗрдХреНрд╢рди рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдиреНрдп рдУрд╡рд░рд╣реЗрдб рд╕реВрдЪрдирд╛рдУрдВ рдХреА рднрд░рдкрд╛рдИ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рд╣реЗрдбрд░ рдЯреЗрдмрд▓ рдореЗрдВ рдХрд┐рд╕реА рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдЕрдиреНрдп рд╕реЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдВрдХред</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рд╣рдорд╛рд░реЗ рдкрд░реАрдХреНрд╖рдг рдорд╛рдорд▓реЗ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрдХрд▓рдХ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреЙрд▓ рд╕реНрдерд╛рди рдХреЛ рд╢реВрдиреНрдп рдорд╛рди рд╕реЗ рднрд░рддрд╛ рд╣реИ рдФрд░, рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдХрд░реНрдиреЗрд▓ рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕реНрдерд┐рддрд┐ рдПрдХ рд╡реИрдз рдорд╛рди рд╕реЗ рднрд░реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред рдПрдХ рд░рд┐рд▓реЛрдХреЗрд╢рди рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдСрдлрд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдЖрдк рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ (рд░рд┐рд▓реЛрдХреЗрд╢рди рдкреЛрдЬрд╝рд┐рд╢рди), рд░рд┐рд▓реЛрдХреЗрд╢рди рдХрд╛ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╕рд┐рдВрдмрд▓ рдЯреЗрдмрд▓ рдореЗрдВ рд╕рд┐рдВрдмрд▓ рдХрд╛ рдЗрдВрдбреЗрдХреНрд╕, рдЬрд┐рд╕рдХрд╛ рдкрддрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдСрдлрд╝рд╕реЗрдЯ рдореЗрдВ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╣реИ? рд╣рдо рдиреАрдЪреЗ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред рд░рд┐рд▓реЛрдХреЗрд╢рди рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЗ рд╕реЗрдХреНрд╢рди рдХрд╛ рд╢реАрд░реНрд╖рдХ рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрдХреНрд╢рди рдХреЗ рд╣реЗрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрдХреНрд╢рди рдФрд░ рдХреИрд░реЗрдХреНрдЯрд░ рдХреЗ рдЯреЗрдмрд▓ рдХреЗ рд╕рд╛рде рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд░рд┐рд▓реЗрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдСрдлрд╕реЗрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдк -r рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рд╛рде objdump рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд░рд┐рдХреЙрд░реНрдб рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрд╕рдВрддреБрд╖реНрдЯ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рд╕реЗ, рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдСрдлрд╕реЗрдЯ 0xD рдкрд░ рдкреНрд░рд┐рдВрдЯрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рд┐рдЦрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдирд┐рдореНрди рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде objdump рдЖрдЙрдЯрдкреБрдЯ рдХреА рддрд▓рд╛рд╢ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">000000000000000d R_X86_64_PC32     printk-0x0000000000000004
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреЛ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдСрдлрд╕реЗрдЯ 0xD рдкрд░ рд╕реНрдерд┐рддрд┐ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЖрд╡рд╢реНрдпрдХ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд░рд┐рдХреЙрд░реНрдб рд╣реИ, рдФрд░ рдкреНрд░рддреАрдХ рдХрд╛ рдирд╛рдо рдЬрд┐рд╕рдХрд╛ рдкрддрд╛ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рд▓рд┐рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдорд╛рди (-4)ред </font><font style="vertical-align: inherit;">рдЬрд┐рд╕реЗ рдкреНрд░рд┐рдВрдЯрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреЛ рдкрд░рд┐рд╢рд┐рд╖реНрдЯ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рдкреНрд░рд┐рдВрдЯ рдкреНрд░рддреАрдХ рдХреЛ рджреЗрдЦреЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ objdump -t exe.ko | grep printk<font></font>
0000000000000000         *UND*	0000000000000000 printk<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдПрдХ рдкреНрд░рддреАрдХ рд╣реИ, рдпрд╣ рдореЙрдбреНрдпреВрд▓ (рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд) рдХреЗ рдЕрдВрджрд░ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рдЦреЛрдЬ рдХрд░реЗрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдмрд╛рдЗрдирд░реА рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдФрд░ рдкреНрд░рддреАрдХреЛрдВ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдХреЛ рджреЗрдЦрдирд╛ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАрдкреВрд░реНрдг рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдпрд╣ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╣рдорд╛рд░реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ (рд░рд╛рдЗрдЯрд░реНрд╕ рд╕реЗ рдХреЙрдкреА рдкреЗрд╕реНрдЯ, рдмрд╛рдИрдВ рдУрд░ рдПрд▓рдПрд╕рдмреА) рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">  0d 00 00 00 00 00 00 00  02 00 00 00 22 00 00 00  fc ff ff ff ff ff ff ff<font></font>
  |                     |  |          ||         |  |                     |<font></font>
  +----  -------+  +--  ---++---+  +---- addendum  ------+<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреА рддреБрд▓рдирд╛ рдЗрд╕реА рд╕рдВрд░рдЪрдирд╛ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рд╕реЗ рдХрд░реЗрдВ &lt;linux / elf.h&gt;:</font></font><br>
<br>
<pre><code class="plaintext hljs">typedef struct elf64_rela {<font></font>
  Elf64_Addr r_offset;	/* Location at which to apply the action */<font></font>
  Elf64_Xword r_info;	/* index and type of relocation */<font></font>
  Elf64_Sxword r_addend;	/* Constant addend used to compute value */<font></font>
} Elf64_Rela;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣рд╛рдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 8 рдмрд╛рдЗрдЯреНрд╕ рд╣реИрдВ 0x00000000d, 4 рдмрд╛рдЗрдЯреНрд╕ рдЯрд╛рдЗрдк рдХрд░реЗрдВ 0x00000002, рдХреИрд░реЗрдХреНрдЯрд░ рдЯреЗрдмрд▓ 0x00000022 (рдпрд╛ рджрд╢рдорд▓рд╡ рдореЗрдВ 34) рдФрд░ 8 рдмрд╛рдЗрдЯреНрд╕ рдкрд░рд┐рд╢рд┐рд╖реНрдЯ -4 рдореЗрдВ 4 рдмрд╛рдЗрдЯреНрд╕ рдЗрдВрдбреЗрдХреНрд╕ред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рдпрд╣рд╛рдБ 34 рдирдВрдмрд░ рдкрд░ рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ рд╕реЗ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">  01 01 00 00 10 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрд░рдЪрдирд╛</font></font><br>
<br>
<pre><code class="plaintext hljs">typedef struct elf64_sym {<font></font>
  Elf64_Word st_name;		/* Symbol name, index in string tbl */<font></font>
  unsigned char	st_info;	/* Type and binding attributes */<font></font>
  unsigned char	st_other;	/* No defined meaning, 0 */<font></font>
  Elf64_Half st_shndx;		/* Associated section index */<font></font>
  Elf64_Addr st_value;		/* Value of the symbol */<font></font>
  Elf64_Xword st_size;		/* Associated symbol size */<font></font>
} Elf64_Sym;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╣рд▓реЗ 4 рдмрд╛рдЗрдЯреНрд╕ 0x00000101 рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИред рдЗрд╕ рдЪрд░рд┐рддреНрд░ рдХреЗ рдирд╛рдо рдХреЗ рд▓рд┐рдПред printkред St_info рдлрд╝реАрд▓реНрдб рдкреНрд░рддреАрдХ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдПрдХ рдлрд╝рдВрдХреНрд╢рди, рдбреЗрдЯрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рдЖрджрд┐ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдИрдПрд▓рдПрдл рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рджреЗрдЦреЗрдВред рд╣рдо st_other рдлрд╝реАрд▓реНрдб рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗ, рдЕрдм рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреЛрдИ рджрд┐рд▓рдЪрд╕реНрдкреА рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЕрдВрддрд┐рдо рддреАрди рдлрд╝реАрд▓реНрдб st_shndx, st_value рдФрд░ st_size рджреЗрдЦреЗрдВред st_shndx - рдЙрд╕ рдЦрдВрдб рдХрд╛ рд╣реЗрдбрд░ рдЗрдВрдбреЗрдХреНрд╕ рдЬрд┐рд╕рдореЗрдВ рд╡рд░реНрдг рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╣рдо рдпрд╣рд╛рдВ рдПрдХ рд╢реВрдиреНрдп рдорд╛рди рджреЗрдЦрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддреАрдХ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдЕрдВрджрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рд╣реИ, рдпрд╣ рдЙрдкрд▓рдмреНрдз рд╡рд░реНрдЧреЛрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реИред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддрджрдиреБрд╕рд╛рд░, рдЗрд╕рдХрд╛ st_value рдорд╛рди рдФрд░ st_size рдХрд╛ рдЖрдХрд╛рд░ рднреА рд╢реВрдиреНрдп рд╣реИред рдореЙрдбреНрдпреВрд▓ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдпреЗ рдлрд╝реАрд▓реНрдб рдХрд░реНрдиреЗрд▓ рджреНрд╡рд╛рд░рд╛ рднрд░реЗ рдЬрд╛рдПрдВрдЧреЗред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП, рдкреНрд░рддреАрдХ рдлреВ рдХреЛ рджреЗрдЦреЗрдВ, рдЬреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдореМрдЬреВрдж рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">  08 00 00 00 02 00 02 00  00 00 00 00 00 00 00 00  16 00 00 00 00 00 00 00
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкреНрд░рддреАрдХ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрд┐ 0x00000000 рдЕрдиреБрднрд╛рдЧ рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдкрддреЗ рдкрд░ .text рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ, рдЕрд░реНрдерд╛рддреНред </font><font style="vertical-align: inherit;">рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЕрд╕рдВрддреБрд╖реНрдЯ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рджреЗрдЦрд╛, рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЖрдХрд╛рд░ 22 рдмрд╛рдЗрдЯреНрд╕ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдУрдмрдЬрдбрдореНрдк рд╣рдореЗрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рдПрдВрдЧреЗ:</font></font><br>
<br>
<pre><code class="plaintext hljs">$ objdump -t exe.ko | grep foo<font></font>
0000000000000000 l     F .text	0000000000000016 foo<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЬрдм рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рдХреЛ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рднреА рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рдЕрдХреНрд╖рд░ рдкрд╛рддрд╛ рд╣реИ рдФрд░ рдорд╛рдиреНрдп рдореВрд▓реНрдпреЛрдВ рдХреЗ рд╕рд╛рде st_value рдФрд░ st_size рдлрд╝реАрд▓реНрдб рднрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ simpleify_symbols рдлрд╝рдВрдХреНрд╢рди, рдХрд░реНрдиреЗрд▓ / рдореЙрдбреНрдпреВрд▓.рд╕реА. рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">/* Change all symbols so that st_value encodes the pointer directly. */<font></font>
static int simplify_symbols(struct module *mod, const struct load_info *info)<font></font>
{<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдореЗрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлреЙрд░реНрдо рдХрд╛ load_info рд╕рдВрд░рдЪрдирд╛ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</font></font><br>
<br>
<pre><code class="plaintext hljs">struct load_info {<font></font>
	const char *name;<font></font>
	/* pointer to module in temporary copy, freed at end of load_module() */<font></font>
	struct module *mod;<font></font>
	Elf_Ehdr *hdr;<font></font>
	unsigned long len;<font></font>
	Elf_Shdr *sechdrs;<font></font>
	char *secstrings, *strtab;<font></font>
	unsigned long symoffs, stroffs, init_typeoffs, core_typeoffs;<font></font>
	struct _ddebug *debug;<font></font>
	unsigned int num_debug;<font></font>
	bool sig_ok;<font></font>
#ifdef CONFIG_KALLSYMS<font></font>
	unsigned long mod_kallsyms_init_off;<font></font>
#endif<font></font>
	struct {<font></font>
		unsigned int sym, str, mod, vers, info, pcpu;<font></font>
	} index;<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реАрд▓реНрдб рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 рдПрдЪрдбреАрдЖрд░ </font><font style="vertical-align: inherit;">- рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░ </font><font style="vertical-align: inherit;">- рд╕реАрдЪрдбреНрд░реНрд╕ - рд╕реЗрдХреНрд╢рди рд╣реЗрдбрд░ рдЯреЗрдмрд▓ рдХреЗ рд▓рд┐рдП рд╕реВрдЪрдХ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - рд╕реНрдЯреНрд░реИрдЯрдм - рдкреНрд░рддреАрдХ рдирд╛рдо рддрд╛рд▓рд┐рдХрд╛ - рд╢реВрдиреНрдп рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдП рдЧрдП рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХрд╛ рдПрдХ рд╕реЗрдЯ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - index.sym - рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ рд╡рд╛рд▓реЗ рдЕрдиреБрднрд╛рдЧ рд╣реЗрдбрд░ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдПрдХреНрд╕реЗрд╕ рдорд┐рд▓реЗрдЧрд╛ред рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрднрд╛рдЧред </font><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ Elf64_Sym рдкреНрд░рдХрд╛рд░ рдХреЗ рддрддреНрд╡реЛрдВ рдХреА рдПрдХ рд╕рд░рдгреА рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">Elf64_Shdr *symsec = &amp;info-&gt;sechdrs[info-&gt;index.sym];<font></font>
Elf64_Sym *sym = (void *)symsec-&gt;sh_addr;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдЧрд▓рд╛, рд▓реВрдк рдореЗрдВ, рд╣рдо рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд╕рднреА рд╡рд░реНрдгреЛрдВ рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЗрд╕рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<pre><code class="plaintext hljs">for (i = 1; i &lt; symsec-&gt;sh_size / sizeof(Elf_Sym); i++) {<font></font>
	const char *name = info-&gt;strtab + sym[i].st_name;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
St_shndx рдлрд╝реАрд▓реНрдб рдореЗрдВ рдЙрд╕ рдЕрдиреБрднрд╛рдЧ рдХрд╛ рд╣реЗрдбрд░ рдЗрдВрдбреЗрдХреНрд╕ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╡рд░реНрдг рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдпрджрд┐ рдХреЛрдИ рд╢реВрдиреНрдп рдорд╛рди (рд╣рдорд╛рд░рд╛ рдорд╛рдорд▓рд╛) рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░рддреАрдХ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдЕрдВрджрд░ рдирд╣реАрдВ рд╣реИ, рдЖрдкрдХреЛ рдЗрд╕реЗ рдХрд░реНрдиреЗрд▓ рдореЗрдВ рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">	switch (sym[i].st_shndx) {<font></font>
	.....<font></font>
	 case SHN_UNDEF: //  0<font></font>
	ksym = resolve_symbol_wait(mod, info, name);<font></font>
 	/* Ok if resolved.  */<font></font>
	if (ksym &amp;&amp; !IS_ERR(ksym)) {<font></font>
		sym[i].st_value = kernel_symbol_value(ksym);<font></font>
		break;<font></font>
	}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЙрд╕рдХреЗ рдмрд╛рдж apply_relocations рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХрддрд╛рд░ рдЖрддреА рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">static int apply_relocations(struct module *mod, const struct load_info *info)<font></font>
{<font></font>
	unsigned int i;<font></font>
	int err = 0;<font></font>
<font></font>
	/* Now do relocations. */<font></font>
	for (i = 1; i &lt; info-&gt;hdr-&gt;e_shnum; i++) {<font></font>
	.....<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реВрдк рдореЗрдВ, рд╣рдо рд░рд┐рд▓реЛрдХреЗрд╢рди рд╕реЗрдХреНрд╢рди рдХреА рддрд▓рд╛рд╢ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдХреНрд╢рди рдХреЗ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЛ apply_relocate_add рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">if (info-&gt;sechdrs[i].sh_type == SHT_RELA) //   <font></font>
	err = apply_relocate_add(info-&gt;sechdrs, info-&gt;strtab,<font></font>
				info-&gt;index.sym, i, mod);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реЗрдХреНрд╢рди рд╣реЗрдбрд░ рдЯреЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░, рд╕рд┐рдВрдмрд▓ рдиреЗрдо рдЯреЗрдмрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЙрдЗрдВрдЯрд░, рд╕рд┐рдВрдмрд▓ рдЯреЗрдмрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реЗрдХреНрд╢рди рд╣реИрдбрд░ рдЗрдВрдбреЗрдХреНрд╕, рдФрд░ рдПрдХ рд░реАрд╡реЛрдХреЗрд╢рди рд╕реЗрдХреНрд╢рди рд╣реЗрдбрд░ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ apply_relocate_add рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">int apply_relocate_add(Elf64_Shdr *sechdrs,<font></font>
	   const char *strtab,<font></font>
	   unsigned int symindex,<font></font>
	   unsigned int relsec,<font></font>
	   struct module *me)<font></font>
{<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдкрд╣рд▓реЗ рд╣рдо рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдЦрдВрдб рдХреЛ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">Elf64_Rela *rel = (void *)sechdrs[relsec].sh_addr;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдлрд┐рд░, рдПрдХ рд▓реВрдк рдореЗрдВ, рд╣рдо рдЗрд╕рдХреА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдПрдХ рд╕рд░рдгреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЙрд░реНрдЯ рдХрд░рддреЗ рд╣реИрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">for (i = 0; i &lt; sechdrs[relsec].sh_size / sizeof(*rel); i++) {
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╣рдо рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдиреБрднрд╛рдЧ рдвреВрдВрдврддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдореЗрдВ рд╕реНрдерд┐рддрд┐, рдЕрд░реНрдерд╛рддреНред </font><font style="vertical-align: inherit;">рдЬрд╣рд╛рдВ рд╣рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред </font><font style="vertical-align: inherit;">рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдЕрдиреБрднрд╛рдЧ рд╣реЗрдбрд░ рдХрд╛ sh_info рдХреНрд╖реЗрддреНрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдиреБрднрд╛рдЧ рд╢реАрд░реНрд╖рд▓реЗрдЦ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реИ, рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд░рд┐рдХреЙрд░реНрдб рдХрд╛ r_offset рдХреНрд╖реЗрддреНрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдЦрдВрдб рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">/* This is where to make the change */<font></font>
loc = (void *)sechdrs[sechdrs[relsec].sh_info].sh_addr + rel[i].r_offset;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЪрд░рд┐рддреНрд░ рдХрд╛ рдкрддрд╛, рдкрд░рд┐рд╢рд┐рд╖реНрдЯ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдПред </font><font style="vertical-align: inherit;">рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ r_info рдлрд╝реАрд▓реНрдб рдореЗрдВ рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЗрд╕ рдЪрд┐рд╣реНрди рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд╢рд╛рдорд┐рд▓ рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">	/* This is the symbol it is referring to.  Note that all<font></font>
	   undefined symbols have been resolved.  */<font></font>
	sym = (Elf64_Sym *)sechdrs[symindex].sh_addr<font></font>
		+ ELF64_R_SYM(rel[i].r_info);<font></font>
<font></font>
	val = sym-&gt;st_value + rel[i].r_addend;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХрд╛ рдкреНрд░рдХрд╛рд░ рдЧрдгрдирд╛ рдХреЗ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдпрд╣ R_X86_64_PLT32 рд╣реИ:</font></font><br>
<br>
<pre><code class="plaintext hljs">	switch (ELF64_R_TYPE(rel[i].r_info)) {<font></font>
	......<font></font>
	case R_X86_64_PLT32:	<font></font>
		if (*(u32 *)loc != 0)<font></font>
			goto invalid_relocation;<font></font>
		val -= (u64)loc;	//   <font></font>
		*(u32 *)loc = val;  //    <font></font>
		break;<font></font>
	.....<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЕрдм рд╣рдо рдЦреБрдж рдЕрдВрддрд┐рдо рд╡реИрд▓ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ sym-&gt; st_value рдкреНрд░рд┐рдВрдЯрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд╣реИ 0xffffffff810b3df9, r_addend (-4) рд╣реИ, рд░рд┐рд▓реЛрдХреЗрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рднрд░рдкрд╛рдИ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдЯреЗрдХреНрд╕реНрдЯ рд╕реЗрдХреНрд╢рди рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ 0xd рдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдлреВ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ ix, i.e. </font><font style="vertical-align: inherit;">ffffffffc000000d рд╣реЛрдЧрд╛ред </font><font style="vertical-align: inherit;">рдЗрди рд╕рднреА рдореВрд▓реНрдпреЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:</font></font><br>
<br>
<pre><code class="plaintext hljs">val = (u32)(0xffffffff810b3df9 - 0x4 - 0xffffffffc000000d) = 0xc10b3de8
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдЖрдЗрдП foo рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдбрдВрдк рдХреЛ рджреЗрдЦреЗрдВ, рдЬреЛ рд╣рдореЗрдВ рдмрд╣реБрдд рд╢реБрд░реБрдЖрдд рдореЗрдВ рдорд┐рд▓рд╛ рдерд╛:</font></font><br>
<br>
<pre><code class="plaintext hljs">53 89 fe 89 fb 48 c7 c7 24 10 00 c0 e8 e8 3d 0b c1 8d 43 02 5b c3 66 2e 0f
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдСрдлрд╕реЗрдЯ 0xD рдкрд░, рдорд╛рди 0xc10b3de8 рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХреА рдЧрдИ рдХреЗ рд╕рдорд╛рди рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рдпрд╣ рд╣реИ рдХрд┐ рдХрд░реНрдиреЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХреИрд╕реЗ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХрд░реАрдмреА рдХреЙрд▓ рдХрдорд╛рдВрдб рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдСрдлрд╕реЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
рд▓реЗрдЦ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдореЗрдВ, рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг 5.4.27 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi504414/index.html">рдХреИрд╕реЗ Microsoft AppGet рдорд╛рд░реЗ рдЧрдП</a></li>
<li><a href="../hi504420/index.html">рдПрдХ рд╕рд╛рде рдЪрд╛рд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдореЛрдбрд╝ рдЖрдзрд╛рд░рд┐рдд PvP рдХреНрд╖реЗрддреНрд░ рд▓реЗрдЦрди</a></li>
<li><a href="../hi504430/index.html">рд╣рд░ рджрд┐рди рдЬреАрд╡рди рдЯрд┐рдВрдХрдСрдлрд╝ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдЪрд╛рд▓рди рдХреЗрдВрджреНрд░: рдПрдХрд▓ рдмреВрдЯрд▓реЛрдбрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</a></li>
<li><a href="../hi504434/index.html">рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреЗ рд▓рд┐рдП рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо: рдмрдЪреНрдЪреЛрдВ рдХреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЦрддрд░реЗ рд╕реЗ рдХреИрд╕реЗ рдмрдЪрд╛рдПрдВ</a></li>
<li><a href="../hi504438/index.html">рдкреНрд░рддрд┐ рд╕рдкреНрддрд╛рд╣ 30 рдорд╛рдЗрдЯреИрдкреНрд╕ред рд╣рдо 2020 рдХреЗ рдЧрд░реНрдорд┐рдпреЛрдВ рдХреЗ рдореМрд╕рдо рдХреЛ рдЦреЛрд▓рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi504444/index.html">рд╡рд┐рдВрдбреЛрдЬрд╝ рдЗрдореЗрдЬ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбреЙрдХрдЯрд░ рдорд▓реНрдЯреА-рд╕реНрдЯреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a></li>
<li><a href="../hi504448/index.html">рдЧреЗрдорд░ рдЬреЗрдирд░реЗрд╢рди II</a></li>
<li><a href="../hi504450/index.html">рдЖрдзреБрдирд┐рдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ: рдПрдХ рд╕рд╛рдЗрдб рд╡реНрдпреВ</a></li>
<li><a href="../hi504452/index.html">рдУрдВрдЯреЛрд▓реЙрдЬреА рдиреЗ рд▓реЗрдпрд░ 2 рдХреЛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛, рдЬрд┐рд╕рдореЗрдВ рдЕрдзрд┐рдХ рдПрдХреАрдХреГрдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЪреЗрди рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХрд╛ рдпреЛрдЧрджрд╛рди рд╣реИ</a></li>
<li><a href="../hi504454/index.html">рд╡реЗрдм рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмреЗрд╕реНрдЯ рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>