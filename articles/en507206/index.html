<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî∏ ‚öõÔ∏è üí∑ Architecture Y messenger üêò üîñ üöå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Y messenger is designed to be simultaneously protected at the Tox, BitMessage level, and convenient at the Telegram and WhatsApp level. In this articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Architecture Y messenger</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/507206/"><p><img src="https://habrastorage.org/webt/en/kw/yv/enkwyvrdt3d7h0wis9og-nvrfoy.png"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y messenger is designed to be simultaneously protected at the Tox, BitMessage level, and convenient at the Telegram and WhatsApp level. </font><font style="vertical-align: inherit;">In this article I will describe how the architecture looks and what solutions were used to achieve the goals.</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are the advantages of modern instant messengers we have collected in our product:</font></font></p><a name="habracut"></a><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Communication</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sending text, photos, files, voice messages;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sending messages protected by end-to-end encryption (including photos and files);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementation of dialogs, multi-user chats and channels;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Receive push notifications of new messages;</font></font></li>
<li>   ;</li>
<li>       ;</li>
<li>       ;</li>
</ul></li>
<li>   :<br>
<ul>
<li>      / .;</li>
<li>     / ;</li>
<li>        ;</li>
<li>    ;</li>
<li>            ;</li>
</ul></li>
<li>  :<br>
<ul>
<li>     (, , );</li>
<li>   ;</li>
<li>     ;</li>
</ul></li>
<li>:<br>
<ul>
<li>   ;</li>
<li>  ;</li>
<li>   ;</li>
<li>    (    );</li>
<li>      ;</li>
<li>     ;</li>
<li>    .</li>
</ul></li>
</ul><br>
<h2 id="setevaya-arhitektura"> </h2><br>
<p>         WebSocket.     HTTP.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">GitHub</a>.</p><br>
<h3 id="celi-i-zadachi">  </h3><br>
<ul>
<li>  .</li>
<li>    .</li>
<li>    .</li>
<li>     .</li>
<li>   .</li>
<li>      .</li>
<li>      </li>
<li>      .</li>
</ul><br>
<h3 id="reshenie"></h3><br>
<p>       ,   ,       ‚Äî " ".</p><br>
<p>        ().     ,                 .</p><br>
<p><img src="https://habrastorage.org/webt/i0/ed/co/i0edcocj-vjv5ohvnpevm4c0hlw.png" alt="Communication scheme between hubs and users"></p><br>
<p>    ,     .       . </p><br>
<p>      (E-mail).</p><br>
<h3 id="haby"></h3><br>
<p> :</p><br>
<ol>
<li>,    .</li>
<li>    (, , , ).</li>
<li>    .</li>
<li>         .</li>
<li>      .</li>
<li>  (    S3- ).</li>
<li>   Blockchain.</li>
<li>  .</li>
<li>        ,    .</li>
<li>  .</li>
</ol><br>
<p><strong>     ,    .   Y messenger           /  /  /     .</strong></p><br>
<h3 id="prochie-elementy-seti">  </h3><br>
<p>   ,   Y messenger    (shared microservice),    :</p><br>
<ul>
<li>Push shared microservice ‚Äî  push-.          .       Push-.</li>
<li>Balancer shared microservice ‚Äî   .            .            <code> &lt;-&gt; </code>  <code> &lt;-&gt; </code>.</li>
</ul><br>
<p> ,       ,         .       .</p><br>
<h2 id="arhitektura-hranilischa-dannyh">  </h2><br>
<h3 id="celi-i-zadachi-1">  </h3><br>
<ul>
<li>    .</li>
<li>         .</li>
<li>      .</li>
<li>        ,    .</li>
<li>        .</li>
</ul><br>
<h3 id="reshenie-1"></h3><br>
<p>          .   ‚Äî  .   ‚Äî  ,         . </p><br>
<p>       PostgreSQL,    ‚Äî Redis.       ,     ,      .</p><br>
<h3 id="gde-chto-hranitsya">  </h3><br>
<ul>
<li><strong> .</strong>       .          .         ,     <code>ID  &lt;-&gt; ID </code>  .</li>
<li><strong>  .</strong>          .    , ..       ,          .           .</li>
<li><strong>  .</strong>     .           (  ),     .</li>
<li><strong>  .</strong>    .       ,       .</li>
<li><strong>  .</strong>    .        .</li>
<li><strong>     .</strong>     .        . </li>
<li><strong>    .</strong>     .      / ,            .                 . </li>
<li><strong>  /.</strong>      .        .</li>
<li><strong>    .</strong>   .        .</li>
</ul><br>
<h2 id="shifrovanie"></h2><br>
<p>     OpenSSL.    Y messenger       AES-CBC, RSA-OAEP, RSA-PSS.       ,  ,   /               .</p><br>
<h3 id="klyuchi"></h3><br>
<p>Y messenger,     ,      .         :</p><br>
<ul>
<li>  (  );</li>
<li>  (  );</li>
<li>  .</li>
</ul><br>
<p>      ,        Int64.</p><br>
<p>   Y messenger     ,     8192 .           4096 ,         16384   .  ,  8192   .        ,      .</p><br>
<h3 id="hranenie-klyuchey"> </h3><br>
<p>              .  ,  ,   ,           .         (,     )      . </p><br>
<p>            ,             ,      .             . </p><br>
<p>      40 ,     Master-Key,    .           ,               .</p><br>
<p>        ,       .</p><br>
<h3 id="skvoznoe-shifrovanie"> </h3><br>
<p>  ,   ,       ,        .</p><br>
<p>           .        ,     ,            ,         .</p><br>
<p>    : </p><br>
<ol>
<li>Alice   Bob'  .</li>
<li>Alice         Bob'. </li>
<li>Alice   .</li>
<li>Alice       Bob'      .</li>
<li>Alice  Bob' ,      .</li>
<li> Alice      ,      .</li>
<li>Bob       .</li>
<li>Bob        Alice.</li>
<li>Bob      .</li>
<li>Bob          ,   Alice.</li>
</ol><br>
<p>     ,    ,     .       ,        .</p><br>
<h3 id="obmen-klyuchami-mezhdu-ustroystvami">   </h3><br>
<p>    cross-device,             .   ,  cross-device      .  cross-device     - ,   ,       .     (  ,  ):</p><br>
<ol>
<li>      .</li>
<li>            .</li>
<li>      .</li>
<li>     .</li>
</ol><br>
<p>       .    .</p><br>
<p>           .   .</p><br>
<p>  ,      .        ,    .   ,     A  B  :</p><br>
<ol>
<li>     A.</li>
<li>     B (   ).</li>
<li> B          ,     .</li>
<li> B        ,        ,   ,       .</li>
<li>                B       .</li>
<li> A                 (       ).</li>
<li> A    ,       .</li>
<li> A           (  ,    ,   )        .</li>
<li>      B.</li>
<li> B            .</li>
<li> B      .</li>
</ol><br>
<p> ,   B     A.           . </p><br>
<p>    ""    ,        .        ,     B (     B        ).</p><br>
<h2 id="ishodnyy-kod"> </h2><br>
<p>     :</p><br>
<ul>
<li> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">https://github.com/Ymessenger/ymessenger</a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client for Android: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Ymessenger/android-app</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">network exchange protocol: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Ymessenger/protocol</font></font></a></li>
</ul><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The online presentation of Y messenger will take place on June 23 at 11:00 (Moscow time). </font><font style="vertical-align: inherit;">In the framework of this meeting, I, the head of the development team, will tell you what tasks the messenger solves, in which companies it is most useful and answer all questions. </font><font style="vertical-align: inherit;">In order not to miss the meeting, register </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></blockquote></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en507196/index.html">What is the difference between Data Analytics and Statistics</a></li>
<li><a href="../en507198/index.html">Podcasts as corporate media: how to make money on them and what metrics to use</a></li>
<li><a href="../en507200/index.html">7 Ways Data Scientists Fool You</a></li>
<li><a href="../en507202/index.html">Avito Analytics meetup</a></li>
<li><a href="../en507204/index.html">Industrial design interior kitchen: from sketch to product in box</a></li>
<li><a href="../en507210/index.html">The performance of modern Java when working with large amounts of data, part 2</a></li>
<li><a href="../en507212/index.html">Training smart gaming rivals in Unity using the "play with yourself" method using ML-Agents</a></li>
<li><a href="../en507214/index.html">How to create and modify interactive PDF forms, or the new skill ABBYY FineReader PDF</a></li>
<li><a href="../en507218/index.html">Read me, or why the text is not read to the end</a></li>
<li><a href="../en507222/index.html">Why everyone should wear masks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>