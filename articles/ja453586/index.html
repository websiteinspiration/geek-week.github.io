<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊🏾 ✂️ 👨 IntersectionObserver APIと画像の遅延読み込み 😂 ♍️ 🖇️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="遅延画像読み込みを使用してWebプロジェクトのパフォーマンスを向上させることは、一般的な最適化手法です。問題は、画像が最新のWebサイトで混雑している「重い」リソースであることです。これについてはすでに公開しています。ここでは、ウォルマートのWebサイトに遅延読み込みが与えたものについて読むことがで...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IntersectionObserver APIと画像の遅延読み込み</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/453586/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延画像読み込みを使用してWebプロジェクトのパフォーマンスを向上させることは、一般的な最適化手法です。</font><font style="vertical-align: inherit;">問題は、画像が最新のWebサイトで混雑している「重い」リソースであることです。</font><font style="vertical-align: inherit;">これについてはすでに公開しています。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、ウォルマートのWebサイトに遅延読み込みが与えたものについて読むことができ、ReactプロジェクトでIntersectionObserverを使用する方法を学ぶことができます。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、静的なサイトの最適化の記事が。</font><font style="vertical-align: inherit;">ブラウザツールを使用した遅延読み込みの実装に関する最近の資料を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に示し</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">
本日は、IntersectionObserver APIの使用法を簡単なWebページを例に説明した記事の翻訳をご紹介します。</font><font style="vertical-align: inherit;">この資料は、初心者プログラマを対象としています。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ao/_d/7t/ao_d7twyxzavzolz2ascrhfk1g4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画像の遅延読み込みとは何ですか？</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションのパフォーマンスを分析するとき、2つの指標が最初に現れます。最初の対話までの時間（対話時間）とリソース消費（リソース消費）です。彼らは必然的にウェブ開発に従事している人々に直面しなければならないでしょう。さらに、アプリケーションの問題は、作業の準備に時間がかかったり、リソースを大量に消費したりするために発生するだけではありません。ただし、いずれの場合でも、これらの問題の原因をできるだけ早く見つけて、問題が発生しないように努めることが非常に重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webアプリケーションで遅延画像読み込みテクノロジーを使用すると、パフォーマンスの問題のリスクを最小限に抑えることができます。</font><font style="vertical-align: inherit;">つまり、ページを稼働状態にする時間とリソースの消費に及ぼす影響の観点から遅延読み込みを分析すると、次の結果が得られます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の対話までの時間。</font><font style="vertical-align: inherit;">これは、Webアプリケーションがインターフェイスを読み込んで、ユーザーが操作するのに適した状態にする必要があるときです。</font><font style="vertical-align: inherit;">遅延読み込み（さらに、画像だけではありません）は、コードを分離し、特定のページに必要なもの、または特定の瞬間に必要なものだけを読み込むテクノロジのおかげで、アプリケーションの応答時間を最適化します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リソースの消費。</font><font style="vertical-align: inherit;">人間はせっかちな存在です。</font><font style="vertical-align: inherit;">ウェブサイトの読み込みに3秒以上かかる場合、70％のユーザーがそのサイトを離れます。</font><font style="vertical-align: inherit;">Webアプリケーションはそれほど長くロードされるべきではありません。</font><font style="vertical-align: inherit;">遅延読み込みを使用すると、ページが機能するために必要なリソースの量を減らすことができます。</font><font style="vertical-align: inherit;">たとえば、特定のプロジェクトのコードがフラグメントに分割され、それらを必要とするページにのみ読み込まれる場合があります。</font><font style="vertical-align: inherit;">その結果、サイトのパフォーマンスが向上し、システムリソースの消費量が減少します。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、遅延読み込みテクノロジーはアプリケーションを高速化し、アプリケーションがダウンロードして動作状態にするまでの時間を短縮します。</font><font style="vertical-align: inherit;">これは、リソースが必要なときにのみ読み込まれるためです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅延読み込みがWebプロジェクトに与える利点は次のとおりです。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページの読み込みが速くなり、操作可能になります。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページの最初のロード時に、転送して処理するデータを少なくする必要があります。</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IntersectionObserver APIを使用した画像の遅延読み込み</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Webページの読み込み方法を考えると、ユーザーには表示されない画像やその他のリソースをダウンロードしても意味がないことが明らかになります。</font><font style="vertical-align: inherit;">遅延読み込みを使用する場合、ページの表示領域にある画像が最初に読み込まれます。</font><font style="vertical-align: inherit;">次に、ユーザーがページをスクロールすると、ページの表示領域に収まる他の画像が読み込まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例を考えてみましょう。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b9/e36/782/7b9e367828e6af1dfd070461196dc7c1.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページとその表示領域</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
前の画像を見てください。ここに、ブラウザとブラウザにロードされたWebページが表示されます。画像</font></font><code>#IMG_1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>#IMG_2 </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はページの範囲内です。これは、それらがユーザーに表示され、画面に表示されるブラウザーウィンドウの領域の境界内にあることを意味します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それはそれはすぐにダウンロードしたロードされているかのように、この手順では、ページと連動完璧とイメージと考えることができない</font></font><code>#IMG_1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>#IMG_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>#IMG_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>#IMG_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ユーザーは見ている</font></font><code>#IMG_1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><code>#IMG_2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>#IMG_3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><code>#IMG_4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼から隠された。ページの読み込み中に最初と2番目の画像を読み込み、3番目と4番目の画像はダウンロードしない場合、これはサイトのパフォーマンスにプラスの影響を与える可能性があります。つまり、次のことを話しているのです。ユーザーがページをスクロールして3番目の画像が表示されるようになると、読み込まれます。スクロールが続行され、4番目の画像が表示されるようになった場合も、画像が読み込まれます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/783/85b/173/78385b17309c48150e2ce83554e7b857.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページのスクロールと画像の読み込み画像を</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
どのように処理するかを正確に把握したので、ページの特定の要素が表示領域に含まれることを確認する方法を自問します。最近のブラウザーにはAPIがあり、プログラマーはページの特定の領域がいつ表示されるかを知ることができます。 IntersectionObserver APIについてです。非同期メカニズムを使用して、要素の監視を整理し、要素がドキュメントのスコープと交差する場合、または別の要素の境界と交差する場合に通知を受け取ることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像の遅延読み込みを構成するには、まず、画像の説明に使用する要素のテンプレートコードを準備する必要があります。そこで彼は：</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;img <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"lzy_img"</span> src=<span class="hljs-string">"lazy_img.jpg"</span> data-src=<span class="hljs-string">"real_img.jpg"</span> /&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クラスを使用すると、遅延読み込みが適用される画像として要素を識別できます。</font><font style="vertical-align: inherit;">この属性を</font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、実際の画像を表示する前にプレースホルダー画像を表示できます。</font></font><code>data-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実画像</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">アドレスが保存され、要素がページの表示領域に入るときに読み込まれます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、遅延読み込みを実装するコードを記述しましょう。</font><font style="vertical-align: inherit;">すでに述べたように、IntersectionObserver APIを使用して、画像がページ表示領域に入った瞬間を検出します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、インスタンスを作成します</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(...);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンストラクター</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、2つのパラメーターを持つ関数を受け入れます。</font><font style="vertical-align: inherit;">1つは監視する必要のある要素で構成される配列を格納し、もう1つはインスタンスを格納します</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">次のようになります。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries, imgObserver</span>) =&gt;</span> {<font></font>
 &nbsp;&nbsp;&nbsp;entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//...</span><font></font>
 &nbsp;&nbsp;&nbsp;})<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数コードは、配列の要素によって表される画像が</font></font><code>entries</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示領域を</font><font style="vertical-align: inherit;">横切るかどうかをチェックします</font><font style="vertical-align: inherit;">。その場合、</font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">対応する画像の属性は、その属性の内容を記録します</font></font><code>data-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries, imgObserver</span>) =&gt;</span> {<font></font>
 &nbsp;&nbsp;&nbsp;entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span>(entry.isIntersecting) {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> lazyImage = entry.target<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.src = lazyImage.dataset.src<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
 &nbsp;&nbsp;&nbsp;})<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、条件を使用して</font></font><code>if(entry.isIntersecting) {...}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、要素がブラウザの表示領域を横切るかどうか</font><font style="vertical-align: inherit;">を確認し</font><font style="vertical-align: inherit;">ます。もしそうなら、要素</font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">をconstantに</font><font style="vertical-align: inherit;">保存します</font></font><code>lazyImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。次に、彼の属性に彼の属性の</font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font><font style="vertical-align: inherit;">を書き込み</font><font style="vertical-align: inherit;">ます</font></font><code>data-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これにより、アドレスが格納されている画像</font></font><code>data-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が読み込まれて画面に表示されます。ブラウザーでは、プレースホルダー画像</font></font><code>lazy_img.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を実際の画像に</font><font style="vertical-align: inherit;">置き換えているように見え</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで</font><font style="vertical-align: inherit;">、関心のある要素の監視を開始するために</font></font><code>.observe()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、インスタンス</font><font style="vertical-align: inherit;">のメソッドを使用する必要があり</font><font style="vertical-align: inherit;">ます</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">imageObserver.observe(<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img.lzy_img'</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは</font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、class </font></font><code>lzy_img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンド</font></font><code>document.querySelectorAll('img.lzy_img')</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">して</font><font style="vertical-align: inherit;">すべての要素</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">ドキュメントから選択し、</font><font style="vertical-align: inherit;">それらをメソッドに渡します</font></font><code>.observe()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要素のリストを受け取ったら、彼はそれらを観察するプロセスを開始します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この例をテストするために、Node.jsプロジェクトを初期化することから始めます。</font></font><br>
<br>
<pre><code class="javascript hljs">mkdir lzy_img<font></font>
cd lzy_img<font></font>
npm init -y</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、フォルダに</font></font><code>lzy_img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">を作成します</font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="html hljs xml">touch index.html</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコードを追加します。</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lazy Load Images<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_1.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_2.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_3.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_4.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_5.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries, imgObserver</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (entry.isIntersecting) {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> lazyImage = entry.target
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"lazy loading "</span>, lazyImage)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.src = lazyImage.dataset.src
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img.lzy_img'</span>)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr.forEach(<span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageObserver.observe(v);
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは5つの画像が説明されていることに気付かれるかもしれません。ここでは、読み込み時にプレースホルダーが表示されます</font></font><code>lazy_img.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code>data-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれ</font><font style="vertical-align: inherit;">の属性には</font><font style="vertical-align: inherit;">、実際の画像に関する情報が含まれています。</font><font style="vertical-align: inherit;">以下は、プロジェクトで使用されるイメージ名のリストです。</font></font><br>
<br>
<pre><code class="plaintext hljs">lazy_img.jpg<font></font>
img_1.jpg<font></font>
img_2.jpg<font></font>
img_3.jpg<font></font>
img_4.jpg<font></font>
img_5.jpg</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の図に示すビューにプロジェクトフォルダーを移動して、これらすべてのイメージを自分で作成する必要があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb4/44e/3cb/bb444e3cbd0ad4e432901dba7a3b2710.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトフォルダー</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
私の場合、ファイルは</font></font><code>lazy_img.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windowsペイントを使用して作成され、実際の画像（</font></font><code>img_*.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pixabay.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">取得</font></a><font style="vertical-align: inherit;">され</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ました</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インスタンスの作成に使用されるコールバックに</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出しがあることに</font><font style="vertical-align: inherit;">注意し</font><font style="vertical-align: inherit;">て</font><font style="vertical-align: inherit;">ください</font></font><code>console.log()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これにより、さまざまなイメージをロードする操作の実行について学ぶことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、を提供</font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するために、パッケージを使用します</font></font><code>http-server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs">npm i http-server</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロパティ</font></font><code>start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font><code>scripts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><font style="vertical-align: inherit;">セクションに</font><font style="vertical-align: inherit;">追加します</font></font><code>package.json</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-string">"scripts"</span>: {
 &nbsp;&nbsp;&nbsp;<span class="hljs-string">"start"</span>: <span class="hljs-string">"http-server ./"</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、ターミナルでコマンドを実行し</font></font><code>npm run start</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブラウザを開き、アドレスに移動します</font></font><code>127.0.0.1:8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><code>index.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初の</font><font style="vertical-align: inherit;">ページ</font><font style="vertical-align: inherit;">は次の図のようになります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd9/e0e/f53/fd9e0ef534be767b804179f38ed134a3.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実画像のないページ</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
実画像があるはずの場所に、プレースホルダーのみが表示されていることがわかります。</font><font style="vertical-align: inherit;">ここでは、最初の画像が表示領域にあるという前提から進むため、ブラウザがダウンロードを開始します。</font><font style="vertical-align: inherit;">その結果、ページは次のようになります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ef/004/1ee/1ef0041eee5e8713415df640faed6cb8.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザが最初の画像をアップロードしました。</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
他の画像はまだアップロードされていません。</font><font style="vertical-align: inherit;">彼らはまだ観覧エリアに達していません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールを見ながらページをスクロールすると、1つの問題に気づくでしょう。</font><font style="vertical-align: inherit;">これは、表示ウィンドウで同じ画像をスクロールすると、ブラウザが数回ダウンロードしようとするという事実にあります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3c4/074/83e/3c407483e097cb7c2dd7ce3b82b37027.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ画像の複数のダウンロード</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは私たちが必要とするものではありません。</font><font style="vertical-align: inherit;">これは、システムリソースの不必要な浪費につながり、プロジェクトのパフォーマンスを低下させます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この問題を解決するに</font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、インスタンスが監視している要素のリストから、</font><font style="vertical-align: inherit;">要素</font><font style="vertical-align: inherit;">（実際の画像が既に読み込まれている）</font><font style="vertical-align: inherit;">を削除する必要があり</font><font style="vertical-align: inherit;">ます</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">また</font></font><code>lzy_img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、この要素から</font><font style="vertical-align: inherit;">クラスを削除する必要があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">編集後のコールバック関数のコードは次のようになります。</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;script&gt;
 &nbsp;&nbsp;&nbsp;<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries, imgObserver</span>) =&gt;</span> {<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (entry.isIntersecting) {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> lazyImage = entry.target
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"lazy loading "</span>, lazyImage)<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.src = lazyImage.dataset.src<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.classList.remove(<span class="hljs-string">"lzy_img"</span>);<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgObserver.unobserve(lazyImage);<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img.lzy_img'</span>)<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr.forEach(<span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> {<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageObserver.observe(v);<font></font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<font></font>
 &nbsp;&nbsp;&nbsp;})<font></font>
&lt;/script&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対応する要素の実際の画像を読み込んだ後、</font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのクラスは削除され</font></font><code>lzy_img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、要素は監視して</font></font><code>IntersectionObserver</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いる</font><font style="vertical-align: inherit;">要素のリストから除外され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これが完成したサンプルコードです：</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lazy Load Images<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_1.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_2.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_3.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_4.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">""</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lzy_img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"lazy_img.jpg"</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"img_5.jpg"</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 &nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries, imgObserver</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (entry.isIntersecting) {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> lazyImage = entry.target
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"lazy loading "</span>, lazyImage)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.src = lazyImage.dataset.src
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lazyImage.classList.remove(<span class="hljs-string">"lzy_img"</span>);
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imgObserver.unobserve(lazyImage);
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> arr = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'img.lzy_img'</span>)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;arr.forEach(<span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageObserver.observe(v);
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画像の遅延読み込みシステムの実装の最も簡単な例を検討しました。</font><font style="vertical-align: inherit;">しかし、IntersectionObserverを使用すると、遅延読み込みのための非常に複雑なスキームを作成できます。</font><font style="vertical-align: inherit;">このトピックに興味がある場合は、資料の冒頭に記載されている出版物を参照し、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を読むことをお勧めします</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">読者の皆様！</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅延画像読み込みシステムを実装した後にWebサイトのパフォーマンスを向上させる例はありますか？</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja453574/index.html">B2B製品管理</a></li>
<li><a href="../ja453578/index.html">批評家からアルゴリズムまで：レーベル、企業、20世紀の音楽文化</a></li>
<li><a href="../ja453580/index.html">先週のフロントエンドの世界からの新鮮な食材のダイジェストNo.366（2019年5月20日〜26日）</a></li>
<li><a href="../ja453582/index.html">ロックファイルを使用しない方が良いNode.jsプロジェクト</a></li>
<li><a href="../ja453584/index.html">準備する：Angular 8は間近です</a></li>
<li><a href="../ja453588/index.html">陛下の粘土についての作品。パート4-シリコーン</a></li>
<li><a href="../ja453590/index.html">自分だけのSaaS</a></li>
<li><a href="../ja453592/index.html">生計を立ててゲームを作る：11 Levelordのヒント</a></li>
<li><a href="../ja453596/index.html">詐欺師とEDS-すべてが非常に悪い</a></li>
<li><a href="../ja453598/index.html">Япония: страна настолько здравого смысла, что он для нас местами иррационален</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>