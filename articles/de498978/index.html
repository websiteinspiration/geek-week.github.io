<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😆 🍄 🛳️ Verwenden von Graylog und NLog zum Sammeln von Protokollen aus C # -Anwendungen. Persönliche Erfahrung 🚣🏾 🔎 🤜🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KDPV
 
 Habr, willkommen! 
 
 Das Folgende ist keinesfalls ein Tutorial oder eine bewährte Methode . Ich beschloss, meine Erfolge nur in der gestellte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Verwenden von Graylog und NLog zum Sammeln von Protokollen aus C # -Anwendungen. Persönliche Erfahrung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/498978/"><img src="https://habrastorage.org/webt/_y/ee/iu/_yeeiuyxudo9su5z6rjaloimftg.jpeg"><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KDPV</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Habr, willkommen! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Folgende ist keinesfalls ein </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tutorial</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bewährte Methode</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ich beschloss, meine Erfolge nur in der gestellten Frage zusammenzufassen und zu dokumentieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, dass der Inhalt dieses Artikels denjenigen, die Informationen zur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokollierung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suchen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">, ermöglicht</font></a><font style="vertical-align: inherit;"> , etwas Neues </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">zu</font></a><font style="vertical-align: inherit;"> lernen oder eine Entscheidung zu treffen. </font><font style="vertical-align: inherit;">Und natürlich hoffe ich auf ein konstruktives Feedback von der Community. </font><font style="vertical-align: inherit;">Es gibt eine Chance, etwas besser zu machen.</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wofür? </font><font style="vertical-align: inherit;">Für wen?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde versuchen, in meinen eigenen Worten zu beschreiben, was Protokollierung ist:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichern einiger für den Menschen lesbarer Informationen über ein positives oder negatives Ereignis während der Ausführung des Programmcodes, möglicherweise unter Beibehaltung qualitativer oder quantitativer Indikatoren und Daten als Teil der gespeicherten Informationen in Bezug auf den Zeitpunkt des Ereignisses.</font></font><br>
</blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es kam eine komplizierte Formulierung heraus, die im allgemeinen Fall die Aufgabe des Erstellens und Verwaltens von Protokollen vollständig beschreibt. </font><font style="vertical-align: inherit;">Eine qualitativ hochwertige Protokollierung hilft dem Entwickler, den internen Status des Codes in jeder Phase seines Lebens zu steuern: vom Debuggen bis zur Installation in einer unbekannten Umgebung des Computers des Verbrauchers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns zeigen, wie ich Protokolle schreibe.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Werkzeuge</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verzichten auf die Protokollierung mit wenig informativen Textnachrichten wie " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenbank ist nicht verfügbar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ", " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei konnte </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">nicht </font></i><i><font style="vertical-align: inherit;">gespeichert werden</font></i><font style="vertical-align: inherit;"> " und dergleichen. Protokolle dieses Typs sind einfach zu erstellen, reichen jedoch häufig nicht aus, um das Wesentliche und die Ursachen des Problems im Code oder in der Umgebung zu verstehen. Irgendwann muss jeder Entwickler nur noch eine strukturierte Protokollierung entwickeln. Wie mein guter Freund und IT-Mentor mir sagte: „ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sammeln Sie alles und schließen Sie dann unnötige ... aus.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “ Spezielle Frameworks helfen uns dabei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt genug davon. Die meisten von ihnen haben ähnliche Fähigkeiten und Einschränkungen. Es wurden viele Artikel und </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Rezensionen</font></a><font style="vertical-align: inherit;"> darüber geschrieben.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Vergleiche und Handbücher. Für die Anmeldung von Anwendungen, die in C # geschrieben wurden, habe ich einmal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog gewählt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jetzt erinnere ich mich nicht, warum er es war, aber es ist einfach so passiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Plattform ist ziemlich gut</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und äußerst nützliche </font><font style="vertical-align: inherit;">Anwendung </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fälle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Natürlich habe ich NLog zu unterschiedlichen Zeiten und für unterschiedliche Projekte auf unterschiedliche Weise verwendet. </font><font style="vertical-align: inherit;">Aber irgendwann wurde ein Code geboren, der jetzt als Snippet verwendet wird und sich praktisch nicht ändert.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung</font></font></h4><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zur Sache! </font><font style="vertical-align: inherit;">Zeigen Sie den Code:</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Diagnostics;
<span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System.Reflection;
<span class="hljs-keyword">using</span> System.Runtime.InteropServices;
<span class="hljs-keyword">using</span> System.Text;
<span class="hljs-keyword">using</span> Newtonsoft.Json;
<span class="hljs-keyword">using</span> NLog;
<span class="hljs-keyword">using</span> NLog.Config;
<span class="hljs-keyword">using</span> NLog.Layouts;
<span class="hljs-keyword">using</span> NLog.Targets;
<span class="hljs-keyword">using</span> NLog.Targets.GraylogHttp;
<span class="hljs-keyword">using</span> NLog.Targets.Wrappers;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> <span class="hljs-title">BIMLIB.Converter</span><font></font>
{<font></font>
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BimlibLogger</span><font></font>
	{<font></font>
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> ApplicationSettings _settings = BimlibSettingsManager.Instance.AppSettings;
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Lazy&lt;LogFactory&gt; _instance = <span class="hljs-literal">null</span>;
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LoggingConfiguration _logConfig = <span class="hljs-literal">null</span>;<font></font>
<font></font>
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Lazy&lt;LogFactory&gt; Instance<font></font>
		{<font></font>
			<span class="hljs-keyword">get</span><font></font>
			{<font></font>
				<span class="hljs-keyword">return</span> _instance ?? (_instance = <span class="hljs-keyword">new</span> Lazy&lt;LogFactory&gt;(BuildLogFactory));<font></font>
			}<font></font>
		}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logger <span class="hljs-title">GetLogger</span>(<span class="hljs-params"></span>)</span><font></font>
		{<font></font>
			<span class="hljs-keyword">return</span> Instance.Value.GetCurrentClassLogger();<font></font>
		}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LogFactory <span class="hljs-title">BuildLogFactory</span>(<span class="hljs-params"></span>)</span><font></font>
		{<font></font>
			LoggingConfiguration config = _logConfig ?? <span class="hljs-keyword">new</span> LoggingConfiguration();
			<span class="hljs-comment">//     .   .</span>
			<span class="hljs-keyword">string</span> headerStr = _settings.LogHeader;
			<span class="hljs-comment">//    .       - , : https://github.com/drewnoakes/figgle</span><font></font>
			Layout header = headerStr;<font></font>
<font></font>
			<span class="hljs-comment">//      : https://nlog-project.org/config/?tab=layout-renderers</span>
			<span class="hljs-comment">//     :</span>
			<span class="hljs-comment">// -   : 2020-04-24 19:13:51.1620 [BIMLIB.Converter.MainClass.Main] -&gt; I : Service starting...</span>
			<span class="hljs-comment">// -  : 2020-04-22 09:55:33.1132 [BIMLIB.Converter.Converter.ClearFile] -&gt; E : mscorlib</span>
			<span class="hljs-comment">//{</span>
			<span class="hljs-comment">//	"Type":"System.IO.FileNotFoundException", "Message":" 'D:\\path\\to\\file\\file_name.ifc'  .", "FileName":"D:\\path\\to\\file\\file_name.ifc", "Data":{</span>
			<span class="hljs-comment">//	}, "TargetSite":"Void WinIOError(Int32, System.String)", "StackTrace":"    System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)\r\n    System.IO.FileInfo.get_Length()\r\n    BIMLIB.Converter.Converter.ClearFile(String path)", "Source":"mscorlib", "HResult":-2147024894}</span><font></font>
<font></font>
			Layout layout = <span class="hljs-string">"${longdate} [${callsite:className=true:includeNamespace=true:fileName=false:includeSourcePath=false:methodName=true:cleanNamesOfAnonymousDelegates=true:cleanNamesOfAsyncContinuations=true}] -&gt; ${level:format=FirstCharacter} : ${message}${onexception:inner=${newline}${exception:format=@}}"</span>;<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> Targets ----------------------------</span><font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> FileTarget ----------------------------</span><font></font>
<font></font>
			Target fileTarget = FileTarget(header, layout).MakeAsyncTarget();<font></font>
			config.AddTarget(fileTarget);<font></font>
			config.AddRuleForAllLevels(fileTarget);<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> ConsoleTarget ----------------------------</span><font></font>
<font></font>
			Target consoleTarget = ConsoleTarget(header, layout).MakeAsyncTarget();<font></font>
			config.AddTarget(consoleTarget);<font></font>
			config.AddRuleForAllLevels(consoleTarget);<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> DebuggerTarget ----------------------------</span><font></font>
<font></font>
			Target debugTarget = DebuggerTarget(header, layout).MakeAsyncTarget();<font></font>
			config.AddTarget(debugTarget);<font></font>
			config.AddRuleForAllLevels(debugTarget);<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> GelfTarget ----------------------------</span><font></font>
<font></font>
			<span class="hljs-comment">//       Graylog  ,    </span>
			<span class="hljs-keyword">if</span> (_settings.Statistics)<font></font>
			{<font></font>
				Target gelfTarget = GelfTarget(headerStr).MakeAsyncTarget();<font></font>
				config.AddTarget(gelfTarget);<font></font>
				config.AddRuleForAllLevels(gelfTarget);<font></font>
			}<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			LogFactory logFactory = <span class="hljs-keyword">new</span> LogFactory<font></font>
			{<font></font>
				Configuration = config<font></font>
			};<font></font>
<font></font>
			<span class="hljs-keyword">try</span><font></font>
			{<font></font>
				<span class="hljs-comment">// ,           </span><font></font>
				config.LoggingRules.ToList().ForEach(r =&gt; r.SetLoggingLevels(LogLevel.AllLevels.Min(), LogLevel.AllLevels.Max()));<font></font>
<font></font>
				_logConfig = config;<font></font>
			}<font></font>
			<span class="hljs-keyword">catch</span> (Exception ex)<font></font>
			{<font></font>
				<span class="hljs-comment">//  ,        </span><font></font>
				Debug.Write(ex);<font></font>
			}<font></font>
<font></font>
			<span class="hljs-keyword">return</span> logFactory;<font></font>
		}<font></font>
<font></font>
		<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> Target Methods</span><font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> FileTarget <span class="hljs-title">FileTarget</span>(<span class="hljs-params">Layout header, Layout layout</span>)</span><font></font>
		{<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> FileTarget ----------------------------</span><font></font>
<font></font>
			FileTarget fileTarget = <span class="hljs-keyword">new</span> FileTarget(<span class="hljs-string">"log_file_target"</span>)<font></font>
			{<font></font>
				ArchiveAboveSize = <span class="hljs-number">1048576</span>,<font></font>
				ArchiveDateFormat = <span class="hljs-string">"yyyy.MM.dd_HH.mm.ss"</span>,<font></font>
				ArchiveEvery = FileArchivePeriod.Day,<font></font>
				ArchiveFileName = GetApplicationLogAndArchivePath(<span class="hljs-literal">false</span>),<font></font>
				ArchiveNumbering = ArchiveNumberingMode.Date,<font></font>
				ArchiveOldFileOnStartup = <span class="hljs-literal">false</span>,<font></font>
				AutoFlush = <span class="hljs-literal">true</span>,<font></font>
				ConcurrentWrites = <span class="hljs-literal">true</span>,<font></font>
				DeleteOldFileOnStartup = <span class="hljs-literal">false</span>,<font></font>
				EnableArchiveFileCompression = <span class="hljs-literal">true</span>,<font></font>
				EnableFileDelete = <span class="hljs-literal">true</span>,<font></font>
				Encoding = Encoding.UTF8,<font></font>
				FileName = GetApplicationLogAndArchivePath(<span class="hljs-literal">true</span>),<font></font>
				Header = header,<font></font>
				Layout = layout,<font></font>
				MaxArchiveFiles = <span class="hljs-number">100</span>,<font></font>
				OpenFileCacheTimeout = <span class="hljs-number">30</span>,<font></font>
				OpenFileFlushTimeout = <span class="hljs-number">30</span>,<font></font>
				OptimizeBufferReuse = <span class="hljs-literal">true</span><font></font>
			};<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-keyword">return</span> fileTarget;<font></font>
		}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ColoredConsoleTarget <span class="hljs-title">ConsoleTarget</span>(<span class="hljs-params">Layout header, Layout layout</span>)</span><font></font>
		{<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> ConsoleTarget ----------------------------</span><font></font>
<font></font>
			ColoredConsoleTarget consoleTarget = <span class="hljs-keyword">new</span> ColoredConsoleTarget(<span class="hljs-string">"log_console_target"</span>)<font></font>
			{<font></font>
				Encoding = Encoding.UTF8,<font></font>
				EnableAnsiOutput = <span class="hljs-literal">false</span>,<font></font>
<font></font>
				UseDefaultRowHighlightingRules = <span class="hljs-literal">true</span>,<font></font>
<font></font>
				Layout = layout,<font></font>
				Header = header<font></font>
			};<font></font>
<font></font>
			ConsoleWordHighlightingRule dateHighLightRule = <span class="hljs-keyword">new</span> ConsoleWordHighlightingRule<font></font>
			{<font></font>
				Regex = <span class="hljs-string">@"^(?=\d).+(?=\s\[)"</span>,<font></font>
				ForegroundColor = ConsoleOutputColor.Yellow<font></font>
			};<font></font>
<font></font>
			ConsoleWordHighlightingRule methodsHighLightRule = <span class="hljs-keyword">new</span> ConsoleWordHighlightingRule<font></font>
			{<font></font>
				Regex = <span class="hljs-string">@"(?&lt;=\[).+(?=\])"</span>,<font></font>
				ForegroundColor = ConsoleOutputColor.Blue<font></font>
			};<font></font>
<font></font>
			ConsoleWordHighlightingRule levelHighLightRule = <span class="hljs-keyword">new</span> ConsoleWordHighlightingRule<font></font>
			{<font></font>
				Regex = <span class="hljs-string">@"(?&lt;=&gt;).+(?=\s:)"</span>,<font></font>
				ForegroundColor = ConsoleOutputColor.Red<font></font>
			};<font></font>
<font></font>
			ConsoleWordHighlightingRule messageHighLightRule = <span class="hljs-keyword">new</span> ConsoleWordHighlightingRule<font></font>
			{<font></font>
				Regex = <span class="hljs-string">@"(?&lt;=\s:\s).+"</span>,<font></font>
				ForegroundColor = ConsoleOutputColor.Green<font></font>
			};<font></font>
<font></font>
			consoleTarget.WordHighlightingRules.Add(dateHighLightRule);<font></font>
			consoleTarget.WordHighlightingRules.Add(methodsHighLightRule);<font></font>
			consoleTarget.WordHighlightingRules.Add(levelHighLightRule);<font></font>
			consoleTarget.WordHighlightingRules.Add(messageHighLightRule);<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-keyword">return</span> consoleTarget;<font></font>
		}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DebuggerTarget <span class="hljs-title">DebuggerTarget</span>(<span class="hljs-params">Layout header, Layout layout</span>)</span><font></font>
		{<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> DebuggerTarget ----------------------------</span><font></font>
<font></font>
			DebuggerTarget debugTarget = <span class="hljs-keyword">new</span> DebuggerTarget(<span class="hljs-string">"log_debug_target"</span>)<font></font>
			{<font></font>
				Layout = layout,<font></font>
				Header = header<font></font>
			};<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-keyword">return</span> debugTarget;<font></font>
		}<font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> GraylogHttpTarget <span class="hljs-title">GelfTarget</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> header</span>)</span><font></font>
		{<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">region</span> GelfTarget ----------------------------</span><font></font>
<font></font>
			Layout gelfCommonLayout = <span class="hljs-string">"${message}"</span>;<font></font>
<font></font>
			IList&lt;TargetPropertyWithContext&gt; gelfParameterInfos =<font></font>
				<span class="hljs-keyword">new</span> List&lt;TargetPropertyWithContext&gt;()<font></font>
				{<font></font>
					<span class="hljs-comment">//     : https://nlog-project.org/config/?tab=layout-renderers</span>
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"appdomain"</span>, Layout = <span class="hljs-string">"${appdomain}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"assembly-version"</span>, Layout = <span class="hljs-string">"${assembly-version}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"activityid"</span>, Layout = <span class="hljs-string">"${activityid}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"callsite"</span>, Layout = <span class="hljs-string">"${callsite}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"callsite-linenumber"</span>, Layout = <span class="hljs-string">"${callsite-linenumber}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"environment-user"</span>, Layout = <span class="hljs-string">"${environment-user:userName=true:domain=true}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"exeption_json_data"</span>, Layout = <span class="hljs-string">"${onexception:inner=${exception:format=@}}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"frameWorkInfo"</span>, Layout = <span class="hljs-string">$"<span class="hljs-subst">{RuntimeInformation.FrameworkDescription}</span> (<span class="hljs-subst">{RuntimeInformation.ProcessArchitecture}</span>)"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"guid"</span>, Layout = <span class="hljs-string">"${guid:format=N}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"hostname"</span>, Layout = <span class="hljs-string">"${hostname}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"identity"</span>, Layout = <span class="hljs-string">"${identity:authType=true:separator=\n:name=true:isAuthenticated=true}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"level_name"</span>, Layout = <span class="hljs-string">"${level:format=Name}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"local-ip"</span>, Layout = <span class="hljs-string">"${local-ip:addressFamily=InterNetwork}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"logger"</span>, Layout = <span class="hljs-string">"${logger:shortName=false}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"machinename"</span>, Layout = <span class="hljs-string">"${machinename}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"osInfo"</span>, Layout = <span class="hljs-string">$"<span class="hljs-subst">{RuntimeInformation.OSDescription}</span> (<span class="hljs-subst">{RuntimeInformation.OSArchitecture}</span>)"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"processid"</span>, Layout = <span class="hljs-string">"${processid}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"processinfo_MainWindowHandle"</span>, Layout = <span class="hljs-string">"${processinfo:property=MainWindowHandle}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"processinfo_PagedMemorySize"</span>, Layout = <span class="hljs-string">"${processinfo:property=PagedMemorySize}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"processname"</span>, Layout = <span class="hljs-string">"${processname:fullName=true}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"processtime"</span>, Layout = <span class="hljs-string">"${processtime:invariant=false}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"sequenceid"</span>, Layout = <span class="hljs-string">"${sequenceid}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"stacktrace"</span>, Layout = <span class="hljs-string">"${stacktrace:format=Raw:topFrames=3:skipFrames=0:separator=
}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"threadid"</span>, Layout = <span class="hljs-string">"${threadid}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"threadname"</span>, Layout = <span class="hljs-string">"${threadname}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"timestamp"</span>, Layout = <span class="hljs-string">$"<span class="hljs-subst">{DateTimeOffset.UtcNow.ToUnixTimeMilliseconds()}</span>"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"timestamp_local"</span>, Layout = <span class="hljs-string">@"${date:universalTime=false:format=yyyy-MM-dd HH\:mm\:ss zzz}"</span> },
					<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"windows-identity"</span>, Layout = <span class="hljs-string">"${windows-identity:userName=true:domain=true}"</span> }<font></font>
				};<font></font>
<font></font>
			GraylogHttpTarget gelfUdpTarget = <span class="hljs-keyword">new</span> GraylogHttpTarget<font></font>
			{<font></font>
				AddNLogLevelName = <span class="hljs-literal">true</span>,<font></font>
				Facility = header,<font></font>
				GraylogServer = _settings.LogServerAddress,<font></font>
				IncludeCallSite = <span class="hljs-literal">true</span>,<font></font>
				IncludeCallSiteStackTrace = <span class="hljs-literal">true</span>,<font></font>
				IncludeEventProperties = <span class="hljs-literal">true</span>,<font></font>
				Layout = gelfCommonLayout,<font></font>
				Name = <span class="hljs-string">"GelfHttp"</span>,<font></font>
				OptimizeBufferReuse = <span class="hljs-literal">true</span><font></font>
			};<font></font>
<font></font>
			<span class="hljs-keyword">foreach</span> (TargetPropertyWithContext gelfParameterInfo <span class="hljs-keyword">in</span> gelfParameterInfos)<font></font>
			{<font></font>
				gelfUdpTarget.ContextProperties.Add(gelfParameterInfo);<font></font>
			}<font></font>
<font></font>
			<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
			<span class="hljs-keyword">return</span> gelfUdpTarget;<font></font>
		}<font></font>
<font></font>
		<span class="hljs-comment">//   https://github.com/nlog/NLog/wiki/AsyncWrapper-target    </span>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Target <span class="hljs-title">MakeAsyncTarget</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Target targ</span>)</span><font></font>
		{<font></font>
			<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AsyncTargetWrapper<font></font>
			{<font></font>
				BatchSize = <span class="hljs-number">100</span>,<font></font>
				ForceLockingQueue = <span class="hljs-literal">true</span>,<font></font>
				FullBatchSizeWriteLimit = <span class="hljs-number">5</span>,<font></font>
				Name = targ.Name,<font></font>
				OptimizeBufferReuse = <span class="hljs-literal">true</span>,<font></font>
				OverflowAction = AsyncTargetWrapperOverflowAction.Grow,<font></font>
				QueueLimit = <span class="hljs-number">10000</span>,<font></font>
				TimeToSleepBetweenBatches = <span class="hljs-number">1</span>,<font></font>
				WrappedTarget = targ<font></font>
			};<font></font>
		}<font></font>
<font></font>
		<span class="hljs-meta">#<span class="hljs-meta-keyword">endregion</span></span><font></font>
<font></font>
		<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetApplicationLogAndArchivePath</span>(<span class="hljs-params"><span class="hljs-keyword">bool</span> isLog</span>)</span><font></font>
		{<font></font>
			<span class="hljs-keyword">string</span> addition;<font></font>
<font></font>
			<span class="hljs-keyword">if</span> (!isLog)<font></font>
			{<font></font>
				addition = <span class="hljs-string">".{#}.zip"</span>;<font></font>
			}<font></font>
			<span class="hljs-keyword">else</span><font></font>
			{<font></font>
				addition = <span class="hljs-string">".log"</span>;<font></font>
			}<font></font>
<font></font>
			<span class="hljs-keyword">try</span><font></font>
			{<font></font>
				<span class="hljs-keyword">if</span> (!Directory.Exists(_settings.LogsFolder))<font></font>
				{<font></font>
					Directory.CreateDirectory(_settings.LogsFolder);<font></font>
				}<font></font>
<font></font>
				<span class="hljs-keyword">return</span> Path.Combine(_settings.LogsFolder, _settings.ProductName + addition);<font></font>
			}<font></font>
			<span class="hljs-keyword">catch</span> (Exception ex)<font></font>
			{<font></font>
				Debug.Write(ex);<font></font>
				<span class="hljs-keyword">return</span> <span class="hljs-keyword">string</span>.Empty;<font></font>
			}<font></font>
		}<font></font>
}<font></font>
</code></pre></div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anwendungsbeispiel:</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword">using</span> NLog;<font></font>
...<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Downloader</span><font></font>
	{<font></font>
		...<font></font>
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Logger log = BimlibLogger.GetLogger();<font></font>
		...<font></font>
		<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">GetFileToConvert</span>(<span class="hljs-params">ConverterRequest.Inputitem inputItem</span>)</span><font></font>
		{<font></font>
			...<font></font>
			<span class="hljs-keyword">try</span><font></font>
			{<font></font>
				...<font></font>
				log.Debug(<span class="hljs-string">$"Downloaded file: <span class="hljs-subst">{downloadedFile}</span>, size: <span class="hljs-subst">{new FileInfo(downloadedFile).Length / <span class="hljs-number">1e6</span>}</span>Mb"</span>);<font></font>
			}<font></font>
			<span class="hljs-keyword">catch</span> (Exception ex)<font></font>
			{<font></font>
				log.Error(ex, ex.Source);<font></font>
				<span class="hljs-keyword">return</span> ...;<font></font>
			}<font></font>
		}<font></font>
	}<font></font>
</code></pre></div>
                    </div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein paar Details</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der bloße Code, wenn auch mit Kommentaren, ist nicht cool. </font><font style="vertical-align: inherit;">Daher werde ich eine Reihe von Konventionen und Annahmen beschreiben:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_settings</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ein bestimmtes Objekt von Einstellungen. </font><font style="vertical-align: inherit;">Es ist nicht zu wichtig, wie genau es gebildet wird, aber es muss vor der ersten Initialisierung des Loggers empfangen werden.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_logConfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - NLog-Konfiguration, die nicht in einer separaten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog.config-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><font style="vertical-align: inherit;">, sondern direkt im Code durchgeführt wird.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sagt </font><font style="vertical-align: inherit;">:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog erzeugt nur dann eine Ausgabe, wenn ein (oder mehrere) NLog-Ziele konfiguriert wurden.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eigentlich sind die Methoden in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zielmethoden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Region </font><font style="vertical-align: inherit;">sind verantwortlich für die </font><font style="vertical-align: inherit;">Erstellung dieser „Ziele“: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileTarget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - das Protokoll in eine Datei zu schreiben.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sieht eine Protokolldatei aus?</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/bn/fz/iw/bnfziwxjz-gabqdfyv92qkab3bq.png"></div>
                    </div><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ColoredConsoleTarget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - um "schöne" Nachrichten an die Konsole auszugeben (falls vorhanden).</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sieht eine Farbkonsole aus?</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/9p/b6/b0/9pb6b0idaxhi4t46opp5wsxk6oa.png"></div>
                    </div><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DebuggerTarget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zum Ausgeben von Logger-Nachrichten an das Visual Studio-Ausgabefenster oder an einen verbundenen Debugger eines Drittanbieters im Debug-Modus.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sehen NLog-Nachrichten im Debugger aus?</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/qo/4n/0j/qo4n0jtkpdylzlxtwhg7xplmmwo.png"></div>
                    </div><br>
 <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GraylogHttpTarget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ziel ist es, Nachrichten an den Server zu senden, auf denen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graylog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> installiert ist </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sieht eine Graylog-Nachricht aus?</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/l9/9j/vu/l99jvuf49hfnuy1attfxuxpg6hu.png"></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In meinem ersten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> über Habr erwähnte ich die Verwendung von Graylog. </font><font style="vertical-align: inherit;">Ich möchte auf das letzte Ziel auf der Liste eingehen. </font><font style="vertical-align: inherit;">Sie ermöglicht es Ihnen, mithilfe der NLog-Bibliothek Nachrichten aus der Anwendung an den Graylog-Dienst zu senden. </font><font style="vertical-align: inherit;">Ich werde versuchen, Ihnen zu sagen, wie mir dieses Tool persönlich gefallen hat.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über Graylog (ein wenig)</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Beschreibung der Installation und Konfiguration des Dienstes wird in diesem Artikel nicht enthalten. </font><font style="vertical-align: inherit;">Ich kann nur sagen, dass ich es im Docker bereitgestellt habe. </font><font style="vertical-align: inherit;">Dies wird auch in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich gebe Ihnen meine Erstellungsdatei</font></font></b>
                        <div class="spoiler_text"><pre><code class="powershell hljs">version: <span class="hljs-string">'2'</span><font></font>
services:<font></font>
  <span class="hljs-comment"># MongoDB: https://hub.docker.com/_/mongo/</span><font></font>
  mongodb:<font></font>
    image: mongo:<span class="hljs-number">4</span><font></font>
    restart: always<font></font>
    volumes:<font></font>
    - mongo_data:/<span class="hljs-keyword">data</span>/db:rw<font></font>
    - /etc/localtime:/etc/localtime  <font></font>
  <span class="hljs-comment"># Elasticsearch: https://www.elastic.co/guide/en/elasticsearch/reference/6.x/docker.html</span><font></font>
  elasticsearch:<font></font>
    image: docker.elastic.co/elasticsearch/elastic<span class="hljs-built_in">search-oss</span>:<span class="hljs-number">6.8</span>.<span class="hljs-number">2</span><font></font>
    restart: always<font></font>
    volumes:<font></font>
    - es_data:/usr/share/elasticsearch/<span class="hljs-keyword">data</span>:rw<font></font>
    - /etc/localtime:/etc/localtime<font></font>
    environment:<font></font>
      - http.host=<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><font></font>
      - transport.host=localhost<font></font>
      - network.host=<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>
      - <span class="hljs-string">"ES_JAVA_OPTS=-Xms512m -Xmx512m"</span><font></font>
    ulimits:<font></font>
      memlock:<font></font>
        soft: <span class="hljs-literal">-1</span>
        hard: <span class="hljs-literal">-1</span>
    mem_limit: <span class="hljs-number">1</span>g
  <span class="hljs-comment"># Graylog: https://hub.docker.com/r/graylog/graylog/</span>
  <span class="hljs-comment"># Graylog: I want to have the lastest</span><font></font>
  graylog:<font></font>
    image: graylog/graylog:<span class="hljs-number">3.2</span><font></font>
    restart: always<font></font>
    volumes:<font></font>
    - graylog_data:/usr/share/graylog/<span class="hljs-keyword">data</span>/journal:rw<font></font>
    - /etc/localtime:/etc/localtime<font></font>
<span class="hljs-comment"># :   .     - </span>
    - /home/MYUSER/graylog<span class="hljs-literal">-data</span>/plugin/graylog<span class="hljs-literal">-plugin</span><span class="hljs-literal">-telegram</span><span class="hljs-literal">-notification</span><span class="hljs-literal">-2</span>.<span class="hljs-number">3.0</span>.jar:/usr/share/graylog/plugin/graylog<span class="hljs-literal">-plugin</span><span class="hljs-literal">-telegram</span><span class="hljs-literal">-notification</span><span class="hljs-literal">-2</span>.<span class="hljs-number">3.0</span>.jar<font></font>
    environment:<font></font>
      <span class="hljs-comment"># CHANGE ME (must be at least 16 characters)!</span><font></font>
      - GRAYLOG_PASSWORD_SECRET=somepasswordpepper<font></font>
      <span class="hljs-comment"># Password: MYPASSWORD</span><font></font>
      - GRAYLOG_ROOT_PASSWORD_SHA2=SHA2MYPASSWORDPLEASEINANYONLINESERVICE<font></font>
      - GRAYLOG_HTTP_BIND_ADDRESS=<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">9999</span>
      - GRAYLOG_WEB_LISTEN_URI=http://my.ex.ipa.dr:<span class="hljs-number">9999</span>/<font></font>
      - GRAYLOG_HTTP_EXTERNAL_URI=http://my.ex.ipa.dr:<span class="hljs-number">9999</span>/<font></font>
      - GRAYLOG_HTTP_PUBLISH_URI=http://my.ex.ipa.dr:<span class="hljs-number">9999</span>/<font></font>
      - GRAYLOG_ROOT_TIMEZONE=Europe/Moscow<font></font>
      - GRAYLOG_PLUGIN_DIR=plugin<font></font>
    links:<font></font>
      - mongodb:mongo<font></font>
      - elasticsearch<font></font>
    depends_on:<font></font>
      - mongodb<font></font>
      - elasticsearch<font></font>
    ports:<font></font>
      - <span class="hljs-number">5044</span>:<span class="hljs-number">5044</span>
      <span class="hljs-comment"># Graylog web interface and REST API</span>
      - <span class="hljs-number">9999</span>:<span class="hljs-number">9999</span>
      <span class="hljs-comment"># Syslog TCP</span>
      - <span class="hljs-number">1514</span>:<span class="hljs-number">1514</span>
      <span class="hljs-comment"># Syslog UDP</span>
      - <span class="hljs-number">1514</span>:<span class="hljs-number">1514</span>/udp
      <span class="hljs-comment"># GELF TCP</span>
      - <span class="hljs-number">12201</span>:<span class="hljs-number">12201</span>
      <span class="hljs-comment"># GELF UDP</span>
      - <span class="hljs-number">12201</span>:<span class="hljs-number">12201</span>/udp
      <span class="hljs-comment">#Volumes</span><font></font>
volumes:<font></font>
  mongo_data:<font></font>
    driver: local<font></font>
  es_data:<font></font>
    driver: local<font></font>
  graylog_data:<font></font>
    driver: local<font></font>
</code></pre></div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich werde auch ein Beispiel für die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einstellung von</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> „Input“ in Graylog hinzufügen:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graylog überwacht den http-Verkehr auf Port 12201</font></font></b>
                        <div class="spoiler_text"><img src="https://habrastorage.org/webt/5o/ya/vj/5oyavjsjaxvtbwjdc9bae_jrcy8.png" align="left"><br>
<br>
<blockquote>Graylog nodes accept data via inputs. Launch or terminate as many inputs as you want here.</blockquote><br>
<br>
<s>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">my.web.adress.domain</a>   12201  -,      .       ...</s><br>
</div>
                    </div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Über GELF</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GELF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Graylog Extended Log Format. Das Format der Nachrichten, die Graylog wahrnimmt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um etwas im GELF-Format an eine bestimmte URL zu senden, müssen Sie ein zusätzliches </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziel verwenden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sie werden im Abschnitt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integrationen</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation vorgestellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog.Targets.GraylogHttp gewählt</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Installierte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nuget</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Projekt </font><font style="vertical-align: inherit;">und konnte </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog.Targets.GraylogHttp.GraylogHttpTarget</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Konfiguration seines Loggers verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das sehr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layout</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für Nachrichten , die </font><font style="vertical-align: inherit;">ich habe zu einer vereinfachten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachricht</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber gefüllt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ContextProperties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">target'a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> breite Palette von zusätzlichen Feldern:</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"someParamName1"</span>, Layout = <span class="hljs-string">"someStringInfo"</span> },
<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"someParamName2"</span>, Layout = <span class="hljs-string">"someNLogLayoutRendered"</span> },
<span class="hljs-keyword">new</span> TargetPropertyWithContext()  { Name = <span class="hljs-string">"someParamName3"</span>, Layout = (<span class="hljs-keyword">string</span>)SomeMethodThatGetsInfo() }</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe speziell verallgemeinerten Code verwendet, um das Prinzip klar zu machen: "beliebiger Name + beliebiger Wert". </font><font style="vertical-align: inherit;">Der Wert kann mit einer eigenen Methode erfolgreich "abgebaut" werden. </font><font style="vertical-align: inherit;">Lesen Sie beispielsweise die Netzwerkeinstellungen oder den freien Speicherplatz auf dem Systemlaufwerk. </font><font style="vertical-align: inherit;">Wie auch immer ...</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt eine Meinung (und ich bestreite es nicht), dass Protokolle am nützlichsten sind, wenn Fehler abgefangen werden. </font><font style="vertical-align: inherit;">Die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Try / Catch-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konstrukte </font><font style="vertical-align: inherit;">wurden erfolgreich eingesetzt und rechtfertigen sich in den meisten Fällen. </font><font style="vertical-align: inherit;">Das "Fehlerobjekt" selbst ist mit Debugging-Informationen, Daten über die Ereigniskette, wenn sie auftritt, und anderen Informationen gefüllt. </font><font style="vertical-align: inherit;">Es ist bequem zu lesen, dass ein solches Objekt nicht immer funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für mich habe ich diese Lösung entwickelt:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonusmethode für die Logger-Klasse zum Senden von Feldern von Objekten an Graylog:</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-comment">// -. ,    Graylog    - .</span>
		<span class="hljs-comment">//     objWithProps -            json (  GELF)...</span>
		<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LogEventInfo <span class="hljs-title">GetLogEventWithProperties</span>(<span class="hljs-params">LogLevel logLevel, <span class="hljs-keyword">string</span> logName, <span class="hljs-keyword">string</span> message, <span class="hljs-keyword">object</span> objWithProps</span>)</span><font></font>
		{<font></font>
			<span class="hljs-comment">//     ,      </span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">string</span>.IsNullOrEmpty(message))<font></font>
			{<font></font>
				message = objWithProps?.GetType()?.Name ?? <span class="hljs-string">"custom_json_data"</span>;<font></font>
			}<font></font>
<font></font>
			LogEventInfo e = <span class="hljs-keyword">new</span> LogEventInfo(logLevel, logName, message);<font></font>
<font></font>
			<span class="hljs-keyword">object</span> logEventProperty = <span class="hljs-literal">null</span>;
			<span class="hljs-comment">//     Newtonsoft.Json: https://www.newtonsoft.com/json</span>
			JsonSerializerSettings jsonSerializerSettings = <span class="hljs-keyword">new</span> JsonSerializerSettings<font></font>
			{<font></font>
				ReferenceLoopHandling = ReferenceLoopHandling.Serialize,<font></font>
				PreserveReferencesHandling = PreserveReferencesHandling.Objects,<font></font>
				NullValueHandling = NullValueHandling.Include<font></font>
			};<font></font>
<font></font>
			<span class="hljs-keyword">try</span><font></font>
			{<font></font>
				<span class="hljs-comment">//  ""  ()   ...</span><font></font>
				logEventProperty = JsonConvert.SerializeObject(objWithProps, Formatting.Indented, jsonSerializerSettings);<font></font>
			}<font></font>
			<span class="hljs-keyword">catch</span> (Exception ex)<font></font>
			{<font></font>
				Debug.Write(ex);<font></font>
<font></font>
				<span class="hljs-keyword">try</span><font></font>
				{<font></font>
					<span class="hljs-comment">// ...,   :  ,   , ...</span>
					IEnumerable&lt;PropertyInfo&gt; objProps = objWithProps?.GetType()?.GetProperties()?.Where(p =&gt; p?.GetGetMethod()?.GetParameters()?.Length == <span class="hljs-number">0</span>);<font></font>
<font></font>
					<span class="hljs-keyword">if</span> (objProps?.Any() == <span class="hljs-literal">true</span>)<font></font>
					{<font></font>
						<span class="hljs-comment">// ...   ,...</span>
						Dictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt; objPropsDict =<font></font>
							objProps<font></font>
							.ToDictionary(<font></font>
								x =&gt; x?.Name,<font></font>
								x =&gt;<font></font>
								{<font></font>
									<span class="hljs-keyword">string</span> rezVal = <span class="hljs-keyword">string</span>.Empty;
									<span class="hljs-keyword">try</span><font></font>
									{<font></font>
										rezVal = x?.GetValue(objWithProps, <span class="hljs-literal">null</span>)?.ToString();<font></font>
									}<font></font>
									<span class="hljs-keyword">catch</span> (Exception ex0)<font></font>
									{<font></font>
										Debug.Write(ex0);<font></font>
									}<font></font>
									<span class="hljs-keyword">return</span> rezVal;<font></font>
								}<font></font>
							)?<font></font>
							.OrderBy(x =&gt; x.Key)?<font></font>
							.ToDictionary(obj =&gt; obj.Key, obj =&gt; obj.Value);<font></font>
						<span class="hljs-comment">// ...   Newtonsoft.Json</span><font></font>
						logEventProperty = JsonConvert.SerializeObject(objPropsDict, Formatting.Indented, jsonSerializerSettings);<font></font>
					}<font></font>
				}<font></font>
				<span class="hljs-keyword">catch</span> (Exception ex1)<font></font>
				{<font></font>
					Debug.Write(ex1);<font></font>
				}<font></font>
			}<font></font>
			<span class="hljs-comment">//   json-,  Graylog      .</span>
			e.Properties[<span class="hljs-string">"custom_json_data"</span>] = logEventProperty;
			<span class="hljs-keyword">return</span> e;<font></font>
		}<font></font>
</code></pre><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anwendungsbeispiel:</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs">log.Debug(BimlibLogger.GetLogEventWithProperties(LogLevel.Debug, log.Name, <span class="hljs-string">$"Got the task"</span>, message));</code></pre><br>
</div>
                    </div><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie sieht es in Graylog aus?</font></font></b>
                        <div class="spoiler_text"> <i>exeption_json_data</i> — <i>exception</i>,   json.<br>
<br>
<img src="https://habrastorage.org/webt/q0/fw/tz/q0fwtze_zbep1dbbwzlqecz2e3q.png"><br>
<br>
  <i>exception</i>,   .<br>
<br>
<img src="https://habrastorage.org/webt/m3/7b/km/m37bkmo_szukwtunyvkxukrw9hm.png"><br>
</div>
                    </div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnis</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis der Anwendung des beschriebenen Ansatzes und einer angemessenen Implementierung der Logger-Aufrufe in den Codetext erhalten wir eine zentralisierte Sammlung von Protokollen mit einer praktischen Schnittstelle zum Lesen, Parsen und Analysieren. </font><font style="vertical-align: inherit;">Wir haben ein praktisches Tool für Benachrichtigungen über bestimmte Werte in den Protokollen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch die üblichen Protokolldateien, die ebenfalls erneut gelesen werden können, ziehen Schlussfolgerungen, verschwinden nicht. </font><font style="vertical-align: inherit;">Es ist kein Konkurrent oder Ersatz für Überwachungssysteme. </font><font style="vertical-align: inherit;">Aber jetzt ist die Situation "Meine Anwendung läuft auf über 100 sehr unterschiedlichen Computern in mehr als 3 fremdsprachigen Ländern und bricht plötzlich irgendwo ab" etwas einfacher und viel schneller gelöst.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist alles?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Im Prinzip habe ich Ihnen alles gesagt, was Sie für eine relativ komfortable Protokollierung Ihrer Anwendungen benötigen. </font><font style="vertical-align: inherit;">Bereit zu diskutieren, Tipps zu bekommen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danke fürs Lesen. </font><font style="vertical-align: inherit;">Wir sehen uns in den Kommentaren. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AsyncWrapper- </font></font></i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ziele wurden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur </font><font style="vertical-align: inherit;">Arbeit </font><font style="vertical-align: inherit;">an den Ratschlägen </font><font style="vertical-align: inherit;">hinzugefügt</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Justmara</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de498952/index.html">Wir laden zu DINS JS EVENING ein: Wir sprechen über aspektorientierte Programmierung und das Vuejs 3 Composition API Framework</a></li>
<li><a href="../de498958/index.html">Fehler ist nicht UIAlertController</a></li>
<li><a href="../de498962/index.html">Über Multitasking: Fenster unter Kontrolle</a></li>
<li><a href="../de498970/index.html">Kubernetes ConfigMaps: Nuancen zu wissen</a></li>
<li><a href="../de498976/index.html">Einführung in .NET 5.0 Vorschau 3</a></li>
<li><a href="../de498982/index.html">Disketten für Dreamcast</a></li>
<li><a href="../de498984/index.html">Stealth School: 5 Arten von Gadgets in Stealth-Spielen</a></li>
<li><a href="../de498988/index.html">Arbeitssuche in Übersee und Einwanderung nach Kanada</a></li>
<li><a href="../de498990/index.html">Gamepad-Unterstützung für Omega Red Emulator</a></li>
<li><a href="../de498996/index.html">Unterschied zwischen Web Sockets und Socket.IO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>