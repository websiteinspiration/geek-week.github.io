<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🏭 🚴🏿 🧔🏼 "Quelles marinas?" ou nous contrôlons le contrôleur via Bluetooth en utilisant une application mobile sur Xamarin (Android) 👨🏼‍🎓 🐍 ☮️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans un article précédent , j'ai promis de parler de la façon de connecter CANNY 3 Tiny en utilisant UART à Bluetooth. Et comme vous ne vous promenez ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>"Quelles marinas?" ou nous contrôlons le contrôleur via Bluetooth en utilisant une application mobile sur Xamarin (Android)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500454/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> précédent </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> j'ai promis de parler de la façon de connecter CANNY 3 Tiny en utilisant UART à Bluetooth. </font><font style="vertical-align: inherit;">Et comme vous ne vous promenez pas vraiment pendant ces vacances de mai, il a été décidé de passer du temps avec des avantages et de tenir la promesse. </font><font style="vertical-align: inherit;">Mais juste pour connecter le contrôleur à l'adaptateur Bluetooth HC-06, ce serait trop facile pour Habr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, nous ne nous contenterons pas de tout connecter, mais nous écrirons également une application Android primitive pour notre circuit en utilisant C # et Xamarin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous aimez surveiller les "fins de course" et les interrupteurs à lames, comme je l'adore, vous êtes les bienvenus sous cat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/a6/2t/ai/a62taim0dwnonrmzzjhicax8q-g.png"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ce dont nous allons parler aujourd'hui: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie I: Introduction </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie II: Connexion du circuit et du programme pour CANNY 3 minuscule </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie III: Nous écrivons une application sur Xamarin pour Android </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie IV: Conclusion</font></font></a><br>
<a name="I"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie I: Introduction</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais commencer par le bon, sauf pour les insertions du code du programme en C #, alors cette fois l'article sera relativement petit, car nous avons examiné les techniques de base de travailler avec le contrôleur plus tôt. </font><font style="vertical-align: inherit;">Afin de ne pas répéter encore une fois, voici une liste d'articles dans lesquels nous avons déjà examiné les méthodes de base de travail avec le contrôleur CANNY:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Un, deux, trois - brûlez le sapin de Noël!" </font><font style="vertical-align: inherit;">ou mon premier aperçu du petit contrôleur CANNY 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - dans cet article, nous avons analysé ce qu'est le contrôleur, ainsi que les bases du travail dans l'environnement de développement CannyLab.</font></font><br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`` La destination a beaucoup de formes ... '' ou nous automatisons le contrôle d'une lampe à l'aide de CANNY 3 Tiny et d'une photorésistance</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - dans cet article, nous avons examiné le travail avec le port COM virtuel USB, la connexion des capteurs à l'ADC, ainsi que le PWM haute fréquence aux sorties du contrôleur.</font></font><br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«  ...»         (CANNY  Arduino)  Raspberry PI</a> —        UART,     .<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour préparer cet article, j'ai utilisé le matériel suivant: petit contrôleur CANNY 3, adaptateur Bluetooth HC-06, interrupteur de fin de course (module Trema), interrupteur à lames, vieux écouteurs filaires, planche à pain, fils, crocodiles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons construire un système qui, à l'aide d'une application mobile, surveille l'état de deux capteurs et, si nécessaire, peut déclencher manuellement une alarme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce qui sera présenté dans cet article est inventé uniquement à des fins éducatives et de démonstration. Je voulais juste montrer quelques astuces de travail avec le contrôleur, ainsi que pour les morceaux de fer achetés à un moment donné pour déterminer leur valeur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Malgré la nature du problème en cours de résolution, loin de la réalité, nous imaginerons que nous réalisons un système de surveillance derrière la porte coulissante du compartiment. </font><font style="vertical-align: inherit;">Quand il commence à bouger, le commutateur à lames fonctionnera et à la fin du chemin, il donnera un signal à la remorque. </font><font style="vertical-align: inherit;">Si nous devons attirer l'attention, par exemple, pour que la porte soit refermée, nous émettrons un signal "grinçant" par le haut-parleur. </font><font style="vertical-align: inherit;">C'est vrai, je n'ai pas de haut-parleur, mais il y a de vieux écouteurs. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/wn/cn/jqwncnwbb_hvquu7qyfhlvhw10q.png"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien et, comme toujours, une note. </font><font style="vertical-align: inherit;">Je ne recommande pas fortement d'utiliser les matériaux de cet article comme la vérité ultime. </font><font style="vertical-align: inherit;">J'ai fait beaucoup de choses pour la première fois moi-même, elles peuvent certainement être mieux faites.</font></font><br>
</i><br>
<a name="II"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie II: Connexion du circuit et du programme pour CANNY 3 Tiny</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, afin de ne pas offenser qui que ce soit en matière de droit d'auteur, j'ai emprunté au </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais moi-même je les ai adaptés pour l' </font><font style="vertical-align: inherit;">idée de connecter le contrôleur au HC-06, en le contrôlant via l'application «Serial bluetooth terminal» et quelques astuces lors du développement du schéma </font><font style="vertical-align: inherit;">ta tâche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le schéma de connexion est le suivant: l' </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kt/lj/7c/ktlj7chkvqtuk-omahss0xxyxx4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
interrupteur de fin de course et l'interrupteur à lames sont connectés aux bornes du contrôleur n ° 6 et n ° 5, les écouteurs à la borne n ° 4 (il a un PWM RF), UART RX est la borne n ° 1, UART TX est la borne n ° 2, la borne n ° 3 Il est utilisé pour fournir «+ 5V», la sortie «-» - pour la communication avec la «masse». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici à quoi cela ressemble dans l'assemblage:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/57/hy/du/57hydukatcvw7-mihshfkaykr20.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai développé le diagramme (programme) pour CANNY 3 tiny dans CannyLab version 1.42, peut-être dans d'autres versions de l'environnement de développement et avec d'autres contrôleurs, il sera nécessaire d'apporter des modifications au diagramme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ce qui s'est passé: les </font></font><br>
<br>
<img src="https://habrastorage.org/webt/l8/mb/yr/l8mbyr6rzisiqurje5vrboprrio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
blocs associés à la configuration du contrôleur et à l'envoi de messages via UART ont été démontés dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article précédent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Examinons plus en détail les deux restants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le bloc « </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recevoir le message UART</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> » </font><font style="vertical-align: inherit;">est chargé d'allumer la sirène (casque). En principe, il est nécessaire d'analyser un exemple de réception d'un message via UART.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous vérifions si les données reçues sont dans l'UART, si c'est le cas, puis nous en envoyons une à l'entrée D-trigger "E", auquel cas le déclencheur copie la valeur de l'entrée "D" dans laquelle nous écrirons les deux premiers caractères du message reçu via UART. Je ne voulais pas tout compliquer, nous allons donc utiliser un schéma simple plus loin. Nous supposons que selon UART, n'importe quel nombre de 00 à 99 nous parviendra, nous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">convertirons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ce nombre d'une forme symbolique en une forme numérique (je recommande de lire comment fonctionne </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">le bloc convertisseur;</font></a><font style="vertical-align: inherit;"> j'avais une petite «prise» avec lui). En outre, toute valeur "&gt; 0" à l'entrée du détecteur de front montant provoque un signal unique, qui active la sortie 5 pendant 5 secondes, fonctionnant en mode RF PWM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez jouer dans les réglages avec la période de remplissage du RF PWM, le son dans le casque en dépendra. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons au bloc</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Formation du message</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">"</font></b><font style="vertical-align: inherit;"> Sa mise en œuvre à première vue peut paraître inhabituelle. Cela s'explique par le fait que je n'ai pas vraiment compris comment travailler avec le programme de terminal Bluetooth série et avec le même protocole Bluetooth dans Xamarin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je vais courir un peu plus loin et dire que je n'ai pas appris à recevoir les messages envoyés par le contrôleur sur mon smartphone. Si tout était évident avec l'UART filaire dans le dernier article, alors avec Bluetooth, en pratique, au lieu du message envoyé, seule sa partie peut être lue et la signification de la commande transmise est violée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai décidé que la solution la plus simple est de transmettre un seul numéro, ce qui garantit d'atteindre le destinataire sans perte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans notre cas, nous surveillons l'état discret du commutateur à lames et du fin de course. Autrement dit, nous n'avons que 4 combinaisons possibles: l'interrupteur à lames et l'interrupteur de fin de course sont désactivés, un seul est activé, les deux sont activés. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que l'interrupteur à lames et l'interrupteur de fin de course donnent un signal discret (0/1), vous devez en quelque sorte les distinguer. Pour ce faire, nous multiplions la valeur du signal reed par 2. Maintenant, il s'avère que la somme des signaux nous donnera des valeurs de 0 à 3. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant analyser une option non évidente avec cinquante ajoutées à cette valeur. Le fait est que CannyLab transfère quelques caractères à UART, c'est-à-dire au lieu de 3, disons 03, mais comme je l'ai dit, il y a un risque de perdre certaines informations. Par exemple, à partir de la valeur 01, le programme sur le smartphone ne peut lire que le premier "0", et ce sera déjà une erreur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il serait possible de se confondre et de transformer les données, en remplaçant, par exemple, le caractère «D1» du registre par une lettre ou un espace, mais j'ai décidé de le rendre plus facile. J'ai converti la valeur 01 en 51 (02 en 52, etc.). Les cinq ne portent pas de signal et je l'ai coupé au niveau du programme pour un smartphone. Ainsi, nous garantissons toujours que la partie utile du message demeure. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous chargeons le programme dans le contrôleur, cliquez sur «Exécuter», si tout fonctionne comme prévu, le HC-06 clignotera périodiquement une LED rouge. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous couplons le smartphone avec l'adaptateur. Vous pouvez maintenant vérifier les performances dans l'application «Terminal Bluetooth série» ou tout autre avec des fonctionnalités similaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notez l'adresse de l'adaptateur Bluetooth, elle nous sera utile dans le chapitre suivant.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7q/9_/cj/7q9_cjavutr8evwh-bzcjo7lu_o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, les données arrivent, selon l'état des capteurs, et si vous envoyez "11", alors un méchant grincement se fait entendre dans les écouteurs. </font><font style="vertical-align: inherit;">Nous pourrions nous arrêter ici, mais esquissons une application primitive. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le programme pour le contrôleur et le code source du programme pour le smartphone peuvent être téléchargés depuis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub.Je</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
voudrais noter que vous n'avez pas à implémenter tout dans le matériel spécifiquement sur les contrôleurs CANNY, vous pouvez écrire un programme pour Arduino ou un autre contrôleur que vous aimez. </font><font style="vertical-align: inherit;">Initialement, j'avais moi-même prévu d'écrire une version supplémentaire du croquis pour Arduino, mais depuis que j'ai tué presque toutes les vacances de mai, je n'avais tout simplement pas la force de connecter CANNY et l'application smartphone.</font></font><br>
<a name="III"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Partie III: Écriture d'une application Android Xamarin </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je sais que Xamarin, pour le moins, n'est pas la solution la plus populaire pour le développement mobile. Et vous avez peut-être déjà une question: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Pourquoi l'ai-je choisie?"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Je voudrais lui répondre avec des paroles de la chanson du même nom de Psoya Korolenko: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ky/lq/bd/kylqbdcllbxokagsfxfjtasavrg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Honnêtement, il n'y a pas de raisons objectives. Il y a quelques années à peine, j'ai appris les bases du C # et tout le monde voulait voir ce qu'est Xamarin. Et maintenant, en raison de "l'auto-isolement", les mains ont finalement atteint. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, permettez-moi de vous rappeler à nouveau. C'est ma première rencontre avec Xamarin et c'est ma première application Android. Ne copiez pas aveuglément mon code de courbe, si soudain vous pouvez trouver une plus belle solution, utilisez-la. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du développement de mon programme, je me suis appuyé sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce matériel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">L'article n'est pas particulièrement mâché, et même en espagnol, j'ai donc jugé approprié de partager avec vous ma variation sur ce sujet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai créé le programme dans l'édition communautaire de Visual studio 2019. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, créez un nouveau projet Android vide (Xamarin), comme dans l'image. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/ic/hz/gwichz5ldmq0k8wgpoedzpnt41u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai apporté des modifications à seulement trois fichiers, ils peuvent être affichés entièrement sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et ici nous analyserons uniquement les parties importantes: les </font><font style="vertical-align: inherit;">
autorisations </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidManifest.xml</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2 sont ajoutées au modèle standard:</font></font><br>
<br>
<pre><code class="cs hljs">  &lt;uses-permission android:name=<span class="hljs-string">"android.permission.BLUETOOTH"</span>/&gt;<font></font>
  &lt;uses-permission android:name=<span class="hljs-string">"android.permission.BLUETOOTH_ADMIN"</span>/&gt;
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activity_main.xml Le</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
conteneur par défaut (RelativeLayout) a été supprimé. </font><font style="vertical-align: inherit;">Au lieu de cela, le conteneur LinearLayout a été ajouté simplement parce qu'il est plus simple. </font><font style="vertical-align: inherit;">Dans ce conteneur, tous les éléments sont alignés verticalement, s'étendant sur toute la largeur de l'écran.</font></font><br>
<br>
<pre><code class="cs hljs">&lt;LinearLayout<font></font>
    xmlns:android=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    android:orientation=<span class="hljs-string">"vertical"</span>
    android:minWidth=<span class="hljs-string">"25px"</span>
    android:minHeight=<span class="hljs-string">"25px"</span>
    android:layout_width=<span class="hljs-string">"match_parent"</span>
    android:layout_height=<span class="hljs-string">"match_parent"</span>
    android:id=<span class="hljs-string">"@+id/linearLayout1"</span>&gt;<font></font>
    &lt;TextView<font></font>
        android:text=<span class="hljs-string">"Reed switch status - undefined"</span>
        android:layout_width=<span class="hljs-string">"match_parent"</span>
        android:layout_height=<span class="hljs-string">"wrap_content"</span>
        android:id=<span class="hljs-string">"@+id/rSwitch"</span>
        android:textSize=<span class="hljs-string">"12pt"</span> /&gt;<font></font>
    &lt;TextView<font></font>
        android:text=<span class="hljs-string">"End sensor status - undefined"</span>
        android:layout_width=<span class="hljs-string">"match_parent"</span>
        android:layout_height=<span class="hljs-string">"wrap_content"</span>
        android:id=<span class="hljs-string">"@+id/EndSensor"</span>
        android:textSize=<span class="hljs-string">"12pt"</span> /&gt;<font></font>
    &lt;Button<font></font>
        android:layout_width=<span class="hljs-string">"match_parent"</span>
        android:layout_height=<span class="hljs-string">"wrap_content"</span>
        android:id=<span class="hljs-string">"@+id/startSiren"</span>
        android:text=<span class="hljs-string">"Send signal to siren"</span> /&gt;<font></font>
    &lt;Switch<font></font>
        android:layout_width=<span class="hljs-string">"match_parent"</span>
        android:layout_height=<span class="hljs-string">"wrap_content"</span>
        android:id=<span class="hljs-string">"@+id/bltSwitch"</span>
        android:<span class="hljs-keyword">checked</span>=<span class="hljs-string">"false"</span>
        android:showText=<span class="hljs-string">"true"</span>
        android:text=<span class="hljs-string">"Connect bluetooth"</span> /&gt;<font></font>
    &lt;TextView<font></font>
        android:text=<span class="hljs-string">"status"</span>
        android:textAppearance=<span class="hljs-string">"?android:attr/textAppearanceSmall"</span>
        android:layout_width=<span class="hljs-string">"match_parent"</span>
        android:layout_height=<span class="hljs-string">"wrap_content"</span>
        android:id=<span class="hljs-string">"@+id/status"</span> /&gt;<font></font>
&lt;/LinearLayout&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quiconque connaît un peu la mise en page HTML ou XML peut facilement comprendre la structure de l'interface utilisateur. </font><font style="vertical-align: inherit;">Nous avons trois champs de texte en lecture seule (TextView), un commutateur (Switch), qui fonctionne essentiellement comme une case à cocher et un bouton ordinaire (Button). </font><font style="vertical-align: inherit;">Les éléments peuvent être placés sur le formulaire par glisser-déposer depuis le constructeur, et dans la fenêtre des propriétés ou dans le code pour les définir des ID plus pratiques, des talons de texte et d'autres paramètres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste à décrire la logique du programme. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MainActivity.cs</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ci-dessous, sous le spoiler, le code entier est pour plus de commodité</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code MainActivity.cs complet</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-comment">// based on http://alejandroruizvarela.blogspot.com/2014/01/bluetooth-arduino-xamarinandroid.html</span>
<span class="hljs-comment">// for this article https://habr.com/ru/post/500454/</span><font></font>
<font></font>
<font></font>
<span class="hljs-comment">// based on http://alejandroruizvarela.blogspot.com/2014/01/bluetooth-arduino-xamarinandroid.html</span>
<span class="hljs-comment">// for this article https://habr.com/ru/post/500454/</span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword">using</span> Android.App;
<span class="hljs-keyword">using</span> Android.OS;
<span class="hljs-keyword">using</span> Android.Support.V7.App;
<span class="hljs-keyword">using</span> Android.Runtime;
<span class="hljs-keyword">using</span> Android.Widget;
<span class="hljs-keyword">using</span> System.Linq;
<span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.IO;
<span class="hljs-keyword">using</span> Java.Util;
<span class="hljs-keyword">using</span> Android.Bluetooth;
<span class="hljs-keyword">using</span> System.Threading.Tasks;<font></font>
<font></font>
<span class="hljs-keyword">namespace</span> _6.<span class="hljs-title">Canny_Xanarin_Bluetooth_Android</span><font></font>
{<font></font>
    [<span class="hljs-meta">Activity(Label = <span class="hljs-meta-string">"Control Canny 3 tiny via bluetooth"</span>, Theme = <span class="hljs-meta-string">"@style/AppTheme"</span>, MainLauncher = true)</span>]
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-title">AppCompatActivity</span><font></font>
    {<font></font>
<font></font>
        Button startSiren;<font></font>
        TextView rSwitch;<font></font>
        TextView EndSensor;<font></font>
        Switch bltSwitch;<font></font>
        TextView status;<font></font>
        <span class="hljs-keyword">private</span> Java.Lang.String dataToSend;
        <span class="hljs-keyword">private</span> BluetoothAdapter mBluetoothAdapter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">private</span> BluetoothSocket btSocket = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">private</span> Stream outStream = <span class="hljs-literal">null</span>;
        <span class="hljs-comment">// don't forget change addres to your device:</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> address = <span class="hljs-string">"98:D3:91:F9:6C:F6"</span>;
        <span class="hljs-comment">// MY_UUID can be saved as is</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UUID MY_UUID = UUID.FromString(<span class="hljs-string">"00001101-0000-1000-8000-00805F9B34FB"</span>);
        <span class="hljs-keyword">private</span> Stream inStream = <span class="hljs-literal">null</span>;<font></font>
<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnCreate</span>(<span class="hljs-params">Bundle savedInstanceState</span>)</span><font></font>
        {<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.OnCreate(savedInstanceState);<font></font>
            Xamarin.Essentials.Platform.Init(<span class="hljs-keyword">this</span>, savedInstanceState);
            <span class="hljs-comment">// Set our view from the "main" layout resource</span><font></font>
            SetContentView(Resource.Layout.activity_main);<font></font>
<font></font>
            startSiren = FindViewById&lt;Button&gt;(Resource.Id.startSiren);<font></font>
            rSwitch = FindViewById&lt;TextView&gt;(Resource.Id.rSwitch);<font></font>
            EndSensor = FindViewById&lt;TextView&gt;(Resource.Id.EndSensor);<font></font>
            status = FindViewById&lt;TextView&gt;(Resource.Id.status);<font></font>
            bltSwitch = FindViewById&lt;Switch&gt;(Resource.Id.bltSwitch);<font></font>
<font></font>
<font></font>
            startSiren.Click += startSiren_ClickOnButtonClicked;<font></font>
            bltSwitch.CheckedChange += bltSwitch_HandleCheckedChange;<font></font>
            CheckBt();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckBt</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            mBluetoothAdapter = BluetoothAdapter.DefaultAdapter;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (!mBluetoothAdapter.Enable())<font></font>
            {<font></font>
                Toast.MakeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"Bluetooth Off"</span>,<font></font>
                    ToastLength.Short).Show();<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mBluetoothAdapter == <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                Toast.MakeText(<span class="hljs-keyword">this</span>,
                    <span class="hljs-string">"Bluetooth does not exist or is busy"</span>, ToastLength.Short)<font></font>
                    .Show();<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">startSiren_ClickOnButtonClicked</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, EventArgs e</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (bltSwitch.Checked)<font></font>
            {<font></font>
                <span class="hljs-keyword">try</span><font></font>
                {<font></font>
                    dataToSend = <span class="hljs-keyword">new</span> Java.Lang.String(<span class="hljs-string">"11"</span>);<font></font>
                    writeData(dataToSend);<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Send signal to siren"</span>);<font></font>
                }<font></font>
                <span class="hljs-keyword">catch</span> (System.Exception execept)<font></font>
                {<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Error when send data"</span> + execept.Message);<font></font>
                }<font></font>
<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> status.Text = <span class="hljs-string">"bluetooth not connected"</span>;<font></font>
        }<font></font>
        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bltSwitch_HandleCheckedChange</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, CompoundButton.CheckedChangeEventArgs e</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (e.IsChecked)<font></font>
            {<font></font>
                Connect();<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                status.Text = <span class="hljs-string">"bluetooth not connected"</span>;
                <span class="hljs-keyword">if</span> (btSocket.IsConnected)<font></font>
                {<font></font>
                    <span class="hljs-keyword">try</span><font></font>
                    {<font></font>
                        btSocket.Close();<font></font>
                        System.Console.WriteLine(<span class="hljs-string">"Connection closed"</span>);<font></font>
                    }<font></font>
                    <span class="hljs-keyword">catch</span> (System.Exception ex)<font></font>
                    {<font></font>
                        Console.WriteLine(ex.Message);<font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            BluetoothDevice device = mBluetoothAdapter.GetRemoteDevice(address);<font></font>
            System.Console.WriteLine(<span class="hljs-string">"Connection in progress"</span> + device);<font></font>
            mBluetoothAdapter.CancelDiscovery();<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                btSocket = device.CreateRfcommSocketToServiceRecord(MY_UUID);<font></font>
                btSocket.Connect();<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Correct Connection"</span>);<font></font>
                status.Text = <span class="hljs-string">"Correct Connection to bluetooth"</span>;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                Console.WriteLine(e.Message);<font></font>
                <span class="hljs-keyword">try</span><font></font>
                {<font></font>
                    btSocket.Close();<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Connection closed"</span>);<font></font>
                }<font></font>
                <span class="hljs-keyword">catch</span> (System.Exception)<font></font>
                {<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Impossible to connect"</span>);<font></font>
                    status.Text = <span class="hljs-string">"Impossible to connect"</span>;<font></font>
                }<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Socket Created"</span>);<font></font>
  <font></font>
            }<font></font>
            beginListenForData();<font></font>
<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">beginListenForData</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                inStream = btSocket.InputStream;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.IO.IOException ex)<font></font>
            {<font></font>
                Console.WriteLine(ex.Message);<font></font>
            }<font></font>
            Task.Factory.StartNew(() =&gt; {<font></font>
                <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];
                <span class="hljs-keyword">int</span> bytes;<font></font>
                <font></font>
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<font></font>
                {<font></font>
<font></font>
                    <span class="hljs-keyword">try</span><font></font>
                    {<font></font>
                        bytes = inStream.Read(buffer, <span class="hljs-number">0</span>, <span class="hljs-number">1024</span>);<font></font>
                        System.Console.WriteLine(<span class="hljs-string">"bytes "</span> + bytes.ToString());
                        <span class="hljs-keyword">if</span> (bytes &gt; <span class="hljs-number">0</span>)<font></font>
                        {<font></font>
                            <font></font>
                            RunOnUiThread(() =&gt; {<font></font>
                                <span class="hljs-keyword">string</span> valor = System.Text.Encoding.ASCII.GetString(buffer).Replace(<span class="hljs-string">"5"</span>,String.Empty);
                                <span class="hljs-comment">// transform string for deleate all symbols except 1-4(command from canny).</span>
                                <span class="hljs-keyword">string</span> command = <span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>(valor.Where(<span class="hljs-keyword">char</span>.IsDigit).ToArray());<font></font>
<font></font>
                                <span class="hljs-keyword">if</span> (command.Length &gt; <span class="hljs-number">0</span>)<font></font>
                                {<font></font>
                                     status.Text=<span class="hljs-string">"data successfully readed"</span>;<font></font>
                                    System.Console.WriteLine(<span class="hljs-string">"command  "</span> + command);
                                    <span class="hljs-keyword">switch</span> (Int32.Parse(command))<font></font>
                                    {<font></font>
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - disconnected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - not pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - disconnected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - connected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - not pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - connected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - pressed "</span>;
                                        <span class="hljs-keyword">break</span>;<font></font>
                                    }<font></font>
                                }<font></font>
                            });<font></font>
                        }<font></font>
                    }<font></font>
                    <span class="hljs-keyword">catch</span> (Java.IO.IOException)<font></font>
                    {<font></font>
                        RunOnUiThread(() =&gt; {<font></font>
                            EndSensor.Text = <span class="hljs-string">"End sensor status - undefined"</span>;<font></font>
                            rSwitch.Text = <span class="hljs-string">"Reed switch status - undefined "</span>;<font></font>
                        });<font></font>
                        <span class="hljs-keyword">break</span>;<font></font>
                    }<font></font>
                }<font></font>
            });<font></font>
        }<font></font>
<font></font>
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeData</span>(<span class="hljs-params">Java.Lang.String data</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                outStream = btSocket.OutputStream;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Error with OutputStream when write to Serial port"</span> + e.Message);<font></font>
            }<font></font>
<font></font>
            Java.Lang.String message = data;<font></font>
<font></font>
            <span class="hljs-keyword">byte</span>[] msgBuffer = message.GetBytes();<font></font>
<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                outStream.Write(msgBuffer, <span class="hljs-number">0</span>, msgBuffer.Length);<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Message sent"</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Error with  when write message to Serial port"</span> + e.Message);<font></font>
                status.Text = <span class="hljs-string">"Error with  when write message to Serial port"</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnRequestPermissionsResult</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> requestCode, <span class="hljs-keyword">string</span>[] permissions, [GeneratedEnum] Android.Content.PM.Permission[] grantResults</span>)</span><font></font>
        {<font></font>
            Xamarin.Essentials.Platform.OnRequestPermissionsResult(requestCode, permissions, grantResults);<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.OnRequestPermissionsResult(requestCode, permissions, grantResults);<font></font>
        }<font></font>
    }<font></font>
 }<font></font>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant en parties. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Blocs avec connexion d'espaces de noms, déclaration de classe, etc. </font><font style="vertical-align: inherit;">Je vais manquer. </font></font><br>
 <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous créons des variables avec lesquelles nous lierons plus tard les éléments de l'interface utilisateur:</font></font><br>
<br>
<pre><code class="cs hljs">   Button startSiren;<font></font>
   TextView rSwitch;<font></font>
   TextView EndSensor;<font></font>
   Switch bltSwitch;<font></font>
   TextView status;<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient ensuite le code de l'exemple sur lequel je me suis appuyé. </font><font style="vertical-align: inherit;">Variables (champs) nécessaires au fonctionnement de certaines méthodes.</font></font><br>
<br>
<pre><code class="cs hljs">  <span class="hljs-keyword">private</span> Java.Lang.String dataToSend;
        <span class="hljs-keyword">private</span> BluetoothAdapter mBluetoothAdapter = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">private</span> BluetoothSocket btSocket = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">private</span> Stream outStream = <span class="hljs-literal">null</span>;
        <span class="hljs-comment">// don't forget change addres to your device:</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> address = <span class="hljs-string">"98:D3:91:F9:6C:F6"</span>;
        <span class="hljs-comment">// MY_UUID can be saved as is</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> UUID MY_UUID = UUID.FromString(<span class="hljs-string">"00001101-0000-1000-8000-00805F9B34FB"</span>);
        <span class="hljs-keyword">private</span> Stream inStream = <span class="hljs-literal">null</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est important pour nous ici de saisir l'adresse de votre module HC-06 dans le champ d'adresse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme il s'agit de ma première expérience de développement pour smartphones, y compris en travaillant avec Xamarin, j'ai décidé de ne rien compliquer, donc l'adresse de l'appareil, comme dans l'exemple d'origine, est codée en dur. </font><font style="vertical-align: inherit;">Si vous le souhaitez, vous pouvez voir </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cet article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il semble qu'il y ait une énumération des appareils Bluetooth disponibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passez.</font></font><br>
<br>
<pre><code class="cs hljs">
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnCreate</span>(<span class="hljs-params">Bundle savedInstanceState</span>)</span><font></font>
        {<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.OnCreate(savedInstanceState);<font></font>
            Xamarin.Essentials.Platform.Init(<span class="hljs-keyword">this</span>, savedInstanceState);
            <span class="hljs-comment">// Set our view from the "main" layout resource</span><font></font>
            SetContentView(Resource.Layout.activity_main);<font></font>
<font></font>
            startSiren = FindViewById&lt;Button&gt;(Resource.Id.startSiren);<font></font>
            rSwitch = FindViewById&lt;TextView&gt;(Resource.Id.rSwitch);<font></font>
            EndSensor = FindViewById&lt;TextView&gt;(Resource.Id.EndSensor);<font></font>
            status = FindViewById&lt;TextView&gt;(Resource.Id.status);<font></font>
            bltSwitch = FindViewById&lt;Switch&gt;(Resource.Id.bltSwitch);<font></font>
<font></font>
<font></font>
            startSiren.Click += startSiren_ClickOnButtonClicked;<font></font>
            bltSwitch.CheckedChange += bltSwitch_HandleCheckedChange;<font></font>
            CheckBt();<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette méthode est créée automatiquement, notre tâche consiste à associer des objets d'interface utilisateur avec les champs de la classe, et également attacher des gestionnaires pour les réactions aux événements ( </font></font><code>startSiren.Click  bltSwitch.CheckedChange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vérification de la connexion via Bluetooth:</font></font><br>
<br>
<pre><code class="cs hljs">
        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CheckBt</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            mBluetoothAdapter = BluetoothAdapter.DefaultAdapter;<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (!mBluetoothAdapter.Enable())<font></font>
            {<font></font>
                Toast.MakeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"Bluetooth Off"</span>,<font></font>
                    ToastLength.Short).Show();<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">if</span> (mBluetoothAdapter == <span class="hljs-literal">null</span>)<font></font>
            {<font></font>
                Toast.MakeText(<span class="hljs-keyword">this</span>,
                    <span class="hljs-string">"Bluetooth does not exist or is busy"</span>, ToastLength.Short)<font></font>
                    .Show();<font></font>
            }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allumez la sirène. </font><font style="vertical-align: inherit;">Essentiellement, il suffit d'envoyer les caractères «11» au contrôleur:</font></font><br>
<br>
<pre><code class="cs hljs">
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">startSiren_ClickOnButtonClicked</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, EventArgs e</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (bltSwitch.Checked)<font></font>
            {<font></font>
                <span class="hljs-keyword">try</span><font></font>
                {<font></font>
                    dataToSend = <span class="hljs-keyword">new</span> Java.Lang.String(<span class="hljs-string">"11"</span>);<font></font>
                    writeData(dataToSend);<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Send signal to siren"</span>);<font></font>
                }<font></font>
                <span class="hljs-keyword">catch</span> (System.Exception execept)<font></font>
                {<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Error when send data"</span> + execept.Message);<font></font>
                }<font></font>
<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span> status.Text = <span class="hljs-string">"bluetooth not connected"</span>;<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vérification de l'état du commutateur (s'il est déplacé vers la droite, cela signifie qu'il est activé): </font></font><br>
<br>
<pre><code class="cs hljs">   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bltSwitch_HandleCheckedChange</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> sender, CompoundButton.CheckedChangeEventArgs e</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">if</span> (e.IsChecked)<font></font>
            {<font></font>
                Connect();<font></font>
            }<font></font>
            <span class="hljs-keyword">else</span><font></font>
            {<font></font>
                <span class="hljs-keyword">if</span> (btSocket.IsConnected)<font></font>
                {<font></font>
                    <span class="hljs-keyword">try</span><font></font>
                    {<font></font>
                        btSocket.Close();<font></font>
                        System.Console.WriteLine(<span class="hljs-string">"Connection closed"</span>);<font></font>
                    }<font></font>
                    <span class="hljs-keyword">catch</span> (System.Exception ex)<font></font>
                    {<font></font>
                        Console.WriteLine(ex.Message);<font></font>
                    }<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous allumez, nous commençons la connexion avec Bluetooth. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'implémentation de la connexion elle-même:</font></font><br>
<br>
<pre><code class="cs hljs">   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Connect</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            BluetoothDevice device = mBluetoothAdapter.GetRemoteDevice(address);<font></font>
            System.Console.WriteLine(<span class="hljs-string">"Connection in progress"</span> + device);<font></font>
            mBluetoothAdapter.CancelDiscovery();<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                btSocket = device.CreateRfcommSocketToServiceRecord(MY_UUID);<font></font>
                btSocket.Connect();<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Correct Connection"</span>);<font></font>
                status.Text = <span class="hljs-string">"Correct Connection to bluetooth"</span>;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                Console.WriteLine(e.Message);<font></font>
                <span class="hljs-keyword">try</span><font></font>
                {<font></font>
                    btSocket.Close();<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Connection closed"</span>);<font></font>
                }<font></font>
                <span class="hljs-keyword">catch</span> (System.Exception)<font></font>
                {<font></font>
                    System.Console.WriteLine(<span class="hljs-string">"Impossible to connect"</span>);<font></font>
                    status.Text = <span class="hljs-string">"Impossible to connect"</span>;<font></font>
                }<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Socket Created"</span>);<font></font>
  <font></font>
            }<font></font>
            beginListenForData();<font></font>
<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et voici l'une des méthodes les plus importantes - lire directement les données:</font></font><br>
<br>
<pre><code class="cs hljs">
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">beginListenForData</span>(<span class="hljs-params"></span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                inStream = btSocket.InputStream;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.IO.IOException ex)<font></font>
            {<font></font>
                Console.WriteLine(ex.Message);<font></font>
            }<font></font>
            Task.Factory.StartNew(() =&gt; {<font></font>
                <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];
                <span class="hljs-keyword">int</span> bytes;<font></font>
                <font></font>
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)<font></font>
                {<font></font>
<font></font>
                    <span class="hljs-keyword">try</span><font></font>
                    {<font></font>
                        bytes = inStream.Read(buffer, <span class="hljs-number">0</span>, <span class="hljs-number">1024</span>);<font></font>
                        System.Console.WriteLine(<span class="hljs-string">"bytes "</span> + bytes.ToString());
                        <span class="hljs-keyword">if</span> (bytes &gt; <span class="hljs-number">0</span>)<font></font>
                        {<font></font>
                            <font></font>
                            RunOnUiThread(() =&gt; {<font></font>
                                <span class="hljs-keyword">string</span> valor = System.Text.Encoding.ASCII.GetString(buffer).Replace(<span class="hljs-string">"5"</span>,String.Empty);
                                <span class="hljs-comment">// transform string for deleate all symbols except 1-4(command from canny).</span>
                                <span class="hljs-keyword">string</span> command = <span class="hljs-keyword">new</span> <span class="hljs-keyword">string</span>(valor.Where(<span class="hljs-keyword">char</span>.IsDigit).ToArray());<font></font>
<font></font>
                                <span class="hljs-keyword">if</span> (command.Length &gt; <span class="hljs-number">0</span>)<font></font>
                                {<font></font>
                                     status.Text=<span class="hljs-string">"data successfully readed"</span>;<font></font>
                                    System.Console.WriteLine(<span class="hljs-string">"command  "</span> + command);
                                    <span class="hljs-keyword">switch</span> (Int32.Parse(command))<font></font>
                                    {<font></font>
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - disconnected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - not pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - disconnected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - connected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - not pressed "</span>;
                                            <span class="hljs-keyword">break</span>;
                                        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<font></font>
                                            rSwitch.Text = <span class="hljs-string">"reed switch - connected "</span>;<font></font>
                                            EndSensor.Text = <span class="hljs-string">"end sensor - pressed "</span>;
                                        <span class="hljs-keyword">break</span>;<font></font>
                                    }<font></font>
                                }<font></font>
                            });<font></font>
                        }<font></font>
                    }<font></font>
                    <span class="hljs-keyword">catch</span> (Java.IO.IOException)<font></font>
                    {<font></font>
                        RunOnUiThread(() =&gt; {<font></font>
                            EndSensor.Text = <span class="hljs-string">"End sensor status - undefined"</span>;<font></font>
                            rSwitch.Text = <span class="hljs-string">"Reed switch status - undefined "</span>;<font></font>
                        });<font></font>
                        <span class="hljs-keyword">break</span>;<font></font>
                    }<font></font>
                }<font></font>
            });<font></font>
        }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai laissé de nombreux éléments de la méthode comme dans l'exemple, si je comprends bien, au début, une connexion au flux de données est créée, s'il y a quelque chose dans le tampon avec les données lues, puis il est lu dans une variable </font></font><code>valor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">De plus, comme je l'ai promis, nous supprimons simplement le chiffre «5». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous supprimons tous les caractères à l'exception des chiffres du message lu. </font></font><code>string command = new string(valor.Where(char.IsDigit).ToArray());</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, après cela, tout est simple, selon le nombre qui nous est parvenu, nous affichons tel ou tel état dans l'interface utilisateur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas fondamentalement changé ces deux méthodes:</font></font><br>
<br>
<pre><code class="cs hljs">  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">writeData</span>(<span class="hljs-params">Java.Lang.String data</span>)</span><font></font>
        {<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                outStream = btSocket.OutputStream;<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Error with OutputStream when write to Serial port"</span> + e.Message);<font></font>
            }<font></font>
<font></font>
            Java.Lang.String message = data;<font></font>
<font></font>
            <span class="hljs-keyword">byte</span>[] msgBuffer = message.GetBytes();<font></font>
<font></font>
            <span class="hljs-keyword">try</span><font></font>
            {<font></font>
                outStream.Write(msgBuffer, <span class="hljs-number">0</span>, msgBuffer.Length);<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Message sent"</span>);<font></font>
            }<font></font>
            <span class="hljs-keyword">catch</span> (System.Exception e)<font></font>
            {<font></font>
                System.Console.WriteLine(<span class="hljs-string">"Error with  when write message to Serial port"</span> + e.Message);<font></font>
                status.Text = <span class="hljs-string">"Error with  when write message to Serial port"</span>;<font></font>
            }<font></font>
        }<font></font>
<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnRequestPermissionsResult</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> requestCode, <span class="hljs-keyword">string</span>[] permissions, [GeneratedEnum] Android.Content.PM.Permission[] grantResults</span>)</span><font></font>
        {<font></font>
            Xamarin.Essentials.Platform.OnRequestPermissionsResult(requestCode, permissions, grantResults);<font></font>
<font></font>
            <span class="hljs-keyword">base</span>.OnRequestPermissionsResult(requestCode, permissions, grantResults);<font></font>
        }<font></font>
    }<font></font>
 }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si je comprends bien, ce bloc de code implémente l'envoi d'un message et un gestionnaire d'événements pour surcharger l'autorisation d'accès à Bluetooth. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, il ne vous reste plus qu'à configurer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une connexion smartphone</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déboguer l'application</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Curieusement, mais cela fonctionne:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/vs/5z/jmvs5zdesg9lvfprcdbp5-cebes.png"><br>
<a name="IV"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Partie IV: Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici comment le programme fonctionne en nature: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8b/4r/kv/8b4rkvzlvtcl-nnqh-fb1dm8cey.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'était ma première expérience dans le développement d'applications pour un smartphone sur Android. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voudrais noter que VS 2019 et Xamarin sur mon ancien ordinateur fonctionnent très lentement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du premier montage du projet, j'ai vraiment réussi à manger ces petits pains français moelleux et à boire du thé. De plus, l'application elle-même s'est avérée franchement misérable, l'interrupteur marche / arrêt ne fonctionne pas très facilement, mais d'un autre côté, étant donné que je ne suis que peu familier avec les techniques de développement de base pour .NET, ainsi que le fait que je ne suis pas du tout programmeur, je pourrais même sans passer par un seul didacticiel ou une seule leçon, décrivez votre première application en une journée. Par conséquent, le seuil d'entrée pour créer une application élémentaire est assez bas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si je comprends bien, les contrôleurs CANNY peuvent être utilisés lors du réglage des voitures, en particulier les voitures domestiques, de sorte qu'il est tout à fait possible de créer une sorte de "fonctionnalité" et d'y écrire une application pour smartphone. </font><font style="vertical-align: inherit;">La principale chose à retenir est que lorsqu'elles sont alimentées à partir du réseau de bord du véhicule, les sorties du contrôleur auront également la même tension que l'entrée (par exemple, 12 V au lieu de 5 V). </font><font style="vertical-align: inherit;">N'oubliez pas de protéger l'adaptateur Bluetooth afin qu'il ne tombe pas en panne par inadvertance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'article s'est avéré très laborieux pour moi, j'espère que tout n'a pas été vain et que vous l'aimerez.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr500444/index.html">9 compétences en programmation Python qui distinguent un débutant d'un expérimenté</a></li>
<li><a href="../fr500446/index.html">Quelques mots sur R2DBC et PostgreSQL</a></li>
<li><a href="../fr500448/index.html">Prometheus: surveillance HTTP via l'exportateur Blackbox</a></li>
<li><a href="../fr500450/index.html">Faire un clavier MIDI à partir d'un vieux synthétiseur pour enfants</a></li>
<li><a href="../fr500452/index.html">Raisonnement élevé sur l'apprentissage profond</a></li>
<li><a href="../fr500456/index.html">BpfTrace - enfin, un remplacement complet de Dtrace sur Linux</a></li>
<li><a href="../fr500458/index.html">Caractéristiques techniques de la parole en ligne: Pack de démarrage</a></li>
<li><a href="../fr500462/index.html">Détection des changements de scène et enregistrement des clips vidéo h264 sur Raspberry Pi sans décodage</a></li>
<li><a href="../fr500468/index.html">Guide des fonctionnalités Java 8-14</a></li>
<li><a href="../fr500470/index.html">Adapter votre solution commerciale existante pour SwiftUI. Partie 3. Travailler avec l'architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>