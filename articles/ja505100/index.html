<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏽 ✔️ 👫 etcdのfioでドライブの十分なパフォーマンスを確認する方法 👆 😃 🈯️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="注意 ペレフ。：この記事は、etcdデータベースの操作に関連する実際の問題の解決策を探すためにIBM Cloudエンジニアが実施したミニスタディの結果です。私たちにとっては、同様のタスクが関連していましたが、著者の考えや行動の流れは、より広い文脈で興味深いかもしれません。
 
 
 
 記事全体の簡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>etcdのfioでドライブの十分なパフォーマンスを確認する方法</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/505100/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意 </font><font style="vertical-align: inherit;">ペレフ。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：この記事は、etcdデータベースの操作に関連する実際の問題の解決策を探すためにIBM Cloudエンジニアが実施したミニスタディの結果です。</font><font style="vertical-align: inherit;">私たちにとっては、同様のタスクが関連していましたが、著者の考えや行動の流れは、より広い文脈で興味深いかもしれません。</font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/ch/rf/tf/chrftfiz54gzuyvhcpym-kdvymm.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記事全体の簡単な要約：fioとetcd</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
etcdクラスターのパフォーマンスは、基盤となるストレージの速度に大きく依存します。</font><font style="vertical-align: inherit;">パフォーマンス監視のために、etcdはさまざまなPrometheusメトリックをエクスポートします。</font><font style="vertical-align: inherit;">それらの1つです</font></font><code>wal_fsync_duration_seconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">etcdのドキュメントによる</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このメトリックの99パーセンタイルが10ミリ秒を超えない場合、ストレージは非常に高速であると見なすことができます...</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linuxマシンでetcdクラスターを構成する可能性を検討していて、ドライブが十分に高速かどうか（SSDなど）を確認する場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼ばれる一般的なI / Oテスターを使用することをお勧めし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">次のコマンドを実行するだけで十分です（ディレクトリ</font></font><code>test-data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、テスト中のドライブのマウントされたセクションにある必要があります）。</font></font><br>
<br>
<pre><code class="bash hljs">fio --rw=write --ioengine=sync --fdatasync=1 --directory=<span class="hljs-built_in">test</span>-data --size=22m --bs=2300 --name=mytest</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
結論を見て、99パーセンタイル</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>fdatasync</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が10ミリ秒に</font><font style="vertical-align: inherit;">収まるかどうかを確認するだけ</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">その場合、ドライブは十分に高速です。</font><font style="vertical-align: inherit;">次に出力例を示します。</font></font><br>
<br>
<pre><code class="bash hljs">fsync/fdatasync/sync_file_range:<font></font>
  sync (usec): min=534, max=15766, avg=1273.08, stdev=1084.70<font></font>
  sync percentiles (usec):<font></font>
   | 1.00th=[ 553], 5.00th=[ 578], 10.00th=[ 594], 20.00th=[ 627],<font></font>
   | 30.00th=[ 709], 40.00th=[ 750], 50.00th=[ 783], 60.00th=[ 1549],<font></font>
   | 70.00th=[ 1729], 80.00th=[ 1991], 90.00th=[ 2180], 95.00th=[ 2278],<font></font>
   | 99.00th=[ 2376], 99.50th=[ 9634], 99.90th=[15795], 99.95th=[15795],<font></font>
   | 99.99th=[15795]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかのメモ：</font></font><br>
<br>
<ol>
<li>        <code>--size</code>  <code>--bs</code>   .      <code>fio</code>,  ,     .  ,   ,   .</li>
<li>     <code>fio</code>   .     ,         ( ,    <code>wal_fsync_duration_seconds</code>).        <code>wal_fsync_duration_seconds</code>.  ,  99- ,      <code>fio</code>,    10 ,  ,    .</li>
<li> <b>     <code>fio</code>   3.5</b>,        <code>fdatasync</code>   .</li>
<li>            <code>fio</code>.</li>
</ol><br>
<h2>  fio  etcd</h2><br>
<h3>   WAL' etcd</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、データベースは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロアクティブロギング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（先読みロギング、WAL）で</font><font style="vertical-align: inherit;">使用されます 。 </font><font style="vertical-align: inherit;">etcdこれも適用されます。 WALの説明はこの記事の範囲を超えていますが、私たちの目的のために、次のことを知る必要があります。etcdクラスターの各メンバーがWALを永続ストレージに保存します。 etcdは、いくつかのキー値ストレージ操作（更新など）を実行する前にWALに書き込みます。ノードがクラッシュしてスナップショット間で再起動すると、etcdはWALの内容に基づいて以前のスナップショットからトランザクションを回復できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、クライアントがKVストレージにキーを追加するか、既存のキーの値を更新するたびに、etcdは永続ストレージ内の通常のファイルであるWALに操作の説明を追加します。</font><font style="vertical-align: inherit;">続行する前に、etcdはWALレコードが実際に保存されていることを100％確認する必要があります。</font><font style="vertical-align: inherit;">Linuxでこれを実現するには</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>write</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、物理メディア自体への書き込み操作が遅延する可能性があるため</font><font style="vertical-align: inherit;">、システムコールを使用するだけでは不十分</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">たとえば、Linuxはメモリ内のカーネルキャッシュ（ページキャッシュなど）にWALエントリをしばらく保持できます。</font><font style="vertical-align: inherit;">データが確実にメディアに書き込まれるようにするには、記録後にシステムコールを使用する必要があります</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-これはetcdが行うことです（次の出力に示されているように</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>strace</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ここで</font></font><code>8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -ファイル記述子WAL）：</font></font><br>
<br>
<pre><code class="plaintext hljs">21:23:09.894875 lseek(8, 0, SEEK_CUR)   = 12808 &lt;0.000012&gt;<font></font>
21:23:09.894911 write(8, ".\0\0\0\0\0\0\202\10\2\20\361\223\255\266\6\32$\10\0\20\10\30\26\"\34\"\r\n\3fo"..., 2296) = 2296 &lt;0.000130&gt;<font></font>
21:23:09.895041 fdatasync(8)            = 0 &lt;0.008314&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、永続ストレージへの書き込みには時間がかかります。</font><font style="vertical-align: inherit;">fdatasync呼び出しを長時間実行すると、etcdのパフォーマンスに影響する場合があります。</font><font style="vertical-align: inherit;">リポジトリのドキュメントに</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">よる</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、十分なパフォーマンスを得るには</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、WALファイルに書き込むとき</font><font style="vertical-align: inherit;">のすべての呼び出し期間の99パーセンタイルが</font><font style="vertical-align: inherit;">10ミリ秒未満である必要があります。</font><font style="vertical-align: inherit;">リポジトリに関連する他のメトリックがありますが、この記事ではこの特定のメトリックに焦点を当てます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fioを使用したスト​​レージの評価</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一般的なI / Oテスターである</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ユーティリティを使用して、特定のストレージがetcdでの使用に適しているかどうかを評価でき</font><font style="vertical-align: inherit;">ます。ディスクI / Oは、同期/非同期、さまざまなクラスのシステムコールなど、さまざまな方法で発生する可能性があることに注意してください。コインの裏側は、</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使うの</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">非常に難しいということです。ユーティリティには多くのパラメーターがあり、それらの値のさまざまな組み合わせにより、まったく異なる結果が得られます。 etcdの場合に正しいスコアを取得するには、fioによって生成される書き込み負荷が、WALファイルに書き込むときのetcdの負荷と同じであることを確認する必要があります。</font></font><br>
<br>
<ul>
<li>  ,   <code>fio</code> ,   ,        ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>write</code></a>,    <code>fdatasync</code>.</li>
<li>    ,    <code>--rw=write</code>. </li>
<li>  <code>fio</code>     <code>write</code> (     — , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>pwrite</code></a>),   <code>--ioengine=sync</code>.</li>
<li> ,  <code>--fdatasync=1</code> ,    <code>write</code>  <code>fdatasync</code>.</li>
<li>      : <code>--size</code>  <code>--bs</code> —        .       .</li>
</ul><br>
<h2>   fio   ,   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメモは、発生した実際のケースからのものです。 Kubernetes v1.13にクラスターがあり、Prometheusをモニタリングしています。ソリッドステートドライブは、etcd v3.2.24のストレージとして使用されていました。 Etcdメトリックは</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、クラスターがアイドル状態のときでも</font><font style="vertical-align: inherit;">待ち時間が長すぎることを示しました</font><font style="vertical-align: inherit;">。これらの測定基準は私たちにとって非常に疑わしいようであり、それらが正確に何を表しているのかわかりませんでした。さらに、クラスターは仮想マシンで構成されていたため、遅延が仮想化によるものかSSDが原因であるとは言えませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、ハードウェアとソフトウェアの構成のさまざまな変更を検討したため、それらを評価する方法が必要でした。</font><font style="vertical-align: inherit;">もちろん、各構成でetcdを実行して、対応するPrometheusメトリックを確認することもできますが、これには多くの労力が必要になります。</font><font style="vertical-align: inherit;">しかし、特定の構成を評価する簡単な方法が必要でした。</font><font style="vertical-align: inherit;">etcdからのPrometheusメトリックの理解をテストしたかったのです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを行うには、2つの問題を解決する必要がありました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">まず、WALファイルに書き込むときに、etcdによって生成されるI / O負荷はどのように見えますか？</font><font style="vertical-align: inherit;">使用されているシステムコールは何ですか？</font><font style="vertical-align: inherit;">レコーディングブロックのサイズは？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次に、上記の質問に対する回答があるとします。</font><font style="vertical-align: inherit;">対応する負荷をどのように再現し</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますか？</font><font style="vertical-align: inherit;">確かに、これ</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は豊富なパラメータを備えた非常に柔軟なユーティリティです</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これは、たとえば、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -約Transl。</font><font style="vertical-align: inherit;">で簡単に確認できます</font><font style="vertical-align: inherit;">）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チーム</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>lsof</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">に基づいて、同じアプローチを使用して両方の問題を解決</font><font style="vertical-align: inherit;">しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><code>strace</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これを</font></font><code>lsof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用すると、プロセスで使用されるすべてのファイル記述子と、それらが関連するファイルを表示できます。</font></font></li>
<li>   <code>strace</code>            .     ,    ,  ,  .    ,  ,  etcd —    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に行ったのは、それ</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用し</font><font style="vertical-align: inherit;">て、アイドル状態のKubernetesクラスター内のetcdサーバーを調べることでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、WALの書き込みブロックは非常に密にグループ化されており、ほとんどのサイズは2200〜2400バイトの範囲にあります。このため、この記事の冒頭のコマンドではフラグ</font></font><code>--bs=2300</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>bs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-の各レコードブロックのバイト単位のサイズ</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を使用しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
etcd書き込みブロックのサイズは、バージョン、デプロイメント、パラメーター値などによって異なることに注意してください。 -期間に影響し</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。同様のユースケースがある場合は</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、etcdプロセスを</font><font style="vertical-align: inherit;">使用し</font><font style="vertical-align: inherit;">て現在の値を</font><font style="vertical-align: inherit;">分析して</font><font style="vertical-align: inherit;">ください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、etcdがファイルシステムでどのように機能するかを明確かつ包括的に把握するために</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、フラグの</font><font style="vertical-align: inherit;">下から起動しました</font></font><code>-ffttT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これにより、子孫プロセスを採用し、それぞれの出力を個別のファイルに記録することが可能になりました。さらに、各システムコールの開始時刻と継続時間に関する詳細情報が取得されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、このコマンド</font></font><code>lsof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、どのファイル記述子がどの目的に使用されたかという点で</font><font style="vertical-align: inherit;">の出力の理解を確認しました</font><font style="vertical-align: inherit;">。結論</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は上記のものと同様でした。同期時間を伴う統計的操作により</font></font><code>wal_fsync_duration_seconds</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、etcdから</font><font style="vertical-align: inherit;">のメトリック</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がWALファイル記述子を使用した</font><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">と</font><font style="vertical-align: inherit;">一致する</font><font style="vertical-align: inherit;">ことが確認されました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
を使用して生成するには</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcdからのロードと同様のワークロード、ユーティリティのドキュメントが調査され、タスクに適したパラメーターが選択されました。必要なシステムコールが含まれていることを確認し、</font><font style="vertical-align: inherit;">（etcdの場合と同様に）</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><font style="vertical-align: inherit;">実行することでその期間を確認しました</font></font><code>strace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パラメータの値の決定には、特に注意が払われました</font></font><code>--size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、fioユーティリティによって生成されるI / O負荷の合計を表します。私たちの場合、これはメディアに書き込まれたバイトの総数です。呼び出し数</font></font><code>write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（および</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）に</font><font style="vertical-align: inherit;">正比例し</font><font style="vertical-align: inherit;">ます。特定の</font></font><code>bs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数の呼び出し</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が等しい場合</font></font><code>size / bs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パーセンタイルに関心があったので、サンプルの数が統計的有意性に十分な大きさであることを確認しようとしました。そしてそれを決めた</font></font><code>10^4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（22 MBのサイズに相当）で十分です。</font><font style="vertical-align: inherit;">パラメータ値を小さくする</font></font><code>--size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、ノイズがより顕著になります（たとえば、</font></font><code>fdatasync</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常よりも時間がかかり、99パーセンタイルに影響する</font><font style="vertical-align: inherit;">呼び出し</font><font style="vertical-align: inherit;">）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それはあなた次第です</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では</font></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、メディアがetcdで使用するのに十分な速度であることが意図されているかどうかを評価</font><font style="vertical-align: inherit;">するために</font><font style="vertical-align: inherit;">それ</font><font style="vertical-align: inherit;">を使用</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">方法を示しています</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">今それはあなた次第です！</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IBM Cloud</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サービスでSSDストレージを備えた仮想マシンを探索できます</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳者からのPS</font></font></h2><br><font style="vertical-align: inherit;"></font><code>fio</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の問題を解決</font><font style="vertical-align: inherit;">
する</font><font style="vertical-align: inherit;">ための</font><font style="vertical-align: inherit;">既製の使用例は</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドキュメント</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または直接</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロジェクトリポジトリに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あり</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">（ドキュメントに記載されているものよりもはるかに多くあります）。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳者からのPPS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのブログも読んでください：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Etcd 3.4.3：ストレージの信頼性とセキュリティの研究</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcd Kubernetes-clusterのデータを直接操作した経験（K8s APIなし）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ";</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes [およびその解決策]の運用における6つの面白いシステムバグ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。」</font></font></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja505080/index.html">非同期コードの世界におけるミューテックス</a></li>
<li><a href="../ja505082/index.html">PythonのML開発者向けの10の便利な方法</a></li>
<li><a href="../ja505090/index.html">「役に立つ」/「使わない」/役に立たないという言葉の翻訳について</a></li>
<li><a href="../ja505092/index.html">マイクロソフトでの就職方法</a></li>
<li><a href="../ja505098/index.html">Snom D717 IP電話レビュー</a></li>
<li><a href="../ja505104/index.html">世界のトップ5の薬局サイトに参入したサービスを開発した方法</a></li>
<li><a href="../ja505106/index.html">乾燥した水と海の膝の深さ</a></li>
<li><a href="../ja505108/index.html">PostgreSQLのパフォーマンスを改善するためのLinuxのチューニング。イリヤ・コスモデヤンスキー</a></li>
<li><a href="../ja505110/index.html">この厄介な瞬間。奇妙で奇抜な面接状況（実話）</a></li>
<li><a href="../ja505114/index.html">6月3日の輸送：1週間の朗報（そして今、全国をドライブする方法）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>