<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐂 💞 🗒️ Fnに基づいて独自のサーバーレスを構築する 👨🏿‍✈️ 🤾🏻 🧖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="サーバーレスコンピューティングは、クラウドコンピューティングで最も目に見える傾向の1つです。作業の基本原則は、インフラストラクチャはDevOpsではなくサービスプロバイダーの関心事であるということです。リソースのスケーリングは自動的に負荷に適応し、変化率が高くなります。
 

 — , " " (F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Fnに基づいて独自のサーバーレスを構築する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/475044/"><p><img src="https://habrastorage.org/webt/q4/8m/gj/q48mgjqsr4hbppglzpibvajf8xw.jpeg"></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サーバーレスコンピューティング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、クラウドコンピューティングで最も目に見える傾向の1つです。</font><font style="vertical-align: inherit;">作業の基本原則は、インフラストラクチャはDevOpsではなくサービスプロバイダーの関心事であるということです。</font><font style="vertical-align: inherit;">リソースのスケーリングは自動的に負荷に適応し、変化率が高くなります。</font></font></p><br>
<p>   —      ,      "  " (FaaS).</p><a name="habracut"></a><br>
<p>    ,  FaaS  AWS Lambda,  Amazon,     .       :</p><br>
<ul>
<li>Cloud Functions   Google</li>
<li>Azure Functions  Microsoft</li>
</ul><br>
<p>     ,        ,          .              .  :</p><br>
<ul>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Apache OpenWhisk</a>,     IBM,</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Spring Cloud Functions</a>,      Spring Framework,        AWS Lambda, Azure Functions  OpenWhisk,</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> Fn</a>,   Oracle.</li>
</ul><br>
<p>     ,      ,   ,   ,     Exoscale.</p><br>
<h2 id="kak-proekt-fn-ustroen">  Fn </h2><br>
<p>Fn    Docker,     :</p><br>
<ul>
<li>CLI ,       Fn,     Fn,</li>
<li>  Fn,  ,     Docker.</li>
</ul><br>
<p>,   Fn,      ,        , … Clojure!</p><br>
<p>      (STDIN),      (STDOUT).          (,  JSON) —        ,   Fn      (FDK).</p><br>
<p>     ,   FaaS         (Go,   Java, Python  ..).</p><br>
<p> FaaS ,   :</p><br>
<ul>
<li>    CLI Fn:      Fn,    .</li>
<li>  ,     CLI Fn:      ,          .</li>
</ul><br>
<p><img src="https://habrastorage.org/webt/_0/ds/if/_0dsifqshganceaz5pks7ixl9gs.jpeg"><br>
<em>    Fn</em></p><br>
<h2 id="lokalnaya-ustanovka-i-testirovanie-besservernyh-funkciy">     </h2><br>
<p>   Fn   .   Docker,    Fn. ,    Debian/Ubuntu:</p><br>
<pre><code class="plaintext hljs">$ sudo apt-get update<font></font>
$ sudo apt-get install docker.io</code></pre><br>
<p>    /  Docker   .       Fn CLI.  ,   curl:</p><br>
<pre><code class="plaintext hljs">$ curl -LSs https://raw.githubusercontent.com/fnproject/cli/master/install | sh</code></pre><br>
<p>    OSX   Homebrew,    :</p><br>
<pre><code class="plaintext hljs">$ brew install fn<font></font>
<font></font>
==&gt; Downloading https://homebrew.bintray.com/bottles/fn-0.5.8.high_sierra.bottle.tar.gz<font></font>
==&gt; Downloading from https://akamai.bintray.com/b1/b1767fb00e2e69fd9da73427d0926b1d1d0003622f7ddc0dd3a899b2894781ff?__gda__=exp=1538038849~hmac=c702c9335e7785fcbacad1f29afa61244d02f2eebb<font></font>
######################################################################## 100.0%<font></font>
==&gt; Pouring fn-0.5.8.high_sierra.bottle.tar.gz<font></font>
  /usr/local/Cellar/fn/0.5.8: 5 files, 16.7MB</code></pre><br>
<p>          CLI.         ,   Node:</p><br>
<pre><code class="plaintext hljs">$ fn init --runtime node --trigger http hellonode<font></font>
<font></font>
Creating function at: /hellonode<font></font>
Function boilerplate generated.<font></font>
func.yaml created.</code></pre><br>
<p>    <code>hellonode</code>      Fn     .        ,        :</p><br>
<pre><code class="plaintext hljs">#   node  :<font></font>
<font></font>
   hellonode<font></font>
   ├── func.js<font></font>
   ├── func.yaml<font></font>
   └── package.json<font></font>
<font></font>
#   Java11 :<font></font>
<font></font>
   hellojava11<font></font>
   ├── func.yaml<font></font>
   ├── pom.xml<font></font>
   └── src<font></font>
       ├── main<font></font>
       │   └── java<font></font>
       │       └── com<font></font>
       │           └── example<font></font>
       │               └── fn<font></font>
       │                   └── HelloFunction.java<font></font>
       └── test<font></font>
           └── java<font></font>
               └── com<font></font>
                   └── example<font></font>
                       └── fn<font></font>
                           └── HelloFunctionTest.java</code></pre><br>
<p>Fn    ,   <code>func.yaml</code>,     Fn,       ,   .</p><br>
<p>    Node  :</p><br>
<pre><code class="plaintext hljs">$ cat hellonode/func.js<font></font>
<font></font>
const fdk=require('@fnproject/fdk');<font></font>
<font></font>
fdk.handle(function(input){<font></font>
  let name = 'World';<font></font>
  if (input.name) {<font></font>
    name = input.name;<font></font>
  }<font></font>
  return {'message': 'Hello ' + name}<font></font>
})</code></pre><br>
<p>  -    ,     .</p><br>
<p>     Fn.    ,  Fn   Docker ,           Docker.</p><br>
<pre><code class="plaintext hljs">$ fn start -d                    #     <font></font>
<font></font>
Unable to find image 'fnproject/fnserver:latest' locally<font></font>
latest: Pulling from fnproject/fnserver<font></font>
ff3a5c916c92: Pull complete<font></font>
1a649ea86bca: Pull complete<font></font>
ce35f4d5f86a: Pull complete<font></font>
<font></font>
...<font></font>
<font></font>
Status: Downloaded newer image for fnproject/fnserver:latest<font></font>
668ce9ac0ed8d7cd59da49228bda62464e01bff2c0c60079542d24ac6070f8e5</code></pre><br>
<p>      "".    <code> </code>:  Fn            .</p><br>
<p>Fn LI    <code>func.yaml</code>   ,      .         <code>hellonode</code>.</p><br>
<pre><code class="plaintext hljs">$ cd hellonode<font></font>
$ fn deploy --app fnexo --local  #   ,   - fnexo.<font></font>
                                 #  local      ,<font></font>
                                 #   <font></font>
<font></font>
Deploying hellonode to app: fnexo<font></font>
Bumped to version 0.0.2<font></font>
Building image nfrankel/hellonode:0.0.3 .<font></font>
Updating function hellonode using image nfrankel/hellonode:0.0.3...<font></font>
Successfully created app:  fnexo<font></font>
Successfully created function: hellonode with nfrankel/hellonode:0.0.3<font></font>
Successfully created trigger: hellonode-trigger</code></pre><br>
<p>     ,      Docker,   .    ,        :</p><br>
<ul>
<li>  Fn <code>invoke</code></li>
<li>   <code>http</code></li>
</ul><br>
<p> <code>invoke</code>  Fn     HTTP  ,     :</p><br>
<pre><code class="plaintext hljs">$ fn invoke fnexo hellonode      #   hellonode  fnexo<font></font>
<font></font>
{"message":"Hello World"}</code></pre><br>
<p>     ,    URL:</p><br>
<pre><code class="plaintext hljs">$ curl http://localhost:8080/t/fnexo/hellonode-trigger<font></font>
<font></font>
{"message":"Hello World"}</code></pre><br>
<p> Fn      8080, ,  , URL    <code>t/app/function</code>,   .  HTTP    ,     trigger,     ""  .    <code>`func.yml</code> :</p><br>
<pre><code class="plaintext hljs">schema_version: 20180708<font></font>
name: hellonode<font></font>
version: 0.0.3<font></font>
runtime: node<font></font>
entrypoint: node func.js<font></font>
format: json<font></font>
triggers:<font></font>
- name: hellonode-trigger<font></font>
  type: http<font></font>
  source: /hellonode-trigger    # URL </code></pre><br>
<p>   ,     ,   :</p><br>
<pre><code class="plaintext hljs">triggers:<font></font>
- name: hellonode-trigger<font></font>
  type: http<font></font>
  source: /hellonode    #    </code></pre><br>
<p>           :</p><br>
<pre><code class="plaintext hljs">$ fn deploy --app fnexo hellonode --local<font></font>
$ curl http://localhost:8080/t/fnexo/hellonode<font></font>
<font></font>
{"message":"Hello World"}</code></pre><br>
<p> !          FaaS  !</p><br>
<h2 id="ustanovka-servisov-besservernyh-funkciy-na-sobstvennoy-infrastrukture">      </h2><br>
<p> -     CLI Exoscale.       —   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    </a>.   ,      . <strong>   ,        8080  Security Group!</strong>      ,     :</p><br>
<pre><code class="plaintext hljs">$ exo firewall create fn-securitygroup<font></font>
$ exo firewall add fn-securitygroup ssh --my-ip<font></font>
$ exo firewall add fn-securitygroup -p tcp -P 8080-8080 -c 0.0.0.0/0<font></font>
$ exo vm create fn-server -s fn-securitygroup</code></pre><br>
<p>    ssh        Fn:</p><br>
<pre><code class="plaintext hljs">$ exo ssh fn-server<font></font>
<font></font>
The authenticity of host '185.19.30.175 (185.19.30.175)' can't be established.<font></font>
ECDSA key fingerprint is SHA256:uaCKRYeX4cvim+Gr8StdPvIQ7eQgPuOKdnj5WI3gI9Q.<font></font>
Are you sure you want to continue connecting (yes/no)? yes<font></font>
Warning: Permanently added '185.19.30.175' (ECDSA) to the list of known hosts.<font></font>
Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-20-generic x86_64)</code></pre><br>
<p>  Docker   Fn ,       ,  :</p><br>
<pre><code class="plaintext hljs">$ sudo apt-get update<font></font>
$ sudo apt-get install docker.io<font></font>
$ sudo systemctl start docker<font></font>
$ curl -LSs https://raw.githubusercontent.com/fnproject/cli/master/install | sh<font></font>
$ sudo fn start<font></font>
<font></font>
...<font></font>
<font></font>
    ______<font></font>
   / ____/___<font></font>
  / /_  / __ \<font></font>
 / __/ / / / /<font></font>
/_/   /_/ /_/<font></font>
    v0.3.643</code></pre><br>
<p>Fn    !           <code>deploy</code>   ,   <code>--local</code>.</p><br>
<p> , Fn     Fn   Docker.         <code>FN_API_URL</code>  <code>FN_REGISTRY</code> ,               .</p><br>
<p>  Fn     <code>context</code>.    :</p><br>
<pre><code class="plaintext hljs">$ fn create context exoscale --provider default --api-url http://185.19.30.175:8080 --registry nfrankel</code></pre><br>
<p>     :</p><br>
<pre><code class="plaintext hljs">$ fn list contexts<font></font>
<font></font>
CURRENT NAME      PROVIDER      API URL                      REGISTRY<font></font>
    default       default       http://localhost:8080/<font></font>
    exoscale      default       http://185.19.30.175:8080    nfrankel<font></font>
</code></pre><br>
<p>   ,     , :</p><br>
<pre><code class="plaintext hljs"> $ fn use context exoscale<font></font>
<font></font>
 Now using context: exoscale</code></pre><br>
<p>      Fn    Docker,      DockerHub (   — <code>nfrankel</code>),      (   — <code>http://185.19.30.175:8080</code>)      ,   .</p><br>
<pre><code class="plaintext hljs">$ fn deploy --app fnexo .   #       hellonode<font></font>
<font></font>
Deploying function at: /.<font></font>
Deploying hellonode to app: fnexo<font></font>
Bumped to version 0.0.5<font></font>
Building image nfrankel/hellonode:0.0.5 .</code></pre><br>
<p>:</p><br>
<pre><code class="plaintext hljs">$ curl http://185.19.30.175:8080/t/fnexo/hellonode<font></font>
<font></font>
{"message":"Hello World"}</code></pre><br>
<p><img src="https://habrastorage.org/webt/vl/8c/mt/vl8cmtjvwj7t9tazi7mlaaexoxi.jpeg"><br>
<em>        Fn</em></p><br>
<h2 id="preimuschestva-besservernyh-vychisleniy-na-svoih-moschnostyah">     </h2><br>
<p>  —        ,       .</p><br>
<p>         , ,        ,           .</p><br>
<p>         ,      ,      ,  -      .</p><br>
<p>Fn    ,       FaaS,   .       ,              .       .</p><br>
<p>     Fn,       ,           Fn,   Fn    .</p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja475028/index.html">ビジネスにおけるMLのonijemeIT株式への適用に関する所見</a></li>
<li><a href="../ja475032/index.html">Gartner Hype Cycle 2019：報告</a></li>
<li><a href="../ja475034/index.html">ArduinoおよびSTM32のブラウザーのグラフ</a></li>
<li><a href="../ja475036/index.html">CassandraからKubernetesへの移行：機能とソリューション</a></li>
<li><a href="../ja475038/index.html">サンクトペテルブルグHSEでの「応用数学とコンピュータサイエンス」の最初のセット：誰であり、どのように扱うか？</a></li>
<li><a href="../ja475046/index.html">最後は手段を正当化しますか？（！）黒とグレーのSEO</a></li>
<li><a href="../ja475048/index.html">仮説検定とp値の直感的な説明</a></li>
<li><a href="../ja475050/index.html">ESports-プレイ、エンゲージ</a></li>
<li><a href="../ja475054/index.html">SAP on Microsoft Azureツアー（モスクワ）</a></li>
<li><a href="../ja475058/index.html">街は眠りに落ち、ハブロフスクの住民は目を覚ます</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>