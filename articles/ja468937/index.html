<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👋🏾 👨🏾‍🤝‍👨🏻 👐🏻 非接触型銀行カード攻撃 🙇🏿 📗 😩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="著者： Cuamckuu
 
 マップコンテンツを取得してEMVチームと連携することは、研究目的だけでなく、興味深いものになる可能性があります。非接触型銀行カードに対する攻撃にはいくつかの種類があり、その実装についてはカットの下で説明します。
 
 前書き
 今年、Digital Securityで...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>非接触型銀行カード攻撃</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468937/"><img src="https://habrastorage.org/webt/mq/0i/ja/mq0ijaoac7t0hg252hv4dotkijq.jpeg"><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">著者： </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuamckuu</font></font></a></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マップコンテンツを取得してEMVチームと連携することは、研究目的だけでなく、興味深いものになる可能性があります。</font><font style="vertical-align: inherit;">非接触型銀行カードに対する攻撃にはいくつかの種類があり、その実装についてはカットの下で説明します。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前書き</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今年、Digital SecurityでSummer of Hack 2019のインターンシップを取得し、非接触型EMVカードに関する研究に取り組みました。</font><font style="vertical-align: inherit;">インターンシップ中、銀行カードの仕組みを学び、非接触型カードを操作するための新しいユーティリティを作成した方がよいことがわかりました。</font><font style="vertical-align: inherit;">データ読み取りモードのデモは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここにあります</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃の種類</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カードと端末は、支払いのセキュリティを高めるために開発されたEMV標準（Europay + MasterCard + VISA）を使用して通信します。</font><font style="vertical-align: inherit;">この点で、非接触型カードには多くの攻撃経路がありません。</font><font style="vertical-align: inherit;">この記事では以下に焦点を当てます。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オンラインストアで他の人のカードをリンクする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソーシャルエンジニアリングの補助ステップ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カードをレンガに変える非接触型DoS</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このような攻撃は、EMV規格に従ってカードとやり取りするときに発生する可能性があります。</font><font style="vertical-align: inherit;">多くのカードを使用すると、ユーザーの個人情報、特にPAN、有効期限、所有者の名前を簡単に読み取ることができます。</font><font style="vertical-align: inherit;">読み取ったデータは、Amazonなどの一部のオンラインストアでカードをマッピングするのに十分です。</font><font style="vertical-align: inherit;">また、受信した個人データは、よりパーソナライズされたフィッシングやスパムの送信に使用できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様に、DoS攻撃が実装されています。</font><font style="vertical-align: inherit;">必要なEMVコマンドを呼び出すと、内部トランザクションカウンターをオーバーフローさせたり、不正なPINコードエントリをシミュレートしたりして、カードをブロックすることができます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なぜ車輪を再発明するのですか？</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
開発を始める前に、既存のソリューションを検討することにしました。特に、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RFIDIOt / ChAP.py</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaccal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nfcmillionaire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conference PoC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Ruby」スクリプト</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Androidアプリ/ libs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を調査しました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レビューされたプログラムのほとんどは、POS端末の操作をシミュレートし、サポートされているカードの識別子を持つ辞書を使用しようとするため、そのようなソリューションはVisaとMasterCardでのみ機能します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の問題は、完全なダンプをダンプするのではなく、データの小さな部分を読み取ることです。ほとんどすべてのプログラムは、その場でできるだけ多くのEMVを解析しようとし、解析エラーを発生させます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題のいずれかがないか、それほど顕著でない場合は、おそらくAndroidのアプリケーション/ライブラリについて話しているため、NFCリーダー付きの電話が必要になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記述された問題は解決することができます、これのためにそれは必要です：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">辞書を使用する代わりにマップタイプを動的に検出する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルを完全に読み取るための複数の操作モードを追加する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その場でEMV標準を分解しようとしないでください</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安価なリーダーPN532を使用（〜5 $）</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カードからデータを取得する</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
詳細にカードと端末（の間の相互作用のプロセス記述Habré記事が既に存在している</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3は、</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私は実用的な部分に自分自身とフォーカスを繰り返さないように頑張りますので）、。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カードと通信するには、手頃な価格とlibnfcライブラリーがあるため、PN532リーダーを使用します。</font><font style="vertical-align: inherit;">私たちは仕事に取り掛かります。</font><font style="vertical-align: inherit;">マップ上のデータは、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
環境-&gt;アプリケーション-&gt;ファイル-&gt;エントリーの</font><font style="vertical-align: inherit;">ように構成されています</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読み取りの目的は、すべてのレコードからデータを取得することです。これを行うには、完全なチェーンを経由する必要があり、環境とアプリケーションの選択は、通信の開始時に一度だけ行われます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EMVコマンドに関する同じプロセス：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT PPSE //非接触環境を選択する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT APPLICATION // AIDでアプリケーションを選択する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">READ RECORD //ファイルとレコード番号を指定する</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チームの1つの編成の例を考えてみます。</font><font style="vertical-align: inherit;">非接触環境を選択する最初のコマンドは常に同じで、次のようになります。</font></font><br>
<br>
<pre><code class="cpp hljs">    <span class="hljs-keyword">byte_t</span> <span class="hljs-keyword">const</span> command[] = {
        <span class="hljs-number">0x40</span>, <span class="hljs-number">0x01</span>, <span class="hljs-comment">// Pn532 InDataExchange</span>
        <span class="hljs-number">0x00</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-comment">// SELECT ppse</span>
        <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// P1:By name, P2:_</span><font></font>
<font></font>
        <span class="hljs-number">0x0e</span>, <span class="hljs-comment">// Lc: Data length</span>
        <span class="hljs-number">0x32</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x59</span>, <span class="hljs-comment">// Data string:</span>
        <span class="hljs-number">0x53</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x31</span>, <span class="hljs-comment">// 2PAY.SYS.DDF01 (PPSE)</span>
        <span class="hljs-number">0x00</span> <span class="hljs-comment">// Le</span><font></font>
    };<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回答例：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6F 23 84 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 A5 11 BF 0C 0E 61 0C 4F 07 A0 00 00 00 03 10 10 87 01 01 90 00 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のコマンドを呼び出すには、回答を解析する必要があります前のチーム。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zk/hj/fp/zkhjfp4fdzmr4zjw9xsfbkt6x8a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーション識別子AIDに関心があります。これを記憶して新しいSELECTクエリを作成しますが、今回は、最初のコマンドのように、受け取ったAIDをPPSEではなくSELECTコマンドに渡します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00 A4 04 00 07 A0 00 00 00 03 10 10 00 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前述のように、AIDを動的に取得し、準備済みの辞書を使用しないことが重要です。アプリケーションは、MIRカードなどのさまざまなタイプのカードを読み取ることができる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションを選択したら、READ RECORDコマンドを使用して必要なレコードを読み取り、ファイル番号とレコード番号をパラメーターとして渡すことができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チーム編成の例：（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これについての詳細は、標準にあります。EMVBook1。11.2 READ RECORD）</font></font></i><br>
<br>
<pre><code class="cpp hljs">    <span class="hljs-keyword">byte_t</span> <span class="hljs-keyword">const</span> sfi_param = (sfi &lt;&lt; <span class="hljs-number">3</span>) | (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-keyword">byte_t</span> <span class="hljs-keyword">const</span> command[] = {
        <span class="hljs-number">0x40</span>, <span class="hljs-number">0x01</span>, <span class="hljs-comment">// Pn532 InDataExchange</span>
        <span class="hljs-number">0x00</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-comment">// READ RECORD</span>
        record_number, sfi_param, <span class="hljs-comment">// P1:record_number and P2:SFI</span>
        <span class="hljs-number">0x00</span> <span class="hljs-comment">// Le</span><font></font>
    };<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">呼び出しの例：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00 B2 02 14 00 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイル番号にはそれぞれ1バイトが割り当てられていないことに注意してください。合計31ファイル（2 ^ 5-1）ですが、255レコードです。1番目から10番目までのファイルがストレージに割り当てられます。カードがロギングをサポートしている場合、内部データとトランザクションログのストレージに残りが割り当てられます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのネストされたループを使用して、各ペアに対してREAD RECORDコマンドを呼び出すことにより、すべてのマップレコードのデータを取得できます。カードから返されたステータスワード（応答の最後の2バイト）に注意を払うと、検索プロセスを大幅に加速できます。ステータスから、ファイルが存在しない（SW = 0x6A82）か、このファイルにそれ以上エントリがない（SW = 0x6A83）ことがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際には、存在しないファイルのケースのみを検討することが理にかなっていることがわかりました。それは、欠落しているエントリのステータスコードを誤って使用するカードがあるためです。</font><font style="vertical-align: inherit;">データを読んだ後、あなたがオンラインパーサの1に送信することができ、私は言っています</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、このいずれかを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マップレコードから抽出されたデータの断片：</font></font><br>
<br>
<img src="https://habrastorage.org/webt/_g/a7/em/_ga7em0ulfkmhjejlef_j4vewmi.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
読み取られたデータは、一部のオンラインストア（主に外国のストア）でカードをマップするのに十分であり、取得した情報は、ソーシャルエンジニアリングを使用したよりパーソナライズされた攻撃に使用できます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非接触型DoSを整理します</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次のタイプの攻撃に進みます。</font><font style="vertical-align: inherit;">DoS-aには少なくとも2つの実装方法があります。</font></font><br>
 <br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遅い方法</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遅い方法を実装するには（攻撃には約4分かかります）、内部のカードトランザクションカウンター（ATC）をオーバーフィルする必要があります。</font><font style="vertical-align: inherit;">これを行うには、次を呼び出します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT PPSE //非接触環境を選択する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT APPLICATION //アプリケーションを選択</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET DATA // ATCオーバーフローまでに残っている量を調べる（オプション）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET PROCESSING OPTIONS // Start Transaction</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET PROCESSING OPTIONS //オーバーフローするまでトランザクションを繰り返す</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手順をより詳細に検討します。</font><font style="vertical-align: inherit;">非接触環境とアプリケーションの選択は、データ抽出を伴うアイテムに似ています。唯一の違いは、今回はSELECT APPLICATIONコマンドの応答を処理する必要があることです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/em/zh/oz/emzhozve-sqitlrqfupooxqnbpy.png"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PDOLフィールドに関心があります。これは、GET PROCESSING OPTIONSコマンドの後続の呼び出しで必要になるため、各呼び出しのトランザクションカウンターが増加するためです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PDOLでは、カードは端末と支払いに関する情報を私たちに尋ねます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記の例では、マップは私たちに尋ねます：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F66 04 //端末トランザクション修飾子（4バイト）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F02 06 //量（6バイト）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F37 04 //予測できない数値（4バイト）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5F2A 02 //トランザクション通貨コード（2バイト）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際の支払いではなくDoSを実装しているため、値の正確さを心配する必要はなく、カードが受け入れる事前準備された値を使用するだけです。</font><font style="vertical-align: inherit;">標準で必要な値の詳細をお読みください。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（EMV Book 3. Annex A Data Elements Dictionary）。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実用上の便宜のため、表を引用します。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タグ（16進数）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有効な値（16進数）</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F59</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端末取引情報</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C8 80 00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F5A</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端末トランザクションタイプ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F58</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">商人タイプインジケーター</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F66</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端末トランザクション修飾子</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">79 00 40 80</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F02</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">金額（承認済み）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00 00 00 10 00 00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F03</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">金額（その他）</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00 00 00 00 00 00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F1A</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">端末の国コード</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01 24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5F2A</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取引通貨コード</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">01 24</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ターミナル検証結果</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00 00 00 00 00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9A</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取引日</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19 01 01</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9C</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取引タイプ</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F37</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">予測できない数</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">82 3D DE 7A</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カードから要求されたデータを形成したら、GPOを呼び出す準備ができました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 80 A8 00 00 12 83 10 79 00 40 80 00 00 00 10 00 00 82 3D DE 7A 01 24 00 </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Answer：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 77 4F 82 02 20 00 94 0C 10 02 03 00 18 01 01 00 10 04 04 00 57 13 42 76 55 00 66 83 25 13 D2 00 52 01 14 89 36 20 00 00 1F 5F 20 02 20 2F 9F 10 07 06 01 11 03 80 20 00 9F 6C 02 30 00 9F 26 08 33 33 89 D5 70 A3 DF 37 9F 27 01 00 9F 36 02 02 48 90 00 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GPO呼び出しを65 536回繰り返し、カードがブロックされます。</font><font style="vertical-align: inherit;">最初にGET DATAを使用して現在のATC値を読み取ることにより、必要な呼び出しの数を減らすことができます。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">簡単な方法</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
カードをロックするのに約2秒かかるので、実装の詳細の詳細な分析は舞台裏に残りますので、クイックメソッドははるかに便利です（そしてより危険です）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この方法は前の方法と似ていますが、今回は、トランザクションカウンターを増やすのではなく、PINコードを入力する試行のカウンターを下げる必要があります。</font><font style="vertical-align: inherit;">Try CounterのPIN値はGET DATAを介して取得することもできますが、この場合、速度が大幅に向上することはありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
必要な操作：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT PPSE //非接触環境を選択する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELECT APPLICATION //アプリケーションを選択</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET DATA // PINを入力するための試行回数を調べる</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GET PROCESSING OPTIONS // Start Transaction</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">確認//間違ったPINを入力してください</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VERIFY //カードがブロックされるまで</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
インターンシップ中、非接触型銀行カードを操作するための新しいツールを作成し、既存のソリューションに存在するいくつかの問題を解決することができました。安価なリーダーを使用すると、研究キットのコストが大幅に削減され、非接触型銀行カードのセキュリティを研究する新しい人々を引き付けるのに役立ちます。</font><font style="vertical-align: inherit;">プログラムのソースコード</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はGithubで入手できます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja468923/index.html">かけ直します</a></li>
<li><a href="../ja468929/index.html">ハッキントッシュを設定するミニマニュアルは、可能な限りシンプルで簡単です</a></li>
<li><a href="../ja468931/index.html">コンテナーでsystemdを実行する</a></li>
<li><a href="../ja468933/index.html">どこを見ても先端のとがった鋭い：ウニの歯の自己研ぎのメカニズム</a></li>
<li><a href="../ja468935/index.html">2019年10月のIT分野の人事担当者向けイベントのダイジェスト</a></li>
<li><a href="../ja468943/index.html">これとEcmaScriptのScopeChain</a></li>
<li><a href="../ja468945/index.html">ITILとITSMは大きな欺瞞の物語です。何かメリットはありますか？それはどれくらいの費用がかかり、正確に「ITILを実装」していないのですか？</a></li>
<li><a href="../ja468951/index.html">小さなデバイスの大きな構成の問題</a></li>
<li><a href="../ja468953/index.html">開発標準としてのコードスタイル</a></li>
<li><a href="../ja468955/index.html">通信は、もう1つの構成可能なリモートオプションです。</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>