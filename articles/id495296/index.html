<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👨🏽 ✌️ 🧙🏽 Forensik, injeksi SQL, dan kucing yang lama menderita: analisis tugas No. 3 dari panggung online NeoQUEST-2020 🔹 📡 🕗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini kita akan mempertimbangkan tugas paling kontroversial dari NeoQUEST-2020 : bagian pertama adalah juara dalam jumlah peserta yang melewatinya,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Forensik, injeksi SQL, dan kucing yang lama menderita: analisis tugas No. 3 dari panggung online NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/495296/"><img src="https://habrastorage.org/webt/gd/oc/8f/gdoc8fvxf7oimhxlgxvmijvuwmk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hari ini kita akan mempertimbangkan tugas paling kontroversial dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : bagian pertama adalah juara dalam jumlah peserta yang melewatinya, dan bagian kedua hanya mematuhi beberapa saja. </font><font style="vertical-align: inherit;">Apa yang istimewa dari dia? </font><font style="vertical-align: inherit;">Pahami potongannya!</font></font><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pernahkah Anda menyelidiki dump RAM? Tahukah Anda berapa banyak hal menarik yang bisa Anda dapatkan dari sana? (spoiler: semuanya, termasuk hasil menjalankan skrip, foto terbaru, serta riwayat browser). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana dengan suntikan SQL eksotis? Anda mengunggah gambar tertentu ke situs, dan Anda diberi informasi dari database tertutup - bukankah ini kejahatan yang ideal? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bagian pertama artikel, kami akan mempertimbangkan alat untuk menganalisis dump memori dan mempelajari cara mengekstrak informasi yang kami butuhkan dari sana, dan di bagian kedua artikel kami akan dengan jelas menunjukkan proses memanipulasi tag gambar untuk injeksi yang rumit :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, tugasnya adalah mengunduh </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arsip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang berisi file biner 1 GB dengan nama berbicara memdump.bin, berdasarkan yang dapat kita asumsikan bahwa ini adalah dump RAM. Kami akan menggunakan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kerangka kerja volatilitas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk penelitiannya </font><font style="vertical-align: inherit;">. Volatilitas mendukung berbagai plugin yang membuatnya mudah untuk mencari dan mengekstrak dari dump berbagai informasi yang berguna untuk </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memeras</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> analis. Pertama, gunakan perintah imageinfo dan dapatkan informasi tentang dump:</font></font><br>
<cut></cut><br>
<img src="https://habrastorage.org/webt/8b/po/2n/8bpo2nbfia9ykmdpqohz8zt4w0a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dilihat oleh output dari perintah imageinfo, kita berurusan dengan dump memori Windows 7. Selanjutnya, kita akan melihat daftar proses yang berjalan di sistem pada saat dump dihapus menggunakan perintah pslist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/1n/py/ja1npywtltvjjnzwwhbs7mkk1ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam daftar ini, Anda dapat melihat beberapa proses menarik. Mari kita mulai studi dengan proses chrome.exe - di browser Anda selalu dapat menemukan sesuatu yang menarik. Ada plugin tambahan untuk volatilitas yang mengotomatiskan ekstraksi informasi dari proses. Sebagai contoh, plugin </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chromehistory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan memungkinkan kita untuk mengekstrak riwayat kunjungan browser dari dump RAM: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/oo/o7/lxooo7skzcqwcxf-hw_njv5rmdk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam sejarah chrome, beberapa hal menarik dapat dilihat sekaligus. Pertama, tautan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke bagian kedua penugasan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, serta permintaan pencarian tentang metadata di gambar PNG, yang juga merupakan petunjuk untuk bagian kedua, tetapi kita akan beralih ke ini nanti. Pada tahap saat ini, kami tertarik pada permintaan untuk kode promosi </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk diskon</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke situs dan file-file pdf, yang mengisyaratkan objek pencarian lebih lanjut (menjalankan Acrobat Reader`a juga dapat mendorong kami dalam hal ini). Mari kita coba cari dokumen pdf dalam dump menggunakan perintah filescan: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/ro/qk/sbroqkdf1jetkddyzac1rhasqh0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selamat mencoba! Sepertinya ada beberapa promo.pdf di dump. Mari kita coba menariknya menggunakan perintah dumpfiles:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-w/gn/iz/-wgnizdzvl_kszkhof-z1bldwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, kesulitan kecil mungkin timbul karena kenyataan bahwa beberapa pemirsa dokumen pdf mungkin tidak mengenali file yang baru saja diekstrak (Anda hanya perlu menghapus byte tambahan di akhir file). Tetapi apakah kita benar-benar takut dengan beberapa byte tambahan? :) Pada akhirnya, buka dokumen dan lihat kode QR, setelah membaca yang mana, kita mendapatkan bendera dari bagian pertama tugas (dan pada saat yang sama kode promosi untuk menerima hadiah dari tim NeoQUEST - kami memberikan hadiah yang berkesan semua peserta yang menyelesaikan setidaknya satu tugas!).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/84/od/xp84odjm5frx774wqy9ka75rjws.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, cobalah untuk mendapatkan bendera kedua. Kami kembali ke situs, tautan yang ditemukan dalam riwayat browser. Untuk mengakses situs Anda perlu memasukkan kode promosi. Kami mengingat riwayat pencarian di browser dan deskripsi dokumen itu sendiri (GUNAKAN INI UNTUK BERGABUNG), dari mana kami dapat menganggap bahwa bendera pertama adalah kode promosi yang kami butuhkan. Kami memasukkannya ke dalam bidang dan sampai ke situs tempat kami ditawari untuk mengunggah gambar: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n9/kb/vu/n9kbvuleozzylxcgoa2hxy5trhq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Melihat seberapa sering situs membeku, peserta kami memutuskan untuk secara eksperimental memverifikasi pemuatan semua jenis dokumen yang mungkin. Sejumlah waktu kemudian kami memahami bahwa hanya gambar PNG yang dapat diunggah ke situs. Teka-teki berikutnya adalah pesan "Tidak cukup data untuk menyimpan gambar ini, maaf!", Yang terjadi ketika Anda mencoba mengunggah gambar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kembali ke riwayat peramban, kami ingat tentang permintaan formulir “tambahkan metadata ke file png”. Menggunakan kesimpulan sederhana, kami menyimpulkan bahwa, kemungkinan besar, nilai-nilai tertentu harus dimasukkan dalam metadata untuk mengunggah gambar ke situs. Anda dapat mulai dengan menjelajahi format PNG (untuk keterangan, misalnya, klik di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Pertama, periksa daftar kata kunci standar untuk gambar metadata PNG, misalnya: "Penulis", "Deskripsi", dll. Dengan menggunakan, misalnya, utilitas konversi dari set ImageMagick, tambahkan metadata ke gambar uji: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convert test.png -set 'Title' '1' -set 'Author' '2' -set 'Deskripsi' '3' -set 'Copyright' '4 '-set' Waktu Pembuatan '' 5 '-set' Perangkat Lunak '' 6 '-set' Penafian '' 7 '-set 'Warning' '8' -set 'Source' '9' -set 'Comment' '0' out.png</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mencoba mengunggah gambar yang dihasilkan ke situs dan menikmati keberhasilan: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sa/7o/pw/sa7opwndturwyzaqse9f4qah83g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata bidang metadata yang diperlukan adalah Judul, Deskripsi, Penulis, dan Hak Cipta. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebuah petunjuk untuk ini, omong-omong, juga dapat ditemukan di dump memori: Anda dapat menemukan penyebutan file mr_cat.png menggunakan volatilitas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/bw/cn/ixbwcn3pzw3ndqxlbnfb6btadyk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peserta kami memutuskan bahwa dengan bantuan Tn. Cat maka perlu untuk menyuntikkan situs tersebut (banyak pesan datang ke surat kami dengan Tn. Cat dalam bentuk terkompresi, terbalik, terpantul dan </font><font style="vertical-align: inherit;">penampilan </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak sedap dipandang</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lainnya </font><font style="vertical-align: inherit;">), tetapi kucing tidak ada hubungannya dengan itu! Dia hanya mengalihkan perhatian dan memberi isyarat kepada para peserta: well, lihat saya, ada sesuatu yang menarik di dalam! Di dalam tempat sampah, gambar hanya terpelihara sebagian; namun, dalam residunya, Anda dapat melihat bidang metadata lengkap yang diperlukan:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/4h/0o/zv4h0ogsh94higmrsqslbzbxzby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Silakan: sekarang kita dapat mengunggah file ke situs; namun, apa yang diberikannya dan bagaimana mencari bendera? Adalah logis untuk mengasumsikan bahwa sekali metadata diperlukan untuk mengunduh, ada kemungkinan bahwa mereka entah bagaimana digunakan untuk menyimpan file yang diunduh (misalnya, sebagai kunci dalam database). Hore! Kami mendekati pencuci mulut: kami perlu memeriksa situs untuk kemungkinan injeksi SQL. Kami mengetahui bahwa jika salah satu parameter diganti dengan tanda kutip ganda ("), maka situs akan memberi tahu kami tentang kesalahan alih-alih memuat gambar:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/s2/bf/f7s2bfigyph9mkfj9jfg6wfxhxc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita melihat query SQL itu sendiri dan memahami bidang apa yang bisa kita operasikan untuk membangun injeksi untuk mengekstrak data dari database yang digunakan. Adapun lokasi bendera, dalam hal ini logis untuk memeriksa gambar pertama yang telah diunggah ke database. Juga, selama operasi injeksi, Anda harus memperhatikan fakta bahwa INSERT dieksekusi dalam permintaan. Ini memaksa Anda untuk membangun kueri tertentu, karena Anda tidak dapat secara eksplisit melakukan operasi SELECT dari tabel yang sama yang Anda sisipkan pada saat yang sama dengan operasi sisipan (INSERT). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita membuat permintaan untuk mengeluarkan Deskripsi gambar pertama dalam basis data:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convert test1.png -set 'Judul' '1' -set 'Penulis' '", (SELECT description FROM (SELECT * FROM picture) AS x batas 0,1)) - -' -set 'Deskripsi' '3' - set 'Copyright' '4' test.png </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unggah gambar yang dihasilkan ke situs web dan dapatkan deskripsi di bidang Hak Cipta, yang merupakan tanda: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/k8/6x/vzk86xyosytdwsvc9orcwkypybi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hore, tugas selesai! Kami berharap bahwa kami meyakinkan semua orang untuk memeriksa ulang input pengguna untuk yang ke-juta kalinya, dan juga tetap aman apel mata Anda dari membuat dump RAM Anda :) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selesaikan artikel dengan kutipan dari orang bijak:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qg/9i/un/qg9iunp8zncqovjy3_qg990lmlc.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495280/index.html">Max Patrol SIEM. Keamanan Informasi Ikhtisar Sistem Manajemen Kejadian</a></li>
<li><a href="../id495282/index.html">Validasi XML menggunakan XSD, JAXB, dan Spring Framework</a></li>
<li><a href="../id495290/index.html">Menjelajahi kualitas kode sistem operasi Zephyr</a></li>
<li><a href="../id495292/index.html">InterSystems IRIS 2020.1 Rilis</a></li>
<li><a href="../id495294/index.html">Macro untuk pythonist. Laporan Yandex</a></li>
<li><a href="../id495298/index.html">Evaluasi Pilihan Monte Carlo Clojure</a></li>
<li><a href="../id495302/index.html">Cara meningkatkan penjualan 2,5 kali dalam 4 bulan di toko online - sebuah kasus untuk promosi SEO</a></li>
<li><a href="../id495304/index.html">Peremajaan sel manusia karena pemrograman ulang mereka</a></li>
<li><a href="../id495308/index.html">Menyapu jalan untuk tetap hidup</a></li>
<li><a href="../id495310/index.html">Walk-through elektronik: biometrik dan multi-format</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>