<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ú üèõÔ∏è üë©üèº‚Äçü§ù‚Äçüë®üèª Zone data storage üèóÔ∏è ‚è≥ ü§®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Western Digital recently announced its zonal storage initiative, an initiative aimed at an open data infrastructure designed to take advantage of zona...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Zone data storage</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wd/blog/490908/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nv/3b/hz/nv3bhzqzmm1n2rhzvh1gqu4brng.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Western Digital recently announced its zonal storage initiative, an initiative aimed at an open data infrastructure designed to take advantage of zonal storage devices.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zoned Storage is a new storage paradigm motivated by incredible data growth. </font><font style="vertical-align: inherit;">Our society is increasingly dependent on data in everyday life, and data management on an extreme scale is becoming increasingly necessary. </font><font style="vertical-align: inherit;">Already today, in large-scale data processing infrastructures, tens of thousands of hard drives and solid state drives are used. </font><font style="vertical-align: inherit;">But even so, out of more than 30 ZB data that is created per year, less than 20% remains in storage. </font><font style="vertical-align: inherit;">The goal of our industry is to ensure that the consumer can afford not to throw out data that can be beneficial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article we will discuss:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are zonal storage devices and why is this technology being implemented</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMR Hard Drives and ZNS Solid State Drives</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Infrastructure - What is Required to Implement Zonal Data Storage</font></font></li>
</ul><a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are zone storage devices?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In its simplest form, zone storage devices are block storage devices whose address space is divided into zones. </font><font style="vertical-align: inherit;">ZSD impose unconventional recording rules: zones can be recorded sequentially, only starting from the beginning of the zone. </font><font style="vertical-align: inherit;">In addition, data within a zone cannot be arbitrarily overwritten.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/tu/ex/fhtuexqojzwesqou-bh6sy44cim.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only way to overwrite an already recorded zone is to reset the zone record pointer, which effectively deletes all the data in the zone, and overwrite it from the beginning of the zone. </font><font style="vertical-align: inherit;">On the other hand, reading data is largely unlimited, and can be read in the same way as on traditional storage devices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The concept of zonal storage devices is standardized:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For devices with SAS interface, work with zones is prescribed in the T10 ZBC standard</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SATA also standardized under T13 ZAC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For NVMe SSDs, a technical proposal is under development called ZNS</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why zonal storage?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The motivation for applying zonal storage technology is the high efficiency of the storage infrastructure. </font><font style="vertical-align: inherit;">Thanks to this technology, higher capacity devices can be used in a more economical way. </font><font style="vertical-align: inherit;">More details on how this economic efficiency is achieved for each type of zonal devices will be explained later in the article.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It all started with SMR</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Over the past few years, the technology of tiled magnetic recording (SMR) has been introduced in hard drives, which has increased the recording density, increase the capacity and cost-effectiveness of hard drives. In SMR, unlike conventional recording, tracks are recorded overlapping, like tiles on a house roof. This allows you to more densely pack tracks and, therefore, provides a higher recording density. In fact, the use of SMR gives us ‚Äúfree‚Äù terabytes of capacity: on the basis of the usual 12 TB disk, you can make 14 or even 15 TB SMR drive, without increasing the cost of production.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/d2/gp/85/d2gp85zvtb68gyn1ulnnng-nbtc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main limitation of this technology is the inability to write data to tracks in random order. As we cannot replace arbitrary tiles on the roof of the house, so with the data in the SMR - we cannot arbitrarily overwrite several blocks without hooking adjacent tracks. To control recording, the disc surface is divided into zones with a gap between them. This allows you to record and erase each zone independently of each other (the size of the zone in the current generation of disks is usually 256 MB).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Several approaches can be used to control recording restriction. The traditional approach (drive-managed - controlled by the drive itself) assumes that the device processes the internal write restrictions on its own using algorithms in microcode and buffers, and provides a normal interface to the host. This type of SMR is commonly used in client devices such as laptop HDDs. However, for large-scale corporate or cloud systems, where performance and space utilization should be predictable, relying on the disc itself to control sequential recording is not possible - performance ‚Äúfloats‚Äù too much depending on the structure and intensity of the load and buffer fullness.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host-managed SMR is an almost mandatory requirement for large data storage systems and is the preferred option for data centers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Host SMR control is standardized in INCITS T10 / T13 as part of the Zone Block Command (ZBC) and Zone ATA (ZAC) device standards for SAS and SATA, respectively.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NVMe and Zone Namespaces in Solid State Drives</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For solid state drives (SSDs), the limitation on the presence of regions that can only be written sequentially (NAND pages) and must be deleted before new data is written (NAND blocks) is an integral property of NAND flash memory operation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When SSDs were first introduced, they introduced an internal management system, called the Flash Translation Layer (FTL), which addressed this recording limitation. FTL allowed the use of solid state drives instead of hard drives without the need to immediately rewrite the software stack. For the end user, the SSD looks like a hard drive with fast random access to information - and this is the merit of FTL.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
However, local control within an SSD is far from ideal in terms of efficiency. </font><font style="vertical-align: inherit;">In particular, there are factors such as:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Write Amplification: To cope with the limitations of not overwriting data, the SSD must move the data on its own to clean unused storage areas called Garbage Collection (GC). </font><font style="vertical-align: inherit;">The garbage collection process, when the FTL "plays tag" with data blocks, causes multiple recordings of the same information (hence the term "excess recording"), which leads to increased wear on the flash memory and shortened the life of the solid state drive. </font><font style="vertical-align: inherit;">The WA coefficient shows how many write operations must be done inside the drive for one write operation received from the host.</font></font></li>
</ul><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cj/2o/jt/cj2ojtou6g2sd22zje-vqdd0vra.png"></div><br>
<ul>
<li> (overprovisioning ‚Äî OP):   (    28%   )             .</li>
<li>   DRAM :   FTL -         DRAM.  ,     DRAM     .        ‚Äî 1      SSD.  ,    SSD  15.36  ‚Äî 16 ¬´¬ª .  ,       !</li>
<li> QoS,               .  FTL   ,          , ,   .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These shortcomings were acceptable in the first wave of the introduction of solid state drives, since the software stacks and interfaces were designed for hard drives, and the response time to the HDD was much longer. For the end user, switching from HDD to SSD was still noticeable acceleration. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Over time, however, the industry moved on to creating more efficient interfaces and software stacks that can take advantage of lower latency and higher flash bandwidth. In particular, the NVMe (Non-Volatile Memory Express) interface specification was created and the corresponding low-cost software stack developed.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The current state of the industry is such that the local optimizations that occurred in the FTL SSD are now detrimental to the deployment of the data infrastructure. In particular, many customers have the desire to create a host-driven sequential workload that matches the size of the NAND flash blocks. In response, NVMe standardizes zone namespaces (ZNSs), which allows the host to direct I / O to share workloads, while also improving latency, bandwidth, and cost-effectiveness by moving the main control to the host.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If we talk about economic efficiency, the transition to ZNS SSD will reduce the cost of the drive by using a smaller amount of NAND (reduction of redundancy), the possibility of using QLC in server drives, reducing the amount of DRAM in SSD controllers.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Infrastructure - Implementing a Zonal Data Warehouse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We have already found out that zonal block devices increase storage efficiency, however, to take advantage of these new devices, some efforts are required, since they do not have backward compatibility with the usual block program stack. While traditional storage devices do not have recording restrictions, zone block devices have recording restrictions that must be consistent within the zone. The main consequence of this is the need to update the software stack.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first component that needs to be updated is the operating system. </font><font style="vertical-align: inherit;">This is not a trivial task in modern multi-tasking operating systems running on multi-core and multi-socket servers typical of data centers. </font><font style="vertical-align: inherit;">The Linux community has made significant efforts to support zone block devices in general, and SMR in particular. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to supporting the Linux kernel, there are a number of utilities and applications that support Zone Block Devices, such as fio, Blktests, and util-linux.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux Kernel and Zone Block Devices</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Work on support for zone storage in the Linux kernel began back in 2014 with the smallest amount of support built into the 3.18 kernel. The first kernel release with functional support for ZBC / ZAC commands was the 4.10 kernel in early 2017. Support continues to improve, and the latest kernels have support for displaying zone devices in the form of block / dev / sd, as well as support for some file systems (f2fs, btrfs).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The figure below shows a high-level image of the structure of the Linux kernel and how zone devices can be integrated with traditional block devices. Support in the Linux kernel was implemented by modifying some existing components, introducing new interfaces, such as the ZBD interface at the block level, and introducing new components, such as the device-mapper dm-zoned.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ty/k0/j5/tyk0j5jgjxt_-dzgsd480nibdvq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As shown in the figure, there are many ways in which the deployment of a data infrastructure can use zone block devices. </font><font style="vertical-align: inherit;">For example (i) Using the old file system on top of the dm-zoned LVM volume, (ii) using the ZBC-enabled file system, (iii) using ZBD-enabled applications that interact directly with block devices through user libraries such as libzbc, and etc.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Area Storage Initiative - Promoting broader support and implementation of applied technologies</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite the successes made by the open source community of developers in supporting Zone Block Devices, information technology engineers and application developers are still making efforts to use this technology, for example, finding out what level of support exists in each release of the Linux kernel, which versions of applications have the necessary support and which version of the kernel is necessary for their work. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The zonal storage initiative was launched in part to address this problem and to promote wider application support for zonal storage technologies. You can visit the site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZonedStorage.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to learn more about zonal storage technologies and the use of ZNS SSDs and ZBC / ZAC SMRs. </font><font style="vertical-align: inherit;">There you will find information on the following issues:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zone block devices</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Getting Started Guides</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux kernel support and features</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Applications and Libraries</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zone device emulation on a regular</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performance testing</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System Compliance Tests</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using this platform, infrastructure engineers and storage application developers now have a centralized location to get all the information and resources needed to use area storage technologies.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Are you ready</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Visit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZonedStorage.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and see if your servers are ready to work with zone drives. </font><font style="vertical-align: inherit;">Try to deploy software emulation over a regular device, and it may turn out that the load structure of your application fits well with the concept of zonal storage, and you should consider deploying a test environment.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490890/index.html">Heroku and React: Deploy Your First App</a></li>
<li><a href="../en490892/index.html">How to generate keys and ads for Yandex and Google from a YML file for free</a></li>
<li><a href="../en490894/index.html">Subtle thoughts on website architecture</a></li>
<li><a href="../en490896/index.html">Principles of work for the children's intensive care unit in the form of a response to ‚ÄúProgrammer, the pack and John Steinbeck‚Äù or</a></li>
<li><a href="../en490906/index.html">Yandex rolled out a beta of an independent Aura - aura.top. Is it top?</a></li>
<li><a href="../en490912/index.html">How we at Sportmaster chose a caching system. Part 1</a></li>
<li><a href="../en490916/index.html">Problems of interaction with external teams on large projects</a></li>
<li><a href="../en490918/index.html">Andrei Zaretsky, Alexander Trukhanov (continued): ‚ÄúWe did not have a name, but there was arrogance‚Äù</a></li>
<li><a href="../en490920/index.html">Accelerate your search in Have I Been Pwned to 49 microseconds (C ++)</a></li>
<li><a href="../en490924/index.html">What is Windows PowerShell and what does it eat? Part 2: Introduction to the programming language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>