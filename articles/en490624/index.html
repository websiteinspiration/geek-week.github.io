<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçï ü§ûüèø üï¶ Feature-Policy HTTP Header and Web Browser Control üìú üì¶ üë©‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is one completely incomparable technique that allows you to keep the performance of a web project under control. It consists in introducing mech...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Feature-Policy HTTP Header and Web Browser Control</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490624/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is one completely incomparable technique that allows you to keep the performance of a web project under control. It consists in introducing mechanisms into the development process, the results of which are clearly visible. These mechanisms are designed to always remind the programmer of the importance of performance. There is something in this context that I really like. This is the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feature-Policy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTTP header </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
This title is a relatively new feature that allows a developer to make certain browser features turn on and off while browsing his site. </font><font style="vertical-align: inherit;">
For example, you can tell the browser that it should not allow the use of the Geolocation API by passing it the following header:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/_a/mh/zz/_amhzzcwmae7goctptz7hobpnwa.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: geolocation 'none'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are many advantages to </font><font style="vertical-align: inherit;">using a header </font><font style="vertical-align: inherit;">in terms of security and performance. </font><font style="vertical-align: inherit;">But I now especially like how </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can use it to make website performance issues that are usually easy to overlook more noticeable. </font><font style="vertical-align: inherit;">This can be compared to something like "performance linting." </font><font style="vertical-align: inherit;">In particular, we are talking about identifying problems with images used in web projects.</font></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oversized-images policy</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the image is transmitted to the browser in a format that it supports, such an image will be displayed. This is standard browser behavior. The browser, trying to help those who are viewing the page, also automatically scales such images. Therefore, they look good even if they are represented by huge graphic files. As a result, if you use images that are larger than the sizes needed by the page, then this is, at first glance, invisible. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Policy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tells the browser that it should not allow the use of images whose size exceeds, by a specified number of times, the size of their containers. </font><font style="vertical-align: inherit;">The image, in accordance with the standard restriction, cannot be more than 2 times the container. </font><font style="vertical-align: inherit;">But this value, if necessary, can be redefined. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, if the browser receives the next header, it will not allow you to display images taken from any sources (this is set thanks </font></font><code>none</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), the dimensions of which are more than 2 times the size of their containers (in width or height).</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you need more flexibility, you can tell the browser that it should not display images that are more than 3 times larger than the containers:</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: oversized-images *(3) 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In any case, if the image does not fit the specified boundaries, a stub will be displayed instead of the image, and an error message will be sent to the console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c98/1e3/169/c981e3169d9219c226c13236f198c222.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the site uses the oversized-images policy, large images will be uploaded, but a stub will be displayed instead, and an error message will be displayed in the console</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unoptimized Images</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another common problem with graphics is the use of non-optimized images. Quite often you can come across images that were not adequately compressed. Their size, however, can be selected correctly. So, to files with photos, when shooting and creating them, a lot of unnecessary metadata can be added, which often remain in files and when used in browsers. One particularly annoying example of this is images, the metadata of which contains their own thumbnails for preview. Many times I saw how the thumbnail embedded in the image (the presence of which designers and developers did not even know), ‚Äúweighed‚Äù more than the image itself!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Among other things, here you can recall the usual image compression, supported by many formats, which allows you to achieve the perfect balance between picture quality and file size. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unoptimized-lossy-images</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unoptimized-lossless-images</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> policies </font><font style="vertical-align: inherit;">let the browser know that it matches file size and image size in pixels.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unoptimized-lossy-images 'none';<font></font>
Feature-Policy: unoptimized-lossless-images 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the number of bytes per pixel (Byte-per-pixel, BPP) is too high, then the browser will display a stub instead of the image and display an error message in the console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/347/215/e57/347215e574f0574312eff1d6737b8d9e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Applying unoptimized- * policies causes a stub to be displayed instead of inappropriate images - just like using the oversized-images policy, the</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
recommended BPP level for lossy compressed images is 0.5, and 1 for lossless compressed images. In addition, when analyzing images, a slight deviation of their total size from these levels is allowed. Now this deviation for images compressed with loss is 1 Kb, for images compressed without loss - 10 Kb.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, suppose we have a JPEG image of 200x200 pixels. JPEG is a lossy image compression format, resulting in a recommended BPP level of 0.5. At the same time, the total image size may exceed the recommended size by only 1 Kb. To find out what size a similar image should suit a browser, you need to multiply the dimensions of the sides of the image in pixels by each other and by BPP, and then add the allowed deviation to what happens. </font></font><br>
<br>
<code>(200 x 200 x .5) + 1024 = 21,024</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte, or </font></font><code>20.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kb </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If the image is compressed without loss, then a deviation from the ‚Äúideal‚Äù size of 10 Kb is allowed, while the BPP of such an image will be 1. Otherwise, the calculations look exactly the same: </font></font><br>
<br>
<code>(200 x 200 x 1) + 10,240 = 50,240</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">byte, or </font></font><code>49.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kb</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The size of the permitted deviation is likely to change in the future. </font><font style="vertical-align: inherit;">In fact, although Blink, by default, uses this indicator for images compressed without loss, equal to 10 Kb, experiments are already underway with a policy </font></font><code>unoptimized-lossless-images-strict</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that changes this indicator, lowering it to the level of 1 Kb.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Media not specified</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The new is the well-forgotten old. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For a long time the use of image attributes </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">was more or less common. Without these attributes, the browser did not know how much space the image should occupy until the moment the image was loaded. This led to shifts in page layouts. The page was displayed, and then, after the image arrived, its content shifted. The browser once again had to recount the layout in order to allocate space for the image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the time came for layouts in which image sizes had to be flexibly resized using CSS, the presence or absence of these attributes no longer played a special role. As a result, many simply stopped using these attributes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But thanks to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recent work</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">initiated by Jen Simmons, Firefox and Chrome can calculate the aspect ratio of images based on their attributes </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. When this approach is combined with the styles applied to images, it turns out that browsers can reserve space for images during the initial passage of the layout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsized-media</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> policy </font><font style="vertical-align: inherit;">tells the browser that all media elements must have attributes that specify the sizes of these elements. If there are no such attributes, the browser should use the default values. Everything, in fact, is a little more complicated, but the bottom line is that if the image does not have the appropriate attributes, the browser uses the standard </font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixel </font><font style="vertical-align: inherit;">value </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="plaintext hljs">Feature-Policy: unsized-media 'none';</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When this policy is applied, images will be displayed, but if their size is not specified in HTML, the developer will quickly notice that the images are displayed in the default size. And, as usual, an error message will be sent to the console.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a4b/b8a/4c5/a4bb8a4c52a7267ef162a8a8244c0f9a.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Applying the unsized-media policy leads to the fact that images and videos without the height and width attributes are displayed, but the browser sets their sizes to 300x150 pixels.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Probably, it‚Äôs worth mentioning one feature that at first seemed unusual to me. </font><font style="vertical-align: inherit;">She shows herself when sharing policies</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>oversized-images</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In this situation, one should not be surprised at the appearance of more than before, the number of messages about too large images. </font><font style="vertical-align: inherit;">The fact is that due to the application of the policy, the</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">browser resizes images that do not have attributes</font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">up to</font></font><code>300x150</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixels. </font><font style="vertical-align: inherit;">After which it is this size that the browser uses as a reference point to determine whether the image matches its container.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attracting attention to less visible issues</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In image-related policies, I like the fact that they, in the process of developing projects, make it possible to make visible what is usually hidden. As a result, the developer learns that he did not take care of optimizing the images, or that he forgot to set their attributes </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. All these errors are immediately reflected in the appearance of the pages. In fact, the main advantage of using the above policies is that they allow the developer to quickly find out about problems with the images. While politics</font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can lead to a decrease in the number of situations in which ‚Äúshifts‚Äù of page layouts occur; the use of other policies does not prevent the loading of inappropriate images. As a result, the only strong point of applying these policies is that they draw the attention of developers to problems. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several more policies that may be useful in terms of analyzing pages for the impact of something on their performance. This is where policies like </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sync-script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> come to mind </font><font style="vertical-align: inherit;">(this policy blocks the execution of synchronous scripts), </font></font><code>sync-xhr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(blocks synchronous AJAX requests) and </font></font><code>document-write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(blocks calls </font></font><code>document.write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These policies are great tools for controlling certain aspects of page performance, but they themselves do not provide developers with the same noticeable feedback that many of the above policies provide in the form of missing images. Of course, if the page has a synchronous script, without which it is not displayed, then this is not easy to miss (and such pages are not so difficult to find). But these policies usually indicate errors in the form of messages displayed on the console. And to be honest, I suspect that most developers do not pay much attention to the console (I think we should all be more careful about the console). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But, nevertheless, we can make the errors detected by the "invisible" policies much more noticeable using the API</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReportingObserver</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for monitoring violations and for displaying relevant notifications on the page. </font><font style="vertical-align: inherit;">Such notifications can be made very noticeable.</font></font><br>
<br>
<pre><code class="plaintext hljs">let reportingAlerts = document.createElement('ul');<font></font>
&nbsp;&nbsp;reportingAlerts.setAttribute('id','reportingAlerts');<font></font>
&nbsp;&nbsp;document.body.appendChild(reportingAlerts);<font></font>
<font></font>
const alertBox = document.getElementById('reportingAlerts');<font></font>
<font></font>
new ReportingObserver((reports, observer) =&gt; {<font></font>
&nbsp;&nbsp;let fragment = document.createDocumentFragment();<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;Object.keys(reports).forEach(function(item) {<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;let li = document.createElement('li');<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;li.textContent = reports[item].body.message + ': ' + reports[item].body.featureId;<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;fragment.appendChild(li);<font></font>
&nbsp;&nbsp;});<font></font>
&nbsp;&nbsp;<font></font>
&nbsp;&nbsp;alertBox.appendChild(fragment)<font></font>
}, {types: ['feature-policy-violation'], buffered: true}).observe();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I sketched </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an example</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in CodePen </font><font style="vertical-align: inherit;">of how this might look.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2bd/c18/c8a/2bdc18c8a9bb20db1f18a9e095be4b8e.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An example of how you can display notifications of policy violations specified by the Feature-Policy header. </font><font style="vertical-align: inherit;">Such notifications are designed for output in the development environment, or where the project is prepared for output to production.</font></font></font></i><br>
 <br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Less use of the Feature-Policy header</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The big minus of using the header </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is its support by browsers. </font><font style="vertical-align: inherit;">Apparently, now it is supported only by Blink-based browsers (Opera, Edge, Chrome, Samsung). </font><font style="vertical-align: inherit;">Firefox and Safari browsers support the attribute </font></font><code>allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for items </font></font><code>iframe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But even where it is </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supported, to ensure the health of many of the policies, you need to enable the flag </font></font><code>Experimental Web Platform features</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(you can find it at the address </font></font><code>about:flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How I Use Feature-Policy Header</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That minus of the title </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which is mentioned above, for me personally is not a particular problem. I prefer to use the policies defined by this header as a browser-based page checker. Therefore, I do not need to strive to apply </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in production, or to ensure that policies work for all my users. They are needed only by me, as well as by those who are developing the site. I, in any case, use Chrome as the main browser in the development process. Therefore, ensuring performance </font></font><code>Feature-Police</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in my work environment is to enable the appropriate flag. After this, the politicians work without any additional intervention on my part. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I found that the easiest way to use the header is </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a browser extension</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModHeader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This extension allows you to set your own headings that are passed to pages when they are viewed.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c9/ec2/33b/9c9ec233b6a3913a5e584335ac43a344.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The ModHeader extension allows you to configure Feature-Policy header options. </font><font style="vertical-align: inherit;">They can be turned on and off, if desired</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
. I have three sets of header values</font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that I periodically use:</font></font><br>
<br>
<ul>
<li><code>oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
<li><code>script-sync 'none'; unsized-media 'none'; oversized-images 'none'; unoptimized-lossy-images 'none'; unoptimized-lossless-images 'none';</code></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I often keep the first one turned on. It‚Äôs very exciting to travel through web pages to which the policies used in it apply. It is scary to look at how large some images are. There are many things on the modern web that could be improved. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So, politics is very often triggered on the pages </font></font><code>unsized-media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(and I also sin by this), so its use during normal work on the Internet is inconvenient. That is why I have it highlighted in a separate policy, which I can turn on and off. The same applies to policies </font></font><code>sync-scripts</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, the application of which "breaks" many sites.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Some of the teams I worked with started using the policies I described during development. </font><font style="vertical-align: inherit;">This allows them to quickly pay attention to previously invisible problems. </font><font style="vertical-align: inherit;">Of course, I recommend including all policies </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the development environment, which allows you to quickly identify and correct errors.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I hope that support </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will appear, as a result, not only in Chrome. </font><font style="vertical-align: inherit;">Although this is my main browser, I have to use other browsers as well. </font><font style="vertical-align: inherit;">It would be helpful if they supported </font></font><code>Feature-Policy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But here, however, we see that rare situation when even experimental support of a certain opportunity is enough for it to be of real benefit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Subtle performance issues are also problems. </font><font style="vertical-align: inherit;">And the ability to make such problems more visible is one of the best methods that a developer can use in order to identify and fix them. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do you plan to use the Feature-Policy heading to identify inconspicuous issues in web projects?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490612/index.html">Functional approach to transactions on Scala or write your own useful monad</a></li>
<li><a href="../en490616/index.html">The digest of fresh materials from the world of the front-end for the last week No. 404 (February 24 - March 1, 2020)</a></li>
<li><a href="../en490618/index.html">Goroutine Stack Buffers</a></li>
<li><a href="../en490620/index.html">When I hear the words "restored the neural network", I climb to check backups</a></li>
<li><a href="../en490622/index.html">Fighting memory leaks in web applications</a></li>
<li><a href="../en490626/index.html">A complete guide to data- * HTML attributes</a></li>
<li><a href="../en490628/index.html">What to do when CSS blocks page parsing?</a></li>
<li><a href="../en490630/index.html">Loading NumPy Arrays from Disk: Comparison of memmap () and Zarr / HDF5</a></li>
<li><a href="../en490634/index.html">Digital events in Moscow from March 2 to 8</a></li>
<li><a href="../en490636/index.html">Digital events in St. Petersburg from March 2 to 8</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>