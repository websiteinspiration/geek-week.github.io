<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏻 ⏮️ 🧚🏼 CI / CD流程更新：准备和计划 👩‍🎤 💪 🧕🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在2020年，可能很难在没有以下单词之一的堆栈描述中找到项目：IaC，微服务，kubernetes，docker，aws / azure / gcloud，区块链，ML，VR等。太好了！进步不会停滞不前。我们正在成长，我们的项目也在成长，出现了解决现代问题的更加便捷和实用的工具。
 
 你好。所以我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>CI / CD流程更新：准备和计划</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496204/"><img src="https://habrastorage.org/webt/vl/jg/11/vljg11dfzemfbyfy8oexvw73eyq.png" alt="图片"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在2020年，可能很难在没有以下单词之一的堆栈描述中找到项目：IaC，微服务，kubernetes，docker，aws / azure / gcloud，区块链，ML，VR等。</font><font style="vertical-align: inherit;">太好了！</font><font style="vertical-align: inherit;">进步不会停滞不前。</font><font style="vertical-align: inherit;">我们正在成长，我们的项目也在成长，出现了解决现代问题的更加便捷和实用的工具。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
你好。所以我想开始这篇文章。但是后来我回顾了一些事情，与同事交谈，意识到我会错。仍然有超过15年的项目，管理者和参与者都是老信徒，因此这些项目具有古老的技术堆栈，很难在现有动物园中维护。由于某种原因，该项目无法进行全局更新（客户是starover，没有更新，项目很大，迁移被延迟，或者每个人都满意），因此您必须予以支持。当仍在积极开发类似项目时，情况更令人不快。就像雪球一样。客户和公众需要功能，代码需要交付，服务器需要关注和维护...但是位包-因此，总的来说，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不再支持汞</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">建议仅考虑这种情况。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
将考虑什么：转换mercurial-git，将CI从CruiseControl.NET迁移到TeamCity，从git-deployment迁移到Octopus </font><font style="vertical-align: inherit;">，并对整个过程</font><font style="vertical-align: inherit;">进行</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">少量</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文本的内容很多，因此将其分成多个部分以方便理解。</font><font style="vertical-align: inherit;">将有一个目录。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第1部分：是什么，为什么不喜欢，计划，要花点时间。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我将这部分称为技术性的。</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第2部分：团队合作精神。</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第3部分：章鱼部署。</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第四部分：幕后花絮。</font><font style="vertical-align: inherit;">不愉快的时刻，未来的计划，可能是常见问题解答。</font><font style="vertical-align: inherit;">最有可能的是，它也可以称为近技术。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于许多原因，我不会将其称为重复指南：由于时间紧缺而无法完全沉浸在项目流程中，对此类事物的实践不足，巨大的整体作品将所有子项目紧密地交织在一起，以及许多其他细微差别，这些细微之处使您不知所措，忍受不了，但无论如何都不要取悦。</font><font style="vertical-align: inherit;">而且，由于项目的功能（这是非常独特的），某些步骤将专门针对这种情况而定制。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">经典介绍</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们有一个Mercurial资源库，300多个（开放！）Brunches，ccnet，另一个ccnet + git（用于部署），以及带有我们自己的配置和单个客户端的一整套项目模块，四个环境以及IIS中的一整套池以及cmd脚本，SQL，五百多个域，两打构建以及活跃的开发。并非所有这些都是必要的，但它确实有效，并且很不方便且很长。唯一令我担忧的是存在其他需要我注意的项目。没有如此集中的工作和干扰，在处理如此庞大的任务的过程中，没有什么比这更危险了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我知道早晚我将不得不注意其他任务，这就是为什么我花大量时间研究现有基础架构，以便至少以后不会出现未解决的问题的原因。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
遗憾的是，由于NDA的原因，我无法完整描述该项目，因此将考虑一般技术要点。与项目相关的所有名称也将被涂上。对于屏幕截图上的黑色涂片，我深表歉意。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该项目的主要特点之一是，它具有许多具有一个核心但模块配置不同的模块。还有一些采用“特殊”方法的模块，这些模块是为经销商和特别是大型客户设计的。一个模块可以为多个客户提供服务。客户应被理解为获得特定模块访问权限的独立组织或一群人。每个客户端都可以访问自己的域，具有自己的设计和自己独特的默认设置。客户端由其使用的域标识。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该项目这部分的总体方案可以表示如下：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/1p/jp/ft1pjp-5mnyfk2fu07salwryrew.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，核心在所有地方都使用相同，并且可以使用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
出现任务以审查和更新CI / CD流程的原因：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CruiseControl.NET被用作构建系统。</font><font style="vertical-align: inherit;">原则上和他一起工作是一种可疑的乐趣。</font><font style="vertical-align: inherit;">多个屏幕上的XML配置，一堆依赖项以及彼此之间的链接配置，缺乏针对现代问题的现代解决方案。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目中的某些开发人员（主要是潜在客户）必须有权访问构建服务器，他们有时喜欢更改ccnet配置，但不应更改。</font><font style="vertical-align: inherit;">猜猜接下来会发生什么。</font><font style="vertical-align: inherit;">您需要在CI系统中具有简单方便的权限管理，而又不影响开发人员对服务器的访问。</font><font style="vertical-align: inherit;">简而言之，没有文本配置-没有地方可以用顽皮的手攀爬。</font></font></li>
<li>  - …  CCNET,        git.         (. ).</li>
<li> ,      .     ,      .&nbsp;</li>
<li>-       ,        —         (   )       .</li>
<li>   .        ?   ?     ?            .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资源使用不足，构建和交付代码的过程过时。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
图至第3段：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/yk/kv/hcykkvp6zijbax7ykugimj3qwkq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在计划阶段，决定使用Teamcity作为构建系统，并使用Octopus作为部署系统。</font><font style="vertical-align: inherit;">客户的“铁”基础架构保持不变：用于开发，测试，登台和生产的单独的专用服务器，以及代理商服务器（主要是生产环境）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
向客户提供了其中一个模块示例的概念证明，编写了一项行动计划，并进行了准备工作（安装，配置等）。</font><font style="vertical-align: inherit;">描述这一点可能没有任何意义。</font><font style="vertical-align: inherit;">如何安装团队城市可以在官方网站上阅读。</font><font style="vertical-align: inherit;">我将分别讨论新系统的一些规定要求：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">易于维护，并承担所有后果（备份，更新，解决问题，如果有的话）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">普遍性。</font><font style="vertical-align: inherit;">理想情况下，开发一个通用方案，根据该方案组装和交付所有模块，并将其用作模板。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减少添加新的构建配置和维护的时间。</font><font style="vertical-align: inherit;">客户端被添加/删除。</font><font style="vertical-align: inherit;">有时有必要进行新的设置。</font><font style="vertical-align: inherit;">创建新模块时，必须不延迟其交付配置。</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大约在这一点上，我们想起了使用位桶停止对Mercury存储库的支持，并且添加了将存储库转移到git的同时保留分支和提交历史的要求。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备：存储库转换</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
似乎有人清楚地解决了这个问题，摆在我们面前而不是我们。</font><font style="vertical-align: inherit;">您只需要找到一个现成的工作解决方案。</font><font style="vertical-align: inherit;">事实证明，快速导出并不是那么快。</font><font style="vertical-align: inherit;">另外，它没有用。</font><font style="vertical-align: inherit;">不幸的是，没有日志和屏幕截图了。</font><font style="vertical-align: inherit;">事实是他做不到。</font><font style="vertical-align: inherit;">Bitbucket不提供自己的转换器（但可以提供）。</font><font style="vertical-align: inherit;">还有更多的谷歌方法，也可以。</font><font style="vertical-align: inherit;">我决定编写自己的脚本，无论如何这不是唯一的软件资源库，它将在将来派上用场。</font><font style="vertical-align: inherit;">此处将介绍早期的发展（因为它们仍然保持相同的形式）。</font><font style="vertical-align: inherit;">工作的逻辑看起来像这样：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们以扩展汞柱为基础。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们获得了汞库所有分支的列表。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们转换分支的名称（感谢Mercurial和开发人员提供的分支名称中的空格，特别感谢为您带来欢乐的变音符号和其他字符）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制作书签（hg书签）并推入中间存储库。</font><font style="vertical-align: inherit;">做什么的？</font><font style="vertical-align: inherit;">因为是bitbucket，而且因为您无法创建与分支名称相同的书签（例如，暂存）。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在新的（已经是git）存储库中，从分支名称中删除后缀，并将hgignore迁移到gitignore。&nbsp;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推送到主存储库。 </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
根据要点列出命令：</font></font><br>
<br>
<ol>
<li><pre><code class="bash hljs">$ <span class="hljs-built_in">cd</span> /path/to/hg/repo<font></font>
$ cat &lt;&lt; EOF &gt;&gt; ./.hg/hgrc<font></font>
[extensions]<font></font>
hggit=<font></font>
EOF<font></font>
</code></pre></li>
<li><pre><code class="bash hljs">$ hg branches &gt; ../branches
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/usr/bin/env bash</span>
hgBranchList=<span class="hljs-string">"./branches"</span>
sed -i <span class="hljs-string">'s/:.*//g'</span> <span class="hljs-variable">${hgBranchList}</span>
symbolsToDelete=$(awk <span class="hljs-string">'{print $NF}'</span> FS=<span class="hljs-string">" "</span> <span class="hljs-variable">${hgBranchList}</span> &gt; sym_to_del.tmp)<font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> hgBranch; <span class="hljs-keyword">do</span>
  hgBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${hgBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${hgBranchList}</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> str; <span class="hljs-keyword">do</span>
  strToDel[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${str}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt; ./sym_to_del.tmp<font></font>
 <font></font>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!strToDel[@]}</span>
<span class="hljs-keyword">do</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-variable">${hgBranches[$i]}</span> | sed <span class="hljs-string">"s/<span class="hljs-variable">${strToDel[$i]}</span>//"</span> &gt;&gt; result.tmp
<span class="hljs-keyword">done</span><font></font>
 <font></font>
sed -i <span class="hljs-string">'s/[ \t]*$//'</span> result.tmp<font></font>
sed <span class="hljs-string">'s/^/"/g'</span> result.tmp &gt; branches_hg<font></font>
sed -i <span class="hljs-string">'s/$/"/g'</span> branches_hg<font></font>
sed <span class="hljs-string">'s/ /-/g'</span> result.tmp &gt; branches_git<font></font>
sed -i <span class="hljs-string">'s/-\/-/\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/-\//\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/\/-/\//g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/---/-/g'</span> branches_git<font></font>
sed -i <span class="hljs-string">'s/--/-/g'</span> branches_git<font></font>
rm sym_to_del.tmp<font></font>
rm result.tmp<font></font>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/usr/bin/env bash</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
hgBranchList=<span class="hljs-string">"./branches_hg"</span>
hgRepo=<span class="hljs-string">"/repos/reponame"</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> hgBranch; <span class="hljs-keyword">do</span>
  hgBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${hgBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${hgBranchList}</span><font></font>
 <font></font>
i=0<font></font>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>
  gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>
  i=$((i+<span class="hljs-number">1</span>))
<span class="hljs-keyword">done</span> &lt;<span class="hljs-variable">${gitBranchList}</span><font></font>
 <font></font>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">${hgRepo}</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>
<span class="hljs-keyword">do</span>
  hg bookmark -r <span class="hljs-string">"<span class="hljs-variable">${hgBranches[$i]}</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${gitBranches[$i]}</span>-cnv"</span>
<span class="hljs-keyword">done</span><font></font>
 <font></font>
hg push git+ssh://git@bitbucket.org:username/reponame-temp.git<font></font>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Done."</span>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># clone repo, run git branch -a, delete remotes/origin words to leave only branch names, delete -cnv postfix, delete default branch string because we can't delete it</span>
repo=<span class="hljs-string">"/repos/repo"</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
defaultBranch=<span class="hljs-string">"default-cnv"</span>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>   gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>;   i=$((i+<span class="hljs-number">1</span>)); <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$gitBranchList</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$repo</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span> git checkout <span class="hljs-variable">${gitBranches[$i]}</span>-cnv; <span class="hljs-keyword">done</span>
git checkout <span class="hljs-variable">$defaultBranch</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span>
    git branch -m <span class="hljs-variable">${gitBranches[$i]}</span>-cnv <span class="hljs-variable">${gitBranches[$i]}</span>
    git push origin :<span class="hljs-variable">${gitBranches[$i]}</span>-cnv <span class="hljs-variable">${gitBranches[$i]}</span>
    git push origin -u <span class="hljs-variable">${gitBranches[$i]}</span>
<span class="hljs-keyword">done</span>
</code></pre></li>
<li><pre><code class="bash hljs"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># clone repo, run git branch -a, delete remotes/origin words to leave only branch names, delete -cnv postfix, delete default branch string because we can't delete it</span>
repo=<span class="hljs-string">"/repos/repo"</span>
gitBranchList=<span class="hljs-string">"./branches_git"</span>
defaultBranch=<span class="hljs-string">"default"</span>
<span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> gitBranch; <span class="hljs-keyword">do</span>   gitBranches[<span class="hljs-variable">$i</span>]=<span class="hljs-variable">${gitBranch}</span>;   i=$((i+<span class="hljs-number">1</span>)); <span class="hljs-keyword">done</span> &lt; <span class="hljs-variable">$gitBranchList</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$repo</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">${!gitBranches[@]}</span>; <span class="hljs-keyword">do</span>
    git checkout <span class="hljs-variable">${gitBranches[$i]}</span>
    sed -i <span class="hljs-string">'1d'</span> .hgignore<font></font>
    mv .hgignore .gitignore<font></font>
    git add .<font></font>
    git commit -m <span class="hljs-string">"Migrated ignore file"</span>
<span class="hljs-keyword">done</span>
</code></pre></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我将尝试解释某些操作的含义，即使用中间存储库。最初，在转换后的存储库中，分支名称包含后缀“ -cnv”。这是由于hg书签功能。您需要删除此后缀，并且还要制作gitignore文件而不是hgignore。所有这些都增加了历史记录，因此增加了存储库的大小（并且不合理地增加了）。作为另一个示例，我可以引用以下内容：尝试创建一个存储库，并将第一次提交及其代码推送到300M。然后将其添加到gitignore中，并在没有它的情况下进行推送。他将保持历史。现在尝试将其从历史记录中删除（git filter-branch）。使用一定数量的提交，结果存储库的大小不会减少，但会增加。这可以通过优化解决，但是不能在bitbucket上启动。仅在导入存储库时执行。因此，所有的粗略操作都是在中间进行的，然后导入到新的操作中。最终，中间存储库的大小为1.15G，生成的结果为350M。&nbsp;</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结论</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
整个迁移过程分为几个阶段，即：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备（使用一个构建，软件安装，存储库转换，更新现有ccnet配置的示例向客户演示）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发环境及其测试的CI / CD配置（旧系统仍可并行运行）；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">剩余环境的CI / CD设置（与现有的“良好”并行）和测试；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迁移开发，暂存和测试；</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迁移生产并将域从旧的IIS实例转移到新的实例。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当前正在完成对成功完成的准备阶段的描述。</font><font style="vertical-align: inherit;">除了现有系统没有崩溃并且git中的mercurial存储库已迁移以外，这里没有取得巨大的成功。</font><font style="vertical-align: inherit;">但是，如果不对这些过程进行描述，就不会有更多技术部分的内容。</font><font style="vertical-align: inherit;">下一部分将描述基于团队合作性建立CI系统的过程。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN496190/index.html">关于短语动词2</a></li>
<li><a href="../zh-CN496192/index.html">从Go调用Rust函数</a></li>
<li><a href="../zh-CN496194/index.html">关于精细结构断层图像的二值化</a></li>
<li><a href="../zh-CN496196/index.html">DEFCON会议26.摇尾巴：秘密的被动监视。第1部分</a></li>
<li><a href="../zh-CN496198/index.html">关于训练机器人主题的第二次ROS Meetup的演示</a></li>
<li><a href="../zh-CN496206/index.html">在0.3秒内在数据库中进行十亿次操作。不要将OLTP与OLAP进行比较，而将QuestDB与PostgreSQL进行比较</a></li>
<li><a href="../zh-CN496208/index.html">JIT如何内联我们的C＃代码（启发式）</a></li>
<li><a href="../zh-CN496210/index.html">生物多样性可能是从玩剪刀布的原则演变而来的</a></li>
<li><a href="../zh-CN496212/index.html">＃04-整个字节不足... | 以牛角骑BK</a></li>
<li><a href="../zh-CN496214/index.html">AdColony：89％的移动应用和游戏发行商使用促销视频</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>