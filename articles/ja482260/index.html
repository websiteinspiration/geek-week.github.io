<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇🏻 🈳 ☝🏻 TelegramBot。基本的な機能。ステッカーと顔文字。（パート3） ◼️ 🧔🏻 👩🏻‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="よくPMに来る質問の1つは、絵文字とステッカーを使用する方法です。
 
 それらの使用方法、使用するツールなど 
 
 この部分では、ステッカーを使用してメッセージを作成する方法、ステッカーを使用して受信したメッセージを処理する方法、メッセージテキスト内のすべての笑顔（絵文字）を見つける方法、笑顔を...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>TelegramBot。基本的な機能。ステッカーと顔文字。（パート3）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482260/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">よくPMに来る質問の1つは、絵文字とステッカーを使用する方法です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらの使用方法、使用するツールなど </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この部分では、ステッカーを使用してメッセージを作成する方法、ステッカーを使用して受信したメッセージを処理する方法、メッセージテキスト内のすべての笑顔（絵文字）を見つける方法、笑顔を使用してメッセージを作成する方法（絵文字）について検討します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
猫の下で誰が気にかけてください。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
伝統的に、記事のソースへのリンクから記事を開始します:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事で説明されているすべてのコードは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part3-Stick_and_Emojiブランチで</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">収集され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ステッカー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
電報で登場してすぐに気に入ったのがステッカーでした。</font><font style="vertical-align: inherit;">彼らはクールで快適、無料です。</font><font style="vertical-align: inherit;">そして、ボットで自然に使用したいこのさまざまなステッカーすべて。</font><font style="vertical-align: inherit;">実際、この手順は非常に簡単です。</font><font style="vertical-align: inherit;">ステッカーをユーザーに送信するには、ステッカーのIDを知っているだけで、他には何も必要ありません。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通常、ステッカーのために、ボットで使用されるステッカーに関するデータを格納するヘルパークラスを作成します</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。Stickers.java</font></font></a><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> org.telegram.telegrambots.api.methods.send.SendSticker;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Stickers {<font></font>
    FUNNY_JIM_CARREY(<span class="hljs-string">"CAADBQADiQMAAukKyAPZH7wCI2BwFxYE"</span>),<font></font>
    ;<font></font>
<font></font>
    String stickerId;<font></font>
<font></font>
    Stickers(String stickerId) {<font></font>
        <span class="hljs-keyword">this</span>.stickerId = stickerId;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> SendSticker <span class="hljs-title">getSendSticker</span><span class="hljs-params">(String chatId)</span> </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-string">""</span>.equals(chatId)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"ChatId cant be null"</span>);<font></font>
        SendSticker sendSticker = getSendSticker();<font></font>
        sendSticker.setChatId(chatId);<font></font>
        <span class="hljs-keyword">return</span> sendSticker;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> SendSticker <span class="hljs-title">getSendSticker</span><span class="hljs-params">()</span> </span>{<font></font>
        SendSticker sendSticker = <span class="hljs-keyword">new</span> SendSticker();<font></font>
        sendSticker.setSticker(stickerId);<font></font>
        <span class="hljs-keyword">return</span> sendSticker;<font></font>
    }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここではすべてが簡単です。</font><font style="vertical-align: inherit;">ステッカーにはわかりやすい名前を付けています。</font><font style="vertical-align: inherit;">そして、いくつかのメソッドを使用して、ユーザーに送信するための既製のオブジェクトを取得します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「ステッカーのIDはどこで入手できますか？」という質問に答えるために、ボットでこのデータを提供するアシスタントを作成しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで作成した基本機能は</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TelegramBotです。</font><font style="vertical-align: inherit;">基本的な機能。</font><font style="vertical-align: inherit;">（パート2）</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ボットが受け入れたステッカーの処理を何らかの方法で開始するためには、次のものが必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 彼らがステッカーを送ってくれたことを確認する</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ステッカーを使用してメッセージを処理するハンドラーを指定します</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 応答としてユーザーにメッセージを生成するハンドラーを実行します </font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：チャットでステッカーを受け取ると、ボットはそれに応じてステッカーIDを含むテキストメッセージを送信する必要があります。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">STICKER</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
コマンドをコマンドのリストに追加しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
送信された更新のアナライザーで、テキストメッセージまたはステッカーが含まれているかどうかを確認します</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。MessageReciever.java行57</font></font></a><br>
<br>
<pre><code class="java hljs">        <span class="hljs-keyword">if</span> (message.hasText()) {<font></font>
            parsedCommand = parser.getParsedCommand(message.getText());<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            Sticker sticker = message.getSticker();<font></font>
            <span class="hljs-keyword">if</span> (sticker != <span class="hljs-keyword">null</span>) {<font></font>
                parsedCommand = <span class="hljs-keyword">new</span> ParsedCommand(Command.STICKER, sticker.getFileId());<font></font>
            }<font></font>
        }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜなら </font><font style="vertical-align: inherit;">送信されたメッセージの複雑な処理を行う必要はありません。その後、いわゆる「システムメッセージ」の処理を担当する既存のハンドラーにステッカーを含むメッセージの処理を委託します</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。MessageReciever.java行86</font></font></a><br>
<br>
<pre><code class="java hljs">            <span class="hljs-keyword">case</span> START:
            <span class="hljs-keyword">case</span> HELP:
            <span class="hljs-keyword">case</span> ID:
            <span class="hljs-keyword">case</span> STICKER:<font></font>
                SystemHandler systemHandler = <span class="hljs-keyword">new</span> SystemHandler(bot);<font></font>
                log.info(<span class="hljs-string">"Handler for command["</span> + command.toString() + <span class="hljs-string">"] is: "</span> + systemHandler);
                <span class="hljs-keyword">return</span> systemHandler;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、中</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemHandler</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我々は、受信処理方法を指定する必要があり</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STICKERの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コマンドを</font><font style="vertical-align: inherit;">：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemHandler.javaライン31を</font></font></a><br>
<br>
<pre><code class="java hljs">            <span class="hljs-keyword">case</span> STICKER:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"StickerID: "</span> + parsedCommand.getText();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その結果、ボットにステッカーを送信すると、応答としてそのIDが返されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3i/56/dy/3i56dyf1gkch2j-xgy9o-gjk8si.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">絵文字または絵文字</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それらは標準化されており、ほとんどすべてのデバイスとオペレーティングシステムがそれらを理解して表示できます。メッセージの装飾に使用すると非常に便利です。彼らはメッセージの下のボタンを簡潔に見ています。好きかどうか-いくつかの利点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、イベントのボットスケジューラで</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/r3/bq/bd/r3bqbdspnrch4-qy28vppzwxiks.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
は、ボタンの同じアイコンとメッセージのテキストを使用して、ユーザーが直感的にインターフェイスを理解できるようにし、余分なテキストでメッセージとボタンを乱雑にします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージまたはボタンに絵文字を表示するには、そのUnicodeを知っている必要があります。インターネットには、リストされているすべての絵文字を見つけることができるソースがたくさんあります。その絵文字には、タグ、コードが示されています。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私自身は、絵文字を使用するこの方法を選択しました。電報自体で絵文字を見て選択する方が便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ステッカーとの類推によって、必要なコードを示し、正しく処理することが保証されるようにするために、自分自身のための小さなヘルパーを作成しましょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず</font><font style="vertical-align: inherit;">、次の依存関係</font><font style="vertical-align: inherit;">を</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pom.xmlに</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="xml hljs">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.vdurmont<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>emoji-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直なところ、どこで見つけたのか覚えていませんが、それ以来、ボットの絵文字で何かをする必要がある場合にのみ使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ライブラリには、さまざまなツールが含まれています。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ri/4e/qm/ri4eqmdo2uiyrnwoxck1trfklim.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
好奇心旺盛で好奇心旺盛な方が好転します:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットを使用して絵文字を送信するには何が必要ですか？ Unicodeメッセージのテキストに目的の絵文字を埋め込む必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
はい、絵文字付きのUnicodeリストを提供するリソースを検索したり、さまざまなスマートフォンで絵文字がどのように見えるかについてのさまざまな要約表を表示したりできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が笑顔で作業するのに最も便利だとわかった方法を紹介したいと思います。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初に、電報自体で笑顔を使用する方法を見てみましょう。アイコンをクリックするだけで、すべての絵文字がリストされているダイアログボックスを呼び出し、それらをメッセージに追加できます。絵文字は、タグを使用してメッセージに追加することもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグはコロンで囲み、希望のスマイリーを示す何らかの一意のテキストを含める必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コロンで始まるメッセージ入力フィールドにメッセージを入力し始めると、テレグラム自体</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/s4/1o/hrs41orsvl1k4mkpt7mxlja-bnm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
に、</font><font style="vertical-align: inherit;">タグを</font><font style="vertical-align: inherit;">入力する</font><font style="vertical-align: inherit;">テキストを含む絵文字が表示され始め</font><font style="vertical-align: inherit;">ます。正​​しいスマイリータグを入力して別のコロンを入力すると、テキストはスマイリーに変わります。絵文字でマウスの左ボタンを押すと、タグも表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/t-/ib/ya/t-ibya9mw4829qau8wnz9h8uxwq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、ライブラリーは私たちの助けになります、依存関係は上で追加しました。</font><font style="vertical-align: inherit;">彼女は絵文字タグの操作方法を知っています。</font><font style="vertical-align: inherit;">タグはより読みやすく、ある種の意味を持っているため、これは主にあなたにとって便利です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タグを知っていると、次のようなUnicodeの絵文字を取得できます。</font></font><br>
<br>
<pre><code class="java hljs">String emoji_kissing = EmojiParser.parseToUnicode(<span class="hljs-string">":kissing:"</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ボットで使用する絵文字を保持する別のクラスを自分で作成できます。</font><font style="vertical-align: inherit;">例</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">イベントプランナー</font></a><font style="vertical-align: inherit;">を使用して</font><font style="vertical-align: inherit;">、彼は彼の武器にこれらの笑顔を持っています：</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> com.vdurmont.emoji.EmojiParser;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Icon {<font></font>
    PLUS(<span class="hljs-string">":heavy_plus_sign:"</span>),<font></font>
    MINUS(<span class="hljs-string">":heavy_minus_sign:"</span>),<font></font>
    CHECK(<span class="hljs-string">":white_check_mark:"</span>),<font></font>
    NOT(<span class="hljs-string">":x:"</span>),<font></font>
    DOUBT(<span class="hljs-string">":zzz:"</span>),<font></font>
    FLAG(<span class="hljs-string">":checkered_flag:"</span>)<font></font>
<font></font>
    <span class="hljs-keyword">private</span> String value;<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> EmojiParser.parseToUnicode(value);<font></font>
    }<font></font>
<font></font>
    Icon(String value) {<font></font>
        <span class="hljs-keyword">this</span>.value = value;<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、これは、このクラスと特定の絵文字を使用してコードがどのように見えるかです。</font></font><br>
<br>
<pre><code class="java hljs">        row.add(<span class="hljs-keyword">new</span> InlineKeyboardButton()<font></font>
                .setText(Icon.CHECK.get() + <span class="hljs-string">" I'm going"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはこのボタンのコードです</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bc/lw/ou/bclwou1ukoe0nosc7iyfnqw6zki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。このライブラリのニュアンスに気づきました。</font><font style="vertical-align: inherit;">電報にあるすべての絵文字ではなく、ライブラリは認識できます。</font><font style="vertical-align: inherit;">したがって、ライブラリの新しいバージョンに注意してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
確かに、どの笑顔を見せることができ、そうでないことは、この仕事をアシスタントに任せます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスク：</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">送信されたメッセージに特定のコマンドが含まれていないが、テキストに絵文字が含まれている場合-これらの絵文字をユーザーへのメッセージの形式で画面に表示し、属性（タグと説明）を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンド</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TEXT_CONTAIN_EMOJI </font></font></b><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Command.java行8</font></a><font style="vertical-align: inherit;">をコマンドのリストに追加します</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Command {<font></font>
  ...<font></font>
    TEXT_CONTAIN_EMOJI,<font></font>
  ...<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージに含まれるコマンドの種類を決定するパーサーに、次のテキストを追加します</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。Parser.java行38</font></font></a><br>
<br>
<pre><code class="java hljs">        <span class="hljs-keyword">if</span> (result.getCommand() == Command.NONE) {<font></font>
            List&lt;String&gt; emojiContainsInText = EmojiParser.extractEmojis(result.getText());<font></font>
            <span class="hljs-keyword">if</span> (emojiContainsInText.size() &gt; <span class="hljs-number">0</span>) result.setCommand(Command.TEXT_CONTAIN_EMOJI);<font></font>
        }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メッセージに特定のコマンドが含まれていないが、絵文字が含まれていると判断した場合は、TEXT_CONTAIN_EMOJIコマンドを解析したことを返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコマンドのみを処理する別のハンドラーを作成します：</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmojiHandler.java</font></font></a><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">import</span> com.example.telegrambot.bot.Bot;
<span class="hljs-keyword">import</span> com.example.telegrambot.command.ParsedCommand;
<span class="hljs-keyword">import</span> com.vdurmont.emoji.Emoji;
<span class="hljs-keyword">import</span> com.vdurmont.emoji.EmojiManager;
<span class="hljs-keyword">import</span> com.vdurmont.emoji.EmojiParser;
<span class="hljs-keyword">import</span> org.apache.log4j.Logger;
<span class="hljs-keyword">import</span> org.telegram.telegrambots.api.objects.Update;<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.util.HashSet;
<span class="hljs-keyword">import</span> java.util.Set;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmojiHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHandler</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger log = Logger.getLogger(EmojiHandler.class);<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmojiHandler</span><span class="hljs-params">(Bot bot)</span> </span>{
        <span class="hljs-keyword">super</span>(bot);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">operate</span><span class="hljs-params">(String chatId, ParsedCommand parsedCommand, Update update)</span> </span>{<font></font>
        String text = parsedCommand.getText();<font></font>
        StringBuilder result = <span class="hljs-keyword">new</span> StringBuilder();<font></font>
        Set&lt;String&gt; emojisInTextUnique = <span class="hljs-keyword">new</span> HashSet&lt;&gt;(EmojiParser.extractEmojis(text));
        <span class="hljs-keyword">if</span> (emojisInTextUnique.size() &gt; <span class="hljs-number">0</span>) result.append(<span class="hljs-string">"Parsed emojies from message:"</span>).append(<span class="hljs-string">"\n"</span>);
        <span class="hljs-keyword">for</span> (String emojiUnicode : emojisInTextUnique) {<font></font>
            Emoji byUnicode = EmojiManager.getByUnicode(emojiUnicode);<font></font>
            log.debug(byUnicode.toString());<font></font>
            String emoji = byUnicode.getUnicode() + <span class="hljs-string">" "</span> +<font></font>
                    byUnicode.getAliases() +<font></font>
                    <span class="hljs-string">" "</span> + byUnicode.getDescription();<font></font>
            result.append(emoji).append(<span class="hljs-string">"\n"</span>);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> result.toString();<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このコードは、メッセージテキストから絵文字のみを選択し、固有のものからセットを形成し、それらのプロパティからタグと説明を選択し、これからテキストメッセージを形成します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業の結果は次のよう</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ia/wy/sx/iawysxkxh3utfud9znjifqrgosm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
になります。角括弧内に、絵文字を挿入するために使用できるタグを取得します。 1つ以上のタグが1つの絵文字を参照する場合があることがわかります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、このアシスタントの助けを借りて、ライブラリが理解している絵文字と無視している絵文字を正確に理解できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、次のように表示されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bz/f9/5i/bzf95i9alj3uqweuzdxfqg9ost0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードを使用して笑顔</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：face_with_monocle：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なんらかの理由で、このライブラリーによって検出されません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ハンドラーがあります。どのようにしてタスクを彼に渡しますか？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
なぜなら </font><font style="vertical-align: inherit;">絵文字が入ったテキストメッセージがTEXT_CONTAIN_EMOJIコマンドとして検出されることはすでに知っています。MessageRecieverでは、このコマンドの処理は別のEmojiHandlerハンドラーが担当することを示す必要があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MessageReciever.java行94</font></font></a><br>
<br>
<pre><code class="java hljs">            <span class="hljs-keyword">case</span> TEXT_CONTAIN_EMOJI:<font></font>
                EmojiHandler emojiHandler = <span class="hljs-keyword">new</span> EmojiHandler(bot);<font></font>
                log.info(<span class="hljs-string">"Handler for command["</span> + command.toString() + <span class="hljs-string">"] is: "</span> + emojiHandler);
                <span class="hljs-keyword">return</span> emojiHandler;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
楽しみのためにプログラムを作成し、お気軽に質問してください:) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この機能を使用して</font><font style="vertical-align: inherit;">ボット</font><font style="vertical-align: inherit;">を感じることができます：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">//t.me/test_habr_bot</font></a><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482250/index.html">VueJSの単純な状態マシン</a></li>
<li><a href="../ja482252/index.html">自動猫トイレ-続き</a></li>
<li><a href="../ja482254/index.html">VonmoTradeの実験。パート3：令状。貿易情報の処理と保管</a></li>
<li><a href="../ja482256/index.html">AIと仕事の未来：近い将来の雇用の見通し</a></li>
<li><a href="../ja482258/index.html">ニューラルネットワークのしくみと、大金を持ち始めた理由</a></li>
<li><a href="../ja482262/index.html">Talend Open Studioにログインする方法</a></li>
<li><a href="../ja482264/index.html">ブラジル、ダークマジック、モータルコンバット、火星、15,000人。オンティコ年結果</a></li>
<li><a href="../ja482268/index.html">未来の巨大構造：ダイソン球、恒星エンジン、「ブラックホール爆弾」</a></li>
<li><a href="../ja482272/index.html">Prometheusのデータウェアハウスの選択：ThanosとVictoriaMetrics</a></li>
<li><a href="../ja482274/index.html">ASP.NETでSystem.Drawingの使用を停止すべき5つの理由</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>