<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍⚕️ 💃 👩🏿‍🏭 "El destino tiene muchas formas ..." o automatizamos el control de una bombilla usando CANNY 3 tiny y un fotorresistor 🏹 👨🏽‍🏭 🤛🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el último artículo sobre Habr, les conté cómo recibí el pequeño controlador Canny3 como regalo. "Parpadeamos" el LED, presionamos un botón. Sobre e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>"El destino tiene muchas formas ..." o automatizamos el control de una bombilla usando CANNY 3 tiny y un fotorresistor</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489764/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">último artículo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre Habr, les conté cómo recibí el pequeño controlador Canny3 como regalo. "Parpadeamos" el LED, presionamos un botón. Sobre esto, en principio, fue posible terminar los experimentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, durante las últimas semanas he estado escuchando audiolibros sobre The </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Witcher</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y, por lo tanto, me he vuelto mucho más serio sobre </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Destination</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Según la información proporcionada en el sitio web del fabricante, la familia de controladores CANNY está destinada principalmente a la automatización de diversos sistemas de automóviles y equipos especiales.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El problema es que nadie me dejará hurgar en un auto real con mis "manos doradas", y en general tengo miedo de los autos. </font><font style="vertical-align: inherit;">Por lo tanto, tuve que comprar una pequeña lámpara de automóvil y una fotorresistencia especialmente para este artículo. </font><font style="vertical-align: inherit;">Lo que no harás para no enojar al Destino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoy conectaremos el controlador y la lámpara del automóvil a una fuente de alimentación de 12V, enviaremos un mensaje al puerto COM, automatizaremos la inclusión de la lámpara dependiendo de la luz y probaremos el controlador PWM de alta frecuencia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿También crees en el poder del Destino? </font><font style="vertical-align: inherit;">Entonces eres bienvenido bajo cat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yt/kd/tj/ytkdtjul2i1qbdrqllt278lszck.png"><br>
<a name="habracut"></a><br>
<br>
<a name="I"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte I: Introducción</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte I: Introducción </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte II: Componentes y precauciones </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte III: Cómo escribir datos en el puerto COM </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte IV: Conecte y programe la lámpara automática y el fotorresistor </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte V: </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Intente </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">reducir el brillo de la lámpara usando PWM </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte VI: Conclusión</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Al comienzo del artículo, le recuerdo No tengo mucha experiencia en electrónica de bricolaje. </font><font style="vertical-align: inherit;">Hace muchos años incursioné en CraftDuino, el clon doméstico de Arduino. </font><font style="vertical-align: inherit;">Y aparte de esas "manualidades" que hizo por mí</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drzugrik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta es realmente mi experiencia en electrónica de bricolaje es limitada. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aparentemente, conociendo mi amor por los desarrollos domésticos, decidí darle a Canny 3.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Incluso en el proceso de preparación del último artículo, me sorprendió que el controlador pueda alimentarse no solo desde 5V, sino también desde 12V, mientras que el voltaje en las salidas será el mismo que en entrada, y la corriente máxima por canal es de hasta 100 mA. Me pareció interesante, porque mi viejo CraftDuino no podía. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cálculos simples usando la fórmula</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo>=</mo><mi>U</mi><mo>&amp;#x2217;</mo><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.993ex" height="2.009ex" viewBox="0 -755.5 4302.5 865.1" role="img" focusable="false" style="vertical-align: -0.255ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-55" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-2217" x="3075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-49" x="3798" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>=</mo><mi>U</mi><mo>∗</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">P=U*I</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me di cuenta de que la potencia máxima por salida del controlador será de alrededor de 1,2 vatios. Se decidió recoger una lámpara con reserva de marcha, por si acaso. La elección recayó en una bombilla LED de 0,9 W. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, todavía no quería quemar mi regalo de Año Nuevo sin gloria, y antes de conectarlo, decidí preguntar a los desarrolladores si entendía todo correctamente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para mi gran sorpresa, no solo me respondieron, sino que también sugirieron que si combina varias salidas, la potencia aumentará proporcionalmente. Después de eso, se decidió comprar algo más potente que la lámpara y la elección recayó en el ventilador del automóvil, que se inserta en el encendedor. Sin embargo, para no hacer "vinagreta" del artículo, decidí posponer las manipulaciones con el ventilador del automóvil hasta la próxima vez.</font></font><br>
<br>
<a name="II"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte II: equipo y precauciones </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, al comienzo de los experimentos, tenía lo siguiente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispositivo de carga y lanzamiento "Orion Vympel-55". </font><font style="vertical-align: inherit;">Ya lo tenía y, afortunadamente, no solo puede cargar las baterías, sino también ser una fuente de alimentación en un amplio rango (incluyendo 12 V);</font></font><br>
<br>
<img src="https://habrastorage.org/webt/uj/fi/_i/ujfi_iwx1hku88fcb2trgbdhvqu.jpeg"><br>
<br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autolamp LED "Skyway H3. </font><font style="vertical-align: inherit;">SH3-9SMD-5050 W. " </font><font style="vertical-align: inherit;">Según tengo entendido, la bombilla se puede usar en varios faros, pero no tengo dónde pegarla, así que elegí la potencia y la facilidad de conexión sin soldar; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zw/vm/yi/zwvmyih0_5t0grxn5elq4j1zvfe.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, volviendo a la fórmula de cálculo de potencia, decidí medir las corrientes y asegurarme de que encajaba en los 100 mA permitidos. </font><font style="vertical-align: inherit;">En teoría, la corriente de la bombilla debería ser</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo>=</mo><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>U</mi><mo>=</mo><mn>0.9</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>12</mn><mo>=</mo><mn>0</mn><mo>,</mo><mn>075</mn><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.044ex" height="2.634ex" viewBox="0 -809.3 12504.8 1134.2" role="img" focusable="false" style="vertical-align: -0.755ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-3D" x="782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-50" x="1838" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-2F" x="2590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-55" x="3090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-3D" x="4135" y="0"></use><g transform="translate(5192,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-39" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-2F" x="6471" y="0"></use><g transform="translate(6972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-3D" x="8250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-30" x="9307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-2C" x="9807" y="0"></use><g transform="translate(10252,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-37" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/489764/&amp;usg=ALkJrhiemA1DLaMOm0aT0fYLNViAoRWnww#MJMATHI-41" x="11754" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>=</mo><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>U</mi><mo>=</mo><mn>0.9</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>12</mn><mo>=</mo><mn>0</mn><mo>,</mo><mn>075</mn><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">I=P/U=0.9/12=0,075A</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero a juzgar por la medida, resultó un poco menos. </font><font style="vertical-align: inherit;">Aunque tal vez acabo de hacer algo mal.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gl/fw/qv/glfwqvsyuybaay2nr5bdftlk2n8.png"><br>
<br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fotoresistor FR-765. </font><font style="vertical-align: inherit;">Lo elegí simplemente porque no había nada más en la tienda.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h9/zq/gq/h9zqgqgqp4vfwhhoreh_qxmo5aa.png"></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, por supuesto que tenía: un controlador, una placa de pruebas, cables, cocodrilos, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En un artículo anterior sobre Canny 3, realmente elogié al controlador, pero resultó que hay una mosca en la pomada. </font><font style="vertical-align: inherit;">La última vez no usé el paquete de cable incluido que viene con el kit, pero esta vez no podría prescindir de él. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como uso muy poco un soldador, quería reducir su uso al mínimo vital. </font><font style="vertical-align: inherit;">Por lo tanto, al final, reuní todos los circuitos en conexiones desmontables. </font><font style="vertical-align: inherit;">Usé cables especiales (papá-papá, mamá-mamá, mamá-papá), placas de prueba y pinzas de cocodrilo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y si los desarrolladores del controlador no tienen la culpa del hecho de que en el proceso de pelar el cable tuve un par de cortes, entonces los momentos en que toda mi estructura cayó al suelo debido al hecho de que enganché el arnés "de madera", en parte a su conciencia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por un lado, un torniquete es algo bueno. Para instalar el controlador dentro del automóvil, creo que el arnés de cables es el correcto. Los cables que contiene están trenzados y si están bien retorcidos, entonces encajan completamente en los conectores "madre", mis cables de "placa". Por otro lado, como no es conveniente hacer experimentos con el cable con la placa de prueba, incluso una hermosa foto con el controlador en toda su extensión fue difícil debido a los "cables de roble". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dije un poco más alto que no quería usar un soldador, pero al menos una vez tendrían que armarse.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para medir la señal del fotorresistor, necesitamos "insertarla" en el convertidor analógico a digital (ADC) del controlador. </font><font style="vertical-align: inherit;">Pero el hecho es que, a diferencia de, por ejemplo, mi viejo Craftduino. </font><font style="vertical-align: inherit;">En el caso de Canny, resultó necesario poner un jersey. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, no leí cuidadosamente la documentación y pensé que las salidas 5 y 6 del controlador son las salidas de A5 y A6. </font><font style="vertical-align: inherit;">Incluso escribí un programa e intenté durante mucho tiempo tomar lecturas. </font><font style="vertical-align: inherit;">Naturalmente, no tuve éxito porque, por defecto, sin una preparación preliminar, los canales 5 y 6 funcionan como una entrada discreta normal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de leer la documentación para el controlador con una "mente fresca", me di cuenta de que todavía tenía que soldar. </font><font style="vertical-align: inherit;">No tienes idea de cómo tenía miedo de "arruinar" todo.</font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La última vez que intenté soldar algo en el circuito que hice por mí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drzugrik</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Logré completar todos los condensadores con soldadura cerca del lugar de la soldadura. </font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta vez el proceso de soldadura fue simple. </font><font style="vertical-align: inherit;">Fue suficiente poner con mucho cuidado una gota de soldadura en la pista. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El aspecto de mi puente de soldadura se puede ver en la foto a continuación:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/pv/r9/vd/pvr9vdryjakzmbjalenhh6wrn9a.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
He conectado solo la sexta salida al canal A6, no me atreví a soldar el quinto canal, para no llenar accidentalmente ambos puentes con soldadura. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teóricamente, era posible prescindir de un soldador conectando el orificio y el terminal No. 6 con un cable. </font><font style="vertical-align: inherit;">Pero eso sería terriblemente inconveniente. </font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La foto a continuación muestra la conexión del pin No. 5 y el pin ADC No. A5 con un cable de padre a padre: lo </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/l6/hb/qul6hbndz9lv1jwj8rq-m34sipe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
último a lo que debe prestar atención antes de ponerse a trabajar. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¡Atención!</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No repita uno a uno, lo que describiré más adelante en el texto. </font><font style="vertical-align: inherit;">No sea flojo para reemplazar las conexiones enchufables con soldadura, recoja cables más gruesos, lea la documentación. </font><font style="vertical-align: inherit;">No soy un experto en estos asuntos, así que puse todo junto "lo mejor que pude". </font><font style="vertical-align: inherit;">También le aconsejo que vigile cuidadosamente el peligro de incendio y que no deje el equipo desatendido. </font><font style="vertical-align: inherit;">Me las arreglé para oler algunos cables ardientes un par de veces. </font><font style="vertical-align: inherit;">Bueno, incluso en la fuente de alimentación había protección contra cortocircuitos (también lo arreglé). </font><font style="vertical-align: inherit;">Por lo tanto, tenga cuidado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Además, no olvide que a pesar del hecho de que los voltajes y las corrientes que tenemos son pequeños, aún tocar las partes vivas bajo voltaje puede ser doloroso </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(especialmente si las golpea con una parte herida del cuerpo)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a name="III"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte III: Cómo escribir datos en el puerto COM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para calibrar de alguna manera nuestro sensor de luz ambiental, necesitamos comprender qué valores envía al controlador dependiendo del nivel de luz. Para hacer esto, necesitamos enviar datos desde el ADC al monitor. Al trabajar con Arduino y sus clones para resolver tales problemas, utilicé un monitor de puerto COM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso de Canny 3 tiny, el proceso de lectura de datos desde un puerto COM virtual no es mucho más complicado que para Arduino. Pero hay una diferencia clave. El entorno de desarrollo CannyLab no tiene su propio monitor de puerto COM. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solía </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hterm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> porque es multiplataforma, ligero y no requiere instalación. Pero puedes usar cualquier otro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diré aún más, nada nos impedirá usar el monitor de puerto COM Arduino IDE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo salió de la caja en mi sistema Windows 10 y no tuve que instalar los controladores para el puerto COM virtual por separado. Pero por si acaso, diré que el controlador parece estar incluido con el entorno de desarrollo CannyLab (está en la carpeta drv \ canny3tiny_vcp). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para no explicar más cómo funcionan los bloques de gráficos asociados con el envío de datos al puerto COM virtual USB, daré un ejemplo simple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hoy, como entrenamiento, enviaremos el mensaje "HABR" utilizando el controlador. Primero debe descargar el IDE CannyLab. Se puede encontrar fácilmente en el sitio web oficial del desarrollador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, usé CannyLab v 1.42, pero creo que en versiones anteriores no habrá problemas con el rendimiento de los diagramas.</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El proceso de escribir software en el nuevo controlador y los principios básicos para trabajar con Cannylab que describí en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capítulo 3 del último artículo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cree un nuevo gráfico, seleccione Canny 3 pequeño en el cuadro de diálogo. Y transferimos bloques, constantes y registros al diagrama, como en la siguiente captura de pantalla. Por supuesto, no es necesario transferir etiquetas de texto; nada depende de ellas durante la ejecución del diagrama. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rz/st/g9/rzstg9zmltxsf2ekndo4orydcnu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si no tiene ganas de mover bloques usted mismo, puede descargar los diagramas de este artículo usando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub.</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cabe señalar que enviar un mensaje al puerto COM funciona un poco extraño y tiene que escribir letras en un par de caracteres en un espejo, pero puede acostumbrarse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo explicaré en partes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Configuración de parámetros"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configuramos la configuración del controlador USB VCP. Primero, habilite el modo de transferencia en el puerto COM virtual y luego establezca la longitud del mensaje transmitido. En nuestro caso, 6 caracteres, incluido el avance de línea. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Texto del mensaje",</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> escribimos el texto del mensaje en constantes (no olvide cambiar al modo "chr") y transferimos estas constantes a los registros de controladores correspondientes. Una vez más, llamo su atención sobre el hecho de que escribimos el mensaje en el orden inverso, tanto en los pares de símbolos como en los registros del conductor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Último bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Transferencia de mensajes"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Envía con una frecuencia especificada nuestro mensaje al puerto COM. Para esto usamos un bloque PWM. No lo confunda con el RF PWM, que usaremos al conectar la lámpara. En este caso, el bloque genera la mitad del tiempo "0" y la segunda mitad "1". Puede "jugar" con el tamaño del período y llenar para aumentar o disminuir la frecuencia de envío de mensajes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es necesario conectar un LED verde a este bloque PWM para verificar el funcionamiento del controlador. Si todo está en orden, el LED parpadeará con la frecuencia de enviar un mensaje. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cómo escribir un programa en el controlador, ya lo dije </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en un artículo anterior</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sin embargo, en el pasado he aprendido otro truco genial.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando conectamos el controlador a la computadora, ingresa al modo de grabación del programa. Anteriormente, para pasar al modo de tiempo de ejecución, quité el controlador de la computadora y puse la carga USB en él. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultó que hay una manera más fácil. Después de conectar el controlador al puerto USB de la computadora y hacer clic en el botón </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Conectar"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en CannyLab </font><font style="vertical-align: inherit;">, vaya al </font><font style="vertical-align: inherit;">menú </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Dispositivo"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y seleccione </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Ejecutar"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/dt/bv/b-dtbvog9sirji-opbj-ehor-hm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El controlador comienza a ejecutar el programa grabado, recibiendo energía del puerto USB. Además, después de eso, el controlador estará disponible en el monitor del puerto COM. Es cierto que para volver al modo de grabación del programa, será necesario quitar el controlador y volver a insertarlo en el puerto USB de la computadora.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y aquí está nuestro "HABR" en el monitor de puerto COM Hterm. </font><font style="vertical-align: inherit;">Presta atención a la velocidad de transferencia de datos y otras configuraciones. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ls/lh/yu/lslhyucpy7cxrmexfqnn3l5swgi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y este es el monitor del puerto COM Arduino IDE: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/zd/vl/abzdvlqwpn6jaw0q0uuzx06ltzo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la foto muestra cómo funciona el controlador después de grabar el diagrama: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qv/4n/zu/qv4nzuowx6saogj5xskvkn7dt3w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
el LED rojo indica que se está recibiendo energía a través del puerto USB de la computadora y el verde "parpadea" al ritmo de los mensajes transmitidos a través del puerto USB COM virtual.</font></font><br>
<br>
<a name="IV"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte IV: conectamos y programamos una lámpara de automóvil y un fotorresistor.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comenzar, consideraremos la opción más simple. Simplemente conecte la lámpara al terminal No. 1 del controlador y la fotorresistencia al terminal No. 6 (ADC). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo es bastante simple, pero por si acaso, dibujé un diagrama: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sv/un/pm/svunpmu3hc-n4agrotbzy2rquea.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero aquí se ve en vivo: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ap/az/z8/apazz8ybxdpnfnaxf9y3c-daabc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"-" y "+" de la fuente de alimentación que conectamos a los terminales correspondientes de Canny 3 pequeño, el pin No. 1 está conectado a la carcasa de la lámpara, y la "cola" de la lámpara con un plus en el tablero del tablero. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con un fotorresistor, también, todo es simple. Además, llevamos la placa desde el bus a la placa, y el signo negativo va al pin No. 6 del controlador, que previamente conectamos con el puente al ADC. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ya escribí anteriormente que toda mi estructura se cayó un par de veces de la mesa. Por lo tanto, más adelante en las fotos puede haber ligeras diferencias en cuanto a los colores de los conductores y los puntos de su entrada en el tablero.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora escribiremos un programa. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n1/7s/l8/n17sl8exoem1_jl54mqgb-bapeg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere el nuevo día que nosotros bloqueamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comencemos con el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Obtener el valor del ADC y convertirlo en suites"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este bloque, traducimos los valores que el ADC (0 a 1023) nos puede dar en iluminación (lux). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos hacer una medición de iluminación cuando es ligera y una medición en condiciones más oscuras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En consecuencia, en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"valor de"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> grabé la lectura mínima de ADC "0", y en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"resultado de" el</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valor cero del nivel de iluminación. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"valor de"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> grabé las lecturas de ADC = 20, y la iluminación correspondiente igual a 300 lux, ingresé el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"resultado de"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No tengo una descripción detallada de los parámetros de la fotorresistencia, pero sospecho que no tiene una característica completamente lineal, pero esto es suficiente para nosotros ahora. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verifique previamente cómo se realiza el diagrama en el simulador. En más detalle sobre el trabajo en el simulador CannyLab que escribí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto es lo que terminé con: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mp/yw/no/mpywnolxlvzxyaqqkeyy3oh2m-u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine que la fotorresistencia pasa un valor de 10 al ADC. El bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Pantalla (MAP)"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esto es esencialmente una escala lineal. Diez es exactamente la mitad de la escala de nuestra escala, lo que significa que la salida será la mitad del rango de 0 a 300, es decir 150. Esto está por debajo del nivel especificado de 300 lux. Por lo tanto, uno se envía al registro de canal No. 1 (salida No. 1) y la lámpara se encenderá . Pero no se encenderá de inmediato, pero solo si está oscuro durante al menos un segundo (1000 milisegundos). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comprender qué mensaje recibiremos en el puerto COM, cambié la visualización de los valores en el simulador a formato hexadecimal. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mq/nr/rk/mqnrrkxyzudcput-yez77oke13a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considere el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"registro de configuración de mensajes VCP D1: D0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , recibe el valor 3130. Como recordamos, este es un par de caracteres, cada parte del cual representa un código de caracteres hexadecimales. Resulta que 31h es el código de caracteres "1" en ASCII, 30 es el código cero en ASCII.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">registro de instalación de mensajes "VCP D3: D2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tendremos los caracteres" 0 "y" 5 ". Recopilamos los valores de los pares de caracteres en el orden de D0 a D3 que obtenemos: "0", "1", "5", "0". Así que obtuvimos nuestro 0150 lux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero como dicen "ni un solo simulador ...". Veamos qué pasa en la práctica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Medición bajo la luz de la lámpara y la luz natural (iluminación combinada): las </font></font><br>
<br>
<img src="https://habrastorage.org/webt/of/ze/ps/ofzepsndi0bepg1hwoxzursk7my.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
lecturas del medidor de luz de fábrica y nuestro medidor casero coinciden casi perfectamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Medición a la luz del día: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/w_/kz/aq/w_kzaqulbnhvr-pq2tsdcy7pqu8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
extremadamente peor.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto probablemente se deba a la no linealidad de las características del fotorresistor, y también porque establecemos el límite de escala inferior en cero, pero no complicaremos el diagrama para aumentar la precisión de la medición; para nuestro ejemplo, lo principal fue comprender el principio general de obtener valores de iluminación. </font><font style="vertical-align: inherit;">Y el aumento de la precisión se puede retrasar hasta la implementación de estos proyectos en el automóvil o en el hogar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificamos el funcionamiento del circuito, cerramos el sensor con un dedo y luego retiramos el dedo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4f/nh/qd/4fnhqd-jpxmvsbj5wtvwnokgybg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora hay una opción cuando está oscuro en la habitación: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5r/d7/lc/5rd7lcy5_cdx339o6z6c39r3y5i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
la lámpara está encendida. </font><font style="vertical-align: inherit;">Todo funciona como deberia.</font></font><br>
<br>
<a name="V"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte V: Intentando reducir el brillo de la lámpara usando PWM</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos a complicar un poco el esquema cambiando el brillo de la lámpara. Para hacer esto, necesitamos un PWM de alta frecuencia (RF PWM), en Canny 3 tiny se implementa en las salidas No. 3 y No. 4. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidí usar la salida No. 4. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El esquema de conexión permanecerá prácticamente sin cambios. Simplemente, en lugar de la salida No. 1, conectamos la salida No. 4 a la lámpara, </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qp/bg/b-/qpbgb-a7whds1vugbizqoyr3its.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
así es como se ve en el ensamblaje. La diferencia es que, en lugar de un cable blanco, el marco ahora es azul. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2t/z3/nl/2tz3nldjplnly2tzmo7ttrb0he0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El diagrama tampoco ha cambiado mucho. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/or/fx/wl/orfxwlbv1adspw_c0fv2ouenqhy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No pintaré el diagrama en detalle. Los principales cambios en la configuración de la salida 4, que utilizamos para PWM. En esta sección, debemos establecer el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Registro de configuración de relleno"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toma valores de 2 a 255 microsegundos, decidí no arriesgarme y elegí 254. Tenga en cuenta que está instalado para dos canales a la vez (No. 3 y No. 4). Luego escribimos "1" en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Registro de habilitación de canal PWM No. 4"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , incluyendo el PWM de nuestra bombilla. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el bloque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Encender la lámpara en modo PWM (con bajo brillo)”, lo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nuevo para nosotros es solo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Registrarse para configurar el canal de llenado No. 4, μs”</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Escribiremos el valor “10” en él, siempre que el nivel de iluminación sobre el fotosensor sea inferior a 250 lux, en dentro de 1 segundo </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La foto a continuación muestra que la lámpara se enciende, pero brilla tenuemente.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/pp/_t/ompp_teo-f76yagfthj5qylheus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si desea que la lámpara brille más, solo necesita cambiar el valor de la constante "10" a cualquier número mayor. Por ejemplo, puede tomar el número 127, en nuestro caso es la mitad del tiempo que lleva completar el período RF PWM, lo que significa aproximadamente la mitad del brillo de la lámpara. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/ni/3t/lxni3tbt3zw1y6lyqthoqqufc1w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cabe señalar que el RF PWM con esta lámpara funciona de manera bastante notable. Aquí hay tres fotos: en la primera, establecemos el </font><font style="vertical-align: inherit;">valor </font><font style="vertical-align: inherit;">en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Registro para llenar el número de canal 4"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a 10 μs, en la segunda - 110 μs, a la derecha - 210 μs. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ud/os/_w/udos_wpczlgn2m1naf4nc5053da.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principio, la lámpara automática de nuestro ejemplo, según tengo entendido, se usa en señales de posición y, a veces, en faros antiniebla de automóviles.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Creo que si refinamos el esquema y el diagrama, entonces sería posible implementar la inclusión de la retroiluminación con poca luz en máquinas más antiguas. </font><font style="vertical-align: inherit;">Es cierto que debe considerar el efecto de la iluminación artificial por la noche. </font><font style="vertical-align: inherit;">De modo que en las carreteras, en los túneles y desde los faros de los autos que se aproximan, la lámpara no se apagó. </font><font style="vertical-align: inherit;">O sería posible controlar la lámpara en el compartimento de pasajeros para que, por ejemplo, las lámparas en las puertas del Zhiguli o Niva no siempre se enciendan cuando se abren.</font></font><br>
<br>
<a name="VI"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parte VI: Conclusión </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el proceso de escribir este artículo, experimenté una fuerte sensación de nostalgia. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mientras estudiaba en el instituto, mi amigo y compañero de clase Seryoga tenía un elegante sedán azul de la marca VAZ 2107. Lo que no hizo con él: conectará algún tipo de manguera (para aumentar el impulso), instalará un ventilador en el compartimento de pasajeros para que se encienda con un botón separado, luego hará que el automóvil arranque con solo presionar un botón (solo con la llave girada encendido). En general, él simplemente no "sintonizó" su "golondrina". Han pasado muchos años desde entonces, mi amigo se mudó a un automóvil más sólido, pero tengo miedo de imaginar qué haría con su Zhiguli si obtuviera este controlador hace 10 años.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gracias a este artículo, también recordé mi Destino. Después de todo, estudié durante muchos años como ingeniero de automatización, pero no trabajé un día exclusivamente en mi especialidad. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resulta que es genial sumergirse en el mundo del bricolaje. En el proceso de ensamblar los circuitos más de una vez "atascados", enciende y apaga la bombilla y el LED con un botón. Es una sensación agradable cuando algo funciona según lo previsto. También me di cuenta de que programar un controlador usando diagramas es una tarea más meditativa que escribir código en el IDE de Arduino. Una percepción completamente diferente del programa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mientras escribía este artículo, me pedí una versión de Canny 3 tiny sin mazo de cables. Ahora descansaré un poco y escribiré un artículo sobre la instalación de este controlador en una placa de pruebas, y por sí mismo analizaremos algunos ejemplos más de automatización de iluminación con su ayuda.</font></font><br>
<br>
<i>   ,  ,    . </i><br>
<br>
<i>UPD:<br>
,       ,            :</i><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">«, ,  –  !»       CANNY 3 tiny</a>.<br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">«  ...»         (CANNY  Arduino)  Raspberry PI</a>.<br>
</li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">« ?»     bluetooth      Xamarin (Android)</a>.<br>
</li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es489754/index.html">20 sistemas de gestión de proyectos, resumen de 100 chips</a></li>
<li><a href="../es489756/index.html">Crea un efecto de lápiz en SVG</a></li>
<li><a href="../es489758/index.html">Angular: un ejemplo de uso de NGRX</a></li>
<li><a href="../es489760/index.html">Conciencia y existencia. Mecánica cuántica sin paradojas.</a></li>
<li><a href="../es489762/index.html">Un ejemplo simple de análisis y análisis de datos para World of Tanks</a></li>
<li><a href="../es489768/index.html">Cómo combina los bloques colisionantes y un algoritmo de búsqueda cuántica</a></li>
<li><a href="../es489770/index.html">Video de MinskJS mitap: mi informe sobre las extensiones del navegador</a></li>
<li><a href="../es489772/index.html">Hackathon en Simferopol, Yandex. Diálogos y leyes de la tecnología chat-bot</a></li>
<li><a href="../es489774/index.html">La historia de cómo automaticé el apartamento usando Node-RED. Parte II</a></li>
<li><a href="../es489776/index.html">The Ember Times - Número 136</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>