<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤘 🎋 😆 Médecine légale, injection SQL et chat endurci: analyse de la tâche n ° 3 de l'étape en ligne NeoQUEST-2020 🎡 🧑🏿‍🤝‍🧑🏻 👏🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous allons considérer la tâche la plus controversée de NeoQUEST-2020 : sa première partie est championne du nombre de participants qui l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Médecine légale, injection SQL et chat endurci: analyse de la tâche n ° 3 de l'étape en ligne NeoQUEST-2020</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/495296/"><img src="https://habrastorage.org/webt/gd/oc/8f/gdoc8fvxf7oimhxlgxvmijvuwmk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aujourd'hui, nous allons considérer la tâche la plus controversée de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NeoQUEST-2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : sa première partie est championne du nombre de participants qui l'ont franchie, et la deuxième partie n'a obéi qu'à quelques-uns. </font><font style="vertical-align: inherit;">Qui a t-il de si spécial à propos de lui? </font><font style="vertical-align: inherit;">Comprenez la coupe!</font></font><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avez-vous déjà dû enquêter sur un vidage de RAM? Savez-vous combien de choses intéressantes vous pouvez en tirer? (spoiler: tout, y compris les résultats des scripts en cours d'exécution, des photos récentes, ainsi que l'historique du navigateur). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'en est-il des injections SQL exotiques? Vous téléchargez une certaine image sur le site et vous recevez des informations d'une base de données fermée - n'est-ce pas un crime idéal? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la première partie de l'article, nous examinerons les outils pour analyser le vidage de la mémoire et apprendre comment extraire les informations dont nous avons besoin à partir de là, et dans la deuxième partie de l'article, nous montrerons clairement le processus de manipulation des balises d'image pour une injection délicate :) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alors, la tâche consiste à télécharger l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archive</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui contient un fichier binaire de 1 Go avec le nom parlant memdump.bin, sur la base duquel nous pouvons supposer qu'il s'agit d'un vidage de RAM. Nous utiliserons le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cadre de volatilité</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour ses recherches </font><font style="vertical-align: inherit;">. Volatility prend en charge divers plugins qui facilitent la recherche et l'extraction du vidage de diverses informations utiles pour </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faire chanter un</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> analyste. Tout d'abord, utilisez la commande imageinfo et obtenez des informations sur le vidage:</font></font><br>
<cut></cut><br>
<img src="https://habrastorage.org/webt/8b/po/2n/8bpo2nbfia9ykmdpqohz8zt4w0a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A en juger par la sortie de la commande imageinfo, nous avons affaire à un vidage de la mémoire de Windows 7. Ensuite, nous allons examiner la liste des processus en cours d'exécution dans le système au moment où le vidage a été supprimé à l'aide de la commande pslist: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/1n/py/ja1npywtltvjjnzwwhbs7mkk1ho.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cette liste, vous pouvez voir plusieurs processus intéressants. Commençons l'étude avec le processus chrome.exe - vous pouvez toujours trouver quelque chose d'intrigant dans le navigateur. Il existe des plugins supplémentaires pour la volatilité qui automatisent l'extraction d'informations des processus. Par exemple, le plugin </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chromehistory</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous permettra d'extraire l'historique de visite d'un navigateur à partir d'un vidage de RAM: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lx/oo/o7/lxooo7skzcqwcxf-hw_njv5rmdk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'histoire de chrome, plusieurs choses intéressantes peuvent être remarquées à la fois. Tout d'abord, un lien </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers la deuxième partie de la mission</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ainsi que des requêtes de recherche sur les métadonnées dans les images PNG, ce qui est également un indice pour la deuxième partie, mais nous y reviendrons plus tard. Au stade actuel, nous sommes intéressés par les demandes de code promotionnel </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour une remise</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le site et les fichiers pdf, qui suggèrent l'objet de recherches supplémentaires (l'exécution d'Acrobat Reader`a peut également nous inciter à le faire). Essayons de trouver des documents pdf dans un vidage en utilisant la commande filescan: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sb/ro/qk/sbroqkdf1jetkddyzac1rhasqh0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bonne chance! Il semble qu'il y ait du promo.pdf dans le vidage. Essayons de le tirer en utilisant la commande dumpfiles:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-w/gn/iz/-wgnizdzvl_kszkhof-z1bldwxu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À ce stade, des difficultés mineures peuvent survenir du fait que certains visualiseurs de documents pdf peuvent ne pas reconnaître le fichier qui vient d'être extrait (il vous suffit de supprimer les octets supplémentaires à la fin du fichier). Mais avons-nous vraiment peur de quelques octets supplémentaires? :) Au final, ouvrez le document et voyez le code QR, après avoir lu lequel, nous obtenons le drapeau de la première partie de la tâche (et en même temps le code promotionnel pour recevoir un cadeau de l'équipe NeoQUEST - nous offrons des prix mémorables tous les participants qui ont terminé au moins une tâche!).</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xp/84/od/xp84odjm5frx774wqy9ka75rjws.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, essayez d'obtenir le deuxième drapeau. Nous revenons sur le site dont le lien a été trouvé dans l'historique du navigateur. Pour accéder au site, vous devez entrer un code promotionnel. Nous rappelons l'historique de recherche dans le navigateur et la description du document lui-même (UTILISER CECI POUR JOINDRE), à partir de laquelle nous pouvons supposer que le premier indicateur est le code promotionnel dont nous avons besoin. Nous le saisissons sur le terrain et arrivons sur le site où l'on nous propose de télécharger une photo: à en </font></font><br>
<br>
<img src="https://habrastorage.org/webt/n9/kb/vu/n9kbvuleozzylxcgoa2hxy5trhq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
juger par la fréquence de blocage du site, nos participants ont décidé de vérifier expérimentalement le chargement de tous les types de documents possibles. Un certain temps plus tard, nous comprenons que seules les images PNG peuvent être téléchargées sur le site. Le prochain casse-tête est le message «Pas assez de données pour stocker cette image, désolé!», Qui se produit lorsque vous essayez de télécharger une image.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Revenant à l'historique du navigateur, nous rappelons les demandes du formulaire «ajouter des métadonnées au fichier png». En utilisant des inférences simples, nous concluons que, très probablement, certaines valeurs doivent être saisies dans les métadonnées pour télécharger une image sur un site. Vous pouvez commencer par étudier le format PNG (pour une description, par exemple, cliquez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Tout d'abord, vérifiez la liste des mots clés standard pour les images PNG de métadonnées, par exemple: "Auteur", "Description", etc. En utilisant, par exemple, l'utilitaire de conversion de l'ensemble ImageMagick, ajoutez des métadonnées à l'image de test: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convert test.png -set 'Title' '1' -set 'Author' '2' -set 'Description' '3' -set 'Copyright' '4 '-set' Creation Time '' 5 '-set' Software '' 6 '-set' Clause de non-responsabilité '' 7 '-set 'Avertissement' '8' -set 'Source' '9' -set 'Comment' '0' out.png</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous essayons de télécharger l'image résultante sur le site et apprécions le succès: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sa/7o/pw/sa7opwndturwyzaqse9f4qah83g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'avère que les champs de métadonnées nécessaires sont Titre, Description, Auteur et Copyright. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'ailleurs, un indice pour cela peut également être trouvé dans le vidage de la mémoire: vous pouvez trouver la mention du fichier mr_cat.png en utilisant la volatilité. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/bw/cn/ixbwcn3pzw3ndqxlbnfb6btadyk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nos participants ont décidé que c'était avec l'aide de M. Cat qu'il fallait injecter le site (beaucoup de messages sont venus à notre courrier avec M. Cat dans une </font><font style="vertical-align: inherit;">apparence </font><font style="vertical-align: inherit;">compressée, inversée, réfléchie et autre </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inesthétique</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), mais le chat n'a rien à voir avec ça! Il distrait simplement et fait allusion aux participants: bon, regardez-moi, il y a quelque chose d'intéressant à l'intérieur! A l'intérieur du dépotoir, l'image n'a été que partiellement conservée; cependant, dans ses résidus, vous pouvez remarquer les champs de métadonnées complétés nécessaires:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/4h/0o/zv4h0ogsh94higmrsqslbzbxzby.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allez-y: nous pouvons maintenant télécharger des fichiers sur le site; cependant, que donne-t-il et comment rechercher un drapeau? Il est logique de supposer qu'une fois que les métadonnées sont requises pour le téléchargement, il est possible qu'elles soient utilisées d'une manière ou d'une autre pour stocker les fichiers téléchargés (par exemple, comme clés dans une base de données). Hourra! Nous approchons du dessert: nous devons vérifier sur le site la possibilité d'une injection SQL. Nous constatons que si l'un des paramètres est remplacé par un double guillemet ("), le site nous signalera une erreur au lieu de charger l'image:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/f7/s2/bf/f7s2bfigyph9mkfj9jfg6wfxhxc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous voyons maintenant la requête SQL elle-même et comprenons quels champs nous pouvons utiliser afin de construire une injection pour extraire des données de la base de données utilisée. Quant à l'emplacement du drapeau, dans ce cas, il est logique de vérifier la toute première image qui a été téléchargée dans la base de données. De plus, pendant l'opération d'injection, vous devez faire attention au fait que INSERT est exécuté dans la demande. Cela nous oblige à construire des requêtes spécifiques car il est impossible d'effectuer explicitement une opération SELECT à partir de la même table dans laquelle nous l'insérons en même temps que l'opération d'insertion (INSERT). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faisons une demande avec laquelle nous extrayons la description de la première image de la base de données:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
convert test1.png -set 'Title' '1' -set 'Author' '", (SELECT description FROM (SELECT * FROM picture) AS x limit 0,1)) - -' -set 'Description' '3' - set 'Copyright' '4' test.png </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez l'image résultante sur le site Web et obtenez la description dans le champ Copyright, qui est un indicateur: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/k8/6x/vzk86xyosytdwsvc9orcwkypybi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hourra, tâche terminée! Nous espérons que nous avons convaincu tout le monde de revérifier les entrées des utilisateurs pour la millionième fois, et aussi de la garder en sécurité la prunelle de vos yeux de créer un vidage de votre RAM :) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminez l'article avec une citation des grands sages:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qg/9i/un/qg9iunp8zncqovjy3_qg990lmlc.png"></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495280/index.html">Max Patrol SIEM. Présentation du système de gestion des événements de sécurité de l'information</a></li>
<li><a href="../fr495282/index.html">Validation XML à l'aide de XSD, JAXB et Spring Framework</a></li>
<li><a href="../fr495290/index.html">Explorer la qualité du code du système d'exploitation Zephyr</a></li>
<li><a href="../fr495292/index.html">InterSystems IRIS 2020.1 Release</a></li>
<li><a href="../fr495294/index.html">Macros pour un pythoniste. Rapport Yandex</a></li>
<li><a href="../fr495298/index.html">Évaluer les options de Monte Carlo Clojure</a></li>
<li><a href="../fr495302/index.html">Comment augmenter les ventes 2,5 fois en 4 mois dans une boutique en ligne - un cas pour la promotion SEO</a></li>
<li><a href="../fr495304/index.html">Rajeunissement des cellules humaines grâce à leur reprogrammation</a></li>
<li><a href="../fr495308/index.html">Rake sur le chemin de la survie</a></li>
<li><a href="../fr495310/index.html">Visite virtuelle: biométrie et multiformat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>