<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìå ü§ôüèø ‚öõÔ∏è ESP-NOW ist ein alternatives Kommunikationsprotokoll f√ºr ESP8266 und ESP32. Grundlegendes Konzept üë©üèª‚ÄçüöÄ üê¨ üëµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESP-NOW ist ein vereinfachtes WiFi-Protokoll zum √úbertragen kurzer Pakete zwischen gepaarten Ger√§tepaaren , das von Espressif im Jahr 2016.07 f√ºr die ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ESP-NOW ist ein alternatives Kommunikationsprotokoll f√ºr ESP8266 und ESP32. Grundlegendes Konzept</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502260/"><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-NOW ist ein vereinfachtes WiFi-Protokoll zum √úbertragen kurzer Pakete zwischen gepaarten </font><font style="vertical-align: inherit;">Ger√§tepaaren </font><font style="vertical-align: inherit;">, das von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Jahr 2016.07 f√ºr die Mikrocontroller ESP8266 und ESP32 </font><font style="vertical-align: inherit;">entwickelt und ver√∂ffentlicht wurde </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Gleichzeitig werden keine zus√§tzlichen Verfahren zur Unterst√ºtzung des WLAN-Protokolls verwendet, was den Austausch von Paketen beschleunigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-NOW kann im Internet der Dinge verwendet werden, um intelligente Lichtquellen, Relais, Steckdosen und andere Fernbedienungsger√§te zu steuern und Informationen von Sensoren und anderen Anwendungen zu empfangen.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW unterst√ºtzt die folgenden Funktionen</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verschl√ºsselte und unverschl√ºsselte Kommunikation zwischen gekoppelten Ger√§ten.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gemischte verschl√ºsselte und unverschl√ºsselte Kommunikation zwischen gekoppelten Ger√§ten. </font></font><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úbertragen Sie bis zu 250 Byte n√ºtzliche Informationen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einrichten einer R√ºckruffunktion, um die Anwendungsschicht insbesondere √ºber den Erfolg oder Misserfolg der √úbertragung zu informieren.</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW bietet au√üerdem die folgenden Funktionen und Einschr√§nkungen.</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úbertragungsgeschwindigkeit - nicht mehr als 1 Mbit / s bei einer Frequenz von 2,4 GHz, d.h. </font><font style="vertical-align: inherit;">ESP-NOW arbeitet auf derselben Frequenz und denselben Kan√§len wie Ihr WLAN-Router.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WiFi-Protokoll nicht verwendet</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñhnlich dem Low-Power-Protokoll einer drahtlosen 2,4-GHz-Maus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist nur eine anf√§ngliche Paarung erforderlich.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach dem Pairing wird die Verbindung nicht unterbrochen.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Broadcast wird nicht unterst√ºtzt - nur Mehrfachverteilung an gekoppelte Ger√§tepaare.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf einem Ger√§t werden maximal 20 Paare, einschlie√ülich verschl√ºsselter Paare, unterst√ºtzt, einschlie√ülich verschl√ºsselter Paare.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Stationsmodus werden maximal 10 verschl√ºsselte Paare unterst√ºtzt.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximal 6 im SoftAP- oder SoftAP + Station-Modus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multicast-Verschl√ºsselung wird nicht unterst√ºtzt.</font></font></li>
</ul><br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheit</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-NOW verwendet die IEEE 802.11 Action Vendor-Rahmentechnologie mit der von Espressif und der CCMP-Verschl√ºsselungstechnologie entwickelten IE-Funktion und bietet eine sichere, verbindungsfreie Kommunikationsl√∂sung. </font><font style="vertical-align: inherit;">Ein Wi-Fi-Ger√§t unterst√ºtzt einen prim√§ren Hauptschl√ºssel (PMK) und mehrere lokale Hauptschl√ºssel (LMK).</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMK wird</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwendet, um LMK mit dem AES-128-Algorithmus zu verschl√ºsseln.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gekoppelte </font><b><font style="vertical-align: inherit;">LMK-</font></b><font style="vertical-align: inherit;"> Ger√§t wird zum Verschl√ºsseln von Benutzerinformationen mithilfe von CCMP verwendet. </font><font style="vertical-align: inherit;">Die maximale Anzahl verschiedener LMKs betr√§gt 6. Wenn f√ºr das gekoppelte Ger√§t kein LMK festgelegt ist, werden Benutzerdaten nicht verschl√ºsselt.</font></font></li>
</ul><br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Grundstufe von</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der unteren Ebene des ESP_NOW-Protokolls wird eine verkn√ºpfte Liste gef√ºhrt, die Informationen √ºber das lokale Ger√§t und das gekoppelte Ger√§t enth√§lt, einschlie√ülich MAC-Adressen und Schl√ºssel. </font><font style="vertical-align: inherit;">ESP-NOW speichert auch h√§ufig verwendete Daten f√ºr die Anwendungsschicht, um den Aufwand f√ºr die Wiederaufbereitung der verkn√ºpften Liste zu vermeiden. </font><font style="vertical-align: inherit;">Informationen zu Ger√§ten werden zum Senden und Empfangen von Daten verwendet und enthalten </font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zum lokalen Ger√§t:</font></font></u> <br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 16 Byte - Der Haupthauptschl√ºssel, mit dem der Schl√ºssel auf dem angeschlossenen Ger√§t verschl√ºsselt wird (KOK in der API). ESP_NOW unterst√ºtzt standardm√§√üig PMK, sodass keine Konfiguration erforderlich ist. </font><font style="vertical-align: inherit;">Bei Bedarf k√∂nnen Sie √ºberpr√ºfen, ob der PMK-Wert mit dem lokalen Ger√§t √ºbereinstimmt.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte - Der lokale Ger√§temodus, der die sendende WiFi-Schnittstelle (SoftAP oder STA) ESP-NOW definiert. </font><font style="vertical-align: inherit;">Der gekoppelte Ger√§temodus wirkt sich nicht auf eine Funktion aus, sondern speichert nur Modusinformationen f√ºr die Anwendungsschicht. </font><font style="vertical-align: inherit;">Im STA WiFi-Modus ist nur Station anwendbar und SoftAP WiFi ist nur SoftAP.</font></font><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Betriebsarten des lokalen Ger√§ts ESP_NOW</font></font></b>
                        <div class="spoiler_text"><blockquote><div class="scrollable-table"><table>
<tbody><tr>
<th></th>
<th></th>
<th> WiFi</th>
</tr>
<tr>
<td><b>IDLE</b></td>
<td> </td>
<td>   </td>
</tr>
<tr>
<td><b>CONTROLLER</b></td>
<td></td>
<td>STA</td>
</tr>
<tr>
<td><b>SLAVE</b></td>
<td></td>
<td>SoftAP‚Ä®</td>
</tr>
<tr>
<td><b>COMBO</b></td>
<td>&amp;</td>
<td>SoftAP</td>
</tr>
</tbody></table></div></blockquote><br>
</div>
                    </div></li>
</ul><br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gepaarte Ger√§teinformationen</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (einschlie√ülich h√§ufig verwendeter Informationen und anderer Benutzerinformationen):</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LMK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 16 Byte - ein lokaler Hauptschl√ºssel, mit dem der Schl√ºssel n√ºtzlicher Informationen w√§hrend der Kommunikation in diesem Paar verschl√ºsselt wird.</font></font></li>
<li><b>MAC-</b>: 6  ‚Äî   ,    . ,     Station, MAC-     Station.</li>
<li><b></b>: 1  ‚Äî       (SoftAP  STA) ESP-NOW.</li>
<li><b></b>: 1  ‚Äî ,     ,   .   0..255.       ,         .    . , 0 ,    ; 1 ~ 14   ;       ,    .</li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfiehlt nicht die Verwendung langwieriger Operationen in R√ºckruffunktionen beim Senden / Senden von Paketen, was vermutlich mit der Implementierung von Algorithmen unter Verwendung des Interrupt-Mechanismus zusammenh√§ngt. </font><font style="vertical-align: inherit;">Diese Annahme wird auch durch die Probleme unterst√ºtzt, die mit der dynamischen Speicherzuweisung in R√ºckruffunktionen verbunden sind, die durch die bevorzugte Verwendung statischer Variablen sowie die Mehrdeutigkeit der Verwendung des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ausnahmemechanismus gel√∂st werden </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Umsetzung der Asynchronit√§t der Start / End - </font><font style="vertical-align: inherit;">Prozesse, Paarung, Empfangen / Senden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pakete </font><font style="vertical-align: inherit;">nicht beschrieben , </font><font style="vertical-align: inherit;">das auch nicht die Anwendung der erleichtert </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MicroPython</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ideologie </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW-Paketformat</font></font></h4><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAC-Header</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 24 Bytes.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kategorie</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte, das die Kategorie des Paketerstellers angibt. </font><font style="vertical-align: inherit;">Der Wert wird eingestellt (127).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisations-ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 3 Byte, enth√§lt eine eindeutige Kennung, die die ersten drei Bytes der von Espressif verwendeten MAC-Adresse sind. </font><font style="vertical-align: inherit;">Wert einstellen (0x18fe34)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuf√§lliger Wert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 4 Bytes zum Schutz von Daten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Package Creator Daten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 7-255Bytes</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Paketerstellungsdaten enthalten die folgenden Felder:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte, auf (221) setzen.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√§nge</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte, Gesamtl√§nge der Organisations-ID, Typ, Version und Benutzerdaten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisations-ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 3 Byte, enth√§lt eine eindeutige Kennung, die die ersten drei Bytes der von Espressif verwendeten MAC-Adresse sind. </font><font style="vertical-align: inherit;">Wert einstellen (0x18fe34)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte, ESP-NOW-Protokoll. </font><font style="vertical-align: inherit;">Wert einstellen (4)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 Byte, aktuelle Version von ESP-NOW. </font><font style="vertical-align: inherit;">Installiert (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhalt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 0-250 Byte Benutzerdaten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FCS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 4 Bytes, Pr√ºfsumme</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da ESP-NOW kein WLAN verwendet, unterscheidet sich der MAC-Header geringf√ºgig vom Standard-Paket-Header. </font><font style="vertical-align: inherit;">Die FromDS- und ToDS-Bits des FrameControl-Felds sind 0. Die Zieladresse wird im ersten Adressfeld angegeben. </font><font style="vertical-align: inherit;">Das zweite Adressfeld zeigt die Quelladresse. </font><font style="vertical-align: inherit;">Das dritte Adressfeld wird als Broadcast-Adresse festgelegt (0xff: 0xff: 0xff: 0xff: 0xff: 0xff).</font></font><br>
<br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundlegender Anwendungsalgorithmus</font></font></h2></u><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Start und Ende</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor Sie ESP-NOW verwenden, wird empfohlen, die Wi-Fi-Schnittstelle auf den gew√ºnschten Modus einzustellen. </font><font style="vertical-align: inherit;">In der Regel ist die Stationsschnittstelle f√ºr </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONTROLLER</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die SoftAP-Schnittstelle f√ºr </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SLAVE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMBO eingestellt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es ist auch ratsam, Wi-Fi nach der Verwendung von ESP-NOW zu beenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um ESP-NOW zu starten, rufen Sie zum Abschluss </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_init ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_deinit ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf. </font><font style="vertical-align: inherit;">Beim </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufruf von esp_now_deinit ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden alle Informationen zu gekoppelten Ger√§ten gel√∂scht.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bindungsr√ºckruffunktionen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anrufverarbeitungsfunktion beim Senden des Pakets </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kann verwendet werden, um die Anwendungsebene des sendenden </font><i><font style="vertical-align: inherit;">Teilnehmers</font></i><font style="vertical-align: inherit;"> in einem Paar √ºber den Erfolg oder Misserfolg der √úbertragung zu informieren, beispielsweise wenn die Informationen auf der MAC-Unterschicht erfolgreich √ºbertragen werden. </font><i><font style="vertical-align: inherit;">Beachten Sie bei der</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Folgendes: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem verkn√ºpften Paar:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die Anwendungsschicht das Paket nicht empfangen hat, die R√ºckruffunktion jedoch "Erfolg" zur√ºckgegeben hat, kann dies folgende Gr√ºnde haben: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Angriffe von einem betr√ºgerischen Ger√§t </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Fehler </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bei der </font><font style="vertical-align: inherit;">Installation verschl√ºsselter Schl√ºssel </font><font style="vertical-align: inherit;">- Paketverlust auf Espressif-Anwendungsebene</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die Anwendungsschicht das Paket empfangen hat, die R√ºckruffunktion jedoch einen Fehler zur√ºckgibt, kann dies folgende Ursache haben: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Der Kanal ist besetzt und die ACK wird nicht empfangen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei mehrfacher Kommunikation mit allen Paaren des lokalen Ger√§ts:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn der R√ºckruf "Erfolg" zur√ºckgibt, bedeutet dies, dass das Paket erfolgreich gesendet wurde.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn die R√ºckruffunktion einen Fehler zur√ºckgibt, bedeutet dies, dass das Paket nicht erfolgreich gesendet wurde.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Anrufverarbeitungsfunktion gibt beim Empfang des Pakets </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_receive_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informationen zur√ºck, einschlie√ülich der MAC-Adresse des sendenden Ger√§ts in einem Paar und n√ºtzlicher Informationen. </font><font style="vertical-align: inherit;">Es kann auch verwendet werden, um die Anwendungsschicht des mit dem Empf√§nger gekoppelten sendenden Ger√§ts dar√ºber zu informieren, dass das Paket erfolgreich empfangen wurde.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hinzuf√ºgen eines Paares gekoppelter Ger√§te</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor dem Senden von Daten m√ºssen Sie das Ger√§t zur Liste der gepaarten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ger√§tepaare</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzuf√ºgen, indem Sie </font><i><font style="vertical-align: inherit;">esp_now_add_peer ()</font></i><font style="vertical-align: inherit;"> aufrufen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Bevor Sie Daten an eine Gruppe etablierter Paare senden, m√ºssen Sie ein Ger√§t mit einer Multicast-MAC-Adresse hinzuf√ºgen. </font><font style="vertical-align: inherit;">Der Kanalbereich der gekoppelten Ger√§te reicht von 0 bis 14. Wenn der Kanal auf 0 eingestellt ist, werden Daten auf dem aktuellen Kanal gesendet. </font><font style="vertical-align: inherit;">Andernfalls muss der Kanal als der Kanal festgelegt werden, auf dem sich das lokale Ger√§t befindet.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheit</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der Schl√ºssel verschl√ºsselt werden muss, k√∂nnen Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_set_pmk ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufrufen, um ihn </font><font style="vertical-align: inherit;">zum </font><i><font style="vertical-align: inherit;">Festlegen von</font></i><font style="vertical-align: inherit;"> PMK </font><font style="vertical-align: inherit;">zu konfigurieren </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn PMK nicht installiert ist, wird standardm√§√üig PMK verwendet und es wird f√ºr alle Ger√§te derselbe Schl√ºssel ausgew√§hlt. </font><font style="vertical-align: inherit;">Stellen Sie auch LMK f√ºr ausgew√§hlte Paare ein.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Senden von Daten mit ESP-NOW-Paketen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_send ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um ESP-NOW-Daten zu senden </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zur gleichen Zeit wird die Funktion gesetzt fr√ºher in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kehrt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP_NOW_SEND_SUCCESS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wenn eine R√ºckruffunktion sendet , </font><font style="vertical-align: inherit;">wenn die Daten erfolgreich auf der MAC - </font><font style="vertical-align: inherit;">Ebene empfangen wurden. </font><font style="vertical-align: inherit;">Andernfalls wird </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP_NOW_SEND_FAIL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur√ºckgegeben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mehrere Gr√ºnde k√∂nnen dazu f√ºhren, dass ESP-NOW keine Daten senden kann. </font><font style="vertical-align: inherit;">Insbesondere,</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zielger√§t existiert nicht;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ger√§tekan√§le stimmen nicht √ºberein;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daten gehen w√§hrend der √úbertragung verloren.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es kann nicht garantiert werden, dass die Anwendungsschicht notwendigerweise Daten akzeptiert. Bei Bedarf k√∂nnen Sie eine Best√§tigung senden, wenn Sie ESP-NOW-Daten erhalten. Wenn ein Best√§tigungszeitlimit auftritt, sollte die ESP-NOW-Daten√ºbertragung wiederholt werden. ESP-NOW-Daten k√∂nnen auch eine Sequenznummer zugewiesen werden, um doppelte Daten zu entfernen. </font><font style="vertical-align: inherit;">Beachten Sie </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
beim Senden von ESP-NOW-Daten √ºber </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_send (),</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass nicht mehr als 250 Byte Informationen gleichzeitig gesendet werden k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BEACHTUNG! Ein zu kurzes Intervall zwischen dem Senden von zwei ESP-NOW-Paketen kann zu Fehlern bei der Ausf√ºhrung der R√ºckruffunktion f√ºhren. Daher wird empfohlen, das n√§chste Datenpaket ESP-NOW zu senden, nachdem die R√ºckruffunktion die Verarbeitung des vorherigen Sendens erfolgreich abgeschlossen hat. Die R√ºckruffunktion wird von einer Wi-Fi-Aufgabe mit hoher Priorit√§t gesendet. Daher wird nicht empfohlen, l√§ngere Vorg√§nge in der R√ºckruffunktion auszuf√ºhren. Stattdessen k√∂nnen Sie die erforderlichen Daten in eine statische Warteschlange stellen und aus einem Prozess mit niedrigerer Priorit√§t verarbeiten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Sendefunktion eine MAC-Adresse zur√ºckgibt, wird diese mit dieser MAC-Adresse an das Ger√§t gesendet. </font><font style="vertical-align: inherit;">Wenn die Sendefunktion NULL zur√ºckgibt, wird das Paket an alle an das sendende Ger√§t angeschlossenen Ger√§te gesendet, was zu einem √úbertragungsfehler oder einer Verz√∂gerung aufgrund einer Netzwerk√ºberlastung f√ºhren kann.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW Daten empfangen</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die R√ºckruffunktion startet auch von einer Wi-Fi-Aufgabe. </font><font style="vertical-align: inherit;">Daher wird nicht empfohlen, l√§ngere Vorg√§nge in der R√ºckruffunktion auszuf√ºhren. </font><font style="vertical-align: inherit;">Stattdessen k√∂nnen Sie die erforderlichen Daten in eine statische Warteschlange stellen und mit einem Prozess mit niedrigerer Priorit√§t verarbeiten.</font></font><br>
<br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abschlie√üend das Vorstehende</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meine Erfahrung beim </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font><i><font style="vertical-align: inherit;">Espressif IDE</font></i><font style="vertical-align: inherit;"> und von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit ESP-NOW, Beschreiben der Fehler, die w√§hrend der Montage aufgetreten sind, und Beheben dieser Fehler, nachdem ich ein stabiles Ergebnis erzielt habe. Anschlie√üend beschreibe ich die ESP-NOW-Bibliothek in MicroPython mit den erkannten Fehlern und M√∂glichkeiten zu deren Behebung. Leider ist das Verst√§ndnis der Algorithmen des ESP-NOW-Protokolls aufgrund der Tatsache, dass der Quellcode von ESP-NOW geschlossen und nur in bin√§rer Form verteilt ist, empirisch und es gibt eine Reihe von Problemen, die bereits identifiziert wurden, f√ºr die es nicht immer Optionen gibt, sie logisch zu √ºberwinden, sondern im Allgemeinen ESP -NOW wurde erfolgreich in der Community von C-Benutzern und Pythonisten basierend auf mehr als 300 auf GitHub pr√§sentierten Anwendungen angewendet. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung der ESP-NOW C-Bibliothek von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">MicroPython</font></i><font style="vertical-align: inherit;"> ESP-NOW Beschreibung und Open Sources</font></font><i><font style="vertical-align: inherit;"></font></i></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502248/index.html">Ein neues GOST f√ºr digitale Ressourcen trat in Kraft: Alle Plattformen sollten f√ºr Menschen mit Behinderungen zug√§nglich sein</a></li>
<li><a href="../de502250/index.html">Zivilluftfahrt heute: Wichtige Aspekte und Herausforderungen in der Ausbildung</a></li>
<li><a href="../de502252/index.html">Fernbedienung und Drohnen</a></li>
<li><a href="../de502254/index.html">PostgreSQL: Serverseitige Programmierung in der menschlichen Sprache (PL / Perl, PL / Python, PL / v8)</a></li>
<li><a href="../de502256/index.html">Wie visualisiere ich ein Spring Integration-Diagramm mit Neo4j?</a></li>
<li><a href="../de502262/index.html">Warum AIOps und Umbrella-Monitoring f√ºr die Bank oder worauf Kundenbeziehungen aufbauen</a></li>
<li><a href="../de502264/index.html">Infrastruktur f√ºr √∂ffentliche Schl√ºssel. Ausstellung von Zertifikaten unter Bedingungen der Selbstisolation</a></li>
<li><a href="../de502266/index.html">Aurora auf Intel-Plattform. Morgend√§mmerung der Exaflops-√Ñra</a></li>
<li><a href="../de502268/index.html">HackTheBox. Patente weitergeben. XXE √ºber DOCX-, LFI- bis RCE-, GIT- und ROP-Ketten-Dateien</a></li>
<li><a href="../de502272/index.html">Sagen Sie nicht "Ich f√ºhle mich selbst" und andere englische Regeln, die in einen Stupor geraten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>