<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕺🏾 🚛 🐜 Microsoft SQL Serverおよび他のDBMSの例でのRとデータベースの相互作用 🍆 👄 🧠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ビジネス情報の大部分がデータベースに格納されているため。どのようなプログラミング言語を使用する場合でも、それらを使用してさまざまなアクションを実行する必要があります。
 

この記事では、Rのデータベースを操作するための2つのインターフェースについて説明します。ほとんどの例はMicrosoft SQ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Microsoft SQL Serverおよび他のDBMSの例でのRとデータベースの相互作用</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461063/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ビジネス情報の大部分がデータベースに格納されているため。</font><font style="vertical-align: inherit;">どのようなプログラミング言語を使用する場合でも、それらを使用してさまざまなアクションを実行する必要があります。</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事では、Rのデータベースを操作するための2つのインターフェースについて説明します。ほとんどの例はMicrosoft SQL Serverの操作を示していますが、すべてのコード例は、MySQL、PostgreSQL、SQLite、ClickHouseなどの他のデータベースでも機能します。 、Google BigQueryなど</font></font></p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/925/a23/786/925a23786a89917d9a314a793545cbb1.jpg" alt="画像"></p><a name="habracut"></a><br>
<h1 id="soderzhanie"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツ</font></font></h1><br>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ分析、特にR言語に興味がある場合は、私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電報</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">や</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YouTube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャンネルに</font><font style="vertical-align: inherit;">興味があるかもしれません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ほとんどのコンテンツはR専用です。</font></font></em></p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要なソフトウェア</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DBIパッケージ</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本的なDBI関数のリスト</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データベース接続</font></font></a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">odbcパッケージを使用してMicrosoft SQL Serverに接続する例</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RMSSQLパッケージを使用してMicrosoft SQL Serverに接続する例</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rスクリプトでデータベースパスワードを非表示にする方法</font></font></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テーブルの作成とデータベースへの書き込み</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DBMSからのデータの読み取り</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">    (DML)</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="> RODBC</a><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   RODBC</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   RODBC</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
</ul></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="></a></li>
</ul><br>
<h1 id="trebuemoe-programmnoe-obespechenie">  </h1><br>
<p> ,               ,   :</p><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"> R</a>;</li>
<li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">RStudio</a>;</li>
<li>   ,  :<br>
3.1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Microsoft SQL Server</a><br>
3.2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MySQL</a><br>
3.3. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">PostgreSQL</a></li>
</ol><br>
<h1 id="paket-dbi"> DBI</h1><br>
<p> <code>DBI</code>            R.</p><br>
<p><code>DBI</code>    ,        .          ,          ().</p><br>
<h3 id="spisok-osnovnyh-funkciy-dbi">   DBI</h3><br>
<ul>
<li><code>dbConnect</code> —    ;</li>
<li><code>dbWriteTable</code> —     ;</li>
<li><code>dbReadTable</code> —     ;</li>
<li><code>dbGetQuery</code> —    ;</li>
<li><code>dbSendQuery</code> —     ;</li>
<li><code>dbFetch</code> —     ;</li>
<li><code>dbExecute</code> —     /  /    ;</li>
<li><code>dbGetInfo</code> —       ;</li>
<li><code>dbListFields</code> —    ;</li>
<li><code>dbListTables</code> —     ;</li>
<li><code>dbExistsTable</code> —      ;</li>
<li><code>dbRemoveTable</code> —     ;</li>
<li><code>dbDisconnect</code> —     .</li>
</ul><br>
<h3 id="podklyuchenie-k-bazam-dannyh">   </h3><br>
<p>         .             ,     .</p><br>
<ul>
<li><code>odbc</code> —     ODBC ;</li>
<li><code>RSQLite</code> —   SQLite;</li>
<li><code>RMySQL</code> / <code>RMariaDB</code> —    MySQL  MariaDB;</li>
<li><code>RPostgreSQL</code> —   PosrtgreSQL;</li>
<li><code>bigrquery</code> —   Google BigQuery;</li>
<li><code>RClickhouse</code> / <code>clickhouse</code> —   ClickHouse;</li>
<li><code>RMSSQL</code> —   Microsoft SQL Server (MS SQL), <em>       GitHub</em>.</li>
</ul><br>
<p> <code>DBI</code>     R,  ,            <code>install.packages(" ")</code>.</p><br>
<p>    GitHub      — <code>devtools</code>.   <code>RMSSQL</code>         R ,      :</p><br>
<pre><code class="plaintext hljs">install.packages("devtools")<font></font>
devtools::install_github("bescoto/RMSSQL")</code></pre><br>
<h4 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-odbc">   Microsoft SQL Server    odbc</h4><br>
<p>     R         <code>library(" ")</code>.</p><br>
<p>   Microsoft SQL Server             .   ,      ,              R   CRAN. </p><br>
<p>   SQL Server,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">ODBC</a> (. Open Database Connectivity)   .      ODBC   R   .       <code>odbc</code>.</p><br>
<div class="spoiler"><b class="spoiler_title">     odbc </b><div class="spoiler_text"><pre><code class="plaintext hljs">#   odbc<font></font>
install.packages("odbc")<font></font>
<font></font>
#  <font></font>
library(odbc)<font></font>
<font></font>
#   MS SQL<font></font>
con &lt;- dbConnect(drv = odbc(),<font></font>
                 Driver   = "SQL Server",<font></font>
                 Server   = "localhost",<font></font>
                 Database = "mybase",<font></font>
                 UID      = "my_username",<font></font>
                 PWD      = "my_password",<font></font>
                 Port     = 1433)</code></pre></div></div><br>
<p>  <code>dbConnect()</code>     <em>drv</em>  ,        (<code>odbc()</code>).     ,   ,         <code>DBI</code>. </p><br>
<p>    .    MS SQL  ODBC    :</p><br>
<ul>
<li>Driver —  ODBC ;</li>
<li>Server — IP  SQL ;</li>
<li>Database —       ;</li>
<li>UID —    ;</li>
<li>PWD — ;</li>
<li>Port —   ,  SQL Server    1433.</li>
</ul><br>
<p>ODBC     Microsoft SQL Server    Windows,       .          ODBC.      Windows 10    :</p><br>
<ul>
<li>32- : <code>%systemdrive%\Windows\SysWoW64\Odbcad32.exe</code></li>
<li>64- : <code>%systemdrive%\Windows\System32\Odbcad32.exe</code></li>
</ul><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/c6c/816/934/c6c816934a70e2386a4547d7626d515f.png"></p><br>
<p>             <code>odbcListDrivers()</code>.</p><br>
<pre><code class="plaintext hljs">   name                                  attribute        value                                   <font></font>
   &lt;chr&gt;                                 &lt;chr&gt;            &lt;chr&gt;                                   <font></font>
 1 SQL Server                            APILevel         2                                       <font></font>
 2 SQL Server                            ConnectFunctions YYY                                     <font></font>
 3 SQL Server                            CPTimeout        60                                      <font></font>
 4 SQL Server                            DriverODBCVer    03.50                                   <font></font>
 5 SQL Server                            FileUsage        0                                       <font></font>
 6 SQL Server                            SQLLevel         1                                       <font></font>
 7 SQL Server                            UsageCount       1                                       <font></font>
 8 MySQL ODBC 5.3 ANSI Driver            UsageCount       1                                       <font></font>
 9 MySQL ODBC 5.3 Unicode Driver         UsageCount       1                                       <font></font>
10 Simba ODBC Driver for Google BigQuery Description      Simba ODBC Driver for Google BigQuery2.0<font></font>
# ... with 50 more rows</code></pre><br>
<p> ODBC        :</p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">MySQL</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">PostgreSQL</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow">Google BigQuery</a></li>
</ul><br>
<p>         , :</p><br>
<ul>
<li>PostgreSQL / MySQL / MariaDB — user, password, host, port, dbname;</li>
<li>GoogleBigQuery — project, dataset;</li>
<li>ClickHouse — user, password, db, port, host;</li>
</ul><br>
<p>     ODBC       ODBC  .     ,    " DSN"    "...".</p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/9ae/e92/ba3/9aee92ba30bdc8de811623aae1fb58fa.png"></p><br>
<p>         , DSN (Data Source Name). </p><br>
<p><img src="https://habrastorage.org/getpro/habr/post_images/b03/a0c/a7c/b03a0ca7c90fa0d5bddccb53575563a3.png"></p><br>
<p>        DSN "my_test_source".          Microsoft SQL Server,        .</p><br>
<div class="spoiler"><b class="spoiler_title">    odbc    DSN</b><div class="spoiler_text"><pre><code class="plaintext hljs">#   DSN<font></font>
con &lt;- dbConnect(odbc(),<font></font>
                DSN = "my_test_source",<font></font>
                UID = "my_username",<font></font>
                PWD = "my_password")</code></pre></div></div><br>
<p>         ODBC     <code>odbcListDataSources()</code>.</p><br>
<pre><code class="plaintext hljs">   name            description                          <font></font>
   &lt;chr&gt;           &lt;chr&gt;                                <font></font>
 1 BQ              Simba ODBC Driver for Google BigQuery<font></font>
 2 BQ_main         Simba ODBC Driver for Google BigQuery<font></font>
 3 BQ ODBC         Simba ODBC Driver for Google BigQuery<font></font>
 4 OLX             Simba ODBC Driver for Google BigQuery<font></font>
 5 Multicharts     Simba ODBC Driver for Google BigQuery<font></font>
 6 PostgreSQL35W   PostgreSQL Unicode(x64)              <font></font>
 7 hillel_bq       Simba ODBC Driver for Google BigQuery<font></font>
 8 blog_bq         Simba ODBC Driver for Google BigQuery<font></font>
 9 MyClientMSSQL   SQL Server                           <font></font>
10 local_mssql     SQL Server                           <font></font>
11 MSSQL_localhost SQL Server                           <font></font>
12 my_test_source  SQL Server                           <font></font>
13 Google BigQuery Simba ODBC Driver for Google BigQuery</code></pre><br>
<h3 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-rmssql">   Microsoft SQL Server    RMSSQL</h3><br>
<p><code>RMSSQL</code>    CRAN,      GitHub    <code>devtools</code>.</p><br>
<pre><code class="plaintext hljs">install.packages("devtools")<font></font>
devtools::install_github("bescoto/RMSSQL")</code></pre><br>
<div class="spoiler"><b class="spoiler_title">    DBI  RMSSQL</b><div class="spoiler_text"><pre><code class="plaintext hljs">#   <font></font>
library(RJDBC)<font></font>
library(RMSSQL)<font></font>
library(DBI)<font></font>
<font></font>
#  RMSSQL<font></font>
con &lt;- dbConnect(MSSQLServer(), <font></font>
                 host     = 'localhost', <font></font>
                 user     = 'my_username', <font></font>
                 password = 'my_password', <font></font>
                 dbname   = "mybase")</code></pre></div></div><br>
<p>  ,        <code>DBI</code>,      . ..      — ,      <em>drv</em>  <code>dbConnect</code>,  —       .</p><br>
<div class="spoiler"><b class="spoiler_title">   MySQL, PostgreSQL, SQLite  BigQuery</b><div class="spoiler_text"><pre><code class="plaintext hljs">#   MySQL<font></font>
library(RMySQL)<font></font>
<font></font>
con &lt;- dbConnect(MySQL(), <font></font>
                 host     = 'localhost', <font></font>
                 user     = 'my_username', <font></font>
                 password = 'my_password', <font></font>
                 dbname   = "mybase",<font></font>
                 host     = "localhost")<font></font>
<font></font>
#   PostrgeSQL<font></font>
library(RPostgreSQL)<font></font>
<font></font>
con &lt;- dbConnect(PostgreSQL(), <font></font>
                 host     = 'localhost', <font></font>
                 user     = 'my_username', <font></font>
                 password = 'my_password', <font></font>
                 dbname   = "mybase",<font></font>
                 host     = "localhost")<font></font>
<font></font>
#   PostrgeSQL<font></font>
library(RPostgreSQL)<font></font>
<font></font>
con &lt;- dbConnect(PostgreSQL(), <font></font>
                 host     = 'localhost', <font></font>
                 user     = 'my_username', <font></font>
                 password = 'my_password', <font></font>
                 dbname   = "mybase",<font></font>
                 host     = "localhost")<font></font>
<font></font>
#   SQLite<font></font>
library(RSQLite)<font></font>
<font></font>
# connection or create base<font></font>
con &lt;- dbConnect(drv = SQLite(),<font></font>
                 "localhost.db")<font></font>
<font></font>
#   Google BigQuery<font></font>
library(bigrquery)<font></font>
<font></font>
con &lt;- dbConnect(drv     = bigquery(),<font></font>
                 project = "my_proj_id",<font></font>
                 dataset = "dataset_name")</code></pre></div></div><br>
<h3 id="kak-skryt-paroli-ot-bazy-dannyh-v-r-skriptah">       R </h3><br>
<p>                   ,        ,  ,       . </p><br>
<p>           ,      ,         .                        .</p><br>
<p>         . ,  Windows     (Credential Manager).                 <code>keyring</code>.           ,    Windows, MacOS  Linux.</p><br>
<pre><code class="plaintext hljs"># install.packages("keyring")<font></font>
<font></font>
#  <font></font>
library(keyring)<font></font>
library(RMSSQL)<font></font>
<font></font>
#  <font></font>
key_set_with_value(service = "mssql", <font></font>
                   username = "my_username",<font></font>
                   password = "my_password")<font></font>
<font></font>
#   RMSSQL<font></font>
con &lt;- dbConnect(MSSQLServer(), <font></font>
                 host     = 'localhost', <font></font>
                 user     = 'my_username', <font></font>
                 password = key_get("mssql", "my_username"), <font></font>
                 dbname   = "mybase")</code></pre><br>
<p>..    <code>key_set_with_value()</code>       ,    <code>key_get()</code>  ,             .   <code>keyring</code>        ,     ,         API.</p><br>
<h3 id="sozdanie-tablic-i-zapis-v-bazu-dannyh">      </h3><br>
<p>      <code>dbWriteTable()</code>.</p><br>
<p>  <code>dbWriteTable()</code>: </p><br>
<p><em>    ,  —  </em></p><br>
<ul>
<li><strong>conn</strong> —    ,     <code>dbConnect</code>;</li>
<li><strong>name</strong> —    ,     ;</li>
<li><strong>value</strong> —  (  data.frame / data.table / tibble_frame)  R,       ;</li>
<li><em>row.names</em> —     row_names,   , <em>    FALSE</em>.</li>
<li><em>overwrite</em> —  ,        <em>name</em>    , <em>    FALSE</em>;</li>
<li><em>append</em> —  ,        <em>name</em>    , <em>    FALSE</em>;</li>
<li><em>field.types</em> —     ,           , <em>    NULL</em>;</li>
<li><em>temporary</em> —      ,         , <em>    FALSE</em>.</li>
</ul><br>
<div class="spoiler"><b class="spoiler_title">      DBI</b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
#     DSN<font></font>
con &lt;- dbConnect(odbc(),<font></font>
                DSN = "my_test_source",<font></font>
                UID = "my_username",<font></font>
                PWD = "my_password")<font></font>
#     iris,         R  iris<font></font>
dbWriteTable(conn  = con,<font></font>
             name  = "iris", <font></font>
             value = iris)<font></font>
<font></font>
#    <font></font>
dbDisconnect(con)</code></pre></div></div><br>
<p>        <code>dbListTables()</code>,    <code>dbRemoveTable()</code></p><br>
<div class="spoiler"><b class="spoiler_title">        </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#   <font></font>
dbListTables(con)<font></font>
#   iris<font></font>
dbRemoveTable(con, "iris")<font></font>
<font></font>
#    <font></font>
dbDisconnect(con)</code></pre></div></div><br>
<h3 id="chtenie-dannyh-iz-subd">   </h3><br>
<p>  <code>DBI</code>      ,     SQL .       <code>dbReadTable()</code>  <code>dbGetQuery()</code>.</p><br>
<div class="spoiler"><b class="spoiler_title">   iris  </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#   iris   iris<font></font>
dbiris &lt;- dbReadTable(con, "iris")<font></font>
<font></font>
#    <font></font>
dbDisconnect(con)</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">    SQL  </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#    <font></font>
setosa &lt;- dbGetQuery(con,<font></font>
                     "SELECT * FROM iris WHERE Species = 'setosa'")<font></font>
<font></font>
#    <font></font>
dbDisconnect(con)</code></pre></div></div><br>
<h3 id="manipulirovanie-dannymi-v-subd-dml">    (DML)</h3><br>
<p>   <code>dbGetQuery()</code>        (SELECT).</p><br>
<p>    ,   UPDATE, INSERT, DELETE,  <code>DBI</code>   <code>dbExecute()</code>.</p><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#   (INSERT)<font></font>
dbExecute(con, <font></font>
          "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species])<font></font>
           VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')")<font></font>
<font></font>
#   (UPDATE)<font></font>
dbExecute(con, <font></font>
          "UPDATE iris<font></font>
           SET [Species] = 'old_value'<font></font>
           WHERE row_names = 51")<font></font>
<font></font>
#     (DELETE)<font></font>
dbExecute(con, "DELETE FROM iris WHERE row_names = 51")<font></font>
<font></font>
#    <font></font>
dbDisconnect(con)</code></pre></div></div><br>
<h3 id="tranzakcii-v-subd">  </h3><br>
<blockquote>       .        (, commit)    (, rollback).       ,     .</blockquote><p><em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">   "    "</a></em></p><br>
<p>    SQL   .  <code>DBI</code>      <code>dbBegin()</code>       <code>dbCommit()</code>,     <code>dbRollback()</code>.     , :  ,          . </p><br>
<p> ,        iris 51 ,    <em>Sepal.Width</em>  5 ,   43   .</p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#     <font></font>
dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)")<font></font>
<font></font>
#   row_names Sepal.Length Sepal.Width Petal.Length Petal.Width    Species<font></font>
# 1         5          5.0         3.6          1.4         0.2     setosa<font></font>
# 2        43          4.4         3.2          1.3         0.2     setosa<font></font>
# 3        51          7.0         3.2          4.7         1.4 versicolor<font></font>
<font></font>
#   <font></font>
dbBegin(con)<font></font>
<font></font>
#  <font></font>
dbExecute(con, <font></font>
          "INSERT INTO iris <font></font>
          (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species])<font></font>
           VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')")<font></font>
<font></font>
#   <font></font>
dbExecute(con, <font></font>
          "UPDATE iris<font></font>
           SET [Sepal.Width] = 8<font></font>
           WHERE row_names = 5")<font></font>
<font></font>
#   43<font></font>
dbExecute(con, "DELETE FROM iris WHERE row_names = 43")<font></font>
<font></font>
#  <font></font>
dbCommit(con)<font></font>
<font></font>
#     <font></font>
dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)")<font></font>
<font></font>
#   row_names Sepal.Length Sepal.Width Petal.Length Petal.Width    Species<font></font>
# 1         5            5         8.0          1.4         0.2     setosa<font></font>
# 2        51            7         3.2          4.7         1.4 versicolor<font></font>
# 3        51            5         3.3          1.7         0.3 new_values</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(odbc)<font></font>
<font></font>
#   <font></font>
con &lt;- dbConnect(odbc(),<font></font>
                 DSN = "my_test_source",<font></font>
                 UID = "my_username",<font></font>
                 PWD = "my_password")<font></font>
<font></font>
#     <font></font>
dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)")<font></font>
<font></font>
#   row_names Sepal.Length Sepal.Width Petal.Length Petal.Width    Species<font></font>
# 1         5          5.0         3.6          1.4         0.2     setosa<font></font>
# 2        43          4.4         3.2          1.3         0.2     setosa<font></font>
# 3        51          7.0         3.2          4.7         1.4 versicolor<font></font>
<font></font>
#   <font></font>
dbBegin(con)<font></font>
<font></font>
#  <font></font>
dbExecute(con, <font></font>
          "INSERT INTO iris <font></font>
          (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species])<font></font>
           VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')")<font></font>
<font></font>
#   <font></font>
dbExecute(con, <font></font>
          "UPDATE iris<font></font>
           SET [Sepal.Width] = 8<font></font>
           WHERE row_names = 5")<font></font>
<font></font>
#   43<font></font>
dbExecute(con, "DELETE FROM iris WHERE row_names = 43")<font></font>
<font></font>
#  <font></font>
dbRollback(con)<font></font>
<font></font>
#     <font></font>
dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)")<font></font>
<font></font>
#   row_names Sepal.Length Sepal.Width Petal.Length Petal.Width    Species<font></font>
# 1         5          5.0         3.6          1.4         0.2     setosa<font></font>
# 2        43          4.4         3.2          1.3         0.2     setosa<font></font>
# 3        51          7.0         3.2          4.7         1.4 versicolor</code></pre></div></div><br>
<h1 id="paket-rodbc"> RODBC</h1><br>
<p> <code>RODBC</code>           ODBC .</p><br>
<p><code>RODBC</code>    <code>DBI</code>, ..          <code>RODBC</code>     <code>DBI</code>.</p><br>
<h3 id="osnovnye-funkcii-paketa-rodbc">   RODBC</h3><br>
<ul>
<li><code>odbcConnect</code> —     DSN;</li>
<li><code>odbcDriverConnect</code> —      ;</li>
<li><code>sqlQuery</code> —    ,     .    : SELECT, UPDATE, INSERT, DELETE.</li>
<li><code>sqlFetch</code> —     ;</li>
<li><code>sqlTables</code> —     .</li>
<li><code>sqlSave</code> —      ,        ;</li>
<li><code>sqlUpdate</code> —         ;</li>
<li><code>sqlDrop</code> —    ;</li>
<li><code>odbcClose</code> —    .</li>
</ul><br>
<h3 id="primer-raboty-s-rodbc">   RODBC</h3><br>
<p>    <code>RODBC</code>    <code>DBI</code>,           .</p><br>
<div class="spoiler"><b class="spoiler_title">     RODBC</b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(RODBC)<font></font>
#  <font></font>
con_string &lt;- odbcDriverConnect(connection = "Driver=SQL Server;Server=localhost;Database=mybase;UID=my_username;PWD=my_password;Port=1433")<font></font>
#   DSN<font></font>
con_dsn    &lt;- odbcConnect(dsn = "my_test_source",<font></font>
                          uid = "my_username",<font></font>
                          pwd = "my_password")<font></font>
<font></font>
#    <font></font>
sqlSave(con_dsn,<font></font>
        dat       = iris,<font></font>
        tablename = "iris")<font></font>
<font></font>
#     iris<font></font>
sqlSave(con_dsn,<font></font>
        dat       = iris,<font></font>
        tablename = "iris",<font></font>
        append    = TRUE)<font></font>
<font></font>
#   4 <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#      R<font></font>
iris[1, 5] &lt;- "virginica"<font></font>
<font></font>
#    <font></font>
sqlUpdate(con_dsn,<font></font>
          dat       = iris,<font></font>
          tablename = "iris")<font></font>
<font></font>
#   4    <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#  <font></font>
sqlDrop(con_dsn, sqtable = "iris")<font></font>
<font></font>
#    <font></font>
odbcCloseAll()</code></pre></div></div><br>
<h1 id="tranzakcionnost"></h1><br>
<p>    <code>RODBC</code> .     .</p><br>
<ul>
<li><code>odbcSetAutoCommit</code> —         ;</li>
<li><code>odbcEndTran</code> —    .</li>
</ul><br>
<p>       <code>odbcSetAutoCommit</code>    <em>autoCommit</em>.</p><br>
<div class="spoiler"><b class="spoiler_title">      RODBC</b><div class="spoiler_text"><pre><code class="plaintext hljs">#  <font></font>
library(RODBC)<font></font>
#   DSN<font></font>
con_dsn    &lt;- odbcConnect(dsn = "my_test_source",<font></font>
                          uid = "my_username",<font></font>
                          pwd = "my_password")<font></font>
<font></font>
#    <font></font>
sqlSave(con_dsn,<font></font>
        dat       = iris,<font></font>
        tablename = "iris")<font></font>
<font></font>
#   <font></font>
odbcSetAutoCommit(con_dsn, autoCommit = FALSE)<font></font>
<font></font>
#   4 <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#   rownames SepalLength SepalWidth PetalLength PetalWidth Species<font></font>
# 1        1         5.1        3.5         1.4        0.2  setosa<font></font>
# 2        2         4.9        3.0         1.4        0.2  setosa<font></font>
# 3        3         4.7        3.2         1.3        0.2  setosa<font></font>
# 4        4         4.6        3.1         1.5        0.2  setosa<font></font>
<font></font>
#      R<font></font>
iris[1, 5] &lt;- "virginica"<font></font>
<font></font>
#    <font></font>
sqlUpdate(con_dsn,<font></font>
          dat       = iris,<font></font>
          tablename = "iris")<font></font>
<font></font>
#   4 <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#   rownames SepalLength SepalWidth PetalLength PetalWidth   Species<font></font>
# 1        1         5.1        3.5         1.4        0.2 virginica<font></font>
# 2        2         4.9        3.0         1.4        0.2    setosa<font></font>
# 3        3         4.7        3.2         1.3        0.2    setosa<font></font>
# 4        4         4.6        3.1         1.5        0.2    setosa<font></font>
<font></font>
#  <font></font>
odbcEndTran(con_dsn, commit = FALSE)<font></font>
<font></font>
#   4 <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#   rownames SepalLength SepalWidth PetalLength PetalWidth Species<font></font>
# 1        1         5.1        3.5         1.4        0.2  setosa<font></font>
# 2        2         4.9        3.0         1.4        0.2  setosa<font></font>
# 3        3         4.7        3.2         1.3        0.2  setosa<font></font>
# 4        4         4.6        3.1         1.5        0.2  setosa<font></font>
<font></font>
#    <font></font>
sqlUpdate(con_dsn,<font></font>
          dat       = iris,<font></font>
          tablename = "iris")<font></font>
<font></font>
#  <font></font>
odbcEndTran(con_dsn, commit = TRUE)<font></font>
<font></font>
#   4    <font></font>
sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4)<font></font>
<font></font>
#   rownames SepalLength SepalWidth PetalLength PetalWidth   Species<font></font>
# 1        1         5.1        3.5         1.4        0.2 virginica<font></font>
# 2        2         4.9        3.0         1.4        0.2    setosa<font></font>
# 3        3         4.7        3.2         1.3        0.2    setosa<font></font>
# 4        4         4.6        3.1         1.5        0.2    setosa<font></font>
<font></font>
#    <font></font>
odbcClose(con_dsn)</code></pre></div></div><br>
<h1 id="zaklyuchenie"></h1><br>
<p>           R, <code>DBI</code>  <code>RODBC</code>,  ,       . </p><br>
<p>          .          .        ODBC    <code>odbc</code>  <code>RODBC</code>.   ,      ,  .    SQL ,    SQL        .</p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
記事を読んでいるなら、おそらくR言語に興味があるでしょう。その場合、私の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">電報</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YouTube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャンネルに</font><font style="vertical-align: inherit;">興味があると思います。</font><font style="vertical-align: inherit;">その内容のほとんどはR言語に捧げられています。</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461053/index.html">オンライン地図をスマートフォンのナビゲーターに接続します。パート2-ベクトルカード</a></li>
<li><a href="../ja461055/index.html">レッコチャレンジ2019：いかがでしたか</a></li>
<li><a href="../ja461057/index.html">ゲーム開発に関する電報チャネル</a></li>
<li><a href="../ja461059/index.html">映画ファンのためのAndroidアプリの作成-パート1（プロトタイピング）</a></li>
<li><a href="../ja461061/index.html">マグネシウム合金、双晶境界および偏析</a></li>
<li><a href="../ja461067/index.html">2019年に準備する必要がある就職の面接の上位65のSQL質問。パートI</a></li>
<li><a href="../ja461069/index.html">Nobelic Outdoor IP Cameras：Ivideonビデオ監視システムのテスト、テクノロジー、機能</a></li>
<li><a href="../ja461071/index.html">ビルダー向けのB2Bサービスの例でのデータベースクエリの最適化</a></li>
<li><a href="../ja461073/index.html">オンライン地図をスマートフォンのナビゲーターに接続します。パート3-OverpassTurbo</a></li>
<li><a href="../ja461075/index.html">ビジネス分析。ITオブジェクト、コンポーネント、ツール</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>