<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📀 🧛🏿 🙏🏿 iOSでユビキタススプラッシュスクリーンを作成する 🔋 👩🏻‍💼 🤱🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="こんにちはハブル！
 
 スプラッシュ画面からアプリケーションの他の画面へのアニメーション遷移の実装について説明します。タスクは、スプラッシュスクリーンと製品の外観を変更せずには実行できないグローバルなブランド変更の一環として発生しました。
 
 大規模なプロジェクトに携わる多くの開発者にとって、美...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>iOSでユビキタススプラッシュスクリーンを作成する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/youla/blog/456394/"><img src="https://habrastorage.org/webt/po/rm/6t/porm6txa_jiiq2ua9zvrkzw8tey.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
こんにちはハブル！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スプラッシュ画面からアプリケーションの他の画面へのアニメーション遷移の実装について説明します。タスクは、スプラッシュスクリーンと製品の外観を変更せずには実行できないグローバルなブランド変更の一環として発生しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
大規模なプロジェクトに携わる多くの開発者にとって、美しいアニメーションの作成に関連する問題の解決は、バグ、複雑な機能、ホットフィックスの世界で新鮮な空気の息吹になります。このようなタスクは比較的簡単に実装でき、結果は目に優しく、非常に印象的です。しかし、標準的なアプローチが適用できない場合があり、その場合はあらゆる種類の回避策を考え出す必要があります。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一見、スプラッシュ画面の更新作業では、アニメーションの作成が一番難しいようですが、残りは「定型作業」です。古典的な状況：最初に1つの画面を表示し、次にカスタム遷移で次の画面を開きます-すべてが簡単です！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アニメーションの一部として、次の画面のコンテンツが表示されるスプラッシュスクリーンに穴を開ける必要があります。つまり</font></font><code>view</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、スプラッシュの下に表示される</font><font style="vertical-align: inherit;">ものを確実に知る必要があり</font><font style="vertical-align: inherit;">ます。 Yulaを起動するとテープが開くので、</font></font><code>view</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切なコントローラー</font><font style="vertical-align: inherit;">に接続するのが論理的</font><font style="vertical-align: inherit;">です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、ユーザープロファイルにつながるプッシュ通知でアプリケーションを実行するとどうなるでしょうか。</font><font style="vertical-align: inherit;">またはブラウザから製品カードを開きますか？</font><font style="vertical-align: inherit;">その場合、次の画面はテープではありません（これはすべての可能性のあるケースとはかけ離れています）。</font><font style="vertical-align: inherit;">メイン画面を開いた後にすべての移行が行われますが、アニメーションは特定のものに関連付けられて</font></font><code>view</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">いますが、どのコントローラーですか？</font><font style="vertical-align: inherit;">各状況を処理</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
するため</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くの</font></font><code>if-else</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブロックの</font><s><font style="vertical-align: inherit;">松葉杖</font></s><font style="vertical-align: inherit;">を避けるために</font><font style="vertical-align: inherit;">、スプラッシュ画面がレベルで表示されます</font></font><code>UIWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このアプローチの利点は、スプラッシュの下で何が発生するかをまったく気にしないことです。アプリケーションのメインウィンドウでは、テープをロードしたり、ポップアップしたり、アニメーションで画面に切り替えたりできます。</font><font style="vertical-align: inherit;">次に、選択したメソッドの実装について詳しく説明します。これは、次の手順で構成されています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スプラッシュスクリーンを準備しています。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外観のアニメーション。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アニメーションを非表示にします。</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スプラッシュスクリーンの準備</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、静的なスプラッシュ画面を準備する必要があります。つまり、アプリケーションが起動するとすぐに表示される画面です。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これを行うには2つの方法があり</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font><code>LaunchScreen.storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">デバイスごとに異なる解像度の画像を提供するか、この画面を作成しますc </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">2番目のオプションはより速く、より便利で、Apple自身が推奨しているので、それを使用します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gb/nt/dp/gbntdpxhdmuulde5w2eed-pbksg.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてがシンプルです</font><font style="vertical-align: inherit;">。</font></font><code>imageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラデーションの背景と</font></font><code>imageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロゴがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご存知のように、この画面はアニメーション化できないため、視覚的に同一の別の画面を作成して、画面間の遷移が見えないようにする必要があります。</font></font><code>Main.storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加</font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/km/hn/j1kmhncns4proxlf8i3hi8pf0su.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の画面との違いは、</font></font><code>imageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムテキストが置換される</font><font style="vertical-align: inherit;">別の画面があることです</font><font style="vertical-align: inherit;">（もちろん、最初は非表示になります）。</font><font style="vertical-align: inherit;">次に、このコントローラーのクラスを作成します。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SplashViewController</span>: <span class="hljs-title">UIViewController</span> </span>{<font></font>
<font></font>
    <span class="hljs-meta">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> logoImageView: <span class="hljs-type">UIImageView!</span>
    <span class="hljs-meta">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> textImageView: <span class="hljs-type">UIImageView!</span><font></font>
    <font></font>
    <span class="hljs-keyword">var</span> textImage: <span class="hljs-type">UIImage?</span><font></font>
    <font></font>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">viewDidLoad</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.viewDidLoad()<font></font>
        textImageView.image = textImage<font></font>
    }<font></font>
    <font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><code>IBOutlet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アニメーション化する要素の要素に</font><font style="vertical-align: inherit;">
加え</font><font style="vertical-align: inherit;">て、このクラスにはプロパティもあります</font></font><code>textImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ランダムに選択された画像がそれに転送されます。</font><font style="vertical-align: inherit;">次に戻って</font></font><code>Main.storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、適切なコントローラクラスをポイントし</font></font><code>SplashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">同時に、最初の</font><font style="vertical-align: inherit;">画面にYulaのスクリーンショットを</font></font><code>ViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入れ</font><font style="vertical-align: inherit;">て</font></font><code>imageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、スプラッシュの下に空白の画面がないようにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、スラッシュスクリーンの表示と非表示のロジックを担当するプレゼンターが必要です。</font><font style="vertical-align: inherit;">そのためのプロトコルを記述し、すぐにクラスを作成します。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">SplashPresenterDescription</span>: <span class="hljs-title">class</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">present</span><span class="hljs-params">()</span></span>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dismiss</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>)<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SplashPresenter</span>: <span class="hljs-title">SplashPresenterDescription</span> </span>{
     <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">present</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//    </span><font></font>
     }<font></font>
     <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dismiss</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-comment">//    </span><font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じオブジェクトがスプラッシュスクリーンのテキストを選択します。</font><font style="vertical-align: inherit;">テキストは画像として表示されるため、適切なリソースをに追加する必要があります</font></font><code>Assets.xcassets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">リソースの名前は、番号を除いて同じです-ランダムに生成されます：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> textImage: <span class="hljs-type">UIImage?</span> = {
        <span class="hljs-keyword">let</span> textsCount = <span class="hljs-number">17</span><font></font>
        <font></font>
        <span class="hljs-keyword">let</span> imageNumber = <span class="hljs-type">Int</span>.random(<span class="hljs-keyword">in</span>: <span class="hljs-number">1</span>...textsCount)
        <span class="hljs-keyword">let</span> imageName = <span class="hljs-string">"i-splash-text-\(imageNumber)"</span><font></font>
        <font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-type">UIImage</span>(named: imageName)<font></font>
    }()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私が</font></font><code>textImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">普通の資産で</font><font style="vertical-align: inherit;">はないことを偶然ではあり</font><font style="vertical-align: inherit;">ませんでした</font></font><code>lazy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">つまり</font><font style="vertical-align: inherit;">、後でその理由を理解するでしょう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当初、スプラッシュスクリーンは別のスプラッシュスクリーンに表示されることを約束し</font></font><code>UIWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました。これには、次のものが必要です。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成</font></font><code>UIWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作成</font></font><code>SplashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><code>rootViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`om;</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このウィンドウがメインウィンドウの上に表示されるように、</font></font><code>windowLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さらに</font><font style="vertical-align: inherit;">設定し</font><font style="vertical-align: inherit;">ます</font></font><code>.normal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（デフォルト値）。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに</font></font><code>SplashPresenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> foregroundSplashWindow: <span class="hljs-type">UIWindow</span> = {
        <span class="hljs-keyword">let</span> splashViewController = <span class="hljs-keyword">self</span>.splashViewController(with: textImage)
        <span class="hljs-keyword">let</span> splashWindow = <span class="hljs-keyword">self</span>.splashWindow(windowLevel: .normal + <span class="hljs-number">1</span>, rootViewController: splashViewController)<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> splashWindow<font></font>
    }()<font></font>
<font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">splashWindow</span><span class="hljs-params">(windowLevel: UIWindow.Level, rootViewController: SplashViewController?)</span></span> -&gt; <span class="hljs-type">UIWindow</span> {
        <span class="hljs-keyword">let</span> splashWindow = <span class="hljs-type">UIWindow</span>(frame: <span class="hljs-type">UIScreen</span>.main.bounds)<font></font>
        <font></font>
        splashWindow.windowLevel = windowLevel<font></font>
        splashWindow.rootViewController = rootViewController<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> splashWindow<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">splashViewController</span><span class="hljs-params">(with textImage: UIImage?)</span></span> -&gt; <span class="hljs-type">SplashViewController?</span> {
        <span class="hljs-keyword">let</span> storyboard = <span class="hljs-type">UIStoryboard</span>(name: <span class="hljs-string">"Main"</span>, bundle: <span class="hljs-literal">nil</span>)
        <span class="hljs-keyword">let</span> viewController = storyboard.instantiateViewController(withIdentifier: <span class="hljs-string">"SplashViewController"</span>)<font></font>
        <font></font>
        <span class="hljs-keyword">let</span> splashViewController = viewController <span class="hljs-keyword">as</span>? <span class="hljs-type">SplashViewController</span><font></font>
        splashViewController?.textImage = textImage<font></font>
<font></font>
        <span class="hljs-keyword">return</span> splashViewController<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたはそれが奇妙設立することを見つけること</font></font><code>splashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、</font></font><code>splashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別の関数の中に作られたが、後でそれが便利になるだろう。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アニメーションロジックはまだ書き始めていませんが</font></font><code>SplashPresenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、多くのコードで記述しています。</font><font style="vertical-align: inherit;">したがって、アニメーション（およびこの責任分担）を直接処理するエンティティを作成することを提案します。</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">protocol</span> <span class="hljs-title">SplashAnimatorDescription</span>: <span class="hljs-title">class</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateAppearance</span><span class="hljs-params">()</span></span>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateDisappearance</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>)<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SplashAnimator</span>: <span class="hljs-title">SplashAnimatorDescription</span> </span>{<font></font>
    <font></font>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">unowned</span> <span class="hljs-keyword">let</span> foregroundSplashWindow: <span class="hljs-type">UIWindow</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">unowned</span> <span class="hljs-keyword">let</span> foregroundSplashViewController: <span class="hljs-type">SplashViewController</span><font></font>
<font></font>
    <span class="hljs-keyword">init</span>(foregroundSplashWindow: <span class="hljs-type">UIWindow</span>) {
        <span class="hljs-keyword">self</span>.foregroundSplashWindow = foregroundSplashWindow<font></font>
<font></font>
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> foregroundSplashViewController = foregroundSplashWindow.rootViewController <span class="hljs-keyword">as</span>? <span class="hljs-type">SplashViewController</span> <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"Splash window doesn't have splash root view controller!"</span>)<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">self</span>.foregroundSplashViewController = foregroundSplashViewController<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateAppearance</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">//    </span><font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateDisappearance</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-comment">//    </span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはコンストラクタ</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">渡され、</font><font style="vertical-align: inherit;">便宜上「抽出」</font></font><code>rootViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">され、のようなプロパティにも格納されます</font></font><code>foregroundSplashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
追加</font></font><code>SplashPresenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> animator: <span class="hljs-type">SplashAnimatorDescription</span> = <span class="hljs-type">SplashAnimator</span>(foregroundSplashWindow: foregroundSplashWindow)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして彼の方法を修正し</font></font><code>present</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><code>dismiss</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">present</span><span class="hljs-params">()</span></span> {<font></font>
        animator.animateAppearance()<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">dismiss</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>) {<font></font>
        animator.animateDisappearance(completion: completion)<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべて、最も退屈な部分、あなたはついにアニメーションを始めることができます！ </font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外観アニメーション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スプラッシュスクリーンの外観のアニメーションから始めましょう。簡単です。 </font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロゴ（</font></font><code>logoImageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）が</font><font style="vertical-align: inherit;">増えてい</font><font style="vertical-align: inherit;">ます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">テキストはフェードに表示され、わずかに上がります（</font></font><code>textImageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
デフォルトで</font></font><code>UIWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は非表示に</font><font style="vertical-align: inherit;">なっていることを思い出させてください。</font><font style="vertical-align: inherit;">これを修正するには2つの方法があります。</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼のメソッドを呼び出し</font></font><code>makeKeyAndVisible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロパティを設定します</font></font><code>isHidden = false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目の方法は、に</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なり</font><font style="vertical-align: inherit;">たくないので適し</font><font style="vertical-align: inherit;">てい</font></font><code>keyWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これを念頭に置いて、</font></font><code>SplashAnimator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">実装します</font></font><code>animateAppearance()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateAppearance</span><span class="hljs-params">()</span></span> {<font></font>
        foregroundSplashWindow.isHidden = <span class="hljs-literal">false</span><font></font>
        <font></font>
        foregroundSplashViewController.textImageView.transform = <span class="hljs-type">CGAffineTransform</span>(translationX: <span class="hljs-number">0</span>, y: <span class="hljs-number">20</span>)
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.3</span>, animations: {
            <span class="hljs-keyword">self</span>.foregroundSplashViewController.logoImageView.transform = <span class="hljs-type">CGAffineTransform</span>(scaleX: <span class="hljs-number">88</span> / <span class="hljs-number">72</span>, y: <span class="hljs-number">88</span> / <span class="hljs-number">72</span>)
            <span class="hljs-keyword">self</span>.foregroundSplashViewController.textImageView.transform = .identity<font></font>
        })<font></font>
        <font></font>
        foregroundSplashViewController.textImageView.alpha = <span class="hljs-number">0</span>
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.15</span>, animations: {
            <span class="hljs-keyword">self</span>.foregroundSplashViewController.textImageView.alpha = <span class="hljs-number">1</span><font></font>
        })<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あなたのことは知りませんが、できるだけ早くプロジェクトを立ち上げて、何が起こったのか見てみたいです！</font><font style="vertical-align: inherit;">開い</font></font><code>AppDelegate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">てプロパティを追加し、</font></font><code>splashPresenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そのメソッドを呼び出すだけ</font></font><code>present</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">同時に、2秒後に呼び出して、</font></font><code>dismiss</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このファイルに戻らないようにします。</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> splashPresenter: <span class="hljs-type">SplashPresenter?</span> = <span class="hljs-type">SplashPresenter</span>()<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">application</span><span class="hljs-params">(<span class="hljs-number">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: <span class="hljs-keyword">Any</span>]?)</span></span> -&gt; <span class="hljs-type">Bool</span> {<font></font>
        splashPresenter?.present()<font></font>
<font></font>
        <span class="hljs-keyword">let</span> delay: <span class="hljs-type">TimeInterval</span> = <span class="hljs-number">2</span>
        <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + delay) {
            <span class="hljs-keyword">self</span>.splashPresenter?.dismiss { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
                <span class="hljs-keyword">self</span>?.splashPresenter = <span class="hljs-literal">nil</span><font></font>
            }<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スプラッシュを非表示にした後、オブジェクト自体はメモリから削除されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
やった、走れる！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tt/rq/fp/ttrqfpp-qx683tpuip5dk-6ga20.gif" width="300"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アニメーションを非表示にする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念なことに（または幸いにも）、10行のコードでは非表示のアニメーションに対応できません。</font><font style="vertical-align: inherit;">それでも回転して増加する貫通穴を作る必要があります！</font><font style="vertical-align: inherit;">「これはマスクでできる」と思ったなら、あなたは絶対に正しいです！</font><font style="vertical-align: inherit;">メインアプリケーションウィンドウに</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マスクを追加し</font></font><code>layer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます（特定のコントローラーにバインドする必要はありません）。</font><font style="vertical-align: inherit;">その</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下でさらにアクションが発生する</font><font style="vertical-align: inherit;">ため、すぐに実行し、同時に非表示に</font><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">animateDisappearance</span><span class="hljs-params">(completion: @escaping <span class="hljs-params">()</span></span></span> -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> window = <span class="hljs-type">UIApplication</span>.shared.delegate?.window, <span class="hljs-keyword">let</span> mainWindow = window <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">"Application doesn't have a window!"</span>)<font></font>
        }<font></font>
<font></font>
        foregroundSplashWindow.alpha = <span class="hljs-number">0</span><font></font>
<font></font>
        <span class="hljs-keyword">let</span> mask = <span class="hljs-type">CALayer</span>()<font></font>
        mask.frame = foregroundSplashViewController.logoImageView.frame<font></font>
        mask.contents = <span class="hljs-type">SplashViewController</span>.logoImageBig.cgImage<font></font>
        mainWindow.layer.mask = mask<font></font>
    }   </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、プロパティ</font></font><code>alpha</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を非</font></font><code>isHidden</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示にしたこと</font><font style="vertical-align: inherit;">に注意してください</font><font style="vertical-align: inherit;">（そうしないと、画面が点滅します）。</font><font style="vertical-align: inherit;">もう1つの興味深い点：このマスクはアニメーション中に増加するため、より高い解像度のロゴ（1024x1024など）を使用する必要があります。</font><font style="vertical-align: inherit;">だから私は追加しました</font></font><code>SplashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> logoImageBig: <span class="hljs-type">UIImage</span> = <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">"splash-logo-big"</span>)!</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何が起こったのか確認してください。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/l6/dd/ka/l6ddkai2i4t09lmwf4acyejc6o4.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は知っています、今はそれほど印象的に見えませんが、すべてが進んでいます。先に進みましょう！</font><font style="vertical-align: inherit;">特に注意を払うと、アニメーションの実行中にロゴがすぐに透明になるわけではなく、しばらくの間は透明になることに気づくでしょう。</font><font style="vertical-align: inherit;">これを行うには</font></font><code>mainWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、すべての上に</font><font style="vertical-align: inherit;">、フェードによって非表示になるロゴを</font></font><code>subviews</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加</font></font><code>imageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<pre><code class="swift hljs">        <span class="hljs-keyword">let</span> maskBackgroundView = <span class="hljs-type">UIImageView</span>(image: <span class="hljs-type">SplashViewController</span>.logoImageBig)<font></font>
        maskBackgroundView.frame = mask.frame<font></font>
        mainWindow.addSubview(maskBackgroundView)<font></font>
        mainWindow.bringSubviewToFront(maskBackgroundView)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、ロゴの形の穴があり、穴の下にロゴ自体があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vy/so/dc/vysodczh_epg4meys0hfghxtxgk.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、美しいグラデーションの背景とテキストの場所に戻ります。</font><font style="vertical-align: inherit;">これを行う方法はありますか？</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は：別のものを</font></font><code>UIWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下に</font><font style="vertical-align: inherit;">置き</font></font><code>mainWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（つまり、小さいものを</font></font><code>windowLevel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と呼びましょう</font></font><code>backgroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）、黒の背景の代わりにそれが表示されます。</font><font style="vertical-align: inherit;">そしてもちろん、</font></font><code>rootViewController'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼にはomがあり</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">彼</font></font><code>SplashViewContoller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">だけ</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">それを隠す必要</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">あり</font></font><code>logoImageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">これを行うには</font></font><code>SplashViewController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、プロパティを作成します。</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">var</span> logoIsHidden: <span class="hljs-type">Bool</span> = <span class="hljs-literal">false</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてメソッドに</font></font><code>viewDidLoad()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加</font><font style="vertical-align: inherit;">します</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">        logoImageView.isHidden = logoIsHidden</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ファイナライズ</font></font><code>SplashPresenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：メソッド</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">もう1つ追加します</font><font style="vertical-align: inherit;">。</font></font><code>splashViewController<i>(with textImage: UIImage?)</i></code><font style="vertical-align: inherit;"></font><code>logoIsHidden: Bool</code><font style="vertical-align: inherit;"></font><code>SplashViewController</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="swift hljs">splashViewController?.logoIsHidden = logoIsHidden</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それが作成された場合したがって、</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたは、このパラメータを渡す必要がある</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、とのために</font></font><code>backgroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-built_in">lazy</span> <span class="hljs-keyword">var</span> backgroundSplashWindow: <span class="hljs-type">UIWindow</span> = {
        <span class="hljs-keyword">let</span> splashViewController = <span class="hljs-keyword">self</span>.splashViewController(with: textImage, logoIsHidden: <span class="hljs-literal">true</span>)
        <span class="hljs-keyword">let</span> splashWindow = <span class="hljs-keyword">self</span>.splashWindow(windowLevel: .normal - <span class="hljs-number">1</span>, rootViewController: splashViewController)<font></font>
        <font></font>
        <span class="hljs-keyword">return</span> splashWindow<font></font>
    }()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、このオブジェクトをコンストラクターを介して</font></font><code>SplashAnimator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（同様に</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">に転送し、</font><font style="vertical-align: inherit;">そこにプロパティを追加する必要があります。</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">unowned</span> <span class="hljs-keyword">let</span> backgroundSplashWindow: <span class="hljs-type">UIWindow</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">unowned</span> <span class="hljs-keyword">let</span> backgroundSplashViewController: <span class="hljs-type">SplashViewController</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、黒の背景の代わりに、表示</font></font><code>foregroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する必要がある非表示の</font><font style="vertical-align: inherit;">直前に同じスプラッシュ画面が表示さ</font><font style="vertical-align: inherit;">れます</font></font><code>backgroundSplashWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="swift hljs">        backgroundSplashWindow.isHidden = <span class="hljs-literal">false</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
計画が成功したことを確認してください：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/z8/3o/m0z83orvkiokxp5wtqqopw690-w.png" width="300"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで最も興味深い部分は、非表示アニメーションです！</font><font style="vertical-align: inherit;">あなたがアニメーション化する必要があるので</font></font><code>CALayer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ありません</font></font><code>UIView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は助けを求めに向けます</font></font><code>CoreAnimation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">回転から始めましょう：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">addRotationAnimation</span><span class="hljs-params">(to layer: CALayer, duration: TimeInterval, delay: CFTimeInterval = <span class="hljs-number">0</span>)</span></span> {
        <span class="hljs-keyword">let</span> animation = <span class="hljs-type">CABasicAnimation</span>()<font></font>
        <font></font>
        <span class="hljs-keyword">let</span> tangent = layer.position.y / layer.position.x
        <span class="hljs-keyword">let</span> angle = -<span class="hljs-number">1</span> * atan(tangent)<font></font>
        <font></font>
        animation.beginTime = <span class="hljs-type">CACurrentMediaTime</span>() + delay<font></font>
        animation.duration = duration<font></font>
        animation.valueFunction = <span class="hljs-type">CAValueFunction</span>(name: <span class="hljs-type">CAValueFunctionName</span>.rotateZ)<font></font>
        animation.fromValue = <span class="hljs-number">0</span><font></font>
        animation.toValue = angle<font></font>
        animation.isRemovedOnCompletion = <span class="hljs-literal">false</span>
        animation.fillMode = <span class="hljs-type">CAMediaTimingFillMode</span>.forwards<font></font>
        <font></font>
        layer.add(animation, forKey: <span class="hljs-string">"transform"</span>)<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のように、回転角度は画面のサイズに基づいて計算されるため、すべてのデバイスのYulaは左上隅に回転します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロゴスケーリングアニメーション：</font></font><br>
<br>
<pre><code class="swift hljs">    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">addScalingAnimation</span><span class="hljs-params">(to layer: CALayer, duration: TimeInterval, delay: CFTimeInterval = <span class="hljs-number">0</span>)</span></span> {
        <span class="hljs-keyword">let</span> animation = <span class="hljs-type">CAKeyframeAnimation</span>(keyPath: <span class="hljs-string">"bounds"</span>)<font></font>
        <font></font>
        <span class="hljs-keyword">let</span> width = layer.frame.size.width
        <span class="hljs-keyword">let</span> height = layer.frame.size.height
        <span class="hljs-keyword">let</span> coefficient: <span class="hljs-type">CGFloat</span> = <span class="hljs-number">18</span> / <span class="hljs-number">667</span>
        <span class="hljs-keyword">let</span> finalScale = <span class="hljs-type">UIScreen</span>.main.bounds.height * coeficient
        <span class="hljs-keyword">let</span> scales = [<span class="hljs-number">1</span>, <span class="hljs-number">0.85</span>, finalScale]<font></font>
        <font></font>
        animation.beginTime = <span class="hljs-type">CACurrentMediaTime</span>() + delay<font></font>
        animation.duration = duration<font></font>
        animation.keyTimes = [<span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">1</span>]<font></font>
        animation.values = scales.<span class="hljs-built_in">map</span> { <span class="hljs-type">NSValue</span>(cgRect: <span class="hljs-type">CGRect</span>(x: <span class="hljs-number">0</span>, y: <span class="hljs-number">0</span>, width: width * $<span class="hljs-number">0</span>, height: height * $<span class="hljs-number">0</span>)) }<font></font>
        animation.timingFunctions = [<span class="hljs-type">CAMediaTimingFunction</span>(name: <span class="hljs-type">CAMediaTimingFunctionName</span>.easeInEaseOut),
                                     <span class="hljs-type">CAMediaTimingFunction</span>(name: <span class="hljs-type">CAMediaTimingFunctionName</span>.easeOut)]<font></font>
        animation.isRemovedOnCompletion = <span class="hljs-literal">false</span>
        animation.fillMode = <span class="hljs-type">CAMediaTimingFillMode</span>.forwards<font></font>
        <font></font>
        layer.add(animation, forKey: <span class="hljs-string">"scaling"</span>)<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
注意が必要</font></font><code>finalScale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。最終的なスケールも、画面のサイズに応じて（高さに比例して）計算されます。つまり、画面の高さが667ポイント（iPhone 6）の場合、Yulaは18倍に増えるはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、最初に、（配列</font></font><code>scales</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">およびの</font><font style="vertical-align: inherit;">2番目の要素に従って）わずかに減少します</font></font><code>keyTimes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。つまり、ある時点</font></font><code>0.2 * duration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code>duration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スケーリングアニメーションの合計期間）で、Yulaのスケールは0.85になります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちはすでにゴールラインにいます！このメソッドでは、</font></font><code>animateDisappearance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのアニメーション</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">開始します</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。1）メインウィンドウのスケーリング（</font></font><code>mainWindow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2）ロゴの回転、拡大縮小、消失（</font></font><code>maskBackgroundView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3）「穴」の回転、スケーリング（</font></font><code>mask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4）テキストの消失（</font></font><code>textImageView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br>
 <br>
<pre><code class="swift hljs">        <span class="hljs-type">CATransaction</span>.setCompletionBlock {<font></font>
            mainWindow.layer.mask = <span class="hljs-literal">nil</span><font></font>
            completion()<font></font>
        }<font></font>
<font></font>
        <span class="hljs-type">CATransaction</span>.begin()<font></font>
        <font></font>
        mainWindow.transform = <span class="hljs-type">CGAffineTransform</span>(scaleX: <span class="hljs-number">1.05</span>, y: <span class="hljs-number">1.05</span>)
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.6</span>, animations: {<font></font>
            mainWindow.transform = .identity<font></font>
        })<font></font>
        <font></font>
        [mask, maskBackgroundView.layer].forEach { layer <span class="hljs-keyword">in</span>
            addScalingAnimation(to: layer, duration: <span class="hljs-number">0.6</span>)<font></font>
            addRotationAnimation(to: layer, duration: <span class="hljs-number">0.6</span>)<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.1</span>, delay: <span class="hljs-number">0.1</span>, options: [], animations: {<font></font>
            maskBackgroundView.alpha = <span class="hljs-number">0</span>
        }) { <span class="hljs-number">_</span> <span class="hljs-keyword">in</span><font></font>
            maskBackgroundView.removeFromSuperview()<font></font>
        }<font></font>
        <font></font>
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.3</span>) {
            <span class="hljs-keyword">self</span>.backgroundSplashViewController.textImageView.alpha = <span class="hljs-number">0</span><font></font>
        }<font></font>
        <font></font>
        <span class="hljs-type">CATransaction</span>.commit()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以前</font></font><code>CATransaction</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はアニメーションを完成</font><font style="vertical-align: inherit;">させ</font><font style="vertical-align: inherit;">ていました。</font><font style="vertical-align: inherit;">この場合、</font></font><code>animationGroup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのアニメーションがで行われるわけではない</font><font style="vertical-align: inherit;">ので</font><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">より便利です</font></font><code>CAAnimation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/_a/0c/io_a0ccqkg672rhvlb52tluudgq.gif" width="300"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、出力では、アプリケーションの起動のコンテキスト（ディップリンク、プッシュ通知、通常の起動など）に依存しないコンポーネントが得られました。</font><font style="vertical-align: inherit;">とにかくアニメーションは正しく動作します！</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここからプロジェクトをダウンロードできます。</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja456380/index.html">ネットロジーのプログラミング学部のオープンデー</a></li>
<li><a href="../ja456382/index.html">フロントエンドでのコラボレーションと自動化。13校から学んだこと</a></li>
<li><a href="../ja456386/index.html">オーディオコンテンツの視覚化のためのオープンライブラリ</a></li>
<li><a href="../ja456388/index.html">PVS-Studioの診断開発チャート</a></li>
<li><a href="../ja456392/index.html">AWKおよびRを備えたParsim 25TB</a></li>
<li><a href="../ja456398/index.html">Vue-cliプラグイン、複雑なデータとプロパティベースのテストでの作業-Panda-Meetupフロントエンドの発表</a></li>
<li><a href="../ja456400/index.html">なぜ競争は詰め込みよりも優れている：私たちの学習ゲーミフィケーションの経験</a></li>
<li><a href="../ja456402/index.html">知恵の歯：プルプル</a></li>
<li><a href="../ja456404/index.html">ルーパー-スケッチプラグイン</a></li>
<li><a href="../ja456406/index.html">Zimbra Collaboration Suiteのボールト間でメールボックスを移行する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>