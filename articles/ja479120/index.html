<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚁 🕵🏿 🧑🏻‍🤝‍🧑🏻 投票率は失敗しました。AgentTeslaをきれいな水に持ち込みました。パート2 🖖🏽 👩🏻‍💻 🛕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="マルウェア分析に関する一連の記事を続けます。では最初の部分は、我々はイリヤPomerantsev、CERTグループ-IBでの悪質なコード分析の専門家は、欧州企業の一つからメールで受信したファイルの詳細な分析を実施し、発見したかについて話しましたAgentTeslaがスパイウェア。この記事では、Ily...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>投票率は失敗しました。AgentTeslaをきれいな水に持ち込みました。パート2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/479120/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vz/an/r5/vzanr5kxitvhd3zqrcdh1qhctjm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルウェア分析に関する一連の記事を続けます。では</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の部分は、我々はイリヤPomerantsev、CERTグループ-IBでの悪質なコード分析の専門家は、欧州企業の一つからメールで受信したファイルの詳細な分析を実施し、発見したかについて話しました</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AgentTeslaがスパイウェア</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この記事では、Ilyaがメインの</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AgentTesla</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モジュールの段階的分析の結果を</font><b><font style="vertical-align: inherit;">紹介し</font></b><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br>
<a name="habracut"></a><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agent Teslaは、合法的なキーロガー製品を装ってサービスとしてマルウェアとして配布されるモジュール型スパイソフトウェアです。</font><font style="vertical-align: inherit;">エージェントテスラは、ユーザー資格情報を抽出してサーバー上のブラウザー、電子メールクライアント、FTPクライアントに送信し、クリップボードデータを登録して、デバイスの画面をキャプチャできます。</font><font style="vertical-align: inherit;">分析時には、開発者の公式ウェブサイトは利用できませんでした。</font></font><br>
</blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定ファイル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の表に、使用されているサンプルで使用されている機能を示します。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></strong><br>
</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">値</font></font></strong><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeyLogger使用フラグ</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本当</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScreenLoggerを使用するためのフラグ</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">偽</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KeyLoggerログの送信間隔（分）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二十</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScreenLoggerログの送信間隔（分）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二十</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backspaceキーを処理するためのフラグ。</font><font style="vertical-align: inherit;">False-ログのみ。</font><font style="vertical-align: inherit;">True-前のキーを消去します</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">偽</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CnCと入力します。</font><font style="vertical-align: inherit;">オプション：smtp、webpanel、ftp</font></font><br>
</td>
<td>smtp<br>
</td>
</tr>
<tr>
<td>        «%filter_list%»<br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>  UAC <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>   <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>  CMD<br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>   «»<br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>    <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>    <br>
</td>
<td>true<br>
</td>
</tr>
<tr>
<td>   <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>  MSCONFIG<br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>     <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>   <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>        <br>
</td>
<td>%startupfolder% \\%insfolder%\\%insname%<br>
</td>
</tr>
<tr>
<td>   «»  «»      <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>      <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>      <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>   UAC <br>
</td>
<td>false<br>
</td>
</tr>
<tr>
<td>       <br>
</td>
<td>yyyy-MM-dd HH:mm:ss<br>
</td>
</tr>
<tr>
<td>     KeyLogger<br>
</td>
<td>true<br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムフィルタリングのタイプ。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1-プログラム名はウィンドウヘッダーで検索されます</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2-プログラム名はウィンドウプロセス名で検索されます</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムフィルター</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「Facebook」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「twitter」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「gmail」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「instagram」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「movie」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「skype」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「porn」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「hack」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「whatsapp」、</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「discord」</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムのメインモジュールを修正する</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対応するフラグが設定されている場合、メインモジュールは、システムで修正するためのパスとして、configで指定されたパスに沿ってコピーされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
構成の値に応じて、ファイルには「非表示」および「システム」の属性が与えられます。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自動起動は、2つのレジストリブランチによって提供されます。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKCU \ソフトウェア\ Microsoft \ Windows \ CurrentVersion \ Run \％insregname％</font></font></b></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \％insregname％</font></font></b></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ブートローダーは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegAsm</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プロセス</font><font style="vertical-align: inherit;">に</font><b><font style="vertical-align: inherit;">挿入</font></b><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">ため、メインモジュールの永続フラグを設定すると、非常に興味深い結果がもたらされます。</font><font style="vertical-align: inherit;">マルウェアは自身をコピーする代わりに、元の</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegAsm.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルをシステム</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">保護し</font><font style="vertical-align: inherit;">、その間に注入が行われました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/mx/in/a8mxinpopuoixolt4r7tiwulc70.png"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/9p/-f/ui/9p-fui42mv7y06i5ivacsyh2zqm.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＆Cとの相互作用</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用される方法に関係なく、ネットワークの相互作用は、</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checkip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [。] Amazonaws [。] Com /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> resourceを使用して被害者の外部IPを取得することから始まります</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
以下は、マルウェアで提供されるネットワーキング方法について説明しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェブパネル</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対話はHTTPプロトコルを介して行われます。</font><font style="vertical-align: inherit;">マルウェアは、次のヘッダーを持つPOSTリクエストを実行します。</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーエージェント：Mozilla / 5.0（Windows U Windows NT 6.1 ru rv：1.9.2.3）Gecko / 20100401 Firefox / 4.0（.NET CLR 3.5.30729）</font></font></b></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接続：キープアライブ</font></font></b></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content-Type：application / x-www-form-urlencoded</font></font></b></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サーバーアドレスは</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％PostURL％に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">設定されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">暗号化されたメッセージは、パラメーター</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"p"で</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">渡されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">暗号化メカニズムについては、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「暗号化アルゴリズム」（方法2）</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のセクションで説明してい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
送信されるメッセージは次のとおりです</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nclient = {8} \ nlink = {9} \ nusername = {10} \ npassword = {11} \ nscreen_link = {12} </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">type</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
パラメータ</font><font style="vertical-align: inherit;">はメッセージのタイプを示します。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lc/5l/yr/lc5lyrzbeie0jr9z-6dpzpylaze.jpeg"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hwid-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マザーボードのシリアル番号とプロセッサーIDの値からMD5ハッシュが書き込まれます。</font><font style="vertical-align: inherit;">ほとんどの場合、ユーザーIDとして使用されます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間は</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -現在の日付と時刻を送信するのに役立ちます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pcname- </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;ユーザー名&gt; / &lt;コンピューター名&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">として定義され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logdata-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログデータ。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
パスワードを送信する場合、メッセージは次のようになります</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nscreen_link = {8} \ n [passwords]</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
以下は、盗まれたデータの説明です</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ nclient [] = {0} \ nlink [] = {1} \ nusername [] = {2} \ npassword [] = {3}</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smtp</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対話はSMTPプロトコルを介して行われます。</font><font style="vertical-align: inherit;">送信されるメッセージはHTML形式です。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BODY</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">の形式は次のとおりです。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/vg/np/ghvgnpycvdbcsyyakmwjvfppnw4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
レターのタイトルの一般的な形式は、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;ユーザー名&gt; / &lt;コンピューター名&gt; &lt;コンテンツタイプ&gt;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">レターの内容と添付ファイルは暗号化されていません。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/x5/7c/5o/x57c5ojnqhgfpnec0jnsqix931c.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対話はftpプロトコルを介して行われます。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;コンテンツタイプ&gt; _ &lt;ユーザー</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名</font><b><font style="vertical-align: inherit;">&gt;-&lt;コンピュータ名&gt; _ &lt;日付と時刻&gt; .html</font></b><font style="vertical-align: inherit;">という名前のファイルが、指定したサーバーに転送されます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ファイルの内容は暗号化されていません。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/2n/wr/r-2nwryzwnv7voneopya8y5aazq.jpeg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">暗号化アルゴリズム</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、次の暗号化方式が使用されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法1</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドは、メインモジュールの文字列を暗号化するために使用されます。</font><font style="vertical-align: inherit;">暗号化には、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AES</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズムが</font><b><font style="vertical-align: inherit;">使用され</font></b><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
入力は6桁の10進数です。</font><font style="vertical-align: inherit;">その上で次の変換が実行されます</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。f（x）=（（（x &gt;&gt; 2-31059）^ 6380）-1363）&gt;&gt; 3</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
結果の値は、埋め込みデータ配列のインデックスです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列の各要素は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DWORD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シーケンス</font><font style="vertical-align: inherit;">です。</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DWORD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を組み合わせると</font><font style="vertical-align: inherit;">、バイトの配列が取得されます。最初の32バイトは暗号化キーで、その後に16バイトの初期化ベクトルが続き、残りのバイトは暗号化されたデータです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法2</font></font></h3><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3DES</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アルゴリズムは</font><font style="vertical-align: inherit;">、バイト単位のパディング（</font><b><font style="vertical-align: inherit;">PKCS7</font></b><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">で</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ECBモード</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">使用さ</font><font style="vertical-align: inherit;">れ</font><b><font style="vertical-align: inherit;">ます</font></b><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">
キーは</font><b><font style="vertical-align: inherit;">％urlkey％</font></b><font style="vertical-align: inherit;">パラメータ</font><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">指定されます</font><font style="vertical-align: inherit;">が、そのMD5ハッシュは暗号化に使用されます。</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">悪意のある機能</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
調査中のサンプルは、次のプログラムを使用して悪意のある機能を実装しています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キーロガー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WinAPI関数を使用して適切なVPOフラグを設定すると、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SetWindowsHookEx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">はキーボードのキーストロークイベントに独自のハンドラーを割り当てます。</font><font style="vertical-align: inherit;">ハンドラー関数は、アクティブウィンドウのタイトルを取得することから始まります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アプリケーションフィルタリングを実行するためのフラグが設定されている場合、指定したタイプに応じてフィルタリングが実行されます。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム名はウィンドウのヘッダーで検索されます</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラム名はウィンドウプロセス名で検索されます</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、次の形式のアクティブウィンドウに関する情報を含むレコードがログに追加されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bx/r0/cj/bxr0cj1srz9us2a4il4rwjfpoqo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、押されたキーに関する情報が記録されます。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キー</font></font></strong><br>
</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記録</font></font></strong><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バックスペース</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Backspaceキーを処理するフラグに応じて、False- </font></font><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{BACK}</font></font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
True-前のキーを消去します</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">キャップスロック</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{キャップスロック}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESC</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ESC}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページアップ</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ページアップ}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウン</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？darr;</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">削除</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{DEL}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆quot;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F5</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F5}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆amp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F10</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F10}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タブ</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{タブ}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆lt;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆gt;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スペース</font></font><br>
</td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F8</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F8}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F12</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F12}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F9</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F9}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alt + Tab</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ALT + TAB}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">終わり</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{終わり}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F4</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F4}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F2</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F2}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CTRL</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{CTRL}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F6</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F6}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正しい</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">？rarr;</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アップ</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆uarr;</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F1</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F1}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">左</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆larr;</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ページダウン</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ページダウン}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インサート</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{インサート}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">勝つ</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{勝つ}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Numlock</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{NumLock}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F11</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F11}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F3</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F3}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ホーム</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ホーム}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">入る</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{入る}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alt + F4</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ALT + F4}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F7</font></font><br>
</td>
<td><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{F7}</font></font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別の鍵</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CapsLockキーとShiftキーの位置に応じて大文字または小文字</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一定の頻度で、収集されたログがサーバーに送信されます。</font><font style="vertical-align: inherit;">転送が失敗した場合、ログは次</font><font style="vertical-align: inherit;">の形式で</font><font style="vertical-align: inherit;">ファイル</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％TEMP％\\ log.tmp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">保存され</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xn/pz/eb/xnpzeba3_y7ulwz0wesksvlspkg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイマーがオフになると、ファイルがサーバーに転送されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリーンロガー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指定された周波数を使用すると、マルウェアは、内スクリーンショット作成</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のJPEGの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォーマット</font><font style="vertical-align: inherit;">と</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">品質の</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 50の値を、ファイルに保存します</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％APPDATA％\\ &lt;10文字のランダムシーケンス&gt; .JPG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">転送後、ファイルは削除されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリップボードロガー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
対応するフラグが設定されている場合、インターセプトされたテキストは以下の表に従って置き換えられます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/wc/y7/xhwcy7r4g5duormggz-texkxemi.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
その後、テキストがログに挿入されます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/6l/2p/ft6l2pmpzecwtkh0hhgbblet30q.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PasswordStealer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マルウェアは、次のアプリケーションからパスワードをダウンロードできます。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブラウザー</font></font></strong><br>
</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メールクライアント</font></font></strong><br>
</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTPクライアント</font></font></strong><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クロム</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">見通し</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Filezilla</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firefox</font></font><br>
</td>
<td>Thunderbird<br>
</td>
<td>WS_FTP<br>
</td>
</tr>
<tr>
<td>IE/Edge<br>
</td>
<td>Foxmail<br>
</td>
<td>WinSCP<br>
</td>
</tr>
<tr>
<td>Safari<br>
</td>
<td>Opera Mail<br>
</td>
<td>CoreFTP<br>
</td>
</tr>
<tr>
<td>Opera Browser<br>
</td>
<td>IncrediMail<br>
</td>
<td>FTP Navigator<br>
</td>
</tr>
<tr>
<td>Yandex<br>
</td>
<td>Pocomail<br>
</td>
<td>FlashFXP<br>
</td>
</tr>
<tr>
<td>Comodo<br>
</td>
<td>Eudora<br>
</td>
<td>SmartFTP<br>
</td>
</tr>
<tr>
<td>ChromePlus<br>
</td>
<td>TheBat<br>
</td>
<td>FTPCommander<br>
</td>
</tr>
<tr>
<td>Chromium<br>
</td>
<td>Postbox<br>
</td>
<td></td>
</tr>
<tr>
<td>Torch<br>
</td>
<td>ClawsMail<br>
</td>
<td></td>
</tr>
<tr>
<td>7Star<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Amigo<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>BraveSoftware<br>
</td>
<td><strong>Jabber </strong><br>
</td>
<td><strong>VPN </strong><br>
</td>
</tr>
<tr>
<td>CentBrowser<br>
</td>
<td>Psi/Psi+<br>
</td>
<td>Open VPN<br>
</td>
</tr>
<tr>
<td>Chedot<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>CocCoc<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Elements Browser<br>
</td>
<td><strong> </strong><br>
</td>
<td></td>
</tr>
<tr>
<td>Epic Privacy Browser<br>
</td>
<td>Internet Download Manager<br>
</td>
<td></td>
</tr>
<tr>
<td>Kometa<br>
</td>
<td>JDownloader<br>
</td>
<td></td>
</tr>
<tr>
<td>Orbitum<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Sputnik<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>uCozMedia<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Vivaldi<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SeaMonkey<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Flock Browser<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>UC Browser<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>BlackHawk<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>CyberFox<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>K-Meleon<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>IceCat<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>IceDragon<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>PaleMoon<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>WaterFox<br>
</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Falkon Browser<br>
</td>
<td></td>
<td></td>
</tr>
</tbody></table></div><br>
<br>
<h2>  <br>
</h2><br>
<ul>
<li>  <b>Sleep</b>.      </li>
<li>  <b>Zone.Identifier</b>.       </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメータ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％filter_list％</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、マルウェアが1秒の間隔で完了するプロセスのリストを設定します</font></font></li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">UACを</font></b><font style="vertical-align: inherit;">無効にする</font></font><b><font style="vertical-align: inherit;"></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タスクマネージャを無効にする</font></font></li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">CMDを</font></b><font style="vertical-align: inherit;">無効にする</font></font><b><font style="vertical-align: inherit;"></font></b></li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">実行</font></b><font style="vertical-align: inherit;">ウィンドウを無効にする</font></font><b><font style="vertical-align: inherit;"></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コントロールパネルを無効にする</font></font></li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">RegEditツールの</font></b><font style="vertical-align: inherit;">無効</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">化</font></font></b></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムの復元ポイントを無効にする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エクスプローラーのコンテキストメニューを無効にする</font></font></li>
<li><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">msconfigの</font></b><font style="vertical-align: inherit;">無効</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">化</font></font></b></li>
<li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UAC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイパス</font><font style="vertical-align: inherit;">：</font></font><br>
</li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メインモジュールの非アクティブな機能</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メインモジュールの分析中に、ネットワーク全体に広がり、マウスの位置を追跡する機能が特定されました。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ワーム </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のストリームでは、リムーバブルメディア接続イベントが監視されます。</font><font style="vertical-align: inherit;">接続すると</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scr.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">という名前</font><font style="vertical-align: inherit;">の</font><b><font style="vertical-align: inherit;">マルウェア</font></b><font style="vertical-align: inherit;">がファイルシステムのルートにコピーされ</font><font style="vertical-align: inherit;">、拡張子が</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lnkの</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font><b><font style="vertical-align: inherit;">が検索され</font></b><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">各</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lnk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">のコマンドは</font><font style="vertical-align: inherit;">、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmd.exe / c start scr.exe＆start &lt;元のコマンド&gt;＆exitに変わります</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メディアのルートの各ディレクトリには</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hidden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性が与えられ、</font><font style="vertical-align: inherit;">隠しディレクトリの名前とコマンド</font><b><font style="vertical-align: inherit;">cmd.exe / c start scr.exe＆explorer / root、\ "％CD％&lt;DIRECTORY NAME&gt; \"＆exitで</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lnk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拡張子を持つファイルが</font><b><font style="vertical-align: inherit;">作成され</font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マウストラッカー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
傍受方法は、キーボードで使用される方法と似ています。</font><font style="vertical-align: inherit;">この機能はまだ開発中です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルアクティビティ</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕方</font></font></strong><br>
</td>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></strong><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ temp.tmp</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UACをバイパスする試みのカウンターが含まれています</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％startupfolder％\％insfolder％\％insname％</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HPEシステムに統合する方法</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ tmpG \ {ミリ秒単位の現在の時間} .tmp</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メインモジュールをバックアップするパス</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ log.tmp</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログファイル</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％AppData％\ {10文字の任意のシーケンス} .jpeg</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリーンショット</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Users \ Public \ {10文字の任意のシーケンス} .vbs</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブートローダーがシステムを閉じるために使用できるvbsファイルへのパス</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ {任意のフォルダ名} \ {ファイル名}</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブートローダーがシステムにドッキングするために使用するパス</font></font><br>
</td>
</tr>
</tbody></table></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">侵入者プロファイル</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
「有線」認証データのおかげで、コマンドセンターにアクセスできました。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/q0/eb/nqq0ebtlfljriwj4m-97hm7-aww.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これにより、攻撃者の最終的なメールを識別することができました：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">junaid [。] In *** @ gmail [。] Com</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コマンドセンターのドメイン名は</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sg *** @ gmail [。] Comに</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">登録されてい</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃で使用されたマルウェアの詳細な分析の過程で、その機能を確立し、このケースに関連する侵害インジケータの最も包括的なリストを取得することができました。</font><font style="vertical-align: inherit;">malvariのネットワーク相互作用のメカニズムを理解することで、情報保護ツールの操作の調整に関する推奨事項を提供し、安定したIDSルールを作成することが可能になりました。</font><b><font style="vertical-align: inherit;">AgentTesla</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の主な危険性</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataStealerのように、そのタスクを実行するために、システムに固定したり、制御コマンドを待つ必要はありません。マシンに入ると、すぐに個人情報の収集を開始し、それをCnCに送信します。このような攻撃的な動作は暗号技術者の動作に多少似ていますが、唯一の違いは、後者はネットワーク接続を必要としないことです。マルウェア自体から感染したシステムを駆除した後、このファミリーとの衝突が発生した場合、少なくとも上記のアプリケーションのいずれかに理論的に保存できるすべてのパスワードを変更する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
先を見据えて、</font><b><font style="vertical-align: inherit;">AgentTeslaを</font></b><font style="vertical-align: inherit;">送信するサイバー犯罪者が</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">非常に頻繁にブートローダーを変更します。</font><font style="vertical-align: inherit;">これにより、攻撃時に静的スキャナーやヒューリスティックアナライザーに気付かれずに済みます。</font><font style="vertical-align: inherit;">また、このファミリはすぐに活動を開始する傾向があるため、システムモニタは役に立たなくなります。</font><font style="vertical-align: inherit;">AgentTeslaを処理する最良の方法は、サンドボックスでの予備分析です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このシリーズの3番目の記事では、</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AgentTesla</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で</font><font style="vertical-align: inherit;">使用される他のブートローダーを</font><b><font style="vertical-align: inherit;">調べ</font></b><font style="vertical-align: inherit;">、それらの半自動解凍のプロセスについても学習します。</font><font style="vertical-align: inherit;">お見逃しなく！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュ</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA1</font></font></strong><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A8C2765B3D655BA23886D663D22BDD8EF6E8E894</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8010CC2AF398F9F951555F7D481CE13DF60BBECF</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">79B445DE923C92BF378B19D12A309C0E9C5851BF</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15839B7AB0417FA35F2858722F0BD47BDF840D62 </font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD </font></font><br>
 </td>
</tr>
</tbody></table></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C＆C</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></strong><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sina-c0m [。] icu</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smtp [。] sina-c0m [。] icu</font></font><br>
 </td>
</tr>
</tbody></table></div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regkey</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">レジストリ</font></font></strong><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKCU \ソフトウェア\ Microsoft \ Windows \ CurrentVersion \ Run \ {スクリプト名}</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKCU \ソフトウェア\ Microsoft \ Windows \ CurrentVersion \ Run \％insregname％</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \％insregname％</font></font><br>
 </td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ミューテックス</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
指標なし。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル</font></font></h3><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルアクティビティ</font></font></strong><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ temp.tmp</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％startupfolder％\％insfolder％\％insname％</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ tmpG \ {ミリ秒単位の現在の時間} .tmp</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ log.tmp</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％AppData％\ {10文字の任意のシーケンス} .jpeg</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C：\ Users \ Public \ {10文字の任意のシーケンス} .vbs</font></font><br>
 </td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％Temp％\ {任意のフォルダ名} \ {ファイル名}</font></font><br>
 </td>
</tr>
</tbody></table></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプル情報</font></font></h2><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名前</font></font></strong><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">わからない</font></font><br>
 </td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MD5</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F7722DD8660B261EA13B710062B59C43</font></font><br>
 </td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA1</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15839B7AB0417FA35F2858722F0BD47BDF840D62</font></font><br>
 </td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA256</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">41DC0D5459F25E2FDCF8797948A7B315D3CB0753 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
98D808D1772CACCC726AF6E9</font></font><br>
 </td>
</tr>
<tr>
<td> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE（.NET）</font></font><br>
 </td>
</tr>
<tr>
<td> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズ</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">327680</font></font><br>
 </td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">元の名前</font></font></strong><br>
 </td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AZZRIDKGGSLTYFUBCCRRCUMRKTOXFVPDKGAGPUZI_20190701133545943.exe</font></font><br>
 </td>
</tr>
<tr>
<td><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日付スタンプ</font></font></strong><br>
 </td>
<td>01.07.2019<br>
 </td>
</tr>
<tr>
<td> <strong>Compiler</strong><br>
 </td>
<td>VB.NET<br>
 </td>
</tr>
</tbody></table></div><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td> <strong>Name</strong><br>
</td>
<td>IELibrary.dll<br>
 </td>
</tr>
<tr>
<td> <strong>MD5</strong><br>
 </td>
<td>BFB160A89F4A607A60464631ED3ED9FD<br>
 </td>
</tr>
<tr>
<td> <strong>SHA1</strong><br>
 </td>
<td>1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD<br>
 </td>
</tr>
<tr>
<td> <strong>SHA256</strong><br>
 </td>
<td>D55800A825792F55999ABDAD199DFA54F3184417<br>
215A298910F2C12CD9CC31EE<br>
 </td>
</tr>
<tr>
<td> <strong>Type</strong><br>
 </td>
<td>PE (.NET DLL)<br>
 </td>
</tr>
<tr>
<td> <strong>Size</strong><br>
 </td>
<td>16896<br>
 </td>
</tr>
<tr>
<td><strong>OrginalName</strong><br>
 </td>
<td>IELibrary.dll<br>
 </td>
</tr>
<tr>
<td><strong>DateStamp</strong><br>
</td>
<td>11.10.2016<br>
 </td>
</tr>
<tr>
<td> <strong>Compiler</strong><br>
 </td>
<td>Microsoft Linker(48.0*)<br>
 </td>
</tr>
</tbody></table></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja479100/index.html">フロントエンド道場：開発者スキルをトレーニングするためのプロジェクト（新しい5つ+古い43つ）</a></li>
<li><a href="../ja479102/index.html">Yandex.Mapsの知識、またはドキュメントがどれだけ好きか</a></li>
<li><a href="../ja479106/index.html">手品の費用はいくらですか</a></li>
<li><a href="../ja479108/index.html">騎士の生活-RPG要素を備えたオンラインアリーナ</a></li>
<li><a href="../ja479116/index.html">検索での表示回数Y.直接：クリックあたり1.5倍多く支払う理由</a></li>
<li><a href="../ja479122/index.html">ペットプロジェクトを開始してメリットを得ない方法</a></li>
<li><a href="../ja479124/index.html">[インフォグラフィック] SFにおける人工知能</a></li>
<li><a href="../ja479126/index.html">モバイル開発におけるPython</a></li>
<li><a href="../ja479128/index.html">空港医療サービスはどのように機能しますか</a></li>
<li><a href="../ja479132/index.html">1Cモバイルプラットフォームの外部コンポーネント（BroadcastReceiver）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>