<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤹🏼 👑 🕠 Code analysis demo Second Reality 🥪 🤟🏻 🦋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On July 23, 2013, the source code for the Second Reality demo (1993) was published . Like many, I was eager to look at the insides of the demo that ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Code analysis demo Second Reality</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/501030/"><div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/second_reality.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On July 23, 2013, the </font><font style="vertical-align: inherit;">source code for the Second Reality demo (1993) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">was published</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Like many, I was eager to look at the insides of the demo that has inspired us so much over the years. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I expected to see monolithic chaos from assembler, but instead of it, to my surprise, I discovered a complex architecture that gracefully combines several languages. </font><font style="vertical-align: inherit;">I've never seen such a code before, perfectly representing two integral aspects of developing a demo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teamwork.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obfuscation.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As usual, I formed an article for my notes: I hope this saves someone a few hours, and perhaps inspires others to read more source code and become more experienced engineers.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1: Introduction</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Before embarking on the code, I’ll give a link to capture the legendary demo in HD video (Michael Hut). </font><font style="vertical-align: inherit;">Today, this is the only way to fully evaluate the demo without graphical glitches (even DOSBox cannot launch it correctly).</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/KTjnt_WSJu8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First contact with code</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The source code is posted on GitHub. </font><font style="vertical-align: inherit;">Just enter one command </font></font><code>git</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<blockquote><code> git clone git@github.com:mtuomi/SecondReality.git</code></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At first, the content is confusing: 32 folders and a mysterious </font></font><code>U2.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one that does not start in DosBox.</font></font><br>
<br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/first_contact.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The demo had the working title “Unreal 2” (the first “Unreal” was the previous Future Crew demo, released for the first Assembly in 1992). </font><font style="vertical-align: inherit;">And only during the development process the name was changed to “Second Reality”. </font><font style="vertical-align: inherit;">This explains the file name “U2.EXE”, but not why the file does not work ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you run </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CLOC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we will get interesting metrics:</font></font><br>
<br>
<pre>    -------------------------------------------------------------------------------<font></font>
                                                   <font></font>
    -------------------------------------------------------------------------------<font></font>
    Assembly                        99           3029           1947          33350<font></font>
    C++                            121           1977            915          24551<font></font>
    C/C++ Header                     8             86            240            654<font></font>
    make                            17            159             25            294<font></font>
    DOS Batch                       71              3              1            253<font></font>
    -------------------------------------------------------------------------------<font></font>
    SUM:                           316           5254           3128          59102<font></font>
    -------------------------------------------------------------------------------<font></font>
</pre><br>
<ul>
<li>   «»  50% .</li>
<li>      Doom.</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It has seventeen makefiles. </font><font style="vertical-align: inherit;">Why not just one?</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch demo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It's hard to figure it out, but the released demo can be launched in DosBox: you need to rename it </font></font><code>U2.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and run it from the right place. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When I learned about the inner workings of the code, it began to look very logical:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">        CD MAIN</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        MOVE U2.EXE DATA / SECOND.EXE</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        CD DATA</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        SECOND.EXE</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And voila!</font></font><br>
<br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/demo.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the 90s, demos were mostly distributed on floppy disks. </font><font style="vertical-align: inherit;">After unpacking, it was necessary to install two large files: </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>REALITY.FC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    . </font><font style="vertical-align: inherit;">&lt;DIR&gt; 08/08/2013 16:40</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    .. &lt;DIR&gt; 08/01/2013 16:40</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    FCINFO10 TXT 48,462 04-10-1993 11:48</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    FILE_ID DIZ 378 04-10-1993 11:30</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    README 1ST 4.222 04-10-1993 12:59</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    REALITY FC 992.188 07-10-1993 12:59 </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    SECOND EXE 1,451,093 07-10-1993 13:35</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        5 Files (s) 2.496,343 Bytes.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        2 Dir (s) 262,111,744 Bytes free.</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Based on my experience in game development, I always expect that the whole picture should look like this:</font></font><br>
<br>
<ul>
<li><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: engine with all the effects in an executable file.</font></font></li>
<li><code>REALITY.FC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Assets (music, sound effects, images) in a proprietary / encrypted format a la </font></font><code>WAD</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Doom.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But after reading it, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>MAIN/PACK.C</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I found that I was mistaken: the Second Reality engine is just a Loader and an Interrupt server (called DIS). </font><font style="vertical-align: inherit;">Each scene (also called “PART”) demo is a fully functional DOS executable. </font><font style="vertical-align: inherit;">Each part is loaded by the Loader loader and launched one after another. </font><font style="vertical-align: inherit;">Parts are stored in encrypted form at the end </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/architecture.png"></div><br>
<ul>
<li><code>REALITY.FC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contains two musical compositions played during the demo (for filling obfuscation added filling and marker at the beginning).</font></font></li>
<li><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contains bootloader and Demo Interrupt Server (DIS).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the end </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, 32 parts (PART) of the demo are added as executable DOS files (encrypted).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Such an architecture provides many advantages:</font></font><br>
<br>
<ul>
<li>     :         PART  ,       <code>_start</code>       (450 ).</li>
<li>  EXE   <code>SECOND.EXE</code>        -.</li>
<li> : Loader  DIS    20 . DOS    .</li>
<li>  :   PART     PART     . </li>
<li>   / :    ,  PART      (  ),   :   EXE     ,    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Any language can be used for PART programming: in the code we find C, Assembly ... and Pascal.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommended Reading</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The three pillars for understanding Second Reality source code are VGA, assembler, and PC architecture (PIC and PIT programming). </font><font style="vertical-align: inherit;">Here are some incredibly useful links:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VGA Architecture: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeVGA Project</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Art of Assembly</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (especially </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chapter 17</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on interruptions and ISRs).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programming PIT 8254</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since the source code is full of “FAR” and “NEAR” pointers, it will be useful to read </font><font style="vertical-align: inherit;">Intel's </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basic Architecture Documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in particular Chapter 4.3 on pointer data types.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comprehensive articles by Michael Abrash from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Graphic Programming Black Book</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chapter 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : (Zen Timer and PIT), </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chapter 24</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : VGA tour, Chapters </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">47</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">48</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">49</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : (Mode X).</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 2: Second Reality Engine</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As discussed in Part 1, the foundation of Second Reality consists of:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The bootloader as a DOS executable.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memory manager (simple stack pool)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo Interrupt Server (DIS).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this part I will give recommendations to programmers who want to read the engine and bootloader (DIS will be discussed in the next part).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Engine code</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The engine code is 100% ASM, but it is very well written and fairly well documented:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>MAIN/U2.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (core).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>MAIN/U2A.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (utilities).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>MAIN/VMODE.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (VGA procedures).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In pseudo-code it can be written like this:</font></font><br>
<br>
<pre><code class="cpp hljs">    exemus  db <span class="hljs-string">'STARTMUS.EXE'</span>,<span class="hljs-number">0</span>
    exe0    db <span class="hljs-string">'START.EXE'</span>,<span class="hljs-number">0</span><font></font>
    ...<font></font>
    exe23   db <span class="hljs-string">'ENDSCRL.EXE'</span>,<span class="hljs-number">0</span><font></font>
<font></font>
    start:<font></font>
       cli                         ; Disable all interrupts<font></font>
       mov     ah,<span class="hljs-number">4</span>ah              ; Deallocate all memory<font></font>
       call checkall               ; Check <span class="hljs-keyword">for</span> <span class="hljs-number">570</span>,<span class="hljs-number">000</span> bytes of mem, <span class="hljs-number">386</span> CPU <span class="hljs-keyword">and</span> VGA<font></font>
       call file_getexepath        <font></font>
       call dis_setint             ; Install Demo Interrupt Server on Interrupt <span class="hljs-number">0f</span>ch<font></font>
       call file_initpacking       ; <span class="hljs-function">Check exe <span class="hljs-title">signature</span> <span class="hljs-params">(no tempering)</span> !
       call file_setint            </span>; <span class="hljs-function">Replace DOS <span class="hljs-title">routines</span> <span class="hljs-params">(only OPENFILE, SEEK <span class="hljs-keyword">and</span> READ)</span> on Interrupt 021h
       call flushkbd               </span>; Flush the keyboard buffer<font></font>
       <font></font>
       call  checkcmdline          ; check/process commandline<font></font>
<font></font>
       ;======== Here we go! ========<font></font>
       call vmode_init             ; <span class="hljs-function">Init <span class="hljs-title">VGA</span> <span class="hljs-params">(<span class="hljs-keyword">not</span> necessarly Mode13h <span class="hljs-keyword">or</span> ModeX)</span>, each PARTs had its own resolution

       mov si,OFFSET exe0
       call executehigh            </span>; loaded to high in memory. Used <span class="hljs-keyword">for</span> loading music loaders <span class="hljs-keyword">and</span> stuff.<font></font>
   <font></font>
       call  _zinit ; Start music<font></font>
       call  restartmus<font></font>
<font></font>
       mov   si,OFFSET exe1     ;Parameter <span class="hljs-keyword">for</span> partexecute: Offset to exec name<font></font>
       call  partexecute<font></font>
       ; Execute all parts until exe23<font></font>
<font></font>
       call fademusic<font></font>
       ;======== And Done! (<span class="hljs-keyword">or</span> fatal <span class="hljs-built_in">exit</span>) ========<font></font>
<font></font>
    fatalexit:<font></font>
       mov cs:notextmode,<span class="hljs-number">0</span>
       call vmode_deinit</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
All steps are pretty easy to read:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set DIS interrupt server as interrupt </font></font><code>0fch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Replacing DOS system calls by interruption </font></font><code>021h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(for more details, see the section </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Dev and Prod Modes"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download music to a sound card via EMS memory.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running music.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Performing each part of the demo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Done!</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Details of the procedures </font></font><code>execute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="cpp hljs"> execute:<font></font>
      cld<font></font>
      call  openfile ; Open the DOS executable <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> PART<font></font>
      call  loadexe  ; loads the specified exe file to memory, does relocations <span class="hljs-keyword">and</span> creates psp<font></font>
      call  closefile<font></font>
      call  runexe   ;runs the exe file loaded previously with loadexe.<font></font>
                     ; returns after exe executed, <span class="hljs-keyword">and</span> frees the memory<font></font>
                     ; it uses.</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memory manager</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There were many legends that Second Reality uses a complex memory manager via MMU; there were no traces in the engine. </font><font style="vertical-align: inherit;">The memory management is actually transferred to DOS: the engine starts by </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">freeing up all RAM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and then distributing it </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on request</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The only tricky trick is the ability to allocate RAM from the end of the heap: it is done using the malloc DOS return value </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when too much RAM is requested</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 3: DIS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demo Interrupt Server (DIS) provides a wide range of services for each PART: from data exchange between different PART to synchronization with VGA.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIS Services</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At run-time, PART, the DIS server provides services to it. </font><font style="vertical-align: inherit;">A list of features can be found at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>DIS/DIS.H</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The most important services:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exchange between different PART ( </font></font><code>dis_msgarea</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">): DIS provides three buffers of 64 bytes </font><font style="vertical-align: inherit;">each </font><font style="vertical-align: inherit;">so that PART can receive parameters from the loader of the previous PART.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emulation Copper ( </font></font><code>dis_setcopper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">): Amiga Copper simulator that allows you to perform operations that are switched by the state of VGA.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dev / Prod ( </font></font><code>dis_indemo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">mode </font><font style="vertical-align: inherit;">: allows the PART to know that it is running in DEV mode (which means it must initialize the video) or launched from the bootloader in PROD mode.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VGA Frame Count ( </font></font><code>_dis_getmframe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Waiting for VGA backstop ( </font></font><code>dis_waitb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo Interrupt Server Code</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The DIS source code is also 100% ASM ... and quite well commented:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>DIS/DIS.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(interrupt handler set to int </font></font><code>0fch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>DIS/DISINT.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (DIS procedures themselves).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since Second Reality is also partially written in C, the code has an interface for C: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>DIS/DIS.H</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>DIS/DISC.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How it works</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DIS is set as an interrupt handler for programmatic int </font></font><code>0fch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The great thing about it is that it can run internally </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when the demo is running, or as a resident program ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TSR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) in Dev mode. </font><font style="vertical-align: inherit;">This flexibility allows you to individually test different PART demos during development:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">                          // Let's pretend we are a FC developer and want to start the STAR part directly.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \&gt; CD DDSTARS            </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \ DDSTARS&gt; K</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  ERROR: DIS not loaded. </font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                          // Oops, the PART could not find the DIS at int 0fch.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \ DDSTARS&gt; CD .. \ DIS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \ DIS&gt; DIS</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  Demo Int Server (DIS) V1.0 Copyright (C) 1993 The Future Crew</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  BETA VERSION - Compiled: 07/26/93 03:15:53 </font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  Installed (int fc).</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  NOTE: This DIS server doesn't support copper or music synchronization!</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                          // DIS is installed, let's try again.</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \ DIS&gt; CD ../DDSTARS</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  C: \ DDSTARS&gt; K</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And voila!</font></font><br>
<br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/DDSTARTS.EXE.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copper</font></font></h3> <br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/copper_emu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Copper" is the coprocessor that the developers of the demo for Amiga loved. </font><font style="vertical-align: inherit;">It was part of the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Original Chip Set</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and allowed you to execute a programmable stream of commands synchronized with video equipment. </font><font style="vertical-align: inherit;">There was no such coprocessor on the PC, and Future Crew had to write a Copper simulator running inside DIS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The FC team used the 8254-PIT and 8259-PIC PC hardware chipsets to simulate Copper. </font><font style="vertical-align: inherit;">She created a system </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">synchronized with the VGA frequency</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , capable of starting procedures in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">three places of the vertical backward beam</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Place 0: after turning on the display (approximately on scan line 25)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Place 1: immediately after the reverse beam sweep (IT IS POSSIBLE TO AVOID IT POSSIBLE)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Place 2: in the reverse beam of the scan beam</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How this is done can be read in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><code>MAIN/COPPER.ASM</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(and see in the diagram below):</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The timer of the 8254 chip is configured to trigger IRQ0 with the desired frequency.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The 8h interrupt handler (which is called by the 8259 PIC after receiving IRQ0) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> replaced with a procedure here </font></font><code>intti8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note: DIS frame count service is actually provided by copper simulator.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 4: Dev and Prod Modes</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reading the source code of Second Reality, you are most struck by how much attention the team paid to the seamless switch from DEV to PROD.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Development Mode</font></font></h3><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/sc_dev.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Development mode, each component of the demo was a separate executable file.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIS was loaded into the resident TSR and accessed through an interrupt </font></font><code>0cfh</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The bootloader caused a DOS interrupt </font></font><code>21h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to open, read, search, and close files.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This DEV configuration has the following advantages:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each coder and artist could work on the executable file and test it separately, without affecting the rest of the team.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The full demo at any time could be tested using a small one </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(without adding all the EXEs to the end). </font><font style="vertical-align: inherit;">The executable of each PART was loaded using a DOS interrupt </font></font><code>021h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from a separate file.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Production (demo mode)</font></font></h3><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/sc_prod.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Production mode, the small </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(containing the bootloader), DIS, and parts of the demo as separate EXEs were combined into one thick one </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access to DIS was still done via interrupt </font></font><code>0fch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The DOS 21h interrupt API was patched by its own Future Crew routines, which open files from the end of a large file </font></font><code>SECOND.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This PROD configuration has an advantage in terms of load time and protection against reverse engineering ... but most importantly, from the point of view of programming or loading PART, NOTHING changes when switching from DEV to PROD.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 5: Separate PART</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Each of the Second Reality visual effects is a fully functional DOS executable. </font><font style="vertical-align: inherit;">They are called PART and all of them 23. Such an architectural solution allowed for rapid prototyping, parallel development (since FC most likely did not have version control tools) and free choice of languages ​​(ASM, C, and even Pascal are found in the source).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separate PART</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A list of all PART / EXEs can be found in the engine source code: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U2.ASM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Here is a more convenient short description of all 23 parts (with the location of the source code, although the names can be very confusing):</font></font><br>
<br>
<div class="scrollable-table"><table cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Title</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Executable file</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coder</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source</font></font></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STARTMUS.EXE</font></font></td>
<td></td>
<td></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAIN / STARTMUS.C</font></font></a></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">START.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/02-START_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">START / MAIN.c</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hidden part</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DDSTARS.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/03-DDSTARS_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DDSTARS / STARS.ASM</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alkutekstit i</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALKU.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/04-ALKU_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALKU / MAIN.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alkutekstit II</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U2A.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/05-U2A_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VISU / C / CPLAY.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alkutekstit III</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAM.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUG / WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/06-PAM_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAM /</font></font></a></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEGLOGO.EXE</font></font></td>
<td></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/07-BEGLOGO_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BEG / BEG.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Glenz</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLENZ.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/08-GLENZ_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLENZ /</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dottitunneli</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TUNNELI.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUG</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/09-TUNNELI_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TUNNELI / TUN10.PAS</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Techno</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TECHNO.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/10-TECHNO_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TECHNO / KOEA.ASM</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panicfake</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PANICEND.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/11-PANICEND_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panic</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vuori-scroll</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MNTSCRL.EXE</font></font></td>
<td></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/12-MNTSCRL_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FOREST / READ2.PAS</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desert dream stars</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DDSTARS.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUG</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/13-DDSTARS_thumb.png"></a></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lens</font></font></td>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/14-LNS&amp;ZOOM_thumb.png"></a></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rotazoomer</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LNS &amp; ZOOM.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/14-LNS&amp;ZOOM-2_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LENS /</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plasma</font></font></td>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/15-PLZPART_thumb.png"></a></td>
<td></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plasmacube</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLZPART.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/15-PLZPART-2_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLZPART /</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MiniVectorBalls</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MINVBALL.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/16-MINVBALL_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DOTS /</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peilipalloscroll</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAYSCRL.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRUG</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/17-RAYSCRL_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WATER / DEMO.PAS</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3D sinusfield</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3DSINFLD.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/18-3DSINFLD_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMAN / DOLOOP.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jellypic</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPLOGO.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/19-JPLOGO_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPLOGO / JP.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vector Part II '</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U2E.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSI</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/20-U2E_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VISU / C / CPLAY.C</font></font></a></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Captions / Acknowledgments</font></font></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ENDLOGO.EXE</font></font></td>
<td></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/21-ENDLOGO_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">END / END.C</font></font></a></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRED.EXE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WILDFIRE</font></font></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/22-CRED_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREDITS / MAIN.C</font></font></a></td>
</tr>
<tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ENDSCRL.EXE</font></font></td>
<td></td>
<td align="center"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><img src="http://fabiensanglard.net/second_reality/parts/23-ENDSCRL_thumb.png"></a></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ENDSCRL / MAIN.C</font></font></a></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It seems that each developer had his own specialization, which could be shared in one part. </font><font style="vertical-align: inherit;">This is especially noticeable in the first scene with scrolling, ships and explosions (Alkutekstit). </font><font style="vertical-align: inherit;">Although this looks like one continuous effect, in fact it is three executable files written by three different people:</font></font><br>
<br>
<div class="scrollable-table"><table>
<tbody><tr>
<td colspan="3"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alkutekstit (Credits) sequence</font></font></b></td>
</tr>
<tr>
<td><img src="http://fabiensanglard.net/second_reality/parts/04-ALKU_seq.png"></td>
<td><img src="http://fabiensanglard.net/second_reality/parts/05-U2A_seq.png"></td>
<td><img src="http://fabiensanglard.net/second_reality/parts/06-PAM_seq.png"></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALKU by WILDFIRE</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U2A by PSI</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAM by TRUG / WILDFIRE</font></font></td>
</tr>
</tbody></table></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assets</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Image Assets ( </font></font><code>.LBM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) are generated using </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deluxe Paint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , an extremely popular bitmap editor in the 90s. </font><font style="vertical-align: inherit;">Interestingly, they are converted to an array of bytes and compiled inside PART. </font><font style="vertical-align: inherit;">As a result of this, the exe file also downloads all assets. </font><font style="vertical-align: inherit;">In addition, this complicates reverse engineering. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Among the cool asset sets are the famous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CITY</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the latest 3D scene:</font></font><br>
<br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/second%20reality%20city.png"></div><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/second%20reality%20ship.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internal unit PART</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Since they were all compiled into DOS executables, in PART, any language could be used:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASM.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PASCAL: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brass knuckles monster (MNTSCRL.EXE)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dotted Tunnel (TUNNELI.EXE)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Raytracing sword (RAYSCRL.EXE)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some PARTs have gone even further and use C to generate ASM code: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLENZ / DOLOOP.C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">downloadable</font></a><font style="vertical-align: inherit;"> polyhedron) and </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Water effect (3DSINFLD.EXE)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As for memory usage, I read a lot about MMU on Wikipedia and other websites ... but in fact, each part could use anything, because after execution it was completely unloaded from memory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When working with VGA, each part used its own set of tricks and worked in its resolution. </font><font style="vertical-align: inherit;">In all of them, not Mode 13h and not ModeX were used, but rather a modified mode 13h mode with its own resolution. </font><font style="vertical-align: inherit;">The </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCRIPT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> file </font><font style="vertical-align: inherit;">often mentions 320x200 and 320x400.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unfortunately, when analyzing PART, reading the source code becomes a daunting task: the quality of the code and comments drops dramatically. </font><font style="vertical-align: inherit;">Perhaps this happened because of the rush or because each PART worked on its own developer (that is, there was no "real" need for comments or code comprehensibility), but the result was something completely confusing:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panic</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GLENZ</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sophisticated algorithms are not only difficult to understand even the names of variables ( </font></font><code>a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>co[]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...). </font><font style="vertical-align: inherit;">The code would be much more readable if the developers left us hints in the release notes. </font><font style="vertical-align: inherit;">As a result, I did not devote much time to studying each part; </font><font style="vertical-align: inherit;">The exception was the 3D engine responsible for U2A.EXE and U2E.EXE.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3D engine Second Reality</font></font></h3><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/3d_end.png"></div><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/3d_end2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anyway, I decided to study in detail the 3D engine, which was used in two parts: </font></font><code>U2A.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>U2E.EXE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The source code is C with assembler-optimized procedures (especially Gouro fill and shade):</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CITY.C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (main code).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VISU.C</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (library </font></font><code>visu.lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVID.ASM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (optimized assembler video (cleaning, screen copying, etc.)).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADRAW.ASM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (drawing objects and truncating).</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACALC.ASM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (matrices and fast sin / cos calculations).</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="http://fabiensanglard.net/second_reality/sr_3d_engine.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The architecture of these components is quite remarkable: the library </font></font><code>VISU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performs all complex tasks, for example, loading assets: 3DS objects, materials and flows (camera and ship movements). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The engine sorts the objects that need to be drawn, and renders them using the artist’s algorithm. </font><font style="vertical-align: inherit;">This leads to a large amount of redrawing, but since VGA latches allow you to record 4 pixels at the same time, it's not so bad. </font></font><br>
<br>
<u><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An interesting fact: the</font></font></b></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> engine performs transformations in an “old-school” way: instead of using common homogeneous 4x4 matrices, it uses 3 * 3 rotation matrices and a displacement vector. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is a summary in pseudo code:</font></font><br>
<br>
<pre><code class="cpp hljs">      main(){<font></font>
<font></font>
            scenem=readfile(tmpname);  <span class="hljs-comment">// Load materials</span>
            scene0=readfile(tmpname);  <span class="hljs-comment">// Load animation</span><font></font>
<font></font>
            <span class="hljs-keyword">for</span>(f=<span class="hljs-number">-1</span>,c=<span class="hljs-number">1</span>;c&lt;d;c++){  <span class="hljs-comment">//Load objects</span>
              <span class="hljs-built_in">sprintf</span>(tmpname,<span class="hljs-string">"%s.%03i"</span>,scene,e);<font></font>
              co[c].o=vis_loadobject(tmpname);<font></font>
            }<font></font>
<font></font>
            vid_init(<span class="hljs-number">1</span>);<font></font>
            vid_setpal(cp);<font></font>
<font></font>
            <span class="hljs-keyword">for</span>(;;){<font></font>
<font></font>
                vid_switch();<font></font>
                _asm mov bx,<span class="hljs-number">1</span>   _asm <span class="hljs-keyword">int</span> <span class="hljs-number">0f</span>ch <span class="hljs-comment">// waitb for retrace via copper simulator interrupt call </span><font></font>
                vid_clear();<font></font>
                <font></font>
                <span class="hljs-comment">// parse animation stream, update objects</span>
                <span class="hljs-keyword">for</span>(;;){}<font></font>
<font></font>
                vid_cameraangle(fov); <span class="hljs-comment">// Field of vision</span><font></font>
<font></font>
                <span class="hljs-comment">// Calc matrices and add to order list (only enabled objects)</span>
                <span class="hljs-keyword">for</span>(a=<span class="hljs-number">1</span>;ac&lt;conum;a++) <span class="hljs-keyword">if</span>(co[a].on) <span class="hljs-comment">/* start at 1 to skip camera */</span><font></font>
                    calc_applyrmatrix(o-&gt;r,&amp;cam);<font></font>
<font></font>
                <span class="hljs-comment">// Zsort via Bubble Sort</span>
                <span class="hljs-keyword">for</span>(a=<span class="hljs-number">0</span>;ac&lt;ordernum;a++)
                    <span class="hljs-keyword">for</span>(b=a<span class="hljs-number">-1</span>;b&gt;=<span class="hljs-number">0</span> &amp;&amp; dis&gt;co[order[b]].dist;b--)<font></font>
<font></font>
                <span class="hljs-comment">// Draw</span>
                <span class="hljs-keyword">for</span>(a=<span class="hljs-number">0</span>;ac&lt;ordernum;a++)<font></font>
                    vis_drawobject(o);<font></font>
              }<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span>(<span class="hljs-number">0</span>);<font></font>
     }</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ports for modern systems</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After the release of this article, many developers began to port Second Reality to modern systems. </font><font style="vertical-align: inherit;">Claudio Matsuoka set about creating </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sr-port</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a C port for Linux and OpenGL ES 2.0, which so far looks pretty impressive. </font><font style="vertical-align: inherit;">Nick Kovacs did a great job on PART PLZ, porting it to C (now it is part of the sr-port source code), as well as </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to javascript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/iw/l9/jm/iwl9jmypg-njcygljgtgi3zaxdg.png"></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en501016/index.html">On the development trends of the processor architecture, or why I believe in the success of Huawei in the server market</a></li>
<li><a href="../en501018/index.html">How to get around some google translate restrictions</a></li>
<li><a href="../en501020/index.html">How to test code containing setTimeout / setInterval under the hood</a></li>
<li><a href="../en501022/index.html">“I am in the desert”: why self-isolation turned out to be a serious stress for us and what it all resulted in</a></li>
<li><a href="../en501026/index.html">Remote banking identification: from complex to simple, or Banks, why do you need biometrics?</a></li>
<li><a href="../en501032/index.html">Cheap server from Chinese parts. Part 1, iron</a></li>
<li><a href="../en501034/index.html">IBM Weekly Seminars - May 2020</a></li>
<li><a href="../en501040/index.html">Typical errors in applications that lead to bloat in postgresql. Andrey Salnikov</a></li>
<li><a href="../en501042/index.html">Likbez on Compliance: we understand the requirements of regulators in the field of information security</a></li>
<li><a href="../en501044/index.html">Do not hold people for idiots or why a person with an engineering background can burn a cell tower (video)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>