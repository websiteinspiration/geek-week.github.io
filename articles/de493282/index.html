<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💗 🚷 🌧️ Grundlegendes zu Netzwerkrichtlinien mit Calico 🎯 🐩 👩🏼‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Calico Network Plugin bietet eine Vielzahl von Netzwerkrichtlinien mit einer einheitlichen Syntax zum Schutz von Hosts auf Hardware, virtuellen Ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Grundlegendes zu Netzwerkrichtlinien mit Calico</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nixys/blog/493282/"><img src="https://habrastorage.org/webt/ui/yk/5t/uiyk5t_l9nxqernjewtrtln6kaa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Calico Network Plugin bietet eine Vielzahl von Netzwerkrichtlinien mit einer einheitlichen Syntax zum Schutz von Hosts auf Hardware, virtuellen Maschinen und Pods. Diese Richtlinien können innerhalb des Namespace angewendet werden oder globale Netzwerkrichtlinien sein, die für den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Endpunkt gelten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (zum Schutz von Anwendungen, die direkt auf dem Host ausgeführt werden - der Server oder die virtuelle Maschine kann direkt der Host sein) oder zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workload-Endpunkt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(zum Schutz von Anwendungen, die in gehosteten Containern oder virtuellen Maschinen ausgeführt werden). Mit Calico-Richtlinien können Sie Sicherheitsmaßnahmen auf verschiedene Punkte im Paketpfad anwenden, indem Sie Parameter wie preDNAT, untracked und applyOnForward verwenden. Wenn Sie wissen, wie diese Optionen funktionieren, können Sie die Sicherheit und Leistung des gesamten Systems verbessern. In diesem Artikel wird das Wesentliche dieser Calico-Richtlinieneinstellungen (preDNAT, unraracked und applyOnForward) erläutert, die auf Host-Endpunkte angewendet werden, wobei der Schwerpunkt auf den Vorgängen in Paketverarbeitungspfaden (iptabels-Ketten) liegt.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel wird davon ausgegangen, dass Sie wissen, wie die Netzwerkrichtlinien von Kubernetes und Calico funktionieren. Wenn nicht, empfehlen wir Ihnen , </font><font style="vertical-align: inherit;">die versuchen , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grundlegende Netzwerkrichtlinien Tutorial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hostschutz Tutorial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Calico verwenden , </font><font style="vertical-align: inherit;">bevor Sie </font><font style="vertical-align: inherit;">diesen Artikel lesen. Wir erwarten auch, dass Sie ein grundlegendes Verständnis von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iptables</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unter Linux haben. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Globale Netzwerkrichtlinie von</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Calico</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dieser Option können Sie eine Reihe von Zugriffsregeln für Labels anwenden (auf Hostgruppen und Workloads / Pods). Dies ist sehr nützlich, wenn Sie heterogene Systeme zusammen verwenden - virtuelle Maschinen, ein System direkt auf der Hardware oder die kubernetes-Infrastruktur. Darüber hinaus können Sie Ihren Cluster (Knoten) mithilfe einer Reihe deklarativer Richtlinien schützen und Netzwerkrichtlinien auf eingehenden Datenverkehr anwenden (z. B. über den NodePorts-Dienst oder externe IPs).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Calico einen Pod mit einem Netzwerk verbindet (siehe Abbildung unten), verbindet er ihn grundsätzlich über eine virtuelle Ethernet-Schnittstelle (veth) mit einem Host. Der vom Pod gesendete Datenverkehr kommt über diese virtuelle Schnittstelle beim Host an und wird so verarbeitet, als stamme er von einer physischen Netzwerkschnittstelle. Standardmäßig nennt Calico diese Schnittstellen caliXXX. Da der Datenverkehr über die virtuelle Schnittstelle erfolgt, durchläuft er iptables, als ob sich der Pod in der Entfernung eines Hops befindet. Wenn also Verkehr vom Pod kommt / kommt, wird er aus Sicht des Hosts weitergeleitet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem Kubernetes-Knoten, auf dem Calico ausgeführt wird, können Sie die virtuelle Schnittstelle (veth) wie folgt der Arbeitslast zuordnen. Im folgenden Beispiel sehen Sie, dass veth # 10 (calic1cbf1ca0f8) im Calico-Monitoring-Namespace mit cnx-manager- * verbunden ist.</font></font><br>
<br>
<pre><code class="plaintext hljs">[centos@ip-172-31-31-46 K8S]$ sudo ip a<font></font>
...<font></font>
10: calic1cbf1ca0f8@if4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1440 qdisc noqueue state UP group default<font></font>
    link/ether ee:ee:ee:ee:ee:ee brd ff:ff:ff:ff:ff:ff link-netnsid 5<font></font>
    inet6 fe80::ecee:eeff:feee:eeee/64 scope link<font></font>
       valid_lft forever preferred_lft forever<font></font>
...<font></font>
<font></font>
[centos@ip-172-31-31-46 K8S]$ calicoctl get wep --all-namespaces<font></font>
...<font></font>
calico-monitoring cnx-manager-8f778bd66-lz45m                            ip-172-31-31-46.ec2.internal 192.168.103.134/32<font></font>
calic1cbf1ca0f8<font></font>
...</code></pre><br>
<img src="https://habrastorage.org/webt/j4/sz/k4/j4szk45ps1af4itowiylazzg-mm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie werden Richtlinien angewendet, da Calico für jede Arbeitslast eine veth-Schnittstelle erstellt? </font><font style="vertical-align: inherit;">Zu diesem Zweck erstellt Calico mithilfe von iptables Hooks in verschiedenen Ketten des Paketverarbeitungspfads. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Diagramm zeigt die Ketten, die an der Verarbeitung von Paketen in iptables (oder dem Netfilter-Subsystem) beteiligt sind. </font><font style="vertical-align: inherit;">Wenn ein Paket über eine Netzwerkschnittstelle ankommt, durchläuft es zuerst die PREROUTING-Kette. </font><font style="vertical-align: inherit;">Dann wird eine Routing-Entscheidung getroffen, und basierend darauf durchläuft das Paket entweder INPUT (an Host-Prozesse gerichtet) oder FORWARD (an Pod oder einen anderen Knoten im Netzwerk gerichtet). </font><font style="vertical-align: inherit;">Vom lokalen Prozess durchläuft das Paket die OUTPUT-Kette und dann POSTROUTING, bevor es über das Kabel gesendet wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass pod auch ein externes Objekt (mit veth verbunden) ist, was die Handhabung von iptables betrifft. </font><font style="vertical-align: inherit;">Zusammenfassen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der weitergeleitete Verkehr (nat, zum / vom Pod geleitet) wird durch die Ketten PREROUTING - FORWARD - POSTROUTING geleitet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Datenverkehr zum lokalen Hostprozess durchläuft die PREROUTING - INPUT-Kette.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Datenverkehr vom lokalen Hostprozess durchläuft die Kette OUTPUT - POSTROUTING.</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/vo/8v/pj/vo8vpjpwprnf9w3wo4rc1rio9is.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calico bietet Richtlinienoptionen zum Anwenden von Richtlinien auf alle Ketten. </font><font style="vertical-align: inherit;">Schauen wir uns vor diesem Hintergrund die verschiedenen in Calico verfügbaren Richtlinieneinstellungen an. </font><font style="vertical-align: inherit;">Die Zahlen in der Optionsliste unten entsprechen den Zahlen im obigen Diagramm.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workload-Endpunktrichtlinie (Pod)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Endpunktrichtlinie</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ApplyOnForward Option</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreDNAT-Richtlinie</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht verfolgte Richtlinie</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns zunächst untersuchen, wie Richtlinien für Workload-Endpunkte (Kubernetes oder OpenStack VMs-Pods) gelten, und anschließend die Richtlinienoptionen für Host-Endpunkte.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workload-Endpunkte</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Workload-Endpunktrichtlinie (1)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine Option zum Schutz Ihrer Kubernetes-Pods. </font><font style="vertical-align: inherit;">Calico unterstützt die Arbeit mit Kubernetes NetworkPolicy, bietet jedoch auch zusätzliche Richtlinien - Calico NetworkPolicy und GlobalNetworkPolicy. </font><font style="vertical-align: inherit;">Calico erstellt eine Kette für jeden Pod (Workload) und hakt die INPUT- und OUTPUT-Ketten für die Workload in die Filtertabelle der FORWARD-Kette ein.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Endpunkte</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Host-Endpunktrichtlinie (2)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zu CNI (Container Network Interface) bieten Calico-Richtlinien die Möglichkeit, den Host direkt zu schützen. In Calico können Sie einen Host-Endpunkt erstellen, indem Sie eine Kombination aus Host-Schnittstelle und ggf. Port-Nummern angeben. Die Anwendung von Richtlinien für diese Entität wird mithilfe der Filtertabelle in den Ketten INPUT und OUTPUT erreicht. Wie aus dem Diagramm ersichtlich ist, (2) werden sie auf lokale Prozesse auf dem Knoten / Host angewendet. Das heißt, wenn Sie eine Richtlinie erstellt haben, die für den Host-Endpunkt gilt, hat dies keine Auswirkungen auf den Datenverkehr zu / von Ihren Pods. Es bietet jedoch eine einzige Schnittstelle / Syntax zum Blockieren des Datenverkehrs für Ihren Host und Ihre Pods mithilfe von Calico-Richtlinien. Dies vereinfacht die Verwaltung von Richtlinien für ein heterogenes Netzwerk erheblich. Das Konfigurieren von Host-Endpunktrichtlinien zur Verbesserung des Clusterschutzes ist ein weiterer wichtiger Anwendungsfall.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ApplyOnForward-Richtlinie (3)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Option ApplyOnForward ist in der globalen Netzwerkrichtlinie von Calico verfügbar, damit Richtlinien auf den gesamten Datenverkehr angewendet werden können, der über den Host-Endpunkt geleitet wird, einschließlich des Datenverkehrs, der vom Host weitergeleitet wird. </font><font style="vertical-align: inherit;">Dieser Datenverkehr umfasst das Senden an einen lokalen Pod oder an eine andere Stelle im Netzwerk. </font><font style="vertical-align: inherit;">Für Calico muss diese Einstellung für Richtlinien aktiviert sein, die PreDNAT verwenden und nicht verfolgt werden. Weitere Informationen finden Sie in den folgenden Abschnitten. </font><font style="vertical-align: inherit;">Darüber hinaus kann ApplyOnForward verwendet werden, um den Host-Verkehr zu verfolgen, wenn ein virtueller Router oder Software-NAT verwendet wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass Sie die ApplyOnForward-Option nicht verwenden müssen, wenn Sie dieselbe Netzwerkrichtlinie für Hostprozesse und Pods anwenden müssen. </font><font style="vertical-align: inherit;">Sie müssen lediglich eine Beschriftung für den gewünschten Hostendpunkt und Workload-Endpunkt (Pod) erstellen. </font><font style="vertical-align: inherit;">Calico ist intelligent genug, um beschriftungsbasierte Richtlinien anzuwenden, unabhängig von der Art des Endpunkts (Hostendpunkt oder Arbeitslast).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PreDNAT-Richtlinie (4)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Kubernetes können die Ports der Service-Entität mithilfe der Option NodePorts oder optional (bei Verwendung von Calico) nach außen weitergeleitet werden, indem sie über die Optionen Cluster-IPs oder Externe IPs deklariert werden. Kube-Proxy gleicht den an den Dienst gebundenen eingehenden Datenverkehr mithilfe von DNAT an die Pods des entsprechenden Dienstes aus. Wie wenden Sie vor diesem Hintergrund Richtlinien auf Datenverkehr an, der über NodePorts eingeht? Damit diese Richtlinien angewendet werden können, bevor der Datenverkehr von DNAT verarbeitet wird (dies ist eine Zuordnung zwischen Host: Port und dem entsprechenden Dienst), stellt Calico einen Parameter für globalNetworkPolicy mit dem Namen "preDNAT: true" bereit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Pre-DNAT aktiviert ist, werden diese Richtlinien in (4) im Diagramm - in der Mangle-Tabelle der PREROUTING-Kette - unmittelbar vor DNAT implementiert. Die übliche Bestellrichtlinie wird hier nicht eingehalten, da die Anwendung dieser Richtlinien auf dem Weg der Datenverkehrsverarbeitung viel früher erfolgt. PreDNAT-Richtlinien berücksichtigen jedoch die Reihenfolge der Anwendung untereinander. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Richtlinien mit Pre-DNAT erstellen, ist es wichtig, den Datenverkehr zu berücksichtigen, den Sie verarbeiten möchten, und zuzulassen, dass die meisten abgelehnt werden. Der in der Vor-DNAT-Richtlinie als "Zulassen" gekennzeichnete Datenverkehr wird von der Hostendpoint-Richtlinie nicht mehr überprüft, während der Datenverkehr, wenn die Vor-DNAT-Richtlinie fehlschlägt, weiterhin durch den Rest der Ketten fließt.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Calico hat es obligatorisch gemacht, die Option applyOnForward zu aktivieren, wenn preDNAT verwendet wird, da das Ziel des Datenverkehrs per Definition noch nicht ausgewählt wurde. </font><font style="vertical-align: inherit;">Der Datenverkehr kann an den Host-Prozess geleitet oder an einen Pod oder einen anderen Knoten umgeleitet werden.</font></font><br>
 <br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht verfolgte Richtlinie (5)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Netzwerke und Anwendungen können große Verhaltensunterschiede aufweisen. In einigen extremen Fällen können Anwendungen viele kurzfristige Verbindungen erzeugen. Dies kann zu einem Speichermangel für conntrack (die Hauptkomponente des Linux-Netzwerkstapels) führen. Um diese Art von Anwendung unter Linux auszuführen, müssen Sie conntrack traditionell manuell konfigurieren oder deaktivieren oder iptables-Regeln schreiben, um conntrack zu umgehen. Nicht verfolgte Richtlinien in Calico sind eine einfachere und effizientere Option, wenn Sie Verbindungen so schnell wie möglich verarbeiten möchten. Zum Beispiel, wenn Sie massiven </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memcache verwenden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder als zusätzliche Schutzmaßnahme gegen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DDOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lesen Sie diesen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blog-Beitrag</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (oder </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unsere Übersetzung</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) für weitere Informationen, einschließlich Leistungstests unter Verwendung der nicht verfolgten Richtlinie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die Option "doNotTrack: true" auf Calico globalNetworkPolicy setzen, wird sie zu einer ** nicht verfolgten ** Richtlinie und wird in einem sehr frühen Stadium der Linux-Paketverarbeitungspipeline angewendet. </font><font style="vertical-align: inherit;">Wenn Sie sich das obige Diagramm ansehen, werden nicht verfolgte Richtlinien in den Ketten PREROUTING und OUTPUT in der Rohtabelle angewendet, bevor die Verbindungsverfolgung (conntrack) gestartet wird. </font><font style="vertical-align: inherit;">Wenn ein Paket von einer nicht verfolgten Richtlinie zugelassen wird, wird es markiert, um die Verbindungsverfolgung für dieses Paket zu deaktivieren. </font><font style="vertical-align: inherit;">Das heisst:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Für jedes Paket wird eine nicht verfolgte Richtlinie angewendet. </font><font style="vertical-align: inherit;">Es gibt kein Konzept für eine Verbindung (oder einen Stream). </font><font style="vertical-align: inherit;">Das Fehlen von Verbindungen hat mehrere wichtige Konsequenzen:</font></font></li>
<li>      ,    ,      ,     ( Calico   conntrack,      ).</li>
<li>  untracked    workload Kubernetes (pod’),            pod’.</li>
<li> NAT      (  ​​  NAT  conntrack).</li>
<li>    « »  untracked-      .     ,   ,         untracked- (         ).</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht verfolgte Richtlinien werden ganz am Anfang der Paketverarbeitungspipeline angewendet. </font><font style="vertical-align: inherit;">Dies ist beim Erstellen von Calico-Richtlinien sehr wichtig. </font><font style="vertical-align: inherit;">Sie können eine Richtlinie für einen Pod mit der Reihenfolge: 1 und eine nicht verfolgte Richtlinie mit der Reihenfolge: 1000 haben. </font><font style="vertical-align: inherit;">Es wird nichts ausmachen. </font><font style="vertical-align: inherit;">Die nicht verfolgte Richtlinie wird vor der Richtlinie für den Pod angewendet. </font><font style="vertical-align: inherit;">Nicht verfolgte Richtlinien respektieren die Ausführungsreihenfolge nur untereinander.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da eines der Ziele der doNotTrack-Richtlinie darin besteht, die Richtlinie in einem sehr frühen Stadium der Linux-Paketverarbeitungspipeline durchzusetzen, muss Calico bei Verwendung von doNotTrack die Option applyOnForward angeben. </font><font style="vertical-align: inherit;">Beachten Sie unter Bezugnahme auf das Paketverarbeitungsdiagramm, dass die Richtlinie für nicht verfolgte (5) vor Routingentscheidungen angewendet wird. </font><font style="vertical-align: inherit;">Der Datenverkehr kann an den Host-Prozess geleitet oder an einen Pod oder einen anderen Knoten umgeleitet werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusammenfassung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben uns die verschiedenen Richtlinienoptionen (Host-Endpunkt, ApplyOnForward, preDNAT und Untracked) in Calico und deren Anwendung auf die Paketverarbeitung angesehen. </font><font style="vertical-align: inherit;">Das Verständnis der Essenz ihrer Arbeit hilft bei der Entwicklung effektiver und sicherer Richtlinien. </font><font style="vertical-align: inherit;">Mit Calico können Sie die globale Netzwerkrichtlinie verwenden, die für das Label (eine Gruppe von Knoten und Pods) gilt, und Richtlinien mit verschiedenen Parametern anwenden. </font><font style="vertical-align: inherit;">Auf diese Weise können Sicherheits- und Netzwerkdesignspezialisten „alles“ (Endpunkttypen) sofort mit derselben Richtliniensprache wie Calico-Richtlinien schützen. </font></font><br>
<br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Danksagung: Ich möchte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sean Crampton</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alex Pollitt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für ihre Bewertung und für wertvolle Informationen </font><font style="vertical-align: inherit;">danken </font><font style="vertical-align: inherit;">.</font></font></i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de493266/index.html">45 Youtube-Kanäle in englischer Sprache für IT-Profis</a></li>
<li><a href="../de493268/index.html">Pentester Angewandt</a></li>
<li><a href="../de493272/index.html">So aktivieren Sie Google-Dokumente offline im neuen Microsoft Edge</a></li>
<li><a href="../de493274/index.html">Über 30 prägnante professionelle Empfehlungen für Android-Entwickler</a></li>
<li><a href="../de493278/index.html">Нужно ли курить для защиты от SARS-CoV-2</a></li>
<li><a href="../de493284/index.html">Kubernetes 1.18: Überblick über wichtige Innovationen</a></li>
<li><a href="../de493288/index.html">Fünf berühmte erklärte Programmierzitate</a></li>
<li><a href="../de493292/index.html">Reaktionsschnell oder reaktionsschnell? Struktur der Analyse-Reaktionskomponente</a></li>
<li><a href="../de493294/index.html">Wir schauen mit TTL in die sowjetische integrierte Schaltung</a></li>
<li><a href="../de493298/index.html">C ++ -, Metaprogrammier- und Mikrocontroller-Register</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>