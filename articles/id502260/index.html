<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹🏽 👩🏻‍🍳 🏴󠁧󠁢󠁷󠁬󠁳󠁿 ESP-NOW adalah protokol komunikasi alternatif untuk ESP8266 dan ESP32. Konsep dasar 👩‍⚕️ 🌬️ 👟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESP-NOW adalah protokol WiFi yang disederhanakan untuk mentransfer paket pendek antara pasangan perangkat berpasangan, dikembangkan dan dirilis oleh E...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ESP-NOW adalah protokol komunikasi alternatif untuk ESP8266 dan ESP32. Konsep dasar</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502260/"><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-NOW adalah protokol WiFi yang disederhanakan untuk mentransfer paket pendek antara pasangan perangkat berpasangan, dikembangkan dan dirilis oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada 2016.07 untuk mikrokontroler ESP8266 dan ESP32. </font><font style="vertical-align: inherit;">Pada saat yang sama, prosedur tambahan yang terkait dengan dukungan protokol WiFi tidak digunakan, yang mempercepat proses pertukaran paket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-SEKARANG dapat digunakan di Internet of Things untuk mengontrol sumber cahaya cerdas, relay, soket, perangkat remote control lainnya, menerima informasi dari sensor dan aplikasi lainnya.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW mendukung fitur-fitur berikut</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komunikasi terenkripsi dan tidak terenkripsi antara perangkat pasangan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komunikasi terenkripsi dan tidak terenkripsi campuran antara perangkat pasangan. </font></font><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfer hingga 250 byte informasi berguna.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyiapkan fungsi panggilan balik untuk memberi tahu lapisan aplikasi, khususnya, tentang keberhasilan atau kegagalan transmisi.</font></font></li>
</ul><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW juga memiliki fitur dan batasan berikut.</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kecepatan transmisi - tidak lebih dari 1 Mbps pada frekuensi 2,4 GHz, mis. </font><font style="vertical-align: inherit;">ESP-NOW beroperasi pada frekuensi dan saluran yang sama dengan router WiFi Anda.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokol WiFi tidak digunakan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mirip dengan protokol berdaya rendah yang digunakan pada mouse nirkabel 2,4 GHz.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanya pemasangan awal yang diperlukan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah berpasangan, koneksi tidak putus.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Siaran tidak didukung - hanya beberapa distribusi untuk pasangan perangkat berpasangan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maksimal 20 pasangan, termasuk yang terenkripsi, didukung pada satu perangkat, termasuk pasangan terenkripsi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maksimal 10 pasangan terenkripsi didukung dalam mode Stasiun.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maksimal 6 dalam mode SoftAP atau SoftAP + Station.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enkripsi multicast tidak didukung.</font></font></li>
</ul><br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keamanan</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ESP-SEKARANG mengadopsi teknologi bingkai Vendor Aksi IEEE802.11 dengan fungsi IE yang dikembangkan oleh teknologi enkripsi Espressif dan CCMP, menyediakan solusi komunikasi yang aman dan bebas koneksi. </font><font style="vertical-align: inherit;">Perangkat Wi-Fi mendukung kunci induk primer (PMK) dan beberapa kunci induk lokal (LMK)</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan untuk mengenkripsi LMK menggunakan algoritma AES-128.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perangkat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pasangan </font><b><font style="vertical-align: inherit;">LMK</font></b><font style="vertical-align: inherit;"> digunakan untuk mengenkripsi informasi pengguna menggunakan CCMP. </font><font style="vertical-align: inherit;">Jumlah maksimum LMK yang berbeda adalah 6. Jika tidak ada LMK yang ditetapkan untuk perangkat yang dipasangkan, data pengguna tidak akan dienkripsi.</font></font></li>
</ul><br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tingkat dasar</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tingkat yang lebih rendah dari protokol ESP_NOW, daftar tertaut dipertahankan berisi informasi tentang perangkat lokal dan perangkat pasangan, termasuk alamat MAC dan kunci. </font><font style="vertical-align: inherit;">ESP-NOW juga menyimpan data yang sering digunakan untuk lapisan aplikasi untuk menghindari overhead memproses ulang daftar tertaut. </font><font style="vertical-align: inherit;">Informasi tentang perangkat digunakan untuk mengirim dan menerima data dan termasuk </font></font><br>
<br>
<u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informasi tentang perangkat lokal:</font></font></u> <br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PMK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 16 byte - kunci master utama yang digunakan untuk mengenkripsi kunci pada perangkat yang terpasang (KOK di API) ESP_NOW mendukung PMK secara default, jadi tidak diperlukan konfigurasi. </font><font style="vertical-align: inherit;">Jika perlu, Anda dapat memverifikasi bahwa nilai PMK cocok dengan perangkat lokal.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte - mode perangkat lokal yang mendefinisikan antarmuka WiFi pemancar (SoftAP atau STA) ESP-NOW. </font><font style="vertical-align: inherit;">Mode perangkat pasangan tidak mempengaruhi fungsi apa pun, tetapi hanya menyimpan informasi mode untuk lapisan aplikasi. </font><font style="vertical-align: inherit;">Dalam mode STA WiFi, hanya Station yang berlaku dan SoftAP WiFi hanya SoftAP.</font></font><div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode operasi perangkat lokal ESP_NOW</font></font></b>
                        <div class="spoiler_text"><blockquote><div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kondisi</font></font></th>
<th> WiFi</th>
</tr>
<tr>
<td><b>IDLE</b></td>
<td> </td>
<td>   </td>
</tr>
<tr>
<td><b>CONTROLLER</b></td>
<td></td>
<td>STA</td>
</tr>
<tr>
<td><b>SLAVE</b></td>
<td></td>
<td>SoftAP </td>
</tr>
<tr>
<td><b>COMBO</b></td>
<td>&amp;</td>
<td>SoftAP</td>
</tr>
</tbody></table></div></blockquote><br>
</div>
                    </div></li>
</ul><br>
<u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informasi </font><u><font style="vertical-align: inherit;">perangkat yang dipasangkan</font></u><font style="vertical-align: inherit;"> (termasuk informasi yang sering digunakan dan informasi pengguna lainnya):</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LMK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 16 byte - kunci master lokal yang digunakan untuk mengenkripsi kunci informasi yang berguna selama komunikasi dalam pasangan ini.</font></font></li>
<li><b>MAC-</b>: 6  —   ,    . ,     Station, MAC-     Station.</li>
<li><b></b>: 1  —       (SoftAP  STA) ESP-NOW.</li>
<li><b></b>: 1  — ,     ,   .   0..255.       ,         .    . , 0 ,    ; 1 ~ 14   ;       ,    .</li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak merekomendasikan penggunaan operasi yang panjang dalam fungsi panggilan balik saat mengirim / mengirim paket, yang mungkin terkait dengan implementasi algoritma menggunakan mekanisme interupsi. </font><font style="vertical-align: inherit;">Asumsi ini juga didukung oleh masalah yang terkait dengan alokasi memori dinamis dalam fungsi callback, yang diselesaikan dengan penggunaan variabel statis yang disukai, serta ambiguitas menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mekanisme</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengecualian </font><i><font style="vertical-align: inherit;">MicroPython</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Implementasi asinkron dari proses awal / akhir, pemasangan, penerimaan / pengiriman paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak dijelaskan, yang juga tidak memfasilitasi penerapan ideologi </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> asyncio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Format Paket ESP-NOW</font></font></h4><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Header MAC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 24 byte.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kategori</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte yang menunjukkan kategori pembuat paket. </font><font style="vertical-align: inherit;">Nilainya diatur (127).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID Organisasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 3 byte, berisi pengidentifikasi unik, yang merupakan tiga byte pertama dari alamat MAC yang digunakan oleh Espressif. </font><font style="vertical-align: inherit;">Tetapkan nilai (0x18fe34)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai acak</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 4 byte, digunakan untuk melindungi data.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data Pembuat Paket</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 7-255Bytes</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data pembuat paket berisi bidang-bidang berikut:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte, Set ke (221).</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panjang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte, panjang total ID organisasi, jenis, versi, dan data pengguna.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID Organisasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 3 byte, berisi pengidentifikasi unik, yang merupakan tiga byte pertama dari alamat MAC yang digunakan oleh Espressif. </font><font style="vertical-align: inherit;">Tetapkan nilai (0x18fe34)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jenis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte, protokol ESP-NOW. </font><font style="vertical-align: inherit;">Tetapkan nilai (4)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 1 byte, versi ESP-NOW saat ini. </font><font style="vertical-align: inherit;">Terpasang (1)</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 0-250 byte data pengguna.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FCS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 4 byte, checksum</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena ESP-NOW tidak menggunakan WiFi, header MAC sedikit berbeda dari header paket standar. </font><font style="vertical-align: inherit;">Bit FromDS dan ToDS dari bidang FrameControl adalah 0. Alamat tujuan ditentukan dalam bidang alamat pertama. </font><font style="vertical-align: inherit;">Bidang alamat kedua menunjukkan alamat sumber. </font><font style="vertical-align: inherit;">Bidang alamat ketiga diatur sebagai alamat broadcast (0xff: 0xff: 0xff: 0xff: 0xff: 0xff).</font></font><br>
<br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritma aplikasi dasar</font></font></h2></u><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai dan akhiri</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum menggunakan ESP-SEKARANG, Anda disarankan untuk mengatur antarmuka Wi-Fi dalam mode yang diinginkan. </font><font style="vertical-align: inherit;">Biasanya, antarmuka Station diatur ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CONTROLLER</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , antarmuka SoftAP untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SLAVE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">COMBO</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Disarankan juga untuk menghentikan Wi-Fi setelah menggunakan ESP-SEKARANG. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memulai ESP-NOW, panggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_init ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_deinit ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menyelesaikan. </font><font style="vertical-align: inherit;">Ketika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_deinit ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">, semua informasi tentang perangkat berpasangan dihapus.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengikat Fungsi Panggilan Balik</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi pemrosesan panggilan saat mengirim paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat digunakan untuk menginformasikan tingkat aplikasi pihak pengirim dalam pasangan tentang keberhasilan atau kegagalan transmisi, misalnya, jika informasi pada sub lapisan MAC berhasil ditransmisikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pertimbangkan hal berikut: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pasangan yang ditautkan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika lapisan aplikasi tidak menerima paket, tetapi fungsi panggilan balik mengembalikan "sukses", alasannya mungkin: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - serangan dari perangkat palsu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - kesalahan instalasi kunci terenkripsi </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - kehilangan paket di tingkat aplikasi Espressif</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika lapisan aplikasi menerima paket, tetapi fungsi panggilan balik mengembalikan kesalahan, penyebabnya mungkin: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Saluran sibuk dan ACK tidak diterima.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan banyak komunikasi dengan semua pasangan perangkat lokal:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika panggilan balik mengembalikan "sukses", itu berarti paket telah berhasil dikirim.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika fungsi panggilan balik menghasilkan kesalahan, itu berarti bahwa paket tersebut tidak berhasil dikirim.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi pemrosesan panggilan setelah menerima paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_receive_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan informasi termasuk alamat MAC dari perangkat pengirim secara berpasangan dan informasi yang berguna. </font><font style="vertical-align: inherit;">Ini juga dapat digunakan untuk menginformasikan lapisan aplikasi perangkat pengirim yang dipasangkan dengan penerima bahwa paket tersebut berhasil diterima.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan sepasang perangkat berpasangan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum mengirim data, Anda harus menambahkan perangkat ke daftar pasangan perangkat berpasangan dengan memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_add_peer ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sebelum mengirim data ke grup pasangan mapan, Anda harus menambahkan perangkat dengan alamat MAC multicast. </font><font style="vertical-align: inherit;">Rentang saluran perangkat pasangan adalah dari 0 hingga 14. Jika saluran diatur ke 0, data akan dikirim pada saluran saat ini. </font><font style="vertical-align: inherit;">Jika tidak, saluran tersebut harus ditetapkan sebagai saluran tempat perangkat lokal berada.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keamanan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika kunci perlu dienkripsi, Anda dapat memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_set_pmk ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengkonfigurasinya </font><font style="vertical-align: inherit;">untuk mengatur PMK. </font><font style="vertical-align: inherit;">Jika PMK tidak diinstal, PMK akan digunakan secara default dan pilih kunci yang sama untuk semua perangkat. </font><font style="vertical-align: inherit;">Juga atur LMK untuk pasangan yang dipilih.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengirim Data dengan Paket ESP-NOW</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_send ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengirim data ESP-NOW </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pada saat yang sama, fungsi yang ditetapkan sebelumnya dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_register_send_cb ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP_NOW_SEND_SUCCESS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saat mengirim fungsi panggilan balik jika data berhasil diterima di tingkat MAC. </font><font style="vertical-align: inherit;">Jika tidak, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP_NOW_SEND_FAIL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan kembali </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Beberapa alasan dapat menyebabkan ESP-NOW tidak dapat mengirim data. </font><font style="vertical-align: inherit;">Khususnya,</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perangkat target tidak ada;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saluran perangkat tidak cocok;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data hilang selama transmisi.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak dijamin bahwa lapisan aplikasi tentu akan menerima data. Jika perlu, Anda dapat mengirim konfirmasi ketika Anda menerima data ESP-NOW. Jika batas waktu konfirmasi terjadi, transmisi data ESP-NOW harus diulang. Nomor urut juga dapat ditugaskan untuk data ESP-SEKARANG untuk menghapus data duplikat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat mengirim data ESP-NOW melalui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp_now_send (),</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harap dicatat bahwa tidak lebih dari 250 byte informasi dapat dikirim sekaligus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PERHATIAN! Interval yang terlalu singkat antara mengirim dua paket ESP-SEKARANG dapat menyebabkan kesalahan dalam pelaksanaan fungsi panggilan balik, oleh karena itu disarankan untuk mengirim paket data ESP-SEKARANG berikutnya setelah fungsi panggilan balik berhasil menyelesaikan pemrosesan pengiriman sebelumnya. Fungsi panggilan balik dikirim dari tugas Wi-Fi prioritas tinggi. Oleh karena itu, tidak disarankan untuk melakukan operasi yang panjang dalam fungsi panggilan balik. Sebagai gantinya, Anda dapat menempatkan data yang diperlukan dalam antrian statis dan memprosesnya dari proses dengan prioritas lebih rendah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika fungsi kirim mengembalikan alamat MAC, maka itu akan dikirim ke perangkat dengan alamat MAC ini. </font><font style="vertical-align: inherit;">Jika fungsi kirim mengembalikan NULL, maka paket akan dikirim ke semua perangkat yang terhubung dengan pengiriman, yang dapat menyebabkan kegagalan transmisi atau keterlambatan karena kemacetan jaringan.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP-NOW Menerima Data</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi panggilan balik juga dimulai dari tugas Wi-Fi. </font><font style="vertical-align: inherit;">Oleh karena itu, tidak disarankan untuk melakukan operasi yang panjang dalam fungsi panggilan balik. </font><font style="vertical-align: inherit;">Sebagai gantinya, Anda dapat menempatkan data yang diperlukan dalam antrian statis dan memprosesnya dengan proses prioritas yang lebih rendah.</font></font><br>
<br>
<u><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulannya, hal tersebut di atas</font></font></h2></u><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengalaman saya dalam membangun </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif IDE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan ESP-NOW, menjelaskan kesalahan yang saya temui selama perakitan dan akan memperbaikinya setelah saya mencapai hasil yang stabil. Lalu saya akan membuat deskripsi perpustakaan ESP-NOW di MicroPython dengan kesalahan yang terdeteksi, dan cara untuk mengatasinya. Sayangnya, karena fakta bahwa kode sumber ESP-SEKARANG ditutup dan didistribusikan hanya dalam bentuk biner, pemahaman tentang algoritma protokol ESP-SEKARANG adalah empiris dan ada sejumlah masalah yang telah diidentifikasi, yang tidak selalu ada pilihan untuk mengatasinya secara logis, tetapi secara umum ESP -NOW telah berhasil diterapkan di komunitas pengguna-C dan Python berdasarkan pada lebih dari 300 aplikasi yang disajikan pada GitHub. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi Perpustakaan ESP-NOW C oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espressif</font></font></i></a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">MicroPython</font></i><font style="vertical-align: inherit;"> ESP-NOW Deskripsi dan Sumber Terbuka</font></font><i><font style="vertical-align: inherit;"></font></i></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id502248/index.html">GOST baru untuk sumber daya digital mulai berlaku: semua platform harus dapat diakses oleh para penyandang cacat</a></li>
<li><a href="../id502250/index.html">Penerbangan Sipil Hari Ini: Aspek dan Tantangan Penting dalam Pelatihan</a></li>
<li><a href="../id502252/index.html">Remote control dan drone</a></li>
<li><a href="../id502254/index.html">PostgreSQL: Pemrograman sisi server dalam bahasa manusia (PL / Perl, PL / Python, PL / v8)</a></li>
<li><a href="../id502256/index.html">Bagaimana cara memvisualisasikan grafik Integrasi Spring menggunakan Neo4j?</a></li>
<li><a href="../id502262/index.html">Mengapa pemantauan AIOps dan payung untuk bank, atau pada apa hubungan pelanggan dibangun</a></li>
<li><a href="../id502264/index.html">Infrastruktur Kunci Publik. Masalah sertifikat dalam kondisi isolasi diri</a></li>
<li><a href="../id502266/index.html">Aurora pada platform Intel. Fajar Era Exaflops</a></li>
<li><a href="../id502268/index.html">HackTheBox. Melewati Paten. XXE via DOCX, LFI ke RCE, GIT, dan file berantai ROP</a></li>
<li><a href="../id502272/index.html">Jangan katakan "Aku merasakan diriku sendiri," dan aturan-aturan bahasa Inggris lainnya yang mendorong orang menjadi pingsan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>