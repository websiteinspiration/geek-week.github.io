<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è¨ ü§≤üèΩ üèπ Regulariza√ß√£o? Ortogonaliza√ß√£o! Melhorando redes compactas üçõ üè© üë®üèæ‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Enquanto outras empresas discutem o gerenciamento remoto da equipe, n√≥s da Smart Engines continuamos compartilhando nossa pilha de tecnologias com voc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Regulariza√ß√£o? Ortogonaliza√ß√£o! Melhorando redes compactas</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/smartengines/blog/495816/"><img src="https://habrastorage.org/webt/jn/gi/4m/jngi4mnuto0wqg0wgq6bg7bauzm.png" width="250" align="right"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto outras empresas discutem o gerenciamento remoto da equipe, n√≥s da Smart Engines continuamos compartilhando nossa pilha de tecnologias com voc√™. Hoje sobre a otimiza√ß√£o de redes neurais. √â extremamente dif√≠cil criar um sistema de reconhecimento baseado em redes neurais que possam funcionar rapidamente em smartphones e outros dispositivos m√≥veis. E garantir que a qualidade seja alta √© ainda mais dif√≠cil. Neste artigo, falaremos sobre um m√©todo simples de regulariza√ß√£o de redes neurais que usamos nos Smart Engines para melhorar a qualidade das redes "m√≥veis" com um pequeno n√∫mero de par√¢metros. A id√©ia do m√©todo baseia-se em uma diminui√ß√£o gradual da depend√™ncia linear dos filtros nas camadas convolucionais durante o treinamento, devido √† qual cada neur√¥nio trabalha com mais efici√™ncia e, portanto, a capacidade de generaliza√ß√£o do modelo √© aprimorada.Para isso, apresentamos filtros na forma de vetores unidimensionais e ortogonalizamos um par com o maior comprimento de proje√ß√£o um sobre o outro.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao projetar a maioria das redes neurais modernas, entende-se que elas ser√£o executadas em algum lugar remotamente no servidor e os dados para processamento ser√£o enviados pelo cliente em um PC ou dispositivo m√≥vel. No entanto, essa abordagem √© inaceit√°vel quando se trata da seguran√ßa dos dados pessoais que voc√™ n√£o deseja transferir para outro lugar (por exemplo, uma foto de passaporte ou um cart√£o banc√°rio para reconhecimento). Felizmente para n√≥s, hoje os dispositivos m√≥veis t√™m capacidade suficiente para executar redes neurais, para que voc√™ possa evitar o envio de dados a terceiros. Outra coisa √© que essas redes devem ser pequenas e conter um pequeno n√∫mero de opera√ß√µes para n√£o testar a paci√™ncia do usu√°rio. Tais condi√ß√µes limitam a qualidade m√°xima alcan√ß√°vel de seu trabalho,e como melhorar redes leves sem sacrificar o tempo de execu√ß√£o √© uma quest√£o em aberto. Refletindo sobre isso, criamos um novo m√©todo de regulariza√ß√£o em redes neurais, focado em redes compactas e consistindo na ortogonaliza√ß√£o de filtros convolucionais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A publica√ß√£o √© uma vers√£o curta do relat√≥rio "Regulariza√ß√£o convencional de pesos de redes neurais via ortogonaliza√ß√£o", apresentado em novembro de 2019 na confer√™ncia internacional ICMV 2019, Amsterd√£, Holanda.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A id√©ia de regulariza√ß√£o usando ortogonaliza√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o m√©todo proposto se refere √† regulariza√ß√£o, primeiro recordamos brevemente o que √©. A regulariza√ß√£o consiste em impor algumas restri√ß√µes ao modelo com base em nossas id√©ias sobre como a tarefa deve ser resolvida. Como resultado, a capacidade de generaliza√ß√£o da rede √© aumentada. Por exemplo, a regulariza√ß√£o de L1 contribui para zerar parte da balan√ßa, fazendo com que a rede seja descarregada, L2 - mant√©m coeficientes em pequenos n√∫meros, o abandono elimina as depend√™ncias de neur√¥nios individuais, etc. Esses m√©todos s√£o parte integrante do processo de aprendizado de muitas redes modernas, especialmente se elas contiverem um grande n√∫mero de par√¢metros - a regulariza√ß√£o permite lidar razoavelmente bem com a reciclagem.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, de volta ao nosso m√©todo. </font><font style="vertical-align: inherit;">N√≥s fazemos uma reserva imediatamente que, em primeiro lugar, consideramos o problema de classificar imagens com uma rede neural convolucional. </font><font style="vertical-align: inherit;">A suposi√ß√£o, com base na qual chegamos ao uso da ortogonaliza√ß√£o, √© a seguinte: se a rede √© extremamente limitada em seus recursos para o conceito de padr√µes nos dados, ent√£o cada neur√¥nio nela deve funcionar da maneira mais eficiente poss√≠vel e para que desempenhe a fun√ß√£o estritamente atribu√≠da a ela. </font><font style="vertical-align: inherit;">Em outras palavras, para que "ligue" caracter√≠sticas que qualquer outro neur√¥nio n√£o consiga detectar. </font><font style="vertical-align: inherit;">Resolvemos esse problema reduzindo gradualmente a rela√ß√£o linear entre os vetores de peso dos neur√¥nios durante o treinamento. </font><font style="vertical-align: inherit;">Para isso, modificamos o algoritmo de ortogonaliza√ß√£o cl√°ssico, adaptando-o √†s realidades do processo de aprendizagem.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ortogonaliza√ß√£o do filtro de convolu√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Defina os filtros da camada convolucional como um conjunto de vetores </font></font><img src="https://habrastorage.org/webt/_d/gd/_l/_dgd_lsccqslwex9nbmw_mjgcqe.png" width="113"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, onde </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o √≠ndice da camada convolucional e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o n√∫mero de filtros nela. Depois que os pesos foram atualizados durante a propaga√ß√£o posterior do erro, em cada camada convolucional individual, procuramos um par de vetores com um comprimento m√°ximo de proje√ß√£o um em cima do outro: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p9/ll/jy/p9lljy3d6hqq6zx1winyzy2idma.png" width="319"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A proje√ß√£o do vetor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode ser calculada como </font></font><img src="https://habrastorage.org/webt/4z/ng/sq/4zngsqbavo-xttuhor2pr8ajt7e.png" width="127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ent√£o, a fim de orthogonalize os filtros </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></i><sub><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , substitu√≠mos o primeiro passo do algoritmo de Gram-Schmidt com a </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-2/o5/zd/-2o5zd8h5qajfjuopfh9lv-z27w.png" width="121"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seguinte f√≥rmula: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-w/2e/hm/-w2ehmsvfheeifgphlsogdm7y-m.png" width="180"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
onde </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© a velocidade de aprendizagem e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de mosto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coeficiente de ortogonaliza√ß√£o, cujos valores est√£o no intervalo [0,0, 1,0]. </font><font style="vertical-align: inherit;">A introdu√ß√£o do coeficiente de ortogonaliza√ß√£o se deve ao fato de que a ortogonaliza√ß√£o "instant√¢nea" dos filtros interrompe bastante o processo de aprendizado, negando as altera√ß√µes sistem√°ticas nos pesos nas itera√ß√µes anteriores. </font><font style="vertical-align: inherit;">Os pequenos valores de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> preservam a din√¢mica do aprendizado e contribuem para uma diminui√ß√£o suave na rela√ß√£o linear entre os filtros em cada camada separadamente. </font><font style="vertical-align: inherit;">Observamos mais uma vez um ponto importante no m√©todo: em uma itera√ß√£o, modificamos apenas um vetor para n√£o prejudicar o algoritmo de otimiza√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jn/gi/4m/jngi4mnuto0wqg0wgq6bg7bauzm.png" width="300"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">Visualiza√ß√£o de uma itera√ß√£o.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consideramos apenas a ortogonaliza√ß√£o de filtros convolucionais, j√° que nas redes neurais modernas as camadas convolucionais comp√µem uma grande parte da arquitetura. </font><font style="vertical-align: inherit;">No entanto, o algoritmo √© facilmente generalizado para os pesos dos neur√¥nios em camadas totalmente conectadas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experi√™ncias</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passamos da teoria para a pr√°tica. </font><font style="vertical-align: inherit;">Para experimentos, decidimos usar os 2 conjuntos de dados mais populares para avaliar redes neurais no campo da vis√£o computacional - MNIST (classifica√ß√£o de imagens de n√∫meros escritos √† m√£o) e CIFAR10 (fotos de 10 classes - barcos, caminh√µes, cavalos, etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como assumimos que a ortogonaliza√ß√£o ser√° √∫til principalmente para redes compactas, adotamos uma arquitetura do tipo LeNet em 3 modifica√ß√µes, que diferem entre si no n√∫mero de filtros nas camadas convolucionais. </font><font style="vertical-align: inherit;">A arquitetura de nossa rede, que ser√° chamada LeNet 1.0 por conveni√™ncia, √© mostrada na Tabela 1. As arquiteturas LeNet 2.0 e LeNet 3.5 derivadas dela s√£o distinguidas por um grande n√∫mero de filtros em camadas convolucionais, 2 e 3,5 vezes, respectivamente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escolhendo a fun√ß√£o de ativa√ß√£o, paramos na ReLU n√£o apenas porque √© a fun√ß√£o mais popular e computacionalmente eficiente (lembramos que ainda estamos falando de redes r√°pidas). </font><font style="vertical-align: inherit;">O fato √© que o uso de fun√ß√µes lineares n√£o por partes nega o efeito da ortogonaliza√ß√£o: por exemplo, a tangente hiperb√≥lica distorce fortemente os vetores de entrada, pois possui uma n√£o linearidade pronunciada em regi√µes pr√≥ximas √† satura√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabela 1. Arquitetura de rede LeNet 1.0 usada nas experi√™ncias.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Camadas</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um tipo</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fun√ß√£o de </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ativa√ß√£o</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 filtros 3x3, passada 1x1, sem preenchimento</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 filtros 5x5, passada 2x2, preenchimento 2x2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 filtros 3x3, passada 1x1, preenchimento 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filtros 5x5, passada 2x2, preenchimento 2x2</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filtros 3x3, passada 1x1, preenchimento 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conv</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32 filtros 3x3, passada 1x1, preenchimento 1x1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relu</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">totalmente conectado</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 neur√¥nios</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Softmax</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentamos 3 valores do coeficiente de ortogonaliza√ß√£o do </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : 0,01, 0,05, 0,1. </font><font style="vertical-align: inherit;">Todas as experi√™ncias foram realizadas 10 vezes e os resultados foram calculados como m√©dia (o desvio padr√£o ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) para a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro √©</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mostrado na tabela com os resultados). </font><font style="vertical-align: inherit;">Tamb√©m calculamos quantos por cento o n√∫mero de erros ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">diminuiu </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os resultados experimentais confirmaram que quanto maior a melhora ortogonalizada, menores os par√¢metros na rede (tabelas 2 e 3). </font><font style="vertical-align: inherit;">Tamb√©m obtivemos um resultado interessante de que o uso da ortogonaliza√ß√£o no caso de redes ‚Äúpesadas‚Äù leva a baixa qualidade. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabela 2. Resultados experimentais para MNIST</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mnist</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 1.0 (52k par√¢metros)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 2.0 (179k par√¢metros)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 3.5 (378k par√¢metros)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha de base</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,402%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,033</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,366%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,026</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,361%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,028</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,379%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,027</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5,72%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,355%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,01%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,359%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,026</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,55%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,05</font></font></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,36%</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,022</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10,45%</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,354%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,018</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,28%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,356%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,034</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,39%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,368%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,015</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8,46%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,53%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,024</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,55%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,335%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,018</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,22%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tabela 3. Resultados experimentais do CIFAR10</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cifar10</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 1.0 (52k par√¢metros)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 2.0 (179k par√¢metros)</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LeNet 3.5 (378k par√¢metros)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taxa de erro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">std</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benef√≠cio</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linha de base</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22,09%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,65</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18,49%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17,08%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,47</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,01</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21,56%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,86</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,38%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18,14%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,65</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,89%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17,33%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,49</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-1,46%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,05</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21,59%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,48</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,24%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18,30%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,57</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,03%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17,59%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,31</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-3,02%</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosto = 0,1</font></font></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21,54%</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,41</font></font></b></td>
<td><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,48%</font></font></b></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18,15%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,53</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1,85%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17,53%</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0,4</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-2,63%</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, as redes LeNet agora s√£o raras e modelos mais modernos s√£o geralmente usados. Portanto, tamb√©m experimentamos o modelo ResNet, facilitado pelo n√∫mero de filtros, composto por 25 camadas convolucionais. As primeiras 7 camadas continham 4 filtros, as pr√≥ximas 12 por 8 filtros e as √∫ltimas 6 por 16 filtros. O n√∫mero total de par√¢metros treinados para este modelo foi de 21 mil. O resultado foi semelhante: a ortogonaliza√ß√£o melhora a qualidade da rede. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nq/va/fx/nqvafx4up03rmco1l7hpopikllg.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FIG. Compara√ß√£o da din√¢mica de aprendizado ResNet no MNIST com e sem ortogonaliza√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar das melhorias alcan√ßadas na qualidade, para total confian√ßa na opera√ß√£o correta do m√©todo proposto, voc√™ precisa ver quais altera√ß√µes ocorreram nos pr√≥prios filtros. </font><font style="vertical-align: inherit;">Para isso, os valores do comprimento m√°ximo de proje√ß√£o do filtro nas camadas 2, 12 e 25 da ResNet foram baixados para todas as √©pocas do treinamento. </font><font style="vertical-align: inherit;">Damos a din√¢mica das mudan√ßas nos gr√°ficos abaixo. </font><font style="vertical-align: inherit;">O mais importante aqui √© que, em todas as camadas, h√° uma diminui√ß√£o na depend√™ncia linear dos filtros. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/g3/2a/gwg32aillxqsf-mrg0owpybr0yq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FIG. </font><font style="vertical-align: inherit;">Din√¢mica das altera√ß√µes no comprimento m√°ximo de proje√ß√£o dos filtros em uma camada convolucional usando o ResNet como exemplo. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A regulariza√ß√£o baseada em ortogonaliza√ß√£o √© extremamente f√°cil de implementar: no python, usando o m√≥dulo numpy, s√£o necess√°rios menos de 10 linhas de c√≥digo. </font><font style="vertical-align: inherit;">Ao mesmo tempo, n√£o retarda o treinamento e √© compat√≠vel com outros m√©todos de regulariza√ß√£o.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar de sua simplicidade, a ortogonaliza√ß√£o ajuda a melhorar a qualidade das redes "leves", que imp√µem restri√ß√µes ao tamanho e velocidade da execu√ß√£o. </font><font style="vertical-align: inherit;">Devido √† prolifera√ß√£o de tecnologias m√≥veis, essas restri√ß√µes s√£o cada vez mais comuns: uma rede neural n√£o deve ser executada em algum lugar da nuvem, mas diretamente em um dispositivo com um processador fraco e pouca mem√≥ria. </font><font style="vertical-align: inherit;">O treinamento dessas redes √© contr√°rio √†s tend√™ncias modernas da ci√™ncia das redes neurais, onde s√£o usados ‚Äã‚Äãativamente conjuntos de modelos com milh√µes de par√¢metros treinados que nenhum smartphone pode puxar. </font><font style="vertical-align: inherit;">√â por isso que, no quadro da solu√ß√£o de problemas industriais, √© extremamente importante inventar e desenvolver m√©todos para melhorar a qualidade de redes simples e r√°pidas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista de fontes utilizadas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alexander V. Gayer, Alexander V. Sheshkus, "Rede neural convolucional pondera√ß√£o regulariza√ß√£o via ortogonaliza√ß√£o", Proc. </font><font style="vertical-align: inherit;">SPIE 11433, D√©cima Segunda Confer√™ncia Internacional sobre Vis√£o de M√°quina (ICMV 2019), 1143326 (31 de janeiro de 2020); </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://doi.org/10.1117/12.2559346</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt495804/index.html">M√°quina de arcade DIY em casa</a></li>
<li><a href="../pt495806/index.html">Universidade Carnegie - Mellon desenvolve aplicativo de an√°lise de voz de pacientes COVID-19</a></li>
<li><a href="../pt495808/index.html">Como modelar uma fuselagem de uma aeronave - depende do n√∫cleo geom√©trico</a></li>
<li><a href="../pt495812/index.html">Loja online Blazor Client Side: Parte 5 - Veja a Lixeira e Trabalhe com Estado</a></li>
<li><a href="../pt495814/index.html">V√°rios servi√ßos SaaS para comunica√ß√£o remota em uma organiza√ß√£o</a></li>
<li><a href="../pt495820/index.html">Transferimos estudantes para udalenka em 1 dia</a></li>
<li><a href="../pt495822/index.html">O que pensar ao implementar o dever</a></li>
<li><a href="../pt495834/index.html">Eventos digitais em Moscou, de 6 a 12 de abril</a></li>
<li><a href="../pt495836/index.html">Eventos digitais em S√£o Petersburgo, de 6 a 12 de abril</a></li>
<li><a href="../pt495838/index.html">PHP Digest No. 177 (23 de mar√ßo a 6 de abril de 2020)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>