<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐜 🚦 🛁 では、電卓でWindows 10を実行したいですか？はい 🔶 👨🏽‍🍳 🦁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows 10 IoTオペレーティングシステム
 
 でのHP Prime G2 HP Prime G2が登場する前に、標準の計算機でWindowsを起動することを夢見ていました。このような強力なハードウェアを搭載した電卓は、市場に出たことがない。さらに重要なことに、HPはARMv7-Aプロセ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>では、電卓でWindows 10を実行したいですか？はい</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477250/"><img src="https://habrastorage.org/getpro/habr/post_images/fe4/6d6/924/fe46d6924a00ceba7cc025e97391dea3.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10 IoTオペレーティングシステム</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
でのHP Prime G2 HP Prime G2が登場する前に、標準の計算機でWindowsを起動することを夢見ていました。</font><font style="vertical-align: inherit;">このような強力なハードウェアを搭載した電卓は、市場に出たことがない。</font><font style="vertical-align: inherit;">さらに重要なことに、HPはARMv7-Aプロセッサを選択しました。</font><font style="vertical-align: inherit;">この記事では、デバイスにUEFIとACPIをインストールする方法について説明します。</font></font><br>
<a name="habracut"></a><br>
<img src="https://habrastorage.org/getpro/habr/post_images/83c/1bc/19e/83c1bc19e073de4640016ff7d896d798.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HP Prime G2のSoC仕様。</font><font style="vertical-align: inherit;">SoC NXP i.MX 6ULL​​（Ultra Lite）にはシングルコアCortex A7プロセッサーが搭載されています</font></font></font></i><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前作</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私の友人の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウェンシンチャン（Zephray）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、GPIOと電卓の技術的特性のリバースエンジニアリングの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本的な作業</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を行いました。さらに、</font><font style="vertical-align: inherit;">稼働中の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">U-Boot</font></a><font style="vertical-align: inherit;">と</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Linux</font></a><font style="vertical-align: inherit;">を電卓</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に移植すること</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">成功し</font></a><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">TI-Planetに</font></a><font style="vertical-align: inherit;"> 
よれば</font><font style="vertical-align: inherit;">、計算機はSD / MMC、JTAG、UARTを含む多数のテストピンを提供します。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Sarah（winocm）</font></a><font style="vertical-align: inherit;">は、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20161117080301/"><font style="vertical-align: inherit;">Qemu</font></a><font style="vertical-align: inherit;">プラットフォームでWindows RTを実行する可能性を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20161117080301/"><font style="vertical-align: inherit;">調査し</font></a><font style="vertical-align: inherit;">ました</font><font style="vertical-align: inherit;">。 2019年までに何かが変わったが、記事はその価値を失っていない。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20161117080301/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイクロソフトは、iMX SoCチップ上のWindows 10 IoTのサポートを提供するNXP契約を締結しました。</font><font style="vertical-align: inherit;">したがって、技術的には、Windows 10 IoTはこの電卓で動作するはずです（ARM上のWindowsも同様です）。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windowsシステム要件を調整する</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows 10ファミリーのOSを実行するためのシステム要件は</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Microsoft Docs Webサイトにリストされています</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">最も最小限の要件でさえLinuxを超えています。システムにはx86 / x64 / ARMv7 / AArch64プロセッサ、少なくとも256 MBのメモリと2 GBのディスク容量が必要です。</font><font style="vertical-align: inherit;">機能するUEFIファームウェア、完全なACPIおよびSMBIOSテーブルが必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
今回のケースでは、デバイスに十分なスペースがありません（WindowsもRaw SLC NANDをサポートしていません）が、USB経由でブートデバイスを計算機に接続できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saraは、ARMv7がWindowsを実行するためのアーキテクチャ要件を示しています。</font><font style="vertical-align: inherit;">ここ数年で、要件は少し変化しました。現時点での要件は次のとおりです。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システムプロセッサ：VFPv3 + VFP HalfPrec、VFPv4を備えたARMv7-A互換プロセッサも適しています</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メモリ：少なくとも256 MBのRAM（おそらくそれより少ない）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
周辺機器：</font></font><font></font>
    -   (  ,   )<font></font>
    - ARM Generic Interrupt Controller (GIC)  Broadcom Interrupt Controller  BCM2835/2836/2837,  CPU  Distributor Interface.       GIC,  GICv2  <font></font>
    - <font></font>
    -  UART,  NS16550, BCM283x,    (  Qualcomm  NXP)<font></font>
    - : UEFI 2.3  </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの計算機はこれらの厳しい要件を満たしています。</font><font style="vertical-align: inherit;">ただし、デフォルトのSoCは396 MHzで実行されます。これは、400 MHz / 1 GHzの基本レベルよりも低くなります。</font><font style="vertical-align: inherit;">250 MBのシステムメモリも報告されますが、UIを備えたシステムの最小要件は512 MBです。</font><font style="vertical-align: inherit;">でもロード中です！</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/819/146/370/8191463700b55caf66ef3589cfb3306a.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WinDbgのcpuinfoによると、SoCは396 MHzで動作</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
するため、要件をさらに減らすことができると思います。</font><font style="vertical-align: inherit;">私の記憶が正しければ、Windows Server Nanoにはamd64システムで起動するための約150 MBのメモリがあります。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UEFIとACPI</font></font></h1><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UEFIの実装</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
について何度か書いている</font><font style="vertical-align: inherit;">ので、ここでは何も新しいことはありません。</font><font style="vertical-align: inherit;">基本的に、UEFIは一連のデバイスドライバーと</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TianoCore</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネル</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">コンポーネントで構成されます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ACPIテーブルは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows IoT iMX Project Mu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リポジトリからコピーされ、</font><font style="vertical-align: inherit;">トリミングされます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UEFIは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U-Boot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">起動し</font></a><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">デフォルトでは、iMXは非整列メモリへのアクセスを許可していません。これにより、UEFI DXEおよびBDSステージ中に多くの問題が発生するため、できるだけ早く有効にする必要があります。</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mrc p15、0、r0、c1、c0、0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 bic r0、r0、＃2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 mcr p15、0、r0、c1、c0、0</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
浮動小数点のハードウェアサポートを備えたコンパイラは、ブートローダーを約30秒から4秒に高速化します。</font><font style="vertical-align: inherit;">ARMv7プラットフォームでは、WindowsはVFPv3 +のサポートを主張しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
画面の初期化と一部のI / Oマルチプレクサの割り当ては、U-Bootで行われます。</font><font style="vertical-align: inherit;">U-Bootは24 / 32bppのシリアルRGB LCDインターフェイスをサポートしていないため、LinuxカーネルにiMXフレームバッファーを実装してシリアルRGBのサポートを追加しました。</font><font style="vertical-align: inherit;">コードはまだウィザードにはありませんが、後で渡します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ry/yc/dw/ryycdw-dae7kuyg1e04tqc4mdom.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LCDが動作するようです。</font><font style="vertical-align: inherit;">手順全体：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ubootを起動します。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画面のバックライトのピンを見つけます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPIおよびLCD初期化シーケンスのピンを見つけます。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I2Cピンを見つけ、I2Cを介してPMICを正しい電圧に設定します。</font></font></li>
</ol><br>
<img src="https://habrastorage.org/webt/9x/kb/be/9xkbbekvqzc21vlimqughncfygo.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U-Boot</font></font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
UEFI</font><i><font color="gray"><font style="vertical-align: inherit;">のシリアルRGB LCDインターフェイスのデモは、U-Boot</font></font></i><font style="vertical-align: inherit;">によって割り当てられたフレームバッファーを取得し、グラフィックス出力プロトコルを登録するだけです。残念ながら、画面解像度は80 * 25コンソールの最小要件を満たしていないため、新しい40 * 12モードを追加してコンソールDXEコンポーネントを変更しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/in/5u/5n/in5u5nj6i7w-6al9z356l3bxhcq.jpeg"><br>
<font color="gray"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EDK2コンポーネントは、画面解像度が80 * 25コンソールの最小要件を満たしていないと主張しています</font></font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンソールコンポーネントをハックする前に、ちょっとしたトリックを行い、640 * 480の解像度をUEFI GOPプロトコルに修正しました。このトリックは、320 * 240の解像度ではエラーコードを表示するのに十分ではないため、Windowsブートマネージャーから診断情報を取得するのにも役立ちました。フレームバッファーからファイルシステムへのブロック転送（BLT）を定期的に実行し、BMPファイルをUSBドライブに保存します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qu/qy/at/quqyatdtrwf-sr8ibwmty1cm5nu.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハックにより、80 * 25モードが使用可能になり、グラフィックアーティファクトがいくつか</font></font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
追加されます</font><i><font color="gray"><font style="vertical-align: inherit;">。</font></font></i><font style="vertical-align: inherit;">新しいモードに接続すると、画質が大幅に向上します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/x6/js/9x/x6js9xbo_ietmgqnihcr5aocayk.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40 * 12モード40 * 12 </font></font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/93/3t/a2/933ta2c6xtz1edrjqqqvb6_ouzw.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モード</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは、320 * 240でのWindowsブートマネージャーメッセージの外観です</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pt/wl/gc/ptwlgcqlzye8ykjmfv-fdxz5rlw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。最初の試行は、UEFIブートサービスステージで失敗します。画面が小さいため、エラーコードは表示されません。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zv/0v/8z/zv0v8zpumqqaynhcmuovmdq7r6c.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フレームバッファーからのブロック転送（BLT）により、メッセージを画像ファイルに保存して読み取ることができます</font></font></font></i> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
USBサポートについて。</font><font style="vertical-align: inherit;">さいわい、iMX6のUSBは完全に準拠しており、最新バージョンのWindowsにはサポートが含まれています。</font><font style="vertical-align: inherit;">したがって、OTGコントローラーをホストモードで構成し、MMIO領域をUEFIおよびWindowsに転送するとすぐに、魔法のように問題なく動作します。</font><font style="vertical-align: inherit;">しかし、OTGポートにVBusが見つかりませんでした（SoCまたはPMICによって制御されるある種のDC-DC回路があると想定していますが、これは検証されていない仮説にすぎません）。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMBIOS</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SMBIOSでメモリサイズとアドレス領域を正しく報告していることを確認してください。そうしないと、Windowsが信じられないほど奇妙なこと（tm）を開始します。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/76c/b12/4cd/76cb124cd519c4b280c9170f38379dc6.jpg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMBIOS構成が正しくないため、Windowsデバッガーはメモリを読み取れません</font></font></font></i><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイマーとHAL拡張</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メモリ構成（LPAE）は処理できるようですが、おそらく他の問題が発生するでしょう。</font><font style="vertical-align: inherit;">ああそう... </font></font><br>
<br>
<img src="https://habrastorage.org/webt/80/nr/0i/80nr0iilsuwgzgkqvs2edu0fv1i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで、これまでのところWindowsをロードすることはこの段階に達するだけです。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/6e/ve/ta/6evetavhyuog9s7uyuirhxku6e8.png"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適切なシステムタイマーが見つからない場合、Windowsは想定された無効なメモリアドレスを参照します。</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
割り込みコントローラーまたはシステムタイマーが見つからない限り、Windowsは起動しません。</font><font style="vertical-align: inherit;">システム時間は、GTDTテーブル（ARMアーキテクチャテーブル）またはCSRTテーブルを介したHAL拡張を使用して登録できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
iMX6ULLには、iMX GPT（汎用目的タイマー）、EPIT（拡張周期タイマー）、およびARMアーキテクチャータイマーの3つのタイマーが付属しています。後者はiMX6UL / ULLでのみ登場しましたが、以前のiMX6 SoCシステムはアーキテクチャタイマーをサポートせずにCortex A15などの古いカーネルで動作していました。 MicrosoftはシステムタイマーにEPIT HAL拡張を実装しましたが、CSRTテーブルのハードウェア識別子とシステムイメージが一致しないため、最初はロードされませんでした（iMX6 Soloの以前のFFUをダウンロードしました）。したがって、タイマーが利用できない場合、Windowsは意図したタイマーを初期化しようと必死になり、無効なメモリアクセスが原因でシステムがクラッシュします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
iMX6ULLのドキュメントでは、アーキテクチャタイマーについて言及していますが、初期化手順の詳細はありません。</font><font style="vertical-align: inherit;">タイマーカウンターはEDK2で初期化できますが、GIC PPI（プロセッサごとの割り込み）は正しく機能しません。</font><font style="vertical-align: inherit;">ただし、Windowsは正常に初期化され、GTDTテーブルを介してタイマーを使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UEFIは現在、EPITタイマーを使用しており、Windowsへの転送時にそれを無効にします。</font><font style="vertical-align: inherit;">次に、WindowsはGPTタイマーを初期化します。</font><font style="vertical-align: inherit;">後の時点で、UEFIは適切な初期化手順でGPTに切り替えることもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
周辺機器によっては、スマートDMA（SDMA）コントローラー用のHAL拡張機能が必要ですが、ダウンロードするのはそれほど難しくありません。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕組みを教えてください！</font></font></h1><br>
<pre>[Security] 3rd party image[0] can be loaded after EndOfDxe: VenHw(0D51905B-B77E-452A-A2C0-ECA0CC8D514A,004118020000000000)/USB(0x0,0x0)/USB(0x2,0x0)/HD(1,GPT,F9ADAEA9-E8DE-4291-B191-5DABA6DC1215,0x800,0x100000)/\efi\boot\bootarm.efi.<font></font>
 InstallProtocolInterface: 5B1B31A1-9562-11D2-8E3F-00A0C969723B 8F257028<font></font>
 ConvertPages: failed to find range 10000000 - 100EEFFF<font></font>
 Loading driver at 0x0008E9D6000 EntryPoint=0x0008E9E7511 bootmgfw.efi<font></font>
 InstallProtocolInterface: BC62157E-3E33-4FEC-9920-2D3B36D750DF 8F28EB10<font></font>
 ProtectUefiImageCommon - 0x8F257028<font></font>
 0x000000008E9D6000 - 0x00000000000EF000<font></font>
 InstallProtocolInterface: 752F3136-4E16-4FDC-A22A-E5F46812F4CA 8FBFF88C<font></font>
 ConvertPages: failed to find range 102000 - 102FFF<font></font>
 Disabling EPIT timer on ExitBootServicesEventSetUefiImageMemoryAttributes - 0x000000008F78A000 - 0x0000000000003000 (0x0000000000000008)<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F787000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F784000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F77F000-0x0000000000005000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F77C000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F779000-0x0000000000003000（0x0000000000000008）</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それがどれほどゆっくりとロードされるのか疑問に思ったら、約3分半です。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2倍速のビデオ：</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6ThQ51FxfcM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">セキュアブートとTPMはどこにありますか？</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは実際には必要ありません。</font><font style="vertical-align: inherit;">ただし、OP-TEEはiMX6 / 7/8をサポートしているため、TrustZone（TZ）でSecure Monitorを実行し、EL1 / PL1からの呼び出し（Secure Monitor Calls）を介してこれらのサービスを実装できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、iMX Windows IoTの公式実装にはOP-TEEが付属していますが、メモリを節約するために無視しました。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドライバーはどうですか？</font></font></h1><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows 10 IoT BSP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
リポジトリに</font><font style="vertical-align: inherit;">は、iMX6 / 7/8用の多くのドライバーが含まれてい</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">すでに述べたように、USBドライバーはそのまま使用できます。</font><font style="vertical-align: inherit;">電卓にはタッチスクリーンドライバーとキーボードも必要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらはLinuxカーネルツリーで利用できるので、Windowsに移植するのはそれほど難しくありません。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows RT 8.1をダウンロードできますか？</font></font></h1><br>
<s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">たぶん</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">更新：Windows RT 8.1は起動せず、新しいバージョンのみが起動します。</font><font style="vertical-align: inherit;">256 MBのメモリでは不十分なため、Windows PEはRAMディスクモードでは起動しません。</font><font style="vertical-align: inherit;">フラットブートモードを開始できませんでした。デバイス（USBドライブを含む）を一覧表示した後、初期化せずに何らかのサイクルに入ります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/8q/oi/do/8qoidosbunc7xdy8ogqrcygg28o.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HP Prime G2がロードされたWindowsは、電卓で電卓アプリケーション</font></font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/os/h7/la/osh7ladn3vfqypyeexumq09kgvo.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notepad </font></font></font></i><font style="vertical-align: inherit;"><i><font color="gray"><font style="vertical-align: inherit;">を起動し</font></font></i><i><font color="gray"><font style="vertical-align: inherit;">ました。電卓の</font></font></i></font><br>
<br>
<img src="https://habrastorage.org/webt/vz/k0/e2/vzk0e2vi2huuhj5okxqym6jn5ge.jpeg"><br>
<i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notepadはテキストを送信して印刷しようとしています</font></font></font></i><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、私もLinuxを起動したいと思います！</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つのオプションがあります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U-Bootを使用してzImage、デバイスツリー、およびinitrdを起動するだけです。</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FD、MpPark、およびFrameBufferメモリ領域をシステムメモリの最上部に移動し、下位のメモリ領域に128 MBの空きを残します。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
LinuxをGRUB経由で、またはEFISTUBから直接ダウンロードします。</font><font style="vertical-align: inherit;">すべてが正常に読み込まれています。ここにログの断片があります：</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EFIスタブ：ブートサービスの終了と仮想アドレスマップのインストール...</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 ExitBootServicesEventSetUefiImageMemoryAttributesでEPITタイマーを無効にする-0x000000008F97B000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F978000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F973000-0x0000000000005000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F970000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F96D000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 SetUefiImageMemoryAttributes-0x000000008F96A000-0x0000000000003000（0x0000000000000008）</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 物理CPU 0x0でのLinuxの起動</font></font><font></font>
 Linux version 4.14.98-g371433a62906-dirty (imbushuo@bc-macbookpro) (gcc version 7.4.1 20181213 [linaro-7.4-2019.02 revision 56ec6f6b99cc167ff0c2f8e1a2eed33b1edc85d4] (Linaro GCC 7.4-2019.02)) #2 PREEMPT Thu Nov 14 03:10:29 EST 2019<font></font>
 CPU: ARMv7 Processor [410fc075] revision 5 (ARMv7), cr=10c53c7d<font></font>
 CPU: div instructions available: patching division code<font></font>
 CPU: PIPT / VIPT nonaliasing data cache, VIPT aliasing instruction cache<font></font>
 OF: fdt: Machine model: HP Prime G2 Calculator<font></font>
 Memory policy: Data cache writeback<font></font>
 efi: Getting EFI parameters from FDT:<font></font>
 efi: EFI v2.70 by EDK II<font></font>
 efi:  ACPI 2.0=0x8f49b000  SMBIOS=0x8f9a8000  SMBIOS 3.0=0x8f9a6000<font></font>
 OF: reserved mem: failed to allocate memory for node 'linux,cma'<font></font>
 CPU: All CPU(s) started in SVC mode.<font></font>
 Built 1 zonelists, mobility grouping on.  Total pages: 64516<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 カーネルコマンドライン：zImage.efi root = / dev / ram0 rw initrd = / rootfs.cpio.gz dtb = / imx6ull-14x14-prime.dtb</font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NXP Linux構成を使用する場合、デバイスツリーまたは事前定義された構成パラメーターからinitrdメモリアドレスを読み取り、UEFIの他の場所にinitrdがロードされるため、カーネルがクラッシュします。</font><font style="vertical-align: inherit;">これらのパラメーターを削除し、構成をより一般的なものにする必要があります。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">しかし、なぜ？</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人々はさまざまなデバイスでWindowsを実行することについて話しているので、年末までにそれらを荒らしたいと思います。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他のプロジェクトはどうですか？</font><font style="vertical-align: inherit;">次は何ですか？</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
作業は継続されます。</font><font style="vertical-align: inherit;">また、いくつかのドライバーを実装し、NANDを組み込んだUEFIブートを取得し、計算機用のUEFIブートユーザーフレンドリーインターフェイスを実装し、UEFIからHP PPLストックオペレーティングシステムをロードする可能性を調査する必要があります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja477234/index.html">Мышь, поставившая крест на проводных собратьях</a></li>
<li><a href="../ja477236/index.html">米国の裁判所、州がネットワークの中立性を取り戻すことを許可</a></li>
<li><a href="../ja477238/index.html">カルマに加えて：スタックオーバーフローが批判される理由と、コミュニティの毒性について多くの人が不満を言う理由</a></li>
<li><a href="../ja477242/index.html">ServiceDeskの選択方法。パート3</a></li>
<li><a href="../ja477248/index.html">クラッシュ後にPostgresデータベースを回復した最初の経験（Relattonベース/ 16490のブロック4123007の無効なページ）</a></li>
<li><a href="../ja477252/index.html">ビジネスインキュベーターとアクセラレーターの開発方法：Thomas Edisonの研究室からY Combinatorまで</a></li>
<li><a href="../ja477254/index.html">XSS、CSRF、フラッシュ認証。r0ot-mi Webによる問題解決—クライアント。パート2</a></li>
<li><a href="../ja477256/index.html">ソユーズロケットでのOneWebの最初の本格的な打ち上げは、アンガラロケットの打ち上げと同様に、来年延期されます</a></li>
<li><a href="../ja477262/index.html">Promobot社のAndroid。外からの眺め</a></li>
<li><a href="../ja477264/index.html">掘削機は独立して溝を掘ることができる自律ロボットに変わりました</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>