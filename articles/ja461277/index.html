<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥£ ğŸ˜ƒ ğŸ§‘ğŸ»â€ğŸ¤â€ğŸ§‘ğŸ» ç„¡æ–™ã®SQLIndexManagerãƒ„ãƒ¼ãƒ«ã®æ¦‚è¦ ğŸˆ ğŸš ğŸŒ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ã”å­˜çŸ¥ã®ã‚ˆã†ã«ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯DBMSã§é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã€å¿…è¦ãªãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã™ã°ã‚„ãæ¤œç´¢ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¿ã‚¤ãƒ ãƒªãƒ¼ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã“ã¨ãŒéå¸¸ã«é‡è¦ã§ã™ã€‚åˆ†æã¨æœ€é©åŒ–ã«ã¤ã„ã¦ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’å«ã‚ã€éå¸¸ã«å¤šãã®è³‡æ–™ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚ãŸã¨ãˆã°ã€ã“ã®å‡ºç‰ˆç‰©ã«ãŠã‘ã‚‹ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã®æœ€è¿‘ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡Œ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ç„¡æ–™ã®SQLIndexManagerãƒ„ãƒ¼ãƒ«ã®æ¦‚è¦</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461277/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã”å­˜çŸ¥ã®ã‚ˆã†ã«ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯DBMSã§é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã€å¿…è¦ãªãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã™ã°ã‚„ãæ¤œç´¢ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã‚¿ã‚¤ãƒ ãƒªãƒ¼ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã“ã¨ãŒéå¸¸ã«é‡è¦ã§ã™ã€‚</font><font style="vertical-align: inherit;">åˆ†æã¨æœ€é©åŒ–ã«ã¤ã„ã¦ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’å«ã‚ã€éå¸¸ã«å¤šãã®è³‡æ–™ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°ã€</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã®å‡ºç‰ˆç‰©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã«ãŠã‘ã‚‹ã“ã®ãƒˆãƒ”ãƒƒã‚¯ã®æœ€è¿‘ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ãŒè¡Œã‚ã‚Œã¾ã—ãŸ</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã‚Œã«ã¯æœ‰æ–™ã¨ç„¡æ–™ã®ä¸¡æ–¹ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">ãŸã¨ãˆã°</font><font style="vertical-align: inherit;">ã€é©å¿œã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–æ‰‹æ³•ã«åŸºã¥ã</font><font style="vertical-align: inherit;">ã‚¿ãƒ¼ãƒ³ã‚­ãƒ¼</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŒã‚ã‚Š</font><font style="vertical-align: inherit;">ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¬¡ã«ã€ä»¥ä¸‹</font><font style="vertical-align: inherit;">ã«ã‚ˆã£ã¦ä½œæˆã•ã‚Œ</font><font style="vertical-align: inherit;">ãŸç„¡æ–™ã®</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLIndexManager</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’è€ƒãˆã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ©ãƒ³ãƒ»ãƒ‡ãƒ³ãƒˆãƒ³</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SQLIndexManagerã¨ä»–ã®å¤šãã®é¡ä¼¼ç‰©ã¨ã®ä¸»ãªæŠ€è¡“çš„ãªé•ã„ã¯ã€ä½œè€…è‡ªèº«ãŒ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¨</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã§</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œã£ãŸã‚‚ã®</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ã§ã™</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŒã˜è¨˜äº‹ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã“ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹å¯èƒ½æ€§ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã“ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«ã¤ã„ã¦</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã“ã“ã§</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è­°è«–ã—ã¦</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ãã ã•ã„</font></a><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ™‚é–“ã®çµŒéã¨ã¨ã‚‚ã«ã€ã»ã¨ã‚“ã©ã®ã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒã‚°ãŒä¿®æ­£ã•ã‚Œã¾ã—ãŸã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãã‚Œã§ã¯ã€SQLIndexManagerãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£è‡ªä½“ã«ç§»ã‚Šã¾ã—ã‚‡ã†ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Visual Studio 2017ã®Cï¼ƒ.NET Framework 4.5ã§è¨˜è¿°ã•ã‚Œã¦ãŠã‚Šã€ãƒ•ã‚©ãƒ¼ãƒ ã«DevExpressã‚’ä½¿ç”¨</font><font style="vertical-align: inherit;">
ã—ã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/i0/wo/do/i0wodozvszemgmmash24snfzrgk.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/xc/mf/ac/xcmfacmb7wxiz5pfvg5m2ybyet4.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç´¢å¼•</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ã‚¨ãƒª</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¯ã‚¨ãƒªã‚¨ãƒ³ã‚¸ãƒ³</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ServerInfo</font></font></li>
</ol><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/ya/ox/fo/yaoxfojk1yhfujv5nhu8wxfjx64.jpeg"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¦DBMSã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«ç½²åã•ã‚Œã¾ã™ã€‚</font></font><br>
<br>
<pre><code class="1c hljs">ApplicationName=â€SQLIndexManagerâ€</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã™ã‚‹ã¨ã€æ¥ç¶šã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã“ã“ã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çµŒç”±ã§åˆ©ç”¨ã§ãã‚‹MS SQL Serverã®ã™ã¹ã¦ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å®Œå…¨ãªãƒªã‚¹ãƒˆã®ãƒ­ãƒ¼ãƒ‰ã¯ã“ã“ã§ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">
ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å·¦ç«¯ã®ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦æ¥ç¶šã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">
æ¬¡ã«ã€æ¬¡ã®DBMSã‚¯ã‚¨ãƒªãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/77/kw/uh/77kwuhjmxnartbvfvmpnk8fpi7k.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/id/l0/w_/idl0w_a4afakmyqmegzbrbomksc.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DBMSæƒ…å ±ã®å–å¾—</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> ProductLevel  = SERVERPROPERTY(<span class="hljs-string">'ProductLevel'</span>)<font></font>
     , <span class="hljs-keyword">Edition</span>       = SERVERPROPERTY(<span class="hljs-string">'Edition'</span>)<font></font>
     , ServerVersion = SERVERPROPERTY(<span class="hljs-string">'ProductVersion'</span>)<font></font>
     , IsSysAdmin    = <span class="hljs-keyword">CAST</span>(IS_SRVROLEMEMBER(<span class="hljs-string">'sysadmin'</span>) <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIT</span>)
</code></pre><br>
</div></div></li>
<li><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãã®ç°¡å˜ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> DatabaseName = t.[<span class="hljs-keyword">name</span>]<font></font>
     , d.DataSize<font></font>
     , DataUsedSize  = <span class="hljs-keyword">CAST</span>(<span class="hljs-literal">NULL</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIGINT</span>)<font></font>
     , d.LogSize<font></font>
     , LogUsedSize   = <span class="hljs-keyword">CAST</span>(<span class="hljs-literal">NULL</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIGINT</span>)<font></font>
     , RecoveryModel = t.recovery_model_desc<font></font>
     , LogReuseWait  = t.log_reuse_wait_desc<font></font>
<span class="hljs-keyword">FROM</span> sys.databases t <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> [database_id]<font></font>
         , DataSize = <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> [<span class="hljs-keyword">type</span>] = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">size</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIGINT</span>) <span class="hljs-keyword">END</span>)<font></font>
         , LogSize  = <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> [<span class="hljs-keyword">type</span>] = <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">size</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIGINT</span>) <span class="hljs-keyword">END</span>)
    <span class="hljs-keyword">FROM</span> sys.master_files <span class="hljs-keyword">WITH</span>(NOLOCK)
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> [database_id]<font></font>
) d <span class="hljs-keyword">ON</span> d.[database_id] = t.[database_id]
<span class="hljs-keyword">WHERE</span> t.[state] = <span class="hljs-number">0</span>
    <span class="hljs-keyword">AND</span> t.[database_id] != <span class="hljs-number">2</span>
    <span class="hljs-keyword">AND</span> <span class="hljs-keyword">ISNULL</span>(HAS_DBACCESS(t.[<span class="hljs-keyword">name</span>]), <span class="hljs-number">1</span>) = <span class="hljs-number">1</span>
</code></pre><br>
</div></div></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€MS SQL Serverã®é¸æŠã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«é–¢ã™ã‚‹ç°¡å˜ãªæƒ…å ±ã‚’å«ã‚€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</font><font style="vertical-align: inherit;">
ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚æ‹¡å¼µæƒ…å ±ã¯æ¨©é™ã«åŸºã¥ã„ã¦è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">sysadmin</font></a><font style="vertical-align: inherit;">ãŒã‚ã‚‹å ´åˆã¯</font><font style="vertical-align: inherit;">ã€</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">sys.master_filesãƒ“ãƒ¥ãƒ¼</font></a><font style="vertical-align: inherit;">ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠã§ãã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ãã®ã‚ˆã†ãªæ¨©åˆ©ãŒãªã„å ´åˆã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé…ããªã‚‰ãªã„ã‚ˆã†ã«ã€è¿”ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªããªã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã“ã“ã§ã€ç›®çš„ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠã—ã€ã€ŒOKã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">
æ¬¡ã«ã€é¸æŠã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã”ã¨ã«æ¬¡ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’åˆ†æã—ã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/bc/fy/gz/bcfygzsztslx32ll82uxflshfhi.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†æ</font></font></b><div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword">declare</span> @Fragmentation <span class="hljs-built_in">float</span>=<span class="hljs-number">15</span>;
<span class="hljs-keyword">declare</span> @MinIndexSize <span class="hljs-built_in">bigint</span>=<span class="hljs-number">768</span>;
<span class="hljs-keyword">declare</span> @MaxIndexSize <span class="hljs-built_in">bigint</span>=<span class="hljs-number">1048576</span>;
<span class="hljs-keyword">declare</span> @PreDescribeSize <span class="hljs-built_in">bigint</span>=<span class="hljs-number">32768</span>;<font></font>
<font></font>
<span class="hljs-keyword">SET</span> NOCOUNT <span class="hljs-keyword">ON</span>
<span class="hljs-keyword">SET</span> ARITHABORT <span class="hljs-keyword">ON</span>
<span class="hljs-keyword">SET</span> NUMERIC_ROUNDABORT <span class="hljs-keyword">OFF</span><font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#AllocationUnits'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#AllocationUnits</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#AllocationUnits (</span>
      ContainerID   <span class="hljs-built_in">BIGINT</span> PRIMARY <span class="hljs-keyword">KEY</span>
    , ReservedPages <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , UsedPages     <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span><font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#AllocationUnits (ContainerID, ReservedPages, UsedPages)</span>
<span class="hljs-keyword">SELECT</span> [container_id]<font></font>
     , <span class="hljs-keyword">SUM</span>([total_pages])<font></font>
     , <span class="hljs-keyword">SUM</span>([used_pages])
<span class="hljs-keyword">FROM</span> sys.allocation_units <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> [container_id]
<span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">SUM</span>([total_pages]) <span class="hljs-keyword">BETWEEN</span> @MinIndexSize <span class="hljs-keyword">AND</span> @MaxIndexSize<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#ExcludeList'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#ExcludeList</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#ExcludeList (ID INT PRIMARY KEY)</span><font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#ExcludeList</span>
<span class="hljs-keyword">SELECT</span> [object_id]
<span class="hljs-keyword">FROM</span> sys.objects <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> [<span class="hljs-keyword">type</span>] <span class="hljs-keyword">IN</span> (<span class="hljs-string">'V'</span>, <span class="hljs-string">'U'</span>)
    <span class="hljs-keyword">AND</span> ( [is_ms_shipped] = <span class="hljs-number">1</span> )<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Partitions'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Partitions</span><font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> [object_id]<font></font>
     , [index_id]<font></font>
     , [partition_id]<font></font>
     , [partition_number]<font></font>
     , [<span class="hljs-keyword">rows</span>]<font></font>
     , [data_compression]<font></font>
<span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Partitions</span>
<span class="hljs-keyword">FROM</span> sys.partitions <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> [object_id] &gt; <span class="hljs-number">255</span>
    <span class="hljs-keyword">AND</span> [<span class="hljs-keyword">rows</span>] &gt; <span class="hljs-number">0</span>
    <span class="hljs-keyword">AND</span> [object_id] <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#ExcludeList)</span><font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Indexes'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Indexes</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Indexes (</span>
      ObjectID         <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexID          <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexName        SYSNAME <span class="hljs-literal">NULL</span>
    , PagesCount       <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , UnusedPagesCount <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , PartitionNumber  <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , RowsCount        <span class="hljs-built_in">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , <span class="hljs-keyword">IndexType</span>        <span class="hljs-built_in">TINYINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsAllowPageLocks <span class="hljs-built_in">BIT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , DataSpaceID      <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , DataCompression  <span class="hljs-built_in">TINYINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsUnique         <span class="hljs-built_in">BIT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsPK             <span class="hljs-built_in">BIT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , FillFactorValue  <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsFiltered       <span class="hljs-built_in">BIT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, IndexID, PartitionNumber)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Indexes</span>
<span class="hljs-keyword">SELECT</span> ObjectID         = i.[object_id]<font></font>
     , IndexID          = i.index_id<font></font>
     , IndexName        = i.[<span class="hljs-keyword">name</span>]<font></font>
     , PagesCount       = a.ReservedPages<font></font>
     , UnusedPagesCount = <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">ABS</span>(a.ReservedPages - a.UsedPages) &gt; <span class="hljs-number">32</span> <span class="hljs-keyword">THEN</span> a.ReservedPages - a.UsedPages <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span><font></font>
     , PartitionNumber  = p.[partition_number]<font></font>
     , RowsCount        = <span class="hljs-keyword">ISNULL</span>(p.[<span class="hljs-keyword">rows</span>], <span class="hljs-number">0</span>)<font></font>
     , <span class="hljs-keyword">IndexType</span>        = i.[<span class="hljs-keyword">type</span>]<font></font>
     , IsAllowPageLocks = i.[allow_page_locks]<font></font>
     , DataSpaceID      = i.[data_space_id]<font></font>
     , DataCompression  = p.[data_compression]<font></font>
     , IsUnique         = i.[is_unique]<font></font>
     , IsPK             = i.[is_primary_key]<font></font>
     , FillFactorValue  = i.[fill_factor]<font></font>
     , IsFiltered       = i.[has_filter]<font></font>
<span class="hljs-keyword">FROM</span> <span class="hljs-comment">#AllocationUnits a</span>
<span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Partitions p ON a.ContainerID = p.[partition_id]</span>
<span class="hljs-keyword">JOIN</span> sys.indexes i <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> i.[object_id] = p.[object_id] <span class="hljs-keyword">AND</span> p.[index_id] = i.[index_id] 
<span class="hljs-keyword">WHERE</span> i.[<span class="hljs-keyword">type</span>] <span class="hljs-keyword">IN</span> (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)
    <span class="hljs-keyword">AND</span> i.[object_id] &gt; <span class="hljs-number">255</span><font></font>
<font></font>
<span class="hljs-keyword">DECLARE</span> @files <span class="hljs-keyword">TABLE</span> (<span class="hljs-keyword">ID</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> @files
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> [data_space_id]
<span class="hljs-keyword">FROM</span> sys.database_files <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> [state] != <span class="hljs-number">0</span>
    <span class="hljs-keyword">AND</span> [<span class="hljs-keyword">type</span>] = <span class="hljs-number">0</span><font></font>
<font></font>
<span class="hljs-keyword">IF</span> @@ROWCOUNT &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">BEGIN</span><font></font>
<font></font>
    <span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> i
    <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes i</span>
    <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> sys.destination_data_spaces dds <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> i.DataSpaceID = dds.[partition_scheme_id] <span class="hljs-keyword">AND</span> i.PartitionNumber = dds.[destination_id]
    <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">ISNULL</span>(dds.[data_space_id], i.DataSpaceID) <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> @files)<font></font>
<font></font>
<span class="hljs-keyword">END</span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword">DECLARE</span> @DBID   <span class="hljs-built_in">INT</span><font></font>
      , @DBNAME SYSNAME<font></font>
<font></font>
<span class="hljs-keyword">SET</span> @DBNAME = DB_NAME()
<span class="hljs-keyword">SELECT</span> @DBID = [database_id]
<span class="hljs-keyword">FROM</span> sys.databases <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> [<span class="hljs-keyword">name</span>] = @DBNAME<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Fragmentation'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Fragmentation</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Fragmentation (</span>
      ObjectID         <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexID          <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , PartitionNumber  <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , Fragmentation    <span class="hljs-built_in">FLOAT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, IndexID, PartitionNumber)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Fragmentation (ObjectID, IndexID, PartitionNumber, Fragmentation)</span>
<span class="hljs-keyword">SELECT</span> i.ObjectID<font></font>
     , i.IndexID<font></font>
     , i.PartitionNumber<font></font>
     , r.[avg_fragmentation_in_percent]<font></font>
<span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes i</span>
<span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">APPLY</span> sys.dm_db_index_physical_stats(@DBID, i.ObjectID, i.IndexID, i.PartitionNumber, <span class="hljs-string">'LIMITED'</span>) r
<span class="hljs-keyword">WHERE</span> i.PagesCount &lt;= @PreDescribeSize
    <span class="hljs-keyword">AND</span> r.[index_level] = <span class="hljs-number">0</span>
    <span class="hljs-keyword">AND</span> r.[alloc_unit_type_desc] = <span class="hljs-string">'IN_ROW_DATA'</span>
    <span class="hljs-keyword">AND</span> i.IndexType <span class="hljs-keyword">IN</span> (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Columns'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Columns</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Columns (</span>
      ObjectID     <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , ColumnID     <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , ColumnName   SYSNAME <span class="hljs-literal">NULL</span>
    , SystemTypeID <span class="hljs-built_in">TINYINT</span> <span class="hljs-literal">NULL</span>
    , IsSparse     <span class="hljs-built_in">BIT</span>
    , IsColumnSet  <span class="hljs-built_in">BIT</span>
    , <span class="hljs-keyword">MaxLen</span>       <span class="hljs-built_in">INT</span>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, ColumnID)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Columns</span>
<span class="hljs-keyword">SELECT</span> ObjectID     = [object_id]<font></font>
     , ColumnID     = [column_id]<font></font>
     , ColumnName   = [<span class="hljs-keyword">name</span>]<font></font>
     , SystemTypeID = [system_type_id]<font></font>
     , IsSparse     = [is_sparse]<font></font>
     , IsColumnSet  = [is_column_set]<font></font>
     , <span class="hljs-keyword">MaxLen</span>       = [max_length]
<span class="hljs-keyword">FROM</span> sys.columns <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> [object_id] <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> i.ObjectID <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes i)</span><font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#IndexColumns'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#IndexColumns</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#IndexColumns (</span>
      ObjectID   <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexID    <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , OrderID    <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , ColumnID   <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsIncluded <span class="hljs-built_in">BIT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, IndexID, ColumnID)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#IndexColumns</span>
<span class="hljs-keyword">SELECT</span> ObjectID   = [object_id]<font></font>
     , IndexID    = [index_id]<font></font>
     , OrderID    = <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> [is_included_column] = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> [key_ordinal] <span class="hljs-keyword">ELSE</span> [index_column_id] <span class="hljs-keyword">END</span><font></font>
     , ColumnID   = [column_id]<font></font>
     , IsIncluded = <span class="hljs-keyword">ISNULL</span>([is_included_column], <span class="hljs-number">0</span>)
<span class="hljs-keyword">FROM</span> sys.index_columns ic <span class="hljs-keyword">WITH</span>(NOLOCK)
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span>(
        <span class="hljs-keyword">SELECT</span> *
        <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes i</span>
        <span class="hljs-keyword">WHERE</span> i.ObjectID = ic.[object_id]
            <span class="hljs-keyword">AND</span> i.IndexID = ic.[index_id]
            <span class="hljs-keyword">AND</span> i.IndexType <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<font></font>
    )<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Lob'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Lob</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Lob (</span>
      ObjectID    <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexID     <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IsLobLegacy <span class="hljs-built_in">BIT</span>
    , IsLob       <span class="hljs-built_in">BIT</span>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, IndexID)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Lob (ObjectID, IndexID, IsLobLegacy, IsLob)</span>
<span class="hljs-keyword">SELECT</span> c.ObjectID<font></font>
     , IndexID     = <span class="hljs-keyword">ISNULL</span>(i.IndexID, <span class="hljs-number">1</span>)<font></font>
     , IsLobLegacy = <span class="hljs-keyword">MAX</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> c.SystemTypeID <span class="hljs-keyword">IN</span> (<span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">99</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span>)<font></font>
     , IsLob       = <span class="hljs-number">0</span>
<span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Columns c</span>
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#IndexColumns i ON c.ObjectID = i.ObjectID AND c.ColumnID = i.ColumnID</span>
<span class="hljs-keyword">WHERE</span> c.SystemTypeID <span class="hljs-keyword">IN</span> (<span class="hljs-number">34</span>, <span class="hljs-number">35</span>, <span class="hljs-number">99</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> c.ObjectID<font></font>
       , i.IndexID<font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#Sparse'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Sparse</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#Sparse (ObjectID INT PRIMARY KEY)</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#Sparse</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> ObjectID
<span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Columns</span>
<span class="hljs-keyword">WHERE</span> IsSparse = <span class="hljs-number">1</span>
    <span class="hljs-keyword">OR</span> IsColumnSet = <span class="hljs-number">1</span><font></font>
<font></font>
<span class="hljs-keyword">IF</span> OBJECT_ID(<span class="hljs-string">'tempdb.dbo.#AggColumns'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#AggColumns</span><font></font>
<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-comment">#AggColumns (</span>
      ObjectID        <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexID         <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    , IndexColumns    <span class="hljs-keyword">NVARCHAR</span>(<span class="hljs-keyword">MAX</span>)<font></font>
    , IncludedColumns <span class="hljs-keyword">NVARCHAR</span>(<span class="hljs-keyword">MAX</span>)<font></font>
    , PRIMARY <span class="hljs-keyword">KEY</span> (ObjectID, IndexID)<font></font>
)<font></font>
<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-comment">#AggColumns</span>
<span class="hljs-keyword">SELECT</span> t.ObjectID<font></font>
     , t.IndexID<font></font>
     , IndexColumns = <span class="hljs-keyword">STUFF</span>((
            <span class="hljs-keyword">SELECT</span> <span class="hljs-string">', ['</span> + c.ColumnName + <span class="hljs-string">']'</span>
            <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#IndexColumns i</span>
            <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Columns c ON i.ObjectID = c.ObjectID AND i.ColumnID = c.ColumnID</span>
            <span class="hljs-keyword">WHERE</span> i.ObjectID = t.ObjectID
                <span class="hljs-keyword">AND</span> i.IndexID = t.IndexID
                <span class="hljs-keyword">AND</span> i.IsIncluded = <span class="hljs-number">0</span>
            <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> i.OrderID
        <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">XML</span> <span class="hljs-keyword">PATH</span>(<span class="hljs-string">''</span>), <span class="hljs-keyword">TYPE</span>).value(<span class="hljs-string">'(./text())[1]'</span>, <span class="hljs-string">'NVARCHAR(MAX)'</span>), <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">''</span>)<font></font>
     , IncludedColumns = <span class="hljs-keyword">STUFF</span>((
            <span class="hljs-keyword">SELECT</span> <span class="hljs-string">', ['</span> + c.ColumnName + <span class="hljs-string">']'</span>
            <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#IndexColumns i</span>
            <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Columns c ON i.ObjectID = c.ObjectID AND i.ColumnID = c.ColumnID</span>
            <span class="hljs-keyword">WHERE</span> i.ObjectID = t.ObjectID
                <span class="hljs-keyword">AND</span> i.IndexID = t.IndexID
                <span class="hljs-keyword">AND</span> i.IsIncluded = <span class="hljs-number">1</span>
            <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> i.OrderID
        <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">XML</span> <span class="hljs-keyword">PATH</span>(<span class="hljs-string">''</span>), <span class="hljs-keyword">TYPE</span>).value(<span class="hljs-string">'(./text())[1]'</span>, <span class="hljs-string">'NVARCHAR(MAX)'</span>), <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">''</span>)
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> ObjectID, IndexID
    <span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes</span>
    <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">IndexType</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<font></font>
) t<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> i.ObjectID<font></font>
     , i.IndexID<font></font>
     , i.IndexName<font></font>
     , ObjectName       = o.[<span class="hljs-keyword">name</span>]<font></font>
     , SchemaName       = s.[<span class="hljs-keyword">name</span>]<font></font>
     , i.PagesCount<font></font>
     , i.UnusedPagesCount<font></font>
     , i.PartitionNumber<font></font>
     , i.RowsCount<font></font>
     , i.IndexType<font></font>
     , i.IsAllowPageLocks<font></font>
     , u.TotalWrites<font></font>
     , u.TotalReads<font></font>
     , u.TotalSeeks<font></font>
     , u.TotalScans<font></font>
     , u.TotalLookups<font></font>
     , u.LastUsage<font></font>
     , i.DataCompression<font></font>
     , f.Fragmentation<font></font>
     , IndexStats       = STATS_DATE(i.ObjectID, i.IndexID)<font></font>
     , IsLobLegacy      = <span class="hljs-keyword">ISNULL</span>(lob.IsLobLegacy, <span class="hljs-number">0</span>)<font></font>
     , IsLob            = <span class="hljs-keyword">ISNULL</span>(lob.IsLob, <span class="hljs-number">0</span>)<font></font>
     , IsSparse         = <span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> p.ObjectID <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">0</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">1</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIT</span>)<font></font>
     , IsPartitioned    = <span class="hljs-keyword">CAST</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> dds.[data_space_id] <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> <span class="hljs-built_in">BIT</span>)<font></font>
     , FileGroupName    = fg.[<span class="hljs-keyword">name</span>]<font></font>
     , i.IsUnique<font></font>
     , i.IsPK<font></font>
     , i.FillFactorValue<font></font>
     , i.IsFiltered<font></font>
     , a.IndexColumns<font></font>
     , a.IncludedColumns<font></font>
<span class="hljs-keyword">FROM</span> <span class="hljs-comment">#Indexes i</span>
<span class="hljs-keyword">JOIN</span> sys.objects o <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> o.[object_id] = i.ObjectID
<span class="hljs-keyword">JOIN</span> sys.schemas s <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> s.[schema_id] = o.[schema_id]
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#AggColumns a ON a.ObjectID = i.ObjectID AND a.IndexID = i.IndexID</span>
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Sparse p ON p.ObjectID = i.ObjectID</span>
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Fragmentation f ON f.ObjectID = i.ObjectID AND f.IndexID = i.IndexID AND f.PartitionNumber = i.PartitionNumber</span>
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> ObjectID      = [object_id]<font></font>
         , IndexID       = [index_id]<font></font>
         , TotalWrites   = <span class="hljs-keyword">NULLIF</span>([user_updates], <span class="hljs-number">0</span>)<font></font>
         , TotalReads    = <span class="hljs-keyword">NULLIF</span>([user_seeks] + [user_scans] + [user_lookups], <span class="hljs-number">0</span>)<font></font>
         , TotalSeeks    = <span class="hljs-keyword">NULLIF</span>([user_seeks], <span class="hljs-number">0</span>)<font></font>
         , TotalScans    = <span class="hljs-keyword">NULLIF</span>([user_scans], <span class="hljs-number">0</span>)<font></font>
         , TotalLookups  = <span class="hljs-keyword">NULLIF</span>([user_lookups], <span class="hljs-number">0</span>)<font></font>
         , LastUsage     = (<font></font>
                                <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(dt)
                                <span class="hljs-keyword">FROM</span> (
                                    <span class="hljs-keyword">VALUES</span> ([last_user_seek])<font></font>
                                         , ([last_user_scan])<font></font>
                                         , ([last_user_lookup])<font></font>
                                         , ([last_user_update])<font></font>
                                ) t(dt)<font></font>
                           )<font></font>
    <span class="hljs-keyword">FROM</span> sys.dm_db_index_usage_stats <span class="hljs-keyword">WITH</span>(NOLOCK)
    <span class="hljs-keyword">WHERE</span> [database_id] = @DBID<font></font>
) u <span class="hljs-keyword">ON</span> i.ObjectID = u.ObjectID <span class="hljs-keyword">AND</span> i.IndexID = u.IndexID
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-comment">#Lob lob ON lob.ObjectID = i.ObjectID AND lob.IndexID = i.IndexID</span>
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> sys.destination_data_spaces dds <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> i.DataSpaceID = dds.[partition_scheme_id] <span class="hljs-keyword">AND</span> i.PartitionNumber = dds.[destination_id]
<span class="hljs-keyword">JOIN</span> sys.filegroups fg <span class="hljs-keyword">WITH</span>(NOLOCK) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">ISNULL</span>(dds.[data_space_id], i.DataSpaceID) = fg.[data_space_id] 
<span class="hljs-keyword">WHERE</span> o.[<span class="hljs-keyword">type</span>] <span class="hljs-keyword">IN</span> (<span class="hljs-string">'V'</span>, <span class="hljs-string">'U'</span>)
    <span class="hljs-keyword">AND</span> (<font></font>
            f.Fragmentation &gt;= @Fragmentation<font></font>
        <span class="hljs-keyword">OR</span><font></font>
            i.PagesCount &gt; @PreDescribeSize<font></font>
        <span class="hljs-keyword">OR</span>
            i.IndexType <span class="hljs-keyword">IN</span> (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>)<font></font>
    )<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã‚¯ã‚¨ãƒªè‡ªä½“ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã‚Œã¯ã€å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒè¡Œã‚ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚å¤§è¦æ¨¡ãªã‚¹ã‚­ãƒ¼ãƒ ã®å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«å¤‰æ•°ã‚’ä½¿ç”¨ã—ãŸæŒ¿å…¥ã¯1ã¤ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã§ã®ã¿å¯èƒ½ã§ã‚ã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã™ã‚‹ã¨ãã«ãƒ—ãƒ©ãƒ³ã‚’ä¸¦åˆ—ã§ç”Ÿæˆã§ãã¾ã™ã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å«ã‚€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</font><font style="vertical-align: inherit;">
ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ã“ã“ã§ã¯ã€æ¬¡ã®ã‚ˆã†ãªä»–ã®è©³ç´°æƒ…å ±ã‚‚è¡¨ç¤ºã§ãã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/yd/rl/oh/ydrlohqwbtggc8n8equratfkkr0.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ•°</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€å¾Œã®å‘¼ã³å‡ºã—ã®æ—¥æ™‚</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ§ç¸®</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ•ã‚¡ã‚¤ãƒ«ã‚°ãƒ«ãƒ¼ãƒ—</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ãªã©</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ã®åˆ—è‡ªèº«ãŒã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š</font><font style="vertical-align: inherit;">
ä¿®æ­£åˆ—ã®ã‚»ãƒ«ã§ã¯ã€æœ€é©åŒ–ã®é–“ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€ã‚¹ã‚­ãƒ£ãƒ³ãŒå®Œäº†ã™ã‚‹ã¨ã€é¸æŠã—ãŸè¨­å®šã«åŸºã¥ã„ã¦ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒé¸æŠã•ã‚Œã¾ã™</font><font style="vertical-align: inherit;">
ã€‚å‡¦ç†ã«å¿…è¦ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é¸æŠã™ã‚‹å¿…è¦</font><font style="vertical-align: inherit;">ãŒ</font><font style="vertical-align: inherit;">ã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä¿å­˜ã§ãã¾ã™ï¼ˆåŒã˜ãƒœã‚¿ãƒ³ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æœ€é©åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã¾ã™ï¼‰ï¼š</font><font style="vertical-align: inherit;">
ç•°ãªã‚‹å½¢å¼ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä¿å­˜ã—ã¾ã™ï¼ˆåŒã˜ãƒœã‚¿ãƒ³ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆ†æã¨æœ€é©åŒ–ã®è©³ç´°è¨­å®šã‚’é–‹ã</font><font style="vertical-align: inherit;">
ã“ã¨ãŒã§ã</font><font style="vertical-align: inherit;">ã¾ã™ï¼‰ï¼š</font><font style="vertical-align: inherit;">3ç•ªç›®ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æƒ…å ±ã‚’æ›´æ–°ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™æ‹¡å¤§é¡ã®æ¨ªã®ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§å·¦ã€‚</font><font style="vertical-align: inherit;">
æ‹¡å¤§é¡ã®ä»˜ã„ãŸãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€æ¤œè¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠã§ãã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/7z/qw/jf/7zqwjfox2zagl5ox0oji648jnta.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/yp/c9/o2/ypc9o2ooiylu7n0pw7zbdo97tbi.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/tt/tu/fn/tttufnve3kmo_siz_d0ahcxfew8.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/tt/8w/gv/tt8wgvpzqx1cl0a1qvkdfxf1ffm.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¾åœ¨ã€å®Œå…¨ãªãƒ˜ãƒ«ãƒ—ã‚·ã‚¹ãƒ†ãƒ ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã—ãŸãŒã£ã¦ã€ã€Œï¼Ÿã€</font><font style="vertical-align: inherit;">ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è£½å“ã«é–¢ã™ã‚‹åŸºæœ¬æƒ…å ±ã‚’å«ã‚€ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã ã‘ã§ã™ã€‚</font><font style="vertical-align: inherit;">
ä¸Šè¨˜ã®ã™ã¹ã¦ã«åŠ ãˆã¦ã€ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«æ¤œç´¢ãƒãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚</font><font style="vertical-align: inherit;">
ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã™ã‚‹</font><font style="vertical-align: inherit;">
ã¨ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸‹éƒ¨ã§å®Ÿè¡Œã•ã‚ŒãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚’ç¢ºèªã§ãã¾ã™ã€‚</font><font style="vertical-align: inherit;">
è©³ç´°ãªåˆ†æã¨æœ€é©åŒ–ã®æœ€é©åŒ–ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ã‚ˆã‚Šç´°ã‹ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¨­å®šã§ãã¾ã™ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼š</font><b><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ææ¡ˆï¼š</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/e5/p_/mq/e5p_mqbcsumjihbb3qnwurxyqdk.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/bm/1c/nn/bm1cnnxagvohdo3a4qtprhvpqbe.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/qn/xa/en/qnxaenzm91ifrvoc2l0aipezq5o.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/wc/aq/zs/wcaqzsz72m6dbuwe3bv1fxqm_3k.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/kc/6x/gp/kc6xgpndlhe19ueeehpobprsomc.jpeg"></a><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã ã‘ã§ãªãã•ã¾ã–ã¾ãªæ–¹æ³•ã§çµ±è¨ˆã‚’é¸æŠçš„ã«æ›´æ–°ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ï¼ˆå®Œå…¨ã«æ›´æ–°ã¾ãŸã¯éƒ¨åˆ†çš„ã«ï¼‰</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã ã‘ã§ãªãåˆ¥ã®ã‚µãƒ¼ãƒãƒ¼ã‚‚é¸æŠã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼ˆã“ã‚Œã¯ã€MS SQL Serverã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒå¤šæ•°ã‚ã‚‹å ´åˆã«éå¸¸ã«ä¾¿åˆ©ã§ã™ï¼‰</font></font></li>
<li>         ,     PowerShell,   , , : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">dbatools.io/commands</a></li>
<li>          ,         MS SQL Server    </li>
<li> .2  4            MS SQL Server,    </li>
<li>    (  ,    ,      )</li>
<li>  SQLIndexManager     MS SQL Server,      , ,  : SQLIndexManager for MS SQL Server</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã™ã¹ã¦ã®éƒ¨åˆ†ã‚’GUIã‹ã‚‰å€‹åˆ¥ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«å‰Šé™¤ã—ã€ãã‚Œã‚‰ã‚’.NET Core 2.1ã«æ›¸ãæ›ãˆã¾ã™ã€‚</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€é¡˜ã„ã®ç¬¬6æ¡ãŒç©æ¥µçš„ã«é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€å®Œå…¨ã‹ã¤é¡ä¼¼ã®è¤‡è£½ã®æ¤œç´¢ã¨ã„ã†å½¢ã§ã™ã§ã«ã‚µãƒãƒ¼ãƒˆãŒã‚ã‚Šã¾ã™ã€‚</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/zk/bw/d3/zkbwd3hem7xtdtj_5yuqhctasac.jpeg"></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ºå…¸</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é©å¿œã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æœ€é©åŒ–æ³•</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLIndexManagerãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLIndexManagerãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®æŠ€è¡“çš„ãªæ¦‚è¦</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLIndexManagerãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹è­°è«–</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQLã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼-SQL ServerãŠã‚ˆã³Azureã§ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç”¨ã®ç„¡æ–™ã®GUIãƒ„ãƒ¼ãƒ«</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL Serverã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆ†æã¨æœ€é©åŒ–</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461265/index.html">ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å‘ã‘ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®ä½¿ç”¨ã®ä¹±ç”¨ã«ã¤ã„ã¦</a></li>
<li><a href="../ja461267/index.html">ãƒãƒƒãƒ—ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°å‘ã‘ã®æ–°ã—ã„Intelãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼</a></li>
<li><a href="../ja461269/index.html">pwnable.kr 08ã§ã®å•é¡Œè§£æ±ºã¯è„šã§ã‚ã‚Šã€10ã¯ã‚·ã‚§ãƒ«ã‚·ãƒ§ãƒƒã‚¯ã§ã™ã€‚ARMã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã€‚Bashã®è„†å¼±æ€§</a></li>
<li><a href="../ja461271/index.html">2019å¹´ã«ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®£ä¼ã™ã‚‹æ–¹æ³•ï¼š4ã¤ã®å®Ÿç”¨çš„ãªæ–¹æ³•+ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«</a></li>
<li><a href="../ja461273/index.html">è²ªæ¬²ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°é¸æ‰‹æ¨©ã®MLãƒˆãƒ©ãƒƒã‚¯ã®ã‚¿ã‚¹ã‚¯ã®åˆ†æ</a></li>
<li><a href="../ja461279/index.html">Golangã¨gRPCã§ã‚·ãƒ³ãƒ—ãƒ«ãªãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆã—ã€Dockerã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠãƒ¼åŒ–ã™ã‚‹æ–¹æ³•</a></li>
<li><a href="../ja461281/index.html">Red Hatï¼ˆRHEL / CentOSï¼‰7ã®chrootç’°å¢ƒã§BIND DNSã‚µãƒ¼ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ãŸã‚ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</a></li>
<li><a href="../ja461283/index.html">ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆï¼šå…¨ä½“åƒã¨ãƒªã‚½ãƒ¼ã‚¹ã‚¬ã‚¤ãƒ‰</a></li>
<li><a href="../ja461285/index.html">5ã¤ã®ä¸»è¦ãªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </a></li>
<li><a href="../ja461287/index.html">ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ã¨ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«åŸºã¥ã„ãŸæˆ¦è¡“ã‚²ãƒ¼ãƒ ã§å·§å¦™ãªAIã‚’é–‹ç™ºã™ã‚‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>