<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧒🏾 🤰🏾 🎖️ SELinuxシステム管理者のチートシート：重要な質問に対する42の回答 😼 🖖🏿 ♂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="この記事の翻訳は、特にLinux管理者コースの学生を対象に作成されました。
 
 
 
 ここでは、セキュリティが強化されたLinuxの生活、宇宙、その他すべてについての重要な質問への回答を得ます。
 
 「重要な真実は、物事が必ずしもよく知られているように見えるとは限らないということです...」―...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>SELinuxシステム管理者のチートシート：重要な質問に対する42の回答</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/484896/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この記事の翻訳は、特に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux管理者</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コースの学生を対象に作成されました</font><font style="vertical-align: inherit;">。</font></font></b></i><br>
<br>
<img src="https://habrastorage.org/webt/of/jl/y2/ofjly2ppm7zgwrztknxeodbhih0.png"><br>
<hr><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここでは、セキュリティが強化されたLinuxの生活、宇宙、その他すべてについての重要な質問への回答を得ます。</font></font></i><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「重要な真実は、物事が必ずしもよく知られているように見えるとは限らないということです...」― </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダグラスアダムス、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヒッチハイクの銀河ガイド</font></font></i></b></blockquote><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全性。信頼性の向上。適合。ポリシー。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム管理者の黙示録の4人の騎手。監視、バックアップ、実装、構成、更新などの日常業務に加えて、システムのセキュリティも担当します。サードパーティプロバイダーが拡張セキュリティをオフにすることを推奨しているシステムでもです。これは</font><font style="vertical-align: inherit;">Mission Impossibleの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ethan Hunt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の作品に似てい</font><font style="vertical-align: inherit;">ます。</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このジレンマに直面し、一部のシステム管理者</font><font style="vertical-align: inherit;">は、生命、宇宙などの大きな問題への答えを決して知らないと思うので</font><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">青い錠剤</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を服用することを決定します</font><font style="vertical-align: inherit;">。そして、私たち全員が知っているように、この答えは42 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。「Hitchhiker's Guide to the Galaxy」の精神に基づい</font><font style="vertical-align: inherit;">て、システムでの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理と使用に関する重要な質問に対する42の答えを次に示し</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SELinuxは強制アクセス制御システムです。つまり、すべてのプロセスにラベルがあります。各ファイル、ディレクトリ、およびシステムオブジェクトにもタグがあります。ポリシールールは、ラベル付けされたプロセスとオブジェクト間のアクセスを制御します。カーネルはこれらのルールを適用します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最も重要な2つの概念は次のとおりです。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベル</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付け-ラベル付け（ファイル、プロセス、ポートなど）および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ強制</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（タイプに基づいてプロセスを相互に分離します）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正しいラベル形式</font></font><code>user:role:type:level</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（オプション）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マルチレベルセキュリティ（MLS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">を提供する目的は、</font><font style="vertical-align: inherit;">プロセス（ドメイン）が使用するデータのセキュリティレベルに基づいてプロセス（ドメイン）を管理することです。たとえば、シークレットプロセスは最高機密データを読み取ることができません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. </font></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Multi-Category Security（MCS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）を</font><font style="vertical-align: inherit;">確保</font><font style="vertical-align: inherit;">することで、同様のプロセスを互いに保護します（たとえば、仮想マシン、OpenShiftメカニズム、SELinuxサンドボックス、コンテナーなど）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 起動時にSELinuxモードを変更するためのカーネルパラメータ：</font></font><br>
<br>
<ul>
<li><code>autorelabel=1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> →システムに強制的に再マーキングを開始させる</font></font></li>
<li><code>selinux=0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> →カーネルがSELinuxインフラストラクチャをロードしない</font></font></li>
<li><code>enforcing=0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> →許容モードでダウンロード</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム全体を再</font><font style="vertical-align: inherit;">
マーキング</font><font style="vertical-align: inherit;">する必要がある場合：</font><font style="vertical-align: inherit;">システムマーキングに多数のエラーが含まれている場合、マーキングを成功させるには、許容モードで起動する必要がある場合があります。</font><b><font style="vertical-align: inherit;">8.</font></b><font style="vertical-align: inherit;"> SELinuxがオンになっているかどうかを確認するには：</font><b><font style="vertical-align: inherit;">9.</font></b><font style="vertical-align: inherit;"> SELinux </font><font style="vertical-align: inherit;">を一時的に有効/無効にするには：</font><b><font style="vertical-align: inherit;">10.</font></b><font style="vertical-align: inherit;"> SELinux </font><font style="vertical-align: inherit;">のステータスを確認します：</font><b><font style="vertical-align: inherit;">11.</font></b><font style="vertical-align: inherit;">設定ファイル：</font><b><font style="vertical-align: inherit;">12 </font></b><b><font style="vertical-align: inherit;">.</font></b><font style="vertical-align: inherit;"> SELinuxはどのように機能しますか？</font><font style="vertical-align: inherit;">Apache Webサーバーのラベル付けの例を次に示します。</font></font><br>
<br>
<code># touch /.autorelabel<br>
#reboot</code><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code># getenforce</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code># setenforce [1|0]</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code># sestatus</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code>/etc/selinux/config</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バイナリ表現： </font></font><code>/usr/sbin/httpd→httpd_exec_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成ディレクトリ： </font></font><code>/etc/httpd→httpd_config_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ログファイルディレクトリ：</font></font><code> /var/log/httpd → httpd_log_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテンツディレクトリ： </font></font><code>/var/www/html → httpd_sys_content_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起動スクリプト： </font></font><code>/usr/lib/systemd/system/httpd.service → httpd_unit_file_d</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">処理する： </font></font><code>/usr/sbin/httpd -DFOREGROUND → httpd_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポート </font></font><code>80/tcp, 443/tcp → httpd_t, http_port_t</code></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストで実行されているプロセス</font></font><code>httpd_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、タグ付けされたオブジェクトと対話できます</font></font><code>httpd_something_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">13.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多くのチームは、</font></font><code>-Z</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストを表示、作成、および変更するための</font><font style="vertical-align: inherit;">引数</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">受け入れ</font><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<ul>
<li><code>ls -Z</code></li>
<li><code>id -Z</code></li>
<li><code>ps -Z</code></li>
<li><code>netstat -Z</code></li>
<li><code>cp -Z</code></li>
<li><code>mkdir -Z</code></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストは、親ディレクトリのコンテキストに基づいてファイルが作成されるときに設定されます（一部の例外はあります）。</font><font style="vertical-align: inherit;">RPMは、インストール中にコンテキストを設定できます。</font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SELinuxエラーの主な原因は4つあります</font><b><font style="vertical-align: inherit;">。</font></b><font style="vertical-align: inherit;">これについては、以下の段落15から21で詳しく説明します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベル付けの問題</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxが知っておくべき何かのため</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxポリシー/アプリケーションのエラー</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなたの情報が危険にさらされる可能性があります。</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マーキングの問題</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：ファイルに</font></font><code>/srv/myweb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">誤ったマーク</font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">付けられている場合、アクセスが拒否される可能性があります。</font><font style="vertical-align: inherit;">これを修正するいくつかの方法を次に示します。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ラベルを知っている場合：</font></font><br>
 <code># semanage fcontext -a -t httpd_sys_content_t '/srv/myweb(/.*)?'</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同等のマーキングのあるファイルを知っている場合：</font></font><br>
<code># semanage fcontext -a -e /srv/myweb /var/www</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストを復元した後（両方の場合）：</font></font><br>
 <code># restorecon -vR /srv/myweb</code></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マーキングの問題：</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルをコピーする代わりに移動すると、ファイルは元のコンテキストを保持します。</font><font style="vertical-align: inherit;">この問題を解決するには：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次のラベルの付いたコンテキストコマンドを変更します。</font></font><br>
 <code># chcon -t httpd_system_content_t /var/www/html/index.html</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リンクラベルを使用してコンテキストコマンドを変更します。</font></font><br>
 <code># chcon --reference /var/www/html/ /var/www/html/index.html</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストを復元します（両方の場合）： </font></font><code># restorecon -vR /var/www/html/</code></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">17.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">場合は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxが知っている必要があり</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTTPDは、ポート8585でリッスンしていることを、SELinuxを教えて：</font></font><br>
<br>
<code># semanage port -a -t http_port_t -p tcp 8585</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">18. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxは知っている必要があり</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ますが、SELinuxポリシーを書き換えるの知識がなくても、実行時にSELinuxポリシーの一部を変更することができるようにブール値を。</font><font style="vertical-align: inherit;">あなたは電子メールを送信するのhttpdたい場合たとえば、次のように入力します</font></font><code># setsebool -P httpd_can_sendmail 1</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">19. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SELinuxは知っている必要があります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /無効SELinuxの設定を有効にする論理値を：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのブール値を表示するには： </font></font><code># getsebool -a</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれの説明を表示するには： </font></font><code># semanage boolean -l</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブール値を設定するには： </font></font><code># setsebool [_boolean_] [1|0]</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">永久インストールの場合はを追加し</font></font><code>-P</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">例えば：</font></font><code># setsebool httpd_enable_ftp_server 1 -P</code></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SELinuxポリシー/アプリケーションには、次のようなエラーが含まれる場合があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファンシーコードパス</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stdoutをリダイレクトする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイル記述子のリーク</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実行可能メモリ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">貧弱に構築されたライブラリ</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オープンチケット（Bugzillaにレポートを送信しないでください。BugzillaにはSLAがありません）。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">21.</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ドメインの数が限られている</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、情報が危険にさらされる可能性があります</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カーネルモジュールをダウンロードする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">強制されたSELinuxモードを無効にする</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で書きます </font></font><code>etc_t/shadow_t</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iptablesルールを変更する</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">22.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポリシーモジュールを開発するためのSELinuxツール：</font><font style="vertical-align: inherit;">インストール後に</font></font><br>
<br>
<code># yum -y install setroubleshoot setroubleshoot-server</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
再起動または再起動</font></font><code>auditd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">します。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">23.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><pre><code class="1c hljs">journalctl</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に関連付けられているすべてのログを一覧表示するには</font></font><code>setroubleshoot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<code># journalctl -t setroubleshoot --since=14:20</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24</font></font></b><font style="vertical-align: inherit;"></font><code>journalctl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .特定のSELinuxラベルに関連付けられているすべてのログを一覧表示</font><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">ために</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">します。</font><font style="vertical-align: inherit;">次に例を示します</font></font><br>
<br>
<code># journalctl _SELINUX_CONTEXT=system_u:system_r:policykit_t:s0</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。25.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SELinuxエラーが発生した場合は、ログ</font></font><code>setroubleshoot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して、</font><font style="vertical-align: inherit;">考えられるいくつかの解決策を提案し</font><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、次のようになり</font></font><code>journalctl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="xml hljs">Jun 14 19:41:07 web1 setroubleshoot: SELinux is preventing httpd from getattr access on the file /var/www/html/index.html. For complete message run: sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e<font></font>
<font></font>
# sealert -l 12fd8b04-0119-4077-a710-2d0e0ee5755e<font></font>
SELinux is preventing httpd from getattr access on the file /var/www/html/index.html.<font></font>
<font></font>
***** Plugin restorecon (99.5 confidence) suggests ************************<font></font>
<font></font>
If you want to fix the label,<font></font>
/var/www/html/index.html default label should be httpd_syscontent_t.<font></font>
Then you can restorecon.<font></font>
Do<font></font>
# /sbin/restorecon -v /var/www/html/index.html</code></pre><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">26.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロギング：SELinuxは多くの場所で情報を記録します：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ var / log / messages</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/var/log/audit/audit.log</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/var/lib/setroubleshoot/setroubleshoot_database.xml</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロギング：監査ログでSELinuxエラー</font><font style="vertical-align: inherit;">を見つける</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<code># ausearch -m AVC,USER_AVC,SELINUX_ERR -ts today</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">28.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特定のサービスのSELinux Access Vector Cache（AVC）メッセージを見つけるには：</font></font><br>
<br>
<code># ausearch -m avc -c httpd</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">29</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .ユーティリティ</font></font><code>audit2allow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は禁止された操作のログから情報を収集してから、SELinuxアクセス許可ポリシールールを生成します。</font><font style="vertical-align: inherit;">例えば：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アクセスが拒否された理由の読みやすい説明を作成するには： </font></font><code># audit2allow -w -a</code> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拒否されたアクセスを許可するタイプ施行規則を表示するには、次の手順に従います。 </font></font><code># audit2allow -a</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタムモジュールを作成するには： </font></font><code># audit2allow -a -M mypolicy</code> </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このオプション</font></font><code>-M</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、指定された名前でタイプ施行ファイル（.te）を作成し、ルールをポリシーパッケージ（.pp）にコンパイルします。</font></font><code>mypolicy.pp mypolicy.te</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタムモジュールをインストールするには： </font></font><code># semodule -i mypolicy.pp</code></li>
</ul> <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">許容モードで動作するように別のプロセス（ドメイン）を構成するには：</font></font><code># semanage permissive -a httpd_t</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">31.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">許容</font><font style="vertical-align: inherit;">ドメインにしたくない場合：</font></font><code># semanage permissive -d httpd_t</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべての許容ドメインを無効</font></font><code># semodule -d permissivedomains</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">するには</font><font style="vertical-align: inherit;">：</font><b><font style="vertical-align: inherit;">33.</font></b><font style="vertical-align: inherit;"> MLS SELinuxポリシー</font><b><font style="vertical-align: inherit;">を</font></b><font style="vertical-align: inherit;">有効にするには：</font><font style="vertical-align: inherit;">
SELinuxが</font><font style="vertical-align: inherit;">許容モードで動作して</font><font style="vertical-align: inherit;">いることを確認し</font><font style="vertical-align: inherit;">ます</font><b><font style="vertical-align: inherit;">。</font></b><font style="vertical-align: inherit;">モード：</font><font style="vertical-align: inherit;">
スクリプト</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">使用して</font><font style="vertical-align: inherit;">、次回の再起動時にファイルが再度マークされるようにします：</font><b><font style="vertical-align: inherit;">34.</font></b><font style="vertical-align: inherit;">特定のMLS範囲でユーザーを作成します：</font><font style="vertical-align: inherit;">
コマンドを使用して</font><font style="vertical-align: inherit;">、新しいユーザーを既存のSELinuxユーザー（この場合は</font><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">にマッピングします</font><font style="vertical-align: inherit;">。</font><b><font style="vertical-align: inherit;">35.</font></b><font style="vertical-align: inherit;"> SELinuxとLinuxユーザーの間の対応を表示するには：</font><b><font style="vertical-align: inherit;">36。</font></b></font><code># yum install selinux-policy-mls<br>
 /etc/selinux/config:<br>
<br>
SELINUX=permissive<br>
SELINUXTYPE=mls</code><br>
<br><font style="vertical-align: inherit;"></font><code># setenforce 0</code><br><font style="vertical-align: inherit;"></font><code>fixfiles</code><font style="vertical-align: inherit;"></font><br>
<br>
<code># fixfiles -F onboot # reboot</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code># useradd -Z staff_u john</code><br>
<br><font style="vertical-align: inherit;"></font><code>useradd</code><font style="vertical-align: inherit;"></font><code>staff_u</code><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><code># semanage login -l</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーの特定の範囲を定義します</font></font><code># semanage login --modify --range s2:c100 john</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。37。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ユーザーのホームディレクトリのラベルを修正するには（必要な場合）：</font></font><code># chcon -R -l s2:c100 /home/john</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在のカテゴリを表示するには：</font></font><code># chcat -L</code><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カテゴリを変更するか、独自のカテゴリを作成するには、次のようにファイルを変更します</font><b><font style="vertical-align: inherit;">。40。</font></b><font style="vertical-align: inherit;">コマンドまたはスクリプトを実行するには特定のファイル、ロール、ユーザーコンテキスト：</font></font><br>
<br>
<code><code>/etc/selinux/_&lt;</code>selinuxtype<code>&gt;</code>_/setrans.conf</code><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<code># runcon -t initrc_t -r system_r -u user_u yourcommandhere</code><br>
<br>
<ul>
<li><code>-t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ファイルコンテキスト</font></font></li>
<li><code>-r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 役割のコンテキスト</font></font></li>
<li><code>-u</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ユーザーコンテキスト</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">41.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無効化されたSELinuxで動作するコンテナ：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポッドマン： </font></font><code># podman run --security-opt label=disable …</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker： </font></font><code># docker run --security-opt label=disable …</code></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">42.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテナにシステムへのフルアクセスを付与する必要がある場合：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポッドマン： </font></font><code># podman run --privileged …</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker： </font></font><code># docker run --privileged …</code></li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そして今、あなたはすでに答えを知っています。</font><font style="vertical-align: inherit;">したがって、パニックにならずにSELinuxをオンにしてください。</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参照：</font></font></h3><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Dan Walshに</font></a><font style="vertical-align: inherit;">よる</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">SELinux</font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Your visual how-to guide for SELinux policy enforcement also</a> by Dan Walsh</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Security Enhanced Linux for mere mortals</a> by <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Thomas Cameron</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">The SELinux Coloring Book</a> by <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">Máirín Duffy</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">SELinux User's and Administrator's Guide—Red Hat Enterprise Linux 7</a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja484882/index.html">Windowsターミナルプレビューv0.8がリリースされました</a></li>
<li><a href="../ja484884/index.html">HIPEC。腹腔の悪性腫瘍の数か月ではなく、生涯</a></li>
<li><a href="../ja484886/index.html">RTLスタイリング101-CSS RTLスタイリングの詳細ガイド</a></li>
<li><a href="../ja484890/index.html">SSAS表形式モデルのディメンション属性へのアクセスの制限</a></li>
<li><a href="../ja484892/index.html">ターンキーケア：SAPホスティングの仕組み</a></li>
<li><a href="../ja484898/index.html">依存関係をテストする正当な理由：AGPLエディション</a></li>
<li><a href="../ja484900/index.html">ウェブサイトレンダリング101</a></li>
<li><a href="../ja484902/index.html">高次の方程式について</a></li>
<li><a href="../ja484904/index.html">Splunkのない1年-ロシアの機械データ分析の市場をアメリカの企業がどのように変えたのか</a></li>
<li><a href="../ja484906/index.html">リモートの分散型チームおよびチームリーダー</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>