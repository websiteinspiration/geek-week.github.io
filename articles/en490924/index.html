<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔰 👩🏼‍🏫 🈯️ What is Windows PowerShell and what does it eat? Part 2: Introduction to the programming language 🌚 👎🏿 🛥️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Historically, command-line utilities on Unix systems are better developed than on Windows, however, with the advent of a new solution, the situation h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>What is Windows PowerShell and what does it eat? Part 2: Introduction to the programming language</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490924/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Historically, command-line utilities on Unix systems are better developed than on Windows, however, with the advent of a new solution, the situation has changed.</font></font></i></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For PowerShell, you can write scripts in an interpreted multi-paradigm language that contains elements of classical procedural, object-oriented, and even functional programming: conditional branching, loops, variables, arrays, hash tables, classes, error handling, as well as functions, cmdlets and pipelines . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The previous article</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was devoted to the basics of working in an environment, and now we offer our readers a small guide for programmers.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table of contents:</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables and their types </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System variables </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scopes </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environment variables ( </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arithmetic </font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">) </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">Arithmetic and comparison </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operators Assignment </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operators Logical operators </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conditional transition </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Loops </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrays </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash tables </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Functions </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error handling You</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
can write code in any text editor or using the integrated development environment - the easiest way to take Windows PowerShell ISE included with Microsoft Server Operating Systems. </font><font style="vertical-align: inherit;">This is only necessary for fairly complex scripts: short sets of commands are easier to execute interactively.</font></font><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comments</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using comments is considered part of a good programming style along with proper indentation and spaces:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-comment">#       —     .</span><font></font>
<font></font>
<span class="hljs-comment">&lt;# 

             . 
            .

#&gt;</span></code></pre><br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Variables and their types</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variables in PowerShell are named objects. </font><font style="vertical-align: inherit;">Their names may include an underscore, as well as letters and numbers. </font><font style="vertical-align: inherit;">The $ symbol is always used before the name, and to declare a variable, it is enough to indicate to the interpreter a valid name: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/f_/bo/jwf_bojczpfg_r16puek7uuo4r0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To initialize the variable (assign a value to it), the assignment operator (symbol =) is used:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span> = <span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can declare a variable by indicating its type in square brackets (type conversion operator) before the name or value:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span><font></font>
<font></font>
<span class="hljs-variable">$test</span> = [<span class="hljs-built_in">int</span>]<span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is important to understand that variables in PowerShell are full-fledged objects (classes) with properties and methods whose types are based on those available in .NET Core. </font><font style="vertical-align: inherit;">We list the main ones:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Type (.NET class)</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code example</font></font><br>
</th>
</tr>
<tr>
<td>[string]<br>
System.String<br>
</td>
<td> Unicode&nbsp;<br>
</td>
<td>$test = «»<br>
$test = ''<br>
</td>
</tr>
<tr>
<td>[char]<br>
System.Char<br>
</td>
<td> Unicode (16 )<br>
</td>
<td>[char]$test = 'c'<br>
</td>
</tr>
<tr>
<td>[bool]<br>
System.Boolean<br>
</td>
<td>  (  True  False)<br>
</td>
<td>[bool]$test = $true<br>
</td>
</tr>
<tr>
<td>[int]<br>
System.Int32<br>
</td>
<td>   (32 )<br>
</td>
<td>[int]$test = 123456789<br>
</td>
</tr>
<tr>
<td>[long]<br>
System.Int64<br>
</td>
<td>   (64 )<br>
</td>
<td>[long]$test = 12345678910<br>
</td>
</tr>
<tr>
<td>[single]<br>
System.Single<br>
</td>
<td>      32 <br>
</td>
<td>[single]$test = 12345.6789<br>
</td>
</tr>
<tr>
<td>[double]<br>
System.Double<br>
</td>
<td>      64  (8 )<br>
</td>
<td>[double]$test = 123456789.101112<br>
</td>
</tr>
<tr>
<td>[decimal]<br>
System.Decimal<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128-bit floating-point number (be sure to include d at the end)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[decimal] $ test = 12345.6789d</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[DateTime] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.DateTime</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">date and time&nbsp;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = Get-Date</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[array] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Object []</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an array whose element index starts at 0</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_array = 1, 2, "test", 3, 4</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[hashtable] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Collections.Hashtable</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hash tables - associative arrays with named keys, built on the principle: @ {key = "value"}</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_hashtable = @ {one = "one"; </font><font style="vertical-align: inherit;">two = "two"; </font><font style="vertical-align: inherit;">three = "three"}</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell supports implicit type conversion, in addition, the type of the variable can change on the fly (for example, using the assignment operator), if it is not specified forcibly - in this case, the interpreter will throw an error. </font><font style="vertical-align: inherit;">You can determine the type of a variable from the previous example by calling the GetType () method:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span>.GetType().FullName</code></pre><br>
<img src="https://habrastorage.org/webt/j5/qf/vp/j5qfvplzg-n84l33ie1ogez8gp4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are a number of cmdlets for managing variables. </font><font style="vertical-align: inherit;">Their list in a convenient form is displayed using the command:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Noun</span> Variable | <span class="hljs-built_in">ft</span> <span class="hljs-literal">-Property</span> Name, Definition <span class="hljs-literal">-AutoSize</span> <span class="hljs-literal">-Wrap</span></code></pre><br>
<img src="https://habrastorage.org/webt/za/qc/1t/zaqc1t0hf3-onpravup8_h0euou.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To view the declared variables and their values, you can use the special cmdlet:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This method seems overly cumbersome, it is much more convenient to work with variables through operators or by accessing their properties and methods directly. </font><font style="vertical-align: inherit;">However, cmdlets have a right to exist because they allow you to specify some additional parameters. </font><font style="vertical-align: inherit;">It is important to understand that user variables are defined only within the current session. </font><font style="vertical-align: inherit;">After closing the console or completing the script, they are deleted.</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System variables</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to those declared by the user, there are built-in (system) variables that are not deleted after the end of the current session. </font><font style="vertical-align: inherit;">They are divided into two types, while PowerShell status data is stored in automatic variables, which cannot be assigned arbitrary values ​​on their own. </font><font style="vertical-align: inherit;">These include, for example, $ PWD:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PWD</span>.Path</code></pre><br>
<img src="https://habrastorage.org/webt/8u/-5/p1/8u-5p10pygkqcoql1kymnbl3q-g.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To store user settings, you need preference variables whose values ​​can be changed. </font><font style="vertical-align: inherit;">For example, with the help of $ ErrorActionPreference, the response of the command interpreter to the occurrence of non-critical errors is set. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to operators and cmdlets, the Variable: pseudo-accumulator exists for accessing declared variables. </font><font style="vertical-align: inherit;">You can work with it by analogy with other drives, and the variables in this case resemble file system objects:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Variable: | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">ls</span> Variable: | more</code></pre><br>
<img src="https://habrastorage.org/webt/h4/03/9e/h4039eawh2tpbuqpyqsidabwkyk.png" alt="image"><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scopes</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For variables in PowerShell, there is the notion of Scope. </font><font style="vertical-align: inherit;">The action of the global area (Global) extends to the entire current session - it includes, for example, system variables. </font><font style="vertical-align: inherit;">Local variables are available only in the area where they were defined: let's say inside the function. </font><font style="vertical-align: inherit;">There is also the concept of a script scope, but for script commands, it is essentially local. </font><font style="vertical-align: inherit;">By default, when declaring variables, they are given a local scope, and to change this, we need a special construction of the form: $ Global: variable = value. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, like this:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$Global:test</span> = <span class="hljs-number">100</span></code></pre><br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Environment Variables</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another Env pseudo-drive is available from PowerShell, which can be used to access environment variables. </font><font style="vertical-align: inherit;">When the shell starts, they are copied from the parent process (i.e., from the program that initiated the current session) and usually their initial values ​​coincide with the values ​​in the control panel. </font><font style="vertical-align: inherit;">To view environment variables, use the Get-ChildItem cmdlet or its aliases (liases): ls and dir.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> Env:</code></pre><br>
<img src="https://habrastorage.org/webt/rf/3d/19/rf3d19syyr5ouu4jnrnnf68gul4.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
These variables are sequences of bytes (or characters, if you like), the interpretation of which depends only on the program that uses them. </font><font style="vertical-align: inherit;">* -Variable cmdlets do not work with environment variables. </font><font style="vertical-align: inherit;">To access them, you will have to use the disk prefix:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$env:TEST</span> = <span class="hljs-string">"Hello, World!"</span></code></pre><br>
<img src="https://habrastorage.org/webt/iq/fk/zv/iqfkzvl82gwr-uxadfpudoladtg.png" alt="image"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithmetic and comparison operators</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell has the following arithmetic operators: + (addition), - (subtraction), * (multiplication), / (division) and% (module or remainder of division). </font><font style="vertical-align: inherit;">The result of an arithmetic expression is calculated from left to right in accordance with the generally accepted order of operations, and parentheses are used to group parts of the expression. </font><font style="vertical-align: inherit;">Spaces between operators are ignored, they are used only to facilitate perception. </font><font style="vertical-align: inherit;">The + operator also concatenates, and the * operator repeats the lines. </font><font style="vertical-align: inherit;">If you try to add a number to a string, it will be converted to a string. </font><font style="vertical-align: inherit;">In addition, PowerShell has many comparison operators that check the correspondence between two values ​​and return boolean True or False:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operator</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code example</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-eq</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equal (analogue = or == in other languages)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -eq 123&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ne</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not equal (analog &lt;&gt; or! =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ne 123&nbsp;&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Greater than / More (analog&gt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -gt 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ge</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Greater than or equal / Greater than or equal (analogue&gt; =)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ge 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-lt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Less than (analog &lt;)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -lt 123&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-le</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Less than or equal / Less than or equal (analog &lt;=)</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -le 123</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are other similar operators that allow, for example, comparing strings with a wildcard character or using regular expressions to match patterns. </font><font style="vertical-align: inherit;">We will consider them in detail in the following articles. </font><font style="vertical-align: inherit;">The symbols &lt;,&gt; and = are not used for comparison, since they are used for other purposes.</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assignment Operators</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In addition to the most common operator =, there are other assignment operators: + =, - =, * =, / = and% =. </font><font style="vertical-align: inherit;">They change the value before assignment. </font><font style="vertical-align: inherit;">The unary operators ++ and - behave similarly, which increase or decrease the value of a variable - they also relate to assignment operators.</font></font><br>
<br>
<a name="section8"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Logical operators</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comparison is not enough to describe difficult conditions. </font><font style="vertical-align: inherit;">You can write down any logical expressions using the following operators: -and, -or, -xor, -not and! .. They work like in other programming languages, while you can use parentheses to specify the calculation order:</font></font><br>
<br>
<pre><code class="powershell hljs">(<span class="hljs-string">""</span> <span class="hljs-operator">-eq</span> <span class="hljs-string">""</span>) <span class="hljs-operator">-and</span> (<span class="hljs-number">100</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>)<font></font>
<font></font>
<span class="hljs-operator">-not</span> (<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>) <font></font>
<font></font>
!(<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>)</code></pre><br>
<a name="section9"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conditional jump</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The branching operators in PowerShell are standard: IF (IF ... ELSE, IF ... ELSEIF ... ELSE) and SWITCH. </font><font style="vertical-align: inherit;">Consider their use with examples:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">50</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt;&gt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">5</span>
<span class="hljs-keyword">switch</span> (<span class="hljs-variable">$test</span>) {
     <span class="hljs-number">0</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 0"</span>}
     <span class="hljs-number">1</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 1"</span>}
     <span class="hljs-number">2</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 2"</span>}
     <span class="hljs-number">3</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 3"</span>}
     <span class="hljs-number">4</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 4"</span>}
     <span class="hljs-number">5</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 5"</span>}<font></font>
     default {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 5    "</span>}<font></font>
}<font></font>
</code></pre><br>
<a name="section10"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cycles</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There are several types of loops in PowerShell: WHILE, DO WHILE, DO UNTIL, FOR, and FOREACH. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The precondition loop works if / while it is running:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Loops with a postcondition will work at least once, because the condition is checked after iteration. </font><font style="vertical-align: inherit;">In this case, DO WHILE works while the condition is true, and DO UNTIL - while it is false:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>)<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">until</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">9</span>)
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The number of iterations of the FOR loop is known in advance:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>; <span class="hljs-variable">$test</span>++) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span><font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In a FOREACH loop iterates over elements of an array or collection (hash table):</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_collection</span> = <span class="hljs-string">"item1"</span>, <span class="hljs-string">"item2"</span>, <span class="hljs-string">"item3"</span>
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$item</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$test_collection</span>)<font></font>
{<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$item</span><font></font>
}<font></font>
</code></pre><br>
<a name="section11"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrays</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell variables store not only single objects (number, string, etc.), but also plural ones. </font><font style="vertical-align: inherit;">The simplest variety of such variables is arrays. </font><font style="vertical-align: inherit;">An array can consist of several elements, one element or be empty, i.e. </font><font style="vertical-align: inherit;">do not contain elements. </font><font style="vertical-align: inherit;">To declare it, use the @ () operator, which we will need in the next article - it is very important for adding other arrays to the array (creating multidimensional arrays), passing arrays to functions as arguments, and similar tasks:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>() <span class="hljs-comment">#  </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When the array is initialized, its values ​​are listed with a comma (special operator,): </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>) <span class="hljs-comment">#      </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In most cases, the @ () operator can be omitted:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, an array of one element is initialized as follows</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = , <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To access array elements, an integer index starting from zero and an index operator (square brackets) are used:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You can specify multiple indices, separated by commas, including </font><font style="vertical-align: inherit;">duplicate:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/vw/5t/qb/vw5tqbcl5agy4603ummtyg984es.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The operator </font></font><code>..</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(two points - the range operator) returns an array of integers on a segment defined by the upper and lower bounds. </font><font style="vertical-align: inherit;">For example, expression 1..4 displays an array of four elements @ (1, 2, 3, 4), and expression 8..5 displays an array of @ (8, 7, 6, 5). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/sk/1h/r-sk1h628lw2hraptfbcukhekgs.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the range operator, you can initialize an array ($ test_array = 1..4) or get a slice, i.e. </font><font style="vertical-align: inherit;">a sequence of elements in one array with indices from another. </font><font style="vertical-align: inherit;">In this case, a negative number -1 indicates the last element of the array, -2 - the penultimate, etc.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..2</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">2</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">1</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">2</span><span class="hljs-type">..1</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that the values ​​of the integer array may be greater than the maximum value of the index of the data array. </font><font style="vertical-align: inherit;">In this case, all values ​​are returned to the last:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..100</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you try to access a single nonexistent array element, $ null is returned. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/oq/7v/qtoq7vdu_7qt710eszjme9s54rq.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In PowerShell, arrays can contain elements of different types or be strongly typed:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">""</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>
<span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$test_array</span>.count; <span class="hljs-variable">$i</span>++)<font></font>
{<font></font>
          <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test_array</span>[<span class="hljs-variable">$i</span>]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Where the property $ test_array.count is the number of elements in the array. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An example of creating a strongly typed array:</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$test_array</span> = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span></code></pre><br>
<a name="section12"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hash tables</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another basic type of variable in PowerShell is hash tables, also called associative arrays. </font><font style="vertical-align: inherit;">Hashtable are similar to JSON object and are built on a key-value basis. </font><font style="vertical-align: inherit;">Unlike ordinary arrays, access to their elements is carried out using named keys, which are object properties (you can also use the index operator - square brackets). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An empty hash table is declared using the service symbol @ and operator brackets:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When declaring, you can immediately create keys and assign values ​​to them:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{one=<span class="hljs-string">""</span>; two=<span class="hljs-string">""</span>; three=<span class="hljs-string">""</span>; <span class="hljs-string">"some key"</span>=<span class="hljs-string">"some value"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To add an item to the hash table, you must assign it a key that does not yet exist or use the Add () method. </font><font style="vertical-align: inherit;">If the assignment is done with an existing key, its value will change. </font><font style="vertical-align: inherit;">To remove an item from a hash table, use the Remove () method.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span>.<span class="hljs-string">"some key"</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">"some key"</span>]
<span class="hljs-variable">$test_hashtable</span>.Add(<span class="hljs-string">"four"</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable">$test_hashtable</span>.five = <span class="hljs-string">""</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">'five'</span>] = <span class="hljs-string">" "</span>
<span class="hljs-variable">$test_hashtable</span>.Remove(<span class="hljs-string">"one"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/tm/lu/rr/tmlurrhp6hctdugfaqilt06j3le.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Variables of this type can be passed as arguments to functions and cmdlets - in the next article we will learn how to do this, and also consider another similar type - PSCustomObject. </font></font><br>
<br>
<a name="section13"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Functions</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell has all the necessary elements for procedural programming, including functions. </font><font style="vertical-align: inherit;">The function word Function is used to describe them, after which it is required to indicate the name of the function and the body enclosed in operator brackets. </font><font style="vertical-align: inherit;">If necessary, pass arguments to the function, you can specify them immediately after the name in parentheses.</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> - <span class="hljs-params">(1, ..., N)</span></span> <font></font>
{ <font></font>
        - <font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A function always returns a result - this is an array of the results of all its statements, if there are more than one. </font><font style="vertical-align: inherit;">If there is one statement, a single value of the corresponding type is returned. </font><font style="vertical-align: inherit;">The return $ value construct adds an element with the value $ value to the result array and aborts the statement list, and an empty function returns $ null. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For example, create a function for squaring a number:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sqr</span> <span class="hljs-params">(<span class="hljs-variable">$number</span>)</span></span><font></font>
{<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$number</span> * <span class="hljs-variable">$number</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Note that in the function body you can use any variables declared before its call, and calling functions in PowerShell may seem unusual: arguments (if any) are not enclosed in parentheses and are separated by spaces. </font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
or so:</font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-literal">-number</span> <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Due to the way arguments are passed, the function itself sometimes has to be enclosed in brackets:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_func</span> <span class="hljs-params">(<span class="hljs-variable">$n</span>)</span></span> {}<font></font>
test_func <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>     <span class="hljs-comment">#   </span>
(test_func) <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>   <span class="hljs-comment">#   — $true</span></code></pre><br>
<img src="https://habrastorage.org/webt/df/kv/mx/dfkvmx4lst2rmo68c0disf_ovl0.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When describing a function, you can assign default values ​​to the arguments:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span> <span class="hljs-params">(<span class="hljs-variable">$arg</span> = value)</span></span> {
         <span class="hljs-comment"># </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There is another syntax for describing function arguments, in addition, parameters can be read from the pipeline - all this will come in handy in the next article when we consider exported modules and create your own cmdlets.</font></font><br>
<br>
<a name="section14"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error processing</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell has a Try ... Catch ... Finally mechanism to handle exceptions. </font><font style="vertical-align: inherit;">The Try block contains code in which an error may occur, and the Catch block contains its handler. </font><font style="vertical-align: inherit;">If there was no error, it is not executed. </font><font style="vertical-align: inherit;">The Finally block is executed after the Try block, regardless of the occurrence of an error, and there may be several Catch blocks for exceptions of various types. </font><font style="vertical-align: inherit;">The exception itself is written to the default non-declaration variable ($ _) and can be easily retrieved. </font><font style="vertical-align: inherit;">In the example below, we implement protection against entering an incorrect value:</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
        [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-string">" "</span>
        <span class="hljs-number">100</span> / <span class="hljs-variable">$test</span><font></font>
<font></font>
} <span class="hljs-keyword">catch</span> {<font></font>
<font></font>
         <span class="hljs-built_in">Write-Warning</span> <span class="hljs-string">" "</span>
         <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$_</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/tc/3s/e0/tc3se0iqqbes07g8jm0_zitavgw.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That’s where the PowerShell programming basics are concerned. </font><font style="vertical-align: inherit;">In the following articles, we will study in more detail the work with variables of various types, collections, regular expressions, the creation of functions, modules and custom cmdlets, as well as object-oriented programming. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 1: the main features of Windows PowerShell </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 3: passing parameters to scripts and functions, creating cmdlets </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Part 4: Working with objects, custom classes</font></font><br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490908/index.html">Zone data storage</a></li>
<li><a href="../en490912/index.html">How we at Sportmaster chose a caching system. Part 1</a></li>
<li><a href="../en490916/index.html">Problems of interaction with external teams on large projects</a></li>
<li><a href="../en490918/index.html">Andrei Zaretsky, Alexander Trukhanov (continued): “We did not have a name, but there was arrogance”</a></li>
<li><a href="../en490920/index.html">Accelerate your search in Have I Been Pwned to 49 microseconds (C ++)</a></li>
<li><a href="../en490926/index.html">Unity ball trajectory 2d for beginners</a></li>
<li><a href="../en490932/index.html">[Forecast] Motornet - a data exchange network for robotic vehicles</a></li>
<li><a href="../en490936/index.html">Create ML on iOS</a></li>
<li><a href="../en490938/index.html">We write thousands of log files at a time</a></li>
<li><a href="../en490940/index.html">Making a quadrocopter using a 3D printer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>