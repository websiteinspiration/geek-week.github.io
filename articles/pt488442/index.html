<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå≤ üï£ üë©üèΩ‚Äçü§ù‚Äçüë®üèæ C√≥digo moderno para fazer solicita√ß√µes HTTP no Swift 5 usando Combine e us√°-las no SwiftUI. Parte 1 üå± üîÅ üë®üèæ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A consulta HTTP√© uma das habilidades mais importantes que voc√™ precisa obter ao desenvolver iOSaplicativos. Nas vers√µes anteriores Swift(at√© a vers√£o ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C√≥digo moderno para fazer solicita√ß√µes HTTP no Swift 5 usando Combine e us√°-las no SwiftUI. Parte 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488442/"><img src="https://habrastorage.org/webt/uk/tq/y4/uktqy4xvl1cqefjbmvzdzydqj-g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A consulta </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© uma das habilidades mais importantes que voc√™ precisa obter ao desenvolver </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativos. Nas vers√µes anteriores </font></font><code>Swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(at√© a vers√£o 5), independentemente de voc√™ ter gerado essas solicita√ß√µes "do zero" ou usando a conhecida estrutura </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alamofire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voc√™ acabou com um c√≥digo de </font></font><code>callback </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipo&nbsp; </font><font style="vertical-align: inherit;">complexo e confuso </font></font><code>completionHandler: @escaping(Result&lt;T, APIError&gt;) -&gt; Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A apar√™ncia na </font></font><code>Swift 5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nova estrutura da programa√ß√£o reativa funcional </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em conjunto com a existente </font></font><code>URLSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fornece a voc√™ todas as ferramentas necess√°rias para a grava√ß√£o independente de c√≥digos muito compactos para buscar dados da Internet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, de acordo com o conceito, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criaremos "editores"</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para selecionar dados da Internet, nos quais podemos "facilmente assinar" no futuro e usar ao projetar </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com&nbsp; </font></font><code>UIKit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e com ajuda&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parece mais conciso e mais eficaz, porque a a√ß√£o dos "editores"&nbsp; </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o se limita apenas aos dados de amostra e se estende at√© o controle da interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). O fato √© que </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a separa√ß√£o de dados √©&nbsp; </font></font><code>View </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realizada usando </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes com </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades, cujas altera√ß√µes s√£o&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">monitoradas AUTOMATICAMENTE e redesenhadas completamente </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nessas&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes, voc√™ pode simplesmente colocar uma certa l√≥gica comercial do aplicativo, se alguns deles</font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedades s√£o o resultado de s√≠ncronos e / ou ass√≠ncronos de transforma√ß√£o outras </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedades que podem ser alterados directamente tais elementos "activos" da interface de utilizador ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) como caixas de texto </font></font><code>TextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Stepper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>Toggle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para deixar claro o que est√° em jogo, darei exemplos espec√≠ficos. Agora, muitos servi√ßos, como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oferecem </font><font style="vertical-align: inherit;">agregadores de not√≠cias para&nbsp; </font><font style="vertical-align: inherit;">oferecer aos usu√°rios a escolha de diferentes conjuntos de artigos, dependendo do que lhes interessa. No caso do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agregador de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not√≠cias&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NewsAPI.org,</font></a><font style="vertical-align: inherit;"> podem ser as √∫ltimas not√≠cias ou not√≠cias de alguma categoria - "esporte", "sa√∫de", "ci√™ncia", "tecnologia", "neg√≥cios" ou not√≠cias de uma fonte de informa√ß√£o espec√≠fica "CNN" , Not√≠cias da ABC, Bloomberg, etc. O usu√°rio geralmente "expressa" seus desejos por servi√ßos na forma </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que for necess√°ria </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, usando a estrutura&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ pode</font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes usando um c√≥digo muito compacto (na maioria dos casos, n√£o mais que 10 a 12 linhas) uma vez para formar uma depend√™ncia s√≠ncrona e / ou ass√≠ncrona da lista de artigos&nbsp; </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de uma "assinatura" de </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades </font><font style="vertical-align: inherit;">"passivas" </font><font style="vertical-align: inherit;">para propriedades "ativas" </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Essa "assinatura" ser√° v√°lida durante todo o "ciclo de vida" da inst√¢ncia da&nbsp; </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe. E ent√£o, </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;voc√™ dar√° ao usu√°rio a oportunidade de gerenciar apenas as </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades </font><font style="vertical-align: inherit;">"ativas" </font><font style="vertical-align: inherit;">no formul√°rio </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, O QUE ele deseja ver: se ser√£o artigos com as √∫ltimas not√≠cias ou artigos na se√ß√£o "sa√∫de". A apar√™ncia dos artigos em si, com as √∫ltimas not√≠cias ou artigos na se√ß√£o "sa√∫de", </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ser√° fornecida AUTOMATICAMENTE por essas&nbsp; </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes e suas propriedades @ passivas "publicadas". Em c√≥digo</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;voc√™ nunca precisar√° solicitar explicitamente uma sele√ß√£o de artigos, porque as </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classes que desempenham um papel s√£o </font><font style="vertical-align: inherit;">respons√°veis ‚Äã‚Äãpor sua exibi√ß√£o correta e s√≠ncrona na tela&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vou mostrar como isso funciona com o&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banco de dados de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> filmes </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">TMDb</font></a><font style="vertical-align: inherit;"> em uma s√©rie de artigos. Nos tr√™s casos, aproximadamente o mesmo padr√£o de uso funcionar√°&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, porque em aplicativos desse tipo voc√™ sempre deve criar LISTAS de filmes ou artigos, escolha as ‚ÄúFOTOS‚Äù (imagens) que os acompanham, PESQUISA nas bases de dados dos filmes ou artigos necess√°rios usando a barra de pesquisa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao acessar esses servi√ßos, podem ocorrer erros, por exemplo, devido ao fato de voc√™ ter especificado a chave errada </font></font><code>API-key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou ter excedido o n√∫mero permitido de solicita√ß√µes ou outra coisa. Voc√™ precisa lidar com esse tipo de erro, caso contr√°rio, corre o risco de deixar o usu√°rio completamente perdido com uma tela em branco. Portanto, voc√™ precisa n√£o apenas selecionar </font></font><code>&nbsp;Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;dados da Internet </font><font style="vertical-align: inherit;">usando </font><font style="vertical-align: inherit;">, mas tamb√©m reportar erros que podem ocorrer durante a amostragem e controlar sua apar√™ncia na tela. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßaremos a desenvolver nossa estrat√©gia, desenvolvendo um aplicativo que interaja com o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agregador de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not√≠cias&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> . Devo dizer que, neste aplicativo, ele </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° usado no m√≠nimo, sem frescuras e apenas para mostrar como, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com seus "editores"</font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e "assinatura" s√£o </font></font><code>Subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">afetados </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â recomend√°vel que voc√™ se registre no site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e receba a chave </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">necess√°ria para concluir qualquer solicita√ß√£o ao servi√ßo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voc√™ deve coloc√°-lo no arquivo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na estrutura </font></font><code>APIConstants</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo do aplicativo para este artigo est√° no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelo de dados de servi√ßo e API do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O servi√ßo&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permite selecionar informa√ß√µes sobre os artigos de not√≠cias atuais </font></font><code> [Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e suas fontes&nbsp; </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nosso modelo de dados ser√° muito simples, est√° localizado no arquivo&nbsp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Articles.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">import</span> Foundation<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">NewsResponse</span>: <span class="hljs-title">Codable</span> </span>{
    <span class="hljs-keyword">let</span> status: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> totalResults: <span class="hljs-type">Int?</span>
    <span class="hljs-keyword">let</span> articles: [<span class="hljs-type">Article</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Article</span>: <span class="hljs-title">Codable</span>, <span class="hljs-title">Identifiable</span> </span>{
    <span class="hljs-keyword">let</span> id = <span class="hljs-type">UUID</span>()
    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> description: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> urlToImage: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> publishedAt: <span class="hljs-type">Date?</span>
    <span class="hljs-keyword">let</span> source: <span class="hljs-type">Source</span><font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SourcesResponse</span>: <span class="hljs-title">Codable</span> </span>{
    <span class="hljs-keyword">let</span> status: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> sources: [<span class="hljs-type">Source</span>]<font></font>
}<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Source</span>: <span class="hljs-title">Codable</span>,<span class="hljs-title">Identifiable</span> </span>{
    <span class="hljs-keyword">let</span> id: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> description: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> country: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> category: <span class="hljs-type">String?</span>
    <span class="hljs-keyword">let</span> url: <span class="hljs-type">String?</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O artigo </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conter√° o identificador </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, t√≠tulo </font></font><code> title</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, descri√ß√£o </font></font><code>&nbsp;description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, autor </font></font><code>author</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, URL da ‚Äúimagem‚Äù </font></font><code>urlToImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, data da publica√ß√£o </font></font><code>publishedAt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e fonte da publica√ß√£o </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Acima dos artigos, </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h√° um complemento </font></font><code>NewsResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no qual estaremos interessados ‚Äã‚Äãapenas na propriedade </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que √© uma variedade de artigos. A estrutura raiz </font></font><code>NewsResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a estrutura </font></font><code>&nbsp;Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o que nos permitir√° literalmente duas linhas de c√≥digo decodificando os </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados no Modelo. A estrutura&nbsp; </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tamb√©m deve ser </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se queremos tornar mais f√°cil para n√≥s para exibir uma s√©rie de artigos </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como uma lista&nbsp; </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;em </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Protocolo </font></font><code>Identifiable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer a presen√ßa de uma propriedade</font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que forneceremos com um identificador exclusivo artificial </font></font><code>UUID()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A fonte de informa√ß√µes&nbsp; </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conter√° um identificador </font></font><code> id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nome </font></font><code> name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, descri√ß√£o&nbsp; </font></font><code>description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pa√≠s </font></font><code> country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, categoria de fonte de publica√ß√£o </font></font><code>category</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, URL do site </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Acima das fontes de informa√ß√£o,&nbsp; </font></font><code>[Source] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h√° um complemento&nbsp; </font></font><code>SourcesResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no qual estaremos interessados ‚Äã‚Äãapenas em uma propriedade </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que √© uma matriz de fontes de informa√ß√£o. A estrutura </font></font><code>SourcesResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a&nbsp; </font><font style="vertical-align: inherit;">estrutura raiz </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o que nos permitir√° decodificar com muita facilidade os </font></font><code> JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dados em um modelo. A estrutura&nbsp; </font></font><code>Source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tamb√©m deve ser </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se quisermos facilitar a exibi√ß√£o de uma matriz de fontes de informa√ß√£o </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de uma lista </font></font><code>&nbsp;List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;em</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O protocolo </font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requer a presen√ßa da propriedade </font></font><code>id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que j√° possu√≠mos, portanto nenhum esfor√ßo adicional ser√° necess√°rio de n√≥s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora considere o que precisamos&nbsp; </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o servi√ßo&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e coloque-o no arquivo&nbsp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.swift</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A parte central da nossa </font></font><code>API</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√© uma classe </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que apresenta dois m√©todos para selecionar dados do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">agregador de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not√≠cias&nbsp;&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> - artigos&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e fontes de informa√ß√£o </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><code>fetchArticles (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp; - sele√ß√£o de artigos com&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base no par√¢metro </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Uma sele√ß√£o de fontes de informa√ß√£o </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para um pa√≠s espec√≠fico </font></font><code> country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esses m√©todos retornam n√£o apenas uma variedade de artigos&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ou uma variedade de fontes de informa√ß√µes </font></font><code>&nbsp;[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas os "publicadores" correspondentes da&nbsp; </font></font><code>Publisher </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nova estrutura </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ambos os editores n√£o retornam nenhum erro - </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e se ainda ocorreu um erro de amostragem ou codifica√ß√£o, uma matriz vazia de artigos </font></font><code>[Article]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ou fontes de informa√ß√£o √©&nbsp; </font><font style="vertical-align: inherit;">retornada&nbsp; </font></font><code>[Source]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem nenhuma mensagem sobre por que essas matrizes estavam vazias.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quais artigos ou fontes de informa√ß√£o que queremos selecionar no servidor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , indicaremos usando a enumera√ß√£o</font></font><code>enum Endpoint:</code><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Endpoint</span> </span>{
    <span class="hljs-keyword">case</span> topHeadLines
    <span class="hljs-keyword">case</span> articlesFromCategory(<span class="hljs-number">_</span> category: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> articlesFromSource(<span class="hljs-number">_</span> source: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> search (searchFilter: <span class="hljs-type">String</span>)
    <span class="hljs-keyword">case</span> sources (country: <span class="hljs-type">String</span>)<font></font>
    <font></font>
    <span class="hljs-keyword">var</span> baseURL:<span class="hljs-type">URL</span> {<span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://newsapi.org/v2/"</span>)!}<font></font>
    <font></font>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">path</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
        <span class="hljs-keyword">case</span> .topHeadLines, .articlesFromCategory:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"top-headlines"</span>
        <span class="hljs-keyword">case</span> .search,.articlesFromSource:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"everything"</span>
        <span class="hljs-keyword">case</span> .sources:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"sources"</span><font></font>
        }<font></font>
    }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isto:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as √∫ltimas not√≠cias&nbsp; </font></font><code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not√≠cias de uma determinada categoria (esportes, sa√∫de, ci√™ncia, neg√≥cios, tecnologia)&nbsp; </font></font><code>.articlesFromCategory(_ category: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not√≠cias de uma fonte espec√≠fica de informa√ß√µes (CNN, ABC News, Fox News etc.) </font></font><code>&nbsp;.articlesFromSource(_ source: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qualquer not√≠cia&nbsp; </font></font><code>.search (searchFilter: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que atenda a uma determinada condi√ß√£o </font></font><code>searchFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fontes de informa√ß√£o </font></font><code>.sources (country:String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para um pa√≠s em particular </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para facilitar a inicializa√ß√£o da op√ß√£o de que precisamos, adicionamos um </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inicializador </font></font><code>init?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† </font><font style="vertical-align: inherit;">enumera√ß√£o </font><font style="vertical-align: inherit;">para v√°rias listas de artigos e fontes de informa√ß√µes, dependendo do √≠ndice </font></font><code>index&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e da string </font></font><code> text</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que tem significados diferentes para diferentes op√ß√µes de enumera√ß√£o:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-keyword">init</span>? (index: <span class="hljs-type">Int</span>, text: <span class="hljs-type">String</span> = <span class="hljs-string">"sports"</span>) {
        <span class="hljs-keyword">switch</span> index {
        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-keyword">self</span> = .topHeadLines
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">self</span> = .search(searchFilter: text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-keyword">self</span> = .articlesFromCategory(text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-keyword">self</span> = .articlesFromSource(text)
        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-keyword">self</span> = .sources (country: text)
        <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><font></font>
        }<font></font>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos voltar √† classe </font></font><code> NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e considerar mais detalhadamente o primeiro m√©todo&nbsp; </font></font><code>fetchArticles (from endpoint: Endpoint)-&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que seleciona artigos com </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base no par√¢metro </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e n√£o retorna nenhum erro - </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticles</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = endpoint.absoluteURL <span class="hljs-keyword">else</span> {              <span class="hljs-comment">// 0</span>
                    <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Article</span>]()).eraseToAnyPublisher()<font></font>
        }<font></font>
           <span class="hljs-keyword">return</span>
            <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>:url)        <span class="hljs-comment">// 1</span>
            .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.data}                                       <span class="hljs-comment">// 2</span>
            .decode(type: <span class="hljs-type">NewsResponse</span>.<span class="hljs-keyword">self</span>,                    <span class="hljs-comment">// 3</span>
                    decoder: <span class="hljs-type">APIConstants</span> .jsonDecoder)<font></font>
            .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.articles}                                   <span class="hljs-comment">// 4</span>
            .replaceError(with: [])                             <span class="hljs-comment">// 5</span>
            .receive(on: <span class="hljs-type">RunLoop</span>.main)                          <span class="hljs-comment">// 6</span>
            .eraseToAnyPublisher()                              <span class="hljs-comment">// 7</span>
    }</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com base no </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;formul√°rio </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para a solicita√ß√£o, a lista desejada de artigos </font></font><code>endpoint.absoluteURL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se isso n√£o puder ser feito, retorne uma matriz vazia de artigos</font></font><code>[Article]()</code></li>
<li> ¬´¬ª <code>dataTaskPublisher(for:)</code>,     <code>Output </code>  <code>(data: Data, response: URLResponse)</code>, &nbsp; <code>Failure</code>&nbsp;-&nbsp;<code>URLError</code>,</li>
<li>  <code>map { }</code>       <code>(data: Data, response: URLResponse)</code>  &nbsp;<code>data</code>,&nbsp;</li>
<li> <code>JSON </code>&nbsp;<code>data</code>   ,   &nbsp;<code>NewsResponse</code>,    <code>articles:&nbsp;[Atricle]</code></li>
<li>  <code>map { }&nbsp;</code>        -&nbsp;<code>articles</code>,&nbsp;</li>
<li>  -        <code>[ ]</code>,</li>
<li>   <code>main </code>,          <code>UI</code>,</li>
<li>¬´¬ª  ¬´¬ª   <code>eraseToAnyPublisher()</code>    <code>AnyPublisher</code>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tarefa de selecionar fontes de informa√ß√£o √© atribu√≠da ao segundo m√©todo - </font></font><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que √© uma c√≥pia sem√¢ntica exata do primeiro m√©todo, exceto que, desta vez, em vez de artigos </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, escolheremos as fontes de informa√ß√£o </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchSources</span><span class="hljs-params">()</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Source</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = <span class="hljs-type">Endpoint</span>.sources.absoluteURL <span class="hljs-keyword">else</span> {      <span class="hljs-comment">// 0</span>
                       <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Source</span>]()).eraseToAnyPublisher()<font></font>
           }<font></font>
              <span class="hljs-keyword">return</span>
               <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>:url)      <span class="hljs-comment">// 1</span>
               .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.data}                                     <span class="hljs-comment">// 2</span>
               .decode(type: <span class="hljs-type">SourcesResponse</span>.<span class="hljs-keyword">self</span>,               <span class="hljs-comment">// 3</span>
                       decoder: <span class="hljs-type">APIConstants</span> .jsonDecoder)<font></font>
               .<span class="hljs-built_in">map</span>{$<span class="hljs-number">0</span>.sources}                                  <span class="hljs-comment">// 4</span>
               .replaceError(with: [])                           <span class="hljs-comment">// 5</span>
               .receive(on: <span class="hljs-type">RunLoop</span>.main)                        <span class="hljs-comment">// 6</span>
               .eraseToAnyPublisher()                            <span class="hljs-comment">// 7</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele retorna para n√≥s o "publicador" </font></font><code>AnyPublisher &lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um valor na forma de uma matriz de fontes de informa√ß√£o </font></font><code>[Source] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a aus√™ncia de um erro </font></font><code>&nbsp;Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;(no caso de erros, uma matriz vazia de fontes √© retornada&nbsp; </font></font><code>[ ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos destacar a parte comum desses dois m√©todos, organiz√°-la como uma </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fun√ß√£o </font></font><code>fetch(_ url: URL) -&gt; AnyPublisher&lt;T, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que retorna o&nbsp; </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor" com </font></font><code>AnyPublisher&lt;T, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base em </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-comment">//     URL</span>
     <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetch</span>&lt;T: Decodable&gt;<span class="hljs-params">(<span class="hljs-number">_</span> url: URL)</span></span> -&gt; <span class="hljs-type">AnyPublisher</span>&lt;<span class="hljs-type">T</span>, <span class="hljs-type">Error</span>&gt; {
                   <span class="hljs-type">URLSession</span>.shared.dataTaskPublisher(<span class="hljs-keyword">for</span>: url)             <span class="hljs-comment">// 1</span>
                    .<span class="hljs-built_in">map</span> { $<span class="hljs-number">0</span>.data}                                          <span class="hljs-comment">// 2</span>
                    .decode(type: <span class="hljs-type">T</span>.<span class="hljs-keyword">self</span>, decoder: <span class="hljs-type">APIConstants</span>.jsonDecoder) <span class="hljs-comment">// 3</span>
                    .receive(on: <span class="hljs-type">RunLoop</span>.main)                               <span class="hljs-comment">// 4</span>
                    .eraseToAnyPublisher()                                   <span class="hljs-comment">// 5</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso simplificar√° os dois m√©todos anteriores:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-comment">//   </span>
     <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticles</span><span class="hljs-params">(from endpoint: Endpoint)</span></span>
                                     -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">Never</span>&gt; {
         <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = endpoint.absoluteURL <span class="hljs-keyword">else</span> {
                     <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Article</span>]()).eraseToAnyPublisher() <span class="hljs-comment">// 0</span><font></font>
         }<font></font>
         <span class="hljs-keyword">return</span> fetch(url)                                          <span class="hljs-comment">// 1</span>
             .<span class="hljs-built_in">map</span> { (response: <span class="hljs-type">NewsResponse</span>) -&gt; [<span class="hljs-type">Article</span>] <span class="hljs-keyword">in</span>        <span class="hljs-comment">// 2</span>
                             <span class="hljs-keyword">return</span> response.articles }<font></font>
                .replaceError(with: [<span class="hljs-type">Article</span>]())                    <span class="hljs-comment">// 3</span>
                .eraseToAnyPublisher()                              <span class="hljs-comment">// 4</span><font></font>
     }<font></font>
    <font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchSources</span><span class="hljs-params">(<span class="hljs-keyword">for</span> country: String)</span></span>
                                       -&gt; <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Source</span>], <span class="hljs-type">Never</span>&gt; {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url = <span class="hljs-type">Endpoint</span>.sources(country: country).absoluteURL
            <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-type">Just</span>([<span class="hljs-type">Source</span>]()).eraseToAnyPublisher() <span class="hljs-comment">// 0</span><font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> fetch(url)                                         <span class="hljs-comment">// 1</span>
            .<span class="hljs-built_in">map</span> { (response: <span class="hljs-type">SourcesResponse</span>) -&gt; [<span class="hljs-type">Source</span>] <span class="hljs-keyword">in</span>     <span class="hljs-comment">// 2</span><font></font>
                            response.sources }<font></font>
               .replaceError(with: [<span class="hljs-type">Source</span>]())                    <span class="hljs-comment">// 3</span>
               .eraseToAnyPublisher()                             <span class="hljs-comment">// 4</span>
    }</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os "publicadores" assim obtidos n√£o entregam nada at√© que algu√©m os "assine". </font><font style="vertical-align: inherit;">Podemos fazer isso ao projetar </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Editores" </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code> SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Lista de artigos.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora um pouco sobre a l√≥gica do funcionamento </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√∫nica abstra√ß√£o das "mudan√ßas externas" √†s quais eles respondem </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o os "editores" </font></font><code>Publisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ‚ÄúAltera√ß√µes externas‚Äù podem ser entendidas como um temporizador </font></font><code> Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, uma notifica√ß√£o </font></font><code>NotificationCenter </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou seu objeto Modelo, que usando o protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode ser transformado em uma √∫nica ‚Äúfonte de verdade‚Äù externa (fonte de verdade).&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para "publishers" ordin√°rios tipo </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code>NotificationCenter</code> <code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reage usando o m√©todo </font></font><code>onReceive (_: perform:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Um exemplo do uso do "editor" </font></font><code>Timer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que apresentaremos posteriormente no terceiro artigo sobre a cria√ß√£o de um aplicativo para o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, focaremos em como criar nosso modelo para&nbsp;</font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"fonte da verdade" externa (fonte da verdade). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos primeiro ver como os </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editores" recebidos devem funcionar em um exemplo espec√≠fico de exibi√ß√£o de v√°rios tipos de artigos: </font></font><br>
<br>
<code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- as √∫ltimas not√≠cias,&nbsp; </font></font><code>.articlesFromCategory(_ category: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- not√≠cias para uma categoria espec√≠fica, </font></font><code>&nbsp;.articlesFromSource(_ source: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- not√≠cias para uma fonte espec√≠fica de informa√ß√µes, </font></font><code>.search (searchFilter: String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- not√≠cias selecionadas por uma determinada condi√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/ua/uv/zruauv9msu2nulm2ksuflhtxusi.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dependendo de qual </font></font><code> Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usu√°rio escolher, precisamos atualizar a lista de artigos </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selecionados no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para fazer isso, criaremos uma classe muito simples </font></font><code>&nbsp;ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que implementa um protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;com tr√™s&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades:</font></font><br>
&nbsp;<br>
<img src="https://habrastorage.org/webt/ty/xj/cs/tyxjcsfctbxerl9oiyr6ljvda8c.png"><br>
<br>
<ul>
<li><code>@Published var indexEndpoint: Int</code> ‚Äî   <code>Endpoint</code> (    ¬´¬ª,        <code>View</code>),&nbsp;&nbsp;</li>
<li><code>@Published var searchString: String</code> ‚Äî  ,             &nbsp;&nbsp;(     ¬´¬ª,        <code>View</code>&nbsp;    <code>TextField</code>),</li>
<li><code>@Published var articles: [Article]</code>&nbsp;-    ( ¬´¬ª,          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NewsAPI.org</a>,  ¬´¬ª).</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim que definir&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedades </font></font><code>indexEndpoint&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><code> searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos come√ßar a us√°-los tanto como propriedades simples&nbsp; </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e como "editores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em uma classe&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ pode n√£o apenas declarar as propriedades de interesse para n√≥s, mas tamb√©m prescrever a l√≥gica de neg√≥cios de sua intera√ß√£o. Para esse prop√≥sito, ao inicializar uma inst√¢ncia de uma classe&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;, </font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos criar uma "assinatura" que atuar√° durante todo o "ciclo de vida" da inst√¢ncia da classe&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e reproduzir√° a depend√™ncia da lista de artigos </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no √≠ndice&nbsp; </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e na cadeia de pesquisa </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para fazer isso, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estendemos a cadeia de "editores" </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e </font><font style="vertical-align: inherit;">produzimos </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editores"</font></font><code>AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cujo valor √© uma lista de artigos&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Em seguida, "assinamos" usando o operador </font></font><code>assign&nbsp;(to: \.articles, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e obtemos a lista de artigos que precisamos </font></font><code>articles </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como uma </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;propriedade </font><font style="vertical-align: inherit;">"output"&nbsp; </font><font style="vertical-align: inherit;">que define </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s devemos puxar a cadeia N√ÉO simplesmente das propriedades&nbsp; </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, principalmente dos "editores" </font></font><code> $indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que participam da cria√ß√£o </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com a ajuda de, </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e n√≥s os alteraremos l√° usando os elementos da interface do usu√°rio&nbsp; </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>TextField</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como faremos isso? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° temos uma fun√ß√£o em nosso arsenal </font></font><code>fetchArticles (from: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que est√° na classe&nbsp; </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e retorna um "editor" </font></font><code>AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dependendo do valor</font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e s√≥ podemos usar de alguma forma os valores dos "editores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transform√°-los em um argumento para </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">essa fun√ß√£o.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, combine os "editores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para fazer isso, o </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operador existe </font></font><code>Publishers.CombineLatest </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ci/pg/wd/cipgwdfx2fxmlevrmkf8nnkc6u4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar um novo "editor" com base nos dados recebidos do "editor" anterior </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;, o operador √© usado&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ln/s7/ur/lns7urzc9l64o8mswhliuggsyp4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, "assinamos" esse "editor" rec√©m-recebido usando um "assinante" muito simples&nbsp; </font></font><code>assign (to: \.articles, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e atribu√≠mos o recebido de " publisher "√†&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;matriz&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/su/io/xi/suioxibgc3t31oewzgkbfaljina.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
acabamos de criar uma </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">" editora "ASS√çNCRONA e" assinada "a ela, como resultado de</font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúAssinatura‚Äù e √© f√°cil verificar se mantemos nossa ‚Äúassinatura‚Äù constante </font></font><code>let subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gw/ig/ml/gwigml-zqpprclh76lzfnjhvzda.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
a principal propriedade de uma </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúassinatura‚Äù √© que, assim que sai de seu escopo, a mem√≥ria ocupada por ela √© automaticamente liberada. Portanto, assim que for </font></font><code>init( ) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conclu√≠da, essa "assinatura" ser√° exclu√≠da </font></font><code>ARC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sem tempo para atribuir as informa√ß√µes ass√≠ncronas recebidas com atraso na matriz </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Informa√ß√µes ass√≠ncronas simplesmente n√£o t√™m para onde "pousar", em seu sentido literal, "a Terra se escondeu". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para salvar essa "assinatura", √© necess√°rio criar uma </font></font><code> init() </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">AL√âM do inicializador </font></font><code>var&nbsp;cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que salvar√° nossa&nbsp; </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" nessa vari√°vel durante todo o "ciclo de vida" da inst√¢ncia da classe&nbsp;  </font></font><code>ArticlesViewMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, removemos a constante </font></font><code>let subscription</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e lembramos da nossa </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" na vari√°vel&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando o operador </font></font><code>.store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/my/gt/xw/mygtxwz7uhcurfyfnblva9irfku.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Subscription" para o "editor" ASS√çNCRONO em que criamos </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° preservado durante todo o "ciclo de vida" da inst√¢ncia da classe&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos alterar arbitrariamente o significado de "editores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e / ou&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e sempre gra√ßas √† "assinatura" criada, teremos uma variedade de artigos correspondentes aos valores desses dois editores&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem nenhum esfor√ßo adicional. Essa&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe geralmente √© chamada&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para reduzir o n√∫mero de chamadas ao servidor ao digitar uma string de pesquisa </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n√£o devemos usar o "editor" da pr√≥pria string de pesquisa&nbsp;</font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e sua vers√£o modificada </font></font><code>validString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/ir/2z/khir2z1rrmou-hks2rtfuq31bnm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
agora que temos </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nossos artigos, </font><font style="vertical-align: inherit;">vamos </font><font style="vertical-align: inherit;">come√ßar a criar a interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Para </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sincronizar </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com o </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Modelo, </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© </font><font style="vertical-align: inherit;">usada uma </font><font style="vertical-align: inherit;">vari√°vel que se refere a uma inst√¢ncia da classe deste Modelo. √â esse par - a&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;classe e a&nbsp; </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel que referencia a inst√¢ncia dessa classe - que controla a altera√ß√£o na interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) em&nbsp; </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicionamos √† estrutura uma </font></font><code>ContentView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;inst√¢ncia da classe </font></font><code>ArticleViewModel </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de uma vari√°vel </font></font><code>var articleViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a substitu√≠mos </font></font><code>Text ("Hello, World!")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por uma lista de artigos </font></font><code>ArticlesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na qual colocamos os artigos&nbsp; </font></font><code>articlesViewModel.articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obtidos de nossa&nbsp;</font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Como resultado, obtemos uma lista de artigos para um √≠ndice fixo e padr√£o&nbsp; </font></font><code>indexEndpoint = 0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, para as </font></font><code>.topHeadLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√∫ltimas not√≠cias: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/je/_f/j-/je_fj-0m2xews-ih7vptprkdpoy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione um </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elemento √† </font><font style="vertical-align: inherit;">nossa tela&nbsp; </font><font style="vertical-align: inherit;">para controlar qual conjunto de artigos queremos exibir. Usaremos a </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">altera√ß√£o </font><font style="vertical-align: inherit;">do&nbsp; </font><font style="vertical-align: inherit;">√≠ndice </font></font><code>$articlesViewModel.indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A presen√ßa de um s√≠mbolo √©&nbsp; </font></font><code>$</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obrigat√≥ria, pois isso significa uma altera√ß√£o no valor fornecido pelo&nbsp; </font></font><code>@Published&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor". A "assinatura" deste "editor" √© acionada imediatamente, e inici√°mos </font></font><code>init ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o " </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">editor" de </font><font style="vertical-align: inherit;">"sa√≠da"&nbsp; </font></font><code>&nbsp;articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;mudar√° e veremos uma lista diferente de artigos na tela: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/sd/pp/zxsdppfkp5y0nuk-j99uhovvmu8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dessa forma, podemos receber matrizes de artigos para as tr√™s op√ß√µes - "topHeadLines", "pesquisar "E" da categoria ":</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jm/yc/a_/jmyca_mvm0n2___cswvcamuuqqm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... mas para uma sequ√™ncia de pesquisa fixa e padr√£o </font></font><code>searchString = "sports"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(onde √© necess√°ria): no </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zq/pi/tw/zqpitwdhh3fsnciz9p2scvn1sas.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
entanto, para a op√ß√£o,&nbsp; </font></font><code>"search"</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;voc√™ deve fornecer ao usu√°rio um campo de texto </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para inserir a sequ√™ncia de pesquisa: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xk/d1/uu/xkd1uu0tmepthmsjlkzu--wlwse.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, o usu√°rio pode procurar qualquer not√≠cia pela sequ√™ncia de pesquisa digitada: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x4/ch/5a/x4ch5apliuwesqxjzeds58ab1t8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para a op√ß√£o,&nbsp; </font></font><code>"from category"&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© necess√°rio fornecer ao usu√°rio a oportunidade de escolher uma categoria e come√ßamos com categoria </font></font><code>science</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2i/8e/3v/2i8e3vvly1r_ipfuflxwbtepglq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
como resultado, o usu√°rio pode procurar qualquer not√≠cia sobre a categoria escolhida de not√≠cias - </font></font><code>science</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code> health</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,&nbsp; </font></font><code>business</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>technology</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/p_/pn/li/p_pnli0chxenoalmms3ltch-iwo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
podemos ver como uma forma muito simples&nbsp; </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;modelo que tem duas controladas pelo usu√°rio </font></font><code>@Published </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recursos - </font></font><code>indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e</font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- permite selecionar uma ampla variedade de informa√ß√µes no site&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lista de fontes de informa√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos ver como o </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;"editor" de fontes de informa√ß√µes recebidas na classe NewsAPI funcionar√° </font></font><code>fetchSources (for country: String)&nbsp;-&gt; AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obteremos uma lista de fontes de informa√ß√µes para diferentes pa√≠ses: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hr/oh/le/hrohle3hq8pkyhnjf6frali7yao.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... e a capacidade de procur√°-las por nome: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kg/ea/ll/kgeallzwaxnkvekct18th7knkyo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... bem como informa√ß√µes detalhadas sobre a fonte selecionada: nome, categoria, pa√≠s, descri√ß√£o resumida e link para o site:&nbsp; </font></font><br>
<br>
<img src="https://habrastorage.org/webt/k_/b7/9w/k_b79wirynz07feigtlhgdeyik4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ clicar no link, acessaremos o site deste site. fonte de informa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que tudo isso funcione, voc√™ precisa de um </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modelo </font><font style="vertical-align: inherit;">extremamente simples&nbsp; </font><font style="vertical-align: inherit;">que possua apenas duas </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades </font><font style="vertical-align: inherit;">controladas pelo usu√°rio </font><font style="vertical-align: inherit;">- </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e&nbsp; </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rs/id/4b/rsid4bb5xmkjdkwuptkmwvhi-yc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, novamente, usamos o mesmo esquema: ao inicializar uma inst√¢ncia de uma classe de uma </font></font><code>SourcesViewModel </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe em</font></font><code> init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criamos uma ‚Äúassinatura‚Äù que funcionar√° durante todo o ‚Äúciclo de vida‚Äù da inst√¢ncia da classe </font></font><code>&nbsp;SourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e garantimos que a lista de fontes de informa√ß√µes dependa&nbsp; </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do pa√≠s&nbsp; </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e da string de pesquisa </font></font><code>&nbsp;searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com a ajuda&nbsp; </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, extra√≠mos a cadeia dos "editores" </font></font><code>$searchString </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font><font style="vertical-align: inherit;">produzimos </font></font><code>$country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editores" </font></font><code>AnyPublisher&lt;[Source], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cujo valor √© uma lista de fontes de informa√ß√£o. N√≥s "assinamos" usando o operador </font></font><code>assign&nbsp;(to: \.sources, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, obtemos a lista de fontes de informa√ß√µes de que precisamos&nbsp; </font></font><code>sources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. e lembre-se da </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"assinatura" </font><font style="vertical-align: inherit;">recebida&nbsp; </font><font style="vertical-align: inherit;">em uma vari√°vel&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando o operador </font></font><code>.store ( in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora que temos </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nossas fontes de informa√ß√£o, </font><font style="vertical-align: inherit;">vamos </font><font style="vertical-align: inherit;">come√ßar a criar </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. B </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para sincronizar </font></font><code> View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;O modelo usa uma </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel que se refere a uma inst√¢ncia da classe deste modelo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione a </font></font><code>ContentViewSources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;inst√¢ncia </font><font style="vertical-align: inherit;">da </font><font style="vertical-align: inherit;">classe </font><font style="vertical-align: inherit;">√† estrutura&nbsp; </font></font><code>SourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na forma de uma vari√°vel </font></font><code>var sourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, remova&nbsp; </font></font><code>Text ("Hello, World!")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e coloque a sua </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para cada uma das 3&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades </font></font><code>&nbsp;sourcesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;:</font></font><br>
<br>
&nbsp;<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caixa de texto&nbsp; </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para a barra de pesquisa&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li>&nbsp;<code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para o pa√≠s </font></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lista de&nbsp; </font></font><code>SourcesList&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fontes de informa√ß√£o</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/td/tk/kn/tdtkknev57l3b5avb8y0uheu7fa.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, obtemos o que precisamos </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/gg/ly/jwgglycniqr2e-jhpifypfzx4m8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta tela, gerenciamos apenas a sequ√™ncia de pesquisa usando a caixa de texto </font></font><code>SearchView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e o ‚Äúpa√≠s‚Äù com&nbsp; </font></font><code>Picker</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e o resto acontece automaticamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A lista de fontes de informa√ß√£o </font></font><code>SourcesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cont√©m </font><font style="vertical-align: inherit;">informa√ß√µes </font><font style="vertical-align: inherit;">m√≠nimas sobre cada fonte - o nome </font></font><code>source.name </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e uma breve descri√ß√£o </font></font><code>source.description</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sj/zi/1z/sjzi1zh-7leadeujwarkuka_ii8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... mas permite obter informa√ß√µes mais detalhadas sobre a fonte selecionada usando o link </font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no qual </font></font><code>destination</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indicamos&nbsp; </font></font><code>DetailSourceView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quais dados de fonte s√£o a fonte de informa√ß√£o&nbsp; </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e a inst√¢ncia desejada da classe </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, permitindo obtenha uma lista de seus artigos </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ix/j_/uh/ixj_uheqhclwopwidsihztunn5e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veja como elegantemente obtemos a lista de artigos para a fonte selecionada de fonte de informa√ß√µes na lista de fontes&nbsp; </font></font><code>SourcesList</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nosso velho amigo nos ajuda - uma classe&nbsp; </font></font><code>ArticlesViewModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para a qual devemos definir as duas </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades de </font><font style="vertical-align: inherit;">"entrada"&nbsp; </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√≠ndice&nbsp; </font></font><code>indexEndpoint = 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ou seja, uma op√ß√£o&nbsp; </font></font><code>.articlesFromSource (_source:String)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correspondente √† sele√ß√£o de artigos para uma fonte fixa </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string&nbsp; </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;como a pr√≥pria fonte (ou melhor, seu identificador) </font></font><code>source.id&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/ia/xi/lr/iaxilr4rlcyippxuvkbd46kequ4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, se voc√™ olhar para todo o aplicativo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsApp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , n√£o ver√° nenhum lugar em que solicitamos explicitamente uma sele√ß√£o de artigos ou fontes de informa√ß√£o no site&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">N√≥s gerenciamos apenas os&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;dados, mas </font></font><code>View Model </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fazemos o nosso trabalho: seleciona os artigos e as fontes de informa√ß√£o que precisamos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fa√ßa o download da imagem </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para o artigo </font></font><code>Article</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O modelo do artigo&nbsp; </font></font><code>Article&nbsp;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cont√©m uma </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem </font></font><code>urlToImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que o </font><font style="vertical-align: inherit;">acompanha&nbsp; </font><font style="vertical-align: inherit;">: com </font></font><br>
<br>
<img src="https://habrastorage.org/webt/om/ny/fv/omnyfvhlcegrhltunqvjvyaq6l4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
base nisso,&nbsp; </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no futuro, devemos obter as imagens </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;no site&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° estamos familiarizados com esta tarefa. </font><font style="vertical-align: inherit;">Na classe </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, usando a fun√ß√£o, </font></font><code>fetchImage(for url: URL?) -&gt; AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crie um "editor"&nbsp;  </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com o valor da imagem&nbsp; </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e sem erros&nbsp; </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(na verdade, se ocorrerem erros, a imagem ser√° retornada </font></font><code> nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Voc√™ pode "assinar" este "editor" para receber imagens&nbsp; </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ao projetar a interface do usu√°rio ( </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Os dados de origem para a fun√ß√£o </font></font><code>fetchImage(for url: URL?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/do/a-/hg/doa-hg5idk0ukdghj0snu0-nubm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos considerar em detalhes como est√° acontecendo a forma√ß√£o, com a ajuda do </font></font><code> Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor" </font></font><code>AnyPublisher &lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se soubermos </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se for </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">igual </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, retorne </font></font><code>Just(nil)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com base na </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forma do "editor" </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cujo valor de sa√≠da </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© uma tupla </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e um erro </font></font><code>&nbsp;Failure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coletamos </font><font style="vertical-align: inherit;">apenas dados </font></font><code>map {}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">da tupla </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para processamento&nbsp; </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e formul√°rio adicionais </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se ocorrer o erro de retorno das etapas anteriores </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entregamos o resultado ao </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fluxo, pois assumimos um uso adicional no design </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Apague" o TIPO do "editor" e devolva a c√≥pia </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ v√™ que o c√≥digo √© bastante compacto e bem leg√≠vel, n√£o h√° nenhum </font></font><code>callbacks</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar a criar&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para a imagem </font></font><code>UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Esta √© uma classe </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que implementa o protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, com duas&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades:</font></font><br>
<br>
<ul>
<li><code>@Published url: URL?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;s√£o </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagens</font></font></li>
<li><code>@Published var image: UIImage?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√© a pr√≥pria imagem do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font></li>
</ul><br>
<img src="https://habrastorage.org/webt/li/o6/kr/lio6krhn0v1eyeiwg_cgpwcigia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, novamente, ao inicializar uma inst√¢ncia da classe,&nbsp; </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;precisamos estender a cadeia da entrada "publisher"&nbsp; </font></font><code>$url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;para a sa√≠da "publisher" </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, na qual </font><font style="vertical-align: inherit;">&nbsp;assinaremos </font><font style="vertical-align: inherit;">mais tarde e obteremos a imagem de que precisamos </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ba/gi/2s/bagi2swivajzz0pkgqzzsswudww.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usamos o operador </font></font><code>&nbsp;flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e um "assinante" muito simples&nbsp; </font></font><code>assign (to: \image, on: self)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para atribu√≠-la ao recebido do "publicador" "Valores para a propriedade </font></font><code>@Published image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eq/3k/4-/eq3k4-0pbruhk4qbcu8hmyinfmg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E novamente na vari√°vel&nbsp; </font><font style="vertical-align: inherit;">" assinatura "√© </font></font><code>cancellableSet </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">armazenada </font></font><code>AnyCancellable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando o operador&nbsp; </font></font><code>store(in: &amp;self.cancellableSet)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A l√≥gica desse ‚Äúdownloader de imagens‚Äù √© que voc√™ baixa uma imagem de algo diferente daquele, </font></font><code> nil URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde que n√£o tenha sido pr√©-carregado, ou seja,</font></font><code>image == nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se durante o processo de download for detectado algum erro, a imagem estar√° ausente, ou seja, </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permanecer√° igual </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mostramos a imagem com a ajuda </font></font><code>ArticleImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que uma inst√¢ncia da </font></font><code>imageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;classe </font><font style="vertical-align: inherit;">usa para isso </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se a imagem dele n√£o for igual </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ela ser√° exibida usando </font></font><code> Image (...)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas se for igual </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dependendo do que for igual </font></font><code>url </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nada ser√° mostrado </font></font><code>EmptyView()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou um ret√¢ngulo </font></font><code>Rectangle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com texto rotativo T ser√° </font><font style="vertical-align: inherit;">exibido </font></font><code>ext("Loading...")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mh/nq/yi/mhnqyirurke0w6yibfxm86gap1i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa l√≥gica funciona bem para o caso quando voc√™ tiver certeza de que&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, al√©m de&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obter uma imagem </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como √© o caso do banco de dados de filmes&nbsp;</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMDb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Com o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org, o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agregador de not√≠cias&nbsp; </font><font style="vertical-align: inherit;">&nbsp; √© diferente. Os artigos de algumas fontes de informa√ß√£o d√£o uma diferente da&nbsp; </font></font><code>nil&nbsp;URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem, mas o acesso √© fechado e obtemos um ret√¢ngulo </font></font><code>Rectangle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com texto rotativo </font></font><code>Text("Loading...")</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que nunca ser√° substitu√≠do: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/tq/lp/shtqlpz4wx-iobt19-wv9j2pb7w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nesta situa√ß√£o, se a </font></font><code>&nbsp;URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem for diferente&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, a igualdade da&nbsp; </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagem&nbsp; </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode significar que a imagem est√° sendo carregada. , e o fato de ocorrer um erro ao carregar e nunca obteremos uma imagem </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para distinguir entre essas duas situa√ß√µes, adicionamos </font><font style="vertical-align: inherit;">mais uma </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;√†s duas </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades </font><font style="vertical-align: inherit;">existentes </font><font style="vertical-align: inherit;">na classe&nbsp; </font><font style="vertical-align: inherit;">:&nbsp;</font></font><br>
<br>
<code>&nbsp;@Published var noData = false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;- este √© um valor booleano com o qual indicaremos a aus√™ncia de dados da imagem devido a um erro durante a sele√ß√£o: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kp/jc/sq/kpjcsqugrsfzyghmefnge0unscy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao criar uma "assinatura", </font></font><code> init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capturamos todos os erros </font></font><code> Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que ocorrem ao carregar a imagem e acumulamos sua presen√ßa na&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedade </font></font><code>self.noData = true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se o download foi bem-sucedido, obtemos a imagem </font></font><code>image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
Criamos o </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Publicador"&nbsp; </font></font><code>AnyPublisher&lt;UIImage?, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;com base na&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;fun√ß√£o </font></font><code>fetchImageErr (for url: URL?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/7f/ek/jf/7fekjfrbihaieypuxaovub1-op8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Come√ßamos a criar um m√©todo </font></font><code>fetchImageErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inicializando o "publicador"&nbsp; </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que pode ser usado para obter de forma ass√≠ncrona um √∫nico valor TYPE </font></font><code>Result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando um fechamento. O fechamento possui um par√¢metro - </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que √© uma fun√ß√£o do TYPE&nbsp; </font></font><code>(Result&lt;Output, Failure&gt;) ‚Üí Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Transformaremos o </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iu/ch/_u/iuch_uvhdkz42-mfyuiuq3jiosg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
resultado </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em</font></font><code>AnyPublisher &lt;UIImage?, Error&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com a ajuda do operador ‚ÄúErase TYPE‚Äù </font></font><code>eraseToAnyPublisher()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, vamos realizar os seguintes passos, tendo em conta todos os erros poss√≠veis (n√£o vamos identificar erros, √© simplesmente importante para n√≥s saber que h√° um erro): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
0. verifica√ß√£o </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e&nbsp; </font></font><code>noData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: em caso afirmativo, em seguida, retornar o erro, se n√£o, a transfer√™ncia de </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais longe, cadeia, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. crie um "publicador" </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuja entrada seja - </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e o valor de sa√≠da </font></font><code>Output</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seja uma tupla </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e um erro&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. analise usando a </font></font><code> tryMap { }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;tupla resultante </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: se </font></font><code>response.statusCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estiver no intervalo </font></font><code>200...299</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, para processamento adicional, coletamos apenas os dados&nbsp; </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Caso contr√°rio, "descartamos" um erro (n√£o importa o qu√™),</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. vamos </font></font><code>map { }</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">converter os dados </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para </font></font><code>UIImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. entregar o resultado para o </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fluxo, uma vez que assumimos que vamos us√°-lo mais tarde no projeto </font></font><code>UI</code><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - que ‚Äúassinar‚Äù para o ‚Äúpublisher‚Äù recebeu usando </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seus fechamentos </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 5. se </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;encontrar um erro </font><font style="vertical-align: inherit;">no fechamento&nbsp; </font></font><code>error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, relatamos usando-o </font></font><code>promise (.failure(error)))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - 6. no fechamento,&nbsp; </font></font><code>receiveValue </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informamos sobre o recebimento bem-sucedido de uma variedade de artigos usando </font></font><code> promise (.success($0))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7. lembramos a "assinatura" recebida na vari√°vel&nbsp; </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para garantir sua viabilidade durante o "tempo de vida" da inst√¢ncia da classe </font></font><code>ImageLoader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8. apagamos "o" editor "TYPE e retorne a inst√¢ncia </font></font><code>AnyPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Retornamos para </font></font><code>ArticleImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde usaremos a nova&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font></font><code>noData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se n√£o houver dados de imagem, n√£o exibiremos nada, ou seja </font></font><code>EmptyView ()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3k/wr/v_/3kwrv_cecjy2f8jea3rgnnpkzri.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Finalmente, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuniremos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> todas as nossas possibilidades de exibir dados do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">agregador de</font></a><font style="vertical-align: inherit;"> not√≠cias </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> em </font></font><code>TabView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yq/xb/ra/yqxbraupq1d0tgeygy2lb05o4xo.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exibir erros ao buscar e decodificar dados JSON do servidor&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao acessar o servidor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,&nbsp; </font><font style="vertical-align: inherit;">podem ocorrer </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">erros</font></a><font style="vertical-align: inherit;"> , por exemplo, devido ao fato de voc√™ ter especificado a chave errada </font></font><code>API-key</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou, por ter uma tarifa de desenvolvedor que n√£o custa nada, exceder o n√∫mero permitido de solicita√ß√µes ou outra coisa. Ao mesmo tempo, o servidor&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;fornece o </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo e a mensagem correspondente: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_f/2n/zv/_f2nzv5bndlu8auo9cygjyk9fta.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio lidar com esse tipo de erro no servidor. Caso contr√°rio, o usu√°rio do seu aplicativo entrar√° em uma situa√ß√£o em que, repentinamente, sem motivo, o servidor&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;interromper√° o processamento de quaisquer solicita√ß√µes, deixando o usu√°rio completamente perdido com uma tela em branco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© agora, ao selecionar artigos&nbsp; </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e fontes de informa√ß√µes&nbsp; </font></font><code>[Source]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no servidor&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;ignoramos todos os erros e, no caso de sua apar√™ncia, retornamos matrizes vazias </font></font><code>[Article]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e,&nbsp; </font><font style="vertical-align: inherit;">como resultado&nbsp; </font></font><code>[Source]()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßando com o tratamento de erros, vamos </font></font><code>fetchArticles (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;criar </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;outro m√©todo </font><font style="vertical-align: inherit;">na classe com </font><font style="vertical-align: inherit;">base no </font><font style="vertical-align: inherit;">m√©todo de </font><font style="vertical-align: inherit;">sele√ß√£o de artigo&nbsp; </font><font style="vertical-align: inherit;">existente </font></font><code>fetchArticlesErr (from endpoint: Endpoint) -&gt; AnyPublisher&lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que retornar√° n√£o apenas uma matriz de artigos </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas tamb√©m um poss√≠vel erro&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fetchArticlesErr</span><span class="hljs-params">(from endpoint: Endpoint)</span></span> -&gt;
                            <span class="hljs-type">AnyPublisher</span>&lt;[<span class="hljs-type">Article</span>], <span class="hljs-type">NewsError</span>&gt; {<font></font>
<font></font>
. . . . . . . .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse m√©todo, assim como o m√©todo </font></font><code>fetchArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, aceita </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e retorna o "publicador" </font><font style="vertical-align: inherit;">na entrada </font><font style="vertical-align: inherit;">com um valor na forma de uma matriz de artigos </font></font><code>[Article]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas, em vez da aus√™ncia de um erro </font></font><code>Never</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos ter um erro definido pela enumera√ß√£o </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/x9/es/ey/x9eseyq8jbapjkmgdoj7aggc6f0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Come√ßamos a criar um novo m√©todo inicializando o "publicador"&nbsp; </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que use para obter assincronamente um √∫nico valor TYPE </font></font><code>Result</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando um fechamento. </font><font style="vertical-align: inherit;">O fechamento possui um par√¢metro - </font></font><code>Promise</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que √© uma fun√ß√£o do TYPE&nbsp; </font></font><code>(Result&lt;Output, Failure&gt;) -&gt; Void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">Transformaremos os </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/bw/ct/3wbwctuso0qweiz3a8qk_h1aiom.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
recebidos </font></font><code>Future</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no "editor" necess√°rio,&nbsp; </font></font><code>AnyPublisher &lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando o operador "TYPE Erase" </font></font><code>eraseToAnyPublisher()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais adiante no novo m√©todo, </font></font><code>fetchArticlesErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repetiremos todas as etapas que executamos no m√©todo&nbsp;</font></font><code>fetchArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas consideraremos todos os erros poss√≠veis:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pb/xz/i0/pbxzi0rn5-cuandt3rtu74ofj8s.png"><br>
<br>
<ul>
<li>0.   endpoint&nbsp; <code>URL endpoint.absoluteURL </code>    , <code> url </code> <code>nil</code>:  <code>nil</code>,    <code>.urlError</code>,   ‚Äî  <code>url</code>   ,</li>
<li>1.  ¬´¬ª <code>dataTaskPublisher(for:)</code>,     ‚Äî <code>url</code>,    <code>Output</code>   <code>(data: Data, response: URLResponse)</code>  &nbsp;<code>URLError</code>,</li>
<li>2.    <code>tryMap { }</code>&nbsp;  <code>(data: Data, response: URLResponse)</code>:  <code>response.statusCode</code>    <code>200...299</code>,       &nbsp;<code>data</code>.    ¬´¬ª  <code>.responseError</code>,  &nbsp;&nbsp;<code>data</code>,    <code>String</code>,    ,</li>
<li>3. <code> JSON</code>    ,   &nbsp;<code>NewsResponse</code>,</li>
<li>4.    <code>main</code> ,         <code>UI</code></li>
<li>¬´¬ª   ¬´¬ª   <code>sink</code>    <code>receiveCompletion</code>  <code>receiveValue</code>,<br>
 <ul>
<li>5.&nbsp; &nbsp;&nbsp;<code>receiveCompletion</code>&nbsp;  <code>error</code>,       <code>promise (.failure(...)))</code>,</li>
<li> 6.&nbsp;&nbsp;&nbsp;<code>receiveValue</code>         <code>promise (.success($0.articles))</code>,</li>
</ul>&nbsp;</li>
<li>7.&nbsp;  ¬´¬ª  &nbsp;<code>var subscriptions</code>,       ¬´ ¬ª   <code>NewsAPI</code>,</li>
<li>8. ¬´¬ª  ¬´¬ª    <code>AnyPublisher</code>.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deve-se observar que o "publicador"&nbsp; </font></font><code>dataTaskPublisher(for:)</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">difere</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de seu prot√≥tipo </font></font><code>dataTask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pois, no caso de um erro do servidor quando </font></font><code>response.statusCode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;N√ÉO </font><font style="vertical-align: inherit;">est√° </font><font style="vertical-align: inherit;">no intervalo </font></font><code>200...299</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ele ainda fornece o valor bem-sucedido na forma de uma tupla </font></font><code>(data: Data, response: URLResponse)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e n√£o um erro no formul√°rio </font></font><code>(Error, URLResponse?)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nesse caso, as informa√ß√µes reais de erro do servidor est√£o contidas </font></font><code>data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. O "publicador" </font></font><code>dataTaskPublisher(for:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;gera um erro&nbsp; </font></font><code>URLError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se ocorrer um erro no lado do cliente (incapacidade de entrar em contato com o servidor, proibi√ß√£o do sistema de seguran√ßa </font></font><code>ATS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se queremos exibir erros </font></font><code>SwiftUI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, precisamos do correspondente </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que chamaremos&nbsp; </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/em/1o/qy/em1oqy5ob60o8xzmz_-kpdvzs4a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na classe </font></font><code>&nbsp;ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que implementa o protocolo </font></font><code>ObservableObject </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, desta vez temos QUATRO&nbsp; </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propriedades:</font></font><br>
<br>
<ol>
<li><code>@Published var indexEndpoint: Int</code> ‚Äî   <code>Endpoint</code> (    ¬´¬ª,     <code> View</code>),&nbsp;</li>
<li><code>@Published var searchString: String</code> ‚Äî   ,    &nbsp;<code>Endpoint</code>:    ¬´¬ª ,       (      ¬´¬ª,        <code>View</code>),&nbsp;</li>
<li>&nbsp;<code>@Published var articles: [Article]</code>&nbsp;-    ( ¬´¬ª,        &nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NewsAPI.org&nbsp;</a>)</li>
<li>&nbsp;&nbsp;<code>@Published var articlesError: NewsError?</code>&nbsp;-  ,      &nbsp;    &nbsp;<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NewsAPI.org&nbsp;</a>.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando voc√™ inicializa uma inst√¢ncia de uma classe </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, devemos estender novamente uma cadeia de entrada "editores" </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sa√≠da "publisher"&nbsp; </font></font><code>AnyPublisher&lt;[Article],NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, √† qual "assinamos" com o "Assinante" </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e recebemos muitos artigos </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou erros&nbsp; </font></font><code>articlesError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em nossa classe, </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j√° constru√≠mos uma fun√ß√£o&nbsp; </font></font><code>fetchArticlesErr (from endpoint: Endpoint)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que retorna um "publicador"&nbsp; </font></font><code>AnyPublisher&lt;[Article], NewsError&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dependendo do valor </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e s√≥ precisamos usar de alguma forma os valores dos "publicadores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transform√°-los em argumento para essa fun√ß√£o </font></font><code>endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.&nbsp; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar, combinaremos os "editores"&nbsp; </font></font><code>$indexEndpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para fazer isso, </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existe um operador </font></font><code>Publishers.CombineLatest</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5i/lz/zh/5ilzzh6h5_aity8uvzd6eladg7q.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, devemos definir o tipo de erro TYPE "publisher" igual ao necess√°rio&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oe/85/tt/oe85tthmperdfzf6yqiy5fmy2b4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, queremos usar a fun√ß√£o&nbsp; </font></font><code>fetchArticlesErr (from endpoint: Endpoint) </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">da nossa classe </font></font><code>NewsAPI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Como de costume, faremos isso com a ajuda de um operador&nbsp; </font></font><code>flatMap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que cria um novo "editor" com base nos dados recebidos do "editor" anterior: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bh/bu/kx/bhbukxfbhg2q9otl4rp-ksponec.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Assinamos" esse "editor" rec√©m-recebido com a ajuda de um "assinante" </font></font><code>sink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e usamos seus fechamentos </font></font><code>receiveCompletion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>receiveValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para receber do "editor" o valor de uma matriz de artigos&nbsp; </font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou erros </font></font><code>articlesError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cq/x8/iy/cqx8iyvnwanwmv1vselki10ytv4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, √© necess√°rio lembrar a "assinatura" resultante em alguma </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vari√°vel </font><font style="vertical-align: inherit;">externa </font></font><code>cancellableSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Caso contr√°rio, n√£o conseguiremos obter o valor de forma ass√≠ncrona</font></font><code>articles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou um erro </font></font><code>articlesError </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ap√≥s a conclus√£o </font></font><code>init()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kh/wh/_a/khwh_ao98y7zy9cdpenc0nzvntq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para reduzir o n√∫mero de chamadas para o servidor ao digitar uma sequ√™ncia de pesquisa </font></font><code>searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, n√£o devemos usar o "editor" da pr√≥pria barra de pesquisa&nbsp; </font></font><code>$searchString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mas sua vers√£o modificada </font></font><code>validString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fl/op/ss/flopssp-pjixvbtesqabmpp1h2s.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Inscrevendo-se" no "editor" ASS√çNCRONO que criamos </font></font><code>init( )</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ser√° persistir durante todo o ‚Äúciclo de vida‚Äù da inst√¢ncia da classe&nbsp; </font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nt/iw/k4/ntiwk4eju6aneam-1wlymjqyu9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Procuramos a corre√ß√£o do nosso </font></font><code> UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para exibir poss√≠veis erros de amostragem de dados nele. Em </font></font><code>SwiftU</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I, na estrutura existente,&nbsp; </font></font><code>ContentVieArticles</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;usamos outra, apenas obtida&nbsp; </font></font><code>View Model</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, apenas adicionando as letras ‚ÄúErr‚Äù no nome. Esta √© uma inst√¢ncia da classe.&nbsp;&nbsp;</font></font><code>ArticlesViewModelErr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que ‚Äúcaptura‚Äù o erro de selecionar e / ou decodificar os dados do artigo no servidor&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kw/vy/uv/kwvyuvbthb08tcalkcdpnucqfbq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, adicionamos a exibi√ß√£o de uma mensagem de emerg√™ncia&nbsp; </font></font><code>Alert</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;em caso de erro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, se a chave da API errada for:</font></font><br>
<br>
<pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">APIConstants</span> </span>{
    <span class="hljs-comment">// News  API key url: https://newsapi.org</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> apiKey: <span class="hljs-type">String</span> = <span class="hljs-string">"API_KEY"</span> <font></font>
    <font></font>
   .  .  .  .  .  .  .  .  .  .  .  .  .<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
... ent√£o receberemos a seguinte mensagem: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/nb/ws/si/nbwssihj8ldlqqtcbti4tjwcv7o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o limite de solicita√ß√µes estiver esgotado, receberemos a seguinte mensagem: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/cz/de/ux/czdeuxquiscc-6qklciy5a0w3jm.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voltando ao m√©todo de sele√ß√£o de artigos&nbsp; </font></font><code>[Article] </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um poss√≠vel erro&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, podemos simplificar seu c√≥digo se usarmos o&nbsp; </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;"editor" </font></font><code>AnyPublisher&lt;T,NewsError&gt;,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que, com base no conjunto,&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recebe </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informa√ß√µes de </font><font style="vertical-align: inherit;">forma ass√≠ncrona </font><font style="vertical-align: inherit;">, as coloca diretamente no </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modelo </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;e relata um erro&nbsp; </font></font><code>NewsError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lc/v7/m9/lcv7m9fmdbq20ih5phivj7hl1go.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
como sabemos, esse c√≥digo √© muito f√°cil de usar para obter um "editor" espec√≠fico se os dados de origem </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forem um </font><font style="vertical-align: inherit;">&nbsp;pa√≠s ou&nbsp; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">agregador de</font></a></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not√≠cias&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NewsAPI.org</font></font></a><font style="vertical-align: inherit;"></font><code>country</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonte de informa√ß√£o e a sa√≠da requer v√°rios modelos - por exemplo, uma lista de artigos ou fontes de informa√ß√£o:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ig/ff/4q/igff4qjqmxcxloixsshjbc36uxy.png"><br>
<br>
<img src="https://habrastorage.org/webt/bh/o_/7n/bho_7nbyxpl5yxth1ihweasjbec.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aprendemos como √© f√°cil atender a </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solicita√ß√µes com a ajuda de </font></font><code> Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seu </font></font><code>URLSession</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor" </font></font><code>dataTaskPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>Codable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se voc√™ n√£o precisa rastrear erros, obt√©m um </font></font><code> Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo de 5 linhas </font><font style="vertical-align: inherit;">muito simples </font><font style="vertical-align: inherit;">para o "editor" </font></font><code>AnyPublisher&lt;T, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que recebe </font></font><code>JSON </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informa√ß√µes de </font><font style="vertical-align: inherit;">forma ass√≠ncrona </font><font style="vertical-align: inherit;">e as coloca diretamente no </font></font><code>Codable </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modelo com </font></font><code>T</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;base no dado&nbsp; </font></font><code>url</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2i/r_/6w/2ir_6wkuga1u9jcxsmqijle480e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este c√≥digo √© muito f√°cil de usar para obter um editor espec√≠fico, se os dados de origem </font></font><code>url </code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forem, por exemplo </font></font><code>Endpoint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e a sa√≠da requer v√°rios modelos - por exemplo, um conjunto de artigos ou uma lista de fontes de informa√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ precisar levar em conta os erros, o c√≥digo do&nbsp; </font></font><code>Generic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"editor" ser√° um pouco mais complicado, mas ainda assim ser√° um c√≥digo muito simples, sem retornos de chamada:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/fi/4d/ep/fi4depxf-hbngki4p5y3ktunbny.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usando a tecnologia de execu√ß√£o de </font></font><code>HTTP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consultas </font></font><code>Combine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ pode criar um "editor" </font></font><code>AnyPublisher&lt;UIImage?, Never&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que seleciona dados de forma ass√≠ncrona e recebe uma imagem UIImage? baseado em </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Os </font></font><code>ImageLoade</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">downloaders de imagem r s√£o armazenados em cache na mem√≥ria para evitar a recupera√ß√£o repetida de dados ass√≠ncronos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os tipos de "editores" obtidos podem muito facilmente ser "feitos para funcionar" nas classes ObservableObject, que usam suas propriedades @Published para controlar sua interface do usu√°rio projetada usando o SwiftUI. Essas classes geralmente desempenham o papel do modelo de exibi√ß√£o, pois possuem as chamadas propriedades @Published "entrada" que correspondem aos elementos ativos da interface do usu√°rio (caixas de texto TextField, Stepper, Picker, bot√µes de op√ß√£o Alternar etc.) e propriedades @Published "output" , consistindo principalmente em elementos passivos da interface do usu√°rio (textos, imagens, imagens, formas geom√©tricas em c√≠rculo (), ret√¢ngulo () etc.). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa id√©ia permeia todo o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agregador de not√≠cias </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">NewsAPI.org</font></a><font style="vertical-align: inherit;"> apresentado neste artigo. bastante universal e foi usado quando</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desenvolvimento de um aplicativo para o </font></font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banco de dados de </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">filmes </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">TMDb</font></a><font style="vertical-align: inherit;"> e o agregador de not√≠cias&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hacker News</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que ser√£o discutidos em artigos futuros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo do aplicativo para este artigo est√° no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Quero chamar sua aten√ß√£o para o fato de que, se voc√™ usar o simulador para o aplicativo apresentado neste artigo, saiba que </font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o simulador funciona com um erro. Voc√™ pode usar</font></font><code>NavigationLink</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no simulador apenas 1 vez. </font><font style="vertical-align: inherit;">Essa. </font><font style="vertical-align: inherit;">voc√™ usou o link, voltou, clique no mesmo link - e nada acontece. </font><font style="vertical-align: inherit;">At√© voc√™ usar outro link, o primeiro n√£o funcionar√°, mas o segundo ficar√° inacess√≠vel. </font><font style="vertical-align: inherit;">Mas isso √© observado apenas no simulador, em um dispositivo real tudo funciona bem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Algumas fontes de informa√ß√£o ainda usam </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em vez </font></font><code>https</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de "imagens" dos seus artigos. </font><font style="vertical-align: inherit;">Se voc√™ definitivamente deseja ver essas ‚Äúimagens‚Äù, mas n√£o pode controlar a fonte de sua apar√™ncia, √© necess√°rio configurar o sistema de seguran√ßa </font></font><code>ATS ( App Transport Security)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para receber essas </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúimagens‚Äù, mas isso, obviamente, n√£o √© uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boa ideia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Voc√™ pode usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">op√ß√µes mais seguras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Refer√™ncias:</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    HTTP   Swift 5   Combine     SwiftUI.  1 .</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modern Networking in Swift 5 with URLSession, Combine and Codable.</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">URLSession.DataTaskPublisher‚Äôs failure type</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Combine: Asynchronous Programming with Swift</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">¬´SwiftUI &amp; Combine:  ¬ª</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Introducing Combine ‚Äî WWDC 2019 ‚Äî Videos ‚Äî Apple Developer. session 722</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">(  722 ¬´  Combine¬ª   )</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Combine in Practice ‚Äî WWDC 2019 ‚Äî Videos ‚Äî Apple Developer. session 721</a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">(  721 ¬´  Combine¬ª   )</a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt488428/index.html">Como prever o futuro na pesquisa Yandex: de corre√ß√µes de erros a consultas de descoberta</a></li>
<li><a href="../pt488432/index.html">Snoop Project, uma ferramenta incr√≠vel para intelig√™ncia na Internet, que os usu√°rios do RuNet est√£o esperando h√° tanto tempo - est√° dispon√≠vel</a></li>
<li><a href="../pt488436/index.html">Crie rapidamente m√∫sicas de chiptune de c√≥digo aberto</a></li>
<li><a href="../pt488438/index.html">A hist√≥ria dos formatos de √°udio para filmes: a resposta alem√£ para cassetes compactas - como foi o destino do desenvolvimento</a></li>
<li><a href="../pt488440/index.html">Lords of DOOM: como dois caras criaram um atirador de culto e abalaram a ind√∫stria de videogames</a></li>
<li><a href="../pt488446/index.html">Instrumenta√ß√£o russa: transformamos seu design nos dedos</a></li>
<li><a href="../pt488448/index.html">Fa√ßa um passeio na Universidade ITMO: nossas master classes, workshops, palestras e competi√ß√µes de estudantes</a></li>
<li><a href="../pt488450/index.html">Como funciona uma nova gera√ß√£o de servi√ßos banc√°rios online</a></li>
<li><a href="../pt488456/index.html">Atividades de projeto em universidades e quais benef√≠cios ela oferece</a></li>
<li><a href="../pt488458/index.html">Desafio de back-end Java / Kotlin do FunCode: anunciados os vencedores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>