<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☮️ ◾️ 👩🏿‍🤝‍👨🏽 保护和黑客Xbox 360（第3部分） ♊️ 🧘🏻 👃🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在Xbox 360游戏机发布6年后的2011年，研究人员发现了一个有趣的事实-如果信号“ 0”在很短的时间内发送到中央处理器的RESET输出，则该处理器不会重置其状态（应该如此），而是改变你的行为！基于此“功能”，开发了Reset Glitch Hack（RGH），借助它可以完全破坏Xbox 360...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>保护和黑客Xbox 360（第3部分）</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500246/"><img src="https://habrastorage.org/webt/ly/33/lc/ly33lcab4l10ezi7uwxcjouyzw8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Xbox 360游戏机发布6年后的2011年，研究人员发现了一个有趣的事实-如果信号“ 0”在很短的时间内发送到中央处理器的RESET输出，则该处理器不会重置其状态（应该如此），而是改变你的行为！</font><font style="vertical-align: inherit;">基于此“功能”，开发了</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset Glitch Hack（RGH）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，借助它可以完全破坏Xbox 360的保护，运行未签名的代码，从而为入侵系统本身和击败“牢不可破”的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DG-16D5S驱动器</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开辟了道路</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
让我们仔细研究一下RGH的工作原理，开发人员如何修补漏洞以及这些漏洞如何解决！</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是小故障攻击？</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无论营销人员怎么说，该处理器都非常笨。</font><font style="vertical-align: inherit;">程序员编写的所有高级代码都简化为简单命令的执行-数字运算，移动数据，有条件和无条件跳转。</font><font style="vertical-align: inherit;">假定处理器始终执行这些命令而没有错误，并且结果与文档相符。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/ae/ik/aeaeiktfaf_phbyprnjmqmwu0y4.png"></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实，编译代码</font></font><br>
<pre><code class="cpp hljs">i = i + <span class="hljs-number">2</span>;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您依赖于这样一个事实，变量i的值将精确地增加2，而没有意识到否则会怎样。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小故障攻击违反了这种信心-他们的目标是确保处理器“笨拙”且行为错误。</font><font style="vertical-align: inherit;">有几种“干扰”处理器的方法，例如：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">消耗CPU电压</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为CPU的参考频率提供额外的脉冲</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“发光”辐射百分比</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有一些特殊的设备可以进行此类攻击-例如，ChipWhisperer在频率和功率方面提供了广泛的攻击方式：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/uy/bu/ycuybuxustoyjxpu590edtbyjz0.jpeg" width="550"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Xbox 360的情况下，由于暴露在RESET线上而导致了“小故障”。</font><font style="vertical-align: inherit;">处理器开始复位过程，但是由于信号持续时间很短，它没有时间完成它，并且继续工作，好像什么都没发生。</font><font style="vertical-align: inherit;">但是就在这短暂的瞬间，当RESET信号处于活动状态时，其行为会改变！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小故障处理器</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360保护取决于引导程序在链中相互检查。最终，每个阶段的验证都归结为调用将散列和与“模式”进行比较的功能。那时他们施加了小故障攻击，迫使处理器忽略不匹配。调用</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过程后，立即向RESET行施加脉冲，</font><font style="vertical-align: inherit;">迫使处理器沿着另一个分支“执行”并继续加载，即使哈希总和不正确也是如此：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/8a/i7/e68ai7t_wy0-har4u49gddcfwh4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二阶段的引导加载程序“ CB”中发现了最佳的攻击场所。</font><font style="vertical-align: inherit;">后面的阶段较难攻击（且易于修复），但是在加载的第一阶段（“ 1BL”，ROM），由于程序代码的结构略有不同，因此攻击失败。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
听起来很简单，但实际上，当尝试进行攻击时，发现了许多细微差别。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，为了成功进行毛刺攻击，必须非常准确地确定应施加RESET脉冲的时间点。</font><font style="vertical-align: inherit;">如果您至少在一个微秒内犯了一个错误，发送的脉冲太短或太长，该攻击将不起作用。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸运的是，在Xbox 360上，每个引导步骤都伴随着</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">POST_OUT</font></a><font style="vertical-align: inherit;">调试总线上的值更改。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此外，调试输出的安排如此频繁，以至于在比较散列总和之前立即设置了新的POST值：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/o_/pz/hn/o_pzhn6nqueomzmzvlv2vkkfazw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，从攻击站点关闭调试输出的位置是一个非常方便的触发器。</font><font style="vertical-align: inherit;">POST_OUT是并行总线，并输出到印刷电路板上的8个测试站点，每个站点负责该值的一位。</font><font style="vertical-align: inherit;">甚至有可能简化连接方案，仅使用一位并计算自系统启动以来状态变化的次数：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ci/zg/qm/cizgqmpbnxyy2jnhoy5fmqovkde.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，由于处理器的频率很高，因此就准确性和持续时间而言，几乎不可能到达正确的时刻。</font><font style="vertical-align: inherit;">曝光时间应该非常短，大​​约是处理器执行一条指令的时间。</font><font style="vertical-align: inherit;">但是处理器运行得越慢，适合我们的时间间隔就越长。</font><font style="vertical-align: inherit;">因此，我们采取并减慢了处理器的速度！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在常规PC上，CPU频率定义为外部“参考”频率与乘数的乘积：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5h/vb/oo/5hvbooyj4elvow6nxit04kc4ypk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，在Xbox 360中，参考频率的外部线路适用于处理器，并且在该频率内部乘以</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在机顶盒的旧的“厚”版本上，可以关闭PLL机制，使处理器的速度降低128倍：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/4w/yt/sp4wytmvkymnu5geqbdp0jwgtag.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在“ Slim”版本上，无法完成PLL技巧（线路未在板上分开），并且由于我们无法影响“ Slim”因子，因此我们将降低“参考”频率！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它是由HANA芯片生成的，可以通过I2C总线进行配置：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u0/mv/h3/u0mvh32w0mjhaeylbllspnsiwwc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不幸的是，不可能降低很多，“低速”最终处理器的频率开始强烈地“游动”，这降低了成功的机会。</font><font style="vertical-align: inherit;">最稳定的选择是放缓3.17倍。</font><font style="vertical-align: inherit;">不是128次，但至少是某种程度。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有？</font><font style="vertical-align: inherit;">不，不是全部。</font><font style="vertical-align: inherit;">攻击将在第一次（特别是在Slim上）起作用的事实远非事实。</font><font style="vertical-align: inherit;">如果启动失败，则前缀会重新启动并尝试再次启动。</font><font style="vertical-align: inherit;">仅给出5次尝试开始，之后前缀停止并开始闪烁“死亡红色环”。</font><font style="vertical-align: inherit;">因此，我们还修补了南桥（SMC）的固件，以免遭受垃圾的困扰，并重新启动前缀，直到其变为蓝色为止：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4s/em/3z/4sem3zqaipwaskszcy_nzntxdvu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们得到了算法：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">贴片SMC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">减慢百分比（通过PLL或I2C）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待POST触发</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等待N微秒</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发送脉冲至RESET</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加快返回速度</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了提高计算的准确性，我们采用相同HANA的频率（48 MHz）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/cg/em/dqcgemuy43cr24pzdnor6sl2zpy.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们基于便宜的CPLD Xilinx XC2C64A获得了这样的设计：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/uf/5m/yxuf5mhm9uohsh7axeb_trevnue.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
不要忘了对RESET上的布线的长度和位置进行萨满化处理（注意照片底部的“线圈”）并向前移动，希望发射能在一分钟内完成。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但这仅在硬件方面。</font><font style="vertical-align: inherit;">我们如何修补引导加载程序并填充我们的代码？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">补丁加载器</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正如我所提到的，二级引导加载程序“ CB”正在受到攻击。该引导加载程序使用固定密钥加密，所有控制台都使用相同的密钥，但是只能修改“ CB”，我们只能对其进行攻击。但是下一个已经用CPU密钥加密了，每个机顶盒都唯一。并修改它，你需要知道这个按键... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还是不行？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Xbox 360的旧“粗”修订版中，CB加载器支持在控制台生产阶段使用的所谓的“零配对”模式。每个引导加载程序的标头位于偏移量0x10处，均包含一个随机配对数据集，该数据集用作解密密钥的一部分。并且，如果此数据集完全由零组成（“零配对”），则处理器密钥将被忽略，而是使用固定的零密钥！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s6/yd/tc/s6ydtc65_pqwl6vqimx88x7j4ws.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
有了这个技巧，就有可能用原始的“ CB”来组装映像，用零密钥加密下一个引导程序“ CD”（具有自己的代码），然后使用RGH运行它！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s5/mg/9y/s5mg9ynt52prplbrelkmas-3hqg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在控制台中，“ Slim”包装了这个技巧，删除了“ Zero-Pairing”模式，并将“ CB”分为两个部分。</font><font style="vertical-align: inherit;">在这里，“ CB”被分为非常简单和小的“ CB_A”，并通过处理器密钥“ CB_B”进行加密：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/kw/fr/iokwfrhtycw2bg8fd8qnuzq9c-c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，使用RC4算法进行加密（即，使用该算法对CB_B进行加密）具有一个特殊性。</font><font style="vertical-align: inherit;">在基于密钥的加密过程中，将生成伪随机数据流，该伪随机数据流与源数据进行二进制“加总”（操作“异或”，“异或”）。</font><font style="vertical-align: inherit;">因此，解密时会发生相同的事情，使用相同的伪随机流进行添加会将数据恢复为原始值：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mw/_3/da/mw_3da2ixwvjpwa3wmxion8bjvk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是二进制加法运算是可交换的和关联的，这意味着我们可以在不知道密钥的情况下修改加密的数据，仅用于</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '和需要补丁的加密代码！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uc/hk/mr/uchkmrjc4tjpy5sepvgm_pv-jo4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
结果，我们可以加密“ CB_A”，打补丁加密的“ CB_B”（这样它就完全不执行解密），并在其代码中放入纯文本“ CD”！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_q/g1/hg/_qg1hghntkm59bnmg1bv5xp4h_8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
简而言之，如果将它们放在一起，则启动看起来像这样：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
（XeLL是Homebrew，Linux的引导程序，并且还显示了CPU密钥）</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JOiPjlWDA1A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">微软反击</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当然，微软试图修补所有问题。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在新的系统更新中，所有旧控制台都从“ CB_A”和“ CB_B”转移到“单独”引导，从而最终关闭了“零配对”模式。</font><font style="vertical-align: inherit;">在Slim上，引导加载程序也已更新。</font><font style="vertical-align: inherit;">新的引导加载程序已进行了认真的修改，以防止RGH，其中最大的重点是保护CB_A：</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全删除POST中的调试输出</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">哈希验证已重做并重复以确保可靠性</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在整个代码中，将sleep（）设置为随机时间（取决于CPU键！！）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了CBLDV融合检查以撤销CB_A</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/zh/ak/rozhaks1oyb4q0ck6f_2mbzmwmi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创新的清单让RGH没有机会。</font><font style="vertical-align: inherit;">但请注意列表中的最后一项-在此之前，CB_A中没有融合检查！</font><font style="vertical-align: inherit;">致命缺陷。</font><font style="vertical-align: inherit;">此外，我们记得，在解码“ CB_A”时不涉及处理器密钥。</font><font style="vertical-align: inherit;">这意味着容易受到RGH影响的CB_A加载程序可以在任何控制台上启动，并且不能禁止这样做。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，为了借助此易受攻击的“ CB_A”开始工作，您需要避开一点。</font><font style="vertical-align: inherit;">如果我们不知道CPU密钥，剩下的就是修补现有的“ CB_B”。</font><font style="vertical-align: inherit;">但是，如果不完全修改整个引导加载程序，而不是修改各个部分，该怎么办？</font><font style="vertical-align: inherit;">因此，“写”旧的引导加载程序（我们已经知道如何打补丁）来替换新的引导加载程序？</font><font style="vertical-align: inherit;">因此，他们做到了：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们以与原始映像相同的方式加密易受攻击的CB_A</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将我们的CB_B与新XOR异或，获得“差异”</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们把它放在加密的“ CB_B”上！</font></font></li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rt/4t/7c/rt4t7ct5vu1vfnvexya_4yjp_oc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同样，一切都在不知道密钥的情况下，我们成功地替换了加密的内容，并且还放置了易受攻击的引导程序。</font><font style="vertical-align: inherit;">主机被黑客入侵，微软对此感到惊讶。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开发人员努力工作，在下一次系统更新中……稍微更改了加密方法“ CB_B”，现在加密密钥也变得依赖于“ CB_A”的版本：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2_/zy/kq/2_zykqm27pplqsop8gquppheo4g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，当尝试“ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异或</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ”并将数据推送到旧版本的易受攻击的“ CB_A”时，引导加载程序由于密钥差异而解密了垃圾。</font><font style="vertical-align: inherit;">而且，新的引导加载程序无法被黑客入侵，它受到良好保护，免受恶意攻击。</font><font style="vertical-align: inherit;">到目前为止，微软取得了胜利！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电晕引发问题</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同时，Xbox 360的新版本Corona进入了市场，并带来了改装问题：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/zj/b1/fszjb1roudnv3rix_uf3usnwml4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
板上没有足够的芯片，您能找到吗？</font><font style="vertical-align: inherit;">没错，HANA芯片被“隐藏”在南桥中。</font><font style="vertical-align: inherit;">Mod芯片没有其他地方可以采用48 MHz的频率，以前的I2C减速命令不起作用。</font><font style="vertical-align: inherit;">但是什么是16MB NAND闪存，这些年来一直用作Xbox 360系统存储，却被具有eMMC接口的4 GB芯片所取代！</font><font style="vertical-align: inherit;">（确实，仅在较便宜的控制台版本中，但仍然）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ho/pv/dl/hopvdl-wilvzq4pzvndoogihru4.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是什么也没有，一切都处理完了。</font><font style="vertical-align: inherit;">我们找到了如何通过读卡器读取/写入闪存的方法：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oo/sz/pj/ooszpjupnf_mgzwpkc-vry0ovou.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
找到了新的I2C减速命令，一个外部48 MHz晶体振荡器代替了HANA：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/88/lm/ic/88lmicizuembheqjiod-uff7jau.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
完成的构建脚本，增加了对4 GB NAND的支持...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qm/7a/tk/qm7atka28kaj3anjmoq2cgoalz0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是微软继续努力。</font><font style="vertical-align: inherit;">例如，在新板上，一些电阻消失了，没有这个电阻，mod芯片停止工作：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/ji/wg/kvjiwggxf9dncmv8rehaqhpzuy4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
确实，这是通过使用烙铁安装跳线来解决的：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/7x/sv/ku7xsv8rpu2fov8upv6g-osgfm8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当POST_OUT音轨从板上消失时，事情变得更加严重：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lu/lo/0m/lulo0m01ihmy34glpcoeriz4ojo.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是在这里微软并不幸运，RGH所需的CPU“球”处于极端行列：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/nk/e2/hcnke2-7eh_xgrz0bmpf2ewtzro.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而且，当然，他们能够连接到他们。</font><font style="vertical-align: inherit;">首先，最松散的，稍微钻出处理器的边缘，并通过布线将其直接焊接到球上：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/-t/k_/gk-tk_mzrvo5suirxpk_d_kknru.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/ue/ai/dwueaifiz18-tfgrylfhdgkpats.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后中国人发布了一个框架，该框架带有弹簧针，恰好放在一个球上，这个问题为其他所有人解决了：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/sd/xj/k7sdxjysbtq9ofcadfby2jpdf-i.jpeg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后的边疆</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在我们击败“皇冠”之后，出现了一个问题-该系统的新版本没有屈服于黑客攻击。要启动RGH，您需要知道CPU密钥，并且要找出CPU密钥，您至少需要运行RGH一次。鸡肉和鸡蛋的问题一般。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
然后产生了一个想法-让我们不仅使用“小故障”身份验证进行检查，而且还将跳过解密！如果能解决问题，那么我们就不需要知道密钥，只需将“ CB_B”清楚地说明即可。这个想法构成了Double Glitch Hack（DGX）的基础：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/28/h2/yh/28h2yheods_vx8jptciovob9yby.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该芯片两次“缓冲”百分比，第一个脉冲跳过引导加载程序的解密阶段，第二个脉冲跳过身份验证。</font><font style="vertical-align: inherit;">由于至少需要成功启动一次，所以它的工作不稳定得多-然后我们获得了CPU密钥并像以前一样进行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DGX无关紧要，在3个月后，中国人发布了“ DGX RIP”，该图像可以在任何机顶盒上运行，可以与标准RGH一起使用，并且当然开始更加稳定：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ig/yv/fy/igyvfysfq1qsiyyefeqsknjiz1e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这些映像包含Xbox 360生产中使用的CB_A引导加载程序的特殊版本，实际上，它是旧的“零配对”模式的完全相似。</font><font style="vertical-align: inherit;">该“ CB_A_mfg”使用固定的空密钥来解密“ CB_B”，而不是处理器密钥：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_2/3k/n1/_23kn1nx7eydggdpskbzkudinv4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
微软在这里。</font><font style="vertical-align: inherit;">在此“ CB_A”的“服务”版本中，也没有融合检查，因此无法禁止它。</font><font style="vertical-align: inherit;">足以根据Xbox 360的修订版本记录图像，焊接芯片-一切正常。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fa/_9/hd/fa_9hdfa5kgwphr69k6xpdnyaia.jpeg" width="550"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">温彻斯特！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RGH仅在代号为Winchester的控制台的新版本中完全修复。</font><font style="vertical-align: inherit;">第一次将CPU和GPU处理器结合在一个芯片中，该板就尽可能地简化了：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/of/ps/1g/ofps1gt_gevcpmlz39aj97ukquc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
POST_OUT曲目不仅被删除。</font><font style="vertical-align: inherit;">即使您焊接到处理器下的平台：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ha/vg/c6/havgc6afvvs4nt5pn8lihldlspq.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nz/si/lc/nzsilch-pq6gun98tbugnx89owi.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
即使将处理器焊接到开发人员专用版本的板XDK上，这些轨道仍然存在：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m2/di/n4/m2din48-hbqpbs2aw_if-uorx0g.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在POST_OUT上，控制台启动时仅可见一个脉冲。</font><font style="vertical-align: inherit;">总线锁定：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/6q/5c/kq6q5cngontmkypyxrsfbke-atw.png" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
而且，它仅在生产阶段被阻止。</font><font style="vertical-align: inherit;">如果您从尚未烧毁保险丝的工厂购买“干净”处理器，则可以使用POST_OUT！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p0/ke/au/p0keau_qpxnl61bmosmxcv5unya.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是RGH不再起作用。</font><font style="vertical-align: inherit;">无论您尝试如何发出RESET脉冲，处理器都会正确执行一个重置，或者由于持续时间太短而忽略您的信号。</font><font style="vertical-align: inherit;">显然，一个特殊的逻辑模块被添加到处理器中，过滤RESET线，从而最终解决了硬件错误。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投稿后</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
事实证明，Xbox 360的最新版本无法破解吗？</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
是的，没有。</font><font style="vertical-align: inherit;">目前，只有一种已知的方法可以在Winchester修订版上运行经过修改的系统。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
软件开发套件（XDK）包含用于签名已编译代码的各种私钥。</font><font style="vertical-align: inherit;">事实证明，其中杂乱无章的签名密钥“ shadowboot”是XDK系统的第三级引导程序。</font><font style="vertical-align: inherit;">借助它，您可以使用经过修改的固件收集合法的签名映像。</font><font style="vertical-align: inherit;">只要在普通的“商店”控制台上工作，他就不会。</font><font style="vertical-align: inherit;">我们需要一个带有XDK版本控制台的处理器，或者一个带有未熔断保险丝的“干净” CPU（您可以在Aliexpress上看到它）：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/sl/fz/rrslfzrmohmrxuagyadwvojnpvq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只有这样，您才有机会在自定义外壳程序的“系统信息”中考虑这样的题词：</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/te/g7/ggteg7iezt2c-hw-h_mczs132fe.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就这样！</font><font style="vertical-align: inherit;">和往常一样，我准备在评论中回答您的问题：）</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360保护和黑客，第1部分</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360保护和黑客，第2部分</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360保护和黑客，第3部分</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN500228/index.html">盖茨比如何规避Next.js</a></li>
<li><a href="../zh-CN500232/index.html">学习Akka.NET：一个简单的在线游戏的服务器</a></li>
<li><a href="../zh-CN500234/index.html">为什么我为Git + JS进行个人费用会计项目</a></li>
<li><a href="../zh-CN500238/index.html">告诉我是什么困扰着你</a></li>
<li><a href="../zh-CN500244/index.html">阵列外</a></li>
<li><a href="../zh-CN500248/index.html">FOSS新闻14-2020年4月27日至5月3日免费和开源新闻的回顾</a></li>
<li><a href="../zh-CN500250/index.html">来自世界开放地图509号的新闻（04.14.2020-20.04.2020）</a></li>
<li><a href="../zh-CN500252/index.html">卡巴斯基安全中心-新级别</a></li>
<li><a href="../zh-CN500254/index.html">我们编写可以正常工作的前端。或如何成为一名开发人员的工程师。第2部分</a></li>
<li><a href="../zh-CN500256/index.html">德米特里·列别捷夫（Dmitry Lebedev）：“几年前，我清楚地了解到，OpenStreetMap会进一步衰落”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>