<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è© ‚õπüèæ üé¥ Integration von Netflow- und SIEM-√úberwachungsl√∂sungen ‚òÅÔ∏è ‚òØÔ∏è ü•á</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SIEMs sind seit langem ein De-facto-Standard bei der Analyse von Sicherheitsereignissen und der Erkennung von Vorf√§llen (obwohl es eine gewisse Tenden...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Integration von Netflow- und SIEM-√úberwachungsl√∂sungen</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/501820/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEMs sind seit langem ein De-facto-Standard bei der Analyse von Sicherheitsereignissen und der Erkennung von Vorf√§llen (obwohl es eine gewisse Tendenz gibt, SIEM aufzugeben und durch L√∂sungen f√ºr die Verwaltung von Protokollen mit einem Add-On aus Technologien f√ºr maschinelles Lernen zu ersetzen), aber die Effektivit√§t dieser L√∂sung h√§ngt davon ab mit welchen Datenquellen es funktioniert. Normalerweise arbeiten SIEM-Spezialisten jedoch haupts√§chlich mit Protokollen, wobei eine so wichtige Informationsquelle wie Netflow au√üer Acht gelassen wird, mit der Sie etwas sehen k√∂nnen, das h√§ufig nicht in die Protokolle gelangt oder zu sp√§t kommt. Dies wirft eine Reihe von Fragen auf. Warum ben√∂tigt eine moderne SIEM-L√∂sung Netflow-Unterst√ºtzung? Was kann SIEM von der Netflow-Analyse erhalten? Welche Option zur Integration von SIEM in Netflow, wenn es Hersteller gibt,die Netflow-Unterst√ºtzung direkt in ihre L√∂sungen einbetten, und es gibt diejenigen, die es vorziehen, mit verschiedenen Netflow-Kollektoren zu arbeiten. Welche Funktionen bietet die Arbeit mit SIEM Netflow? Wir werden dar√ºber reden.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflow zur Erkennung von Bedrohungen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem fr√ºheren </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe bereits die M√∂glichkeiten der Verwendung von Netflow f√ºr die Cybersicherheit beschrieben. Ich m√∂chte Sie daran erinnern, dass Netflow im Gegensatz zu den Protokollen von Netzwerkger√§ten oder Rohdatenverkehr ein Protokoll ist, mit dem Sie den Datenverkehr anhand von Metadaten analysieren k√∂nnen, die aus Netzwerksitzungen stammen. Dies sind nicht nur Adressen und Ziel- und Quellports, sondern auch Nachrichtentypen und Codes f√ºr ICMP, IP-Diensttypen, IP-Protokolltyp, Netzwerkschnittstellen, Sitzungsdauer, Start- und Endzeiten usw. Wenn die Protokolle normalerweise auf Endger√§ten (z. B. Servern, Workstations und DBMS) oder Schutzmitteln erstellt werden, was ist in einer Situation zu tun, in der erstere keine Sicherheitsereignisse generieren oder Sie ihnen keine Sicherheitsmittel zuweisen k√∂nnen?und letztere werden nur am Perimeter installiert und sehen nicht, was innerhalb des Unternehmens- oder Abteilungsnetzwerks passiert? Eine andere Sache ist die Netzwerkausr√ºstung - Switches und Router (Hardware oder virtuell), drahtlose Zugangspunkte und Controller. Sie werden im Inneren installiert und die Interaktion von Benutzern, Ger√§ten und Anwendungen durchl√§uft sie immer. Es ist unm√∂glich, sie zu bestehen! Durch die √úbertragung von Daten √ºber diese Interaktion an Netflow (selbst Cisco ASA oder Firepower generieren sie) erhalten wir eine wertvolle Informationsquelle nicht nur f√ºr die IT, sondern auch f√ºr die Cybersicherheit. Wenn Ger√§te das Ablaufprotokoll nicht verstehen, k√∂nnen wir spezielle Exporteure, Software- oder Hardwarel√∂sungen verwenden, die Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdie Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdie Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdrahtlose Zugangspunkte und Controller. Sie werden im Inneren installiert und die Interaktion von Benutzern, Ger√§ten und Anwendungen durchl√§uft sie immer. Es ist unm√∂glich, sie zu bestehen! Durch die √úbertragung von Daten √ºber diese Interaktion an Netflow (selbst Cisco ASA oder Firepower generieren sie) erhalten wir eine wertvolle Informationsquelle nicht nur f√ºr die IT, sondern auch f√ºr die Cybersicherheit. Wenn Ger√§te das Ablaufprotokoll nicht verstehen, k√∂nnen wir spezielle Exporteure, Software- oder Hardwarel√∂sungen verwenden, die Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdrahtlose Zugangspunkte und Controller. Sie werden im Inneren installiert und die Interaktion von Benutzern, Ger√§ten und Anwendungen durchl√§uft sie immer. Es ist unm√∂glich, sie zu bestehen! Durch die √úbertragung von Daten √ºber diese Interaktion an Netflow (selbst Cisco ASA oder Firepower generieren sie) erhalten wir eine wertvolle Informationsquelle nicht nur f√ºr die IT, sondern auch f√ºr die Cybersicherheit. Wenn Ger√§te das Ablaufprotokoll nicht verstehen, k√∂nnen wir spezielle Exporteure, Software- oder Hardwarel√∂sungen verwenden, die Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderDurch die √úbertragung von Daten √ºber diese Interaktion an Netflow (selbst Cisco ASA oder Firepower generieren sie) erhalten wir eine wertvolle Informationsquelle nicht nur f√ºr die IT, sondern auch f√ºr die Cybersicherheit. Wenn Ger√§te das Ablaufprotokoll nicht verstehen, k√∂nnen wir spezielle Exporteure, Software- oder Hardwarel√∂sungen verwenden, die Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderDurch die √úbertragung von Daten √ºber diese Interaktion an Netflow (selbst Cisco ASA oder Firepower generieren sie) erhalten wir eine wertvolle Informationsquelle nicht nur f√ºr die IT, sondern auch f√ºr die Cybersicherheit. Wenn Ger√§te das Ablaufprotokoll nicht verstehen, k√∂nnen wir spezielle Exporteure, Software- oder Hardwarel√∂sungen verwenden, die Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdie Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oderdie Stream-Datens√§tze f√ºr den durch sie geleiteten Datenverkehr generieren (mit Cisco, der Netflow Generation Appliance oder</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stealthwatch-Durchflusssensor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Mithilfe von Algorithmen zum Erkennen von Anomalien oder Signaturen, die Netflow-Streams √ºberlagert sind, sowie Methoden des maschinellen Lernens k√∂nnen Sie Abweichungen vom Referenzverhalten des Netzwerkverkehrs identifizieren, die Bedrohungen der Informationssicherheit oder Probleme mit der IT-Infrastruktur charakterisieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es sei daran erinnert, dass Netflow nicht sagen kann, was im Netzwerkverkehr √ºbertragen wird (obwohl es bereits Technologien gibt, mit denen Sie die von Netflow verwendeten Anwendungen und den sch√§dlichen Code erkennen k√∂nnen), wurde es f√ºr andere Aufgaben entwickelt. </font><font style="vertical-align: inherit;">Aber er kann sagen, wer wie und wie lange mit wem ‚Äûgesprochen‚Äú hat. </font><font style="vertical-align: inherit;">Obwohl es verschiedene Versionen von Ablaufprotokollen gibt, k√∂nnen Sie mit den meisten von ihnen die folgenden Daten erfassen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quell- und Ziel-IP-Adresse</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quell- und Zielports</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokoll</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art der Leistung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellschnittstelle</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeitstempel starten und beenden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Menge der √ºbertragenen Informationen.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einigen Versionen, z. B. in IPFIX oder Netflow v9, k√∂nnen Sie einige Informationen aus dem Datenk√∂rper extrahieren, sodass der Netflow-Analysator (eigenst√§ndig oder in SIEM integriert) laufende Anwendungen identifizieren kann. </font><font style="vertical-align: inherit;">All diese Informationen reichen oft aus, um Anomalien oder sogar Bedrohungen im Netzwerkverkehr zu erkennen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/qa/mq/0gqamq6h7orvlobxcnercgfl5os.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflow und SIEM: Was ist die St√§rke, Bruder?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist, wenn das Zielsystem keine Protokolle generiert oder diese von Eindringlingen deaktiviert werden? </font><font style="vertical-align: inherit;">Was tun, wenn auf dem Zielsystem einfach keine Sicherheitsfunktionen vorhanden sind, da diese den Prozessor laden und das System verlangsamen? </font><font style="vertical-align: inherit;">Was tun, wenn ein Mitarbeiter sein pers√∂nliches Ger√§t mitbringt, das nicht mit SIEM verbunden ist? </font><font style="vertical-align: inherit;">Wir haben immer noch die einzige Informationsquelle - den Netzwerkverkehr, der auf jeden Fall vom Zielger√§t generiert wird. </font><font style="vertical-align: inherit;">Was kann dazu beitragen, einen ‚Äûsauberen‚Äú Netflow zu identifizieren, der ohne SIEM mithilfe von NTA-L√∂sungen (Network Traffic Analysis) analysiert werden kann? </font><font style="vertical-align: inherit;">Hier ist eine kurze Liste solcher Bedrohungen und Anomalien:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schadcode, Ransomware und Crypto Miner</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaktion mit Befehlsservern</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerk-Scan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Denial-of-Service-Angriffe</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenlecks</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacken ssh oder rdp</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Torrents und andere P2P-Anwendungen</font></font></li>
<li>   ,   </li>
<li> </li>
<li> ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und was geben Ihnen die Protokolle, die Ihr SIEM sammelt? Die M√∂glichkeit, Benutzeraktivit√§ten auf Knoten, den Zugriff auf Ressourcen, den Ein- und Ausstieg in und aus Systemen, Alarme von Netzwerkger√§ten und Sicherheitstools und vieles mehr zu √ºberwachen. Durch die Kombination von Protokollen und Netflow, die zu SIEM kommen und dort analysiert werden, k√∂nnen Sie schnell neue Sitzungen und neuen Datenverkehr von Ger√§ten identifizieren, die gerade angegriffen wurden, einschlie√ülich solcher, die Ihren Umkreis umgehen. Durch die Kombination dieser Datentypen k√∂nnen Sie auch falsch konfigurierte Netzwerksicherheitsfunktionen identifizieren. Netflow erg√§nzt die traditionellen SIEM-Funktionen um die F√§higkeit, neue Arten von Datenverkehr, seine Bursts, die Interaktion mit externen und internen Ressourcen, Datenlecks, die Verteilung von Schadcode und die Interaktion mit Teamservern zu erkennen.Kapselung der b√∂swilligen Last in zul√§ssige Protokolle usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kombination von traditionell verarbeiteten SIEM-Daten mit Netflow erm√∂glicht es, nicht nur mehr verschiedene Sicherheitsereignisse zu sehen, sondern diese auch schneller zu sehen, wodurch der sogenannte TTD-Parameter (Time-to-Detect) und damit die Reaktionszeit reduziert werden. Es ist klar, dass SIEM- und Netflow-Analyse unabh√§ngig voneinander arbeiten und ihre Arbeit gut erledigen k√∂nnen, aber es ist die Kombination dieser beiden L√∂sungen, die es Ihnen erm√∂glicht, einen synergistischen Effekt zu erzielen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das √Ñndern des Verkehrsverhaltens kann auf verd√§chtiges oder abnormales Verhalten hinweisen. Das √úberschreiten des Schwellenwerts f√ºr ins Internet hochgeladene Daten kann beispielsweise auf ein Leck hinweisen. Eine √Ñnderung der Gr√∂√üe von DNS-Abfragen und -Antworten im Vergleich zum bereitgestellten RFC kann die Tatsache des Betriebs von Schadcode charakterisieren (laut Cisco-Statistiken verwenden 92% der Malware DNS, um Befehle zu empfangen, Daten herunterzuladen oder Updates herunterzuladen). Erinnerst du dich an die Geschichte mit Equifax? Dann konnten die Angreifer auf das Webportal und dann auf die internen Datenbankserver zugreifen und langsam gro√üe Datenmengen nach au√üen hochladen. Unabh√§ngig davon waren alle diese Ereignisse nicht von gro√üem Interesse und wurden nur gesammelt und mit Netflow-Daten angereichert. Sie erm√∂glichten es, Vorf√§lle im Bereich der Informationssicherheit zu identifizieren. Dies ist ein weiterer Fall f√ºr Netflow-Analysesysteme.Dies kann nicht standardm√§√üiges Verhalten sowohl des Webportals erkennen, von dem aus die Abfrage an die Datenbank frequentiert wird, als auch von Datenbanken, die dem Portal pl√∂tzlich viele Daten zuweisen. Ich habe bereits</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschrieb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dieses Szenario auf Habr fr√ºher. SIEM, das Netflow-Daten empf√§ngt, kann einen zus√§tzlichen Kontext f√ºr Ereignisse abrufen, die von IPS, ITU, Proxys, Antivirenprogrammen, EDR usw. generiert wurden, um effektiver auf den Vorfall zu reagieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderes Beispiel. Erkennung unbekannter Angriffe, f√ºr die Intrusion Detection-Systeme keine Signaturen haben - aufgrund der Korrelation von Netzwerkanomalien und Ereignissen von Hosts sowie des Ausl√∂sens von Triggern. Das Scannen von 100 Knoten in 3 Minuten kann beispielsweise den Betrieb von Schadcode charakterisieren, der seinen Br√ºckenkopf erweitert. Eine Verl√§ngerung der Antwortzeit vom Server kann einen DDoS-Angriff gegen ihn charakterisieren, und beispielsweise kann eine Nicht√ºbereinstimmung der √ºber das DNS-Protokoll empfangenen und gesendeten Informationsmenge auf ein Datenleck hinweisen. Dies ist ein Fall, den wir uns bereits fr√ºher angesehen haben, als ich √ºber die Suche nach einer DNSpionage-Kampagne sprach. Gleichzeitig k√∂nnen Sie feststellen, dass </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einem Fall</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nur Netflow analysiert haben und in dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anderen </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Fall</font></a><font style="vertical-align: inherit;"> auch Daten von Endger√§ten, Sandboxen, einem DNS-Gateway usw. gesammelt haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer Bereich, in dem die Integration von Netflow in SIEM hilfreich sein kann, ist das Situationsbewusstsein. Korrelation von Fl√ºssen mit Protokollen, Kontext, Geolokalisierungsinformationen, Benutzeraktivit√§t und Reputationsdaten. In einem fr√ºheren Hinweis habe ich beispielsweise einen Fall mit der Erkennung des internen Verkehrs mit Knoten aus dem Iran oder Nordkorea angef√ºhrt. Wenn Sie keine Kontakte zu diesen L√§ndern haben, ist dies m√∂glicherweise ein Zeichen daf√ºr, dass b√∂sartiger Code Informationen stiehlt oder dass regierungsnahe Hacker auf Ihr Unternehmen abzielen. Ein Netzwerkanomalie-Analysesystem kann einen Teil dieser Arbeit ausf√ºhren, indem es die entsprechende Anomalie identifiziert. Wenn Sie jedoch auch wissen m√∂chten, welcher Benutzer an diesem Vorfall beteiligt war, ben√∂tigen Sie zus√§tzlichen Kontext in Form von Benutzernamen aus Active Directory.Netflow selbst verarbeitet diese Informationen nicht. Daher m√ºssen wir sie mit Informationen aus AD anreichern. Wenn du benutzt</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dazu m√ºssen Sie es nur in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ISE integrieren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das IP- und MAC-Adressen mit bestimmten Benutzern und Ger√§teprofilen verkn√ºpft. Was ist, wenn Cisco ISE nicht im Netzwerk bereitgestellt wird? Die Aufgabe, Netflow mit Benutzerinformationen anzureichern, liegt in der Verantwortung von SIEM.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderes Beispiel. Auf meinem Computer wird eine Website ausgef√ºhrt, die f√ºr eine Reihe von Aufgaben verwendet wird. Aber wie viele normale Benutzer k√∂nnen sich derselben r√ºhmen? Pl√∂tzlich erfassen Sie den Datenverkehr, der mit dem Betrieb eines Webservers verbunden ist, von einem Benutzercomputer aus? Oder in dem Segment, in dem sich Benutzer befinden, die an einem Windows-PC arbeiten, sehen Sie pl√∂tzlich den Datenverkehr, der dem Linux-Betriebssystem innewohnt. Vielleicht hat dieser ‚Äûhandliche‚Äú Benutzer beschlossen, eine virtuelle Maschine unter Linux zu erstellen, wodurch die Sicherheitsrichtlinie verletzt wurde? Auf diese Weise k√∂nnen Sie auch Dienstprogramme f√ºr den Remotezugriff identifizieren (z. B. RAT), Kryptominierer, Cloud- oder Peer-to-Peer-Anwendungen usw.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie ein Bef√ºrworter eines Ansatzes eines einzelnen Anbieters sind, verringert der Aufbau eines Sicherheitssystems auf Basis von Cisco-L√∂sungen Ihre Abh√§ngigkeit von SIEM - allen Cisco-L√∂sungen, einschlie√ülich Firewalls, E-Mail-Schutz, Sandbox, PC-Schutzl√∂sung ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco AMP for Endpoints</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) und usw. kann Daten, Kontext, Sicherheitsereignisse und Befehle direkt untereinander austauschen. Wenn Ihre Infrastruktur jedoch viele verschiedene L√∂sungen von verschiedenen Herstellern geerbt hat, ist SIEM das Bindeglied, mit dessen Hilfe eine vollst√§ndige L√∂sung aus dem Zoo verschiedener Produkte erstellt werden kann. In jedem Fall erweitert die Analyse des aus der vorhandenen Netzwerkinfrastruktur gesammelten Netzwerkverkehrs in Kombination mit den Daten, die SIEM normalerweise sammelt, den </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizont.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die F√§higkeit des IS-Dienstes, mehr zu sehen und schneller zu reagieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vorteile der Verwendung von Netflow in SIEM:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Korrelation der Netzwerkaktivit√§t mit anderen Informationen zur Informationssicherheit, die auf der Ebene von Anwendungen und PCs / Servern gesammelt wurden</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen √ºberwachen, wo ein hohes Risiko f√ºr Verst√∂√üe gegen Datenschutzgesetze besteht (z. B. GDPR), und Sie k√∂nnen nur die Header oder Metadaten des Netzwerkverkehrs und nicht dessen Inhalt analysieren</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erkennung von Anomalien, die die ersten Stadien der Entwicklung eines Vorfalls oder gezielter Angriffe charakterisieren</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erfassung und Speicherung verschiedener Daten, die den Vorfall charakterisieren, und Bereitstellung dieser Daten im Rahmen von IS-Untersuchungen oder der Interaktion mit Strafverfolgungsbeh√∂rden.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Silberkugel?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber denken Sie nicht, dass Netflow die Silberkugel ist, nach der alle so lange gesucht haben. Es hat auch Nachteile. Beispielsweise kann seine Verarbeitung den Prozessor und den Speicher veralteter oder falsch ausgew√§hlter Netzwerkger√§te laden, was sich nachteilig auf die Leistung und die Netzwerkbandbreite auswirken kann. Um effektiv mit Netflow arbeiten zu k√∂nnen, ben√∂tigen Sie m√∂glicherweise dessen Hardwareunterst√ºtzung oder die Verwendung der sogenannten Exporteure, die den Datenverkehr durch Weiterleiten in Netflow √ºbersetzen (diejenigen, die auf die Einf√ºhrung von IDS / COB in geschalteten Netzwerken gesto√üen sind, haben f√ºr eine √§hnliche Aufgabe sogenannte B√§nder oder Splitter verwendet ) Ich habe bereits zwei Beispiele f√ºr solche externen L√∂sungen angegeben - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Flow Sensor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und die Cisco Netflow Generation Appliance. </font><font style="vertical-align: inherit;">Angesichts der j√ºngsten Modernisierung des Netzwerks kann davon ausgegangen werden, dass Ihre Switches und Router bereits die eine oder andere Version von Netflow unterst√ºtzen und Sie keine zus√§tzlichen Exporteure ben√∂tigen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weitere wissenswerte Netflow-Funktionen sind:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehlalarme, die mit einer falschen oder unzureichenden Schulung des Analysesystems sowie mit einer √Ñnderung des IT-Betriebs verbunden sein k√∂nnen, √ºber die das Analysesystem noch nicht ‚Äûinformiert‚Äú wurde.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">verminderte Leistung und Auswirkungen auf den SIEM-Speicher (dar√ºber werden wir noch weiter sprechen)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úber Netflow gesammelte Metadaten erm√∂glichen nicht immer eine vollst√§ndige Untersuchung, was m√∂glicherweise Rohdatenverkehr im PCAP-Format erfordert.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM-Integrationsoptionen mit Netflow</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche der heute auf dem Markt befindlichen SIEMs arbeiten mit Netzwerkverkehr? </font><font style="vertical-align: inherit;">Ich muss sagen, dass fast alles, aber auf unterschiedliche Weise und oft erfordert dies eine separate bezahlte Lizenz, die wiederum auch in Optionen unterteilt ist. </font><font style="vertical-align: inherit;">Ich m√∂chte drei Optionen f√ºr die Analyse von Netflow in SIEM hervorheben:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">integrierte Unterst√ºtzung f√ºr Netflow in SIEM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eigene Exporteure / Sensoren zur Erzeugung von Netflow und zur √úbertragung an SIEM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM-Integration mit externen L√∂sungen der Klasse Network Traffic Analysis (NTA).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM mit integrierter Netflow-Unterst√ºtzung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beispielsweise verf√ºgt Microfocus ArcSight, das im postsowjetischen SIEM-Bereich sehr beliebt ist, √ºber eine integrierte Unterst√ºtzung f√ºr Netflow. </font><font style="vertical-align: inherit;">Mit dieser Funktion kann SIEM Netzwerkfl√ºsse im laufenden Betrieb mit anderen Sicherheitsereignissen korrelieren oder diese mit Daten aus Threat Intelligence-Quellen anreichern. </font><font style="vertical-align: inherit;">Diese Option hat jedoch ihre Nachteile, n√§mlich:</font></font><br>
<br>
<ul>
<li>-,         ,     .         ( , ¬´   ¬ª,   )?</li>
<li>-,  Netflow  SIEM,          Netflow    .      ?    SIEM  ,              , ,   ?   -   ¬´¬ª Netflow     ?</li>
</ul><br>
<img src="https://habrastorage.org/webt/lo/jh/ge/lojhgex6afz5whncqwvjnwb3qxo.png" alt="Bild"><br>
<br>
<ul>
<li>-,     .     ?             VPN- (      ).</li>
<li>-,    Netflow   SIEM   FPS  ?</li>
<li>,      ,  flow-    (.  ).       Netflow,          SIEM.   Netflow      ‚Äî v5,     ,  v9,      IPv6, MPLS  .     Flexible Netflow ( Netflow v9), IPFIX,    Netflow v10, sFlow, , ,     , NetStream, Jflow  ..           SIEM?</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie nur vor der Wahl von SIEM stehen, nehmen Sie in die Liste der betrachteten Parameter auch den Netflow-Typ auf, der von Ihrem Ger√§t generiert wird. </font><font style="vertical-align: inherit;">Wenn Sie SIEM bereits gekauft haben, haben Sie nicht viel Auswahl. </font><font style="vertical-align: inherit;">In diesem Fall sollten Sie die folgenden Optionen in Betracht ziehen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein separater IS-Netzwerkanomalie-Analysator (z. B. Cisco Stealthwatch), der die gesamte Analyse selbst durchf√ºhrt und die Ergebnisse an SIEM weitergibt</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separater Netflow-Kollektor, der SIEM-Zusammenfassungsanalysen zu Netzwerkfl√ºssen √ºbermitteln kann, und SIEM analysiert diese Daten bereits.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie viel in Gramm zu h√§ngen, das hei√üt in Bytes gespeichert?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor wir mit der n√§chsten Option zur Integration von Netflow in SIEM fortfahren, ist es √ºbrigens an der Zeit, die Frage zu beantworten, wie viele Netflow-Daten wir in unserem System zur Analyse von Sicherheitsereignissen erhalten. F√ºr Abhilfema√ünahmen oder regelm√§√üige Protokolle gibt es eine betr√§chtliche Anzahl von Beispielen und Statistiken zu EPS (Ereignisse pro Sekunde). Es gibt nicht viele Daten zu FPS (Fluss pro Sekunde). Das durchschnittliche Volumen von Netflow ist direkt proportional zur Anzahl der eindeutigen TCP / UDP-Sockets, die von Clientger√§ten und Servern in Ihrem Netzwerk erstellt wurden. Dies kann von Fall zu Fall sehr unterschiedlich sein. Die Einbeziehung von Stichproben (dh die selektive √úbertragung von Netflow-Daten) wirkt sich auch auf die Gesamtdatenmenge aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie viele FPS k√∂nnen wir also generieren? </font><font style="vertical-align: inherit;">Dies h√§ngt nat√ºrlich stark von der Situation ab, aber ich w√ºrde sagen, dass diese Zahl f√ºr eine normale Workstation im Durchschnitt 1,5 FPS und 6 FPS bei Spitzenlast betr√§gt. </font><font style="vertical-align: inherit;">Mit anderen Worten, wenn Ihr Netzwerk 10.000 Knoten hat und die durchschnittliche FPS f√ºr jeden von ihnen 4 betr√§gt, generiert das Netzwerk ungef√§hr 40.000 Fl√ºsse pro Sekunde. </font><font style="vertical-align: inherit;">Warum so viel? </font><font style="vertical-align: inherit;">Wie ich oben geschrieben habe, h√§ngt es davon ab, wie viele eindeutige Verbindungen Ihre Anwendungen oder Ihr Netzwerk generieren. </font><font style="vertical-align: inherit;">Heutzutage laufen auf den Computern der Benutzer viele ‚Äûgespr√§chige‚Äú Programme, die entweder aktiv Inhalte aus dem Internet wie Browser laden oder st√§ndig nach Updates wie Antivirenprogrammen suchen. </font><font style="vertical-align: inherit;">Hier ist eine Beispielliste von Software und Diensten, die die Anzahl der FPS im Netzwerk aktiv erh√∂hen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adobe, Virenschutzprogramme, Java</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skype</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-Mail-Clients</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netbios</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Feed-orientierte Apps (Twitter, Nachrichten, Telegramm usw.).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine genauere Antwort zeigt Ihnen die Analyse von Netflow in den von Ihnen ben√∂tigten Netzwerksegmenten, die mit nur einem Befehl auf einem Netzwerkger√§t (je nach Hersteller) durchgef√ºhrt wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die L√§nge eines Netflow v5-Datensatzes betr√§gt 48 Byte. F√ºr die 9. Version von Netflow gibt es keine so genaue Zahl, da Sie mit dieser Version beschreiben k√∂nnen, was Sie in den Datensatz aufnehmen werden, und daher kann seine L√§nge stark variieren. Wenn wir jedoch ungef√§hr 100 Bytes f√ºr die durchschnittliche L√§nge eines Stream-Datensatzes ben√∂tigen (und jedes Netzwerkpaket 20 bis 30 Streams generieren kann), k√∂nnen wir absch√§tzen, wie viele Daten generiert und an SIEM √ºbertragen werden. Gleichzeitig kann das SIEM-Speichervolumen f√ºr diese Daten gr√∂√üer sein (dies h√§ngt vom Speicherformat, der Indizierung, Komprimierung, Sicherung usw. ab). Denken Sie bei der Berechnung der Anzahl der FPS √ºbrigens daran, dass im Rahmen eines DDoS-Angriffs das Konzept des ‚Äûdurchschnittlichen FPS‚Äú nicht funktioniert, da jede Verbindung, jedes TCP-SYN-Paket ein separater Stream ist und bei einem leistungsstarken DDoS-Angriff die Anzahl der FPS in Ihr Peak wird sehr gro√ü sein.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe oben erw√§hnt, dass Sie Netflow beim √úbertragen auf das zentrale SIEM √ºber das Internet ‚Äûsteuern‚Äú m√ºssen. </font><font style="vertical-align: inherit;">Denken Sie nicht, dass die Generierung von Netflow das Netzwerk stark belastet und seine Bandbreite reduziert. </font><font style="vertical-align: inherit;">Laut unserer Forschung erh√∂ht sich die Last f√ºr die Schnittstelle, von der die Netzwerktelemetrie exportiert wird, um etwa 1-2%, da in Netflow nur Kursinformationen und zus√§tzliche Telemetrie √ºbertragen werden und nicht der gesamte Datenk√∂rper (tats√§chlich mithilfe von Stichproben und modernen Protokollversionen) Netflow Dieser Wert kann um eine Gr√∂√üenordnung noch geringer sein und bei 0,1% variieren.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sammeln kann nicht analysiert werden</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, Sie haben sich dennoch f√ºr einen unformatierten Netflow auf Ihrem SIEM entschieden. Dieses Szenario hat eine andere Nuance. Es ist sehr wichtig zu verstehen, dass die Unterst√ºtzung von SIflow Netflow nicht ausreicht. Es ist √§u√üerst wichtig, diesen Netflow unter Sicherheitsgesichtspunkten handhaben zu k√∂nnen, dh Regeln f√ºr die Analyse und Korrelation von integrierten Netflow-Streams zu haben, die st√§ndig aktualisiert und f√ºr neue Arten von Angriffen aktualisiert werden. Angenommen, Netflow gibt uns dieses Bild:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b6/up/na/b6upnaoghurwuh9pns2lv0cqpya.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir sehen einen Anstieg im SSH-Protokoll. Tats√§chlich sehen wir jetzt dasselbe Bild bei Angriffen auf das RDP-Protokoll. Dies ist das Erraten von Passw√∂rtern. Dies kann jedoch nur unter der Bedingung offengelegt werden, dass wir eine entsprechende Regel haben, die aus einer Reihe von Netflow-Streams ein Ereignis "Password Matching" sammelt. Dann k√∂nnen wir sagen, dass SIEM √ºber eine integrierte Netflow-Unterst√ºtzung verf√ºgt und diese unter Sicherheitsgesichtspunkten analysieren kann. Wenn Sie diesen Pfad w√§hlen, sollten Sie den Verk√§ufer fragen, was SIEM in Netflow ‚Äûout of the box‚Äú analysieren kann und wie m√ºhsam die Beschreibung Ihrer eigenen Netflow-Prozessoren ist. Haben Sie Spezialisten, die dies tun? Wir sind uns bewusst, dass das Schreiben eines Connectors in Netflow nicht so schwierig ist, im Gegensatz zu den Regeln f√ºr die Verarbeitung und das Erkennen von Anomalien, die st√§ndige Arbeit erfordern.Es geht darum, die Engine eines anderen f√ºr Ihr IDS (Snort, Zeek oder Suricata) zu kopieren, aber nicht in der Lage zu sein, fortlaufend Signaturen f√ºr neu entdeckte Exploits und Angriffe zu schreiben. Im obigen Beispiel sollte das System selbst einen Anstieg des Datenverkehrs auf SSH erkennen und selbst sagen, dass es sich um Angriffe zum Erraten von Kennw√∂rtern auf SSH handelt (entweder Telnet, RDP oder FTP). Es k√∂nnte so aussehen (zum Beispiel</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fc/h8/--/fch8--okgcjqtnsxzuufafzja28.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anschlie√üend k√∂nnen Sie diesen Vorfall mithilfe der Funktionen von SIEM oder einem separaten Netflow-Analysetool auf einer tieferen Ebene untersuchen. </font><font style="vertical-align: inherit;">Ohne die F√§higkeit, Netflow in Bezug auf Informationssicherheit zu "verstehen", ist das Vorhandensein einer integrierten Unterst√ºtzung f√ºr Netflow ein zweifelhafter Vorteil f√ºr SIEM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9f/4z/b-/9f4zb-x6zrz4-f_rknuozlv0n5s.png" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM mit eigenem Netflow-Exporteur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderer SIEM-Marktteilnehmer, LogRhythm, bietet wiederum einen zus√§tzlichen Exporteur von NetMon-Streams an, der in einer verteilten Infrastruktur sowie in einem Netzwerk n√ºtzlich sein kann, dessen Ger√§te Netflow nicht unterst√ºtzen und f√ºr den durch ihn √ºbertragenen Netzwerkverkehr einen separaten Netflow-Generator erfordert. Tats√§chlich √ºbernimmt der SIEM-Hersteller in dieser Ausf√ºhrungsform die Funktionen von Netzwerkanbietern, entwickelt eine L√∂sung zum Generieren von Netflow und reduziert die Belastung von SIEM, wodurch die Notwendigkeit entf√§llt, rohen Netflow zu verarbeiten und zu speichern. Die Situation √§hnelt der Unterst√ºtzung von SSL Offload auf vielen Firewalls der neuen Generation. Ja, es existiert dort, aber bei einem intensiven Austausch von HTTPS-Verkehr f√ºhrt die zus√§tzliche Belastung von NGFW zu einer signifikanten Verringerung seines Durchsatzes.Daher wird in stark ausgelasteten Architekturen normalerweise ein separates Ger√§t f√ºr diese Aufgabe zugewiesen, das die Aufgabe √ºbernimmt, den SSL-Verkehr zu entschl√ºsseln und ihn dann an NGFW zur√ºckzugeben. Das gleiche passiert mit der SIEM Netflow-Verarbeitung in diesem Szenario.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yl/x6/z0/ylx6z0lpfhuepced9wmgjjodgmq.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist klar, dass dieses Szenario auch einen Nachteil hat - eine Erh√∂hung des Endpreises der L√∂sung, da Sie neben der Zahlung von Lizenzen f√ºr die Anzahl der analysierten FPS auch zus√§tzliche Sensoren bezahlen m√ºssen, die den Datenverkehr durch sich selbst leiten und Netflow generieren. Dar√ºber hinaus m√ºssen Sie √Ñnderungen an der Netzwerkarchitektur vornehmen, dies muss jedoch trotzdem erfolgen, sodass ich es nicht als Nachteil, sondern als Merkmal dieses Szenarios bezeichnen w√ºrde. Wenn Ihre Netzwerkger√§te nicht wissen, wie Netflow generiert wird, und Sie Netzwerkanomalien analysieren m√∂chten, k√∂nnen Sie nur separate Sensoren verwenden. Die Frage ist nur, was billiger ist - kaufen Sie Sensoren vom SIEM-Hersteller oder verwenden Sie Sensoren von Netzwerkherstellern (z. B. Cisco Netflow Generation Appliance) oder Entwicklern von Tools zur Analyse von Netzwerkanomalien (z. B.Cisco Stealthwatch Enterprise Flow Sensor). Bei dieser Option lohnt es sich auch herauszufinden, ob SIEM in der Lage ist, Netflow unter dem Gesichtspunkt der Informationssicherheit zu analysieren, oder ob nur Konnektoren in Form von Exporteuren / Sensoren herausgenommen werden (normalerweise).</font></font><br>
<br>
<h3>SIEM,   NTA</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die dritte Option, die Integration in L√∂sungen der NTA-Klasse, liegt auf der Hand, da NTA tats√§chlich derselbe Generator f√ºr Sicherheitsereignisse ist wie NGFW, Antivirus, Sicherheitsscanner, IPS usw. Dieses Szenario ist jedoch insofern interessant, als Sie die beiden vorhandenen Sicherheitsanalysetools kombinieren, aber separat damit arbeiten k√∂nnen. Mit NTA k√∂nnen Sie eine eingehende Analyse des Netzwerkverkehrs durchf√ºhren, b√∂sartigen Code, DDoS-Angriffe, Informationslecks erkennen, Remotebenutzer √ºberwachen ... Mit einem guten Tool zur Analyse des Netzwerkverkehrs k√∂nnen Sie gleichzeitig separate Sensoren in den Segmenten verwenden, in denen Netzwerkger√§te Netflow oder dessen nicht unterst√ºtzen Die Einbeziehung f√ºhrt zu einer Erh√∂hung der Belastung der Netzwerkger√§te. Mit NTA in diesem Szenario k√∂nnen Sie Netflow (in verschiedenen Versionen) aggregieren, verarbeiten und analysieren.und auf SIEM nur Alarme geben, wenn die eine oder andere b√∂swillige Aktivit√§t entdeckt wird. Diese Option ist nat√ºrlich auch dann sinnvoll, wenn Sie oder Ihre IT-Mitarbeiter bereits √ºber eine NTA-Klassenl√∂sung zur Fehlerbehebung im Netzwerk verf√ºgen und sie auch f√ºr Netzwerksicherheitsaufgaben verwendet werden kann. Oder wenn Sie im Gegenteil die Kosten f√ºr die NTA-L√∂sung mit Ihren Netzwerkern teilen m√∂chten, die sie f√ºr ihre Aufgaben verwenden, und mit Ihnen f√ºr Ihre.wer wird es f√ºr ihre Aufgaben verwenden, und Sie f√ºr Ihre.wer wird es f√ºr ihre Aufgaben verwenden, und Sie f√ºr Ihre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Nachteil dieser Option sind die zus√§tzlichen Kosten einer NTA-Klassenl√∂sung sowie die Notwendigkeit einer doppelten Schulung von Spezialisten in den Grundlagen der Arbeit mit zwei verschiedenen L√∂sungen. Andererseits erm√∂glicht eine separate L√∂sung zur Analyse des Netzwerkverkehrs tiefere Untersuchungen von Vorf√§llen als mit einem einzelnen SIEM mit integrierter Netflow-Unterst√ºtzung und flexibleren Anwendungen als mit dem SIEM-Hersteller, der √ºber separate Netflow-Sensoren verf√ºgt. Wenn wir jedoch √ºber eine separate L√∂sung der NTA-Klasse sprechen, meine ich die Sicherheitsl√∂sung und nicht nur ein Tool zur Analyse des Netzwerkverkehrs oder zur √úberwachung der Netzwerkleistung. Beispielsweise analysiert der bereits erw√§hnte SolarWinds NTA den Netzwerkverkehr gut, um IT-Aufgaben zu unterst√ºtzen, ist jedoch aus Gr√ºnden der Informationssicherheit sehr schlecht.Gleiches gilt f√ºr 5View von InfoVista oder Visual TruView von Fluke. Und das gleiche zum Beispiel</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kann von beiden im Unternehmen verwendet werden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/dd/jz/geddjzdyxryg6go3vpqkhswzmdq.jpeg" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Worauf muss man bei der Auswahl achten?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Auswahl einer NTA-L√∂sung aus Sicherheitsgr√ºnden sowie bei der Analyse von Exporteuren / Sensoren, die von SIEM- oder SIEM-Anbietern mit Netflow-Unterst√ºtzung bereitgestellt werden, w√ºrde ich empfehlen, die folgenden Kriterien zu beachten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arten von erkennbaren b√∂swilligen Aktivit√§ten. </font><font style="vertical-align: inherit;">Sie verwenden ein Tool zur √úberwachung der Informationssicherheit. </font><font style="vertical-align: inherit;">Es ist logisch anzunehmen, dass es in der Lage sein sollte, verschiedene Anomalien und Bedrohungen im Zusammenhang mit der Informationssicherheit ‚Äûout of the box‚Äú zu identifizieren. </font><font style="vertical-align: inherit;">Dar√ºber hinaus ist dieser Parameter in drei Teile unterteilt: integrierte Algorithmen zum Erkennen verschiedener Arten von Bedrohungen der Informationssicherheit, Schreiben von benutzerdefinierten Handlern / Regeln und Unterst√ºtzung externer Quellen f√ºr Threat Intelligence, um die analysierten Abl√§ufe mit Bedrohungsdaten anzureichern.</font></font></li>
<li>  Netflow. ,      ,            .</li>
<li>.     ,     1  (   FPS)?     60  FPS,  NTA   40 ,       ,      ,   , ,  80  FPS.</li>
<li> . , flat, ‚Ä¶        ,          . ,  .    .  ,       (, ,  Argus, Fluke, Plixer, Riverbed  SolarWinds),   ,      .             ,       .           ,  ;     ,       .      , ,  Cisco Stealthwatch.</li>
<li> .         ,      ,      ,     ,     .           ‚Äî     NTA.     ,  Cisco    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>   nfdump  OSU FlowTools      Lancope,           .</li>
<li>   .   ,                -    .       :<br>
<br>
<ul>
<li>  /</li>
<li> flow cache (   cash flow :-)</li>
<li>   .   MAC-,  VLAN,  MPLS,  TCP, , ,       ,     ,       (  IPFIX  ).</li>
</ul></li>
<li>   .        Netflow  SIEM,    SIEM  NTA  .  , ,     (,   )  REST API, syslog  ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es darum geht, was unabh√§ngig von SIEM zu w√§hlen ist, w√ºrde ich auch raten, die M√∂glichkeiten der Bedrohungssuche zu pr√ºfen, die die gew√§hlte L√∂sung bietet. </font><font style="vertical-align: inherit;">Da das Thema der Notiz jedoch etwas anders gew√§hlt wurde, werden wir diesen Aspekt jetzt nicht ber√ºcksichtigen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preisfrage</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie diese drei Optionen unter dem Gesichtspunkt ihrer Kosten betrachten, wird sich die dritte Option unter dem Gesichtspunkt der Investitionsausgaben als die teuerste herausstellen (vorbehaltlich der gleichen Funktionen f√ºr die Netflow-Analyse in allen drei Szenarien). Es ist verst√§ndlich. Zus√§tzlich zu den Kosten f√ºr SIEM ben√∂tigen Sie eine separate L√∂sung f√ºr die Analyse des Netzwerkverkehrs, die mindestens aus einem Steuerungssystem und der erforderlichen Anzahl von Sammlern besteht, die Netflow von verschiedenen Exporteuren / Sensoren sammeln. Unabh√§ngig davon, wie stark Sie die Abdeckung Ihres Netzwerks mit neuen Exporteuren / Sensoren erweitern, hat dies keine Auswirkungen auf die Kosten f√ºr SIEM und die Infrastruktur, da es mit bereits verarbeiteten Alarmen und nicht mit rohen Netflow-Streams funktioniert. welche (Signale) mehrere Gr√∂√üenordnungen weniger sein werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste Option erscheint unter dem Gesichtspunkt des Preises am attraktivsten, da wir f√ºr die Schulung von Analysten und NTA-Administratoren oder f√ºr zus√§tzliche Exporteure / Sensoren keine zus√§tzlichen Kosten zahlen m√ºssen. Wissen Sie, √ºbertragen Sie Netflow-Streams an SIEM und alle. Die Infrastrukturkosten f√ºr SIEM steigen jedoch erheblich, da Sie rohe Netflow-Streams speichern m√ºssen, wodurch Ihr vorhandener Speicher erweitert werden muss. Die zweite Option liegt zwischen den beiden Extremen, sowohl in Bezug auf die Netflow-Analysefunktionen als auch in Bezug auf die Kosten. In jedem Fall lohnt es sich bei den ersten beiden Optionen, die Gesamtbetriebskosten der L√∂sung anhand der Herausforderungen sowie der aktuellen und erwarteten FPS und infolgedessen der √Ñnderungen der Lizenzkosten f√ºr SIEM und der Speicherung f√ºr die SIEM-Hersteller zu erfragen. Nehmen wir zum BeispielLogRhythm und sein Subsystem f√ºr die Netflow-Analyse. Es gibt mindestens drei Optionen f√ºr die Implementierung und folglich f√ºr die Preisgestaltung. Die j√ºngste Option, Freemium, kann nur Alarme an SIEM senden, die Bandbreite darf 1 GB / s nicht √ºberschreiten, die Speicherkapazit√§t betr√§gt nur 1 GB (dies entspricht etwa einem Tag Netflow-Speicher ohne Stichproben), die Indexspeicherdauer betr√§gt nicht mehr als 3 Tage. und es gibt keine Korrelation mit zus√§tzlichen Datenquellen, und der Support funktioniert nur online und √ºber die Community. In der n√§chsten Version, NetMon, sind die Indikatoren besser (Bandbreite bis zu 10 GB / s f√ºr alle Exporteure, Speicherplatz ist unbegrenzt, der Index wird bis zu einem Monat gespeichert, es besteht jedoch auch keine Korrelation mit anderen Quellen). Und nur in der Premium-Version von NetworkXDR gibt es keine Einschr√§nkungen, aber es steht als "ein Kilometer Moskauer Stra√üen", das hei√üt nicht billig.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem der Projekte wurden wir mit der Tatsache konfrontiert, dass bei einem t√§glichen Netzwerk-Telemetrievolumen von 1 TB und dem Senden an SIEM mit integrierter Netflow-Unterst√ºtzung die Gesamtkosten der L√∂sung etwa 600.000 US-Dollar betrugen (sogar vor dem n√§chsten Kurssprung). Gleichzeitig blieb ein Teil dieser Daten aufgrund des Fehlens geeigneter Regeln im SIEM und im Duplikat unverarbeitet. Die Verwendung einer separaten NTA-L√∂sung (in unserem Fall </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) f√ºhrte zu einer Reduzierung des an SIEM √ºbertragenen Datenvolumens um 80%, und die Kosten f√ºr die L√∂sung sanken auf 99.000 US-Dollar. Die Mathematik mag von Projekt zu Projekt unterschiedlich sein, aber wir haben festgestellt, dass die SIEM-Infrastruktur umso teurer ist, je mehr Netflow wir verarbeiten m√ºssen. Warum so?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns ein Beispiel an. Wenn ein Benutzer eine Verbindung zum Server herstellt, behandeln wir unter dem Gesichtspunkt der klassischen Analyse von Informationssicherheitsereignissen nur ein Ereignis, das wir vom Server ‚Äûentfernen‚Äú, indem wir es beispielsweise √ºber ein Syslog an SIEM senden (tats√§chlich gibt es zwei Ereignisse - einen Versuch Verbindung und deren Ergebnis). Wenn dieses Ereignis in Netzwerkkomponenten zerlegt wird, werden wir sehen, dass um eine Gr√∂√üenordnung mehr Threads generiert werden. Beispielsweise betr√§gt die durchschnittliche Anzahl von "Hop" (Hop) vom Client zum Server im durchschnittlichen Netzwerk 5-6. Jeder Switch oder Router, √ºber den die Anforderung vom Client zur Serverseite weitergeleitet wird, generiert seine Netflow-Eintr√§ge, die den durchlaufenden Datenverkehr beschreiben. Dar√ºber hinaus erfolgt dies f√ºr jede Sitzungsrichtung (Anforderung und Antwort) separat. Es stellt sich heraus, dass dort,Wenn auf Anwendungsebene nur 1-2 Ereignisse generiert wurden, waren f√ºr Netflow-Flows mindestens zehnmal mehr erforderlich (sogar noch mehr, da ein Netzwerkpaket etwa 20 bis 30 Netflow-Flows generiert). Und wir m√ºssen nicht nur f√ºr all diese Dutzende von Threads bezahlen (obwohl das Ereignis immer noch einer ist) und Speicherplatz f√ºr ihre Speicherung zuweisen. Daher muss SIEM sie auch verarbeiten, Duplikate entfernen, multidirektionale Flows innerhalb einer Sitzung kombinieren und diese Daten erst dann mit anderen Ereignissen korrelieren. Daher k√∂nnen die Gesamtkosten einer scheinbar offensichtlichen L√∂sung h√∂her sein als bei einem separaten Netflow-Exporteur oder einer in SIEM integrierten eigenst√§ndigen L√∂sung zur Analyse von Netzwerkanomalien.Ein Netzwerkpaket generiert also ungef√§hr 20 bis 30 Netflow-Streams. Und wir m√ºssen nicht nur f√ºr all diese Dutzende von Threads bezahlen (obwohl das Ereignis immer noch einer ist) und Speicherplatz f√ºr ihre Speicherung zuweisen. Daher muss SIEM sie auch verarbeiten, Duplikate entfernen, multidirektionale Flows innerhalb einer Sitzung kombinieren und diese Daten erst dann mit anderen Ereignissen korrelieren. Daher k√∂nnen die Gesamtkosten einer scheinbar offensichtlichen L√∂sung h√∂her sein als bei einem separaten Netflow-Exporteur oder einer in SIEM integrierten eigenst√§ndigen L√∂sung zur Analyse von Netzwerkanomalien.Ein Netzwerkpaket generiert also ungef√§hr 20 bis 30 Netflow-Streams. Und wir m√ºssen nicht nur f√ºr all diese Dutzende von Threads bezahlen (obwohl das Ereignis immer noch einer ist) und Speicherplatz f√ºr ihre Speicherung zuweisen. Daher muss SIEM sie auch verarbeiten, Duplikate entfernen, multidirektionale Flows innerhalb einer Sitzung kombinieren und diese Daten erst dann mit anderen Ereignissen korrelieren. Daher k√∂nnen die Gesamtkosten einer scheinbar offensichtlichen L√∂sung h√∂her sein als bei einem separaten Netflow-Exporteur oder einer in SIEM integrierten eigenst√§ndigen L√∂sung zur Analyse von Netzwerkanomalien.multidirektionale Fl√ºsse innerhalb einer Sitzung zu kombinieren und diese Daten erst dann mit anderen Ereignissen zu korrelieren. Daher k√∂nnen die Gesamtkosten einer scheinbar offensichtlichen L√∂sung h√∂her sein als bei einem separaten Netflow-Exporteur oder einer in SIEM integrierten eigenst√§ndigen L√∂sung zur Analyse von Netzwerkanomalien.multidirektionale Fl√ºsse innerhalb einer Sitzung zu kombinieren und diese Daten erst dann mit anderen Ereignissen zu korrelieren. Daher k√∂nnen die Gesamtkosten einer scheinbar offensichtlichen L√∂sung h√∂her sein als bei einem separaten Netflow-Exporteur oder einer in SIEM integrierten eigenst√§ndigen L√∂sung zur Analyse von Netzwerkanomalien.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solche externen Netflow-Analysatoren k√∂nnen in einem von zwei Szenarien verwendet werden. Die erste ist die √úbertragung einer optimierten Telemetrie an SIEM, die von Wiederholungen befreit (dedupliziert) ist und multidirektionale Streams kombiniert. Aufgrund unserer Erfahrung (und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kann in diesem Modus arbeiten) kann ich sagen, dass dies eine sechsfache Reduzierung des an SIEM √ºbertragenen Telemetrievolumens bedeutet, das in diesem Szenario Netflow unter Sicherheitsgesichtspunkten weiterhin analysieren sollte.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dl/kp/ul/dlkpul7r3u12fhxu_-fzcdt5qqs.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im zweiten Szenario wird davon ausgegangen, dass die gesamte Verarbeitung mit einer L√∂sung der NTA-Klasse ausgef√ºhrt wird und nur Alarme, die als Ergebnis der Netflow-Verarbeitung empfangen wurden, in SIEM empfangen werden. </font><font style="vertical-align: inherit;">Diese Option reduziert noch mehr Daten, die an SIEM gesendet werden, und senkt die Kosten f√ºr Lizenzen und Infrastruktur. </font><font style="vertical-align: inherit;">Ja, und SIEM ist nicht mehr erforderlich, um den unformatierten Netflow analysieren zu k√∂nnen. Dies erweitert die M√∂glichkeiten zur Auswahl von Tools zur Analyse von Informationssicherheitsereignissen.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/su/mb/ubsumbhkpbgb2zqgn9qfwdzmd04.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gibt es Alternativen?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir die Optionen f√ºr die Verwendung von Netflow in SIEM untersucht haben, um mehr Sicherheitsereignisse als ohne Netflow zu erkennen, wollen wir uns m√∂gliche Alternativen ansehen. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerkdiagnosetools</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen versuchen, die Netzwerkdiagnosetools zu verwenden, mit denen die Netzwerkbandbreite, die Verf√ºgbarkeit interner Knoten und Segmente, Spitzenlasten usw. bewertet werden. </font><font style="vertical-align: inherit;">Zum Beispiel SolarWinds NetFlow Traffic Analyzer. </font><font style="vertical-align: inherit;">Diese L√∂sungen sind nicht daf√ºr ausgelegt, IS-Anomalien und -Drohungen zu erkennen, sondern k√∂nnen verwendet werden, um Flussinformationen an SIEM zu √ºbertragen, das m√∂glicherweise Netflow analysieren kann. </font><font style="vertical-align: inherit;">Dadurch wird SIEM geladen, wie oben beschrieben, und Sie m√ºssen sich entscheiden, ob Sie dazu bereit sind. </font><font style="vertical-align: inherit;">Es ist zwar sinnvoll, zun√§chst zu kl√§ren, ob der Netzwerkanalysator Netflow-Daten an externe Systeme senden kann. </font><font style="vertical-align: inherit;">Manchmal k√∂nnen sie nur zusammenfassende Statistiken ausgeben oder Alarme generieren, was f√ºr IS-Aufgaben eindeutig nicht ausreicht.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h8/yk/-s/h8yk-sjxv2lrquymay28nbqd5ui.jpeg" alt="Bild"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intrusion Detection Systems und NGFW</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Netzwerk-IPS und NGFW sind eine weitere Alternative. Sie k√∂nnen in den Netzwerkverkehr hineinschauen und viele Bedrohungen durch einen umfassenden Netzwerkinspektionsmechanismus erkennen ... aber am Rand. Normalerweise befinden sich NGFW und IPS jedoch an der Grenze zwischen Unternehmensnetzwerk und Internet und sehen nur, was durch sie hindurchgeht. Die Installation dieser Ger√§te, "b√ºgeln" oder virtuell, an jedem Ort, an dem Sie interessiert sind, ist zu teuer und in einigen F√§llen technisch unm√∂glich. In Bezug auf die Grenze oder den Umfang ist zu beachten, dass die Schnittstelle zwischen dem Rechenzentrum des Unternehmens und den Benutzersegmenten auch die Grenze ist. Und auch die Schnittstelle zwischen Unternehmens- und Industrienetzwerk. In jedem Fall kann die Installation zus√§tzlicher IPS- oder NGFW-Sensoren Ihre Brieftasche schmerzhaft treffen, w√§hrend Netflow von bereits gekauften und implementierten Netzwerkger√§ten gesammelt wird.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tools zur Untersuchung von Netzwerkvorf√§llen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit den NFT-Klassenl√∂sungen (Network Forensics Tool) k√∂nnen Sie den Netzwerkverkehr speichern, verarbeiten und analysieren, um Vorf√§lle zu untersuchen. </font><font style="vertical-align: inherit;">Es gibt jedoch einen signifikanten Unterschied zwischen dieser Art von L√∂sung und NTA - NFT arbeitet mit einer vollst√§ndigen Kopie des Datenverkehrs, dh normalerweise mit PCAP-Dateien, und NTA mit Aufzeichnungen dar√ºber. </font><font style="vertical-align: inherit;">Und wenn Netflow-Analysel√∂sungen fast in Echtzeit funktionieren, dann NFT - mit einer erheblichen Verz√∂gerung. </font><font style="vertical-align: inherit;">Dar√ºber hinaus tritt bei jeder L√∂sung, die mit PCAP funktioniert (oder auf andere Weise eine Kopie des gesamten Netzwerkverkehrs erfasst und speichert), das Problem auf, dass alle gesammelten Daten gespeichert werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie sich vor, Sie haben einen Port an einem 1-Gbit / s-Netzwerkger√§t. Mit einer Paketl√§nge von 64 Bytes kann dieser Port 1953125 Pakete pro Sekunde und mit einer L√§nge von 1500 Bytes - 83.333 Pakete - passieren. Das hei√üt, abh√§ngig von der L√§nge des Pakets (und dies h√§ngt von den Anwendungen im Netzwerk ab) haben wir ungef√§hr 80.000 bis 2 Millionen Pakete pro Sekunde, die wir speichern m√ºssen. An einem Tag erlaubt ein solcher Port 86400 Gbit / s oder fast 11 TB. Fast 4 PB werden im Laufe des Jahres ausgef√ºhrt, und dies gilt nur f√ºr einen Port, von dem wir Tausende und Zehntausende in unserem Netzwerk haben k√∂nnen. Selbst die selektive Speicherung von Verkehr wird unser Leben nicht wesentlich erleichtern. Daher werden L√∂sungen der NFT-Klasse ben√∂tigt, die Netflow-Analysatoren jedoch nicht ersetzen k√∂nnen. Dies sind Tools, die verschiedene Aufgaben l√∂sen - √úberwachung und Untersuchung von Vorf√§llen.In der Regel arbeiten diese L√∂sungen paarweise. Mit Netflow k√∂nnen wir Vorf√§lle identifizieren, und NFT sammelt bereits detaillierte Daten dazu in Form der Erfassung des gesamten Netzwerkverkehrs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt jedoch SIEM mit NFT, z. B. IBM QRadar Incident Forensics oder RSA Security Analytics, mit denen Sie mit einer vollst√§ndigen Kopie des Netzwerkverkehrs arbeiten k√∂nnen und alle Netflow-Metadaten automatisch in SIEM verf√ºgbar sind</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Ja, das gibt es! Dar√ºber hinaus besteht der Vorteil dieser L√∂sung in der M√∂glichkeit, alle interessierenden Netzwerksitzungen zu rekonstruieren und zu visualisieren, was die Untersuchung von Vorf√§llen erleichtern kann. Mit SIEM k√∂nnen Sie den Platz eines Angreifers einnehmen und alles sehen, was er sieht. Aber diese W√ºrde ist verborgen und ein schwerwiegender Nachteil, den ich oben erw√§hnt habe, ist, dass das Speichern einer vollst√§ndigen Kopie des Netzwerkverkehrs einen gro√üen, nicht so gro√üen Speicher erfordert, der als separates SIEM oder sogar mehr kosten kann (mehr als nur das Speichern von nur rohem Netflow) ). M√∂glicherweise m√ºssen Sie ausw√§hlen, welche bestimmten Sitzungen gespeichert werden sollen, um Platz zu sparen. Dies kann dazu f√ºhren, dass Datenverkehr verloren geht. Wenn die gesetzlichen Anforderungen f√ºr die Speicherung von Daten im Zusammenhang mit Vorf√§llen eingehalten werden,Sie m√ºssen sie brechen oder zus√§tzliches Geld f√ºr die Lagerung bezahlen. Ein weiteres Merkmal dieser L√∂sung ist die Notwendigkeit, Datenverkehr zu speichern, der bereits in SIEM entschl√ºsselt wurde. Dies bedeutet, dass Sie die Architektur Ihres √úberwachungssystems √ºberpr√ºfen m√ºssen, um Datenverkehr entschl√ºsseln und an SIEM senden zu k√∂nnen. Und vergessen Sie nicht, dass sich solche L√∂sungen immer noch auf die Durchf√ºhrung von Untersuchungen konzentrieren, f√ºr die qualifiziertes Personal erforderlich ist, und nicht auf die Erkennung von Anomalien und Bedrohungen mithilfe vorgefertigter Algorithmen.Solche Entscheidungen konzentrieren sich jedoch auf die Durchf√ºhrung von Untersuchungen, f√ºr die qualifiziertes Personal erforderlich ist, und nicht auf die Erkennung von Anomalien und Bedrohungen mithilfe vorgefertigter Algorithmen.Solche Entscheidungen konzentrieren sich jedoch auf die Durchf√ºhrung von Untersuchungen, f√ºr die qualifiziertes Personal erforderlich ist, und nicht auf die Erkennung von Anomalien und Bedrohungen mithilfe vorgefertigter Algorithmen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Szenario w√ºrde ich immer noch die anf√§ngliche Analyse des Netzwerkverkehrs mit Netflow betrachten und erst dann f√ºr die Ereignisse und Vorf√§lle, die f√ºr mich von Interesse sind, die Aufzeichnung des Netzwerkverkehrs aktivieren. </font><font style="vertical-align: inherit;">Dadurch werden Ressourcen f√ºr die Speicherung von "allem" gespart und nicht ausgegeben.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also, um es kurz zusammenzufassen. Netflow ist eine wertvolle Datenquelle f√ºr die √úberwachung der Sicherheit von Unternehmens- und Abteilungsnetzwerken. Oft ist dies die einzige, die erfasst werden kann und auf deren Grundlage Sie Entscheidungen √ºber das Vorhandensein oder Fehlen von Bedrohungen in Ihrer Umgebung treffen k√∂nnen. Grunds√§tzlich kann Netflow auch unabh√§ngig mithilfe von NTA-Klassenl√∂sungen analysiert werden, die √ºber eine gro√üe Datenbank mit Regeln und Algorithmen zur Erkennung b√∂swilliger und abnormaler Aktivit√§ten verf√ºgen und in der Lage sind, Vorf√§lle schnell zu erkennen und darauf zu reagieren. Die Integration von Netflow in die von SIEM gesammelten Daten bietet uns viel mehr. SIEM beginnt zu sehen, was es vorher nicht gesehen hat und sieht es viel fr√ºher, als wir verletzt werden k√∂nnen. Gleichzeitig m√ºssen wir keine starken √Ñnderungen an der vorhandenen √úberwachungsinfrastruktur vornehmen, da wir bereits √ºber Netzwerkger√§te verf√ºgen.- Sie m√ºssen Netflow nur direkt oder √ºber Zwischenl√∂sungen zu SIEM umleiten. Durch die Aktivierung von Netflow kann ich auch einen kleinen, aber schnellen Sieg erzielen - fast alle unsere L√∂sungspiloten</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> endet mit der Tatsache, dass wir bestimmte Verst√∂√üe gegen IS-Richtlinien feststellen, die zuvor vom IS-Dienst nicht </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">erkannt</font></a><font style="vertical-align: inherit;"> wurden. </font><font style="vertical-align: inherit;">Mit Netflow konnten sie gesehen und in SIEM integriert werden, um einen synergistischen Effekt aus den angewendeten Netzwerk√ºberwachungstools und dem Aktivit√§tssystem zu erzielen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de501806/index.html">ACS: Probleme, L√∂sungen und Sicherheitsrisikomanagement</a></li>
<li><a href="../de501808/index.html">Die Liste der √Ñnderungen in D 2.092. Ausleihen Ausleihen</a></li>
<li><a href="../de501810/index.html">Coole 3D-Shooter auf einem alten Laptop: ein Test der Cloud-Gaming-Plattform GFN.RU</a></li>
<li><a href="../de501812/index.html">Python-Telegramm-Paginierungsbot</a></li>
<li><a href="../de501814/index.html">COVID-√Ñnderungen: Geschichten von StartupDrive-Mitgliedern, die sich w√§hrend einer Pandemie ge√§ndert haben und st√§rker geworden sind</a></li>
<li><a href="../de501822/index.html">Ingenieur der dritten Generation</a></li>
<li><a href="../de501824/index.html">Machen Sie sich bereit f√ºr einen Hackathon zu Hause</a></li>
<li><a href="../de501826/index.html">√úber ehrgeizige Gr√ºnder oder wie ich versucht habe, Investitionen f√ºr ein Startup zu sammeln</a></li>
<li><a href="../de501830/index.html">Wir portieren das Angular-Projekt auf ESLint mit Prettier, Husky und Lint-Inszenierung</a></li>
<li><a href="../de501834/index.html">√úbersicht √ºber Creaform Metrascan 3D-Scanner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>