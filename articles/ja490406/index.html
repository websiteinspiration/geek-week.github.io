<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐄 🏏 🎲 表現できないほど魅力的：公開できないハニオットをどのように作成したか 🐯 👈 🎽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ウイルス対策企業、情報セキュリティの専門家、そして単に愛好家は、ベイトシステムをインターネットに配置します。ハニポットは、新鮮なウイルスの「生餌」を捕獲したり、異常なハッカーの戦術を特定したりします。ハニポットは非常に一般的であるため、サイバー犯罪者は一種の免責を発達させました。彼らは、彼らの前に罠...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>表現できないほど魅力的：公開できないハニオットをどのように作成したか</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/trendmicro/blog/490406/"><img src="https://habrastorage.org/webt/qi/wa/e3/qiwae34tux4xxeobnrua7xsjo48.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウイルス対策企業、情報セキュリティの専門家、そして単に愛好家は、ベイトシステムをインターネットに配置します。ハニポットは、新鮮なウイルスの「生餌」を捕獲したり、異常なハッカーの戦術を特定したりします。</font><font style="vertical-align: inherit;">ハニポットは非常に一般的であるため、サイバー犯罪者は一種の免責を発達させました。彼らは、彼らの前に罠があり、単にそれを無視していることをすぐに明らかにします。</font><font style="vertical-align: inherit;">現代のハッカーの戦術を探るために、現実的なハニオットを作成しました。これは7か月間インターネット上に存在し、さまざまな攻撃を引き付けました。</font><font style="vertical-align: inherit;">私たちの調査では、「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法にとらわれて、現実的な脅威をとらえるために現実的な工場ハニーポットを実行する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」と説明しました。</font><font style="vertical-align: inherit;">研究からのいくつかの事実はこの投稿にあります。</font></font></i><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハニポット開発：チェックリスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スーパートラップを作成する際の主なタスクは、それに興味を示したハッカーにさらされないようにすることでした。</font><font style="vertical-align: inherit;">これを行うには、私は多くの仕事をしなければなりませんでした：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">従業員の名前と写真、電話番号、電子メールなど、会社に関する現実的な伝説を作成します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">弊社の伝説に対応する産業インフラのモデルを発明し、実施すること。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">外で利用できるネットワークサービスを決定しますが、脆弱性のあるポートを開くことに関与しないようにしてください。 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">脆弱なシステムに関する情報の漏洩の様子を整理し、潜在的な攻撃者にこの情報を配布します。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トラップインフラストラクチャにハッカーの目立たない監視を実装します。 </font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、まず最初に。</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">凡例を作成する</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイバー犯罪者は、多くの操作に遭遇するという事実にすでに慣れているため、サイバー犯罪者の最も進んだ部分は、脆弱なシステムのそれぞれについて詳細な調査を行い、これが罠ではないことを確認します。同じ理由で、デザインや技術面でのハニポットのリアリズムの実現だけでなく、実際の会社の外観の作成にも努めました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
架空のクルハーカーの代わりに、実際のシステムとトラップを区別する検証アルゴリズムを開発しました。これには、レピュテーションシステムでの会社のIPアドレスの検索、IPアドレスの履歴の逆調査、会社に関連する名前とキーワード、およびその取引先などの多くのものが含まれます。その結果、伝説は非常に説得力があり魅力的であることが判明しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、トラップ工場を小さな産業用プロトタイピングブティックとして位置づけ、軍事および航空分野の非常に大規模な匿名クライアントのために働くことにしました。これにより、既存のブランドの使用に関連する法的な問題が解消されました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、私たちはビジョン、使命、組織の名前を考え出す必要がありました。私たちの会社は、それぞれが創業者である少数の従業員を持つスタートアップになると決めました。これは、私たちのビジネスの専門化の伝説に信頼性を追加しました。これにより、大規模で重要な顧客のためのデリケートなプロジェクトに取り組むことができます。私たちは会社にサイバーセキュリティの面で弱く見えるようにしたかったのですが、同時に、ターゲットシステムの重要な資産で作業していることは明らかでした。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/6d/hw/gu/6dhwguxausaawidgg95iywb01-m.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeTechハニポットサイトのスクリーンショット。出典：Trend Micro。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
社名としてMeTechを選択しました。このサイトは、無料のテンプレートに基づいて作成されました。画像はフォトバンクから取得され、最も人気のないものを使用して、認識されにくくしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
会社をリアルに見せたかったので、ビジネスのプロファイルに対応する専門的なスキルを持つ従業員を追加する必要がありました。彼らの名前と個性を考え出し、その人種に応じてフォトバンクから画像を選択しようとしました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/sp/vo/7s/spvo7snoj5ph5lxm5an3uhh4vxo.png" alt="画像"><br>
<i><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MeTechハニポットサイトのスクリーンショット。出典：Trend Micro</font></font></i></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちを明らかにしないために、私たちは必要な顔を選択できる良質な集合写真を探していました。</font><font style="vertical-align: inherit;">しかし、潜在的なクラッカーが逆画像検索を利用して、「従業員」がフォトバンクのみに住んでいることがわかる可能性があるため、その後、このオプションを放棄しました。</font><font style="vertical-align: inherit;">最後に、ニューラルネットワークを使用して作成された実在しない人々の写真を利用しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サイトに公開されている従業員のプロファイルには、技術的なスキルに関する重要な情報が含まれていましたが、特定の教育機関や都市からの指示は避けました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
メールボックスを作成するには、ホスティングプロバイダーのサーバーを使用し、米国でいくつかの電話番号を借りて、それらを音声メニューと留守番電話を備えた仮想電話交換機に組み合わせました。</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハニポットインフラストラクチャ</font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
公開されないようにするために、実際の産業用機器、物理コンピューター、および安全な仮想マシンを組み合わせて使用​​することにしました。</font><font style="vertical-align: inherit;">先を見据えて、初段の検索エンジンを使って取り組みの結果を確認したところ、ハニポットは本物の産業システムのように見えました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/wf/k_/_4/wfk__4gu5azv2hwi4vwtw2d_ajw.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shodanを使用してハニポットをスキャンした結果。</font><font style="vertical-align: inherit;">出典：Trend Micro。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
トラップのハードウェアとして4つのPLCを使用しました</font><i><font style="vertical-align: inherit;">。</font></i></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> シーメンスS7-1200、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つのAllenBradley MicroLogix 1100、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オムロンCP1L。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのPLCは、制御システムのグローバル市場での人気のために選択されました。</font><font style="vertical-align: inherit;">そして、これらのコントローラーはそれぞれ独自のプロトコルを使用しており、これにより、どのPLCがより頻繁に攻撃するか、および原則として誰が興味を持つかを確認できます。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/zv/tx/hs/zvtxhskzoo7llc8cbeurbmx7tt0.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「工場」トラップの設備。</font><font style="vertical-align: inherit;">出典：トレンドマイクロ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
鉄片を置いてインターネットに接続するだけではありません。</font><font style="vertical-align: inherit;">各コントローラーをタスクを実行するようにプログラムしました。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">混合</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バーナーおよびコンベヤーベルト制御、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロボットアームを使用したパレタイズ。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして、生産プロセスを現実的にするために、フィードバックパラメーターをランダムに変更し、エンジンの始動と停止をシミュレーションし、バーナーのオンとオフを切り替えるようにロジックをプログラムしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちの工場には3台の仮想コンピューターと1台の物理コンピューターがありました。仮想マシンは、プラント、パレタイジングロボットを制御するために、およびPLCソフトウェアエンジニアの自動化された作業場として使用されました。物理コンピューターはファイルサーバーとして機能しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PLCへの攻撃を監視することに加えて、デバイスにダウンロードされたプログラムのステータスを監視したいと考えました。これを行うために、仮想アクチュエーターとインストールの状態がどのように変更されたかをすばやく判断できるインターフェースを作成しました。すでに計画段階で、コントローラーロジックを直接プログラミングするよりも、制御プログラムを使用してこれを実装する方がはるかに簡単であることがわかりました。パスワードなしでVNCを介してハニポットのデバイス管理インターフェイスへのアクセスを開きました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
産業用ロボットは、現代のスマート製造の重要なコンポーネントです。そのため、工場トラップの設備にロボットとAWPを追加して制御することにしました。 「工場」をより現実的にするために、AWPコントロールに実際のソフトウェアをインストールしました。これは、エンジニアがロボットロジックをグラフィカルにプログラムするために使用します。まあ、産業用ロボットは通常、隔離された内部ネットワークに配置されているので、保護されていないVNCアクセスはワークステーション管理にのみ残すことにしました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/z9/p1/ku/z9p1kujj4-pokliqn7lmacs0oes.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロボットの3Dモデルを含むRobotStudio環境。出典：Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ロボット制御ワークステーションを備えた仮想マシンに、ABB RoboticsのRobotStudioプログラミング環境をインストールしました。</font><font style="vertical-align: inherit;">RobotStudioをセットアップしたら、ロボットでシミュレーションファイルを開いて、3D画像が画面に表示されるようにしました。</font><font style="vertical-align: inherit;">その結果、保護されていないVNCサーバーを発見したShodanと他の検索エンジンは、画面からこの画像を受け取り、制御へのオープンアクセスを持つ産業用ロボットを探している人にそれを表示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
細部へのそのような注意の意味は、それを発見して、何度も何度もそれに戻るだろう攻撃者にとって魅力的で最も現実的な目標を作成することでした。</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AWPエンジニア</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PLCロジックをプログラムするために、インフラストラクチャにエンジニアリングコンピュータを追加しました。</font><font style="vertical-align: inherit;">PLCプログラミング用の産業用ソフトウェアがインストールされています。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シーメンスのTIAポータル、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allen-Bradleyコントローラー用MicroLogix、</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オムロン向けCX-One。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エンジニアリングワークステーションにはネットワークの外部からアクセスできないと判断しました。</font><font style="vertical-align: inherit;">代わりに、ロボット制御のワークステーションおよびインターネットからアクセス可能な工場のワークステーションと同じパスワードを管理者アカウントに設定しました。</font><font style="vertical-align: inherit;">この構成は、多くの企業で非常に一般的です。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、あらゆる努力にもかかわらず、エンジニアのAWPに到達した攻撃者は一人もいませんでした。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルサーバー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
侵入者のおとりとして、またトラップ工場で自分の「仕事」をバックアップする手段として必要でした。これにより、ネットワークトラップに痕跡を残すことなく、USBデバイスを使用してハニオットとファイルを共有できました。ファイルサーバーのOSとしてWindows 7 Proをインストールし、共有フォルダーに誰でも読み書きできるようにしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初は、ファイルサーバー上にフォルダーとドキュメントの階層を作成しませんでした。しかし、その後、攻撃者がこのフォルダーを積極的に調査していることが判明したため、さまざまなファイルで埋めることにしました。これを行うために、指定された拡張子の1つを使用してランダムなサイズのファイルを作成するPythonスクリプトを作成し、辞書に基づいて名前を形成しました。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/55/ra/ok/55raoklawy-fcys1bf5eevbeaii.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">魅力的なファイル名を生成するためのスクリプト。出典：Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
スクリプトを実行すると、非常に興味深い名前のファイルが入ったフォルダーの形で目的の結果が得られました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/ll/fw/8i/llfw8i9bqf7zhbz6fffj3nrg99i.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スクリプトの結果。</font><font style="vertical-align: inherit;">出典：Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">監視環境</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現実的な会社を作ることに多大な労力を費やしたので、「訪問者」を監視するための環境に身を投じるだけの余裕はありませんでした。攻撃者が監視されていることに気付かれないように、すべてのデータをリアルタイムで取得する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、4つのUSBイーサネットアダプター、4つのSharkTapイーサネットカプラー、Raspberry Pi 3、および大容量の外部ドライブを使用して実装しました。私たちのネットワークのスキームは次のようになりました：</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/j5/94/g8/j594g8h2lljwitq06azjhb62ots.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">監視装置を備えたハニポットネットワークのスキーム。出典：Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
内部ネットワークからのみアクセス可能なPLCへのすべての外部トラフィックを監視するために、3つのSharkTapタップを配置しました。 4番目のSharkTapは、脆弱な仮想マシンのゲストのトラフィックを追跡しました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/pg/c9/gp/pgc9gpcpjeuykehtqxytnv7y5ru.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharkTapイーサネットカプラーとSierra Wireless AirLink RV50ルーター。</font><font style="vertical-align: inherit;">出典：Trend Micro</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Raspberry Piが毎日トラフィックをキャプチャしました。</font><font style="vertical-align: inherit;">私たちは、企業でよく使用されるSierra Wireless AirLink RV50セルラールーターを使用してインターネット接続を確立しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
残念ながら、このルーターでは計画を満たさない攻撃を選択的にブロックすることができなかったため、透過モードのCisco ASA 5505ファイアウォールをネットワークに追加して、ネットワークへの影響を最小限に抑えてブロックを実行しました。</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">トラフィック分析</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tsharkとtcpdumpは現在の問題をすばやく解決するのに適していますが、私たちの場合、数ギガバイトのトラフィックがあり、数人が分析したため、それらの機能は十分ではありませんでした。</font><font style="vertical-align: inherit;">AOLが開発したオープンソースアナライザーMolochを使用しました。</font><font style="vertical-align: inherit;">機能の点では、Wiresharkに匹敵しますが、コラボレーション、パッケージの説明とタグ付け、エクスポート、その他のタスクのための機能が増えています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
収集したデータをハニポットコンピューターで処理したくなかったため、PCAPダンプはAWSに毎日エクスポートされ、そこからMolochを使用してコンピューターに既にインポートされています。</font></font><br>
<br>
<h3><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">画面記録 </font></font></b></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハニポットでのクラッカーのアクションを文書化するために、一定の間隔で仮想マシンのスクリーンショットを撮るスクリプトを書き、前のスクリーンショットと比較して、そこで何かが起こっているかどうかを判断しました。</font><font style="vertical-align: inherit;">アクティビティが検出されたとき、スクリプトには画面の記録が含まれていました。</font><font style="vertical-align: inherit;">このアプローチが最も効果的であることが証明されています。</font><font style="vertical-align: inherit;">また、システムで発生した変更を理解するために、PCAPダンプからのVNCトラフィックを分析しようとしましたが、最終的に、実装した画面の記録はよりシンプルで視覚的にわかりました。</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VNCセッションの監視</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これには、ChaosreaderとVNCLoggerを使用しました。</font><font style="vertical-align: inherit;">どちらのユーティリティもPCAPダンプからキーストロークを抽出しますが、VNCLoggerはBackspace、Enter、Ctrlなどのキーをより正確に処理します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNCLoggerには2つの欠点があります。</font><font style="vertical-align: inherit;">まず、インターフェイス上のトラフィックを「リッスン」することによってのみキーを抽出できるため、tcpreplayを使用してVNCセッションをシミュレートする必要がありました。</font><font style="vertical-align: inherit;">VNCLoggerの2番目の欠点はChaosreaderに共通です。どちらもクリップボードの内容を表示しません。</font><font style="vertical-align: inherit;">これを行うには、Wiresharkを使用する必要がありました。</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ルアーハッカー</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃されるハニポットを作成しました。</font><font style="vertical-align: inherit;">これを達成するために、潜在的なクラッカーの注意を引くように設計された情報漏洩を上演しました。</font><font style="vertical-align: inherit;">次のポートがハニポットで開かれました。RDP </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s5/ck/ma/s5ckmab2jeiqlxn58v51ywkyqe0.png" alt="画像"><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ポートは、作業の開始直後に閉じる必要がありました。これは、ネットワーク内の大量のスキャントラフィックが原因で、パフォーマンスの問題が発生したためです。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
VNC端末は、最初はパスワードなしの「表示専用」モードで動作し、次に「誤って」フルアクセスモードに切り替えました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
攻撃者を引き付けるために、PasteBinで利用可能な産業システムに関する漏洩情報を含む2つの投稿を投稿しました。</font></font><br>
 <br>
<img src="https://habrastorage.org/webt/4g/qf/lk/4gqflk8fpyjhxqhbxwtscepi_nm.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PasteBinに投稿された攻撃の1つ。</font><font style="vertical-align: inherit;">出典：Trend Micro</font></font></i><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">攻撃</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハニポットは約7か月間オンラインで暮らしていました。最初の攻撃は、ハニポットがオンラインでリリースされてから1か月後に発生しました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スキャナー</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
有名企業のスキャナー（ip-ip、Rapid、Shadow Server、Shodan、ZoomEyeなど）からのトラフィックが多かった。非常に多くのIPアドレスを分析から除外する必要があったため、9452のうち610、またはすべての一意のIPアドレスの6.45％が完全に正当なスキャナーに属していました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">詐欺師</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
、加入者のアカウントを介してギフトカードや詐欺の他のタイプの航空会社のマイルアウト現金スマートフォンを購入する：私たちが直面しなければならなかった最大のリスクの一つは、犯罪目的のために我々のシステムを使用した</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">鉱山を</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのシステムへの最初の訪問者の1人が鉱山労働者であることが判明しました。彼はMoneroマイニングソフトウェアをそれにアップロードしました。生産性が低いため、彼は私たちの特定のシステムで多くを稼ぐことができなかっただろう。しかし、このようなシステムを数十、さらには数百と組み合わせると、かなりうまくいく可能性があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恐喝者</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハニポットの運用中に、本物のランサムウェアウイルスに2回遭遇しました。最初のケースでは、それはクライシスでした。そのオペレーターはVNCを介してシステムにログオンしましたが、TeamViewerをインストールし、それを使用してさらにアクションを実行しました。 BTCで1万ドルの身代金を要求するランサムウェアメッセージを待った後、犯罪者とのやり取りを行い、ファイルの1つを復号化するように依頼しました。彼らは要求を満たし、身代金要求を繰り返した。必要な情報をすべて入手したので、最大で6,000ドルを交渉し、その後、システムを仮想マシンにリロードしました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2番目のランサムウェアはPhobosでした。 1時間インストールしたハッカーは、ハニポットのファイルシステムを調べ、ネットワークをスキャンした後、ランサムウェアをインストールしました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3番目のランサムウェア攻撃は偽物であることが判明しました。</font><font style="vertical-align: inherit;">不明な「ハッカー」がhaha.batファイルをシステムにダウンロードした後、しばらくの間、彼がどのように機能させようとしているかを監視しました。</font><font style="vertical-align: inherit;">1つの試みは、haha.batをhaha.rnsmwrに名前変更することでした。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/53/nj/r1/53njr1nbgvuvbdsuo4aythx-n7e.png" alt="画像"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ハッカー」はbatファイルの有害性を高め、拡張子を.rnsmwrに変更します。</font><font style="vertical-align: inherit;">出典：トレンドマイクロ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
バッチファイルがようやく実行を開始すると、ハッカーはそれを編集し、身代金を200ドルから750ドルに増やしました。</font><font style="vertical-align: inherit;">その後、すべてのファイルを「暗号化」し、ランサムウェアメッセージをデスクトップに残して姿を消し、VNCのパスワードを変更しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
数日後、ハッカーは戻ってきて、思い出させるためにバッチファイルを起動しました。これにより、ポルノサイトのある多くのウィンドウが開きました。</font><font style="vertical-align: inherit;">どうやら、このようにして彼は自分の要求に注意を向けようとした。</font></font><br>
<br>
<b><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概要</font></font></h3></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
調査中に、脆弱性に関する情報が公開されるとすぐに、ハニポットが注目を集め、活動が日々成長していることがわかりました。トラップが注目を集めるために、私たちは架空の会社の多くのセキュリティ違反を認めなければなりませんでした。残念ながら、この状況は、フルタイムのITおよび情報セキュリティ担当者を持たない多くの実際の企業の間ではめったにありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一般的なケースでは、組織は最小限の特権の原則を使用する必要がありますが、侵入者を引き付けるためにまったく反対の方法を実装しました。また、攻撃を監視する時間が長くなるほど、標準の侵入テスト方法と比較して、より高度な攻撃になりました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして最も重要なこととして、これらの攻撃はすべて、ネットワークのセットアップ時に適切なセキュリティ対策が実装されていれば失敗します。</font><font style="vertical-align: inherit;">組織は、特にトラップで行ったように、機器や産業インフラストラクチャコンポーネントにインターネットからアクセスできないようにする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてのコンピューターで同じローカル管理者パスワードを使用しているにもかかわらず、エンジニアのワークステーションに対する単一の攻撃を記録しませんでしたが、侵入者の可能性を最小限に抑えるために、この方法を回避する必要があります。</font><font style="vertical-align: inherit;">実際、セキュリティが不十分であることは、サイバー犯罪者が長い間関心を寄せてきた産業システムを攻撃する追加の誘因となります。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490392/index.html">Catchain：TONブロックチェーンコンセンサスアルゴリズム</a></li>
<li><a href="../ja490394/index.html">コモドールアミガ500+：誰も怒らせない</a></li>
<li><a href="../ja490398/index.html">赤いホグワーツ。役員、またはなぜ歴史家が探偵のようであるか</a></li>
<li><a href="../ja490400/index.html">OpenCVライブラリを使用して、3D点群の2D断面の楕円弧を認識する</a></li>
<li><a href="../ja490404/index.html">5Gがなぜ、どのようにすべてを変えるか：テクノロジー、段階的な実装、および加入者機器の要素ベース</a></li>
<li><a href="../ja490408/index.html">FreeBSD：GNU / Linuxよりもはるかに優れている</a></li>
<li><a href="../ja490410/index.html">インターネットを介して接続された生きている人工ニューロン</a></li>
<li><a href="../ja490412/index.html">たぶん、JavaScriptで少し落ち着かなければなりませんか？</a></li>
<li><a href="../ja490416/index.html">コンピュータサイエンスクラブレクチャービデオ</a></li>
<li><a href="../ja490418/index.html">ミレニアル世代とジェネレーションAlpha VS高等教育</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>