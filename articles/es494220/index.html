<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíö üë©üèº‚Äçüíª ü§ö OpenToonz: por dentro y por fuera üëãüèæ üèÅ üåò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Han pasado casi cuatro a√±os desde que PVS-Studio verific√≥ el c√≥digo fuente de OpenToonz. Este proyecto es una herramienta muy poderosa para crear anim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>OpenToonz: por dentro y por fuera</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/494220/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dea/ccf/6dd/deaccf6dded129be42e3f458e2457c48.png" alt="image1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Han pasado casi cuatro a√±os desde que PVS-Studio verific√≥ el c√≥digo fuente de OpenToonz. </font><font style="vertical-align: inherit;">Este proyecto es una herramienta muy poderosa para crear animaciones bidimensionales. </font><font style="vertical-align: inherit;">Desde el √∫ltimo control, con su ayuda, se crearon obras animadas como Mary and the Witch Flower, Batman Ninja, Promare y otras. </font><font style="vertical-align: inherit;">Dado que los grandes estudios contin√∫an usando Toonz, ¬øpor qu√© no verificar la calidad del c√≥digo fuente nuevamente?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede familiarizarse con el an√°lisis anterior de errores en el art√≠culo " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo incorrecto de un paquete para crear animaciones 2D de Toonz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">En general, no parece que la calidad del c√≥digo haya mejorado mucho, por lo que la impresi√≥n general no es mejor. </font><font style="vertical-align: inherit;">Adem√°s, se encontraron muchos de los mismos errores que en el art√≠culo anterior. </font><font style="vertical-align: inherit;">No los volveremos a considerar, ya que hay muchas cosas para elegir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, debe comprender que la presencia de errores no necesariamente impide el uso activo y productivo del producto de software. Lo m√°s probable es que los errores encontrados se encuentren en vivo en partes del c√≥digo raramente utilizadas o completamente no utilizadas, de lo contrario habr√≠an sido identificadas en el proceso de uso de la aplicaci√≥n y corregidas. Sin embargo, esto no significa que el an√°lisis est√°tico sea redundante. Es solo que el significado del an√°lisis est√°tico no es buscar errores antiguos e irrelevantes, sino abaratar el proceso de desarrollo. Muchos errores al escribir c√≥digo se pueden detectar de inmediato, y no durante la operaci√≥n del software. En consecuencia, con el uso regular de un analizador est√°tico, los errores se corrigen en una etapa temprana. Esto ahorra a los desarrolladores tiempo y dinero de la empresa, y mejora la percepci√≥n del producto por parte de los usuarios. De acuerdo, es desagradable darse de baja constantemente a los desarrolladores,que una cosa u otra no funciona.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N1 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V610</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comportamiento indefinido. </font><font style="vertical-align: inherit;">Verifique el operador de turno '&lt;&lt;'. </font><font style="vertical-align: inherit;">El operando izquierdo '(- 1)' es negativo.</font></font><br>
<br>
<pre><code class="cpp hljs">decode_mcu_AC_refine (j_decompress_ptr cinfo, JBLOCKROW *MCU_data)<font></font>
{<font></font>
  <span class="hljs-keyword">int</span> p1, m1;<font></font>
  p1 = <span class="hljs-number">1</span> &lt;&lt; cinfo-&gt;Al;    <font></font>
  m1 = (<span class="hljs-number">-1</span>) &lt;&lt; cinfo-&gt;Al; <font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No est√° claro lo que el autor del c√≥digo quer√≠a lograr aqu√≠. </font><font style="vertical-align: inherit;">El uso de operadores de turno con n√∫meros negativos conduce a un comportamiento indefinido. </font><font style="vertical-align: inherit;">La forma en que se describe el comportamiento de los operadores de cambio en el est√°ndar parece un poco confuso a primera vista, pero, sin embargo, verifiquemos: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. El tipo de resultado es el del operando izquierdo promovido. </font><font style="vertical-align: inherit;">El comportamiento es indefinido si el operando derecho es negativo, o mayor o igual que la longitud en bits del operando izquierdo promovido.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. El valor de E1 &lt;&lt; E2 es E1 posiciones de bit E2 desplazadas a la izquierda; los bits vacantes est√°n llenos de cero. Si E1 tiene un tipo sin signo, el valor del resultado es E1 * 2 ^ E2, m√≥dulo reducido uno m√°s que el valor m√°ximo representable en el tipo de resultado. De lo contrario, si E1 tiene un tipo con signo y un valor no negativo, y E1 * 2 ^ E2 es representable en el tipo de resultado, entonces ese es el valor resultante; de lo contrario, el comportamiento es indefinido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, el comportamiento no se define si el operando derecho o izquierdo tiene un valor negativo. Si el operando es de tipo con signo, valor no negativo y se ajusta al tipo resultante, entonces el comportamiento ser√° normal. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N2 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El uso del patr√≥n 'if (A) {...} else if (A) {...}' fue detectado. </font><font style="vertical-align: inherit;">Hay una probabilidad de presencia de error l√≥gico. </font><font style="vertical-align: inherit;">L√≠neas de verificaci√≥n: 156, 160. cameracapturelevelcontrol.cpp 156</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CameraCaptureLevelHistogram::mousePressEvent</span><span class="hljs-params">(QMouseEvent* event)</span> </span>{
  <span class="hljs-keyword">if</span> (event-&gt;button() != Qt::LeftButton) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (m_currentItem == Histogram) {<font></font>
    m_histogramCue = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == None) <span class="hljs-keyword">return</span>;<font></font>
  QPoint pos = event-&gt;pos();<font></font>
  <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_black;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == GammaSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - gammaToHPos(m_gamma, m_black, m_white);<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == BlackSlider)  <span class="hljs-comment">// &lt;=</span><font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_white;<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_currentItem == ThresholdSlider)<font></font>
    m_offset = pos.x() - SIDE_MARGIN - m_threshold;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ a la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_offset se le</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> asignan diferentes valores dependiendo del valor de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sin embargo, duplicar la verificaci√≥n en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BlackSlider no tiene</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sentido, y desde el cuerpo de la condici√≥n puede ver que la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_white</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est√° involucrada en el c√°lculo </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Veamos los valores posibles para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_currentItem</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs">  LevelControlItem m_currentItem;<font></font>
<font></font>
  <span class="hljs-keyword">enum</span> LevelControlItem {<font></font>
    None = <span class="hljs-number">0</span>,<font></font>
    BlackSlider,<font></font>
    WhiteSlider,<font></font>
    GammaSlider,<font></font>
    ThresholdSlider,<font></font>
    Histogram,<font></font>
    NumItems<font></font>
  };</code></pre><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/664/caa/09b/664caa09b6eca7a582ae4441c232e61e.png" alt="image3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resulta que el valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WhiteSlider</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tambi√©n es </font><i><font style="vertical-align: inherit;">posible</font></i><font style="vertical-align: inherit;"> , para lo cual la verificaci√≥n simplemente no se realiza. </font><font style="vertical-align: inherit;">Por lo tanto, es completamente posible que algunos de los escenarios de comportamiento se hayan perdido debido al error de copiar y pegar. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N3 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El uso del </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">patr√≥n</font></a><font style="vertical-align: inherit;"> 'if (A) {...} else if (A) {...}' fue detectado. </font><font style="vertical-align: inherit;">Hay una probabilidad de presencia de error l√≥gico. </font><font style="vertical-align: inherit;">L√≠neas de verificaci√≥n: 784, 867. tpalette.cpp 784</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPalette::loadData</span><span class="hljs-params">(TIStream &amp;is)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> tagName;
  <span class="hljs-keyword">while</span> (is.openChild(tagName)) {
    <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"version"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">if</span> (....){<font></font>
          ....<font></font>
        }<font></font>
        ....<font></font>
        is.closeChild();<font></font>
        }<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"refImgPath"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"animation"</span>) {<font></font>
      ....<font></font>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"stylepages"</span>) { <span class="hljs-comment">// &lt;=</span>
      <span class="hljs-keyword">int</span> key = <span class="hljs-string">'0'</span>;
      <span class="hljs-keyword">while</span> (!is.eos()) {
        <span class="hljs-keyword">int</span> styleId = <span class="hljs-number">0</span>;<font></font>
        ....<font></font>
      }<font></font>
    } <font></font>
      ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro error similar. </font><font style="vertical-align: inherit;">Aqu√≠, las mismas condiciones tienen cuerpos diferentes, pero ya </font><font style="vertical-align: inherit;">no es </font><font style="vertical-align: inherit;">posible concluir sobre las posibles opciones para el valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tagName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lo m√°s probable es que se haya perdido alguna opci√≥n, y al final tenemos un c√≥digo que nunca se ejecutar√°. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N4 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V547 La</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> expresi√≥n 'chancount == 2' siempre es verdadera. </font><font style="vertical-align: inherit;">psd.cpp 720</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TPSDReader::readImageData</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> chancount)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">1</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) { <span class="hljs-comment">// &lt;= 1</span><font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (depth == <span class="hljs-number">8</span> &amp;&amp; chancount &gt; <span class="hljs-number">1</span>) {<font></font>
    ....<font></font>
    <span class="hljs-keyword">for</span> (....) {
      <span class="hljs-keyword">if</span> (chancount &gt;= <span class="hljs-number">3</span>) {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">4</span>)  <font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (chancount &lt;= <span class="hljs-number">2</span>)  <span class="hljs-comment">// &lt;= 2</span><font></font>
      {<font></font>
        ....<font></font>
        <span class="hljs-keyword">if</span> (chancount == <span class="hljs-number">2</span>) <span class="hljs-comment">// &lt;= 3</span><font></font>
          ....<font></font>
        <span class="hljs-keyword">else</span><font></font>
          ....<font></font>
      }<font></font>
      ....<font></font>
    }<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (m_headerInfo.depth == <span class="hljs-number">8</span> &amp;&amp; chancount == <span class="hljs-number">1</span>) {<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un peque√±o error l√≥gico se desliz√≥ en estas comprobaciones. </font><font style="vertical-align: inherit;">En la prueba bajo el n√∫mero uno, el n√∫mero de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cambio se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compara con 1, y en la prueba n√∫mero 2 se verifica que esta variable sea menor o igual a 2. Como resultado, el √∫nico valor de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cambio</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> posible </font><font style="vertical-align: inherit;">es 2 </font><font style="vertical-align: inherit;">a la condici√≥n bajo el n√∫mero </font><font style="vertical-align: inherit;">3. Este error puede no conducir al funcionamiento incorrecto del programa, pero complica la lectura y comprensi√≥n del c√≥digo. </font><font style="vertical-align: inherit;">Por ejemplo, no est√° claro por qu√© la rama de otra cosa entonces ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, la funci√≥n considerada en este fragmento toma un poco m√°s de 300 l√≠neas de c√≥digo y consiste en tales montones de condiciones y bucles.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/725/c28/39a/725c2839a5774ec76b0143ec64531fda.png" alt="image4.png"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N5 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V614</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variable no inicializada 'precSegmentIndex' utilizada. </font><font style="vertical-align: inherit;">Considere verificar el quinto argumento real de la funci√≥n 'insertBoxCorners'. </font><font style="vertical-align: inherit;">rasterselection.cpp 803</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">TStroke <span class="hljs-title">getIntersectedStroke</span><span class="hljs-params">(TStroke &amp;stroke, TRectD bbox)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> precSegmentIndex, currentSegmentIndex, startSegmentIndex,<font></font>
      precChunkIndex = <span class="hljs-number">-1</span>;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....) {<font></font>
    insertBoxCorners(bbox, points, outPoints, currentSegmentIndex,<font></font>
                     precSegmentIndex);<font></font>
    ....<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insertBoxCorners</span><span class="hljs-params">(...., <span class="hljs-keyword">int</span> currentSegmentIndex, <span class="hljs-keyword">int</span> precSegmentIndex)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> sameIndex = (precSegmentIndex == currentSegmentIndex);<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> segmentIndex = precSegmentIndex;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quiz√°s, se cometi√≥ un error aqu√≠ incluso al inicializar las variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">currentSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">startSegmentIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">precChunkIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">El desarrollador podr√≠a esperar que la inicializaci√≥n del √∫ltimo elemento -1 se inicialice con el mismo valor que otras variables declaradas en la misma l√≠nea. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N6 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V590</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Considere la posibilidad de inspeccionar la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">expresi√≥n</font></a><font style="vertical-align: inherit;"> 's! = "" &amp;&amp; s == "color"'. </font><font style="vertical-align: inherit;">La expresi√≥n es excesiva o contiene un error de imprenta. </font><font style="vertical-align: inherit;">cleanupparameters.cpp 416</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CleanupParameters::loadData</span><span class="hljs-params">(TIStream &amp;is, <span class="hljs-keyword">bool</span> globalParams)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> s = is.getTagAttribute(<span class="hljs-string">"sharpness"</span>);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"lineProcessing"</span>)<font></font>
    ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s)) <font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; isDouble(s))<font></font>
      ....<font></font>
    <span class="hljs-keyword">if</span> (s != <span class="hljs-string">""</span> &amp;&amp; s == <span class="hljs-string">"color"</span>) <span class="hljs-comment">// &lt;=</span><font></font>
      ....<font></font>
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tagName == <span class="hljs-string">"despeckling"</span>) {<font></font>
    ....  <font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este error, incluso m√°s bien un defecto, en s√≠ mismo solo conduce a una comparaci√≥n innecesaria. </font><font style="vertical-align: inherit;">Sin embargo, si miramos el c√≥digo como un todo, quedar√° claro que la comparaci√≥n adicional apareci√≥ como resultado de copiar y pegar de las condiciones anteriores.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bcc/077/857/bcc077857a8341d45e6fcf504129353c.png" alt="image5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tales fideos, que ocupan docenas o m√°s l√≠neas de c√≥digo, pueden contener cualquier otro error l√≥gico, y su b√∫squeda con este formato puede convertirse en un tormento. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N7 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V772</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Llamar a un operador 'eliminar' para un puntero nulo causar√° un comportamiento indefinido. </font><font style="vertical-align: inherit;">pluginhost.cpp 1327</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ el mensaje del analizador en s√≠ mismo es bastante exhaustivo: llamar al operador de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eliminaci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en un puntero a un tipo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nulo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conduce a un comportamiento indefinido. </font><font style="vertical-align: inherit;">Si se necesitara una funci√≥n universal para eliminar las interfaces, podr√≠a valer la pena convertirla en un repetitivo.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;class T&gt;
<span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">release_interface</span><span class="hljs-params">(T *interf)</span> </span>{
  <span class="hljs-keyword">if</span> (interf) <span class="hljs-keyword">delete</span> interf;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N8 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es extra√±o que el operador 'sizeof ()' eval√∫e el tama√±o de un puntero a una clase, pero no el tama√±o del objeto de clase 'm_xshHandle'. </font><font style="vertical-align: inherit;">tstageobjectcmd.cpp 455</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DVAPI</span> <span class="hljs-title">TStageObjectParams</span> {</span><font></font>
  ....<font></font>
};<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemovePegbarNodeUndo</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> TUndo {<font></font>
  ....<font></font>
  TXsheetHandle *m_xshHandle;<font></font>
<font></font>
<span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(m_xshHandle);<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> error </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">bastante com√∫n</font></a><font style="vertical-align: inherit;"> que puede ocurrir tanto por falta de atenci√≥n como por ignorancia. </font><font style="vertical-align: inherit;">Aqu√≠, lo m√°s probable, el asunto fue la falta de atenci√≥n, ya que en el primer t√©rmino, </font><font style="vertical-align: inherit;">sin embargo, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esto</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fue desreferenciado. </font><font style="vertical-align: inherit;">Si necesita el tama√±o de un objeto, siempre debe recordar que el puntero de un objeto debe estar desreferenciado. </font><font style="vertical-align: inherit;">De lo contrario, solo obtendremos el tama√±o del puntero.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> <span class="hljs-keyword">sizeof</span> *<span class="hljs-keyword">this</span> + <span class="hljs-keyword">sizeof</span>(TStageObjectParams) + <span class="hljs-keyword">sizeof</span>(*m_xshHandle);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N9 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V568</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es extra√±o que el operador 'sizeof ()' eval√∫e el tama√±o de un puntero a una clase, pero no el tama√±o del objeto de clase 'this'. </font><font style="vertical-align: inherit;">shaderfx.cpp 107</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RectF</span> {</span>
  GLfloat m_val[<span class="hljs-number">4</span>];<font></font>
  ....<font></font>
  <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>==(<span class="hljs-keyword">const</span> RectF &amp;rect) <span class="hljs-keyword">const</span> {
    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);<font></font>
  }<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y aqu√≠, obviamente, se olvidaron de desreferenciar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puntero </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Como resultado, no obtenemos el tama√±o del objeto, sino el tama√±o del puntero. </font><font style="vertical-align: inherit;">Como resultado, solo se comparan los primeros 4 u 8 bytes (dependiendo de la profundidad de bits). </font><font style="vertical-align: inherit;">La versi√≥n correcta del c√≥digo:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">return</span> (<span class="hljs-built_in">memcmp</span>(m_val, rect.m_val, <span class="hljs-keyword">sizeof</span>(*<span class="hljs-keyword">this</span>)) == <span class="hljs-number">0</span>);</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N10 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V554</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uso incorrecto de unique_ptr. </font><font style="vertical-align: inherit;">La memoria asignada con 'nuevo []' se limpiar√° utilizando 'eliminar'. </font><font style="vertical-align: inherit;">screensavermaker.cpp 29</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeScreenSaver</span><span class="hljs-params">(TFilePath scrFn, TFilePath swfFn,
                     <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> screenSaverName)</span> </span>{
  <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">stat</span> <span class="hljs-title">results</span>;</span><font></font>
....<font></font>
  <span class="hljs-keyword">int</span> swfSize = results.st_size;
  <span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;<span class="hljs-keyword">char</span>&gt; <span class="hljs-title">swf</span><span class="hljs-params">(<span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[swfSize])</span></span>;<font></font>
....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A menudo se olvida que el tipo de instancia de unique_ptr depende de si se usar√° delete o delete []. Como resultado, si crea una instancia del puntero como en el fragmento en consideraci√≥n, mientras asigna memoria a trav√©s de un nuevo [], puede producirse un comportamiento indefinido, ya que la liberaci√≥n se producir√° mediante la eliminaci√≥n. Para evitar esto, debe agregar corchetes al tipo de puntero: std :: unique_ptr &lt;char []&gt;. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N11 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V521</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Estas expresiones que usan el operador ',' son peligrosas. Aseg√∫rese de que la expresi√≥n 'm_to, m_from = it-&gt; first.getNumber ()' sea correcta. flipbook.cpp 509</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadImagesPopup</span> <span class="hljs-title">final</span> :</span> <span class="hljs-keyword">public</span> FileBrowserPopup {<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> m_from, m_to, ....;<font></font>
  ....<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LoadImagesPopup::onFilePathClicked</span><span class="hljs-params">(....)</span> </span>{<font></font>
  TLevel::Iterator it;<font></font>
  ....<font></font>
  it = level-&gt;begin();<font></font>
  m_to, m_from = it-&gt;first.getNumber();  <span class="hljs-comment">// &lt;=</span>
  <span class="hljs-keyword">for</span> (; it != level-&gt;end(); ++it) m_to = it-&gt;first.getNumber();<font></font>
<font></font>
  <span class="hljs-keyword">if</span> (m_from == <span class="hljs-number">-2</span> &amp;&amp; m_to == <span class="hljs-number">-2</span>) m_from = m_to = <span class="hljs-number">1</span>;<font></font>
<font></font>
  m_minFrame = m_from;<font></font>
  m_maxFrame = m_to;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quiz√°s el programador esperaba que pudieras asignar un valor a varias variables simplemente escribi√©ndolas con una coma. Sin embargo, el operador "," en C ++ funciona de manera diferente. En √©l, se ejecuta el primer operando y el resultado se "restablece", luego se calcula el segundo operando. Y, aunque la variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to se</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inicializa en un ciclo posterior, si algo sale mal o alguien refactoriza incorrectamente, es posible que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no reciba un valor. Y en general, en cualquier caso, este c√≥digo parece extra√±o. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N12 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V532</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Considere inspeccionar la declaraci√≥n del patr√≥n '* puntero ++'. Probablemente significaba: '(* puntero) ++'. trop.cpp 140</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>, <span class="hljs-title">class</span> <span class="hljs-title">Q</span>&gt;
<span class="hljs-title">void</span> <span class="hljs-title">doGammaCorrect</span>(<span class="hljs-title">TRasterPT</span>&lt;T&gt; <span class="hljs-title">raster</span>, <span class="hljs-title">double</span> <span class="hljs-title">gamma</span>) {</span>
  <span class="hljs-function">Gamma_Lut&lt;Q&gt; <span class="hljs-title">lut</span><span class="hljs-params">(....)</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword">int</span> j;
  <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>; j &lt; raster-&gt;getLy(); j++) {<font></font>
    T *pix    = raster-&gt;pixels(j);<font></font>
    T *endPix = pix + raster-&gt;getLx();<font></font>
    <span class="hljs-keyword">while</span> (pix &lt; endPix) {<font></font>
      pix-&gt;r = lut.m_table[pix-&gt;r];<font></font>
      pix-&gt;b = lut.m_table[pix-&gt;b];<font></font>
      pix-&gt;g = lut.m_table[pix-&gt;g];<font></font>
      *pix++; <span class="hljs-comment">// &lt;=</span><font></font>
    }<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una peque√±a falla, que puede confundir a√∫n m√°s a la persona que lee el c√≥digo. El incremento, seg√∫n lo previsto, desplaza el puntero. Sin embargo, despu√©s de esto hay una desreferenciaci√≥n sin sentido. Es mejor simplemente escribir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pix ++</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N13 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V773</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se sali√≥ de la funci√≥n sin soltar el puntero 'autoCloseUndo'. Una p√©rdida de memoria es posible. vectortapetool.cpp 575</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">joinLineToLine</span><span class="hljs-params">(....)</span> </span>{<font></font>
  ....<font></font>
  UndoAutoclose *autoCloseUndo = <span class="hljs-number">0</span>;<font></font>
  ....<font></font>
  autoCloseUndo = <span class="hljs-keyword">new</span> UndoAutoclose(....);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (pos &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<font></font>
  ....<font></font>
  TUndoManager::manager()-&gt;add(autoCloseUndo);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hubo m√°s de 20 advertencias de este tipo. A menudo, en alg√∫n lugar al final de la funci√≥n, se libera la memoria, pero para el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anterior </font><font style="vertical-align: inherit;">se omite este paso necesario. Entonces est√° aqu√≠. Al final, el puntero se pasa a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TUndoManager :: manager () -&gt; add ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que se encarga de eliminar el puntero, pero hay un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anterior </font><font style="vertical-align: inherit;">por el que olvid√≥ llamar a este m√©todo. Por lo tanto, siempre vale la pena recordar sus punteros cada vez que salga de la funci√≥n, y no solo ingrese la eliminaci√≥n en alg√∫n lugar al final del bloque o antes del √∫ltimo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorno</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, si para una versi√≥n abreviada del c√≥digo este error parece obvio, entonces en un c√≥digo real y m√°s complicado, rastrear tal problema puede ser dif√≠cil. Aqu√≠ el analizador est√°tico siempre cansado ayudar√°. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N14 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V522</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Puede tener lugar la desreferenciaci√≥n de la 'regi√≥n' de puntero nulo. palettecmd.cpp 94</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">isStyleUsed</span><span class="hljs-params">(<span class="hljs-keyword">const</span> TVectorImageP vi, <span class="hljs-keyword">int</span> styleId)</span> </span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">int</span> regionCount = vi-&gt;getRegionCount();
  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; regionCount; i++) {<font></font>
    TRegion *region = vi-&gt;getRegion(i);<font></font>
    <span class="hljs-keyword">if</span> (region || region-&gt;getStyle() != styleId) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ podemos suponer que el desarrollador mezcl√≥ las reglas de la evaluaci√≥n de cortocircuito y pens√≥ que si la primera comprobaci√≥n del puntero devuelve </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falso</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no se eliminar√° la referencia de dicho puntero nulo. Sin embargo, para el operador "||" Es todo lo contrario. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmento N15 </font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Probablemente sea mejor asignar valor a la variable 'ca' que declararlo de nuevo. Declaraci√≥n anterior: xshcellmover.cpp, l√≠nea 319. xshcellmover.cpp 323 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V561</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Probablemente sea mejor asignar valor a la variable 'cb' que declararlo de nuevo. Declaraci√≥n previa: xshcellmover.cpp, l√≠nea 320. xshcellmover.cpp 324xshcellmover.cpp 323</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">redo</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">override</span> </span>{
  <span class="hljs-keyword">int</span> ca       = m_cellsMover.getStartPos().x;
  <span class="hljs-keyword">int</span> cb       = m_cellsMover.getPos().x;<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (!m_cellsMover.getOrientation()-&gt;isVerticalTimeline()) {
    <span class="hljs-keyword">int</span> ca = m_cellsMover.getStartPos().y;
    <span class="hljs-keyword">int</span> cb = m_cellsMover.getPos().y;<font></font>
  }<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (ca != cb) {<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quiz√°s otro copiar y pegar, pero con una esencia no muy com√∫n del error. La llamada a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fue reemplazada por </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero se olvidaron de eliminar el tipo de la variable al comienzo de la l√≠nea, debido a lo cual ocurre la notificaci√≥n local. Como resultado, en lugar de cambiar la orientaci√≥n de posici√≥n para el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inicial </font><font style="vertical-align: inherit;">, </font><i><font style="vertical-align: inherit;">se crean</font></i><font style="vertical-align: inherit;"> nuevos </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> locales </font><font style="vertical-align: inherit;">, con lo cual no sucede nada m√°s. Pero </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ca</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> externos </font><font style="vertical-align: inherit;">siguen existiendo con valores para </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n N1</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el proceso de escribir el art√≠culo, me result√≥ interesante tocar e intentar hacer algo en este programa. </font><font style="vertical-align: inherit;">Tal vez tuve suerte, pero el comportamiento extra√±o no tarda en llegar: colgar, me muestra la manipulaci√≥n de la tableta despu√©s de la flacidez y la plaza extra√±a pulsando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">las teclas Ctrl + Z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lamentablemente, no pude repetir este comportamiento.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/a67/350/35da67350bc54eb9cbada817d91a04c8.png" alt="image6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero, de hecho, a pesar de este comportamiento e inculcar el h√°bito de presionar regularmente </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + S</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , OpenToonz impresiona con su escala y funcionalidad. </font><font style="vertical-align: inherit;">A√∫n as√≠, no es en vano que los grandes estudios tambi√©n lo usen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y mi arte como extra:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e88/a95/8e3/e88a958e3dd8c85b3894de88f140b7e0.gif" alt="image7.gif"></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n N2</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En el caso de OpenToonz, es obvio que tratar de corregir todos los errores detectados por el analizador a la vez ser√° una gran tarea que detendr√° el proceso de desarrollo. </font><font style="vertical-align: inherit;">Para tales casos, existe el enfoque de ‚ÄúSupresi√≥n masiva‚Äù, cuando la deuda t√©cnica se ingresa en la base supresora del analizador y el trabajo adicional con el analizador se lleva a cabo sobre la base de nuevas respuestas. </font><font style="vertical-align: inherit;">Bueno, si aparece el tiempo, puede resolver la deuda t√©cnica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PD: Les recuerdo que los desarrolladores de proyectos de c√≥digo abierto pueden usar la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opci√≥n de licencia gratuita PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Si desea compartir este art√≠culo con una audiencia de habla inglesa, utilice el enlace de traducci√≥n: Victoria Khanieva. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">OpenToonz</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es494202/index.html">Ranking de los distritos de Mosc√∫ por precio de alquiler con Python</a></li>
<li><a href="../es494204/index.html">Bloc de notas con osciloscopio y generador de frecuencia (tarjeta de sonido)</a></li>
<li><a href="../es494206/index.html">Los problemas biol√≥gicos de la correcci√≥n de errores.</a></li>
<li><a href="../es494210/index.html">Instalar Ubuntu en Microsoft Surface Pro</a></li>
<li><a href="../es494214/index.html">C√≥mo el coronavirus ayuda a los gigantes de TI a conquistar el mundo</a></li>
<li><a href="../es494222/index.html">¬øHas dejado de trabajar en cuarentena?</a></li>
<li><a href="../es494224/index.html">Todos los caminos conducen a Fullstack</a></li>
<li><a href="../es494226/index.html">Posici√≥n acordada</a></li>
<li><a href="../es494228/index.html">Impresi√≥n 3D en la creaci√≥n del Boeing 777</a></li>
<li><a href="../es494230/index.html">AI vs. COVID-19: Experiencia Hubei y Florida</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>