<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👉🏼 🤹🏻 🙏🏻 Avalonia UI動物園プラットフォームとの戦いへの小さな貢献 ☎️ 👩🏿‍✈️ 👨🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="この記事は、PVS-Studio静的アナライザーを使用してAvalonia UIプロジェクトをチェックした結果です。Avalonia UIは、オープンソースのクロスプラットフォームXAMLベースのユーザーインターフェイスプラットフォームです。これは、.NETの歴史の中で技術的に重要なプロジェクトの1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Avalonia UI動物園プラットフォームとの戦いへの小さな貢献</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/481598/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e34/9b1/06a/e349b106a7c1d3ea775353520b20cd91.png" alt="図2"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は、PVS-Studio静的アナライザーを使用してAvalonia UIプロジェクトをチェックした結果です。</font><font style="vertical-align: inherit;">Avalonia UIは、オープンソースのクロスプラットフォームXAMLベースのユーザーインターフェイスプラットフォームです。</font><font style="vertical-align: inherit;">これは、.NETの歴史の中で技術的に重要なプロジェクトの1つであり、WPFシステムに基づいてクロスプラットフォームインターフェイスを作成することができます。</font><font style="vertical-align: inherit;">この記事が、著者がいくつかのエラーを修正し、将来的に静的アナライザーを使用するように説得するのに役立つことを願っています。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avalonia UIについて</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avalonia UIプロジェクト（以前はPerspexと呼ばれていました）は、Windows、Linux、およびMacOSで実行されるユーザーインターフェイスを作成する機能を提供します。現在、AndroidとiOSの実験的なサポートもあります。 Avalonia UIはラッパーのラッパーではありませんが、ネイティブAPIを指します。 XamarinラッパーをラップするXamarinフォームとは異なります。デモビデオの1つで、Debianコンソールを制御できる機能に驚かされました。さらに、XAMLマークアップを使用しているため、このプロジェクトでは、従来のインターフェースデザイナーよりも多くのレイアウトとデザインの機能が提供されます。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Avalonia</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
UIをすでに使用しているプロジェクトには、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AvalonStudio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（C＃およびC / C ++で開発するためのクロスプラットフォームIDE）および</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Core2Dが含まれます</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（2Dスキームとダイアグラムのエディター）。</font><font style="vertical-align: inherit;">商用プロジェクトとして、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wasabi Wallet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Bitcoin Wallet）を</font><font style="vertical-align: inherit;">お持ちいただけます</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
クロスプラットフォームアプリケーションを作成するときに、いくつかの異なるライブラリを用意する必要性との闘いは非常に重要です。</font><font style="vertical-align: inherit;">私たちはプロジェクトを手伝いたかったので、プロジェクトをダウンロードして、アナライザーで確認しました。</font><font style="vertical-align: inherit;">著者がこの記事に注意を払い、コードに必要な変更を加えるか、開発プロセスに定期的な静的分析を導入することを願っています。</font><font style="vertical-align: inherit;">これを行うには、オープンソースプロジェクト用のPVS-Studioの無料ライセンスオプションを利用できます。</font><font style="vertical-align: inherit;">静的アナライザーを定期的に使用すると、多くの問題を回避し、多くのエラーを検出して修正するコストを削減できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">検証結果</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3001</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '^'演算子の左側と右側に同一のサブ式 '統制フラグ'があります。</font><font style="vertical-align: inherit;">WindowImpl.cs 975TwitterClientMessageHandler.cs 52</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateWMStyles</span>(<span class="hljs-params">Action change</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> style = (WindowStyles)GetWindowLong(....);<font></font>
  ....<font></font>
  style = style | controlledFlags ^ controlledFlags;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のC＃診断から象徴的に始めます。</font><font style="vertical-align: inherit;">アナライザーは、ビット単位のOR演算子の奇妙な使用を検出しました。</font><font style="vertical-align: inherit;">ここで何が起こっているのかを図で説明しましょう：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
式</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-number">1100</span> <span class="hljs-number">0011</span> | <span class="hljs-number">1111</span> <span class="hljs-number">0000</span> ^ <span class="hljs-number">1111</span> <span class="hljs-number">0000</span> </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これに似ています：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-number">1100</span> <span class="hljs-number">0011</span> | <span class="hljs-number">0000</span> <span class="hljs-number">0000</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
排他的OR（ "^"）は、ビットごとのOR（ "|"）よりも優先されます。</font><font style="vertical-align: inherit;">最も可能性が高いのは、ここでは操作の順序が異なることでした。</font><font style="vertical-align: inherit;">この場合、括弧内の最初の式を使用する必要があります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateWMStyles</span>(<span class="hljs-params">Action change</span>)</span><font></font>
{<font></font>
  ....<font></font>
  style = (style | controlledFlags) ^ controlledFlags;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の2つの警告の前に、私は認めなければなりません。誤検知です。</font><font style="vertical-align: inherit;">これは、パブリックAPIである</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TransformToVisual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを使用しているためです</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私たちの場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VisualRootは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">visual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の親です</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">応答を分析したとき、私はこれを理解していませんでした、プロジェクトの著者は記事を書いた後にこれについて私に話しました。</font><font style="vertical-align: inherit;">したがって、この記事で提案されている編集は、実際の転倒に対する保護ではなく、このロジックを破る潜在的な改訂に対する保護です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの戻り値のnull逆参照の可能性があります。</font><font style="vertical-align: inherit;">検査を検討してください：TranslatePoint（...）。</font><font style="vertical-align: inherit;">VisualExtensions.cs 23</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Point <span class="hljs-title">PointToClient</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> IVisual visual, PixelPoint point</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> rootPoint = visual.VisualRoot.PointToClient(point);
  <span class="hljs-keyword">return</span> visual.VisualRoot.TranslatePoint(rootPoint, visual).Value;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小さな方法。</font><font style="vertical-align: inherit;">アナライザは、TranslatePoint呼び出しの結果を逆参照することは安全ではないと考えています。</font><font style="vertical-align: inherit;">このメソッドを見てください：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Point? TranslatePoint(<span class="hljs-keyword">this</span> IVisual visual,<font></font>
                                    Point point,<font></font>
                                    IVisual relativeTo)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> transform = visual.TransformToVisual(relativeTo);
  <span class="hljs-keyword">if</span> (transform.HasValue)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> point.Transform(transform.Value);<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が返され</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドには6つの呼び出しがあります。</font><font style="vertical-align: inherit;">3つのケースで値がチェックされ、残りの部分ではPVS-Studioが潜在的な逆参照を検出して警告を発行します。</font><font style="vertical-align: inherit;">私は上記の最初のものを引用しました、そして他の二つの警告はここにあります：</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヌル逆参照の可能性があります。</font><font style="vertical-align: inherit;">「p」の検査を検討してください。</font><font style="vertical-align: inherit;">VisualExtensions.cs 35</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヌル逆参照の可能性があります。</font><font style="vertical-align: inherit;">「controlPoint」を調べることを検討してください。</font><font style="vertical-align: inherit;">Scene.cs 176</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様に、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PointToClient</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド内に</font><i><font style="vertical-align: inherit;">Nullable &lt;Struct&gt; .HasValue</font></i><font style="vertical-align: inherit;">チェックを</font><font style="vertical-align: inherit;">追加</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">ことで</font><i><font style="vertical-align: inherit;">修正する</font></i><font style="vertical-align: inherit;">ことを提案し</font><i><font style="vertical-align: inherit;">ます</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></i><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Point <span class="hljs-title">PointToClient</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> IVisual visual, PixelPoint point</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> rootPoint = visual.VisualRoot.PointToClient(point);
  <span class="hljs-keyword">if</span> (rootPoint.HasValue)
    <span class="hljs-keyword">return</span> visual.VisualRoot.TranslatePoint(rootPoint, visual).Value;
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">throw</span> ....;<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの戻り値のnull逆参照の可能性があります。</font><font style="vertical-align: inherit;">調べることを検討してください：TransformToVisual（...）</font><font style="vertical-align: inherit;">ViewportManager.cs 381 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前の例とよく似たケース：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnEffectiveViewportChanged</span>(<span class="hljs-params">TransformedBounds? bounds</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">var</span> transform = _owner.GetVisualRoot().TransformToVisual(_owner).Value;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TransformToVisual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッド</font><font style="vertical-align: inherit;">は次のようになります。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Matrix? TransformToVisual(<span class="hljs-keyword">this</span> IVisual <span class="hljs-keyword">from</span>, IVisual to)<font></font>
{<font></font>
  <span class="hljs-keyword">var</span> common = <span class="hljs-keyword">from</span>.FindCommonVisualAncestor(to);
  <span class="hljs-keyword">if</span> (common != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ちなみに、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FindCommonVisualAncestor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッド</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">、参照型のデフォルト値として</font><font style="vertical-align: inherit;">実際に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">返す</font><i><font style="vertical-align: inherit;">ことができ</font></i><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IVisual <span class="hljs-title">FindCommonVisualAncestor</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> IVisual visual,
                                               IVisual target</span>)</span><font></font>
{<font></font>
  Contract.Requires&lt;ArgumentNullException&gt;(visual != <span class="hljs-literal">null</span>);
  <span class="hljs-keyword">return</span> ....FirstOrDefault();<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TransformToVisual</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッドは</font><font style="vertical-align: inherit;">9か所で使用され、7か所でチェックが行われます。チェックなしで使用するための最初の警告はより高く、最後はここにあります：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能なnull逆参照。 「変換」の検査を検討してください。 MouseDevice.cs 80 </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">式は常に真です。おそらく「&amp;&amp;」演算子をここで使用する必要があります。 NavigationDirection.cs 89</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">IsDirectional</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> NavigationDirection direction</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">return</span> direction &gt; NavigationDirection.Previous ||<font></font>
         direction &lt;= NavigationDirection.PageDown;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奇妙なチェック。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NavigationDirection</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列挙には</font><font style="vertical-align: inherit;">9つのタイプがあり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PageDown</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が最後の</font><font style="vertical-align: inherit;">タイプ</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">おそらくこれは常にそうであるとは限らなかった、またはそれが新しい紹介オプションの突然の出現に対する保険である。</font><font style="vertical-align: inherit;">ここでは最初のチェックで十分だと思います。</font><font style="vertical-align: inherit;">決定はプロジェクトの作者に任せます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告PVS-Studio：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'SelectionChangedEventArgs'コンストラクターに渡される引数の順序が誤っている可能性があります： 'removedSelectedItems'および 'addedSelectedItems'。</font><font style="vertical-align: inherit;">DataGridSelectedItemsCollection.cs 338</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">internal</span> SelectionChangedEventArgs <span class="hljs-title">GetSelectionChangedEventArgs</span>(<span class="hljs-params"></span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SelectionChangedEventArgs<font></font>
    (DataGrid.SelectionChangedEvent,<font></font>
     removedSelectedItems, <font></font>
     addedSelectedItems)<font></font>
      {<font></font>
        Source = OwningGrid<font></font>
      };<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、アナライザーはコンストラクターの2番目と3番目の引数が混乱していることを示唆しています。</font><font style="vertical-align: inherit;">呼び出されたコンストラクタを見てみましょう：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SelectionChangedEventArgs</span>(<span class="hljs-params">RoutedEvent routedEvent, 
                                 IList addedItems, 
                                 IList removedItems</span>)
    : <span class="hljs-title">base</span>(<span class="hljs-params">routedEvent</span>)</span><font></font>
{<font></font>
  AddedItems = addedItems;<font></font>
  RemovedItems = removedItems;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
タイプ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IListの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2つのコンテナー</font><i><font style="vertical-align: inherit;">が</font></i><font style="vertical-align: inherit;">受け入れられ</font><font style="vertical-align: inherit;">、簡単に混合できます。</font><font style="vertical-align: inherit;">クラスの最初のコメントから判断すると、これはMicrosoftからコピーされ、Avaloniaで変更された制御コードのエラーです。</font><font style="vertical-align: inherit;">しかし、メソッドの引数の順序を修正することは価値があるように思えます。少なくとも、バグレポートが届いたときに自分でエラーの可能性を探す必要はありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザは、さらに3個の同様のエラーが見つかりました：</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-スタジオ</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">：</font></b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">V3066</font></a><font style="vertical-align: inherit;">「SelectionChangedEventArgs」コンストラクタに渡される引数の可能性のある不適切な順序：「を削除」と「追加します」。</font><font style="vertical-align: inherit;">AutoCompleteBox.cs 707</font></font><br>
<br>
<pre><code class="cs hljs">OnSelectionChanged(<span class="hljs-keyword">new</span> SelectionChangedEventArgs(SelectionChangedEvent, <font></font>
                                                 removed, <font></font>
                                                 added));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同じコンストラクターの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SelectionChangedEventArgs。</font></font></i> <br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066警告</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'ItemsRepeaterElementIndexChangedEventArgs'コンストラクターに渡される引数の順序が誤っている可能性があります： 'oldIndex'および 'newIndex'。</font><font style="vertical-align: inherit;">ItemsRepeater.cs 532</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Update'メソッドに渡される引数の順序が誤っている可能性があります： 'oldIndex'および 'newIndex'。</font><font style="vertical-align: inherit;">ItemsRepeater.cs 536</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
イベント呼び出しの1つのメソッドでの2つの操作。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnElementIndexChanged</span>(<span class="hljs-params">IControl element, 
                                    <span class="hljs-keyword">int</span> oldIndex,
                                    <span class="hljs-keyword">int</span> newIndex</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (ElementIndexChanged != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (_elementIndexChangedArgs == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
      _elementIndexChangedArgs = <font></font>
         <span class="hljs-keyword">new</span> ItemsRepeaterElementIndexChangedEventArgs(element, <font></font>
                                                       oldIndex,<font></font>
                                                       newIndex);<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
       _elementIndexChangedArgs.Update(element, oldIndex, newIndex);<font></font>
    }<font></font>
    .....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ItemsRepeaterElementIndexChangedEventArgs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Update</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドの</font><i><font style="vertical-align: inherit;">両方</font></i><font style="vertical-align: inherit;">で、</font><font style="vertical-align: inherit;">引数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oldIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newIndexの順序</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が異なることが</font><i><font style="vertical-align: inherit;">わかりました</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-title">ItemsRepeaterElementIndexChangedEventArgs</span>(<span class="hljs-params">
           IControl element,
           <span class="hljs-keyword">int</span> newIndex, 
           <span class="hljs-keyword">int</span> oldIndex</span>)</span><font></font>
{<font></font>
    Element = element;<font></font>
    NewIndex = newIndex;<font></font>
    OldIndex = oldIndex;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>(<span class="hljs-params">IControl element, <span class="hljs-keyword">int</span> newIndex, <span class="hljs-keyword">int</span> oldIndex</span>)</span><font></font>
{<font></font>
    Element = element;<font></font>
    NewIndex = newIndex;<font></font>
    OldIndex = oldIndex;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、コードはさまざまなプログラマーによって作成されたものであり、1つは何が起こったのか、もう1つは何が起こるのかがより重要</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
です。前のケースと同様に、すぐに編集しないでください。本当にエラーがあるかどうかを確認する必要があります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「then」ステートメントは「else」ステートメントと同等です。</font><font style="vertical-align: inherit;">DataGridSortDescription.cs 235</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span>
  IOrderedEnumerable&lt;<span class="hljs-keyword">object</span>&gt; <span class="hljs-title">ThenBy</span>(<span class="hljs-params">IOrderedEnumerable&lt;<span class="hljs-keyword">object</span>&gt; seq</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (_descending)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer);<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThenBy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
メソッドの非常に興味深い実装</font><font style="vertical-align: inherit;">。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IEnumerable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インターフェイス</font><font style="vertical-align: inherit;">には</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">引数が継承さ</font><i><font style="vertical-align: inherit;">れ</font></i><font style="vertical-align: inherit;">ており、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ThenBy</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドがあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">私はその使用が暗示されていたと思います。</font><font style="vertical-align: inherit;">このような：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span>
  IOrderedEnumerable&lt;<span class="hljs-keyword">object</span>&gt; <span class="hljs-title">ThenBy</span>(<span class="hljs-params">IOrderedEnumerable&lt;<span class="hljs-keyword">object</span>&gt; seq</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (_descending)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> seq.ThenByDescending(o =&gt; GetValue(o), InternalComparer);<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> seq.ThenBy(o =&gt; GetValue(o), InternalComparer);<font></font>
  }<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告PVS-Studio：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">負のインデックス値の可能性があります。</font><font style="vertical-align: inherit;">'index'インデックスの値は-1に達する可能性があります。</font><font style="vertical-align: inherit;">Animator.cs 68</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> T <span class="hljs-title">InterpolationHandler</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> animationTime, T neutralValue</span>)</span><font></font>
{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (kvCount &gt; <span class="hljs-number">2</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (animationTime &lt;= <span class="hljs-number">0.0</span>)<font></font>
    {<font></font>
      ....<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (animationTime &gt;= <span class="hljs-number">1.0</span>)<font></font>
    {<font></font>
      ....<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
      <span class="hljs-keyword">int</span> index = FindClosestBeforeKeyFrame(animationTime);<font></font>
      firstKeyframe = _convertedKeyframes[index]; <font></font>
    }<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インデックス</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が値-1を持つことができる</font><font style="vertical-align: inherit;">と信じてい</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">変数は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FindClosestBeforeKeyFrame</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドから取得され</font><font style="vertical-align: inherit;">ます。それを見てください。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">FindClosestBeforeKeyFrame</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> time</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; _convertedKeyframes.Count; i++)
    <span class="hljs-keyword">if</span> (_convertedKeyframes[i].Cue.CueValue &gt; time)
      <span class="hljs-keyword">return</span> i - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"Index time is out of keyframe time range."</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ご覧のように、ループ内で条件がチェックされ、イテレータの以前の値が返されます。</font><font style="vertical-align: inherit;">条件を確認するのは非常に難しく、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CueValueが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何であるか正確に言うことはできません</font><font style="vertical-align: inherit;">が、説明によると、</font><i><font style="vertical-align: inherit;">0.0〜1.0</font></i><font style="vertical-align: inherit;">の値を取ります。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">時間</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について何か言うことができます</font><font style="vertical-align: inherit;">。これは</font><font style="vertical-align: inherit;">、呼び出しメソッドからの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">animationTime</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。これは</font><font style="vertical-align: inherit;">、確実にゼロより大きく1未満です。</font><font style="vertical-align: inherit;">そうでなければ、プログラムは別のブランチに行きます。</font><font style="vertical-align: inherit;">これらがアニメーションをレンダリングするために呼び出されるメソッドである場合、状況は浮動バグのように見えます。</font><i><font style="vertical-align: inherit;">FindClosestBeforeKeyFrame</font></i><font style="vertical-align: inherit;">の結果のチェックを追加し</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この場合、特別な扱いが必要です。</font><font style="vertical-align: inherit;">または、最初の要素が他の条件を満たさない場合は、ループから削除します。</font><font style="vertical-align: inherit;">これがどのように機能するのかわからないので、修正の例として2番目のオプションを選択します。</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">FindClosestBeforeKeyFrame</span>(<span class="hljs-params"><span class="hljs-keyword">double</span> time</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; _convertedKeyframes.Count; i++)
    <span class="hljs-keyword">if</span> (_convertedKeyframes[i].Cue.CueValue &gt; time)
      <span class="hljs-keyword">return</span> i - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">"Index time is out of keyframe time range."</span>);<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3117</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンストラクターパラメーター 'phones'は使用されません。</font><font style="vertical-align: inherit;">Country.cs 25</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Country</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> name, 
               <span class="hljs-keyword">string</span> region, 
               <span class="hljs-keyword">int</span> population,                
               <span class="hljs-keyword">int</span> area, 
               <span class="hljs-keyword">double</span> density, 
               <span class="hljs-keyword">double</span> coast, 
               <span class="hljs-keyword">double</span>? migration, 
               <span class="hljs-keyword">double</span>? infantMorality, 
               <span class="hljs-keyword">int</span> gdp, 
               <span class="hljs-keyword">double</span>? literacy, 
               <span class="hljs-keyword">double</span>? phones, 
               <span class="hljs-keyword">double</span>? birth, 
               <span class="hljs-keyword">double</span>? death</span>)</span><font></font>
{<font></font>
  Name = name;<font></font>
  Region = region;<font></font>
  Population = population;<font></font>
  Area = area;<font></font>
  PopulationDensity = density;<font></font>
  CoastLine = coast;<font></font>
  NetMigration = migration;<font></font>
  InfantMortality = infantMorality;<font></font>
  GDP = gdp;<font></font>
  LiteracyPercent = literacy;<font></font>
  BirthRate = birth;<font></font>
  DeathRate = death;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザー操作と手動コードレビューの違いの良い例。</font><font style="vertical-align: inherit;">13のコンストラクタ引数、1つは使用されません。</font><font style="vertical-align: inherit;">実際、Visual Studioは未使用の引数も記録しますが、警告の3番目のレベルにあります（多くの場合、無効になっています）。</font><font style="vertical-align: inherit;">この場合、クラスには各引数に13のプロパティがあり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Phonesの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どこにも</font><font style="vertical-align: inherit;">値が</font><font style="vertical-align: inherit;">割り当てられてい</font><font style="vertical-align: inherit;">ないため、これは明らかな間違い</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">編集は当たり前ですが、持ってきません。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ヌル逆参照の可能性があります。</font><font style="vertical-align: inherit;">「tabItem」を調べることを検討してください。</font><font style="vertical-align: inherit;">TabItemContainerGenerator.cs 22</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IControl <span class="hljs-title">CreateContainer</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> item</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> tabItem = (TabItem)<span class="hljs-keyword">base</span>.CreateContainer(item);<font></font>
  tabItem.ParentTabControl = Owner;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateContainer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の呼び出し結果を逆参照することは危険だと考えました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドを見てください：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IControl <span class="hljs-title">CreateContainer</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> item</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> container = item <span class="hljs-keyword">as</span> T;
  <span class="hljs-keyword">if</span> (item == <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
     <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (container != <span class="hljs-literal">null</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span> container;<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">return</span> result;<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは</font><font style="vertical-align: inherit;">、50個のメソッドのチェーンを通じて値を渡す場合でも、変数へ</font><font style="vertical-align: inherit;">の</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の割り当てを確認できます</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ただし、実行がこのスレッドで少なくとも1回実行されるかどうかはわかりません。</font><font style="vertical-align: inherit;">はい、一般的にはできませんでした...メソッドの呼び出しは、オーバーライドされたメソッドと仮想メソッドの間で失われます。</font><font style="vertical-align: inherit;">だから私は追加のチェックで安全であることをお勧めします：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> IControl <span class="hljs-title">CreateContainer</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> item</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">var</span> tabItem = (TabItem)<span class="hljs-keyword">base</span>.CreateContainer(item);
  <span class="hljs-keyword">if</span>(tabItem == <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<font></font>
  tabItem.ParentTabControl = Owner;<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3142</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到達不能コードが検出されました。</font><font style="vertical-align: inherit;">エラーが発生している可能性があります。</font><font style="vertical-align: inherit;">DevTools.xaml.cs 91 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、陰謀を作成するために多くのコードを記述しませんが、すぐに言います。警告は偽です。</font><font style="vertical-align: inherit;">アナライザーは、無条件の例外をスローするメソッド呼び出しを検出しました。</font><font style="vertical-align: inherit;">そこで彼は：</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Load</span>(<span class="hljs-params"><span class="hljs-keyword">object</span> obj</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> XamlLoadException(<span class="hljs-string">$"No precompiled XAML 
     found for <span class="hljs-subst">{obj.GetType()}</span>,
     make sure to specify x:Class and 
     include your XAML file as AvaloniaResource"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドの呼び出しの後にある到達不可能なコードについて、35の警告（！）に注意を向けないようにすることは不可能でした。私はプロジェクトの開発者の一人に尋ねました：それはどのように機能しますか？また、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mono.Cecil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ライブラリを使用して、あるメソッドの呼び出しを他のメソッドの呼び出しに置き換える方法についても教えてくれました</font><font style="vertical-align: inherit;">。 ILコードで直接呼び出しを置き換えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーはこのライブラリーをサポートしていないため、多くの誤検知があるため、このプロジェクトではこの診断を無効にすることをお勧めします。認めるのは少し厄介です。この診断をしたのは私だったのですが...他のツールと同様に、静的分析を構成する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、現在、安全でない型変換に関する診断を開発しています。</font><font style="vertical-align: inherit;">また、タイピング制御がエンジン側で実行されるゲームプロジェクトでは、1,000弱の操作が可能です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio警告：</font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このメソッドが常に1つの同じ値「true」を返すのは奇妙です。</font><font style="vertical-align: inherit;">DataGridRows.cs 412</font></font><br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">ScrollSlotIntoView</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> slot, <span class="hljs-keyword">bool</span> scrolledHorizontally</span>)</span><font></font>
{<font></font>
  <span class="hljs-keyword">if</span> (.....)<font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">if</span> (DisplayData.FirstScrollingSlot &lt; slot<font></font>
         &amp;&amp; DisplayData.LastScrollingSlot &gt; slot)<font></font>
    {<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (DisplayData.FirstScrollingSlot == slot &amp;&amp; slot != <span class="hljs-number">-1</span>)<font></font>
    {<font></font>
      ....<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドは常に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を返し</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">おそらく、シグネチャが作成されてからメソッドの目的が変更されましたが、おそらくこれは誤りです。</font><font style="vertical-align: inherit;">これは、クラスの最初のコメントで判断すると、Microsoftからコピーされたコントロールクラスでもあります。</font><font style="vertical-align: inherit;">私の意見では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataGrid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は通常、最も不安定なコントロールの1つであり、検討する価値があるように思われます。条件を満たさない場合、スクロールを確認する必要がありますか？</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらのエラーの一部は、Avalonia UI開発者自身ではなく、WPFコントロールからコピーされたコードによってプロジェクトに導入されました。ただし、インターフェースのユーザーにとっては、エラーの原因は通常は役割を果たしません。クラッシュまたは誤動作しているインターフェースは、プログラム全体の意見を損ないます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、アナライザーを構成する必要があることを述べましたが、静的分析アルゴリズムの動作原理のために避けられない誤検知があります。</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">停止</font></a><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">問題に</font></a><font style="vertical-align: inherit;">詳しい人</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">彼らは、他のコードを扱うときの数学的制限を認識しています。ただし、この場合、1つの診断をほぼ150から無効にすることについて話している。したがって、静的分析での意味の喪失については触れていません（または、質問は価値がありません）。さらに、この診断は良い反応を示した可能性があり、大量の誤検知の中から見つけるのが難しくなります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
高品質のプロジェクトコードに注意してください。開発者がコードの品質のペースとレベルを維持してくれることを願っています。残念ながら、プロジェクトが大きくなるほど、バグも多くなります。バグを減らすための可能な方法の1つは、静的および動的分析を接続してCI \ CDを正しく構成することです。大規模なプロジェクトでの作業を簡素化し、デバッグに必要な時間を短縮したい場合は、</font><font style="vertical-align: inherit;">PVS-Studioを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ダウンロードして試してください</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a></p><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事を英語を話す視聴者と共有したい場合は、翻訳へのリンクを使用してください：Alexander Senichkin。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Avalonia UIの少ないプラットフォームへの戦いへのわずかな貢献</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja481582/index.html">work＆dev fun（damentals）＃2ソフトスキルは優れています。ただ誰かがそれらを誤解した</a></li>
<li><a href="../ja481584/index.html">チームを管理するときは、すべてのルールを破る</a></li>
<li><a href="../ja481592/index.html">お得な割引付きの運転手向けの6つの新年ギフトオプション</a></li>
<li><a href="../ja481594/index.html">GOST R IEC 61508（IEC 61508）に準拠した「シンプルな電圧発生器」の開発</a></li>
<li><a href="../ja481596/index.html">Mikrotikログ分析のためのELK 7.5設定の解析</a></li>
<li><a href="../ja481600/index.html">Bonsai Family Wiki Engine：2019の結果</a></li>
<li><a href="../ja481604/index.html">過酷なチェリャビンスクの開発者がGoogle Playやソーシャルネットワーク向けのゲームを作る方法</a></li>
<li><a href="../ja481606/index.html">C ++とCortex M4マイクロコントローラーを使用するObserverテンプレートを使用した静的サブスクリプション</a></li>
<li><a href="../ja481610/index.html">PostgreSQLアンチパターン：負荷のかかった大きなテーブルの更新</a></li>
<li><a href="../ja481616/index.html">測地線ドーム。デバイスと私の計算経験について</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>