<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèµÔ∏è üöæ üë∑üèº Use of modern graphic formats in web projects ‚öîÔ∏è üë®üèª‚Äçüè´ üëßüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eddie Osmani, in the article ‚ÄúThe Price of JavaScript in 2018 ‚Äù, voiced one valuable idea: the time required to process a script of 200 KB in size and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Use of modern graphic formats in web projects</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/494710/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eddie Osmani, in the article ‚ÄúThe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Price of JavaScript in 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù, voiced one valuable idea: the time required to process a script of 200 KB in size and to process an image having the same size varies significantly. The fact is that when processing the code, the browser needs to do more extensive work than in preparing for the use of images. Here's what the article says about it:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A JPEG image needs to be decoded, rasterized and displayed. And the JS bundle is necessary, if we consider it simplistically, load, parse, compile, execute. In fact, the engine has to solve other problems in the process of processing JS-code. In general, it should be borne in mind that much more system resources are spent on processing JavaScript code, the size of which, in bytes, is comparable to the size of other materials.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
These words were written in 2018, but they are still more than fair. True, given the current situation, the idea expressed here is perceived today a little differently.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/8f/9m/t0/8f9mt0mjuf4ivefgknhgl8ykpge.png"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Considering that a pandemic has erupted in the world now, I noticed that my Internet connection has become unstable. Fortunately, due to the fact that the Internet is protected by excellent specialists who do not know fatigue, most of the World Wide Web still works fine. But on the Internet, something is definitely happening. I use a 100 Mbps connection, but I get the feeling that I'm sitting on a 3G modem.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This makes some changes to the above reasoning. The fact is that our devices can parse and compile JavaScript at the same speed that they could do it a couple of weeks ago. But data now travels through networks more slowly. As a result, at the moment it is extremely important how much data representing a certain resource is transmitted over the network when this resource is loaded. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And sites usually have much more than 200 KB of images. A page with several megabytes of pictures is usually the case. Many developers (and me too!), As a rule, do not think at all about the size of media materials.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But, which is very good, optimizing the images used on web pages is not so difficult. </font><font style="vertical-align: inherit;">In this article we will talk about how to use modern graphic formats like WebP. </font><font style="vertical-align: inherit;">Images saved in such formats often turn out to be 2-3 times smaller than those for which the old and well-known old formats (like JPG and PNG) are used by everyone. </font><font style="vertical-align: inherit;">The use of new formats can seriously change the situation for the better.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">General overview of modern graphic formats</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To improve the work with web graphics, we can use the following three formats:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPEG 2000 is a format that is an improved version of regular JPG. </font><font style="vertical-align: inherit;">This format was developed in 1997, primarily for use in cinema and in medicine. </font><font style="vertical-align: inherit;">It allows you to compress images stronger than JPEG, but with fewer artifacts.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPEG XR is a format related to JPEG 2000. It was developed by Microsoft in 2009.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebP is a format Google created in 2010 for the web. </font><font style="vertical-align: inherit;">The main goal of its development was to use advanced methods for optimizing images in order to reduce file sizes. </font><font style="vertical-align: inherit;">WebP supports transparency and even animation.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here we will mainly talk about WebP. </font><font style="vertical-align: inherit;">Formats related to JPEG, we will discuss where the issue of browser compatibility will be raised.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How much can you win using alternative graphic formats?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A few months ago, I used the following image in one material.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ebb/257/a61/ebb257a61229023d8aee7651708966c8.jpg"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The image used in one material</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
I conducted some experiments, considering the use of the JPG and PNG formats for storing the original image. </font><font style="vertical-align: inherit;">I optimized image options using</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagemin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in order to find out what WebP can give me instead of these ‚Äúretro‚Äù formats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The results were incredible.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image Features</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Original</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webp</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.Png file (from Photoshop)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">742 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">61 Kb! </font><font style="vertical-align: inherit;">(92% less)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimized .png file (after Imagemin)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">178 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">58 Kb! </font><font style="vertical-align: inherit;">(67% less)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File in .jpg format (from Photoshop)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">242 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 Kb! </font><font style="vertical-align: inherit;">(79% less)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimized file in .jpg format (after imagemin)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">151 Kb</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">50 Kb! </font><font style="vertical-align: inherit;">(67% less)</font></font></td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I conducted similar experiments with many images. </font><font style="vertical-align: inherit;">It almost always turned out that WebP files were 30-70% smaller than even optimized versions of graphic files of other formats. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This may raise the question of how conversion to WebP can affect SVG images. </font><font style="vertical-align: inherit;">I did not conduct such experiments with SVG. </font><font style="vertical-align: inherit;">SVG is a vector format. </font><font style="vertical-align: inherit;">This means that the images in it are built on the basis of mathematical instructions, and not on the basis of information about the color of individual pixels. </font><font style="vertical-align: inherit;">Converting an SVG image to WebP means giving up the ability to scale SVG images, which, I believe, is unacceptable. </font><font style="vertical-align: inherit;">In addition, I suspect that such a conversion, in most cases, will lead to an increase in file sizes.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser compatibility</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To learn about how certain graphic formats are supported by browsers, take a look at </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caniuse.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
WebP format is supported by most browsers.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b8d/e47/094/b8de470941379e70ba194f35566deb05.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Support for WebP format by browsers</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Although the level of support for this format is very high, it‚Äôs very bad that Safari and Internet Explorer do not support it. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And here is information about JPEG 2000 support.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f50/5b6/1e3/f505b61e34cd89c8e5ae6c336396f5ee.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Support for JPEG 2000 format by browsers</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
So, now Safari is on our side, but Internet Explorer is again out of work. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
What about JPEG XR?</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c39/c5c/ba1/c39c5cba1bb76927dee034cd17a893e6.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Support for JPEG XR format by browsers</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
And here Internet Explorer was distinguished. </font><font style="vertical-align: inherit;">As a result, using these three formats, we override all existing browsers (KaiOS Browser does not support any of these formats, and I apologize to him for ignoring him, but I don‚Äôt even know what browser it is ) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now let's talk about how to choose different image formats designed for different browsers.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The picture element to the rescue</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTML has two elements for outputting images. The first can be compared to an international pop star like Madonna. It is </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. And the second is like a new band, known only in narrow circles of music lovers. This is an element </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The element </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">appeared in HTML much later than </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The main goal of this new element is to allow developers to download various graphic resources depending on the screen resolution, or depending on whether the browser supports a certain graphic format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here's what the HTML code that uses the element looks like </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/webp"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.jp2"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/jp2"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.jxr"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"image/vnd.ms-photo"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An element </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">may include many child elements </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and one element </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The browser sequentially parses these elements, selecting, based on the attribute </font></font><code>type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(s </font></font><code>media</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), one of them that can use it. When such an element is found, the browser finds out the address of the image using the attribute </font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and then displays this image using the element </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The attribute </font></font><code>srcset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">has much greater capabilities than the usual one </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but, fortunately, we can consider it as an analogue </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In general, elements </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">are something like settings that correspond to different images. The </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image that best matches the environment in which the page is viewed is included.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Chrome, for example, after processing the above markup, the browser will come to something more or less equivalent to the following code:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using a set of consecutive elements </font></font><code>source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">means that at least one of them will be suitable in each browser. </font><font style="vertical-align: inherit;">So, most browsers use a webp image, Safari will load a jp2 image, IE a jxr image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is appropriate to recall that Internet Explorer does not support the element </font></font><code>picture</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This item is too new for this browser. </font><font style="vertical-align: inherit;">But, despite this, the above markup fragment in IE will work as expected. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The fact is that when the browser stumbles upon an element unknown to it, it considers it as an element </font></font><code>div</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">As a result, when parsing our code, IE sees many elements </font></font><code>div</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as one tag</font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which contains the path to the jxr image. </font><font style="vertical-align: inherit;">And this, as it turns out, is the very format that Internet Explorer supports.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplified alternative</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The above code fragment is extremely good because it allows you to use modern graphic formats in all current browsers. </font><font style="vertical-align: inherit;">But the use of such code is based on the assumption of the existence of those images to which it has links. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you create such images yourself - you have to invest a lot of manual labor in it. </font><font style="vertical-align: inherit;">If you generate them automatically, this can significantly increase the build time of the project. </font><font style="vertical-align: inherit;">Graphics processing, as you know, becomes a very slow process when it comes to a lot of images.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Only very few visitors to my blog use Internet Explorer (in the last 7 days only 3 people with IE tried to view it, which amounted to 0.02% of the traffic). </font><font style="vertical-align: inherit;">Therefore, I decided to use a simplified version of the above solution:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcset</span>=<span class="hljs-string">"/images/cereal-box.webp"</span> /&gt;</span>
&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/cereal-box.jpg"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I give a compact webp image to those browsers that support this format (Chrome, Firefox, Edge), and to browsers that don't support this format (IE, Safari), I offer a legacy of the past - a jpeg image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
From my point of view, this is an example of progressive improvement. </font><font style="vertical-align: inherit;">The project remains operational on older browsers, although loading images takes longer. </font><font style="vertical-align: inherit;">This is a compromise that suits me. </font><font style="vertical-align: inherit;">(True, I hope that WebP support will appear soon in Apple‚Äôs browsers as well).</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verification of the solution</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Developer tools will always assume that the image contains what was originally written to the </font></font><code>src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tag </font><font style="vertical-align: inherit;">attribute </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If you check the item using the tab </font></font><code>Elements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you can see that the page is using a jpg image. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to check the operability of all this, it is best, as it seems to me, to right-click on the picture and select the item </font></font><code>  ‚Ä¶</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In Chrome when the command is executed, the system should offer to save the file with the extension </font></font><code>.webp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">But in Safari it will be a jpeg file. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to find out exactly which graphic file was received from the server when the page was loaded, you can refer to the developer toolbar </font></font><code>Network</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convert image files to WebP format</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google has created a set of tools aimed at working with webp-files. </font><font style="vertical-align: inherit;">One such tool is called </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cwebp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It allows you to convert graphic files of other formats to WebP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are using MacOS, you can install this toolkit using Homebrew:</font></font><br>
<br>
<pre><code class="plaintext hljs">brew install webp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On other platforms, I believe it will be necessary to download the appropriate </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libwebp</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package from the repository. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
After installing the tools, you can use them like this:</font></font><br>
<br>
<pre><code class="plaintext hljs">cwebp -q 80 cereal.png -o cereal.webp
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consider this command:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The flag </font></font><code>-q 80</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allows you to set the image quality. </font><font style="vertical-align: inherit;">Its value varies from 1 (worst quality) to 100 (best). </font><font style="vertical-align: inherit;">You can experiment with different values. </font><font style="vertical-align: inherit;">I found out that it is best to ask something in the region of 70-80.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The file name </font></font><code>cereal.jpg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the original image that needs to be converted to webp.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The construction </font></font><code>-o cereal.webp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sets the path to the output file.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No one wants to waste time typing such commands manually. </font><font style="vertical-align: inherit;">Fortunately, this task can be automated.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using modern image formats in React applications</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A component is a great way to ignore some of the element's oddities </font></font><code>&lt;picture&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">I use React components for this. </font><font style="vertical-align: inherit;">In my opinion, it is very convenient. </font><font style="vertical-align: inherit;">Here's what it looks like:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> ImgWithFallback = ({<font></font>
&nbsp;&nbsp;src,<font></font>
&nbsp;&nbsp;fallback,<font></font>
&nbsp;&nbsp;type = <span class="hljs-string">'image/webp'</span>,<font></font>
&nbsp;&nbsp;...delegated<font></font>
}) =&gt; {<font></font>
&nbsp;&nbsp;<span class="hljs-keyword">return</span> (
&nbsp;&nbsp;&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">picture</span>&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">srcSet</span>=<span class="hljs-string">{src}</span> <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span> /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{fallback}</span> {<span class="hljs-attr">...delegated</span>} /&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag">&lt;/<span class="hljs-name">picture</span>&gt;</span></span><font></font>
&nbsp;&nbsp;);<font></font>
};<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Using the component is </font></font><code>ImgWithFallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">very similar to working with a regular tag </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;ImgWithFallback<font></font>
&nbsp;&nbsp;src=<span class="hljs-string">"/images/cereal.webp"</span>
&nbsp;&nbsp;fallback=<span class="hljs-string">"/images/cereal.png"</span>
&nbsp;&nbsp;alt=<span class="hljs-string">"A photo showing the expiration date on a box of Lucky Charms"</span><font></font>
/&gt;<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The use of modern graphic formats with stylized components</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you use libraries </font></font><code>styled-components</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>emotion</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you may be used to special image design:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> FancyImg = styled.img<span class="hljs-string">`
&nbsp;&nbsp;whatever: stuff;
`</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The very good thing is that it works with our component </font></font><code>ImgWithFallback</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">You can wrap it in the appropriate wrapper just like any other component:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> FancyImg = styled(ImgWithFallback)<span class="hljs-string">`
&nbsp;&nbsp;whatever: stuff;
`</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The reason for the operability of this design is how the auxiliary structure works exactly </font></font><code>styled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It generates a class and embeds it in the document stylesheet. </font><font style="vertical-align: inherit;">Then the name of the generated class is passed to the component as a property:</font></font><br>
<br>
<pre><code class="css hljs">&lt;<span class="hljs-selector-tag">ImgWithFallback</span> <span class="hljs-selector-tag">className</span>="<span class="hljs-selector-tag">sc-some-generated-thing</span>" /&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We delegate all the properties to the child tag </font></font><code>&lt;img&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as a result, the correct styles are applied to the image, as it usually happens. </font><font style="vertical-align: inherit;">Everything works exactly as you might expect.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using the gatsby-image Package</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are using Gatsby, then be aware that the package </font></font><code>gatsby-image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, when used normally, already uses many image optimizations. </font><font style="vertical-align: inherit;">This includes converting images to webp format (although, for this you need to enable the appropriate option). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The package </font></font><code>gatsby-image</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does not claim to be a replacement </font></font><code>img</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Its use may not be so simple, its internal mechanisms can lead to surprises that make life difficult for the developer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
If you are interested in this package, take a look at its </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cons of WebP</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The only real drawback of webp that I managed to find is that it is very inconvenient to work with files of this format. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Most desktop image packages do not yet support it. </font><font style="vertical-align: inherit;">For example, I cannot open webp files in Preview on MacOS. </font><font style="vertical-align: inherit;">This means, let's say that if I save a webp image from a web page, I will not be able to view it on my computer! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Converting webp files to jpeg files is a fairly simple process. </font><font style="vertical-align: inherit;">On the Internet you can find many free services that perform such a conversion. </font><font style="vertical-align: inherit;">But, again, this is not as convenient as working with traditional graphic formats. </font><font style="vertical-align: inherit;">If your site offers users to download graphic files from it, you may decide that you do not need to switch to webp.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summary</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I really like the fact that using webp I was able to reduce the size of the images on my blog by about 50%. In addition to the fact that in our difficult times this improves the user experience of working with him, I also hope that this will allow me to save a little on paying for traffic. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, the idea of ‚Äã‚Äãmanually converting image files to webp format seems quite impractical. I am already studying the question of how to automatically convert jpg and png files to this format. Ideally, this process should occur completely unnoticed by the developer, during the assembly of the site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The creators of web projects are usually not particularly interested in the features of using new image formats. </font><font style="vertical-align: inherit;">But I believe that understanding this issue is very useful. </font><font style="vertical-align: inherit;">After all, using WebP is probably the easiest way to reduce the size of your web project by hundreds of kilobytes. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do you use the WebP format?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en494690/index.html">Artificial Intelligence vs. Coronavirus</a></li>
<li><a href="../en494692/index.html">Painless injections with 4D needles</a></li>
<li><a href="../en494700/index.html">Scenarios of infection in specific cities based on the dataset of movement of people across Russia</a></li>
<li><a href="../en494702/index.html">The digest of fresh materials from the world of the front-end for the last week No. 408 (March 23 - 29, 2020)</a></li>
<li><a href="../en494704/index.html">CMI5, or Life after SCORM</a></li>
<li><a href="../en494712/index.html">5 best practices for using React hooks in production</a></li>
<li><a href="../en494714/index.html">On the positive impact of variable fonts on web project performance</a></li>
<li><a href="../en494716/index.html">All about the auto keyword in CSS</a></li>
<li><a href="../en494718/index.html">News from the world of OpenStreetMap No. 504 (10.03.2020-16.03.2020)</a></li>
<li><a href="../en494720/index.html">My cheat sheet by pandas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>