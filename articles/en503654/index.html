<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ñ üìø üë©‚Äç‚ù§Ô∏è‚Äçüë© Web service that allows users to independently maintain a culture of communication online üêã üç¶ üï°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In previous posts , a new approach to moderating online discussions was proposed, which does not require an appointed moderator or collective voting a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Web service that allows users to independently maintain a culture of communication online</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503654/"><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In previous posts</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a new approach to moderating online discussions was proposed, which does not require an appointed moderator or collective voting and allows users from different sites to organize into a kind of community of moderators. This approach will allow users to control the online communication culture themselves, which will reduce the burden on website owners to moderate comments.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/do/cd/z5/docdz5pwqbzmgy1__p6hs2ceu9s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Readers of Habr were offered a</font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> small test example of a</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commentary tape in which one could try this approach in action.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Thanks to everyone who takes part in testing! </font><font style="vertical-align: inherit;">Already the initial statistics allow us to say that readers confidently perform moderation. </font><font style="vertical-align: inherit;">Now it's time to move on. </font><font style="vertical-align: inherit;">In this post, I want to discuss the simplest possible device for a web service that implements this approach. </font><font style="vertical-align: inherit;">Unfortunately, experience for the implementation of such a task is not enough, therefore, the advice of the Habr community is required.</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What are the current requirements for the web service?</font></font></b> <br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Easy connection of new sites to the web service. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simple basic functions of the moderation API. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the initial stage, it must withstand a load of at least 40-50 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
simultaneously moderating users.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the long run it should not be difficult to scale.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Given these requirements, the web service diagram presented in the figure is still looming. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ra/fc/co/rafccoongouedlxvosem2sq2fhy.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to connect your site to the web service, the site owner will need:</font></font></b> <br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on your </font><b><font style="vertical-align: inherit;">js</font></b><font style="vertical-align: inherit;"> website </font><font style="vertical-align: inherit;">that encapsulates functions for working with the API.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moderate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attribute to the comment input field </font><font style="vertical-align: inherit;">, which the script will focus on. </font><font style="vertical-align: inherit;">After that, when you click on the comment field, a moderation dialog will appear.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moderate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attribute to each comment in the feed </font><font style="vertical-align: inherit;">, which the script will focus on. </font><font style="vertical-align: inherit;">After that, a button will appear next to each comment that brings up the moderation dialog.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the process of its work, the script will use the following functions of the moderation API</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (of course, there will be more functions that should ensure the functioning of the Community, but now we consider only the basic ones):</font></font><br>
<br>
<ul>
<li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetAccessToken</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , IN: api_key. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Request a temporary token for the current check. </font><font style="vertical-align: inherit;">In this token, encrypted on the server side, all the data necessary for the server is stored, allowing the server to identify the current scan and distinguish one scan from another. </font><font style="vertical-align: inherit;">The token has a limited lifetime. </font><font style="vertical-align: inherit;">The site owner must register a unique api_key on the web service, which is included in the token.</font></font><br>
</li>
<li><b>GetChecks</b>, IN: token. OUT:comments_list_for_check,last_comment_check_results <br>
           .     ,      ,            . <br>
</li>
<li><b>SetCheck</b>, IN: token, comments_list_with_result, comment_for_check OUT: true/false <br>
          .        ,   ( )   true        comment_for_check    . <br>
</li>
</ul><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache mod_php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
is currently planned as a web server </font><font style="vertical-align: inherit;">. Pros: it works quickly, requires a minimum of configuration knowledge. As a minus: scripts are executed from a single apache user. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The web service API functions are planned to be executed in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pros: speed of development, cross-platform, acceptable performance. Cons: security (however, it is planned to use version 7, where there are fewer holes) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sphinx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as the base </font><font style="vertical-align: inherit;">. Pros: Easy installation, speed of search and ease of scaling compared to relational db. Minus: the lack of join queries, but this is solved by the correct structure of the database.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So far, it seems that initially all this can be run on an ordinary VPS and thus ensure the work of 40-50 moderating users at the same time. </font><font style="vertical-align: inherit;">If the load increases, then in VPS it will not be difficult to add resources (memory, processor, disk capacity), and if the load on DB Sphinx increases, it will not be difficult to deploy another instance of Sphinx. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Questions:</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
What can be the "pitfalls" in this implementation? </font><font style="vertical-align: inherit;">And what technologies would you use to implement the simplest version of such a web service?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thank you for the attention !</font></font></h2></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en503638/index.html">6 useful habits that, surprisingly, only a few programmers have</a></li>
<li><a href="../en503642/index.html">How to get on LinkedIn, Facebook, Google in Silicon Valley</a></li>
<li><a href="../en503648/index.html">What does the output of "ss -s" mean</a></li>
<li><a href="../en503650/index.html">VKCup 2020 Stage I. A Long Way</a></li>
<li><a href="../en503652/index.html">Digital events in Moscow from May 25 to May 31</a></li>
<li><a href="../en503656/index.html">The band suppression algorithm in the image as a tool for improving the quality of tomographic reconstruction</a></li>
<li><a href="../en503660/index.html">Test projects without pain. Yandex Report</a></li>
<li><a href="../en503662/index.html">NEW - VoIP Phone Snom D335</a></li>
<li><a href="../en503666/index.html">Startup and Business Course Translation from Stanford University. Lecture number 1. How to start a startup</a></li>
<li><a href="../en503668/index.html">Circle Squared: Visual Evidence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>