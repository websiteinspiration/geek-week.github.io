<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèΩ üéº üóëÔ∏è Windows gegen Sysmon ‚è¨ üíö üóûÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auf der letzten ZeroNights-Konferenz wurde uns im Rahmen der informellen Kommunikation mit unseren Kollegen im √úberwachungssystem auf den ersten Blick...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows gegen Sysmon</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489050/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/x6/_z/yyx6_zfwsrw0m-c8zx_yr5bimqs.jpeg"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auf der letzten ZeroNights-Konferenz wurde uns im Rahmen der informellen Kommunikation mit unseren Kollegen im √úberwachungssystem auf den ersten Blick eine einfache Frage gestellt. Es wurde allgemein angenommen, dass Sysmon verwendet werden sollte, um den Endpunkt unter Windows vollst√§ndig zu √ºberwachen. Ist das so? </font><font style="vertical-align: inherit;">Und wenn ja, aus welchen besonderen Gr√ºnden (Hallo Seryozha!)? </font><font style="vertical-align: inherit;">Wir konnten keine eindeutige umfassende Antwort in unserem Wissensgep√§ck oder einen entsprechenden Vergleich im Internet finden, daher haben wir uns zun√§chst f√ºr uns selbst und nicht zuletzt, damit auch in Zukunft eine solche Quelle von der Community verf√ºgbar sein wird, entschlossen, dieses Thema zu untersuchen und vergleichen Sie die pers√∂nlichen Ereignisse von Windows und Sysmon. </font><font style="vertical-align: inherit;">Wie das Sprichwort sagt: "1 ... 2 ... 3 ... Kampf!".</font></font><a name="habracut"></a></p><br>
<a name="stage1"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jeder Spezialist auf dem Gebiet der Informationssicherheit ist gezwungen, innerhalb eines bestimmten Rahmens zu arbeiten. Zum Beispiel ist Sicherheit innerhalb eines begrenzten Budgets mit seltenen Ausnahmen nicht die Hauptmethode f√ºr ein Unternehmen, um Gewinne zu erzielen oder andere Funktionen innerhalb seines Kerngesch√§fts auszuf√ºhren. Daher wird unter Bedingungen begrenzter Ressourcen, √ºber die die Organisation verf√ºgt, h√§ufig nur ein kleiner Teil davon dem Sicherheitssektor zugewiesen, um diese Richtung auf einem Mindestma√ü (entsprechend bestimmten Anforderungen) zu halten. Selbst mit unbegrenzten Ressourcen wird es immer andere Einschr√§nkungen geben, die es nicht erlauben, das Sicherheitsniveau auf das Absolute zu bringen. Dies sind die ber√ºchtigten Schwachstellen von Zero oder Normal Day (endloses Patch-Management) und das st√§ndige Wettr√ºsten von Hackern und Sicherheitsleuten.und die Dynamik der Entwicklung der IT-Infrastruktur und vieles mehr.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor diesem Hintergrund ist die Frage der Priorisierung von Schutzmitteln und -methoden mehr denn je dringend, auch in Richtung √úberwachung. In diesem Bereich, laut Statistik auf der Basis der Daten der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MITRE ATT &amp; CK</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Matrix </font><font style="vertical-align: inherit;">, die wir bereits </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ºber letztes Mal, sind die Priorit√§ten wie folgen: die unbedingte erste Linie durch eine </font><font style="vertical-align: inherit;">solche genommen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle von Sicherheitsereignissen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als Endpunkte.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/9p/it/hr9piteihbc4qv4qgsff55qu2iq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Quelle f√ºhrt zu der Anzahl von Matrixtechniken, die anhand der darauf aufgezeichneten Ereignisse identifiziert werden k√∂nnen. Das am h√§ufigsten verwendete Betriebssystem f√ºr Endpunkte ist Microsoft Windows. Wenn Sie in den meisten Unternehmensinfrastrukturen genau die Protokolle erfassen, erzielen Sie das beste Ergebnis im Verh√§ltnis aller Arten von Kosten zur Abdeckung von Netzwerkger√§ten und zur Abdeckung b√∂sartiger Techniken. Dies wird durch die Statistiken derselben Autoren best√§tigt. Die Orte 1-3, 5, 7, 8, 10 und Teil 4 besetzen genau diese sogenannten Grundereignisse.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/7q/7o/gh7q7otidvmpw_ibo6fqnaxmsuw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber wie im ber√ºhmten Witz gibt es eine Einschr√§nkung. In den letzten Jahren wurde allgemein anerkannt, dass Windows-Protokolle durch Sysmon-Ereignisse erg√§nzt, wenn nicht ersetzt werden m√ºssen. Sie sagen, dass sie unter dem Gesichtspunkt der Informationssicherheit vollst√§ndiger, besser und als √úberwachungstool besser angepasst sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dar√ºber hinaus entspricht dieser Ansatz in gewisser Weise dem Konzept des Minimalismus. Jedes Softwareprodukt, das Sie zu Ihrem eigenen hinzuf√ºgen m√∂chten oder das Ihnen von einem Unternehmenskunden freiwillig zur Verf√ºgung gestellt wird, erh√∂ht den Angriffsbereich, die Verwaltungs- und Aktualisierungskosten sowie die Fehlerquellen. Und oft - und genau die Zeit vor der Implementierung Ihres √úberwachungssystems, w√§hrend Ihr Ansatz die Genehmigung besteht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon wurde von Microsoft-Spezialisten entwickelt und k√ºrzlich von diesem Unternehmen √ºbernommen, was der IT ein gewisses Ma√ü an Vertrauen verleiht. Dar√ºber hinaus werden die Protokolle in Form eines .evtx-Protokolls geschrieben, mit dem Sie sie mit denselben Tools und Methoden wie normale Windows-Protokolle erfassen und verarbeiten k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Machen Sie sofort einen Vorbehalt, dass sich der Artikel als gro√ü herausstellte, obwohl wir versucht haben, das Material minimal zu duplizieren und zu komprimieren. Der Leser kann nat√ºrlich sagen und uns auf diesen Witz √ºber Lenin verweisen: "Aber er h√§tte aufgeschlitzt ...". Oder dass "die Ver√∂ffentlichung zur besseren Lesbarkeit in zwei oder drei Teile unterteilt werden k√∂nnte". Es schien uns jedoch, dass wir trotz des Umfangs des vorbereiteten Materials eine vollst√§ndige Antwort auf die Frage unserer Kollegen im Gesch√§ft geben m√ºssen, und die Suche w√§re bequemer. Um nichts zu verlieren, empfehlen wir Ihnen, den Artikel 1 Mal vollst√§ndig zu lesen, sich Notizen zu machen und erst dann zu bestimmten Ereignisgruppen zur√ºckzukehren und sich eingehend mit diesen zu befassen.</font></font><br>
<br>
<a name="stage2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Einfachheit halber</font></a><font style="vertical-align: inherit;"> f√ºgen wir ein Inhaltsverzeichnis hinzu: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einf√ºhrung </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inhaltsverzeichnis </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichsformat </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen eines Prozesses </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerkverbindungen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beenden eines Prozesses </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herunterladen eines Treibers </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zugreifen auf einen Prozess </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen einer Datei </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registrierungsaktionen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WMI-Konfiguration </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS-Abfragen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einzigartige Sysmon- </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ereignisse Filtern von Ereignissen </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andere freie </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Basisereignisanbieter </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allgemeine Ausgabe</font></font></a><br>
<br>
<a name="stage3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichsformat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warum und was verglichen wurde, scheint klar zu sein. Und wie wurde das gemacht und warum genau? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben beschlossen, einen Vergleich in Form einer Tabelle f√ºr jede der Ereignisgruppen durchzuf√ºhren, die eine bestimmte Aktivit√§t im System widerspiegeln. Beispielsweise werden Ereignisse mit der ID (Ereignis-ID, EID) 12, 13 und 14 in Sysmon, die die Aktivit√§t mit der Registrierung widerspiegeln, nicht einmal separat gefiltert, obwohl sie von unterschiedlichen atomaren Aktionen sprechen. Nach der gleichen Logik wurde der Rest der Gruppierung vorgenommen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solche Gruppen umfassten nur √§hnliche Ereignisse. Ein Analogon zum Sysmon EID 6-Ereignis ist beispielsweise das Windows EID 6-Ereignis. Gleichzeitig gibt es mindestens 219 und 7036 Windows-Ereignisse zum Laden von Treibern. Sie entstehen aber im Fehlerfall. Jene. Tragen Sie nicht dieselbe semantische Last und k√∂nnen Sie bei Bedarf die Ereignisse von Sysmon oder Windows erg√§nzen, je nachdem, was wir sammeln m√∂chten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Gruppen von Ereignissen, die in der Tabelle wiedergegeben sind, werden in Ereignissen enthaltene informative Felder (die wir zu √úberwachungszwecken verwenden) in Form von Zeichenfolgen dargestellt. F√ºr jedes dieser Felder wird sein Name angegeben. F√ºr Windows sind zwei Optionen m√∂glich, f√ºr XML- und Magazinansichten (wer h√§tte gedacht, dass sie √ºbereinstimmen?), Wenn sie sich st√§rker als durch Leerzeichen unterscheiden. Dies geschieht, weil Der Name des Feldes, das in das √úberwachungssystem f√§llt, h√§ngt m√∂glicherweise von der Erfassungsmethode ab. Die Zeilen enthalten auch Ereignisdaten (um deren Format zu verstehen) und einen Kommentar (falls dies unserer Meinung nach erforderlich ist). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Felder mit der gleichen semantischen Last f√ºr beide Quellen werden in einer Zeile zusammengefasst. Wenn f√ºr eine der Quellen kein Feld mit einer √§hnlichen semantischen Last vorhanden ist, werden in den entsprechenden Feldern Striche ("-") angezeigt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen, die Informationen zu einer bestimmten Entit√§t enthalten, z. B. das Subjekt, das die Aktion ausf√ºhrt, werden zu einer semantischen Gruppe zusammengefasst. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Vergleich wurde f√ºr Versionen von Windows Kernel 6.3 (Windows 2012R2) und 10.0 (Windows 10, 2016, 2019) durchgef√ºhrt. Fr√ºhere Versionen wurden nicht ber√ºcksichtigt, da sie zwar immer noch weit verbreitet sind, aber allm√§hlich verschwinden. Wenn sich die Ereignisse f√ºr verschiedene Kernelversionen nicht unterschieden, wurden die Spalten zu einer zusammengefasst, um die Duplizierung zu verringern. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Rate Vollzeit ist, sind die Spalten in der folgenden Reihenfolge von der Mitte bis zu den Kanten angeordnet: Daten, Feldname, Kommentar. Dies macht den Vergleich visueller. Zur visuellen Trennung von Spalten nach den Quellen, auf die sie sich beziehen, werden Farben verwendet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einzigartig f√ºr Sysmon EID (da es sich in diesem Fall um ein erg√§nzendes Tool handelt, ist das Aufzeichnen von Betriebssystemprotokollen in der Grundfunktionalit√§t des Betriebssystems enthalten) wird in einem separaten Abschnitt beschrieben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Abschnitt mit der Tabelle zeigt die Gruppenrichtlinienobjekteinstellungen, die vorgenommen werden m√ºssen, um die Aufzeichnung im Gruppenereignisprotokoll zu erm√∂glichen </font><font style="vertical-align: inherit;">Die Anzahl der m√∂glichen Pr√ºfungsoptionen ist im Allgemeinen recht gro√ü. </font><font style="vertical-align: inherit;">F√ºr Sysmon werden solche Einstellungen nicht angezeigt, weil </font><font style="vertical-align: inherit;">Alle sind in einer einzigen Konfigurationsdatei enthalten.</font></font><br>
<br>
<a name="stage4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozesserstellung</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paradoxerweise beschlossen sie, von vorne zu beginnen. Und dann waren sie auch nicht original und gingen in Ordnung - bei der Erh√∂hung von EID Sysmon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Protokollierung von Ereignisdaten in Windows wird wie folgt aktiviert: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration der √úberwachungsrichtlinien - √úberwachungsrichtlinien - Detaillierte Nachverfolgung - Erstellung des Pr√ºfprozesses - Erfolg erm√∂glicht die Protokollierung des Ereignisses selbst; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Computerkonfiguration - Richtlinien - Administrative Vorlagen - System - Audit-Prozesserstellung - Befehlszeile in Prozesserstellungsereignisse einbeziehen - F√ºgt dem Ereignis die Befehlszeile des gestarteten Prozesses hinzu, wodurch h√§ufig zwischen einem legitimen und einem illegitimen Start unterschieden werden kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Vergleich in dem oben beschriebenen Format ist in der folgenden Tabelle dargestellt.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/rs/dw/nm/rsdwnmsmgurjif--9gck7phggee.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Folgenden werden alle Tabellen durch Bilder dargestellt und k√∂nnen angeklickt werden. Da wir erstens keine gute M√∂glichkeit gefunden haben, Tabellen nach Markdown oder HTML zu √ºbertragen, w√§hrend die Spaltenbreite oder Silbentrennung gem√§√ü der vorhandenen Version in Excel beibehalten wurde. Und zweitens sind ihre Inhalte f√ºr die Indizierung nicht sehr wertvoll, au√üer f√ºr Kommentare. Viel wertvoller in Tabellen ist die Zusammensetzung der in diesem Artikel beschriebenen Felder und das Datenformat, mit dem Sie arbeiten m√ºssen, wenn diese Ereignisquellen verwendet werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie es in der richtigen Reihenfolge, aber nicht Zeile f√ºr Zeile - jeder wird eine so detaillierte Analyse f√ºr sich selbst durchf√ºhren. </font><font style="vertical-align: inherit;">In diesem und im folgenden Abschnitt werden wir uns nur mit den Informationen befassen, die zum ersten Mal gefunden wurden. </font><font style="vertical-align: inherit;">Beginnen Sie sofort mit einem Beispiel f√ºr dieses Verhalten. </font><font style="vertical-align: inherit;">Die Felder des Abschnitts System sind in jedem Ereignis vorhanden, das in das Protokoll f√§llt, unabh√§ngig von der Quelle - Sysmon oder Windows. </font><font style="vertical-align: inherit;">Sie enthalten allgemeine Informationen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Name des Ereignisanbieters.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Zeit, zu der das Ereignis protokolliert wurde.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Name des Magazins, von dem wir diese Veranstaltung erhalten haben.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Host, auf dem das Ereignis aufgetreten ist.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Name des Anbieters und das Protokoll nach der Verbindung werden vom Analysten normalerweise nicht verwendet. Sie erm√∂glichen es jedoch zu verstehen, wo und wer die Protokolle schreibt. Dies ist wichtig, wenn der Erfassungsprozess noch nicht begonnen hat. Zeit, Host und EID sind die Hauptbaken, mit denen die prim√§re Filterung von Ereignissen durchgef√ºhrt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter den Feldern, die ich besonders erw√§hnen m√∂chte, ist die GUID sowohl f√ºr die Benutzersitzung als auch f√ºr die untergeordneten und √ºbergeordneten Prozesse nur in den Sysmon-Protokollen vorhanden. Und aus Seltsamkeiten in dasselbe Sparschwein - die Prozess-ID (neu und √ºbergeordnet) in Windows-Ereignissen wird hexadezimal geschrieben, obwohl sie im selben Task-Manager in Dezimalschreibweise angezeigt wird. Wie das Sprichwort sagt, viel Spa√ü beim Debuggen ("-Willst du dich verbessern? -Github") ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Befehlszeile beim Starten eines Prozesses in Windows-Ereignissen hat je nach dem zum Starten verwendeten Dienstprogramm ein anderes Format. Aber in Sysmon wollten und konnten die Autoren - das Format h√§ngt nicht von anderen Eingaben ab. Ich werde die Gr√ºnde nicht beurteilen, aber die Ersteller von SIEM-Inhalten werden dank Microsoft nicht dar√ºber schreiben, das ist sicher. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Hauptunterscheidungsmerkmal von Sysmon f√ºr dieses sowie f√ºr andere Ereignisse, die dieses Feld enthalten, w√ºrde ich den Hash der ausf√ºhrbaren Datei nennen. Das Hash-Format wird in der Sysmon-Konfiguration ausgew√§hlt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wieder aus den zus√§tzlichen interessanten Sysmon-Boni - dem Feld Regelname. </font><font style="vertical-align: inherit;">Dies ist in der Tat ein Tag, mit dem bestimmte Filter in der Konfigurationsdatei markiert und dann bei der Analyse von Ereignissen verwendet werden k√∂nnen. </font><font style="vertical-align: inherit;">Zum Beispiel k√∂nnen wir sagen, dass sich der Beginn von Prozess X auf Taktik Y oder Technik Z bezieht. Dieser Ansatz ist sowohl aus Sicht des Analysten als auch aus Sicht des Inhaltsentwicklers SIEM oder Sysmon interessant - er erm√∂glicht es uns, den Grund zu verstehen, warum wir uns entschieden haben, dieses Ereignis zu sammeln.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon ist viel besser, um diese Gruppe von Ereignissen zu beheben:</font></font><br>
<br>
<ul>
<li> GUID       ,          , ,     ,      ID         (    ).  , ,           .         .    ID           , , SIEM,         .  GUID,  ‚Äî  .</li>
<li>  ‚Äî                 ‚Äî  ,            ,    .    ‚Äî  Sysmon    ,      SIEM ( ).   -    ‚Äî   ,        .    ,   SIEM     .   , ,  IBM QRadar. , -     .   , ,     ‚Äî  Windows  ,    ,    .</li>
<li>  Rule Name    .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Anwendbarkeit der verbleibenden eindeutigen Felder, die in Windows-Ereignissen, die in Sysmon-Ereignissen, eine Rolle spielen, wie sie auf Englisch von Fall zu Fall sagen. </font><font style="vertical-align: inherit;">Um √ºber die Auswahl eines bestimmten Protokolls zu entscheiden oder diese im Allgemeinen zu kombinieren, muss dies daher auch von Fall zu Fall erfolgen.</font></font></li>
</ul><a name="stage5"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netzwerkverbindungen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aufzeichnen dieser Ereignisse unter Windows: Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration der √úberwachungsrichtlinien - √úberwachungsrichtlinien - Objektzugriff - Verbindung der √úberwachungsfilterplattform</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Warum haben Sie sich entschieden, sich auf die Ereignisse der Windows Filtering Platform (WFP) und nicht auf die Windows-Firewall zu konzentrieren? Die Antwort ist einfach. Nach unserer Praxis befinden sich die Endpunkte in Form von Antivirenprogrammen ohnehin bereits auf den Hosts. Obwohl sie nicht zur √úberwachung der grundlegenden Ereignisse des Systems ausgelegt sind (weshalb sie f√ºr unsere Zwecke nicht geeignet sind), enthalten sie in modernen Realit√§ten immer eine Host-Firewall. Aus diesem Grund wird die Windows-Firewall normalerweise einfach abgebrochen, um Doppelarbeit zu vermeiden. Dementsprechend schreibt niemand an den Colonel ... WFP, obwohl es den Verkehr filtern kann, verwenden wir ihn nur zur √úberwachung. Daher fehlt eine Vervielf√§ltigung.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/59/ba/nq59banogevpo2koyntusv8dtfo.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Tabelle zeigt, dass, wenn wir versuchen, uns auf Windows-Ereignisse zu verlassen, der Benutzerultraschall und der vollqualifizierte Dom√§nenname der interagierenden Hosts durch Ereignisanreicherung wiederhergestellt werden m√ºssen. Wenn Sie dar√ºber nachdenken, ist es f√ºr uns jedoch wichtiger zu wissen, welcher Prozess die Verbindung hergestellt hat und nicht welcher Benutzer. Beispielsweise wird die Malware an das C &amp; C-Center gesendet. Auf jeden Fall m√∂chten wir herausfinden, wer den Prozess gestartet hat, oder einen Vorfall erstellen, basierend auf dem Verst√§ndnis, dass der Editor nicht ins Internet selbst geht (d. H. Basierend auf den im Ereignis verf√ºgbaren Informationen).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und mit FQDN ist es noch einfacher: Alle modernen Systeme enthalten die CMDB-Komponente als grundlegende oder zus√§tzliche Funktionalit√§t. </font><font style="vertical-align: inherit;">Wenn nicht, lohnt es sich auf jeden Fall, sich mit einer Drittanbieterl√∂sung zu versorgen. </font><font style="vertical-align: inherit;">Die Kenntnis Ihrer Infrastruktur ist die Grundlage f√ºr die Informationssicherheit im Allgemeinen. </font><font style="vertical-align: inherit;">Die Informationen sind also entweder durch Anreicherung oder √ºber eine Asset-Karte verf√ºgbar, die ihre Verwendung in Korrelation erm√∂glicht. </font><font style="vertical-align: inherit;">Die Hauptsache ist, wenn m√∂glich, nicht zu vergessen, DHCP-Protokolle zu verbinden, damit die Informationen auf dem neuesten Stand sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle anderen eindeutigen Felder sind nicht so wichtig, zum Beispiel:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ber√ºhmte H√§fen. </font><font style="vertical-align: inherit;">Wir w√ºrden uns nicht auf dieses Feld verlassen - es ist nicht umsonst, dass es Mittel gibt, um Anomalien im Verkehr zu erkennen, wenn beispielsweise der SSH-Tunnel eher √ºber Port 80 als √ºber HTTP verl√§uft.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkehrsrichtung. </font><font style="vertical-align: inherit;">Wenn Sie die Host-ID (IP oder FQDN) und die Quelle / das Ziel der Verbindung kennen, k√∂nnen Sie die Richtung leicht berechnen.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und in diesem Fall gewinnt Sysmon, aber weniger bedeutend - GUID, FQDN, User bieten einen Komfort, der mit SIEM-L√∂sungen oder L√∂sungen von Drittanbietern durchaus m√∂glich ist. </font><font style="vertical-align: inherit;">Trotzdem bedeuten kleine Anstrengungen nicht Null.</font></font><br>
<a name="stage6"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozessabschluss</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen wird das Ereignis, wie bereits oben erw√§hnt, nicht sehr oft verwendet, aber ...</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/lq/0e/x0/lq0ex02swhhs39noycfzb1m2wog.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn es gebraucht wird, gibt es einen klaren Gewinn auf der Seite von Windows. </font><font style="vertical-align: inherit;">Wir f√ºgen nur hinzu, wie die Protokollierung aktiviert wird, und gehen direkt zu den Schlussfolgerungen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration der √úberwachungsrichtlinien - √úberwachungsrichtlinien - Detaillierte Nachverfolgung - Beendigung des Pr√ºfprozesses - Erfolgreich</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall wird der Vorteil der nativen Betriebssystemprotokollierung erreicht durch:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeigt den Benutzer an, der den Vorgang abgeschlossen hat.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Vorhandensein eines Exit-Codes, der √ºber den regelm√§√üigen Abschluss des Prozesses sowie √ºber Fehler sprechen kann.</font></font></li>
</ul><a name="stage7"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treiber herunterladen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Windows-Ereignis ist im Gegensatz zu den anderen standardm√§√üig aktiviert und wird in das Systemprotokoll aufgenommen. </font><font style="vertical-align: inherit;">Es gibt nicht viele informative Felder in diesen Veranstaltungen.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/a3/hd/4k/a3hd4kpimlddce6uu5az5mzn_dw.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und wieder sofort zu den Schlussfolgerungen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Gruppe liefern Sysmon-Ereignisse dem Analysten viel n√ºtzlichere Informationen. </font><font style="vertical-align: inherit;">Beispielsweise ist laut Windows-Ereignissen nicht einmal klar, welche Treiberdatei verwendet wurde. </font><font style="vertical-align: inherit;">Daher in dieser Gruppe von Windows in expliziten Au√üenseitern.</font></font><br>
<a name="stage8"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prozesszugriff</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir w√ºrden diese Gruppe von Ereignissen nicht als grundlegend einstufen, sondern als etwas fortgeschritten. Aus Sicherheitsgr√ºnden kann die Veranstaltung von gro√üem Interesse sein. Es gibt viele </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√∂glichkeiten, wie ein</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> b√∂swilliger Prozess Ihr legitimes kleines "besser" machen kann. Nat√ºrlich nicht wegen Altruismus, sondern wegen b√∂swilliger Handlungen. Und die betrachteten Veranstaltungen werden uns nur helfen, viele M√∂glichkeiten f√ºr solche Kreativit√§t zu entdecken. Diese Protokolle werden unter Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte √úberwachungsrichtlinienkonfiguration - √úberwachungsrichtlinien - Objektzugriff - √úberwachungskernelobjekt - Erfolgreich aktiviert</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/g5/3x/xm/g53xxmsrxfjnuq5dy-hxfatsq2g.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Windows hat zwei Vorteile. Erstens die Zuordnung des Benutzers, von dem aus der Quellprozess arbeitet. Wie oben erw√§hnt, ist der Vorteil normalerweise vernachl√§ssigbar. Und zweitens </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HandleID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Zugriffsrechte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Interesse an Zugriffsrechten klar ist, ist HandleID nur f√ºr die Suche nach verwandten Ereignissen n√ºtzlich. Es ist erforderlich, um die Benutzerinteraktion durch Prozesse mit Betriebssystemobjekten zu organisieren - dieselben Prozesse (deren Threads), Dateien usw. Dementsprechend k√∂nnen zus√§tzliche Ereignisse zeigen, wie und an wen es ausgegeben wurde und wann das erforderliche Handle f√ºr den Zugriff widerrufen wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie das Thema Objekte und Handle zum ersten Mal ber√ºhren und Aktionen mit ihnen protokollieren, ist es wichtig, zwei Dinge zu beachten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die oben genannten zus√§tzlichen Schritte zu protokollieren, ist es zun√§chst wichtig, zus√§tzliche Einstellungen f√ºr √úberwachungsrichtlinien zu aktivieren, insbesondere Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration der √úberwachungsrichtlinien - √úberwachungsrichtlinien - Objektzugriff - Manipulation des √úberwachungshandles - Erfolgreich. Es sei daran erinnert, dass das Volumen dieser Ereignisse sehr gro√ü sein kann. Der Griff wird nach Eingang einer Anfrage ausgestellt und spiegelt die beanspruchten Rechte wider. Aber warum k√∂nnen wir nicht das gleiche Ereignisvolumen direkt von der Pr√ºfung des Zugriffs auf Objekte erwarten?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies liegt daran, dass zweitens SACL f√ºr das Objekt aktiviert werden soll, dessen Steuerung geplant ist. Tats√§chlich ist dies eine Liste √§hnlich der Liste der DACL-Zugriffsrechte, die bestimmt, ob das mit seinem Token erstellte Subjekt oder Objekt beim Versuch, auf das Objekt zuzugreifen, Erfolg oder Misserfolg erh√§lt. Die SACL bestimmt jedoch in ungef√§hr derselben Form nicht die Rechte zur Interaktion mit dem Objekt, sondern ob Sicherheitsereignisse generiert werden, wenn bestimmte Rechte angefordert und ausge√ºbt werden. Diese Ereignisse umfassen nicht bereits angeforderte, aber tats√§chlich verwendete Zugriffsrechte.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis erhalten wir einen Filter, mit dem Sie nur den Zugriff auf f√ºr uns wichtige Objekte und nur die f√ºr uns wichtigen Zugriffstypen protokollieren k√∂nnen. Im Gegenzug m√ºssen wir jedoch eine SACL direkt an jedes dieser Objekte anh√§ngen oder angeben, dass die SACL vom √ºbergeordneten Objekt geerbt wird. Dies kann nat√ºrlich durch verschiedene Methoden automatisiert werden. Es ist jedoch unwahrscheinlich, dass die Konfiguration solcher Automatisierungstools bequem ist. Im Gegensatz zu einer einfachen Sysmon-Liste, die auch Platzhalter enthalten kann, wenn auch eigenartige. Wir werden in einem separaten Abschnitt √ºber das Filtern in Sysmon sprechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gl√ºcklicherweise ist f√ºr Objekte vom Typ standardm√§√üig bereits ein SACL-Prozess f√ºr die Kernel-Version 6.3 und h√∂her vorhanden. Wenn jemand einen Weg angeben kann, wie diese SACL empfangen werden soll (Empfehlungen aus diesem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir haben es nicht erf√ºllt), es wird interessant sein zu h√∂ren / diskutieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Sysmon-Seite gibt es neben den bereits besprochenen GUIDs und Regelnamen noch einige weitere interessante Bereiche. </font><font style="vertical-align: inherit;">Zun√§chst die PID des Zielprozesses. </font><font style="vertical-align: inherit;">Damit k√∂nnen Sie die nachfolgende Aktivit√§t des infizierten Objekts √ºberwachen, da eine ausf√ºhrbare Datei mehrere Instanzen enthalten kann. </font><font style="vertical-align: inherit;">Zweitens das CallTrace-Feld, das die Aktionen der Ereignisquelle im Ziel erfasst. </font><font style="vertical-align: inherit;">Schauen Sie sich das an und stellen Sie fest, dass ‚ÄûFingerspitzengef√ºhl und kein Betrug‚Äú nicht nur Worte sind. </font><font style="vertical-align: inherit;">Andererseits ist eine solch detaillierte Analyse bereits das Schicksal der Forensik. </font><font style="vertical-align: inherit;">Und wer eine dedizierte Forensik hat, steht h√∂chstwahrscheinlich nicht am Anfang des Weges zum Aufbau eines √úberwachungssystems.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Gruppe unterscheiden sich Ereignisse in einer relativ gro√üen Anzahl von Feldern. </font><font style="vertical-align: inherit;">Wenn diese Informationen jedoch bei Windows-Ereignissen h√∂chstwahrscheinlich die Bequemlichkeit einer ersten Analyse bieten, erfasst Sysmon eindeutige Daten, die auf andere Weise nur schwer zu erhalten sind. </font><font style="vertical-align: inherit;">Daher bleibt der Vorteil bei Sysmon.</font></font><br>
<a name="stage9"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dateierstellung</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Kategorie ist in Windows wie folgt enthalten: Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte √úberwachungsrichtlinienkonfiguration - √úberwachungsrichtlinien - Objektzugriff - √úberwachungsdateisystem - Erfolgreich</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/wu/qp/wy/wuqpwygxyngiqa8db58gvoenmiu.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie aus der Tabelle hervorgeht, √§hneln alle Vor- und Nachteile dieser Gruppe den oben bereits beschriebenen. Einschlie√ülich der Vor- und Nachteile von SACL (f√ºr Dateien und Ordner f√ºr alle (alle) Benutzer, einschlie√ülich Eigenschaften - Sicherheit - Erweitert - √úberwachung - Hinzuf√ºgen - Jeder - Erfolg - Schreiben (f√ºr Dateien) oder √Ñndern (f√ºr ein Verzeichnis)). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen SACL auch global f√ºr Dateien festlegen, indem Sie es unter Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration von √úberwachungsrichtlinien - √úberwachungsrichtlinien - Objektzugriff - Globale Objektzugriffs√ºberwachung - Dateisystem definieren. Die Anzahl der Ereignisse, insbesondere bei tempor√§ren Dateien, wird jedoch proportional zum Umfang der Vorg√§nge zunehmen. Ich w√ºrde nicht sagen, dass dies ein effektiver Ansatz ist, er ist nur f√ºr einen kleinen Teil der Operationen m√∂glich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich m√∂chte die merkw√ºrdigen Besonderheiten der Protokollierung erw√§hnen, die hier beginnen. </font><font style="vertical-align: inherit;">F√ºr diese Gruppe ist nicht festgelegt Windows - </font><font style="vertical-align: inherit;">Ereignis , </font><font style="vertical-align: inherit;">wenn eine Datei durch Powershell zum Beispiel erstellt wird, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die C - </font><font style="vertical-align: inherit;">New-Item: \ ForTest \ test.t</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gleichzeitig wird dieselbe Aktion in den Sysmon-Protokollen perfekt angezeigt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Ereignisgruppe wird am besten mit Sysmon aufgezeichnet.</font></font><br>
<a name="stage10"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registrierungsaktionen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Bezug auf die Gruppe haben wir bisher nur eine Veranstaltung aufgenommen. </font><font style="vertical-align: inherit;">Dieser Trend wird sich hier √§ndern.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kl/wm/b0/klwmb01kl6o_14omabn-qdhjh-c.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Protokollierung dieser Ereignisse wird wie folgt konfiguriert: Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte √úberwachungsrichtlinienkonfiguration - √úberwachungsrichtlinien - Objektzugriff - √úberwachungsregistrierung - Erfolgreich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SACL f√ºr alle (alle) Benutzer ist wie folgt definiert: regedit.exe - Registrierungszweig - Berechtigungen - Erweitert - √úberwachung - Jeder - Erfolg - Erweiterte Berechtigungen - Vollzugriff oder Wert festlegen, Unterschl√ºssel erstellen, Link erstellen, L√∂schen, DAC schreiben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen SACL auch global f√ºr Dateien festlegen, indem Sie es unter Computerkonfiguration - Richtlinien - Windows-Einstellungen - Sicherheitseinstellungen - Erweiterte Konfiguration von √úberwachungsrichtlinien - √úberwachungsrichtlinien - Objektzugriff - Globale Objektzugriffs√ºberwachung - Registrierung definieren. Die Nachteile des Ansatzes √§hneln den gleichen Dateivorg√§ngen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Konzentrieren Sie sich sofort auf die Einschr√§nkungen. </font><font style="vertical-align: inherit;">F√ºr Sysmon alle Vorg√§nge (Erstellen, √Ñndern, L√∂schen) mit Wert- oder Schl√ºsselerh√∂hungsereignissen (au√üer dem Umbenennen von Wert). </font><font style="vertical-align: inherit;">F√ºr Windows:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle Operationen mit Value Raise-Ereignissen. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Erstellen eines Schl√ºssels l√∂st keine Ereignisse aus. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Umbenennen des Schl√ºssels l√∂st nur das Access-Ereignis aus. Der neue Schl√ºsselname wird nicht angezeigt. </font><font style="vertical-align: inherit;">Die im Ereignis angegebenen angeforderten Rechte haben keine intuitiv eindeutige √úbereinstimmung mit der Operation. </font><font style="vertical-align: inherit;">Somit kann der Umbenennungsvorgang nur durch die Ausnahmemethode bestimmt werden - es gibt kein L√∂schereignis 4660 mit dieser HandleID.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Entfernen des Schl√ºssels l√∂st das Ereignis 4663 aus, gefolgt von 4660.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zu den in den vorherigen Abschnitten beschriebenen Feldern ist zu beachten, dass Windows-Ereignisse alte und neue Daten von Namen und Werten von Schl√ºssel und Wert enthalten, die w√§hrend der Untersuchung helfen k√∂nnen, das Motiv des Angreifers zu verstehen. </font><font style="vertical-align: inherit;">Insbesondere wenn die Anfangswerte nicht Standard oder typisch sind und die Konfiguration, einschlie√ülich der Registrierungsdaten des untersuchten Computers, nicht au√üerhalb des Hosts gespeichert wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie wir sehen k√∂nnen, gibt es strengere Einschr√§nkungen f√ºr die Windows-Protokollierung. </font><font style="vertical-align: inherit;">Und um einige Fakten zu korrigieren, ist √ºberhaupt eine ‚ÄûKorrelation‚Äú erforderlich, wenn auch die einfachste. </font><font style="vertical-align: inherit;">Es ist jedoch in der Lage, eine gr√∂√üere Menge wirklich n√ºtzlicher Informationen bereitzustellen. </font><font style="vertical-align: inherit;">Es ist schwierig, einem der Teilnehmer f√ºr diese Veranstaltungsgruppe den Vorzug zu geben.</font></font><br>
<a name="stage11"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WMI-Konfiguration</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen zur vorletzten Gruppe von Ereignissen √ºber. Dies sind WMI-Ereignisse. Ein Angreifer kann einen Filter (Filter) erstellen, der Ereignisse √ºber eine √Ñnderung des Systemstatus empf√§ngt, in unserem Beispiel eine √Ñnderung des Status eines Dienstes. Und um bestimmte Aktionen basierend auf den von diesem Filter empfangenen Ereignissen auszuf√ºhren, wird ein Verbraucher erstellt. In unserem Fall ist dies ein Eintrag in der Protokolldatei. Als n√§chstes muss er den Filterausgang mit dem Verbrauchereingang verbinden und eine Bindung zwischen dem Filter und dem Verbraucher herstellen. Es wird sich ein System herausstellen, das unter bestimmten Bedingungen funktioniert. Wird oft f√ºr </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persistenztaktiken verwendet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Genau in der beschriebenen Reihenfolge werden die Ereignisse 19-21 Sysmon aufgezeichnet.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist wichtig zu verstehen, dass das Erstellen eines Filters oder Verbrauchers an sich keine Bedrohung darstellt, aber nat√ºrlich Teil eines Angriffs sein kann. Dar√ºber hinaus kann f√ºr b√∂swillige Aktivit√§ten ein vorhandener Filter, ein Verbraucher oder beides verwendet werden. Hier ist es wie mit einem Messer oder, n√§her am Thema der Ressource, mit verschl√ºsselten Messenger. Die Frage ist nicht im Tool, sondern in seiner Verwendung. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns den Tisch genauer an.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f9/bo/br/f9bobr7pus2gf7lnaxgoxcirosq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein wichtiger Punkt, der zuallererst beachtet werden sollte - Ereignis 5861 wird im angegebenen Protokoll nur aufgrund der Tatsache der Erstellung oder nachfolgenden √Ñnderung (einschlie√ülich Filter und Verbraucher) des Bundles generiert. Dies erleichtert einerseits die Verfolgung mutma√ülich b√∂swilliger Aktivit√§ten (es ist keine Korrelation zwischen zwei oder drei Ereignissen erforderlich), wenn nicht nur eine Gruppe darin erstellt wird. Andererseits verpassen wir die Startzeit dieser Aktivit√§t, wenn der Filter oder Verbraucher genau im Rahmen und im Voraus erstellt wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ist das kritisch? Von Fall zu Fall. Wenn wir beginnen, die Abfolge eines Vorfalls abzuwickeln und feststellen, dass vor zwei Jahren ein atypischer und angeblich b√∂swilliger Filter oder Verbraucher erstellt wurde, stellen wir sofort fest, dass die Angreifer seit mehr als zwei Jahren bei uns zu Hause sind. Und zumindest bis zu dieser Tiefe m√ºssen Spuren des Angriffs gesucht werden. Wie oft passiert das? Dies ist die Hauptfrage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn jedoch √Ñnderungen am Filter oder am Verbraucher des vorhandenen Bundles vorgenommen werden, wird das gesamte Bild in einem einzigen Ereignis angezeigt. W√§hrend Sysmon nur die √Ñnderungen (das Objekt) widerspiegelt, die vorgenommen wurden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter anderem: Bei Sysmon-Ereignissen werden Daten in einer strukturierteren Form und in einem bequemeren Format wiedergegeben. Beispielsweise wird anstelle der SID in einem atypischen Format die Anmeldung des Benutzers sofort angezeigt. Die Daten sind jedoch etwas geringer. Vielleicht ist dies f√ºr Ihren Fall kritisch. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir schlie√üen mit Einschr√§nkungen. Erstens konnten wir diese Ereignisse trotz der Tatsache, dass dieses Journal seit Windows 2012 (Kernel 6.2) vorhanden ist, nicht einmal f√ºr Kernel 6.3 (2012R2) abrufen, der im Artikel untersucht wird. M√∂glicherweise liegt dies am Fehlen von Patches. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens nach dem Autor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel, der Filter f√ºr Timer-Ereignisse wird von Sysmon nicht festgelegt. </font><font style="vertical-align: inherit;">Es w√§re m√∂glich, kein Wort zu nehmen, sondern zu √ºberpr√ºfen. </font><font style="vertical-align: inherit;">Dar√ºber hinaus ist die Version von Sysmon alt. </font><font style="vertical-align: inherit;">Aber hier ist ein Pr√§zedenzfall wichtig - es gibt nicht wenige Arten von Filtern und WMI-Verbrauchern. </font><font style="vertical-align: inherit;">Aus einer solchen Studie, erg√§nzt durch Details, k√∂nnte ein separater Artikel erstellt werden. </font><font style="vertical-align: inherit;">Testen Sie einfach die Zieltypen, um genau zu verstehen, welche registriert werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall sind wir mit der Verwendung von Windows-Ereignissen besser vertraut. </font><font style="vertical-align: inherit;">Unter dem Gesichtspunkt der Zweckm√§√üigkeit: Bei mehr Daten ist keine prim√§re Korrelation erforderlich. </font><font style="vertical-align: inherit;">Unter dem Gesichtspunkt der Zielsetzung wird also die Schaffung eines Mechanismus (basierend auf neuen, modifizierten oder vorhandenen Teilen) und nicht dessen Einzelteile festgelegt.</font></font><br>
<a name="stage12"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DNS-Abfragen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen also zur letzten Gruppe √ºber, die verglichen wird, aber noch weit vom Abschluss unseres Artikels entfernt. </font><font style="vertical-align: inherit;">Dieser Typ und die entsprechenden Ereignisse sind nicht nur durch das Erscheinen in unserem Artikel, sondern auch durch das Hinzuf√ºgen von Sysmon zum Toolkit aktuell. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In den letzten Jahren ist das Thema der Verwendung von DNS f√ºr andere Zwecke, beispielsweise zum Empfangen von Befehlen von C &amp; C oder zum Stehlen von Informationen √ºber diesen Kanal, popul√§r geworden. </font><font style="vertical-align: inherit;">H√∂chstwahrscheinlich nicht von alleine - wir w√ºrden die Geschichten √ºber eine solche Verwendung von ICMP- und DNS-Kan√§len auf Null verweisen. </font><font style="vertical-align: inherit;">Zu dieser Zeit waren vertraute Studenten in der Verkapselung des Spielzeugverkehrs ausgefeilt, um die begehrten Spieleserver vom Netzwerk des Instituts √ºber die einzig erlaubten Kan√§le (Hallo, Zhenya) zu erreichen</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tumbochko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">!). Dies machte es m√∂glich, die Zeit irgendwie langweilig zu verbringen oder ihre Labore schnell zu meistern. Und es war kaum ihre Idee. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor nicht allzu langer Zeit wurde diesem Leckkanal ein Konzept wie DoH hinzugef√ºgt, das die Erkennung von verd√§chtigem DNS-Verkehr auf Netzwerkebene erschwerte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oder vielleicht war es nur ein Marketingtrick - einen neuen zu verkaufen, der auch ein vergessener alter ist. Oder der Beginn des weit verbreiteten Auftretens solcher Kan√§le bei nachweisbaren b√∂swilligen Aktivit√§ten. Wir haben uns nicht tief mit diesem Thema befasst und waren bereit, Getreide zu sammeln - pl√∂tzlich beschlie√üt einer der Leser, ein wenig Weisheit in die Kommentare zu stecken. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also n√§her am Punkt. Aktivieren Sie die Ereignisanzeige - Anwendungs- und Dienstprotokolle - Microsoft - Windows - DNS-Clientereignisse - Betrieb - Kontextmen√º - Protokoll aktivieren.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/oz/9m/4ooz9mm2kjdsagzhnxcymt5_mpq.png"></div></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trotzdem wie bereits besprochen. Bei den Informationen zum Thema achten wir auf die explizite Angabe des Bildes der ausf√ºhrbaren Datei, die die Anforderung im Sysmon-Ereignis ausgef√ºhrt hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir √ºber das Objekt sprechen, gibt es viel mehr Informationen in den Windows-Protokollen. Aber es gibt mehrere wichtige "Aber". Erstens werden die Informationen auf mehrere Ereignisse mit allen Konsequenzen verteilt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens werden die Informationen nicht intuitiv dargestellt. </font><font style="vertical-align: inherit;">Das Entschl√ºsseln des gr√∂√üten Teils des Wissens erfordert Kenntnisse dar√ºber, wie die Felder des Pakets gebildet werden, und die F√§higkeit, diese Daten wieder in Fakten umzuwandeln, die die Entscheidung des Analytikers erleichtern. </font><font style="vertical-align: inherit;">Wir k√∂nnen sagen, dass der Analyst tats√§chlich nicht umsonst ein Gehalt bekommt und warum nicht hinsetzen und es herausfinden. </font><font style="vertical-align: inherit;">Ja, das ist richtig. </font><font style="vertical-align: inherit;">Aber ich m√∂chte Sie daran erinnern, dass es sich um ein kleines Team ohne engmaschige Spezialisten handelt, vor dem die Aufgaben der Informationssicherheit kein Ende haben. </font><font style="vertical-align: inherit;">Und wenn f√ºr jedes von SIEM analysierte Ereignis eine solche Aufgabe auf ihn f√§llt, wird er sie in einigen Jahren nicht mehr einholen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr diese Gruppe ist der Gewinner schwer zu bestimmen. </font><font style="vertical-align: inherit;">Sysmon bietet eine lakonische Version an, aus der Sie leicht einen guten Teil n√ºtzlicher Informationen herausholen k√∂nnen. </font><font style="vertical-align: inherit;">Windows bietet eine erweiterte Option. </font><font style="vertical-align: inherit;">Es bleibt zu "n√§hen", sich mit dem Inhalt zu befassen und sich zu fragen, ob es Zeit war, NTA einzuf√ºhren?</font></font><br>
<a name="stage13"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einzigartige Sysmon-Ereignisse</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben Sysmons einzigartigen Ereignissen Folgendes zugeschrieben:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 4, 16. Obwohl es √ºber Windows-Protokolle verfolgt werden kann, geben sie nur Auskunft √ºber die Ereignisse in Sysmon. </font><font style="vertical-align: inherit;">Dementsprechend machen sie in ihrer Abwesenheit keinen Sinn.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EID 2 - EID 4663 kann als analog angesehen werden. Aber selbst unter Ber√ºcksichtigung der darin enthaltenen Zugriffsrechtslisten ist das Ereignis nicht so detailliert wie EID2 und wird mit anderen Windows-Ereignissen nicht auf einen solchen Status angereichert.</font></font></li>
<li>EID 7-9, 17 ‚Äî   .      ETW.  ,   ,      .</li>
<li>EID 15 ‚Äî   ,    ETW.       ,      ‚Äî .</li>
<li>EID 18 ‚Äî      (named pipes)       . , -,   .  -,      ,        .       ETW.</li>
</ul><a name="stage14"></a><br>
<h1> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt drei Optionen zum Filtern von Ereignissen auf der Quellseite. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erste ist nur f√ºr Windows-Ereignisse und nur zur √úberwachung des Zugriffs und der Vorg√§nge mit Objekten verf√ºgbar. Implementiert mit SACL. Zu den Nachteilen dieses Ansatzes geh√∂rt die Komplexit√§t der detaillierten Einstellungen (Sie k√∂nnen beispielsweise nicht nur vorhandene oder erstellte Dateien mit der Erweiterung .exe √ºberwachen). Zu den Vorteilen geh√∂rt die M√∂glichkeit, die Liste der Benutzer einzuschr√§nken, f√ºr die Vorg√§nge mit dem Objekt aufgezeichnet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die zweite Option ist sowohl f√ºr Windows-Ereignisse als auch f√ºr Sysmon-Ereignisse verf√ºgbar: Verwenden von Xpath unter Ber√ºcksichtigung der Einschr√§nkungen, die von Microsoft eingef√ºhrt wurden. Da die Methode f√ºr beide Quellen verf√ºgbar ist, geht die Beschreibung √ºber den Rahmen dieses Artikels hinaus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und die dritte ist die Sysmon-Konfiguration. Es gibt viele M√∂glichkeiten:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Platzhalteremulation - enth√§lt (beliebig | alle), schlie√üt (beliebig | alle) aus, endet mit, beginnt mit. </font><font style="vertical-align: inherit;">Die Verwendung von enth√§lt | schlie√üt alles aus, um Ausdr√ºcke wie "C: \ Windows \ *. Exe" zu emulieren.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Genaue √úbereinstimmung - ist, ist nicht, Bild.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arithmetik - weniger als, mehr als.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist zu beachten, dass eine solche Filterung nicht f√ºr alle Felder verf√ºgbar ist. </font><font style="vertical-align: inherit;">Beispielsweise k√∂nnen Sie keine Hashes von Standardsoftware auf die Whitelist setzen, um Prozesse zu erstellen, an denen wir nicht interessiert sind. </font><font style="vertical-align: inherit;">Ein Beispiel aus unserer Erfahrung - der legitime Prozess git.exe hat Zehntausende von Startereignissen pro Tag auf den Hosts unserer Entwickler erstellt. </font><font style="vertical-align: inherit;">Vielleicht k√∂nnte gerade in diesem Fall sein Verhalten versch√§rft werden, wodurch diese Welle von Ereignissen verringert wird. </font><font style="vertical-align: inherit;">Es ist jedoch keine gute Idee, ausf√ºhrbare Dateien nach Bildnamen auszuschlie√üen. </font><font style="vertical-align: inherit;">Nun, vielleicht nur ein Antivirus mit aktivierter Selbstverteidigung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sysmon ist auch nur auf dem Weg zu einer ausgekl√ºgelten Filterung, indem Bedingungen aus verschiedenen Bereichen kombiniert werden. </font><font style="vertical-align: inherit;">Sie k√∂nnen nur eine Gruppe von Regeln f√ºr jede EID erstellen, die durch UND-Beziehungen kombiniert wird, und nur eine mit ODER-Beziehungen. </font><font style="vertical-align: inherit;">Dementsprechend k√∂nnen Bedingungen der Form (A und B) oder (C und D) nicht mehr geschrieben werden. </font><font style="vertical-align: inherit;">Abh√§ngig vom gefilterten Strom kann diese Tatsache keinen signifikanten Vorteil bringen, aber auch ein greifbares Ergebnis liefern.</font></font><br>
<a name="stage15"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Andere Anbieter von kostenlosen Basisveranstaltungen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Abschnitt m√∂chte ich zun√§chst auf den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ETW-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mechanismus </font><font style="vertical-align: inherit;">(Event Trace for Windows) </font><font style="vertical-align: inherit;">eingehen </font><font style="vertical-align: inherit;">. Sowohl die in Windows als auch in Sysmon integrierten Protokolle protokollieren Ereignisse mithilfe dieses Mechanismus. Tats√§chlich k√∂nnen wir f√ºr jede Aktion im System ein Ereignis erhalten. Der einfachste Weg, um das potenzielle Volumen solcher Ereignisse zu ermitteln, besteht darin, die Option Ereignisanzeige - Ansicht - Analyse anzeigen und Debug-Protokoll anzeigen zu aktivieren. Damit Ereignisse Ihr System nicht sofort f√ºllen, wird jedes Protokoll separat in seinem Kontextmen√º aktiviert. Sie sehen sich diese G√ºte an und stellen sich unwillk√ºrlich eine Frage: Warum brauchen wir Sysmon mit einer solchen Menge verschiedener Ereignisse?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsache ist, dass diese Protokolle urspr√ºnglich zum Debuggen und nicht zu Sicherheitszwecken gedacht waren. Daher wird ihre zentralisierte Sammlung nicht bereitgestellt. Insbesondere finden Sie den FQDN des Hosts, auf dem sie erstellt wurden, nirgendwo. Die Frage kann nat√ºrlich von Dienstprogrammen von Drittanbietern von klein bis gro√ü gel√∂st werden, von Skripten bis hin zu vollwertigen Protokollierungsdiensten. Sie m√ºssen sich jedoch daran erinnern, dass dies zus√§tzliche Software in einem gro√üen Unternehmen und dementsprechend eine separate Aufgabe ist. Ich m√∂chte Sie daran erinnern, dass wir in der Einleitung bei zus√§tzlichen Aktivit√§ten zur Installation von Software vom Prinzip des Minimalismus ausgegangen sind.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und zweitens berichten diese Protokolle so detailliert √ºber jedes Niesen, dass sie auch die Informationen St√ºck f√ºr St√ºck ausw√§hlen m√ºssen. Journaleintr√§ge sind wirklich atomar und erfordern eine vorherige Korrelation oder Anreicherung, damit der Analyst produktiv arbeiten kann. Schlie√ülich wei√ü ein Programmierer, der seine Erstellung mithilfe dieser Ereignisse debuggt, wie alles funktionieren sollte. Und ein Sicherheitsbeamter, insbesondere mit einem breiten Profil, denkt auf viel h√∂heren Abstraktionsebenen. Ja, au√üerdem wird nach unbekannten illegitimen Aktivit√§ten gesucht. Eine solche Problemstellung f√ºhrt zu einem zus√§tzlichen Softwaremodul, das die Vorverarbeitung durchf√ºhrt. Dies wird unser Konzept erneut komplizieren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl wir nicht weit von der Protokollierung unter Windows entfernt sind, werden wir nicht vergessen, WMI zu erw√§hnen. Dieses Tool erfasst grunds√§tzlich Status√§nderungen, ohne deren Quelle anzuzeigen. Als Beispiel f√ºr eine Ausnahme: Laden einer DLL: Zeigt das DLL-Modul selbst und den Prozess an, der es l√§dt. Aus Sicherheitsgr√ºnden erfordert dieses Ereignis jedoch auch eine Bereicherung, da hier die Informationen ersch√∂pft sind. Im Allgemeinen sind Fischlosigkeit und Krebs Fische. Das Tool kann jedoch nur als Extra verwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine weitere beliebte Option, die im Artikel nicht behandelt wird, ist die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Osquery.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die beiden Hauptgr√ºnde, warum wir diese L√∂sung hier nicht in Betracht gezogen haben, sind die geringe H√§ufigkeit von Produktaktualisierungen (abz√ºglich sowohl der Sicherheit als auch der Funktionalit√§t) und die im Vergleich zu anderen Optionen erh√∂hte Verwendung von Systemressourcen (eine vollst√§ndige Datenbank ist enthalten). </font><font style="vertical-align: inherit;">Vermutlich eignet sich die L√∂sung gut f√ºr Server, f√ºr die sie entwickelt wurde. </font><font style="vertical-align: inherit;">Aber f√ºr Workstations, m√∂glicherweise mit veralteter Hardware - kaum.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In letzter Zeit sind mehrere weitere Tools erschienen, die nicht so weit verbreitet sind wie die in Betracht gezogenen. </font><font style="vertical-align: inherit;">Dazu geh√∂ren Velociraptor und SilkETW. </font><font style="vertical-align: inherit;">Sie erfinden kein Fahrrad und arbeiten auch nach dem Windows-Standard - ETW. </font><font style="vertical-align: inherit;">In Anbetracht des bereits zitierten Materialvolumens wurde beschlossen, diese Tools in eine separate Publikation zu unterteilen (da Zeit und M√ºhe sowie ein Gef√ºhl der Nachfrage zur Verf√ºgung stehen).</font></font><br>
<a name="stage16"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allgemeine Schlussfolgerung</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Verlauf des Vergleichs wurde gezeigt, dass Sysmon-Ereignisse mit Analoga normalerweise Windows-Ereignisse in ihren funktionalen Eigenschaften √ºbertreffen. </font><font style="vertical-align: inherit;">Einige Sysmon-Ereignisse haben einfach keine Alternativen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie jedoch nicht, dass zun√§chst die L√∂sung anhand Ihrer Aufgaben ausgew√§hlt werden muss. </font><font style="vertical-align: inherit;">Wenn Sie nur ein √úberwachungssystem erstellen und im ersten Jahr Methoden zur Erkennung von sieben bis zehn Vorf√§llen implementieren m√∂chten, wie Gartner es hinterlassen hat, sollten Sie √ºber gen√ºgend Windows-Ereignisse verf√ºgen. </font><font style="vertical-align: inherit;">Und vielleicht viel mehr als ein Jahr.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens wird auch das Windows-Ereignisprotokollierungssystem st√§ndig aktualisiert, und w√§hrend des Schreibens dieses Artikels wurden Windows-EIDs wie 4798 und 4799 angezeigt. Es ist auch m√∂glich, dass der Satz von Feldern erg√§nzt wird. Daher ist dieser Vergleich, obwohl er aufgrund der uns vorliegenden Informationen der vollst√§ndigste ist, nicht in Stein gemei√üelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und drittens ist Sysmon immer noch ein externes Instrument, das eine Reihe von Risiken birgt. Beispielsweise gab es F√§lle, in denen die Protokollierung einzelner EIDs ohne Angabe von Gr√ºnden beendet wurde. In diesem Fall war die Aufzeichnung anderer Ereignisse wie gewohnt. Bedeutendere Kollegen behaupten, dass das Problem mit Speicherlecks in Version 10.41 zusammenh√§ngt. Aber Release 10.42, in dem dieses Problem ganz oder teilweise geschlossen ist (mit Sysmons Changelog ist nicht alles so </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detailliert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), hat unsere Probleme in dieser Richtung nicht gel√∂st. </font><font style="vertical-align: inherit;">Nur die Deinstallations-Installations-Komponente hilft. </font><font style="vertical-align: inherit;">Alle Sicherheit und einen sch√∂nen Tag! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danke an Timur</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zinint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√ºr Hilfe bei der Vorbereitung der Ver√∂ffentlichung. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Es stellt sich als sehr schwierig heraus, ein normales √Ñnderungsprotokoll zu f√ºhren oder der Hauptbeschreibung neue Funktionen hinzuzuf√ºgen, wie wir festgestellt haben (danke, Onkel Dim</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shudv</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), ein Lastwagen mit Nishtyaks, der bereits vor </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9 Monaten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf unserer Stra√üe umgekippt </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ist</font></a><font style="vertical-align: inherit;"> ... Zusammenfassung: In Sysmon k√∂nnen Sie (A und B) oder (C und D) nur ...</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de489040/index.html">Contact Center AI: Dritte im Gespr√§ch sind in Ordnung</a></li>
<li><a href="../de489042/index.html">Gro√üe Wiederer√∂ffnung des Stores: Laden von Daten mit Coroutine in Android</a></li>
<li><a href="../de489044/index.html">Physik des Textes. Teil 1. Symbole</a></li>
<li><a href="../de489046/index.html">Selbstfahrender GAZ66 Monster Truck 1/16</a></li>
<li><a href="../de489048/index.html">Protokollierung und Abfrageverfolgung sind bew√§hrte Methoden. Yandex-Bericht</a></li>
<li><a href="../de489058/index.html">Ensembles neuronaler Netze mit PyTorch und Sklearn</a></li>
<li><a href="../de489060/index.html">Analyse: Was ist der Unterschied zwischen risikoreichen und risikoarmen Anlagen?</a></li>
<li><a href="../de489062/index.html">Unglaubliche parallele Apache Parquet I / O-Leistung in Python</a></li>
<li><a href="../de489068/index.html">Digitale Unsterblichkeit - Ein technischer Ansatz</a></li>
<li><a href="../de489070/index.html">Es kostet 354 Paar Socken. Eine Auswahl an Geschenken f√ºr den 23. Februar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>