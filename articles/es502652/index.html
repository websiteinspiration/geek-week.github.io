<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛀🏼 🧕🏾 🥪 Contratos públicos, cómo garantizar su coherencia. 🙆🏿 👨🏾‍🍳 👨🏿‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- ¿Su sistema consta de muchos servicios interconectados?
- ¿Todavía actualiza manualmente el código de servicio al cambiar la API pública?
- los camb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Contratos públicos, cómo garantizar su coherencia.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/directum/blog/502652/"><ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Su sistema consta de muchos servicios interconectados?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Todavía actualiza manualmente el código de servicio al cambiar la API pública?</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">los cambios en sus servicios a menudo socavan el trabajo de otros, y otros desarrolladores lo odian por esto?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si respondió que sí al menos una vez, ¡bienvenido!</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Condiciones</font></font></h4><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contratos públicos, especificaciones</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : interfaces públicas a través de las cuales puede interactuar con el servicio. </font><font style="vertical-align: inherit;">En el texto significan lo mismo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobre qué es el artículo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aprenda a reducir el tiempo dedicado al desarrollo de servicios web utilizando herramientas para la descripción unificada de contratos y la generación automática de código. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El uso adecuado de las técnicas y herramientas que se describen a continuación le permitirá implementar rápidamente nuevas funciones y no romper las antiguas.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Cómo se ve el problema?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay un sistema que consta de varios servicios. </font><font style="vertical-align: inherit;">Estos servicios se asignan a diferentes equipos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-e/nt/tj/-enttjd6jjg8qoq2c51pw4fha0a.png"> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los servicios al consumidor dependen del proveedor de servicios. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El sistema evoluciona y un día el proveedor de servicios cambia sus contratos públicos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hk/sf/qs/hksfqs6qfhp-ptvnfidpouif2ki.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si los servicios al consumidor no están listos para el cambio, entonces el sistema deja de funcionar por completo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/1u/iv/iq/1uiviq4rc31xzihqfa4rc2qzgdy.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cómo resolver este problema</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El equipo de servicio del proveedor arreglará todo</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto se puede hacer si el equipo proveedor posee el área temática de otros servicios y tiene acceso a sus repositorios git. </font><font style="vertical-align: inherit;">Esto funcionará solo en proyectos pequeños cuando haya pocos servicios dependientes. </font><font style="vertical-align: inherit;">Esta es la opción más barata. </font><font style="vertical-align: inherit;">Si es posible, debes usarlo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actualice el código de su servicio al equipo de consumidores.</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Por qué otros se rompen, pero estamos reparando? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, la pregunta principal es cómo arreglar su servicio, ¿cómo se ve el contrato ahora? </font><font style="vertical-align: inherit;">Debe conocer el nuevo código de servicio del proveedor o comunicarse con su equipo. </font><font style="vertical-align: inherit;">Pasamos tiempo estudiando el código e interactuando con otro equipo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Piense qué hacer para evitar que aparezca el problema</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La opción más razonable a largo plazo. </font><font style="vertical-align: inherit;">Considérelo en la siguiente sección.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cómo prevenir la manifestación de un problema. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El ciclo de vida del desarrollo de software se puede representar en tres etapas: diseño, implementación y pruebas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada uno de los pasos debe ampliarse de la siguiente manera:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la etapa de diseño, defina declarativamente contratos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durante la implementación, generamos código de servidor y cliente bajo contratos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al realizar las pruebas, verificamos los contratos e intentamos tener en cuenta las necesidades del cliente (CDC).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada uno de los pasos se explica más adelante como un ejemplo de nuestro problema.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cómo se ve el problema con nosotros</font></font></h3><br>
<img src="https://habrastorage.org/webt/ws/qh/3j/wsqh3j_vzqriz0hufhvw5k4j_1i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Así es como se ve nuestro ecosistema. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los círculos son servicios y las flechas son canales de comunicación entre ellos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Frontend es una aplicación cliente basada en la web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La mayoría de las flechas conducen al Servicio de Almacenamiento. Almacena documentos. Este es el servicio más importante. Después de todo, nuestro producto es un sistema de gestión de documentos electrónicos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si este servicio cambia sus contratos, el sistema dejará de funcionar inmediatamente. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4t/mx/xx/4tmxxxgjb3e888bmekaqofdxhq8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las fuentes de nuestro sistema están escritas principalmente en C #, pero también hay servicios en Go y Python. En este contexto, no importa lo que hagan los otros servicios en la figura. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rt/qw/pu/rtqwpuk7eea5fyotxyspnctk2iq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada servicio tiene su propia implementación de cliente para trabajar con el servicio de almacenamiento. Al cambiar los contratos, debe actualizar manualmente el código en cada proyecto.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Me gustaría alejarme de la actualización manual hacia la automática. </font><font style="vertical-align: inherit;">Esto ayudará a aumentar la velocidad a la que cambia el código del cliente y reducirá los errores. </font><font style="vertical-align: inherit;">Los errores son errores tipográficos en la URL, errores por descuido, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, este enfoque no corrige errores en la lógica empresarial del cliente. </font><font style="vertical-align: inherit;">Solo puede ajustarlo manualmente.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Del problema a la tarea</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro caso, es necesario implementar </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la generación automática de código de cliente. </font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al hacerlo, se debe considerar lo siguiente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lado del servidor: los controladores ya están escritos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el navegador es un cliente del servicio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los servicios se comunican a través de HTTP.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La generación debe estar sintonizada. </font><font style="vertical-align: inherit;">Por ejemplo, para admitir JWT.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preguntas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el curso de la resolución del problema, surgieron preguntas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qué herramienta elegir;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cómo obtener contratos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dónde colocar los contratos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dónde colocar el código del cliente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en que punto hacer la generacion.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las siguientes son respuestas a estas preguntas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qué herramienta elegir</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las herramientas para trabajar con contratos se presentan en dos direcciones: RPC y REST. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/wy/3e/3k/wy3e3k54sqffxjda4tvynid6rcy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RPC puede entenderse como una simple llamada remota, mientras que REST requiere condiciones adicionales para verbos HTTP y URL.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las diferencias en la llamada RPC y REST se presentan aquí.</font></font></b>
                        <div class="spoiler_text"><div class="scrollable-table"><table>
<tbody><tr>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPC: llamada a procedimiento remoto</font></font></td>
<td colspan="2">REST Representational State Transfer</td>
</tr>
<tr>
<td colspan="2">  </td>
<td colspan="2">, HTTP-  URL</td>
</tr>
<tr>
<td></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders/PlaceOrder</td>
<td>POST</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders</td>
</tr>
<tr>
<td></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders/GetOrder?OrderNumber=1</td>
<td>GET</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders/1</td>
</tr>
<tr>
<td></td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders/UpdateOrder</td>
<td>PUT</td>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Restaurant</a>:8080/Orders/1</td>
</tr>
</tbody></table></div><br>
</div>
                    </div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tabla muestra una comparación de herramientas para trabajar con REST y RPC.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Propiedades</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openapi</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wsdl</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahorro</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gRPC</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un tipo</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DESCANSO</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rpc</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plataforma</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No depende</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lengua</font></font></td>
<td colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No depende</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secuencia de desarrollo *</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codifique primero, especifique primero</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codifique primero, especifique primero</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificaciones primero</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codifique primero, especifique primero</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protocolo de transporte</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 1.1</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cualquiera (REST requiere HTTP)</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">propio</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP / 2</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificación</font></font></td>
<td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marco de referencia </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comentario</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umbral de entrada bajo, mucha documentación</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redundancia XML, SOAP, etc.</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alto umbral de entrada, poca documentación</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Umbral de entrada promedio, mejor documentación</font></font></td>
</tr>
</tbody></table></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Código primero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : primero escribimos la parte del servidor y luego obtenemos contratos. </font><font style="vertical-align: inherit;">Es conveniente cuando el lado del servidor ya está escrito. </font><font style="vertical-align: inherit;">No es necesario describir manualmente los contratos. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Especificaciones primero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : primero definimos los contratos, luego obtenemos la parte del cliente y la parte del servidor de ellos. </font><font style="vertical-align: inherit;">Es conveniente al comienzo del desarrollo cuando todavía no hay código. </font><font style="vertical-align: inherit;">
La </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salida</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WSDL no </font><b><font style="vertical-align: inherit;">es</font></b><font style="vertical-align: inherit;"> adecuada debido a su redundancia. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apache Thrift es demasiado exótico y difícil de aprender.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GRPC requiere net Core 3.0 y net Standard 2.1. </font><font style="vertical-align: inherit;">En el momento del análisis, se utilizaron net Core 2.2 y net Standard 2.0. </font><font style="vertical-align: inherit;">No hay soporte GRPC en el navegador fuera de la caja, se requiere una solución adicional. </font><font style="vertical-align: inherit;">GRPC utiliza Protobuf y serialización binaria HTTP / 2. </font><font style="vertical-align: inherit;">Debido a esto, el rango de utilidades para probar API como Postman, etc., se está reduciendo. </font><font style="vertical-align: inherit;">Las pruebas de carga a través de algunos JMeter pueden requerir un esfuerzo adicional. </font><font style="vertical-align: inherit;">No es adecuado, cambiar a GRPC requiere muchos recursos. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAPI no requiere actualizaciones adicionales. </font><font style="vertical-align: inherit;">Captura una gran cantidad de herramientas que admiten trabajar con REST y esta especificación. </font><font style="vertical-align: inherit;">Lo seleccionamos</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas para trabajar con OpenAPI</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tabla muestra una comparación de herramientas para trabajar con OpenAPI.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swashbuckle</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSwag</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openapitools</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versiones de especificación admitidas</font></font></td>
<td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede generar especificaciones en formato OpenApi v2, v3</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Código de primer apoyo</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahi esta</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahi esta</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idiomas de servidor compatibles</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C #</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un montón de</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Idiomas de cliente compatibles</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C #, TypeScript, AngularJS, Angular (v2 +), API window.fetch</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un montón de</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraciones de generación</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahi esta</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahi esta</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ver</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paquete Nuget</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paquete Nuget + utilidad separada</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilidad separada</font></font></td>
</tr>
</tbody></table></div><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La conclusión de</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Swashbuckle no es adecuada, porque </font><font style="vertical-align: inherit;">le permite obtener solo la especificación. </font><font style="vertical-align: inherit;">Para generar código de cliente, debe usar una solución adicional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenApiTools es una herramienta interesante con un montón de configuraciones, pero no admite código primero. </font><font style="vertical-align: inherit;">Su ventaja es la capacidad de generar código de servidor en muchos idiomas. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSwag es conveniente porque es un paquete Nuget. </font><font style="vertical-align: inherit;">Es fácil conectarse al construir un proyecto. </font><font style="vertical-align: inherit;">Admite todo lo que necesitamos: primer enfoque de código y generación de código de cliente en c #. </font><font style="vertical-align: inherit;">Lo seleccionamos</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dónde concertar contratos. </font><font style="vertical-align: inherit;">Cómo acceder a servicios a contratos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aquí hay soluciones para organizar el almacenamiento por contrato. </font><font style="vertical-align: inherit;">Las soluciones se enumeran en orden de complejidad creciente.</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La carpeta del proyecto del servicio del proveedor es la opción más fácil. </font><font style="vertical-align: inherit;">Si necesita ejecutar el enfoque, elíjalo.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una carpeta compartida es una opción válida si los proyectos deseados están en el mismo repositorio. </font><font style="vertical-align: inherit;">A la larga, será difícil mantener la integridad de los contratos en la carpeta. </font><font style="vertical-align: inherit;">Esto puede requerir una herramienta adicional para dar cuenta de diferentes versiones de contratos, etc.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositorio separado para especificaciones: si los proyectos están en repositorios diferentes, entonces los contratos deben colocarse en un lugar público. </font><font style="vertical-align: inherit;">Las desventajas son las mismas que la carpeta compartida.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a través del servicio API (swagger.ui, swaggerhub), un servicio separado que se ocupa de la gestión de especificaciones.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decidimos usar la opción más simple: almacenar contratos en la carpeta del proyecto del proveedor de servicios. </font><font style="vertical-align: inherit;">Esto es suficiente para nosotros en esta etapa, entonces, ¿por qué pagar más?</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿En qué punto generas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora debe decidir en qué punto realizar la generación de código. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si se compartieran los contratos, los servicios al consumidor podrían recibir los contratos y generar el código ellos mismos si fuera necesario. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Decidimos colocar los contratos en la carpeta con el proyecto del proveedor de servicios. </font><font style="vertical-align: inherit;">Esto significa que la generación se puede realizar después del ensamblaje del proyecto de servicio del proveedor.</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dónde colocar el código del cliente</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El código del cliente se generará por contrato. </font><font style="vertical-align: inherit;">Queda por averiguar dónde colocarlo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece una buena idea poner el código del cliente en un proyecto separado StorageServiceClientProxy. </font><font style="vertical-align: inherit;">Cada proyecto podrá conectar este ensamblaje. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beneficios de esta solución:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el código del cliente está cerca de su servicio y está constantemente actualizado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">los consumidores pueden usar el enlace al proyecto dentro de un repositorio.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desventajas</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no funcionará si necesita generar un cliente en otra parte del sistema, por ejemplo, un repositorio diferente. </font><font style="vertical-align: inherit;">Se resuelve utilizando al menos una carpeta compartida para contratos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los consumidores deben estar escritos en el mismo idioma. </font><font style="vertical-align: inherit;">Si necesita un cliente en otro idioma, debe usar OpenApiTools.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sujetamos NSwag</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atributos del controlador</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesito decirle a NSwag cómo generar la especificación correcta para nuestros controladores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, necesita organizar los atributos.</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.Routing.Route(<span class="hljs-meta-string">"[controller]"</span>)</span>]  <span class="hljs-comment">//  url</span>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ApiController</span>] <span class="hljs-comment">//     </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DescriptionController</span> : <span class="hljs-title">ControllerBase</span> {<font></font>
[<span class="hljs-meta">NSwag.Annotations.OpenApiOperation(<span class="hljs-meta-string">"GetDescription"</span>)</span>] <span class="hljs-comment">//    </span>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ProducesResponseType(typeof(ConversionDescription), 200)</span>] <span class="hljs-comment">//    200  </span>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ProducesResponseType(401)</span>] <span class="hljs-comment">//    401</span>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ProducesResponseType(403)</span>] <span class="hljs-comment">//    403</span>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.HttpGet(<span class="hljs-meta-string">"{pluginName}/{binaryDataId}"</span>)</span>] <span class="hljs-comment">//  url</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> ActionResult&lt;ConversionDescription&gt; <span class="hljs-title">GetDescription</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> pluginName, Guid binaryDataId</span>)</span> { 
 <span class="hljs-comment">// ... </span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por defecto, NSwag no puede generar la especificación correcta para la aplicación / octeto-flujo tipo MIME. </font><font style="vertical-align: inherit;">Por ejemplo, esto puede suceder cuando se transfieren archivos. </font><font style="vertical-align: inherit;">Para solucionar esto, debe escribir su atributo y procesador para crear la especificación.</font></font><br>
<br>
<pre><code class="cs hljs">[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.Route(<span class="hljs-meta-string">"[controller]"</span>)</span>]<font></font>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ApiController</span>]
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FileController</span> : <span class="hljs-title">ControllerBase</span> {<font></font>
[<span class="hljs-meta">NSwag.Annotations.OpenApiOperation(<span class="hljs-meta-string">"SaveFile"</span>)</span>]<font></font>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ProducesResponseType(401)</span>]<font></font>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.ProducesResponseType(403)</span>]<font></font>
[<span class="hljs-meta">Microsoft.AspNetCore.Mvc.HttpPost(<span class="hljs-meta-string">"{pluginName}/{binaryDataId}/{fileName}"</span>)</span>]<font></font>
[<span class="hljs-meta">OurNamespace.FileUploadOperation</span>] <span class="hljs-comment">//  </span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">SaveFile</span>(<span class="hljs-params"></span>)</span> { <span class="hljs-comment">// ... }</span>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procesador para generar especificaciones para operaciones de archivo</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea es que puede escribir su atributo y procesador para manejar este atributo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Colgamos el atributo en el controlador, y cuando NSwag lo cumpla, lo procesará utilizando nuestro procesador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para implementar esto, NSwag proporciona las clases OpenApiOperationProcessorAttribute e IOperationProcessor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En nuestro proyecto, hicimos nuestros herederos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileUploadOperationAttribute: OpenApiOperationProcessorAttribute</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FileUploadOperationProcessor: IOperationProcessor</font></font></li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lea más sobre el uso de procesadores aquí.</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuración de NSwag para la generación de especificaciones y código</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las secciones principales de config 3:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tiempo de ejecución: especifica el tiempo de ejecución de .net. </font><font style="vertical-align: inherit;">Por ejemplo, NetCore22;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentGenerator: describe cómo generar una especificación;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">codeGenerators: define cómo generar código de acuerdo con la especificación.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NSwag contiene un montón de configuraciones, lo cual es confuso al principio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para mayor comodidad, puede usar NSwag Studio. </font><font style="vertical-align: inherit;">Al usarlo, puede ver en tiempo real cómo varias configuraciones afectan el resultado de la generación de código o las especificaciones. </font><font style="vertical-align: inherit;">Después de eso, seleccione manualmente la configuración seleccionada en el archivo de configuración. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lea más sobre la configuración aquí</font></font></a><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generamos la especificación y el código del cliente al ensamblar el proyecto del proveedor de servicios.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que después del ensamblaje del proyecto del proveedor de servicios, se generen la especificación y el código, haga lo siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creamos un proyecto WebApi para el cliente.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribimos una configuración para Nswag CLI - Nswag.json (descrito en la sección anterior).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribimos un PostBuild Target dentro del proyecto del proveedor de servicios csproj.</font></font></li>
</ol><br>
<code>&lt;Target Name="GenerateWebApiProxyClient“ AfterTargets="PostBuildEvent"&gt;<br>
&lt;Exec Command="$(NSwagExe_Core22) run nswag.json”/&gt;<br>
</code><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ (NSwagExe_Core22) ejecutar nswag.json - ejecuta la utilidad NSwag bajo .bet runtine netCore 2.2 con la configuración nswag.json </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Target hace lo siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSwag genera una especificación a partir de un conjunto de servicios de proveedor.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSwag genera código de cliente según la especificación.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de cada ensamblaje del proyecto del proveedor de servicios, el proyecto del cliente se actualiza. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El proyecto del cliente y el proveedor de servicios están dentro de la misma solución. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El montaje se lleva a cabo como parte de la solución. </font><font style="vertical-align: inherit;">La solución está configurada para que el proyecto del cliente se ensamble después del proyecto de servicio del proveedor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NSwag también le permite personalizar la generación de especificaciones / códigos de manera imperativa a través de la API del software.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cómo agregar soporte para JWT</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitamos proteger nuestro servicio de solicitudes no autorizadas. </font><font style="vertical-align: inherit;">Para esto, usaremos tokens JWT. </font><font style="vertical-align: inherit;">Deben enviarse en los encabezados de cada solicitud HTTP para que el proveedor de servicios pueda verificarlos y decidir si cumplir con la solicitud o no. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Más información acerca de JWT aquí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jwt.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tarea se reduce a la necesidad de modificar los encabezados de la solicitud HTTP saliente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para hacer esto, el generador de código NSwag puede generar un punto de extensión: el método CreateHttpRequestMessageAsync. </font><font style="vertical-align: inherit;">Dentro de este método hay acceso a la solicitud HTTP antes de enviarla.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de código</font></font></b>
                        <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword">protected</span> Task&lt;HttpRequestMessage&gt; <span class="hljs-title">CreateHttpRequestMessageAsync</span>(<span class="hljs-params">CancellationToken cancellationToken</span>)</span> {
      <span class="hljs-keyword">var</span> message = <span class="hljs-keyword">new</span> HttpRequestMessage();<font></font>
<font></font>
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">string</span>.IsNullOrWhiteSpace(<span class="hljs-keyword">this</span>.AuthorizationToken)) {<font></font>
        message.Headers.Authorization =<font></font>
          <span class="hljs-keyword">new</span> System.Net.Http.Headers.AuthenticationHeaderValue(BearerScheme, <span class="hljs-keyword">this</span>.AuthorizationToken);<font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword">return</span> Task.FromResult(message);<font></font>
    }<font></font>
</code></pre><br>
</div>
                    </div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusión</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Elegimos la opción con OpenAPI, porque </font><font style="vertical-align: inherit;">Es fácil de implementar y las herramientas para trabajar con esta especificación están altamente desarrolladas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conclusiones sobre la API abierta y GRPC: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API abierta</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la especificación es detallada;</font></font></li>
<li>          ,  ;</li>
<li>     ;</li>
<li>    .</li>
</ul><br>
<b>GRPC</b><br>
<br>
<ul>
<li>  ,      URL, HTTP  ..;</li>
<li>      OpenAPI;</li>
<li>    ;</li>
<li>           ;</li>
<li>     HTTP/2.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, recibimos una especificación basada en el código ya escrito de los controladores. </font><font style="vertical-align: inherit;">Para hacer esto, era necesario colgar atributos especiales en los controladores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, en base a la especificación recibida, implementamos la generación del código del cliente. </font><font style="vertical-align: inherit;">Ahora no necesitamos actualizar manualmente el código del cliente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se han realizado estudios en el área de versiones y pruebas de contratos. </font><font style="vertical-align: inherit;">Sin embargo, no fue posible probar todo en la práctica debido a la falta de recursos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versiones de contratos públicos</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Por qué versionar contratos públicos?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de los cambios en los proveedores de servicios, todo el sistema debe permanecer en un estado operativo constante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se deben evitar los cambios importantes en la API pública para no dañar a los clientes.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opciones de solucion</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sin versionar contratos públicos</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El propio equipo proveedor de servicios repara los servicios al consumidor. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/f0/k3/_6/f0k3_6ed1gt10sz1k5ol2brrj80.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este enfoque no funcionará si el equipo del proveedor de servicios no tiene acceso a los repositorios de servicios al consumidor o carece de competencias. </font><font style="vertical-align: inherit;">Si no hay tales problemas, puede hacerlo sin versionar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/-8/dd/ri/-8ddri4wch4oiugyd2bvz28zvzk.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usar versiones de contratos públicos</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El equipo del proveedor de servicios deja la versión anterior de los contratos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/xg/e9/-vxge9yyrzws2i3lbm5b6rrvbyq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este enfoque no tiene los inconvenientes del anterior, pero agrega otras dificultades. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debe decidir lo siguiente:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qué herramienta usar;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuándo presentar una nueva versión;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuánto tiempo mantener versiones antiguas.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qué herramienta usar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tabla muestra las características de OpeanAPI y GRPC asociadas con el control de versiones.</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<td></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gRPC</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Openapi</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atributo de versión</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el nivel de protobuf, hay un paquete de atributos [packageName]. [Versión]</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el nivel de especificación, hay atributos basePath (para URL) y Versión</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atributo obsoleto para métodos</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sí, pero el generador de código no lo tiene en cuenta en C #</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sí, está marcado como Obsoleto </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. NSwag no es compatible con el código primero, debe escribir su procesador</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atributo en desuso para parámetros</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Está marcado como Obsoleto</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sí, está marcado como Obsoleto </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. NSwag no es compatible con el código primero, debe escribir su procesador</font></font><br>
</td>
</tr>
</tbody></table></div><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En desuso</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> significa que ya no vale la pena usar esta API. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ambas herramientas admiten versión y atributos obsoletos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si usa OpenAPI y el primer enfoque de código, nuevamente necesita escribir procesadores para crear la especificación correcta.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando presentar una nueva versión</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nueva versión debe introducirse cuando los cambios en los contratos no conservan la compatibilidad con versiones anteriores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¿Cómo verificar que los cambios violen la compatibilidad entre las versiones nuevas y antiguas de los contratos?</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para OpenAPI hay una herramienta Azure opeanapi-diff para verificar la compatibilidad entre 2 especificaciones </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/Azure/openapi-diff;</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no se encontró ninguna herramienta automática para gRPC, solo hay políticas de versiones; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">general </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/grpc/grpc/blob/master/doc/versioning.md;</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en .Net </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com/en-us/aspnet/core/grpc/versioning?view=aspnetcore-3.1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuánto tiempo mantener versiones</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay una respuesta correcta a esta pregunta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para eliminar la compatibilidad con la versión anterior, debe saber quién utiliza su servicio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Será malo si se elimina la versión y alguien más la usa. </font><font style="vertical-align: inherit;">Es especialmente difícil si no controlas a tus clientes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, ¿qué se puede hacer en esta situación?</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">notifique a los clientes que la versión anterior ya no será compatible. </font><font style="vertical-align: inherit;">En este caso, podemos perder los ingresos del cliente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">admite todo el conjunto de versiones. </font><font style="vertical-align: inherit;">El costo del soporte de software está creciendo;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para responder a esta pregunta, debe preguntarle a la empresa: ¿los ingresos de los antiguos clientes exceden el costo de soportar versiones anteriores de software? </font><font style="vertical-align: inherit;">¿Podría ser más rentable pedirles a los clientes que actualicen?</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El único consejo en esta situación es prestar más atención a los contratos públicos para reducir la frecuencia de sus cambios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si los contratos públicos se usan en un sistema cerrado, puede usar el enfoque de los CDC. </font><font style="vertical-align: inherit;">Así podemos saber cuándo los clientes dejaron de usar versiones anteriores del software. </font><font style="vertical-align: inherit;">Después de eso, puede eliminar el soporte de la versión anterior.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusión</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use el control de versiones solo si no puede prescindir de él. </font><font style="vertical-align: inherit;">Si decide usar el control de versiones, cuando diseñe contratos, considere la compatibilidad de versiones. </font><font style="vertical-align: inherit;">Debe lograrse un equilibrio entre el costo de soportar versiones anteriores y los beneficios que proporciona. </font><font style="vertical-align: inherit;">También vale la pena decidir cuándo puede dejar de admitir la versión anterior.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prueba de contratos y CDC</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta sección está iluminada superficialmente, como </font><font style="vertical-align: inherit;">No hay requisitos previos serios para la implementación de este enfoque.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contratos impulsados ​​por el consumidor (CDC)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los CDC son la respuesta a la pregunta de cómo garantizar que el proveedor y el consumidor usen los mismos contratos. </font><font style="vertical-align: inherit;">Estos son algún tipo de pruebas de integración destinadas a verificar los contratos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea es la siguiente:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El consumidor describe el contrato.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El proveedor implementa este contrato en casa.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este contrato se utiliza en el proceso de CI en el consumidor y el proveedor. </font><font style="vertical-align: inherit;">Si se viola el proceso, alguien ha dejado de cumplir con el contrato.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pacto</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PACT es una herramienta que implementa esta idea.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El consumidor escribe pruebas usando la biblioteca PACT.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estas pruebas se convierten en un artefacto - archivo de pacto. </font><font style="vertical-align: inherit;">Contiene información sobre los contratos.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El proveedor y el consumidor usan el archivo del pacto para ejecutar las pruebas.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durante las pruebas de cliente, se crea un apéndice de proveedor, y durante las pruebas de proveedor, se crea un apéndice de cliente. </font><font style="vertical-align: inherit;">Ambos trozos usan un archivo de pacto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede lograr un comportamiento de creación de código auxiliar similar a través del Validador </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simulado de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Swagger </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">bitbucket.org/atlassian/swagger-mock-validator/src/master</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enlaces útiles sobre Pact</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pact broker: solución de gestión de archivos de pacto </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.pact.io/pact_broker</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pact aún no es compatible con GRPC. </font><font style="vertical-align: inherit;">Lea más sobre la hoja de ruta Pact </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pact.canny.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Más información sobre el PACT </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.pact.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Por qué debería usar PACT </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.pact.io/faq/convinceme?</font></font></a></li>
</ul><br>
<img src="https://habrastorage.org/webt/0u/qv/-f/0uqv-fhceairtmtcfyv6fy9b-xg.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cómo se pueden incrustar CDC en CI</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desplegando usted mismo Pact + Pact broker;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compre una solución SaaS Pact Flow preparada.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusión</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se necesita un pacto para garantizar el cumplimiento del contrato. </font><font style="vertical-align: inherit;">Se mostrará cuando los cambios en los contratos violen las expectativas de los servicios al consumidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta herramienta es adecuada cuando el proveedor se adapta al cliente: el cliente. </font><font style="vertical-align: inherit;">Esto solo es posible dentro de un sistema aislado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si está haciendo un servicio para el mundo exterior y no sabe quiénes son sus clientes, entonces Pact no es para usted.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es502636/index.html">Negocios y cyberpunk: mezclar, sostener, usar</a></li>
<li><a href="../es502638/index.html">Cómo desarrollar un blog en Instagram en 2020: análisis del caso de Sasha Mitroshina</a></li>
<li><a href="../es502642/index.html">Poner el juego "Serpiente" en el tablero. Parte 2: visualización "vector"</a></li>
<li><a href="../es502644/index.html">Cómo Sherpaa transmitió expectativas poco realistas de capital de riesgo</a></li>
<li><a href="../es502648/index.html">Los 10 conceptos erróneos principales sobre la portabilidad de Hadoop a la nube</a></li>
<li><a href="../es502654/index.html">Jack Ma tiene muchos errores en inglés, pero sus habilidades para hablar son más altas que la mayoría de los estudiantes. ¿Porqué es eso?</a></li>
<li><a href="../es502656/index.html">Microminiaturización: semiconductor magnético de dos átomos</a></li>
<li><a href="../es502660/index.html">Cómo traducir "participación" / "participantes" sin parte / participar</a></li>
<li><a href="../es502662/index.html">La vida cotidiana "alquimista"</a></li>
<li><a href="../es502666/index.html">Ensamblaje 486 - selección de componentes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>