<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🌾 🦇 😨 C ++でOpenALを使用するためのガイド。パート1：サウンドを再生する 🎨 👨🏽‍🎤 ⛲️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ゲームにはサウンドが必要です！画面上での描画にすでにOpenGLを使用していると思います。あなたはそのAPIを理解し、名前がなじみがあるように思えたため、OpenALを選びました。
 
 まあ、良いニュースは、OpenALにも非常に使い慣れたAPIがあることです。もともとはOpenGL仕様APIをシ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>C ++でOpenALを使用するためのガイド。パート1：サウンドを再生する</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/488744/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゲームにはサウンドが必要です！</font><font style="vertical-align: inherit;">画面上での描画にすでにOpenGLを使用していると思います。</font><font style="vertical-align: inherit;">あなたはそのAPIを理解し</font><font style="vertical-align: inherit;">、名前がなじみがあるように思えたため、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">選びまし</font></a><font style="vertical-align: inherit;">た。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まあ、良いニュースは、OpenALにも非常に使い慣れたAPIがあることです。</font><font style="vertical-align: inherit;">もともとはOpenGL仕様APIをシミュレートするために設計されました。</font><font style="vertical-align: inherit;">それが、ゲーム用の多くのサウンドシステムから選択した理由です。</font><font style="vertical-align: inherit;">また、クロスプラットフォームです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、C ++で書かれたゲームでOpenALを使用するために必要なコードについて詳しく説明します。</font><font style="vertical-align: inherit;">3D空間でのサウンド、音楽、サウンドの配置について、コード例とともに説明します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenALの歴史</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
簡潔に説明します。上記のように、OpenGL APIの模倣として意図的に設計されましたが、これには理由があります。これは多くの人に知られている便利なAPIであり、グラフィックがゲームエンジンの片側である場合、サウンドは異なるはずです。当初、OpenALはオープンソースであるはずでしたが、その後何かが起こりました... </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
人々はグラフィックスとしてのサウンドにそれほど興味がないので、Creativeは最終的にOpenALをそのプロパティにし、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リファレンス実装は</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">現在独占的で無料ではありません。だが！</font><font style="vertical-align: inherit;">OpenAL </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕様</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、まだ「オープン」標準です。つまり、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">公開されてい</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
仕様は随時修正されますが、多くはありません。これは特に必要がないため、サウンドはグラフィックスほど速く変化しません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オープン仕様により、他の人々が仕様のオープンソース実装を作成できました。そのような実装の1つは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL Soft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">であり、率直に言って、他のものを探すことは意味がありません。これは私が使用する実装であり、同様に使用することをお勧めします。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
彼女はクロスプラットフォームです。</font><font style="vertical-align: inherit;">それはかなり奇妙に実装されています-実際、ライブラリ内ではシステムに存在する他のサウンドAPIを使用しています。</font><font style="vertical-align: inherit;">Windowsでは、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DirectSound</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Unixでは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSSを</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用し</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このおかげで、彼女はクロスプラットフォームになることができました。</font><font style="vertical-align: inherit;">本質的に、これはラッパーAPIのビッグネームです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このAPIの速度が気になるかもしれません。</font><font style="vertical-align: inherit;">しかし、心配しないでください。</font><font style="vertical-align: inherit;">これは同じサウンドであり、大きな負荷が発生しないため、グラフィックAPIで必要とされる大規模な最適化は必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、話は十分です。テクノロジーに移りましょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenALでコードを書くために何が必要ですか？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
選択したツールチェーンでOpenAL Softを構築する必要があります。これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、ソースインストールセクションの</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手順に従って実行できる非常に単純なプロセスです</font><font style="vertical-align: inherit;">。私はこれで問題を一度も経験していませんが、問題がある場合は、元の記事の下にコメントを</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">書く</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">か</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">、OpenAL Softメーリングリストに書いてください</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、いくつかのサウンドファイルとそれらをダウンロードする方法が必要になります。バッファーへのオーディオデータの読み込みとさまざまなオーディオ形式の微妙な詳細については、この記事の範囲外ですが、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ogg / Vorbisファイルのダウンロードとストリーミング</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">について読むことができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;">。 WAVファイルのダウンロードは非常に簡単です。これに関するインターネット上の記事はすでに数百に上ります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分で決めるオーディオファイルを見つけるタスク。</font><font style="vertical-align: inherit;">あなたがダウンロードできるインターネットには多くのノイズと爆発があります。</font><font style="vertical-align: inherit;">あなたが噂を持っているなら、あなたは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">あなた自身のチップチューン音楽</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">書く</font></a><font style="vertical-align: inherit;">ことを試みることができ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ます</font></a><font style="vertical-align: inherit;"> [ </font><font style="vertical-align: inherit;">Habréの</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻訳</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
また、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenALSoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Programmers Guideも手元に置いて</font></a><font style="vertical-align: inherit;">おいて</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ください</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このドキュメントは、「公式」に特化した、より優れたPDFです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それは、実際には、すべてです。</font><font style="vertical-align: inherit;">コードの記述方法、IDEおよびツールチェーンの使用方法をすでに理解していることを前提としています。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAL APIの概要</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
何度か言ったように、これはOpenGL APIに似ています。類似性は、それが状態に基づいており、オブジェクト自体と直接ではなく、記述子/識別子と対話するという事実にあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenGLとOpenALのAPI規約には違いがありますが、重要ではありません。 OpenGLでは、レンダリングコンテキストを生成するために特別なOS呼び出しを行う必要があります。これらの課題はOSによって異なり、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">実際</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">にはOpenGL仕様の一部ではありませ</font><i><font style="vertical-align: inherit;">ん</font></i><font style="vertical-align: inherit;">。 OpenALでは、すべてが異なります。コンテキスト作成関数は仕様の一部であり、オペレーティングシステムに関係なく同じです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
APIを操作する場合、操作するオブジェクトには主に3つのタイプがあります。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスナー</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（「リスナー」）は、3D空間にある「耳」の場所です（リスナーは常に1つしかありません）。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（「ソース」）は、やはり3D空間で音を出す「スピーカー」です。</font><font style="vertical-align: inherit;">リスナーとソースは空間で移動でき、これに応じて、ゲームのスピーカーから聞こえる内容が変わります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後のオブジェクトは</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">ソースがリスナーに再生するサウンドのサンプルを保存します。</font><font style="vertical-align: inherit;">OpenALを介してオーディオが処理される方法を変更するためにゲームが使用する</font><strong><font style="vertical-align: inherit;">モード</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
もあり</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">出典</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のように、これらのオブジェクトはサウンドのソースです。</font><font style="vertical-align: inherit;">位置と方向を設定でき、再生オーディオデータのバッファに関連付けられます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスナー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ゲーム内の唯一の「耳」のセット。</font><font style="vertical-align: inherit;">リスナーが聞くものは、コンピューターのスピーカーを通して再生されます。</font><font style="vertical-align: inherit;">彼はまた地位を持っています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファー</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenGLでは、同等のものはTexture2Dです。</font><font style="vertical-align: inherit;">本質的に、これはソースが再生するオーディオデータです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">データ型</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenALは、クロスプラットフォームコードをサポートするために、特定の一連のアクションを実行し、いくつかのデータ型を定義します。</font><font style="vertical-align: inherit;">実際、これはOpenGLに準拠しているため、OpenALタイプをOpenGLタイプに直接変換することもできます。</font><font style="vertical-align: inherit;">以下の表は、それらとその同等物を示しています。</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプopenal</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openalcと入力します</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">openglと入力します</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++ Typedef</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALboolean</code></td>
<td><code>ALCboolean</code></td>
<td><code>GLboolean</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8ビットのブール値</font></font></td>
</tr>
<tr>
<td><code>ALbyte</code></td>
<td><code>ALCbyte</code></td>
<td><code>GLbyte</code></td>
<td><code>std::int8_t</code></td>
<td><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">符号</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">付き</font><font style="vertical-align: inherit;">の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">追加コードの</font></a><font style="vertical-align: inherit;"> 8ビット整数値</font></font></td>
</tr>
<tr>
<td><code>ALubyte</code></td>
<td><code>ALCubyte</code></td>
<td><code>GLubyte</code></td>
<td><code>std::uint8_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8ビットの符号なし整数値</font></font></td>
</tr>
<tr>
<td><code>ALchar</code></td>
<td><code>ALCchar</code></td>
<td><code>GLchar</code></td>
<td><code>char</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">シンボル</font></font></td>
</tr>
<tr>
<td><code>ALshort</code></td>
<td><code>ALCshort</code></td>
<td><code>GLshort</code></td>
<td><code>std::int16_t</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16ビット符号付き整数値</font></font></td>
</tr>
<tr>
<td><code>ALushort</code></td>
<td><code>ALCushort</code></td>
<td><code>GLushort</code></td>
<td><code>std::uint16_t</code></td>
<td>16-    </td>
</tr>
<tr>
<td><code>ALint</code></td>
<td><code>ALCint</code></td>
<td><code>GLint</code></td>
<td><code>std::int32_t</code></td>
<td>32-      </td>
</tr>
<tr>
<td><code>ALuint</code></td>
<td><code>ALCuint</code></td>
<td><code>GLuint</code></td>
<td><code>std::uint32_t</code></td>
<td>32-    </td>
</tr>
<tr>
<td><code>ALsizei</code></td>
<td><code>ALCsizei</code></td>
<td><code>GLsizei</code></td>
<td><code>std::int32_t</code></td>
<td> 32-   </td>
</tr>
<tr>
<td><code>ALenum</code></td>
<td><code>ALCenum</code></td>
<td><code>GLenum</code></td>
<td><code>std::uint32_t</code></td>
<td> 32- </td>
</tr>
<tr>
<td><code>ALfloat</code></td>
<td><code>ALCfloat</code></td>
<td><code>GLfloat</code></td>
<td><code>float</code></td>
<td>32-     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">IEEE 754</a></td>
</tr>
<tr>
<td><code>ALdouble</code></td>
<td><code>ALCdouble</code></td>
<td><code>GLdouble</code></td>
<td><code>double</code></td>
<td>64-     IEEE 754</td>
</tr>
<tr>
<td><code>ALvoid</code></td>
<td><code>ALCvoid</code></td>
<td><code>GLvoid</code></td>
<td><code>void</code></td>
<td> </td>
</tr>
</tbody>
</table></div><br>
<h2>  OpenAL</h2><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenALエラー認識を単純化する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
方法に関する記事がありますが、</font><font style="vertical-align: inherit;">完全を期すために、ここで繰り返します。</font><font style="vertical-align: inherit;">OpenAL API呼び出しには、通常とコンテキストの</font><font style="vertical-align: inherit;">2つの</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
で始まるコンテキスト呼び出しは</font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、Linuxでレンダリングコンテキストまたは対応するものを取得するためのOpenGL win32呼び出しに似ています。サウンドは、すべてのオペレーティングシステムが同じ呼び出しを行うのに十分単純なものです。通常の呼び出しはで始まります</font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。コンテキスト呼び出しでエラーを取得するには、を呼び出し</font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。通常の呼び出しの場合、を呼び出します</font></font><code>alGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これらは、値、</font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">考えられるエラーをリストするだけの</font><font style="vertical-align: inherit;">値</font><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">返します</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは1つのケースのみを検討しますが、他のすべてのケースではほとんど同じです。</font><font style="vertical-align: inherit;">いつもの挑戦をしましょう</font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">まず、詳細を渡すという退屈な作業を行うプリプロセッサマクロを作成します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alCall(function, ...) alCallImpl(__FILE__, __LINE__, function, __VA_ARGS__)</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理論的には、コンパイラは</font></font><code>__FILE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">どちら</font><font style="vertical-align: inherit;">もサポートしていない可能性があります</font></font><code>__LINE__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が、正直なところ、そうであることがわかった場合は驚きます。</font></font><code>__VA_ARGS__</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">このマクロに渡すことができる可変数の引数を示します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、最後に報告されたエラーを手動で受け取り、標準エラーストリームに明確な値を表示する関数を実装します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_al_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line)</span>
</span>{<font></font>
    ALenum error = alGetError();<font></font>
    <span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> AL_INVALID_NAME:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_NAME: a bad name (ID) was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_ENUM: an invalid enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_INVALID_OPERATION:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_INVALID_OPERATION: the requested operation is not valid"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> AL_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"AL_OUT_OF_MEMORY: the requested operation resulted in OpenAL running out of memory"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN AL ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
考えられるミスは多くありません。</font><font style="vertical-align: inherit;">コードで記述した説明は、これらのエラーについて受け取る唯一の情報ですが、仕様では、特定の関数が特定のエラーを返す理由を説明しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、すべてのOpenGL呼び出しをラップする2つの異なるテンプレート関数を実装します。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                alFunction function, 
                Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;
</span>{
    <span class="hljs-keyword">auto</span> ret = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);<font></font>
    check_al_errors(filename,line);<font></font>
    <span class="hljs-keyword">return</span> ret;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2つあります。1つ目はを返すOpenAL関数に使用され</font></font><code>void</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、2つ目は関数が空でない値を返すときに使用されます。</font><font style="vertical-align: inherit;">C ++のメタプログラミングテンプレートに慣れていない場合は、Cコードの各部分を確認してください</font></font><code>std::enable_if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これらは、これらのテンプレート関数のうち、関数呼び出しごとにコンパイラーによって実装されるものを決定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そして今、呼び出しについても同じです</font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> alcCall(function, device, ...) alcCallImpl(__FILE__, __LINE__, function, device, __VA_ARGS__)</span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check_alc_errors</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename, <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, ALCdevice* device)</span>
</span>{<font></font>
    ALCenum error = alcGetError(device);<font></font>
    <span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"***ERROR*** ("</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; line &lt;&lt; <span class="hljs-string">")\n"</span> ;
        <span class="hljs-keyword">switch</span>(error)<font></font>
        {<font></font>
        <span class="hljs-keyword">case</span> ALC_INVALID_VALUE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_VALUE: an invalid value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_DEVICE:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_DEVICE: a bad device was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_CONTEXT:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_CONTEXT: a bad context was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_INVALID_ENUM:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_INVALID_ENUM: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ALC_OUT_OF_MEMORY:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ALC_OUT_OF_MEMORY: an unknown enum value was passed to an OpenAL function"</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"UNKNOWN ALC ERROR: "</span> &lt;&lt; error;<font></font>
        }<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename, 
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line, 
                 alcFunction function, 
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> alcFunction, <span class="hljs-keyword">typename</span> ReturnType, <span class="hljs-keyword">typename</span>... Params&gt;
<span class="hljs-keyword">auto</span> <span class="hljs-title">alcCallImpl</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* filename,
                 <span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint_fast32_t</span> line,
                 alcFunction function,
                 ReturnType&amp; returnValue,
                 ALCdevice* device, 
                 Params... params)</span>
-&gt;<span class="hljs-keyword">typename</span> <span class="hljs-built_in">std</span>::<span class="hljs-keyword">enable_if_t</span>&lt;!<span class="hljs-built_in">std</span>::is_same_v&lt;<span class="hljs-keyword">void</span>,<span class="hljs-title">decltype</span><span class="hljs-params">(function(params...))</span>&gt;,<span class="hljs-keyword">bool</span>&gt;
</span>{<font></font>
    returnValue = function(<span class="hljs-built_in">std</span>::forward&lt;Params&gt;(params)...);
    <span class="hljs-keyword">return</span> check_alc_errors(filename,line,device);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最大の変化は、インクルージョンある</font></font><code>device</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すべてのコールを使用して、</font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">だけでなく、スタイル・エラーの対応を使用</font></font><code>ALCenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">して</font></font><code>ALC_</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">それらは非常によく似ており、非常に長い間</font><font style="vertical-align: inherit;">、コード</font><font style="vertical-align: inherit;">が大幅に</font><font style="vertical-align: inherit;">損傷し、理解できるように</font><font style="vertical-align: inherit;">から小さな変更が加えられ</font></font><code>al</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ている</font></font><code>alc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、私はその上にある本を読み続けました</font></font><code>c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで全部です。</font><font style="vertical-align: inherit;">通常、C ++でのOpenAL呼び出しは、次のいずれかのオプションのようになります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
alGenSources(<span class="hljs-number">1</span>, &amp;source);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span><font></font>
alcCaptureStart(&amp;device);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz = alGetString(param);<font></font>
ALenum error = alGetError();<font></font>
<span class="hljs-keyword">if</span>(error != AL_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz = alcGetString(&amp;device, param);<font></font>
ALCenum error = alcGetError();<font></font>
<span class="hljs-keyword">if</span>(error != ALC_NO_ERROR)<font></font>
{<font></font>
    <span class="hljs-comment">/* handle different possibilities */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、今は次のようにできます。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* example #1 */</span>
<span class="hljs-keyword">if</span>(!alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #2 */</span>
<span class="hljs-keyword">if</span>(!alcCall(alcCaptureStart, &amp;device))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #3 */</span>
<span class="hljs-keyword">const</span> ALchar* sz;
<span class="hljs-keyword">if</span>(!alCall(alGetString, sz, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment">/* example #4 */</span>
<span class="hljs-keyword">const</span> ALCchar* sz;
<span class="hljs-keyword">if</span>(!alcCall(alcGetString, sz, &amp;device, param))<font></font>
{<font></font>
    <span class="hljs-comment">/* error occurred */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奇妙に思えるかもしれませんが、私にとってはより便利です。</font><font style="vertical-align: inherit;">もちろん、別の構造を選択することもできます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.wavファイルをダウンロードする</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分でダウンロードするか、ライブラリを使用できます。</font><font style="vertical-align: inherit;">ここで</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ロード.wavファイルのオープンソース実装が</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">私はクレイジーなので、自分でやります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> <span class="hljs-title">convert_to_int</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* buffer, <span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> len)</span>
</span>{
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> a = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::endian::native == <span class="hljs-built_in">std</span>::endian::little)
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">memcpy</span>(&amp;a, buffer, len);
    <span class="hljs-keyword">else</span>
        <span class="hljs-keyword">for</span>(<span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i)
            <span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">char</span>*&gt;(&amp;a)[<span class="hljs-number">3</span> - i] = buffer[i];
    <span class="hljs-keyword">return</span> a;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">load_wav_file_header</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::ifstream&amp; file,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
                          <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
                          ALsizei&amp; size)</span>
</span>{
    <span class="hljs-keyword">char</span> buffer[<span class="hljs-number">4</span>];
    <span class="hljs-keyword">if</span>(!file.is_open())
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-comment">// the RIFF</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read RIFF"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"RIFF"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't begin with RIFF)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the size of the file</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read size of file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the WAVE</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read WAVE"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"WAVE"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (header doesn't contain WAVE)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// "fmt/0"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read fmt/0"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// this is always 16, the size of the fmt data chunk</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read the 16"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// PCM should be 1?</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read PCM"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// the number of channels</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read number of channels"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    channels = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// sample rate</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read sample rate"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    sampleRate = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">// (sampleRate * bitsPerSample * channels) / 8</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read (sampleRate * bitsPerSample * channels) / 8"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// ?? dafaq</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read dafaq"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// bitsPerSample</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">2</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read bits per sample"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    bitsPerSample = convert_to_int(buffer, <span class="hljs-number">2</span>);<font></font>
<font></font>
    <span class="hljs-comment">// data chunk header "data"</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data chunk header"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">strncmp</span>(buffer, <span class="hljs-string">"data"</span>, <span class="hljs-number">4</span>) != <span class="hljs-number">0</span>)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: file is not a valid WAVE file (doesn't have 'data' tag)"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// size of data</span>
    <span class="hljs-keyword">if</span>(!file.read(buffer, <span class="hljs-number">4</span>))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: could not read data size"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    size = convert_to_int(buffer, <span class="hljs-number">4</span>);<font></font>
<font></font>
    <span class="hljs-comment">/* cannot be at the end of file */</span>
    <span class="hljs-keyword">if</span>(file.eof())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: reached EOF on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(file.fail())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: fail state set on the file"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">char</span>* <span class="hljs-title">load_wav</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; filename,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; channels,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span>&amp; sampleRate,
               <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span>&amp; bitsPerSample,
               ALsizei&amp; size)</span>
</span>{
    <span class="hljs-function"><span class="hljs-built_in">std</span>::ifstream <span class="hljs-title">in</span><span class="hljs-params">(filename, <span class="hljs-built_in">std</span>::ios::binary)</span></span>;
    <span class="hljs-keyword">if</span>(!in.is_open())<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not open \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">if</span>(!load_wav_file_header(in, channels, sampleRate, bitsPerSample, size))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav header of \""</span> &lt;&lt; filename &lt;&lt; <span class="hljs-string">"\""</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword">char</span>* data = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[size];<font></font>
<font></font>
    in.read(data, size);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> data;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは完全に記事の主題ではないため、コードについては説明しません。</font><font style="vertical-align: inherit;">しかし</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、WAVファイルの仕様と</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">並行して読むと非常に明白</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">です</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初期化と破壊</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初にOpenALを初期化する必要があります。次に、他の優れたプログラマーと同様に、作業を終えたらそれを終了します。</font><font style="vertical-align: inherit;">これは、初期化中に使用されます</font></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（これ</font></font><code>ALC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そうで</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><i><font style="vertical-align: inherit;">ない</font></i><font style="vertical-align: inherit;">ことに注意してください</font></font><code>AL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">これ</font><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">、本質的に、バックグラウンドミュージックを再生するためのコンピューター上の何かを表し、それを使用し</font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">グラフィックカードを選択するのと同じです。</font><font style="vertical-align: inherit;">OpenGLゲームがレンダリングする場所。</font></font><code>ALCcontext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL用に作成する（オペレーティングシステムに固有の）レンダリングコンテキストに似ています。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alcdevice</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenALデバイスは、サウンドカードであろうとチップであろうと、サウンドが出力されるものですが、理論的にはさまざまなものがあります。標準出力</font></font><code>iostream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を画面ではなくプリンターに</font><font style="vertical-align: inherit;">する方法と同様に</font><font style="vertical-align: inherit;">、デバイスはファイルまたはデータストリームにすることもできます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、プログラミングゲームの場合はサウンドデバイスになるため、通常はシステムの標準的なサウンド出力デバイスにする必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
システムで利用可能なデバイスのリストを取得するには、次の関数を使用してデバイスを要求できます。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">get_available_devices</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&gt;&amp; devicesVec, ALCdevice* device)</span>
</span>{
    <span class="hljs-keyword">const</span> ALCchar* devices;
    <span class="hljs-keyword">if</span>(!alcCall(alcGetString, devices, device, <span class="hljs-literal">nullptr</span>, ALC_DEVICE_SPECIFIER))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
<font></font>
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ptr = devices;<font></font>
<font></font>
    devicesVec.clear();<font></font>
<font></font>
    <span class="hljs-keyword">do</span><font></font>
    {<font></font>
        devicesVec.push_back(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(ptr));<font></font>
        ptr += devicesVec.back().size() + <span class="hljs-number">1</span>;<font></font>
    }<font></font>
    <span class="hljs-keyword">while</span>(*(ptr + <span class="hljs-number">1</span>) != <span class="hljs-string">'\0'</span>);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは実際には、呼び出しのラッパーのラッパーにすぎません</font></font><code>alcGetString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。戻り値は、値で区切られ、</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2つの値で終わる</font><font style="vertical-align: inherit;">文字列のリストへのポインタ</font><font style="vertical-align: inherit;">です</font></font><code>null</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。ここで、ラッパーはそれを私たちにとって便利なベクトルに変換します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
幸い、これを行う必要はありません！一般的なケースでは、私が推測しているように、ほとんどのゲームはデフォルトで、デバイスにサウンドを出力できます。音声を出力するオーディオデバイスを変更するオプションはめったにありません。したがって、OpenALデバイスを初期化するには、呼び出しを使用します</font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。この呼び出しは</font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、を</font><font style="vertical-align: inherit;">介して取得できるエラー状態を指定しないため、他の呼び出しとは少し異なります</font><font style="vertical-align: inherit;">。したがって、通常の関数のように呼び出します。</font></font><br>
<br>
<pre><code class="cpp hljs">ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
<span class="hljs-keyword">if</span>(!openALDevice)<font></font>
{<font></font>
    <span class="hljs-comment">/* fail */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のようにデバイスをリストし、ユーザーがそれらの1つを選択できるようにする場合は、</font></font><code>alcOpenDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに</font><font style="vertical-align: inherit;">その名前を</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">転送する必要があります</font></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><em><font style="vertical-align: inherit;">デフォルトでデバイスを開くための</font></em></font><code>nullptr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注文の</font><font style="vertical-align: inherit;">送信</font><font style="vertical-align: inherit;">。戻り値は、対応するデバイス</font><font style="vertical-align: inherit;">か、エラーが発生した場合です。</font><font style="vertical-align: inherit;">
エニュメレーションを完了したかどうかによっては、エラーが発生してプログラムがトラックで停止する場合があります。デバイスなし= OpenALなし。 OpenALなし=音なし。音なし=ゲームなし。</font><font style="vertical-align: inherit;">
プログラムを閉じるときに最後に行うことは、プログラムを正しく完了することです。</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><code>nullptr</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean closed;
<span class="hljs-keyword">if</span>(!alcCall(alcCloseDevice, closed, openALDevice, openALDevice))<font></font>
{<font></font>
    <span class="hljs-comment">/* do we care? */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この段階で完了が不可能だった場合、これはもはや私たちにとって重要ではありません。デバイスを閉じる前に、作成されたすべてのコンテキストを閉じる必要がありますが、私の経験では、この呼び出しによってコンテキストも完了します。しかし、私たちはそれを正しく行います。呼び出しを行う前にすべてを完了すると</font></font><code>alcCloseDevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、エラーは発生しなくなります。何らかの理由でエラーが発生した場合は、何も実行できません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
からの呼び出し</font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">がデバイスの2つのコピーを送信</font><font style="vertical-align: inherit;">することに気づいたかもしれません</font><font style="vertical-align: inherit;">。これは、テンプレート関数の動作方法が原因で発生しました。1つはエラーチェックに必要で、もう1つは関数パラメーターとして使用されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
理論的には、エラーチェック用の最初のパラメーターを渡し、それを関数に送信するように、テンプレート関数を改善できます。</font><font style="vertical-align: inherit;">しかし、私はそれをするのが面倒です。</font><font style="vertical-align: inherit;">これは宿題のままにしておきます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当社のALCコンテキスト</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
初期化の2番目の部分はコンテキストです。</font><font style="vertical-align: inherit;">以前と同様に、OpenGLのレンダリングコンテキストに似ています。</font><font style="vertical-align: inherit;">1つのプログラムに複数のコンテキストがあり、それらを切り替えることができますが、これは必要ありません。</font><font style="vertical-align: inherit;">各コンテキストには独自の</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスナー</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり、コンテキスト間で渡すことはできません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
おそらく、これはサウンド処理ソフトウェアで役立ちます。</font><font style="vertical-align: inherit;">ただし、99.9％のケースのゲームでは、1つのコンテキストで十分です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
新しいコンテキストの作成は非常に簡単です：</font></font><br>
<br>
<pre><code class="cpp hljs">ALCcontext* openALContext;
<span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit program */</span>
}</code></pre><br><font style="vertical-align: inherit;"></font><code>ALCdevice</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コンテキストを作成したい</font><font style="vertical-align: inherit;">
もの</font><font style="vertical-align: inherit;">について</font><font style="vertical-align: inherit;">通信する必要があり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">オプションで、キーと値のゼロで終わるリストを渡すこともできます</font></font><code>ALCint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、コンテキストを作成するための属性です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直なところ、どのような状況で属性の受け渡しが役立つかさえわかりません。</font><font style="vertical-align: inherit;">ゲームは通常のサウンド機能を備えた通常のコンピューターで実行されます。</font><font style="vertical-align: inherit;">属性は、コンピュータに応じてデフォルト値を持っているので、これは特に重要ではありません。</font><font style="vertical-align: inherit;">ただし、それでも必要な場合：</font></font><br>
<br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性名</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALC_FREQUENCY</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hzで測定された、出力バッファーへの混合周波数</font></font></td>
</tr>
<tr>
<td><code>ALC_REFRESH</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hzで測定された更新間隔</font></font></td>
</tr>
<tr>
<td><code>ALC_SYNC</code></td>
<td><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、それが同期コンテキストか非同期コンテキスト</font><font style="vertical-align: inherit;">かを</font><font style="vertical-align: inherit;">示します</font></font></td>
</tr>
<tr>
<td><code>ALC_MONO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">モノラルオーディオデータを処理する機能を必要とするソースをいくつ使用するかを示すのに役立つ値。</font><font style="vertical-align: inherit;">最大量を制限するのではなく、事前にこれを知っていれば、より効果的になります。</font></font></td>
</tr>
<tr>
<td><code>ALC_STEREO_SOURCES</code></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じですが、ステレオデータ用です。</font></font></td>
</tr>
</tbody>
</table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラーが発生した場合、これはおそらく、必要な属性が不可能であるか、サポートされているデバイス用に別のコンテキストを作成できないことが原因です。</font><font style="vertical-align: inherit;">これはエラーになります</font></font><code>ALC_INVALID_VALUE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">無効なデバイスを渡すと、エラー</font></font><code>ALC_INVALID_DEVICE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">発生します</font><font style="vertical-align: inherit;">が、もちろん、このエラーは既に確認しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテキストを作成するだけでは不十分です。</font><font style="vertical-align: inherit;">まだそれを最新にする必要があります-それはWindows OpenGLレンダリングコンテキストのように見えますよね？</font><font style="vertical-align: inherit;">同じです。</font></font><br>
<br>
<pre><code class="cpp hljs">ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
   || contextMadeCurrent != ALC_TRUE)<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-comment">/* probably exit or give up on having sound */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテキスト（またはその中のソースとリスナー）を使用した以降の操作では、コンテキストを最新にする必要があります。</font><font style="vertical-align: inherit;">操作は</font><font style="vertical-align: inherit;">、</font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font><font style="vertical-align: inherit;">を返し</font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。送信される可能性のある唯一のエラー値</font></font><code>alcGetError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、名前から明らかなものです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンテキストで終了、つまり </font><font style="vertical-align: inherit;">プログラムを終了するときは、コンテキストが最新ではなくなってから破棄する必要があります。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>))<font></font>
{<font></font>
    <span class="hljs-comment">/* what can you do? */</span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span>(!alcCall(alcDestroyContext, openALDevice, openALContext))<font></font>
{<font></font>
    <span class="hljs-comment">/* not much you can do */</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
から発生する可能性のある唯一のエラー</font></font><code>alcDestroyContext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font></font><code>alcMakeContextCurrent</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-の</font><font style="vertical-align: inherit;">エラー</font><font style="vertical-align: inherit;">と同じ</font></font><code>ALC_INVALID_CONTEXT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">あなたがすべてを正しく行うと、あなたはそれを得ることができませんが、そうするなら、それについて何もすることができません。</font></font><br>
<br>
<blockquote><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">何もできないエラーをチェックするのはなぜですか？</font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私はそれらについてのメッセージを少なくともエラーのストリームに表示したいので、私たちには</font></font><code>alcCall</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そうします。</font><font style="vertical-align: inherit;">これにより、問題を調査</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">し、OpenAL Soft開発者にバグを報告する</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことができ</font><font style="vertical-align: inherit;">ます。</font></font></blockquote><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最初のサウンドを再生します</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さて、これで十分です。サウンドを再生してみましょう。</font><font style="vertical-align: inherit;">まず、明らかにサウンドファイルが必要です。</font><font style="vertical-align: inherit;">たとえば、これは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私がこれまでに終了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">ゲーム</font></a><font style="vertical-align: inherit;">からのもの</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<div class="oembed"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://indiegamedev.net/wp-content/uploads/2020/02/iamtheprotectorofthissystem.wav</font></font></a></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私はこのシステムの保護者です！</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
したがって、IDEを開き、次のコードを使用します。 OpenAL Softをプラグインし、上記のファイルアップロードコードとエラーチェックコードを追加することを忘れないでください。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{<font></font>
    ALCdevice* openALDevice = alcOpenDevice(<span class="hljs-literal">nullptr</span>);
    <span class="hljs-keyword">if</span>(!openALDevice)
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
<font></font>
    ALCcontext* openALContext;<font></font>
    <span class="hljs-keyword">if</span>(!alcCall(alcCreateContext, openALContext, openALDevice, openALDevice, <span class="hljs-literal">nullptr</span>) || !openALContext)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not create audio context"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
    ALCboolean contextMadeCurrent = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span>(!alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, openALContext)<font></font>
       || contextMadeCurrent != ALC_TRUE)<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not make audio context current"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
    <span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    ALuint buffer;<font></font>
    alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    ALenum format;<font></font>
    <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_MONO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_MONO16;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
        format = AL_FORMAT_STEREO8;<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
        format = AL_FORMAT_STEREO16;<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
            &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
            &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
            &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
    }<font></font>
<font></font>
    alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
    soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span><font></font>
<font></font>
    ALuint source;<font></font>
    alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
    alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
    alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
    alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
    alCall(alSourcei, source, AL_BUFFER, buffer);<font></font>
<font></font>
    alCall(alSourcePlay, source);<font></font>
<font></font>
    ALint state = AL_PLAYING;<font></font>
<font></font>
    <span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
    {<font></font>
        alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
    }<font></font>
<font></font>
    alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
    alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);<font></font>
<font></font>
    alcCall(alcMakeContextCurrent, contextMadeCurrent, openALDevice, <span class="hljs-literal">nullptr</span>);<font></font>
    alcCall(alcDestroyContext, openALDevice, openALContext);<font></font>
<font></font>
    ALCboolean closed;<font></font>
    alcCall(alcCloseDevice, closed, openALDevice, openALDevice);<font></font>
<font></font>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コンパイル！</font><font style="vertical-align: inherit;">作曲します！</font><font style="vertical-align: inherit;">ローンチ！</font></font><em><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私はこのシステムの計画者です</font></font></strong></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">音が聞こえない場合は、すべてをもう一度確認してください。</font><font style="vertical-align: inherit;">コンソールウィンドウに何かが書き込まれている場合、これはエラーストリームの標準出力であり、重要です。</font><font style="vertical-align: inherit;">エラー報告関数は、エラーを生成したソースコードの行を教えてくれるはずです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
エラー</font><font style="vertical-align: inherit;">が見つかった場合は</font><font style="vertical-align: inherit;">、「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラマガイド」</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仕様</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><font style="vertical-align: inherit;">読んで、</font><font style="vertical-align: inherit;">関数がこのエラーを生成する条件を理解してください。</font><font style="vertical-align: inherit;">これは、それを理解するのに役立ちます。</font><font style="vertical-align: inherit;">うまくいかない場合は、元の記事の下にコメントを残してください。私がお手伝いします。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RIFF WAVEデータをダウンロード</font></font></h3><br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> channels;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">int32_t</span> sampleRate;
<span class="hljs-built_in">std</span>::<span class="hljs-keyword">uint8_t</span> bitsPerSample;
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt; soundData;
<span class="hljs-keyword">if</span>(!load_wav(<span class="hljs-string">"iamtheprotectorofthissystem.wav"</span>, channels, sampleRate, bitsPerSample, soundData))<font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span> &lt;&lt; <span class="hljs-string">"ERROR: Could not load wav"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これはウェーブブートコードを指します。</font><font style="vertical-align: inherit;">重要なことは、ポインターとして、またはベクターとして収集されたデータ（チャネル数、サンプリングレート、およびサンプルあたりのビット数）を受け取ることです。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファ生成</font></font></h3><br>
<pre><code class="cpp hljs">ALuint buffer;<font></font>
alCall(alGenBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenGLでテクスチャデータバッファーを生成したことがあれば、おそらくおなじみのようです。本質的には、バッファを生成し、サウンドカードにのみ存在するように見せかけます。実際、それは通常のRAMに格納される可能性が最も高いですが、OpenAL仕様はこれらすべての操作を抽象化します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、値</font></font><code>ALuint</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">バッファ</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">へ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の</font><em><font style="vertical-align: inherit;">ハンドル</font></em><font style="vertical-align: inherit;">です。</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は基本的にサウンドカードのメモリ内のサウンドデータである</font><font style="vertical-align: inherit;">ことに注意してください</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">プログラムから（通常のRAMから）取得し、サウンドカード/チップなどに移動したため、このデータに</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直接アクセス</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">する</font><font style="vertical-align: inherit;">ことは</font><em><font style="vertical-align: inherit;">でき</font></em><font style="vertical-align: inherit;">なくなりました</font><font style="vertical-align: inherit;">。 OpenGLも同様に機能し、RAMからVRAMにテクスチャデータを移動します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">記述子</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を生成し</font></font><code>alGenBuffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">考えられるエラー値がいくつかありますが、最も重要なのはです。これは</font></font><code>AL_OUT_OF_MEMORY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、サウンドデータをサウンドカードに追加できなくなったことを意味します。</font><font style="vertical-align: inherit;">たとえば、単一のバッファを使用する場合は</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">この</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラーは発生し</font><font style="vertical-align: inherit;">ませんが</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、エンジン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">作成する</font></a><font style="vertical-align: inherit;">場合はこれを考慮する必要があります</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オーディオデータの形式を決定する</font></font></h3><br>
<pre><code class="cpp hljs">ALenum format;<font></font>
<font></font>
<span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_MONO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">1</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_MONO16;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">8</span>)<font></font>
    format = AL_FORMAT_STEREO8;<font></font>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(channels == <span class="hljs-number">2</span> &amp;&amp; bitsPerSample == <span class="hljs-number">16</span>)<font></font>
    format = AL_FORMAT_STEREO16;<font></font>
<span class="hljs-keyword">else</span><font></font>
{<font></font>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cerr</span>
        &lt;&lt; <span class="hljs-string">"ERROR: unrecognised wave format: "</span>
        &lt;&lt; channels &lt;&lt; <span class="hljs-string">" channels, "</span>
        &lt;&lt; bitsPerSample &lt;&lt; <span class="hljs-string">" bps"</span> &lt;&lt; <span class="hljs-built_in">std</span>::<span class="hljs-built_in">endl</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
サウンドデータは次のように機能します。いくつかの</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">チャネル</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">があり、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプルあたりのビット</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイズがあり</font><em><font style="vertical-align: inherit;">ます</font></em><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">データは多くの</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サンプルで</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">構成されてい</font><em><font style="vertical-align: inherit;">ます</font></em><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">オーディオデータの</font><em><font style="vertical-align: inherit;">サンプル</font></em></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
数を決定する</font><font style="vertical-align: inherit;">には、次の操作を行います。</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">int_fast32_t</span> numberOfSamples = dataSize / (numberOfChannels * (bitsPerSample / <span class="hljs-number">8</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オーディオデータの</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">継続時間の</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
計算に便利に変換できるもの</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in">std</span>::<span class="hljs-keyword">size_t</span> duration = numberOfSamples / sampleRate;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし</font></font><code>numberOfSamples</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、もも</font><font style="vertical-align: inherit;">知る必要はありませんが</font><font style="vertical-align: inherit;">、</font></font><code>duration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらすべての情報がどのように使用されているかを知ることは重要です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
戻る</font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-OpenALにオーディオデータ形式を通知する必要があります。それは明らかだと思いませんか？ OpenGLテクスチャバッファーを埋める方法と同様に、データはBGRAシーケンスであり、8ビット値で構成されていると言って、OpenALでも同じことを行う必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
後で渡すポインターが指すデータを解釈する方法をOpenALに伝えるには、データ形式を定義する必要があります。</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォーマットの</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下で</font><font style="vertical-align: inherit;">、それはOpenALによって理解されるように意味されます。考えられる意味は4つだけです。チャネル数には2つの値があります：1つはモノラル、2つはステレオです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
チャネル数に加えて、サンプルあたりのビット数も用意されています。</font><font style="vertical-align: inherit;">または</font></font><code>8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、またはに</font><font style="vertical-align: inherit;">等しく</font></font><code>16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、本質的に音質です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、波負荷関数から通知されたサンプルあたりのチャネルとビットの値を</font></font><code>ALenum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用して、将来のパラメーター</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">使用する</font><font style="vertical-align: inherit;">値を決定でき</font><font style="vertical-align: inherit;">ます</font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファー充填</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alBufferData, buffer, format, soundData.data(), soundData.size(), sampleRate);<font></font>
soundData.clear(); <span class="hljs-comment">// erase the sound in RAM</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これで、すべてが簡単になります。</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ディスクリプターが</font></font></em> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指すOpenALバッファーにロードし</font></font><code>buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">指定さ</font></font><code>soundData.data()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">れたのサイズで</font></font><code>size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><font style="vertical-align: inherit;">ptr </font><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">指すデータ</font></font><code>sampleRate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">また、OpenALにパラメータを介してこのデータのフォーマットを通知します</font></font><code>format</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後に、Wave Loaderが受信したデータを削除するだけです。</font><font style="vertical-align: inherit;">どうして？</font><font style="vertical-align: inherit;">すでにサウンドカードにコピーしているためです。</font><font style="vertical-align: inherit;">それらを2か所に保管し、貴重なリソースを費やす必要はありません。</font><font style="vertical-align: inherit;">サウンドカードがデータを失った場合、もう一度ディスクからダウンロードするだけで、CPUや他の誰かにコピーする必要はありません。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソース設定</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenALは基本的に、</font><font style="vertical-align: inherit;">1つ以上の</font><strong><font style="vertical-align: inherit;">ソース</font></strong><font style="vertical-align: inherit;">からのサウンドを聞く</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">リスナーである</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ことを</font><font style="vertical-align: inherit;">思い出してください</font><font style="vertical-align: inherit;">。さて、今こそ音源を作る時です。</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">ALuint source;<font></font>
alCall(alGenSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alSourcef, source, AL_PITCH, <span class="hljs-number">1</span>);<font></font>
alCall(alSourcef, source, AL_GAIN, <span class="hljs-number">1.0f</span>);<font></font>
alCall(alSource3f, source, AL_POSITION, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSource3f, source, AL_VELOCITY, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<font></font>
alCall(alSourcei, source, AL_LOOPING, AL_FALSE);<font></font>
alCall(alSourcei, source, AL_BUFFER, buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正直なところ、デフォルト値は私たちに非常に適しているため、これらのパラメーターの一部を設定する必要はありません。しかし、これはあなたが実験してそれらが何をするかを見ることができるいくつかの側面を示しています（あなたは狡猾に行動し、時間とともにそれらを変えることさえできます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初にソースを生成します-これ</font><font style="vertical-align: inherit;">もOpenAL API内の何かへ</font><font style="vertical-align: inherit;">の</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハンドル</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。ピッチ（トーン）が変化しないように設定し、ゲイン（ボリューム）をオーディオデータの元の値と等しくし、位置と速度をリセットします。我々は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ないループやる</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">そう、私たちのプログラムを終了することはありませんので、音を、バッファを示しています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
異なるソースが同じバッファを使用できることに注意してください。</font><font style="vertical-align: inherit;">たとえば、異なる場所からプレーヤーを撃った敵は同じショット音を再生できるため、サウンドデータの多くのコピーは必要ありませんが、3D空間のいくつかの場所からのみサウンドが生成されます。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">音を出す</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alSourcePlay, source);<font></font>
<font></font>
ALint state = AL_PLAYING;<font></font>
<font></font>
<span class="hljs-keyword">while</span>(state == AL_PLAYING)<font></font>
{<font></font>
    alCall(alGetSourcei, source, AL_SOURCE_STATE, &amp;state);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、ソースの再生を開始する必要があります。</font><font style="vertical-align: inherit;">単に電話してください</font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、</font></font><code>AL_SOURCE_STATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ソースの</font><font style="vertical-align: inherit;">現在の状態を格納する値を作成し、</font><font style="vertical-align: inherit;">それを無限に更新します。</font><font style="vertical-align: inherit;">それが等しくなくなったら、</font></font><code>AL_PLAYING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちは続けることができます。</font></font><code>AL_STOPPED</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バッファから音を出すのが終了</font><font style="vertical-align: inherit;">した</font><font style="vertical-align: inherit;">とき（またはエラーが発生</font><font style="vertical-align: inherit;">した</font><font style="vertical-align: inherit;">とき）に</font><font style="vertical-align: inherit;">状態を変更でき</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">loopingの値を設定する</font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と、サウンドは永久に再生されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に、ソースバッファーを変更して、別のサウンドを再生します。</font><font style="vertical-align: inherit;">または同じ音を再生するなど </font><font style="vertical-align: inherit;">バッファを設定し、</font></font><code>alSourcePlay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それを</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">し、</font></font><code>alSourceStop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要に応じてを使用します。</font><font style="vertical-align: inherit;">次の記事では、これをより詳細に検討します。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クリーニング</font></font></h3><br>
<pre><code class="cpp hljs">alCall(alDeleteSources, <span class="hljs-number">1</span>, &amp;source);<font></font>
alCall(alDeleteBuffers, <span class="hljs-number">1</span>, &amp;buffer);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オーディオデータを1回再生して終了するだけなので、以前に作成したソースとバッファを削除します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コードの残りの部分は説明なしで理解できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">次はどこへ？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事で説明したすべてを知っていれば、小さなゲームをすでに作成できます！</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pong</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他の古典的なゲーム</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">を作成してみてください</font></a><font style="vertical-align: inherit;">。それらはそれ以上必要ありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
でも覚えておいて！</font><font style="vertical-align: inherit;">これらのバッファは、短いサウンドにのみ適しています。</font><font style="vertical-align: inherit;">音楽や声の演技が必要な場合は、オーディオをOpenALにストリーミングする必要があります。</font><font style="vertical-align: inherit;">これについては、一連のチュートリアルの次のパートの1つで説明します。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja488730/index.html">モノのインターネット、スマートマニュファクチャリング、スマートシティの新しいロシア規格</a></li>
<li><a href="../ja488732/index.html">才能あるサイモン氏：ユニークな能力と3Dプリンティングが生産プロセスをどのように変えるか</a></li>
<li><a href="../ja488736/index.html">リモートワークが勢いを増している</a></li>
<li><a href="../ja488740/index.html">Simo AhavaによるGoogleタグマネージャー用のカスタムHTMLタグガイド</a></li>
<li><a href="../ja488742/index.html">アーキテクチャをご覧ください。そして、私は見ませんが、彼女は</a></li>
<li><a href="../ja488748/index.html">Djangoを使用してTodoアプリケーションを作成します。パート1</a></li>
<li><a href="../ja488750/index.html">恐竜ウォーク：20世紀の2台の大型コンピューター</a></li>
<li><a href="../ja488752/index.html">Golang + Phaser3 = MMORPG-私たちは世界の無限の世代の基盤を作ります</a></li>
<li><a href="../ja488754/index.html">一括：バンドルサイズの自動チェック</a></li>
<li><a href="../ja488756/index.html">新しいgooglesheets4パッケージを使用してRでGoogle Sheets API（Google Sheets API v4）を操作する方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>