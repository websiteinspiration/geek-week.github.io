<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎹 🤦🏻 🚵🏻 Write-up CTFZone Quals 2019: Huhn 🔁 💅🏿 👧🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trotz der Verschiebung der OFFZONE 2020- Konferenz wird es ein CTFZone- Finale geben ! Dieses Jahr wird es zum ersten Mal online stattfinden und aktiv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Write-up CTFZone Quals 2019: Huhn</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bizone/blog/492222/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trotz der Verschiebung der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OFFZONE 2020-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konferenz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wird</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es ein </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">CTFZone-</font></a><font style="vertical-align: inherit;"> Finale geben </font><font style="vertical-align: inherit;">! </font><font style="vertical-align: inherit;">Dieses Jahr wird es zum ersten Mal online stattfinden und aktiv in sozialen Netzwerken ausgestrahlt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden die Details später bekannt geben, aber wir schlagen vor, das Webtask-Startup bereits in der Qualifikationsphase zu untersuchen. </font><font style="vertical-align: inherit;">Die Analyse der Lösung wurde uns von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Devand MacLean</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus Kanada </font><b><font style="vertical-align: inherit;">zugesandt</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Speziell für Habr haben wir den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text des lokalen Startups übersetzt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und laden Sie ein, herauszufinden, auf welche Kette von Schwachstellen die Teilnehmer gestoßen sind und was das Huhn damit zu tun hat.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qq/kw/um/qqkwum4pqnrjnrgqxa9__wofqec.png"><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allgemeine Informationen</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autor der Aufgabe:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pavel Sorokin </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Punkte:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 470 </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anzahl der Teams, die die Aufgabe gelöst haben:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font><br>
<p><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nützliche Links:</font></font></b></p><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://gchq.github.io/CyberChef/</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/directory-structure?view=aspnetcore-3.0</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://jakeydocs.readthedocs.io/en/latest/tutorials/first-mvc-app/adding-view.html</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/0xd4d/dnSpy/releases</a></li>
</ul><br>
<h2> </h2><br>
<p>  , - :</p><br>
<ul>
<li>  <b><font color="#ff0000">(/Home/Index)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Home/Hens)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Home/Contact)</font></b>;</li>
<li>   <b><font color="#ff0000">(/Auth/Login)</font></b>.</li>
</ul><br>
<p>, &nbsp; ,   :</p><br>
<ul>
<li>    ;</li>
<li>  &nbsp;API  ,  &nbsp; .</li>
</ul><br>
<h2> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Seite / Home / Hens enthält Links zum Herunterladen von Hühnerpässen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7n/nc/1n/7nnc1nhfmbr0yfkok8ra-hqi1fo.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Decodieren von Base64 finden wir den Parameter Dateiname: 1.txt. </font><font style="vertical-align: inherit;">Mit CyberChef codieren wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / passwd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Base64 und folgen dem Link: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://web-chicken.ctfz.one/File/Download?filename=L2V0Yy9wYXNzd2Q=</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Der Inhalt der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei / etc / passwd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem Server wird </font><font style="vertical-align: inherit;">im Browser geöffnet </font><font style="vertical-align: inherit;">Wir haben das Recht, beliebige Dateien im System zu lesen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie versuchen, andere Dateien im System zu finden, stellen Sie möglicherweise einen Fehler fest, der jedes Mal auftritt, wenn Sie eine nicht vorhandene Datei anfordern (oder eine Datei, die mit den Benutzerrechten der Anwendung nicht gelesen werden kann):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/au/su/ocausuexy92ii3ackgqn2fnh-ta.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem </font><font style="vertical-align: inherit;">wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">festgestellt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> haben </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">dass sich der Fehler auf die Umgebungsvariable </font><b><font style="vertical-align: inherit;">ASPNETCORE_ENVIRONMENT</font></b><font style="vertical-align: inherit;"> bezieht </font><font style="vertical-align: inherit;">, beginnen wir mit der Untersuchung der ASP.NET Core-Webanwendungslayouts. </font><font style="vertical-align: inherit;">Und wir sehen folgendes:</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dr/oz/7s/droz7stwr6mkzt3buptphi6yt88.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die erforderlichen Pfade und Dateinamen zu konvertieren und in Base64 zu extrahieren, schreiben wir ein kleines Python-Skript ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fetch.py</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/nv/of/aqnvofypmm8iiotr8xq0koyybtg.png"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit diesem Wissen über die Struktur der in ASP.NET Core erstellten MVC-Webanwendung erhalten wir mit fetch.py ​​den Quellcode für die folgenden Dateien:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Shared/_Layout.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Index.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Contact.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Home/Hens.cshtml</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">../Views/Auth/Login.cshtml</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir dies getan und den Quellcode jeder Seite studiert haben, finden wir ein interessantes Detail in Hens.cshtml </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/7w/kp/mq/7wkpmqusqncbmjsdigxelqxxy2c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeile 1 enthält die Einschlussanweisung @ using StackHenneryMVCAppProject, die in ASP.NET einen Link zu einer DLL-Datei bedeutet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir öffnen ../StackHenneryMVCAppProject.dll - aber nicht über das Python-Dienstprogramm in Kali Linux, sondern im Browser unter Windows, da wir diese Datei in Windows dekompilieren werden. Durch die Verwendung eines solchen URL: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://web-chicken.ctfz.one/File/Download?filename=Li4vU3RhY2tIZW5uZXJ5TVZDQXBwUHJvamVjdC5kbGw=</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Öffnen DLL-Datei in dnSpy (.NET - </font><font style="vertical-align: inherit;">Decompiler), sieht sofort , </font><font style="vertical-align: inherit;">dass bei dem Verfahren </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialize ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Klasse </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Config. Die Konfiguration</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die beim Start der Webanwendung ausgeführt wird, liest den Inhalt der Datei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">horn_domains_internal.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mit einem Python-Skript extrahieren wir den Inhalt dieser Datei: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Web-Chicken-Flag</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
web-Chicken-Auth </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialize ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode </font><font style="vertical-align: inherit;">stellt </font><font style="vertical-align: inherit;">über Port 4321 eine </font><font style="vertical-align: inherit;">Verbindung zum&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web-Chicken-Flag her</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und empfängt mehrere Parameter: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RSA_key</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flag</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider ist es nicht möglich, eine Verbindung zur Web-Chicken-Flagge herzustellen. Aber wenn wir den lokalen DNS - </font><font style="vertical-align: inherit;">Hosts Rekord Web-Huhn-Auth an den Server des externen IP - </font><font style="vertical-align: inherit;">Adresse (übersetzen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">34.89.232.240</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) verwalten wir öffnen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-Huhn-Auth /</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swagger UI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Schnittstelle , </font><font style="vertical-align: inherit;">das verwendet wird Befehle über die REST-API beschreiben und ausführen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/zy/jq/he/zyjqherp-esnmlziil2jnubkram.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durchsuchen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der dekompilierten DLL-Datei können Sie feststellen, dass der </font><b><font style="vertical-align: inherit;">AuthController-</font></b><font style="vertical-align: inherit;"> Controller </font><font style="vertical-align: inherit;">nicht nur die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Login ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode, sondern auch die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode hatte </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/tz/zb/1c/tzzb1cui_v-acwn19zzbvi-5kbq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir zu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Auth / Change_Password_Test</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gehen,&nbsp; </font><b><font style="vertical-align: inherit;">sehen</font></b><font style="vertical-align: inherit;"> wir dieses Formular:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hx/-l/we/hx-lwesr4_cxhuu-ryjzb2ku76w.png"></div><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode untersuchen, </font><font style="vertical-align: inherit;">verstehen wir, dass sie vier Parameter vom Typ String über eine HTTP-POST-Anforderung verarbeitet:</font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nutzername;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neues Kennwort;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">altes Kennwort;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url.</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qx/ik/qt/qxikqtcwxuiix9mslp_stalz9ea.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Etwas niedriger in der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Change_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode, die </font><font style="vertical-align: inherit;">wir sehen: Ohne einen Wert für </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url zu erhalten</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nimmt die Methode den Wert </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf.auth_server</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><b><font style="vertical-align: inherit;">dh </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web-Chicken-Auth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und fügt dann </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> am Ende des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base_url-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Werts hinzu </font><font style="vertical-align: inherit;">, wobei die resultierende Zeichenfolge der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variablen </font><b><font style="vertical-align: inherit;">zugewiesen</font></b><font style="vertical-align: inherit;"> wird </font><font style="vertical-align: inherit;">:</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-d/aa/uj/-daaujfp1ocf8i6l9gtf1rtvemi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im nächsten wichtigen Teil des Codes werden die Zeichenfolgenwerte der </font><b><font style="vertical-align: inherit;">Parameter </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">username</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">old_password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus der HTTP-POST-Anforderung und mit ihnen das&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus der Konfiguration in die JSON-Zeichenfolge eingefügt. Anschließend wird aus diesen Daten ein JSON </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StringContent-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Objekt erstellt </font><font style="vertical-align: inherit;">, das als HTTP-POST-Daten an die </font><font style="vertical-align: inherit;">im vorherigen Schritt erstellte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestURI-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variable </font><b><font style="vertical-align: inherit;">gesendet</font></b><font style="vertical-align: inherit;"> wird </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/qd/5b/3wqd5b7hjj1ftppsvtcxvfdpdyi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt wartet der Server auf die HTTP-POST-Anforderung, um&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uri aufzufordern,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das JSON-Objekt mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parameter </font><font style="vertical-align: inherit;">0 zurückzugeben. Wenn dies nicht der Fall ist, gelangen wir zu dem Code-Zweig, der ab Zeile 6 beginnt und die Ansicht </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Views / Auth / Login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem Fehler </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ungültige Anmeldung /</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zurückgibt </font><b><font style="vertical-align: inherit;">Passwort</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn der HTTP - </font><font style="vertical-align: inherit;">POST - </font><font style="vertical-align: inherit;">Anforderung noch </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ein JSON - </font><font style="vertical-align: inherit;">Objekt mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Parameter </font><font style="vertical-align: inherit;">gleich 0, gehen wir zu dem Code - </font><font style="vertical-align: inherit;">Zweig von Zeile 11. Dann wird </font><font style="vertical-align: inherit;">die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variable </font><font style="vertical-align: inherit;">den Wert bekommt </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-Huhn-Auth</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , eine </font><font style="vertical-align: inherit;">andere JSON </font><b><font style="vertical-align: inherit;">StringContent</font></b><font style="vertical-align: inherit;"> Objekt erstellt wird</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit den Parametern aus der ursprünglichen HTTP-POST-Anforderung wie im vorherigen Teil, und diese Daten werden an die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri2-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adresse </font><font style="vertical-align: inherit;">&nbsp;in der HTTP-PUT-Anforderung </font><font style="vertical-align: inherit;">gesendet </font><font style="vertical-align: inherit;">. Schließlich wird die Nachricht " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passwort geändert"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an den Client zurückgegeben </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/cj/8y/wh/cj8ywhk0pr5vmdm8uyabhg26cf0.png"></div><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kurz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
gesagt: Der gesamte Prozess beginnt mit einer HTTP-POST-Anforderung an&nbsp; </font><b><font style="vertical-align: inherit;">/ Auth / Change_Password_Test</font></b><font style="vertical-align: inherit;"> , die eine bestimmte Anzahl von Parametern erwartet. Es nimmt diese Werte und erstellt ein JSON-Objekt, um es </font><font style="vertical-align: inherit;">über HTTP POST </font><font style="vertical-align: inherit;">an </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;base_url&gt; / auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu senden&nbsp; </font><font style="vertical-align: inherit;">. Wenn als Antwort JSON mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parameter </font><font style="vertical-align: inherit;">0 </font><font style="vertical-align: inherit;">empfangen wird </font><font style="vertical-align: inherit;">, erstellt es ein weiteres JSON-Objekt und sendet eine HTTP-PUT-Anforderung an&nbsp; </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-Chicken-Auth / Auth / Change_password</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beim Erlernen der REST-API in der Swagger-Benutzeroberfläche sehen wir, dass in der dekompilierten DLL-Datei nicht nur die Routen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;/ auth / change_password vorhanden waren</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sondern auch die Route für </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oh/kn/3p/ohkn3pbbiptuoxndp_xxo-in92q.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese API-Route erwartete ein JSON-Objekt mit zwei Parametern: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">email</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secret_token</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wenn er es erhalten hat, hat er ein JSON-Objekt mit der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eigenschaft </font><font style="vertical-align: inherit;">0 und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachrichten-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zeichenfolgen zurückgegeben </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qw/a1/j3/qwa1j37cbbppj5gpzr8iz6vdl2q.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellt sich heraus, dass </font><font style="vertical-align: inherit;">es ausreicht, eine gültige E-Mail-Adresse </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzugeben</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wenn wir die </font><b><font style="vertical-align: inherit;">Check_Password_Test ()</font></b><font style="vertical-align: inherit;"> -Methode irgendwie zwingen, die </font><font style="vertical-align: inherit;">Route </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anstelle von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sofort anzufordern </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir untersuchen erneut den Teil des Codes, in dem die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode </font><font style="vertical-align: inherit;">den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">requestUri-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wert </font><font style="vertical-align: inherit;">in der ursprünglichen HTTP-POST-Anforderung </font><font style="vertical-align: inherit;">zuweist </font><font style="vertical-align: inherit;">, und wir verstehen, dass wir den Wert </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-Chicken-auth / auth / password_recovery #</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als base_url-Parameter und requestUri im Finale senden müssen Das Ergebnis ist </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-horn-auth / auth / password_recovery # / auth / login</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Zeichen # in der HTTP-URL zeigt an, dass ein Teil der Anforderungsadresse beendet wurde. Daher ignoriert der Server, der die Anforderung empfängt, einfach den Teil </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / login</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/-d/aa/uj/-daaujfp1ocf8i6l9gtf1rtvemi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist natürlich gut, aber wir müssen nur herausfinden, wie der REST-Endpunkt, an den wir jetzt die Anfrage umleiten, den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-Mail-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wert erhält </font><font style="vertical-align: inherit;">. Ohne diesen Wert schlägt die Anfrage fehl und wir werden nicht weiter gehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir schauen uns genau an, wie die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check_Password_Test ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Methode </font><font style="vertical-align: inherit;">JSON-Daten erstellt, und stellen fest, dass die Eingabedaten überhaupt nicht gelöscht werden, sodass Sie Ihre Parameter problemlos implementieren können. Es reicht aus, die folgenden Parameter in der HTTP-POST-Anfrage zu senden: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Benutzername = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">admin</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
old_password = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pwned "," email ":" admin@chicken.ctf.zone "," lol ":"</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
new_password = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p0tat0</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
base_url = </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http: // web-Chicken-auth / auth / password_recovery #</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das resultierende JSON-Objekt wird an </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gesendet&nbsp; </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/02/h8/4-/02h84-3pz0w1c7_bg2hlyqt4k7o.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit diesen JSON-Daten haben wir die Anforderungen erfüllt, dass </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ auth / password_recovery</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Antwort zurückgeben soll. </font><b><font style="vertical-align: inherit;">Danach gibt</font></b><font style="vertical-align: inherit;"> der Server den Zweig für die Kennwortänderung ein (das JSON-Objekt enthält die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-Mail-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eigenschaft </font><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Jetzt </font><font style="vertical-align: inherit;">brauchen wir den </font><font style="vertical-align: inherit;">Wert von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">old_password</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht mehr. </font><font style="vertical-align: inherit;">In diesem </font><b><font style="vertical-align: inherit;">Codezweig haben</font></b><font style="vertical-align: inherit;"> wir alle Werte angegeben, die zum Ändern des Kennworts erforderlich sind (die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzername-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eigenschaft </font><font style="vertical-align: inherit;">lautet </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">admin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kennworteigenschaft</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p0tat0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Die Anfrage ist abgeschlossen und wir erhalten das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passwort als</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Antwort </font><b><font style="vertical-align: inherit;">geändert</font></b><font style="vertical-align: inherit;"> .</font></font><br>
 <br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dl/pa/nw/dlpanwrefhtrjpvetawk6ed2nva.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es bleibt nur noch ein neuer Benutzername und Passwort auf der Anmeldeseite einzugeben!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/zx/is/eezxiswaxjxezkq8cezfrbinggs.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und hier ist unsere Flagge:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/ge/iw/yygeiwxjauomdcsnyqp2pabdcou.png"></div></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de492212/index.html">Frontend-Entwicklung von Portalen für Open Source-Software: Erfahrungsaustausch</a></li>
<li><a href="../de492214/index.html">Warum lohnt es sich, sich beim Gehen zu treffen? Von der Wissenschaft bewiesen, von der Mafia bestätigt</a></li>
<li><a href="../de492216/index.html">Speichern von Werten in einer .NET-Anwendung in der Erstellungsphase</a></li>
<li><a href="../de492218/index.html">Zu beachtende Icon-Design-Regeln</a></li>
<li><a href="../de492220/index.html">5 wenig bekannte Geheimnisse der Pandas</a></li>
<li><a href="../de492226/index.html">Kostenvergleich für verwaltete Kubernetes (2020)</a></li>
<li><a href="../de492228/index.html">Als Sports.ru schrieb ihr WYSIWYG-Editor</a></li>
<li><a href="../de492232/index.html">Wie Smartcalls zu Voximplant Kit wurden - Rebranding- und Killer-Funktionen</a></li>
<li><a href="../de492234/index.html">Forschung: Warum Menschen bereit sind, in sozialen Projekten weniger zu erhalten</a></li>
<li><a href="../de492242/index.html">M5Stack und seine Kontakte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>