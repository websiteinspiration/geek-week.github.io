<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’‹ ğŸ•´ğŸ» ğŸ¤›ğŸ¾ Best Practices von Kubernetes. Kubernetes LebensfÃ¤higkeitstest mit Bereitschafts- und Lebendigkeitstests ğŸš‡ ğŸ âœŒğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Best Practices von Kubernetes. Erstellen kleiner Container 
 Best Practices fÃ¼r Kubernetes. Kubernetes-Organisation mit einem Namespace
 
 
 
 Verteil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Best Practices von Kubernetes. Kubernetes LebensfÃ¤higkeitstest mit Bereitschafts- und Lebendigkeitstests</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/502430/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices von Kubernetes. Erstellen kleiner Container </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Best Practices fÃ¼r Kubernetes. Kubernetes-Organisation mit einem Namespace</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/2l/kw/qe/2lkwqe-zu3jhaxqfmla1cj65koq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Verteilte Systeme kÃ¶nnen schwierig zu verwalten sein, da sie viele bewegliche verÃ¤nderbare Elemente enthalten und alle ordnungsgemÃ¤ÃŸ funktionieren mÃ¼ssen, um die FunktionalitÃ¤t des Systems sicherzustellen. Wenn eines der Elemente ausfÃ¤llt, muss das System es erkennen, umgehen und reparieren, und dies alles muss automatisch erfolgen. In dieser Kubernetes Best Practices-Reihe erfahren Sie, wie Sie Bereitschafts- und Lebendigkeitstests konfigurieren, um die LebensfÃ¤higkeit eines Kubernetes-Clusters zu testen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
IntegritÃ¤tsprÃ¼fung Mit der IntegritÃ¤tsprÃ¼fung kÃ¶nnen Sie dem System auf einfache Weise mitteilen, ob Ihre Anwendungsinstanz ausgefÃ¼hrt wird oder nicht. Wenn eine Instanz Ihrer Anwendung nicht funktioniert, sollten andere Dienste nicht darauf zugreifen oder Anforderungen an sie senden. Stattdessen sollte die Anforderung an eine andere Instanz der Anwendung gesendet werden, die bereits ausgefÃ¼hrt wird oder spÃ¤ter gestartet wird. DarÃ¼ber hinaus sollte das System Ihre Anwendung auf verlorene FunktionalitÃ¤t zurÃ¼cksetzen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
StandardmÃ¤ÃŸig sendet Kubernetes Datenverkehr an den Pod, wenn alle Container in den Herden ausgefÃ¼hrt werden, und lÃ¤dt die Container neu, wenn sie abstÃ¼rzen. FÃ¼r den Anfang kann dieses Standardverhalten des Systems recht gut sein, aber Sie kÃ¶nnen die ZuverlÃ¤ssigkeit Ihrer Produktbereitstellung durch benutzerdefinierte IntegritÃ¤tsprÃ¼fungen erhÃ¶hen.</font></font><a name="habracut"></a><br>
<br>
<img src="https://habrastorage.org/webt/ug/fr/_w/ugfr_wdknpt2o0folyontpio334.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GlÃ¼cklicherweise kÃ¶nnen Sie dies mit Kubernetes ganz einfach tun, sodass es keine Ausreden gibt, solche ÃœberprÃ¼fungen zu ignorieren. Kubernetes bietet zwei Arten von Health Check-Tests an. Es ist wichtig, die Unterschiede in den einzelnen Anwendungen zu verstehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Readiness Readiness Test soll Kubernetes mitteilen, dass Ihre Anwendung fÃ¼r den Datenverkehr bereit ist. Bevor der Dienst Datenverkehr an den Pod senden kann, muss Kubernetes Ã¼berprÃ¼fen, ob die VerfÃ¼gbarkeitsprÃ¼fung erfolgreich ist. Wenn der Bereitschaftstest fehlschlÃ¤gt, sendet Kubernetes keinen Datenverkehr mehr an den Pod, bis der Test erfolgreich ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Liveness Viability Test teilt Kubernetes mit, ob Ihre Anwendung aktiv oder tot ist. Im ersten Fall lÃ¤sst Kubernetes ihn in Ruhe, im zweiten Fall entfernt er die tote Kapsel und ersetzt sie durch eine neue.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir uns ein Szenario vor, in dem Ihre Anwendung 1 Minute benÃ¶tigt, um sich aufzuwÃ¤rmen und auszufÃ¼hren. Ihr Dienst wird erst gestartet, wenn die Anwendung vollstÃ¤ndig geladen und gestartet wurde, obwohl der Workflow bereits begonnen hat. AuÃŸerdem treten Probleme auf, wenn Sie den Umfang dieser Bereitstellung auf mehrere Kopien erhÃ¶hen mÃ¶chten, da diese Kopien erst dann Datenverkehr erhalten sollten, wenn sie vollstÃ¤ndig bereit sind. StandardmÃ¤ÃŸig sendet Kubernetes jedoch unmittelbar nach dem Start der Prozesse im Container Datenverkehr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem Bereitschaftstest wartet Kubernetes, bis die Anwendung vollstÃ¤ndig gestartet ist, und erst danach kann der Dienst Datenverkehr an eine neue Kopie senden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/3g/ol/wj/3golwjtf8e-peabrur40nlxmy08.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir uns ein anderes Szenario vor, in dem eine Anwendung fÃ¼r eine lange Zeit einfriert und die Bearbeitung von Anforderungen beendet. Da der Prozess weiterhin ausgefÃ¼hrt wird, berÃ¼cksichtigt Kubernetes standardmÃ¤ÃŸig, dass alles in Ordnung ist, und sendet weiterhin Anforderungen an den nicht funktionierenden Pod. Bei Verwendung von Liveness erkennt Kubernetes jedoch, dass die Anwendung keine Anforderungen mehr bearbeitet, und startet standardmÃ¤ÃŸig einen nicht funktionierenden Pod neu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-b/9z/-b/-b9z-bhznyyzrlsz9eh51nrkmmy.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ãœberlegen Sie, wie Sie Bereitschaft und VitalitÃ¤t testen kÃ¶nnen. Es gibt drei Testmethoden: HTTP, Befehl und TCP. Sie kÃ¶nnen jeden von ihnen zur ÃœberprÃ¼fung verwenden. Die gebrÃ¤uchlichste Benutzertestmethode ist eine HTTP-Sonde.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auch wenn Ihre Anwendung kein HTTP-Server ist, kÃ¶nnen Sie in Ihrer Anwendung einen einfachen HTTP-Server erstellen, um mit dem Liveness-Test zu interagieren. Danach pingt Kubernetes den Ping an den Pod. Wenn die HTTP-Antwort im Bereich von 200 oder 300 ms liegt, bedeutet dies, dass der Pod â€gesundâ€œ ist. Andernfalls wird das Modul als "ungesund" markiert. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vo/uy/pq/vouypq-yjyxuldceusrnb7njndw.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei Tests mit Command fÃ¼hrt Kubernetes den Befehl in Ihrem Container aus. Wenn der Befehl mit einem Exit-Code von Null zurÃ¼ckgegeben wird, wird der Container als fehlerfrei markiert. Andernfalls wird der Container als "krank" markiert, wenn die Exit-Statusnummer zwischen 1 und 255 liegt. Diese Testmethode ist nÃ¼tzlich, wenn Sie den HTTP-Server nicht starten kÃ¶nnen oder mÃ¶chten, aber einen Befehl ausfÃ¼hren kÃ¶nnen, der den Zustand Ihrer Anwendung Ã¼berprÃ¼ft.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/68/e6/ki/68e6kiogqoollyhciz0zdvdrp0s.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der letzte ÃœberprÃ¼fungsmechanismus ist der TCP-Test. Kubernetes versucht, eine TCP-Verbindung am angegebenen Port herzustellen. Wenn dies mÃ¶glich ist, wird der BehÃ¤lter als gesund angesehen, wenn nicht, ist er nicht lebensfÃ¤hig. Diese Methode kann nÃ¼tzlich sein, wenn Sie ein Skript verwenden, in dem das Testen mit einer HTTP-Anforderung oder BefehlsausfÃ¼hrung nicht sehr gut funktioniert. Die Hauptdienste fÃ¼r die ÃœberprÃ¼fung mit TCP sind beispielsweise gRPC oder FTP.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wp/or/mt/wpormt0xbafznizmg8ybwgfiay8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tests kÃ¶nnen auf verschiedene Arten mit verschiedenen Parametern konfiguriert werden. Sie kÃ¶nnen festlegen, wie oft sie ausgefÃ¼hrt werden sollen, wie hoch die Schwellenwerte fÃ¼r Erfolg und Misserfolg sind und wie lange auf Antworten gewartet werden soll. Weitere Informationen finden Sie in der Dokumentation zum Bereitschaftstest. Es gibt jedoch einen sehr wichtigen Punkt beim Einrichten des Liveness-Tests - die anfÃ¤ngliche Einstellung der initialDelaySeconds-TestverzÃ¶gerung. Wie bereits erwÃ¤hnt, fÃ¼hrt der Fehler dieses Tests zu einem Neustart des Moduls. Daher mÃ¼ssen Sie sicherstellen, dass der Test erst gestartet wird, wenn die Anwendung betriebsbereit ist. Andernfalls wird der zyklische Neustart gestartet. Ich empfehle die Verwendung der P99-Startzeit oder der durchschnittlichen Startzeit der Anwendung aus dem Puffer. Vergessen Sie nicht, diesen Wert als einzustellenda die Startzeit Ihrer Anwendung schneller oder langsamer wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die meisten Experten werden bestÃ¤tigen, dass Health Check eine obligatorische PrÃ¼fung fÃ¼r jedes verteilte System ist, und Kubernetes ist keine Ausnahme. </font><font style="vertical-align: inherit;">Die Verwendung der IntegritÃ¤tsprÃ¼fung der Dienste gewÃ¤hrleistet zuverlÃ¤ssige und betriebsbereite Kubernetes und macht keine Arbeit fÃ¼r Benutzer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wird sehr bald fortgesetzt ...</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/mxEvAPQRwhw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen Werbung :)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank fÃ¼r Ihren Aufenthalt bei uns. GefÃ¤llt dir unser Artikel? MÃ¶chten Sie weitere interessante Materialien sehen? UnterstÃ¼tzen Sie uns, indem Sie eine Bestellung </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">aufgeben</font></a><font style="vertical-align: inherit;"> oder Ihren Freunden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cloud-basiertes VPS fÃ¼r Entwickler ab 4,99 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> empfehlen </font><font style="vertical-align: inherit;">, ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einzigartiges Analogon von Einstiegsservern, das wir fÃ¼r Sie erfunden haben: </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die ganze Wahrheit Ã¼ber VPS (KVM) E5-2697 v3 (6 Kerne) 10 GB DDR4 480 GB SSD 1 Gbit / s ab 19 $ oder wie teilt man den Server?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfÃ¼gbar). </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R730xd 2-mal gÃ¼nstiger im Equinix Tier IV-Rechenzentrum in Amsterdam?</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nur wir haben </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel TetraDeca-Core Xeon 2x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV von 199 US-Dollar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Niederlanden!</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lesen Sie mehr Ã¼ber</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Aufbau eines InfrastrukturgebÃ¤udes. </font><font style="vertical-align: inherit;">Klasse C mit Dell R730xd E5-2650 v4-Servern fÃ¼r 9.000 Euro fÃ¼r einen Cent?</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de502418/index.html">3D-Bildmonitor</a></li>
<li><a href="../de502420/index.html">Interessante CSS-Funde im Twitter-Design</a></li>
<li><a href="../de502422/index.html">Reduzierung der React Native-AnwendungsgrÃ¶ÃŸe um 60% in wenigen einfachen Schritten</a></li>
<li><a href="../de502424/index.html">Stoppen Sie den Import ganzer JavaScript-Pakete</a></li>
<li><a href="../de502428/index.html">Syntaktische Leckereien Julia</a></li>
<li><a href="../de502432/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends fÃ¼r die letzte Woche Nr. 415 (11.-17. Mai 2020)</a></li>
<li><a href="../de502436/index.html">CI TeamCity - Automatisierung von Build-Prozessen fÃ¼r Android- und UI-Tests</a></li>
<li><a href="../de502438/index.html">Material Python. Benutzerdefinierte Karten mit OpenGL-Effekten</a></li>
<li><a href="../de502440/index.html">Erstellen von Anwendungen mit Mediapipe</a></li>
<li><a href="../de502442/index.html">PHP Digest Nr. 180 (4. - 18. Mai 2020)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>