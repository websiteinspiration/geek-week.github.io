<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßôüèª üë®üèª‚Äçüåæ üëêüèΩ Pre√ßo caro de estilos. Relat√≥rio Yandex üëΩ üíÉ ‚õ∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Carregar CSS em uma p√°gina √© uma opera√ß√£o de bloqueio. Se o carregamento ass√≠ncrono do JavaScript n√£o estiver vis√≠vel para o usu√°rio, a apar√™ncia lent...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Pre√ßo caro de estilos. Relat√≥rio Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/501998/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregar CSS em uma p√°gina √© uma opera√ß√£o de bloqueio. </font><font style="vertical-align: inherit;">Se o carregamento ass√≠ncrono do JavaScript n√£o estiver vis√≠vel para o usu√°rio, a apar√™ncia lenta dos estilos poder√° expulsar um visitante impaciente do site. </font><font style="vertical-align: inherit;">Como carregar CSS da maneira mais eficiente e transparente poss√≠vel para os usu√°rios? </font><font style="vertical-align: inherit;">Nikita Dubko est√° tentando descobrir</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DarkMeFoDy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do grupo de interface de pesquisa Yandex em Minsk.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kATRlMrtaaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Ol√° a todos. </font><font style="vertical-align: inherit;">Vou falar sobre os estilos. </font><font style="vertical-align: inherit;">Todo mundo est√° falando sobre TypeScript e TypeScript hoje. </font><font style="vertical-align: inherit;">E eu vou falar sobre o script estilo Cascade.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouco sobre mim. </font><font style="vertical-align: inherit;">Sou desenvolvedor da Bielorr√∫ssia - depois do filme Dudya, digo isso em todos os lugares. </font><font style="vertical-align: inherit;">Voc√™ pode ter ouvido minha voz no podcast de padr√µes da Web e, se voc√™ encontrar erros de digita√ß√£o no feed de not√≠cias dos padr√µes da Web, provavelmente sou eu tamb√©m. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouco aviso. </font><font style="vertical-align: inherit;">Haver√° v√°rias insanidades no relat√≥rio - trate tudo o que digo com grandes cr√≠ticas. </font><font style="vertical-align: inherit;">Pense por que voc√™ pode usar essas t√©cnicas e por que n√£o precisa delas. </font><font style="vertical-align: inherit;">Algumas coisas ser√£o realmente loucas. </font><font style="vertical-align: inherit;">Vai.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelo que?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para come√ßar - por que falar sobre otimiza√ß√£o de CSS? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ come√ßar a procurar nos mecanismos de pesquisa downloads r√°pidos de JS, h√° muitos resultados. Se voc√™ procura um carregamento r√°pido de CSS, a parte superior nem exibe o CSS necess√°rio. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/fy/mh/fdfymhsjiglvpavgqbzxrczyqo8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ olhar para o Google, existem 111 milh√µes de resultados sobre JS e CSS, apenas 26 milh√µes, </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ent√£o talvez isso n√£o importe? Por que falar sobre isso? Se voc√™ procurar relat√≥rios de desempenho JS, encontrar√° muitos deles. H√° sobre React, sobre todos os tipos de outras estruturas, sobre Vanilla, etc. Mas sobre CSS, encontrei apenas um relat√≥rio. Harry Roberts em 2018 leu um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interessante </font><font style="vertical-align: inherit;">sobre o desempenho do CSS. Eu pensei ter encontrado um segundo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por Roma Dvornova, ‚ÄúCSS Parsim: dicas e truques de desempenho‚Äù. Mas acabou sendo um relat√≥rio JS que analisa CSS. N√£o √© exatamente o que precisamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que eles n√£o pensam muito em CSS. √â uma vergonha. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas quando vou para a web, geralmente vejo HTML. E tamb√©m vejo CSS que estiliza a p√°gina. Mas eu n√£o vejo JS. JS √© algo que move CSS e HTML em uma p√°gina para deixar tudo bonito. Este √© um script. E se o JS n√£o carregar, n√£o ser√° t√£o ruim quanto se o CSS n√£o carregar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erros no JS caem silenciosamente no console. E √© improv√°vel que o usu√°rio comum entre no DevTools para procurar: "Ah, voc√™ est√° a√≠, um erro no console". Mas se o CSS n√£o carregar, talvez voc√™ n√£o veja tudo o que precisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, existem estudos sobre o fato de que o principal √© causar uma primeira impress√£o.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38% dos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usu√°rios podem acessar o site e, se perceberem que √© diretamente nojento, sair√£o imediatamente. E </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">88%</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v√£o tolerar, us√°-lo uma vez e, em seguida, eles nunca retornam e dificilmente aconselhar√£o seu site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora que estamos todos sentados em casa, o tr√°fego da Internet aumentou especialmente. E precisamos pensar em como fornecer com efici√™ncia quaisquer recursos aos usu√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar contar do ponto de vista do Yandex. Se pudermos otimizar cada entrega do Yandex por 100 ms e fornecer, digamos, 200 milh√µes de p√°ginas por dia (n√£o sei o n√∫mero exato), neste dia economizaremos 0,1 s * 200 milh√µes = 232 pessoas-dia. Apenas otimizando a sa√≠da por 100 milissegundos. E CSS tamb√©m faz isso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos jogar um pouco de detetives e descobrir como tirar o m√°ximo proveito dos estilos de carregamento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A medida!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O primeiro conselho √© sempre medir tudo. N√£o h√° sentido em fazer otimiza√ß√µes teoricamente. Voc√™ pode supor que a otimiza√ß√£o funcione no seu caso, mas medi√ß√µes reais mostrar√£o que nada disso. Essa √© a regra mais importante de qualquer otimiza√ß√£o. </font><font style="vertical-align: inherit;">Andrei Prokopyuk, da equipe SERP Velocity do HolyJS, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muito bem </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">sobre</font></a><font style="vertical-align: inherit;"> como fazemos isso </font><font style="vertical-align: inherit;">, n√£o vou me repetir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quais ferramentas de medi√ß√£o existem? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Se voc√™ deseja medir em dispositivos mais ou menos reais, lento, n√£o t√£o legal quanto o seu, use o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Eu costumo fazer medi√ß√µes l√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Voc√™ possui o Lighthouse se usar navegadores baseados no Chromium. Ele, como medi√ß√µes locais, mostra coisas muito boas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Se voc√™ tem certeza de que pode fazer tudo sozinho, v√° para o DevTools, na guia Desempenho. Tem muitos detalhes, voc√™ pode iniciar suas pr√≥prias m√©tricas e analis√°-las. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/xl/jl/vxxljlbogdfjvd0v2kyqedewfxy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, no desempenho, √© necess√°rio definir condi√ß√µes reais. Voc√™ est√° sentado no seu laptop legal com Internet legal no escrit√≥rio, tudo √© incr√≠vel aqui, mas eles v√™m at√© voc√™ e dizem: "Estou lento". E voc√™ diz: "Tudo funciona para mim". N√£o fa√ßa assim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sempre tente verificar como o usu√°rio, nas condi√ß√µes do metr√¥ ou em outro lugar, usar√° seu site. Para fazer isso, voc√™ precisa configurar uma Internet muito lenta. Tamb√©m √© aconselh√°vel desacelerar a CPU, porque algu√©m pode vir at√© voc√™ a partir de um Nokia 3110. Ele tamb√©m precisa mostrar o site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais importante: avalie em usu√°rios reais. Existe essa m√©trica, mais precisamente, todo um conjunto de m√©tricas - RUM, Real User Monitoring. √â quando voc√™ mede n√£o o que acontece sinteticamente no seu c√≥digo, mas as m√©tricas de usu√°rios reais na produ√ß√£o. Por exemplo, do carregamento de uma p√°gina para uma a√ß√£o. Uma a√ß√£o √©, por exemplo, algo que funciona no navegador ou at√© mesmo um clique em algum elemento importante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembre-se de que voc√™ n√£o est√° desenvolvendo para rob√¥s. Sotka em Lighthouse - √© √≥timo, √© muito bom. Portanto, voc√™ cumpre pelo menos os requisitos que o Farol define. Mas existem usu√°rios reais e, se o usu√°rio n√£o conseguir ver a p√°gina ao carregar o Lighthouse, voc√™ est√° fazendo algo errado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z-/fy/cn/z-fycndvddxfylx_s_ahdxjolpc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem m√©tricas importantes para se concentrar. </font><font style="vertical-align: inherit;">Esta √© a primeira pintura com conte√∫do, quando o primeiro conte√∫do aparecer em sua p√°gina com o qual voc√™ pode fazer algo, leia. </font><font style="vertical-align: inherit;">Essa m√©trica √© enviada nos navegadores Chromium, voc√™ pode obt√™-la. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/xi/mi/mtximitp8tflgksudiaaporikko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recentemente, voc√™ ainda pode ver a Maior pintura com conte√∫do. </font><font style="vertical-align: inherit;">Muitas vezes acontece que voc√™ tem uma p√°gina de m√≠dia e √© importante, por exemplo, ver uma foto nela. </font><font style="vertical-align: inherit;">Ent√£o voc√™ precisa dessa m√©trica espec√≠fica.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregamento CSS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos finalmente passar ao CSS, como o CSS √© carregado. </font><font style="vertical-align: inherit;">As recep√ß√µes s√£o conhecidas h√° muito tempo. </font><font style="vertical-align: inherit;">H√° um caminho de renderiza√ß√£o cr√≠tica, um caminho de renderiza√ß√£o cr√≠tica. </font><font style="vertical-align: inherit;">√â sobre o que o navegador faz desde o momento do envio da solicita√ß√£o do recurso at√© o momento em que os pixels s√£o exibidos na tela do usu√°rio. </font><font style="vertical-align: inherit;">Sobre isso, tamb√©m, h√° v√°rios artigos e relat√≥rios. </font><font style="vertical-align: inherit;">Mas vamos dar uma r√°pida olhada em como esse navegador faz isso.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS ‚Äî  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele come√ßa a baixar HTML, v√™ tags. </font><font style="vertical-align: inherit;">Ele gradualmente os analisa, entende o que fazer com eles. </font><font style="vertical-align: inherit;">Carrega. </font><font style="vertical-align: inherit;">Veio atrav√©s do link. </font><font style="vertical-align: inherit;">Deve ser usado. </font><font style="vertical-align: inherit;">Mas como? </font><font style="vertical-align: inherit;">Primeiro voc√™ precisa fazer o download. </font><font style="vertical-align: inherit;">O download √© lento. </font><font style="vertical-align: inherit;">Quando carrega, come√ßa a analisar mais a p√°gina.</font></font><br>
<br>
<pre><code class="html hljs xml"> <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS ‚Äî  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>-!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se deparar com outro link, ser√° bloqueado novamente e n√£o permitir√° a execu√ß√£o. </font><font style="vertical-align: inherit;">Bloqueia JS, bloqueia a an√°lise. </font><font style="vertical-align: inherit;">E at√© inicializar, n√£o faz nada. </font><font style="vertical-align: inherit;">Mas ent√£o come√ßa a trabalhar mais.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;link&gt;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos aprofundar - o que acontece quando voc√™ acessa o link? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/eb/cs/3webcs2yte1_pqw5nzwvmj_epy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gravar para onde vamos √© padr√£o. </font><font style="vertical-align: inherit;">Existe um estilo CSS que fica em algum lugar. </font><font style="vertical-align: inherit;">Agora est√° na moda colocar todas as estat√≠sticas na CDN.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onde ir?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, o navegador precisa entender para onde ir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u8/me/ix/u8meixyugzfctlaocm2xzo862po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele v√™ o URL e precisa entender esse URL - sobre o que √©? Estamos acostumados ao fato de que o URL √© um identificador de site. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/26/2m/6b/262m6bmfjupam-ega9z7tmpibzk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas fisicamente precisamos obter o endere√ßo IP desta URL e ir para a m√°quina f√≠sica real no endere√ßo IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ys/nq/ah/ysnqah21cz075zefg6khjupdm-w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o seu CDN, ele receber√° um registro no DNS e ser√° direcionado diretamente para o endere√ßo IP. Como algu√©m pode acelerar neste caso? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lz/cl/sn/lzclsnosywf5yaqi0fihvdefism.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma ideia maluca √© reduzir a dist√¢ncia do usu√°rio ao servidor DNS. Pegue e transplante o usu√°rio. Por exemplo, para exibir a mensagem: "Sente-se mais perto" ou "Aproxime-se". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode especificar imediatamente o endere√ßo IP no link. Por que precisamos procurar DNS, resolver dom√≠nios, se voc√™ pode fornecer imediatamente o resultado por endere√ßo IP? Essa √© uma maneira louca, mas no caso dos servidores DNS globais do DDoS, ele pode at√© salv√°-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E podemos nos livrar de obter um endere√ßo IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s4/i0/1v/s4i01v9rasbbahddidnteghzu8a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passando para o index.html ou para outro arquivo, voc√™ j√° sabe o endere√ßo de dom√≠nio para onde vai. Aqui est√° exatamente o caso em que, em vez de armazenar est√°tica em um dom√≠nio ou subdom√≠nio separado, voc√™ pode colocar a estat√≠stica mais pr√≥xima do seu dom√≠nio, a saber, o pr√≥prio dom√≠nio. Ent√£o o DNS n√£o precisa ser resolvido, ele j√° est√°. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zn/l1/gg/znl1ggztpsl37dgk1cmfo0ob8c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s descobrimos para onde ir. Mas podemos fazer essas coisas com anteced√™ncia para o navegador. Se, por exemplo, sua folha de estilos for carregada muito mais tarde atrav√©s da √°rvore do DOM, voc√™ poder√° dizer ao navegador usando &lt;link rel = "dns-prefetch"&gt; que "Eu ainda n√£o vou l√°, mas voc√™ aquece os recursos, definitivamente precisarei deles mais tarde "</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esta entrada, voc√™ diz ao navegador para descer e obter esse DNS. </font><font style="vertical-align: inherit;">Quando o link aparecer no c√≥digo, o navegador j√° saber√° o endere√ßo IP deste dom√≠nio. </font><font style="vertical-align: inherit;">Voc√™ pode fazer essas coisas preliminares. </font><font style="vertical-align: inherit;">A mesma coisa, por exemplo, antes de entrar na pr√≥xima p√°gina, para onde voc√™ definitivamente ir√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, o navegador sabe para onde ir. </font><font style="vertical-align: inherit;">Ele precisa entender como ir.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como ir</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos assistindo o protocolo. Agora, √© claro, https √© um requisito direto. A inclus√£o de mecanismos de pesquisa marcar√° seus sites n√£o em https com formul√°rios como n√£o totalmente seguros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://howhttps.works/why-do-we-need-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©rie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> incr√≠vel </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://howhttps.works/why-do-we-need-"><font style="vertical-align: inherit;">de</font></a><font style="vertical-align: inherit;"> quadrinhos sobre como o quadro funciona https. Mas somos pessoas de TI, adoramos diagramas complexos legais e quadrinhos engra√ßados s√£o f√°ceis demais. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, formulei com minhas pr√≥prias palavras como o https funciona. Primeiro voc√™ obt√©m um certificado SSL do seu servidor. Em seguida, voc√™ deve verificar o certificado em uma autoridade de certifica√ß√£o. Estes s√£o servidores especiais que sabem o que √© v√°lido e o que n√£o √©, e podem solicitar navegadores: "Sim, est√° tudo bem aqui, use este certificado".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, √© apresentada a gera√ß√£o de chaves para comunica√ß√£o entre o servidor e o cliente, criptografia e descriptografia usando chaves diferentes. O processo √© interessante se voc√™ o examinar em termos de criptografia. Mas queremos acelerar. Qu√£o? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/g1/ue/pqg1ueqmruwadkjjb7ff5sstwu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos novamente transferir o usu√°rio para mais perto dos servidores. J√° temos um DNS, agora podemos aproxim√°-lo da autoridade de certifica√ß√£o. E colocar entre esses servidores ser√° perfeito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode desativar o https, por que precisamos dele? N√≥s gastamos tempo obtendo um certificado, criptografar, descriptografar. Na verdade n√£o. Este √© o conselho mais prejudicial do relat√≥rio, n√£o fa√ßa isso. https √© prote√ß√£o de dados do usu√°rio, e http / 2 n√£o funcionar√° sem https, e http / 2 √© outra maneira de acelerar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° tamb√©m a tecnologia de grampeamento OCSP. Voc√™ pode verificar um certificado sem uma autoridade de certifica√ß√£o. Provavelmente isso est√° mais pr√≥ximo do DevOps. Voc√™ precisa configurar seu servidor de uma certa maneira para que ele possa armazenar em cache a resposta da Autoridade de Certifica√ß√£o e emitir para o usu√°rio: "Acredite, meu certificado √© realmente real". Assim, podemos salvar pelo menos a etapa em que vamos √† autoridade de certifica√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas h√° uma nuance - no Chrome, isso n√£o funciona e por um longo tempo. Mas para o usu√°rio de outros navegadores, voc√™ pode acelerar esse processo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu j√° disse duas vezes que √© necess√°rio transplantar o usu√°rio, e a ideia est√° subindo no ar - para aproximar o servidor do usu√°rio. Eu n√£o descobri nada de novo para voc√™. Esta √© uma CDN, uma rede de entrega de conte√∫do distribu√≠do. A id√©ia √© que voc√™ possa usar o sidienki pronto, criar sua pr√≥pria infraestrutura de forma independente e colocar v√°rios servidores em todo o mundo, tanto quanto o dinheiro e as oportunidades permitirem. Mas voc√™ precisa organizar o servidor para que um usu√°rio da Austr√°lia v√° para servidores australianos. Aqui a velocidade da luz joga com voc√™, quanto menor a dist√¢ncia, mais r√°pido os el√©trons a passam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos cavar mais fundo. O que mais est√° acontecendo na solicita√ß√£o? De fato, https √© apenas um inv√≥lucro sobre http. N√£o √© apenas um inv√≥lucro legal. E se for ainda mais profundo, o http √© uma solicita√ß√£o da fam√≠lia TCP / IP.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wl/be/sf/wlbesfr8mnsmulrqrlgazdwxa_4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como os pacotes e bytes s√£o enviados na rede para que todos os navegadores, clientes e servidores se comuniquem? </font><font style="vertical-align: inherit;">A primeira coisa que um cliente / servidor faz em uma conex√£o TCP / IP √© um handshake. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas em 2020, a OMS recomenda evitar apertos de m√£o. </font><font style="vertical-align: inherit;">Existe uma tecnologia TCP Fast Open t√£o legal. </font><font style="vertical-align: inherit;">Voc√™ pode, no momento do aperto de m√£o, evitar toda a cadeia ‚ÄúOl√°, eu sou um cliente‚Äù - ‚ÄúOl√°, eu sou um servidor‚Äù - ‚ÄúEu acredito em voc√™‚Äù - ‚ÄúE eu acredito em voc√™. </font><font style="vertical-align: inherit;">Vai". </font><font style="vertical-align: inherit;">Voc√™ j√° pode enviar dados √∫teis neste momento. </font><font style="vertical-align: inherit;">E se o aperto de m√£o foi bem-sucedido, parte dos dados √∫teis passou. </font><font style="vertical-align: inherit;">Este √© o TCP Fast Open.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que pegar?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos descobrir o que o cliente deve buscar no servidor. </font><font style="vertical-align: inherit;">O principal n√£o √© que o cliente pegue algo do servidor, mas o servidor entregue os dados ao cliente. </font><font style="vertical-align: inherit;">Ent√£o voc√™ pode pensar: User-Agent. </font><font style="vertical-align: inherit;">Posso obter o User-Agent do cliente, descobrir em qual navegador o usu√°rio efetuou login. </font><font style="vertical-align: inherit;">Descubra aproximadamente se este navegador n√£o me engana.</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.example</span> {
    <span class="hljs-attribute">display</span>: -ms-grid;
    <span class="hljs-attribute">display</span>: grid;
    <span class="hljs-attribute">-webkit-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-o-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-webkit-user-select</span>: none;
       <span class="hljs-attribute">-moz-user-select</span>: none;
        <span class="hljs-attribute">-ms-user-select</span>: none;
            <span class="hljs-attribute">user-select</span>: none;
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-webkit-gradient</span>(linear, left top, left bottom, from(white), <span class="hljs-built_in">to</span>(black));
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-o-linear-gradient</span>(top, white, black);
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, white, black);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Digamos que ele fez login no Firefox. </font><font style="vertical-align: inherit;">Como de costume, eu tenho um assembly no qual o autoprefixer est√° conectado √† uma brega, gerou um monte de c√≥digo para mim. </font><font style="vertical-align: inherit;">Sim, √© uma abordagem legal de que tudo funcionar√° em qualquer lugar. </font><font style="vertical-align: inherit;">Mas eu j√° sei que o usu√°rio efetuou login no Firefox. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que n√£o desligar todo o excesso? </font><font style="vertical-align: inherit;">Concordo, h√° muito menos linhas, enviamos menos bytes, isso √© legal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos uma vers√£o lite do SERP, Granny. </font><font style="vertical-align: inherit;">Vitaly Kharisov falou sobre ela</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vithar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">nos dias de padr√µes da Web. Ele usa exatamente essa abordagem. Podemos gerar v√°rios pacotes e entreg√°-los a diferentes clientes de maneiras diferentes. Eles pesam muito menos, porque o Firefox √© seu, o WebKit √© seu, e funciona, √© verificado. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/av/3l/rj/av3lrjwxk0h7r1uvu2soqygili8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais longe. Provavelmente processamos solicita√ß√µes de usu√°rios, sabemos que a pessoa est√° autorizada e usamos algumas informa√ß√µes pessoais para ela. √â l√≥gico que devemos obter algo do banco de dados. Mas nem todos! Existem coisas est√°ticas que n√£o diferem para nenhum dos usu√°rios, elas s√£o exatamente iguais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
James Akvuh leu um </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">relat√≥rio</font></a><font style="vertical-align: inherit;"> interessante sobre isso</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúRenderiza√ß√£o do lado do servidor. </font><font style="vertical-align: inherit;">Fa√ßa Voc√™ Mesmo". </font><font style="vertical-align: inherit;">Qual √© o ponto? </font><font style="vertical-align: inherit;">Voc√™ j√° sabe que possui HTML e algum tipo de CSS que √© o mesmo para todos os usu√°rios. </font><font style="vertical-align: inherit;">Antes de escolher qualquer dado, voc√™ pode gerar a sa√≠da desses dados est√°ticos e enviar imediatamente o mais √∫til em um fluxo do servidor. </font><font style="vertical-align: inherit;">E depois disso - v√° para os dados, receba-os rapidamente, converta-os em modelos e entregue-os ao cliente. </font><font style="vertical-align: inherit;">E o usu√°rio j√° ver√° algo √∫til.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seu navegador n√£o suporta v√≠deo HTML5.</font></font><source src="https://mefody.dev/talks/css-cost/images/screencast-yandex-prerender.mp4" type="video/mp4"></video></div></div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√≥s implementamos isso h√° muito tempo. Temos na SERP, na p√°gina principal de pesquisa, duas fases - pr√©-pesquisa e p√≥s-pesquisa. A pr√©-pesquisa √© quando enviamos todas as pe√ßas que n√£o precisam de conhecimento sobre qual usu√°rio efetuou login. J√° podemos dar a ele, por exemplo, um chap√©u. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, temos uma barra de pesquisa que o usu√°rio pode come√ßar a usar antes que todo o resto seja carregado. Isso √© √∫til em uma conex√£o lenta. N√≥s fazemos isso, funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E eu tamb√©m falei sobre http / 2. Isso √© totalmente suportado pelos navegadores modernos; portanto, se voc√™ ainda n√£o o configurou no servidor, descubra como configur√°-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Server Push √© uma tecnologia interessante que diz: ‚ÄúNavegador, ainda n√£o lhe dei o conhecimento de que voc√™ precisa de algum tipo de CSS. Mas eu sei exatamente o que √© necess√°rio. Ent√£o segure, pr√©-carregue. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6b/hr/do/6bhrdomeghpruxrhggwss8lpe4a.png"><br>
<br>
<img src="https://habrastorage.org/webt/0_/h-/eo/0_h-eognhuhs4pp55sj0rzltkly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o √© d√≠ficil. Voc√™ precisa configurar alguns cabe√ßalhos no servidor e tudo come√ßar√° a funcionar. Se o navegador n√£o conhece esse t√≠tulo, nada vai quebrar, isso √© o mais bonito. Vamos cavar ainda mais. TCP J√° falamos sobre isso: um aperto de m√£o, bytes s√£o enviados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/f4/gy/htf4gytrvdio_te6zyz5wsevhn8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lave as m√£os ap√≥s um aperto de m√£o. Por√©m, em termos de TCP, come√ßamos a encaminhar bytes e os algoritmos s√£o otimizados o suficiente para que o servidor cliente n√£o fique ocioso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, um determinado segmento de dados √© enviado primeiro. Por padr√£o, (isso pode ser alterado nas configura√ß√µes), s√£o 1460 bytes. O servidor n√£o envia informa√ß√µes em um segmento. Ele envia janelas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira janela √© 14600 bytes, dez segmentos. Ent√£o, se a conex√£o for boa, ele come√ßa a ampliar as janelas. Se a conex√£o for ruim, poder√° reduzir a janela. O que √© importante entender? Existe a primeira janela de dez segmentos, na qual voc√™ deve ajustar o site inteiro, se desejar. E ent√£o haver√° a velocidade m√°xima do conte√∫do. </font><font style="vertical-align: inherit;">Vitaliy Kharisov </font><font style="vertical-align: inherit;">tamb√©m leu um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre isso </font><font style="vertical-align: inherit;">. E sim, √© poss√≠vel ajustar um site com tudo o que voc√™ precisa em uma janela se voc√™ desativar, por exemplo, o JS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma nuance importante. </font><font style="vertical-align: inherit;">Quando voc√™ preenche um segmento inteiro, √© um segmento. </font><font style="vertical-align: inherit;">Mas se voc√™ enviar apenas um byte extra, o servidor ainda enviar√° um segmento extra inteiro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h4/8v/ut/h48vut1nv1yldqqdo2ubbe3miai.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode fazer uma otimiza√ß√£o interessante, reduzir a produ√ß√£o em um kilobyte inteiro, mas n√£o ver√° nada nas suas medi√ß√µes - talvez por isso. </font><font style="vertical-align: inherit;">Tente fazer a otimiza√ß√£o normalmente em v√°rios segmentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estranho: sou um tip√≥grafo e digo coisas complexas para servidores. </font><font style="vertical-align: inherit;">Vamos nos aproximar ainda mais do CSS real.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enviar menos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, enviamos menos para o usu√°rio, menos segmentos, chega mais r√°pido, o usu√°rio fica feliz. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/76/hb/6l/76hb6lkb_giyi6iwvnfvaui4yuk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minifica√ß√£o. Ela foi criada em seus projetos. Existem v√°rias ferramentas interessantes, plug-ins de pacotes da web, configura√ß√µes de gole - em geral, voc√™ vai descobrir por si mesmo. Voc√™ pode personaliz√°-lo manualmente, mas parece apenas quando voc√™ tem certeza de que pode compactar seu CSS mais frio do que qualquer CSSO. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembre-se de ativar a compacta√ß√£o. Se pelo menos o gzip n√£o estiver ativado em 2020, voc√™ definitivamente est√° fazendo algo errado, porque esta √© uma t√©cnica de compress√£o antiga. Em geral, em 2020, √© hora de usar brotli. Essa √© uma boa maneira de reduzir um pouco a sa√≠da nos navegadores Chromium. Ou, se voc√™ n√£o deseja oferecer suporte ao brotli, pelo menos pode tentar o zopfli.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse √© um algoritmo de compacta√ß√£o bastante lento para o gzip, que simplesmente fornece os melhores resultados de compacta√ß√£o e descompacta t√£o r√°pido quanto o gzip comum. Portanto, o zopfli precisa ser configurado com sabedoria e usado somente quando voc√™ n√£o precisa enviar dados em tempo real. Voc√™ pode configurar os arquivadores gzip a serem coletados durante a montagem usando o algoritmo zopfli, e enviados estaticamente j√°, de fato, n√£o est√£o em movimento. Isso pode ajud√°-lo. Mas tamb√©m me√ßa os resultados.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pu/f6/sm/puf6smovgfumpzw6cdrj4nxvjzo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos esses algoritmos usam algum tipo de dicion√°rio: um dicion√°rio √© constru√≠do com base na repeti√ß√£o de fragmentos de c√≥digo. Mas √†s vezes eles dizem: √© necess√°rio alinhar, se alinhamos, ent√£o nos livramos da solicita√ß√£o. Vincular todo o CSS em HTML ser√° muito r√°pido. O truque √© que o gzip funciona um pouco mais eficientemente quando voc√™ divide os estilos e o HTML, porque os dicion√°rios s√£o diferentes, mais eficientes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No meu caso, peguei a p√°gina de inicializa√ß√£o, vinculei a inicializa√ß√£o e comparei as duas vers√µes. O gzip sobre recursos individuais √© 150 bytes a menos. Sim, o ganho √© muito pequeno. Aqui tamb√©m √© preciso medir tudo. Mas no seu caso, isso pode, por exemplo, reduzir o n√∫mero de segmentos em um.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como otimizar o c√≥digo? N√£o estou falando de minifica√ß√£o. Tire o que voc√™ n√£o est√° usando no projeto. Provavelmente voc√™ possui um c√≥digo que nunca ser√° executado no cliente. Pelo que? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oc/qy/i3/ocqyi32nsmaifhfwjtobuhbfyt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que voc√™ possa automatizar isso, guias especiais s√£o incorporadas ao navegador, por exemplo, no Chrome DevTools, isso √© Cobertura, que informa: "Eu n√£o usei esse CSS ou esse JS, voc√™ pode cort√°-lo". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas voc√™ pode ter foco, ativo, algo instalado usando JS. Voc√™ precisa simular todas as a√ß√µes poss√≠veis no site, s√≥ assim voc√™ ter√° certeza de que esse CSS poder√° ser cortado. Chris Coyer tem um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> revis√£o </font><font style="vertical-align: inherit;">sobre ferramentas autom√°ticas que tentam fazer tudo com foco e foco. Mas ele chegou √† conclus√£o de que era imposs√≠vel automatizar isso. Ainda n√£o deu certo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anton Kholkin da Booking.com, onde eles tamb√©m tentaram remover montes de c√≥digo legado. </font><font style="vertical-align: inherit;">Mas eles tinham uma peculiaridade: um c√≥digo legado que vinha de projetos externos. </font><font style="vertical-align: inherit;">Foi necess√°rio remov√™-lo. </font><font style="vertical-align: inherit;">Veja que solu√ß√µes interessantes eles encontraram. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ mesmo pode tentar jogar com o mesmo Puppeteer, que √© como o Chrome. </font><font style="vertical-align: inherit;">Voc√™ pode fazer testes que passam automaticamente por tudo, tentar pairar, se concentrar. </font><font style="vertical-align: inherit;">E use essa mesma cobertura. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minha colega Vitya Khomyakov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">victor-homyakov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiz meu pr√≥prio </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como encontrar duplicatas e estilos em uma p√°gina. Basta pegar, copiar e colar. Ele escrever√° para voc√™ no console: "esse seletor, ao que parece, voc√™ n√£o precisa". At√© o ponto que acabou de entrar no DevTools. √â incrivel. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5q/4i/4g/5q4i4gjomb59s7ry5xcukiqi0zc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um recurso que eu realmente gosto nas ferramentas dos desenvolvedores do Firefox: uma oportunidade de ver estilos que parecem ser usados, mas na verdade o navegador n√£o os aplica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, voc√™ pode definir display: inline e parece que este display: inline n√£o faz sentido definir tamanhos. Ou alinhamento vertical, funciona apenas para c√©lulas em linha ou tabela. At√© agora, s√≥ vi no Firefox que ele pode destacar: "voc√™ n√£o precisa dessa linha".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui tamb√©m √© preciso ter cuidado: talvez voc√™ use esse estilo para colar a classe posteriormente. Mas, na minha opini√£o, um recurso interessante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa a si mesmo a pergunta agora: voc√™ precisa de todo o Bootstrap no projeto? Coloque qualquer estrutura CSS usada em vez do Bootstrap. Provavelmente, voc√™ usa o Bootstrap para grades e elementos mais ou menos comuns e metade do Bootstrap n√£o √© necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tente usar a montagem corretamente. Quase todas as estruturas CSS modernas permitem que voc√™ use o c√≥digo-fonte para montagem e selecione apenas o que voc√™ precisa. Isso pode reduzir drasticamente o tamanho do pacote CSS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o doar sem uso. Em vez de procurar meu legado, voc√™ pode usar o entendimento no n√≠vel de compila√ß√£o de que esta p√°gina n√£o usar√° esse CSS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, uma pilha BEM completa permite que voc√™ fa√ßa a montagem para que voc√™, j√° fornecendo a p√°gina, possa construir uma √°rvore de todos os componentes dos blocos BEM que estar√£o na p√°gina. O BEM permite determinar que, se esse bloco n√£o estiver na p√°gina, n√£o h√° necessidade de carregar esse CSS. Envie apenas o necess√°rio. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© os funcion√°rios do Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dizem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : use o BEM, ele pode realmente ajud√°-lo na otimiza√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu n√£o acredito que digo isso em voz alta, mas neste caso o CSS-in-JS parece ser uma boa abordagem. Quando voc√™ escreve componentes independentes independentes e configura cuidadosamente o assembly ou determina em tempo de execu√ß√£o quais blocos s√£o usados ‚Äã‚Äãe quais n√£o s√£o, voc√™ pode se livrar do problema de encontrar um c√≥digo legado simplesmente n√£o enviando esse c√≥digo ao cliente. Parece f√°cil, mas √© necess√°ria disciplina. Pense nisso com anteced√™ncia no in√≠cio do projeto.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/he/na/zrhenay2u6hrppvi4jx-ams_njo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que outra op√ß√£o existe? Um pouco louco. Neste c√≥digo, parece que o estilo n√£o √© necess√°rio, porque usamos uma div - o padr√£o j√° √© display: block. E vamos excluir todos os padr√µes? Se em seu projeto voc√™ tiver certeza de que a marca√ß√£o HTML nunca ser√° alterada novamente - passe pelos valores padr√£o que o navegador j√° fornece e remova-os. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menos estilos - √≥timo! Mas isso √© novamente uma ideia maluca. O CSS n√£o precisa saber sobre HTML, porque √© um estilo. √â bastante independente, voc√™ deve conect√°-lo a outro projeto, ele deve funcionar l√°. E sim, √© dif√≠cil de manter. Mude a etiqueta - tudo quebra. Ideia louca como prometido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use vari√°veis. CSS possui vari√°veis ‚Äã‚Äãmuito antigas, como currentColor.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vh/eg/om/vhegomyxszcuft3mc8rloetjmio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muitas vezes, existe um padr√£o: voc√™ deseja, por exemplo, criar um bot√£o cujo texto e borda sejam da mesma cor. E, ao passar o mouse, mudamos os dois. Pelo que? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/-5/jl/-v-5jle8hdyn94asbckxmh0ev_i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° uma vari√°vel currentColor que recebe um valor da cor e voc√™ a coloca, por exemplo, na borda, proxy essa propriedade e altera apenas uma linha ao passar o mouse, focalizar, ativo, o que voc√™ quiser. Isso parece conveniente, e o c√≥digo se tornou uma linha a menos. Voc√™ pode otimizar. A prop√≥sito, neste exemplo, voc√™ n√£o pode usar a tarefa de cor da borda, porque, por padr√£o, ela j√° recebe um valor da propriedade color. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Äs vezes, √© muito triste observar como o base64 √© usado. No CSS, era recomendado ativamente antes: use base64 para injetar pequenos √≠cones. Se ele se encaixa em um segmento sobre o TCP, √© bom para voc√™. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/95/uu/rb/95uurb_rsvp6_xjhnolso-ftl-o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas Harry Roberts tamb√©m</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conduziu um</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estudo elegante sobre como a base64 afeta o carregamento da p√°gina. Sim, h√° menos solicita√ß√µes, mas esses estilos s√£o analisados ‚Äã‚Äã√†s vezes mais lentamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, a an√°lise √© uma opera√ß√£o muito r√°pida, o usu√°rio provavelmente n√£o notar√°. Mas temos uma m√©trica importante - a primeira renderiza√ß√£o, para que o usu√°rio veja algo na p√°gina. Nos celulares, a primeira renderiza√ß√£o, de acordo com um estudo de Harry Roberts, ocorre dez vezes depois. Pense se voc√™ precisa do base64? Sim, h√° menos solicita√ß√µes, mas isso teve algum efeito? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E por favor n√£o use base64 para SVG. Porque o SVG √© √≥timo para usar o codificador de URL. Julia Bukhvalova tem uma </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">ferramenta</font></a><font style="vertical-align: inherit;"> legal</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Entre, cole seu SVG e ele exibir√° o CSS em um formato pronto para colar. Voc√™ pode perceber que n√£o h√° base64, mas algumas coisas escaparam que no CSS podem n√£o ser percebidas corretamente. √â muito mais eficiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em m√©dia, o base64 oferece um acr√©scimo de 30% ao tamanho do que voc√™ comprime. Pelo que? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use tecnologia moderna. Talvez seja necess√°rio oferecer suporte ao Internet Explorer - os argumentos usuais ao falar sobre grades. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pe/mg/xu/pemgxutjaqos0iq67ch7qdzudnc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas pense bem: se voc√™ n√£o tem suporte para o IE e ainda digita em float ou tabelas, pode usar grades para criar um layout de tr√™s colunas com uma diferen√ßa de 20 pixels - essa √© a dist√¢ncia entre as colunas. Tr√™s linhas Bem, cinco, considerando o an√∫ncio em si.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tente isso em um carro aleg√≥rico. E quero dizer que alteramos tr√™s linhas, incluindo o nome das classes, se voc√™ tocar em HTML. Eu n√£o encontrei uma maneira de fazer o mesmo legal em um carro aleg√≥rico. Jogue fora suas decis√µes. Mas use a tecnologia moderna. Eles permitem que voc√™ indique de forma mais compacta a marca√ß√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ji/vb/ze/jivbzezcoj7ou78zj5ylexaxd8i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode experimentar o Atomic CSS. O que √© isso? Voc√™ escreve esses nomes de classe um pouco loucos. Depois de algum tempo, voc√™ come√ßa a entender que √© voc√™ quem define a cor de fundo ou apenas a cor. Estes s√£o os "recursos" para CSS. Mas voc√™ tem um conjunto fixo de CSS que voc√™ usa em HTML como uma indica√ß√£o de estilo. E o CSS est√° subitamente ficando menor. Para projetos grandes, ele realmente se tornar√° menor, porque h√° menos estilos √∫nicos. Mas voc√™ est√° desenvolvendo HTML.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/77/fl/gy77flr72xq4fuxlgz0jq3etfcu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode olhar na dire√ß√£o do Tailwind CSS, que agora est√° ganhando popularidade. N√£o √© CSS at√¥mico, trata-se de classes de utilidade, semelhantes ao Bootstrap, apenas mais utilit√°rias. Voc√™ pode usar um conjunto espec√≠fico. O suficiente parece ser suficiente para voc√™. Um conjunto de classes que executam suas fun√ß√µes. Voc√™ tamb√©m pode tentar, mas n√£o exagere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kn/ir/8j/knir8jsxsmezohd8gouoba98pk4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra id√©ia maluca - por que precisamos de nomes de classe inteiros no cliente? Sim, √© conveniente para desenvolvimento e depura√ß√£o, mas vamos pegar todos os nomes de classe e transform√°-los em uma letra. Ser√° menos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre como fazer isso. Voc√™ pode configurar o webpack ou outro plug-in ao criar. Mas n√£o decolou de n√≥s. N√≥s tentamos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aconteceu que o gzip √© t√£o legal que tudo foi muito bem otimizado para n√≥s, e o BEM e o gzip s√£o incrivelmente amig√°veis. </font><font style="vertical-align: inherit;">Como as constru√ß√µes de texto s√£o repetidas para descrever blocos e elementos no c√≥digo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, isso nos deu quase nenhum lucro. </font><font style="vertical-align: inherit;">Mas se, por exemplo, voc√™ n√£o tiver o BEM e um monte de classes diferentes, poder√° tentar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importante: medir. </font><font style="vertical-align: inherit;">Me√ßa todas essas pe√ßas experimentais. </font><font style="vertical-align: inherit;">Talvez agora funcione para voc√™ e, em seguida, voc√™ alterou levemente a arquitetura do projeto, ele come√ßou a se montar de maneira diferente e tudo ficou mais lento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baixe!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At√© agora, eu s√≥ falei sobre como baixar um arquivo. N√≥s o baixamos. O que o usu√°rio viu todo esse tempo? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/0l/8e/hv0l8e1uk89lmfqategu9yux-je.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele viu uma tela t√£o incr√≠vel. Enquanto est√°vamos baixando, a tela estava em branco. Fizemos o download e o navegador inicia mais seis etapas. Seja um pouco paciente, vou falar sobre eles um pouco mais r√°pido do que sobre o download. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4c/zj/yy/4czjyy-8-jl4c4qdm9dzgczmfes.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar com a an√°lise. A an√°lise √© quando um navegador baixa um fluxo de bytes e come√ßa a dividi-lo em entidades que ele entende.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/709/df0/50d/709df050daf8e241e96c31e73c720fad.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, ele se deparou com importa√ß√£o. Isso novamente deve ser baixado. Leia a primeira parte do relat√≥rio novamente? A importa√ß√£o √© uma opera√ß√£o de bloqueio. Mas os navegadores s√£o inteligentes. Eles t√™m um scanner de pr√©-carregamento. Eu disse que tudo est√° bloqueado l√°, isso n√£o √© verdade. Os navegadores sabem que, por exemplo, se houver tr√™s tags de link seguidas que seguem o estilo, quando eu baixar o primeiro, voc√™ poder√° come√ßar a baixar o segundo e o terceiro. Ele n√£o pode analisar, porque toda a estrutura da an√°lise √© interrompida. Mas fa√ßa o download com anteced√™ncia - pode. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/yw/qw/abywqwqotl2uyae8y67kpx_-6ky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o importar √© uma coisa ruim. Se os estilos forem consistentes em HTML, o navegador ver√° que iremos al√©m em outro arquivo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/zb/-k/xfzb-kzu_zycogs1kilkjp73rsy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E se voc√™ o inserir diretamente na importa√ß√£o, primeiro fa√ßa o download do seu style.css e veja a importa√ß√£o. Ele come√ßa a analisar esse CSS ... Sim, bloqueamos tudo de uma maneira nova e procuramos o arquivo! Assim, voc√™ pode fazer uma cachoeira legal com desoptimiza√ß√£o no site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esque√ßa a importa√ß√£o ou configure para que n√£o haja importa√ß√£o ap√≥s a compila√ß√£o. Para o ambiente de desenvolvimento, ok, mas n√£o para o usu√°rio. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/2g/lx/le2glxus3towgrovquopecvq1nu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, passamos pelas etapas de constru√ß√£o de √°rvores, usando o Cascade. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qo/g-/q8/qog-q84eqwq9dszmfw3zlo7f__0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo isso tamb√©m √© descrito por um longo tempo. O CSS Object Model √© constru√≠do - uma √°rvore especial de como o navegador mapeia tags, classes para estilos. Ele vincula tudo ao DOM e faz essas conex√µes muito rapidamente. Quando voc√™ muda alguma coisa, basta que ele mude dentro da √°rvore.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/kv/b1/cpkvb1obn0v0kwyr1ijpgmc3vmc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto maior o seletor, mais dif√≠cil √© para o navegador desenhar uma √°rvore. Ele precisa analisar o seletor, convert√™-lo em estruturas em √°rvore. E se voc√™ inseriu! Importante l√°, ele deve levar isso em conta. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/z_/ld/abz_ldlw6yhtfzvfiak5pjnnjem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que √© hora de falar sobre o BEM novamente. Mas o BEM n√£o √© necess√°rio se voc√™ souber usar classes de utilit√°rio, se uma classe for respons√°vel por uma funcionalidade e elas n√£o interferirem entre si. Ent√£o construir uma √°rvore √© muito simples. Voc√™ tem uma estrutura bastante plana e, em seguida, o navegador deve vincul√°-lo corretamente ao DOM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w3/tt/fd/w3ttfdtaor_cd7m8e4gikrch4po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ fizer isso, eles dizem que esses seletores desaceleram a an√°lise de CSS. Mas essas s√£o lendas h√° muito tempo, a diferen√ßa √© t√£o pequena para o navegador que, no projeto m√©dio, voc√™ n√£o perceber√° se otimizar seletores com asteriscos. Mas voc√™ gostaria de desenvolver e manter esse c√≥digo? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/83/1d/po831d3idqqnykaw8ieprtg5eoo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu costumava ouvir dicas: tente colocar tudo em um atalho. background √© um atalho para muitas outras propriedades. Colocamos tudo em uma propriedade e ela se torna ideal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por bytes, sim, est√° ficando menor. Mas se voc√™ deseja otimizar a composi√ß√£o do CSS OM, o navegador ainda far√° com que todas essas propriedades ocorram em segundo plano. Os navegadores para cada elemento DOM criam uma tabela de todas as propriedades que ele pode ter. Quando voc√™ olha para os valores calculados do DevTools, eles n√£o est√£o l√° porque o navegador os calculou de acordo com seus requisitos. Ele armazena isso na mem√≥ria, porque √© muito mais f√°cil reescrever uma propriedade e tudo funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse tamb√©m √© um conselho muito estranho, mas se voc√™ quiser acelerar o CSS OM, poder√° definir imediatamente todas as propriedades, uma de cada vez. Isso pode funcionar. Mas o tamanho do pacote aumentar√° bastante. Voc√™ precisa medir. Duvido que d√™ lucro, mas de repente!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando o CSS OM √© criado, o JS tamb√©m est√° bloqueado neste momento. Se a constru√ß√£o do OM CSS demorar dois segundos, o JS falhar√°. Embora eu n√£o possa imaginar como voc√™ conseguiu escrever tanto em CSS que a √°rvore foi criada por dois segundos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/25/0e/un/250eunwpu4yepgffhza-6g1u2dg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, o navegador faz o Layout. Esta √© a localiza√ß√£o de todos os elementos DOM, o uso de posi√ß√µes. Ele entende onde o elemento deve estar localizado e com quais dimens√µes. Parece que, nesta fase, o usu√°rio j√° deve ver algum tipo de imagem. Mas ele v√™ tudo na janela de exibi√ß√£o, pode olhar atrav√©s de uma janela limitada. Se algo n√£o est√° certo por baixo, ele simplesmente n√£o v√™.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/af/_r/hgaf_racfuoqjcan8wci-i94miu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A id√©ia √© chamada CSS cr√≠tico e tamb√©m √© bastante antiga. Voc√™ insere algumas coisas importantes para a primeira tela no in√≠cio do download. Por exemplo, em linha no seu HTML, livre-se de quaisquer solicita√ß√µes adicionais. O usu√°rio v√™ essa tela primeiro e depois faz o download como quiser. Provavelmente, ele come√ßar√° a rolar quando tiver tempo para carreg√°-lo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/nk/0u/hbnk0uuz7vgkbubstjoqnfwgsus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© feito simplesmente. Existem ferramentas que automatizam tudo isso, incluindo plugins para webpack e React. Basta pesquisar e configurar corretamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/addyosmani/critical</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/pocketjoso/penthouse</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/anthonygore/html-critical-webpack-plugin</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/GoogleChromeLabs/critters</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/1p/pi/qp/1ppiqpkakke_gsbhxo1cybumlgo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tenha uma boa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abordagem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do Filament Group - como carregar de forma ass√≠ncrona sem bloquear o CSS. Tudo √© bem simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando voc√™ colocar &lt;link rel = preload&gt;, diga ao navegador: ‚ÄúVou precisar desse estilo, mas agora n√£o estamos bloqueando nada. Fa√ßa o download agora, armazene em cache e, quando eu voltar, comece a criar o CSS OM. ‚Äù E voc√™ s√≥ precisa colocar onload e processar que "ok, desde que eu baixei, fa√ßa rel = stylesheet, habilite a an√°lise". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma abordagem bastante simples, mas use-a com sabedoria tamb√©m. Se voc√™ tiver muita pr√©-carga, poder√° fazer pior. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j1/ny/ri/j1nyrizteczgvkx5dwd78_fy1yy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode brincar com express√µes de m√≠dia. Cole-os e diga ao navegador: "esse estilo n√£o √© mais necess√°rio agora, mas quando essa express√£o de m√≠dia funcionar, ser√° necess√°rio". O navegador tamb√©m far√° o download proativamente, mas com uma prioridade mais baixa e sem bloqueio.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/m3/go/iem3golzhy8qq3fulda1iwn8d0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra abordagem maluca, mas n√£o t√£o louca - quando voc√™ tem o http / 2 push. Voc√™ pode incorporar CSS bem na frente do bloco. Sem CSS, seu bloco n√£o ficar√° muito bom. Ent√£o, por que n√£o incorporar o CSS necess√°rio para o pr√≥ximo bloco antes desse bloco? Isso √© l√≥gico, e o envio http / 2 permitir√° que voc√™ o otimize. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma abordagem simples. Se voc√™ expandi-lo, use carregamento lento. Por que um usu√°rio deve baixar algo que ele n√£o usar√°? Voc√™ pode configurar os componentes do React para que, se ele nunca atingiu a √°rea de visibilidade da p√°gina, por que deveria baixar os estilos para si mesmo? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Explore a API do Intersection Observer e poder√° acelerar drasticamente sua p√°gina. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/ag/dz/-vagdzf0qqu3mmpabixf1rw9_ss.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O √∫ltimo passo √© desenhar e aplicar em camadas compostas, col√°-las e assim por diante.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/1v/bc/be1vbcsui3hmenm-0ryzhadzrjs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O navegador cria camadas compostas em um grande n√∫mero de casos. </font><font style="vertical-align: inherit;">Na minha opini√£o, apenas um quarto do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo fonte do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chromium se </font><font style="vertical-align: inherit;">encaixa aqui </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Voc√™ pode ver por si mesmo quando ele cria camadas compostas no c√≥digo do navegador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A mem√≥ria de v√≠deo √© limitada, especialmente em telefones celulares. </font><font style="vertical-align: inherit;">Se voc√™ trouxer tudo para novas camadas para otimizar as anima√ß√µes usando o will-change: transform ou qualquer outra coisa, poder√° estar piorando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie menos camadas - exatamente o necess√°rio para a otimiza√ß√£o atual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√ìtimo, todos n√≥s analisamos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E se eu voltar?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E se eu voltar √† p√°gina? Esta √© apenas a primeira vez que fui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voltando √† p√°gina, parece que consigo baixar tudo instantaneamente. Eu j√° baixei todos os recursos, por que n√£o us√°-los uma segunda vez? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/di/1l/8vdi1lapv3i9ka0lb-swsysnhms.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o servidor n√£o fornecer o cabe√ßalho de controle de cache, o navegador tentar√° armazenar em cache seu arquivo para reutiliz√°-lo. Voc√™ pode configurar seu servidor por padr√£o, digamos: "armazene em cache esse arquivo por um ano inteiro". N√£o mudar√°. Mas, nesse caso, voc√™ precisa lidar com o problema de invalida√ß√£o do cache global. Mas este √© o t√≥pico de um relat√≥rio separado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use trabalhadores de servi√ßo! 2020, √© hora, Aplicativos Web Progressivos! Kirill Chugainov teve um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relat√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sobre como os Trabalhadores em Servi√ßo podem ser usados ‚Äã‚Äãpara diferentes ocasi√µes. Nesse caso, voc√™ intercepta a solicita√ß√£o CSS, salva-a e, se o navegador seguir esse estilo pela segunda vez, afaste-a do cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o navegador n√£o promete nada a voc√™. Voc√™ sempre pode enfrentar o fato de o navegador ficar sem mem√≥ria. Ele tentar√° armazenar em cache, mas n√£o h√° mem√≥ria. O armazenamento em cache n√£o √© cem por cento. Sempre lide com essas situa√ß√µes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode tentar usar o armazenamento local. Mas ele √© muito lento. √Äs vezes, o download de um arquivo √© mais r√°pido do que ir para a API de armazenamento local. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode tentar o banco de dados interno do navegador. Mas me√ßa. Talvez uma viagem ao JS leve mais tempo devido a um processador fraco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ tamb√©m pode informar com anteced√™ncia ao navegador que far√° o download de algo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7a/_f/oq/7a_foqb9hzh_ycjaddhrkarqhia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;link rel&gt; - saiba como esse atributo funciona. H√° pr√©-conex√£o, pr√©-busca, pr√©-renderiza√ß√£o - quero falar sobre isso separadamente. Ele diz: ‚ÄúEstou nesta p√°gina agora e depois irei para a pr√≥xima. Fa√ßa o download de tudo para esta p√°gina na guia segundo plano e desenhe. ‚Äù Coisas legais. N√£o funciona em lugar nenhum. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iy/ca/ql/iycaqlaidexf0urgnjv05zpjskg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De certa forma, ele √© suportado no IE e Edge. No Chrome, ele realmente n√£o faz isso, n√£o √© renderizado. Funciona como pr√©-busca: baixa esses arquivos e caches. Infelizmente, um pr√©-renderizador completo n√£o funciona em lugar nenhum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas voc√™ pode desenvolver essa ideia. Por exemplo, no aplicativo Yandex - naturalmente, n√£o usando CSS - √© feito um pr√©-renderizador. Quando voc√™ est√° procurando algo, √© prov√°vel que obtenha resultados instantaneamente. N√≥s </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prever onde voc√™ vai, e com anteced√™ncia pelos nossos pr√≥prios m√©todos de ir buscar todos os recursos necess√°rios.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qual √© o pr√≥ximo? </font><font style="vertical-align: inherit;">Havia muitos links. </font><font style="vertical-align: inherit;">Tamb√©m aconselho a olhar para uma incr√≠vel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cole√ß√£o de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> otimiza√ß√£o de tudo, desde Vanya Akulov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iamakulov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Veja como otimizar HTML, JS e assembly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E n√£o se esque√ßa de arrumar. </font><font style="vertical-align: inherit;">Agora, meu conselho realmente funciona, sugerindo como faz√™-lo rapidamente, mas provavelmente, depois de cinco anos, eles ser√£o prejudiciais. </font><font style="vertical-align: inherit;">Haver√° algum tipo de tecnologia que ser√° incompat√≠vel com eles. </font><font style="vertical-align: inherit;">Acompanhe isso e tente manter seu c√≥digo ideal, inclusive depois de um tempo. </font><font style="vertical-align: inherit;">Obrigado pela aten√ß√£o.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt501988/index.html">Como a tela da mensagem VK √© renderizada?</a></li>
<li><a href="../pt501990/index.html">Postagem √∫til: 4 eventos para resolver os problemas do segundo dia no OpenShift e criar operadores</a></li>
<li><a href="../pt501992/index.html">Como organizar os testes para acelerar e estabilizar os lan√ßamentos de produtos. Parte 1</a></li>
<li><a href="../pt501994/index.html">Orchestrator for MySQL: por que um projeto √† prova de falhas n√£o pode ser constru√≠do sem ele</a></li>
<li><a href="../pt501996/index.html">Zen Go (vers√£o de bolso)</a></li>
<li><a href="../pt502000/index.html">12 cursos online de engenharia de dados</a></li>
<li><a href="../pt502004/index.html">M√©todo Kanban: Entendendo seu processo como um processo coletivo de constru√ß√£o de conhecimento - Parte 1 (receitas)</a></li>
<li><a href="../pt502008/index.html">Programa√ß√£o para as massas</a></li>
<li><a href="../pt502028/index.html">Vanya vai para a av√≥ ou JavaScript din√¢mico adapt√°vel</a></li>
<li><a href="../pt502030/index.html">Servi√ßos Web no Oracle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>