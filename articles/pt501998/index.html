<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙🏻 👨🏻‍🌾 👐🏽 Preço caro de estilos. Relatório Yandex 👽 💃 ⛷️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Carregar CSS em uma página é uma operação de bloqueio. Se o carregamento assíncrono do JavaScript não estiver visível para o usuário, a aparência lent...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Preço caro de estilos. Relatório Yandex</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/501998/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregar CSS em uma página é uma operação de bloqueio. </font><font style="vertical-align: inherit;">Se o carregamento assíncrono do JavaScript não estiver visível para o usuário, a aparência lenta dos estilos poderá expulsar um visitante impaciente do site. </font><font style="vertical-align: inherit;">Como carregar CSS da maneira mais eficiente e transparente possível para os usuários? </font><font style="vertical-align: inherit;">Nikita Dubko está tentando descobrir</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DarkMeFoDy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do grupo de interface de pesquisa Yandex em Minsk.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kATRlMrtaaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Olá a todos. </font><font style="vertical-align: inherit;">Vou falar sobre os estilos. </font><font style="vertical-align: inherit;">Todo mundo está falando sobre TypeScript e TypeScript hoje. </font><font style="vertical-align: inherit;">E eu vou falar sobre o script estilo Cascade.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouco sobre mim. </font><font style="vertical-align: inherit;">Sou desenvolvedor da Bielorrússia - depois do filme Dudya, digo isso em todos os lugares. </font><font style="vertical-align: inherit;">Você pode ter ouvido minha voz no podcast de padrões da Web e, se você encontrar erros de digitação no feed de notícias dos padrões da Web, provavelmente sou eu também. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pouco aviso. </font><font style="vertical-align: inherit;">Haverá várias insanidades no relatório - trate tudo o que digo com grandes críticas. </font><font style="vertical-align: inherit;">Pense por que você pode usar essas técnicas e por que não precisa delas. </font><font style="vertical-align: inherit;">Algumas coisas serão realmente loucas. </font><font style="vertical-align: inherit;">Vai.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelo que?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para começar - por que falar sobre otimização de CSS? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você começar a procurar nos mecanismos de pesquisa downloads rápidos de JS, há muitos resultados. Se você procura um carregamento rápido de CSS, a parte superior nem exibe o CSS necessário. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fd/fy/mh/fdfymhsjiglvpavgqbzxrczyqo8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você olhar para o Google, existem 111 milhões de resultados sobre JS e CSS, apenas 26 milhões, </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
então talvez isso não importe? Por que falar sobre isso? Se você procurar relatórios de desempenho JS, encontrará muitos deles. Há sobre React, sobre todos os tipos de outras estruturas, sobre Vanilla, etc. Mas sobre CSS, encontrei apenas um relatório. Harry Roberts em 2018 leu um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interessante </font><font style="vertical-align: inherit;">sobre o desempenho do CSS. Eu pensei ter encontrado um segundo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por Roma Dvornova, “CSS Parsim: dicas e truques de desempenho”. Mas acabou sendo um relatório JS que analisa CSS. Não é exatamente o que precisamos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que eles não pensam muito em CSS. É uma vergonha. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas quando vou para a web, geralmente vejo HTML. E também vejo CSS que estiliza a página. Mas eu não vejo JS. JS é algo que move CSS e HTML em uma página para deixar tudo bonito. Este é um script. E se o JS não carregar, não será tão ruim quanto se o CSS não carregar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erros no JS caem silenciosamente no console. E é improvável que o usuário comum entre no DevTools para procurar: "Ah, você está aí, um erro no console". Mas se o CSS não carregar, talvez você não veja tudo o que precisa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A propósito, existem estudos sobre o fato de que o principal é causar uma primeira impressão.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">38% dos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuários podem acessar o site e, se perceberem que é diretamente nojento, sairão imediatamente. E </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">88%</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vão tolerar, usá-lo uma vez e, em seguida, eles nunca retornam e dificilmente aconselharão seu site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora que estamos todos sentados em casa, o tráfego da Internet aumentou especialmente. E precisamos pensar em como fornecer com eficiência quaisquer recursos aos usuários. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos tentar contar do ponto de vista do Yandex. Se pudermos otimizar cada entrega do Yandex por 100 ms e fornecer, digamos, 200 milhões de páginas por dia (não sei o número exato), neste dia economizaremos 0,1 s * 200 milhões = 232 pessoas-dia. Apenas otimizando a saída por 100 milissegundos. E CSS também faz isso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos jogar um pouco de detetives e descobrir como tirar o máximo proveito dos estilos de carregamento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A medida!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O primeiro conselho é sempre medir tudo. Não há sentido em fazer otimizações teoricamente. Você pode supor que a otimização funcione no seu caso, mas medições reais mostrarão que nada disso. Essa é a regra mais importante de qualquer otimização. </font><font style="vertical-align: inherit;">Andrei Prokopyuk, da equipe SERP Velocity do HolyJS, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muito bem </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">sobre</font></a><font style="vertical-align: inherit;"> como fazemos isso </font><font style="vertical-align: inherit;">, não vou me repetir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quais ferramentas de medição existem? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Se você deseja medir em dispositivos mais ou menos reais, lento, não tão legal quanto o seu, use o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebPageTest</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Eu costumo fazer medições lá. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Você possui o Lighthouse se usar navegadores baseados no Chromium. Ele, como medições locais, mostra coisas muito boas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Se você tem certeza de que pode fazer tudo sozinho, vá para o DevTools, na guia Desempenho. Tem muitos detalhes, você pode iniciar suas próprias métricas e analisá-las. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/vx/xl/jl/vxxljlbogdfjvd0v2kyqedewfxy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Naturalmente, no desempenho, é necessário definir condições reais. Você está sentado no seu laptop legal com Internet legal no escritório, tudo é incrível aqui, mas eles vêm até você e dizem: "Estou lento". E você diz: "Tudo funciona para mim". Não faça assim. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sempre tente verificar como o usuário, nas condições do metrô ou em outro lugar, usará seu site. Para fazer isso, você precisa configurar uma Internet muito lenta. Também é aconselhável desacelerar a CPU, porque alguém pode vir até você a partir de um Nokia 3110. Ele também precisa mostrar o site.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais importante: avalie em usuários reais. Existe essa métrica, mais precisamente, todo um conjunto de métricas - RUM, Real User Monitoring. É quando você mede não o que acontece sinteticamente no seu código, mas as métricas de usuários reais na produção. Por exemplo, do carregamento de uma página para uma ação. Uma ação é, por exemplo, algo que funciona no navegador ou até mesmo um clique em algum elemento importante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembre-se de que você não está desenvolvendo para robôs. Sotka em Lighthouse - é ótimo, é muito bom. Portanto, você cumpre pelo menos os requisitos que o Farol define. Mas existem usuários reais e, se o usuário não conseguir ver a página ao carregar o Lighthouse, você está fazendo algo errado.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/z-/fy/cn/z-fycndvddxfylx_s_ahdxjolpc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem métricas importantes para se concentrar. </font><font style="vertical-align: inherit;">Esta é a primeira pintura com conteúdo, quando o primeiro conteúdo aparecer em sua página com o qual você pode fazer algo, leia. </font><font style="vertical-align: inherit;">Essa métrica é enviada nos navegadores Chromium, você pode obtê-la. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/mt/xi/mi/mtximitp8tflgksudiaaporikko.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recentemente, você ainda pode ver a Maior pintura com conteúdo. </font><font style="vertical-align: inherit;">Muitas vezes acontece que você tem uma página de mídia e é importante, por exemplo, ver uma foto nela. </font><font style="vertical-align: inherit;">Então você precisa dessa métrica específica.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carregamento CSS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos finalmente passar ao CSS, como o CSS é carregado. </font><font style="vertical-align: inherit;">As recepções são conhecidas há muito tempo. </font><font style="vertical-align: inherit;">Há um caminho de renderização crítica, um caminho de renderização crítica. </font><font style="vertical-align: inherit;">É sobre o que o navegador faz desde o momento do envio da solicitação do recurso até o momento em que os pixels são exibidos na tela do usuário. </font><font style="vertical-align: inherit;">Sobre isso, também, há vários artigos e relatórios. </font><font style="vertical-align: inherit;">Mas vamos dar uma rápida olhada em como esse navegador faz isso.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS —  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele começa a baixar HTML, vê tags. </font><font style="vertical-align: inherit;">Ele gradualmente os analisa, entende o que fazer com eles. </font><font style="vertical-align: inherit;">Carrega. </font><font style="vertical-align: inherit;">Veio através do link. </font><font style="vertical-align: inherit;">Deve ser usado. </font><font style="vertical-align: inherit;">Mas como? </font><font style="vertical-align: inherit;">Primeiro você precisa fazer o download. </font><font style="vertical-align: inherit;">O download é lento. </font><font style="vertical-align: inherit;">Quando carrega, começa a analisar mais a página.</font></font><br>
<br>
<pre><code class="html hljs xml"> <span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ru"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CSS —  <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/main.ac74gsac.css"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>-!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se deparar com outro link, será bloqueado novamente e não permitirá a execução. </font><font style="vertical-align: inherit;">Bloqueia JS, bloqueia a análise. </font><font style="vertical-align: inherit;">E até inicializar, não faz nada. </font><font style="vertical-align: inherit;">Mas então começa a trabalhar mais.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;link&gt;</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos aprofundar - o que acontece quando você acessa o link? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/3w/eb/cs/3webcs2yte1_pqw5nzwvmj_epy4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gravar para onde vamos é padrão. </font><font style="vertical-align: inherit;">Existe um estilo CSS que fica em algum lugar. </font><font style="vertical-align: inherit;">Agora está na moda colocar todas as estatísticas na CDN.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Onde ir?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, o navegador precisa entender para onde ir. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/u8/me/ix/u8meixyugzfctlaocm2xzo862po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele vê o URL e precisa entender esse URL - sobre o que é? Estamos acostumados ao fato de que o URL é um identificador de site. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/26/2m/6b/262m6bmfjupam-ega9z7tmpibzk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas fisicamente precisamos obter o endereço IP desta URL e ir para a máquina física real no endereço IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ys/nq/ah/ysnqah21cz075zefg6khjupdm-w.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para o seu CDN, ele receberá um registro no DNS e será direcionado diretamente para o endereço IP. Como alguém pode acelerar neste caso? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lz/cl/sn/lzclsnosywf5yaqi0fihvdefism.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma ideia maluca é reduzir a distância do usuário ao servidor DNS. Pegue e transplante o usuário. Por exemplo, para exibir a mensagem: "Sente-se mais perto" ou "Aproxime-se". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode especificar imediatamente o endereço IP no link. Por que precisamos procurar DNS, resolver domínios, se você pode fornecer imediatamente o resultado por endereço IP? Essa é uma maneira louca, mas no caso dos servidores DNS globais do DDoS, ele pode até salvá-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E podemos nos livrar de obter um endereço IP. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/s4/i0/1v/s4i01v9rasbbahddidnteghzu8a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passando para o index.html ou para outro arquivo, você já sabe o endereço de domínio para onde vai. Aqui está exatamente o caso em que, em vez de armazenar estática em um domínio ou subdomínio separado, você pode colocar a estatística mais próxima do seu domínio, a saber, o próprio domínio. Então o DNS não precisa ser resolvido, ele já está. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zn/l1/gg/znl1ggztpsl37dgk1cmfo0ob8c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nós descobrimos para onde ir. Mas podemos fazer essas coisas com antecedência para o navegador. Se, por exemplo, sua folha de estilos for carregada muito mais tarde através da árvore do DOM, você poderá dizer ao navegador usando &lt;link rel = "dns-prefetch"&gt; que "Eu ainda não vou lá, mas você aquece os recursos, definitivamente precisarei deles mais tarde "</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esta entrada, você diz ao navegador para descer e obter esse DNS. </font><font style="vertical-align: inherit;">Quando o link aparecer no código, o navegador já saberá o endereço IP deste domínio. </font><font style="vertical-align: inherit;">Você pode fazer essas coisas preliminares. </font><font style="vertical-align: inherit;">A mesma coisa, por exemplo, antes de entrar na próxima página, para onde você definitivamente irá. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, o navegador sabe para onde ir. </font><font style="vertical-align: inherit;">Ele precisa entender como ir.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como ir</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos assistindo o protocolo. Agora, é claro, https é um requisito direto. A inclusão de mecanismos de pesquisa marcará seus sites não em https com formulários como não totalmente seguros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://howhttps.works/why-do-we-need-"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">série</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> incrível </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://howhttps.works/why-do-we-need-"><font style="vertical-align: inherit;">de</font></a><font style="vertical-align: inherit;"> quadrinhos sobre como o quadro funciona https. Mas somos pessoas de TI, adoramos diagramas complexos legais e quadrinhos engraçados são fáceis demais. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, formulei com minhas próprias palavras como o https funciona. Primeiro você obtém um certificado SSL do seu servidor. Em seguida, você deve verificar o certificado em uma autoridade de certificação. Estes são servidores especiais que sabem o que é válido e o que não é, e podem solicitar navegadores: "Sim, está tudo bem aqui, use este certificado".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, é apresentada a geração de chaves para comunicação entre o servidor e o cliente, criptografia e descriptografia usando chaves diferentes. O processo é interessante se você o examinar em termos de criptografia. Mas queremos acelerar. Quão? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pq/g1/ue/pqg1ueqmruwadkjjb7ff5sstwu0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Podemos novamente transferir o usuário para mais perto dos servidores. Já temos um DNS, agora podemos aproximá-lo da autoridade de certificação. E colocar entre esses servidores será perfeito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode desativar o https, por que precisamos dele? Nós gastamos tempo obtendo um certificado, criptografar, descriptografar. Na verdade não. Este é o conselho mais prejudicial do relatório, não faça isso. https é proteção de dados do usuário, e http / 2 não funcionará sem https, e http / 2 é outra maneira de acelerar.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jq/hh/p1/jqhhp1dzstopvkbbsf70gnkxwpw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Há também a tecnologia de grampeamento OCSP. Você pode verificar um certificado sem uma autoridade de certificação. Provavelmente isso está mais próximo do DevOps. Você precisa configurar seu servidor de uma certa maneira para que ele possa armazenar em cache a resposta da Autoridade de Certificação e emitir para o usuário: "Acredite, meu certificado é realmente real". Assim, podemos salvar pelo menos a etapa em que vamos à autoridade de certificação. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas há uma nuance - no Chrome, isso não funciona e por um longo tempo. Mas para o usuário de outros navegadores, você pode acelerar esse processo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu já disse duas vezes que é necessário transplantar o usuário, e a ideia está subindo no ar - para aproximar o servidor do usuário. Eu não descobri nada de novo para você. Esta é uma CDN, uma rede de entrega de conteúdo distribuído. A idéia é que você possa usar o sidienki pronto, criar sua própria infraestrutura de forma independente e colocar vários servidores em todo o mundo, tanto quanto o dinheiro e as oportunidades permitirem. Mas você precisa organizar o servidor para que um usuário da Austrália vá para servidores australianos. Aqui a velocidade da luz joga com você, quanto menor a distância, mais rápido os elétrons a passam. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos cavar mais fundo. O que mais está acontecendo na solicitação? De fato, https é apenas um invólucro sobre http. Não é apenas um invólucro legal. E se for ainda mais profundo, o http é uma solicitação da família TCP / IP.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/wl/be/sf/wlbesfr8mnsmulrqrlgazdwxa_4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como os pacotes e bytes são enviados na rede para que todos os navegadores, clientes e servidores se comuniquem? </font><font style="vertical-align: inherit;">A primeira coisa que um cliente / servidor faz em uma conexão TCP / IP é um handshake. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas em 2020, a OMS recomenda evitar apertos de mão. </font><font style="vertical-align: inherit;">Existe uma tecnologia TCP Fast Open tão legal. </font><font style="vertical-align: inherit;">Você pode, no momento do aperto de mão, evitar toda a cadeia “Olá, eu sou um cliente” - “Olá, eu sou um servidor” - “Eu acredito em você” - “E eu acredito em você. </font><font style="vertical-align: inherit;">Vai". </font><font style="vertical-align: inherit;">Você já pode enviar dados úteis neste momento. </font><font style="vertical-align: inherit;">E se o aperto de mão foi bem-sucedido, parte dos dados úteis passou. </font><font style="vertical-align: inherit;">Este é o TCP Fast Open.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que pegar?</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos descobrir o que o cliente deve buscar no servidor. </font><font style="vertical-align: inherit;">O principal não é que o cliente pegue algo do servidor, mas o servidor entregue os dados ao cliente. </font><font style="vertical-align: inherit;">Então você pode pensar: User-Agent. </font><font style="vertical-align: inherit;">Posso obter o User-Agent do cliente, descobrir em qual navegador o usuário efetuou login. </font><font style="vertical-align: inherit;">Descubra aproximadamente se este navegador não me engana.</font></font><br>
<br>
<pre><code class="css hljs"><span class="hljs-selector-class">.example</span> {
    <span class="hljs-attribute">display</span>: -ms-grid;
    <span class="hljs-attribute">display</span>: grid;
    <span class="hljs-attribute">-webkit-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-o-transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">transition</span>: all .<span class="hljs-number">5s</span>;
    <span class="hljs-attribute">-webkit-user-select</span>: none;
       <span class="hljs-attribute">-moz-user-select</span>: none;
        <span class="hljs-attribute">-ms-user-select</span>: none;
            <span class="hljs-attribute">user-select</span>: none;
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-webkit-gradient</span>(linear, left top, left bottom, from(white), <span class="hljs-built_in">to</span>(black));
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">-o-linear-gradient</span>(top, white, black);
    <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, white, black);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Digamos que ele fez login no Firefox. </font><font style="vertical-align: inherit;">Como de costume, eu tenho um assembly no qual o autoprefixer está conectado à uma brega, gerou um monte de código para mim. </font><font style="vertical-align: inherit;">Sim, é uma abordagem legal de que tudo funcionará em qualquer lugar. </font><font style="vertical-align: inherit;">Mas eu já sei que o usuário efetuou login no Firefox. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por que não desligar todo o excesso? </font><font style="vertical-align: inherit;">Concordo, há muito menos linhas, enviamos menos bytes, isso é legal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temos uma versão lite do SERP, Granny. </font><font style="vertical-align: inherit;">Vitaly Kharisov falou sobre ela</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vithar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classe </font><font style="vertical-align: inherit;">nos dias de padrões da Web. Ele usa exatamente essa abordagem. Podemos gerar vários pacotes e entregá-los a diferentes clientes de maneiras diferentes. Eles pesam muito menos, porque o Firefox é seu, o WebKit é seu, e funciona, é verificado. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/av/3l/rj/av3lrjwxk0h7r1uvu2soqygili8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais longe. Provavelmente processamos solicitações de usuários, sabemos que a pessoa está autorizada e usamos algumas informações pessoais para ela. É lógico que devemos obter algo do banco de dados. Mas nem todos! Existem coisas estáticas que não diferem para nenhum dos usuários, elas são exatamente iguais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
James Akvuh leu um </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">relatório</font></a><font style="vertical-align: inherit;"> interessante sobre isso</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Renderização do lado do servidor. </font><font style="vertical-align: inherit;">Faça Você Mesmo". </font><font style="vertical-align: inherit;">Qual é o ponto? </font><font style="vertical-align: inherit;">Você já sabe que possui HTML e algum tipo de CSS que é o mesmo para todos os usuários. </font><font style="vertical-align: inherit;">Antes de escolher qualquer dado, você pode gerar a saída desses dados estáticos e enviar imediatamente o mais útil em um fluxo do servidor. </font><font style="vertical-align: inherit;">E depois disso - vá para os dados, receba-os rapidamente, converta-os em modelos e entregue-os ao cliente. </font><font style="vertical-align: inherit;">E o usuário já verá algo útil.</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seu navegador não suporta vídeo HTML5.</font></font><source src="https://mefody.dev/talks/css-cost/images/screencast-yandex-prerender.mp4" type="video/mp4"></video></div></div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nós implementamos isso há muito tempo. Temos na SERP, na página principal de pesquisa, duas fases - pré-pesquisa e pós-pesquisa. A pré-pesquisa é quando enviamos todas as peças que não precisam de conhecimento sobre qual usuário efetuou login. Já podemos dar a ele, por exemplo, um chapéu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ou seja, temos uma barra de pesquisa que o usuário pode começar a usar antes que todo o resto seja carregado. Isso é útil em uma conexão lenta. Nós fazemos isso, funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E eu também falei sobre http / 2. Isso é totalmente suportado pelos navegadores modernos; portanto, se você ainda não o configurou no servidor, descubra como configurá-lo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Server Push é uma tecnologia interessante que diz: “Navegador, ainda não lhe dei o conhecimento de que você precisa de algum tipo de CSS. Mas eu sei exatamente o que é necessário. Então segure, pré-carregue. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/6b/hr/do/6bhrdomeghpruxrhggwss8lpe4a.png"><br>
<br>
<img src="https://habrastorage.org/webt/0_/h-/eo/0_h-eognhuhs4pp55sj0rzltkly.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não é díficil. Você precisa configurar alguns cabeçalhos no servidor e tudo começará a funcionar. Se o navegador não conhece esse título, nada vai quebrar, isso é o mais bonito. Vamos cavar ainda mais. TCP Já falamos sobre isso: um aperto de mão, bytes são enviados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ht/f4/gy/htf4gytrvdio_te6zyz5wsevhn8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lave as mãos após um aperto de mão. Porém, em termos de TCP, começamos a encaminhar bytes e os algoritmos são otimizados o suficiente para que o servidor cliente não fique ocioso.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, um determinado segmento de dados é enviado primeiro. Por padrão, (isso pode ser alterado nas configurações), são 1460 bytes. O servidor não envia informações em um segmento. Ele envia janelas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira janela é 14600 bytes, dez segmentos. Então, se a conexão for boa, ele começa a ampliar as janelas. Se a conexão for ruim, poderá reduzir a janela. O que é importante entender? Existe a primeira janela de dez segmentos, na qual você deve ajustar o site inteiro, se desejar. E então haverá a velocidade máxima do conteúdo. </font><font style="vertical-align: inherit;">Vitaliy Kharisov </font><font style="vertical-align: inherit;">também leu um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre isso </font><font style="vertical-align: inherit;">. E sim, é possível ajustar um site com tudo o que você precisa em uma janela se você desativar, por exemplo, o JS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma nuance importante. </font><font style="vertical-align: inherit;">Quando você preenche um segmento inteiro, é um segmento. </font><font style="vertical-align: inherit;">Mas se você enviar apenas um byte extra, o servidor ainda enviará um segmento extra inteiro. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/h4/8v/ut/h48vut1nv1yldqqdo2ubbe3miai.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode fazer uma otimização interessante, reduzir a produção em um kilobyte inteiro, mas não verá nada nas suas medições - talvez por isso. </font><font style="vertical-align: inherit;">Tente fazer a otimização normalmente em vários segmentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estranho: sou um tipógrafo e digo coisas complexas para servidores. </font><font style="vertical-align: inherit;">Vamos nos aproximar ainda mais do CSS real.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enviar menos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, enviamos menos para o usuário, menos segmentos, chega mais rápido, o usuário fica feliz. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/76/hb/6l/76hb6lkb_giyi6iwvnfvaui4yuk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minificação. Ela foi criada em seus projetos. Existem várias ferramentas interessantes, plug-ins de pacotes da web, configurações de gole - em geral, você vai descobrir por si mesmo. Você pode personalizá-lo manualmente, mas parece apenas quando você tem certeza de que pode compactar seu CSS mais frio do que qualquer CSSO. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lembre-se de ativar a compactação. Se pelo menos o gzip não estiver ativado em 2020, você definitivamente está fazendo algo errado, porque esta é uma técnica de compressão antiga. Em geral, em 2020, é hora de usar brotli. Essa é uma boa maneira de reduzir um pouco a saída nos navegadores Chromium. Ou, se você não deseja oferecer suporte ao brotli, pelo menos pode tentar o zopfli.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse é um algoritmo de compactação bastante lento para o gzip, que simplesmente fornece os melhores resultados de compactação e descompacta tão rápido quanto o gzip comum. Portanto, o zopfli precisa ser configurado com sabedoria e usado somente quando você não precisa enviar dados em tempo real. Você pode configurar os arquivadores gzip a serem coletados durante a montagem usando o algoritmo zopfli, e enviados estaticamente já, de fato, não estão em movimento. Isso pode ajudá-lo. Mas também meça os resultados.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pu/f6/sm/puf6smovgfumpzw6cdrj4nxvjzo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos esses algoritmos usam algum tipo de dicionário: um dicionário é construído com base na repetição de fragmentos de código. Mas às vezes eles dizem: é necessário alinhar, se alinhamos, então nos livramos da solicitação. Vincular todo o CSS em HTML será muito rápido. O truque é que o gzip funciona um pouco mais eficientemente quando você divide os estilos e o HTML, porque os dicionários são diferentes, mais eficientes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No meu caso, peguei a página de inicialização, vinculei a inicialização e comparei as duas versões. O gzip sobre recursos individuais é 150 bytes a menos. Sim, o ganho é muito pequeno. Aqui também é preciso medir tudo. Mas no seu caso, isso pode, por exemplo, reduzir o número de segmentos em um.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como otimizar o código? Não estou falando de minificação. Tire o que você não está usando no projeto. Provavelmente você possui um código que nunca será executado no cliente. Pelo que? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/oc/qy/i3/ocqyi32nsmaifhfwjtobuhbfyt0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que você possa automatizar isso, guias especiais são incorporadas ao navegador, por exemplo, no Chrome DevTools, isso é Cobertura, que informa: "Eu não usei esse CSS ou esse JS, você pode cortá-lo". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas você pode ter foco, ativo, algo instalado usando JS. Você precisa simular todas as ações possíveis no site, só assim você terá certeza de que esse CSS poderá ser cortado. Chris Coyer tem um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artigo de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> revisão </font><font style="vertical-align: inherit;">sobre ferramentas automáticas que tentam fazer tudo com foco e foco. Mas ele chegou à conclusão de que era impossível automatizar isso. Ainda não deu certo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Há um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anton Kholkin da Booking.com, onde eles também tentaram remover montes de código legado. </font><font style="vertical-align: inherit;">Mas eles tinham uma peculiaridade: um código legado que vinha de projetos externos. </font><font style="vertical-align: inherit;">Foi necessário removê-lo. </font><font style="vertical-align: inherit;">Veja que soluções interessantes eles encontraram. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você mesmo pode tentar jogar com o mesmo Puppeteer, que é como o Chrome. </font><font style="vertical-align: inherit;">Você pode fazer testes que passam automaticamente por tudo, tentar pairar, se concentrar. </font><font style="vertical-align: inherit;">E use essa mesma cobertura. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minha colega Vitya Khomyakov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">victor-homyakov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiz meu próprio </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">script</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como encontrar duplicatas e estilos em uma página. Basta pegar, copiar e colar. Ele escreverá para você no console: "esse seletor, ao que parece, você não precisa". Até o ponto que acabou de entrar no DevTools. É incrivel. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/5q/4i/4g/5q4i4gjomb59s7ry5xcukiqi0zc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um recurso que eu realmente gosto nas ferramentas dos desenvolvedores do Firefox: uma oportunidade de ver estilos que parecem ser usados, mas na verdade o navegador não os aplica. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, você pode definir display: inline e parece que este display: inline não faz sentido definir tamanhos. Ou alinhamento vertical, funciona apenas para células em linha ou tabela. Até agora, só vi no Firefox que ele pode destacar: "você não precisa dessa linha".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui também é preciso ter cuidado: talvez você use esse estilo para colar a classe posteriormente. Mas, na minha opinião, um recurso interessante. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faça a si mesmo a pergunta agora: você precisa de todo o Bootstrap no projeto? Coloque qualquer estrutura CSS usada em vez do Bootstrap. Provavelmente, você usa o Bootstrap para grades e elementos mais ou menos comuns e metade do Bootstrap não é necessário. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tente usar a montagem corretamente. Quase todas as estruturas CSS modernas permitem que você use o código-fonte para montagem e selecione apenas o que você precisa. Isso pode reduzir drasticamente o tamanho do pacote CSS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não doar sem uso. Em vez de procurar meu legado, você pode usar o entendimento no nível de compilação de que esta página não usará esse CSS.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, uma pilha BEM completa permite que você faça a montagem para que você, já fornecendo a página, possa construir uma árvore de todos os componentes dos blocos BEM que estarão na página. O BEM permite determinar que, se esse bloco não estiver na página, não há necessidade de carregar esse CSS. Envie apenas o necessário. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Até os funcionários do Google </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dizem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : use o BEM, ele pode realmente ajudá-lo na otimização. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu não acredito que digo isso em voz alta, mas neste caso o CSS-in-JS parece ser uma boa abordagem. Quando você escreve componentes independentes independentes e configura cuidadosamente o assembly ou determina em tempo de execução quais blocos são usados ​​e quais não são, você pode se livrar do problema de encontrar um código legado simplesmente não enviando esse código ao cliente. Parece fácil, mas é necessária disciplina. Pense nisso com antecedência no início do projeto.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/zr/he/na/zrhenay2u6hrppvi4jx-ams_njo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que outra opção existe? Um pouco louco. Neste código, parece que o estilo não é necessário, porque usamos uma div - o padrão já é display: block. E vamos excluir todos os padrões? Se em seu projeto você tiver certeza de que a marcação HTML nunca será alterada novamente - passe pelos valores padrão que o navegador já fornece e remova-os. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menos estilos - ótimo! Mas isso é novamente uma ideia maluca. O CSS não precisa saber sobre HTML, porque é um estilo. É bastante independente, você deve conectá-lo a outro projeto, ele deve funcionar lá. E sim, é difícil de manter. Mude a etiqueta - tudo quebra. Ideia louca como prometido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use variáveis. CSS possui variáveis ​​muito antigas, como currentColor.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vh/eg/om/vhegomyxszcuft3mc8rloetjmio.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Muitas vezes, existe um padrão: você deseja, por exemplo, criar um botão cujo texto e borda sejam da mesma cor. E, ao passar o mouse, mudamos os dois. Pelo que? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/-5/jl/-v-5jle8hdyn94asbckxmh0ev_i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Há uma variável currentColor que recebe um valor da cor e você a coloca, por exemplo, na borda, proxy essa propriedade e altera apenas uma linha ao passar o mouse, focalizar, ativo, o que você quiser. Isso parece conveniente, e o código se tornou uma linha a menos. Você pode otimizar. A propósito, neste exemplo, você não pode usar a tarefa de cor da borda, porque, por padrão, ela já recebe um valor da propriedade color. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Às vezes, é muito triste observar como o base64 é usado. No CSS, era recomendado ativamente antes: use base64 para injetar pequenos ícones. Se ele se encaixa em um segmento sobre o TCP, é bom para você. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/95/uu/rb/95uurb_rsvp6_xjhnolso-ftl-o.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas Harry Roberts também</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conduziu um</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> estudo elegante sobre como a base64 afeta o carregamento da página. Sim, há menos solicitações, mas esses estilos são analisados ​​às vezes mais lentamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, a análise é uma operação muito rápida, o usuário provavelmente não notará. Mas temos uma métrica importante - a primeira renderização, para que o usuário veja algo na página. Nos celulares, a primeira renderização, de acordo com um estudo de Harry Roberts, ocorre dez vezes depois. Pense se você precisa do base64? Sim, há menos solicitações, mas isso teve algum efeito? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E por favor não use base64 para SVG. Porque o SVG é ótimo para usar o codificador de URL. Julia Bukhvalova tem uma </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">ferramenta</font></a><font style="vertical-align: inherit;"> legal</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: Entre, cole seu SVG e ele exibirá o CSS em um formato pronto para colar. Você pode perceber que não há base64, mas algumas coisas escaparam que no CSS podem não ser percebidas corretamente. É muito mais eficiente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em média, o base64 oferece um acréscimo de 30% ao tamanho do que você comprime. Pelo que? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use tecnologia moderna. Talvez seja necessário oferecer suporte ao Internet Explorer - os argumentos usuais ao falar sobre grades. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pe/mg/xu/pemgxutjaqos0iq67ch7qdzudnc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas pense bem: se você não tem suporte para o IE e ainda digita em float ou tabelas, pode usar grades para criar um layout de três colunas com uma diferença de 20 pixels - essa é a distância entre as colunas. Três linhas Bem, cinco, considerando o anúncio em si.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tente isso em um carro alegórico. E quero dizer que alteramos três linhas, incluindo o nome das classes, se você tocar em HTML. Eu não encontrei uma maneira de fazer o mesmo legal em um carro alegórico. Jogue fora suas decisões. Mas use a tecnologia moderna. Eles permitem que você indique de forma mais compacta a marcação. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ji/vb/ze/jivbzezcoj7ou78zj5ylexaxd8i.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode experimentar o Atomic CSS. O que é isso? Você escreve esses nomes de classe um pouco loucos. Depois de algum tempo, você começa a entender que é você quem define a cor de fundo ou apenas a cor. Estes são os "recursos" para CSS. Mas você tem um conjunto fixo de CSS que você usa em HTML como uma indicação de estilo. E o CSS está subitamente ficando menor. Para projetos grandes, ele realmente se tornará menor, porque há menos estilos únicos. Mas você está desenvolvendo HTML.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/gy/77/fl/gy77flr72xq4fuxlgz0jq3etfcu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode olhar na direção do Tailwind CSS, que agora está ganhando popularidade. Não é CSS atômico, trata-se de classes de utilidade, semelhantes ao Bootstrap, apenas mais utilitárias. Você pode usar um conjunto específico. O suficiente parece ser suficiente para você. Um conjunto de classes que executam suas funções. Você também pode tentar, mas não exagere. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/kn/ir/8j/knir8jsxsmezohd8gouoba98pk4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra idéia maluca - por que precisamos de nomes de classe inteiros no cliente? Sim, é conveniente para desenvolvimento e depuração, mas vamos pegar todos os nomes de classe e transformá-los em uma letra. Será menos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui está </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre como fazer isso. Você pode configurar o webpack ou outro plug-in ao criar. Mas não decolou de nós. Nós tentamos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aconteceu que o gzip é tão legal que tudo foi muito bem otimizado para nós, e o BEM e o gzip são incrivelmente amigáveis. </font><font style="vertical-align: inherit;">Como as construções de texto são repetidas para descrever blocos e elementos no código. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, isso nos deu quase nenhum lucro. </font><font style="vertical-align: inherit;">Mas se, por exemplo, você não tiver o BEM e um monte de classes diferentes, poderá tentar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Importante: medir. </font><font style="vertical-align: inherit;">Meça todas essas peças experimentais. </font><font style="vertical-align: inherit;">Talvez agora funcione para você e, em seguida, você alterou levemente a arquitetura do projeto, ele começou a se montar de maneira diferente e tudo ficou mais lento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baixe!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Até agora, eu só falei sobre como baixar um arquivo. Nós o baixamos. O que o usuário viu todo esse tempo? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hv/0l/8e/hv0l8e1uk89lmfqategu9yux-je.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele viu uma tela tão incrível. Enquanto estávamos baixando, a tela estava em branco. Fizemos o download e o navegador inicia mais seis etapas. Seja um pouco paciente, vou falar sobre eles um pouco mais rápido do que sobre o download. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/4c/zj/yy/4czjyy-8-jl4c4qdm9dzgczmfes.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos começar com a análise. A análise é quando um navegador baixa um fluxo de bytes e começa a dividi-lo em entidades que ele entende.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/709/df0/50d/709df050daf8e241e96c31e73c720fad.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, ele se deparou com importação. Isso novamente deve ser baixado. Leia a primeira parte do relatório novamente? A importação é uma operação de bloqueio. Mas os navegadores são inteligentes. Eles têm um scanner de pré-carregamento. Eu disse que tudo está bloqueado lá, isso não é verdade. Os navegadores sabem que, por exemplo, se houver três tags de link seguidas que seguem o estilo, quando eu baixar o primeiro, você poderá começar a baixar o segundo e o terceiro. Ele não pode analisar, porque toda a estrutura da análise é interrompida. Mas faça o download com antecedência - pode. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/yw/qw/abywqwqotl2uyae8y67kpx_-6ky.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então importar é uma coisa ruim. Se os estilos forem consistentes em HTML, o navegador verá que iremos além em outro arquivo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xf/zb/-k/xfzb-kzu_zycogs1kilkjp73rsy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E se você o inserir diretamente na importação, primeiro faça o download do seu style.css e veja a importação. Ele começa a analisar esse CSS ... Sim, bloqueamos tudo de uma maneira nova e procuramos o arquivo! Assim, você pode fazer uma cachoeira legal com desoptimização no site. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esqueça a importação ou configure para que não haja importação após a compilação. Para o ambiente de desenvolvimento, ok, mas não para o usuário. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/le/2g/lx/le2glxus3towgrovquopecvq1nu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, passamos pelas etapas de construção de árvores, usando o Cascade. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qo/g-/q8/qog-q84eqwq9dszmfw3zlo7f__0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo isso também é descrito por um longo tempo. O CSS Object Model é construído - uma árvore especial de como o navegador mapeia tags, classes para estilos. Ele vincula tudo ao DOM e faz essas conexões muito rapidamente. Quando você muda alguma coisa, basta que ele mude dentro da árvore.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/cp/kv/b1/cpkvb1obn0v0kwyr1ijpgmc3vmc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto maior o seletor, mais difícil é para o navegador desenhar uma árvore. Ele precisa analisar o seletor, convertê-lo em estruturas em árvore. E se você inseriu! Importante lá, ele deve levar isso em conta. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ab/z_/ld/abz_ldlw6yhtfzvfiak5pjnnjem.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece que é hora de falar sobre o BEM novamente. Mas o BEM não é necessário se você souber usar classes de utilitário, se uma classe for responsável por uma funcionalidade e elas não interferirem entre si. Então construir uma árvore é muito simples. Você tem uma estrutura bastante plana e, em seguida, o navegador deve vinculá-lo corretamente ao DOM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/w3/tt/fd/w3ttfdtaor_cd7m8e4gikrch4po.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você fizer isso, eles dizem que esses seletores desaceleram a análise de CSS. Mas essas são lendas há muito tempo, a diferença é tão pequena para o navegador que, no projeto médio, você não perceberá se otimizar seletores com asteriscos. Mas você gostaria de desenvolver e manter esse código? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/po/83/1d/po831d3idqqnykaw8ieprtg5eoo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eu costumava ouvir dicas: tente colocar tudo em um atalho. background é um atalho para muitas outras propriedades. Colocamos tudo em uma propriedade e ela se torna ideal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por bytes, sim, está ficando menor. Mas se você deseja otimizar a composição do CSS OM, o navegador ainda fará com que todas essas propriedades ocorram em segundo plano. Os navegadores para cada elemento DOM criam uma tabela de todas as propriedades que ele pode ter. Quando você olha para os valores calculados do DevTools, eles não estão lá porque o navegador os calculou de acordo com seus requisitos. Ele armazena isso na memória, porque é muito mais fácil reescrever uma propriedade e tudo funciona. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse também é um conselho muito estranho, mas se você quiser acelerar o CSS OM, poderá definir imediatamente todas as propriedades, uma de cada vez. Isso pode funcionar. Mas o tamanho do pacote aumentará bastante. Você precisa medir. Duvido que dê lucro, mas de repente!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando o CSS OM é criado, o JS também está bloqueado neste momento. Se a construção do OM CSS demorar dois segundos, o JS falhará. Embora eu não possa imaginar como você conseguiu escrever tanto em CSS que a árvore foi criada por dois segundos. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/25/0e/un/250eunwpu4yepgffhza-6g1u2dg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, o navegador faz o Layout. Esta é a localização de todos os elementos DOM, o uso de posições. Ele entende onde o elemento deve estar localizado e com quais dimensões. Parece que, nesta fase, o usuário já deve ver algum tipo de imagem. Mas ele vê tudo na janela de exibição, pode olhar através de uma janela limitada. Se algo não está certo por baixo, ele simplesmente não vê.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/hg/af/_r/hgaf_racfuoqjcan8wci-i94miu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A idéia é chamada CSS crítico e também é bastante antiga. Você insere algumas coisas importantes para a primeira tela no início do download. Por exemplo, em linha no seu HTML, livre-se de quaisquer solicitações adicionais. O usuário vê essa tela primeiro e depois faz o download como quiser. Provavelmente, ele começará a rolar quando tiver tempo para carregá-lo. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hb/nk/0u/hbnk0uuz7vgkbubstjoqnfwgsus.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso é feito simplesmente. Existem ferramentas que automatizam tudo isso, incluindo plugins para webpack e React. Basta pesquisar e configurar corretamente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/addyosmani/critical</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/pocketjoso/penthouse</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/anthonygore/html-critical-webpack-plugin</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/GoogleChromeLabs/critters</font></font></a><br>
<br>
<img src="https://habrastorage.org/webt/1p/pi/qp/1ppiqpkakke_gsbhxo1cybumlgo.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tenha uma boa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">abordagem</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do Filament Group - como carregar de forma assíncrona sem bloquear o CSS. Tudo é bem simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando você colocar &lt;link rel = preload&gt;, diga ao navegador: “Vou precisar desse estilo, mas agora não estamos bloqueando nada. Faça o download agora, armazene em cache e, quando eu voltar, comece a criar o CSS OM. ” E você só precisa colocar onload e processar que "ok, desde que eu baixei, faça rel = stylesheet, habilite a análise". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma abordagem bastante simples, mas use-a com sabedoria também. Se você tiver muita pré-carga, poderá fazer pior. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/j1/ny/ri/j1nyrizteczgvkx5dwd78_fy1yy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você também pode brincar com expressões de mídia. Cole-os e diga ao navegador: "esse estilo não é mais necessário agora, mas quando essa expressão de mídia funcionar, será necessário". O navegador também fará o download proativamente, mas com uma prioridade mais baixa e sem bloqueio.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ie/m3/go/iem3golzhy8qq3fulda1iwn8d0u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra abordagem maluca, mas não tão louca - quando você tem o http / 2 push. Você pode incorporar CSS bem na frente do bloco. Sem CSS, seu bloco não ficará muito bom. Então, por que não incorporar o CSS necessário para o próximo bloco antes desse bloco? Isso é lógico, e o envio http / 2 permitirá que você o otimize. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma abordagem simples. Se você expandi-lo, use carregamento lento. Por que um usuário deve baixar algo que ele não usará? Você pode configurar os componentes do React para que, se ele nunca atingiu a área de visibilidade da página, por que deveria baixar os estilos para si mesmo? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Explore a API do Intersection Observer e poderá acelerar drasticamente sua página. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-v/ag/dz/-vagdzf0qqu3mmpabixf1rw9_ss.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O último passo é desenhar e aplicar em camadas compostas, colá-las e assim por diante.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/be/1v/bc/be1vbcsui3hmenm-0ryzhadzrjs.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O navegador cria camadas compostas em um grande número de casos. </font><font style="vertical-align: inherit;">Na minha opinião, apenas um quarto do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">código fonte do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chromium se </font><font style="vertical-align: inherit;">encaixa aqui </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Você pode ver por si mesmo quando ele cria camadas compostas no código do navegador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A memória de vídeo é limitada, especialmente em telefones celulares. </font><font style="vertical-align: inherit;">Se você trouxer tudo para novas camadas para otimizar as animações usando o will-change: transform ou qualquer outra coisa, poderá estar piorando. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Crie menos camadas - exatamente o necessário para a otimização atual. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ótimo, todos nós analisamos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E se eu voltar?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E se eu voltar à página? Esta é apenas a primeira vez que fui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voltando à página, parece que consigo baixar tudo instantaneamente. Eu já baixei todos os recursos, por que não usá-los uma segunda vez? </font></font><br>
<br>
<img src="https://habrastorage.org/webt/8v/di/1l/8vdi1lapv3i9ka0lb-swsysnhms.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o servidor não fornecer o cabeçalho de controle de cache, o navegador tentará armazenar em cache seu arquivo para reutilizá-lo. Você pode configurar seu servidor por padrão, digamos: "armazene em cache esse arquivo por um ano inteiro". Não mudará. Mas, nesse caso, você precisa lidar com o problema de invalidação do cache global. Mas este é o tópico de um relatório separado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use trabalhadores de serviço! 2020, é hora, Aplicativos Web Progressivos! Kirill Chugainov teve um bom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relatório</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sobre como os Trabalhadores em Serviço podem ser usados ​​para diferentes ocasiões. Nesse caso, você intercepta a solicitação CSS, salva-a e, se o navegador seguir esse estilo pela segunda vez, afaste-a do cache. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o navegador não promete nada a você. Você sempre pode enfrentar o fato de o navegador ficar sem memória. Ele tentará armazenar em cache, mas não há memória. O armazenamento em cache não é cem por cento. Sempre lide com essas situações. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode tentar usar o armazenamento local. Mas ele é muito lento. Às vezes, o download de um arquivo é mais rápido do que ir para a API de armazenamento local. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode tentar o banco de dados interno do navegador. Mas meça. Talvez uma viagem ao JS leve mais tempo devido a um processador fraco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você também pode informar com antecedência ao navegador que fará o download de algo.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/7a/_f/oq/7a_foqb9hzh_ycjaddhrkarqhia.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;link rel&gt; - saiba como esse atributo funciona. Há pré-conexão, pré-busca, pré-renderização - quero falar sobre isso separadamente. Ele diz: “Estou nesta página agora e depois irei para a próxima. Faça o download de tudo para esta página na guia segundo plano e desenhe. ” Coisas legais. Não funciona em lugar nenhum. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/iy/ca/ql/iycaqlaidexf0urgnjv05zpjskg.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De certa forma, ele é suportado no IE e Edge. No Chrome, ele realmente não faz isso, não é renderizado. Funciona como pré-busca: baixa esses arquivos e caches. Infelizmente, um pré-renderizador completo não funciona em lugar nenhum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas você pode desenvolver essa ideia. Por exemplo, no aplicativo Yandex - naturalmente, não usando CSS - é feito um pré-renderizador. Quando você está procurando algo, é provável que obtenha resultados instantaneamente. Nós </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">podemos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> prever onde você vai, e com antecedência pelos nossos próprios métodos de ir buscar todos os recursos necessários.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qual é o próximo? </font><font style="vertical-align: inherit;">Havia muitos links. </font><font style="vertical-align: inherit;">Também aconselho a olhar para uma incrível </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coleção de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> otimização de tudo, desde Vanya Akulov</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iamakulov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Veja como otimizar HTML, JS e assembly. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E não se esqueça de arrumar. </font><font style="vertical-align: inherit;">Agora, meu conselho realmente funciona, sugerindo como fazê-lo rapidamente, mas provavelmente, depois de cinco anos, eles serão prejudiciais. </font><font style="vertical-align: inherit;">Haverá algum tipo de tecnologia que será incompatível com eles. </font><font style="vertical-align: inherit;">Acompanhe isso e tente manter seu código ideal, inclusive depois de um tempo. </font><font style="vertical-align: inherit;">Obrigado pela atenção.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt501988/index.html">Como a tela da mensagem VK é renderizada?</a></li>
<li><a href="../pt501990/index.html">Postagem útil: 4 eventos para resolver os problemas do segundo dia no OpenShift e criar operadores</a></li>
<li><a href="../pt501992/index.html">Como organizar os testes para acelerar e estabilizar os lançamentos de produtos. Parte 1</a></li>
<li><a href="../pt501994/index.html">Orchestrator for MySQL: por que um projeto à prova de falhas não pode ser construído sem ele</a></li>
<li><a href="../pt501996/index.html">Zen Go (versão de bolso)</a></li>
<li><a href="../pt502000/index.html">12 cursos online de engenharia de dados</a></li>
<li><a href="../pt502004/index.html">Método Kanban: Entendendo seu processo como um processo coletivo de construção de conhecimento - Parte 1 (receitas)</a></li>
<li><a href="../pt502008/index.html">Programação para as massas</a></li>
<li><a href="../pt502028/index.html">Vanya vai para a avó ou JavaScript dinâmico adaptável</a></li>
<li><a href="../pt502030/index.html">Serviços Web no Oracle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>