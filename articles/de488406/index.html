<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌈 🗒️ ◽️ IPv6 - Sie machen es falsch 😌 🕺 👩🏼‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt viele Missverständnisse und Mythen rund um IPv6. Häufig verstehen Hosting-Anbieter die Verwendung falsch und denken an veraltete Ansätze aus d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>IPv6 - Sie machen es falsch</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/488406/"><img src="https://habrastorage.org/webt/gg/-1/kx/gg-1kxivqjrehg1_oidyoqkphos.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt viele Missverständnisse und Mythen rund um IPv6. Häufig verstehen Hosting-Anbieter die Verwendung falsch und denken an veraltete Ansätze aus der IPv4-Welt. Mit beispielsweise Oktillionen von IPv6-Adressen verkauft der Hoster Adressen einzeln an Clients, anstatt ein vollwertiges Netzwerk / 64 zuzuweisen, wie aus den Empfehlungen hervorgeht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es kommt vor, dass Hoster verschiedenen Clients innerhalb desselben / 64-Netzwerks IPv6-Adressen zuweisen. Gleichzeitig nehmen große Dienste wie Google alle Adressen im Bereich / 64 als einen Client wahr. Infolgedessen können Kunden unter den Aktivitäten eines Bandkollegen leiden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Verfügbarkeit von IPv6-Adressen können Sie internen Ressourcen wie Containern oder VPN-Clients vollständige externe Adressen zuweisen. </font><font style="vertical-align: inherit;">Dazu muss der Host dem Client ein separates geroutetes Netzwerk zur Verfügung stellen. </font><font style="vertical-align: inherit;">Leider kann das fast niemand. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werden die Hauptfehler bei der Verwendung von IPv6-Anbietern analysiert.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handlung: RFC 3177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Im Jahr 2001 wurden die Empfehlungen zur Zuweisung von Adressen empfohlen (Entschuldigung für die Tautologie, dies ist wichtig), um Folgendes hervorzuheben:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 48 im Allgemeinen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 64 wenn dahinter nur ein Subnetz</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ 128 wenn ein und nur ein Gerät</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das anstößige Dokument RFC 2119, das die Anwendung verschiedener Ebenen der obligatorischen Einhaltung von Anweisungen regelt, definiert „empfohlen“ wie folgt: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Wörter „sollte“ oder „empfohlen“ bedeuten, dass es unter bestimmten Umständen vernünftige Gründe geben kann, nicht auf diese Weise zu handeln, jedoch die Wahl einer anderen Verhaltenslinie muss eine ausgewogene Entscheidung sein, die mit vollem Verständnis der Konsequenzen getroffen wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht hatte zu diesem Zeitpunkt niemand ein vollständiges Verständnis der Konsequenzen, vielleicht wurden „bestimmte Umstände“ nicht definiert, aber auf die eine oder andere Weise folgten alle den Empfehlungen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen war IPv6-Verkehr zum Zeitpunkt des Schreibens des Dokuments äußerst selten und wurde größtenteils in Instituten und persönlichen Netzwerken neugieriger Enthusiasten gefunden. </font><font style="vertical-align: inherit;">Einige echte Probleme häuften sich und analysierten sich, aber es dauerte viel Zeit. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Umdenken begann im Jahr 2005. </font><font style="vertical-align: inherit;">Schließlich wurden diese Empfehlungen im Jahr 2011 abgelehnt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kenntnis des Problems: RFC 6177</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die neue Adressierungsrichtlinie besagt ausdrücklich, dass / 48 nur ein Wunsch ist, keine Anforderung. Es wird kein Hinweis auf bestimmte Nummern gegeben, es wird jedoch angegeben, dass / 64 oder kürzer unter normalen Bedingungen funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptlogik bei der Empfehlung der Größe der Ausgabe des Blocks / 48 an den Endverbraucher verfolgte drei Ziele. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens sollte der zugewiesene Adressraum für Verbraucherzwecke ausreichend und leicht erweiterbar sein, ohne Langhantelkniebeugen. Ja, genau das steht, nur in der englischen Version - springe durch Reifen. Einer der wichtigen Gründe für den Wechsel zu IPv6 besteht darin, die vorhandene Zielgröße von "einzelne Adresse" in "mehrere Subnetze" zu ändern.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens sollte der Anbieterwechsel mit einem Minimum an Problemen durchgeführt werden. </font><font style="vertical-align: inherit;">Wenn Sie das alte Subnetz-Adressschema speichern können, wenn Sie in einen neuen Adressraum wechseln, spart dies viel Arbeit </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Drittens sollte die Zuweisung von Block / 48 die Zunahme der Anforderungen des Adressraums eines sich entwickelnden Verbrauchers abdecken. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obwohl alle diese Bedingungen erfüllt waren, stellte sich heraus, dass die Empfehlung / 48, gelinde gesagt, überflüssig war.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pin / 64 als Ausgabeeinheiten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neben der Verteilungsreihenfolge gab es noch weitere Punkte. </font><font style="vertical-align: inherit;">Es stellte sich heraus, dass viele Funktionen von IPv6 nicht funktionieren, wenn das Netzwerkpräfix nicht / 64 ist. </font><font style="vertical-align: inherit;">Sie funktionieren nämlich nicht:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachbarentdeckung (ND)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sichere Nachbarschaftsentdeckung (SENDEN)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einige Teile von Mobile IPv6</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site-Multihoming durch IPv6-Vermittlung</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viele verschiedene kleine Dinge</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer Faktor war die Tatsache, dass viele der entwickelten Technologien genau auf einem solchen Netzwerkpräfix beruhten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nicht nur die Drohung, den neu entdeckten Standard zu brechen, war der Grund für das Schreiben neuer Empfehlungen. </font><font style="vertical-align: inherit;">Zwei Meinungen von zweifelhafter Gültigkeit waren ebenfalls sehr beliebt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstens implementieren viele Geräte das IPv6-Routing programmgesteuert mit Krücken und Fahrrädern und sind daher nicht für einen vollständigen Übergang bereit. </font><font style="vertical-align: inherit;">Eine mögliche Erhöhung der Verzögerung aufgrund dieser kann sich um ein Vielfaches erhöhen, wenn nicht sogar um eine Größenordnung. </font><font style="vertical-align: inherit;">Die Standarddefinition des / 64-Subnetzes würde diese Verzögerungen erheblich reduzieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zweitens ist die Umstellung auf einen neuen Standard für den technischen Support und die Systemadministratoren immer ein Problem. </font><font style="vertical-align: inherit;">Ein einzelnes / 64-Präfix sollte diesen Schmerz auf einen akzeptablen Wert reduzieren.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Situation an den Fronten</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie bereits im Jahr 2001 wurde Empfehlung / 64 von vielen großen Internet-Playern als Standard angesehen. Einerseits ist es gut, andererseits nicht so gut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei vielen Bewertungssystemen, beispielsweise zur Spam-Erkennung, werden alle Adressen aus einem Block als zu einem Spammer gehörend betrachtet. Theoretisch sollte dies dem Benutzer das Leben erleichtern, im Gegenteil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oft beschäftigen sich Anbieter nicht mit Dingen wie dem Erlernen gängiger Praktiken. Adressen können nach jedem Prinzip vergeben werden, zumindest sogar nach dem Horoskop. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt mehrere typische Probleme, die alle auf die Verletzung der Empfehlungen des Anbieters einerseits und die strikte Einhaltung durch einige andere Organisationen andererseits zurückzuführen sind.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Ausgeben von Adressen von einem Block an mehrere Benutzer kann dazu führen, dass alle als ein tatsächlicher Benutzer betrachtet werden, z. B. Maschinen im Netzwerk des Unternehmens. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn mehrere Personen aus diesem Block gleichzeitig nach Katzen suchen, kann Google entscheiden, dass dieses Botnetz Anfragen nach Suchbetrug oder anderen nicht sehr guten Dingen sendet. Aus seiner Sicht ist dies alles ein Benutzer. Das logische Ergebnis ist ein zunehmend komplizierteres Captcha. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie wissen, ist dies die harmloseste Antwort auf einen hypothetischen Betrug.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die umgekehrte Situation ist die Ausgabe von Adressen aus verschiedenen Blöcken an einen Benutzer. </font><font style="vertical-align: inherit;">Wenn Benutzer dieser Blöcke in die schwarze Liste einer anderen Person fallen, fallen die Adressen eines ehrlichen Benutzers mit. </font><font style="vertical-align: inherit;">Besonders interessante Geschichte: Einige Ihrer Adressen wurden von einem Werbenetzwerk gesperrt, andere von einem anderen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Darüber hinaus sind weitere unangenehme Überraschungen möglich. </font><font style="vertical-align: inherit;">Sie haben beispielsweise Block / 64 für Ihre Verwendung erhalten, dies ist jedoch ein dynamischer Block als dynamische Adresse - heute 2001: DA8: 1D01: FA13 :: / 64, morgen 2001: DA8: 1D01: FC15 :: / 64. </font><font style="vertical-align: inherit;">Jeden Tag neue Abenteuer! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es besteht eine beträchtliche Chance, verschiedene Kombinationen dieser Probleme und anderer phantasievoll gekrümmter Rechen im Anhang zu treffen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie IPv6 von unserem Server aus</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir über eine Billion IP-Adressen verfügen, geben Sie beispielsweise VPN-Clients echte IP-Adressen, damit diese ohne NAT ins Internet gehen und eingehende Verbindungen aus der ganzen Welt akzeptieren können. </font><font style="vertical-align: inherit;">Es klingt großartig, aber in der Praxis ist es nicht so einfach. </font><font style="vertical-align: inherit;">Dies erfordert ein separates IPv6-Netzwerk, das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">über die</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der Serverschnittstelle zugewiesene IP-Adresse </font><font style="vertical-align: inherit;">geleitet </font><font style="vertical-align: inherit;">wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, einem Server wird eine Adresse zugewiesen </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dann benötigen VPN-Clients ein separates Netzwerk, z. </font></font><code>2a01:baba:fafa:0f0f::/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B. über die Adresse weitergeleitet </font></font><code>2a01:baba::c0fee:dead/64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leider verfügen nur sehr wenige Hosting-Anbieter über Tools, mit denen solche Netzwerke an Clients </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ausgegeben werden können</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Deshalb müssen Sie Krücken wie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ND Proxy verwenden</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Lesen von IETF-Empfehlungen ist nicht die interessanteste Aktivität, aber äußerst nützlich. </font><font style="vertical-align: inherit;">Es lohnt sich natürlich nicht, sie mit langen Winterabenden zu füllen, aber es ist auch unerwünscht, die für Sie wichtigen Abschnitte nicht zu lesen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie bei der Auswahl eines Anbieters sicher, dass er diesen Standpunkt teilt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie müssen verstehen, dass der falsche Ansatz bei der Zuweisung von Adressen dem Anbieter keinen Schaden zufügt und bei den meisten Verträgen nicht einmal die Grundlage für eine Entschädigung sein kann. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies kann sich jedoch als Schlüsselfaktor für Sie herausstellen, obwohl Sie es selbst noch nicht vermuten.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de488386/index.html">Fälle für die Anwendung von Tools zur Analyse von Netzwerkanomalien: Angriffe über Browser-Plug-Ins</a></li>
<li><a href="../de488388/index.html">Relogin und HTTP Basic Auth</a></li>
<li><a href="../de488390/index.html">So machen Sie mit OpenId Connect Telegramm-Bot-Freunde</a></li>
<li><a href="../de488392/index.html">Produktionsbereite Bilder für k8s</a></li>
<li><a href="../de488404/index.html">Spiele, auf die es sich zu warten lohnt, im Jahr 2020</a></li>
<li><a href="../de488408/index.html">STM32 Ethernet-RS485 IoT Gateway</a></li>
<li><a href="../de488410/index.html">7 Lektionen, die ich in zehn Jahren in der Entwicklung gelernt habe</a></li>
<li><a href="../de488412/index.html">Erstellen eines Discord-Bots basierend auf discord.js</a></li>
<li><a href="../de488416/index.html">SLAE - Security Linux Assembly Expert Prüfung</a></li>
<li><a href="../de488418/index.html">REST-API-Authentifizierung mit Spring Security und MongoDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>