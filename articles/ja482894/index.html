<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😏 🔘 😟 WaveFunctionCollapseアルゴリズムと事前確率分布を使用した適応型手続き型生成 🚶🏿 ⏭️ 👨🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="手続き型生成とは何ですか？
 プロシージャル生成には多くの生成アルゴリズムが含まれ、その原理はデータを手動ではなくアルゴリズムで作成することです。作成したいもの（マップ、音楽、地形など）を手動で作成する代わりに、同じプロセスを複数回実行する。このアプローチは、マップ全体またはレベルをランダムに生成で...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>WaveFunctionCollapseアルゴリズムと事前確率分布を使用した適応型手続き型生成</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482894/"><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手続き型生成とは何ですか？</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロシージャル生成には多くの生成アルゴリズムが含まれ、その原理はデータを手動ではなくアルゴリズムで作成することです。作成したいもの（マップ、音楽、地形など）を手動で作成する代わりに、同じプロセスを複数回実行する。</font><font style="vertical-align: inherit;">このアプローチは、マップ全体またはレベルをランダムに生成できるビデオゲームで特に便利です（たとえば、Minecraft、Terraria、またはFactorioのマップ、またはほとんどのローグライクのレベルスキーム）。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">波動関数崩壊アルゴリズムとそのスコープ</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では</font><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">Maxim Gumin</font></a><font style="vertical-align: inherit;">によって提案され</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">た波動関数の折りたたみアルゴリズム（WaveFunctionCollapse、WFC）</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を調べ</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">ます（</font></a><font style="vertical-align: inherit;"> Twitterには他の開発者がこのアルゴリズムを使用して作成したすばらしいコンテンツのコレクションがあります！）指定されたサイズのグリッドの画像。</font><font style="vertical-align: inherit;">
アルゴリズムは、どのタイルが既に部分的に構成された画像に「対応」しているのかを追跡して、完成した画像を段階的に作成するという考え方に基づいています。</font><font style="vertical-align: inherit;">アルゴリズムの詳細については、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">Githubの元のWFCリポジトリ</font></a><font style="vertical-align: inherit;">と記事の4番目のセクション</font><font style="vertical-align: inherit;">を参照することをお勧めします。</font><font style="vertical-align: inherit;">「</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">WaveFunctionCollapseは野生での制約解決</font></a><font style="vertical-align: inherit;">」</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/887/cab/bc8/887cabbc82864fa16f590d3e6ca859e1.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手続き的に生成されたシード画像の例</font></font></i><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同様の画像を作成することに加えて、WFCアルゴリズムのアプリケーションの別の領域は、タイルカードの生成です。</font><font style="vertical-align: inherit;">タイルマップの生成が記事の主なトピックになります。これは、アイデアを視覚的に説明するのに使用しやすいためです。</font><font style="vertical-align: inherit;">サンプル画像の代わりに、交互に接続できるタイルとタイルのペアのみを保存できます。</font><font style="vertical-align: inherit;">この場合、アルゴリズムを使用して、以下に示すような画像を作成できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e72/7d0/cfc/e727d0cfc2cf088a7fa82d04513dfe1e.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ランダムに生成されたタイルの例</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">課題と私たちのソリューション</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちは、ボードゲーム</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カルカソンヌ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（「カルカソンヌ」）に</font><font style="vertical-align: inherit;">基づいてタイルカードを生成するタスクを引き受けました。</font><font style="vertical-align: inherit;">フィールドでは、プレーヤーが「手動で」（下記のアニメーションを参照）、互いに組み合わせる必要のあるタイルからフィールドを生成します。</font></font><br>
<br>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 57.501%;"><video loop="" muted="" webkit-playsinline="" autoplay="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="https://thumbs.gfycat.com/OilyFarAmericanpainthorse-mobile.mp4" type="video/mp4"></video></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
驚くべきことに、概念的には、これは不完全なソリューションに新しいパーツを追加して任意のタイルカードを作成するWFCアルゴリズムと非常に似ています。</font><font style="vertical-align: inherit;">また、WaveFunctionCollapseはタイルカードジェネレーターとして使用できるため、「カルカソンヌ」フィールドも生成できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ただし、ゲーム自体には非常に多くの異なるタイルがあり、それらすべての比率をコーディングすることは、24時間のハッカソンにとって非常に膨大な作業です。</font><font style="vertical-align: inherit;">したがって、私たちは城や川を使わず、道路、草、修道院だけを使った「カルカソンヌ」の非常に簡略化されたバージョンを演奏することにしました。</font><font style="vertical-align: inherit;">したがって、回転と対称性を備えた6つのタイルが可能です。</font><font style="vertical-align: inherit;">しかし、そのような条件下でも、結果は美しく、カルカソンヌでの実際のゲームのように見えます！</font></font><br>
<br>
<div class="oembed"><div style="max-width: 100vh;"><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 100%;"><video loop="" muted="" webkit-playsinline="" autoplay="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">お使いのブラウザはHTML5ビデオをサポートしていません。</font></font><source src="https://thumbs.gfycat.com/DimThornyBunny-mobile.mp4" type="video/mp4"></video></div></div></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズムでカルカソンヌフィールドを埋める視覚化</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/681/d89/8fe681d89415778bf69d4fab4e735d27.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アルゴリズム</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
に入力されたルールの例上の画像には、アルゴリズムに追加された入力ルールの例が含まれています。</font><font style="vertical-align: inherit;">ただし、フィールドの外観の特定の側面を制御する必要があります。</font><font style="vertical-align: inherit;">アルゴリズムは、修道院で満たされた、都市に似た道路から「通り」を作成する必要がありますか、それとも、フィールドは、その周りに村が点在する草で構成される必要がありますか？</font><font style="vertical-align: inherit;">元のアルゴリズムでは、（他のように）このような条件を制御する方法はありませんが、制御の可能性のために、単純な改善を行うことが可能です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベイジアン事前確率分布</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上記のように、各ステップで、アルゴリズムは新しいタイルをフィールドに追加して、既に配置されているタイルと一致するようにしますが、選択した場所に複数の異なるタイルを配置できる場合はどうなるかについては触れていません（方法についても触れませんでした）通常はこの場所を選択しますが、記事ではそれを考慮しません！）。元のアルゴリズムでは、適切なタイルがランダムに均一に選択されます。ただし、私たちの決定では、芝生などの特定のタイルを優先して、フィールドでより頻繁に発生するようにすることができます。これは、両方のタイプのタイルを使用できる場合、芝生が道路よりも使用される可能性が高いタイルの不均一な「確率事前」分布を作成することによって実現できます。これはベイジアン手法を連想させます。 2つのオプションから選択する単純化されたケースでは、草と道路の場合、p&gt; 0.5の確率で草を追加できます。均一な確率で得られる通常の0.5ではありません。このタスクは、各タイルに優先度の値を割り当て、この値を使用して確率をすべての可能なタイルの値の合計で割った値として設定することにより、簡単に一般化できます。下の図は、非常に異なる係数値を持つ2つの適切なソリューションを示しており、アルゴリズムの感度を理解できます。下の図は、非常に異なる係数値を持つ2つの適切なソリューションを示しており、アルゴリズムの感度を理解できます。下の図は、非常に異なる係数値を持つ2つの適切なソリューションを示しており、アルゴリズムの感度を理解できます。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b6f/4b0/30a/b6f4b030a2b8a2baf17b5e140a5afce8.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なる初期事前確率分布の異なるソリューション</font></font></i><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">別の例：条件付き確率とグループ化</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このアイデアを拡張できます。これを説明するために、カルカソンヌフィールドの代わりに、Minecraft鉱石の2次元マップを生成します。</font><font style="vertical-align: inherit;">Minecraftのさまざまな種類の鉱石は通常、大規模なフォーメーションで見られます。そのため、各鉱石の確率を設定するとともに、マップにすでに配置されている近隣に確率を依存させます。</font><font style="vertical-align: inherit;">石炭の近くの鉄の配置には「禁止」は何もありませんが、既に配置されている石炭の隣に、別の石炭がより高い優先順位を与えられています。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは以下の画像では考慮されていませんが、ゲームでは確率はタイルの高さに依存するため、画像内の位置もタイルの確率の分布状態に影響を与える可能性があります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c84/715/69e/c8471569ee2741d7a7f781154e520136.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WFCによって作成されたMinecraft鉱石タイルマップの例</font></font></i><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
手続き型生成は、ストックしておく価値のある強力なツールです。</font><font style="vertical-align: inherit;">特に、WFCは世界の生成で積極的に使用されており、新しいタイルの分布が不均一であり、他の要因、たとえば、マップに既に配置されている近傍、新しいタイル、画像内の位置などの影響を受ける可能性を考慮する価値があります。</font><font style="vertical-align: inherit;">非常にシンプルなアプリケーションを作成しましたが、開発の可能性はほとんど無限です！</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja482882/index.html">電磁ブレーキとしてのモーター</a></li>
<li><a href="../ja482884/index.html">夜のレッスン：構文の強調表示を書く</a></li>
<li><a href="../ja482886/index.html">ハブラ分析：出版の長さは重要ですか？</a></li>
<li><a href="../ja482888/index.html">プロバイダーNATの背後でのVPNサーバーの開始</a></li>
<li><a href="../ja482892/index.html">Let vs const-何を使うべきですか？</a></li>
<li><a href="../ja482896/index.html">OSCP-私の経験</a></li>
<li><a href="../ja482898/index.html">モスクワのプロの燃え尽きの歴史-1996年から2017年まで。国営企業のトップマネージャーから研究者までの道のり</a></li>
<li><a href="../ja482900/index.html">オンラインでの自動マーチャンダイジング、または自転車の発明方法</a></li>
<li><a href="../ja482902/index.html">いいえ、人工知能は私たちを倒すことはできません</a></li>
<li><a href="../ja482904/index.html">宇宙マイクロプロセッサの簡単な歴史、パート1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>