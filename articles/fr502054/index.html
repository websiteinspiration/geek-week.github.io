<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö∂üèø üôáüèº üçô R√©seau de neurones convolutifs et son int√©gration dans iOS (partie 2) üë©‚Äçüöí üôåüèº ‚úäüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la partie pr√©c√©dente, nous avons pr√©par√© les donn√©es et examin√© √©galement les outils de mise en ≈ìuvre et l'architecture du r√©seau neuronal ( lien...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>R√©seau de neurones convolutifs et son int√©gration dans iOS (partie 2)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/502054/"><img src="https://habrastorage.org/webt/fk/nn/iv/fknnivkxwzilkr5dzw_mstec7bk.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la partie pr√©c√©dente, nous avons pr√©par√© les donn√©es et examin√© √©galement les outils de mise en ≈ìuvre et l'architecture du r√©seau neuronal ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lien</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Commen√ßons la prochaine √©tape du d√©veloppement avec le pr√©traitement des donn√©es. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mises √† niveau</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Keras fournit une large gamme d'outils pour le pr√©traitement des donn√©es, en particulier pour les images. </font><font style="vertical-align: inherit;">La m√©thode ImageDataGenerator (Fig. 7) vous permet d'√©tendre l'ensemble de donn√©es avec des transformations artificielles. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/bj/70/0y/bj700y-rnmubq3yfqfyustyshcu.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.7. </font><font style="vertical-align: inherit;">- G√©n√©rateur de donn√©es.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier nombre rotation_range est un nombre al√©atoire pour la rotation des images √† l'int√©rieur du g√©n√©rateur. Width_shift_range - montre combien vous pouvez r√©duire les valeurs de pixels en largeur. Height_shift_range - le coefficient par lequel chaque pixel sera multipli√© pour se comprimer en hauteur. Shear_range - taux de cisaillement, angle de d√©calage dans le sens antihoraire en degr√©s. Zoom_range - plage pour une mise √† l'√©chelle al√©atoire. Horizontal_flip - image al√©atoire affich√©e horizontalement. Vertical_flip - affichage d'image vertical al√©atoire. Fill_mode - les points en dehors des donn√©es d'entr√©e sont remplis conform√©ment au mode sp√©cifi√©. Data_format - format de donn√©es d'image. Ainsi, le r√©seau neuronal aura une meilleure g√©n√©ralisation, car le jeu de donn√©es d'origine a essentiellement des pixels propres, les nombres sont au centre.Dans les vraies photographies, d'autres situations sont possibles lorsque le geste est dans un coin ou flou. Le processus d'apprentissage est en cours de r√©√©criture avec de nouvelles donn√©es.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la figure 8, le graphique du test a commenc√© √† diminuer, donc la formation a √©t√© arr√™t√©e. Si la m√©trique val_acc n'√©tait pas utilis√©e pour l'arr√™t, l'algorithme continuerait son travail, r√©sultant en un r√©seau neuronal recycl√©.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par rapport aux r√©sultats ant√©rieurs, la valeur de la fonction de perte a diminu√© et, par cons√©quent, le degr√© de confiance de l'algorithme dans les pr√©dictions a augment√©. La pr√©cision a augment√© d'un peu plus de 2% (Fig. 8, Fig. 9). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/do/cc/jd/doccjdygrwyzydl51abbpmusqos.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 8 - Calendrier de formation sur les nouvelles donn√©es. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/3k/5f/pf/3k5fpfjks90dt-gmtnxpwlkxj0u.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.9. - M√©triques du mod√®le. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conversion</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Pour l'int√©gration dans l'application iOS, vous devez obtenir un r√©seau neuronal d'un certain format. Cela vous permet de cr√©er le framework CoreML. Il vous permet d'ex√©cuter des mod√®les d'apprentissage automatique form√©s dans un format. mlmodel dans les applications. Pour travailler avec des images, il existe un cadre Vision bas√© sur Core ML et aide au suivi et √† la reconnaissance des visages, du texte, des objets, des codes √† barres. La d√©termination de l'horizon et l'acquisition de la matrice pour l'alignement de l'image sont √©galement disponibles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour convertir un mod√®le de .h5 en. mlmodel est utilis√© par la biblioth√®que de Python Coremltools. Cette biblioth√®que prend en charge la conversion au format mlmodel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour la conclusion correcte du mod√®le, un dictionnaire est sp√©cifi√© qui correspondra √† 10 chiffres. La ligne suivante d√©clare, Model_check.h5 est le nom du mod√®le, il est en outre indiqu√© qu'il recevra des images sur la couche d'entr√©e du r√©seau neuronal. Le champ image_scale conduira √† standardiser la matrice de pixels. (Fig.10) Fig.10 </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gh/fe/ii/ghfeiiblwg6m92ho-avcn9zh7rg.jpeg"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. - Conversion. </font></font></i><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application mobile. Travaillez avec un mod√®le pr√©par√©.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un exemple du site officiel des d√©veloppeurs Apple est utilis√© comme base du projet. Dernier environnement de d√©veloppement Xcode, le langage de programmation est la cinqui√®me version de Swift.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fichiers (Fig. 11) contenant le code dans le projet sont consid√©r√©s. AppDelegate.swift lance la fen√™tre de d√©marrage de l'application et initialise tous les fichiers connect√©s au projet. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/hs/a4/7c/hsa47cfkzfwyp_x9buco1zs4onm.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.11. - La structure de l'application.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un mod√®le pr√©par√© est ajout√© au projet apr√®s la conversion de sign_lang.mlmodel (Fig.12). </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ja/7v/_l/ja7v_ltd52_ttq50j4gc-axbucq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.12. - Mod√®le en Xcode.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La ligne Type indique que le mod√®le d'apprentissage automatique ajout√© au projet est en effet un r√©seau neuronal de classification. Pour pr√©dire le mod√®le, des images en noir et blanc avec des √©l√©ments gris de dimension 64x64 seront entr√©es, le programme les convertira dans ce format en utilisant Vision. La sortie sera un dictionnaire dans lequel les paires seront la ligne avec l'√©tiquette qui a √©t√© sp√©cifi√©e lors de la conversion et la confiance (probabilit√©) avec laquelle le neuronal la pr√©dit. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les principaux fichiers d'application.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le fichier principal est consid√©r√© - Image Classification View Controller.swift </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ImageView - une fen√™tre pour afficher l'image actuelle sur l'√©cran du t√©l√©phone, envoy√©e √† l'entr√©e du mod√®le.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CameraButton - un bouton qui, lorsqu'il est cliqu√©, fera appara√Ætre un menu contextuel offrant √† l'utilisateur d'effectuer les actions suivantes: Prendre une photo, Choisir une photo. La premi√®re action ouvrira l'appareil photo du smartphone, dans lequel le mode photo sera disponible. (Fig. 13) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous choisissez une autre action, Choisir une photo, une galerie interne s'ouvre. En appuyant sur le bouton Utiliser la photo, l'utilisateur retournera √† l'√©cran principal, o√π le r√©seau neuronal analysera les images et donnera sa pr√©diction, comme indiqu√© sur la Fig. 14.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s le mot Classification, nous voyons la conclusion des deux r√©sultats les plus probables pr√©dits par le mod√®le. Le nombre entre parenth√®ses est la confiance du r√©seau neuronal que sa pr√©diction est correcte. La figure 14 montre que l'algorithme avec une confiance de 0,99 indique que le nombre 0 est affich√©, ce qui co√Øncide avec la r√©alit√©. Aucun algorithme d'apprentissage automatique ne peut donner une pr√©cision de 100% sur des donn√©es r√©elles, et le r√©seau neuronal construit ne fait pas exception, et de fausses pr√©dictions sont possibles, comme on peut le voir sur la Fig. 15. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/78/qp/5h/78qp5hj0ajrbotphwhueoaybit0.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 13. - Travaillez avec l'appareil photo. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/px/l6/gf/pxl6gfi5rspqsfe53bsnk2dpyzi.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.14. - Pr√©diction du r√©seau neuronal. </font></font></i><br>
<br>
<img src="https://habrastorage.org/webt/oy/pv/s4/oypvs4v3zrcxig6481s3zqnpdrq.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig.15. - Fausse pr√©diction.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, nous avons con√ßu l'architecture d'un r√©seau neuronal convolutif pour reconna√Ætre les chiffres de la langue des signes. </font><font style="vertical-align: inherit;">Une formation au r√©seau de neurones a √©t√© effectu√©e et, en raison de l'expansion des donn√©es d'entra√Ænement et de la s√©lection d'hyperparam√®tres, une pr√©cision de 81% a √©t√© obtenue sur un ensemble de donn√©es de test. </font><font style="vertical-align: inherit;">L'algorithme a √©t√© converti avec succ√®s pour √™tre port√© sur un smartphone. </font><font style="vertical-align: inherit;">Une application mobile a √©t√© d√©velopp√©e dans laquelle un r√©seau de neurones a √©t√© int√©gr√©. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lien de code</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr502040/index.html">√Ä propos des verbes Phrasal-5 (haut / bas)</a></li>
<li><a href="../fr502046/index.html">Cinq ans de rouille</a></li>
<li><a href="../fr502048/index.html">Comportement complexe sans r√©seaux neuronaux et sans entra√Ænement. La base philosophique</a></li>
<li><a href="../fr502050/index.html">Quelques notes sur la culture</a></li>
<li><a href="../fr502052/index.html">Meilleures pratiques Kubernetes. Cr√©er de petits conteneurs</a></li>
<li><a href="../fr502066/index.html">Commandes de console simples que tout le monde devrait conna√Ætre</a></li>
<li><a href="../fr502068/index.html">110 volts sur votre ordinateur</a></li>
<li><a href="../fr502070/index.html">L'histoire de Pentax (article plus vid√©o)</a></li>
<li><a href="../fr502072/index.html">Amarrage de l'ISS √† l'aide de JavaScript et d'une boussole</a></li>
<li><a href="../fr502076/index.html">Trolley Robot 2.0. Partie 1. Navigation autonome d'un robot domestique bas√© sur ROS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>