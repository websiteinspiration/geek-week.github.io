<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî® üèùÔ∏è üëÇüèª Tengo que ir r√°pido. Optimizar las solicitudes de contenido de correo electr√≥nico IMAP üö∂üèº üö∂üèæ üè£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Hola a todos! En un art√≠culo anterior, habl√© sobre c√≥mo puede sincronizar r√°pidamente el contenido de un cuadro en la memoria cach√© local. Aqu√≠ quier...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Tengo que ir r√°pido. Optimizar las solicitudes de contenido de correo electr√≥nico IMAP</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495956/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Hola a todos! </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En un art√≠culo anterior,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> habl√© sobre c√≥mo puede sincronizar r√°pidamente el contenido de un cuadro en la memoria cach√© local. </font><font style="vertical-align: inherit;">Aqu√≠ quiero hablar sobre las caracter√≠sticas de solicitar el contenido de las cartas y la mejor forma de solicitar contenido, sin tener miedo al alto consumo de tr√°fico.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/kk/4w/8a/kk4w8ac2scl3dawogln5zyvg7fg.jpeg" alt="imagen"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recordemos r√°pidamente lo que aprendimos en el √∫ltimo art√≠culo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IMAP es un protocolo con estado</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para ver el contenido de la bandeja de entrada, primero debe seleccionarlo con el comando SELECCIONAR</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para sincronizar r√°pidamente el cuadro en el que estamos, puede usar el comando NOOP</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para no ordenar los mensajes del almacenamiento local para actualizar el buz√≥n que ya nos queda, puede usar CONDSTORE y QRESYNC, siempre que su servidor admita los datos de extensi√≥n de protocolo</font></font></li>
</ul><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°Suficiente!</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©jame recordarte el comando para solicitar el cuerpo de la carta:</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH number (BODY[])</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto crear√° una solicitud para obtener todo el cuerpo de la carta y todos los archivos adjuntos. </font><font style="vertical-align: inherit;">Solo vea cu√°nto tarda en llegar un mensaje en 42 p√°rrafos de Lorem Ipsum y con una imagen de 2 megabytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, pregunte el tama√±o del mensaje en el servidor. </font><font style="vertical-align: inherit;">Esto se hace mediante el comando:</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH 18871 (RFC822.SIZE)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RFC822.SIZE devuelve el tama√±o del mensaje en bytes:</font></font><br>
<br>
<pre><code class="bash hljs">* 18871 FETCH (RFC822.SIZE 3937793)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es decir, como resultado, nuestro mensaje ocupa casi 4 megabytes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, sin embargo, utilizaremos la solicitud del cuerpo completo de la carta y echaremos un vistazo a la hora:</font></font><br>
<br>
<pre><code class="bash hljs">1 OK Fetch completed (0.007 + 3.265 secs).</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3,3 segundos! </font><font style="vertical-align: inherit;">Y este es solo un mensaje con el archivo adjunto, e imag√≠nense que tal ser√° el cuadro completo. </font><font style="vertical-align: inherit;">Luego, llevar√° m√°s de un minuto descargar al menos las veintiuna. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debe admitir que el negocio de un cliente que en 2020 no puede sincronizar el correo m√°s r√°pido que en un minuto es malo. </font><font style="vertical-align: inherit;">¬øPero qu√© hacer?</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dame un bocado una vez</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">susurra RFC3501</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la cl√°usula </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.5.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que describe los posibles par√°metros para el comando FETCH, notar√° una solicitud interesante:</font></font><br>
<br>
<pre><code class="bash hljs">BODY[&lt;section&gt;]&lt;&lt;partial&gt;&gt;
</code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secci√≥n: qu√© parte de la carta obtener</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parcial - el tama√±o de esta parte</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo se construye parcial? </font><font style="vertical-align: inherit;">Y es muy f√°cil. </font><font style="vertical-align: inherit;">Primero, el byte desde el que necesita comenzar a leer se escribe a trav√©s del punto, y luego cu√°ntos bytes en general se deben leer:</font></font><br>
<br>
<pre><code class="bash hljs">BODY[&lt;section&gt;]&lt;&lt;0.1024&gt;&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ solicitamos la parte de la letra desde cero byte hasta 1024. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien, ¬øqu√© es la secci√≥n? </font><font style="vertical-align: inherit;">Primero, hablar√© sobre un par√°metro tan √∫til en una consulta FETCH como BODYSTRUCTURE:</font></font><br>
<br>
<pre><code class="bash hljs">1 FETCH 18871 (BODYSTRUCTURE)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este par√°metro, como probablemente entendi√≥ de la firma, devuelve la estructura de la letra en la forma descrita en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIME-IMB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="bash hljs">* 18871 FETCH (BODYSTRUCTURE (((<span class="hljs-string">"text"</span> <span class="hljs-string">"plain"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 25604 337 NIL NIL NIL NIL)(<span class="hljs-string">"text"</span> <span class="hljs-string">"html"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 29593 390 NIL NIL NIL NIL) <span class="hljs-string">"alternative"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_763_774309787.1586268692"</span>) NIL NIL NIL)(<span class="hljs-string">"image"</span> <span class="hljs-string">"jpeg"</span> (<span class="hljs-string">"name"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>) NIL NIL <span class="hljs-string">"base64"</span> 3880726 NIL (<span class="hljs-string">"attachment"</span> (<span class="hljs-string">"filename"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>)) NIL NIL) <span class="hljs-string">"mixed"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_210_297656922.1586268692"</span>) NIL NIL NIL))
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo un vistazo a esta estructura, ¬øy tu cabeza est√° girando? </font><font style="vertical-align: inherit;">No tengas miedo, ahora lo resolveremos. </font><font style="vertical-align: inherit;">Compare los soportes de apertura y cierre.</font></font><br>
<br>
<pre><code class="bash hljs">(<font></font>
BODYSTRUCTURE&nbsp;<font></font>
(<font></font>
[1] (<font></font>
[1.1] (<span class="hljs-string">"text"</span> <span class="hljs-string">"plain"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 25604 337 NIL NIL NIL NIL)<font></font>
[1.2] (<span class="hljs-string">"text"</span> <span class="hljs-string">"html"</span> (<span class="hljs-string">"charset"</span> <span class="hljs-string">"utf-8"</span>) NIL NIL <span class="hljs-string">"quoted-printable"</span> 29593 390 NIL NIL NIL NIL) <span class="hljs-string">"alternative"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_763_774309787.1586268692"</span>) NIL NIL NIL<font></font>
)<font></font>
[2] (<span class="hljs-string">"image"</span> <span class="hljs-string">"jpeg"</span> (<span class="hljs-string">"name"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>) NIL NIL <span class="hljs-string">"base64"</span> 3880726 NIL (<span class="hljs-string">"attachment"</span> (<span class="hljs-string">"filename"</span> <span class="hljs-string">"IMG_20200217_000236.jpg"</span>)) NIL NIL) <span class="hljs-string">"mixed"</span> (<span class="hljs-string">"boundary"</span> <span class="hljs-string">"--=_Part_210_297656922.1586268692"</span>) NIL NIL NIL<font></font>
)<font></font>
)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede notar que pongo n√∫meros cerca de algunos corchetes. </font><font style="vertical-align: inherit;">Esta es la seccion. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øC√≥mo calcularlos? </font><font style="vertical-align: inherit;">El primer par√©ntesis debe omitirse, ya que simplemente contiene la respuesta a la solicitud, luego cada par√©ntesis de apertura debe numerarse de acuerdo con la regla, ya que los t√≠tulos de los documentos est√°n numerados:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Numeramos cada soporte de apertura teniendo en cuenta la secci√≥n anterior</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la secci√≥n est√° anidada, la actual a trav√©s del punto se agrega al n√∫mero anterior</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la secci√≥n no est√° anidada, aumente su n√∫mero en uno</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, en este caso, en la primera parte que termina con ‚Äúalternativa‚Äù (es decir, esta es la parte de la carta multiparte / alternativa, donde somos libres de elegir qu√© partes mostrar al usuario), hay dos secciones que est√°n numeradas a trav√©s de un punto. </font><font style="vertical-align: inherit;">Conoc√≠ un servidor donde puede haber anidamiento de tres niveles (es decir, [1.1.1], [1.1.2], etc.). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analicemos la parte [1.1] mirando la estructura de todo esto en el documento </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIME-IMB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A juzgar por ello, el encabezado Content-Type es el primero. </font><font style="vertical-align: inherit;">Incluye:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo MIME, aqu√≠ est√° text / plain</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codificaci√≥n (charset = utf8)</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los siguientes son dos par√°metros que se escriben como NIL. </font><font style="vertical-align: inherit;">Francamente, no entend√≠ lo que era, pero hasta ahora no lo he necesitado, as√≠ que lo extra√±ar√©. </font><font style="vertical-align: inherit;">Pido disculpas por tal frivolidad. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego est√° el encabezado Content-Transfer-Encoding, se incluye en √©l, que describe el mecanismo de codificaci√≥n, aqu√≠ se puede imprimir.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los siguientes dos n√∫meros describen el tama√±o de la parte en bytes y el n√∫mero de l√≠neas, si es posible. </font><font style="vertical-align: inherit;">Con su ayuda, podemos calcular cu√°ntos bytes tomar para mostrar un cierto n√∫mero de l√≠neas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las siguientes l√≠neas que no est√°n en esta parte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content-Id, que se usa en la l√≠nea de la carta</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del contenido, una l√≠nea que describe qu√© es esta parte</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para los otros dos par√°metros, no pude encontrar una respuesta definitiva de qu√© se trata, pero uno de estos par√°metros puede contener partes MD5, que a veces pueden ser √∫tiles. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para la parte [2], todo es igual, excepto que es una imagen, un archivo adjunto con un nombre y una codificaci√≥n base64. Si a√∫n no est√° completamente claro lo que est√° sucediendo aqu√≠, entonces </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en este sitio se presenta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perfectamente c√≥mo calcular la secci√≥n. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que da Y el hecho de que en la etapa de mostrar la carta ya podemos solicitar solo la parte superior del contenido y no cargar los archivos adjuntos hasta que el propio usuario ingrese el mensaje y haga clic en el bot√≥n "descargar". Toda la informaci√≥n para mostrar archivos adjuntos nos llega en BODYSCTRUCTURE para que el nombre, el formato y el tama√±o se puedan mostrar sin cargar el archivo adjunto.&nbsp;</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasemos a practicar. </font><font style="vertical-align: inherit;">Solicitaremos un kilobyte de contenido del mensaje sin archivos adjuntos, solo para saber lo que nos enviaron.</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (body[1.1]&lt;0.1024&gt;)<font></font>
* 18871 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consecte=<font></font>
tur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. Praesent et enim te=<font></font>
llus. Nunc vestibulum diam tortor, id posuere turpis tempor luctus. Vivam=<font></font>
us molestie non nunc nec placerat. Cras finibus ut erat et tristique. Cur=<font></font>
abitur vitae commodo risus. Etiam sed scelerisque erat. Quisque cursus bl=<font></font>
andit finibus. Nullam ac lectus accumsan, molestie quam non, mollis urna.=<font></font>
&nbsp;Nulla at arcu <span class="hljs-keyword">in</span> libero condimentum mollis ut non velit. Vestibulum sed =<font></font>
risus et magna congue iaculis. Vestibulum nec interdum elit, ut commodo m=<font></font>
auris. Nulla ipsum leo, vestibulum nec ligula non, elementum ullamcorper =<font></font>
risus. Nunc et malesuada sem, id venenatis massa. Integer dolor ante, max=<font></font>
imus <span class="hljs-keyword">in</span> eleifend nec, ultricies ut risus. Mauris posuere eget tortor at p=<font></font>
orttitor.=0AIn porta elementum ornare. Suspendisse aliquam, tortor sed al=<font></font>
iquam bibendum, nulla ante rhoncus elit, placerat accumsan augue nibh non=<font></font>
&nbsp;est. Duis finibus vel tortor finibu)<font></font>
1 OK Fetch completed (0.073 + 0.000 + 0.072 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Unos 100 milisegundos y ya vemos parte del contenido de la carta! </font><font style="vertical-align: inherit;">Este es solo un excelente resultado, dado que anteriormente nos tom√≥ casi 4 segundos descargar el contenido de una carta. </font><font style="vertical-align: inherit;">Luego, simplemente puede cargar todo el contenido de la letra en la secuencia de fondo, desde el exterior parecer√° que las letras se cargan al instante. </font><font style="vertical-align: inherit;">Todo lo que se requer√≠a era mirar la estructura de la carta y descargar solo lo que se requiere para una visualizaci√≥n r√°pida.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solo un momento. </font><font style="vertical-align: inherit;">Esta solicitud har√° que el mensaje en el servidor aparezca como le√≠do. </font><font style="vertical-align: inherit;">Pero puede solucionar esto agregando solo PEEK a la solicitud del cuerpo</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (BODY.PEEK[1.1]&lt;0.1024&gt;)<font></font>
* 18871 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consecte=<font></font>
tur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. Praesent et enim te=<font></font>
llus. Nunc vestibulum diam tortor, id posuere turpis tempor luctus. Vivam=<font></font>
us molestie non nunc nec placerat. Cras finibus ut erat et tristique. Cur=<font></font>
abitur vitae commodo risus. Etiam sed scelerisque erat. Quisque cursus bl=<font></font>
andit finibus. Nullam ac lectus accumsan, molestie quam non, mollis urna.=<font></font>
&nbsp;Nulla at arcu <span class="hljs-keyword">in</span> libero condimentum mollis ut non velit. Vestibulum sed =<font></font>
risus et magna congue iaculis. Vestibulum nec interdum elit, ut commodo m=<font></font>
auris. Nulla ipsum leo, vestibulum nec ligula non, elementum ullamcorper =<font></font>
risus. Nunc et malesuada sem, id venenatis massa. Integer dolor ante, max=<font></font>
imus <span class="hljs-keyword">in</span> eleifend nec, ultricies ut risus. Mauris posuere eget tortor at p=<font></font>
orttitor.=0AIn porta elementum ornare. Suspendisse aliquam, tortor sed al=<font></font>
iquam bibendum, nulla ante rhoncus elit, placerat accumsan augue nibh non=<font></font>
&nbsp;est. Duis finibus vel tortor finibu)<font></font>
1 OK Fetch completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Y voil√°! </font><font style="vertical-align: inherit;">La carta permanece sin leer y parte del contenido que recibimos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo se vuelve a√∫n m√°s f√°cil si la funci√≥n de solicitud </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">PREVIEW</font></a><font style="vertical-align: inherit;"> se implementa en su servidor.&nbsp; </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><br>
<br>
<pre><code class="bash hljs">1 fetch 18871 (PREVIEW)<font></font>
* 18871 FETCH (PREVIEW (FUZZY <span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consectetur enim in nisi venenatis, id varius tellus viverra. Praesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis t"</span>))<font></font>
1 OK Fetch completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ no dedicamos tiempo a consultar la estructura y obtenemos la vista previa del mensaje al instante. </font><font style="vertical-align: inherit;">Pero no olvide que la estructura de consulta es √∫til para definir archivos adjuntos para que no se carguen en inactivo.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espere</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Casi cualquier cliente de correo implementa el bot√≥n "actualizar" si el usuario desea recibir nuevas cartas en este momento. </font><font style="vertical-align: inherit;">Pero de alguna manera esto no es bueno para nuestro tiempo, donde hay notificaciones tanto en dispositivos como en navegadores. </font><font style="vertical-align: inherit;">¬øQu√© dice IMAP sobre esto? </font><font style="vertical-align: inherit;">Y √©l dice </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inactivo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esta operaci√≥n mantiene la conexi√≥n a la carpeta y le notifica los cambios en la carpeta. </font><font style="vertical-align: inherit;">Tenga en cuenta, no el buz√≥n, sino las carpetas. </font><font style="vertical-align: inherit;">Para hacer esto, necesita que el servidor implemente la funci√≥n IDLE.&nbsp;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, seleccione la carpeta para la cual el servidor enviar√° alertas, y luego habilite IDLE</font></font><br>
<br>
<pre><code class="bash hljs">1 SELECT Inbox<font></font>
* FLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span>)<font></font>
* OK [PERMANENTFLAGS (\Answered \Flagged \Deleted \Seen \Draft <span class="hljs-variable">$Forwarded</span> <span class="hljs-variable">$MDNSent</span> \*)] Flags permitted.<font></font>
* 18872 EXISTS<font></font>
* 0 RECENT<font></font>
* OK [UNSEEN 18685] First unseen.<font></font>
* OK [UIDVALIDITY 1532079879] UIDs valid<font></font>
* OK [UIDNEXT 20155] Predicted next UID<font></font>
* OK [HIGHESTMODSEQ 26338] Highest<font></font>
1 OK [READ-WRITE] Select completed (0.002 + 0.000 + 0.001 secs).<font></font>
1 IDLE<font></font>
+ idling</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La respuesta "+ inactivo" notifica sobre la inclusi√≥n del inactivo en la carpeta. </font><font style="vertical-align: inherit;">¬øQu√© sucede si llega una nueva carta?</font></font><br>
<br>
<pre><code class="bash hljs">* 18873 EXISTS<font></font>
* 1 RECENT</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Me envi√© la misma carta e Idle me inform√≥ que deb√≠a solicitar la carta 18873, que hab√≠a 18873 cartas en la carpeta y que acababa de llegar una carta. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, solicitar√© esta carta en otra conexi√≥n, estamos interesados ‚Äã‚Äãen la carta con la respuesta EXISTE.</font></font><br>
<br>
<pre><code class="bash hljs">1 fetch 18873 (BODY.PEEK[1.1]&lt;0.1024&gt;)<font></font>
* 18873 FETCH (BODY[1.1]&lt;0&gt; {1024}<font></font>
---- Original Message ---- Tue, Apr 7, 2020, 17:11=0ASubject=<font></font>
: Lorem Ipsum=0A&nbsp; Lorem ipsum dolor sit amet, consectetur adipiscing elit=<font></font>
. Vivamus consectetur enim <span class="hljs-keyword">in</span> nisi venenatis, id varius tellus viverra. P=<font></font>
raesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis te=<font></font>
mpor luctus. Vivamus molestie non nunc nec placerat. Cras finibus ut erat=<font></font>
‚Ä¶</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es muy importante entenderlo. </font><font style="vertical-align: inherit;">IDLE requiere una conexi√≥n separada, por lo que no puede recibir cambios ni solicitar mensajes en la misma sesi√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© m√°s puede hacer IDLE? </font><font style="vertical-align: inherit;">Puede notificar sobre letras borradas y letras cuyas banderas han cambiado. </font><font style="vertical-align: inherit;">Echemos un vistazo a la letra por el simple hecho de poner la bandera "/ visto" y eliminar la letra.</font></font><br>
<br>
<pre><code class="bash hljs">* 18873 FETCH (FLAGS (\Seen \Recent))<font></font>
* OK Still here<font></font>
* OK Still here<font></font>
* 18873 EXPUNGE<font></font>
* 18871 EXPUNGE<font></font>
* 0 RECENT</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Elimin√© la conversaci√≥n (18873, 18871) y mir√© otra carta (respuesta FETCH). </font><font style="vertical-align: inherit;">¬øPor qu√© esta carta se convirti√≥ en 18871? </font><font style="vertical-align: inherit;">Porque IMAP cuenta el n√∫mero de letra si algo ha cambiado. </font><font style="vertical-align: inherit;">Desde que se convirti√≥ en el principal, su n√∫mero tambi√©n cambi√≥.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con IDLE, podemos sincronizar r√°pidamente el estado de la caja, pero es desagradable que requiera una conexi√≥n por separado. </font><font style="vertical-align: inherit;">¬øPodr√≠a ser mejor? </font><font style="vertical-align: inherit;">Por eso estoy aqu√≠.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grita como te va</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© pasa si te digo que hay una funci√≥n que te permite recibir notificaciones del servidor en la misma conexi√≥n, e incluso configuradas especialmente para buzones, y m√°s de una? </font><font style="vertical-align: inherit;">Suena como un cuento de hadas, pero no te vuelvas loco, esta es una capacidad real </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NOTIFICAR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">√âl sabe mucho, por ejemplo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configurar carpetas espec√≠ficas de las cuales esperamos notificaciones</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escuchar los cambios de estado de la carpeta (leer letras, letras nuevas)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Establecer el formato de notificaci√≥n, es decir, lo que queremos ver al cambiar la carpeta</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escucha los cambios de nombre de carpeta</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escuchar cambios de metadatos de carpeta</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos un ejemplo de c√≥mo podemos escuchar los cambios de estado de la carpeta</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (inboxes (MessageNew FlagChange MessageExpunge))<font></font>
1 OK NOTIFY completed (0.001 + 0.000 secs).</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora el servidor nos enviar√° notificaciones con estados de carpeta, por ejemplo, agregar√© un par de mensajes a diferentes carpetas</font></font><br>
<br>
<pre><code class="bash hljs">* STATUS INBOX/Ozon (MESSAGES 312 UIDNEXT 321 UNSEEN 48)<font></font>
* STATUS <span class="hljs-string">"INBOX/Company News"</span> (MESSAGES 178 UIDNEXT 179 UNSEEN 1)<font></font>
* STATUS <span class="hljs-string">"INBOX/Company News"</span> (MESSAGES 177 UIDNEXT 179 UNSEEN 0)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Analizar√© el comando: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero viene el comando NOTIFY SET. </font><font style="vertical-align: inherit;">Luego, entre par√©ntesis, seleccionamos qu√© carpetas escucharemos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bandejas de entrada: para todas las carpetas que puede seleccionar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personal: carpetas que est√°n en el espacio de nombres del usuario</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suscrito: carpetas a las que est√° suscrito el usuario</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sub√°rbol: sub√°rbol de la carpeta que se especificar√°</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buzones de correo: aqu√≠ puede enumerar las carpetas para escuchar.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seleccionado: alerta solo para las carpetas seleccionadas</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y los par√°metros que son responsables del filtro de alerta:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mensaje nuevo: si llega un nuevo mensaje</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlagChange - si la bandera ha cambiado</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MessageExpunge: si el mensaje se elimin√≥ o movi√≥</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero con dicho comando, no podemos recibir los par√°metros de un mensaje nuevo, modificado o eliminado. </font><font style="vertical-align: inherit;">Para hacer esto, seleccione el par√°metro Seleccionado y especifique exactamente qu√© devolver. </font><font style="vertical-align: inherit;">Podemos agregar otra alerta sin eliminar la anterior.</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> status (selected (MessageNew (uid preview) MessageExpunge))
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ dentro de MessageNew especificamos los par√°metros que debe devolver la notificaci√≥n. </font><font style="vertical-align: inherit;">Elegir√© Inbox y nuevamente me lanzar√© a m√≠ mismo lorem ipsum.</font></font><br>
<br>
<pre><code class="bash hljs">* 18868 FETCH (UID 20157 PREVIEW (FUZZY <span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus consectetur enim in nisi venenatis, id varius tellus viverra. Praesent et enim tellus. Nunc vestibulum diam tortor, id posuere turpis t"</span>))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øTe gusta eso? </font><font style="vertical-align: inherit;">Para el inactivo, necesitamos mantener dos conexiones, una de las cuales tambi√©n solicita mensajes que el inactivo nos devolvi√≥. </font><font style="vertical-align: inherit;">Inmediatamente nos traen todo en bandeja de plata.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y as√≠ podemos escuchar los cambios en el nombre de la carpeta</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (inboxes (MailboxName))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cambie el nombre de alguna carpeta y vea el resultado.</font></font><br>
<br>
<pre><code class="bash hljs">* LIST () <span class="hljs-string">"/"</span> 1111 (<span class="hljs-string">"OLDNAME"</span> (aaaa))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora sabemos que hab√≠a una carpeta "aaaa" y se convirti√≥ en "1111". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora puede escuchar el cambio de banderas y la eliminaci√≥n de mensajes. </font><font style="vertical-align: inherit;">Para hacer esto, use el par√°metro FlagChange</font></font><br>
<br>
<pre><code class="bash hljs">1 notify <span class="hljs-built_in">set</span> (selected (MessageNew (uid) FlagChange MessageExpunge))</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y cuando cambias las banderas de mensajes y las borras, obtenemos</font></font><br>
<br>
<pre><code class="bash hljs">* 18865 EXPUNGE<font></font>
* 18864 FETCH (FLAGS ())<font></font>
* 18864 FETCH (FLAGS (\Answered))</code></pre><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que sigue</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas estas caracter√≠sticas ayudan al cliente de correo a trabajar de la manera m√°s r√°pida y conveniente posible para el usuario. </font><font style="vertical-align: inherit;">IDLE y NOTIFY notifican al usuario los cambios en las carpetas, solicitando que parte de la carta acelere su carga.&nbsp;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el art√≠culo final, me gustar√≠a hablar sobre el mecanismo de b√∫squeda en IMAP y c√≥mo se puede acelerar y reducir la carga en la red. </font><font style="vertical-align: inherit;">Gracias por leer hasta el final.&nbsp;</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es495942/index.html">Ahorre tiempo, nervios y horas hombre</a></li>
<li><a href="../es495944/index.html">TOP50 actualizado (calificaci√≥n de supercomputadoras CIS): din√°mica y tendencias</a></li>
<li><a href="../es495946/index.html">Norbert Wiener: el padre distra√≠do de la cibern√©tica</a></li>
<li><a href="../es495948/index.html">√ìxido incrustado. Desarrollo para procesadores Cortex-M3 utilizando la placa de depuraci√≥n STM32F103C8T6 (Black Pill)</a></li>
<li><a href="../es495954/index.html">¬øC√≥mo ha estado funcionando Cisco en modo de acceso remoto y un per√≠metro ausente durante 20 a√±os?</a></li>
<li><a href="../es495960/index.html">Solo Wi-Fi AH-ny. O c√≥mo construimos una red Wi-Fi 6 (AX) en una instituci√≥n educativa</a></li>
<li><a href="../es495962/index.html">Udalenka: c√≥mo en X5 planearon cambiar a un formato de trabajo remoto</a></li>
<li><a href="../es495966/index.html">C√≥digo absurdo o "c√≥mo no escribir"</a></li>
<li><a href="../es495970/index.html">Herramientas para el trabajo en equipo remoto: desde el seguimiento del tiempo hasta las finanzas</a></li>
<li><a href="../es495974/index.html">Observaciones fotogr√°ficas de meteoros, Perseidas 2020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>