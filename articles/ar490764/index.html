<!doctype html>
<html class="no-js" lang="ar">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏾 👩🏽‍🎤 ◾️ Grafana ، InfluxDB ، علامتان ومبلغ واحد. أو كيف تحسب مجموع المجموعات الفرعية؟ 😠 😠 🚣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تحية للجميع! 
 
 تشارك في اختبار الأداء. وأحب حقًا إعداد المراقبة والاستمتاع بالمقاييس في Grafana . ومعيار تخزين المقاييس في أدوات التحميل هو InfluxDB...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Grafana ، InfluxDB ، علامتان ومبلغ واحد. أو كيف تحسب مجموع المجموعات الفرعية؟</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/490764/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/ol/b6/9a/olb69a8cdqhqtmjf-ic8x8qjevi.png"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تحية للجميع! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تشارك في اختبار الأداء. </font><font style="vertical-align: inherit;">وأحب حقًا إعداد المراقبة والاستمتاع </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالمقاييس</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">Grafana</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ومعيار تخزين المقاييس في أدوات التحميل هو </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">في </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB ،</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يمكنك حفظ المقاييس من الأدوات الشائعة مثل:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="  Apache.JMeter
Real-time results

In this document we will present the configuration setup to graph and historize the data in different backends:

 • InfluxDB setup for InfluxDBBackendListenerClient
 • InfluxDB setup for GraphiteBackendListenerClient
 • Grafana
 • Graphite"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اباتشي</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="  Gatling
Realtime monitoring

The sections below describe how to configure Gatling with InfluxDB and Graphite, and use Grafana as a graphing library"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جاتلينج</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="  LoadRunner Enterprise
Manage analysis servers

This section describes how to configure external analysis database servers to be used with LoadRunner Enterprise"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مؤسسة Loadrunner</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" title="  Yandex.Tank
Modules / Artifact uploaders / InfluxDB

      Yandex.Tank  InfluxDB"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ياندكس تانك</font></font></a></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من خلال العمل باستخدام أدوات اختبار الأداء ومقاييسها ، جمعت مجموعة مختارة من وصفات البرمجة لحزمة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">أقترح النظر في مشكلة مثيرة للاهتمام تنشأ عندما يكون هناك مقياس بعلامتين أو أكثر. </font><font style="vertical-align: inherit;">أعتقد أن هذا ليس من غير المألوف. </font><font style="vertical-align: inherit;">وفي الحالة العامة ، تبدو المهمة كما يلي: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">حساب المقياس الإجمالي لمجموعة مقسمة إلى مجموعات فرعية</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">هناك ثلاثة خيارات: </font></font></h3><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">فقط الكمية المجمعة حسب علامة النوع</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">طريق جرافانا. </font><font style="vertical-align: inherit;">نستخدم مجموعة من القيم</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مجموع الارتفاعات مع استعلام فرعي</font></font></a></li>
</ol> <br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كيف بدأ كل شيء</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
مراقبة JVM MBean باستخدام </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jolokia</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegraf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . وتصور مقاييس حول تجمعات الذاكرة - مقدار الذاكرة المخصصة لكل تجمع ذاكرة في HEAP وما بعده. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الرسوم البيانية على تجمعات ذاكرة JVM ونشاط جامع القمامة من الساعة 13:00 من اليوم السابق إلى 01:00 من ليلة اليوم الحالي (فترة 12 ساعة). هنا يمكنك أن ترى أن مجمعات الذاكرة مقسمة إلى مجموعتين: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . وأن حوالي 17:00 وكان هناك جمع القمامة، وبعد ذلك حجم تجمعات الذاكرة انخفض: </font><font style="vertical-align: inherit;">
لمقاييس جمع على تجمعات الذاكرة، وتحديد </font><font style="vertical-align: inherit;">الإعدادات التالية </font><font style="vertical-align: inherit;">في </font><b><font style="vertical-align: inherit;">تلغراف</font></b><font style="vertical-align: inherit;"> ملف التكوين </font><font style="vertical-align: inherit;">: </font><b><font style="vertical-align: inherit;">telegraf.conf</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/ow/ow/os/owowosl0e-neglcsbew-0u7bjjq.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><br>
<pre><code class="apache hljs">[<span class="hljs-attribute">outputs</span>.influxdb]
  <span class="hljs-attribute">urls</span> =<span class="hljs-meta"> ["http://influxdb_server:8086"]</span>
  <span class="hljs-attribute">database</span> = <span class="hljs-string">"telegraf"</span>
  <span class="hljs-attribute">username</span> = <span class="hljs-string">"login-InfluxDb"</span>
  <span class="hljs-attribute">password</span> = <span class="hljs-string">"*****"</span>
  <span class="hljs-attribute">retention_policy</span> = <span class="hljs-string">"month"</span>
  <span class="hljs-attribute">influx_uint_support</span> = false<font></font>
<font></font>
[<span class="hljs-attribute">agent</span>]
  <span class="hljs-attribute">collection_jitter</span> = <span class="hljs-string">"2s"</span>
  <span class="hljs-attribute">interval</span> = <span class="hljs-string">"2s"</span>
  <span class="hljs-attribute">precision</span> = <span class="hljs-string">"s"</span><font></font>
<font></font>
[[<span class="hljs-attribute">inputs</span>.jolokia<span class="hljs-number">2</span>_agent]]
  <span class="hljs-attribute">username</span> = <span class="hljs-string">"login-Jolokia"</span>
  <span class="hljs-attribute">password</span> = <span class="hljs-string">"*****"</span>
  <span class="hljs-attribute">urls</span> =<span class="hljs-meta"> ["http://127.0.0.1:7777/jvm-service"]</span><font></font>
<font></font>
[[<span class="hljs-attribute">inputs</span>.jolokia<span class="hljs-number">2</span>_agent.metric]]
  <span class="hljs-attribute">paths</span> =<span class="hljs-meta"> ["Usage","PeakUsage","CollectionUsage","Type"]</span>
  <span class="hljs-attribute">name</span> = <span class="hljs-string">"java_memory_pool"</span>
  <span class="hljs-attribute">mbean</span> = <span class="hljs-string">"java.lang:name=*,type=MemoryPool"</span>
  <span class="hljs-attribute">tag_keys</span> =<span class="hljs-meta"> ["name"]</span><font></font>
<font></font>
[[<span class="hljs-attribute">processors</span>.converter]]<font></font>
  [<span class="hljs-attribute">processors</span>.converter.fields]
    <span class="hljs-attribute">integer</span> =<span class="hljs-meta"> ["CollectionUsage.*", "PeakUsage.*", "Usage.*"]</span>
    <span class="hljs-attribute">tag</span> =<span class="hljs-meta"> ["Type"]</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وفي </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana ، أنشأت</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> طلبًا إلى </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لعرض القيمة القصوى للمقياس في الرسوم البيانية </font></font><b><code>Usage.Committed</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لفترة زمنية بخطوة </font></font><b><code>$granularity</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1 م) وتم تجميعها حسب </font></font><b><code>Type</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">علامتين (HEAP أو NON_HEAP) و </font></font><b><code>name</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Metaspace، G1 Old Gen، ...): </font><font style="vertical-align: inherit;">
نفس الطلب في شكل نصي ، مع الأخذ في الاعتبار جميع متغيرات </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> (انتبه إلى الهروب من القيم المتغيرة باستخدام </font><font style="vertical-align: inherit;">- وهذا مهم حتى يعمل الاستعلام بشكل صحيح):</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/qx/2z/-2/qx2z-2mblgxyi-u6g4mrbyvybf8.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><code>:regex</code></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^${jolokia:regex}$/ <span class="hljs-keyword">AND</span><font></font>
    $timeFilter<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-built_in">time</span>($granularity)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نفس الاستعلام في شكل نصي ، مع مراعاة القيم المحددة لمتغيرات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جرافانا</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^serverName$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^<span class="hljs-keyword">http</span>:\/\/<span class="hljs-number">127</span>\<span class="hljs-number">.0</span>\<span class="hljs-number">.0</span>\<span class="hljs-number">.1</span>:<span class="hljs-number">7777</span>\/jvm-service$/ <span class="hljs-keyword">AND</span>
    <span class="hljs-built_in">time</span> &gt;= <span class="hljs-number">1583834400000</span>ms <span class="hljs-keyword">and</span> <span class="hljs-built_in">time</span> &lt;= <span class="hljs-number">1583877600000</span>ms
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-built_in">time</span>(<span class="hljs-number">1</span>m)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
التجميع حسب الوقت </font></font><b><code>GROUP BY time($granularity)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أو </font></font><b><code>GROUP BY time(1m)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يستخدم لتقليل عدد النقاط على الرسم البياني. </font><font style="vertical-align: inherit;">لفترة زمنية تبلغ 12 ساعة وخطوة تجميع مدتها دقيقة واحدة ، نحصل على: 12 × 60 = 720 مرة أو 721 نقطة (النقطة الأخيرة بقيمة فارغة).</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تذكر أن </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">721</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> هو العدد المتوقع للنقاط استجابة لطلبات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بالإعدادات الحالية للفاصل الزمني (12 ساعة) وخطوة التجميع (دقيقة واحدة).</font></font></blockquote> <br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تجمع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ذاكرة </font><b><font style="vertical-align: inherit;">NON_HEAP: Metaspace</font></b><font style="vertical-align: inherit;"> (أزرق) في الصدارة في استهلاك الذاكرة في الساعة 20:00. </font><font style="vertical-align: inherit;">ووفقًا لـ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP: G1 Old Gen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (أصفر) ، كانت هناك زيادة محلية صغيرة في الساعة 17:03. </font><font style="vertical-align: inherit;">وفي </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تمام</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الساعة 20:00 ، في المجموع ، </font><b><font style="vertical-align: inherit;">غادرت</font></b><font style="vertical-align: inherit;"> جميع </font><font style="vertical-align: inherit;">تجمعات </font><b><font style="vertical-align: inherit;">NON_HEAP </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.5 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (113.2 + 45.9 + 13.4) ، </font><font style="vertical-align: inherit;">وتجمعات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (67 + 57 + 4).</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/ku/mo/wf/kumowfdo6gkw3wx_b8mugtsp8l4.png"></a><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تذكر قيم 20:00: </font><font style="vertical-align: inherit;">تجمعات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">172.5 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font><font style="vertical-align: inherit;">وتجمعات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128 MiB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">سنركز على هذه القيم في المستقبل.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في سياق </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">النوع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، حصلنا على قيمة المقياس بسهولة. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في سياق علامة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فقط </font><font style="vertical-align: inherit;">، من السهل أيضًا الحصول على قيمة المقياس ، نظرًا لأن جميع أسماء تجمعات الذاكرة فريدة ، ويكفي ترك تجميع النتائج </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالاسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فقط </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">يبقى السؤال: كيف يمكن الحصول على الحجم المخصص لجميع تجمعات HEAP وجميع تجمعات NON_HEAP في المجموع؟</font></font></blockquote><br>
<a name="1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. فقط الكمية المجمعة حسب علامة النوع</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.1. </font><font style="vertical-align: inherit;">تم تجميع المجموع حسب العلامة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الحل الأول الذي قد يتبادر إلى الذهن هو تجميع القيم حسب علامة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">النوع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> وحساب مجموع القيم في كل مجموعة. </font><font style="vertical-align: inherit;">سيبدو مثل هذا الاستعلام كما يلي: </font><font style="vertical-align: inherit;">
تمثيل نصي لطلب حساب المجموع تم تجميعه حسب علامة </font><b><font style="vertical-align: inherit;">النوع</font></b><font style="vertical-align: inherit;"> مع جميع متغيرات </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/xz/w_/4a/xzw_4aonrgekrw4onxv9fwcctlg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"Usage.committed"</span>)
<span class="hljs-keyword">FROM</span> <span class="hljs-string">"telegraf"</span>.<span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span>
<span class="hljs-keyword">WHERE</span>
    host =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span>
    jolokia_agent_url =~ /^${jolokia:regex}$/ <span class="hljs-keyword">AND</span><font></font>
    $timeFilter<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
    <span class="hljs-string">"Type"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا استعلام صالح ، لكنه سيعرض نقطتين فقط: سيتم حساب المجموع </font><font style="vertical-align: inherit;">بالتجميع </font><font style="vertical-align: inherit;">فقط بواسطة علامة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">النوع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بقيمتين (HEAP و NON_HEAP). </font><font style="vertical-align: inherit;">لن نرى حتى الجدول الزمني. </font><font style="vertical-align: inherit;">ستكون هناك نقطتان مستقلتان بقيمة إجمالية كبيرة (أكثر من 3 تيرابايت): </font><font style="vertical-align: inherit;">
هذا المبلغ غير مناسب ، هناك حاجة إلى تقسيم الفواصل الزمنية.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/sz/lx/bo/szlxboh0o4r3-jsq7jg9d49wnic.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.2. </font><font style="vertical-align: inherit;">المبلغ مجمَّع حسب العلامة في الدقيقة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في الاستعلام الأصلي ، قمنا بتجميع المقاييس حسب فترة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تفصيل $</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> مخصصة </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">لنقم بالتجميع الآن بفاصل زمني مخصص. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وأضاف أن هذا الاستعلام سيظهر </font></font><b><code>GROUP BY time($granularity)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
نحصل على قيم متضخمة ، بدلاً من 172.5 ميغابايت بواسطة </font><b><font style="vertical-align: inherit;">NON_HEAP</font></b><font style="vertical-align: inherit;"> نرى 4.88 غيغابايت: </font><font style="vertical-align: inherit;">
نظرًا لإرسال المقاييس إلى InfluxDB مرة واحدة كل ثانيتين (انظر </font><b><font style="vertical-align: inherit;">telegraf.conf</font></b><font style="vertical-align: inherit;"> أعلاه) ، فإن مجموع القراءات في دقيقة واحدة لن يعطي المبلغ في الوقت الحاضر ، ومجموع ثلاثين من هذه المبالغ. </font><font style="vertical-align: inherit;">لا يمكننا </font><font style="vertical-align: inherit;">
تقسيم النتيجة على ثابت </font><b><font style="vertical-align: inherit;">30</font></b><font style="vertical-align: inherit;"> أيضًا. </font><font style="vertical-align: inherit;">نظرًا لأن </font><b><font style="vertical-align: inherit;">دقة $</font></b><font style="vertical-align: inherit;"> هي معلمة ، يمكن تعيينها على دقيقة واحدة و 10 دقائق. </font><font style="vertical-align: inherit;">وستتغير قيمة المبلغ.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/yb/xp/tw/ybxptwbmibq2xlujuuwbkwb83nq.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/9l/lo/hn/9llohn9ncpoztbtcsrfqzfzoqya.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3. </font><font style="vertical-align: inherit;">تم تجميع العلامة في الثانية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
من أجل الحصول على قيمة المقياس بشكل صحيح لكثافة مجموعة المقاييس الحالية (ثانيتان) ، تحتاج إلى حساب المبلغ لفترة زمنية لا تتجاوز كثافة مجموعة المقاييس. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا نحاول عرض الإحصائيات مع تجميع في ثوان. أضف إلى </font></font><b><code>GROUP BY</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التجميع </font></font><b><code>time(1s)</code></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
مع مثل هذه الدقة الصغيرة ، نحصل على عدد كبير من النقاط لفاصلنا الزمني 12 ساعة (12 ساعة * 60 دقيقة * 60 ثانية = 43،200 فواصل ، 43،201 نقطة لكل سطر ، وآخرها فارغ): </font><font style="vertical-align: inherit;">
43،201 نقطة في كل سطر من الرسم البياني. هناك العديد من </font><b><font style="vertical-align: inherit;">النقاط</font></b><font style="vertical-align: inherit;"> التي </font><b><font style="vertical-align: inherit;">ستشكل InfluxDB</font></b><font style="vertical-align: inherit;"> استجابة لفترة طويلة ، </font><b><font style="vertical-align: inherit;">وستستغرق Grafana</font></b><font style="vertical-align: inherit;"> استجابة أطول ، ثم سيقوم المتصفح برسم هذا العدد الضخم من النقاط لفترة طويلة.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/vn/sl/q_/vnslq_lq48mzzh9hgmjwiuvcy2i.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/_2/mw/4k/_2mw4ki9rcnf140m2doyqsn-zxy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وليس في كل ثانية هناك نقاط: تم جمع المقاييس كل ثانيتين ، والتجميع في كل ثانية ، مما يعني أن كل نقطة ثانية ستكون فارغة. لرؤية خط متجانس ، قم بتكوين اتصال القيم غير الفارغة. خلاف ذلك ، لن نرى الرسوم البيانية: في </font><font style="vertical-align: inherit;">
السابق ، </font><font style="vertical-align: inherit;">كان </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> بحيث علق المتصفح أثناء رسم عدد كبير من النقاط. الآن نسخة </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> لديها القدرة على رسم عدة عشرات الآلاف من النقاط: المتصفح ببساطة يتخطى بعضها ، يرسم رسمًا بيانيًا باستخدام البيانات الضعيفة. لكن الرسم البياني تم صقله. يتم عرض المرتفعات كمتوسطات عالية.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/xx/ya/hf/xxyahfkl3xzk6ezsakvgsbi8lp4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ونتيجة لذلك ، يوجد رسم بياني ، يتم عرضه بدقة ، ويتم حساب المقاييس في الساعة 20:00 بشكل صحيح ، ويتم حساب المقاييس في وسيلة إيضاح الرسم البياني بشكل صحيح. </font><font style="vertical-align: inherit;">لكن الرسم البياني سلس: لا يمكن رؤية الرشقات عليه بدقة تبلغ ثانية واحدة. </font><font style="vertical-align: inherit;">على وجه الخصوص ، </font><font style="vertical-align: inherit;">اختفى </font><font style="vertical-align: inherit;">ارتفاع </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في الساعة 17:03 من المخطط ، مخطط </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> سلس للغاية: </font><font style="vertical-align: inherit;">
سيظهر ناقص في الأداء بشكل واضح على مدى فترة زمنية أطول. </font><font style="vertical-align: inherit;">إذا حاولت إنشاء رسم بياني في شهر (720 ساعة) وليس في 12 ساعة ، فسيتم تجميد كل شيء بمثل هذه الدقة الصغيرة (ثانية واحدة) ، سيكون هناك العديد من النقاط. </font><font style="vertical-align: inherit;">وهناك ناقص في حالة عدم وجود قمم ، مفارقة - </font><b><font style="vertical-align: inherit;">نظرًا للدقة العالية في الحصول على المقاييس ، نحصل على دقة منخفضة لعرضها</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/1g/vs/m8/1gvsm8owfg-ifjjcqwf-w1q2lbk.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a name="2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. طريق جرافانا. </font><font style="vertical-align: inherit;">نستخدم مجموعة من القيم</font></font></h2><br><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">لم</font></b><font style="vertical-align: inherit;"> يكن من الممكن </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إنشاء حل</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
بسيط ومنتج مع </font><b><font style="vertical-align: inherit;">InfluxDB </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ومصمم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> استعلام </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">سنحاول فقط استخدام أدوات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لتلخيص المقاييس </font><b><font style="vertical-align: inherit;">المعروضة</font></b><font style="vertical-align: inherit;"> في المخطط الأصلي. </font><font style="vertical-align: inherit;">ونعم هذا ممكن!</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1. </font><font style="vertical-align: inherit;">ما عليك سوى جعل تلميح أداة التحويم / القيمة المكدسة: تراكمية</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وسوف نترك طلب لاختيار المقاييس دون تغيير، وهو نفس في قسم "كيف بدأ كل شيء": </font><font style="vertical-align: inherit;">
سيتم تجميع القياسات عن طريق </font><b><font style="vertical-align: inherit;">نوع</font></b><font style="vertical-align: inherit;"> و </font><b><font style="vertical-align: inherit;">اسم</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">لكننا </font><b><font style="vertical-align: inherit;">سنعرض</font></b><font style="vertical-align: inherit;"> فقط علامة </font><b><font style="vertical-align: inherit;">Type</font></b><font style="vertical-align: inherit;"> في أسماء الرسوم البيانية </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
وفي إعدادات </font><b><font style="vertical-align: inherit;">التمثيل</font></b><font style="vertical-align: inherit;"> البصري ، سنقوم بتجميع المقاييس حسب مكدسات </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">
أولاً ، أضف فصل </font><b><font style="vertical-align: inherit;">علامتين</font></b><font style="vertical-align: inherit;"> إلى مجموعتين مختلفتين A و B ، بحيث لا تتقاطع قيمهما:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/s5/an/3e/s5an3errkt29lgc8byme6tnowz4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/ls/vg/to/lsvgtohynssezzeiy04px0qwq3c.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/no/py/5g/nopy5ggb9ittxbz2phdei1egphg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إضافة تجاوز سلسلة</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / HEAP / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المكدس</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : أ</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إضافة تجاوز السلسلة</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / NON_HEAP / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المكدس</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ب</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ثم قم بتكوين تصور المقاييس لعرض القيم الإجمالية في تلميح مع الرسوم البيانية:</font></font><br>
<br>
<ol>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التراص والقيمة الفارغة</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font><b><font style="vertical-align: inherit;">التراص</font></b><font style="vertical-align: inherit;"> : </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">قيد التشغيل</font></font></b><font style="vertical-align: inherit;"></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تلميح أداة التمرير</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">القيمة المكدسة</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : تراكمية</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تلميح</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وضع </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">التمرير</font></b><font style="vertical-align: inherit;"> : واحد</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نظرًا للميزات المختلفة لـ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana ،</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فأنت بحاجة إلى تنفيذ الإجراءات بهذا الترتيب. </font><font style="vertical-align: inherit;">إذا قمت بتغيير ترتيب الإجراءات أو تركت بعض الحقول بالإعدادات الافتراضية ، فلن يعمل شيء ما:</font></font><br>
<br>
<ul>
<li>    Stack <b>A</b>  <b>B</b>    <b>Stacking &amp; Null value</b> / <b>Stack</b>: On,    ;</li>
<li>  <b>Hover tooltip / Mode</b>    ,    <b>Single</b>,  <b>Hover tooltip</b>    .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
والآن ، نرى العديد من الخطوط ، لأنفسنا. </font><font style="vertical-align: inherit;">لكن! </font><font style="vertical-align: inherit;">إذا قمت </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بالتمرير</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> فوق أعلى </font><b><font style="vertical-align: inherit;">NON_HEAP</font></b><font style="vertical-align: inherit;"> ، فسوف يعرض تلميح الأدوات مجموع قيم جميع </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAPs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يعتبر المبلغ صحيحًا ، يعني </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> بالفعل </font><b><font style="vertical-align: inherit;">أنه</font></b><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">
وإذا قمت </font><b><font style="vertical-align: inherit;">بالتحويم</font></b><font style="vertical-align: inherit;"> فوق المخطط العلوي باسم </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> ، </font><b><font style="vertical-align: inherit;">فسنرى</font></b><font style="vertical-align: inherit;"> المبلغ بواسطة </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">يتم عرض الرسم البياني بشكل صحيح. </font><font style="vertical-align: inherit;">حتى ارتفاع </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> في الساعة 17:03 مرئي: </font><font style="vertical-align: inherit;">
رسميًا ، تم الانتهاء من المهمة. </font><font style="vertical-align: inherit;">
ولكن هناك سلبيات - يتم عرض الكثير من الرسوم البيانية الإضافية. </font><font style="vertical-align: inherit;">تحتاج إلى الحصول على المؤشر لأعلىها. </font><font style="vertical-align: inherit;">وفي وسيلة الإيضاح للرسم البياني ، لا يتم عرض القيم التراكمية ، ولكن يتم عرض القيم الفردية ، لذلك أصبحت وسيلة الإيضاح عديمة الفائدة.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/p9/tx/tw/p9txtwio9i4uozvliutk5_dg13o.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/g5/78/bo/g578boco1u0sncwf0jmh8ejsyow.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2. </font><font style="vertical-align: inherit;">قيمة مكدسة: تراكمية مع إخفاء خطوط وسيطة</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعنا نصلح الطرح الأول من الحل السابق: تأكد من عدم عرض الرسوم البيانية الإضافية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
لهذا:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أضف مقاييس جديدة باسم مختلف وقيمة 0 إلى النتائج.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أضف مقاييس جديدة إلى </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stack B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> إلى أعلى المكدس.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إخفاء من الشاشة - الأسطر الأصلية لـ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نضيف سلسلتين جديدتين بعد الطلب الرئيسي: الطلب </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لاستلام سلسلة بقيم 0 واسم </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[NON_HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> والطلب </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لاستلام سلسلة بقيم 0 واسم </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . للحصول على 0 ، نأخذ القيمة الأولى </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لحقل "Usage.committed"</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في كل مجموعة زمنية </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ونطرحها</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">أولاً ("Usage.committed") - أولاً ("Usage.committed")</font></b><font style="vertical-align: inherit;"> - نحصل على 0 مستقرة. يتم تغيير أسماء الرسوم البيانية دون فقدان المعنى نظرًا </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">للأقواس</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> المربعة: </font><b><font style="vertical-align: inherit;">[NON_HEAP]</font></b><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HEAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">يتم</font></b><font style="vertical-align: inherit;"> دمج </font><b><font style="vertical-align: inherit;">[HEAP]</font></b><font style="vertical-align: inherit;"> و </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> في </font><b><font style="vertical-align: inherit;">Stack A</font></b><font style="vertical-align: inherit;"> ، وكذلك إخفاء جميع </font><b><font style="vertical-align: inherit;">HEAP</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">[NON_HEAP]</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/no/kh/0f/nokh0fb2fp1t_ictdthli2etylg.png"></a><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">و </font><font style="vertical-align: inherit;">الجمع بين </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كومة B</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اخفاء NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">الحصول على</font></b><font style="vertical-align: inherit;"> 
المبلغ الصحيح من قبل </font><b><font style="vertical-align: inherit;">[NON_HEAP]</font></b><font style="vertical-align: inherit;"> في تلميح الأدوات عندما تحوم فوق الرسم البياني: </font><font style="vertical-align: inherit;">
الحصول على المبلغ الصحيح من </font><b><font style="vertical-align: inherit;">[هيب]</font></b><font style="vertical-align: inherit;"> في تلميح الأدوات عندما تحوم فوق الرسم البياني. </font><font style="vertical-align: inherit;">وحتى كل الرشقات مرئية: </font><font style="vertical-align: inherit;">
ويتم تشكيل الجدول بسرعة. </font><font style="vertical-align: inherit;">لكن الأسطورة تعرض دائمًا 0 ، أصبحت الأسطورة عديمة الفائدة. </font><font style="vertical-align: inherit;">
كل شيء يعمل! </font><font style="vertical-align: inherit;">تجاوز صحيح من خلال مداخن </font><b><font style="vertical-align: inherit;">جرافانا</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ولهذا السبب تمت إضافة المقالة إلى فئة </font><b><font style="vertical-align: inherit;">البرمجة غير الطبيعية</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/uf/zw/7s/ufzw7sw-oxjflnzkglbilrdgmw4.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/ga/mh/nz/gamhnzyw1thhnbi5mflkwrlvr_i.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/p_/tp/ev/p_tpevfzm7rwkc1534vyhe92ozg.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<a name="3"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. مجموع الارتفاعات في الاستعلام الفرعي</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نظرًا لأننا قد شرعنا بالفعل في مسار البرمجة غير الطبيعية مع مجموعة من </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font><b><font style="vertical-align: inherit;">فلنستمر</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">دعونا نجعل </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB يُرجع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> عددًا صغيرًا من النقاط ويجعل الأسطورة تظهر.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.1 مجموع الزيادات في المجموع التراكمي للحد الأقصى</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
دعونا </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نتعمق</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> في إمكانيات </font><b><font style="vertical-align: inherit;">InfluxDB</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">في السابق ، غالبًا ما كنت أساعد عن طريق أخذ مشتق المبلغ التراكمي ، لذلك سنحاول تطبيق هذا النهج الآن. </font><font style="vertical-align: inherit;">دعنا ننتقل إلى وضع التحرير اليدوي للطلبات: </font><font style="vertical-align: inherit;">
لنقم بتقديم مثل هذا الطلب:</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/om/-b/yt/om-bytkvhp5zisny6gw5io_g2ba.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"U"</span>) <span class="hljs-keyword">FROM</span> (
        <span class="hljs-keyword">SELECT</span> non_negative_difference(cumulative_sum(<span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>))) <span class="hljs-keyword">AS</span> <span class="hljs-string">"U"</span> 
        <span class="hljs-keyword">FROM</span> <span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span> 
        <span class="hljs-keyword">WHERE</span> <font></font>
            (<font></font>
                <span class="hljs-string">"host"</span> =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span> 
                <span class="hljs-string">"jolokia_agent_url"</span> =~ /^${jolokia:regex}$/<font></font>
            ) <span class="hljs-keyword">AND</span> <font></font>
            $timeFilter <font></font>
        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span><font></font>
)<font></font>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">"Type"</span>, <span class="hljs-built_in">time</span>($granularity)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هنا يتم أخذ القيمة القصوى للقياس في مجموعة من الوقت ومجموع هذه القيم من لحظة بدء المرجعية، التي تم تجميعها حسب </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نوع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> علامات </font><font style="vertical-align: inherit;">. ونتيجة لذلك ، في كل لحظة من الوقت ، سيكون هناك مجموع لجميع المؤشرات حسب النوع ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> أو </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NON_HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) مع الفصل حسب اسم التجمع ، ولكن لا </font><font style="vertical-align: inherit;">يتم جمع </font><font style="vertical-align: inherit;">30 قيمة ، كما كان الحال في الإصدار 1.2 ، ولكن واحدًا فقط هو الحد الأقصى. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وإذا أخذنا </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">non_negative_difference</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الزيادة من </font><font style="vertical-align: inherit;">مثل هذا المبلغ التراكمي للخطوة الأخيرة، فإننا سوف تحصل على قيمة مجموع كل حمامات البيانات التي تم تجميعها حسب </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">نوع</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> علامات </font><font style="vertical-align: inherit;">في الوقت الذي يبدأ الفاصل الزمني. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
الآن ، للحصول على المبلغ عن طريق العلامة فقط</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">اكتب</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، بدون تجميع حسب علامة </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، تحتاج إلى تقديم طلب من المستوى الأعلى مع معلمات تجميع مماثلة ، ولكن بدون تجميع حسب </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاسم</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نتيجة لمثل هذا الاستعلام المعقد ، نحصل على مجموع جميع الأنواع. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
جدول مثالي. </font><font style="vertical-align: inherit;">يتم حساب مجموع الحد الأقصى بشكل صحيح. </font><font style="vertical-align: inherit;">هناك وسيلة إيضاح بقيم صحيحة غير صفرية. </font><font style="vertical-align: inherit;">في تلميح الأدوات ، يمكنك عرض جميع المقاييس ، وليس فقط مفرد. </font><font style="vertical-align: inherit;">يتم عرض رشقات </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HEAP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> حتى </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">
شيء واحد ولكن - اتضح أن الطلب صعب: مجموع الزيادة في مجموع القيم القصوى التراكمية مع تغيير في مستوى التجميع.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/an/yv/1t/anyv1t7m69cwrl6cnwgl-dwd7xy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.2 مجموع الارتفاعات مع تغيير في مستوى التجميع</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هل يمكنك القيام بشيء أبسط من الإصدار 3.1؟ صندوق Pandora مفتوح بالفعل ، تحولنا إلى وضع تحرير الاستعلام اليدوي. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هناك شك في أن تلقي زيادة من المبلغ التراكمي يؤدي إلى تأثير صفر - واحد يطفئ الآخر. تخلص من </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاختلاف non_negative_sif (cumulative_sum (...))</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تبسيط الطلب. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
نترك ببساطة مجموع الحد الأقصى ، مع انخفاض في مستوى التجميع:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">sum</span>(<span class="hljs-string">"A"</span>)
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">max</span>(<span class="hljs-string">"Usage.committed"</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">"A"</span>
    <span class="hljs-keyword">FROM</span> <span class="hljs-string">"month"</span>.<span class="hljs-string">"java_memory_pool"</span> 
    <span class="hljs-keyword">WHERE</span><font></font>
            (<font></font>
                <span class="hljs-string">"host"</span> =~ /^${host:regex}$/ <span class="hljs-keyword">AND</span> 
                <span class="hljs-string">"jolokia_agent_url"</span> =~ /^${jolokia:regex}$/<font></font>
            ) <span class="hljs-keyword">AND</span> <font></font>
            $timeFilter<font></font>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>, <span class="hljs-string">"name"</span><font></font>
)<font></font>
<span class="hljs-keyword">WHERE</span> $timeFilter
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">time</span>($granularity), <span class="hljs-string">"Type"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
هذا استعلام بسيط وسريع يقوم بإرجاع 721 نقطة فقط لكل سلسلة في 12 ساعة ، عندما يتم تجميعها بالدقائق: 12 (ساعات) * 60 (دقائق) = 720 فواصل زمنية ، 721 نقطة (آخر فارغة). يرجى ملاحظة أن فلتر الوقت مكرر. إنه في الاستعلام الفرعي وفي طلب التجميع: </font><font style="vertical-align: inherit;">
بدون </font><b><font style="vertical-align: inherit;">$ timeFilter ،</font></b><font style="vertical-align: inherit;"> في طلب التجميع الخارجي ، لن يكون عدد النقاط المرتجعة 721 في 12 ساعة ، بل أكثر. نظرًا لأن الاستعلام الفرعي تم تجميعه للفاصل الزمني </font><b><font style="vertical-align: inherit;">من</font></b><font style="vertical-align: inherit;"> ... </font><b><font style="vertical-align: inherit;">إلى</font></b><font style="vertical-align: inherit;"> ، فإن تجميع طلب خارجي بدون عامل تصفية سيكون للفاصل الزمني </font><b><font style="vertical-align: inherit;">من</font></b><font style="vertical-align: inherit;"> ... </font><b><font style="vertical-align: inherit;">الآن</font></b><font style="vertical-align: inherit;"> . وإذا تم </font><b><font style="vertical-align: inherit;">تحديد</font></b><font style="vertical-align: inherit;"> فاصل زمني </font><font style="vertical-align: inherit;">في </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> لا يدوم X- ساعات (وليس هذا </font><b><font style="vertical-align: inherit;">إلى</font></b><font style="vertical-align: inherit;"> = </font><b><font style="vertical-align: inherit;">الآن</font></b></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/8s/ab/tg/8sabtg9rebcu-tonmirjck2jdmk.png"></a><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ، ولكن للفاصل الزمني من الماضي ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إلى</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الآن</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ، ستظهر نقاط فارغة ذات قيمة فارغة في نهاية التحديد. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
تبين أن الرسم البياني الناتج بسيط وسريع وصحيح. </font><font style="vertical-align: inherit;">مع وسيلة إيضاح تعرض مقاييس الملخص. </font><font style="vertical-align: inherit;">مع تلميح لخطوط متعددة في وقت واحد. </font><font style="vertical-align: inherit;">وأيضًا مع عرض جميع رشقات القيم: </font><font style="vertical-align: inherit;">
تم تحقيق النتيجة!</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/an/yv/1t/anyv1t7m69cwrl6cnwgl-dwd7xy.png"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">المراجع (بدلاً من المراجع)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
توزيعات الأدوات المستخدمة في المقالة:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">grafana</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (6.5.0)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تدفق</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.7.9)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تلغراف</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.13.3)</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jolokia-jvm-1.6.2-agent.jar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1.6.2)</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
وثائق حول إمكانيات الأدوات المستخدمة في المقالة:</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">جوهر</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">وصف</font></font></th>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">سياسة الاحتفاظ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ، </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">الاحتفاظ ببيانات InfluxDB</font></font></a></td>
<td>Retention policy <b>montn</b>   30  ,     JVM    .       <b>auto</b>,     .   «  »   <b>telegraf.conf</b>      <b>InfluxDB</b>  ,      <b>Grafana</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">InfluxDB v1.x Output Plugin</a></td>
<td>    <b>Telegraf</b>  <b>InfluxDB</b>.     <b>telegraf.conf</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">agent / interval</a></td>
<td>   ,     2 .   «  »   <b>telegraf.conf</b>.   «1.2.       »  «1.3.       »</td>
</tr>
<tr>
<td>Java 8 / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Interface MemoryPoolMXBean</a></td>
<td>  MemoryPool,  ,     bool,  long.     <b>telegraf.conf</b>    int</td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Jolokia2 Input Plugins</a></td>
<td>  <b>telegraf.conf</b>   MBean-,     <b>InfluxDB</b></td>
</tr>
<tr>
<td>Telegraf / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Converter Processor</a></td>
<td>  <b>telegraf.conf</b>,      <b>float</b>   <b>int</b>    <b>InfluxDB</b>.      <b>Type</b>   <b>Type</b>,        </td>
</tr>
<tr>
<td>Grafana / Variables / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Advanced Formatting Options / Regex</a></td>
<td> Grafana,    Multiselect    ,    ,     ,    <b><code>~ /^<u>${}</u>$/</code></b> — ,  <b><code>~ /^${<u>:regex</u>}$/</code></b></td>
</tr>
<tr>
<td>Grafana / Variables / Global Built-in Variables / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">The $timeFilter or $__timeFilter Variable</a></td>
<td> Grafana- <b>$timeFilter</b>,     </td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MAX()</a></td>
<td>  <b>MAX()</b>  <b>InfluxDB</b> 1.7,       </td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SUM()</a></td>
<td>    <b>SUM()</b>  <b>InfluxDB</b> 1.7</td>
</tr>
<tr>
<td>InfluxDB / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Subqueries</a></td>
<td>    <b>InfluxDB</b> 1.7,     3 </td>
</tr>
<tr>
<td>InfluxDB / Transformation / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CUMULATIVE_SUM()</a></td>
<td>  <b>CUMULATIVE_SUM()</b>,        <b>InfluxDB</b>,    <b>NON_NEGATIVE_DERIVATIVE()</b></td>
</tr>
<tr>
<td>InfluxDB / Transformation / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NON_NEGATIVE_DERIVATIVE()</a></td>
<td>  <b>NON_NEGATIVE_DERIVATIVE()</b>,     3 .     <b>CUMULATIVE_SUM()</b> —          3</td>
</tr>
<tr>
<td><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Using Grafana’s Query Inspector to troubleshoot issues</a></td>
<td> <b>Query Inspector</b>,         ,        Grafana-</td>
</tr>
<tr>
<td>Grafana / Graph / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Draw Options</a></td>
<td>  Stack, Tooltip,…              «2. Grafana-way.   » </td>
</tr>
<tr>
<td>Grafana / Graph / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Series overrides</a></td>
<td>       (     )  <b>Grafana</b></td>
</tr>
</tbody></table></div><br>
<h2></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">مزيج من Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> يحتاج إلى أن تكون معروفة جيدا للمهندسين اختبار الأداء. وفي هذه الحزمة ، تعتبر العديد من المهام البسيطة مثيرة للاهتمام للغاية ، ولا يمكن حلها دائمًا من خلال طرق البرمجة العادية. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في بعض الأحيان قد تكون هناك حاجة إلى مهارات البرمجة غير طبيعية مع </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الميزات </font><font style="vertical-align: inherit;">والدقيقة من </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الاستعلام </font><b><font style="vertical-align: inherit;">اللغة</font></b><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
في المقالة ، تم أخذ أربع خطوات في الاعتبار لتنفيذ تلخيص المقياس مع التجميع حسب علامة واحدة ، ولكن يحتوي على العديد من العلامات. كانت المهمة مثيرة للاهتمام. وهناك العديد من هذه المهام. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
أقوم بإعداد تقرير عن </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">التفاصيل</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> الدقيقة للبرمجة مع </font><b><font style="vertical-align: inherit;">Grafana</font></b><font style="vertical-align: inherit;"> و </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfluxDB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">سوف أنشر بشكل دوري مواد حول هذا الموضوع. </font><font style="vertical-align: inherit;">في غضون ذلك ، سأكون سعيدًا بأسئلتك حول المقالة الحالية.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar490754/index.html">Visual Studio Code Code Editor. الدليل الأكثر تفصيلاً لإعداد وتثبيت الإضافات للمبتدئين</a></li>
<li><a href="../ar490756/index.html">انشر جنكينز كرمز</a></li>
<li><a href="../ar490758/index.html">أثبت علماء الرياضيات القانون العالمي للاضطراب</a></li>
<li><a href="../ar490760/index.html">Ray Casting Visual Search (RCVS). خوارزمية بسيطة وسريعة للعثور على نماذج ثلاثية الأبعاد متشابهة في الهندسة</a></li>
<li><a href="../ar490762/index.html">كيف تتنبأ بالطيران؟</a></li>
<li><a href="../ar490766/index.html">كيف تفهم المبتدئ ، أي لغة تختار للمهنة المطلوبة؟</a></li>
<li><a href="../ar490768/index.html">عندما تكون ألعاب الكمبيوتر هي وظيفتك: الجهاز الداخلي للألعاب السحابية</a></li>
<li><a href="../ar490770/index.html">يسقط الدين الفني! في TechLead Conf 2020 ، سنوضح لك كيف</a></li>
<li><a href="../ar490772/index.html">كيفية كتابة ونشر عقد ذكي في Telegram Open Network (TON)</a></li>
<li><a href="../ar490774/index.html">متجاوب</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>