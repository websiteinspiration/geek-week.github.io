<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÖ üôÇ ü¶ë Kami menulis firmware untuk TI cc2530 pada Z-Stack 3.0 untuk Zigbee relay Sonoff BASICZBR3 dengan sensor ds18b20 üë®üèø‚Äçüé® üññ ü§ûüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diasumsikan bahwa pembaca sudah memiliki pengetahuan awal tentang bahasa C, tahu sesuatu tentang Zigbee, chip cc2530, metode untuk menginstal dan meng...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Kami menulis firmware untuk TI cc2530 pada Z-Stack 3.0 untuk Zigbee relay Sonoff BASICZBR3 dengan sensor ds18b20</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/iobroker/blog/495926/"><img src="https://habrastorage.org/webt/pk/k8/1r/pkk81rmgifam0ccamhmapnesahq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diasumsikan bahwa pembaca sudah memiliki pengetahuan awal tentang bahasa C, tahu sesuatu tentang Zigbee, chip cc2530, metode untuk menginstal dan menggunakannya, dan juga akrab dengan proyek-proyek seperti zigbee2mqtt. </font><font style="vertical-align: inherit;">Jika tidak, bersiap-siaplah atau bacalah di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://myzigbee.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.zigbee2mqtt.io/</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Artikel ini ditulis pertama kali secara terperinci, tetapi secara bertahap berakselerasi dan tidak berhenti pada detailnya, tetapi menjelaskan kode firmware yang sudah jadi. </font><font style="vertical-align: inherit;">Jika seseorang tidak tertarik pada alasan, maka buka saja sumber firmware dan bacalah. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode sumber dari firmware yang sudah selesai</font></font></a><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kode dan pendekatan pengembangan tidak mengklaim sebagai ideal. </font><font style="vertical-align: inherit;">"Aku bukan penyihir, aku hanya belajar."</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tujuan</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tujuan utamanya adalah memahami cara menulis firmware untuk Z-Stack untuk waktu yang lama. </font><font style="vertical-align: inherit;">Oleh karena itu, saya memutuskan untuk mengimplementasikan firmware alternatif untuk peralatan jadi ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sonoff BASICZBR3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> relay dipilih sebagai contoh </font><font style="vertical-align: inherit;">) dan menambahkan kemampuan untuk menghubungkan sensor suhu ds18b20 yang populer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, saya ingin menunjukkan kepada pengembang pemula Zigbee contoh pengembangan firmware untuk chip TI cc2530 pada Z-Stack.</font></font><br>
<a name="habracut"></a><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Persiapan</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memulai pengembangan, Anda perlu mengunduh dan menginstal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z-Stack 3.0.2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ini adalah SDK untuk mengembangkan firmware dengan contoh dan dokumentasi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda juga perlu mengunduh dan menginstal </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IAR Embeded Workbench untuk 8051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ini adalah lingkungan pengembangan dengan kemampuan untuk mengkompilasi chip TI cc2530. </font><font style="vertical-align: inherit;">Periode penggunaan gratis adalah 1 bulan (tetapi pencari akan menemukan solusi). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pengembangan dan debugging, saya menggunakan CCDebugger - memungkinkan tidak hanya menginstal chip cc2531 / cc2530, tetapi juga debugging aplikasi di lingkungan IAR. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/_j/aj/pr/_jajpr3cvn5q93lo6_igpenpdly.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menyederhanakan percobaan, membuat prototipe dan debugging yang saya lakukan di devboard dan modul cc2530 yang sesuai:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ql/xc/cq/qlxccqkdbxnqt3pcuo8049lj0ci.jpeg"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Membuat aplikasi baru</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami membuat proyek baru berdasarkan GenericApp. </font><font style="vertical-align: inherit;">Ini adalah contoh aplikasi Z-Stack dasar. </font><font style="vertical-align: inherit;">Itu terletak di folder Z-Stack 3.0.2 \ Projects \ zstack \ HomeAutomation \ GenericApp. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menyalinnya di dekat situ dan mengganti namanya, misalnya, ke DIYRuZRT (sebut saja aplikasi untuk perangkat kami). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalam folder CC2530DB ada file:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericApp.ewd - pengaturan proyek untuk C-SPY</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericApp.ewp - file proyek</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenericApp.eww - Workspace</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubah nama file menjadi DIYRuZRT.eww dan DIYRuZRT.ewp. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di dalam semua file (termasuk folder Sumber), kami juga mengubah semua referensi untuk GenericApp ke DIYRuZRT. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang buka proyek DIYRuZRT.ewp di IAR. Kami memilih konfigurasi RouterEB dan melakukan Rebuild All. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fb/re/mb/fbremb-ma8rcyafhwdcj6klys9k.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folder RouterEB akan dibuat di folder CC2530DB, dan file DIYRuZRT.d51 akan muncul di dalam folder EXE - file ini nyaman untuk menginstal dan debugging dari IAR. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi jika kita perlu mem-flash firmware melalui SmartRF Flash Programmer, maka kita akan membuat perubahan kecil. Untuk melakukan ini, dalam pengaturan proyek di bagian Tautan pada tab Output, ubah pengaturan untuk file Output dan Format: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/r5/cb/xl/r5cbxlrunrutiwxxgt-gytlwjz4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, file firmware DIYRuZRT.hex akan dibuat di folder EXE, nyaman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk flashing dari alat lain dan dengan cara lain</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi setelah mengunggah firmware ini, perangkat tidak terhubung ke jaringan. </font><font style="vertical-align: inherit;">Baiklah, kita akan mengerti.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Sedikit terminologi</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminologi Zigbee memiliki konsep berikut:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Endpoint</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Titik deskripsi perangkat akhir. </font><font style="vertical-align: inherit;">Biasanya dalam perangkat sederhana satu titik akhir. </font><font style="vertical-align: inherit;">Ada beberapa dari mereka di perangkat multifungsi, serta di perangkat dengan profil interaksi yang berbeda (satu profil - satu titik akhir).</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cluster (cluster)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - seperangkat atribut dan perintah yang terkait dengan fungsional tunggal (on / off, peredupan, pengukuran suhu, dll.). </font><font style="vertical-align: inherit;">Cluster menunjukkan peluang yang direalisasikan oleh titik akhir. </font><font style="vertical-align: inherit;">Di satu titik akhir, Anda dapat menerapkan beberapa kelompok berbeda, tetapi tidak yang sama.</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atribut (atribut)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - karakteristik kluster yang nilainya dapat dibaca atau ditulis. </font><font style="vertical-align: inherit;">Cluster dapat memiliki banyak atribut.</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Command</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Pesan kontrol yang bisa diproses oleh cluster. </font><font style="vertical-align: inherit;">Tim mungkin memiliki parameter. </font><font style="vertical-align: inherit;">Ini diimplementasikan oleh fungsi yang dieksekusi ketika perintah dan parameter diterima.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jenis cluster, atribut, perintah distandarisasi di Perpustakaan Zigbee Cluster. </font><font style="vertical-align: inherit;">Tetapi pabrikan dapat menggunakan kelompok mereka sendiri, dengan atribut dan tim mereka sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beberapa produsen yang menyedihkan tidak mempedulikan standar dan melakukan sesuatu tentang standar tersebut. </font><font style="vertical-align: inherit;">Maka Anda harus beradaptasi dengan mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminologi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z-Stack juga memiliki konsep sendiri</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , misalnya:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSAL (Lapisan Sistem Abstraksi Sistem Operasi)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tingkat abstraksi Sistem Operasi. </font><font style="vertical-align: inherit;">Di sini mereka beroperasi dengan tugas (tugas), pesan (pesan), acara (acara), timer (timer) dan objek lainnya.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL (Hardware Abstraction Layer)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tingkat abstraksi peralatan. </font><font style="vertical-align: inherit;">Di sini mereka beroperasi dengan tombol (tombol), LED (led), interupsi (Interrupt), dll.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lapisan perangkat keras menyediakan isolasi kode program dan peralatan yang dikontrolnya. </font><font style="vertical-align: inherit;">Tingkat operasional menyediakan mekanisme untuk membangun dan berinteraksi di antara elemen-elemen aplikasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menggunakan ini semua menanti Anda di bawah ini dan, pada prinsipnya, saat mengembangkan firmware.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Apa yang kita miliki di dalam aplikasi basis?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode aplikasi terletak di folder Sumber:</font></font><br>
<br>
<ul>
<li><i>OSAL_DIYRuZRT.c</i> ‚Äî    <br>
</li>
<li><i>zcl_DIYRuZRT.h</i> ‚Äî  <br>
</li>
<li><i>zcl_DIYRuZRT.c</i> ‚Äî   <br>
</li>
<li><i>zcl_DIYRuZRT_data.c</i> ‚Äî  ,   <br>
</li>
</ul><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSAL_DIYRuZRT.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - file utama di mana array penangan tugas (task)&nbsp; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pTaskEventHandlerFn taskArr diisi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan fungsi inisialisasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">osalInitTasks diimplementasikan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua file lain diperlukan untuk mengimplementasikan inisialisasi dan penangan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar penangan tugas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pTaskEventHandlerFn taskAr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r diisi dengan referensi fungsi. Beberapa tugas terhubung / terputus oleh arahan kompilasi yang sesuai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda dapat melihat dan mengonfigurasi arahan kompilasi dalam opsi kompiler Simbol yang ditentukan:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/pn/tl/u6/pntlu6bioazjsoaywmdfofeloas.png"><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">const</span> pTaskEventHandlerFn tasksArr[] = {<font></font>
  macEventLoop,<font></font>
  nwk_event_loop,<font></font>
#<span class="hljs-keyword">if</span> !defined (DISABLE_GREENPOWER_BASIC_PROXY) &amp;&amp; (ZG_BUILD_RTR_TYPE)<font></font>
  gp_event_loop,<font></font>
#endif  <font></font>
  Hal_ProcessEvent,<font></font>
#<span class="hljs-keyword">if</span> defined( MT_TASK )<font></font>
  MT_ProcessEvent,<font></font>
#endif<font></font>
  APS_event_loop,<font></font>
#<span class="hljs-keyword">if</span> defined ( ZIGBEE_FRAGMENTATION )<font></font>
  APSF_ProcessEvent,<font></font>
#endif<font></font>
  ZDApp_event_loop,<font></font>
#<span class="hljs-keyword">if</span> defined ( ZIGBEE_FREQ_AGILITY ) || defined ( ZIGBEE_PANID_CONFLICT )<font></font>
  ZDNwkMgr_event_loop,<font></font>
#endif<font></font>
  <span class="hljs-comment">//Added to include TouchLink functionality</span>
  #<span class="hljs-keyword">if</span> defined ( INTER_PAN )<font></font>
    StubAPS_ProcessEvent,<font></font>
  #endif<font></font>
  <span class="hljs-comment">// Added to include TouchLink initiator functionality</span>
  #<span class="hljs-keyword">if</span> defined ( BDB_TL_INITIATOR )<font></font>
    touchLinkInitiator_event_loop,<font></font>
  #endif<font></font>
  <span class="hljs-comment">// Added to include TouchLink target functionality</span>
  #<span class="hljs-keyword">if</span> defined ( BDB_TL_TARGET )<font></font>
    touchLinkTarget_event_loop,<font></font>
  #endif<font></font>
  zcl_event_loop,<font></font>
  bdb_event_loop,<font></font>
  zclDIYRuZRT_event_loop<font></font>
};<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">osalInitTasks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah fungsi start-up aplikasi yang mendaftarkan tugas yang </font><b><font style="vertical-align: inherit;">dilakukan oleh</font></b><font style="vertical-align: inherit;"> aplikasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Registrasi tugas dilakukan berurutan, dan setiap tugas mendapatkan nomornya sendiri. Penting untuk mengikuti urutan yang sama seperti dalam array </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">taskArr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , seperti penangan dipanggil sesuai dengan nomor tugas.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">osalInitTasks</span><span class="hljs-params">( <span class="hljs-keyword">void</span> )</span>
</span>{<font></font>
  uint8 taskID = <span class="hljs-number">0</span>;<font></font>
<font></font>
  tasksEvents = (uint16 *)osal_mem_alloc( <span class="hljs-keyword">sizeof</span>( uint16 ) * tasksCnt);<font></font>
  osal_memset( tasksEvents, <span class="hljs-number">0</span>, (<span class="hljs-keyword">sizeof</span>( uint16 ) * tasksCnt));<font></font>
<font></font>
  macTaskInit( taskID++ );<font></font>
  nwk_init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> !defined (DISABLE_GREENPOWER_BASIC_PROXY) &amp;&amp; (ZG_BUILD_RTR_TYPE)</span><font></font>
  gp_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
  Hal_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined( MT_TASK )</span><font></font>
  MT_TaskInit( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
  APS_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined ( ZIGBEE_FRAGMENTATION )</span><font></font>
  APSF_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
  ZDApp_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined ( ZIGBEE_FREQ_AGILITY ) || defined ( ZIGBEE_PANID_CONFLICT )</span><font></font>
  ZDNwkMgr_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
  <span class="hljs-comment">// Added to include TouchLink functionality</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined ( INTER_PAN )</span><font></font>
  StubAPS_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-comment">// Added to include TouchLink initiator functionality</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined( BDB_TL_INITIATOR )</span><font></font>
  touchLinkInitiator_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-comment">// Added to include TouchLink target functionality</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined ( BDB_TL_TARGET )</span><font></font>
  touchLinkTarget_Init( taskID++ );<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
  zcl_Init( taskID++ );<font></font>
  bdb_Init( taskID++ );<font></font>
  zclDIYRuZRT_Init( taskID );<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aplikasi kami mendaftarkan function handler </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_event_loop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan fungsi inisialisasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_Init</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mereka ditambahkan terakhir dalam daftar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah dua fungsi utama aplikasi kita. Implementasi fungsi-fungsi ini ada di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zcl_DIYRuZRT.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_Init</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fungsi pendaftaran tugas. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_ENDPOINT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nomor titik akhir yang diterapkan oleh aplikasi kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Langkah-langkah pendaftaran yang menggambarkan aplikasi kami dilakukan secara berurutan:</font></font><br>
<br>
<ul>
<li><b>bdb_RegisterSimpleDescriptor </b> ‚Äî    .    <b>SimpleDescriptionFormat_t zclDIYRuZRT_SimpleDesc</b> ‚Äî    ,  , ,    .       <i>OSAL_DIYRuZRT_data.c</i><br>
</li>
<li><b>zclGeneral_RegisterCmdCallbacks </b> ‚Äî      <b>zclGeneral_AppCallbacks_t zclDIYRuZRT_CmdCallbacks</b> ‚Äî  ,       .<br>
</li>
<li><b>zcl_registerAttrList </b> ‚Äî    <b>zclAttrRec_t zclDIYRuZRT_Attrs</b> ‚Äî  ,     .<br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zcl_registerForMsg</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftar tanda terima pesan kontrol.</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegisterForKeys</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kami menandatangani tugas kami untuk menerima acara klik tombol.</font></font><br>
</li>
</ul><br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*********************************************************************
 * SIMPLE DESCRIPTOR
 */</span>
<span class="hljs-comment">// This is the Cluster ID List and should be filled with Application</span>
<span class="hljs-comment">// specific cluster IDs.</span>
<span class="hljs-keyword">const</span> cId_t zclDIYRuZRT_InClusterList[] =<font></font>
{<font></font>
  ZCL_CLUSTER_ID_GEN_BASIC,<font></font>
  ZCL_CLUSTER_ID_GEN_IDENTIFY,<font></font>
  <font></font>
  <span class="hljs-comment">// DIYRuZRT_<span class="hljs-doctag">TODO:</span> Add application specific Input Clusters Here. </span>
  <span class="hljs-comment">//       See zcl.h for Cluster ID definitions</span><font></font>
  <font></font>
};<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCLDIYRuZRT_MAX_INCLUSTERS   (sizeof(zclDIYRuZRT_InClusterList) / sizeof(zclDIYRuZRT_InClusterList[0]))</span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword">const</span> cId_t zclDIYRuZRT_OutClusterList[] =<font></font>
{<font></font>
  ZCL_CLUSTER_ID_GEN_BASIC,<font></font>
  <font></font>
  <span class="hljs-comment">// DIYRuZRT_<span class="hljs-doctag">TODO:</span> Add application specific Output Clusters Here. </span>
  <span class="hljs-comment">//       See zcl.h for Cluster ID definitions</span><font></font>
};<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCLDIYRuZRT_MAX_OUTCLUSTERS  (sizeof(zclDIYRuZRT_OutClusterList) / sizeof(zclDIYRuZRT_OutClusterList[0]))</span><font></font>
<font></font>
<font></font>
SimpleDescriptionFormat_t zclDIYRuZRT_SimpleDesc =<font></font>
{<font></font>
  DIYRuZRT_ENDPOINT,                  <span class="hljs-comment">//  int Endpoint;</span>
  ZCL_HA_PROFILE_ID,                     <span class="hljs-comment">//  uint16 AppProfId;</span>
  <span class="hljs-comment">// DIYRuZRT_<span class="hljs-doctag">TODO:</span> Replace ZCL_HA_DEVICEID_ON_OFF_LIGHT with application specific device ID</span>
  ZCL_HA_DEVICEID_ON_OFF_LIGHT,          <span class="hljs-comment">//  uint16 AppDeviceId; </span>
  DIYRuZRT_DEVICE_VERSION,            <span class="hljs-comment">//  int   AppDevVer:4;</span>
  DIYRuZRT_FLAGS,                     <span class="hljs-comment">//  int   AppFlags:4;</span>
  ZCLDIYRuZRT_MAX_INCLUSTERS,         <span class="hljs-comment">//  byte  AppNumInClusters;</span>
  (cId_t *)zclDIYRuZRT_InClusterList, <span class="hljs-comment">//  byte *pAppInClusterList;</span>
  ZCLDIYRuZRT_MAX_OUTCLUSTERS,        <span class="hljs-comment">//  byte  AppNumInClusters;</span>
  (cId_t *)zclDIYRuZRT_OutClusterList <span class="hljs-comment">//  byte *pAppInClusterList;</span><font></font>
};<font></font>
</code></pre><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_event_loop</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fungsi event handler aplikasi kita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, peristiwa sistem diproses dalam satu lingkaran:</font></font><br>
<br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZCL_INCOMING_MSG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - perintah kontrol perangkat diproses dalam zclDIYRuZRT_ProcessIncomingMsg.</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KEY_CHANGE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - acara klik tombol diproses di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_HandleKeys</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
</li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ZDO_STATE_CHANGE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - acara perubahan status jaringan.</font></font><br>
</li>
</ul><br>
<pre><code class="cpp hljs">  <span class="hljs-keyword">if</span> ( events &amp; SYS_EVENT_MSG )<font></font>
  {<font></font>
    <span class="hljs-keyword">while</span> ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( zclDIYRuZRT_TaskID )) )<font></font>
    {<font></font>
      <span class="hljs-keyword">switch</span> ( MSGpkt-&gt;hdr.event )<font></font>
      {<font></font>
        <span class="hljs-keyword">case</span> ZCL_INCOMING_MSG:
          <span class="hljs-comment">// Incoming ZCL Foundation command/response messages</span><font></font>
          zclDIYRuZRT_ProcessIncomingMsg( (zclIncomingMsg_t *)MSGpkt );<font></font>
          <span class="hljs-keyword">break</span>;<font></font>
<font></font>
        <span class="hljs-keyword">case</span> KEY_CHANGE:<font></font>
          zclDIYRuZRT_HandleKeys( ((keyChange_t *)MSGpkt)-&gt;state, ((keyChange_t *)MSGpkt)-&gt;keys );<font></font>
          <span class="hljs-keyword">break</span>;<font></font>
<font></font>
        <span class="hljs-keyword">case</span> ZDO_STATE_CHANGE:<font></font>
          zclDIYRuZRT_NwkState = (devStates_t)(MSGpkt-&gt;hdr.status);<font></font>
<font></font>
          <span class="hljs-comment">// now on the network</span>
          <span class="hljs-keyword">if</span> ( (zclDIYRuZRT_NwkState == DEV_ZB_COORD) ||<font></font>
               (zclDIYRuZRT_NwkState == DEV_ROUTER)   ||<font></font>
               (zclDIYRuZRT_NwkState == DEV_END_DEVICE) )<font></font>
          {<font></font>
            giGenAppScreenMode = GENERIC_MAINMODE;<font></font>
            zclDIYRuZRT_LcdDisplayUpdate();<font></font>
          }<font></font>
          <span class="hljs-keyword">break</span>;<font></font>
<font></font>
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">break</span>;<font></font>
      }<font></font>
<font></font>
      <span class="hljs-comment">// Release the memory</span><font></font>
      osal_msg_deallocate( (uint8 *)MSGpkt );<font></font>
    }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikutnya adalah pemrosesan acara khusus </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_EVT_1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang mengubah status LED </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_LED_2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan memulai timer untuk 500 m dengan acara yang sama. </font><font style="vertical-align: inherit;">Ini memulai flashing LED </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_LED_2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-keyword">if</span> ( events &amp; DIYRuZRT_EVT_1 )<font></font>
  {<font></font>
    <span class="hljs-comment">// toggle LED 2 state, start another timer for 500ms</span><font></font>
    HalLedSet ( HAL_LED_2, HAL_LED_MODE_TOGGLE );<font></font>
    osal_start_timerEx( zclDIYRuZRT_TaskID, DIYRuZRT_EVT_1, <span class="hljs-number">500</span> );<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> ( events ^ DIYRuZRT_EVT_1 );<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faktanya adalah bahwa ketika firmware dimulai, peristiwa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_KEY_SW_1 terjadi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan di dalamnya timer dan acara </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_EVT_1 diinisialisasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dan jika Anda menekan tombol S2, maka kedipan akan berhenti (LED saya tetap menyala). </font><font style="vertical-align: inherit;">Menekannya lagi akan mulai berkedip.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. HAL: LED dan tombol</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"Tunggu, LED dan tombol mana?", Anda bertanya. </font><font style="vertical-align: inherit;">Awalnya, semua contoh dalam Z-stack difokuskan pada berbagai jenis papan debug dari seri SmartRF05 EB: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/tz/bl/ru/tzblrurrrpoze3kghx_dd1zrume.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memiliki papan debug yang sedikit berbeda dan modul dengan chip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada 2 tombol (+ reset) dan 3 LED (+ indikator daya) di papan tulis. </font><font style="vertical-align: inherit;">Berikut adalah salah satu dari mereka (D2) yang berkedip ketika firmware bekerja dengan benar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memanggil kontak, kami menentukan korespondensi pin, dioda dan tombol:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D1 - P10</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D2 - P11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D3 - P14</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S2 - P20</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S1 - P01</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, HAL adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lapisan Abstraksi Perangkat Keras</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cara untuk abstrak dari implementasi peralatan. Kode aplikasi menggunakan makro dan fungsi yang bekerja dengan abstraksi seperti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tombol 1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED 2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan korespondensi spesifik abstraksi dan peralatan diatur secara terpisah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_LED_2 jenis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apa </font><font style="vertical-align: inherit;">dan bagaimana memahami pin yang ditangguhkan. </font><i><font style="vertical-align: inherit;">Dengan</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
mencari, kami menemukan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_led.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana konstanta ini dan fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalLedSet dijelaskan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , di mana nomor LED dan mode ditransmisikan. Di dalam, fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalLedOnOff dipanggil</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menghidupkan dan mematikan LED, yang selanjutnya mengeksekusi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_TURN_ON_LED2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_TURN_OFF_LED2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_TURN_ON_LED2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_TURN_OFF_LED2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah makro yang dijelaskan dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Perubahan makro tergantung pada konfigurasi perangkat keras. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam hal ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HAL_TURN_OFF_LED2() &nbsp; &nbsp; &nbsp; st( LED2_SBIT = LED2_POLARITY (0); )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HAL_TURN_ON_LED2()&nbsp; &nbsp; &nbsp; &nbsp; st( LED2_SBIT = LED2_POLARITY (1); )</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sedikit lebih tinggi dalam file adalah korespondensi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED2_SBIT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED2_POLARITY</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs">&nbsp;&nbsp;<span class="hljs-comment">/* 2 - Red */</span>
&nbsp;&nbsp;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_BV &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BV(1)</span>
&nbsp;&nbsp;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_SBIT &nbsp; &nbsp; &nbsp; &nbsp; P1_1</span>
&nbsp;&nbsp;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_DDR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; P1DIR</span>
&nbsp;&nbsp;<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_POLARITY &nbsp; &nbsp; ACTIVE_HIGH</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini berarti bahwa LED 2 terletak di pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1_1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan level switching-nya tinggi. </font><font style="vertical-align: inherit;">Tapi, kalau dilihat dari kodenya, LED harus padam ketika tombol ditekan, tetapi dengan kita tetap menyala. </font><font style="vertical-align: inherit;">Jika dalam file ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg.h kita</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ubah:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_POLARITY &nbsp; &nbsp; ACTIVE_HIGH</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
di</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_POLARITY &nbsp; &nbsp; ACTIVE_LOW</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
maka sekarang LED padam ketika Anda menekan tombol S2, sebagaimana mestinya dengan logika. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar tidak mengubah file umum yang tidak terkait dengan aplikasi kita, lebih baik melakukan sebaliknya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buat salinan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dari folder Z-Stack 3.0.2 \ Components \ hal \ target \ CC2530EB \) di folder Source kami dan beri nama, misalnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mari kita buat salinan file kita yang pertama (dengan demikian tidak termasuk koneksi file bersama). </font><font style="vertical-align: inherit;">Buat file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preinclude.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di folder Sumber kami </font><font style="vertical-align: inherit;">dan tulis baris di sana:</font></font><br>
</li>
</ul><br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">"hal_board_cfg_DIYRuZRT.h"</span></span></code></pre><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunjukkan koneksi file ini adalah yang pertama - dalam pengaturan proyek:</font></font><br>
</li>
</ul><br>
<pre><code class="cpp hljs">$PROJ_DIR$\..\Source\preinclude.h</code></pre><br>
<img src="https://habrastorage.org/webt/jl/_f/j_/jl_fj_oy71xhwehgszprw9jhdiw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita dapat mengubah parameter peralatan di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kita </font><font style="vertical-align: inherit;">dan di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preinclude.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tanpa harus mengedit file bersama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mentransfer arahan kompiler ke file preinclude.h yang sama dan menghapusnya di Opsi kompiler:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SECURE 1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TC_LINKKEY_JOIN</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NV_INIT</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NV_RESTORE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xZTOOL_P1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_TASK</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_APP_FUNC</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_SYS_FUNC</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_ZDO_FUNC</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_ZDO_MGMT</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> xMT_APP_CNF_FUNC</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LEGACY_LCD_DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LCD_SUPPORTED DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MULTICAST_ENABLED FALSE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_READ</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_WRITE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_BASIC</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_IDENTIFY</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_SCENES</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_GROUPS</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam file yang sama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kita menemukan deskripsi tombol S1 dan Joystick Center Tekan:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* S1 */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PUSH1_BV&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BV(1)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PUSH1_SBIT&nbsp; &nbsp; &nbsp; &nbsp; P0_1</span><font></font>
<font></font>
<span class="hljs-comment">/* Joystick Center Press */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PUSH2_BV&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BV(0)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PUSH2_SBIT&nbsp; &nbsp; &nbsp; &nbsp; P2_0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PUSH2_POLARITY&nbsp; &nbsp; ACTIVE_HIGH</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini sesuai dengan pin tombol di papan tulis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat inisialisasi perangkat keras - makro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_BOARD_INIT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam file yang sama. </font><font style="vertical-align: inherit;">Secara default, arahan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_BOARD_CC2530EB_REV17 dihidupkan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi kami melihat varian makro yang sesuai.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/* ----------- Board Initialization ---------- */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined (HAL_BOARD_CC2530EB_REV17) &amp;&amp; !defined (HAL_PA_LNA) &amp;&amp; \
    !defined (HAL_PA_LNA_CC2590) &amp;&amp; !defined (HAL_PA_LNA_SE2431L) &amp;&amp; \
    !defined (HAL_PA_LNA_CC2592)</span><font></font>
<font></font>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HAL_BOARD_INIT()                                         \
{                                                                \
  uint16 i;                                                      \
                                                                 \
  SLEEPCMD &amp;= ~OSC_PD;                       <span class="hljs-comment">/* turn on 16MHz RC and 32MHz XOSC */</span>                \
  while (!(SLEEPSTA &amp; XOSC_STB));            <span class="hljs-comment">/* wait for 32MHz XOSC stable */</span>                     \
  asm(<span class="hljs-meta-string">"NOP"</span>);                                <span class="hljs-comment">/* chip bug workaround */</span>                            \
  for (i=0; i&lt;504; i++) asm(<span class="hljs-meta-string">"NOP"</span>);          <span class="hljs-comment">/* Require 63us delay for all revs */</span>                \
  CLKCONCMD = (CLKCONCMD_32MHZ | OSC_32KHZ); <span class="hljs-comment">/* Select 32MHz XOSC and the source for 32K clock */</span> \
  while (CLKCONSTA != (CLKCONCMD_32MHZ | OSC_32KHZ)); <span class="hljs-comment">/* Wait for the change to be effective */</span>   \
  SLEEPCMD |= OSC_PD;                        <span class="hljs-comment">/* turn off 16MHz RC */</span>                              \
                                                                 \
  <span class="hljs-comment">/* Turn on cache prefetch mode */</span>                              \
  PREFETCH_ENABLE();                                             \
                                                                 \
  HAL_TURN_OFF_LED1();                                           \
  LED1_DDR |= LED1_BV;                                           \
  HAL_TURN_OFF_LED2();                                           \
  LED2_DDR |= LED2_BV;                                           \
  HAL_TURN_OFF_LED3();                                           \
  LED3_DDR |= LED3_BV;                                           \
  HAL_TURN_OFF_LED4();                                           \
  LED4_SET_DIR();                                                \
                                                                 \
  <span class="hljs-comment">/* configure tristates */</span>                                      \
  P0INP |= PUSH2_BV;                                             \
}</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam makro ini mode dan register prosesor diinisialisasi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebaliknya </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED2_DDR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan yang lainnya akan diganti </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1DIR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftarkan port </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1 ini</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , isi pin mode operasi (input atau output). Oleh karena itu, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED2_BV diatur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke 1 per bit dari pin yang sesuai (dalam kasus kami, 1 bit, yang sesuai dengan pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1_1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qr/ed/0y/qred0ypxdrfxxkaleymbpqmjgto.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mode register dan prosesor dijelaskan dalam dokumentasi </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Panduan Pengguna cc253x".</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tetapi tidak terlihat bagaimana tombol-tombol tersebut dikonfigurasikan. Tombol diproses sama, tetapi di file lain - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_key.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ini mendefinisikan parameter tombol dan fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalKeyInit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalKeyConfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalKeyRead</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HalKeyPoll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Fungsi-fungsi ini bertanggung jawab untuk menginisialisasi subsistem bekerja dengan tombol dan nilai membaca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara default, pemrosesan tombol dilakukan pada timer setiap 100 ms. </font><font style="vertical-align: inherit;">Pin P2_0 untuk konfigurasi saat ini ditetapkan ke joystick dan status saat ini dibaca sebagai klik - oleh karena itu, timer kedip LED mulai.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Kami mengkonfigurasi perangkat untuk diri kita sendiri</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ubah file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zcl_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_ENDPOINT pada 1</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSAL_DIYRuZRT_data.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_DEVICE_VERSION pada 1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_ManufacturerName pada {6, 'D', 'I', 'Y', 'R', 'u', 'Z'}</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_ModelId pada {9, 'D', 'I', 'Y', 'R', 'u', 'Z', '_', 'R', 'T'}</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_DateCode pada {8, '2', '0', '2', '0', '0', '4', '0', '5'}</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar perangkat dapat terhubung ke jaringan pada saluran apa pun (hanya 11 secara default, ditentukan dalam arahan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEFAULT_CHANLIST</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tools \ f8wConfig.cfg</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Anda harus menentukan fitur ini di file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preinclude.h dengan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengubah nilai arahan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menambahkan arahan kompilasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DISABLE_GREENPOWER_BASIC_PROXY</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sehingga titik akhir GREENPOWER tidak dibuat untuk perangkat kami. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Matikan juga dukungan yang tidak perlu untuk layar LCD.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//#define LCD_SUPPORTED DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DISABLE_GREENPOWER_BASIC_PROXY</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEFAULT_CHANLIST 0x07FFF800&nbsp; <span class="hljs-comment">// ALL Channels</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar perangkat kami mencoba terhubung secara otomatis ke jaringan, kami akan menambahkan koneksi ke jaringan dalam kode fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_Init</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs">bdb_StartCommissioning(BDB_COMMISSIONING_MODE_NWK_STEERING |<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BDB_COMMISSIONING_MODE_FINDING_BINDING);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, jalankan Build, isi firmware ke dalam chip dan mulai memasangkan pada koordinator. </font><font style="vertical-align: inherit;">Saya memeriksa operasi jaringan Zigbee di ioBroker.zigbee, beginilah tampilannya perangkat yang terhubung: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/um/ik/ss/umikss4n4f19icobraxj-rb_tj4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hebat, ternyata menghubungkan perangkat!</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Kami mempersulit pengoperasian perangkat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita coba sedikit menyesuaikan fungsi:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proses menghubungkan perangkat ke jaringan dilakukan dengan menekan agak lama pada tombol.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika perangkat sudah ada di jaringan, maka tekan lama akan menampilkannya dari jaringan.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tekan sebentar - mengalihkan status LED.</font></font><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status LED harus dipertahankan ketika perangkat dimulai setelah listrik mati.</font></font><br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengatur pemrosesan tombol saya sendiri, saya membuat fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_HalKeyInit</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mirip dengan yang ada di modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_key.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi khusus untuk set tombol saya.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    ()</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DIYRuZRT_HalKeyInit</span><span class="hljs-params">( <span class="hljs-keyword">void</span> )</span>
</span>{
  <span class="hljs-comment">/*      0 */</span>
  halKeySavedKeys = <span class="hljs-number">0</span>;<font></font>
<font></font>
  PUSH1_SEL &amp;= ~(PUSH1_BV); <span class="hljs-comment">/*    - GPIO */</span>
  PUSH1_DIR &amp;= ~(PUSH1_BV); <span class="hljs-comment">/*    -  */</span><font></font>
  <font></font>
  PUSH1_ICTL &amp;= ~(PUSH1_ICTLBIT); <span class="hljs-comment">/*      */</span>
  PUSH1_IEN &amp;= ~(PUSH1_IENBIT);   <span class="hljs-comment">/*     */</span><font></font>
  <font></font>
  PUSH2_SEL &amp;= ~(PUSH2_BV); <span class="hljs-comment">/* Set pin function to GPIO */</span>
  PUSH2_DIR &amp;= ~(PUSH2_BV); <span class="hljs-comment">/* Set pin direction to Input */</span><font></font>
  <font></font>
  PUSH2_ICTL &amp;= ~(PUSH2_ICTLBIT); <span class="hljs-comment">/* don't generate interrupt */</span>
  PUSH2_IEN &amp;= ~(PUSH2_IENBIT);   <span class="hljs-comment">/* Clear interrupt enable bit */</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memanggil fungsi ini ditambahkan ke </font><font style="vertical-align: inherit;">file </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_BOARD_INIT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> makro </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untuk menghindari konflik, nonaktifkan hal_key bawaan di file yang sama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HAL_KEY FALSE</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena </font><font style="vertical-align: inherit;">tombol pembaca standar dinonaktifkan, kami akan melakukannya sendiri. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam fungsi inisialisasi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_Init</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><b><font style="vertical-align: inherit;">kita</font></b><font style="vertical-align: inherit;"> memulai timer untuk membaca status tombol. </font><font style="vertical-align: inherit;">Timer akan menghasilkan acara </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_KEY_EVENT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="cpp hljs">osal_start_reload_timer( zclDIYRuZRT_TaskID, HAL_KEY_EVENT, <span class="hljs-number">100</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan dalam loop acara, kami akan menangani acara </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_KEY_EVENT dengan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memanggil fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_HalKeyPoll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//  </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DIYRuZRT_HalKeyPoll</span> <span class="hljs-params">(<span class="hljs-keyword">void</span>)</span>
</span>{<font></font>
  uint8 keys = <span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-comment">//   1 ?</span>
  <span class="hljs-keyword">if</span> (HAL_PUSH_BUTTON1())<font></font>
  {<font></font>
    keys |= HAL_KEY_SW_1;<font></font>
  }<font></font>
  <font></font>
  <span class="hljs-comment">//   2 ?</span>
  <span class="hljs-keyword">if</span> (HAL_PUSH_BUTTON2())<font></font>
  {<font></font>
    keys |= HAL_KEY_SW_2;<font></font>
  }<font></font>
  <font></font>
  <span class="hljs-keyword">if</span> (keys == halKeySavedKeys)<font></font>
  {<font></font>
    <span class="hljs-comment">//  -  </span>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  <span class="hljs-comment">//        . </span><font></font>
  halKeySavedKeys = keys;<font></font>
<font></font>
  <span class="hljs-comment">//     </span><font></font>
  OnBoard_SendKeys(keys, HAL_KEY_STATE_NORMAL);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menyimpan keadaan tombol dalam variabel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halKeySavedKeys</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memungkinkan kita untuk menentukan momen perubahan - menekan dan melepaskan tombol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika Anda mengklik tombol, mulai timer selama 5 detik. </font><font style="vertical-align: inherit;">Jika timer ini menyala, acara </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_EVT_LONG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dibuat </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jika tombol dilepaskan, timer diatur ulang. </font><font style="vertical-align: inherit;">Bagaimanapun, jika Anda menekan tombol, kami mengganti status LED.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">zclDIYRuZRT_HandleKeys</span><span class="hljs-params">( byte shift, byte keys )</span>
</span>{
  <span class="hljs-keyword">if</span> ( keys &amp; HAL_KEY_SW_1 )<font></font>
  {<font></font>
    <span class="hljs-comment">//       - 5 </span>
    osal_start_timerEx(zclDIYRuZRT_TaskID, DIYRuZRT_EVT_LONG, <span class="hljs-number">5000</span>);
    <span class="hljs-comment">//  </span>
    updateRelay(RELAY_STATE == <span class="hljs-number">0</span>);<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    <span class="hljs-comment">//     </span><font></font>
    osal_stop_timerEx(zclDIYRuZRT_TaskID, DIYRuZRT_EVT_LONG);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, saat memproses acara pers lama, kami memperhatikan kondisi jaringan saat ini melalui atribut struktur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bdbAttributes.bdbNodeIsOnANetwork</font></font></b><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-comment">//  DIYRuZRT_EVT_LONG</span>
  <span class="hljs-keyword">if</span> ( events &amp; DIYRuZRT_EVT_LONG )<font></font>
  {<font></font>
    <span class="hljs-comment">//    </span>
    <span class="hljs-comment">//      ?</span>
    <span class="hljs-keyword">if</span> ( bdbAttributes.bdbNodeIsOnANetwork )<font></font>
    {<font></font>
      <span class="hljs-comment">//  </span><font></font>
      zclDIYRuZRT_LeaveNetwork();<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <font></font>
    {<font></font>
      <span class="hljs-comment">//    </span><font></font>
      bdb_StartCommissioning(<font></font>
        BDB_COMMISSIONING_MODE_NWK_FORMATION | <font></font>
        BDB_COMMISSIONING_MODE_NWK_STEERING | <font></font>
        BDB_COMMISSIONING_MODE_FINDING_BINDING | <font></font>
        BDB_COMMISSIONING_MODE_INITIATOR_TL<font></font>
      );<font></font>
      <span class="hljs-comment">//  ,   </span>
      osal_start_timerEx(zclDIYRuZRT_TaskID, DIYRuZRT_EVT_BLINK, <span class="hljs-number">500</span>);<font></font>
    }<font></font>
    <font></font>
    <span class="hljs-keyword">return</span> ( events ^ DIYRuZRT_EVT_LONG );<font></font>
  }<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melangkah lebih jauh. </font><font style="vertical-align: inherit;">Keadaan LED akan disimpan dalam variabel, nilai yang akan kami simpan dalam memori NV. </font><font style="vertical-align: inherit;">Saat perangkat dimulai, kita akan membaca nilai dari memori menjadi variabel.</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-comment">//  NVM   RELAY STATE</span>
  <span class="hljs-keyword">if</span> ( SUCCESS == osal_nv_item_init( NV_DIYRuZRT_RELAY_STATE_ID, <span class="hljs-number">1</span>, &amp;RELAY_STATE ) ) {
    <span class="hljs-comment">//   RELAY STATE  </span>
    osal_nv_read( NV_DIYRuZRT_RELAY_STATE_ID, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, &amp;RELAY_STATE );<font></font>
  }<font></font>
  <span class="hljs-comment">//   </span><font></font>
  applyRelay();<font></font>
</code></pre><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">updateRelay</span> <span class="hljs-params">( <span class="hljs-keyword">bool</span> value )</span>
</span>{
  <span class="hljs-keyword">if</span> (value) {<font></font>
    RELAY_STATE = <span class="hljs-number">1</span>;<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    RELAY_STATE = <span class="hljs-number">0</span>;<font></font>
  }<font></font>
  <span class="hljs-comment">//   </span>
  osal_nv_write(NV_DIYRuZRT_RELAY_STATE_ID, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, &amp;RELAY_STATE);
  <span class="hljs-comment">//   </span><font></font>
  applyRelay();<font></font>
}<font></font>
  <font></font>
<span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">applyRelay</span> <span class="hljs-params">( <span class="hljs-keyword">void</span> )</span>
</span>{
  <span class="hljs-comment">//  </span>
  <span class="hljs-keyword">if</span> (RELAY_STATE == <span class="hljs-number">0</span>) {
    <span class="hljs-comment">//    1</span><font></font>
    HalLedSet ( HAL_LED_1, HAL_LED_MODE_OFF );<font></font>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">//    1</span><font></font>
    HalLedSet ( HAL_LED_1, HAL_LED_MODE_ON );<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8. Sekarang kita akan berurusan dengan Zigbee</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejauh ini kami telah memilah-milah perangkat keras - dengan tombol kami mengontrol LED. </font><font style="vertical-align: inherit;">Sekarang kami menerapkan hal yang sama melalui Zigbee. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengontrol relai, cukup bagi kami untuk menggunakan titik akhir kami dan mengimplementasikan cluster </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenOnOff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kami membaca spesifikasi Zigbee Cluster Library untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenOnOff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cluster </font><font style="vertical-align: inherit;">: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zo/9z/z7/zo9zz7ccj2oyfyrxrk3mithxh0i.png"><br>
<br>
<img src="https://habrastorage.org/webt/7b/na/ek/7bnaekoi4gmleiisjwvbfw75hao.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cukup untuk mengimplementasikan atribut OnOff dan perintah Hidupkan, Matikan, Beralih. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, tambahkan arahan ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preinclude.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_ON_OFF</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam deskripsi atribut kami zclDIYRuZRT_Attrs, kami menambahkan atribut cluster baru:</font></font><br>
<br>
<pre><code class="cpp hljs">  <span class="hljs-comment">// ***  On/Off  ***</span><font></font>
  {<font></font>
    ZCL_CLUSTER_ID_GEN_ON_OFF,<font></font>
    { <span class="hljs-comment">// </span><font></font>
      ATTRID_ON_OFF,<font></font>
      ZCL_DATATYPE_BOOLEAN,<font></font>
      ACCESS_CONTROL_READ,<font></font>
      (<span class="hljs-keyword">void</span> *)&amp;RELAY_STATE<font></font>
    }<font></font>
  },<font></font>
  {<font></font>
    ZCL_CLUSTER_ID_GEN_ON_OFF,<font></font>
    {  <span class="hljs-comment">//  On/Off </span><font></font>
      ATTRID_CLUSTER_REVISION,<font></font>
      ZCL_DATATYPE_UINT16,<font></font>
      ACCESS_CONTROL_READ | ACCESS_CLIENT,<font></font>
      (<span class="hljs-keyword">void</span> *)&amp;zclDIYRuZRT_clusterRevision_all<font></font>
    }<font></font>
  },<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami juga menambahkan cluster ke daftar cluster titik akhir masuk yang didukung </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_InClusterList</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk menerapkan perintah kontrol, tambahkan handler ke tabel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_CmdCallbacks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">/*********************************************************************
 *    ZCL 
 */</span>
<span class="hljs-keyword">static</span> zclGeneral_AppCallbacks_t zclDIYRuZRT_CmdCallbacks =<font></font>
{<font></font>
  zclDIYRuZRT_BasicResetCB,               <span class="hljs-comment">// Basic Cluster Reset command</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// Identify Trigger Effect command</span>
  zclDIYRuZRT_OnOffCB,                    <span class="hljs-comment">// On/Off cluster commands</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// On/Off cluster enhanced command Off with Effect</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// On/Off cluster enhanced command On with Recall Global Scene</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// On/Off cluster enhanced command On with Timed Off</span><font></font>
#ifdef ZCL_LEVEL_CTRL<font></font>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// Level Control Move to Level command</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// Level Control Move command</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// Level Control Step command</span>
  <span class="hljs-literal">NULL</span>,                                   <span class="hljs-comment">// Level Control Stop command</span><font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kami menerapkannya:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    OnOff</span>
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">zclDIYRuZRT_OnOffCB</span><span class="hljs-params">(uint8 cmd)</span>
</span>{
  <span class="hljs-comment">//  ,   </span>
  <span class="hljs-comment">//    </span><font></font>
  afIncomingMSGPacket_t *pPtr = zcl_getRawAFMsg();<font></font>
  zclDIYRuZRT_DstAddr.addr.shortAddr = pPtr-&gt;srcAddr.addr.shortAddr;<font></font>
  <font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">if</span> (cmd == COMMAND_ON) {<font></font>
    updateRelay(TRUE);<font></font>
  }<font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cmd == COMMAND_OFF) {<font></font>
    updateRelay(FALSE);<font></font>
  }<font></font>
  <span class="hljs-comment">// </span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cmd == COMMAND_TOGGLE) {<font></font>
    updateRelay(RELAY_STATE == <span class="hljs-number">0</span>);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hebat, sekarang relay dapat diaktifkan oleh perintah. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/rg/_b/r5/rg_br5mwpw1z8g63trgcdts2o84.png"><br>
<br>
<img src="https://habrastorage.org/webt/sc/s8/-h/scs8-heldl3hz6l7h4ia3jllscw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi ini tidak cukup. </font><font style="vertical-align: inherit;">Sekarang kita juga harus memberi tahu koordinator tentang keadaan LED saat ini, jika kita mengganti dengan tombol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekali lagi, tambahkan arahan:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ZCL_REPORTING_DEVICE</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang buat fungsi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_ReportOnOff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang mengirim pesan status. </font><font style="vertical-align: inherit;">Kami akan memanggilnya ketika LED diaktifkan dan ketika perangkat dimulai.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//    </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">zclDIYRuZRT_ReportOnOff</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{
  <span class="hljs-keyword">const</span> uint8 NUM_ATTRIBUTES = <span class="hljs-number">1</span>;<font></font>
<font></font>
  zclReportCmd_t *pReportCmd;<font></font>
<font></font>
  pReportCmd = osal_mem_alloc(<span class="hljs-keyword">sizeof</span>(zclReportCmd_t) +<font></font>
                              (NUM_ATTRIBUTES * <span class="hljs-keyword">sizeof</span>(zclReport_t)));
  <span class="hljs-keyword">if</span> (pReportCmd != <span class="hljs-literal">NULL</span>) {<font></font>
    pReportCmd-&gt;numAttr = NUM_ATTRIBUTES;<font></font>
<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].attrID = ATTRID_ON_OFF;<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].dataType = ZCL_DATATYPE_BOOLEAN;<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].attrData = (<span class="hljs-keyword">void</span> *)(&amp;RELAY_STATE);<font></font>
<font></font>
    zclDIYRuZRT_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;<font></font>
    zclDIYRuZRT_DstAddr.addr.shortAddr = <span class="hljs-number">0</span>;<font></font>
    zclDIYRuZRT_DstAddr.endPoint = <span class="hljs-number">1</span>;<font></font>
<font></font>
    zcl_SendReportCmd(DIYRuZRT_ENDPOINT, &amp;zclDIYRuZRT_DstAddr,<font></font>
                      ZCL_CLUSTER_ID_GEN_ON_OFF, pReportCmd,<font></font>
                      ZCL_FRAME_CLIENT_SERVER_DIR, <span class="hljs-literal">false</span>, SeqNum++);<font></font>
  }<font></font>
<font></font>
  osal_mem_free(pReportCmd);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang dalam log kita melihat pesan tentang perubahan status LED.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9. Hubungkan sensor suhu ds18b20</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sensor terhubung ke pin gratis (dalam kasus saya, set </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2_1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tambahkan kode polling sensor ke aplikasi. Kami akan mewawancarai secara teratur - satu menit sekali. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Segera setelah pemungutan suara, koordinator jaringan akan memberi tahu Anda tentang nilai saat ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baca spesifikasi ZCL untuk mengirim data dari sensor suhu. Kita membutuhkan </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengukuran Suhu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cluster </font><b><font style="vertical-align: inherit;">.</font></b></font><br>
<br>
<img src="https://habrastorage.org/webt/o2/_q/8h/o2_q8h7gtgxs7cjvvz8dumonsgq.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kita melihat bahwa kita perlu mengimplementasikan 3 atribut, yang salah satunya mewakili nilai suhu dikalikan dengan 100. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita menambahkan atribut dengan analogi dengan cluster </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GenOnOff</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Koordinator akan diberi tahu tentang acara </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DIYRuZRT_REPORTING_EVT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang kami rencanakan di awal satu menit sekali. Di event handler, kami akan menelepon</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zclDIYRuZRT_ReportTemp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan membaca suhu sensor dan mengirim pesan.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//   </span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">zclDIYRuZRT_ReportTemp</span><span class="hljs-params">( <span class="hljs-keyword">void</span> )</span>
</span>{
  <span class="hljs-comment">//  </span><font></font>
  zclDIYRuZRT_MeasuredValue = readTemperature();<font></font>
  <font></font>
  <span class="hljs-keyword">const</span> uint8 NUM_ATTRIBUTES = <span class="hljs-number">1</span>;<font></font>
<font></font>
  zclReportCmd_t *pReportCmd;<font></font>
<font></font>
  pReportCmd = osal_mem_alloc(<span class="hljs-keyword">sizeof</span>(zclReportCmd_t) +<font></font>
                              (NUM_ATTRIBUTES * <span class="hljs-keyword">sizeof</span>(zclReport_t)));
  <span class="hljs-keyword">if</span> (pReportCmd != <span class="hljs-literal">NULL</span>) {<font></font>
    pReportCmd-&gt;numAttr = NUM_ATTRIBUTES;<font></font>
<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].attrID = ATTRID_MS_TEMPERATURE_MEASURED_VALUE;<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].dataType = ZCL_DATATYPE_INT16;<font></font>
    pReportCmd-&gt;attrList[<span class="hljs-number">0</span>].attrData = (<span class="hljs-keyword">void</span> *)(&amp;zclDIYRuZRT_MeasuredValue);<font></font>
<font></font>
    zclDIYRuZRT_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;<font></font>
    zclDIYRuZRT_DstAddr.addr.shortAddr = <span class="hljs-number">0</span>;<font></font>
    zclDIYRuZRT_DstAddr.endPoint = <span class="hljs-number">1</span>;<font></font>
<font></font>
    zcl_SendReportCmd(DIYRuZRT_ENDPOINT, &amp;zclDIYRuZRT_DstAddr,<font></font>
                      ZCL_CLUSTER_ID_MS_TEMPERATURE_MEASUREMENT, pReportCmd,<font></font>
                      ZCL_FRAME_CLIENT_SERVER_DIR, <span class="hljs-literal">false</span>, SeqNum++);<font></font>
  }<font></font>
<font></font>
  osal_mem_free(pReportCmd);<font></font>
}<font></font>
</code></pre><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10. Tuang firmware ke dalam perangkat</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mengubah devboard ke Sonoff BASICZBR3, Anda perlu menyesuaikan pencocokan pin dan tombol LED. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/eg/fu/we/egfuweya8lj53yh-5rarbvslzvk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ulangi LED 1 pada pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P0_7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengontrol relai. Inklusi dilakukan oleh </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACTIVE_HIGH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tingkat tinggi </font><font style="vertical-align: inherit;">. </font><b><font style="vertical-align: inherit;">Kami menggantung kembali</font></b><font style="vertical-align: inherit;"> tombol </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1_3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan informasi LED 2 pada </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1_0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kami membiarkan sensor suhu pada pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2_1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kami membuat semua perubahan ini dalam file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hal_board_cfg_DIYRuZRT.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Untuk memilih konfigurasi, kami akan membuat arahan terpisah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL_SONOFF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika sudah diatur, maka pengaturan untuk Sonoff BASICZBR3 akan digunakan, jika tidak untuk devboard.</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> HAL_SONOFF</span>
  <span class="hljs-comment">/* 1 - P0_7  */</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_BV           BV(7)</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_SBIT         P0_7</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_DDR          P0DIR</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_POLARITY     ACTIVE_HIGH</span><font></font>
<font></font>
  <span class="hljs-comment">/* 2 - P1_0  */</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_BV           BV(0)</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_SBIT         P1_0</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_DDR          P1DIR</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_POLARITY     ACTIVE_LOW</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
  <span class="hljs-comment">/* 1 - P1_0  */</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_BV           BV(0)</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_SBIT         P1_0</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_DDR          P1DIR</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED1_POLARITY     ACTIVE_LOW</span><font></font>
<font></font>
  <span class="hljs-comment">/* 2 - P1_1  */</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_BV           BV(1)</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_SBIT         P1_1</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_DDR          P1DIR</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LED2_POLARITY     ACTIVE_LOW</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter penting lainnya harus diperbaiki - kehadiran kuarsa "menonton", karena </font><font style="vertical-align: inherit;">Di papan Sonoff BASICZBR3 tidak disolder:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment">//#define HAL_CLOCK_CRYSTAL</span>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> OSC32K_CRYSTAL_INSTALLED FALSE</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tanpa opsi ini, firmware tidak memulai (atau lebih tepatnya, tidak selalu). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah itu, kami mengumpulkan firmware dan terhubung ke firmware.</font></font><br>
<blockquote><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PERHATIAN!!! </font><font style="vertical-align: inherit;">Putuskan relai Sonoff BASICZBR3 dari daya AC sebelum koneksi dan firmware apa pun!</font></font></b></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menghubungkan kabel Sonoff BASICZBR3 dengan CCDebugger, menghapus chip dan mem-flash firmware kami.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/bz/w-/3b/bzw-3bib84ucfczt0kg_mmbajtw.jpeg"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11. Kami memulai perangkat di zigbee2mqtt dan ioBroker.Zigbee</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun perangkat kami telah muncul dalam daftar perangkat yang terhubung dan kami dapat mengelolanya dengan mengirim perintah, tetapi kami perlu melakukan ini dengan lebih benar - dengan gambar dan status. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mendapatkan perangkat baru di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioBroker.Zigbee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anda perlu melakukan 2 langkah:</font></font><br>
<br>
<ol>
<li>     <b>zigbee-herdsman-converters</b>.       ,       <b>zigbee2mqtt</b>.<br>
</li>
<li>    <b>ioBroker.Zigbee</b><br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua perubahan dapat dilakukan terlebih dahulu dalam file lokal, dan kemudian dilakukan PR dalam repositori yang sesuai. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menemukan lokasi paket </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zigbee-herdsman-converter</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di ioBroker yang terinstal (atau zigbee2mqtt). Di dalam paket kami menemukan file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devices.js </font></font></i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Koenkk/zigbee-herdsman-converters/blob/master/devices.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> File </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ini berisi deskripsi semua perangkat yang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioBroker.zigbee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zigbee2mqtt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat bekerja </font><b><font style="vertical-align: inherit;">dengan</font></b><font style="vertical-align: inherit;"> . Kami menemukan di dalamnya satu blok deskripsi perangkat DIYRuZ (setelah 2300 baris). Tambahkan deskripsi perangkat baru ke blok ini:</font></font><br>
<br>
<pre><code class="javascript hljs">&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">zigbeeModel</span>: [<span class="hljs-string">'DIYRuZ_RT'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">model</span>: <span class="hljs-string">'DIYRuZ_RT'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">vendor</span>: <span class="hljs-string">'DIYRuZ'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">description</span>: <span class="hljs-string">''</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">supports</span>: <span class="hljs-string">'on/off, temperature'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">fromZigbee</span>: [fz.on_off, fz.temperature],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">toZigbee</span>: [tz.on_off],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam atribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fromZigbee,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kami menentukan konverter yang akan memproses pesan yang berasal dari perangkat. Dua pos kami distandarisasi. Konverter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fz.on_off</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memproses pesan on / off, dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fz.temperature memproses</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data suhu. Kode konverter ini (terletak di file converters / fromZigbee.js) menunjukkan bagaimana pesan masuk diproses dan bahwa suhu dibagi 100.</font></font><br>
<br>
<pre><code class="javascript hljs">   on_off: {
        <span class="hljs-attr">cluster</span>: <span class="hljs-string">'genOnOff'</span>,
        <span class="hljs-attr">type</span>: [<span class="hljs-string">'attributeReport'</span>, <span class="hljs-string">'readResponse'</span>],
        <span class="hljs-attr">convert</span>: <span class="hljs-function">(<span class="hljs-params">model, msg, publish, options, meta</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (msg.data.hasOwnProperty(<span class="hljs-string">'onOff'</span>)) {
                <span class="hljs-keyword">const</span> property = getProperty(<span class="hljs-string">'state'</span>, msg, model);
                <span class="hljs-keyword">return</span> {[property]: msg.data[<span class="hljs-string">'onOff'</span>] === <span class="hljs-number">1</span> ? <span class="hljs-string">'ON'</span> : <span class="hljs-string">'OFF'</span>};<font></font>
            }<font></font>
        },<font></font>
    },<font></font>
</code></pre><br>
<pre><code class="javascript hljs"> temperature: {
        <span class="hljs-attr">cluster</span>: <span class="hljs-string">'msTemperatureMeasurement'</span>,
        <span class="hljs-attr">type</span>: [<span class="hljs-string">'attributeReport'</span>, <span class="hljs-string">'readResponse'</span>],
        <span class="hljs-attr">convert</span>: <span class="hljs-function">(<span class="hljs-params">model, msg, publish, options, meta</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> temperature = <span class="hljs-built_in">parseFloat</span>(msg.data[<span class="hljs-string">'measuredValue'</span>]) / <span class="hljs-number">100.0</span>;
            <span class="hljs-keyword">return</span> {<span class="hljs-attr">temperature</span>: calibrateAndPrecisionRoundOptions(temperature, options, <span class="hljs-string">'temperature'</span>)};<font></font>
        },<font></font>
    },<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam atribut </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toZigbee</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><b><font style="vertical-align: inherit;">kami</font></b><font style="vertical-align: inherit;"> menentukan konverter yang akan memproses perintah kami ke perangkat. </font><font style="vertical-align: inherit;">Dalam kasus kami, ini adalah konverter </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tz.on_off</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk mengalihkan relay. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya ditambahkan ke "konverter". </font><font style="vertical-align: inherit;">Siapa yang menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zigbee2mqtt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Anda sudah bisa menggunakannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan pengguna ioBroker masih menambahkan deskripsi perangkat ke file </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioBroker.zigbee \ lib \ devices.js</font></font></i><br>
<br>
<pre><code class="javascript hljs">&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">vendor</span>: <span class="hljs-string">'DIYRuZ'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">models</span>: [<span class="hljs-string">'DIYRuZ_RT'</span>],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">icon</span>: <span class="hljs-string">'img/DIYRuZ.png'</span>,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">states</span>: [<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;states.state,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;states.temperature,<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;},<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini cukup untuk menunjukkan model yang persis sama, file dengan gambar dan daftar status. </font><font style="vertical-align: inherit;">Dalam kasus kami, status juga standar: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">status</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk kondisi relai, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suhu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menampilkan nilai suhu.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/oz/fu/zm/ozfuzmz72p-e1lwweegnd4fv74q.png"><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12. Apa selanjutnya?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, saya tidak dapat menemukan semua aspek dan fitur yang disediakan Z-Stack 3.0. </font><font style="vertical-align: inherit;">Kemungkinan besar saya bahkan tidak mengimplementasikan dengan benar beberapa jenis fungsionalitas atau mekanisme bawaan yang dapat digunakan untuk mengimplementasikannya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, solusi di atas dapat ditingkatkan dan dikembangkan. </font><font style="vertical-align: inherit;">Berikut ini beberapa arahan:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak dapat dengan cepat menemukan solusi untuk kemungkinan menghubungkan perangkat anak melalui relay. </font><font style="vertical-align: inherit;">Perangkat router lain dapat menjalankan perintah permit_join dan menghubungkan perangkat baru melalui diri mereka sendiri, tanpa harus membawa perangkat baru ke koordinator. </font><font style="vertical-align: inherit;">Perangkat ini diwakili oleh router, ditampilkan dengan benar di peta jaringan, tetapi menolak untuk mengeksekusi perintah ‚Äúpermit_join‚Äù. </font><font style="vertical-align: inherit;">Lebih tepatnya, perintah dijalankan, tetapi perangkat tidak terhubung melalui itu.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Juga, tidak menerapkan pelaporan yang benar. </font><font style="vertical-align: inherit;">Ini adalah cara untuk mengkonfigurasi pemberitahuan status ketika Anda dapat menggunakan perintah configReport untuk menentukan daftar atribut yang akan dikirim dan frekuensi pemberitahuan.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bekerja dengan kelompok.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menangani interupsi dan mengimplementasikan tombol polling melalui interupsi.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, untuk perangkat berikut ini, Anda perlu berurusan dengan mode daya dan pembuatan "tidur" perangkat pada baterai.</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti biasa, selain komentar, saya mengundang Anda untuk mendiskusikan hal ini dan perangkat lain dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">obrolan Telegram di Zigbee</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya ingin mengucapkan terima kasih atas dukungan dan bantuannya dalam pengembangan kolega saya dalam obrolan Telegram dan komunitas Zigbee:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/DJONvl</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/antstar</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t.me/Jager_f</font></font></a></li>
</ul><br>
</blockquote><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referensi</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dokumentasi utama termasuk dalam Z-Stack 3.0.2 SDK dan diinstal dengannya. </font><font style="vertical-align: inherit;">Tetapi saya akan memberikan bagian dari tautan di sini:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OSAL dan HAL </font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TI ZIgbee Wiki</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Create New Application For SmartRF05 + CC2530 SWRA231 Version 1.1</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Stack Home Sample Application User's Guide SWRU354 Version 1.3</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Stack Sample Applications SWRA201 Version 1.6</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Stack Developer's Guide SWRA176 Version 1.12</a>&nbsp;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Stack 3.0 Developer's Guide Version 1.14</a>&nbsp;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Stack API SWRA195 Version 1.10</a>&nbsp;</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">TI CC253x User's Guide</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/formtapez/ZigUP</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zigbee Cluster Library rev 6</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   DIYRuZ_RT</a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id495910/index.html">Menginstal ROS dalam Gambar IMG Ubuntu Papan Tunggal</a></li>
<li><a href="../id495912/index.html">Stiker replay cerdas</a></li>
<li><a href="../id495918/index.html">Bagaimana cara mereproduksi suara realistis dalam permainan komputer dan VR dan mengapa itu sulit</a></li>
<li><a href="../id495920/index.html">Detail Implementasi Protokol Sinkronisasi Waktu PTPv2</a></li>
<li><a href="../id495924/index.html">Mengapa sangat sulit untuk membangun model distribusi COVID-19 yang bagus?</a></li>
<li><a href="../id495932/index.html">Apa arti tersembunyi dari penulis dalam Panduan SCRUM. Bagian 1. Tentang proses</a></li>
<li><a href="../id495934/index.html">DataGelola di rumah</a></li>
<li><a href="../id495938/index.html">Pilihan artikel tentang pembelajaran mesin: kasus, panduan dan studi untuk Maret 2020</a></li>
<li><a href="../id495942/index.html">Hemat waktu, saraf dan jam kerja</a></li>
<li><a href="../id495944/index.html">TOP50 yang diperbarui (peringkat superkomputer CIS): dinamika dan tren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>