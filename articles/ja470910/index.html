<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🅱️ 👘 👨🏼‍🎤 マイクロサービスコントラクトのアノテーションで何ができますか？ 🦍 🧔🏿 👃🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前回の投稿では、Acronisでマイクロサービスに注釈を付ける方法と理由について説明し、Acronisサイバープラットフォーム全体で単一のAPI形式を使用するという慣行を共有することを約束しました。今日は、静的アノテーションチェックの経験について説明します。これは、会社にアノテーションを導入するため...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>マイクロサービスコントラクトのアノテーションで何ができますか？</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/470910/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前回の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">投稿で</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、Acronisでマイクロサービスに注釈を付ける方法と理由について説明し、Acronisサイバープラットフォーム全体で単一のAPI形式を使用するという慣行を共有することを約束しました。</font><font style="vertical-align: inherit;">今日は、静的アノテーションチェックの経験について説明します。これは、会社にアノテーションを導入するための最初のステップです。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/hm/0k/un/hm0kunnfzs9fvcgleqiyumvqny8.jpeg"></a><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
したがって、すべてまたはほとんどのAPIの注釈がすでにあるとします。同僚も私たちに尋ねた合理的な質問：「これらの魔法のオブジェクトで何ができるのですか？」</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
実際、注釈によって直接実行できるチェックには2つのタイプがあります。静的チェックは、SwaggerまたはRAMLアノテーションのテキストに直接行きます。それらは他に何も必要とせず、正式なマイクロサービス契約を使用する最初の利点と考えることができます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
動的チェックは、サービスが機能している場合にのみ開始できます。これらを使用すると、より深く掘り下げてアノテーションの有効性を確認したり、サービスの安定性をテストしたり、さらに多くのことができるため、多少複雑になります。しかし、これは次の投稿のトピックであり、今日は静力学に焦点を当てます。</font></font><br>
<br>
<h3>  API Guideline!</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
自分自身や他の人を混乱させないために、静的なアノテーションチェックが作成され、企業の要件とAPIアノテーション（できればAPI自体）の適合性を制御するように作成されていることをすぐに言及する価値があります。これは、会社が採用した単なる慣例でも、サービス用のAPIを準備するためのルールを形式化した本格的なガイドラインAPIでもかまいません。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/084/f24/61b/084f2461b8fa9d944fbcf83ce4618ab7.jpg" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
マイクロサービスのカラフルな世界について話すとき、各チームは独自のフレームワーク、独自のプログラミング言語、独自のスタック、またはいくつかの特別なライブラリを持つことができるため、これは非常に重要です。マイクロサービス固有のプラクティスの影響下で、外部オブザーバーのAPIのプレゼンテーションが変更されています。これは不必要な多様性を生み出します。エコシステム（またはプラットフォーム）の要素の効果的な相互作用のためには、APIを可能な限り「調整」する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次に例を示します。1つのコンポーネントのAPIでは、リソースが存在しない場合にのみ404コードが返されます。</font><font style="vertical-align: inherit;">そして、他のチームはこのエラーをアプリケーションロジックにバインドし、ユーザーが倉庫で終了した製品を購入しようとすると、APIは404を返します。</font><font style="vertical-align: inherit;">私はそのような問題を非常によく説明しました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atygaev</font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">こちら</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">この404コードの理解の不一致により、開発が遅くなり、エラーが発生します。つまり、サポートの不必要な呼び出しや余分なデバッグ時間が必要になりますが、いずれにせよ、問題は金銭的に測定されます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
会社が採用した構文と命名の詳細は、REST自体に固有のさまざまな側面によって補足されます。</font><font style="vertical-align: inherit;">開発者は次のような質問に答える必要があります。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POSTはべき等になるか？</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用しているエラーコードとその意味を教えてください。</font></font></li>
<li>      -?</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、各チームがこれらの答えについて個別に困惑する必要があると想像してください。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
検索クエリの形式も完全に異なる場合があります。たとえば、サンプルを作成する方法は約12通りあり、MacBookProを使用していてウイルス攻撃が頻繁に発生しているユーザーだけがリストされます。数十のマイクロサービスで構成される大規模なプロジェクトで作業する場合、検索クエリの構文が会社のすべてのバージョンと製品に共通である必要があります。そして、開発の製品/サービスの1つに連絡することに慣れている人は、同じ要求と応答の構造を別の人に見つけることを期待しています。そうでなければ、驚き（そして悲しみ）は避けられません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの企業、特に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PayPal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">Google</font></a><font style="vertical-align: inherit;">などの巨人</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、独自のガイドラインがあり、非常によく考えられています。しかし、他の人のガイドラインを使用することは常に可能であるとは限りません。それらは会社の詳細に大きく関係しているからです。さらに、皆の考え方は異なり、ルールが異なるのは、人々がこの方法で作業する方が便利であり、そうでない場合はそうでないからです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アクロニスが独自のAPIガイドラインを必要とするという理解はすぐには現れませんでしたが、開発者、マイクロサービス、そして実際には外部のクライアントと統合の数が増加しています。ある時点で、アーキテクトのチームは、前述のITの巨人の経験と、開発チームですでに確立されたデファクトプラクティスの両方を考慮して、APIを宣言するための統一ルールを確立する必要がありました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この最新のガイドラインAPIの実装に伴う問題の1つは、要件を満たしていない既存の公開済みAPIであり、これにより、インターフェースの再設計と下位互換性の維持に追加コストがかかります。したがって、ビジネスモデルにAPIの将来の統合と公開が含まれる場合は、統一されたルールをできるだけ早く検討する必要があります。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/yf/gz/qtyfgz3v0rojzm0dubyojcwl6hw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、ガイドラインAPIを採用しても、すべてのAPIが自動的に構成的なものになるわけではありません。すべてのAPIを分析する必要があり、すべての開発者は新しい要件を理解する必要がありました。したがって、開発したガイドラインAPIに対してRAMLチェックを自動化しました。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
静的分析</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
まず、静的に分析する対象を決定する必要があります。</font><font style="vertical-align: inherit;">ガイドラインAPIのすべてのポイントを形式化できるわけではないため、最初に、APIアノテーションから簡単に理解できる一連のルールを強調表示する必要があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最初のバージョンでは、次のルールを識別しました。</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APIの説明を確認してください。</font><font style="vertical-align: inherit;">前の記事で述べたように、APIアノテーションに基づいて美しいドキュメントを作成できます。</font><font style="vertical-align: inherit;">つまり、各リソース、クエリパラメータ、レスポンスには、APIのユーザーに必要なすべての情報を提供する説明が必要です。</font><font style="vertical-align: inherit;">ささいなことのように思えますが、注釈に説明が豊富でないことを開発者に示すのは簡単です。</font></font></li>
<li>    .     API    . ,  response       , -   .   ,  endpoint              .</li>
<li>   HTTP-.  HTTP    ,      .     .           HTTP. ,  201,   HTTP,    .  GET,  201,   (   ,  GET  ).   API Guideline   .  ,        ,           .</li>
<li>  HTTP.   ,   HTTP    (GET, POST, PUT  ..),       .  API Guideline   , ,   (OPTIONS),     (     ).      HEAD,     .         .</li>
<li>  . ,   2019        .       ,    API    API    .      ,    ,        ,        . </li>
<li>  .          .    “” –   CamelCase  snake_case.Camelcase –       ,  snake_case –          .       -. ,  Python  snake_case,   Go  Java — CamelCase.             API Guideline.          ;</li>
<li>   .      ,     .    Acronis     X-Custom-Header-Name(  ,     ).        .</li>
<li>  HTTPS.      HTTPS,   ,       HTTP –   .    RAML  Swagger   .    HTTPS  HTTP. </li>
<li>  URI.   ,     API Guideline, URI       : - /api/2, - /api/service_name/v2   .         URI    API.  ,    ,    .</li>
<li>   .   ,        API —  .  ,   ,     API,    .         :     .  ,    ,    -  “”,      API    ,           –        . ,  ,   ,    , ,      . ,     HTTP REST    . ,  (, ,  )   ,        .        . </li>
</ol><br>
<br>
<i><img src="https://habrastorage.org/webt/kt/vo/wc/ktvowckxsyc4hujr2owbwmvy2qe.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
説明がない</font></font><br>
<img src="https://habrastorage.org/webt/po/dv/k6/podvk6eqjgnydciv-jzbbw7-nm4.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
場合</font><font style="vertical-align: inherit;">説明がある</font><font style="vertical-align: inherit;">場合</font></font><br>
</i><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">調査結果</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アノテーションの静的分析は、サービスの品質ではなく、APIの品質をチェックするために必要です。</font><font style="vertical-align: inherit;">この段階では、プログラミングインターフェイスを相互に関連づけることができるため、すべてが非常に予測可能な明確で理解可能な環境で作業できます。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もちろん、十分に大規模な企業でこのような形式に対処することだけが必要です。すべての通信を「手動で」チェックすることは非常に長く、費用がかかり、信頼できません。</font><font style="vertical-align: inherit;">小さなスタートアップはそれを必要としません。</font><font style="vertical-align: inherit;">少なくとも当面は。</font><font style="vertical-align: inherit;">しかし、将来的にAkronisのようなユニコーンになる計画がある場合は、静的チェックとガイドラインAPIが役立ちます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja470892/index.html">FPGA上の小さなCAMのシンプルな実装</a></li>
<li><a href="../ja470894/index.html">弾丸</a></li>
<li><a href="../ja470902/index.html">高性能でネイティブなパーティション分割：TimescaleDBをサポートするZabbix</a></li>
<li><a href="../ja470904/index.html">機械学習とディープニューラルネットワークで最も柔らかく、毛皮で覆われた道</a></li>
<li><a href="../ja470908/index.html">付加技術の助けを借りて世界で初めて、大型航空機エンジンアセンブリが入手されました</a></li>
<li><a href="../ja470916/index.html">スマートフォンから制御されるロシアの「最も安い」電子チェックポイント</a></li>
<li><a href="../ja470918/index.html">F＃9：タイプオプション</a></li>
<li><a href="../ja470920/index.html">DataLine Cloudに接続する5つ以上の方法</a></li>
<li><a href="../ja470922/index.html">ハリコフでのmitap ThinkJava＃10の発表</a></li>
<li><a href="../ja470924/index.html">新しいプロジェクトでRobot Frameworkを採用した理由</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>