<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå≠ üë®üèø‚Äçüç≥ üëåüèΩ Using RabbitMQ with MonsterMQ Part 2 ü•© üñêÔ∏è üèØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(Image taken from the official RabbitMQ website )
 
 In the first article, we wrote two PHP programs that use RabbitMQ: one sent messages, the other r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Using RabbitMQ with MonsterMQ Part 2</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/489022/"><img src="https://habrastorage.org/getpro/habr/post_images/640/66e/579/64066e579d113ef3373c9a3c2c3e75ce.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Image taken from the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official RabbitMQ website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
In the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">first article,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we wrote two PHP programs that use RabbitMQ: one sent messages, the other received. </font><font style="vertical-align: inherit;">In this article, we will look at how to create a queue that will distribute tasks that consume a significant amount of time among many workers (message handlers).</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The main idea is not to complete tasks that consume a significant amount of time immediately, but to add them to the queue in the form of a message. </font><font style="vertical-align: inherit;">Later, the working worker receives a message from the queue, which he consumes and performs the task as if in the background. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This concept is very relevant for web applications, where, for example, you may need to perform some time-consuming tasks, the result of which is not immediately required, for example, sending email or making an HTTP request to a third-party application (for example, via libcurl to PHP).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cooking</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this part, we will send messages that will represent tasks for workers. Since we do not have real tasks, like processing images or generating pdf files, we will pretend that we are busy using the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sleep ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">. We will take the number of points in the message as the complexity of the task. Each dot will mean one second of work, for example, the message </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hello ...</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will take three seconds of work. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We will slightly </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">modify</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our </font><b><font style="vertical-align: inherit;">send.php</font></b><font style="vertical-align: inherit;"> script </font><font style="vertical-align: inherit;">from the last lesson so that it can send arbitrary messages.</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $producer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
<font></font>
   $message = implode(<span class="hljs-string">' '</span>, array_slice($argv, <span class="hljs-number">1</span>));<font></font>
   $message = <span class="hljs-keyword">empty</span>($message) ? <span class="hljs-string">'Hello world!'</span> : $message;<font></font>
<font></font>
   $producer-&gt;publish($message, <span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Sent {$message} \n"</span>;<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Our </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">receive.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script </font><font style="vertical-align: inherit;">also needs to be changed. </font><font style="vertical-align: inherit;">It should simulate operation for one second for each point in the received message. </font><font style="vertical-align: inherit;">Let's rename the file to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and write the following code in it:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'test-queue'</span>)-&gt;declare();<font></font>
<font></font>
   $consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $consumer-&gt;wait(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$message, $channelNumber</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$consumer</span>)</span>{
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Received: {$message}"</span>;<font></font>
      sleep(substr_count($message, <span class="hljs-string">'.'</span>));
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Done"</span>;<font></font>
   });<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, run both scripts in different terminals:</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 1</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 2</span>
php send.php <span class="hljs-string">"A very hard task which takes two seconds.."</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
One of the advantages of using task queues is the ability to distribute work among many workers. </font><font style="vertical-align: inherit;">Let's try to run two </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> scripts at </font><b><font style="vertical-align: inherit;">once</font></b><font style="vertical-align: inherit;"> in two different terminals. </font><font style="vertical-align: inherit;">And in the third we will send messages with the </font><b><font style="vertical-align: inherit;">send.php</font></b><font style="vertical-align: inherit;"> script</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 1</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="bash hljs"><span class="hljs-comment"># Shell 2</span><font></font>
php worker.php <font></font>
</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment"># Shell 3</span><font></font>
php new_task.php First message.<font></font>
php new_task.php Second message..<font></font>
php new_task.php Third message...<font></font>
php new_task.php Fourth message....<font></font>
php new_task.php Fifth message.....<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Next, let's see what our workers brought out:</font></font><br>
<pre><code class="php hljs"><span class="hljs-comment"># shell 1</span><font></font>
php worker.php<font></font>
<span class="hljs-comment"># Received: First message.</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Third message...</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Fifth message.....</span>
<span class="hljs-comment"># Done</span>
</code></pre><br>
<pre><code class="php hljs"><span class="hljs-comment"># shell 2</span><font></font>
php worker.php<font></font>
<span class="hljs-comment"># Received: Second message..</span>
<span class="hljs-comment"># Done</span>
<span class="hljs-comment"># Received: Fourth message....</span>
<span class="hljs-comment"># Done</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
By default, RabbitMQ will send each subsequent message to the next consuming recipient in turn. </font><font style="vertical-align: inherit;">On average, each recipient will receive the same number of messages, this method of distributing messages is called round-robin (in a circle). </font><font style="vertical-align: inherit;">Try this with three or more workers.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Message confirmation</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tasks can take a certain amount of time. </font><font style="vertical-align: inherit;">Perhaps you are interested in what will happen to the message if you finish the work of the recipient who did not manage to process this message to the end. </font><font style="vertical-align: inherit;">With our current code, the message will be returned to the queue, since message acknowledgment is enabled by default in MonsterMQ.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When we use message confirmation, we tell RabbitMQ that the message has been processed and he has the right to remove it from the queue. If the recipient completed his work without sending confirmation (for example, as a result of an unexpected termination of the TCP connection), RabbitMQ will understand that the message was not processed and will return it to the queue, trying to deliver it to other available workers. Thus, you can be sure that messages will not be lost, even in the event of an unexpected shutdown of any of the workers. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To disable message acknowledgment in MonsterMQ, you can pass </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as the second argument to </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consume ()</font></font></b><br>
<br>
<pre><code class="php hljs">$consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>, <span class="hljs-literal">true</span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Forgetting the confirmation of received messages is a fairly common, easily tolerated error, which can lead to serious consequences. </font><font style="vertical-align: inherit;">If this happens, messages will be delivered again and again and will also accumulate in the queues taking up more and more memory. </font><font style="vertical-align: inherit;">To debug this error, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rabbitmqctl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to display the </font><b><font style="vertical-align: inherit;">messages_unacknowledged</font></b><font style="vertical-align: inherit;"> field</font></font><b><font style="vertical-align: inherit;"></font></b><br>
<br>
<pre><code class="bash hljs">sudo rabbitmqctl list_queues name messages_ready messages_unacknowledged</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On windows, drop sudo</font></font><br>
<br>
<pre><code class="bash hljs">rabbitmqctl.bat list_queues name messages_ready messages_unacknowledged</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Queue Security</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despite the fact that our messages will not be lost if any of the workers unexpectedly terminates their work, nevertheless, we can still lose the created queues if RabbitMQ is shut down. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To protect yourself from losing queues, you need to declare the queue as </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durable</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (persistent, durable). </font><font style="vertical-align: inherit;">Since the queues are idempotent, that is, we cannot change or recreate it by calling the declaration method with the same name, we will have to declare a new queue. </font><font style="vertical-align: inherit;">Let's do it as follows</font></font><br>
<br>
<pre><code class="php hljs">$consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remember to change the queue announcement code in the sender code as well.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fair distribution of messages</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
You may have noticed that messages between our two workers are still not distributed fairly honestly. If, for example, every even message is time-consuming, and every odd message is processed quickly, then one worker receiving time-consuming messages will always be busy, while the second will be idle. To avoid this, you can use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quality of service</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Let's add the following line to our code</font></font><br>
<br>
<pre><code class="php hljs">$consumer-&gt;qos()-&gt;prefetchCount(<span class="hljs-number">1</span>)-&gt;perConsumer()-&gt;apply();</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This line tells RabbitMQ not to send messages to the recipient until it processes and acknowledges the current message. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perConsumer ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> applies quality of service to all channels of the recipient, use the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perChannel ()</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">if you want to apply quality of service only to the current channel. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/270/e31/4b5/270e314b59a085e186e46b28e2593613.png" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Image taken from </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RabbitMQ official site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Putting the whole code together</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
This will look like our </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">send.php</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (sender)</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $producer = \MonsterMQ\Client\Producer();<font></font>
<font></font>
   $producer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $producer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();<font></font>
<font></font>
   $message = implode(<span class="hljs-string">' '</span>, array_slice($argv, <span class="hljs-number">1</span>));<font></font>
   $message = <span class="hljs-keyword">empty</span>($message) ? <span class="hljs-string">'Hello world!'</span> : $message;<font></font>
<font></font>
   $producer-&gt;publish($message, <span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Sent {$message} \n"</span>;<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
And so the recipient </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">worker.php</font></font></b><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">try</span> {<font></font>
   $consumer = \MonsterMQ\Client\Consumer();<font></font>
<font></font>
   $consumer-&gt;connect(<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">5672</span>);<font></font>
   $consumer-&gt;logIn(<span class="hljs-string">'guest'</span>, <span class="hljs-string">'guest'</span>);<font></font>
<font></font>
   $consumer-&gt;queue(<span class="hljs-string">'new-queue'</span>)-&gt;setDurable()-&gt;declare();<font></font>
<font></font>
   $consumer-&gt;qos()-&gt;prefetchCount(<span class="hljs-number">1</span>)-&gt;perConsumer()-&gt;apply();<font></font>
<font></font>
   $consumer-&gt;consume(<span class="hljs-string">'test-queue'</span>);<font></font>
<font></font>
   $consumer-&gt;wait(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$message, $channelNumber</span>) <span class="hljs-title">use</span> (<span class="hljs-params">$consumer</span>)</span>{
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Received: {$message}"</span>;<font></font>
      sleep(substr_count($message, <span class="hljs-string">'.'</span>));
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"\n Done"</span>;<font></font>
   });<font></font>
} <span class="hljs-keyword">catch</span>(\<span class="hljs-built_in">Exception</span> $e) {<font></font>
   var_dump($e);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
That's all, in the next lesson we will learn how to send messages to many recipients from the same queue.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en489010/index.html">We share the largest in Russia layer of data on online training with projects in linguistics, personalization, peddesign, ML</a></li>
<li><a href="../en489012/index.html">Google Cloud Spanner: good, bad, evil</a></li>
<li><a href="../en489014/index.html">The book ‚ÄúPerfect Algorithm. Greedy Algorithms and Dynamic Programming ¬ª</a></li>
<li><a href="../en489016/index.html">German Gref: ‚ÄúWe tried to organize a discussion about the AGI, and not a single self-respecting scientist came to it‚Äù</a></li>
<li><a href="../en489020/index.html">The study of one malicious</a></li>
<li><a href="../en489024/index.html">Webix JavaScript library through the eyes of a beginner. Part 5. Work with data on the user side</a></li>
<li><a href="../en489026/index.html">Changing Google AdSense Algorithms May Lead to Site Owners and Webmasters</a></li>
<li><a href="../en489028/index.html">About remote work</a></li>
<li><a href="../en489034/index.html">The new UIS mobile app - torment or salvation for those seeking public procurement?</a></li>
<li><a href="../en489038/index.html">The book "Java Concurrency in Practice"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>