<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫ ‚öõÔ∏è üßëüèæ‚Äçü§ù‚Äçüßëüèæ Sequential fetch and 5 ways to solve üë®üèº‚Äçüé® üë®‚Äçüë®‚Äçüë¶ ü§Ωüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At technical interviews, in addition to checking theoretical knowledge, it is customary to set tasks to assess the level of practical knowledge of the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Sequential fetch and 5 ways to solve</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/490524/"><p><img src="https://habrastorage.org/webt/pc/kl/kx/pcklkx93vt-uz0vgvco63wft12w.gif"></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At technical interviews, in addition to checking theoretical knowledge, it is customary to set tasks to assess the level of practical knowledge of the candidate, his ability to write code, and the ability to think logically and algorithmically. </font><font style="vertical-align: inherit;">Often, this list includes algorithmic problems. </font><font style="vertical-align: inherit;">Everyone has become accustomed to them and, when preparing, first of all, they look at them.</font></font><a name="habracut"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The list is long, but the main thing that is most often found looks something like this: </font></font></p><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">factorial</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fibonacci numbers</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniqueness of array elements</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checking for parentheses within the text</font></font></li>
<li> (mergeSort, insertionSort, bubbleSort, quickSort)</li>
<li> (   /    /     )</li>
</ul><br>
<p>   ,   70   JavaScript,   ,      ,       ,         (   ,   ).</p><br>
<p>  ,     :</p><br>
<ul>
<li>   </li>
<li>   </li>
<li>     </li>
<li>  </li>
<li>      </li>
</ul><br>
<p> ,   ,         . </p><br>
<p>    :</p><br>
<blockquote>,           :<br>
<ol>
<li>   </li>
<li>          </li>
<li>   </li>
</ol><br>
<br>
     :<br>
<em>fetch(url1) =&gt; fetch(url2, resultsUrl1) =&gt; fetch(url3, resultsUrl2)</em><br>
<br>
 - <br>
compose(res2 =&gt; fetch(url3, res2), res1 =&gt; fetch(url2, res1), () =&gt; fetch(url1)) <br>
<br>
      ?</blockquote><p>          ,     (    ):</p><br>
<ul>
<li></li>
<li>async/await</li>
<li></li>
</ul><br>
<p>   ,     ,    (    <code>reduce</code>,    ).</p><br>
<p>     ,   ;   ,    -   ;   ;           .</p><br>
<p>       ,         .         .    ,          ,    ,     .</p><br>
<p>        ,            reduce ,   <code>Array</code>.        :</p><br>
<ul>
<li> </li>
<li> reduce</li>
</ul><br>
<p> ,     fetch ,      :</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeFetch</span> (<span class="hljs-params">url, params=<span class="hljs-string">'-'</span></span>) </span>{
    <span class="hljs-comment">//           </span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`fakeFetch to: <span class="hljs-subst">${url}</span> with params: <span class="hljs-subst">${params}</span>`</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {<font></font>
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">`<span class="hljs-subst">${url}</span> is DONE`</span>), <span class="hljs-number">1000</span>);<font></font>
    })<font></font>
};</code></pre><br>
<p>     ( ):</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> urls = [<span class="hljs-string">'url1'</span>, <span class="hljs-string">'url2'</span>, <span class="hljs-string">'url3'</span>];</code></pre><br>
<p>         (  1), .   <code>then().then().then()</code>  <code>await; await; await;</code>  .</p><br>
<p> ,     callback.          :</p><br>
<pre><code class="javascript hljs">fetchSeries(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`result: <span class="hljs-subst">${result}</span>`</span>))</code></pre><br>
<p>      ,      .        ,    ,       .</p><br>
<h4 id="generatory"></h4><br>
<p>   ,       ,      . ,       ,     ,   . </p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generatorWay</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">generateSequence</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">let</span> results;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; urls.length; i++) {<font></font>
            results = <span class="hljs-keyword">yield</span> fakeFetch(urls[i], results);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> results;<font></font>
    }<font></font>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">generator, yieldValue</span>) </span>{
        <span class="hljs-keyword">let</span> next = generator.next(yieldValue);
        <span class="hljs-keyword">if</span> (!next.done) {  
            <span class="hljs-keyword">return</span> next.value<font></font>
                .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> execute(generator, result));<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            callback(next.value);<font></font>
        }<font></font>
    }<font></font>
    execute(generateSequence())<font></font>
}</code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a></p><br>
<p>  :</p><br>
<ul>
<li> generateSequence <code>yield'</code>   ,  .</li>
<li>   <code>execute(generator)</code>,      <code>next</code>,     ‚Äî   , ,    ,       <code>next</code>.</li>
<li>   <code>execute</code>     ,  callback.</li>
</ul><br>
<h4 id="asinhronnye-generatory"> </h4><br>
<p>     ,         while:</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncGeneratorWay</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">generateSequence</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">let</span> results;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; urls.length; i++) {<font></font>
            results = <span class="hljs-keyword">yield</span> <span class="hljs-keyword">await</span> fakeFetch(urls[i], results);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> results;<font></font>
    }<font></font>
    <span class="hljs-keyword">let</span> generator = generateSequence();
    <span class="hljs-keyword">let</span> result;
    <span class="hljs-keyword">while</span> (!result || !result.done) {<font></font>
        result = <span class="hljs-keyword">await</span> generator.next(result &amp;&amp; result.value);<font></font>
    }<font></font>
    callback(result.value);<font></font>
}</code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a></p><br>
<p>          (    ).</p><br>
<p>    <code>for await of</code>  ,       2.</p><br>
<h4 id="asyncawait">Async/await</h4><br>
<p>   .   ,       async/await.  ,       async,      .</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncAwaitWay</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-keyword">const</span> series = <span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">let</span> results;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; urls.length; i++) {  <font></font>
            results = <span class="hljs-keyword">await</span> fakeFetch(urls[i], results);<font></font>
        }<font></font>
        <span class="hljs-keyword">return</span> results;<font></font>
    }<font></font>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> series();<font></font>
    callback(result);<font></font>
}</code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a></p><br>
<p>       <code>fakeFetch</code>       <code>await</code>;</p><br>
<h4 id="recursion">Recursion</h4><br>
<p> ,    reduce (     ),        <code>recursion</code>  .      .   ,     :</p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursionWay</span>(<span class="hljs-params">callback</span>) </span>{  
    <span class="hljs-keyword">const</span> recursion = <span class="hljs-function">(<span class="hljs-params">arr = [], promise = <span class="hljs-built_in">Promise</span>.resolve(</span>)) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!arr.length) { 
            <span class="hljs-keyword">return</span> promise;<font></font>
        }<font></font>
        <span class="hljs-keyword">const</span> [url, ...restUrls] = arr;
        <span class="hljs-keyword">return</span> promise<font></font>
            .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> recursion(restUrls, fakeFetch(url, res)));<font></font>
    }<font></font>
    recursion(urls)<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> callback(result));<font></font>
}</code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a></p><br>
<p>       shift  ,       .        .</p><br>
<p>Promise.resolve(),    -,    ,       ,    .</p><br>
<h4 id="reduce">Reduce</h4><br>
<p> ,   ,       . ,        ,             . </p><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reduceWay</span>(<span class="hljs-params">callback</span>) </span>{<font></font>
    urls<font></font>
        .reduce(<span class="hljs-function">(<span class="hljs-params">accum, item</span>) =&gt;</span> {
            <span class="hljs-keyword">return</span> accum<font></font>
                .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> fakeFetch(item, res))<font></font>
        }, <span class="hljs-built_in">Promise</span>.resolve())<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> callback(result));<font></font>
}</code></pre><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow">  </a></p><br>
<p>  : </p><br>
<ul>
<li>  </li>
<li>    fakeFetch   then;</li>
<li>      , Promise.resolve(),    -,    ,   (Promise)    ,    .     :</li>
</ul><br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reduceWay</span>(<span class="hljs-params">callback</span>) </span>{<font></font>
    urls<font></font>
        .reduce(<span class="hljs-function">(<span class="hljs-params">accum, item</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (!accum) {
                <span class="hljs-keyword">return</span> fakeFetch(item);<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> accum<font></font>
                .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> fakeFetch(item, res));<font></font>
        })<font></font>
        .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> callback(result));<font></font>
}</code></pre><br>
<p>    2   .</p><br>
<h4 id="vyvody"></h4><br>
<p>    .  ,     :</p><br>
<div class="scrollable-table"><table>
<thead>
<tr>
<th></th>
<th>. </th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>reduce</td>
<td>6</td>
<td>1</td>
</tr>
<tr>
<td>async/await</td>
<td>9</td>
<td>x1.5</td>
</tr>
<tr>
<td>recursion</td>
<td>10</td>
<td>x1.67</td>
</tr>
<tr>
<td> ()</td>
<td>13</td>
<td>x2.17</td>
</tr>
<tr>
<td></td>
<td>17</td>
<td>x2.83</td>
</tr>
</tbody>
</table></div><br>
<p>    "",    ,    reduce. ,           (  ).   , , :</p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> reduceWay = <span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> urls.reduce(
    <span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> acc.then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> fakeFetch(item, res)),  
    <span class="hljs-built_in">Promise</span>.resolve())<font></font>
    .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> callback(result));  <font></font>
}</code></pre><br>
<h4 id="posleslovie"></h4><br>
<p>,  ,       ,         .</p><br>
<p>           ,   ‚Äî  .   async/await ‚Äî ,          .          reduce /   .</p><br>
<p>       ,    ,     ‚Ä¶    .</p><br>
<h4 id="poleznye-ssylki"> </h4><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generators</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asynchronous Generators</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array: iterate over reduce</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recursion</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Async / await</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promises</font></font></a></p><br>
<p><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promise Chain</font></font></a></p><br>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD I</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> make some adjustments to the async / await method, following the comments. </font><font style="vertical-align: inherit;">Indeed, one could shorten the method and give it greater visibility with </font></font><code>for of</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></p><br>
<pre><code class="javascript hljs"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncAwaitWay</span>(<span class="hljs-params">callback</span>) </span>{
    <span class="hljs-keyword">let</span> results;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> url <span class="hljs-keyword">of</span> urls) {  <font></font>
        results = <span class="hljs-keyword">await</span> fakeFetch(url, results);<font></font>
        }<font></font>
    callback(result);<font></font>
}</code></pre></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en490510/index.html">Companies spend $ 16 billion on drones to capture 8 trillion market</a></li>
<li><a href="../en490512/index.html">(Almost) Auto-generate colors</a></li>
<li><a href="../en490516/index.html">AI exists, but is that not what we thought?</a></li>
<li><a href="../en490518/index.html">An Introduction to the Lena Data Analysis Architectural Framework</a></li>
<li><a href="../en490520/index.html">The origins of mathematics: logical ideas</a></li>
<li><a href="../en490526/index.html">Several Ways to Optimize a React-Redux Application</a></li>
<li><a href="../en490528/index.html">7 free courses for data professionals (DS and DE)</a></li>
<li><a href="../en490530/index.html">DNS-over-HTTPS and the risks to personal data - discuss expert opinions</a></li>
<li><a href="../en490532/index.html">Technologies for Computing: From Call-Only Phones to the Cloud and Linux Supercomputers</a></li>
<li><a href="../en490534/index.html">Fuzzy induction method and its application for modeling knowledge and information systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>