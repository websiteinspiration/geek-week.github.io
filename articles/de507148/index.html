<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍗 👈🏿 🐈 Senden Sie magische Links mit Node.js. 👞 🤟🏿 🙎🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor dem Start des Node.js Developer- Kurses wurde eine Übersetzung des Artikels erstellt .
 
 
 Die beliebteste Methode zur Eingabe der Anwendung ist ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Senden Sie magische Links mit Node.js.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/507148/"><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vor dem Start des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node.js Developer-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kurses wurde eine Übersetzung des Artikels erstellt </font><font style="vertical-align: inherit;">.</font></font></b></i><br>
<br>
<hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Die beliebteste Methode zur Eingabe der Anwendung ist die Angabe eines Benutzernamens und eines Kennworts. Benutzer können jedoch bestimmte Nachteile feststellen. </font><font style="vertical-align: inherit;">Obwohl es viele Passwortmanager gibt, braucht ihre Verwendung Zeit. </font><font style="vertical-align: inherit;">Nicht viel, aber trotzdem. </font><font style="vertical-align: inherit;">Einige Anwendungen fördern eine komplexe und damit enttäuschende Kennwortrichtlinie, sodass es schwierig sein kann, ein neues Kennwort zu erstellen. </font><font style="vertical-align: inherit;">Ein passwortloses System kann eine gute Alternative zur herkömmlichen Authentifizierung durch Login und Passwort sein. </font><font style="vertical-align: inherit;">Es wird von Slack und FramerX verwendet und es sieht so aus, als würde ein magischer Link an den Benutzer gesendet, um eine solche Authentifizierung in der Anwendung zu aktivieren. </font><font style="vertical-align: inherit;">Ein passwortloses System funktioniert wie folgt:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Benutzer besucht die Anwendung, in der ein Formular zur Eingabe einer E-Mail-Adresse vorhanden ist.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Benutzer gibt eine E-Mail-Adresse ein und drückt die Bestätigungstaste.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein magischer Link zum Betreten des Systems wird an die E-Mail-Adresse des Benutzers gesendet.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Benutzer klickt auf den Link und wird zu der Anwendung weitergeleitet, in der er sich bereits angemeldet hat.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach ist der magische Link nicht mehr gültig. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Folgenden werden einige wichtige Punkte für die Implementierung der kennwortlosen Autorisierung auf Node.js erläutert.</font></font><a name="habracut"></a><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lassen Sie uns eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Express-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anwendung </font><font style="vertical-align: inherit;">erstellen</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Zuerst müssen wir eine einfache Express-Anwendung erstellen und einige Endpunkte hinzufügen. </font><font style="vertical-align: inherit;">Der folgende Code ist verantwortlich für die Einrichtung eines Express-Servers mit Helfern zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parsen eingehender Anforderungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmelden</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und zum Hinzufügen von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir müssen zwei Verzeichnisse erstellen, zu denen wir später Handler hinzufügen werden. </font><font style="vertical-align: inherit;">Es wird </font></font><code>/login</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und sein </font></font><code>/account</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der erste Handler ist für das Senden magischer Links an Benutzer und der zweite für deren Authentifizierung verantwortlich. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/3e/po/qt3epo1etknmhkp3rpijaekmexs.png"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server.ts</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nodemailer konfigurieren</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodemailer verwenden</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , um E-Mails zu senden, aber zuerst müssen Sie es konfigurieren. </font><font style="vertical-align: inherit;">Wir benötigen mehrere Komponenten: eine E-Mail-Adresse, ein E-Mail-Passwort, einen SMTP-Server-Host und einen SMTP-Server-Port. </font><font style="vertical-align: inherit;">Wir benötigen außerdem eine Briefvorlage, die wir den Benutzern mit einem magischen Link senden. </font><font style="vertical-align: inherit;">Eine Vorlage kann nur eine Zeichenfolge oder eine HTML-Seite sein.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vo/dc/r0/vodcr0nsmdbrvqdxnazj02mg1ew.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token-Generierung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Dafür verwenden wir das Paket </font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jsonwebtoken</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das insgesamt alles für uns </font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">erledigt</font></a></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Unser Token besteht aus zwei Eigenschaften: E-Mail-Adresse und Ablaufzeit. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/e0/x4/bm/e0x4bm02olp4xkoxn-vstcoxqkw.png"> <br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">token.ts</font></font></i><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-Mail senden</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt müssen wir einen Login-Handler hinzufügen, in dem wir zuerst überprüfen, ob die Anfrage die E-Mail-Adresse des Benutzers enthält, dann ein neues Token für diesen bestimmten Benutzer generieren und schließlich den im obigen Code beschriebenen Mechanismus verwenden, um die E-Mail zu senden.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/s8/pf/yq/s8pfyqtbzuffdnumv4axfrl8tbc.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzerauthentifizierung</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn sich ein Benutzer am System anmeldet, müssen wir seine Anforderungen an unseren Server autorisieren. </font><font style="vertical-align: inherit;">Gehen Sie dazu wie folgt vor:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überprüfen Sie, ob die Anforderung einen Autorisierungsheader enthält.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sicher, dass der Autorisierungsheader lautet </font></font><code>bearer token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versuchen Sie, dieses Token zu dekodieren.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Überprüfen Sie, ob das Token alle erforderlichen Felder enthält. </font><font style="vertical-align: inherit;">In unserem Fall: </font></font><code>email</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>expiration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleichen Sie Datum und Uhrzeit nach Ablauf mit den aktuellen, um sicherzustellen, dass das Token nicht abgelaufen ist.</font></font></li>
<li>, ,     ,   , .</li>
</ol><br>
<br>
<img src="https://habrastorage.org/webt/dl/d5/r-/dld5r-jbbmywnwgbdkcapab7cdc.png"><br>
<br>
<h3></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die Grundeinstellung für die kennwortlose Anmeldung zusätzlich zu einem normalen Autorisierungsdatenstrom. Der größte Vorteil, den ich bei diesem Ansatz sehe, besteht darin, dass sich die Erfahrung mit der Verwendung des Produkts verbessert, wenn Benutzer sich schneller und einfacher bei einem Produkt anmelden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selbst wenn die Anmeldung am System einfacher sein kann als mit einem normalen Login / Passwort, kann die Rückkehr zum System schwieriger sein. Jedes Mal, wenn sich ein Benutzer anmeldet, muss er auf eine E-Mail warten, seinen Posteingang überprüfen und auf den Link klicken. Dieser Vorgang kann auch unangenehm sein. Wenn für eine Sitzung eine kurze Zeitüberschreitung auftritt oder erwartet wird, dass sich Benutzer häufig beim System anmelden, ist die kennwortlose Autorisierung möglicherweise nicht die beste Wahl.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   .</a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de507116/index.html">"Udalenka". Notizen vom gestrigen Büroentwickler. Teil 2</a></li>
<li><a href="../de507124/index.html">PDB ist nicht nur wertvolles Fell</a></li>
<li><a href="../de507132/index.html">Vladimir Kitov: „Es ist unmöglich zu verstehen, wie wegweisende Wissenschaftler in den 1950er Jahren die universelle Computerisierung vorausgesehen haben!“</a></li>
<li><a href="../de507138/index.html">Geologie des 21. Jahrhunderts als Geodatenwissenschaft</a></li>
<li><a href="../de507146/index.html">Mehrfarbige Fenster: virtueller Konstruktor, CRTP und komplizierte Vorlagen</a></li>
<li><a href="../de507150/index.html">Wir zeichnen ein Interferenzbild in JavaScript</a></li>
<li><a href="../en486014/index.html">SLAC Tour: US Department of Energy National Accelerator Laboratory at Stanford</a></li>
<li><a href="../en486018/index.html">Session Survey Results</a></li>
<li><a href="../en486024/index.html">Really simple graphics in R for science and journalism</a></li>
<li><a href="../en486028/index.html">Neural networks in the production of dentures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>