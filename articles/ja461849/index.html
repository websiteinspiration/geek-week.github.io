<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏐 🏳️‍🌈 🤟🏼 ﻿PVS-StudioがRed Dead Redemptionエンジンをちらりと見た-Bullet 🍫 🤰 ♟️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="現在、たとえばゲームの開発では、オブジェクトフィジックスを個別に実装する必要がなくなりました。これは、ライブラリが多数存在するためです。 Bulletはかつて多くのAAAゲーム、バーチャルリアリティプロジェクト、さまざまなシミュレーション、機械学習で積極的に使用されていました。はい、それは現在も使用...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>﻿PVS-StudioがRed Dead Redemptionエンジンをちらりと見た-Bullet</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/461849/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d4/8af/4e2/0d48af4e201510deac9e3634151d647e.png" alt="写真4"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
現在、たとえばゲームの開発では、オブジェクトフィジックスを個別に実装する必要がなくなりました。これは、ライブラリが多数存在するためです。 Bulletはかつて多くのAAAゲーム、バーチャルリアリティプロジェクト、さまざまなシミュレーション、機械学習で積極的に使用されていました。はい、それは現在も使用されています。たとえば、Red Dead RedemptionやRed Dead Redemption 2のエンジンの1つです。PVS-StudioでBulletをチェックして、静的分析でこのような大規模プロジェクトで検出できるエラーを確認してください。物理シミュレーションに関連しています。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このライブラリは</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自由に配布されている</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ため、誰でもオプションでプロジェクトで使用できます。</font><font style="vertical-align: inherit;">Red Dead Redemptionに加えて、この物理エンジンは映画業界でも特殊効果を作成するために使用されます。</font><font style="vertical-align: inherit;">たとえば、衝突を計算するためにガイ・リッチーによるシャーロック・ホームズの撮影に関与しました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これがPVS-Studioがプロジェクトをチェックする記事との最初の出会いである場合は、少し補足します。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、C、C ++、C＃、Javaプログラムのソースコードのエラー、欠点、潜在的な脆弱性を見つけるのに役立つ静的コードアナライザーです。</font><font style="vertical-align: inherit;">静的分析は、一種の自動化されたコードレビュープロセスです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ウォーミングアップ用</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例1：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
面白い間違いから始めましょう：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V624</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '3.141592538'定数におそらく誤植があります。</font><font style="vertical-align: inherit;">&lt;math.h&gt;のM_PI定数の使用を検討してください。</font><font style="vertical-align: inherit;">PhysicsClientC_API.cpp 4109</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">B3_SHARED_API <span class="hljs-keyword">void</span> <span class="hljs-title">b3ComputeProjectionMatrixFOV</span><span class="hljs-params">(<span class="hljs-keyword">float</span> fov, ....)</span>
</span>{
  <span class="hljs-keyword">float</span> yScale = <span class="hljs-number">1.0</span> / <span class="hljs-built_in">tan</span>((<span class="hljs-number">3.141592538</span> / <span class="hljs-number">180.0</span>) * fov / <span class="hljs-number">2</span>);<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
小数部の7番目の位置にある数字「6」が欠落している、数字Pi（3.141592653 ...）の小さなタイプミス。 </font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f83/42b/62f/f8342b62f2250ce927675fbbc1f40af7.png" alt="写真1"></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">おそらく、小数点以下の1000万分の1のエラーは具体的な結果につながらないでしょうが、タイプミスのない既存のライブラリ定数を使用する必要があります。</font><font style="vertical-align: inherit;">Piの場合</font><font style="vertical-align: inherit;">、</font><i><font style="vertical-align: inherit;">math.h</font></i><font style="vertical-align: inherit;">ヘッダーの</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M_PI</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定数</font><font style="vertical-align: inherit;">があり</font><font style="vertical-align: inherit;">ます。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コピーペースト</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例2：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アナライザーは、間接的にエラーを検出できる場合があります。</font><font style="vertical-align: inherit;">したがって、たとえば、ここでは関連する3つの引数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halfExtentsX、halfExtentsY、halfExtentsZ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が関数</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">渡されます</font><font style="vertical-align: inherit;">が、後者は関数のどこでも使用されていません。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addVertex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メソッドを呼び出す</font><font style="vertical-align: inherit;">と、変数</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">halfExtentsYが</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2回使用される</font><font style="vertical-align: inherit;">ことに気付くでしょう</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">おそらくこれはコピーと貼り付けのエラーであり、ここでは忘れられた引数を使用する必要があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V751</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パラメーター 'halfExtentsZ'は関数本体内では使用されません。</font><font style="vertical-align: inherit;">TinyRenderer.cpp 375</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TinyRenderObjectData::createCube</span><span class="hljs-params">(<span class="hljs-keyword">float</span> halfExtentsX,
                                      <span class="hljs-keyword">float</span> halfExtentsY,
                                      <span class="hljs-keyword">float</span> halfExtentsZ,
                                      ....)</span>
</span>{<font></font>
  ....<font></font>
  m_model-&gt;addVertex(halfExtentsX * cube_vertices_textured[i * <span class="hljs-number">9</span>],<font></font>
                     halfExtentsY * cube_vertices_textured[i * <span class="hljs-number">9</span> + <span class="hljs-number">1</span>],<font></font>
                     halfExtentsY * cube_vertices_textured[i * <span class="hljs-number">9</span> + <span class="hljs-number">2</span>],<font></font>
                     cube_vertices_textured[i * <span class="hljs-number">9</span> + <span class="hljs-number">4</span>],<font></font>
                     ....);<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例3：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
アナライザーは次の興味深いフラグメントも検出しました。最初に元の形式で提供します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f03/4d3/6a0/f034d36a087d3705a4aaf5c1ca4ff54c.png" alt="写真11"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この最後の行を参照してください？</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/97f/976/5f6/97f9765f6af6eef034ea0c541f6e95c1.png" alt="写真12"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プログラマーがこのような長い条件を1行で記述することにしたのは非常に奇妙です。しかし、間違いがそれに陥る可能性が最も高いという事実は、まったく驚くことではありません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは、この行で次の警告を発行しました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V501</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「&amp;&amp;」演算子の左側と右側に、同一のサブ式「rotmat.Column1（）。Norm（）&lt;1.0001」があります。 LinearR4.cpp 351 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V501</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「&amp;&amp;」演算子の左側と右側に同一のサブ式「0.9999 &lt;rotmat.Column1（）。Norm（）」があります。 LinearR4.cpp 351 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
すべてを視覚的な「表」形式で書き込むと</font><font style="vertical-align: inherit;">、同じチェック</font><font style="vertical-align: inherit;">が</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Column1にも</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">適用さ</font><font style="vertical-align: inherit;">れることが明らかになり</font><font style="vertical-align: inherit;">ます。最後の2つの比較は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Column1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">および</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Column2とは</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ほとんどの場合、3番目と4番目の比較で</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Column2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の値がチェックされているはず</font><i><font style="vertical-align: inherit;">です</font></i><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="cpp hljs">   Column1().Norm() &lt; <span class="hljs-number">1.0001</span> &amp;&amp; <span class="hljs-number">0.9999</span> &lt; Column1().Norm()<font></font>
&amp;&amp; Column1().Norm() &lt; <span class="hljs-number">1.0001</span> &amp;&amp; <span class="hljs-number">0.9999</span> &lt; Column1().Norm()<font></font>
&amp;&amp;(Column1() ^ Column2()) &lt; <span class="hljs-number">0.001</span> &amp;&amp; (Column1() ^ Column2()) &gt; <span class="hljs-number">-0.001</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この形式では、同じ比較がはるかに顕著になります。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例4：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
類似形式のエラー：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V501</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「&amp;&amp;」演算子の左側と右側に、同じサブ式「cs.m_fJacCoeffInv [0] == 0」があります。</font><font style="vertical-align: inherit;">b3CpuRigidBodyPipeline.cpp 169</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">float</span> m_fJacCoeffInv[<span class="hljs-number">2</span>];      
<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">b3SolveFriction</span><span class="hljs-params">(b3ContactConstraint4&amp; cs, ....)</span>
</span>{
  <span class="hljs-keyword">if</span> (cs.m_fJacCoeffInv[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> &amp;&amp; cs.m_fJacCoeffInv[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">return</span>;<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、同じ配列要素が二重チェックされます。ほとんどの場合、条件は次のようになっているはずです：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cs.m_fJacCoeffInv [0] == 0 &amp;&amp; cs.m_fJacCoeffInv [1] == 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。これは、コピー/貼り付けエラーの典型的な例です。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例5：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
そのような別の欠陥が発見されました：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'if（A）{...} else if（A）{...}'パターンの使用が検出されました。論理エラーが存在する可能性があります。チェック行：79、112。main.cpp 79</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">while</span> (serviceResult &gt; <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    serviceResult = enet_host_service(client, &amp;event, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (serviceResult &gt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
      ....<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (serviceResult &gt; <span class="hljs-number">0</span>)<font></font>
    {<font></font>
      <span class="hljs-built_in">puts</span>(<span class="hljs-string">"Error with servicing the client"</span>);
      <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<font></font>
    }<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結果が</font><i><font style="vertical-align: inherit;">serviceResult</font></i><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">割り当てられている</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enet_host_service</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数は</font><font style="vertical-align: inherit;">、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成功する</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と1を返し、失敗</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">と-1を返します。</font><font style="vertical-align: inherit;">おそらく</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブランチ</font><font style="vertical-align: inherit;">は</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">serviceResult</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">の負の値に応答するはず</font><i><font style="vertical-align: inherit;">でした</font></i><font style="vertical-align: inherit;">が、検証条件が重複していました。</font><font style="vertical-align: inherit;">ほとんどの場合、これはコピーと貼り付けのエラーでもあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
記事では意味をなさない同様のアナライザー警告：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V517</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「if（A）{...} else if（A）{...}」パターンの使用が検出されました。</font><font style="vertical-align: inherit;">論理エラーが存在する可能性があります。</font><font style="vertical-align: inherit;">チェック行：151、190。PhysicsClientUDP.cpp 151</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限界を超えて：アレイの境界を越えて</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例6：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
見つけるのが面倒なエラーの1つは、配列を超えることです。多くの場合、このエラーはループ内の複雑なインデックス付けが原因で発生します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、ループ条件では、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dofIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><i><font style="vertical-align: inherit;">は</font></i><font style="vertical-align: inherit;">上から128、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dof</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は4に</font><font style="vertical-align: inherit;">制限されてい</font><font style="vertical-align: inherit;">ます。ただし、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_desiredStateに</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">も含まれる要素は128のみです。その結果、インデックス</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[dofIndex + dof]は</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列の</font><i><font style="vertical-align: inherit;">流出に</font></i><font style="vertical-align: inherit;">つながる可能性があります。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V557</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アレイのオーバーランが発生する可能性があります。 「dofIndex + dof」インデックスの値は130に達する可能性があります。PhysicsClientC_API.cpp 968</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_DEGREE_OF_FREEDOM 128 </span>
<span class="hljs-keyword">double</span> m_desiredState[MAX_DEGREE_OF_FREEDOM];<font></font>
<font></font>
<span class="hljs-function">B3_SHARED_API <span class="hljs-keyword">int</span> <span class="hljs-title">b3JointControl</span><span class="hljs-params">(<span class="hljs-keyword">int</span> dofIndex,
                                 <span class="hljs-keyword">double</span>* forces,
                                 <span class="hljs-keyword">int</span> dofCount, ....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (   (dofIndex &gt;= <span class="hljs-number">0</span>)<font></font>
      &amp;&amp; (dofIndex &lt; MAX_DEGREE_OF_FREEDOM )<font></font>
      &amp;&amp; dofCount &gt;= <span class="hljs-number">0</span>
      &amp;&amp; dofCount &lt;= <span class="hljs-number">4</span>)<font></font>
  {<font></font>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> dof = <span class="hljs-number">0</span>; dof &lt; dofCount; dof++)<font></font>
    {<font></font>
      command-&gt;m_sendState.m_desiredState[dofIndex+dof] = forces[dof];<font></font>
      ....<font></font>
    }<font></font>
  }<font></font>
  ....<font></font>
}</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例7：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
同様のエラーですが、現在は、配列にインデックスを付けるときではなく、ある条件で合計するとエラーになります。</font><font style="vertical-align: inherit;">ファイル名が可能な限り長い場合、端子ゼロは配列の外側に書き込まれます（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1つずつのエラー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">当然のことながら、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">len</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数</font><font style="vertical-align: inherit;">は例外的な場合</font><font style="vertical-align: inherit;">に</font><font style="vertical-align: inherit;">のみ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MAX_FILENAME_LENGTH</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と等しくなります</font><font style="vertical-align: inherit;">が、これはエラーを排除するのではなく、単にその発生をまれにします。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V557</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アレイのオーバーランが発生する可能性があります。</font><font style="vertical-align: inherit;">「len」インデックスの値は1024に達する可能性があります。PhysicsClientC_API.cpp 5223</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MAX_FILENAME_LENGTH MAX_URDF_FILENAME_LENGTH 1024</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">b3Profile</span>
{</span>
  <span class="hljs-keyword">char</span> m_name[MAX_FILENAME_LENGTH];
  <span class="hljs-keyword">int</span> m_durationInMicroSeconds;<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">int</span> len = <span class="hljs-built_in">strlen</span>(name);
<span class="hljs-keyword">if</span> (len &gt;= <span class="hljs-number">0</span> &amp;&amp; len &lt; (MAX_FILENAME_LENGTH + <span class="hljs-number">1</span>))<font></font>
{<font></font>
  command-&gt;m_type = CMD_PROFILE_TIMING;<font></font>
  <span class="hljs-built_in">strcpy</span>(command-&gt;m_profile.m_name, name);<font></font>
  command-&gt;m_profile.m_name[len] = <span class="hljs-number">0</span>;<font></font>
}</code></pre><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1回測定-7回カット</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例8：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数の結果を何度も使用する必要がある場合や、一連の呼び出しを通じてアクセスする必要がある変数を繰り返し使用する必要がある場合は、一時変数を使用してコードを最適化し、読みやすくする必要があります。アナライザーは、このような修正を行うことができるコード内の100を超える場所を検出しました。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V807</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下。 'm_app-&gt; m_renderer-&gt; getActiveCamera（）'式を繰り返し使用しないようにポインターを作成することを検討してください。 InverseKinematicsExample.cpp 315</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">resetCamera</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    m_app-&gt;m_renderer-&gt;getActiveCamera()-&gt;setCameraDistance(dist);<font></font>
    m_app-&gt;m_renderer-&gt;getActiveCamera()-&gt;setCameraPitch(pitch);<font></font>
    m_app-&gt;m_renderer-&gt;getActiveCamera()-&gt;setCameraYaw(yaw);<font></font>
    m_app-&gt;m_renderer-&gt;getActiveCamera()-&gt;setCameraPosition(....);<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここでは、同じ呼び出しチェーンが再利用され、単一のポインターに置き換えることができます。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例9：</font></font></b><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V810</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下。 「btCos（euler_out.pitch）」関数は、同じ引数を使用して数回呼び出されました。結果はおそらく一時変数に保存する必要があります。これは、 'btAtan2'関数の呼び出し中に使用できます。 btMatrix3x3.h 576 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V810</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下。 'btCos（euler_out2.pitch）'関数は、同じ引数を使用して数回呼び出されました。結果はおそらく一時変数に保存する必要があります。これは、 'btAtan2'関数の呼び出し中に使用できます。 btMatrix3x3.h 578</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">getEulerZYX</span><span class="hljs-params">(....)</span> <span class="hljs-keyword">const</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
  <span class="hljs-keyword">else</span><font></font>
  {<font></font>
    ....<font></font>
    euler_out.roll  = btAtan2(m_el[<span class="hljs-number">2</span>].y() / btCos(euler_out.pitch),<font></font>
                              m_el[<span class="hljs-number">2</span>].z() / btCos(euler_out.pitch));<font></font>
    euler_out2.roll = btAtan2(m_el[<span class="hljs-number">2</span>].y() / btCos(euler_out2.pitch),<font></font>
                              m_el[<span class="hljs-number">2</span>].z() / btCos(euler_out2.pitch));<font></font>
    euler_out.yaw  =  btAtan2(m_el[<span class="hljs-number">1</span>].x() / btCos(euler_out.pitch),<font></font>
                              m_el[<span class="hljs-number">0</span>].x() / btCos(euler_out.pitch));<font></font>
    euler_out2.yaw =  btAtan2(m_el[<span class="hljs-number">1</span>].x() / btCos(euler_out2.pitch),<font></font>
                              m_el[<span class="hljs-number">0</span>].x() / btCos(euler_out2.pitch));<font></font>
<font></font>
  }<font></font>
  ....<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このケースでは、2つの変数を作成してから返された値は保存することができます</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">btCosの</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能</font><font style="vertical-align: inherit;">のために</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">euler_out.pitch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">その中のeuler_out2.pitch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代わりに、各引数のための機能を4回呼び出すのを、。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">漏れ</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例10：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次のタイプの多くのエラーがプロジェクトで見つかりました：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V773</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">importer</font></a><font style="vertical-align: inherit;"> 'ポインターの可視性スコープがメモリを解放せずに終了しました。</font><font style="vertical-align: inherit;">メモリリークの可能性があります。</font><font style="vertical-align: inherit;">SerializeSetup.cpp 94</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SerializeSetup::initPhysics</span><span class="hljs-params">()</span>
</span>{<font></font>
  ....<font></font>
  btBulletWorldImporter* importer = <span class="hljs-keyword">new</span> btBulletWorldImporter(m_dynamicsWorld);<font></font>
  ....<font></font>
 <font></font>
  fclose(file);<font></font>
<font></font>
  m_guiHelper-&gt;autogenerateGraphicsObjects(m_dynamicsWorld);<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">インポーター</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポインターからメモリが解放されていません</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これにより、メモリリークが発生することがあります。</font><font style="vertical-align: inherit;">そして、物理エンジンの場合、これは悪い傾向かもしれません。</font><font style="vertical-align: inherit;">リークを回避するには、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">削除インポーター</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を追加</font><i><font style="vertical-align: inherit;">する</font></i><font style="vertical-align: inherit;">ために変数が不要になった後で十分</font><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">ただし、もちろん、スマートポインタを使用することをお勧めします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ここにあなたの法律があります</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例11：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
C ++規則が常に数学的な規則または「常識」と一致するとは限らないため、コードに次のエラーが表示されます。</font><font style="vertical-align: inherit;">小さなコードスニペットにエラーが含まれていることに気付きましたか？</font></font><br>
<br>
<pre><code class="cpp hljs">btAlignedObjectArray&lt;btFractureBody*&gt; m_fractureBodies;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">btFractureDynamicsWorld::fractureCallback</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; numManifolds; i++)<font></font>
  {<font></font>
    ....<font></font>
    <span class="hljs-keyword">int</span> f0 = m_fractureBodies.findLinearSearch(....);
    <span class="hljs-keyword">int</span> f1 = m_fractureBodies.findLinearSearch(....);<font></font>
<font></font>
    <span class="hljs-keyword">if</span> (f0 == f1 == m_fractureBodies.size())
      <span class="hljs-keyword">continue</span>;<font></font>
    ....<font></font>
  }<font></font>
....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは次の警告を生成します：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V709</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不審な比較が見つかりました： 'f0 == f1 == m_fractureBodies.size（）'。 「a == b == c」は「a == b &amp;&amp; b == c」と等しくないことに注意してください。 btFractureDynamicsWorld.cpp 483 </font><i><font style="vertical-align: inherit;">f0</font></i><font style="vertical-align: inherit;">が</font><i><font style="vertical-align: inherit;">f1</font></i><font style="vertical-align: inherit;">に等しく、</font><i><font style="vertical-align: inherit;">m_fractureBodies</font></i><font style="vertical-align: inherit;">の要素数に等しいこと</font><font style="vertical-align: inherit;">を</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
条件がチェックしているように見え</font><font style="vertical-align: inherit;">ます。この比較では、</font><i><font style="vertical-align: inherit;">f0</font></i><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">f1が</font></i><i><font style="vertical-align: inherit;">m_fractureBodies</font></i><font style="vertical-align: inherit;">配列の最後にある</font><font style="vertical-align: inherit;">かどうかを確認する必要があるようです。これ</font><font style="vertical-align: inherit;">は、</font><i><font style="vertical-align: inherit;">findLinearSearch（）</font></i><font style="vertical-align: inherit;">メソッドで見つかっ</font><font style="vertical-align: inherit;">たオブジェクト</font><font style="vertical-align: inherit;">の</font><font style="vertical-align: inherit;">位置が</font><font style="vertical-align: inherit;">含まれているため</font><font style="vertical-align: inherit;">です。ただし、実際には、この式は</font><i><font style="vertical-align: inherit;">f0</font></i><font style="vertical-align: inherit;">と</font><i><font style="vertical-align: inherit;">f1</font></i><font style="vertical-align: inherit;">が等しいかどうかのチェックになります</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、次に</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m_fractureBodies.size（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><font style="vertical-align: inherit;">結果</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f0 == f1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と等しいかどうかを確認し</font><font style="vertical-align: inherit;">ます。その結果、ここの3番目のオペランドは0または1と比較されます</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
。そして、幸いなことに、非常にまれです。これまでのところ、私たちは</font><font style="vertical-align: inherit;">2つのオープンプロジェクトでのみ彼女に</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会い</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ました。興味深いことに、それらはすべて単なるゲームエンジンでした。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例12：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
文字列を操作する場合、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文字列</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クラスが提供する機能を使用する方がよい場合がよくあり</font><i><font style="vertical-align: inherit;">ます</font></i><font style="vertical-align: inherit;">。したがって、次の2つのケースでは、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">strlen（MyStr.c_str（））</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">val = ""</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それぞれMyStr.length（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">と</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">val.clear（）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に置き換える方が適切</font><font style="vertical-align: inherit;">です。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V806</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下。</font><font style="vertical-align: inherit;">strlen（MyStr.c_str（））の種類の式は、MyStr.length（）に書き換えることができます。</font><font style="vertical-align: inherit;">RobotLoggingUtil.cpp 213</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function">FILE* <span class="hljs-title">createMinitaurLogFile</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* fileName,
                            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; structTypes,
                            ....)</span>
</span>{<font></font>
  FILE* f = fopen(fileName, <span class="hljs-string">"wb"</span>);
  <span class="hljs-keyword">if</span> (f)<font></font>
  {<font></font>
    ....<font></font>
    fwrite(structTypes.c_str(), <span class="hljs-built_in">strlen</span>(structTypes.c_str()), <span class="hljs-number">1</span>, f);<font></font>
    ....<font></font>
  }<font></font>
  ....<font></font>
}<font></font>
</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V815</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パフォーマンスの低下。</font><font style="vertical-align: inherit;">式「val = ""」を「val.clear（）」に置き換えることを検討してください。</font><font style="vertical-align: inherit;">b3CommandLineArgs.h 40</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addArgs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> val;<font></font>
  ....<font></font>
  val = <span class="hljs-string">""</span>;<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
他にも警告が出ましたが、やめてもいいと思います。</font><font style="vertical-align: inherit;">ご覧のとおり、静的コード分析では、さまざまなエラーが広範囲に明らかになる可能性があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロジェクトの1回限りのチェックについて読むのは興味深いですが、これは静的コードアナライザーを使用する正しい方法ではありません。</font><font style="vertical-align: inherit;">これについては以下で説明します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私たちの前に発見されたバグ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最近の記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的コード分析が使用されていないために検出されないエラー</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」の精神において、</font><font style="vertical-align: inherit;">すでに修正されているが静的アナライザーが検出できるバグまたは欠点を見つけるの</font><font style="vertical-align: inherit;">は興味深いことでした</font><font style="vertical-align: inherit;">。</font></font><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0e5/4ab/39d/0e54ab39d2d7d7dbd4d595d1032fe994.png" alt="写真2"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
リポジトリにはそれほど多くのプルリクエストがありませんでした、そしてそれらの多くはエンジンの内部ロジックに関連しています。</font><font style="vertical-align: inherit;">しかし、アナライザーが検出できるエラーもありました。</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例13：</font></font></b><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">char</span> m_deviceExtensions[B3_MAX_STRING_LENGTH];<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">b3OpenCLUtils_printDeviceInfo</span><span class="hljs-params">(cl_device_id device)</span>
</span>{<font></font>
  b3OpenCLDeviceInfo info;<font></font>
  b3OpenCLUtils::getDeviceInfo(device, &amp;info);<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (info.m_deviceExtensions != <span class="hljs-number">0</span>)<font></font>
  {<font></font>
    ....<font></font>
  }<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
編集に関するコメントは、配列が空でないことを確認する必要があることを示唆していますが、代わりに無意味なポインターチェックが実行され、常にtrueを返しました。これは、最初のタイプのチェックに関するPVS-Studio警告によって示されます：</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V600</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">状態の検査を検討してください。 「info.m_deviceExtensions」ポインタは常にNULLと等しくありません。 b3OpenCLUtils.cpp 551 </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例14：</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
次の関数の問題をすぐに見つけることができますか？</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Matrix4x4::SetIdentity</span><span class="hljs-params">()</span>
</span>{<font></font>
  m12 = m13 = m14 = m21 = m23 = m24 = m13 = m23 = m41 = m42 = m43 = <span class="hljs-number">0.0</span>;<font></font>
  m11 = m22 = m33 = m44 = <span class="hljs-number">1.0</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アナライザーは次の警告を生成します</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。V570</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ値が変数「m23」に2回割り当てられます。</font><font style="vertical-align: inherit;">LinearR4.h 627 </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V570</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同じ値が「m13」変数に2回割り当てられます。</font><font style="vertical-align: inherit;">LinearR4.h 627 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この形式の記録で繰り返し割り当てを肉眼で追跡することは困難であり、その結果、一部の行列要素は初期値を受け取りませんでした。</font><font style="vertical-align: inherit;">このエラーは、割り当てレコードの表形式で修正されました。</font></font><br>
<br>
<pre><code class="cpp hljs">m12 = m13 = m14 =<font></font>
m21 = m23 = m24 =<font></font>
m31 = m32 = m34 =<font></font>
m41 = m42 = m43 = <span class="hljs-number">0.0</span>;
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例15：</font></font></b><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">btSoftBody :: addAeroForceToNode（）</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
関数の条件の1つにある次のエラーは</font><font style="vertical-align: inherit;">、明示的なバグにつながりました。</font><font style="vertical-align: inherit;">プルリクエストのコメントによると、反対側からオブジェクトに力が加えられました。</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">eAeroModel</span>
{</span>
  <span class="hljs-keyword">enum</span> _<font></font>
  {<font></font>
    V_Point,             <font></font>
    V_TwoSided,<font></font>
    ....<font></font>
    END<font></font>
  };<font></font>
};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">btSoftBody::addAeroForceToNode</span><span class="hljs-params">(....)</span>
</span>{<font></font>
  ....<font></font>
  <span class="hljs-keyword">if</span> (....)<font></font>
  {<font></font>
    <span class="hljs-keyword">if</span> (btSoftBody::eAeroModel::V_TwoSided)<font></font>
    {<font></font>
      ....<font></font>
    }<font></font>
    ....<font></font>
  }<font></font>
....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PVS-Studioはこのエラーを検出して次の警告を発行することもできます</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。V768</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列挙定数 'V_TwoSided'がブール型の変数として使用されています。 btSoftBody.cpp 542 </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
修正されたチェックは次のとおりです。</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword">if</span> (m_cfg.aeromodel == btSoftBody::eAeroModel::V_TwoSided)<font></font>
{<font></font>
  ....<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
列挙子の1つに対するオブジェクトプロパティの同等性の代わりに、</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V_TwoSided</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">列挙子自体がチェックされました</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私は自分でそのようなタスクを設定しなかったので、すべてのプルリクエストを確認しなかったのは明らかです。</font><font style="vertical-align: inherit;">静的コードアナライザーを定期的に使用すると、エラーを早期に検出できることを示したかっただけです。</font><font style="vertical-align: inherit;">これは、静的コード分析を使用する正しい方法です。</font><font style="vertical-align: inherit;">静的分析はDevOpsプロセスに組み込まれ、バグの主要なフィルターになる必要があります。</font><font style="vertical-align: inherit;">これらすべては、記事「</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">静的分析をプロセスに埋め込むことで、バグを探すのではなく」で詳しく説明されてい</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">結論</font></font></h2><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a4a/dc3/388/a4adc33880ad2c22a88902ae54a7fa44.png" alt="写真6"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
いくつかのプルリクエストから判断すると、プロジェクトはさまざまなコード分析ツールを通じてチェックされることがありますが、編集は段階的にではなく、グループ単位で行われ、時間間隔が大きくなります。一部のリクエストでは、コメントは警告を抑制するためにのみ変更が行われたことを示しています。分析を使用するこのようなアプローチは、プロジェクトの継続的なチェックであり、明らかなバグが現れるまで待機せずにエラーをすぐに修正できるため、その利点が大幅に減少します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私たちのチームのニュースやイベントについて常に知りたい場合は、私たちの社会サービスに登録してください。ネットワーク：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instagram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twitter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vkontakte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Telegram</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事を英語を話す視聴者と共有したい場合は、翻訳リンクを使用してください：</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-StudioがRed Dead RedemptionのBullet Engineを調べました</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja461827/index.html">ハイブリッドPHP / RoadRunnerを使用したGoアプリケーション開発</a></li>
<li><a href="../ja461829/index.html">TCP対UDPまたは将来のネットワークプロトコル</a></li>
<li><a href="../ja461831/index.html">StealthWatch：展開とカスタマイズ。パート2</a></li>
<li><a href="../ja461833/index.html">3つのマツで迷子にならないでください：環境の自己中心的な表現</a></li>
<li><a href="../ja461845/index.html">財政を維持する方法としての交換への投資：3つの作業方法</a></li>
<li><a href="../ja461851/index.html">ブロックチェーンと電気</a></li>
<li><a href="../ja461855/index.html">2019年前半のITの給与：給与計算ツールMy Circleによると</a></li>
<li><a href="../ja461859/index.html">あなたは食品技術について何も知らない</a></li>
<li><a href="../ja461861/index.html">Office 365クラウドサービス：Check Point CloudGuard SaaSテスト</a></li>
<li><a href="../ja461865/index.html">ビデオコース「IDA PROを使用した、ゼロからの逆転入門。第1章"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>