<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕦 🧕🏻 🔺 Vulnerability Management - more: management or vulnerabilities? 👩🏽‍🔧 👶🏽 🌀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, we want to share with you the cases that happened to our customers and tell / show / answer the question why vulnerability management...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Vulnerability Management - more: management or vulnerabilities?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acribia/blog/487780/"><img src="https://habrastorage.org/webt/eo/yr/k2/eoyrk2w48rdsst63ql3j5f0kkk8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this article, we want to share with you the cases that happened to our customers and tell / show / answer the question why vulnerability management is almost always not about vulnerabilities, and the simple thing is “we will filter out 1,000,000 vulnerabilities for you really important minimum "is not enough.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case # 1 “Oh, we ourselves know that everything is bad with us!”</font></font></h2><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> remote control module (IPMI) installed on critical servers - more than 500 pcs.</font></font><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vulnerability:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criticality level (CVSS Score) - 7.8</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
CVE-2013−4786 - vulnerability in IPMI protocol that allowed an attacker to gain access to user’s password hashes, which could lead to unauthorized access and potential account hijacking by attackers.</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Description of the case:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the customer knew about the vulnerability itself, however, for a number of reasons described below, it didn’t go further than “taking risks”.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The complexity of the case itself is that patches are far from being available for all motherboards using this module, and updating firmware on such a large number of servers is extremely resource-intensive.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
There were alternative mitigation methods - access lists (ACLs) on network equipment (it’s very difficult since admins are very distributed and use IPMI from where it comes from) and disabling IPMI, here, I think, comments are unnecessary (just in case: 500 distributed servers should be managed regularly "for the sake of safety, no one will) </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
here usually ends with the story, but from our side was made additional analysis of vulnerability and it became clear that the password hash an account returned by the server only if requested with existing login server, so it was decided: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Change account identifiers to difficult to select</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Of course, this is not a panacea. </font><font style="vertical-align: inherit;">And if, in no hurry, so as not to “shine”, sort through logins, then sooner or later it will be possible to pick it up. </font><font style="vertical-align: inherit;">But most likely it will take a lot of time to have time to implement additional measures. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Change the password so that the hash has to be brutally longer. A </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
situation similar to Clause 1 - to brute-force the SHA1 hash of a 16-character password will take forever. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, a dangerous vulnerability that was known, and which could even be easily exploited by Script kiddie, was closed with minimal resources.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case # 2 "We can download OpenVAS without you!"</font></font></h2><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> all routers and switches within the company - more than 350 devices.</font></font><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vulnerability</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : criticality level (CVSS Score) - 10.0</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
CVE-2018-0171 - vulnerability in the functionality of Cisco Smart Install, the operation of which leads to a change in the configuration of the equipment, including changing the password and its loss by the legal administrator, that is, loss of control over the device. Thus, an attacker will gain full access to the device.</font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Case Description:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despite the use of several scanners, including commercial ones, none of them showed this vulnerability. Perhaps the signatures at that time were far from ideal for this vulnerability, or the network topology affected, one way or another - a precedent. We, as a company providing this service for a certain time, have our own base with really dangerous vulnerabilities, which we additionally check. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The customer did not use the Smart Install functionality, so the solution itself, due to the complexity of updating the firmware (even considering the out-of-date hardware part), came down to providing the client with a list of IP addresses where the vulnerable service was turned off by the script.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, the critical vulnerability on the vast majority of network equipment, which could go unnoticed, and in the event of an attack would lead to a complete shutdown of the entire company, has been fixed.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case # 3 “If you wanted to, we would have already been broken!”</font></font></h2><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> domain controller, mail server and a number of other devices / servers / hosts critical for the company</font></font><br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vulnerability:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> criticality level (CVSS Score) - 9.3</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
CVE-2017-0144 - vulnerability in the SMB protocol that allows remote execution of arbitrary code on the server (through a group vulnerabilities, which includes the one in question, were distributed by the WannaCry ransomware). </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Case Description:</font></font></i> </b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the start of the provision of services during scheduled scanning, a critical vulnerability was discovered, the only possible recommendation is to install OS updates. </font><font style="vertical-align: inherit;">The customer agreed on this decision, but based on the results of the control scan, the vulnerability remained. </font><font style="vertical-align: inherit;">After the escalation of the situation and a personal meeting with the Customer, it turned out that the reason was the human factor - the task was not performed by a specialist. </font></font><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consequences:</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for several days, as a result of ignoring the task, malware that successfully spreads over the network got to the user's workstation, this vulnerability was exploited, which led to the failure of the domain controller. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As a result, the company suffered heavy losses (infrastructure restoration work took several months).</font></font><br>
<br>
<pre><code class="java hljs">     ,      ,    –      ,    .   –           ,   ,  ,       ,      ,     .
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dmitry Golovnya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GolovnyaD</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SOC Analyst, Acribia</font></font></b></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487764/index.html">I am 14 and I combine school with work in IT</a></li>
<li><a href="../en487768/index.html">Opening ports 4321 and 9898 on Xiaomi Gateway 2</a></li>
<li><a href="../en487772/index.html">Meet the Chuvash language in Yandex.Translate: how we solve the main problem of machine translation</a></li>
<li><a href="../en487774/index.html">SQL Server Date and Time Errors</a></li>
<li><a href="../en487776/index.html">Microsoft Azure Training Day: Server Infrastructure Migration (registration completed)</a></li>
<li><a href="../en487782/index.html">How I got rid of a thousand tabs ...</a></li>
<li><a href="../en487784/index.html">Where do they come from in QA?</a></li>
<li><a href="../en487786/index.html">How much freedom a smart oven user needs. How a strong team can test hypotheses in two weeks instead of three</a></li>
<li><a href="../en487788/index.html">Product design without a designer</a></li>
<li><a href="../en487790/index.html">“Yes, they exist!” What do Data Science specialists in Kazakhstan do and how much do they earn?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>