<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèº‚Äçü§ù‚Äçüßëüèº üò§ ‚ùå Peluang apa yang diberikan Spring untuk menyesuaikan perilakunya? ‚ùï üëºüèº üöç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Dalam sentuhan Vladislav Rodin. Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitek...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Peluang apa yang diberikan Spring untuk menyesuaikan perilakunya?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/501930/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Halo semuanya. </font><font style="vertical-align: inherit;">Dalam sentuhan Vladislav Rodin. </font><font style="vertical-align: inherit;">Saat ini, saya adalah kepala kursus Arsitek Beban Tinggi di OTUS, dan saya juga mengajar kursus arsitektur perangkat lunak. </font></font></i><br>
<br>
<b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain mengajar, saya juga menulis materi hak cipta untuk blog OTUS di Haber dan saya ingin bertepatan dengan artikel hari ini untuk meluncurkan kursus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Developer on the Spring Framework"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang sekarang terbuka untuk perekrutan.</font></font></i></b><br>
<br>
<img src="https://habrastorage.org/webt/pz/w4/uv/pzw4uv5fvldfmljzvc4v3flumdc.png"><br>
<hr><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengantar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari sudut pandang pembaca, kode aplikasi menggunakan Spring terlihat cukup sederhana: beberapa kacang dideklarasikan, kelas ditandai dengan anotasi, dan kemudian kacang disuntikkan jika perlu, semuanya berfungsi dengan baik. Tetapi seorang pembaca yang ingin tahu memiliki pertanyaan: "Bagaimana cara kerjanya? Apa yang terjadi?". Pada artikel ini kami akan mencoba menjawab pertanyaan ini, tetapi tidak demi memuaskan keingintahuan kosong.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerangka kerja pegas dikenal cukup fleksibel dan menyediakan opsi untuk menyesuaikan perilaku kerangka kerja. </font><font style="vertical-align: inherit;">Spring juga memiliki sejumlah aturan yang agak menarik untuk menerapkan anotasi tertentu (misalnya, Transaksional). </font><font style="vertical-align: inherit;">Untuk memahami arti dari aturan ini, untuk dapat menurunkannya, dan juga untuk memahami apa dan bagaimana Anda dapat mengkonfigurasi di Spring, Anda perlu memahami beberapa prinsip operasi apa yang ada di Spring di bawah tenda. </font><font style="vertical-align: inherit;">Seperti yang Anda ketahui, pengetahuan tentang beberapa prinsip dibebaskan dari pengetahuan banyak fakta. </font><font style="vertical-align: inherit;">Saya sarankan agar Anda membiasakan diri dengan prinsip-prinsip di bawah ini jika, tentu saja, Anda belum mengetahuinya.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Konfigurasi membaca</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya, Anda perlu mem-parsing konfigurasi yang ada di aplikasi Anda. </font><font style="vertical-align: inherit;">Karena ada beberapa jenis konfigurasi (xml-, groovy-, konfigurasi java, konfigurasi berdasarkan anotasi), metode yang berbeda digunakan untuk membacanya. </font><font style="vertical-align: inherit;">Dengan satu atau lain cara, peta dari bentuk Peta &lt;String, BeanDefinition&gt; dikumpulkan, di mana nama-nama kacang ditugaskan untuk definisi kacang mereka. </font><font style="vertical-align: inherit;">Objek dari kelas BeanDefinition adalah meta-informasi tentang kacang dan berisi id-id kacang itu, namanya, kelasnya, metode destroy dan init. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Contoh kelas yang terlibat dalam proses ini: GroovyBeanDefinitionReader, XmlBeanDefinitionReader, AnnotatedBeanDefinitionReader, mengimplementasikan antarmuka </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanDefinitionReader</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyiapkan Beandefinitions</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami memiliki deskripsi kacang, tetapi tidak ada kacang itu sendiri, belum dibuat. </font><font style="vertical-align: inherit;">Sebelum membuat kacang, Spring menyediakan kemampuan untuk menyesuaikan BeanDefinitions yang dihasilkan. </font><font style="vertical-align: inherit;">Untuk tujuan ini, antarmuka </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanFactoryPostProcessor digunakan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini terlihat seperti ini:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BeanFactoryPostProcessor</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">postProcessBeanFactory</span><span class="hljs-params">(ConfigurableListableBeanFactory beanFactory)</span> <span class="hljs-keyword">throws</span> BeansException</span>;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parameter metode antarmuka ini memungkinkan menggunakan metode getBeanDefinitionNames sendiri untuk mendapatkan nama yang digunakan untuk mendapatkan BeanDefinitions dari peta dan mengeditnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengapa ini diperlukan? </font><font style="vertical-align: inherit;">Misalkan beberapa kacang memerlukan detail untuk terhubung ke sistem eksternal, seperti database. </font><font style="vertical-align: inherit;">Kami ingin kacang yang sudah dibuat dengan detail, tetapi rincian itu sendiri disimpan dalam file properti. </font><font style="vertical-align: inherit;">Kita dapat menerapkan salah satu standar BeanFactoryPostProcessors - PropertySourcesPlaceholderConfigurer, yang akan menggantikan properti nama di BeanDefinition dengan nilai aktual yang disimpan dalam file properti. </font><font style="vertical-align: inherit;">Artinya, itu benar-benar akan menggantikan Value ("user") dengan Value ("root") di BeanDefinion. </font><font style="vertical-align: inherit;">Agar ini berfungsi, PropertySourcesPlaceholderConfigurer, tentu saja, harus terhubung. </font><font style="vertical-align: inherit;">Tetapi ini tidak terbatas pada ini, Anda dapat mendaftarkan BeanFactoryPostProcessor Anda, untuk menerapkan logika apa pun yang Anda perlukan untuk memproses BeanDefinitions.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuat Kacang</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, kami memiliki peta yang memiliki nama-nama kacang yang terletak oleh kunci, dan konfigurasi BeanDefinitions berdasarkan nilai-nilai. Sekarang Anda perlu membuat kacang ini. Inilah yang </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dilakukan BeanFactory</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tetapi di sini Anda dapat menambahkan penyesuaian dengan menulis dan mendaftarkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FactoryBean</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anda </font><font style="vertical-align: inherit;">. FactoryBean adalah antarmuka bentuk:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">FactoryBean</span> </span>{
    <span class="hljs-function">T <span class="hljs-title">getObject</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception</span>;<font></font>
    Class&lt;?&gt; getObjectType();<font></font>
    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">isSingleton</span><span class="hljs-params">()</span></span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, BeanFactory membuat kacang itu sendiri jika tidak ada FactoryBean yang sesuai dengan kelas kacang, atau meminta FactoryBean untuk membuat kacang ini. </font><font style="vertical-align: inherit;">Ada nuansa kecil: jika ruang lingkup kacang adalah singletone, maka kacang dibuat pada tahap ini, jika prototipe, maka setiap kali kacang ini diperlukan, itu akan diminta dari BeanFactory. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasilnya, kami kembali mendapatkan peta, tetapi sudah sedikit berbeda: kunci berisi nama kacang, dan nilai kacang itu sendiri. </font><font style="vertical-align: inherit;">Tetapi ini hanya berlaku untuk lajang.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengkonfigurasi Kacang</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang tibalah tahap yang paling menarik. Kami memiliki peta berisi kacang yang dibuat, tetapi kacang ini belum dikonfigurasi. Artinya, kami tidak memproses anotasi yang menetapkan status kacang: Autowired, Value. Kami juga tidak memproses anotasi yang mengubah perilaku kacang: Transaksional, Async. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeanPostProcessors</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang sekali lagi implementasi dari antarmuka yang sesuai, </font><font style="vertical-align: inherit;">memungkinkan kami untuk menyelesaikan masalah ini </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BeanPostProcessor</span> </span>{
    <span class="hljs-function">Object <span class="hljs-title">postProcessBeforeInitialization</span><span class="hljs-params">(Object bean, String beanName)</span> <span class="hljs-keyword">throws</span> BeansException</span>;
    <span class="hljs-function">Object <span class="hljs-title">postProcessAfterInitialization</span><span class="hljs-params">(Object bean, String beanName)</span> <span class="hljs-keyword">throws</span> BeansException</span>;<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami melihat 2 metode dengan nama yang menakutkan tetapi komprehensif. Kedua metode mengambil kacang sebagai input, dari mana Anda dapat bertanya kelas mana itu, dan kemudian menggunakan API Refleksi untuk memproses anotasi. Metode pengembalian kacang, mungkin diganti dengan proxy. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk setiap kacang sebelum menempatkannya dalam konteks, hal berikut terjadi: metode postProcessBeforeInisialisasi dipicu untuk semua BeanPostProcessors, maka metode init dipicu, dan kemudian metode postProcessAfterInisialisasi dipicu untuk semua BeanPostProcessors juga.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dua metode ini memiliki semantik yang berbeda: postProcessBeforeInisialisasi proses menyatakan penjelasan, postProcessAfterInisialisasi memproses perilaku, karena proksi digunakan untuk memproses perilaku, yang dapat menyebabkan hilangnya anotasi. Itu sebabnya perilaku berubah di tempat terakhir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di mana kustomisasi? Kita dapat menulis anotasi kami, BeanPostProcessor untuk itu, dan Spring akan memprosesnya. Namun, agar BeanPostProcessor berfungsi, ia juga harus terdaftar sebagai kacang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Misalnya, untuk menyematkan nomor acak dalam bidang, kami membuat anotasi InjectRandomInt (tergantung di bidang), membuat dan mendaftarkan InjectRandomIntBeanPostProcessor, dengan metode pertama yang kami proses anotasi yang dibuat, dan dalam metode kedua, kami cukup mengembalikan kacang yang masuk.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk profil kacang, membuat anotasi Profil yang disiarkan ke metode, membuat dan mendaftarkan ProfileBeanPostProcessor, dengan metode pertama di mana kita mengembalikan kacang yang masuk, dan dalam metode kedua, kita mengembalikan proxy yang membungkus panggilan ke metode asli dengan kliping dan waktu eksekusi logging.</font></font><br>
<br>
<hr><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pelajari lebih lanjut tentang kursus</font></font></a><br>
<br>
<hr></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id501914/index.html">Stream Modern Web Live 2020 - Praktik UX Terbaik di Masa Tak Terbatas</a></li>
<li><a href="../id501918/index.html">Buku "Desain Game. Resep untuk kesuksesan game komputer terbaik dari Super Mario dan Doom hingga Assassin's Creed dan ¬ª</a></li>
<li><a href="../id501922/index.html">IOT di mana Anda tidak menunggu. Pengembangan dan pengujian (bagian 1)</a></li>
<li><a href="../id501924/index.html">Bagaimana cara membuat diagram venn dengan 50 lingkaran? Visualisasi set dan sejarah proyek Python open source saya</a></li>
<li><a href="../id501928/index.html">PM mitap online dengan pembicara dari Atlassian (Jira), Wrike dan Productboard</a></li>
<li><a href="../id501932/index.html">Mempercepat implementasi proyek AI dalam holding hutan Segezha</a></li>
<li><a href="../id501934/index.html">Publikasikan pustaka desain komponen VKUI dalam Figma</a></li>
<li><a href="../id501938/index.html">Prometheus, jangan pergi: 6 alat pemantauan alternatif untuk Kubernetes</a></li>
<li><a href="../id501940/index.html">Sedikit tentang Neutralino.js</a></li>
<li><a href="../id501942/index.html">Metode Kanban: Memahami Proses Anda sebagai Proses Pembelajaran Kolektif</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>