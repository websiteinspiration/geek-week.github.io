<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧜🏻 🤴🏿 🔟 Erstellen von Python-Bindungen für C / C ++ - Bibliotheken mit SIP. Teil 1 🎵 🙅🏿 🗒️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Während der Arbeit an einem Projekt in Python besteht manchmal der Wunsch, eine Bibliothek zu verwenden, die nicht in Python geschrieben ist, sondern ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Erstellen von Python-Bindungen für C / C ++ - Bibliotheken mit SIP. Teil 1</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/495480/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Während der Arbeit an einem Projekt in Python besteht manchmal der Wunsch, eine Bibliothek zu verwenden, die nicht in Python geschrieben ist, sondern beispielsweise in C oder C ++. Die Gründe dafür mögen unterschiedlich sein. Erstens ist Python eine wunderbare Sprache, aber in einigen Situationen ist sie nicht schnell genug. Wenn Sie feststellen, dass die Leistung durch die Funktionen der Python-Sprache eingeschränkt ist, ist es sinnvoll, einen Teil des Programms in einer anderen Sprache zu schreiben (in diesem Artikel werden wir über C und C ++ sprechen), diesen Teil des Programms als Bibliothek anzuordnen und Python-Bindungen (Python-Bindungen) zu erstellen. darüber und verwenden Sie das so erhaltene Modul als normale Python-Bibliothek. Zweitens tritt eine Situation häufig auf, wenn Sie wissen, dass es eine Bibliothek gibt, die das erforderliche Problem löst. Leider ist diese Bibliothek nicht in Python geschrieben, sondern in demselben C oder C ++.In diesem Fall können wir auch eine Python-Bindung über die Bibliothek erstellen und verwenden, ohne daran zu denken, dass die Bibliothek ursprünglich nicht in Python geschrieben wurde.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt verschiedene Tools zum Erstellen von Python-Bindungen, von untergeordneten wie der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python / C-API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bis zu übergeordneten wie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SWIG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hatte nicht das Ziel, verschiedene Arten der Erstellung von Python-Bindungen zu vergleichen, aber ich möchte über die Grundlagen der Verwendung eines Tools sprechen, nämlich </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ursprünglich wurde SIP entwickelt, um eine Bindung um die Qt-Bibliothek - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyQt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zu erstellen </font><font style="vertical-align: inherit;">, und wird auch zum Entwickeln anderer großer Python-Bibliotheken verwendet, z. B. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wxPython</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel wird gcc als Compiler für C und g ++ als C ++ - Compiler verwendet. </font><font style="vertical-align: inherit;">Alle Beispiele wurden unter Arch Linux und Python 3.8 getestet. </font><font style="vertical-align: inherit;">Um die Beispiele nicht zu komplizieren, wird das Thema Kompilierung für verschiedene Betriebssysteme und die Verwendung verschiedener Compiler (z. B. Visual Studio) nicht in den Umfang dieses Artikels aufgenommen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können alle Beispiele für diesen Artikel aus dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository auf github herunterladen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Repository mit SIP-Quellen befindet sich unter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.riverbankcomputing.com/hg/sip/</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mercurial wird als Versionskontrollsystem für SIP verwendet.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erstellen einer Bindung über eine Bibliothek in C.</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schreiben einer Bibliothek in C.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieses Beispiel befindet sich im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in der Quelle, aber in diesem Artikel gehen wir davon aus, dass wir alles von Grund auf neu machen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit einem einfachen Beispiel. </font><font style="vertical-align: inherit;">Zuerst erstellen wir eine einfache C-Bibliothek, die wir dann über ein Python-Skript ausführen. </font><font style="vertical-align: inherit;">Lassen Sie unsere Bibliothek die einzige Funktion sein</font></font><br>
<br>
<pre><code class="plaintext hljs">int foo(char*);
</code></pre><br><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Dies</font></i><font style="vertical-align: inherit;"> 
nimmt einen String und gibt seine Länge multipliziert mit 2 zurück. Die </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Header-Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sieht beispielsweise folgendermaßen aus:</font></font><br>
<br>
<pre><code class="plaintext hljs">#ifndef FOO_LIB<font></font>
#define FOO_LIB<font></font>
<font></font>
int foo(char* str);<font></font>
<font></font>
#endif<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und die Datei mit der Implementierung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.cpp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;string.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int foo(char* str) {<font></font>
	return strlen(str) * 2;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Funktionalität der Bibliothek zu testen, schreiben wir ein einfaches </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.c-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programm </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">#include &lt;stdio.h&gt;<font></font>
<font></font>
#include "foo.h"<font></font>
<font></font>
int main(int argc, char* argv[]) {<font></font>
	char* str = "0123456789";<font></font>
	printf("%d\n", foo(str));<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie aus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gründen der</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Genauigkeit ein </font><i><font style="vertical-align: inherit;">Makefile</font></i><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">CC=gcc<font></font>
CFLAGS=-c<font></font>
DIR_OUT=bin<font></font>
<font></font>
all: main<font></font>
<font></font>
main: main.o libfoo.a<font></font>
	$(CC) $(DIR_OUT)/main.o -L$(DIR_OUT) -lfoo -o $(DIR_OUT)/main<font></font>
<font></font>
main.o: makedir main.c<font></font>
	$(CC) $(CFLAGS) main.c -o $(DIR_OUT)/main.o<font></font>
<font></font>
libfoo.a: makedir foo.c<font></font>
	$(CC) $(CFLAGS) foo.c -o $(DIR_OUT)/foo.o<font></font>
	ar rcs $(DIR_OUT)/libfoo.a $(DIR_OUT)/foo.o<font></font>
<font></font>
makedir:<font></font>
	mkdir -p $(DIR_OUT)<font></font>
<font></font>
clean:<font></font>
	rm -rf $(DIR_OUT)/*<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie alle Quellen der Bibliothek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in einem Unterordner von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Quellordner liegen:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    └── Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir gehen in den Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und kompilieren die Quellen mit dem Befehl</font></font><br>
<br>
<pre><code class="bash hljs">make
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Während der Kompilierung wird der Text angezeigt.</font></font><br>
<br>
<pre><code class="bash hljs">mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Übersetzungsergebnis wird in der platziert werden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><font style="vertical-align: inherit;">innerhalb des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Bin── bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │ ├ foo.o.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │ ├ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │ ├ Haupt</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    │ └ main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ├── main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    └── Makefile</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben eine Bibliothek für statische Verknüpfungen und ein Programm zusammengestellt, das sie unter dem Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main verwendet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nach dem Kompilieren können Sie überprüfen, ob das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hauptprogramm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gestartet wird </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns eine Python-Bindung über die foo-Bibliothek erstellen.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SIP-Grundlagen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst müssen Sie SIP installieren. </font><font style="vertical-align: inherit;">Dies erfolgt standardmäßig wie bei allen anderen Bibliotheken, die pip verwenden:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user sip
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie in einer virtuellen Umgebung arbeiten, sollte der Parameter --user, der angibt, dass die SIP-Bibliothek im Benutzerordner und nicht global im System installiert werden muss, natürlich nicht angegeben werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was müssen wir tun, damit die foo-Bibliothek aus Python-Code aufgerufen werden kann? Sie müssen mindestens zwei Dateien erstellen: eine im TOML-Format und den Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und die zweite ist eine Datei mit der Erweiterung .sip. Lassen Sie uns nacheinander mit jedem von ihnen umgehen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir müssen uns auf die Struktur der Quelle einigen. Im </font><font style="vertical-align: inherit;">Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befindet sich der Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der die Quelle für die Bibliothek enthält. Nach der Kompilierung </font><font style="vertical-align: inherit;">wird der Ordner </font><i><font style="vertical-align: inherit;">bin im</font></i><font style="vertical-align: inherit;"> Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo erstellt</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die alle kompilierten Dateien enthält. </font><font style="vertical-align: inherit;">Später werden wir dem Benutzer die Möglichkeit hinzufügen, die Pfade zu den Header- und Objektdateien der Bibliothek über die Befehlszeile anzugeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die für SIP erforderlichen Dateien befinden sich im selben Ordner wie der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyproject.toml</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist keine Erfindung von SIP-Entwicklern, sondern das Python-Projektbeschreibungsformat, das in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 517 „Ein vom Buildsystem unabhängiges Format für Quellbäume“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518 „Festlegen der Mindestanforderungen an das Buildsystem für Python-Projekte“ beschrieben ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies ist eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TOML-Datei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die als fortgeschrittenere Version des INI-Formats betrachtet werden kann, in der die Parameter in Form von „Schlüssel = Wert“ gespeichert sind und die Parameter nicht nur in Abschnitten wie [foo] gespeichert werden können, die in TOML-Begriffen als Tabellen bezeichnet werden, sondern und in Unterabschnitten des Formulars [foo.bar.spam]. Parameter können nicht nur Zeichenfolgen, sondern auch Listen, Zahlen und Boolesche Werte enthalten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Datei soll alles beschreiben, was zum Erstellen eines Python-Pakets erforderlich ist und nicht unbedingt SIP verwendet. </font><font style="vertical-align: inherit;">Wie wir jedoch etwas später sehen werden, reicht diese Datei in einigen Fällen nicht aus, und außerdem muss ein kleines Python-Skript erstellt werden. </font><font style="vertical-align: inherit;">Aber lassen Sie uns über alles in Ordnung sprechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine vollständige Beschreibung aller möglichen Parameter der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die sich auf SIP beziehen, finden Sie auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der SIP-Dokumentationsseite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Erstellen</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sie in unserem Beispiel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> auf derselben Ebene wie der Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── foo.o.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ Haupt</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ └── main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ └ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Inhalt von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lautet wie folgt:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.1"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Abschnitt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Build-System]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ("Tabelle" in TOML-Begriffen) ist Standard und wird in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 518 beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Es enthält zwei Parameter:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erfordert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine Liste der Pakete, die zum Erstellen unseres Pakets benötigt werden. </font><font style="vertical-align: inherit;">Das Beschreibungsformat für die Paketabhängigkeit ist in der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 508-Abhängigkeitsspezifikation für Python-Softwarepakete beschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In diesem Fall benötigen wir nur das sip-Paket Version 5.x.</font></font></li>
<li><i>build-backend</i> ,        .  ,          Python-,    .        ,   ,    SIP,     «sipbuild.api».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Weitere Parameter sind in den Abschnitten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip. *] Beschrieben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Abschnitt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enthält allgemeine Informationen zum Paket: den Namen des zu erstellenden Pakets (unser Paket heißt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber verwechseln Sie diesen Namen nicht mit dem Namen des Moduls, das wir später in Python importieren werden), die Versionsnummer des Pakets (in unserem Fall) Versionsnummer "0.1") und Lizenz (zum Beispiel " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MIT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das aus Sicht der Baugruppe wichtigste ist in den [tool.sip.bindings] beschrieben. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notieren Sie den Paketnamen in der Abschnittsüberschrift. </font><font style="vertical-align: inherit;">Wir haben diesem Abschnitt zwei Parameter hinzugefügt:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Header</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Eine Liste der Header-Dateien, die zur Verwendung der foo-Bibliothek benötigt werden.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliotheken</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Eine Liste von Objektdateien, die für die statische Verknüpfung zusammengestellt wurden.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Pfad, in dem neben den an den C-Compiler angehängten Header-Dateien nach weiteren Header-Dateien </font><i><font style="vertical-align: inherit;">gesucht</font></i><font style="vertical-align: inherit;"> wird. In diesem Fall wird nach der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h gesucht</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Pfad, in dem neben den an den C-Compiler angehängten Objektdateien nach weiteren Objektdateien </font><i><font style="vertical-align: inherit;">gesucht werden kann</font></i><font style="vertical-align: inherit;"> . In diesem Fall ist dies der Ordner, in dem die kompilierte Bibliotheksdatei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo erstellt wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also haben wir die erste notwendige Datei für SIP erstellt. </font><font style="vertical-align: inherit;">Nun fahren wir mit der Erstellung der nächsten Datei fort, die den Inhalt des zukünftigen Python-Moduls beschreibt.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pyfoo.sip</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im selben Ordner wie die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_c_01 /</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── foo.o.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ Haupt</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ └── main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ └ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Datei mit der Erweiterung .sip beschreibt die Schnittstelle der Quellbibliothek, die in Python in ein Modul konvertiert wird. </font><font style="vertical-align: inherit;">Diese Datei hat ein eigenes Format, das wir nun betrachten werden, und ähnelt der C / C ++ - Headerdatei mit zusätzlichem Markup, das SIP beim Erstellen eines Python-Moduls helfen soll. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unserem Beispiel sollte diese Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> heißen </font><font style="vertical-align: inherit;">, da </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">zuvor in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><font style="vertical-align: inherit;">[tool.sip.bindings erstellt haben. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]. Im allgemeinen Fall kann es mehrere solcher Partitionen geben, und dementsprechend müssen mehrere * .sip-Dateien vorhanden sein. Wenn wir jedoch mehrere SIP-Dateien haben, ist dies aus Sicht von SIP ein Sonderfall, den wir in diesem Artikel nicht berücksichtigen werden. Bitte beachten Sie, dass im Allgemeinen der Name der .sip-Datei (und dementsprechend der Name des Abschnitts) möglicherweise nicht mit dem Namen des Pakets übereinstimmt, der im Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Abschnitt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.metadata] angegeben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus unserem Beispiel:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo, language=<span class="hljs-string">"C"</span>)<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zeilen, die mit dem Zeichen "%" beginnen, werden als Direktiven bezeichnet. Sie sollten SIP mitteilen, wie das Python-Modul richtig zusammengesetzt und gestaltet werden soll. Eine vollständige Liste der Anweisungen finden Sie auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dieser Dokumentationsseite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Einige Anweisungen haben zusätzliche Parameter. Parameter sind möglicherweise nicht erforderlich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel verwenden wir zwei Anweisungen. In den folgenden Beispielen lernen wir einige andere Anweisungen kennen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beginnt mit der Direktive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module (Name = foo, Sprache = "C")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bitte beachten Sie, dass </font><font style="vertical-align: inherit;">wir den </font><font style="vertical-align: inherit;">Wert des ersten Parameters ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ohne Anführungszeichen und den Wert des zweiten Parameters ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprache) angegeben haben</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) mit Anführungszeichen, wie Zeichenfolgen in C / C ++. </font><font style="vertical-align: inherit;">Dies ist eine Anforderung dieser Direktive, wie in der Dokumentation zur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direktive beschrieben </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Direktive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font><font style="vertical-align: inherit;">nur der Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erforderlich </font><font style="vertical-align: inherit;">, der den Namen des Python-Moduls festlegt, aus dem die Bibliotheksfunktion importiert wird. </font><font style="vertical-align: inherit;">In diesem Fall heißt das Modul </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und enthält die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nach der Montage und Installation importieren wir es mit dem folgenden Code:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir könnten dieses Modul in einem anderen Modul verschachteln, indem wir diese Zeile beispielsweise durch Folgendes ersetzen:</font></font><br>
<br>
<pre><code class="cpp hljs">%Module(name=foo.bar, language=<span class="hljs-string">"C"</span>)<font></font>
...<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">müsste</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Funktion </font><i><font style="vertical-align: inherit;">foo</font></i><font style="vertical-align: inherit;"> wie folgt </font><font style="vertical-align: inherit;">importiert </font><font style="vertical-align: inherit;">werden:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> foo.bar <span class="hljs-keyword">import</span> foo
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sprachparameter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Module-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direktive </font><font style="vertical-align: inherit;">gibt die Sprache an, in der die Quellbibliothek geschrieben ist. </font><font style="vertical-align: inherit;">Der Wert dieses Parameters kann entweder "C" oder "C ++" sein. </font><font style="vertical-align: inherit;">Wenn dieser Parameter nicht angegeben wird, geht SIP davon aus, dass die Bibliothek in C ++ geschrieben ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen Sie sich nun die letzte Zeile der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">char</span>*)</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist eine Beschreibung der Schnittstelle der Funktion aus der Bibliothek, die wir in das Python-Modul einfügen möchten. </font><font style="vertical-align: inherit;">Basierend auf dieser Deklaration erstellt sip eine Python-Funktion. </font><font style="vertical-align: inherit;">Ich denke, dass hier alles klar sein sollte.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir sammeln und prüfen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt ist alles bereit, um ein Python-Paket mit einer Bindung für eine C-Bibliothek zu erstellen. Zunächst müssen Sie die Bibliothek selbst erstellen. </font><font style="vertical-align: inherit;">Gehen Sie zum Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01 / foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und starten Sie den Build mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="bash hljs">$ make<font></font>
<font></font>
mkdir -p bin<font></font>
gcc -c main.c -o bin/main.o<font></font>
gcc -c foo.c -o bin/foo.o<font></font>
ar rcs bin/libfoo.a bin/foo.o<font></font>
gcc bin/main.o -Lbin -lfoo -o bin/main<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn alles gut gegangen ist, wird der </font><font style="vertical-align: inherit;">Ordner </font><i><font style="vertical-align: inherit;">bin im</font></i><font style="vertical-align: inherit;"> Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo erstellt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in dem sich unter anderem eine kompilierte </font><i><font style="vertical-align: inherit;">libfoo.a-</font></i><font style="vertical-align: inherit;"> Bibliothek befindet </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ich möchte Sie daran erinnern, dass wir hier, um nicht vom Hauptthema abgelenkt zu werden, nur über das Erstellen unter Linux mit gcc sprechen. </font><font style="vertical-align: inherit;">
Gehen Sie zurück zum Ordner </font><i><font style="vertical-align: inherit;">pyfoo_c_01</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jetzt ist es Zeit, die SIP-Teams kennenzulernen. </font><font style="vertical-align: inherit;">Nach der Installation von SIP werden die folgenden Befehlszeilenbefehle verfügbar ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">Dokumentationsseite</font></a><font style="vertical-align: inherit;"> ):</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schluck bauen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Erstellt eine Python-Erweiterungsobjektdatei.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Erstellt eine Python-Erweiterungsobjektdatei und installiert sie.</font></font></li>
<li><i>sip-sdist</i>.      .tar.gz,      pip.</li>
<li><i>sip-wheel</i>.     wheel (   .whl).</li>
<li><i>sip-module</i>.  ,      ,   SIP.  ,    ,    .         ,       standalone project,      ,     ,     ,    .</li>
<li><i>sip-distinfo</i>.     <i>.dist-info</i>,       wheel.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Befehle müssen in dem Ordner ausgeführt werden, in dem sich die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befindet </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um zu beginnen und die Funktionsweise von SIP besser zu verstehen, führen Sie den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit der Option </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--verbose aus,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> um eine detailliertere Ausgabe an die Konsole zu erhalten, und sehen Sie, was während des Erstellungsprozesses passiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build --verbose</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Diese Bindungen werden erstellt: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Generieren der Pyfoo-Bindungen ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilieren des 'foo'-Moduls ... </font><font style="vertical-align: inherit;">
Erstellen der </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
' </font><font style="vertical-align: inherit;">
foo'- </font><font style="vertical-align: inherit;">Erweiterung </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eines Builds Erstellen von build / temp.linux-x86_64-3.8</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c sipfoocmodule.c -o build / temp.linux-x86_64-3.8 / sipfoocmodule.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: In der Funktion </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
func_foo </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">sipfoocmodule .c: 29: 22: Warnung: implizite Funktionsdeklaration “foo” [-Wimplicit-Funktionsdeklaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c array.c -o build / temp.linux-x86_64-3.8 / array.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c bool.cpp -o build / temp.linux-x86_64-3.8 / bool.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c objmap.c -o build / temp.linux-x86_64-3.8 / objmap.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c qtlib.c -o build / temp.linux-x86_64-3.8 / qtlib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c int_convertors.c -o build / temp.linux-x86_64-3.8 / int_convertors.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c voidptr.c -o build / temp.linux-x86_64-3.8 / voidptr.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c apiversions.c -o build / temp.linux-x86_64-3.8 / apiversions.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c deskriptoren.c -o build / temp.linux-x86_64-3.8 / deskriptoren.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unbenutztes-Ergebnis -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c threads.c -o build / temp.linux-x86_64-3.8 / threads.o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gcc -pthread -Wno-unused-result -Wsign -compare -DNDEBUG -g -fwrapv -O3 -Wall -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -fno-semantic-interposition -march = x86-64 -mtune = generic -O3 -pipe -fno-plt -march = x86-64 -mtune = generisch -O3 -pipe -fno-plt -fPIC -DSIP_PROTECTED_IS_PUBLIC -Dprotected = public -I. -I ../../ foo -I / usr / include / python3.8 -c siplib.c -o build / temp.linux-x86_64-3.8 / siplib.o</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: In der Funktion "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: Warnung: "st" darf ohne Initialisierung in dieser Funktion [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | verwendet werden slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
~~~~~~~~~~~~~~~~~~~~~~~~~ siplib.c: 10671: 19: Anmerkung: “st” wurde hier deklariert </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: In der Funktion "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: Warnung: "owner" kann ohne Initialisierung in dieser Funktion verwendet werden [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * owner = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~~ ^ ~</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
g ++ -pthread -shared -Wl, -O1, - sort-common, - nach Bedarf, -z, relro, -z, jetzt -fno-semantic-interposition -Wl, -O1, - sort-common, - wie benötigt, -z, relro, -z, jetzt build / temp.linux-x86_64-3.8 / sipfoocmodule.o build / temp.linux-x86_64-3.8 / array.o build / temp.linux-x86_64-3.8 /bool.o build / temp.linux-x86_64-3.8 / objmap.o build / temp.linux-x86_64-3.8 / qtlib.o build / temp.linux-x86_64-3.8 / int_convertors.o build / temp.linux-x86_64 -3.8 / voidptr.o build / temp.linux-x86_64-3.8 / apiversions.o build / temp.linux-x86_64-3.8 / deskriptoren.o build / temp.linux-x86_64-3.8 / threads.o build / temp.linux -x86_64-3.8 / siplib.o -L ../../ foo / bin -L / usr / lib -lfoo -o / home / jenyay / projects / soft / sip-examples / pyfoo_c_01 / build / foo / foo. cpython-38-x86_64-linux-gnu.so </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Projekt wurde erstellt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden nicht tief in die Arbeit von SIP einsteigen, aber aus der Ausgabe geht hervor, dass einige Quellen kompilieren. </font><font style="vertical-align: inherit;">Diese Quellen befinden sich im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo /,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der mit diesem Befehl erstellt wurde </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── bauen</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ └ foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ apiversions.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ array.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ array.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ bool.cpp</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ bauen</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ └ temp.linux-x86_64-3.8</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ivers │ ├─ivers apiversions.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ array.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ bool.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ DESkriptoren.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ int_convertors.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── objmap.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ qtlib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── sipfoocmodule.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── siplib.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── threads.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ └ voidptr.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ Deskriptoren.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.cpython-38-x86_64-linux-gnu.so</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ int_convertors.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ objmap.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ qtlib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ sipAPIfoo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ sipfoocmodule.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ sip.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ sipint.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ siplib.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ threads.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ └ voidptr.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── foo</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ bin</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├── foo.o.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ libfoo.a</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ ├ Haupt</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ │ └── main.o</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ foo.h</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ ├ main.c</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
│ └ Makefile</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
├── pyfoo.sip</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
└── pyproject.toml</font></font><font></font>
</pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusätzliche Quellen wurden </font><font style="vertical-align: inherit;">
im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angezeigt </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Schauen wir uns aus Neugier die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipfoocmodule.c an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da sie sich direkt </font><font style="vertical-align: inherit;">auf das zu </font><i><font style="vertical-align: inherit;">erstellende </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modul bezieht </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="plaintext hljs">/*<font></font>
 * Module code.<font></font>
 *<font></font>
 * Generated by SIP 5.1.1<font></font>
 */<font></font>
<font></font>
#include "sipAPIfoo.h"<font></font>
<font></font>
/* Define the strings used by this module. */<font></font>
const char sipStrings_foo[] = {<font></font>
    'f', 'o', 'o', 0,<font></font>
};<font></font>
<font></font>
PyDoc_STRVAR(doc_foo, "foo(str) -&gt; int");<font></font>
<font></font>
static PyObject *func_foo(PyObject *sipSelf,PyObject *sipArgs)<font></font>
{<font></font>
    PyObject *sipParseErr = SIP_NULLPTR;<font></font>
<font></font>
    {<font></font>
        char* a0;<font></font>
<font></font>
        if (sipParseArgs(&amp;sipParseErr, sipArgs, "s", &amp;a0))<font></font>
        {<font></font>
            int sipRes;<font></font>
<font></font>
            sipRes = foo(a0);<font></font>
<font></font>
            return PyLong_FromLong(sipRes);<font></font>
        }<font></font>
    }<font></font>
<font></font>
    /* Raise an exception if the arguments couldn't be parsed. */<font></font>
    sipNoFunction(sipParseErr, sipName_foo, doc_foo);<font></font>
<font></font>
    return SIP_NULLPTR;<font></font>
}<font></font>
<font></font>
/* This defines this module. */<font></font>
sipExportedModuleDef sipModuleAPI_foo = {<font></font>
    0,<font></font>
    SIP_ABI_MINOR_VERSION,<font></font>
    sipNameNr_foo,<font></font>
    0,<font></font>
    sipStrings_foo,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    0,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    {SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR,<font></font>
            SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR, SIP_NULLPTR},<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR,<font></font>
    SIP_NULLPTR<font></font>
};<font></font>
<font></font>
/* The SIP API and the APIs of any imported modules. */<font></font>
const sipAPIDef *sipAPI_foo;<font></font>
<font></font>
/* The Python module initialisation function. */<font></font>
#if defined(SIP_STATIC_MODULE)<font></font>
PyObject *PyInit_foo(void)<font></font>
#else<font></font>
PyMODINIT_FUNC PyInit_foo(void)<font></font>
#endif<font></font>
{<font></font>
    static PyMethodDef sip_methods[] = {<font></font>
        {sipName_foo, func_foo, METH_VARARGS, doc_foo},<font></font>
        {SIP_NULLPTR, SIP_NULLPTR, 0, SIP_NULLPTR}<font></font>
    };<font></font>
<font></font>
    static PyModuleDef sip_module_def = {<font></font>
        PyModuleDef_HEAD_INIT,<font></font>
        "foo",<font></font>
        SIP_NULLPTR,<font></font>
        -1,<font></font>
        sip_methods,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR,<font></font>
        SIP_NULLPTR<font></font>
    };<font></font>
<font></font>
    PyObject *sipModule, *sipModuleDict;<font></font>
    /* Initialise the module and get it's dictionary. */<font></font>
    if ((sipModule = PyModule_Create(&amp;sip_module_def)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    sipModuleDict = PyModule_GetDict(sipModule);<font></font>
<font></font>
    if ((sipAPI_foo = sip_init_library(sipModuleDict)) == SIP_NULLPTR)<font></font>
        return SIP_NULLPTR;<font></font>
<font></font>
    /* Export the module and publish it's API. */<font></font>
    if (sipExportModule(&amp;sipModuleAPI_foo, SIP_ABI_MAJOR_VERSION, SIP_ABI_MINOR_VERSION, 0) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
    /* Initialise the module now all its dependencies have been set up. */<font></font>
    if (sipInitModule(&amp;sipModuleAPI_foo,sipModuleDict) &lt; 0)<font></font>
    {<font></font>
        Py_DECREF(sipModule);<font></font>
        return SIP_NULLPTR;<font></font>
    }<font></font>
<font></font>
    return sipModule;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie mit der Python / C-API gearbeitet haben, werden Ihnen bekannte Funktionen angezeigt. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Achten Sie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> besonders auf die Funktion </font><i><font style="vertical-align: inherit;">func_foo</font></i><font style="vertical-align: inherit;"> ab Zeile 18. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis der Kompilierung dieser Quellen wird die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build / foo / foo.cpython-38-x86_64-linux-gnu.so</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellt </font><font style="vertical-align: inherit;">und enthält die Python-Erweiterung, die noch korrekt installiert werden muss. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Erweiterung zu kompilieren und sofort zu installieren, können Sie den Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install verwenden.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wir verwenden ihn jedoch nicht, da standardmäßig versucht wird, die erstellte Python-Erweiterung global im System zu installieren. Dieser Befehl hat den Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--target-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mit dem Sie den Pfad angeben können, unter dem Sie die Erweiterung installieren möchten. Wir verwenden jedoch besser andere Tools, die Pakete erstellen, die dann mit pip installiert werden können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie zuerst den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Die Verwendung ist sehr einfach:</font></font><br>
<br>
<pre><code class="bash hljs">$ sip-sdist<font></font>
<font></font>
The sdist has been built.<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach wird die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1.tar.gz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellt </font><font style="vertical-align: inherit;">, die mit dem folgenden Befehl installiert werden kann:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user pyfoo-0.1.tar.gz
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis werden die folgenden Informationen angezeigt und das Paket wird installiert:</font></font><br>
<br>
<pre><code class="plaintext hljs">Processing ./pyfoo-0.1.tar.gz<font></font>
  Installing build dependencies ... done<font></font>
  Getting requirements to build wheel ... done<font></font>
    Preparing wheel metadata ... done<font></font>
Building wheels for collected packages: pyfoo<font></font>
  Building wheel for pyfoo (PEP 517) ... done<font></font>
  Created wheel for pyfoo: filename=pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl size=337289 sha256=762fc578...<font></font>
  Stored in directory: /home/jenyay/.cache/pip/wheels/54/dc/d8/cc534fff...<font></font>
Successfully built pyfoo<font></font>
Installing collected packages: pyfoo<font></font>
  Attempting uninstall: pyfoo<font></font>
    Found existing installation: pyfoo 0.1<font></font>
    Uninstalling pyfoo-0.1:<font></font>
      Successfully uninstalled pyfoo-0.1<font></font>
Successfully installed pyfoo-0.1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir sicher, dass es uns gelungen ist, eine Python-Bindung herzustellen. </font><font style="vertical-align: inherit;">Wir starten Python und versuchen, die Funktion aufzurufen. </font><font style="vertical-align: inherit;">Ich </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">möchte</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie daran erinnern, dass das </font><i><font style="vertical-align: inherit;">pyfoo-</font></i><font style="vertical-align: inherit;"> Paket gemäß unseren Einstellungen </font><font style="vertical-align: inherit;">das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modul enthält </font><font style="vertical-align: inherit;">, das die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion hat </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'123456'</span>)
<span class="hljs-number">12</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bitte beachten Sie, dass wir als Parameter für die Funktion nicht nur eine Zeichenfolge übergeben, sondern eine Zeichenfolge von Bytes b'123456 '- ein direktes Analogon von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu C. Wenig später werden wir die Konvertierung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinzufügen </font><font style="vertical-align: inherit;">und umgekehrt. Das Ergebnis wurde erwartet. Ich möchte Sie daran erinnern, dass die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die doppelte Größe eines Arrays vom Typ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zurückgibt </font><font style="vertical-align: inherit;">, das als Parameter übergeben wurde. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Versuchen wir, </font><font style="vertical-align: inherit;">anstelle einer Liste von Bytes </font><font style="vertical-align: inherit;">einen </font><font style="vertical-align: inherit;">regulären Python-String </font><font style="vertical-align: inherit;">an die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">zu übergeben.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'123456'</span>)<font></font>
<font></font>
Traceback (most recent call last):<font></font>
  File <span class="hljs-string">"&lt;stdin&gt;"</span>, line <span class="hljs-number">1</span>, <span class="hljs-keyword">in</span> &lt;module&gt;<font></font>
TypeError: foo(str): argument <span class="hljs-number">1</span> has unexpected type <span class="hljs-string">'str'</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die erstellte Bindung konnte die Zeichenfolge nicht in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konvertieren </font><font style="vertical-align: inherit;">. Wir werden im nächsten Abschnitt erläutern, wie dies zu tun ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Herzlichen Glückwunsch, wir haben die erste Bindung für eine in C geschriebene Bibliothek erstellt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beenden Sie den Python-Interpreter und setzen Sie die Baugruppe im Radformat zusammen. Wie Sie höchstwahrscheinlich wissen, ist Wheel ein relativ neues Paketformat, das in letzter Zeit allgemein verwendet wurde. Das Format ist in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PEP 427, „Das Wheel Binary Package Format 1.0“ beschrieben,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aber eine Beschreibung der Funktionen des Wheel-Formats ist ein Thema, das eines separaten großen Artikels würdig ist. Für uns ist es wichtig, dass der Benutzer das Paket mit pip einfach im Radformat installieren kann. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Paket im Radformat ist nicht komplizierter als ein Paket im SDIST-Format. Dazu im Ordner mit der Datei</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muss den Befehl ausführen</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Ausführen dieses Befehls wird der Erstellungsprozess angezeigt und möglicherweise werden vom Compiler Warnungen </font><font style="vertical-align: inherit;">
ausgegeben </font><font style="vertical-align: inherit;">: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ sip-Wheel </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Bindungen werden erstellt: pyfoo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Generieren der Pyfoo-Bindungen ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilieren des 'foo'-Moduls ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: In der Funktion func_foo: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sipfoocmodule.c: 29: 22: Warnung: implizite Deklaration der foo-Funktion [-Wimplicit-Funktionsdeklaration] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 29 | sipRes = foo (a0); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: In der Funktion "slot_richcompare": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 9536: 16: Warnung: "st" kann ohne Initialisierung in dieser Funktion verwendet werden [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 9536 | slot = findSlotInClass (ctd, st); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
~~~~~~~~~~~~~~~~~~~~~~~~~ siplib.c: 10671: 19: Bemerkung: „st“ wurde hier deklariert</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
10671 | sipPySlotType st; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ^ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: In der Funktion "parsePass2": </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
siplib.c: 5625: 32: Warnung: "owner" kann ohne Initialisierung in dieser Funktion verwendet werden [-Wmaybe-uninitialized] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 5625 | * owner = arg; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 | ~~~~~~~~ ^ ~ ~ </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Rad wurde gebaut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn die Assembly abgeschlossen ist (unser kleines Projekt wird schnell kompiliert), wird im Projektordner eine Datei mit dem Namen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder ähnlichem </font><i><font style="vertical-align: inherit;">angezeigt</font></i><font style="vertical-align: inherit;"> . Der Name der generierten Datei kann je nach Betriebssystem und Version von Python unterschiedlich sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt können wir dieses Paket mit pip installieren:</font></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.1-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Option </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--upgrade</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird </font><i><font style="vertical-align: inherit;">hier</font></i><font style="vertical-align: inherit;"> verwendet </font><i><font style="vertical-align: inherit;">,</font></i><font style="vertical-align: inherit;"> damit pip das zuvor installierte pyfoo-Modul ersetzt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ferner können das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modul </font><font style="vertical-align: inherit;">und das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket </font><font style="vertical-align: inherit;">wie oben gezeigt verwendet werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fügen Sie char * Konvertierungsregeln hinzu</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im vorherigen Abschnitt ist das Problem aufgetreten, dass die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nur eine Reihe von Bytes, keine Zeichenfolgen akzeptieren kann. Jetzt werden wir dieses Manko beheben. Zu diesem Zweck verwenden wir ein anderes SIP-Tool - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anmerkungen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Anmerkungen werden in .sip-Dateien verwendet und auf einige Codeelemente angewendet: Funktionen, Klassen, Funktionsargumente, Ausnahmen, Variablen usw. Anmerkungen werden zwischen Schrägstrichen geschrieben: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ annotation /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Annotation kann als Flag fungieren, das in dem Status gesetzt oder nicht gesetzt sein kann, zum Beispiel: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ReleaseGIL /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oder einigen Annotationen müssen einige Werte zugewiesen werden, zum Beispiel: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Encoding = "UTF-8" /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn mehrere Anmerkungen auf ein Objekt angewendet werden müssen, werden sie durch Kommas in Schrägstrichen getrennt: / annotation_1, annotation_2 /. </font><i><font style="vertical-align: inherit;">Fügen Sie</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
im folgenden Beispiel, das sich im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02 befindet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , eine Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip hinzu.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Annotation parameter function </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
<font></font>
int foo(char* /Encoding="UTF-8"/);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Annotation " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codierung"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gibt an, in welcher Codierung die an die Funktion zu übergebende Zeichenfolge codiert werden soll. Die Werte für diese Anmerkung können sein: ASCII, Latin-1, UTF-8 oder None. Wenn die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Annodation "Codierung"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht angegeben oder gleich " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keine" ist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wird der Parameter für eine solche Funktion keiner Codierung unterzogen und unverändert an die Funktion übergeben. In diesem Fall muss der Parameter im Python-Code jedoch vom Typ " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bytes" sein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , d. H. ein Array von Bytes, wie wir im vorherigen Beispiel gesehen haben. Wenn die Codierung angegeben ist, kann dieser Parameter eine Zeichenfolge sein (geben Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">str</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Python ein). </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kodieren</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Annotation </font><font style="vertical-align: inherit;">kann nur auf die </font><font style="vertical-align: inherit;">Parameter des Typs angewendet werden , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">const char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns überprüfen, wie die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moduls </font><font style="vertical-align: inherit;">jetzt funktioniert </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um dies zu </font><font style="vertical-align: inherit;">tun, wie zuvor, müssen Sie zuerst die kompilieren </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Bibliothek mit dem </font><font style="vertical-align: inherit;">Aufruf </font><font style="vertical-align: inherit;">des </font><i><font style="vertical-align: inherit;">make</font></i><font style="vertical-align: inherit;"> - Befehl </font><font style="vertical-align: inherit;">innerhalb des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Ordner </font><font style="vertical-align: inherit;">, und dann </font><font style="vertical-align: inherit;">rufen Sie </font><font style="vertical-align: inherit;">den Befehl zum Beispiel </font><i><font style="vertical-align: inherit;">sip-Rad,</font></i><font style="vertical-align: inherit;"> aus dem </font><i><font style="vertical-align: inherit;">pyfoo_c_02</font></i><font style="vertical-align: inherit;"> Beispiel Ordner </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die Datei </font><i><font style="vertical-align: inherit;">pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl</font></i><font style="vertical-align: inherit;"> oder mit einem ähnlichen Namen </font><font style="vertical-align: inherit;">wird erstellt </font><font style="vertical-align: inherit;">, die mit dem folgenden Befehl festgelegt werden kann:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.2-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn alles gut gegangen ist, starten Sie den Python-Interpreter und versuchen Sie, die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit einem String-Argument </font><font style="vertical-align: inherit;">aufzurufen </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">from</span> foo <span class="hljs-keyword">import</span> foo<font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">b'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">'qwerty'</span>)
<span class="hljs-number">12</span><font></font>
<font></font>
<span class="hljs-meta">&gt;&gt;&gt; </span>foo(<span class="hljs-string">''</span>)
<span class="hljs-number">24</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst stellen wir sicher, dass die Verwendung von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bytes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weiterhin möglich ist. Danach stellen wir sicher, dass wir jetzt auch </font><font style="vertical-align: inherit;">String-Argumente </font><font style="vertical-align: inherit;">an die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion übergeben können </font><font style="vertical-align: inherit;">. Beachten Sie, dass die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für ein Zeichenfolgenargument mit russischen Buchstaben einen doppelt so großen Wert zurückgab wie für eine Zeichenfolge, die nur lateinische Buchstaben enthält. Dies geschah aufgrund der Tatsache, dass die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht die Zeichenfolgenlänge in Zeichen zählt (und verdoppelt), sondern die Länge des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Arrays </font><font style="vertical-align: inherit;">. Da in UTF-8 die Codierung russischer Buchstaben 2 Bytes belegt, beträgt die Größe des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -Arrays </font><font style="vertical-align: inherit;">nach der Konvertierung von Python-Strings waren doppelt so lang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fein! Wir haben das Problem mit dem Funktionsargument gelöst</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber was ist, wenn wir Dutzende oder Hunderte solcher Funktionen in unserer Bibliothek haben, müssen Sie die Parametercodierung für jede von ihnen angeben? Oft ist die in einem Programm verwendete Codierung dieselbe, und es gibt keinen Zweck für unterschiedliche Funktionen, unterschiedliche Codierungen anzuzeigen. In diesem Fall kann SIP die Standardcodierung angeben. Wenn für eine Funktion eine andere Codierung erforderlich ist, kann diese mithilfe der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codierungsanmerkung</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neu definiert werden </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Codierung der Funktionsparameter standardmäßig </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">festzulegen, wird die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direktive </font><i><font style="vertical-align: inherit;">% DefaultEncoding verwendet</font></i><font style="vertical-align: inherit;"> . Die Verwendung wird im Beispiel im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03 gezeigt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ändern Sie die Datei </font><i><font style="vertical-align: inherit;">pyfoo.sip</font></i><font style="vertical-align: inherit;"> , um die </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Direktive </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding zu </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nutzen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, jetzt ist sein Inhalt wie folgt:</font></font><br>
<br>
<pre><code class="plaintext hljs">%Module(name=foo, language="C")<font></font>
%DefaultEncoding "UTF-8"<font></font>
<font></font>
int foo(char*);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn das Argument nun eine Funktion vom Typ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usw. ist. </font><font style="vertical-align: inherit;">Wenn </font><font style="vertical-align: inherit;">keine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encoding-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Annotation vorhanden ist </font><font style="vertical-align: inherit;">, wird die Codierung der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% DefaultEncoding-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direktive entnommen. </font><font style="vertical-align: inherit;">Wenn dies nicht </font><font style="vertical-align: inherit;">der </font><i><font style="vertical-align: inherit;">Fall</font></i><font style="vertical-align: inherit;"> ist, wird die Konvertierung nicht durchgeführt und für alle Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">char *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usw. </font><font style="vertical-align: inherit;">Es ist notwendig, keine Zeilen, sondern </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bytes zu übertragen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Beispiel aus dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><i><font style="vertical-align: inherit;">wird</font></i><font style="vertical-align: inherit;"> in der gleichen Weise wie ein Beispiel aus dem gesammelten und überprüft </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_02</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kurz über project.py. </font><font style="vertical-align: inherit;">Montage automatisieren</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bisher haben wir zwei Dienstprogrammdateien verwendet, um eine Python-Bindung zu erstellen - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo.sip</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jetzt werden wir eine andere solche Datei kennenlernen, die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> heißen sollte </font><font style="vertical-align: inherit;">. Mit diesem Skript können wir den Erstellungsprozess unseres Pakets beeinflussen. Lassen Sie uns die Build-Automatisierung durchführen. Um die Beispiele </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_01</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_03</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus den vorherigen Abschnitten </font><font style="vertical-align: inherit;">zu sammeln </font><font style="vertical-align: inherit;">, mussten Sie zuerst zum Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gehen </font><font style="vertical-align: inherit;">, dort mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kompilieren </font><font style="vertical-align: inherit;">, zu dem Ordner zurückkehren, in dem sich die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> befindet </font><i><font style="vertical-align: inherit;">,</font></i><font style="vertical-align: inherit;"> und erst dann mit einem der Pakete das Paket erstellen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- *</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Befehle </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unser Ziel ist es nun sicherzustellen, dass beim Ausführen der </font><i><font style="vertical-align: inherit;">Befehle </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-Wheel zuerst</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die Assembly der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C-Bibliothek gestartet </font><font style="vertical-align: inherit;">wird und dann der Befehl selbst bereits gestartet wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein in diesem Abschnitt erstelltes Beispiel befindet sich im </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellordner pyfoo_c_04</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um den Erstellungsprozess zu ändern, können wir </font><font style="vertical-align: inherit;">eine Klasse </font><font style="vertical-align: inherit;">in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deklarieren (der Dateiname sollte genau das sein), die von der Klasse </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abgeleitet ist </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Diese Klasse verfügt über Methoden, die wir selbst überschreiben können. </font><font style="vertical-align: inherit;">Derzeit interessieren uns folgende Methoden:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bauen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wird während des Aufrufs des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehls sip-build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufgerufen </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wird</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufgerufen, wenn der </font><i><font style="vertical-align: inherit;">Befehl sip-sdist aufgerufen wird</font></i><font style="vertical-align: inherit;"> .</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wird aufgerufen, wenn der Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-whe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufgerufen wird </font><font style="vertical-align: inherit;">.</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installieren</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wird aufgerufen, wenn der Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufgerufen wird </font><font style="vertical-align: inherit;">.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das heißt, wir können das Verhalten dieser Befehle neu definieren. </font><font style="vertical-align: inherit;">Genau genommen werden die aufgelisteten Methoden in der abstrakten Klasse </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.AbstractProject deklariert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aus der die abgeleitete Klasse </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellt wird </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><font style="vertical-align: inherit;">mit folgendem Inhalt:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> subprocess<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">_build_foo</span>(<span class="hljs-params">self</span>):</span>
        cwd = os.path.abspath(<span class="hljs-string">'foo'</span>)<font></font>
        subprocess.run([<span class="hljs-string">'make'</span>], cwd=cwd, capture_output=<span class="hljs-literal">True</span>, check=<span class="hljs-literal">True</span>)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span><font></font>
        self._build_foo()<font></font>
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span><font></font>
        self._build_foo()<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse deklariert </font><font style="vertical-align: inherit;">, die von der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse </font><i><font style="vertical-align: inherit;">abgeleitet ist,</font></i><font style="vertical-align: inherit;"> und </font><i><font style="vertical-align: inherit;">die</font></i><font style="vertical-align: inherit;"> Methoden </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> darin definiert </font><font style="vertical-align: inherit;">. Bei all diesen Methoden rufen wir die gleichnamigen Methoden aus der Basisklasse auf, bevor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Methode </font><i><font style="vertical-align: inherit;">_build_foo</font></i><font style="vertical-align: inherit;"> aufrufen </font><font style="vertical-align: inherit;">, mit der die Ausführung des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehls make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gestartet wird </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass die </font><i><font style="vertical-align: inherit;">Methoden </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_sdist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Namen der von ihnen erstellten Datei zurückgeben sollten. Dies ist nicht in der Dokumentation geschrieben, sondern in den SIP-Quellen angegeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt müssen wir den </font><i><font style="vertical-align: inherit;">Befehl make</font></i><font style="vertical-align: inherit;"> nicht mehr ausführen</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manuell, um die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek zu erstellen </font><font style="vertical-align: inherit;">, wird dies automatisch durchgeführt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie jetzt </font><font style="vertical-align: inherit;">den Befehl </font><i><font style="vertical-align: inherit;">sip- </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whe im</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><i><font style="vertical-align: inherit;">pyfoo_c_04 ausführen</font></i><font style="vertical-align: inherit;"> , wird eine Datei mit dem Namen pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl oder ähnlichem erstellt, abhängig von Ihrem Betriebssystem und der Version von Python. </font><font style="vertical-align: inherit;">
Dieses Paket kann mit dem folgenden Befehl installiert werden:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="bash hljs">pip install --user --upgrade pyfoo-0.4-cp38-cp38-manylinux1_x86_64.whl
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach können Sie sicherstellen, dass die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">des </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moduls </font><font style="vertical-align: inherit;">weiterhin funktioniert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fügen Sie zu erstellende Befehlszeilenoptionen hinzu</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Beispiel befindet sich im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und das Paket hat eine Versionsnummer von 0,5 (siehe die Einstellungen in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Dieses Beispiel basiert auf einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel aus der Dokumentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit einigen Korrekturen. In diesem Beispiel werden wir unsere Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wiederholen </font><font style="vertical-align: inherit;">und neue Befehlszeilenoptionen für den Build hinzufügen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unseren Beispielen bauen wir eine sehr einfache Bibliothek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In realen Projekten kann die Bibliothek sehr groß sein, und es ist dann nicht sinnvoll, sie in den Quellcode des Python-Bindungsprojekts aufzunehmen. Ich möchte Sie daran erinnern, dass SIP ursprünglich erstellt wurde, um eine Bindung für eine so große Bibliothek wie Qt zu erstellen. Sie können natürlich argumentieren, dass Submodule von git bei der Organisation der Quelle helfen können, aber das ist nicht der Punkt. Angenommen, die Bibliothek befindet sich möglicherweise nicht in dem Ordner mit der Bindungsquelle. In diesem Fall stellt sich die Frage, wo der SIP-Kollektor nach dem Bibliotheksheader und den Objektdateien suchen soll. In diesem Fall haben verschiedene Benutzer möglicherweise ihre eigenen Möglichkeiten, die Bibliothek zu platzieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dieses Problem zu lösen, fügen wir dem Build-System zwei neue Befehlszeilenoptionen hinzu, mit denen Sie den Pfad zur Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo.h</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Parameter </font><i><font style="vertical-align: inherit;">--foo-include-dir)</font></i><font style="vertical-align: inherit;"> angeben können</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) und zur Bibliotheksobjektdatei (Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo-library-dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Außerdem wird davon ausgegangen, dass sich die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek </font><font style="vertical-align: inherit;">zusammen mit den Bindungsquellen befindet </font><font style="vertical-align: inherit;">, wenn diese Parameter nicht angegeben werden </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir müssen die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erneut erstellen </font><font style="vertical-align: inherit;">und darin eine von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abgeleitete Klasse </font><i><font style="vertical-align: inherit;">deklarieren</font></i><font style="vertical-align: inherit;"> . Schauen wir uns zuerst die neue Version der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py an</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und sehen dann </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">wie sie funktioniert.</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">import</span> os<font></font>
<font></font>
<span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Option, Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-string">"""        
       foo.
    """</span><font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-string">"""     . """</span><font></font>
<font></font>
        tools = [<span class="hljs-string">'build'</span>, <span class="hljs-string">'install'</span>, <span class="hljs-string">'sdist'</span>, <span class="hljs-string">'wheel'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   .</span><font></font>
        options = super().get_options()<font></font>
<font></font>
        <span class="hljs-comment">#   </span>
        inc_dir_option = Option(<span class="hljs-string">'foo_include_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing foo.h"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo'</span>),<font></font>
                                tools=tools)<font></font>
        options.append(inc_dir_option)<font></font>
<font></font>
        lib_dir_option = Option(<span class="hljs-string">'foo_library_dir'</span>,<font></font>
                                help=<span class="hljs-string">"the directory containing the foo library"</span>,<font></font>
                                metavar=<span class="hljs-string">"DIR"</span>,<font></font>
                                default=os.path.abspath(<span class="hljs-string">'foo/bin'</span>),<font></font>
                                tools=tools)<font></font>
<font></font>
        options.append(lib_dir_option)<font></font>
<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""    . """</span><font></font>
<font></font>
        <span class="hljs-comment">#     </span><font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
        <span class="hljs-comment">#  ,         </span><font></font>
        self.foo_include_dir = os.path.abspath(self.foo_include_dir)<font></font>
        self.foo_library_dir = os.path.abspath(self.foo_library_dir)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        <span class="hljs-string">"""   . """</span><font></font>
<font></font>
        <span class="hljs-comment">#   pyfoo</span>
        <span class="hljs-comment"># (  pyproject.toml  [tool.sip.bindings.pyfoo])</span>
        foo_bindings = self.bindings[<span class="hljs-string">'pyfoo'</span>]<font></font>
<font></font>
        <span class="hljs-comment">#   include_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_include_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.include_dirs = [self.foo_include_dir]<font></font>
<font></font>
        <span class="hljs-comment">#   library_dirs  </span>
        <span class="hljs-keyword">if</span> self.foo_library_dir <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<font></font>
            foo_bindings.library_dirs = [self.foo_library_dir]<font></font>
<font></font>
        super().update(tool)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben erneut die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse erstellt </font><font style="vertical-align: inherit;">, die von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abgeleitet </font><i><font style="vertical-align: inherit;">ist</font></i><font style="vertical-align: inherit;"> . In diesem Beispiel ist die automatische Assemblierung der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek deaktiviert </font><font style="vertical-align: inherit;">, da jetzt davon ausgegangen wird, dass sie sich an einem anderen Ort befinden kann. </font><font style="vertical-align: inherit;">Zum </font><font style="vertical-align: inherit;">Zeitpunkt der Erstellung der Bindung sollten die Header- und Objektdateien bereit sein. </font><font style="vertical-align: inherit;">In </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse werden </font><font style="vertical-align: inherit;">drei Methoden neu definiert: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Betrachten Sie sie genauer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beginnen wir mit der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Diese Methode sollte eine Liste der Instanzen der Klasse </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Option zurückgeben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Jedes Listenelement ist eine Befehlszeilenoption. Innerhalb der überschriebenen Methode erhalten wir die Liste der Standardoptionen (die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optionsvariable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), indem </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">die gleichnamige Basisklassenmethode aufrufen, dann zwei neue Optionen ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">erstellen </font><font style="vertical-align: inherit;">, sie der Liste hinzufügen und diese Liste dann von der Funktion zurückgeben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Konstruktor der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse </font><font style="vertical-align: inherit;">akzeptiert einen erforderlichen Parameter (Option Namen) und eine ausreichend große Anzahl von optionalen, dass die Art der Wert für diesen Parameter, Standardwert, Parameterbeschreibung und einige andere beschreiben. In </font><font style="vertical-align: inherit;">diesem Beispiel werden die folgenden Optionen für die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Option</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konstruktor </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<ul>
<li><i>help</i>   ,   ,     <i>sip-wheel -h</i></li>
<li><i>metavar</i> —  ,    ,       .     <i>metavar</i>  «DIR»,   ,     — .</li>
<li><i>default</i> —     .    ,          ,   <i>foo</i>   ,      (    ).</li>
<li><i>tools</i> —  ,        .        <i>sip-build</i>, <i>sip-install</i>, <i>sip-sdist</i>  <i>sip-wheel</i>,  tools = ['build', 'install', 'sdist', 'wheel'].</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die folgende überladene Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults dient</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum </font><i><font style="vertical-align: inherit;">Festlegen von</font></i><font style="vertical-align: inherit;"> Parameterwerten, die der Benutzer über die Befehlszeile übergeben kann. Die Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus der Basisklasse erstellt für jeden in der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellten Befehlszeilenparameter eine </font><font style="vertical-align: inherit;">Variable (Klassenmitglied). </font><i><font style="vertical-align: inherit;">Daher</font></i><font style="vertical-align: inherit;"> ist es wichtig, die gleichnamige Basisklassenmethode aufzurufen, bevor die erstellten Variablen verwendet werden, damit alle mit den Befehlszeilenparametern erstellten Variablen erstellt und mit Standardwerten initialisiert werden . Danach werden in unserem Beispiel die Variablen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;"> erstellt</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Wenn der Benutzer die entsprechenden Befehlszeilenparameter nicht angegeben hat, werden Standardwerte gemäß den Parametern des Konstruktors der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optionsklasse</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standardparameter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) verwendet. Wenn der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standardparameter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht festgelegt ist, wird er je nach Typ des erwarteten Parameterwerts entweder None oder eine leere Liste oder 0 initialisiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Innerhalb der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults stellen wir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sicher, dass die Pfade in den Variablen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> immer absolut sind. Dies ist erforderlich, damit es nicht davon abhängt, wie der Arbeitsordner zum Zeitpunkt des Starts der Assembly lautet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die letzte überladene Methode in dieser Klasse ist </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Diese Methode wird aufgerufen, wenn die zuvor vorgenommenen Änderungen auf das Projekt angewendet werden müssen. Ändern oder fügen Sie beispielsweise die in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angegebenen Parameter </font><i><font style="vertical-align: inherit;">hinzu</font></i><font style="vertical-align: inherit;"> . In den vorherigen Beispielen haben wir die Pfade zu den Header- und Objektdateien mithilfe der Parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Abschnitt </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[tool.sip.bindings.pyfoo] festgelegt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jetzt werden wir diese Parameter aus dem Skript </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">festlegen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sodass </font><font style="vertical-align: inherit;">wir </font><font style="vertical-align: inherit;">in der Datei </font><i><font style="vertical-align: inherit;">pyproject.toml</font></i><font style="vertical-align: inherit;"> die </font><i><font style="vertical-align: inherit;">folgenden</font></i><font style="vertical-align: inherit;"> Parameter entfernen:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.3"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Innerhalb der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aktualisieren Sie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uns aus dem Wörterbuch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.bindings</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keyed </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gat Instanz </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sipbuild.Bindings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Der Schlüsselname entspricht den [tool.sip.bindings. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ] aus der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und die so erhaltene Klasseninstanz beschreibt die in diesem Abschnitt beschriebenen Einstellungen. Dann werden den Mitgliedern dieser Klasse </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library_dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (die Namen der Mitglieder entsprechen den Parametern </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">include-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">library-dirs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit einem durch Unterstriche ersetzten Bindestrich) Listen zugewiesen, die die in den Mitgliedern </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_include_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font><i><font style="vertical-align: inherit;">self.foo_library_dir</font></i><font style="vertical-align: inherit;"> gespeicherten Pfade </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthalten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In diesem Beispiel überprüfen wir aus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gründen der</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Genauigkeit, ob die Werte </font><i><font style="vertical-align: inherit;">self.foo_include_dir</font></i><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.foo_library_dir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht gleich </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">None</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind. In diesem Beispiel ist diese Bedingung jedoch immer erfüllt, da die von uns erstellten Befehlszeilenparameter Standardwerte haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher haben wir die Konfigurationsdateien so vorbereitet, dass während der Montage die Pfade zu den Header- und Objektdateien angegeben werden konnten. Lassen Sie uns überprüfen, was passiert ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen Sie zunächst sicher, dass die Standardwerte funktionieren. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wechseln</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sie dazu in den Ordner </font><i><font style="vertical-align: inherit;">pyfoo_c_05 / foo</font></i><font style="vertical-align: inherit;"> und erstellen Sie die Bibliothek mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da wir in diesem Beispiel die automatische Bibliothekserstellung deaktiviert haben. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gehen Sie danach zum Ordner</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und führen Sie den Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">whe aus</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Als Ergebnis dieses Befehls wird die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei pyfoo-0.5-cp38-cp38-manylinux1_x86_64.whl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder mit einem ähnlichen Namen </font><font style="vertical-align: inherit;">erstellt </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verschieben Sie nun den Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> irgendwo außerhalb des Ordners </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_05</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und führen Sie den Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">whe</font></i><font style="vertical-align: inherit;"> erneut aus </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Als Ergebnis erhalten wir den erwarteten Fehler, dass wir keine Objektbibliotheksdatei haben:</font></font><br>
<br>
<pre><code class="plaintext hljs">usr/bin/ld:   -lfoo<font></font>
collect2: :  ld     1<font></font>
sip-wheel: Unable to compile the 'foo' module: command 'g++' failed with exit status 1<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Führen Sie danach </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip-Wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit der neuen Befehlszeilenoption aus:</font></font><br>
<br>
<pre><code class="bash hljs">sip-wheel --foo-include-dir <span class="hljs-string">".../foo"</span> --foo-library-dir <span class="hljs-string">".../foo/bin"</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anstelle der Auslassungspunkte müssen Sie den Pfad zu dem Ordner angeben, in den Sie den </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><font style="vertical-align: inherit;">mit der zusammengestellten Bibliothek </font><font style="vertical-align: inherit;">verschoben haben </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Infolgedessen sollte es der Assembly gelingen, die .whl-Datei zu erstellen. </font><font style="vertical-align: inherit;">Das erstellte Modul kann auf die gleiche Weise wie in den vorherigen Abschnitten installiert und getestet werden.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie die Reihenfolge der aufrufenden Methoden aus project.py</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das nächste Beispiel, das wir betrachten werden, ist sehr einfach und zeigt die Reihenfolge des Aufrufs der Methoden der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse </font><font style="vertical-align: inherit;">, die wir in den vorherigen Abschnitten überladen haben. Dies kann hilfreich sein, um zu verstehen, wann Variablen initialisiert werden können. Dieses Beispiel befindet sich im Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyfoo_c_06</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im </font><i><font style="vertical-align: inherit;">Quellrepository</font></i><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Beispiel werden im Wesentlichen </font><font style="vertical-align: inherit;">alle Methoden überladen, die wir zuvor </font><font style="vertical-align: inherit;">in der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FooProject-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse verwendet haben </font><font style="vertical-align: inherit;">, die sich in der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py befindet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , und der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Druckfunktion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufrufe hinzugefügt </font><font style="vertical-align: inherit;">, die den Namen der Methode anzeigen, in der sie sich befindet:</font></font><br>
<br>
<pre><code class="python hljs"><span class="hljs-keyword">from</span> sipbuild <span class="hljs-keyword">import</span> Project<font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FooProject</span>(<span class="hljs-params">Project</span>):</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_options</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'get_options()'</span>)<font></font>
        options = super().get_options()<font></font>
        <span class="hljs-keyword">return</span> options<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_user_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_user_defaults()'</span>)<font></font>
        super().apply_user_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">apply_nonuser_defaults</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'apply_nonuser_defaults()'</span>)<font></font>
        super().apply_nonuser_defaults(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span>(<span class="hljs-params">self, tool</span>):</span>
        print(<span class="hljs-string">'update()'</span>)<font></font>
        super().update(tool)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'build()'</span>)<font></font>
        super().build()<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_sdist</span>(<span class="hljs-params">self, sdist_directory</span>):</span>
        print(<span class="hljs-string">'build_sdist()'</span>)
        <span class="hljs-keyword">return</span> super().build_sdist(sdist_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_wheel</span>(<span class="hljs-params">self, wheel_directory</span>):</span>
        print(<span class="hljs-string">'build_wheel()'</span>)
        <span class="hljs-keyword">return</span> super().build_wheel(wheel_directory)<font></font>
<font></font>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">install</span>(<span class="hljs-params">self</span>):</span>
        print(<span class="hljs-string">'install()'</span>)<font></font>
        super().install()<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aufmerksame Leser sollten beachten, dass zusätzlich zu den zuvor verwendeten Methoden die Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , über die wir zuvor noch nicht gesprochen haben </font><font style="vertical-align: inherit;">, in diesem Beispiel überladen ist </font><font style="vertical-align: inherit;">. Diese Methode empfiehlt, Standardwerte für alle Variablen festzulegen, die nicht über Befehlszeilenparameter geändert werden können. </font><i><font style="vertical-align: inherit;">Geben Sie in der</font></i></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den expliziten Pfad zur Bibliothek zurück:</font></font><br>
<br>
<pre><code class="plaintext hljs">[build-system]<font></font>
requires = ["sip &gt;=5, &lt;6"]<font></font>
build-backend = "sipbuild.api"<font></font>
<font></font>
[tool.sip.metadata]<font></font>
name = "pyfoo"<font></font>
version = "0.4"<font></font>
license = "MIT"<font></font>
<font></font>
[tool.sip.bindings.pyfoo]<font></font>
headers = ["foo.h"]<font></font>
libraries = ["foo"]<font></font>
include-dirs = ["foo"]<font></font>
library-dirs = ["foo/bin"]<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit das Projekt erfolgreich erstellt werden kann, müssen Sie in den Ordner </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gehen </font><font style="vertical-align: inherit;">und dort die Bibliothek mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl make</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellen </font><font style="vertical-align: inherit;">. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kehren Sie danach zum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ordner </font><i><font style="vertical-align: inherit;">pyfoo_c_06 zurück</font></i><font style="vertical-align: inherit;"> und führen Sie beispielsweise den Befehl </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sip- </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">whe aus</font></i><font style="vertical-align: inherit;"> . Wenn Sie die Compiler-Warnungen verwerfen, wird der folgende Text angezeigt: </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options () </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">update ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Diese Bindungen werden erstellt: pyfoo. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel ()</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Generieren der Pyfoo-Bindungen ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilieren des 'foo'-Moduls ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Rad wurde gebaut.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es werden fette Linien angezeigt, die aus unserer Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausgegeben werden </font><font style="vertical-align: inherit;">. Wir sehen also, dass die Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mehrmals </font><i><font style="vertical-align: inherit;">aufgerufen wird</font></i><font style="vertical-align: inherit;"> . Dies muss berücksichtigt werden, wenn Sie eine Mitgliedsvariable in der Klasse initialisieren </font><i><font style="vertical-align: inherit;">möchten</font></i><font style="vertical-align: inherit;"> , die von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Project</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abgeleitet ist </font><font style="vertical-align: inherit;">. Die Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_options</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist hierfür nicht der beste Ort. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist auch nützlich, sich daran zu erinnern, dass die Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vor der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults aufgerufen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird </font><font style="vertical-align: inherit;">, d. H. In der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_user_defaults können</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bereits Variablen verwendet werden, deren Werte in der Methode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apply_nonuser_defaults festgelegt sind</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach wird die </font><i><font style="vertical-align: inherit;">Update-</font></i><font style="vertical-align: inherit;"> Methode aufgerufen</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und ganz am Ende die Methode, die direkt für die Montage verantwortlich ist, in unserem Fall </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build_wheel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fazit zum ersten Teil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel haben wir begonnen, das SIP-Tool zu untersuchen, mit dem Python-Bindungen für in C oder C ++ geschriebene Bibliotheken erstellt werden können. In diesem ersten Teil des Artikels haben wir die Grundlagen der Verwendung von SIP anhand des Beispiels zum Erstellen einer Python-Bindung für eine in C geschriebene sehr einfache Bibliothek untersucht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die Dateien ermittelt, die Sie für die Arbeit mit SIP erstellen müssen. Die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pyproject.toml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enthält Informationen zum Paket (Name, Versionsnummer, Lizenz und Pfade zu Header- und Objektdateien). Mit der Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">project.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können </font><font style="vertical-align: inherit;">Sie den Erstellungsprozess des Python-Pakets beeinflussen, z. B. mit dem Erstellen der C-Bibliothek beginnen oder den Benutzer den Speicherort der Header- und Objektdateien der Bibliothek angeben lassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der </font><i><font style="vertical-align: inherit;">* .sip-</font></i><font style="vertical-align: inherit;"> Datei</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beschreibt die Schnittstelle des Python-Moduls und listet die Funktionen und Klassen auf, die im Modul enthalten sein werden. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anweisungen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Anmerkungen werden verwendet </font><font style="vertical-align: inherit;">, um die Schnittstelle in der </font><i><font style="vertical-align: inherit;">* .sip-</font></i><font style="vertical-align: inherit;"> Datei zu beschreiben </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im zweiten Teil des Artikels werden wir eine Bindung über eine in C ++ geschriebene objektorientierte Bibliothek erstellen und anhand ihres Beispiels Techniken untersuchen, die bei der Beschreibung der Schnittstelle von C ++ - Klassen hilfreich sind, und gleichzeitig neue Anweisungen und Anmerkungen für uns behandeln. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fortsetzung folgt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verweise</font></font></h2><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiele für diesen Artikel</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIP-Homepage</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentation für SIP</font></font></a></li>
</ul></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de495468/index.html">Algorithmus zur Erkennung von Preisschildern, der auch auf Datenerfassungsterminals funktioniert</a></li>
<li><a href="../de495472/index.html">Die Umstellung auf Vegetarismus verhindert nicht, dass Menschen mit Krankheiten wie COVID-19 infiziert werden</a></li>
<li><a href="../de495474/index.html">DataGrip 2020.1: Konfigurationen starten, nach Excel exportieren, Ergebnisse im Editor und mehr</a></li>
<li><a href="../de495476/index.html">Warum der Erfolg der Atari DeepMind AI enttäuschend ist</a></li>
<li><a href="../de495478/index.html">Big and Small Data Tester: Trends, Theorie, meine Geschichte</a></li>
<li><a href="../de495484/index.html">Wie Unix-Pipelines implementiert werden</a></li>
<li><a href="../de495486/index.html">Neue Bedrohungen für vertrauliche Daten: Ergebnisse der globalen Umfrage von Acronis</a></li>
<li><a href="../de495490/index.html">Test- und QS-Bereich auf der DUMP 2020-Konferenz. Was erwartet Sie in diesem Jahr? Spoiler: ein Paar Schmerzmittel und Kirschen</a></li>
<li><a href="../de495492/index.html">Unreal Engine 4 iOS Game Release-Funktionen</a></li>
<li><a href="../de495494/index.html">Erstellen eines zusätzlichen Kube-Schedulers mit benutzerdefinierten Planungsregeln</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>