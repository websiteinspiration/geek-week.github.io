<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôåüèæ üßú ü§¥ Contoh SPA Simple Notes di Mithril.js üàπ üëπ üêù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mithril.js adalah alat yang tidak populer untuk membangun aplikasi web klien. Praktis tidak ada publikasi tentang Habr√© tentang topik ini. Dalam posti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Contoh SPA Simple Notes di Mithril.js</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/492496/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mithril.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah alat yang tidak populer untuk membangun aplikasi web klien. </font><font style="vertical-align: inherit;">Praktis tidak ada publikasi tentang Habr√© tentang topik ini. </font><font style="vertical-align: inherit;">Dalam posting ini, saya ingin menunjukkan bagaimana Anda dapat membuat aplikasi kecil di Mithril. </font><font style="vertical-align: inherit;">Aplikasi akan didasarkan pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publikasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terjemahan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa itu Mihtril?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mithril adalah kerangka kerja reaktif yang dirancang untuk membuat SPA (aplikasi web satu halaman). Semua dalam semua, itu hanya javascript dan 13 tanda tangan dari fungsi API. Selain itu, ada perpustakaan mithril-stream yang tidak termasuk dalam mithril dan digunakan secara terpisah. Inti dari mithril meliputi perutean aplikasi dan bekerja dengan permintaan XHR. Konsep sentral adalah abstraksi - simpul virtual (vnode). Node virtual hanyalah objek js dengan beberapa set atribut. Simpul virtual dibuat oleh fungsi khusus m (). Keadaan antarmuka saat ini disimpan dalam daftar node virtual (virtual DOM). Pada rendering awal halaman aplikasi, DOM virtual diterjemahkan ke dalam DOM. Ketika penangan peristiwa DOM API dimulai, ketika janji m.request () selesai, dan ketika URL berubah (navigasi di sepanjang rute aplikasi), array DOM virtual baru dihasilkan,membandingkan dengan yang lama, dan node yang diubah mengubah DOM browser. Selain peristiwa DOM dan penyelesaian permintaan m.request (), redrawing dapat dipanggil secara manual dengan fungsi m.redraw ().</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak ada templat mirip-HTML di luar kotak, tidak ada dukungan JSX, meskipun Anda dapat menggunakan semua ini dengan berbagai plugin untuk membangun jika diinginkan. Saya tidak akan menggunakan peluang ini di sini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika argumen pertama ke m () adalah string, (misalnya, 'div'), maka fungsi mengembalikan simpul virtual sederhana dan sebagai hasilnya, tag HTML akan ditampilkan di DOM</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika argumen pertama ke m () adalah objek atau fungsi yang mengembalikan objek, maka objek tersebut harus memiliki metode view (), dan objek seperti itu disebut komponen. Metode view () komponen, pada gilirannya, harus selalu mengembalikan fungsi m () (atau array tipe: [m (),])). Dengan demikian, kita dapat membangun hierarki objek komponen. Dan jelas bahwa pada akhirnya semua komponen mengembalikan node vnode sederhana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedua node dan komponen virtual memiliki metode siklus hidup, dan mereka disebut sama oninit (), oncreate (), onbeforeupdate (), dll. Masing-masing metode ini dipanggil pada titik waktu yang sangat spesifik dalam rendering halaman.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda bisa meneruskan parameter ke simpul atau komponen virtual sebagai objek, yang seharusnya menjadi argumen kedua ke fungsi m (). Anda bisa mendapatkan tautan ke objek ini di dalam simpul menggunakan notasi vnode.attrs. Argumen ketiga ke fungsi m () adalah turunan dari simpul ini dan dapat diakses melalui tautan vnode.children. Selain fungsi m (), simpul sederhana dikembalikan oleh fungsi m.trust (). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penulis mithril tidak menawarkan pola desain aplikasi khusus, meskipun ia menyarankan untuk menghindari beberapa solusi yang gagal, misalnya, komponen "terlalu tebal" atau memanipulasi keturunan pohon komponen. Penulis juga tidak menawarkan cara atau metode khusus untuk mengontrol keadaan aplikasi secara keseluruhan atau komponen. Meskipun dokumentasi menyatakan bahwa Anda tidak boleh menggunakan status node itu sendiri, memanipulasi itu.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua fitur mithril ini tampaknya sangat merepotkan, dan kerangka kerja tampaknya belum selesai, tidak ada rekomendasi khusus, tidak ada keadaan / penyimpanan, tidak ada peredam / event dispatcher, tidak ada template. </font><font style="vertical-align: inherit;">Secara umum, lakukan yang Anda bisa.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang Anda butuhkan sebagai contoh </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami akan menggunakan:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mithril.js versi 2.0.4</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pustaka css </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pure.css</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versi 1.0.1</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fontawesome v5.12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk ikon</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rollup.js</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versi 1.32 untuk membangun aplikasi</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgREST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versi 5.2.0, sebagai server REST backend</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgresql versi 9.6 atau lebih tinggi sebagai basis data.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Server frontend tidak penting di sini, hanya harus memberikan file index.html dan skrip dan gaya klien. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak akan menginstal mithril di node_modules, dan mengikat kode aplikasi dan kerangka kerja menjadi satu file. </font><font style="vertical-align: inherit;">Kode aplikasi dan mithril akan diunggah ke halaman secara terpisah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan menjelaskan prosedur instalasi untuk alat-alat tersebut, walaupun saya dapat mengatakan tentang postgREST, cukup unduh file biner, letakkan di folder terpisah, buat file konfigurasi test.conf seperti ini:</font></font><br>
<br>
<pre><code class="plaintext hljs">db-uri = "postgres://postgres:user1@localhost:5432/testbase"<font></font>
server-port= 5000<font></font>
# The name of which database schema to expose to REST clients<font></font>
db-schema= "public"<font></font>
# The database role to use when no client authentication is provided.<font></font>
# Can (and probably should) differ from user in db-uri<font></font>
db-anon-role = "postgres" </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada saat yang sama, cluster postgesql Anda harus memiliki basis testbase dan user1. </font><font style="vertical-align: inherit;">Di basis tes ini, buat tabel:</font></font><br>
<br>
<pre><code class="sql hljs"><span class="hljs-comment">-- Postgrest sql notes table </span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> notes (
<span class="hljs-keyword">id</span> <span class="hljs-built_in">serial</span> primary <span class="hljs-keyword">key</span>,<font></font>
title <span class="hljs-built_in">varchar</span>(<span class="hljs-number">127</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
<span class="hljs-keyword">content</span> <span class="hljs-built_in">text</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<font></font>
created <span class="hljs-built_in">timestamp</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CURRENT_TIMESTAMP</span>,<font></font>
completed <span class="hljs-built_in">timestamp</span> <span class="hljs-keyword">with</span> <span class="hljs-built_in">time</span> zone,<font></font>
ddel <span class="hljs-built_in">smallint</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span>
)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memulai server postgREST dilakukan dengan perintah:</font></font><br>
<br>
<pre><code class="bash hljs">postgrest test.conf
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memulai server, ini menampilkan pesan informasi tentang menghubungkan ke database, dan pada port mana ia akan mendengarkan klien.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merencanakan proyek</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, jika secara kasar memahami cara kerja mitril, Anda perlu memikirkan cara membuat aplikasi. </font><font style="vertical-align: inherit;">Ini rencananya:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan menyimpan data aplikasi dalam objek lokal, sebut saja modelnya</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplikasi API akan disimpan dalam file terpisah</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan menyimpan rute aplikasi dalam file terpisah</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">File path akan menjadi titik masuk untuk membangun aplikasi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap komponen terpisah (dan saya akan menggunakan skema render komponen) dan fungsi yang terkait dengannya akan disimpan dalam file terpisah</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap komponen yang membuat data model akan memiliki akses ke model.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penangan peristiwa DOM komponen dilokalkan dalam komponen</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kita tidak perlu acara khusus, lebih tepatnya acara DOM asli, panggilan balik untuk acara ini dilokalkan dalam komponen. </font><font style="vertical-align: inherit;">Saya akan menggunakan dua cara mengikat. </font><font style="vertical-align: inherit;">Mungkin tidak semua orang menyukai pendekatan ini, tetapi tidak semua orang suka redux atau vuex. </font><font style="vertical-align: inherit;">Selain itu, teknik mengikat satu arah juga dapat diterapkan secara elegan dalam mitril menggunakan mithril-sream. </font><font style="vertical-align: inherit;">Tetapi dalam kasus ini, ini adalah solusi yang berlebihan.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Struktur Folder Aplikasi</font></font></h3><br>
<img src="https://habrastorage.org/webt/yp/uy/fa/ypuyfap4tlxl_ccqo86wbtb9h98.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folder publik akan dilayani oleh server depan, ada file index.html, dan direktori dengan gaya dan skrip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folder src berisi akar dari router dan definisi API, dan dua direktori, untuk model dan tampilan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di root proyek ada file konfigurasi rollup.config, dan proyek dibangun menggunakan perintah:</font></font><br>
<br>
<pre><code class="bash hljs">rollup ‚Äìc</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agar tidak membuat pembaca bosan dengan potongan kode panjang yang tersedia di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya hanya akan mengomentari elemen implementasi utama untuk menunjukkan pendekatan idiomatis untuk mitral.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API dan router</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode API:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// used by backend server</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> restApi= {
  <span class="hljs-attr">notes</span>: { <span class="hljs-attr">url</span>: <span class="hljs-string">'notes'</span>, <span class="hljs-attr">editable</span>: [<span class="hljs-string">'add'</span>, <span class="hljs-string">'edit'</span>, <span class="hljs-string">'del'</span>] }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment">// used by routers</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> appApi = {
  <span class="hljs-attr">root</span>: <span class="hljs-string">"/"</span>,<font></font>
}<font></font>
<span class="hljs-comment">// used by navBar</span>
<span class="hljs-comment">// here array of arrays though it may be hash eg</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> appMenu = [<font></font>
  [<span class="hljs-string">`<span class="hljs-subst">${appApi.root}</span>`</span>, <span class="hljs-string">'Home'</span>],<font></font>
  [<span class="hljs-string">`<span class="hljs-subst">${appApi.root}</span>`</span>, <span class="hljs-string">'About'</span>],<font></font>
  [<span class="hljs-string">`<span class="hljs-subst">${appApi.root}</span>`</span>, <span class="hljs-string">'Contacts'</span>],<font></font>
]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mendefinisikan API untuk server REST dan untuk router. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Router:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { restApi, appApi } <span class="hljs-keyword">from</span> <span class="hljs-string">'./appApi'</span>;
<span class="hljs-keyword">import</span> { moModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'./model/moModel'</span>;
<span class="hljs-keyword">import</span> { vuView, vuApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'./view/vuApp'</span>;
<span class="hljs-keyword">import</span> { vuNavBar } <span class="hljs-keyword">from</span> <span class="hljs-string">'./view/vuNavBar'</span>;<font></font>
<font></font>
<span class="hljs-comment">// application router</span>
<span class="hljs-keyword">const</span> appRouter = { [appApi.root]: {<font></font>
  render() {<font></font>
    <span class="hljs-keyword">const</span> view = m(vuApp, {
      <span class="hljs-attr">model</span>: moModel.getModel( restApi.notes ),<font></font>
    });<font></font>
    <span class="hljs-keyword">return</span> vuView( {<span class="hljs-attr">menu</span>: vuNavBar}, view);<font></font>
  }<font></font>
}};<font></font>
<font></font>
<span class="hljs-comment">// once per app</span>
m.route(<span class="hljs-built_in">document</span>.body, <span class="hljs-string">"/"</span>, appRouter);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini router dipasang pada badan dokumen. </font><font style="vertical-align: inherit;">Router itu sendiri adalah objek yang menggambarkan rute dan komponen yang akan digunakan pada rute ini, fungsi render () harus mengembalikan vnode. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Objek appApi mendefinisikan semua rute aplikasi yang valid, dan objek appMenu mendefinisikan semua elemen navigasi yang mungkin untuk aplikasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fungsi render, ketika dipanggil, menghasilkan model aplikasi dan meneruskannya ke simpul root.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Model aplikasi</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Struktur yang menyimpan data yang relevan, saya sebut model. </font><font style="vertical-align: inherit;">Kode sumber fungsi yang mengembalikan model:</font></font><br>
<br>
<pre><code class="javascript hljs">getModel(<font></font>
    {url=<span class="hljs-literal">null</span>, method=<span class="hljs-string">"GET"</span>, order_by=<span class="hljs-string">'id'</span>, editable=<span class="hljs-literal">null</span>} = {}<font></font>
  ) {<font></font>
<span class="hljs-comment">/**
  * url - string of model's REST API url
  * method - string of model's REST method
  * order_by - string "order by" with initially SELECT 
  * editable - array defines is model could changed
*/</span>
    <span class="hljs-keyword">const</span> model = {
      <span class="hljs-attr">url</span>: url,
      <span class="hljs-attr">method</span>: method,
      <span class="hljs-attr">order_by</span>: order_by,
      <span class="hljs-attr">editable</span>: editable,
      <span class="hljs-attr">key</span>: order_by, <span class="hljs-comment">// here single primary key only</span>
      <span class="hljs-attr">list</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// main data list </span>
      <span class="hljs-attr">item</span>: {}, <span class="hljs-comment">// note item</span>
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// Promise error</span>
      <span class="hljs-attr">save</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// save status</span>
      <span class="hljs-attr">editMode</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// view switch flag</span>
      <span class="hljs-attr">word</span>: <span class="hljs-string">''</span> <span class="hljs-comment">// dialog header word</span><font></font>
    };  <font></font>
    model.getItem= <span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> {<font></font>
      model.item= {};<font></font>
      <span class="hljs-keyword">if</span> ( !id ) {<font></font>
        model.editMode= <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
      }<font></font>
      <span class="hljs-keyword">const</span> key= model.key;
      <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">let</span> it <span class="hljs-keyword">of</span> model.list ) {
        <span class="hljs-keyword">if</span> (it[key] == id) {<font></font>
          model.item= <span class="hljs-built_in">Object</span>.assign({}, it);
          <span class="hljs-keyword">break</span>;<font></font>
        }<font></font>
      }<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    };<font></font>
    <span class="hljs-keyword">return</span> model;<font></font>
  },</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Ini diinisialisasi, dan mengembalikan objek model. </font><font style="vertical-align: inherit;">Tautan di dalam objek mungkin berubah, tetapi tautan ke objek itu sendiri tetap konstan. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain fungsi getModel, objek moModel global memiliki fungsi wrapper untuk fungsi mitri m.request (), ini adalah getList (model), dan formSubmit (event, model, method). </font><font style="vertical-align: inherit;">Parameter model sebenarnya adalah referensi ke objek model, event adalah objek event yang dihasilkan ketika formulir dikirimkan, metode adalah metode HTTP yang dengannya kita ingin menyimpan catatan (POST adalah catatan baru, PATCH, DELETE sudah tua).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perwakilan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folder tampilan berisi fungsi yang bertanggung jawab untuk merender elemen halaman individual. </font><font style="vertical-align: inherit;">Saya membaginya menjadi 4 bagian:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuApp - komponen root aplikasi, </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuNavBar - bilah navigasi,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuNotes - daftar catatan,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuNoteForm - formulir pengeditan catatan,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuDialog - elemen dialog HTML </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Router menentukan bahwa vuView (menu, view) dikembalikan pada satu rute. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Definisi fungsi ini:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> vuView= <span class="hljs-function">(<span class="hljs-params">appMenu, view</span>)=&gt;</span> m(vuMain, appMenu, view);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini hanya pembungkus yang mengembalikan komponen vuMain, jika objek appMenu cukup kompleks untuk memiliki objek bersarang dalam struktur yang mirip dengan objek eksternal, maka pembungkus tersebut adalah cara yang tepat untuk mengembalikan komponen dengan elemen navigasi dan komponen anak yang berbeda (Anda hanya perlu menulis lebih sedikit kode) . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Komponen VuMain:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> vuMain= <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ivnode</span>) </span>{
  <span class="hljs-comment">// We use ivnode as argument as it is initial vnode</span>
  <span class="hljs-keyword">const</span> { menu }= ivnode.attrs;
  <span class="hljs-keyword">return</span> { view(vnode) {
    <span class="hljs-comment">// IMPORTANT !</span>
    <span class="hljs-comment">// If we use vnode inside the view function we MUST provide it for view</span>
    <span class="hljs-keyword">return</span> [<font></font>
      m(menu),<font></font>
      m(<span class="hljs-string">'#layout'</span>, vnode.children)<font></font>
    ];<font></font>
  }};<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini hanya mengembalikan vnodes navigasi dan konten halaman yang sebenarnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, di mana dimungkinkan untuk mendefinisikan komponen, saya akan menggunakan penutupan. </font><font style="vertical-align: inherit;">Penutupan dipanggil sekali selama rendering awal halaman, dan secara lokal menyimpan semua tautan yang diteruskan ke objek dan definisi fungsi mereka sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penutupan sebagai definisi harus selalu mengembalikan komponen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan sebenarnya komponen konten aplikasi:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> vuApp= <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ivnode</span>) </span>{
  <span class="hljs-keyword">const</span> { model }= ivnode.attrs;
  <span class="hljs-comment">//initially get notes</span><font></font>
  moModel.getList( model );<font></font>
  <font></font>
  <span class="hljs-keyword">return</span> { view() { 
    <span class="hljs-keyword">return</span> [<font></font>
      m(vuNotes, { model }),<font></font>
      m(vuNoteForm, { model }),<font></font>
      vuModalDialog(model)<font></font>
    ];<font></font>
  }};<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena kami sudah memiliki model, ketika saya menelepon penutupan, saya ingin mendapatkan seluruh daftar catatan dari database. </font><font style="vertical-align: inherit;">Akan ada tiga komponen pada halaman:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuNotes - daftar catatan dengan tombol add,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuNoteForm - formulir pengeditan catatan,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vuModalDialog - elemen dialog yang akan kami tampilkan secara modal, dan banting bila perlu. </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena masing-masing komponen ini perlu tahu cara menggambar itu sendiri, kami meneruskan tautan ke objek model di masing-masing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar Catatan Komponen:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">//Notes List</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> vuNotes= <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ivnode</span>) </span>{
  <span class="hljs-keyword">const</span> { model }= ivnode.attrs;
  <span class="hljs-keyword">const</span> _display= <span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span> model.editMode ? <span class="hljs-string">'display:none'</span>: <span class="hljs-string">'display:block'</span>;
  <span class="hljs-keyword">const</span> vuNote= noteItem(model); <span class="hljs-comment">// returns note function</span><font></font>
  <font></font>
  <span class="hljs-keyword">return</span> { view() {
    <span class="hljs-keyword">return</span> model.error ? m(<span class="hljs-string">'h2'</span>, {<span class="hljs-attr">style</span>: <span class="hljs-string">'color:red'</span>}, model.error) :<font></font>
    !model.list ? m(<span class="hljs-string">'h1'</span>, <span class="hljs-string">'...LOADING'</span> ) :<font></font>
    m(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">style</span>: _display() }, [<font></font>
      m(addButton , { model } ),<font></font>
      m(<span class="hljs-string">'.pure-g'</span>, m(<span class="hljs-string">'.pure-u-1-2.pure-u-md-1-1'</span>,<font></font>
        m(<span class="hljs-string">'.notes'</span>, model.list.map( vuNote ) )<font></font>
      ))<font></font>
    ]);<font></font>
  }};<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bendera bool editMode disimpan dalam objek model, jika nilai flag benar, maka kami menunjukkan formulir pengeditan, jika tidak - daftar catatan. </font><font style="vertical-align: inherit;">Anda dapat menaikkan tanda centang satu tingkat lebih tinggi, tetapi kemudian jumlah node virtual dan node DOM itu sendiri akan berubah setiap kali bendera diaktifkan, dan ini adalah pekerjaan yang tidak perlu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kami idiomatis untuk mitril, kami menghasilkan halaman, memeriksa ada atau tidaknya atribut dalam model menggunakan operator ternary. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut adalah penutupan yang mengembalikan fungsi tampilan catatan:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> noteItem= <span class="hljs-function"><span class="hljs-params">model</span>=&gt;</span> {
  <span class="hljs-comment">// click event handler</span>
  <span class="hljs-keyword">const</span> event= <span class="hljs-function">(<span class="hljs-params"> msg, word=<span class="hljs-string">''</span>, time=<span class="hljs-literal">null</span></span>)=&gt;</span> <span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span> {<font></font>
    model.getItem(e.target.getAttribute(<span class="hljs-string">'data'</span>));
    <span class="hljs-keyword">if</span> ( !!msg ) {<font></font>
      model.save= { <span class="hljs-attr">err</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">msg</span>: msg };<font></font>
      model.word= word;<font></font>
      <span class="hljs-keyword">if</span> ( !!time )<font></font>
        model.item.completed= time;<font></font>
      vuDialog.open();<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      model.editMode= <span class="hljs-literal">true</span>;<font></font>
    }<font></font>
  };<font></font>
  <span class="hljs-comment">// trash icon's click handler</span>
  <span class="hljs-keyword">const</span> _trash= event(<span class="hljs-string">'trash'</span>, <span class="hljs-string">'Dlelete'</span>);<font></font>
  <font></font>
  <span class="hljs-comment">// check icon's click handler</span>
  <span class="hljs-keyword">const</span> _check= event(<span class="hljs-string">'check'</span>, <span class="hljs-string">'Complete'</span>,
    <span class="hljs-comment">// postgre timestamp string</span>
    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString().split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>].replace(<span class="hljs-string">'T'</span>, <span class="hljs-string">' '</span>));<font></font>
  <font></font>
  <span class="hljs-comment">// edit this note</span>
  <span class="hljs-keyword">const</span> _edit= event(<span class="hljs-string">''</span>);<font></font>
  <font></font>
  <span class="hljs-keyword">const</span> _time= <span class="hljs-function"><span class="hljs-params">ts</span>=&gt;</span> ts.split(<span class="hljs-string">'.'</span>)[<span class="hljs-number">0</span>];<font></font>
  <font></font>
  <span class="hljs-comment">// Single Note </span>
  <span class="hljs-keyword">const</span> _note= <span class="hljs-function"><span class="hljs-params">note</span>=&gt;</span> m(<span class="hljs-string">'section.note'</span>, {<span class="hljs-attr">key</span>: note.id}, [<font></font>
    m(<span class="hljs-string">'header.note-header'</span>, [ m(<span class="hljs-string">'p.note-meta'</span>, [
      <span class="hljs-comment">// note metadata</span>
      m(<span class="hljs-string">'span'</span>, { <span class="hljs-attr">style</span>: <span class="hljs-string">'padding: right: 3em'</span> }, <span class="hljs-string">`Created: <span class="hljs-subst">${_time( note.created )}</span>`</span>),<font></font>
      note.completed ? m(<span class="hljs-string">'span'</span>, <span class="hljs-string">`  Completed: <span class="hljs-subst">${_time( note.completed )}</span>`</span>) : <span class="hljs-string">''</span>, 
      <span class="hljs-comment">// note right panel </span>
      m(<span class="hljs-string">'a.note-pan'</span>, m(<span class="hljs-string">'i.fas.fa-trash'</span>, { <span class="hljs-attr">data</span>: note.id, <span class="hljs-attr">onclick</span>: _trash } )),<font></font>
      note.completed ? <span class="hljs-string">''</span> : [<font></font>
        m(<span class="hljs-string">'a.note-pan'</span>, m(<span class="hljs-string">'i.fas.fa-pen'</span>, {<span class="hljs-attr">data</span>: note.id, <span class="hljs-attr">onclick</span>: _edit } )),<font></font>
        m(<span class="hljs-string">'a.note-pan'</span>, m(<span class="hljs-string">'i.fas.fa-check'</span>, { <span class="hljs-attr">data</span>: note.id, <span class="hljs-attr">onclick</span>: _check} ))<font></font>
      ]<font></font>
    ]),<font></font>
      m(<span class="hljs-string">'h2.note-title'</span>, { <span class="hljs-attr">style</span>: note.completed ? <span class="hljs-string">'text-decoration: line-through'</span>: <span class="hljs-string">''</span>}, note.title)<font></font>
    ]),<font></font>
    m(<span class="hljs-string">'.note-content'</span>, m(<span class="hljs-string">'p'</span>, note.content))<font></font>
  ]);<font></font>
  <span class="hljs-keyword">return</span> _note;<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua penangan klik didefinisikan secara lokal. Model tidak tahu bagaimana objek catatan terstruktur, saya hanya mendefinisikan properti kunci, yang dengannya kita dapat memilih elemen yang diinginkan dari array model.list. Namun, komponen harus tahu persis bagaimana objek yang digambar terstruktur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan memberikan teks lengkap dari kode untuk formulir untuk mengedit catatan, kita hanya melihat penangan pengiriman formulir secara terpisah:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-comment">// form submit handler</span>
  <span class="hljs-keyword">const</span> _submit= <span class="hljs-function"><span class="hljs-params">e</span>=&gt;</span> {<font></font>
    e.preventDefault();<font></font>
    model.item.title= clean(model.item.title);<font></font>
    model.item.content= clean(model.item.content);<font></font>
    <span class="hljs-keyword">const</span> check= check_note(model.item);
    <span class="hljs-keyword">if</span> ( !!check ) {<font></font>
      model.save= { <span class="hljs-attr">err</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">msg</span>: check }; <font></font>
      model.word= <span class="hljs-string">'Edit'</span>;<font></font>
      vuDialog.open();<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<font></font>
    } <font></font>
    <span class="hljs-keyword">return</span> moModel.formSubmit(e, model, _method() ).then(
      <span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span> { model.editMode=<span class="hljs-literal">false</span>; <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;}).catch(
      <span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span> { vuDialog.open(); <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; } );<font></font>
  };</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Karena definisi terjadi pada penutupan, kami memiliki tautan ke model, dan kami mengembalikan janji dengan pemrosesan selanjutnya dari hasil: larangan menampilkan formulir ketika permintaan selesai secara normal, atau dalam kasus kesalahan - membuka dialog dengan teks kesalahan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap kali Anda mengakses server backend, daftar catatan dibaca ulang. </font><font style="vertical-align: inherit;">Dalam contoh ini, tidak perlu menyesuaikan daftar dalam memori, meskipun ini bisa dilakukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Komponen dialog dapat dilihat dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositori</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , satu-satunya hal yang perlu ditekankan adalah bahwa dalam hal ini saya menggunakan objek literal untuk mendefinisikan komponen, karena saya ingin fungsi membuka dan menutup jendela tersedia untuk komponen lain.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kesimpulan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menulis aplikasi SPA kecil dalam javascript dan mithril.js, mencoba untuk tetap menggunakan idiom kerangka ini. </font><font style="vertical-align: inherit;">Saya ingin memperhatikan sekali lagi bahwa ini hanya kode javascript. </font><font style="vertical-align: inherit;">Mungkin tidak cukup bersih. </font><font style="vertical-align: inherit;">Pendekatan ini memungkinkan Anda untuk merangkum potongan-potongan kecil kode, mengisolasi mekanisme komponen, dan menggunakan keadaan umum untuk semua komponen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id492482/index.html">Acara digital di Moskow dari 16 hingga 22 Maret</a></li>
<li><a href="../id492484/index.html">Acara digital di St. Petersburg dari 16 Maret hingga 22 Maret</a></li>
<li><a href="../id492486/index.html">Nuxt + Django + GraphQL misalnya</a></li>
<li><a href="../id492488/index.html">OpenID Connect: otorisasi aplikasi internal dari generik ke standar</a></li>
<li><a href="../id492492/index.html">NikiRobot - sebuah evolusi dalam robotika pendidikan</a></li>
<li><a href="../id492500/index.html">Garasi Sains dalam bahasa Rusia. Pengalaman menerjemahkan pertunjukan Amerika</a></li>
<li><a href="../id492502/index.html">MIP * = RE: bukti pembuatan zaman dari bidang ilmu komputer yang menyebabkan efek domino dalam fisika dan matematika</a></li>
<li><a href="../id492504/index.html">Apa yang terjadi ketika modul JS diimpor dua kali?</a></li>
<li><a href="../id492506/index.html">3 cara membuat daftar besar di Angular</a></li>
<li><a href="../id492508/index.html">Pesan Kubernetes untuk DevOps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>