<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖇️ 🚣🏽 📠 Windows PowerShellとは何で、何を食べますか？パート2：プログラミング言語の概要 👨‍🎓 💆 🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="歴史的に、コマンドラインユーティリティはWindowsよりもUnixシステムで開発された方が優れていますが、新しいソリューションの登場により状況は変化しました。
 
 
 
 PowerShellの場合、従来の手続き型、オブジェクト指向、さらには関数型プログラミングの要素を含む、解釈されたマルチパラ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Windows PowerShellとは何で、何を食べますか？パート2：プログラミング言語の概要</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/490924/"><font color="#999999"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">歴史的に、コマンドラインユーティリティはWindowsよりもUnixシステムで開発された方が優れていますが、新しいソリューションの登場により状況は変化しました。</font></font></i></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/webt/-b/i_/73/-bi_73lwdxmnzvtveeghrwvtqay.png"></a><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellの場合、従来の手続き型、オブジェクト指向、さらには関数型プログラミングの要素を含む、解釈されたマルチパラダイム言語でスクリプトを書くことができます：条件付き分岐、ループ、変数、配列、ハッシュテーブル、クラス、エラー処理、および関数、コマンドレット、パイプライン。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前回の記事</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">は、環境での作業の基本について説明していましたが、今回はプログラマー向けの小さなガイドを読者に提供します。</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目次：</font></font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コメント</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数とそのタイプ</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム変数</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スコープ</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境変数（</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">算術</font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">）</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">算術演算</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子</font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">と比較</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">演算子代入</font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演算子論理演算子</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件付き遷移</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ループ</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュテーブル</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">関数</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラー処理</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
任意のテキストエディターまたは統合開発環境を使用してコードを記述できます-最も簡単な方法Microsoftサーバーオペレーティングシステムに含まれるWindows PowerShell ISE。</font><font style="vertical-align: inherit;">これは、かなり複雑なスクリプトにのみ必要です。短いコマンドセットは、対話的に実行する方が簡単です。</font></font><br>
<br>
<a name="section1"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コメント</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
コメントの使用は、適切なインデントとスペースとともに、優れたプログラミングスタイルの一部と見なされます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-comment">#       —     .</span><font></font>
<font></font>
<span class="hljs-comment">&lt;# 

             . 
            .

#&gt;</span></code></pre><br>
<a name="section2"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">変数とその型</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellの変数は名前付きオブジェクトです。</font><font style="vertical-align: inherit;">それらの名前には、アンダースコア、文字、数字を含めることができます。</font><font style="vertical-align: inherit;">$記号は常に名前の前に使用され、変数を宣言するには、有効な名前をインタープリターに示すのに十分です。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/jw/f_/bo/jwf_bojczpfg_r16puek7uuo4r0.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数を初期化（値を割り当てる）するには、代入演算子（記号=）を使用します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span> = <span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数を宣言するには、名前または値の前に角括弧（型変換演算子）でその型を示します。</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span><font></font>
<font></font>
<span class="hljs-variable">$test</span> = [<span class="hljs-built_in">int</span>]<span class="hljs-number">100</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellの変数は、.NET Coreで利用可能なものに基づいた型のプロパティとメソッドを持つ本格的なオブジェクト（クラス）であることを理解することが重要です。</font><font style="vertical-align: inherit;">主なものをリストします：</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">タイプ（.NETクラス）</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード例</font></font><br>
</th>
</tr>
<tr>
<td>[string]<br>
System.String<br>
</td>
<td> Unicode&nbsp;<br>
</td>
<td>$test = «»<br>
$test = ''<br>
</td>
</tr>
<tr>
<td>[char]<br>
System.Char<br>
</td>
<td> Unicode (16 )<br>
</td>
<td>[char]$test = 'c'<br>
</td>
</tr>
<tr>
<td>[bool]<br>
System.Boolean<br>
</td>
<td>  (  True  False)<br>
</td>
<td>[bool]$test = $true<br>
</td>
</tr>
<tr>
<td>[int]<br>
System.Int32<br>
</td>
<td>   (32 )<br>
</td>
<td>[int]$test = 123456789<br>
</td>
</tr>
<tr>
<td>[long]<br>
System.Int64<br>
</td>
<td>   (64 )<br>
</td>
<td>[long]$test = 12345678910<br>
</td>
</tr>
<tr>
<td>[single]<br>
System.Single<br>
</td>
<td>      32 <br>
</td>
<td>[single]$test = 12345.6789<br>
</td>
</tr>
<tr>
<td>[double]<br>
System.Double<br>
</td>
<td>      64  (8 )<br>
</td>
<td>[double]$test = 123456789.101112<br>
</td>
</tr>
<tr>
<td>[decimal]<br>
System.Decimal<br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">128ビット浮動小数点数（最後に必ずdを含める）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[10進数] $テスト= 12345.6789d</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[DateTime] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.DateTime</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">日時&nbsp;</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = Get-Date</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[配列] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Object []</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要素インデックスが0で始まる配列</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_array = 1、2、 "テスト"、3、4</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ハッシュテーブル] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
System.Collections.Hashtable</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュテーブル-原則に基づいて構築された、名前付きキーを持つ連想配列：@ {key = "value"}</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test_hashtable = @ {one = "one"; </font><font style="vertical-align: inherit;">two = "two"; </font><font style="vertical-align: inherit;">three = "three"}</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellは暗黙的な型変換をサポートしています。さらに、強制的に指定されていない場合、変数の型は（たとえば、代入演算子を使用して）オンザフライで変更できます。この場合、インタープリターはエラーをスローします。</font><font style="vertical-align: inherit;">GetType（）メソッドを呼び出すことにより、前の例から変数のタイプを判別できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test</span>.GetType().FullName</code></pre><br>
<img src="https://habrastorage.org/webt/j5/qf/vp/j5qfvplzg-n84l33ie1ogez8gp4.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
変数を管理するための多数のコマンドレットがあります。</font><font style="vertical-align: inherit;">次のコマンドを使用して、便利な形式のリストを表示します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Command</span> <span class="hljs-literal">-Noun</span> Variable | <span class="hljs-built_in">ft</span> <span class="hljs-literal">-Property</span> Name, Definition <span class="hljs-literal">-AutoSize</span> <span class="hljs-literal">-Wrap</span></code></pre><br>
<img src="https://habrastorage.org/webt/za/qc/1t/zaqc1t0hf3-onpravup8_h0euou.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
宣言された変数とその値を表示するには、特別なコマンドレットを使用できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-Variable</span> | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このメソッドは非常に扱いにくいように見えます。演算子を使用するか、プロパティとメソッドに直接アクセスすることで変数を操作する方がはるかに便利です。</font><font style="vertical-align: inherit;">ただし、いくつかの追加パラメーターを指定できるため、コマンドレットには存在する権利があります。</font><font style="vertical-align: inherit;">ユーザー変数は現在のセッション内でのみ定義されることを理解することが重要です。</font><font style="vertical-align: inherit;">コンソールを閉じるかスクリプトを完了すると、それらは削除されます。</font></font><br>
<br>
<a name="section3"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">システム変数</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザーが宣言した変数に加えて、現在のセッションの終了後に削除されない組み込み（システム）変数があります。</font><font style="vertical-align: inherit;">PowerShellのステータスデータは自動変数に格納されますが、それ自体で任意の値を割り当てることはできませんが、それらは2つのタイプに分けられます。</font><font style="vertical-align: inherit;">これらには、たとえば$ PWDが含まれます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$PWD</span>.Path</code></pre><br>
<img src="https://habrastorage.org/webt/8u/-5/p1/8u-5p10pygkqcoql1kymnbl3q-g.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ユーザー設定を保存するには、値を変更できる設定変数が必要です。</font><font style="vertical-align: inherit;">たとえば、$ ErrorActionPreferenceを使用して、重大ではないエラーの発生に対するコマンドインタープリターの応答を設定します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
演算子とコマンドレットに加えて、宣言された変数にアクセスするためのVariable：疑似アキュムレータが存在します。</font><font style="vertical-align: inherit;">他のドライブとの類推によってそれを扱うことができ、この場合の変数はファイルシステムオブジェクトに似ています。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">Get-ChildItem</span> Variable: | more</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
または </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">ls</span> Variable: | more</code></pre><br>
<img src="https://habrastorage.org/webt/h4/03/9e/h4039eawh2tpbuqpyqsidabwkyk.png" alt="画像"><br>
<br>
<a name="section4"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スコープ</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellの変数には、スコープの概念があります。</font><font style="vertical-align: inherit;">グローバル領域（グローバル）のアクションは、現在のセッション全体に及び、システム変数などが含まれます。</font><font style="vertical-align: inherit;">ローカル変数は、それらが定義された領域でのみ使用できます。関数の内部で考えてみましょう。</font><font style="vertical-align: inherit;">スクリプトスコープの概念もありますが、スクリプトコマンドの場合、基本的にローカルです。</font><font style="vertical-align: inherit;">デフォルトでは、変数を宣言すると、変数にローカルスコープが与えられます。これを変更するには、フォームの特別な構成が必要です：$ Global：variable = value。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、次のようになります。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$Global:test</span> = <span class="hljs-number">100</span></code></pre><br>
<a name="section5"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">環境変数</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別のEnv疑似ドライブがPowerShellから利用可能で、環境変数にアクセスするために使用できます。</font><font style="vertical-align: inherit;">シェルが起動すると、それらは親プロセス（つまり、現在のセッションを開始したプログラム）からコピーされ、通常、それらの初期値はコントロールパネルの値と一致します。</font><font style="vertical-align: inherit;">環境変数を表示するには、Get-ChildItemコマンドレットまたはそのエイリアス（liases）を使用します：lsおよびdir。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-built_in">dir</span> Env:</code></pre><br>
<img src="https://habrastorage.org/webt/rf/3d/19/rf3d19syyr5ouu4jnrnnf68gul4.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これらの変数はバイトのシーケンス（または必要に応じて文字）であり、その解釈はそれらを使用するプログラムにのみ依存します。</font><font style="vertical-align: inherit;">*-変数コマンドレットは環境変数では機能しません。</font><font style="vertical-align: inherit;">それらにアクセスするには、ディスク接頭辞を使用する必要があります。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$env:TEST</span> = <span class="hljs-string">"Hello, World!"</span></code></pre><br>
<img src="https://habrastorage.org/webt/iq/fk/zv/iqfkzvl82gwr-uxadfpudoladtg.png" alt="画像"><br>
<br>
<a name="section6"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">算術演算子と比較演算子</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellには、+（加算）、-（減算）、*（乗算）、/（除算）および％（モジュールまたは除算の剰余）の算術演算子があります。</font><font style="vertical-align: inherit;">算術式の結果は、一般に受け入れられている演算の順序に従って左から右に計算され、括弧は式の一部をグループ化するために使用されます。</font><font style="vertical-align: inherit;">オペレーター間のスペースは無視され、認識を容易にするためにのみ使用されます。</font><font style="vertical-align: inherit;">+演算子も連結し、*演算子は行を繰り返します。</font><font style="vertical-align: inherit;">文字列に数値を追加しようとすると、文字列に変換されます。</font><font style="vertical-align: inherit;">さらに、PowerShellには2つの値の対応をチェックしてブール値のTrueまたはFalseを返す比較演算子が多数あります。</font></font><br>
<div class="scrollable-table"><table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">オペレーター</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">説明</font></font><br>
</th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">コード例</font></font><br>
</th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-eq</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等しい（他の言語では類義語=または==）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -eq 123&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ne</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等しくない（アナログ&lt;&gt;または！=）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ne 123&nbsp;&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より大/より（アナログ&gt;）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -gt 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ge</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より大きいか等しい/より大きいか等しい（analog&gt; =）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -ge 123</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-lt</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">より小さい（アナログ&lt;）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -lt 123&nbsp;&nbsp;</font></font><br>
</td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-le</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下/以下（アナログ&lt;=）</font></font><br>
</td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ test = 100 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
$ test -le 123</font></font><br>
</td>
</tr>
</tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、文字列をワイルドカード文字と比較したり、正規表現を使用してパターンを一致させたりできる、同様の演算子が他にもあります。</font><font style="vertical-align: inherit;">これらについては、以下の記事で詳しく検討します。</font><font style="vertical-align: inherit;">記号&lt;、&gt;および=は、他の目的で使用されるため、比較には使用されません。</font></font><br>
<br>
<a name="section7"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代入演算子</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も一般的な演算子=に加えて、他の代入演算子があります：+ =、-=、* =、/ =および％=。</font><font style="vertical-align: inherit;">割り当て前に値を変更します。</font><font style="vertical-align: inherit;">単項演算子++および-は同様に動作し、変数の値を増減します。これらは代入演算子にも関連しています。</font></font><br>
<br>
<a name="section8"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">論理演算子</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
比較は困難な条件を説明するには不十分です。</font><font style="vertical-align: inherit;">演算子-and、-or、-xor、-not and！..を使用して論理式を書き留めることができます。これらは他のプログラミング言語と同じように機能し、括弧を使用して計算順序を指定できます。</font></font><br>
<br>
<pre><code class="powershell hljs">(<span class="hljs-string">""</span> <span class="hljs-operator">-eq</span> <span class="hljs-string">""</span>) <span class="hljs-operator">-and</span> (<span class="hljs-number">100</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>)<font></font>
<font></font>
<span class="hljs-operator">-not</span> (<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>) <font></font>
<font></font>
!(<span class="hljs-number">123</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">321</span>)</code></pre><br>
<a name="section9"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件付きジャンプ</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellの分岐演算子は標準です：IF（IF ... ELSE、IF ... ELSEIF ... ELSE）およびSWITCH。</font><font style="vertical-align: inherit;">例と一緒に使用することを検討してください：</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">100</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">50</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt;&gt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">100</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 100"</span><font></font>
}<font></font>
<span class="hljs-keyword">else</span> {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &lt; 100"</span><font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">5</span>
<span class="hljs-keyword">switch</span> (<span class="hljs-variable">$test</span>) {
     <span class="hljs-number">0</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 0"</span>}
     <span class="hljs-number">1</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 1"</span>}
     <span class="hljs-number">2</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 2"</span>}
     <span class="hljs-number">3</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 3"</span>}
     <span class="hljs-number">4</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 4"</span>}
     <span class="hljs-number">5</span> {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test = 5"</span>}<font></font>
     default {<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">"test &gt; 5    "</span>}<font></font>
}<font></font>
</code></pre><br>
<a name="section10"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">サイクル</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellには、WHILE、DO WHILE、DO UNTIL、FOR、およびFOREACHのいくつかのタイプのループがあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
前提条件ループは、/の実行中に次の場合に機能します。</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>) {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
条件は反復後にチェックされるため、事後条件付きのループは少なくとも1回は機能します。</font><font style="vertical-align: inherit;">この場合、条件が真の間はDO WHILEが機能し、偽の間はDO UNTILが機能します。</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">while</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>)<font></font>
<font></font>
<font></font>
<font></font>
[<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">do</span> {
      <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span>
      <span class="hljs-variable">$test</span> = <span class="hljs-variable">$test</span> + <span class="hljs-number">1</span> <font></font>
}<font></font>
<span class="hljs-keyword">until</span> (<span class="hljs-variable">$test</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">9</span>)
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FORループの反復回数は事前にわかっています。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$test</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">10</span>; <span class="hljs-variable">$test</span>++) {
       <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test</span><font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FOREACHループでは、配列またはコレクション（ハッシュテーブル）の要素を反復処理します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_collection</span> = <span class="hljs-string">"item1"</span>, <span class="hljs-string">"item2"</span>, <span class="hljs-string">"item3"</span>
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$item</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$test_collection</span>)<font></font>
{<font></font>
        <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$item</span><font></font>
}<font></font>
</code></pre><br>
<a name="section11"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">配列</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShell変数には、単一のオブジェクト（数値、文字列など）だけでなく、複数のオブジェクトも格納されます。</font><font style="vertical-align: inherit;">そのような変数の最も単純な種類は配列です。</font><font style="vertical-align: inherit;">配列は、1つの要素である複数の要素で構成することも、空にすることもできます。</font><font style="vertical-align: inherit;">要素を含まない。</font><font style="vertical-align: inherit;">宣言するには、次の記事で必要となる@（）演算子を使用します。他の配列を配列に追加する（多次元配列を作成する）、配列を引数として関数に渡すなど、同様のタスクを実行することが非常に重要です。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>() <span class="hljs-comment">#  </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列が初期化されると、その値はコンマ（特別な演算子）でリストされます： </font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>) <span class="hljs-comment">#      </span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ほとんどの場合、@（）演算子は省略できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合、1つの要素の配列は次のように初期化されます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = , <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
配列要素にアクセスするには、ゼロから始まる整数インデックスとインデックス演算子（角括弧）を使用します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
複数のインデックスをコンマで区切って指定できます。</font><font style="vertical-align: inherit;">複製：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>]</code></pre><br>
<img src="https://habrastorage.org/webt/vw/5t/qb/vw5tqbcl5agy4603ummtyg984es.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
演算子</font></font><code>..</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（2点-範囲演算子）は、上限と下限で定義されたセグメント上の整数の配列を返します。</font><font style="vertical-align: inherit;">たとえば、式1..4は4つの要素@（1、2、3、4）の配列を表示し、式8..5は配列@（8、7、6、5）を表示します。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/r-/sk/1h/r-sk1h628lw2hraptfbcukhekgs.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
範囲演算子を使用すると、配列（$ test_array = 1..4）を初期化したり、スライスを取得したりできます。</font><font style="vertical-align: inherit;">別のインデックスを持つ1つの配列内の要素のシーケンス。</font><font style="vertical-align: inherit;">この場合、負の数-1は配列の最後の要素を示し、-2は最後から2番目の要素を示します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">""</span>
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..2</span>]
<span class="hljs-variable">$test_array</span>[<span class="hljs-number">2</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">1</span><span class="hljs-type">..0</span>]
<span class="hljs-variable">$test_array</span>[-<span class="hljs-number">2</span><span class="hljs-type">..1</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
整数配列の値は、データ配列のインデックスの最大値より大きい場合があることに注意してください。</font><font style="vertical-align: inherit;">この場合、すべての値が最後に返されます：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span>[<span class="hljs-number">0</span><span class="hljs-type">..100</span>]</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
存在しない単一の配列要素にアクセスしようとすると、$ nullが返されます。</font></font><br>
<br>
<img src="https://habrastorage.org/webt/qt/oq/7v/qtoq7vdu_7qt710eszjme9s54rq.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellでは、配列に異なる型の要素を含めるか、強く型付けすることができます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_array</span> = <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">""</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>
<span class="hljs-keyword">for</span> ([<span class="hljs-built_in">int</span>]<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$test_array</span>.count; <span class="hljs-variable">$i</span>++)<font></font>
{<font></font>
          <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$test_array</span>[<span class="hljs-variable">$i</span>]<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
プロパティ$ test_array.countは、配列の要素数です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
強く型付けされた配列を作成する例：</font></font><br>
<br>
<pre><code class="powershell hljs">[<span class="hljs-built_in">int</span>[]]<span class="hljs-variable">$test_array</span> = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span></code></pre><br>
<a name="section12"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ハッシュテーブル</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellのもう1つの基本的なタイプの変数は、連想配列とも呼ばれるハッシュテーブルです。</font><font style="vertical-align: inherit;">ハッシュテーブルはJSONオブジェクトに似ており、Key-Valueベースで作成されます。</font><font style="vertical-align: inherit;">通常の配列とは異なり、それらの要素へのアクセスは、オブジェクトのプロパティである名前付きキーを使用して実行されます（インデックス演算子-角括弧も使用できます）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
空のハッシュテーブルは、サービスシンボル@と演算子の角かっこを使用して宣言されます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
宣言するときに、すぐにキーを作成し、それらに値を割り当てることができます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span> = <span class="hljs-selector-tag">@</span>{one=<span class="hljs-string">""</span>; two=<span class="hljs-string">""</span>; three=<span class="hljs-string">""</span>; <span class="hljs-string">"some key"</span>=<span class="hljs-string">"some value"</span>}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ハッシュテーブルに項目を追加するには、まだ存在しないキーを項目に割り当てるか、Add（）メソッドを使用する必要があります。</font><font style="vertical-align: inherit;">既存のキーを使用して割り当てを行った場合、その値は変化します。</font><font style="vertical-align: inherit;">ハッシュテーブルからアイテムを削除するには、Remove（）メソッドを使用します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-variable">$test_hashtable</span>.<span class="hljs-string">"some key"</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">"some key"</span>]
<span class="hljs-variable">$test_hashtable</span>.Add(<span class="hljs-string">"four"</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable">$test_hashtable</span>.five = <span class="hljs-string">""</span>
<span class="hljs-variable">$test_hashtable</span>[<span class="hljs-string">'five'</span>] = <span class="hljs-string">" "</span>
<span class="hljs-variable">$test_hashtable</span>.Remove(<span class="hljs-string">"one"</span>)</code></pre><br>
<img src="https://habrastorage.org/webt/tm/lu/rr/tmlurrhp6hctdugfaqilt06j3le.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
このタイプの変数は、関数およびコマンドレットへの引数として渡すことができます。次の記事では、これを行う方法を学び、別の同様のタイプであるPSCustomObjectについても検討します。 </font></font><br>
<br>
<a name="section13"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">機能</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellには、関数を含む、手続き型プログラミングに必要なすべての要素があります。</font><font style="vertical-align: inherit;">関数の語句Functionは、それらを記述するために使用されます。その後、関数の名前と演算子の括弧で囲まれた本体を示す必要があります。</font><font style="vertical-align: inherit;">必要に応じて、引数を関数に渡します。括弧内の名前の直後に引数を指定できます。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> - <span class="hljs-params">(1, ..., N)</span></span> <font></font>
{ <font></font>
        - <font></font>
} <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数は常に結果を返します-これは、複数のステートメントがある場合、そのすべてのステートメントの結果の配列です。</font><font style="vertical-align: inherit;">ステートメントが1つの場合、対応するタイプの単一の値が返されます。</font><font style="vertical-align: inherit;">return $ value構文は、値$ valueの要素を結果配列に追加し、ステートメントリストを中止します。空の関数は$ nullを返します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
たとえば、数値を二乗する関数を作成します。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sqr</span> <span class="hljs-params">(<span class="hljs-variable">$number</span>)</span></span><font></font>
{<font></font>
      <span class="hljs-keyword">return</span> <span class="hljs-variable">$number</span> * <span class="hljs-variable">$number</span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数本体では、その呼び出しの前に宣言された任意の変数を使用でき、PowerShellでの関数の呼び出しは異常に見える場合があります。引数（ある場合）は括弧で囲まれず、スペースで区切られます。 </font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
とか、ぐらい：</font></font><br>
<br>
<pre><code class="powershell hljs">sqr <span class="hljs-literal">-number</span> <span class="hljs-number">2</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
引数の受け渡し方法により、関数自体を角括弧で囲む必要がある場合があります。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_func</span> <span class="hljs-params">(<span class="hljs-variable">$n</span>)</span></span> {}<font></font>
test_func <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>     <span class="hljs-comment">#   </span>
(test_func) <span class="hljs-operator">-eq</span> <span class="hljs-variable">$null</span>   <span class="hljs-comment">#   — $true</span></code></pre><br>
<img src="https://habrastorage.org/webt/df/kv/mx/dfkvmx4lst2rmo68c0disf_ovl0.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数を説明するとき、引数にデフォルト値を割り当てることができます：</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">func</span> <span class="hljs-params">(<span class="hljs-variable">$arg</span> = value)</span></span> {
         <span class="hljs-comment"># </span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
関数の引数を記述するための別の構文があり、さらに、パラメーターをパイプラインから読み取ることができます。これは、エクスポートされたモジュールを検討して独自のコマンドレットを作成するときに、次の記事で役立ちます。</font></font><br>
<br>
<a name="section14"></a><h3><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エラー処理</font></font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PowerShellには、例外を処理するためのTry ... Catch ...最後のメカニズムがあります。</font><font style="vertical-align: inherit;">Tryブロックにはエラーが発生する可能性のあるコードが含まれており、Catchブロックにはそのハンドラが含まれています。</font><font style="vertical-align: inherit;">エラーがなければ、実行されません。</font><font style="vertical-align: inherit;">Finalブロックは、エラーの発生に関係なく、Tryブロックの後に実行されます。また、さまざまなタイプの例外に対応する複数のCatchブロックが存在する場合があります。</font><font style="vertical-align: inherit;">例外自体はデフォルトの非宣言変数（$ _）に書き込まれ、簡単に取得できます。</font><font style="vertical-align: inherit;">以下の例では、誤った値を入力しないように保護を実装しています。</font></font><br>
<br>
<pre><code class="powershell hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
        [<span class="hljs-built_in">int</span>]<span class="hljs-variable">$test</span> = <span class="hljs-built_in">Read-Host</span> <span class="hljs-string">" "</span>
        <span class="hljs-number">100</span> / <span class="hljs-variable">$test</span><font></font>
<font></font>
} <span class="hljs-keyword">catch</span> {<font></font>
<font></font>
         <span class="hljs-built_in">Write-Warning</span> <span class="hljs-string">" "</span>
         <span class="hljs-built_in">Write-Host</span> <span class="hljs-variable">$_</span><font></font>
<font></font>
}<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/tc/3s/e0/tc3se0iqqbes07g8jm0_zitavgw.png" alt="画像"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ここで、PowerShellプログラミングの基本が関係します。</font><font style="vertical-align: inherit;">次の記事では、さまざまなタイプの変数、コレクション、正規表現、関数、モジュール、カスタムコマンドレットの作成、およびオブジェクト指向プログラミングを使用した作業について詳しく説明します。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート1：Windows PowerShellの主な機能</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート3：スクリプトと関数へのパラメーターの受け渡し、コマンドレットの作成</font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">パート4：オブジェクトの操作、カスタムクラス</font></font><br>
</a><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja490908/index.html">ゾーンデータストレージ</a></li>
<li><a href="../ja490912/index.html">Sportmasterでのキャッシングシステムの選択方法。パート1</a></li>
<li><a href="../ja490916/index.html">大規模プロジェクトでの外部チームとの相互作用の問題</a></li>
<li><a href="../ja490918/index.html">Andrei Zaretsky、Alexander Trukhanov（続き）：「私たちは名前を持っていませんでしたが、傲慢がありました」</a></li>
<li><a href="../ja490920/index.html">「I Have Peend Pwned」での検索を49マイクロ秒に加速（C ++）</a></li>
<li><a href="../ja490926/index.html">初心者向けのユニティボール軌道2d</a></li>
<li><a href="../ja490932/index.html">[予報] Motornet-ロボット車両のデータ交換ネットワーク</a></li>
<li><a href="../ja490936/index.html">iOSでMLを作成する</a></li>
<li><a href="../ja490938/index.html">一度に数千ものログファイルを書き込む</a></li>
<li><a href="../ja490940/index.html">3Dプリンターを使用してquadrocopterを作成する</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>