<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí° üë®üèΩ‚Äçüè≠ üë©üèΩ‚Äçüè≠ Como aprendemos a recomendar filmes e por que voc√™ n√£o deve confiar apenas nas classifica√ß√µes üëí üë©üèø‚Äç‚öïÔ∏è üë©üèº‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine que voc√™ deseja passar a noite assistindo a um filme, mas n√£o sabe qual escolher. Os usu√°rios do Yandex geralmente se encontram na mesma situa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como aprendemos a recomendar filmes e por que voc√™ n√£o deve confiar apenas nas classifica√ß√µes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/497390/"><img src="https://habrastorage.org/webt/vu/_4/oo/vu_4oolbpa8pde7nsycpg5vpokq.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine que voc√™ deseja passar a noite assistindo a um filme, mas n√£o sabe qual escolher. Os usu√°rios do Yandex geralmente se encontram na mesma situa√ß√£o; portanto, nossa equipe desenvolve recomenda√ß√µes que podem ser encontradas no Search and Air. Parece que isso √© complicado: recebemos classifica√ß√µes de usu√°rios e, com a ajuda deles, treinamos o carro para encontrar filmes com probabilidade de dar 5 pontos, obtemos uma lista pronta de filmes. Mas essa abordagem n√£o funciona. Por qu√™? √â sobre isso que vou falar hoje.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um pouco de hist√≥ria. Em 2006, a Netflix lan√ßou o concurso de aprendizado de m√°quina do Pr√™mio Netflix. Se voc√™ se esqueceu de repente, a empresa ainda n√£o est√° transmitindo na Internet, mas alugou filmes em DVD. Mas, mesmo assim, era importante para ela prever a classifica√ß√£o do usu√°rio, a fim de recomendar algo a ele. Portanto, a ess√™ncia da competi√ß√£o: prever as classifica√ß√µes dos espectadores √© 10% melhor (de acordo com a m√©trica RMSE) que o Cinematch, o sistema de recomenda√ß√£o da Netflix. Essa foi uma das primeiras competi√ß√µes em massa desse tipo. O interesse aqueceu um enorme conjunto de dados (mais de 100 milh√µes de classifica√ß√µes), al√©m de um pr√™mio de US $ 1 milh√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A competi√ß√£o terminou em 2009. </font><font style="vertical-align: inherit;">As equipes do Pragmatic Chaos da BellKor e do The Ensemble chegaram √† linha de chegada com o mesmo resultado (RMSE = 0,8567), mas o The Ensemble ficou em segundo lugar porque enviou a solu√ß√£o 20 minutos depois dos concorrentes. </font><font style="vertical-align: inherit;">Resultados e trabalho podem ser encontrados </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mas a coisa mais interessante √© diferente. </font><font style="vertical-align: inherit;">Se voc√™ acredita nas hist√≥rias repetidas em confer√™ncias especializadas, os algoritmos vencedores n√£o apareceram em produ√ß√£o no servi√ßo de streaming de v√≠deo que foi lan√ßado em breve. </font><font style="vertical-align: inherit;">N√£o posso falar sobre os motivos das decis√µes de outras pessoas, mas vou lhe dizer por que fizemos o mesmo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Classifica√ß√£o pessoal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° h√° algum tempo, os usu√°rios do Yandex podem classificar os filmes que assistiram. E n√£o apenas no KinoPoisk, mas tamb√©m nos resultados da pesquisa. Com o tempo, acumulamos centenas de milh√µes de estimativas de dezenas de milh√µes de pessoas. Em algum momento, decidimos usar esses dados para ajudar os usu√°rios a entender o quanto eles gostariam de um filme. De fato, resolvemos o mesmo problema do concurso do Netflix, ou seja, previmos que classifica√ß√£o o usu√°rio daria ao filme. Naquela √©poca, as classifica√ß√µes KinoPoisk e IMDB j√° existiam, que foram constru√≠das com base nas classifica√ß√µes das pessoas. Como constru√≠mos uma classifica√ß√£o pessoal, decidimos usar uma escala separada como uma porcentagem para evitar semelhan√ßas visuais e confus√£o.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dd/tk/h7/ddtkh7i3ud_9q5lmqtvw-4ambgc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A prop√≥sito, a necessidade de correlacionar a escala de pontos e a porcentagem √© uma dor de cabe√ßa separada e n√£o √≥bvia, por isso vou falar brevemente sobre isso. </font><font style="vertical-align: inherit;">Parece que, para uma escala de 10 pontos, considere 10% para cada ponto - e o ponto est√° no chap√©u. </font><font style="vertical-align: inherit;">Mas n√£o. </font><font style="vertical-align: inherit;">A raz√£o √© psicologia e h√°bitos. </font><font style="vertical-align: inherit;">Por exemplo, do ponto de vista dos usu√°rios, uma classifica√ß√£o de 8/10 √© muito melhor que 80%. </font><font style="vertical-align: inherit;">Como correlacionar isso? </font><font style="vertical-align: inherit;">Com crowdsourcing! </font><font style="vertical-align: inherit;">E foi o que fizemos: lan√ßamos a tarefa em Tolok, na qual os atiradores descreviam as expectativas dos filmes com uma certa pontua√ß√£o ou porcentagem de classifica√ß√£o pessoal. </font><font style="vertical-align: inherit;">Com base nessa marca√ß√£o, selecionamos uma fun√ß√£o que traduz a previs√£o da pontua√ß√£o de ponto em porcentagem, para que as expectativas do usu√°rio sejam mantidas.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo de miss√µes em Tolok</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/webt/tw/fv/ux/twfvuxxkjd7rnkave0yuudmzs5q.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Prever as expectativas do filme √© √∫til, mas seria bom criar recomenda√ß√µes tamb√©m. </font><font style="vertical-align: inherit;">Ou seja, mostre imediatamente √† pessoa uma lista de bons filmes. </font><font style="vertical-align: inherit;">Nesse momento, muitos de voc√™s podem pensar: "E vamos classificar os filmes que o usu√°rio n√£o assistiu por classifica√ß√£o pessoal". </font><font style="vertical-align: inherit;">N√≥s pensamos assim tamb√©m no come√ßo. </font><font style="vertical-align: inherit;">Mas ent√£o eu tive que resolver dois problemas.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema da ferramenta</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando um usu√°rio procura um filme espec√≠fico (ou deseja alugar um DVD espec√≠fico), o servi√ßo deve prever a classifica√ß√£o desse filme espec√≠fico. Exatamente esse problema foi resolvido no concurso do Netflix, onde a m√©trica RMSE foi usada. Mas as recomenda√ß√µes resolvem um problema diferente: voc√™ n√£o precisa adivinhar a nota, mas encontrar um filme que acabar√° sendo assistido. E a m√©trica RMSE faz um mau trabalho nisso. Por exemplo, a penalidade por prever uma classifica√ß√£o de 2 em vez de 1 √© exatamente a mesma que para 5 em vez de 4. Mas nosso sistema nunca deve recomendar filmes nos quais o usu√°rio coloca 2! As m√©tricas baseadas em lista s√£o muito mais adequadas para esta tarefa, como Precision @ K, Recall @ K, MRR ou NDCG. N√£o posso deixar de falar um pouco mais sobre eles (mas se voc√™ n√£o estiver interessado nas m√©tricas, pule o pr√≥ximo par√°grafo). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar com a m√©trica.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MRR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (classifica√ß√£o rec√≠proca m√©dia). Veremos em que posi√ß√£o no ranking ser√° o filme com o qual o usu√°rio interagiu (por exemplo, assistiu ou elogiou) no per√≠odo de teste. A m√©trica MRR √© a posi√ß√£o reversa m√©dia do usu√°rio de um filme. I.e</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.7ex" height="4.259ex" viewBox="0 -1132.2 10204.2 1833.9" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-52" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-52" x="1811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-3D" x="2848" y="0"></use><g transform="translate(3626,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5367,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7833,0)"><g transform="translate(286,0)"><rect stroke="none" width="1964" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="1138" y="582"></use><g transform="translate(60,-403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6E" x="981" y="0"></use><g transform="translate(1118,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-75" x="737" y="-213"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>R</mi><mi>R</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>‚àë</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><mfrac><mn>1</mn><mrow><mi>r</mi><mi>a</mi><mi>n</mi><msub><mi>k</mi><mi>u</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-1">MRR = \frac{1}{|U|} \sum_{u=1}^{|U|} \frac{1}{rank_u}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Essa m√©trica, ao contr√°rio do RMSE, avalia a lista inteira, mas, infelizmente, analisa apenas o primeiro elemento adivinhado. No entanto, √© f√°cil modificar a m√©trica para se livrar dessa desvantagem. Podemos calcular a soma das posi√ß√µes inversas de todos os filmes com os quais o usu√°rio interagiu. Essa m√©trica √© chamada Classifica√ß√£o M√©dia de Acertos Rec√≠procos. Essa m√©trica leva em considera√ß√£o todos os filmes adivinhados na edi√ß√£o. Observe que a posi√ß√£o k no pagamento recebe um peso de 1 / k para um filme adivinhado e um peso de 0 para outro filme. Freq√ºentemente, 1 / log (k) √© usado em vez de 1 / k: √© mais prov√°vel que corresponda √† probabilidade de o usu√°rio rolar para a posi√ß√£o k. O resultado √© uma m√©trica DCG (ganho cumulativo descontado)</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></munderover><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.927ex" height="4.384ex" viewBox="0 -1186 16329.6 1887.7" role="img" focusable="false" style="vertical-align: -1.63ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-43" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-47" x="1589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-3D" x="2653" y="0"></use><g transform="translate(3431,0)"><g transform="translate(397,0)"><rect stroke="none" width="1056" height="60" x="0" y="220"></rect><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="496" y="582"></use><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="1046" y="0"></use></g></g></g><g transform="translate(5172,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJSZ1-2211" x="0" y="0"></use><g transform="translate(1056,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-55" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-7C" x="1046" y="0"></use></g><g transform="translate(1056,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-3D" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="1351" y="0"></use></g></g><g transform="translate(7805,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-4E" x="1494" y="675"></use><g transform="translate(1056,-287)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-73" x="989" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-3D" x="1458" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="2237" y="0"></use></g></g><g transform="translate(10897,0)"><g transform="translate(286,0)"><rect stroke="none" width="5025" height="60" x="0" y="220"></rect><g transform="translate(1421,614)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-61" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-69" x="1010" y="0"></use><g transform="translate(958,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6E" x="0" y="0"></use><g transform="translate(424,-107)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6F" x="503" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-73" x="989" y="0"></use></g></g></g><g transform="translate(60,-442)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-6D"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-61" x="833" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-78" x="1334" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-28" x="1862" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-31" x="2252" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-2C" x="2752" y="0"></use><g transform="translate(2143,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-6C"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-6F" x="278" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-67" x="779" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-28" x="4310" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-70" x="4700" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-6F" x="5203" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMATHI-73" x="5689" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-29" x="6158" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/yandex/blog/497390/&amp;usg=ALkJrhhUFzepP8zWzaHkn3MrnlcI2-B9EQ#MJMAIN-29" x="6548" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi><mi>C</mi><mi>G</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac><munderover><mo>‚àë</mo><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></munderover><munderover><mo>‚àë</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><mfrac><mrow><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><mrow><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mi>log</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-2">DCG = \frac{1}{|U|} \sum_{u=1}^{|U|} \sum_{pos=1}^{N} \frac{gain_{pos}}{\max(1, \log(pos))}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mas a contribui√ß√£o de diferentes usu√°rios para a m√©trica √© diferente: para algu√©m que adivinhou todos os filmes, para algu√©m que n√£o adivinhou nada. </font><font style="vertical-align: inherit;">Portanto, como regra, essa m√©trica √© normalizada. </font><font style="vertical-align: inherit;">Divida o DCG de cada usu√°rio no DCG de melhor classifica√ß√£o para esse usu√°rio. </font><font style="vertical-align: inherit;">A m√©trica resultante √© denominada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NDCG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ganho cumulativo com desconto normalizado). </font><font style="vertical-align: inherit;">√â amplamente utilizado para avaliar a qualidade da classifica√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, cada tarefa tem sua pr√≥pria m√©trica. </font><font style="vertical-align: inherit;">Mas o pr√≥ximo problema n√£o √© t√£o √≥bvio.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema de escolha</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° √© dif√≠cil descrever, mas vou tentar. Acontece que as pessoas n√£o d√£o notas altas aos filmes que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">costumam</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> assistir. Obras-primas raras de filmes, cl√°ssicos e obras de arte obt√™m as notas mais altas, mas isso n√£o impede as pessoas √† noite ap√≥s o trabalho com prazer de assistir a uma boa com√©dia, um novo filme de a√ß√£o ou uma espetacular √≥pera espacial. Acrescente a isso que os usu√°rios do Yandex n√£o gostaram de todos os filmes que j√° assistiram em algum lugar. E se focarmos apenas nas classifica√ß√µes mais altas, corremos o risco de obter um feed de filme recomendado que pare√ßa l√≥gico, os usu√°rios podem at√© reconhecer sua qualidade, mas no final eles n√£o assistir√£o a nada.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, √© assim que meu feed de filmes pode parecer se o classific√°ssemos por classifica√ß√£o pessoal e n√£o sab√≠amos nada sobre minhas visualiza√ß√µes no passado. √ìtimos filmes. Mas n√£o quero revis√°-los hoje.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/5y/gz/ot/5ygzotyougvrodtwyb_nlbp03va.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Acontece que, nas condi√ß√µes de classifica√ß√µes dispersas e na escassez de filmes com classifica√ß√µes altas, vale a pena olhar n√£o apenas para a classifica√ß√£o. Bem, ent√£o treinamos o carro para prever a exibi√ß√£o do filme recomendado, e n√£o a classifica√ß√£o. Parece l√≥gico, porque o usu√°rio quer isso. O que poderia dar errado? O problema √© que a fita ser√° preenchida com filmes, cada um dos quais √© bastante adequado para um passatempo f√°cil √† noite, mas sua classifica√ß√£o pessoal ser√° baixa. Os usu√°rios, √© claro, prestar√£o aten√ß√£o ao fato de que n√£o h√° "obras-primas" no feed, o que significa que a credibilidade das recomenda√ß√µes ser√° prejudicada, e eles n√£o assistir√£o ao que ver√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, chegamos ao entendimento de que √© necess√°rio um equil√≠brio entre os dois extremos. √â necess√°rio treinar a m√°quina para que sejam levados em considera√ß√£o o potencial de visualiza√ß√£o e a percep√ß√£o da recomenda√ß√£o por uma pessoa.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como nossas recomenda√ß√µes funcionam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso sistema faz parte da Pesquisa, portanto, precisamos criar recomenda√ß√µes muito rapidamente: o tempo de resposta do servi√ßo deve ser inferior a 100 milissegundos. </font><font style="vertical-align: inherit;">Portanto, tentamos realizar o maior n√∫mero poss√≠vel de opera√ß√µes pesadas offline, no est√°gio de prepara√ß√£o dos dados. </font><font style="vertical-align: inherit;">Todos os filmes e usu√°rios no sistema de recomenda√ß√£o s√£o representados por perfis (√© importante n√£o confundir com a conta), que incluem chaves de objetos, contadores e incorpora√ß√£o (em outras palavras, vetores em um determinado espa√ßo). </font><font style="vertical-align: inherit;">Perfis de filmes s√£o preparados todos os dias no YT ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lidos como "Yt"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) e carregados na RAM de m√°quinas que respondem a solicita√ß√µes. </font><font style="vertical-align: inherit;">Mas com os usu√°rios, tudo √© um pouco mais complicado.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos os dias, tamb√©m criamos o perfil principal do usu√°rio no YT e o enviamos para a loja Yandex, a partir da qual voc√™ pode obter o perfil em algumas dezenas de milissegundos. Mas os dados ficam desatualizados rapidamente se uma pessoa assiste e avalia ativamente o v√≠deo. N√£o √© bom se as recomenda√ß√µes come√ßarem a ficar abaixo. Portanto, lemos o fluxo de eventos do usu√°rio e formamos a parte din√¢mica do perfil. Quando uma pessoa entra em uma solicita√ß√£o, combinamos o perfil do reposit√≥rio com um perfil din√¢mico e obtemos um √∫nico perfil, que pode ficar para tr√°s da realidade por apenas alguns segundos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso acontece offline (ou seja, com anteced√™ncia) e agora vamos diretamente para o tempo de execu√ß√£o. Aqui, o sistema de recomenda√ß√£o consiste em duas etapas. A classifica√ß√£o de todo o banco de dados de filmes √© muito longa; portanto, na primeira etapa, simplesmente selecionamos v√°rias centenas de candidatos, ou seja, encontramos filmes que podem ser de interesse do espectador. Isso inclui pinturas populares e aquelas pr√≥ximas ao usu√°rio em alguns embeddings. Existem v√°rios algoritmos para encontrar rapidamente os vizinhos mais pr√≥ximos, usamos o HNSW (Hierarchical Navigable Small World). Com ele, encontramos os filmes mais pr√≥ximos do usu√°rio em apenas alguns milissegundos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na segunda etapa, extra√≠mos recursos (√†s vezes tamb√©m chamados de fatores) por filmes, pares de usu√°rios e usu√°rios / filmes e classificamos candidatos usando o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CatBoost</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Deixe-me lembr√°-lo: j√° percebemos que precisamos nos concentrar n√£o apenas nas visualiza√ß√µes, mas tamb√©m em outras caracter√≠sticas de qualidade das recomenda√ß√µes, portanto, para a classifica√ß√£o, chegamos a uma combina√ß√£o de v√°rios modelos CatBoost treinados para v√°rios objetivos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para encontrar candidatos, usamos incorpora√ß√£o de v√°rias decomposi√ß√µes matriciais: da vers√£o cl√°ssica do ALS, que prev√™ a avalia√ß√£o, a varia√ß√µes mais complexas baseadas no SVD ++. </font><font style="vertical-align: inherit;">Como recursos para classifica√ß√£o, s√£o utilizados contadores e filmes simples de eventos do usu√°rio, CTRs para v√°rios eventos, bem como modelos pr√©-treinados mais complexos. </font><font style="vertical-align: inherit;">Por exemplo, a previs√£o do ALS tamb√©m atua como um recurso. </font><font style="vertical-align: inherit;">Um dos modelos mais √∫teis √© a rede neural DSSM do Recomendador, da qual provavelmente falarei um pouco mais.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendador DSSM</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DSSM √© uma rede neural de duas torres. Cada torre constr√≥i sua pr√≥pria incorpora√ß√£o, ent√£o a dist√¢ncia do cosseno √© considerada entre as incorpora√ß√µes, esse n√∫mero √© a sa√≠da da rede. Ou seja, a rede aprende a avaliar a proximidade de objetos nas torres esquerda e direita. Redes neurais semelhantes s√£o usadas, por exemplo, em uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pesquisa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">web</font></a><font style="vertical-align: inherit;"> para encontrar documentos relevantes para uma consulta. Para a tarefa de pesquisa, uma solicita√ß√£o √© enviada para uma das torres e um documento para a outra. Para nossa rede, o papel da solicita√ß√£o √© desempenhado pelo usu√°rio, e os filmes atuam como documentos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A torre do filme constr√≥i a incorpora√ß√£o com base nos dados do filme: este √© o t√≠tulo, descri√ß√£o, g√™nero, pa√≠s, atores etc. Essa parte da rede √© bastante semelhante √† da pesquisa. No entanto, para o espectador, queremos usar a hist√≥ria dele. Para isso, agregamos a incorpora√ß√£o de filmes da hist√≥ria com o desaparecimento do tempo desde o momento do evento. Em seguida, al√©m da incorpora√ß√£o total, aplicamos v√°rias camadas da rede e, como resultado, obtemos uma incorpora√ß√£o de tamanho 400.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/lt/3k/v0/lt3kv0xtsbzqiyxq_333j3sgkua.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ considerar imediatamente todo o hist√≥rico do usu√°rio na incorpora√ß√£o, isso reduzir√° bastante o treinamento. </font><font style="vertical-align: inherit;">Portanto, vamos ao truque e aprendemos a rede em duas etapas. </font><font style="vertical-align: inherit;">Primeiro, aprenda o InnerDSSM mais simples. </font><font style="vertical-align: inherit;">Na entrada, ele recebe apenas os √∫ltimos 50 eventos da hist√≥ria do usu√°rio, sem se dividir em tipos de eventos (visualiza√ß√µes, classifica√ß√µes ...). </font><font style="vertical-align: inherit;">Em seguida, treinamos novamente o InnerDSSM resultante ao longo do hist√≥rico do usu√°rio, mas detalhando os tipos de eventos. </font><font style="vertical-align: inherit;">Ent√£o, obtemos o OuterDSSM, que √© usado em tempo de execu√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Usar uma rede de tempo de execu√ß√£o na testa requer muitos recursos de computa√ß√£o. </font><font style="vertical-align: inherit;">Portanto, salvamos os incorpora√ß√µes da torre de filmes no banco de dados, e os casamentos de acordo com o hist√≥rico do usu√°rio s√£o atualizados quase em tempo real. </font><font style="vertical-align: inherit;">Assim, durante o processamento da solicita√ß√£o, voc√™ precisa aplicar apenas uma pequena parte do OuterDSSM e calcular os cossenos, isso n√£o leva muito tempo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, nossas recomenda√ß√µes j√° est√£o dispon√≠veis em nossa pesquisa (por exemplo, mediante solicita√ß√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[o que ver]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), no servi√ßo Yandex.Air, e uma vers√£o adaptada dessa tecnologia tamb√©m √© usada no Yandex.Stations. </font><font style="vertical-align: inherit;">Mas isso n√£o significa que possamos relaxar. </font><font style="vertical-align: inherit;">Treinamos constantemente novos modelos, aplicamos mais e mais dados, tentamos novas abordagens de treinamento e novas m√©tricas de qualidade. </font><font style="vertical-align: inherit;">Na minha opini√£o, quanto mais antiga a √°rea, mais dif√≠cil √© se desenvolver. </font><font style="vertical-align: inherit;">Mas este √© o principal interesse dos especialistas.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt497376/index.html">O que fazer com as bochechas vermelhas para que seu nariz n√£o cres√ßa</a></li>
<li><a href="../pt497382/index.html">8 dificuldades das equipes √°geis durante a pandemia: ‚ÄúNdagwurugwu nke anya mmiri‚Äù, ·ªçj·ªç, oke iwe, ag·ªçnar, COVID-19</a></li>
<li><a href="../pt497384/index.html">Como estabelecer acesso seguro aos servidores no modo remoto</a></li>
<li><a href="../pt497386/index.html">Bolsistas da VK Fellowship falam sobre o futuro do ensino a dist√¢ncia, disciplina e socializa√ß√£o</a></li>
<li><a href="../pt497388/index.html">Um milion√©simo jogo de tiro do zero: um caminho independente para desenvolvedores</a></li>
<li><a href="../pt497392/index.html">Como crescer de um estudante para um engenheiro de software?</a></li>
<li><a href="../pt497394/index.html">Dez recursos com cursos de ci√™ncia da computa√ß√£o dispon√≠veis gratuitamente em abril</a></li>
<li><a href="../pt497396/index.html">Colegas: nem amigo nem inimigo, mas como?</a></li>
<li><a href="../pt497398/index.html">Processadores para servidor AMD EPYC Rome 7x32 - Registre o desempenho de um √∫nico n√∫cleo</a></li>
<li><a href="../pt497402/index.html">Como criar uma linguagem de programa√ß√£o Python?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>