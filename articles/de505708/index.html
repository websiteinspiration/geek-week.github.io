<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîû üèéÔ∏è üóùÔ∏è Warum schreiben wir keinen Code in Controller? üéâ üåî üàπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich denke, viele von Ihnen haben die Meinung geh√∂rt, dass die Controller keinen Code enthalten sollten, und daher wird ein Controller mit Methoden in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Warum schreiben wir keinen Code in Controller?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/505708/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich denke, viele von Ihnen haben die Meinung geh√∂rt, dass die Controller keinen Code enthalten sollten, und daher wird ein Controller mit Methoden in einer Zeile als ‚ÄûBest Practice‚Äú angesehen. Ich bezweifle wiederum, dass die Vorteile davon so gro√ü sind. </font><font style="vertical-align: inherit;">Wenn Sie √§hnliche Gedanken hatten, frage ich unter kat.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/8de/142/358/8de1423581455ddfe4a47f5af5693d62.png" alt="Bild"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hallo alle zusammen! </font><font style="vertical-align: inherit;">Ich m√∂chte sofort sagen, dass meine Meinung nicht wahr ist, und der Zweck dieses Beitrags ist es, meine Meinung zu √§u√üern und die Kommentare anderer zu h√∂ren. </font><font style="vertical-align: inherit;">All dies gilt f√ºr die Implementierung der API. Wenn Sie MVC mit Ansichten haben, funktioniert dieser Fall nicht, da es in diesem Fall besser ist, nur die Logik mit Ansicht in die Controller zu schreiben</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist los?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich bin sicher, dass viele von Ihnen mit einer typischen CRUD-Anwendung mit 3-Layer-Architektur arbeiten (√ºbrigens gibt es keine weiteren Layer, aber beim n√§chsten Mal mehr dar√ºber). </font><font style="vertical-align: inherit;">In dieser Architektur haben Sie eine Ebene f√ºr die Arbeit mit Daten (weitere DA), eine Ebene f√ºr Gesch√§ftslogik (weitere BL) und eine Ansichtsebene (weitere VL). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BL kann auf verschiedene Arten durchgef√ºhrt werden, ich habe 2 Optionen getroffen:</font></font><br>
<br>
<ul>
<li>Class ‚Äî         .    -  ,    , , .         IRepository    ,  API       ,             .</li>
<li>CQS ‚Äî      DTO (Command\Query) ,       .                  .</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Methoden haben eine Reihe von eigenen Regeln und eine davon ist, dass die Handler keine anderen Handler aufrufen k√∂nnen, sie m√ºssen v√∂llig unabh√§ngig sein, genau die gleiche Situation in der Implementierung durch eine gew√∂hnliche Klasse mit einer Reihe von Methoden, die Methoden sind so an das Feature gebunden, dass sie nicht sein k√∂nnen wiederverwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Betrachten Sie einige Implementierungen in diesem Stil, und dann werde ich den Code an die Controller √ºbertragen und analysieren, was wir verloren haben. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/94a/cec/90b/94acec90b37d7d50e3d2b8154ada6495.png" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/94a/a11/236/94aa11236a0675ae51802682b917003b.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dieser Form implementieren wir alle Methoden und rufen sie dann einfach auf API-Ebene auf: </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/57a/c90/589/57ac905897f3c4ddfe4807d5e0e2d3f0.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hoffe, Sie verstehen, dass der Code mit Befehl -&gt; Handler √§hnlich und nur mehr geteilt sein wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und es verfolgt mich immer, warum mache ich diese zus√§tzliche Arbeit?</font></font><br>
<br>
<ul>
<li>  ? ‚Äî ,         .<br>
<br>
 -       2 ,     ‚Äî   </li>
<li>      ? ‚Äî ,     ?      ,         IUserService?</li>
<li>?     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">TestServer</a>    end2end .</li>
</ul><br>
<h2>     </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lassen Sie uns den √úberschuss entfernen. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/ff0/05d/bcd/ff005dbcd0122ff451e06541214630f3.png" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/80b/44d/fb2/80b44dfb21071c0ebb8ef2e1e1199d42.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh Wunder, der Service-Code unterscheidet sich nicht vom Controller. Wir haben nur ein paar Attribute hinzugef√ºgt und sind bereit, http-Anfragen abzufangen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich glaube, dass ASP NET uns perfekt von der Arbeit mit HTTP abstrahiert hat. Wir haben den besten Ort, an dem wir mit unseren Typen arbeiten. </font><font style="vertical-align: inherit;">Ich wiederhole, wenn Sie Ansichten haben, ist es in Controllern besser, Code nur f√ºr View zu schreiben, und in Diensten schreiben Sie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiederverwendete</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Methoden, um Daten f√ºr View abzurufen. </font><font style="vertical-align: inherit;">In der heutigen Realit√§t haben wir jedoch immer h√§ufiger API + SPA.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Validierung?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die ASP NET Core Pipeline ist sehr gut abgestimmt und bietet viele L√∂sungen. Schauen Sie sich FluentValidation an. Sie werden eine Validierung hinzuf√ºgen, ohne den Code in den Controllern zu √§ndern.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Willst du mehr Trennung?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Trennen Sie die Schnittstelle und wenn Sie auch eine Implementierung ben√∂tigen. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/a19/389/bca/a19389bca07fbf6521fd5683a861bad5.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Bonus wird die Serviceschnittstelle zu einem Vertrag auf h√∂chster Ebene, und im Rahmen eines Prozesses ist es nur ein direkter Aufruf des Codes vom Controller. Im Rahmen der Client-Server-Kommunikation wird eine einfache Implementierung derselben Schnittstelle mithilfe von HttpClient ersetzt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schlie√üen Sie andere Kan√§le an</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn sie mir sagen, dass wir einen anderen Kanal haben k√∂nnen, zum Beispiel √ºber eine Warteschlange, kann ich einfach eine Instanz des Controllers abrufen und in einem anderen Kanal verwenden. </font><font style="vertical-align: inherit;">Dieser Controller l√∂st sich leicht von DI auf. </font><font style="vertical-align: inherit;">Dar√ºber hinaus ist ASP NET sehr flexibel und Sie k√∂nnen einigen Kan√§len beibringen, es selbst zu verarbeiten, indem Sie die Pipeline erneut √§ndern.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/95d/b6d/75e/95db6d75e8fe8cd3bc3fcd4101a821ad.png" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lustige Tatsache</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Testaufgabe in diesem Stil wird verworfen und abgelehnt. Sie haben jedoch viele Gr√ºnde, warum Sie dies getan haben. Wenn Sie jedoch zu einem Interview gehen und diskutieren, warum Sie den Code entwerfen, ist dies wahrscheinlich ein guter Ort, und Sie haben denselben Spezialisten, der das versteht Diese Programmierung ist </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vielf√§ltig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesamt</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen nur Dienste nach Repository-Typ, Cache, Client-API usw. wiederverwenden. Die Wiederverwendung der Logik zur Verarbeitung einer einzelnen Anforderung ist jedoch ein sehr seltener und h√∂chstwahrscheinlich ein schlechter Fall. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Ansatz muss wie andere an den richtigen Stellen angewendet werden, spart Zeit und ist sehr praktisch f√ºr APIs (Microservices), die f√ºr den √∂ffentlichen Zugriff geschlossen sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich glaube, dass die Controller der BL-Dienst oder Command \ QueryHandler sind, und in meinen Projekten √ºbe ich diesen Ansatz und teile die Controller sehr gut. Ich empfehle, dass Sie es auch versuchen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben die Verantwortung des Frameworks nicht erh√∂ht, es hatte eine Aufgabe:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anfragen annehmen</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ordnen Sie sie einem Modell zu</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufen Sie den von uns angegebenen Code gem√§√ü einigen Regeln auf</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gib Antworten</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie blieb bei ihm. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich sehe wirklich keine kritischen Probleme, warum dies nicht getan werden sollte, deshalb lade ich Sie ein, dies zu kommentieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich nicht viel geworfen werde, werden im n√§chsten Artikel die Schnittstellen f√ºr jede Serviceklasse des Systems behandelt. Ist dies erforderlich? </font><font style="vertical-align: inherit;">Lohnt es sich um </font><font style="vertical-align: inherit;">eine L√∂sung , </font><font style="vertical-align: inherit;">um zu </font><font style="vertical-align: inherit;">schreiben , </font><font style="vertical-align: inherit;">um es einfacher zu </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">furzen</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu benetzen.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de505698/index.html">7 Websites f√ºr das Website-Design. Was auszusuchen?</a></li>
<li><a href="../de505700/index.html">Ich werde Java-Programmierer interviewen. Eine Reihe von Fragen f√ºr jedes Level</a></li>
<li><a href="../de505702/index.html">Unbeholfener (fast w√∂rtlicher) Kopierschutz</a></li>
<li><a href="../de505704/index.html">Arbeiten Sie an einer Fernbedienung - einem vergessenen Alten</a></li>
<li><a href="../de505706/index.html">FOSS News Nr. 19 - eine √úberpr√ºfung der kostenlosen und Open Source-Nachrichten f√ºr den 1. bis 7. Juni 2020</a></li>
<li><a href="../de505710/index.html">WebSockets und Spring WebFlux</a></li>
<li><a href="../de505720/index.html">Spring Boot + Apache Kafka und SSL im Docker-Container</a></li>
<li><a href="../de505724/index.html">Russische faire Verwendung: Wo ist die Urheberrechtsgrenze?</a></li>
<li><a href="../de505736/index.html">Ausf√ºhren, PHPUnit, Ausf√ºhren: Wie ich die Testausf√ºhrungszeit optimiert habe</a></li>
<li><a href="../de505738/index.html">Ein bisschen √ºber Periodogramme von Zeitreihen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>