<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😤 👩🏾‍🚒 👇🏾 Imitación del dibujo a mano alzada en el ejemplo de RoughJS 🙌🏽 🏻 🏴󠁧󠁢󠁳󠁣󠁴󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RoughJS es una pequeña biblioteca de gráficos JavaScript (< 9KB ) que le permite dibujar en un estilo incompleto y escrito a mano . Te permite dibujar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Imitación del dibujo a mano alzada en el ejemplo de RoughJS</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500018/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RoughJS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es una pequeña biblioteca de gráficos JavaScript (&lt; </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">9KB</font></a><font style="vertical-align: inherit;"> ) que le permite dibujar en un </font><font style="vertical-align: inherit;">estilo </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incompleto y escrito a mano</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Te permite dibujar sobre </font></font><code>&lt;canvas&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y con </font></font><code>SVG</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En esta publicación quiero responder la pregunta más popular sobre RoughJS: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿cómo funciona?</font></font></strong><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06b/dcb/dee/06bdcbdee1eec1748f07434abb002f34.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un poco de historia</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fascinado por las imágenes de gráficos, diagramas y bocetos dibujados a mano, me pregunté, como un verdadero nerd: ¿puedo crear tales dibujos con la ayuda de un código, puedo imitar el dibujo con la mayor precisión posible a mano, sin dejar de preservar la posibilidad de implementación de software? Decidí centrarme en las primitivas (líneas, polígonos, elipses y curvas) para crear una biblioteca completa de gráficos 2D. En base a esto, puede crear bibliotecas y gráficos para dibujar gráficos y diagramas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de examinar brevemente el problema, encontré un artículo de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joe Wood</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y sus colegas llamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sketchy rendering para visualización de información</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Las técnicas descritas en él se convirtieron en la base de la biblioteca, especialmente en el dibujo de líneas y elipses.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En 2017, escribí la primera versión de la biblioteca, que solo funcionaba en Canvas. </font><font style="vertical-align: inherit;">Habiendo resuelto el problema, perdí interés en él. </font><font style="vertical-align: inherit;">Un año después, trabajé mucho con SVG y decidí adaptar RoughJS para trabajar con SVG. </font><font style="vertical-align: inherit;">También cambié la estructura de la API para hacerlo más simple y me centré en primitivas de gráficos vectoriales simples. </font><font style="vertical-align: inherit;">Hablé sobre la versión 2.0 en Hacker News y de repente ganó una inmensa popularidad. </font><font style="vertical-align: inherit;">En 2018, fue </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la segunda publicación más popular de ShowHN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde entonces, otras personas han creado cosas más sorprendentes basadas en RoughJS, por ejemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excalidraw</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do Cats &amp; Dogs ...</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la biblioteca de gráficos roughViz</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora hablemos de algoritmos ...</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desigualdad</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base fundamental para la imitación de figuras escritas a mano es el azar. </font><font style="vertical-align: inherit;">Cuando dibujamos a mano, cualquiera de las dos formas será algo diferente. </font><font style="vertical-align: inherit;">Nadie dibuja con precisión, por lo que cada punto espacial en RoughJS se ajusta para el desplazamiento aleatorio. </font><font style="vertical-align: inherit;">La magnitud de la aleatoriedad viene dada por un parámetro numérico </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/35d/b72/e5e/35db72e5e11caf5a6cb19e194b0a5972.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagina un punto </font></font><code>A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y un círculo a su alrededor. </font><font style="vertical-align: inherit;">Ahora reemplace con un </font></font><code>A</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">punto aleatorio dentro de este círculo. </font><font style="vertical-align: inherit;">El área de este círculo de aleatoriedad está controlada por el valor </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Líneas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las líneas escritas a mano nunca son rectas y a menudo muestran curvatura en la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">curva</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (descrita </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Aleatorizamos los dos puntos finales de la línea según la rugosidad. </font><font style="vertical-align: inherit;">Luego seleccionamos dos puntos aleatorios más aproximadamente a una distancia del 50% y 75% desde el final del segmento. </font><font style="vertical-align: inherit;">Al conectar estos puntos de la curva, obtenemos el efecto de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexión</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/633/f29/8fe/633f298feb4231e8c9d652cb2811b4ff.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al dibujar a mano, las personas a veces mueven el lápiz hacia adelante y hacia atrás a lo largo de la línea. </font><font style="vertical-align: inherit;">Esto es necesario para hacer que la línea sea más brillante o simplemente para corregir la rectitud de la línea. </font><font style="vertical-align: inherit;">Se ve algo como esto:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/377/2fd/665/3772fd6659c97c0dea4144645d63fdf7.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para agregar un efecto incompleto, RoughJS dibuja una línea dos veces. </font><font style="vertical-align: inherit;">En el futuro planeo hacer que este aspecto sea más personalizable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mira esta superficie del lienzo. </font><font style="vertical-align: inherit;">El parámetro de rugosidad cambia la apariencia de las líneas:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/vw/vy/fp/vwvyfpdytbbalxolkj9eufdctri.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el artículo original sobre lienzo, puedes dibujarte a ti mismo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al dibujar a mano, las líneas largas generalmente se vuelven menos rectas y más curvas. </font><font style="vertical-align: inherit;">Es decir, la aleatoriedad de las compensaciones para crear un efecto </font></font><code></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es una función de la longitud y el valor de la línea </font></font><code>randomness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sin embargo, escalar esta función no es adecuado para líneas muy largas. </font><font style="vertical-align: inherit;">Por ejemplo, en la imagen a continuación, se dibujan cuadrados concéntricos con la misma semilla aleatoria, es decir </font><font style="vertical-align: inherit;">de hecho, son una figura aleatoria, pero con una escala diferente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6f/943/aaf/c6f943aaf7f5fd94336286e902a7ed5b.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede notar que los bordes de los cuadrados exteriores se ven un poco más desiguales que los interiores. </font><font style="vertical-align: inherit;">Por lo tanto, también agregué un factor de amortiguación dependiendo de la longitud de la línea. </font><font style="vertical-align: inherit;">El coeficiente de atenuación se utiliza como una función escalonada en varias longitudes.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/f30/162/f0ff30162ccf5f76efab1543ed36b79a.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elipses (y círculos)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tome una hoja de papel y dibuje algunos círculos lo más rápido posible en un movimiento continuo. </font><font style="vertical-align: inherit;">Esto es lo que obtuve:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/268/911/691/2689116919287022e800ab72c7e3877f.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que los puntos de inicio y finalización del bucle no siempre coinciden. </font><font style="vertical-align: inherit;">RoughJS intenta imitar esto, mientras hace que la apariencia sea más completa (la técnica está adaptada del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artículo giCenter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El algoritmo encuentra los </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puntos de elipse donde </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">está determinado por el tamaño de la elipse. </font><font style="vertical-align: inherit;">Luego, cada punto se aleatoriza por su valor </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Luego se dibuja una curva a través de estos puntos. </font><font style="vertical-align: inherit;">Para obtener el efecto de los </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extremos desconectados, los</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puntos del segundo al último no coinciden con el primer punto. </font><font style="vertical-align: inherit;">En cambio, la curva conecta los puntos segundo y tercero.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d8/a4f/238/4d8a4f238460b44b847da72c22cbf3d1.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
También se dibuja una segunda elipse para que el bucle esté más cerrado y tenga un efecto de boceto adicional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el artículo original, puede dibujar elipses en una superficie de lienzo interactiva. </font><font style="vertical-align: inherit;">Varíe la aspereza y observe cómo cambia la forma:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/5g/9o/kq5g9ouwifltwn-qfp2tednoaqq.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el caso del dibujo lineal, algunos de estos artefactos se acentúan más si alguna forma se escala a diferentes tamaños. </font><font style="vertical-align: inherit;">En una elipse, este efecto es más notable porque la relación es cuadrática. </font><font style="vertical-align: inherit;">En la imagen a continuación, todos los círculos tienen la misma forma, pero los exteriores se ven más desiguales.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d1c/bc1/682/d1cbc168206970ade73e1b7a77639d7d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El algoritmo se ajusta automáticamente en función del tamaño de la forma, aumentando el número de puntos en el círculo ( </font></font><code>n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">A continuación se muestra el mismo conjunto de círculos generados mediante la sintonización automática.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa4/6f0/612/aa46f0612d82b8944e70fb888db8ac39.jpg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Llenando</font></font></h2><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> líneas </font><em><font style="vertical-align: inherit;">punteadas</font></em><font style="vertical-align: inherit;"> 
se usan generalmente para rellenar formas dibujadas a mano </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En el caso de los bocetos a mano alzada, las líneas no siempre permanecen dentro del contorno de las formas. </font><font style="vertical-align: inherit;">También son aleatorizados. </font><font style="vertical-align: inherit;">Densidad, ángulo, ancho de línea se puede ajustar.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e4/d62/0dc/1e4d620dc5d4e0c7167c7f64595537c6.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los cuadrados que se muestran arriba son fáciles de rellenar, pero en el caso de otras formas, pueden ocurrir todo tipo de problemas. </font><font style="vertical-align: inherit;">Por ejemplo, los polígonos cóncavos (en los que los ángulos pueden exceder los 180 °) a menudo causan tales problemas:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/20b/9cd/46f/20b9cd46fba00903739307fba87386f0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De hecho, la imagen de arriba está tomada de un informe de error en una de las versiones anteriores de RoughJS. Desde entonces, he actualizado el algoritmo de relleno de trazo adaptando la versión del </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">método de escaneo de cadenas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El algoritmo de escaneo de cadenas</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se puede usar para llenar cualquier polígono. Su principio es escanear un polígono usando líneas horizontales (líneas de trama). Las líneas de trama van desde la parte superior del polígono hacia abajo. Para cada línea de trama, determinamos en qué puntos la línea se cruza con el polígono. Construimos estos puntos de intersección de izquierda a derecha.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d9/6df/028/8d96df0287ebd8320120e61813fc30f6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pasando de un punto a otro, cambiamos del modo de relleno al modo sin relleno; </font><font style="vertical-align: inherit;">el cambio entre estados ocurre cuando cada punto de intersección en la línea de trama se encuentra. </font><font style="vertical-align: inherit;">Aquí se debe tener mucho más en cuenta, en particular, los casos límite y los métodos de optimización de escaneo; </font><font style="vertical-align: inherit;">Puede leer más sobre esto aquí: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rasterizar polígonos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o implementar un spoiler con pseudocódigo.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detalles de la implementación del algoritmo de escaneo de cadenas</font></font></b>
                        <div class="spoiler_text">     ()      .<br>
<br>
 —     (Edge Table, ET),   ,    <code>Y<sub>min</sub></code>.      <code>Y<sub>min</sub></code>,        <code>X<sub>min</sub></code>.<br>
<br>
 —     (Active Edge Table, AET),       ,     .<br>
<br>
        :<br>
<br>
<pre><code class="javascript hljs">interface EdgeTableEntry {
  <span class="hljs-attr">ymin</span>: number;<font></font>
  ymax: number;<font></font>
  x: number; <span class="hljs-comment">// Initialized to Xmin</span>
  iSlope: number; <span class="hljs-comment">// Inverse of the slope of the line: 1/m</span><font></font>
}<font></font>
<font></font>
interface ActiveEdgeTableEntry {<font></font>
  <span class="hljs-attr">scanlineY</span>: number; <span class="hljs-comment">// The y value of the scanline</span><font></font>
  edge: EdgeTableEntry;<font></font>
}</code></pre><br>
   ,    :<br>
<br>
<strong>1.</strong>  <em>y</em>   <em>y</em>  ET.      .<br>
<br>
<strong>2.</strong>  AET   .<br>
<br>
<strong>3.</strong>   ,   AET,  ET  :<br>
<br>
<strong>(a)</strong>    ET <em>y</em>  AET ,   <em>y<sub>min</sub> ≤ y</em>.<br>
<br>
<strong>(b)</strong>   AET ,   <em>y = y<sub>max</sub></em>,    AET  <em>x</em>.<br>
<br>
<strong>()</strong>      <em>y</em>,    <em>x</em>  AET.<br>
<br>
<strong>(d)</strong>   <em>y</em>   ,   , ..    .<br>
<br>
<strong>(e)</strong>    ,   AET,  <em>x</em>   <em>y</em> (<code>edge.x = edge.x + edge.iSlope</code>)</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la imagen a continuación (en el artículo original interactivo), cada cuadrado denota un píxel. </font><font style="vertical-align: inherit;">Puede mover los vértices para cambiar el polígono y observar qué píxeles se rellenarán tradicionalmente.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/o7/wg/2po7wg8kdj0ixdeogj9_b2hax78.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al rellenar trazos, el incremento de las líneas de trama se realiza en incrementos dependiendo de la densidad dada de líneas de trazos, y cada línea se dibuja utilizando el algoritmo descrito anteriormente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, este algoritmo es para líneas de trama horizontales. </font><font style="vertical-align: inherit;">Para implementar diferentes ángulos de trazos, el algoritmo primero rota la forma en sí por el ángulo de trazos deseado. </font><font style="vertical-align: inherit;">Luego se calculan las líneas de trama para la figura girada. </font><font style="vertical-align: inherit;">Además, las líneas calculadas giran de vuelta al ángulo de los trazos en la dirección opuesta.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9b/1ad/324/e9b1ad3244af05b53b02203659e7f6f7.jpg"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No solo rellenando trazos</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RoughJS también admite otros estilos de relleno, pero todos se derivan del mismo algoritmo de eclosión. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El sombreado cruzado</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> consiste en dibujar líneas discontinuas en un ángulo </font></font><code>angle</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y luego otras líneas en un ángulo </font></font><code>angle + 90°</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zigzag</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> busca conectar una línea discontinua con la anterior. </font><font style="vertical-align: inherit;">Para obtener un </font><font style="vertical-align: inherit;">patrón de </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puntos</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dibuje círculos pequeños a lo largo de las líneas punteadas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06b/dcb/dee/06bdcbdee1eec1748f07434abb002f34.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las curvas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo en RoughJS está normalizado a curvas: líneas, polígonos, elipses, etc. </font><font style="vertical-align: inherit;">Por lo tanto, el desarrollo natural de esta idea es crear una curva de croquis. </font><font style="vertical-align: inherit;">En RoughJS, pasamos un conjunto de puntos a una curva, después de lo cual usamos la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aproximación de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la curva </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">para</font></a><font style="vertical-align: inherit;"> convertirlos en </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">curvas de</font></a><font style="vertical-align: inherit;"> Bezier cúbicas </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada curva de Bezier tiene dos puntos finales y dos puntos de control. </font><font style="vertical-align: inherit;">Al aleatorizarlos sobre la base </font></font><code>roughness</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, también puede crear curvas "escritas a mano".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba3/0bd/82c/ba30bd82c30edfc43f6845670f97f4b0.png"></div><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Llenado de curvas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sin embargo, se requiere el proceso inverso para llenar las curvas. En lugar de normalizar todo a una curva, la curva se normaliza a un polígono. Después de obtener el polígono, puede usar el algoritmo de escaneo de línea para llenar la forma curva. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede muestrear puntos en la curva con la frecuencia deseada utilizando la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ecuación de la curva cúbica de Bezier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a85/bcc/2d5/a85bcc2d5b946e8e88df52f2080b5303.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si usamos la frecuencia de muestreo, que depende de la densidad de los trazos, obtenemos suficientes puntos para llenar la figura. Pero esto no es particularmente efectivo. Si parte de la curva es aguda, entonces necesitamos más puntos. Si parte de la curva es casi recta, entonces se necesitan menos puntos. Una solución puede ser determinar la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">curvatura / suavidad de la</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> curva. Si es muy curva, dividimos la curva en dos curvas más pequeñas. Si es suave, lo consideraremos simplemente como una línea recta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La suavidad de la curva se calcula utilizando el método descrito en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esta publicación</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . El valor de suavidad se compara con el valor de tolerancia, después de lo cual se toma la decisión de dividir la curva o no. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aquí está la misma curva con un nivel de tolerancia de 0.7:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/995/55d/9be/99555d9be7e6cc2223db46f6cbd98da8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basado solo en la tolerancia, el algoritmo proporciona suficientes puntos para representar la curva. </font><font style="vertical-align: inherit;">Sin embargo, no le permite deshacerse efectivamente de los puntos opcionales. </font><font style="vertical-align: inherit;">Esto ayudará al segundo parámetro llamado </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distancia</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Para reducir el número de puntos en este método, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se utiliza el algoritmo Ramer-Douglas-Pecker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los siguientes muestra los puntos generados con valores de la distancia, que equivale a </font></font><code>0.15</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>0.75</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>1.5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>3.0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c9/e93/6e1/4c9e936e15771d9d02d1768a2e14b70b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Según la </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rugosidad de la</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> forma, puede establecer el valor de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distancia</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apropiado </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Habiendo recibido todos los vértices del polígono, podemos rellenar bellamente las formas curvas:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/eb7/161/45beb716138e9836c8e841f63d15f28a.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Circuitos SVG</font></font></h2><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los contornos SVG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son una herramienta muy poderosa que se puede utilizar para crear todo tipo de imágenes impresionantes, pero debido a esto, es bastante difícil trabajar con ellas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RoughJS analiza el camino y lo normaliza en solo tres operaciones: </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mover</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Línea</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Curva cúbica</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analizador de datos de ruta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Después de la normalización, la figura se puede dibujar utilizando los métodos anteriores de dibujar líneas y curvas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El paquete de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puntos en ruta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> combina la normalización de rutas y el muestreo de puntos de curva para calcular los puntos de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">ruta</font></a><font style="vertical-align: inherit;"> correspondientes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente es un ejemplo de cálculo de puntos para una ruta </font></font><code>M240,100c50,0,0,125,50,100s0,-125,50,-150s175,50,50,100s-175,50,-300,0s0,-125,50,-100s0,125,50,150s0,-100,50,-100</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/585/374/dd6/585374dd67d5210ff7628540a6b5edaa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro ejemplo de SVG que me encanta mostrar es el </font><font style="vertical-align: inherit;">mapa </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">general</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de los Estados Unidos:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff7/68b/675/ff768b675300dc4604b87dc2e81478c7.png"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prueba RoughJS</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consulte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el sitio web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repositorio en Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> o la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentación de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">API</font></a><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Siga</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Twitter </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">@RoughLib</font></a><font style="vertical-align: inherit;"> para </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">obtener información del</font></a><font style="vertical-align: inherit;"> proyecto </font><font style="vertical-align: inherit;">.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es500008/index.html">Conoce a los escaladores</a></li>
<li><a href="../es500010/index.html">Historia del hidrógeno sucio.</a></li>
<li><a href="../es500012/index.html">Entity Framework Core</a></li>
<li><a href="../es500014/index.html">El diseño totalmente receptivo es más que solo consultas de medios</a></li>
<li><a href="../es500016/index.html">Trabajo práctico con FPGAs en el conjunto de Redd. Dominar DMA para el bus Avalon-ST y cambiar entre buses Avalon-MM</a></li>
<li><a href="../es500020/index.html">Google Earth Engine: plataforma única de análisis de geodatos grandes</a></li>
<li><a href="../es500022/index.html">¿Por qué participar en la vida comunitaria y cómo ayuda al crecimiento profesional?</a></li>
<li><a href="../es500026/index.html">Tonterías en esta industria * simplemente increíble</a></li>
<li><a href="../es500028/index.html">Plataformas de gestión de datos: periféricos a la nube</a></li>
<li><a href="../es500030/index.html">Quién es bueno en una crisis: ejemplos de empresas de TI cuyas existencias aumentan durante una pandemia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>