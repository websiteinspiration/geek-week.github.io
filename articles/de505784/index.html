<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍✈️ 🖇️ ☮️ Wie und warum die Option noatime die Leistung des Linux-Systems verbessert 👼🏻 👩🏼‍💼 🦋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Aktualisieren von atime wirkt sich auf die Systemleistung aus. Was dort passiert und was dagegen zu tun ist - lesen Sie den Artikel.
 
 
 Immer we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Wie und warum die Option noatime die Leistung des Linux-Systems verbessert</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/505784/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Aktualisieren von atime wirkt sich auf die Systemleistung aus. </font><font style="vertical-align: inherit;">Was dort passiert und was dagegen zu tun ist - lesen Sie den Artikel.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ul/95/o-/ul95o-nvhv-_qxazmshaml17zwq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Immer wenn ich Linux auf meinem Heimcomputer aktualisiere, muss ich bestimmte Probleme lösen. Im Laufe der Jahre ist dies zur Gewohnheit geworden: Ich sichere meine Dateien, lösche das System, installiere alles von Grund auf neu, stelle meine Dateien wieder her und installiere meine Lieblingsanwendungen neu. Ich ändere auch die Systemeinstellungen für mich. Manchmal dauert es zu lange. Und vor kurzem habe ich mich gefragt, ob ich diese Kopfschmerzen brauche.</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atime</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist einer von drei Zeitstempeln für Dateien unter Linux (dazu später mehr). </font><font style="vertical-align: inherit;">Insbesondere habe ich mich gefragt, ob es sich immer noch lohnt, atime auf späteren Linux-Systemen zu deaktivieren. </font><font style="vertical-align: inherit;">Da atime bei jedem Zugriff auf eine Datei aktualisiert wird, wurde mir klar, dass dies einen erheblichen Einfluss auf die Systemleistung hat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe kürzlich ein Upgrade auf Fedora 32 durchgeführt und aus Gewohnheit zunächst atime deaktiviert. </font><font style="vertical-align: inherit;">Ich dachte: brauche ich das wirklich? </font><font style="vertical-align: inherit;">Ich habe mich entschlossen, dieses Thema zu studieren, und das habe ich ausgegraben.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein bisschen über Dateizeitstempel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um dies zu verstehen, müssen Sie einen Schritt zurücktreten und sich an einige Dinge über Linux-Dateisysteme erinnern und daran, wie der Kernel Dateien und Verzeichnissen Zeitstempel zuweist. </font><font style="vertical-align: inherit;">Sie können das Datum der letzten Änderung von Dateien und Verzeichnissen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anzeigen,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indem Sie den </font><b><font style="vertical-align: inherit;">Befehl ls -l (long) ausführen</font></b><font style="vertical-align: inherit;"> oder einfach die Informationen dazu im Dateimanager anzeigen. </font><font style="vertical-align: inherit;">Hinter den Kulissen verfolgt der Linux-Kernel jedoch mehrere Zeitstempel für Dateien und Verzeichnisse:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wann wurde die Datei das letzte Mal geändert (mtime)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wann wurden die Eigenschaften und Dateimetadaten das letzte Mal geändert (ctime)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wann wurde das letzte Mal auf eine Datei zugegriffen (atime)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dem Befehl </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können Sie </font><font style="vertical-align: inherit;">Datei- oder Verzeichnisinformationen anzeigen. </font><font style="vertical-align: inherit;">Hier ist die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei / etc / fstab</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von einem meiner Testserver:</font></font></li>
</ol><br>
<pre><code class="bash hljs">$ <span class="hljs-built_in">stat</span> fstab<font></font>
  File: fstab<font></font>
  Size: 261             Blocks: 8          IO Block: 4096   regular file<font></font>
Device: b303h/45827d    Inode: 2097285     Links: 1<font></font>
Access: (0664/-rw-rw-r--)  Uid: (    0/    root)   Gid: (    0/    root)<font></font>
Context: system_u:object_r:etc_t:s0<font></font>
Access: 2019-04-25 21:10:18.083325111 -0500<font></font>
Modify: 2019-05-16 10:46:47.427686706 -0500<font></font>
Change: 2019-05-16 10:46:47.434686674 -0500<font></font>
 Birth: 2019-04-25 21:03:11.840496275 -0500</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier können Sie sehen, dass diese Datei am 25. April 2019 erstellt wurde, als ich das System installiert habe. </font><font style="vertical-align: inherit;">Meine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei / etc / fstab</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wurde zuletzt am 16. Mai 2019 geändert, und alle anderen Attribute wurden ungefähr zur gleichen Zeit geändert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / fstab</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in eine neue Datei </font><font style="vertical-align: inherit;">kopiere </font><font style="vertical-align: inherit;">, ändern sich die Daten, was darauf hinweist, dass es sich um eine neue Datei handelt:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo cp fstab fstab.bak<font></font>
$ <span class="hljs-built_in">stat</span> fstab.bak<font></font>
  File: fstab.bak<font></font>
  Size: 261             Blocks: 8          IO Block: 4096   regular file<font></font>
Device: b303h/45827d    Inode: 2105664     Links: 1<font></font>
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)<font></font>
Context: unconfined_u:object_r:etc_t:s0<font></font>
Access: 2020-05-12 17:53:58.442659986 -0500<font></font>
Modify: 2020-05-12 17:53:58.443659981 -0500<font></font>
Change: 2020-05-12 17:53:58.443659981 -0500<font></font>
 Birth: 2020-05-12 17:53:58.442659986 -0500</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn ich die Datei jedoch nur umbenenne, ohne ihren Inhalt zu ändern, aktualisiert Linux nur die Änderungszeit der Datei:</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo mv fstab.bak fstab.tmp<font></font>
$ <span class="hljs-built_in">stat</span> fstab.tmp<font></font>
  File: fstab.tmp<font></font>
  Size: 261             Blocks: 8          IO Block: 4096   regular file<font></font>
Device: b303h/45827d    Inode: 2105664     Links: 1<font></font>
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)<font></font>
Context: unconfined_u:object_r:etc_t:s0<font></font>
Access: 2020-05-12 17:53:58.442659986 -0500<font></font>
Modify: 2020-05-12 17:53:58.443659981 -0500<font></font>
Change: 2020-05-12 17:54:24.576508232 -0500<font></font>
 Birth: 2020-05-12 17:53:58.442659986 -0500</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Zeitstempel sind für bestimmte Unix-Programme sehr nützlich. Zum Beispiel ist biff ein Programm, das Sie über eine neue Nachricht in einer E-Mail benachrichtigt. Jetzt verwenden nur noch wenige Leute </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biff</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber in jenen Tagen, als Postfächer lokal im System waren, war Biff ziemlich weit verbreitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Woher weiß das Programm, ob Sie neue E-Mails in Ihrem Posteingang haben? biff vergleicht die letzte geänderte Zeit (als der Posteingang mit einer neuen E-Mail aktualisiert wurde) und die letzte Zugriffszeit (als Sie Ihre E-Mail das letzte Mal gelesen haben). Wenn die Änderung später als der Zugriff erfolgt ist, wird biff verstehen, dass ein neuer Brief eingetroffen ist, und Sie darüber informieren. Der E-Mail-Client von Mutt funktioniert ähnlich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Zeitstempel für den letzten Zugriff ist auch nützlich, wenn Sie Statistiken zur Dateisystemnutzung erfassen und die Leistung optimieren müssen. Systemadministratoren müssen wissen, auf welche Objekte zugegriffen wird, um das Dateisystem ordnungsgemäß zu konfigurieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die meisten modernen Programme benötigen dieses Label jedoch nicht mehr, sodass vorgeschlagen wurde, es nicht zu verwenden. Im Jahr 2007 diskutierten Linus Torvalds und mehrere andere Kernel-Entwickler zeitweise im Zusammenhang mit Leistungsproblemen. Der Linux-Kernel-Entwickler Ingo Molnar machte die folgende Bemerkung zu atime und dem ext3-Dateisystem:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">„Es ist ziemlich seltsam, dass jeder Desktop- und Linux-Server aufgrund ständiger Aktualisierungen von atime unter einem spürbaren Rückgang der E / A-Leistung leidet, obwohl es nur zwei echte Benutzer gibt: tmpwatch [das für die Verwendung von ctime konfiguriert werden kann, dies ist also kein großes Problem] und einige Backup-Tools. " </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber die Leute benutzen immer noch einige Programme, die dieses Label brauchen. </font><font style="vertical-align: inherit;">Das Entfernen von Zeit wird also ihre Arbeit stören. </font><font style="vertical-align: inherit;">Linux-Kernel-Entwickler sollten die Benutzerfreiheit nicht verletzen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salomos Entscheidung</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Linux-Distributionen enthalten viele Anwendungen, und Benutzer können je nach Bedarf auch andere Programme herunterladen und installieren. Dies ist ein wesentlicher Vorteil eines Open Source-Betriebssystems. Dies macht es jedoch schwierig, die Leistung Ihres Dateisystems zu optimieren. Das Entfernen ressourcenintensiver Komponenten kann das System stören. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Kompromiss haben Linux-Kernel-Entwickler die neue Relaytime-Option eingeführt, mit der ein Gleichgewicht zwischen Leistung und Kompatibilität hergestellt werden soll:</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atime wird nur aktualisiert, wenn die vorherige Zugriffszeit kürzer als die aktuelle Zeit zum Aktualisieren oder Ändern des Status ist ... Ab Linux 2.6.30 verwendet der Kernel diese Option standardmäßig (wenn noatime nicht angegeben ist) ... Auch ab Linux 2.6 .30, die Zeit, zu der zuletzt auf die Datei zugegriffen wurde, wird immer aktualisiert, wenn sie älter als 1 Tag ist. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Moderne Linux-Systeme (beginnend mit Linux 2.6.30, veröffentlicht im Jahr 2009) verwenden bereits Relaytime, was einen wirklich großen Leistungsschub bringen dürfte. </font><font style="vertical-align: inherit;">Dies bedeutet, dass Sie die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei / etc / fstab</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nicht konfigurieren </font><font style="vertical-align: inherit;">müssen und sich bei der Relaytime auf den Standardwert verlassen können.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbesserung der Systemleistung mit noatime</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie Ihr System jedoch optimieren möchten, um maximale Leistung zu erzielen, können Sie atime weiterhin deaktivieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Leistungsänderung ist auf sehr schnellen modernen Laufwerken (wie NVME oder Fast SSD) möglicherweise nicht sehr auffällig, aber es gibt einen leichten Anstieg. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie wissen, dass Sie keine Software verwenden, für die atime erforderlich ist, können Sie die Leistung geringfügig verbessern, indem Sie die Option noatime in die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datei / etc / fstab aufnehmen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Danach wird der Kernel nicht ständig aktualisiert. </font><font style="vertical-align: inherit;">Verwenden Sie beim Mounten des Dateisystems die Option noatime:</font></font><br>
<br>
<pre><code class="bash hljs">/dev/mapper/fedora_localhost--live-root /          ext4   defaults,noatime,x-systemd.device-timeout=0 1 1<font></font>
UUID=be37c451-915e-4355-95c4-654729cf662a /boot    ext4   defaults,noatime        1 2<font></font>
UUID=C594-12B1                          /boot/efi  vfat   <span class="hljs-built_in">umask</span>=0077,shortname=winnt 0 2<font></font>
/dev/mapper/fedora_localhost--live-home /home      ext4   defaults,noatime,x-systemd.device-timeout=0 1 2<font></font>
/dev/mapper/fedora_localhost--live-swap none       swap   defaults,x-systemd.device-timeout=0 0 0</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Änderungen werden beim nächsten Neustart wirksam.</font></font><br>
<br>
<hr><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als Werbung</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Benötigen Sie einen Server zum Hosten der Site? </font><font style="vertical-align: inherit;">Unser Unternehmen bietet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zuverlässige Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit täglicher oder einmaliger Zahlung. Jeder Server ist mit einem Internetkanal von 500 Megabit verbunden und kostenlos vor DDoS-Angriffen geschützt!</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/9fa/cf4/a34/9facf4a348ef01048b4eb5e16ae66daa.png"></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de505764/index.html">Roboter Interview</a></li>
<li><a href="../de505766/index.html">Überwachen von Daten in Ruhe mit einem DCAP-System</a></li>
<li><a href="../de505772/index.html">Digitale Veranstaltungen in Moskau vom 8. bis 14. Juni</a></li>
<li><a href="../de505778/index.html">HCI: Schlüsselfertige Lösungen für den Aufbau einer flexiblen Unternehmens-IT-Infrastruktur</a></li>
<li><a href="../de505780/index.html">So erstellen Sie einen Angebotsgenerator in einer Stunde</a></li>
<li><a href="../de505786/index.html">5 klassische Kunsttechniken für eine gute Präsentation</a></li>
<li><a href="../de505788/index.html">Ozon Go Demo Day</a></li>
<li><a href="../de505796/index.html">CO2, Sp02 und COVID-19: Warum müssen Sie häufiger lüften (wenige Messungen)?</a></li>
<li><a href="../de505798/index.html">PHP 25 Jahre: eine kurze Geschichte der Sprache und 50% Rabatt auf PhpStorm</a></li>
<li><a href="../de505802/index.html">Hosting und dedizierte Server: Beantworten Sie Fragen. Teil 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>