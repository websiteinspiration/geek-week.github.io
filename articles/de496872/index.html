<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏳️ ◼️ 👩🏻‍🌾 Neues Hyperledger Fabric: Go SDK-Softwaremodell 👶🏿 🧑🏻 🍩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In einem früheren Artikel haben wir über das neue Programmiermodell des Codecodes in Hyperledger Fabric gesprochen. Obwohl die Veröffentlichung des ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Neues Hyperledger Fabric: Go SDK-Softwaremodell</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/496872/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/qw/s8/sbqws8367mab59tnf8ln9jliky0.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In einem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">früheren Artikel haben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir über das neue Programmiermodell des Codecodes in Hyperledger Fabric gesprochen. </font><font style="vertical-align: inherit;">Obwohl die Veröffentlichung des neuen Go SDK noch nicht stattgefunden hat, hindert uns nichts daran, zu sehen, was uns in Zukunft erwartet, und es sogar an einem Testbuild zu testen. </font><font style="vertical-align: inherit;">Es ist noch nicht alles implementiert (z. B. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commit-Handler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), aber das geplante Design des Softwaremodells ist bereits klar. Schauen wir uns das genauer an.</font></font><br>
<a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Repository habe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ich das Beispielraster geringfügig geändert, sodass es mit dem Kettencode beginnt, den wir im vorherigen Artikel gesehen haben, und einen einfachen Client hinzugefügt, der mit der neuen API geschrieben wurde. </font><font style="vertical-align: inherit;">Das Repository enthält einfache Anweisungen zum Starten und Konfigurieren des Netzwerks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">go.mod sehen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> können, verwenden wir zur Verwendung der neuen API keine Version (es gibt noch keine Version), sondern alle Änderungen an einem bestimmten Commit (dies ist eine vorübergehende Maßnahme vor der Veröffentlichung der Version): </font><font style="vertical-align: inherit;">
In unserer Anwendung </font><font style="vertical-align: inherit;">importieren </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">wir</font></a><font style="vertical-align: inherit;"> das Gateway-Paket </font><font style="vertical-align: inherit;">in </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">app.go.</font></a><font style="vertical-align: inherit;"> 
Das Wesentliche der neuen API Bereitstellung gemeinsamer Abstraktionen für alle SDKs (go, node, java) und Reduzierung der vom Entwickler von Projekt zu Projekt übertragenen Boilerplate. </font><font style="vertical-align: inherit;">Eine solche Abstraktion ist </font><b><font style="vertical-align: inherit;">Wallet.</font></b></font><br>
<br>
<code>require github.com/hyperledger/fabric-sdk-go v1.0.0-beta1.0.20200404205634-0e550fc1a918<br>
</code><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br>
<code>"github.com/hyperledger/fabric-sdk-go/pkg/gateway"</code><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Die Initialisierung der Brieftasche sieht folgendermaßen aus:</font></font><br>
<br>
<pre><code class="go hljs">wallet, err := gateway.NewFileSystemWallet(<span class="hljs-string">"wallet"</span>)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
	fmt.Errorf(err.Error())<font></font>
}<font></font>
<font></font>
err = wallet.Put(<span class="hljs-string">"admin"</span>, gateway.NewX509Identity(<span class="hljs-string">"Org1MSP"</span>, <span class="hljs-keyword">string</span>(cert), <span class="hljs-keyword">string</span>(privKey)))
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<font></font>
	fmt.Errorf(err.Error())<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wallet ist eine Implementierung der WalletStore-Oberfläche:</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> WalletStore <span class="hljs-keyword">interface</span> {<font></font>
	Put(label <span class="hljs-keyword">string</span>, stream []<span class="hljs-keyword">byte</span>) error<font></font>
	Get(label <span class="hljs-keyword">string</span>) ([]<span class="hljs-keyword">byte</span>, error)<font></font>
	List() ([]<span class="hljs-keyword">string</span>, error)<font></font>
	Exists(label <span class="hljs-keyword">string</span>) <span class="hljs-keyword">bool</span>
	Remove(label <span class="hljs-keyword">string</span>) error<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen können, beschreibt diese Schnittstelle die grundlegenden Operationen mit der </font><font style="vertical-align: inherit;">Benutzeridentität</font><font style="vertical-align: inherit;"> speichern </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Zusätzlich zum Dateisystem kann die Identität im Speicher gespeichert werden. Verwenden Sie einfach eine andere integrierte Factory - </font><b><font style="vertical-align: inherit;">NewInMemoryWallet ()</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Stellen Sie eine Verbindung zum Netzwerk her:</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="go hljs">gw, err := gateway.Connect(gateway.WithConfig(config.FromFile(<span class="hljs-string">"./../connection-org1.yaml"</span>)),<font></font>
gateway.WithIdentity(wallet, <span class="hljs-string">"admin"</span>),<font></font>
gateway.WithDiscovery(<span class="hljs-literal">true</span>),<font></font>
gateway.WithCommitHandler(gateway.DefaultCommitHandlers.OrgAny))</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.Connect ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gibt einen Zeiger auf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gateway zurück</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ein Objekt, das Netzwerkkonnektivität bereitstellt. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.WithCommitHandler</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - eine funktionale Option zum Festlegen einer Strategie zum Warten auf </font><i><font style="vertical-align: inherit;">Festschreibungsereignisse</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bisher wurde keine Strategie implementiert (was bedeutet, dass die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Standardstrategie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> des "alten" SDK </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Warten auf Commits von allen Endorsern"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwendet wird </font><font style="vertical-align: inherit;">), aber Folgendes ist geplant:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.DefaultCommitHandlers.OrgAll</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Warten Sie auf ein Commit bei allen Peers der Organisation (standardmäßig).</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.DefaultCommitHandlers.OrgAny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Warten auf ein Commit bei einem Organisations- </font><i><font style="vertical-align: inherit;">Peer</font></i></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.DefaultCommitHandlers.NetworkAll</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Warten auf ein Commit bei allen Peers aller Organisationen im Kanal</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.DefaultCommitHandlers.NetworkAny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Warten auf ein Commit bei einem Peer im Kanal</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können überhaupt nicht auf Commits warten, dazu später mehr, aber achten Sie zuerst darauf:</font></font><br>
<br>
<pre><code class="go hljs">network, err := gw.GetNetwork(<span class="hljs-string">"mychannel"</span>)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
	<span class="hljs-built_in">panic</span>(err)<font></font>
}<font></font>
<font></font>
contract := network.GetContract(<span class="hljs-string">"mycc"</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst erhalten wir vom Kanal eine Teilmenge von Peers, mit denen wir interagieren werden, und dann einen Zeiger auf Contract, dessen Methoden es uns ermöglichen, mit dem Kettencode zu interagieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt haben wir die Möglichkeit zu bestimmen, ob eine Strategie zum Warten auf ein Commit verwendet werden soll oder nicht. </font><font style="vertical-align: inherit;">Schauen wir uns zunächst eine Transaktion an, bei der ein Commit wartet:</font></font><br>
<br>
<pre><code class="go hljs">result, err := contract.SubmitTransaction(<span class="hljs-string">"Create"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"50"</span>)</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier starten wir die Simulation der Transaktion beim Peer, erhalten die Antwort, senden die Angebotsantwort an den Besteller, warten auf die Validierung und legen gemäß der obigen Strategie fest, um auf das Festschreiben zu warten. </font><font style="vertical-align: inherit;">Standard und vertrautes Verhalten. </font><font style="vertical-align: inherit;">Wir schauen weiter.</font></font><br>
<br>
<pre><code class="go hljs">result, err := contract.EvaluateTransaction(<span class="hljs-string">"Read"</span>, <span class="hljs-string">"b"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-built_in">panic</span>(err)<font></font>
	}<font></font>
fmt.Println(<span class="hljs-keyword">string</span>(result))</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall erhält der Kunde eine Angebotsantwort und unternimmt nichts anderes. </font><font style="vertical-align: inherit;">Wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erwarten keine Commits</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies sollte verwendet werden, um den Status zu lesen.</font></font><br>
<br>
<pre><code class="go hljs">transient := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>][]<span class="hljs-keyword">byte</span>)<font></font>
transient[<span class="hljs-string">"someTransient"</span>] = []<span class="hljs-keyword">byte</span>(<span class="hljs-string">"mytransientdata"</span>)<font></font>
txn, err := contract.CreateTransaction(<span class="hljs-string">"Update"</span>, gateway.WithTransient(transient))
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
	<span class="hljs-built_in">panic</span>(err)<font></font>
}<font></font>
result, err = txn.Submit(<span class="hljs-string">"b"</span>, <span class="hljs-string">"100"</span>)
<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
	<span class="hljs-built_in">panic</span>(err)<font></font>
}<font></font>
</code></pre><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contract.CreateTransaction</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bietet etwas mehr Kontrolle über die Transaktion, nämlich die Möglichkeit, funktionale Optionen zu übergeben:</font></font><br>
<br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.WithTransient (transient)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zum Senden privater Daten</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gateway.WithEndorsingPeers ("peer0.org1.example.com")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - zum manuellen Bestimmen von Zielen</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rufen Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">app.go auf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und ersetzen </font><font style="vertical-align: inherit;">Sie die </font><i><font style="vertical-align: inherit;">Transaktionsmethoden</font></i><font style="vertical-align: inherit;"> durch verschiedene Schlüssel, Werte und Optionen, um zu sehen, wie dies funktioniert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit ist die Überprüfung der neuen API abgeschlossen. </font><font style="vertical-align: inherit;">Übrigens ist es ganz einfach, Ihre eigene Brieftasche zu implementieren, Handler und Identität festzulegen, sodass Sie Standardimplementierungen zu denen hinzufügen können, die Ihren Zielen entsprechen, oder der Community Ihre eigenen Ideen und Ihren eigenen Code anbieten können. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielen Dank für Ihre Aufmerksamkeit.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de496860/index.html">Erster DI: Erster DI für Schnittstellen für Typoskriptanwendungen</a></li>
<li><a href="../de496862/index.html">Arduino Bubble Display</a></li>
<li><a href="../de496864/index.html">Audit Wallets in CryptoNote</a></li>
<li><a href="../de496868/index.html">Small Space Symphony</a></li>
<li><a href="../de496870/index.html">Android deklarative Programmierung von Client-Server-Anwendungen</a></li>
<li><a href="../de496874/index.html">Wir untersuchen die Mediastreamer2 VoIP-Engine. Teil 9</a></li>
<li><a href="../de496876/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends für die letzte Woche Nr. 410 (6. - 12. April 2020)</a></li>
<li><a href="../de496878/index.html">Feindliche KI: Jage einen Spieler ohne Navigation2D und finde den Pfad A *</a></li>
<li><a href="../de496880/index.html">VDI Skala-R BPM. Was ist es und woher kommt es?</a></li>
<li><a href="../de496882/index.html">So starten Sie USB Type-C in Ihren Designs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>