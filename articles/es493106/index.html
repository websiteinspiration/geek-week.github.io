<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêº üò¶ üñêüèΩ ¬øCu√°nto hay de nuevo en la Docena del Diablo? üçî üë©üèæ‚Äçüîß üëú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Estamos hablando solo de PostgreSQL 13. El 8 de abril tuvo lugar un "congelamiento": congelamiento de funciones de PostgreSQL , ahora solo se incluir√°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>¬øCu√°nto hay de nuevo en la Docena del Diablo?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/493106/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estamos hablando solo de PostgreSQL 13. El 8 de abril tuvo lugar un "congelamiento": </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">congelamiento de funciones de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PostgreSQL </font><font style="vertical-align: inherit;">, ahora solo se incluir√°n en esta versi√≥n las funciones que se aceptan antes de esta fecha. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es dif√≠cil nombrar una versi√≥n revolucionaria de esto. </font><font style="vertical-align: inherit;">No hay cambios cardinales, conceptuales en √©l. </font><font style="vertical-align: inherit;">Adem√°s, parches tan importantes como Tabla y Funciones para el est√°ndar JSON / SQL, que quer√≠a ver en PG12 junto al parche JSONPath, no tuvieron tiempo de ingresarlo; </font><font style="vertical-align: inherit;">el almacenamiento integrado listo para usar no apareci√≥, solo se est√° finalizando la interfaz. </font><font style="vertical-align: inherit;">Pero la lista de mejoras sigue siendo impresionante. </font><font style="vertical-align: inherit;">Hemos preparado un resumen bastante completo de los parches incluidos en la Docena del Diablo.</font></font></i><br>
<br>
<hr><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambios a los comandos SQL</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CREATE DATABASE ... LOCALE</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Utilities</font></font><code>initdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>createdb</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y el equipo</font></font><code>CREATE COLLATION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tiene una configuraci√≥n</font></font><code>LOCALE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que le permite especificar valores para la derecha</font></font><code>LC_CTYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>LC_COLLATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ahora apareci√≥ la misma oportunidad en el equipo</font></font><code>CREATE DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db_koi8r <span class="hljs-keyword">TEMPLATE</span> template0 
    <span class="hljs-keyword">ENCODING</span> <span class="hljs-string">'KOI8R'</span> LOCALE <span class="hljs-string">'ru_RU.KOI8R'</span>;</code></pre><a name="habracut"></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTERAR VISTA ... RENOMBRAR COLUMNA</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El nombre de la columna en la vista ahora se puede cambiar con el comando</font></font><code>ALTER VIEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Anteriormente, esto requer√≠a volver a crear la vista. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongamos que olvid√≥ darle un nombre a la columna:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">AS</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">current_timestamp</span>, <span class="hljs-built_in">current_timestamp</span> - pg_postmaster_start_time();
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |    ?column?     <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:00.088824+03 | 04:18:24.897856</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede arreglar:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">VIEW</span> uptime <span class="hljs-keyword">RENAME</span> <span class="hljs-keyword">COLUMN</span> "?column?" <span class="hljs-keyword">TO</span> uptime;
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> uptime;</code></pre><br>
<pre><code class="plaintext hljs">       current_timestamp       |     uptime      <font></font>
-------------------------------+-----------------<font></font>
 2020-03-23 15:37:40.726516+03 | 04:19:05.535548</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTER TABLE ... ALTER COLUMN ... DROP EXPRESSION</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La columna generada de la tabla ahora se puede normalizar, es decir, eliminar la expresi√≥n para evaluarla:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> payments (<font></font>
    id <span class="hljs-type">integer</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    income_tax <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>) <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> (amount*<span class="hljs-number">0.13</span>) STORED<font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> payments(id, amount) <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-number">42</span>);<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                                     Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable |                   Default            <font></font>
        <font></font>
------------+---------------+-----------+----------+--------------------------------------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          | generated always as ((amount * 0.13))<font></font>
 stored<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posteriormente, decidieron que se debe establecer expl√≠citamente el ingreso_tax. </font><font style="vertical-align: inherit;">Eliminar la expresi√≥n:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> payments <span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLUMN</span> income_tax <span class="hljs-keyword">DROP</span> EXPRESSION;<font></font>
\d payments</code></pre><br>
<pre><code class="plaintext hljs">                   Table "public.payments"<font></font>
   Column   |     Type      | Collation | Nullable | Default<font></font>
------------+---------------+-----------+----------+---------<font></font>
 id         | integer       |           | not null |<font></font>
 amount     | numeric(18,2) |           |          |<font></font>
 income_tax | numeric(18,2) |           |          |<font></font>
Indexes:<font></font>
    "payments_pkey" PRIMARY KEY, btree (id)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, los datos existentes de la columna no han desaparecido:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> payments;</code></pre><br>
<pre><code class="plaintext hljs"> id | amount | income_tax<font></font>
----+--------+------------<font></font>
  1 |  42.00 |       5.46</code></pre><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DROP DATABASE ... FORCE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si desea eliminar una base de datos sin esperar a que todos los usuarios se desconecten, puede usar la nueva opci√≥n de</font></font><code>FORCE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando</font></font><code>DROP DATABASE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con√©ctese a la nueva base de datos:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> dblink;
<span class="hljs-keyword">SELECT</span> dblink_connect(<span class="hljs-string">'dbname=db'</span>);</code></pre><br>
<pre><code class="plaintext hljs"> dblink_connect<font></font>
----------------<font></font>
 OK</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora eliminaremos, interrumpiendo por la fuerza, tambi√©n </font></font><code>pg_terminate_backend</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, las conexiones abiertas:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">DATABASE</span> db <span class="hljs-keyword">WITH</span> (FORCE);</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTERAR TIPO ... ESTABLECER ALMACENAMIENTO</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El comando</font></font><code>ALTER TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite que los tipos de datos b√°sicos cambien varias propiedades, en particular, la estrategia de almacenamiento. </font><font style="vertical-align: inherit;">Anteriormente, solo se pod√≠a configurar en un equipo</font></font><code>CREATE TYPE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para la demostraci√≥n, no crearemos un nuevo tipo base, sino que usaremos el existente</font></font><code>tsquery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pero primero, cree una base de datos separada y con√©ctese a ella:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> db;<font></font>
\c db</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se utiliza una estrategia de almacenamiento para el tipo de datos tsquery </font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por lo que las columnas de tablas de este tipo obtienen la misma estrategia:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | p</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | p</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si necesita utilizar una estrategia diferente para nuevas tablas, puede cambiar el tipo base:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=<span class="hljs-keyword">external</span>);
<span class="hljs-keyword">SELECT</span> typname,typstorage <span class="hljs-keyword">FROM</span> pg_type <span class="hljs-keyword">WHERE</span> typname = <span class="hljs-string">'tsquery'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> typname | typstorage<font></font>
---------+------------<font></font>
 tsquery | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El tipo de almacenamiento en las nuevas tablas tambi√©n cambiar√°:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> new_queries (query <span class="hljs-type">tsquery</span>);
<span class="hljs-keyword">SELECT</span> attname, attstorage <span class="hljs-keyword">FROM</span> pg_attribute <span class="hljs-keyword">WHERE</span> attrelid = <span class="hljs-string">'new_queries'</span>::<span class="hljs-type">regclass</span> <span class="hljs-keyword">AND</span> attname = <span class="hljs-string">'query'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> attname | attstorage<font></font>
---------+------------<font></font>
 query   | e</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debe tenerse en cuenta que cambiar una estrategia que implica el uso de TOAST </font></font><code>plain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no se puede </font><font style="vertical-align: inherit;">volver a cambiar a </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TYPE</span> <span class="hljs-type">tsquery</span> <span class="hljs-keyword">SET</span> (storage=plain);</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  cannot change type's storage to PLAIN</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, los experimentos se llevaron a cabo en una base de datos separada, lo cual no es una pena eliminar. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALTERAR ESTAD√çSTICAS ... ESTABLECER ESTAD√çSTICAS El</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
comando le </font></font><code>CREATE STATISTICS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permite recopilar listas de los valores m√°s comunes para combinaciones seleccionadas de columnas de tabla. </font><font style="vertical-align: inherit;">El n√∫mero de valores m√°s comunes recopilados est√° determinado por el par√°metro </font></font><code>default_statistics_target</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El valor para estad√≠sticas espec√≠ficas ahora se puede cambiar con el comando:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">STATISTICS</span>  <span class="hljs-keyword">SET</span> <span class="hljs-keyword">STATISTICS</span> _;</code></pre><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OBTENGA PRIMERO con la opci√≥n CON TIES</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Como sabe, en</font></font><code>SELECT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lugar de especificar un</font><font style="vertical-align: inherit;">comando</font><font style="vertical-align: inherit;">,</font></font><code>LIMIT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede usar la sintaxis definida en el est√°ndar SQL:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
(2 rows)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora es </font></font><code>FETCH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compatible con la frase </font></font><code>WITH TIES</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que agrega a la salida todas las l√≠neas "relacionadas" (l√≠neas iguales a las ya seleccionadas, si solo se tiene en cuenta la condici√≥n de clasificaci√≥n):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-string">'1.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.1'</span>), (<span class="hljs-number">2</span>,<span class="hljs-string">'2.2'</span>), (<span class="hljs-number">3</span>,<span class="hljs-string">'3.1'</span>)) t(a,b)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> a
<span class="hljs-keyword">FETCH FIRST</span> <span class="hljs-number">2</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">WITH</span> TIES;</code></pre><br>
<pre><code class="plaintext hljs"> a |  b  <font></font>
---+-----<font></font>
 1 | 1.1<font></font>
 2 | 2.1<font></font>
 2 | 2.2<font></font>
(3 rows)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funciones integradas y tipos de datos</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_random_uuid La</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
nueva funci√≥n</font></font><code>get_random_uuid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devuelve el valor de UUID de la versi√≥n 4 (valor aleatorio):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gen_random_uuid();</code></pre><br>
<pre><code class="plaintext hljs">           gen_random_uuid            <font></font>
--------------------------------------<font></font>
 25e02793-80c0-438c-be07-c94b966c43ab</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La funci√≥n es √∫til para generar valores √∫nicos de UUID en sistemas distribuidos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anteriormente, ten√≠a que usar las bibliotecas uuid-ossp o pgcrypto. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">min_scale y trim_scale para valores de tipo num√©rico</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La funci√≥n </font></font><code>min_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">determina el n√∫mero de d√≠gitos significativos en la parte fraccionaria del n√∫mero, y la funci√≥n </font></font><code>trim_scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descarta ceros </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;">no</font></b></a><font style="vertical-align: inherit;"> significativos </font><font style="vertical-align: inherit;">:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> n, min_scale(n), trim_scale(n) <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">42.42000</span>)) <span class="hljs-keyword">as</span> t(n);</code></pre><br>
<pre><code class="plaintext hljs">    n     | min_scale | trim_scale<font></font>
----------+-----------+------------<font></font>
 42.42000 |         2 |      42.42</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reposici√≥n de</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"> mcd y mcm</font></b></a><font style="vertical-align: inherit;"> en la secci√≥n de funciones matem√°ticas. </font><font style="vertical-align: inherit;">Ahora puede encontrar r√°pidamente el divisor com√∫n m√°s grande (</font></font><code>gcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) y el m√∫ltiplo com√∫n m√°s peque√±o (</font></font><code>lcm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> gcd(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>), lcm(<span class="hljs-number">54</span>,<span class="hljs-number">24</span>);</code></pre><br>
<pre><code class="plaintext hljs"> gcd | lcm<font></font>
-----+-----<font></font>
   6 | 216</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funciones agregadas min y max para el tipo pg_lsn</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se han agregado funciones agregadas para el</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tipo de datos</font><font style="vertical-align: inherit;">y</font><font style="vertical-align: inherit;">eso le permite realizar consultas del formulario:</font></font><code>pg_lsn</code><font style="vertical-align: inherit;"></font><code>min</code><font style="vertical-align: inherit;"></font><code>max</code><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> min(restart_lsn) <span class="hljs-keyword">FROM</span> pg_replication_slots;
<span class="hljs-keyword">SELECT</span> min(sent_lsn) <span class="hljs-keyword">FROM</span> pg_stat_replication;</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificaci√≥n del modificador de tipo del valor de retorno de una funci√≥n</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En versiones anteriores, el modificador de tipo no se verific√≥ por el valor de retorno de la funci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supongamos que hay un tipo para almacenar unidades monetarias y una funci√≥n que devuelve el monto del impuesto sobre la renta:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TYPE</span> currency <span class="hljs-keyword">AS</span> (<font></font>
    amount <span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>),<font></font>
    code   <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> income_tax(quantity currency) <span class="hljs-keyword">RETURNS</span> currency
    <span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT quantity.amount * 0.13, quantity.code'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Llamando a la funci√≥n, esperamos obtener dos decimales, sin embargo, obtenemos cuatro. </font><font style="vertical-align: inherit;">Incluso la conversi√≥n expl√≠cita despu√©s de una llamada de funci√≥n no ayuda (tercera columna):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]--<font></font>
amount | 5.5146<font></font>
code   | <font></font>
amount | 5.5146</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n 13, el resultado es correcto:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> amount, code, amount::<span class="hljs-type">numeric</span>(<span class="hljs-number">18</span>,<span class="hljs-number">2</span>)
<span class="hljs-keyword">FROM</span> income_tax(<span class="hljs-keyword">ROW</span>(<span class="hljs-number">42.42</span>, <span class="hljs-string">''</span>))\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]<font></font>
amount | 5.51<font></font>
code   | <font></font>
amount | 5.51</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los nombres localizados en to_date () y to_timestamp ()</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Funciones</font></font><code>to_date</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tambi√©n</font></font><code>to_timestamp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aprendieron a entender los nombres traducidos de los meses y d√≠as de la semana. </font><font style="vertical-align: inherit;">Anteriormente, solo se pod√≠an usar nombres en ingl√©s:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> to_date(<span class="hljs-string">', 24  2020'</span>, <span class="hljs-string">'TMDay, DD TMMonth YYYY'</span>);</code></pre><br>
<pre><code class="plaintext hljs">  to_date   <font></font>
------------<font></font>
 2020-03-24</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normalizar y EST√Å NORMALIZADO</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para cumplir con el est√°ndar SQL, la funci√≥n normalizar () se ha agregado para normalizar la cadena Unicode y el predicado IS NORMALIZADO para verificar si la cadena est√° normalizada.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> str, normalize(str, NFC) <span class="hljs-keyword">AS</span> nfc,<font></font>
       str <span class="hljs-keyword">IS</span> NFC NORMALIZED <span class="hljs-keyword">AS</span> is_nfc_normalized,<font></font>
       normalize(str, NFKC) <span class="hljs-keyword">AS</span> nfkc,<font></font>
       str <span class="hljs-keyword">IS</span> NFKC NORMALIZED <span class="hljs-keyword">AS</span> is_nfkc_normalized
<span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">U&amp;'\0032\2075'</span>)) <span class="hljs-keyword">AS</span> vals(str)\gx</code></pre><br>
<pre><code class="plaintext hljs">-[ RECORD 1 ]------+---<font></font>
str                | 2‚Åµ<font></font>
nfc                | 2‚Åµ<font></font>
is_nfc_normalized  | t<font></font>
nfkc               | 25<font></font>
is_nfkc_normalized | f</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lea m√°s</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre los formularios de normalizaci√≥n de UNICODE. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo Xid8 y funci√≥n xid8_current () para n√∫meros de transacci√≥n de 64 bits Se</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
agreg√≥ un nuevo tipo de datos xid8 para el n√∫mero de transacci√≥n de 64 bits. Pero no, esto no significa que PostgreSQL cambi√≥ a transacciones de 64 bits: todo funciona exactamente como antes. Sin embargo, algunas funciones devuelven un nuevo tipo, por ejemplo, ahora se recomienda para su uso en lugar de las antiguas funciones pg_current_xact_id txid_current, que volvi√≥ INT8, y as√≠ sucesivamente. N. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuevos tipos de datos polim√≥rficos familia anycompatible</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
tipos a√±adi√≥ </font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblearray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblenonarray</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>anycompatiblerange</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A diferencia de los tipos familiares </font></font><code>anyelement</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, los nuevos tipos le permiten usar no exactamente lo mismo, sino tipos realmente compatibles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el siguiente ejemplo, la funci√≥n</font></font><code>maximum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">como argumentos definidos como </font></font><code>anycompatible</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se pasan </font></font><code>integer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>numeric</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">El valor de retorno se convierte en un valor com√∫n para estos dos tipos:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> maximum(a anycompatible, b anycompatible) <span class="hljs-keyword">RETURNS</span> anycompatible
	<span class="hljs-keyword">AS</span> <span class="hljs-string">'SELECT CASE WHEN a &gt; b THEN a ELSE b END'</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">SQL</span>;<font></font>
<font></font>
<span class="hljs-keyword">SELECT</span> f, pg_typeof(f) <span class="hljs-keyword">FROM</span> maximum(<span class="hljs-number">42</span>, <span class="hljs-number">42.42</span>) f;</code></pre><br>
<pre><code class="plaintext hljs">   f   | pg_typeof<font></font>
-------+-----------<font></font>
 42.42 | numeric</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, los tipos anycompatible- y any- son dos conjuntos independientes de tipos:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> first_elems(a <span class="hljs-type">anyarray</span>, b anycompatiblearray)
    <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">TABLE</span>(a <span class="hljs-type">anyelement</span>, b anycompatible) <span class="hljs-keyword">AS</span> $$<span class="pgsql">
        <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">ROW</span>(a[array_lower(a,<span class="hljs-number">1</span>)], b[array_lower(b,<span class="hljs-number">1</span>)]);
    $$</span> <span class="hljs-keyword">LANGUAGE</span> <span class="hljs-keyword">sql</span>;
<span class="hljs-keyword">SELECT</span> first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>], <span class="hljs-keyword">ARRAY</span>[<span class="hljs-string">'a'</span>,<span class="hljs-string">'b'</span>,<span class="hljs-string">'c'</span>]) <span class="hljs-keyword">AS</span> str, <font></font>
       first_elems(<span class="hljs-keyword">ARRAY</span>[<span class="hljs-number">1.1</span>,<span class="hljs-number">2.2</span>,<span class="hljs-number">3.3</span>],<span class="hljs-keyword">ARRAY</span>[<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>]) <span class="hljs-type">bool</span>;</code></pre><br>
<pre><code class="plaintext hljs">  str  |  bool   <font></font>
-------+---------<font></font>
 (1,a) | (1.1,t)</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lenguajes de procedimiento</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transformaci√≥n para tipo bool en PL / Perl</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Recientemente, TRANSFORMACI√ìN de Ivan Panchenko (Postgres Professional) -</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se comprometi√≥ bool_plperl</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Postgres pasa valores booleanos a</font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o</font><font style="vertical-align: inherit;">en PL / Perl como</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero para Perl que</font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NO un valor booleano</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falso</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero s√≥lo la letra f, es decir, </font><font style="vertical-align: inherit;">en un contexto l√≥gico,</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verdad</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Este problema se puede resolver de diferentes maneras (ver</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> correspondencia</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), pero crear TRANSFORM para bool, seg√∫n Tom Lane, es lo m√°s pr√°ctico. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejecuci√≥n r√°pida de expresiones simples en PL / pgSQL</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las expresiones simples (al menos que no contienen llamadas a la tabla y no requieren bloqueos) ser√°n m√°s r√°pidas. </font><font style="vertical-align: inherit;">Anteriormente, en estos casos, se dedicaba tiempo improductivo a contactar al programador en cada ciclo.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">OR REPLACE</span> <span class="hljs-keyword">FUNCTION</span> slow_pi() <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">double</span> <span class="hljs-type">precision</span> <span class="hljs-keyword">AS</span> $$<span class="pgsql">
    <span class="hljs-keyword">DECLARE</span>
        a <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        s <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">1</span>;
        r <span class="hljs-type">double</span> <span class="hljs-type">precision</span> := <span class="hljs-number">0</span>;
    <span class="hljs-keyword">BEGIN</span>
        <span class="hljs-keyword">FOR</span> i <span class="hljs-keyword">IN</span> <span class="hljs-number">1</span> .. <span class="hljs-number">10000000</span> <span class="hljs-keyword">LOOP</span>
            r := r + s/a; a := a + <span class="hljs-number">2</span>; s := -s;
        <span class="hljs-keyword">END</span> <span class="hljs-keyword">LOOP</span>;
        <span class="hljs-keyword">RETURN</span> <span class="hljs-number">4</span>*r;
    <span class="hljs-keyword">END</span>;
    $$</span> <span class="hljs-keyword">LANGUAGE</span> plpgsql;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Llame slow_pi () en PG12:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535898497<font></font>
    (1 row)<font></font>
    Time: 13060,650 ms (00:13,061)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora en PG13:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> slow_pi();</code></pre><br>
<pre><code class="plaintext hljs">          slow_pi      <font></font>
    --------------------<font></font>
     3.1415925535897915<font></font>
    (1 row)<font></font>
    Time: 2108,464 ms (00:02,108)</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extensiones de confianza en lugar de pg_pltemplate</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El directorio del sistema ha disminuido en una tabla. </font><font style="vertical-align: inherit;">Borrado</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Almacenaba las propiedades de los lenguajes de procedimiento que se necesitan durante la ejecuci√≥n</font></font><code>CREATE LANGUAGE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ahora decidimos registrar las propiedades en los scripts de las extensiones de los idiomas correspondientes</font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y deshacernos de la tabla en s√≠. </font><font style="vertical-align: inherit;">Pero para implementar el plan, es necesario proporcionar la posibilidad para que el propietario de la base de datos (sin derechos de superusuario) cree un lenguaje confiable a partir del script de extensi√≥n. </font><font style="vertical-align: inherit;">De hecho, ahora para crear, por ejemplo, plpgsql, el propietario de la base de datos no tiene que ser superusuario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recibido de la siguiente manera. </font><font style="vertical-align: inherit;">Ha aparecido un nuevo par√°metro l√≥gico en el archivo de control para extensiones</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si ambos par√°metros</font></font><code>trusted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>superuser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incluida, entonces la extensi√≥n puede ser creada no solo por el superusuario, sino tambi√©n por el usuario con derecho </font></font><code>CREATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a la base de datos actual (y, por lo tanto, a su propietario). </font><font style="vertical-align: inherit;">Al ejecutar un script de dicha extensi√≥n, se utilizar√°n los derechos de superusuario que inicializaron el cl√∫ster. </font><font style="vertical-align: inherit;">Los objetos creados por la extensi√≥n le pertenecer√°n, aunque el propietario de la extensi√≥n en s√≠ ser√° el usuario creador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Consecuencias importantes de estos cambios:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las extensiones confiables abren el camino para que los desarrolladores externos creen otros idiomas confiables. </font><font style="vertical-align: inherit;">Ahora estamos limitados solo a plpgsql, plperl y pltcl.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fue </font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escrito que plpython se refiere a la segunda versi√≥n del lenguaje. </font><font style="vertical-align: inherit;">No </font></font><code>pg_pltemplate</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacerlo es un paso (necesario, aunque no suficiente) para la transici√≥n a Python 3.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√çndices</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compresi√≥n del √°rbol B</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un parche importante y muy esperado (el trabajo comenz√≥ ya en 2015) escrito por Anastasia Lubennikova (Postgres Professional) y Peter Geigan (Peter Geoghegan) finalmente se comunica por Peter. Nastya logr√≥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hablar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de esto</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"> en PGconf India</font></a><font style="vertical-align: inherit;"> . Postgres ha aprendido a reducir significativamente el tama√±o de los √≠ndices del √°rbol B a trav√©s de la deduplicaci√≥n, es decir, ahorros en claves de √≠ndice duplicadas. Estos √≠ndices se han redise√±ado seriamente para que la compresi√≥n sea posible sin p√©rdida de compatibilidad con versiones anteriores de √≠ndices. La idea de la deduplicaci√≥n se toma de una arquitectura m√°s flexible de √≠ndices como</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GIN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (√≠ndices inversos - √çndice invertido generalizado).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En estos √≠ndices con mayor frecuencia que en</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el √°rbol B</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, existe una situaci√≥n en la que una clave corresponde a una gran cantidad de registros. En el caso del procesamiento de textos, por ejemplo, el mismo token se encuentra generalmente en varios documentos. Y se almacena en el √≠ndice solo una vez. Hasta hace poco, los √≠ndices del √°rbol B no sab√≠an c√≥mo hacer esto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los √≠ndices del √°rbol B difieren de los √≠ndices GIN principalmente en las p√°ginas de hoja. Dependiendo del n√∫mero de registros relacionados con el mismo valor clave, las opciones son posibles: la p√°gina contiene solo una lista de publicaci√≥n: una lista de TID (identificadores de registros indexados), si la lista es peque√±a y si hay muchos TID, en lugar de una lista de valores se almacenan Nuevas "ramas de √°rbol": enlaces a otras p√°ginas como la lista de publicaciones u otras ramas de √°rbol (se llaman √°rbol de publicaci√≥n).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tal estructura de √°rbol es similar a un √°rbol B, pero difiere en detalles esenciales: por ejemplo, las listas para moverse a trav√©s de p√°ginas del mismo nivel de √°rbol en el GIN son unidireccionales, no bidireccionales. Por lo tanto (incluida) una buena compatibilidad de √≠ndices nuevos y deduplicados con versiones antiguas no es f√°cil de lograr. Y las mejoras realmente tomaron m√°s de 3 a√±os. Tambi√©n fue necesario resolver el mecanismo de limpieza (microvac√≠o) y otros matices. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las pruebas de rendimiento, todos los √≠ndices a los que se aplica la deduplicaci√≥n se han reducido aproximadamente 3 veces. La compresi√≥n de duplicados tambi√©n ayuda a √≠ndices √∫nicos, eliminando el problema de la hinchaz√≥n del √≠ndice a una alta tasa de cambios en la tabla. Se puede conectar y desconectar un nuevo comportamiento en el nivel de configuraci√≥n del √≠ndice. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El escaneo completo por √≠ndice GIN no se realiza donde no es necesario</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este parche permite en algunos casos evitar un pase completo a trav√©s de todo el √≠ndice GIN. </font><font style="vertical-align: inherit;">Algunas operaciones, aunque son compatibles con el √≠ndice GIN, se realizan mediante un an√°lisis completo del √≠ndice. </font><font style="vertical-align: inherit;">Tomemos, por ejemplo, el √≠ndice para la b√∫squeda de columna de texto completo </font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si la consulta de b√∫squeda tiene la forma "cualquier cosa menos una palabra dada", entonces todo el √≠ndice deber√° leerse en su totalidad. </font><font style="vertical-align: inherit;">Sin embargo, si hay otra condici√≥n presente en la solicitud que no requiere un escaneo completo del √≠ndice, entonces el √≠ndice a√∫n se escanear√° por completo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con la nueva optimizaci√≥n, se usar√° primero una condici√≥n m√°s precisa, que le permitir√° obtener una ganancia del √≠ndice, y luego los resultados se verificar√°n dos veces para tener en cuenta otra limitaci√≥n. </font><font style="vertical-align: inherit;">Compare el n√∫mero de p√°ginas que se leyeron en la versi√≥n 12 (Buffers):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5167<font></font>
   Buffers: shared hit=24 read=27405<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=24 read=22238<font></font>
 Planning Time: 0.283 ms<font></font>
 Execution Time: 3258.234 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
con el n√∫mero de buffers en la nueva versi√≥n:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> mail_messages <span class="hljs-keyword">WHERE</span> tsv @@ to_tsquery(<span class="hljs-string">'!vacuum'</span>) <span class="hljs-keyword">AND</span> tsv @@ to_tsquery(<span class="hljs-string">'analyze'</span>);</code></pre><br>
<pre><code class="plaintext hljs">                                             QUERY PLAN                                             <font></font>
---------------------------------------------------------------------------<font></font>
Bitmap Heap Scan on mail_messages (actual rows=5864 loops=1)<font></font>
   Recheck Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
   Heap Blocks: exact=5156<font></font>
   Buffers: shared hit=5179<font></font>
   -&gt;  Bitmap Index Scan on mail_messages_tsv_idx (actual rows=5864 loops=1)<font></font>
         Index Cond: ((tsv @@ to_tsquery('!vacuum'::text)) AND (tsv @@ to_tsquery('analyze'::text)))<font></font>
         Buffers: shared hit=23<font></font>
 Planning Time: 0.250 ms<font></font>
 Execution Time: 8.779 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se puede encontrar una situaci√≥n similar al usar trigramas y al verificar la aparici√≥n de matrices. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√°metros de las clases de operador</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En PostgreSQL, muchos m√©todos de acceso al √≠ndice son un "marco" que adopta una implementaci√≥n de alto nivel del algoritmo de b√∫squeda, trabajando con p√°ginas y bloqueos, y el registro WAL. Y el enlace a tipos de datos y operadores espec√≠ficos se realiza mediante clases de operador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta ahora, las clases de operador no pod√≠an tener par√°metros. Por ejemplo, para una b√∫squeda de texto completo, se puede usar un √≠ndice GiST con una clase de operadores </font></font><code>tsvector_ops</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(sobre las clases de operadores GiST </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Esta clase de operadores utiliza un √°rbol de firma, y ‚Äã‚Äãla longitud de la firma fue fija (124 bytes). Ahora puede especificar la longitud expl√≠citamente, lo que le permite controlar el equilibrio entre el tama√±o del √≠ndice y la eficiencia (el n√∫mero de colisiones hash):</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">ON</span> mail_messages <span class="hljs-keyword">USING</span> gist(tsv tsvector_ops(siglen=<span class="hljs-number">1024</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se realizaron cambios similares para los iniciadores para otras clases de operadores GiST que usan un √°rbol de firma, que se aplica a las extensiones hstore, intarray, ltree y pg_trgm. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero la idea principal para la que se concibi√≥ este cambio es la capacidad de pasar la expresi√≥n JSONPath al √≠ndice GIN para que no se indexe todo el documento JSON, sino solo la parte necesaria. En muchos casos, esto reducir√° radicalmente el tama√±o de los √≠ndices. Pero este trabajo queda por hacer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea de Oleg Bartunov, la implementaci√≥n de Nikita Glukhov y Alexander Korotkov (los tres profesionales de Postgres). </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
agreg√≥ el </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;">operador &lt;-&gt; (recuadro, punto)</font></b></a><font style="vertical-align: inherit;"> . La operaci√≥n faltante se agreg√≥ para usar en kNN para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GiST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SP-GiST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En PG12 cuando se trabaja con tipos geom√©tricos </font></font><code>point</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede usar el operador de distancia </font></font><code>&lt;-&gt;(point, box)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y acelerar√° la b√∫squeda con los √≠ndices GiST y SP-GiST. </font><font style="vertical-align: inherit;">Pero el operador sim√©trico para √©l </font></font><code>&lt;-&gt;(box, point)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no se implement√≥, aunque </font></font><code>box</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya entend√≠a las distancias a tipos m√°s complejos: pol√≠gonos y c√≠rculos.</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> points(<span class="hljs-type">point</span> <span class="hljs-type">point</span>);
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> boxes(<span class="hljs-type">box</span> <span class="hljs-type">box</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> points <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'1,2'</span>,<span class="hljs-string">'3,4'</span>);
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> boxes <span class="hljs-keyword">VALUES</span>(box(<span class="hljs-type">point</span>(<span class="hljs-number">3</span>,<span class="hljs-number">4</span>),<span class="hljs-type">point</span>(<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)), box(<span class="hljs-type">point</span>(<span class="hljs-number">13</span>,<span class="hljs-number">14</span>),<span class="hljs-type">point</span>(<span class="hljs-number">15</span>,<span class="hljs-number">16</span>)));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En PG12:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs">:    : box &lt;-&gt; point</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si viceversa, entonces todo est√° bien:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, p.point  &lt;-&gt; b.box distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en PG13:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> p.point, b.box, b.box  &lt;-&gt; p.point distance <span class="hljs-keyword">FROM</span> points <span class="hljs-keyword">AS</span> p, boxes <span class="hljs-keyword">AS</span> b <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> distance;</code></pre><br>
<pre><code class="plaintext hljs"> point |       box       |      distance<font></font>
-------+-----------------+--------------------<font></font>
 (1,2) | (5,6),(3,4)     | 2.8284271247461903<font></font>
 (2,1) | (5,6),(3,4)     | 3.1622776601683795<font></font>
 (1,2) | (15,16),(13,14) | 16.970562748477143<font></font>
 (2,1) | (15,16),(13,14) | 17.029386365926403</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los √≠ndices GiST y SP-GiST se acelerar√°n en esta operaci√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tenga en cuenta que en PG13, si pregunta:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> count(*) <span class="hljs-keyword">FROM</span> pg_operator <span class="hljs-keyword">WHERE</span> oprname = <span class="hljs-string">'&lt;-&gt;'</span>;</code></pre><pre><code class="plaintext hljs"> count <font></font>
-------<font></font>
    28</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
y si hacemos lo mismo en PG12, obtenemos 20 entradas: en la 13¬™ versi√≥n, la lista se repone con hasta 8 operadores.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Json</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soporte para el m√©todo .datetime () para jsonpath</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Este es uno de los parches fallidos de una gran serie de</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parches JSONPath que PG12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no tuvo tiempo de completar. Parte del est√°ndar JSON / SQL. El problema era que todas las funciones de la serie de parches JSONPath son inmutables, pero la comparaci√≥n de fechas tiene en cuenta la zona horaria actual, que puede cambiar durante la sesi√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tales casos, permitimos que las funciones inmutables existentes arrojen un error sobre comparaciones no inmutables. Al mismo tiempo, este parche tiene funciones con el sufijo _tz que funcionan de manera estable en operaciones con zona horaria.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nueva funci√≥n: funci√≥n jsonb_set_lax</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, lax es un modo de operaci√≥n no estricto (a diferencia de estricto) de las funciones con jsonb. En este caso, esta funci√≥n estar√° operativa en una situaci√≥n en la que uno de los argumentos que toma es NULL. A diferencia de la versi√≥n estricta, jsonb_set (), tiene un argumento adicional que indica acciones en el caso de NULL. Opciones: use_json_null / raise_exception / return_target / delete_key. Opciones sugeridas por los usuarios interesados. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimizado algunas funciones jsonb.</font></font></b></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Optimizado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mucho.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, principalmente a trav√©s de los esfuerzos de Nikita Glukhov (Postgres Professional). </font><font style="vertical-align: inherit;">Pero analizar cada punto en este caso no tiene sentido: en primer lugar, su abundancia inflar√° un art√≠culo ya corto; </font><font style="vertical-align: inherit;">y en segundo lugar, los cambios se relacionan con el dispositivo interno y no todos los usuarios est√°n interesados. </font><font style="vertical-align: inherit;">Por lo tanto, solo enumeraremos la mayor√≠a de ellos:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funci√≥n optimizada JsonbExtractScalar ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Operador optimizado # &gt;&gt;, funciones jsonb_each_text (), jsonb_array_elements_text ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El reconocimiento del tipo JsonbContainer en get_jsonb_path_all () est√° optimizado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtener el primer token del iterador JsonbIterator se reemplaza por la macro ligera JsonbContainerIsXxx ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extracci√≥n de claves m√°s conveniente: findJsonbKeyInObject ();</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Almacenamiento optimizado del resultado findJsonbValueFromContainer () y getIthJsonbValueFromContainer ();</font></font></li>
<li>  get_jsonb_path_all(),     ;<br>
  JsonbValueAsText.</li>
</ol><br>
<i> ,        SQL/JSON: JSON_TABLE  SQL/JSON: functions.       . ,   .      .     PG14.   JSONPath   .</i><br>
<br>
<h3>  </h3><br>
<h4>pgbench</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La utilidad para ejecutar pruebas de rendimiento recibi√≥ una serie de mejoras. </font><font style="vertical-align: inherit;">Hab√≠a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estad√≠sticas sobre la ejecuci√≥n de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tareas en la fase de inicializaci√≥n, una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conclusi√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√°s </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">visual</font></a><font style="vertical-align: inherit;"> , la capacidad de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ver el c√≥digo de los scripts incorporados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , las pruebas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en una tabla de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cuentas </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">particionada</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s, agregamos un comando </font></font><code>\aset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">similar a </font></font><code>\gset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero que permite establecer valores para variables de varias solicitudes enviadas a la vez. </font><font style="vertical-align: inherit;">La siguiente l√≠nea, enviada al servidor para su ejecuci√≥n, establece ambas variables </font></font><code>one</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>two</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> one \; <span class="hljs-keyword">SELECT</span> <span class="hljs-number">2</span> <span class="hljs-keyword">AS</span> two \aset</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_dump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_dump aprendi√≥ a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descargar datos de tablas de terceros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">A trav√©s del par√°metro, </font></font><code>--include-foreign-data</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede especificar una lista de servidores de terceros, cuyos datos de las tablas se descargar√°n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Use esta descarga con cuidado. </font><font style="vertical-align: inherit;">Lejos del hecho de que los datos deben cargarse en un servidor de terceros. </font><font style="vertical-align: inherit;">Adem√°s, es muy posible que un servidor de terceros no est√© disponible durante la recuperaci√≥n. </font><font style="vertical-align: inherit;">O un servidor de terceros solo puede permitir leer, pero no escribir datos.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psql</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una serie de peque√±os parches hace que psql sea m√°s c√≥modo:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mejora de la finalizaci√≥n de pesta√±as para varios equipos.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s de </font></font><code>\echo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enviar una cadena a STDOUT, un nuevo comando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>\warn</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">env√≠a una cadena a la salida de error est√°ndar (STDERR).</font></font></li>
<li> <code>\d</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> toast-</a>       .        <code>\d+</code>        .</li>
<li>  <code>\dt+</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  ¬´Persistence¬ª</a>      (unlogged)   (permanent).</li>
<li>  <code>\e</code>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a>,       <code>;</code> (  <code>\g*</code>). ,       psql      .</li>
<li>         .     <code>PROMPT1</code>  <code>PROMPT2</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> <code>%x</code>.</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los nuevos comandos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para obtener m√°s informaci√≥n sobre los m√©todos de acceso: </font></font><code>\dAc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>\dAf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>\dAo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>\dAp</code></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usted </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">puede</font></a></font><code>\g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ahora </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especificar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entre corchetes las opciones que son compatibles </font></font><code>\pset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Actuar√°n solo en el equipo actual.</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libpq</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cambios menores en conexi√≥n con PostgreSQL:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> corrigi√≥ la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">inexactitud</font></a><font style="vertical-align: inherit;"> en la descripci√≥n de los par√°metros host y hostadr y la inconsistencia resultante en la salida del </font></font><code>\conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando de utilidad psql.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la clave del certificado del cliente se almacena en forma cifrada, puede ingresar la contrase√±a solo en modo interactivo. </font><font style="vertical-align: inherit;">El nuevo par√°metro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslpassword le permite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> descifrar la clave de forma no interactiva.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dos nuevos par√°metros, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslminprotocolversion y sslmaxprotocolversion, le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permiten especificar una restricci√≥n en la versi√≥n del protocolo SSL / TCL con el que se permite la conexi√≥n.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reindexdb</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El nuevo par√°metro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--jobs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la </font><font style="vertical-align: inherit;">utilidad </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">reindexdb</font></a><font style="vertical-align: inherit;"> establece el n√∫mero de conexiones de bases de datos en las que los √≠ndices se reconstruir√°n al mismo tiempo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_rewind</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las limitaciones de la utilidad se eliminan gradualmente y las posibilidades aumentan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, pg_rewind </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ahora puede</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registrar informaci√≥n para la recuperaci√≥n (como pg_basebackup puede hacer esto), as√≠ como iniciar la recuperaci√≥n y el cierre posterior de una instancia si no se detuvo a trav√©s de un punto de control (esto ten√≠a que hacerse manualmente antes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y en segundo lugar, pg_rewind aprendi√≥ a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabajar con el archivo WAL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez que la utilidad encuentra el punto de divergencia WAL entre los dos servidores, debe crear una lista de todas las p√°ginas que deben copiarse en el cl√∫ster de destino para eliminar las diferencias. </font><font style="vertical-align: inherit;">Para esto, la utilidad requiere todos los archivos WAL, comenzando desde el punto encontrado. </font><font style="vertical-align: inherit;">Si los archivos WAL necesarios no est√°n disponibles en el cl√∫ster de destino, la utilidad no podr√≠a realizar su trabajo antes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con este parche de Alexey Kondratov (Postgres Professional), pg_rewind podr√° leer los segmentos WAL faltantes del archivo de los archivos de registro utilizando el par√°metro restore_command si se especifica un nuevo modificador -c o --restore-target-wal.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_waldump</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
pg_waldump </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descifrar√°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> el </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">registro de</font></a><font style="vertical-align: inherit;"> transacci√≥n preparado.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amcheck</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La extensi√≥n amcheck ha aprendido a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reconocer mejor el da√±o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en los √≠ndices del √°rbol B. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, ahora los mensajes en el registro del servidor sobre p√°ginas da√±adas ser√°n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diferentes para los √≠ndices y las tablas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inspeccion de pagina</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La </font></font><code>heap_tuple_infomask_flags</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funci√≥n de extensi√≥n pageinspect </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descifra los valores de los campos</font></font></a> <code>infomask</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y los </font></font><code>infomask2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devuelve la funci√≥n </font></font><code>heap_page_items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">√ötil en la investigaci√≥n de situaciones de corrupci√≥n de datos.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">postgres_fdw</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El superusuario en el nivel de asignaci√≥n de nombre de usuario puede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permitir a los usuarios normales</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilizar una conexi√≥n sin contrase√±a:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-keyword">MAPPING</span> <span class="hljs-keyword">FOR</span>  <span class="hljs-keyword">SERVER</span> 
    <span class="hljs-keyword">OPTIONS</span> (<span class="hljs-keyword">ADD</span> password_required <span class="hljs-string">'false'</span>);</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto se hace, entre otras cosas, para que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sslkey y sslcert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puedan usarse como par√°metros de conexi√≥n </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adminpack</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La extensi√≥n adminpack tiene una nueva caracter√≠stica - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>pg_file_sync</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Utiliz√°ndolo, puede hacer fsync para archivos escritos por el servidor en el disco, por ejemplo, a trav√©s de </font></font><code>pg_file_write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><code>COPY TO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supervisi√≥n</font></font></h3><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_slru</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la memoria compartida del servidor, no solo hay una gran memoria cach√© de b√∫fer, sino tambi√©n varias otras memorias cach√© m√°s simples (por ejemplo, para el estado de la transacci√≥n). </font><font style="vertical-align: inherit;">Utilizan un algoritmo simple para desplazar las p√°ginas que se usan con menos frecuencia (simples, menos utilizadas recientemente o SLRU). </font><font style="vertical-align: inherit;">Hasta ahora, tales cach√©s "simplemente funcionaban", pero era necesario monitorearlos, en primer lugar para que los desarrolladores del kernel de PostgreSQL descubrieran si es necesario cambiar algo en ellos. </font><font style="vertical-align: inherit;">Para este y prop√≥sito, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ha aparecido</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una nueva vista de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">pg_stat_slru</font></a><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_activity</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la vista, la </font></font><code>pg_stat_activity</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nueva columna</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para los procesos que participan en solicitudes paralelas, se rellena con el n√∫mero del proceso principal. </font><font style="vertical-align: inherit;">Y el proceso principal </font></font><code>leader_id</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es un n√∫mero de proceso </font></font><code>pid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La siguiente consulta muestra qu√© consultas y qu√© procesos se ejecutan actualmente en paralelo:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> query, leader_pid, <font></font>
    array_agg(pid) <span class="hljs-keyword">filter</span>(<span class="hljs-keyword">WHERE</span> leader_pid != pid) <span class="hljs-keyword">AS</span> members
  <span class="hljs-keyword">FROM</span> pg_stat_activity
 <span class="hljs-keyword">WHERE</span> leader_pid <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
 <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> query, leader_pid;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay cambios en la lista de eventos en espera. </font><font style="vertical-align: inherit;">Se agregaron </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dos nuevos eventos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><code>BackupWaitWalArchive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>RecoveryPause</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Y los otros dos recibieron nombres m√°s precisos: </font></font><code>RecoveryWalStream -&gt; RecoveryRetrieveRetryInterval</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>RecoveryWalAll -&gt; RecoveryWalStream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dos nuevos eventos de espera nuevos que ocurren en la r√©plica</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><code>RecoveryConflictSnapshot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(conflicto con VACUUM, que elimin√≥ la versi√≥n necesaria de las filas) y </font></font><code>RecoveryConflictTablespace</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(conflicto relacionado con la eliminaci√≥n del espacio de tablas).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta ahora, la extensi√≥n ha </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tratado las solicitudes con </font></font><code>FOR UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y sin una frase como la misma solicitud. Ahora las solicitudes con </font></font><code>FOR UPDATE</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se registran por separado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La cantidad de informaci√≥n recopilada ha aumentado. De ahora en adelante, no solo se registra informaci√≥n sobre recursos para ejecutar comandos, sino tambi√©n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estad√≠sticas sobre entradas de diario generadas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nuevas columnas de presentaci√≥n: </font></font><code>wal_bytes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- volumen de registros generados, </font></font><code>wal_records</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- n√∫mero de registros generados, </font></font><code>wal_num_fpw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- n√∫mero de im√°genes de p√°gina completa (escrituras de p√°gina completa). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto fue posible gracias a la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">infraestructura preparada</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para rastrear el uso de WAL. Por lo tanto, ahora </font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con una nueva opci√≥n </font></font><code>WAL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, mostrar√° el volumen de registros generados:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t (id <span class="hljs-type">int</span>);
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, WAL, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">SUMMARY</span> <span class="hljs-keyword">OFF</span>)
    <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>);</code></pre><br>
<pre><code class="plaintext hljs">              QUERY PLAN              <font></font>
--------------------------------------<font></font>
 Insert on t (actual rows=0 loops=1)<font></font>
   WAL:  records=1  bytes=59<font></font>
   -&gt;  Result (actual rows=1 loops=1)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Extension </font></font><code>auto_explain</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>VACUUM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font><code>VERBOSE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y </font></font><code>autovacuum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tambi√©n utilizan la infraestructura creada y generar√°n vol√∫menes de WAL. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Volviendo a </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si el nuevo par√°metro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pg_stat_statements.track_planning est√° habilitado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , se registrar√°n estad√≠sticas adicionales relacionadas con el planificador para cada operador: n√∫mero de compilaciones del plan; </font><font style="vertical-align: inherit;">tiempo total de planificaci√≥n; </font><font style="vertical-align: inherit;">tiempo m√≠nimo y m√°ximo de una planificaci√≥n, as√≠ como desviaci√≥n media y est√°ndar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La contabilidad de los recursos asignados al planificador se refleja en otro parche que no est√° relacionado </font></font><code>pg_stat_statements</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>EXPLAIN</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con la opci√≥n </font></font><code>BUFFERS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informar√° el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√∫mero de buffers utilizados en la etapa de planificaci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">ANALYZE</span>, <span class="hljs-keyword">BUFFERS</span>, <span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>, <span class="hljs-keyword">TIMING</span> <span class="hljs-keyword">OFF</span>) 
    <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> pg_class;</code></pre><br>
<pre><code class="plaintext hljs">                   QUERY PLAN                   <font></font>
------------------------------------------------<font></font>
 Seq Scan on pg_class (actual rows=386 loops=1)<font></font>
   Buffers: shared hit=9 read=4<font></font>
 Planning Time: 0.782 ms<font></font>
   Buffers: shared hit=103 read=11<font></font>
 Execution Time: 0.219 ms</code></pre><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revista</font></font></h4><br>
<ul>
<li> <code>log_statement_sample_rate</code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   SQL,   </a>,      <code>log_min_duration_sample</code>( ).<br>
,    <code>log_min_duration_statement</code>    , ..  <code>log_min_duration_statement</code> ,  <code>log_min_duration_sample</code>,       ,      <code>log_statement_sample_rate</code>.<br>
 ,   <code>log_transaction_sample_rate</code>    ,       ,      .</li>
<li>  ,   (   log_min_error_statement),         .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>log_parameter_max_length_on_error</code></a>.     0,   .<br>
 <code>log_parameter_max_length_on_error</code>          SQL,    ,      .<br>
    (     <code>log_statements</code>  <code>log_duration</code>)   ,  : <code>log_parameter_max_length</code>,     ,   .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora puede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escribir el tipo de proceso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>pg_stat_activity.backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) en el </font><font style="vertical-align: inherit;">registro del servidor </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para esto </font></font><code>log_line_prefix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se proporciona un s√≠mbolo especial </font><font style="vertical-align: inherit;">en el par√°metro </font></font><code>%b</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Y si el registro est√° escrito en formato csv ( </font></font><code>log_destination=csvlog</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), entonces la columna </font></font><code>backend_type</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ya </font><font style="vertical-align: inherit;">est√° </font><font style="vertical-align: inherit;">incluida all√≠.</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progreso</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las nuevas vistas </font></font><code>pg_stat_progress_analyze</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tambi√©n le </font></font><code>pg_stat_progress_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">permiten realizar un seguimiento del progreso de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la recopilaci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">estad√≠sticas</font></a><font style="vertical-align: inherit;"> por parte del equipo </font></font><code>ANALYZE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crear una copia de seguridad de la</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilidad, </font></font><code>pg_basebackup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">respectivamente.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mejoramiento</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√°lculo de funciones inmutables en la cl√°usula FROM en la etapa de planificaci√≥n</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El parche de Aleksandr Kuzmenkov y Aleksandr Parfyonov (ambos de Postgres Professional) ayuda en los casos en que la</font></font><code>FROM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">llamada contiene una llamada de funci√≥n que en realidad es una constante. </font><font style="vertical-align: inherit;">En este caso, en lugar de hacer la conexi√≥n, el valor constante se sustituye en los lugares necesarios de la solicitud. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As√≠ es como sucede esto con un ejemplo de una consulta relacionada con la b√∫squeda de texto completo:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                              <font></font>
------------------------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, '''tuple'''::tsquery)) DESC<font></font>
   -&gt;  Bitmap Heap Scan on mail_messages<font></font>
         Recheck Cond: (tsv @@ '''tuple'''::tsquery)<font></font>
         -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
               Index Cond: (tsv @@ '''tuple'''::tsquery)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hay conexi√≥n, y el valor 'tupla' :: tsquery se sustituye en la consulta ya en la etapa de planificaci√≥n. </font><font style="vertical-align: inherit;">La versi√≥n 12 ten√≠a una imagen completamente diferente:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">COSTS</span> <span class="hljs-keyword">OFF</span>)
<span class="hljs-keyword">SELECT</span> subject, ts_rank_cd(tsv, q) <span class="hljs-keyword">AS</span> rank                            
<span class="hljs-keyword">FROM</span> mail_messages, to_tsquery(<span class="hljs-string">'english'</span>, <span class="hljs-string">'tuple'</span>) q
<span class="hljs-keyword">WHERE</span> tsv @@ q                            
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> rank <span class="hljs-keyword">DESC</span>;</code></pre><br>
<pre><code class="plaintext hljs">                          QUERY PLAN                         <font></font>
-----------------------------------------------------<font></font>
 Sort<font></font>
   Sort Key: (ts_rank_cd(mail_messages.tsv, q.q)) DESC<font></font>
   -&gt;  Nested Loop<font></font>
         -&gt;  Function Scan on q<font></font>
         -&gt;  Bitmap Heap Scan on mail_messages<font></font>
               Recheck Cond: (tsv @@ q.q)<font></font>
               -&gt;  Bitmap Index Scan on mail_messages_tsv_idx<font></font>
                     Index Cond: (tsv @@ q.q)</code></pre><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clasificaci√≥n incremental</font></font></a></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cuando se necesita ordenar por muchas claves (k1, k2, k3 ...), el planificador ahora puede aprovechar el conocimiento de que los datos ya est√°n ordenados por varias de las primeras claves (por ejemplo, k1 y k2). En este caso, no puede volver a ordenar todos los datos nuevamente, sino dividirlos en grupos consecutivos con los mismos valores k1 y k2, y "ordenar" por la clave k3.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, toda la clasificaci√≥n se divide en varios tipos consecutivos de menor tama√±o. Esto reduce la cantidad de memoria necesaria y tambi√©n le permite entregar los primeros datos antes de que se complete toda la clasificaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, en la base de datos de demostraci√≥n en la tabla de tickets hay un √≠ndice en la columna ticket_id. </font><font style="vertical-align: inherit;">Los datos recibidos del √≠ndice se ordenar√°n por ticket_id, por lo que la siguiente consulta utilizar√° una ordenaci√≥n incremental:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                                  QUERY PLAN                                  <font></font>
------------------------------------------------------------------------------<font></font>
 Incremental Sort (actual rows=2949857 loops=1)<font></font>
   Sort Key: ticket_no, passenger_id<font></font>
   Presorted Key: ticket_no<font></font>
   Full-sort Groups: 92184 Sort Method: quicksort Memory: avg=31kB peak=31kB<font></font>
   -&gt;  Index Scan using tickets_pkey on tickets (actual rows=2949857 loops=1)<font></font>
 Planning Time: 2.137 ms<font></font>
 Execution Time: 2230.019 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La funcionalidad de ordenaci√≥n incremental se puede deshabilitar con el par√°metro enable_incrementalsort. </font><font style="vertical-align: inherit;">En este caso, la clasificaci√≥n llevar√° mucho m√°s tiempo:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SET</span> enable_incrementalsort = <span class="hljs-keyword">off</span>;
<span class="hljs-keyword">EXPLAIN</span> (<span class="hljs-keyword">analyze</span>, <span class="hljs-keyword">costs</span> <span class="hljs-keyword">off</span>, <span class="hljs-keyword">timing</span> <span class="hljs-keyword">off</span>)
<span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> tickets <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ticket_no, passenger_id;</code></pre><br>
<pre><code class="plaintext hljs">                              QUERY PLAN                               <font></font>
-----------------------------------------------------------------------<font></font>
 Gather Merge (actual rows=2949857 loops=1)<font></font>
   Workers Planned: 2<font></font>
   Workers Launched: 2<font></font>
   -&gt;  Sort (actual rows=983286 loops=3)<font></font>
         Sort Key: ticket_no, passenger_id<font></font>
         Sort Method: external merge  Disk: 107024kB<font></font>
         Worker 0:  Sort Method: external merge  Disk: 116744kB<font></font>
         Worker 1:  Sort Method: external merge  Disk: 107200kB<font></font>
         -&gt;  Parallel Seq Scan on tickets (actual rows=983286 loops=3)<font></font>
 Planning Time: 3.994 ms<font></font>
 Execution Time: 12291.844 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea de la clasificaci√≥n incremental fue propuesta en 2013 por Alexander Korotkov (Postgres Professional), y ahora, siete a√±os despu√©s, James Coleman llev√≥ el parche a un estado aceptado por la comunidad. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aceleraci√≥n TRUNCATE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cuando se realiza el </font></font><code>TRUNCATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escaneo </font></font><code>shared_buffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para eliminar los b√∫feres de tabla de la memoria compartida. Anteriormente, el escaneo se realizaba tres veces, para cada capa de tabla: PRINCIPAL (capa de datos principal), FSM (mapa de espacio libre), VM (mapa de visibilidad). Ahora la l√≥gica ha cambiado, en lugar de la operaci√≥n triple, los buffers se escanean solo una vez. Con valores grandes, </font></font><code>shared_buffers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esto proporciona una ganancia tangible. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tostada de descompresi√≥n parcial</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando no hay necesidad de leer completamente TOAST, limit√°ndolo a una rebanada al principio o cerca del principio, entonces no tiene sentido desabrocharlo por completo. </font><font style="vertical-align: inherit;">TOAST comprimido se lee en iteraciones: lea una pieza, si no hay datos necesarios, luego ampl√≠ela y siga leyendo. </font><font style="vertical-align: inherit;">Sugerido por un estudiante de Google Summer of Code, Binguo Bao, que da un ejemplo:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> slicingtest (<font></font>
     id <span class="hljs-type">serial</span> <span class="hljs-keyword">PRIMARY KEY</span>,<font></font>
     a <span class="hljs-type">text</span><font></font>
);<font></font>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> slicingtest (a) <span class="hljs-keyword">SELECT</span>
    repeat(<span class="hljs-string">'1234567890-=abcdefghijklmnopqrstuvwxyz'</span>, <span class="hljs-number">1000000</span>) <span class="hljs-keyword">AS</span> a <span class="hljs-keyword">FROM</span>
    generate_series(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);<font></font>
\<span class="hljs-keyword">timing</span>
<span class="hljs-keyword">SELECT</span> sum(length(substr(a, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>))) <span class="hljs-keyword">FROM</span> slicingtest;</code></pre><br>
<pre><code class="plaintext hljs">Time: 28.123 ms</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con el parche, un orden de magnitud m√°s r√°pido:</font></font><br>
<br>
<pre><code class="plaintext hljs">Time: 2.306 ms</code></pre><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VAC√çO Paralelo</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En su</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> art√≠culo sobre este tema,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Yegor Rogov explica en detalle este importante paso en la paralelizaci√≥n. En resumen: "Parche Masahiko Sawada, que le permite realizar la limpieza en paralelo. La tabla misma todav√≠a se borra mediante un proceso (principal), pero para limpiar √≠ndices, ahora puede iniciar flujos de trabajo en segundo plano, uno para cada √≠ndice. En modo manual, esto le permite acelerar la limpieza de tablas grandes con m√∫ltiples √≠ndices; la limpieza autom√°tica a√∫n no utiliza esta funci√≥n ".</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Limpieza autom√°tica cuando se pega en una mesa</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para este parche (tambi√©n conocido como aspiradora autom√°tica Berserk), debemos agradecer a Dorofei Proleskovsky, quien propuso una soluci√≥n al siguiente problema: la limpieza autom√°tica no llega a la tabla de solo agregar, porque no tienen versiones "muertas" de las filas. Debido a esto, el mapa de visibilidad no se actualiza, lo que hace que solo los escaneos de √≠ndice sean ineficaces, y cuando la limpieza llega a evitar desbordamientos del contador de transacciones, debe hacer mucho trabajo a la vez. Ahora esta situaci√≥n se ha solucionado: la limpieza autom√°tica tambi√©n funcionar√° para agregar l√≠neas. </font><font style="vertical-align: inherit;">Aparecieron </font><font style="vertical-align: inherit;">dos nuevos par√°metros del servidor ( </font></font><code>autovacuum_vacuum_insert_threshold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>autovacuum_vacuum_insert_scale_factor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), similares a los de las modificaciones ( </font></font><code>autovacuum_vacuum_threshold</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>autovacuum_vacuum_scale_factor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gesti√≥n de memoria agregada de hash</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La agregaci√≥n de hash puede requerir m√°s RAM de la que pensaba el planificador y de lo indicado en </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Anteriormente, dicho error del planificador conduc√≠a al hecho de que el tama√±o se </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ignoraba y la memoria se asignaba tanto como fuera necesario para la operaci√≥n o la llegada de OOM Killer. Ahora el algoritmo puede no ir m√°s all√° </font></font><code>work_mem</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y, si es necesario, usar archivos temporales en el disco. Para controlar el comportamiento del planificador, aparecieron los siguientes par√°metros: </font></font><code>enable_groupingsets_hash_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>enable_hashagg_disk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimizaci√≥n de ACTUALIZACI√ìN para tablas con columnas generadas</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n 12, las columnas generadas se recalculaban durante cualquier actualizaci√≥n de fila, incluso si este cambio no las afectaba de ninguna manera. Ahora ser√°n recalculados solo cuando sea realmente necesario (si sus columnas base han cambiado). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esta optimizaci√≥n, por ejemplo, puede acelerar significativamente la actualizaci√≥n de tablas con una columna de tipo generado </font></font><code>tsvector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que la funci√≥n es </font></font><code>to_tsvector()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bastante costosa. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acceso desde el disparador a la lista de columnas modificadas</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Un peque√±o parche que agrega un </font></font><code>TriggerData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mapa de bits de columnas modificadas </font><font style="vertical-align: inherit;">a la estructura </font><font style="vertical-align: inherit;">. Esta informaci√≥n puede ser utilizada por funciones de activaci√≥n generales, como </font></font><code>tsvector_update_trigger()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><code>lo_manage()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, para no realizar un trabajo innecesario. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uso de varias estad√≠sticas avanzadas al evaluar</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En PG12, el planificador no pudo utilizar varias estad√≠sticas avanzadas para la misma tabla al mismo tiempo. Por ejemplo, imagine una situaci√≥n en la que se construyen dos estad√≠sticas avanzadas para diferentes conjuntos de columnas, y las columnas de un conjunto y de otro participan en la consulta. Ahora el planificador tiene acceso a toda la informaci√≥n disponible. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infraestructura para paralelizaci√≥n y COPIA</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (consulte tambi√©n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este parche</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">.</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La concurrencia de PostgreSQL todav√≠a funciona para consultas de solo lectura. </font><font style="vertical-align: inherit;">Hay dificultades con los escritores, y uno de ellos es el bloqueo de procesos que realizan simult√°neamente una tarea (incluida en un grupo paralelo com√∫n). </font><font style="vertical-align: inherit;">Se cree que los bloqueos de tales procesos no entran en conflicto; por ejemplo, varios procesos pueden mantener un bloqueo exclusivo en la misma tabla. </font><font style="vertical-align: inherit;">Esto requiere un cuidado especial por parte de los desarrolladores del kernel, pero de lo contrario tendr√≠an puntos muertos constantemente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hay dos excepciones:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueo de extensi√≥n de relaci√≥n, que se captura cuando se agregan nuevas p√°ginas al final del archivo de datos, y</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bloqueo de p√°gina, que se utiliza al mover elementos de √≠ndice GIN de la lista de espera al √°rbol principal.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(Puede leer m√°s </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en este art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">.</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Tales bloqueos deber√≠an entrar en conflicto incluso entre procesos del mismo grupo paralelo, que implementa este parche. </font><font style="vertical-align: inherit;">Pero estos bloqueos nunca pueden conducir a puntos muertos, por lo que se excluyen del an√°lisis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para el usuario, en general, nada cambia, pero este parche es importante porque, en primer lugar, allana el camino para INSERTAR y COPIAR en paralelo, y en segundo lugar, elimina uno de los cuellos de botella de PostgreSQL en condiciones de alta carga (que se puede escuchar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el informe HL ++</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seguridad</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
primos</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"> SKH PRH reemplazaron a los</font></b></a><font style="vertical-align: inherit;"> primos EDH</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"> reemplazados</font></b></a><font style="vertical-align: inherit;"> (claves ef√≠meras Diffie-Hellman) utilizando el protocolo SKIP ahora desaparecido.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> initdb: la configuraci√≥n predeterminada para la autenticaci√≥n</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ha cambiado La configuraci√≥n de acceso predeterminada para las conexiones locales y de red ha cambiado cuando se inicia initdb. Ahora</font><font style="vertical-align: inherit;">ser√°</font></font><code>pg_hba.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para conexiones locales en lugar del m√©todo de autenticaci√≥n</font><font style="vertical-align: inherit;">(o md5 si no es compatible con el igual), y</font><font style="vertical-align: inherit;">para conexiones de red. Inicialmente, se discutieron medidas m√°s liberales: advertencia en la documentaci√≥n. Entonces m√°s dura:</font><font style="vertical-align: inherit;">. Como resultado, decidimos limitarnos a</font><font style="vertical-align: inherit;">y</font><font style="vertical-align: inherit;">.</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"> Usando explicit_bzero</font></b></a></font><code>trust</code><font style="vertical-align: inherit;"></font><code>peer</code><font style="vertical-align: inherit;"></font><code>md5</code><font style="vertical-align: inherit;"></font><code>scram-sha-256</code><font style="vertical-align: inherit;"></font><code>peer</code><font style="vertical-align: inherit;"></font><code>md5</code><font style="vertical-align: inherit;"></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parche importante Las funciones del sistema operativo bzero () y explicit_bzero () escriben bytes que contienen en las √°reas de memoria indicadas </font></font><code>'\0'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(ver, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por ejemplo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Linux). Estos parches son solo el comienzo: hay muchas secciones de memoria en las que pueden permanecer las contrase√±as y otra informaci√≥n confidencial. Decidimos comenzar desde lugares como libpq, en el que todo el archivo con contrase√±as puede permanecer en la memoria despu√©s de leer .pgpass, y desde la limpieza despu√©s de cerrar la conexi√≥n. En be-secure-common.c ahora hay una sobrescritura de la frase secreta ingresada en SSL, que aparece en la l√≠nea (ruta) del error. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se agreg√≥ el par√°metro "password_protocol" a libpq</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este parche permite a libpq controlar qu√© protocolo de transferencia de contrase√±a se usa durante la conexi√≥n. Despu√©s de recibir este par√°metro, libpq rechazar√° la autenticaci√≥n si el protocolo es m√°s d√©bil que el especificado. Por defecto, este par√°metro </font></font><code>plaintext</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, es decir, todos los protocolos son adecuados. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acceso obligatorio para TRUNCATE</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Este parche permite que las extensiones incorporen el Control de acceso obligatorio (MAC) para una operaci√≥n TRUNCATE. Los derechos sobre √©l ahora ser√°n verificados por la extensi√≥n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sepgsql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La pol√≠tica de referencia de SELinux</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y las distribuciones de Linux basadas en Redhat no admiten la comprobaci√≥n de SELinux en db_table {truncate}. En este caso, sepgsql se usar√° con 'deny_unknown' igual a 1, y TRUNCATE fallar√°. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disponibilidad de GUC ssl_passphrase_command</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un parche simple pero √∫til. </font><font style="vertical-align: inherit;">Ahora el valor del par√°metro ssl_passphrase_command solo lo ver√° el superusuario. </font><font style="vertical-align: inherit;">El par√°metro especifica un comando externo que se llama cuando se requiere una contrase√±a para descifrar un archivo SSL, por ejemplo, una clave privada.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Localizaci√≥n</font></font></h3><br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versiones de reglas de clasificaci√≥n de libc</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Para las</font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"> reglas de clasificaci√≥n de</font></a></b><font style="vertical-align: inherit;"> ICU, los n√∫meros de versi√≥n se almacenan en la base de datos. Cada vez que se usa la regla (clasificaci√≥n, comparaci√≥n de caracteres), el n√∫mero de versi√≥n guardado se verifica con la versi√≥n actual en la biblioteca de la UCI en el sistema operativo, y en caso de discrepancias, se emite una advertencia. Esto le permite descubrir que ciertos √≠ndices creados de acuerdo con las reglas de clasificaci√≥n modificadas pueden ser incorrectos y deber√≠an reconstruirse. Al reconstruir los √≠ndices con el comando</font></font><code>ALTER COLLATION ... REFRESH VERSION</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, se actualiza la versi√≥n de la regla de clasificaci√≥n en la base de datos y ya no se emiten advertencias.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero eso fue solo para la UCI. Ahora el n√∫mero de versi√≥n tambi√©n se almacena para las reglas de clasificaci√≥n de libc:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">SELECT</span> collname, collversion <span class="hljs-keyword">FROM</span> pg_collation <span class="hljs-keyword">WHERE</span> collname = <span class="hljs-string">'ru_RU'</span>;</code></pre><br>
<pre><code class="plaintext hljs"> collname | collversion<font></font>
----------+-------------<font></font>
 ru_RU    | 2.27</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo que hace posible emitir advertencias cuando una biblioteca cambia en el sistema operativo. </font><font style="vertical-align: inherit;">Muy relevante a la luz de la transici√≥n a glibc 2.28, donde muchas reglas de clasificaci√≥n han cambiado, y los √≠ndices correspondientes deber√≠an reconstruirse. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero hasta que cambiaron a 2.28, todo est√° tranquilo:</font></font><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">COLLATION</span> "ru_RU" <span class="hljs-keyword">REFRESH</span> <span class="hljs-keyword">VERSION</span>;</code></pre><br>
<pre><code class="plaintext hljs">NOTICE:  version has not changed<font></font>
ALTER COLLATION</code></pre><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B√∫squeda de texto completo</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B√∫squeda de texto completo para el idioma griego</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
No hay comentarios. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dict_int aprendi√≥ a manejar valores absolutos.</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
El diccionario de plantillas dict_int (tambi√©n conocido como extensi√≥n) agreg√≥ la capacidad de eliminar el signo de un n√∫mero.</font></font><br>
<br>
<pre><code class="pgsql hljs">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTENSION</span> dict_int;
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {-123}<font></font>
(1 row)</code></pre><br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TEXT SEARCH</span> <span class="hljs-keyword">DICTIONARY</span> intdict (ABSVAL = <span class="hljs-keyword">true</span>);
<span class="hljs-keyword">SELECT</span> ts_lexize(<span class="hljs-string">'intdict'</span>, <span class="hljs-string">'-123'</span>);</code></pre><br>
<pre><code class="plaintext hljs">ts_lexize<font></font>
-----------<font></font>
 {123}<font></font>
(1 row)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es decir, esta vez se reconoci√≥ el valor absoluto.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fraccionamiento</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANTES de los</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
disparadores de fila</font></font><code>BEFORE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en una tabla particionada</font><font style="vertical-align: inherit;">En la versi√≥n 12, no puede crear disparadores de fila</font><font style="vertical-align: inherit;">en una tabla particionada. En secciones separadas, por favor, pero no en toda la tabla a la vez. Ahora, un</font></font><code>BEFORE FOR EACH ROW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activador creado en una tabla particionada se heredar√° autom√°ticamente y funcionar√° para todas las secciones. Pero con la condici√≥n de que si se activa</font></font><code>UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, la clave de partici√≥n solo se puede cambiar dentro de la secci√≥n actual.</font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Soporte para tablas particionadas en replicaci√≥n l√≥gica</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Anteriormente, incluir una tabla particionada en una publicaci√≥n causaba un error:</font></font><br>
<br>
<pre><code class="pgsql hljs"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PUBLICATION</span> pub <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">TABLE</span> p;</code></pre><br>
<pre><code class="plaintext hljs">ERROR:  "p" is a partitioned table<font></font>
DETAIL:  Adding partitioned tables to publications is not supported.<font></font>
HINT:  You can add the table partitions individually.</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora funciona. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritmo</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
de uni√≥n </font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">seccional mejorado</font></a></b><font style="vertical-align: inherit;"> A partir de la versi√≥n 11, el planificador puede unir tablas particionadas secci√≥n por secci√≥n, pero solo si los l√≠mites de las secciones coinciden exactamente. </font><font style="vertical-align: inherit;">Ahora el algoritmo se ha mejorado: funcionar√° si la secci√≥n de una tabla est√° completamente incluida en la secci√≥n de otra, incluso si sus tama√±os no coinciden (por ejemplo, si una tabla se divide por d√≠a y la otra por mes). </font><font style="vertical-align: inherit;">El nuevo algoritmo funciona para particionar por rangos y por listas. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UNI√ìN SECUNDARIA COMPLETA SECCIONAL La uni√≥n seccionalizada</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ahora funciona para combinaciones externas completas grabadas con una frase </font></font><code>USING</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableam</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta √°rea atractiva y prometedora, pero dif√≠cil, no hay avances radicales con respecto a PostgreSQL 12. No hay almacenamientos de plug-in listos como </font></font><code>zheap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otros que no sean el mont√≥n), pero el trabajo contin√∫a en la API. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un mayor nivel de abstracci√≥n para determinar el tama√±o de una tabla</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Robert Haas reescribi√≥ el c√≥digo, cambiando su arquitectura a favor de las capas abstractas, de modo que no habr√≠a necesidad de duplicar el c√≥digo en el futuro. Esta pieza se refiere al </font></font><code>estimate_rel_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tama√±o de las capas (horquillas) de la mesa. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede usar m√©todos de acceso a tablas con relcache.</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Este parche trae las capacidades de administraci√≥n de memoria de los m√©todos de acceso a tablas a las capacidades de los m√©todos de √≠ndice. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tableam y TOAST</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
TOAST est√°n dise√±ados en gran medida para el almacenamiento</font></font><code>heap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, al crear nuevos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√©todos de acceso a la tabla,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede ir de dos maneras: ayudar a los desarrolladores de nuevos m√©todos a integrar insertar, actualizar y eliminar registros de TOAST en ellos o delegar el trabajo con TOAST para codificar utilizando el almacenamiento tradicional de PostgreSQL: almacenamiento din√°mico. </font><font style="vertical-align: inherit;">Una serie de 5 parches utiliza ranuras de tupla para implementar operaciones de inserci√≥n / actualizaci√≥n / eliminaci√≥n y puede ayudar a los que van en ambos sentidos.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fsync</font></font></h4><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manejo de errores de fsync en pg_receivewal y pg_recvlogical</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
La lucha contra</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fsync ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contin√∫a. PostgreSQL cree que una llamada fsync () exitosa significa que todos los datos del archivo se han vaciado al disco, pero esto no siempre ocurre (depende del sistema operativo) y puede provocar la p√©rdida de datos. PG13 decidi√≥ que era necesario tratar con los servicios p√∫blicos</font></font><code>pg_receivewal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>pg_recvlogical</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Actualmente, el comportamiento predeterminado es el siguiente: estas utilidades escribir√°n errores fsync en los registros, restaurar√°n la conexi√≥n y continuar√°n como si nada hubiera pasado. Como resultado, el WAL contiene informaci√≥n sobre los archivos que se copiaron correctamente y que, de hecho, no se volcaron correctamente en el disco. Por lo tanto, es mejor interrumpir la utilidad. Tambi√©n se discuti√≥ el destino de pg_dump, pg_basebackup, pg_rewind y pg_checksums, pero hasta ahora se han limitado a estos dos.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protecci√≥n contra la configuraci√≥n de indicadores incorrectos para fsync ()</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Este parche verifica si los indicadores est√°n configurados correctamente al recibir el descriptor de archivo para fsync (): los directorios est√°n abiertos solo para lectura y los archivos para escritura o ambos.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copia de seguridad y replicaci√≥n</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pausa durante la recuperaci√≥n antes de llegar al punto de recuperaci√≥n</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si durante la recuperaci√≥n los WAL han finalizado, pero</font></font><code>recovery_target_time</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no han alcanzado el</font><font style="vertical-align: inherit;">especificado</font><font style="vertical-align: inherit;">, el servidor completa la recuperaci√≥n y cambia al modo de funcionamiento normal. Ahora ya no ser√° as√≠. El proceso de recuperaci√≥n se pausar√°, como se informa en el registro, y el administrador tendr√° la oportunidad de insertar los segmentos WAL que faltan y continuar la recuperaci√≥n.</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El par√°metro ignore_invalid_pages</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Cuando el proceso de recuperaci√≥n en una r√©plica encuentra un enlace a una p√°gina no v√°lida en el registro WAL,</font></font><code>panic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-a</font><font style="vertical-align: inherit;">sucede</font><font style="vertical-align: inherit;">. La inclusi√≥n del par√°metro ayudar√° a superarlo.</font></font><code>ignore_invalid_pages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. La recuperaci√≥n continuar√° con la posible p√©rdida de integridad, datos y otras consecuencias m√°s graves. El par√°metro est√° destinado a los desarrolladores de servidores y debe usarse en aquellos casos en los que a√∫n deba intentar completar la recuperaci√≥n e iniciar la r√©plica. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cambiando primary_conninfo sin necesidad de reiniciar</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
el parche de Sergey Kornilov, que le permite cambiar la configuraci√≥n </font></font><code>primary_conninfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>primary_slot_name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>wal_receiver_create_temp_slot</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sin necesidad de reiniciar el servidor. En realidad, por el bien de esto, abandonaron el archivo </font></font><code>recovery.conf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la versi√≥n 12. </font><font style="vertical-align: inherit;">
Los manifiestos de </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">copia de seguridad</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pg_basebackup ahora crean un "manifiesto": un archivo JSON que contiene informaci√≥n sobre la copia de seguridad realizada (nombres y tama√±os de archivo, archivos WAL necesarios, as√≠ como sumas de comprobaci√≥n para todo y todo).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La nueva utilidad pg_validatebackup verifica que las copias de seguridad cumplan con el manifiesto, y tambi√©n verifica la disponibilidad y correcci√≥n de los archivos WAL necesarios para la recuperaci√≥n utilizando la utilidad pg_waldump (esto se aplica solo a los archivos WAL dentro de la copia de seguridad en s√≠, y no en el archivo). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esto le permitir√° detectar situaciones en las que los archivos de copia de seguridad se da√±aron o desaparecieron, o cuando la recuperaci√≥n se hizo imposible debido a la falta de los archivos de registro necesarios. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitaci√≥n de datos no le√≠dos por la ranura de replicaci√≥n La ranura de replicaci√≥n</font></font></b></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
es un mecanismo conveniente pero peligroso: si el cliente no lee los datos de la ranura a tiempo, los registros WAL no le√≠dos pueden ocupar todo el espacio en el servidor. Ahora usando el par√°metro</font></font><code>max_slot_wal_keep_size</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede establecer un l√≠mite en la cantidad m√°xima de espacio en disco que pueden ocupar los datos no le√≠dos. </font><font style="vertical-align: inherit;">Si en el siguiente punto de control resulta que se excede el tama√±o, se deshabilita la ranura y se libera el lugar.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ventanas</font></font></h3><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compatibilidad con sockets Unix en Windows Los</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
sockets de dominio </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Unix</font></a><font style="vertical-align: inherit;"> son compatibles con Windows 10, aunque est√°n deshabilitados de forma predeterminada.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documentaci√≥n</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay dos nuevas aplicaciones en la documentaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de una larga </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">discusi√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apareci√≥ el Ap√©ndice M. Glosario</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Actualmente hay 101 t√©rminos en el glosario. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La capacidad de resaltar el color de los mensajes de diagn√≥stico de las utilidades de la consola utilizando una variable </font></font><code>PG_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">era anterior. </font><font style="vertical-align: inherit;">Esto ahora est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ap√©ndice N. Soporte de color</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La intenci√≥n original de Peter Eisentrout en este parche era activar la salida coloreada de forma predeterminada. </font><font style="vertical-align: inherit;">Y para aquellos que no quer√≠an esto, se propuso establecer expl√≠citamente la variable</font></font><code>NO_COLOR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pero hubo m√°s opositores a la diferenciaci√≥n de color de los mensajes entre los que discutieron el parche. </font><font style="vertical-align: inherit;">Por lo tanto, decidieron solo documentar las oportunidades disponibles. </font><font style="vertical-align: inherit;">Y tenemos una nueva secci√≥n del primer nivel en la documentaci√≥n.</font></font><br>
<br>
<hr><br>
<i>        PG13,  ,  PG14     . ,   . .</i></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es493094/index.html">Los trabajadores del almac√©n de Amazon hacen sonar la alarma por la propagaci√≥n del coronavirus</a></li>
<li><a href="../es493096/index.html">Agregue un tema oscuro en iOS</a></li>
<li><a href="../es493098/index.html">Implemente el cl√∫ster de equilibrio de carga VPN ASA</a></li>
<li><a href="../es493100/index.html">C√≥mo encontrar formas f√°ciles ayuda a las startups a lograr un crecimiento agresivo</a></li>
<li><a href="../es493102/index.html">Tendencias de automatizaci√≥n global: desarrollo de RPA</a></li>
<li><a href="../es493108/index.html">Cloudflare selecciona procesadores AMD para servidores perimetrales de d√©cima generaci√≥n</a></li>
<li><a href="../es493110/index.html">C√≥mo delegar en el trabajo remoto: una gu√≠a para el liderazgo del equipo y m√°s</a></li>
<li><a href="../es493112/index.html">C√≥mo comenzar un nuevo negocio en 6 meses en lugar de 3 a√±os</a></li>
<li><a href="../es493114/index.html">C√≥mo el ingeniero de datos observ√≥ los datos</a></li>
<li><a href="../es493116/index.html">"¬°M√°s interactividad!" o ¬øC√≥mo fue TeamLead Conf 2020?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>