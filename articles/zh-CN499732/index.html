<!doctype html>
<html class="no-js" lang="zh-CN">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏼 👂 🎖️ Go行业的区块链开发。第1部分 🙍🏿 👼 🧚🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="四个月以来，我一直在从事一个名为“在政府和行业中开发基于区块链的安全和数据管理工具的项目”。
 现在我想谈谈我是如何开始这个项目的，现在我将详细描述程序代码。
 
 
 
 这是系列文章中的第一篇。在这里，我描述了服务器和协议。实际上，读者甚至可以编写自己的这些区块链元素版本。
 
 但是第二部分是...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Go行业的区块链开发。第1部分</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499732/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">四个月以来，我一直在从事一个名为“在政府和行业中开发基于区块链的安全和数据管理工具的项目”。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在我想谈谈我是如何开始这个项目的，现在我将详细描述程序代码。</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/habr/post_images/319/86b/9a5/31986b9a5079081f4eb87335330d119c.jpg" alt="图片"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是系列文章中的第一篇。在这里，我描述了服务器和协议。实际上，读者甚至可以编写自己的这些区块链元素版本。</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是第二部分</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是关于区块链和交易的数据结构，以及与数据库实现交互的包。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
去年，在Digital Break黑客马拉松上，他们提出了一个想法，即为了使行业和数字经济成为分布式注册表技术的有用系统，创新援助基金会也为开发提供了一笔赠款（关于赠款，我应该为刚开始创业的人写一篇单独的文章。 ），现在按顺序进行。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
开发是在Go中进行的，存储块的数据库是LevelDB。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
主要部分是协议，服务器（运行TCP和WebSocket）-例如，第一部分用于同步区块链，第二部分用于连接客户端，发送来自JavaScript的事务和命令。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如前所述，主要需要使用此区块链来自动化和保护供应商和客户之间或两者之间的产品交换。他们不急于彼此信任。但是，任务不仅是用内置的计算器制作“支票簿”，而且是一个在产品生命周期中自动执行大多数日常任务的系统。按照区块链的惯例，负责该业务的字节码存储在交易的输入和输出中（交易本身在块中，LevelDB中的块以GOB格式预编码）。首先，让我们谈谈协议和服务器（又名节点）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该协议并不是很有效，它的全部意义在于，响应特殊的命令行，切换到某些数据（通常是块或事务）的加载模式，并且交换库存也需要它，以便节点知道它与谁连接以及如何连接。它们有事要做（为同步会话连接的节点也称为“邻居”，因为它们的IP是已知的，并且其状态数据存储在内存中）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
文件夹（Linux称为目录的文件夹）在理解Go-programmers时被称为包，因此在每个文件的开头（从该目录开始使用Go-code），它们都将编写文件夹package_name_where_sit_this_file。</font><font style="vertical-align: inherit;">否则，程序包将无法提供给编译器。</font><font style="vertical-align: inherit;">好吧，对于那些懂这种语言的人来说，这不是秘密。</font><font style="vertical-align: inherit;">这些软件包是：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 网络（服务器，客户端，协议）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 存储和传输的数据的结构（块，事务）</font></font></li>
<li>   (blockchain)</li>
<li>  (consensus)</li>
<li>    (xvm)</li>
<li>  (crypto, types)  .</li>
</ul><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是github的链接，</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
这是一个培训版本，它缺少进程间的通信，并且具有几个实验组件，其结构与正在开发的组件相对应。</font><font style="vertical-align: inherit;">如果您在评论中有话要说，我将很乐意考虑进一步的发展。</font><font style="vertical-align: inherit;">现在用于服务器和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
首先，看一下服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器例程使用协议包中的数据结构充当在TCP协议之上运行的数据服务器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该例程使用以下软件包：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">types</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">该软件包</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font><i><font style="vertical-align: inherit;">tcp_server.go</font></i><font style="vertical-align: inherit;">数据结构</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即成</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> Serve <span class="hljs-keyword">struct</span> {<font></font>
	Port <span class="hljs-keyword">string</span>
	BufSize <span class="hljs-keyword">int</span><font></font>
	ST *types.Settings<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它可以采用以下参数：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 通过其交换数据的网络端口</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JSON服务器配置文件</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在调试模式下运行标志（私有区块链）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
进展：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 从JSON文件读取配置</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 检查调试模式标志：如果设置了该标志，则不会启动网络同步调度程序，并且不会加载区块链</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 初始化配置数据结构并启动服务器</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器</font></font></h3><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 根据协议启动TCP服务器和网络通信。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它有一个提供数据结构，其中包括一个端口号，一个缓冲器大小的，和一个指向</font><i><font style="vertical-align: inherit;">types.Settings</font></i><font style="vertical-align: inherit;">结构</font></font><i><font style="vertical-align: inherit;"></font></i></li>
<li>  Run    (     ,           handle   )</li>
<li>  <i>handle</i>      ,        <i>protocol.Choice</i></li>
<li> <i>protocol.Choice</i>  <i>result</i>   . <i>result</i>    <i>protocol.Interprete</i>,   <i>intrpr</i> —   <i>InterpreteData</i>,      </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后，通过</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Commands [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行此开关</font><font style="vertical-align: inherit;">，其中检查以下一项：</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">result，inv，error</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且有一个</font><i><font style="vertical-align: inherit;">默认</font></i><font style="vertical-align: inherit;">节</font></font><i><font style="vertical-align: inherit;"></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分中，</font><font style="vertical-align: inherit;">通过</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Commands [1]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值进行了切换，该</font><i><font style="vertical-align: inherit;">命令</font></i><font style="vertical-align: inherit;">检查</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区长度</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值</font><font style="vertical-align: inherit;">（在每种情况下都调用相应的函数）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BufferLength中的功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都位于</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">srvlib.go</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">服务器软件包的。</font></font><br>
<br>
<pre><code class="go hljs">GetVersion(conn net.Conn, version <span class="hljs-keyword">string</span>)</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
只是打印到控制台，并将参数中传递的版本发送给客户端： </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:"</span> + version))</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能</font></font><br>
<br>
<pre><code class="go hljs">BufferLength(conn net.Conn, intrpr *protocol.InterpreteData)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如下执行块，事务或其他特定数据的加载：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在控制台上打印需要接受的协议中指定的数据类型： </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-string">"DataType:"</span>, intrpr.Commands[<span class="hljs-number">2</span>])</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取</font><font style="vertical-align: inherit;">数值变量</font><i><font style="vertical-align: inherit;">buf_len中</font></i><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intrpr.Body</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个</font><font style="vertical-align: inherit;">指定大小</font><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-built_in">make</span>([]<span class="hljs-keyword">byte</span>, buf_len)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 发送好的响应： </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:ok"</span>))</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 从读取流中产生完整的缓冲区： </font></font><br>
<br>
<pre><code class="go hljs">io.ReadFull(conn, newbuf)</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 将缓冲区的内容打印到控制台 </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-keyword">string</span>(newbuf))</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和读取的字节数 </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-string">"Bytes length:"</span>, n)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 发送好的响应： </font></font><br>
<br>
<pre><code class="go hljs">conn.Write([]<span class="hljs-keyword">byte</span>(<span class="hljs-string">"result:ok"</span>))</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
服务器包中的方法以这样的方式配置：它们使用</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包中的功能处理接收到的数据</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该协议用作在网络通信期间呈现数据的工具。</font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择（str字符串）（string，错误）</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对服务器接收的数据执行初始处理，接收数据的字符串表示形式，并返回为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interprete</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备的字符串</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><i><font style="vertical-align: inherit;">ReqParseN2（str）</font></i><font style="vertical-align: inherit;">将输入字符串分为头和主体</font></font><i><font style="vertical-align: inherit;"></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> head被分解为元素，并使用ReqParseHead（head）放置在命令片中</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开关（命令[0]）中，我们</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择接收到的命令（</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmd，键，地址</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或触发</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在cmd中，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将</font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2个</font><i><font style="vertical-align: inherit;">切换命令（命令[1]）-length</font></i><font style="vertical-align: inherit;">和</font><i><font style="vertical-align: inherit;">getversion</font></i><font style="vertical-align: inherit;">。</font></font></li>
<li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">length</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令[2]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font><i><font style="vertical-align: inherit;">数据类型</font></i><font style="vertical-align: inherit;">并将其存储在</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据类型中</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正文是否</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含字符串值</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-built_in">len</span>(body) &lt; <span class="hljs-number">1</span></code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 返回一个响应字符串： </font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-string">"result:bufferlength:"</span> + datatype + <span class="hljs-string">"/"</span> + body</code></pre></li>
<li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getversion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个字符串</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">return</span> <span class="hljs-string">"result:version/auto"</span></code></pre></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">口译</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它包含InterpreteData结构，并对从</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choice</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回的</font><font style="vertical-align: inherit;">字符串和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象的形成</font><font style="vertical-align: inherit;">进行辅助处理</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<pre><code class="go hljs"><span class="hljs-keyword">type</span> InterpreteData <span class="hljs-keyword">struct</span> {<font></font>
	Head <span class="hljs-keyword">string</span>
	Commands []<span class="hljs-keyword">string</span>
	Body <span class="hljs-keyword">string</span>
	IsErr <span class="hljs-keyword">bool</span>
	ErrCode <span class="hljs-keyword">int</span> 
	ErrMessage <span class="hljs-keyword">string</span>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能 </font></font><br>
<br>
<pre><code class="go hljs">Interprete(str <span class="hljs-keyword">string</span>) (*InterpreteData, error)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接受字符串</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结果</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并创建对</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象的引用</font><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
进展：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choice</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><i><font style="vertical-align: inherit;">ReqParseN2（str）</font></i><font style="vertical-align: inherit;">检索头部和身体</font></font><i><font style="vertical-align: inherit;"></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><i><font style="vertical-align: inherit;">ReqParseHead（head）将</font></i><font style="vertical-align: inherit;"> head分解为元素</font></font><i><font style="vertical-align: inherit;"></font></i></li>
<li><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InterpreteData</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象被初始化，</font><font style="vertical-align: inherit;">并返回指向它的指针：</font></font></li>
</ul><br>
<pre><code class="go hljs">res := &amp;InterpreteData{<font></font>
	Head: head,<font></font>
	Commands: commands,<font></font>
	Body: body,<font></font>
}<font></font>
<span class="hljs-keyword">return</span> res, <span class="hljs-literal">nil</span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该对象</font><font style="vertical-align: inherit;">在主程序包的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">server.go</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
客户端程序包包含</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPConnect</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCPResponseData函数</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能</font></font><br>
<br>
<pre><code class="go hljs">TCPConnect(s *types.Settings, data []<span class="hljs-keyword">byte</span>, payload []<span class="hljs-keyword">byte</span>)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
工作方式如下：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 与传输的设置对象中指定的连接建立连接 </font></font><br>
<br>
<pre><code class="go hljs">net.Dial(<span class="hljs-string">"tcp"</span>, s.Host + <span class="hljs-string">":"</span> + s.Port)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在data参数中传递的数据将被传输： </font></font><br>
<br>
<pre><code class="go hljs">conn.Write(data)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 阅读答案 </font></font><br>
<br>
<pre><code class="go hljs">resp, n, _ := TCPResponseData(conn, s.BufSize)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并印在控制台上 </font></font><br>
<br>
<pre><code class="go hljs">fmt.Println(<span class="hljs-keyword">string</span>(resp[:n]))</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有效载荷</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被传输，则其被传输</font></font><br>
<br>
<pre><code class="go hljs">conn.Write(payload)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并读取服务器响应，并将其打印在控制台上</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功能</font></font><br>
<br>
<pre><code class="go hljs"> TCPResponseData(conn net.Conn, bufsiz <span class="hljs-keyword">int</span>) ([]<span class="hljs-keyword">byte</span>, <span class="hljs-keyword">int</span>, error)</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
创建指定大小的缓冲区，在该处读取服务器响应，然后返回该缓冲区，读取的字节数以及错误对象。</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户例行</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
用于将命令传输到节点服务器，以及获得简要的统计信息和测试。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
它可以采用以下参数：JSON格式的配置文件，要以字符串形式发送到服务器的数据，要发送到有效负载的文件的路径，节点调度程序仿真标志，要以数值形式传输的数据类型。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 获取配置 </font></font><br>
<br>
<pre><code class="go hljs">st := types.ParseConfig(*config)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果给您一个</font><i><font style="vertical-align: inherit;">e</font></i><font style="vertical-align: inherit;">标志，则启动</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sheduler</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果指定了标志f指示文件的路径，则将其数据加载到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fdb中</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并将内容发送到服务器</font></font><br>
<br>
<pre><code class="go hljs">client.TCPConnect(st, []<span class="hljs-keyword">byte</span>(CMD_BUFFER_LENGTH + <span class="hljs-string">":"</span> + strconv.Itoa(*t) + <span class="hljs-string">"/"</span> + strconv.Itoa(fdblen)), fdb)</code></pre></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果未指定文件，则仅发送</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志中的数据</font><font style="vertical-align: inherit;">：</font></font><br>
<br>
<pre><code class="go hljs">client.TCPConnect(st, []<span class="hljs-keyword">byte</span>(*data), <span class="hljs-literal">nil</span>)</code></pre></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
所有这些都是显示协议结构的简化视图。</font><font style="vertical-align: inherit;">在开发过程中，必要的功能已添加到其结构中。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在第二部分中，我将讨论块和事务的数据结构，在第三部分中，将讨论用于从JavaScript连接的WebSocket服务器，在第四部分中，我们将考虑同步调度程序，然后是处理来自输入和输出，密码术和输出池的字节码的堆栈机。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN499714/index.html">世界，代码，5月：我们在假期中提供有用的报告</a></li>
<li><a href="../zh-CN499718/index.html">我们了解VPN协议</a></li>
<li><a href="../zh-CN499720/index.html">打字稿练习本</a></li>
<li><a href="../zh-CN499722/index.html">从Babel到GraphQL：HolyJS 2019莫斯科会谈</a></li>
<li><a href="../zh-CN499728/index.html">Google的工作。从乌克兰到硅谷</a></li>
<li><a href="../zh-CN499736/index.html">圣彼得堡HSE的软件工程硕士学位教授的内容</a></li>
<li><a href="../zh-CN499740/index.html">专业人才基地“泄漏”</a></li>
<li><a href="../zh-CN499742/index.html">拒绝服务类型：DDoS如何发展</a></li>
<li><a href="../zh-CN499744/index.html">云安全警报安全中心</a></li>
<li><a href="../zh-CN499750/index.html">如何扫描整个互联网</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>