<!doctype html>
<html class="no-js" lang="pt">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¶ ‚ñ™Ô∏è üë∏üèª Como solucionar os erros ao criar relat√≥rios no Power BI e come√ßar a constru√ß√£o de um sistema de upload para big data üëÉüèæ üßö üà∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Por tr√°s dos pain√©is bonitos e compreens√≠veis do Power BI, muitas vezes h√° semanas de prepara√ß√£o e minera√ß√£o de dados. Especialmente quando se trata d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Como solucionar os erros ao criar relat√≥rios no Power BI e come√ßar a constru√ß√£o de um sistema de upload para big data</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/agima/blog/492204/"><img src="https://habrastorage.org/webt/2d/wo/vr/2dwovr1h5boyixwojsztgjctksk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por tr√°s dos pain√©is bonitos e compreens√≠veis do Power BI, muitas vezes h√° semanas de prepara√ß√£o e minera√ß√£o de dados. </font><font style="vertical-align: inherit;">Especialmente quando se trata de criar relat√≥rios √∫teis de BI em uma grande organiza√ß√£o com um volume de tr√°fego de dezenas de milh√µes de visitantes todos os meses. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste artigo, quero descrever v√°rios aspectos negativos que encontrei ao criar relat√≥rios de BI com base em dados de sistemas de an√°lise da Web em v√°rias empresas (grandes representantes do com√©rcio eletr√¥nico russo, companhias de seguros etc.). </font><font style="vertical-align: inherit;">O artigo n√£o tem como objetivo fazer propaganda antipublicidade, ou vice-versa, de determinadas ferramentas ou decis√µes. </font><font style="vertical-align: inherit;">√â preparado para ajudar a evitar poss√≠veis momentos negativos para outros usu√°rios e indicar op√ß√µes de solu√ß√µes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aviso Legal</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estou falando sobre grandes quantidades de dados e mostrando exemplos de upload e amostragem do Google Analytics 360. Em projetos com uma pequena quantidade de dados, essas dificuldades podem n√£o existir. </font><font style="vertical-align: inherit;">Eu conheci todos os problemas identificados na pr√°tica e, no artigo, descrevo apenas minha experi√™ncia em resolver - a sua pode ser completamente diferente.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conector para Yandex.Metrica</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Yandex.Metrica possui condi√ß√µes de amostragem mais brandas e uma interface intuitiva em compara√ß√£o com o Google Analytics. Portanto, muitos profissionais de marketing preferem o Yandex.Metrica e criam relat√≥rios de BI sobre o upload de dados a partir da√≠. Para fazer isso, use o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conector de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maxim Uvarov. Este m√©todo √© inseguro e n√£o permite o processamento de solicita√ß√µes complexas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As grandes empresas precisam garantir que as informa√ß√µes confidenciais n√£o caiam nas m√£os dos detratores, e os indicadores financeiros ser√£o usados ‚Äã‚Äãapenas pelas partes interessadas e exclusivamente dentro da empresa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O primeiro grande ponto negativo √© que, para usar o conector, no Power BI, √© necess√°rio ativar a configura√ß√£o "Ignorar n√≠veis de privacidade", caso contr√°rio, n√£o funcionar√°.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ty/pg/eb/typgebof8euu4d6s2pgljyfqs4k.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, dados confidenciais podem cair nas m√£os de qualquer usu√°rio n√£o autorizado. Isso √© confirmado por um trecho da Ajuda do Power BI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xd/2j/86/xd2j860l6kp0j7wuswlge0jor3u.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A conex√£o de dados √© an√¥nima. No entanto, n√£o h√° autoriza√ß√£o ou verifica√ß√£o de permiss√£o para usar esses dados para os usu√°rios que realmente t√™m permiss√£o. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/gd/b3/dn/gdb3dni9wi_kxd27btthfhuk5h0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que esses conectores funcionem, voc√™ precisa obter um token de acesso oauth. A descri√ß√£o do conector fornece um link sobre como conceder ao aplicativo acesso √† sua conta. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/-y/nq/gx/-ynqgxssteulef1kedj3smcflkk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De fato, um aplicativo de terceiros ter√° acesso √† sua conta. Ningu√©m garante a seguran√ßa dos seus dados.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/tm/ux/23/tmux237gyybnovyelwetareee4g.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo ponto negativo √© que a API do Yandex.Metrica n√£o pode processar grandes quantidades de dados em projetos grandes e, como resultado, o conector tamb√©m se recusa a trabalhar com consultas complexas nos dados brutos do Yandex.Metrica - n√£o os descarrega. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, voc√™ precisa fazer o upload de dados por um ano, sem filtros complexos. O conector gera um erro: ‚ÄúA solicita√ß√£o √© muito complexa. Por favor, reduza o espa√ßamento ou a amostragem da data ". </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xs/vx/fi/xsvxfi4zsihgayia1fo87_pbj88.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, esta √© uma tradu√ß√£o do erro da pr√≥pria API Yandex.Metrica. No entanto, nesse caso, n√£o temos op√ß√£o de baixar dados com uma discrimina√ß√£o por m√™s ou dia - por exemplo, para alternar dados para cada m√™s e combin√°-los em um √∫nico conjunto de dados, superando um erro de API. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ reduzir significativamente o per√≠odo, a API permitir√° que voc√™ bombeie dados, mas isso √© apenas uma pequena parte do que precisamos.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/xd/gd/6q/xdgd6qonfgcyjthxhjj65_ophyu.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar relat√≥rios grandes, o descarregamento por per√≠odos curtos √© impratic√°vel e inconveniente. </font><font style="vertical-align: inherit;">Na pr√°tica, voc√™ geralmente precisa descarregar atrav√©s de funis complexos de site aberto com um grande n√∫mero de visitas por dia. </font><font style="vertical-align: inherit;">Especialmente ao usar segmentos complexos de visitas, √© praticamente imposs√≠vel fazer o upload dos dados necess√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesmo que voc√™ tenha conseguido carregar os dados, n√£o √© poss√≠vel carregar no modelo de dados para criar o pr√≥prio relat√≥rio, porque v√°rios erros de carregamento aparecem de vez em quando. </font><font style="vertical-align: inherit;">Por algum motivo, mesmo com uma tabela carregada normalmente, ocorrem erros.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/9d/u8/wk9du8sdgpdqe1gb7cr-n2uk6_8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que todas as partes interessadas na empresa possam usar o relat√≥rio criado no conector da API Yandex.Metrica, √© necess√°rio publicar o relat√≥rio no Servi√ßo PowerBI. </font><font style="vertical-align: inherit;">Nesse caso, os n√≠veis de privacidade tamb√©m ter√£o que ser ignorados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qc/dg/i8/qcdgi8gck0lkcdp-t--vedkmuiw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando a visualiza√ß√£o estiver configurada e o relat√≥rio publicado na nuvem da Microsoft, o conector exibir√° um erro de consulta combinado e n√£o ser√° atualizado pelo Servi√ßo do Power BI - voc√™ n√£o poder√° configurar a atualiza√ß√£o agendada do seu relat√≥rio. O erro ocorre quando uma das consultas, que forma a tabela de upload final, cont√©m a l√≥gica do trabalho simult√¢neo com a consulta externa e interna. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No erro, a </font></font><br>
<br>
<img src="https://habrastorage.org/webt/0-/ci/rt/0-cirtjh6ifdkpe-ajduldxstsc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
tabela </font><font style="vertical-align: inherit;">"Fun√ß√£o chamada" </font><font style="vertical-align: inherit;">√© </font><font style="vertical-align: inherit;">apenas indicada: </font><font style="vertical-align: inherit;">Esta tabela √© obtida devido √† fun√ß√£o PQYM, que funciona com uma fonte de dados externa - a API Yandex.Metrica. O mecanismo de atualiza√ß√£o de relat√≥rios no Power BI n√£o funciona e solicita refazer a combina√ß√£o de consultas. Isso ocorre devido aos links internos de uma solicita√ß√£o para conectar-se a uma solicita√ß√£o externa, bem como √† estrutura da pr√≥pria fun√ß√£o.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/vv/lv/mb/vvlvmbnqatqohghiivpcofsgxze.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Decidimos n√£o usar esse conector ao criar relat√≥rios e passamos a descarregar dados da API Yandex.Metrica por meio de scripts Python, mais sobre isso mais adiante neste artigo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conector do Google Analytics</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar relat√≥rios sobre os dados do Google Analytics (estamos falando de download direto do sistema de an√°lise), tamb√©m h√° um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conector</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maxim Uvarov. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui voc√™ tamb√©m ter√° que definir "Ignorando n√≠veis de privacidade". O acesso √† API do seu sistema de an√°lise, que cont√©m dados sobre vendas online, ocorre em uma conex√£o an√¥nima. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/pw/ke/x1/pwkex1vkvifxlkqne2kbvo0pvsy.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acordo com as instru√ß√µes, novamente voc√™ ter√° que abrir o acesso a um aplicativo de terceiros, apenas para uma conta do Google, que contenha uma amea√ßa √† privacidade dos seus dados. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/zx/qr/0f/zxqr0fyqjpqp_6umz9y_o5_i83a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode reescrever alguns dados no pr√≥prio conector e come√ßar a us√°-los para seu pr√≥prio aplicativo. Para fazer isso, registre o "ID do cliente OAuth 2.0" em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cloud.google.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, obtenha tokens de acesso e insira as chaves de acesso necess√°rias em seu mecanismo de trabalho. Mas mesmo essas a√ß√µes n√£o ajudar√£o na luta contra a amostragem e a atualiza√ß√£o dos seus relat√≥rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sempre que voc√™ tocar nos dados agregados da API do Google Analytics, sempre encontraremos amostras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O conector tem a op√ß√£o de descarregar um dia, mas nem sempre ele salva. O indicador de amostragem embutido no conector mostra que ele existe mesmo em um dia. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/dk/kj/5l/dkkj5lp-e3zi8drcbylxc1hzmjk.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por exemplo, os dados da sess√£o divididos pelo Shopping Stage n√£o podem ser carregados sem amostragem nessas quantidades de dados. Isso levar√° a grandes erros de dados e medidas na cria√ß√£o de relat√≥rios, especialmente quando for necess√°rio calcular com precis√£o a convers√£o da transi√ß√£o de uma etapa para outra ou fazer upload de dados em funis com uma estrutura complexa de segmentos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mesmo que a perda de dados n√£o seja cr√≠tica para voc√™, voc√™ ainda n√£o poder√° configurar a atualiza√ß√£o agendada de seus relat√≥rios por meio do Servi√ßo do Power BI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/sh/5q/61/sh5q61niklucdiieoedjfltnp3c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mesmo erro do mecanismo de trabalho interfere, apenas as fun√ß√µes PQGA.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/ft/uy/k0ftuyqfzkqptqvupuotawgo1my.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tamb√©m nos recusamos a trabalhar com este conector.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conector nativo do Google Analytics</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Äs vezes, o Google e a Microsoft fazem concess√µes entre si: o Power BI pronto para uso possui um conector padr√£o do Google Analytics. </font><font style="vertical-align: inherit;">Infelizmente, n√£o existe essa op√ß√£o para o Yandex.Metrica.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/xl/hk/po/xlhkpo-a4h95gz-nksi6ws_613k.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O mecanismo para trabalhar com a API do Google Analytics √© mais convenientemente implementado aqui do que no conector de Maxim Uvarov, mas durante o download de um grande n√∫mero de indicadores, os dados s√£o muito amostrados. </font><font style="vertical-align: inherit;">Os n√∫meros repetidos na captura de tela s√£o os dados amostrados.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lw/ba/n_/lwban_daksuitnrmfw5sihfjqpm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode evitar a amostragem se descarregar minitabelas discriminadas apenas por data e qualquer um dos indicadores. Por exemplo, data, n√∫mero de sess√µes e tipo de dispositivo. E, a partir dessas tabelas, para coletar os relat√≥rios necess√°rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ n√£o possui milh√µes de tr√°fego, isso pode ajudar. No entanto, os relat√≥rios n√£o ser√£o informativos e com limita√ß√µes de escalabilidade: devido √†s muitas minitabelas no modelo de dados, √© dif√≠cil criar relacionamentos entre elas. Isso imp√µe uma restri√ß√£o √† cria√ß√£o de filtros e fatias. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode reescrever o conector padr√£o e for√ß√°-lo a fazer upload de dados para cada dia, enquanto os dados estar√£o pr√≥ximos dos n√∫meros reais na interface do GA, mas n√£o ser√° poss√≠vel evitar a amostragem.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/br/oc/fg/brocfgwihu2rpcqfjrdmhsvbsdc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De acordo com minhas observa√ß√µes, no detalhamento das sess√µes do Shopping Stage, nem um √∫nico conector conseguiu fazer upload de dados normalmente sem amostrar grandes quantidades de dados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No conector padr√£o, voc√™ n√£o pode personalizar as datas do download. </font><font style="vertical-align: inherit;">Tudo isso √© simplesmente uma sele√ß√£o de par√¢metros e m√©tricas das APIs do Google Analytics organizadas em pastas.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/he/_n/tt/he_ntt6qogkz6vm-3mjnbmn0rya.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse conector √© adequado para projetos de Internet de pequeno e m√©dio porte com pouco tr√°fego. </font><font style="vertical-align: inherit;">Aqui, uma situa√ß√£o semelhante surge com a obten√ß√£o de dados do Yandex.Metrica. </font><font style="vertical-align: inherit;">Todas as informa√ß√µes necess√°rias sem perda de precis√£o s√≥ podem ser baixadas diretamente atrav√©s da API usando scripts ou servi√ßos especiais de streaming de dados - mais sobre isso mais adiante neste artigo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sticks in Wheels by Google</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Recentemente, notamos um bloqueio estranho - ao tentar configurar a atualiza√ß√£o para o conector "nativo" do Google Analytics, um erro de autoriza√ß√£o apareceu por meio de uma conta do Google na interface do Servi√ßo do Power BI. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/o0/wt/yr/o0wtyrw-caxzwahcpjjb_pgfrbe.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentamos descobrir no Google o que fazer em tal situa√ß√£o e como "branquear" a reputa√ß√£o da conta, mas nossas tentativas falharam. Tentamos registrar novas contas e fazer login em diferentes dispositivos - o Google bloqueou qualquer tentativa de autoriza√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cerca de um m√™s ap√≥s o bloqueio, ainda conseguimos acessar a mesma conta, mas esse incidente pode interferir seriamente na libera√ß√£o dos relat√≥rios de BI necess√°rios em tempo h√°bil e colocar o cliente em uma situa√ß√£o embara√ßosa. </font><font style="vertical-align: inherit;">Imediatamente ap√≥s o bloqueio, come√ßamos a procurar uma poss√≠vel sa√≠da da situa√ß√£o. </font><font style="vertical-align: inherit;">Para evitar bloqueios inesperados, decidimos criar nosso pr√≥prio ambiente controlado com os dados necess√°rios para os relat√≥rios de BI.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√µes de solu√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obtenha os relat√≥rios de BI necess√°rios para organiza√ß√µes de m√©dio e grande porte, e mesmo sem amostragem √© poss√≠vel. </font><font style="vertical-align: inherit;">Mas voc√™ precisa tentar um pouco e escolher uma das v√°rias maneiras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode usar servi√ßos prontos para transmitir dados. </font><font style="vertical-align: inherit;">Seu principal objetivo √© fazer upload de dados do sistema de an√°lise, v√°rios sistemas de publicidade, CRM e outros servi√ßos para qualquer armazenamento. </font><font style="vertical-align: inherit;">Conveniente, r√°pido e pr√°tico, mas n√£o gratuito. </font><font style="vertical-align: inherit;">Em grandes volumes de dados ou dados com v√°rias fontes, os valores s√£o tang√≠veis. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os servi√ßos mais famosos:</font></font></b><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renta.im</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pipeline OWOX BI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myBI Connect</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cada um desses sistemas permite configurar o fluxo di√°rio de dados n√£o amostrados dos sistemas de an√°lise da web (Yandex.Metrics e Google Analytics) para bancos de dados (por exemplo, BigQuery, Banco de Dados SQL do Azure, Microsoft SQL Server ou ClickHouse) para conectar-se via Power BI e criar relat√≥rios. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se as ferramentas listadas forem muito caras para a empresa, voc√™ pode tentar implementar seu sistema de upload de dados e usar o Power BI + Python + Qualquer Cloud Server (ou Yandex.Cloud) + PostgreSQL. Este √© o m√©todo que usamos ao criar relat√≥rios de BI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esquema de intera√ß√£o do sistema:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kb/iu/um/kbiuumx6q6a_k5wxdq1g78ukehg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este esquema de trabalho fornece a necess√°ria seguran√ßa, autonomia e agrega√ß√£o de dados. Depois de estabelecer esse esquema uma vez, voc√™ n√£o precisar√° gastar tempo coletando informa√ß√µes - tudo est√° no reposit√≥rio, basta conectar e come√ßar a fazer um relat√≥rio no Power BI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os scripts Python ‚Äúextraem‚Äù todos os dados de acordo com a API das fontes necess√°rias, gravam no banco de dados ou formam descarregamentos (por exemplo, no formato csv). Os scripts para upload da API e carregamento no banco de dados merecem um artigo separado, e algum dia eu o escreverei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, existem muitos modelos e solu√ß√µes prontas na Internet, mas, para ampliar ainda mais a escala, √© necess√°rio conhecer as necessidades individuais do sistema sob o qual os scripts para descarregamento s√£o criados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os dados s√£o gravados em um banco de dados pr√©-criado e configurado - no nosso caso, o PostgreSQL. </font><font style="vertical-align: inherit;">Os scripts distribuem dados para cada dia e os escrevem nas tabelas de acordo com uma programa√ß√£o. </font><font style="vertical-align: inherit;">Eles est√£o localizados em um servidor em nuvem sob nosso controle ou sob o controle do servi√ßo de seguran√ßa de TI do cliente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
H√° um grande n√∫mero de empresas que fornecem servi√ßos de armazenamento em nuvem. </font><font style="vertical-align: inherit;">Com base nas prefer√™ncias pessoais, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yandex Cloud</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> foi selecionado </font><font style="vertical-align: inherit;">. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vantagens do Yandex.Cloud:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√£o conveniente e aluguel de servidores com o PostgreSQL pr√©-instalado.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Documenta√ß√£o extensa em russo, que √© claramente declarada e permite que voc√™ aprenda rapidamente como usar o servi√ßo. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento conveniente de servidores.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suporte r√°pido de especialistas.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flexibilidade de v√°rias configura√ß√µes e tarifas de equipamentos: ningu√©m imp√µe nenhum pacote de configura√ß√µes prontas, voc√™ mesmo escolhe a configura√ß√£o do seu equipamento e pode solicitar imediatamente a predefini√ß√£o de qualquer banco de dados.</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yt/f6/_-/ytf6_-9xrfcobvmfbwaajwyl8bm.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os uploads resultantes s√£o gravados no banco de dados PostgreSQL. </font><font style="vertical-align: inherit;">Esse banco de dados foi escolhido por ser um DBMS relacional a objetos (trabalhando com matrizes multidimensionais e suporte a JSON da ‚Äúcaixa‚Äù - pois estruturas de dados complexas devem ter). </font><font style="vertical-align: inherit;">√â flex√≠vel, confi√°vel, gratuito e tamb√©m possui uma enorme comunidade de suporte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O Power BI possui um conector direto interno no PostgreSQL. </font><font style="vertical-align: inherit;">Na primeira conex√£o, voc√™ precisa instalar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Npgsql</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adicional </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">O Power BI notifica voc√™ sobre isso e fornece um link.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ju/n_/wf/jun_wfcjtsnm0khj3wf9pzj8h2s.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para configurar atualiza√ß√µes de relat√≥rio ao usar o armazenamento em nuvem, voc√™ deve configurar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power BI Gateway</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . √â necess√°rio configurar a atualiza√ß√£o dos relat√≥rios de BI e garantir a seguran√ßa dos dados confidenciais ao transferi-los de um banco de dados, que deve estar localizado no circuito interno de TI da sua organiza√ß√£o ou em um servidor em nuvem seguro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O gateway fornece transfer√™ncia de dados r√°pida e segura entre reposit√≥rios de dados localizados na rede interna da organiza√ß√£o e nos servi√ßos de nuvem da Microsoft. A transfer√™ncia de dados entre o Power BI e o gateway √© segura e todas as credenciais fornecidas pelos administradores do gateway s√£o criptografadas para proteger as informa√ß√µes na nuvem e s√£o descriptografadas apenas no computador do gateway.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mm/hd/re/mmhdrebvglgmfz1zfbncjck835w.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de baixar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Power BI Gateway</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e inici√°-lo, uma caixa de di√°logo √© exibida.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/or/q7/4z/orq74zn_gyemebomwqxzfxcwkfu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para registrar e operar o gateway, s√£o necess√°rias as credenciais do servi√ßo de nuvem do Power BI Service.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/pq/ft/4zpqft8l1urixndm8dfndrrje4s.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ap√≥s todas as configura√ß√µes, uma janela sobre o gateway de trabalho ser√° exibida. </font><font style="vertical-align: inherit;">Em seguida, voc√™ precisa fazer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configura√ß√µes adicionais.</font></font></a><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sw/mb/t2/swmbt2b7ldkzf42k56px-ucc4re.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma alternativa mais simples para personalizar o PostgreSQL √© o Google BigQuery. </font><font style="vertical-align: inherit;">O Power BI possui um conector interno no Google BigQuery. </font><font style="vertical-align: inherit;">Nesse caso, √© necess√°rio seguir o princ√≠pio de "sete vezes para calcular o custo, uma vez para atender √† solicita√ß√£o".</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/3m/gv/7a/3mgv7a-1zf0i3g8oxj-jiabgke4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O BigQuery pode ser usado gratuitamente por um ano, simplesmente amarrando um cart√£o banc√°rio mediante acordo para o uso do servi√ßo. </font><font style="vertical-align: inherit;">Dinheiro ap√≥s o prazo final sem o seu conhecimento n√£o ser√° debitado. </font><font style="vertical-align: inherit;">Tarifas adicionais - de acordo com as tarifas do pr√≥prio sistema, mas com algumas "vantagens" agrad√°veis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se os dados baixados do seu sistema n√£o atingirem 10 GB por m√™s (!), N√£o haver√° cobran√ßa pelo download.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/bg/il/hj/bgilhj19p3rswgrnp5co7lw75dq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se o processamento mensal de dados n√£o exceder 1 TB, nenhuma taxa ser√° cobrada por isso tamb√©m. </font><font style="vertical-align: inherit;">Se houver mais, ent√£o US $ 5 para cada tratamento 1 TB.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/gk/4l/ffgk4l0whznxxacywqupqmuht1i.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ precisar armazenar mais de 10 GB por m√™s, cada gigabyte subsequente custar√° US $ 0,010.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lh/bn/7z/lhbn7zv038ot99ogeahedobx5bc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As tarifas s√£o descritas em mais detalhes na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina do BigQuery.</font></font></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum√°rio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ precisar de dados de v√°rios sistemas de an√°lise e, ao mesmo tempo, seguran√ßa, seguran√ßa, agrega√ß√£o cont√≠nua, usabilidade e falta de amostragem s√£o fundamentais para voc√™, voc√™ tem duas maneiras. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O primeiro s√£o os servi√ßos de streaming. </font><font style="vertical-align: inherit;">S√£o f√°ceis de usar, contam com suporte t√©cnico cont√≠nuo e integra√ß√£o pronta com data warehouses. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desvantagens:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Custos tang√≠veis em grandes quantidades de dados.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo limitado de integra√ß√£o fornecido.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processos n√£o controlados no lado do provedor de servi√ßos de streaming para trabalhar com suas informa√ß√µes.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo √© o seu pr√≥prio fluxo de upload e agrega√ß√£o de dados. Escal√°vel, controlado, com seguran√ßa de dados. Pode parecer complicado e demorado de implementar. Se a empresa precisar de uma organiza√ß√£o eficaz de relat√≥rios de BI, de mais escalabilidade e seguran√ßa de dados, essa op√ß√£o ser√° a mais aceit√°vel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todos aqueles que pensam apenas em relat√≥rios de BI completos precisam adicionar o lema "Acumular, estruturar e proteger esses dados da juventude" na cultura corporativa. N√£o h√° nada melhor do que um banco de dados completo e tolerante a falhas com um backup regular e com direitos diferenciados de us√°-lo para diferentes categorias de partes interessadas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio acumular, estruturar e agregar seus dados de sistemas de an√°lise, de um aplicativo m√≥vel e de outros servi√ßos de clientes. </font><font style="vertical-align: inherit;">Tudo isso no futuro ajudar√° a analisar seu p√∫blico e produtos em qualquer se√ß√£o. </font><font style="vertical-align: inherit;">Informa√ß√µes e dados agora dominam o mundo e √†s vezes custam mais que dinheiro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Falarei sobre como implementar a abordagem descrita no artigo para transferir dados de an√°lise para um banco de dados PostgreSQL usando scripts Python e detalhes de implementa√ß√£o nos artigos a seguir.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt492190/index.html">SaaS russo 2019 - resultados</a></li>
<li><a href="../pt492192/index.html">Em busca da excel√™ncia do bolso</a></li>
<li><a href="../pt492194/index.html">Conhe√ßa um cara que vende dispositivos sem fio para roubar rapidamente carros de luxo</a></li>
<li><a href="../pt492200/index.html">Automa√ß√£o de teste: Java ou Python?</a></li>
<li><a href="../pt492202/index.html">–ö–æ—Ä–æ–Ω–∞–≤–∏—Ä—É—Å COVID-19: —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, –±–µ–∑ –ø–∞–Ω–∏–∫–∏</a></li>
<li><a href="../pt492210/index.html">Vis√£o geral t√©cnica da arquitetura de armazenamento Infinidat</a></li>
<li><a href="../pt492212/index.html">Desenvolvimento front-end de portais em software de c√≥digo aberto: compartilhe experi√™ncia</a></li>
<li><a href="../pt492214/index.html">Por que vale a pena fazer reuni√µes enquanto caminha? Comprovado pela ci√™ncia, confirmado pela m√°fia</a></li>
<li><a href="../pt492216/index.html">Salvando valores em um aplicativo .Net no Build</a></li>
<li><a href="../pt492218/index.html">Regras de design de √≠cone para lembrar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>