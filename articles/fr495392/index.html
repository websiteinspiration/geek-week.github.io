<!doctype html>
<html class="no-js" lang="fr">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✍️ 🙋🏽 🤯 Comment rechercher des bugs sur le front-end: 4 étapes principales 🕗 👩🏻‍🤝‍👨🏽 🈳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, j'examinerai la question de l'identification et du traitement des erreurs qui se produisent sur le frontend (navigateur ou vue Web)....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Comment rechercher des bugs sur le front-end: 4 étapes principales</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/495392/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c08/5ff/884/c085ff8845d18ef9dffa549af66df2e5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, j'examinerai la question de l'identification et du traitement des erreurs qui se produisent sur le frontend (navigateur ou vue Web). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur le frontend, le code JS est exécuté dans le navigateur. </font><font style="vertical-align: inherit;">JavaScript n'est pas un langage compilé, il y a donc toujours un risque d'erreur de performance lors de l'utilisation directe du programme. </font><font style="vertical-align: inherit;">Une erreur d'exécution bloque le code situé après le lieu de l'erreur et les utilisateurs du programme courent le risque de rester avec un écran d'application non fonctionnel qui ne peut être rechargé ou fermé. </font><font style="vertical-align: inherit;">Mais il existe des méthodes pour détecter les erreurs et leur accompagnement sûr, pour éviter de telles situations.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Outils JavaScript</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayer / attraper des blocs</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les fonctions qui peuvent échouer peuvent être encapsulées dans des blocs try / catch. </font><font style="vertical-align: inherit;">Tout d'abord, le programme essaie d'exécuter le code dans le bloc try. </font><font style="vertical-align: inherit;">Si, pour une raison quelconque, l'exécution du code est interrompue, le programme va dans le bloc catch, où trois paramètres sont disponibles:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nom - nom normalisé de l'erreur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">message - message sur les détails de l'erreur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stack - la pile d'appels en cours dans laquelle l'erreur s'est produite.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est à dire:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;callFunc();<font></font>
<font></font>
} <span class="hljs-keyword">catch</span> (e) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.name) <span class="hljs-comment">// ReferenceError</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.message) <span class="hljs-comment">// callFunc is not defined</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.stack) <span class="hljs-comment">// ReferenceError: callFunc is not defined at window.onload</span><font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour le développeur, l'essentiel est que le programme puisse continuer son exécution après le bloc catch. </font><font style="vertical-align: inherit;">Ainsi, l'interaction de l'utilisateur ne sera pas interrompue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant le bloc try / catch, vous pouvez également provoquer vos propres erreurs, par exemple, lors de la vérification des données:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> user = {<font></font>
<font></font>
&nbsp;&nbsp;<span class="hljs-attr">name</span> : «Mike»<font></font>
<font></font>
};<font></font>
<font></font>
<span class="hljs-keyword">try</span> {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (!user.age) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">SyntaxError</span>(«User age is absent!»);<font></font>
<font></font>
} <span class="hljs-keyword">catch</span> (e) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.name) <span class="hljs-comment">// SyntaxError</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.message) <span class="hljs-comment">// User age is absent!</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e.stack) <span class="hljs-comment">// SyntaxError: User age is absent! at window.onload</span><font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, vous pouvez étendre cette instruction avec un bloc de plus - enfin, qui est toujours exécuté: à la fois dans le cas où il n'y a pas eu d'erreur dans try, et dans le cas où le contrôle est passé au bloc catch:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">try</span> {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;callFunc();<font></font>
<font></font>
} <span class="hljs-keyword">catch</span> (e) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(e)<font></font>
<font></font>
} <span class="hljs-keyword">finally</span> {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;...<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parfois, ils utilisent l'instruction try / finally (sans catch) afin que vous puissiez continuer à utiliser le code sans gérer des erreurs spécifiques.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Événement Window.onerror</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est souvent utile de savoir que le script de la page s'est cassé même si le programme s'est cassé et que la session utilisateur s'est terminée sans succès. </font><font style="vertical-align: inherit;">Habituellement, ces informations sont ensuite utilisées dans les systèmes d'enregistrement des erreurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'objet fenêtre global a un événement onerror ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisez-le avec précaution: l'implémentation peut différer selon les navigateurs!</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-built_in">window</span>.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message, url, line, col, error</span>) </span>{<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${message}</span>\n  <span class="hljs-subst">${line}</span>:<span class="hljs-subst">${col}</span>  <span class="hljs-subst">${url}</span>`</span>);<font></font>
<font></font>
};</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous placez ce code au début du script ou le chargez dans un script distinct en premier lieu, pour toute erreur ci-dessous, le développeur disposera d'informations détaillées à ce sujet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, les informations complètes ne sont disponibles que pour les scripts téléchargés à partir du même domaine. </font><font style="vertical-align: inherit;">Si le script cassé est chargé à partir d'un autre domaine, window.onerror fonctionnera, mais il n'y aura pas de détails sur l'erreur.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composants du framework</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certains frameworks JS ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">React</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Vue) proposent leurs propres solutions de gestion des erreurs. </font><font style="vertical-align: inherit;">Par exemple, React pourra dessiner une disposition spéciale à l'emplacement du bloc dans lequel l'erreur s'est produite:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">constructor</span>(props) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">super</span>(props);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">this</span>.state = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span> };<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">static</span> getDerivedStateFromError(error) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//    ,      UI.</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> };<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;componentDidCatch(error, errorInfo) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//           </span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logErrorToMyService(error, errorInfo);<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;render() {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.state.hasError) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment">//    UI  </span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>-   .<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.children;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
}<font></font>
<font></font>
&lt;ErrorBoundary&gt;<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyWidget</span> /&gt;</span></span><font></font>
<font></font>
&lt;/ErrorBoundary&gt;</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, le composant React est enveloppé dans un composant spécial qui gère les erreurs. </font><font style="vertical-align: inherit;">Ceci est similaire à l'encapsulation de fonctions avec une construction try / catch.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Outils d'assemblage de projet</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les scripts JS modernes sont généralement transposés. </font><font style="vertical-align: inherit;">Autrement dit, le développement est effectué en utilisant les dernières normes ES. </font><font style="vertical-align: inherit;">Et puis le code du développeur utilisant le générateur de projet (tel que Webpack) est converti en code qui sera garanti pour fonctionner dans le nombre de navigateurs sélectionné. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au stade de la construction, le code est vérifié pour la syntaxe correcte. </font><font style="vertical-align: inherit;">Un support ouvert ou une désignation incorrecte d'un champ de classe provoquera immédiatement une erreur lors de l'assemblage et le bundle ne sera tout simplement pas assemblé. </font><font style="vertical-align: inherit;">Le développeur devra corriger immédiatement ces erreurs afin de continuer à travailler. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, le collecteur peut suggérer que certains morceaux de code ne sont pas utilisés lors de l'exécution du programme. </font><font style="vertical-align: inherit;">Cela incitera peut-être le développeur à réfléchir à une étude plus approfondie du code, ce qui pourrait indirectement affecter l'identification de nouvelles erreurs.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Test</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre façon d'éviter les erreurs dans le code est de le tester. </font><font style="vertical-align: inherit;">Il existe des outils en frontend pour une utilisation efficace des tests unitaires. </font><font style="vertical-align: inherit;">En règle générale, des cadres tels que Jest, Karma, Mocha, Jasmine sont utilisés. </font><font style="vertical-align: inherit;">Avec les frameworks de test, ils utilisent souvent des extensions telles que Enzyme, React Testing Library, Sinon et autres, qui permettent d'enrichir les tests à l'aide de la simulation, des fonctions d'espionnage et d'autres outils. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la recherche d'erreurs, les tests sont principalement utiles pour charger une variété de données pouvant entraîner des erreurs d'exécution. </font><font style="vertical-align: inherit;">Ainsi, le code suivant passera la validation de la syntaxe et fonctionnera comme prévu:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> func = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(data)<font></font>
<font></font>
}<font></font>
<font></font>
func(<span class="hljs-string">'{«a»:1}'</span>)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il se cassera si vous lui donnez la mauvaise valeur:</font></font><br>
<br>
<pre><code class="javascript hljs">func() <span class="hljs-comment">// Uncaught SyntaxError: Unexpected token u in JSON at position 0.</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce code passe également la validation lors de l'assemblage:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">const</span> obj = {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">outer</span> : {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr">last</span> : <span class="hljs-number">9</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;}<font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span> (obj.outer.inner.last) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(«SUCCESS»)<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, il se cassera également pendant l'exécution. </font><font style="vertical-align: inherit;">Après les tests, le développeur fera probablement des vérifications supplémentaires:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">if</span> (obj.outer?.inner?.last) {<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">console</span>.log(«SUCCESS»)<font></font>
<font></font>
}</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Souvent, de telles erreurs se produisent lors de la réception de données du serveur (par exemple, avec une demande AJAX) avec leur analyse ultérieure. </font><font style="vertical-align: inherit;">Le test du code vous permet d'identifier et d'éliminer à l'avance les cas où le code peut se casser pendant l'exécution dans le navigateur du client.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Enregistrement</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Supposons que nous ayons pris toutes les mesures possibles pour éviter les erreurs lors du développement et du montage du projet. Cependant, les erreurs peuvent toujours infiltrer le code productif. Nous devons en quelque sorte découvrir leur présence et prendre des mesures correctives immédiates. Demander aux utilisateurs d'ouvrir une console de navigateur et de prendre des captures d'écran n'est pas la meilleure option. Par conséquent, il est bon de connecter la journalisation des erreurs au projet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La signification est simple: pour chaque événement window.onerror ou chaque transition de l'exécution de code vers le bloc catch, une simple requête AJAX est adressée à une adresse de serveur spécialement allouée, dans le corps de laquelle sont placées les informations d'erreur. Ensuite, vous aurez besoin d'un outil qui avertira rapidement le support technique et les développeurs de la présence de nouvelles erreurs et vous permettra de travailler efficacement avec eux. Sentry est le plus populaire de ces outils frontaux.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le système de journalisation Sentry vous permet de collecter, grouper, présenter les erreurs en temps réel. </font><font style="vertical-align: inherit;">Il existe des assemblages pour différentes langues, y compris JavaScript. </font><font style="vertical-align: inherit;">Le projet fournit un accès payant avec des fonctionnalités avancées pour les entreprises, cependant, vous pouvez essayer ses principales fonctionnalités sur un compte de test gratuit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sentry peut être connecté à la fois directement dans le fichier HTML et dans des composants exécutés sur l'un des frameworks populaires: React, Vue, Angular, Ember et autres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour connecter les capacités de journalisation directement dans le navigateur de la section, chargez le script:</font></font><br>
<br>
<pre><code class="javascript hljs">&lt;script<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;src=«https:<span class="hljs-comment">//browser.sentry-cdn.com/5.13.0/bundle.min.js»</span><font></font>
<font></font>
&nbsp;&nbsp;&nbsp;integrity=«sha384-ePH2Cp6F+/PJbfhDWeQuXujAbpil3zowccx6grtsxOals4qYqJzCjeIa7W2UqunJ»<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;crossorigin=<span class="hljs-string">"anonymous"</span>&gt;&lt;/script&gt;</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, dans le code JS, nous initialisons:</font></font><br>
<br>
<pre><code class="javascript hljs">Sentry.init({<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">dsn</span>: <span class="hljs-string">'https://&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span><font></font>
<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout. </font><font style="vertical-align: inherit;">Si et quand une erreur se produit dans le code sous cette ligne, Sentry l'enregistrera. </font><font style="vertical-align: inherit;">Les journaux seront enregistrés même lorsque l'erreur s'est produite en raison de la faute de scripts d'autres domaines:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/678/d2e/401/678d2e401660ad74977598ab150c1b85.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a05/7b3/b45/a057b3b458602831347c02db278c98ed.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sentry a amplement l'occasion d'analyser un tableau de messages d'erreur et de configurer des notifications. </font><font style="vertical-align: inherit;">Il est également possible de regrouper les journaux d'erreurs par les versions de votre produit:</font></font><br>
<br>
<pre><code class="javascript hljs">Sentry.init({<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">dsn</span>: <span class="hljs-string">'https://&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span>,<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">release</span>: <span class="hljs-string">'2020.03.06.1'</span><font></font>
<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide de Sentry, les statistiques peuvent être utilisées pour transférer le contexte d'une erreur, par exemple, les informations client, l'empreinte digitale, le niveau d'erreur (fatal, erreur, avertissement, info, débogage) et la balise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est possible d'enregistrer les événements utilisateur dans les statistiques. </font><font style="vertical-align: inherit;">Par exemple, vous pouvez définir le suivi pour modifier la taille de la fenêtre du navigateur ou effectuer une demande AJAX. </font><font style="vertical-align: inherit;">Sentry a également son propre widget avec une fenêtre de rétroaction, qui peut être montrée à l'utilisateur en cas d'erreur. </font><font style="vertical-align: inherit;">Cela fournira des informations supplémentaires pour enquêter sur les circonstances de l'erreur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour déployer Sentry avec les frameworks, il suffit d'installer le package et de se connecter:</font></font><br>
<br>
<pre><code class="javascript hljs"># Using yarn<font></font>
<font></font>
yarn add @sentry/browser<font></font>
<font></font>
# Using npm<font></font>
<font></font>
npm install @sentry/browser</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous faisons l'initialisation dans le script principal du projet (pour React et Angular):</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Sentry <span class="hljs-keyword">from</span> «@sentry/browser»;<font></font>
<font></font>
Sentry.init({ <span class="hljs-attr">dsn</span>: <span class="hljs-string">'https://&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span> });</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour Vue et Ember, nous passons une autre ligne de configuration requise:</font></font><br>
<br>
<pre><code class="javascript hljs"># Vue<font></font>
<font></font>
Sentry.init({<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">dsn</span>: <span class="hljs-string">'&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span>,<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">integrations</span>: [<span class="hljs-keyword">new</span> Integrations.Vue({Vue, <span class="hljs-attr">attachProps</span>: <span class="hljs-literal">true</span>})],<font></font>
<font></font>
});<font></font>
<font></font>
# Ember<font></font>
<font></font>
Sentry.init({<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">dsn</span>: <span class="hljs-string">'&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span>,<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">integrations</span>: [<span class="hljs-keyword">new</span> Integrations.Ember()]<font></font>
<font></font>
});</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le package d'intégration est installé séparément:</font></font><br>
<br>
<pre><code class="javascript hljs"># Using yarn<font></font>
<font></font>
yarn add @sentry/integrations<font></font>
<font></font>
# Using npm<font></font>
<font></font>
npm install @sentry/integrations</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour éviter les conflits et la duplication d'informations lors de la connexion de plusieurs scripts dans un même projet, Sentry vous permet de créer un client distinct pour chaque initialisation de journalisation:</font></font><br>
<br>
<pre><code class="javascript hljs"><span class="hljs-keyword">import</span> { BrowserClient } <span class="hljs-keyword">from</span> «@sentry/browser»;<font></font>
<font></font>
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> BrowserClient({<font></font>
<font></font>
&nbsp;&nbsp;&nbsp;<span class="hljs-attr">dsn</span>: <span class="hljs-string">'&lt;your account key here&gt;@sentry.io/&lt;your project id here&gt;'</span>,<font></font>
<font></font>
});<font></font>
<font></font>
client.captureException(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'example'</span>));</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le site Web du projet contient une documentation détaillée avec des exemples d'utilisation: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://docs.sentry.io</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet article a été préparé avec le support de la plateforme cloud </font></font></i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mail.ru Cloud Solutions</font></font></i></a><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quoi d'autre à lire sur le sujet:</font></font><br>
<br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composants Reactable React: comment arrêter d'écrire la même chose</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comment éviter les erreurs lors du développement sur React</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> -     </a>.</li>
</ol></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr495378/index.html">Conférence DEFCON 27. Buttplug: True Penetration Testing. Partie 1</a></li>
<li><a href="../fr495380/index.html">Grand pare-feu égyptien</a></li>
<li><a href="../fr495384/index.html">Mon expérience de stage chez Microsoft Redmond et l'obtention d'une offre</a></li>
<li><a href="../fr495388/index.html">Émission de télévision des années 1970 qui est devenue un ancêtre de l'eSport</a></li>
<li><a href="../fr495390/index.html">STM32CubeMonitor mérite un essai</a></li>
<li><a href="../fr495396/index.html">Première impression de concepts</a></li>
<li><a href="../fr495398/index.html">Ro.Ri.Re</a></li>
<li><a href="../fr495400/index.html">Fonctionne avec la carte SD via l'interface SPI. Implémentation VHDL</a></li>
<li><a href="../fr495402/index.html">L'année dernière, nous avons finalement photographié un trou noir. Maintenant quoi?</a></li>
<li><a href="../fr495404/index.html">Les stocks affaissés sont-ils prometteurs? Analysons avec python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>