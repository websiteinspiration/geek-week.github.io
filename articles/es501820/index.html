<!doctype html>
<html class="no-js" lang="es">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüëß‚Äçüëß üçó üì∂ Integraci√≥n de Netflow y soluciones de monitoreo SIEM üêç üë®üèø‚Äçüöí üíÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los SIEM se han convertido en un est√°ndar de facto en el an√°lisis de eventos de seguridad y la detecci√≥n de incidentes (aunque existe cierto movimient...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Integraci√≥n de Netflow y soluciones de monitoreo SIEM</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/501820/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los SIEM se han convertido en un est√°ndar de facto en el an√°lisis de eventos de seguridad y la detecci√≥n de incidentes (aunque existe cierto movimiento para abandonar SIEM y reemplazarlos con soluciones para administrar registros con un complemento de tecnolog√≠as de aprendizaje autom√°tico), pero la efectividad de esta soluci√≥n depende de con qu√© fuentes de datos funciona. A√∫n as√≠, por lo general, los especialistas de SIEM trabajan principalmente con registros, dejando de lado una fuente de informaci√≥n tan importante como Netflow, que le permite ver algo que a menudo no entra en los registros o llega, pero es demasiado tarde. Esto plantea una serie de preguntas. ¬øPor qu√© una soluci√≥n SIEM moderna necesita soporte de Netflow? ¬øQu√© puede obtener SIEM del an√°lisis de Netflow? ¬øQu√© opci√≥n para integrar SIEM con Netflow si hay fabricantes,quienes integran el soporte de Netflow directamente en sus soluciones, y hay quienes prefieren trabajar con varios recolectores de Netflow. ¬øCu√°les son las caracter√≠sticas de trabajar con SIEM Netflow? Hablaremos de esto.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflow para detecci√≥n de amenazas</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">art√≠culo</font></a><font style="vertical-align: inherit;"> anterior</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ya he descrito las posibilidades de usar Netflow para ciberseguridad. Perm√≠tame recordarle que, a diferencia de los registros de equipos de red o tr√°fico sin procesar, Netflow es un protocolo que le permite analizar el tr√°fico por metadatos recopilados de las sesiones de red. Estos no son solo direcciones y puertos de origen y destino, sino tambi√©n tipos de mensajes y c√≥digos para ICMP, tipos de servicios IP, tipos de protocolos IP, interfaces de red, duraci√≥n de la sesi√≥n, horas de inicio y finalizaci√≥n, etc. Si los registros generalmente se generan en dispositivos terminales (por ejemplo, servidores, estaciones de trabajo y DBMS) o medios de protecci√≥n, entonces qu√© hacer en una situaci√≥n en la que los primeros no generan eventos de seguridad o no puede ponerles medios de seguridad,y estos √∫ltimos se instalan solo en el per√≠metro y no ven lo que sucede dentro de la red corporativa o departamental? Otra cosa es el equipo de red: conmutadores y enrutadores (hardware o virtuales), puntos de acceso inal√°mbrico y controladores. Se instalan en el interior y la interacci√≥n de usuarios, dispositivos, aplicaciones siempre pasa a trav√©s de ellos. ¬°Es imposible pasarlos! Al transmitir datos sobre esta interacci√≥n a Netflow (incluso Cisco ASA o Firepower lo genera), obtenemos una valiosa fuente de informaci√≥n no solo para TI, sino tambi√©n para la ciberseguridad. Cuando el equipo no comprende el protocolo de flujo, podemos utilizar exportadores especiales, soluciones de software o hardware que generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, el dispositivo Netflow Generation oque generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, Netflow Generation Appliance oque generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, Netflow Generation Appliance opuntos de acceso inal√°mbrico y controladores. Se instalan en el interior y la interacci√≥n de usuarios, dispositivos, aplicaciones siempre pasa a trav√©s de ellos. ¬°Es imposible pasarlos! Al transmitir datos sobre esta interacci√≥n a Netflow (incluso Cisco ASA o Firepower lo genera), obtenemos una valiosa fuente de informaci√≥n no solo para TI, sino tambi√©n para la ciberseguridad. Cuando el equipo no comprende el protocolo de flujo, podemos utilizar exportadores especiales, soluciones de software o hardware que generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (para Cisco, el dispositivo de generaci√≥n Netflow opuntos de acceso inal√°mbrico y controladores. Se instalan en el interior y la interacci√≥n de usuarios, dispositivos, aplicaciones siempre pasa a trav√©s de ellos. ¬°Es imposible pasarlos! Al transmitir datos sobre esta interacci√≥n a Netflow (incluso Cisco ASA o Firepower lo genera), obtenemos una valiosa fuente de informaci√≥n no solo para TI, sino tambi√©n para la ciberseguridad. Cuando los equipos no entienden el protocolo de flujo, podemos usar exportadores especiales, soluciones de software o hardware que generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (para Cisco, el dispositivo de generaci√≥n Netflow oAl transmitir datos sobre esta interacci√≥n a Netflow (incluso Cisco ASA o Firepower lo genera), obtenemos una valiosa fuente de informaci√≥n no solo para TI, sino tambi√©n para la ciberseguridad. Cuando el equipo no comprende el protocolo de flujo, podemos utilizar exportadores especiales, soluciones de software o hardware que generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, el dispositivo Netflow Generation oAl transmitir datos sobre esta interacci√≥n a Netflow (incluso Cisco ASA o Firepower lo genera), obtenemos una valiosa fuente de informaci√≥n no solo para TI, sino tambi√©n para la ciberseguridad. Cuando el equipo no comprende el protocolo de flujo, podemos utilizar exportadores especiales, soluciones de software o hardware que generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (para Cisco, el dispositivo de generaci√≥n Netflow oque generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, Netflow Generation Appliance oque generan registros de flujo para el tr√°fico que pasa a trav√©s de ellos (con Cisco, Netflow Generation Appliance o</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor de flujo Stealthwatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Los algoritmos para detectar anomal√≠as o firmas superpuestas en los flujos de Netflow, as√≠ como los m√©todos de aprendizaje autom√°tico, le permiten identificar desviaciones del comportamiento est√°ndar del tr√°fico de red, que caracterizar√° las amenazas o problemas de seguridad de la informaci√≥n con la infraestructura de TI. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vale la pena recordar que Netflow no puede decir qu√© se transmite dentro del tr√°fico de red (aunque ya existen tecnolog√≠as que le permiten reconocer las aplicaciones utilizadas y el c√≥digo malicioso por Netflow), fue desarrollado para otras tareas. </font><font style="vertical-align: inherit;">Pero puede decir qui√©n "habl√≥" y con qui√©n, c√≥mo y por cu√°nto tiempo. </font><font style="vertical-align: inherit;">A pesar de la existencia de diferentes versiones de protocolos de flujo, la mayor√≠a de ellos le permiten recopilar los siguientes datos:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Direcci√≥n IP de origen y destino</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puertos de origen y destino</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocolo</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipo de servicio</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interfaz fuente</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcas de tiempo de inicio y fin</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cantidad de informaci√≥n transmitida.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En algunas versiones, por ejemplo, en IPFIX o Netflow v9, puede extraer parte de la informaci√≥n del cuerpo de datos, lo que permite que el analizador Netflow (aut√≥nomo o integrado en SIEM) identifique las aplicaciones en ejecuci√≥n. </font><font style="vertical-align: inherit;">Toda esta informaci√≥n suele ser suficiente para detectar anomal√≠as o incluso amenazas en el tr√°fico de red.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/0g/qa/mq/0gqamq6h7orvlobxcnercgfl5os.png" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netflow y SIEM: ¬øcu√°l es la fuerza, hermano?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øQu√© sucede si el sistema de destino no genera registros o los intrusos los desactivan? </font><font style="vertical-align: inherit;">¬øQu√© hacer cuando simplemente no hay caracter√≠sticas de seguridad en el sistema de destino, porque cargan el procesador y ralentizan el sistema? </font><font style="vertical-align: inherit;">¬øQu√© hacer cuando un empleado trae su dispositivo personal que no est√° conectado a SIEM? </font><font style="vertical-align: inherit;">Todav√≠a tenemos la √∫nica fuente de informaci√≥n: el tr√°fico de red, que en cualquier caso es generado por el dispositivo objetivo. </font><font style="vertical-align: inherit;">¬øQu√© puede ayudar a identificar un Netflow "limpio" que pueda analizarse sin SIEM utilizando soluciones de An√°lisis de tr√°fico de red (NTA)? </font><font style="vertical-align: inherit;">Aqu√≠ hay una breve lista de tales amenazas y anomal√≠as:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c√≥digo malicioso, ransomware y cripto mineros</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interacci√≥n con servidores de comando</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escaneo de red</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ataques de denegaci√≥n de servicio</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuga de datos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hackear ssh o rdp</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">torrents y otras aplicaciones P2P</font></font></li>
<li>   ,   </li>
<li> </li>
<li> ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øY qu√© le dan los registros que recopila su SIEM? La capacidad de monitorear la actividad del usuario en los nodos, el acceso a los recursos, la entrada y salida de los sistemas, las alarmas de los equipos de red y las herramientas de seguridad, y mucho m√°s. La combinaci√≥n de registros y Netflow que llegan a SIEM y se analizan all√≠ le permite identificar r√°pidamente nuevas sesiones y nuevo tr√°fico desde dispositivos que han sido atacados, incluidos aquellos que omiten su per√≠metro. Al combinar estos tipos de datos, tambi√©n puede identificar caracter√≠sticas de seguridad de red configuradas incorrectamente. Netflow complementa las capacidades tradicionales de SIEM con la capacidad de detectar nuevos tipos de tr√°fico, sus r√°fagas, interacci√≥n con recursos externos e internos, fugas de datos, distribuci√≥n de c√≥digo malicioso, interacci√≥n con los servidores del equipo,encapsulaci√≥n de carga maliciosa en protocolos permitidos, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La combinaci√≥n de datos SIEM procesados ‚Äã‚Äãtradicionalmente con Netflow permite no solo ver m√°s eventos de seguridad, sino tambi√©n verlos m√°s r√°pido, reduciendo el llamado par√°metro TTD (Time-to-Detect) y, como resultado, el tiempo de respuesta. Est√° claro que el an√°lisis SIEM y Netflow pueden funcionar de manera independiente y hacer bien su trabajo, pero es la combinaci√≥n de estas dos soluciones lo que le permite lograr un efecto sin√©rgico.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cambiar el patr√≥n de comportamiento del tr√°fico puede indicar un comportamiento sospechoso o anormal. Por ejemplo, exceder el umbral para los datos cargados en Internet puede indicar una fuga. Un cambio en el tama√±o de las consultas y respuestas de DNS en comparaci√≥n con el RFC proporcionado puede caracterizar el hecho de la operaci√≥n de c√≥digo malicioso (seg√∫n las estad√≠sticas de Cisco, el 92% del malware usa DNS para recibir comandos, descargar datos o descargar actualizaciones). ¬øRecuerdas la historia con Equifax? Luego, los atacantes pudieron acceder al portal web, y luego a los servidores de bases de datos internos, cargando lentamente grandes cantidades de datos al exterior. Por separado, todos estos eventos no fueron de gran inter√©s y solo reunidos y enriquecidos con datos de Netflow, permitieron identificar incidentes de seguridad de la informaci√≥n. Este es otro caso para los sistemas de an√°lisis de Netflow,que puede detectar un comportamiento no est√°ndar tanto del portal web desde el que se frecuenta la consulta a la base de datos como de las bases de datos que de repente brindan muchos datos al portal. ya estoy</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Describi√≥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> este escenario en Habr anteriormente. SIEM, al recibir datos de Netflow, puede obtener un contexto adicional para eventos generados por IPS, ITU, proxies, antivirus, EDR, etc., para responder de manera m√°s efectiva al incidente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro ejemplo. Detecci√≥n de ataques desconocidos para los que los sistemas de detecci√≥n de intrusos no tienen firmas, debido a la correlaci√≥n de anomal√≠as de red y eventos de los hosts, as√≠ como a la activaci√≥n de disparadores. Por ejemplo, escanear 100 nodos en 3 minutos puede caracterizar la operaci√≥n de c√≥digo malicioso que expande su cabeza de puente. Un aumento en el tiempo de respuesta del servidor puede caracterizar un ataque DDoS contra √©l y, por ejemplo, una falta de coincidencia en la cantidad de informaci√≥n recibida y enviada a trav√©s del protocolo DNS puede indicar una fuga de datos. Este es un caso que ya vimos anteriormente cuando habl√© sobre encontrar una campa√±a de DNSpionage. Al mismo tiempo, puede observar que en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un caso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> analizamos solo Netflow, y en el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tambi√©n recopilamos datos de dispositivos terminales, cajas de arena, una puerta de enlace DNS, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otra √°rea donde la integraci√≥n de Netflow en SIEM puede ayudar es la conciencia situacional. Correlaci√≥n de flujos con registros, contexto, informaci√≥n de geolocalizaci√≥n, actividad del usuario, datos de reputaci√≥n. Por ejemplo, en una nota anterior, cit√© un caso con la detecci√≥n de tr√°fico interno con nodos de Ir√°n o Corea del Norte. Si no tiene contactos con estos pa√≠ses, tal vez esto sea una se√±al de c√≥digo malicioso que roba informaci√≥n o piratas inform√°ticos progubernamentales dirigidos a su empresa. Un sistema de an√°lisis de anomal√≠as de red puede hacer parte de este trabajo identificando la anomal√≠a correspondiente. Pero si tambi√©n desea comprender qu√© usuario estuvo involucrado en este incidente, necesitar√° un contexto adicional en forma de nombres de usuario de Active Directory.Netflow en s√≠ no opera con esta informaci√≥n, por lo que debemos enriquecerla con informaci√≥n de AD. Si utiliza</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , para esto solo necesita integrarlo con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ISE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que vincular√° las direcciones IP y MAC con usuarios espec√≠ficos y perfiles de dispositivos. ¬øQu√© sucede si Cisco ISE no se implementa en la red? La tarea de enriquecer Netflow con informaci√≥n del usuario es responsabilidad de SIEM.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro ejemplo. Tengo un sitio web ejecut√°ndose en mi computadora que se utiliza para varias tareas. ¬øPero cu√°ntos usuarios comunes pueden presumir de lo mismo? ¬øDe repente captura el tr√°fico inherente a la operaci√≥n de un servidor web desde una computadora de usuario? O en el segmento donde se encuentran los usuarios que trabajan en una PC con Windows, de repente ves el tr√°fico inherente al sistema operativo Linux. ¬øQuiz√°s este usuario "pr√°ctico" decidi√≥ crear una m√°quina virtual con Linux, violando as√≠ la pol√≠tica de seguridad? Y tambi√©n puede identificar utilidades para acceso remoto de esta manera (por ejemplo, RAT), criptomineros, aplicaciones en la nube o punto a punto, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si es partidario de un enfoque de proveedor √∫nico, la construcci√≥n de un sistema de seguridad basado en las soluciones de Cisco le permitir√° reducir su dependencia de SIEM: todas las soluciones de Cisco, incluidos los firewalls, la protecci√≥n de correo electr√≥nico, el sandboxing, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco AMP para</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puntos finales </font><font style="vertical-align: inherit;">y etc. puede intercambiar datos, contexto, eventos de seguridad, comandos entre ellos directamente. Pero si su infraestructura ha heredado muchas soluciones diferentes de diferentes fabricantes, entonces SIEM ser√° el enlace que ayudar√° a construir una soluci√≥n completa del zool√≥gico de diferentes productos. En cualquier caso, el an√°lisis del tr√°fico de red recolectado de la infraestructura de red existente, combinado con los datos que SIEM generalmente recolecta, expande los </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">horizontes.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La capacidad del servicio IS de ver m√°s y responder m√°s r√°pido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beneficios de usar Netflow en SIEM:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correlaci√≥n de la actividad de la red con otra informaci√≥n sobre seguridad de la informaci√≥n recopilada del nivel de aplicaciones y PC / servidores</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la capacidad de monitorear donde existen altos riesgos de violaci√≥n de las leyes de privacidad (por ejemplo, GDPR) y puede analizar solo los encabezados o metadatos del tr√°fico de red, y no su contenido</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detecci√≥n de anomal√≠as que caracterizan las primeras etapas del desarrollo de un incidente o ataques dirigidos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recopilaci√≥n y almacenamiento de diversos datos que caracterizan el incidente y los proporcionan como parte de las investigaciones de SI o la interacci√≥n con las agencias de aplicaci√≥n de la ley.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øBala de plata?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero no piense que Netflow es la bala de plata que todos han estado buscando durante tanto tiempo. Tambi√©n tiene desventajas. Por ejemplo, su procesamiento puede cargar el procesador y la memoria de equipos de red desactualizados o seleccionados incorrectamente y esto puede afectar negativamente su rendimiento y el ancho de banda de la red. Para trabajar eficazmente con Netflow, es posible que necesite su soporte de hardware o el uso de los llamados exportadores, quienes al pasar el tr√°fico a trav√©s de ellos mismos lo traducir√°n a Netflow (aquellos que han encontrado la introducci√≥n de IDS / COB en redes conmutadas, usaron las llamadas cintas o divisores para una tarea similar ) Ya he dado dos ejemplos de tales soluciones externas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor de flujo Cisco Stealthwatch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y el dispositivo Cisco Netflow Generation. </font><font style="vertical-align: inherit;">Aunque, dada la reciente modernizaci√≥n de la red, se puede suponer que sus conmutadores y enrutadores ya admiten una u otra versi√≥n de Netflow y no necesitar√° ning√∫n exportador adicional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otras caracter√≠sticas de Netflow que vale la pena conocer incluyen:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">falsos positivos que pueden asociarse con una capacitaci√≥n incorrecta o insuficiente del sistema de an√°lisis, as√≠ como con un cambio en las operaciones de TI, sobre el cual el sistema de an√°lisis a√∫n no ha sido "informado"</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disminuci√≥n del rendimiento y el impacto en el almacenamiento SIEM (hablaremos de esto a√∫n m√°s)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los metadatos recopilados a trav√©s de Netflow no siempre permiten una investigaci√≥n completa, lo que puede requerir tr√°fico sin procesar en el formato PCAP.</font></font></li>
</ul><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opciones de integraci√≥n SIEM con Netflow</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øCu√°l de los SIEM en el mercado actual trabaja con tr√°fico de red? </font><font style="vertical-align: inherit;">Debo decir que casi todo, pero de diferentes maneras y, a menudo, esto requiere una licencia paga por separado, que, a su vez, tambi√©n se divide en opciones. </font><font style="vertical-align: inherit;">Destacar√≠a tres opciones para analizar Netflow en SIEM:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">soporte integrado para Netflow en SIEM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exportadores / sensores propios para generar Netflow y transmitir a SIEM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integraci√≥n SIEM con soluciones externas de la clase Network Traffic Analysis (NTA).</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM con soporte integrado de Netflow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por ejemplo, Microfocus ArcSight, que es bastante popular en el espacio SIEM sovi√©tico, tiene soporte incorporado para Netflow. </font><font style="vertical-align: inherit;">Esta caracter√≠stica permite a SIEM correlacionar los flujos de red con otros eventos de seguridad sobre la marcha o enriquecerlos con datos de fuentes de Inteligencia de amenazas. </font><font style="vertical-align: inherit;">Sin embargo, esta opci√≥n tiene sus inconvenientes, a saber:</font></font><br>
<br>
<ul>
<li>-,         ,     .         ( , ¬´   ¬ª,   )?</li>
<li>-,  Netflow  SIEM,          Netflow    .      ?    SIEM  ,              , ,   ?   -   ¬´¬ª Netflow     ?</li>
</ul><br>
<img src="https://habrastorage.org/webt/lo/jh/ge/lojhgex6afz5whncqwvjnwb3qxo.png" alt="imagen"><br>
<br>
<ul>
<li>-,     .     ?             VPN- (      ).</li>
<li>-,    Netflow   SIEM   FPS  ?</li>
<li>,      ,  flow-    (.  ).       Netflow,          SIEM.   Netflow      ‚Äî v5,     ,  v9,      IPv6, MPLS  .     Flexible Netflow ( Netflow v9), IPFIX,    Netflow v10, sFlow, , ,     , NetStream, Jflow  ..           SIEM?</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si solo se enfrenta a la elecci√≥n de SIEM, incluya en la lista de par√°metros bajo consideraci√≥n tambi√©n el tipo de Netflow que genera su equipo. </font><font style="vertical-align: inherit;">Si ya ha comprado SIEM, entonces no tiene muchas opciones. </font><font style="vertical-align: inherit;">En este caso, debe considerar las siguientes opciones:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un analizador de anomal√≠as de red IS separado (por ejemplo, Cisco Stealthwatch), que llevar√° a cabo todo el an√°lisis por s√≠ solo y dar√° sus resultados a SIEM</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El recopilador de Netflow separado, que podr√° enviar a SIEM resumen de an√°lisis de flujos de red, y SIEM ya analizar√° estos datos.</font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øCu√°nto colgar en gramos, es decir, almacenado en bytes?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por cierto, antes de pasar a la siguiente opci√≥n para integrar Netflow con SIEM, es hora de tocar la pregunta, ¬øcu√°ntos datos de Netflow recibiremos en nuestro sistema de an√°lisis de eventos de seguridad? Para remedios o registros regulares, hay un n√∫mero considerable de ejemplos y estad√≠sticas sobre EPS (eventos por segundo). No hay muchos datos sobre FPS (flujo por segundo). El volumen promedio de Netflow es directamente proporcional a la cantidad de sockets TCP / UDP √∫nicos creados por los dispositivos cliente y servidores en su red, que pueden variar mucho de un caso a otro. Y la inclusi√≥n del muestreo (es decir, la transferencia selectiva de datos de Netflow) tambi√©n afecta la cantidad total de datos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, ¬øcu√°ntos FPS podemos generar? </font><font style="vertical-align: inherit;">Por supuesto, esto depende mucho de la situaci√≥n, pero yo dir√≠a que para una estaci√≥n de trabajo regular este n√∫mero es, en promedio, 1.5 FPS y 6 FPS en la carga m√°xima. </font><font style="vertical-align: inherit;">En otras palabras, si su red tiene 10 mil nodos y el FPS promedio para cada uno de ellos es 4, entonces la red genera aproximadamente 40 mil flujos por segundo. </font><font style="vertical-align: inherit;">¬øPorque tanto? </font><font style="vertical-align: inherit;">Como escrib√≠ anteriormente, depende de cu√°ntas conexiones √∫nicas generen sus aplicaciones o su red. </font><font style="vertical-align: inherit;">Hoy en d√≠a, hay muchos programas "habladores" que se ejecutan en las computadoras de los usuarios, que cargan activamente contenido de Internet, como los navegadores, o constantemente buscan actualizaciones, como los antivirus. </font><font style="vertical-align: inherit;">Aqu√≠ hay una lista de muestra de software y servicios que aumentan activamente el n√∫mero de FPS en la red:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adobe, antivirus, Java</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skype</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clientes de correo electr√≥nico</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netbios</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">navegadores</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicaciones orientadas a la alimentaci√≥n (Twitter, noticias, Telegram, etc.).</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una respuesta m√°s precisa le indicar√° el an√°lisis de Netflow en los segmentos de red que necesita, que se realiza con solo un comando en un dispositivo de red (seg√∫n el fabricante).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La longitud de un registro de Netflow v5 es de 48 bytes. Para la novena versi√≥n de Netflow, no existe una cifra tan exacta, ya que esta versi√≥n le permite describir lo que incluir√° en el registro y, por lo tanto, su longitud puede variar mucho. Pero si, m√°s o menos, tomamos 100 bytes para la longitud promedio de un registro de flujo (y cada paquete de red puede generar 20-30 flujos), entonces podemos estimar cu√°ntos datos se generar√°n y transferir√°n a SIEM. Al mismo tiempo, el volumen de almacenamiento SIEM para estos datos puede ser mayor (esto depender√° del formato de almacenamiento, indexaci√≥n, compresi√≥n, copia de seguridad, etc.). Por cierto, al calcular la cantidad de FPS, recuerde que en el marco de un ataque DDoS, el concepto de "FPS promedio" no funciona, ya que cada conexi√≥n, cada paquete TCP SYN ser√° una secuencia separada, y con un poderoso ataque DDoS, la cantidad de FPS en tu pico ser√° muy grande.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mencion√© anteriormente que en el caso de transferir Netflow al SIEM central, tendr√° que "manejarlo" a trav√©s de Internet. </font><font style="vertical-align: inherit;">No piense que la generaci√≥n de Netflow crear√° una gran carga en la red y reducir√° su ancho de banda. </font><font style="vertical-align: inherit;">Seg√∫n nuestra investigaci√≥n, dado que solo se transmite informaci√≥n de encabezado y telemetr√≠a adicional en Netflow, y no todo el cuerpo de datos, la carga aumentar√° en aproximadamente un 1-2% a la interfaz desde la que se exporta la telemetr√≠a de red (de hecho, utilizando muestreo y versiones de protocolo modernas Netflow este valor puede ser incluso menor en un orden de magnitud y variar al nivel de 0.1%).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recolectar no puede ser analizado</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero supongamos que a√∫n decidi√≥ obtener un Netflow sin procesar en su SIEM. Este escenario tiene otro matiz. Es muy importante comprender que la disponibilidad del soporte de Netflow en SIEM no es suficiente; Es extremadamente importante poder manejar este Netflow desde un punto de vista de seguridad, es decir, tener reglas para analizar y correlacionar los flujos de Netflow integrados y actualizados constantemente para nuevos tipos de ataques. Digamos que Netflow nos da esta imagen:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/b6/up/na/b6upnaoghurwuh9pns2lv0cqpya.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vemos un aumento en el protocolo SSH. De hecho, ahora estamos viendo la misma imagen con ataques al protocolo RDP. Esto es adivinar la contrase√±a. Pero esto se puede revelar solo con la condici√≥n de que tengamos una regla correspondiente, que de una serie de flujos de Netflow recopilar√° un evento "Contrase√±a coincidente". Entonces podemos decir que SIEM tiene soporte incorporado de Netflow y puede analizarlo desde un punto de vista de seguridad. Por lo tanto, al elegir este camino, debe preguntarle al vendedor qu√© puede analizar SIEM en Netflow "fuera de la caja" y, si nada, cu√°n laborioso es el proceso de describir sus propios procesadores Netflow y ¬øtiene alg√∫n especialista que lo haga? Somos conscientes de que escribir un conector en Netflow no es tan dif√≠cil, a diferencia de las reglas para procesarlo e identificar anomal√≠as en √©l que requieren un trabajo constante.Se trata de copiar el motor de otra persona para su IDS (Snort, Zeek o Suricata), pero no poder escribir firmas para ataques y exploits recientemente descubiertos de forma continua. En el ejemplo anterior, el sistema mismo deber√≠a reconocer un aumento en el tr√°fico en SSH y decirse que estos son ataques de "adivinaci√≥n de contrase√±as" en SSH (ya sea Telnet, RDP o FTP). Podr√≠a verse as√≠ (por ejemplo</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<br>
<img src="https://habrastorage.org/webt/fc/h8/--/fch8--okgcjqtnsxzuufafzja28.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y luego puede investigar este incidente a un nivel m√°s profundo, utilizando las capacidades proporcionadas por SIEM o una herramienta de an√°lisis de Netflow separada. </font><font style="vertical-align: inherit;">Sin la capacidad de "comprender" Netflow en t√©rminos de seguridad de la informaci√≥n, la presencia de soporte incorporado para Netflow es una ventaja dudosa para SIEM.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/9f/4z/b-/9f4zb-x6zrz4-f_rknuozlv0n5s.png" alt="imagen"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIEM con su propio exportador de Netflow</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Otro jugador en el mercado SIEM, LogRhythm, a su vez, ofrece un exportador adicional de transmisiones de NetMon, que puede ser √∫til en una infraestructura distribuida, as√≠ como en una red cuyo equipo no admite Netflow y requiere un generador de Netflow separado para el tr√°fico de red que pasa a trav√©s de √©l. De hecho, en esta realizaci√≥n, el fabricante SIEM asume las funciones de los proveedores de redes, desarrollando una soluci√≥n para generar Netflow y reduciendo la carga en SIEM, lo que elimina la necesidad de procesar y almacenar Netflow sin procesar. La situaci√≥n es similar al soporte de SSL Offload en muchos firewalls de nueva generaci√≥n. S√≠, existe all√≠, pero con un intercambio intensivo de tr√°fico HTTPS, la carga adicional en NGFW conduce a una disminuci√≥n significativa en su rendimiento.Por lo tanto, en arquitecturas muy cargadas, generalmente se asigna un dispositivo separado para esta tarea, que asume la tarea de descifrar el tr√°fico SSL y luego devolverlo a NGFW. Lo mismo sucede con el procesamiento de SIEM Netflow en este escenario.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/yl/x6/z0/ylx6z0lpfhuepced9wmgjjodgmq.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Est√° claro que este escenario tambi√©n tiene un inconveniente: un aumento en el precio final de la soluci√≥n, ya que adem√°s de pagar licencias por la cantidad de FPS analizados, tambi√©n deber√° pagar sensores adicionales que pasar√°n el tr√°fico a trav√©s de s√≠ mismos y generar√°n Netflow. Adem√°s, deber√° realizar cambios en la arquitectura de red, pero esto tendr√° que hacerse de todos modos, por lo que lo llamar√≠a no un inconveniente, sino una caracter√≠stica de este escenario. Si su equipo de red no sabe c√≥mo generar Netflow y desea analizar las anomal√≠as de la red, entonces la √∫nica opci√≥n para hacerlo es utilizar sensores separados. La √∫nica pregunta es qu√© ser√° m√°s barato: compre sensores del fabricante SIEM o use sensores de fabricantes de redes (por ejemplo, Cisco Netflow Generation Appliance) o desarrolladores de herramientas de an√°lisis de anomal√≠as de red (por ejemplo,Sensor de flujo de Cisco Stealthwatch Enterprise). En esta opci√≥n, tambi√©n vale la pena averiguar si SIEM puede analizar Netflow desde el punto de vista de la seguridad de la informaci√≥n, o ¬øsolo tiene conectores en forma de exportadores / sensores extra√≠dos (por lo general puede)?</font></font><br>
<br>
<h3>SIEM,   NTA</h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La tercera opci√≥n, la integraci√≥n con soluciones de clase NTA, es bastante obvia, ya que, de hecho, NTA es el mismo generador de eventos de seguridad que NGFW, antivirus, esc√°ner de seguridad, IPS, etc. Sin embargo, este escenario es interesante porque combina las dos herramientas de an√°lisis de seguridad que tiene, pero puede trabajar con ellas por separado. NTA le permite realizar un an√°lisis en profundidad del tr√°fico de red, detectar c√≥digos maliciosos, ataques DDoS, fugas de informaci√≥n, monitorear usuarios remotos ... Al mismo tiempo, una buena herramienta de an√°lisis de tr√°fico de red tambi√©n le permite usar sensores separados en aquellos segmentos donde el equipo de red no es compatible con Netflow o sus La inclusi√≥n conduce a un aumento de la carga en el equipo de red. NTA en este escenario le permite agregar, procesar, analizar Netflow (en sus diferentes versiones),y en SIEM solo dan alarmas sobre el hecho de la detecci√≥n de una u otra actividad maliciosa. Obviamente, esta opci√≥n tambi√©n tiene sentido cuando usted o su personal de TI ya tienen una soluci√≥n de clase NTA para la resoluci√≥n de problemas de red y tambi√©n se puede usar para tareas de seguridad de red. O cuando, por el contrario, desea compartir los gastos de la soluci√≥n NTA con sus networkers, quienes la usar√°n para sus tareas y usted para las suyas.qui√©n lo usar√° para sus tareas y usted para las suyas.qui√©n lo usar√° para sus tareas y usted para las suyas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La desventaja de esta opci√≥n es el costo adicional de una soluci√≥n de clase NTA, as√≠ como la necesidad de una doble capacitaci√≥n de especialistas en los conceptos b√°sicos para trabajar con dos soluciones diferentes. Pero, por otro lado, una soluci√≥n separada para analizar el tr√°fico de red permitir√° realizar investigaciones de incidentes m√°s profundas que con un solo SIEM con soporte incorporado de Netflow y aplicaciones m√°s flexibles que con el fabricante SIEM que tiene sensores Netflow separados. Pero vale la pena recordar que cuando hablamos de una soluci√≥n separada de la clase NTA, me refiero a la soluci√≥n de seguridad, y no solo a una herramienta para analizar el tr√°fico de red o monitorear el rendimiento de la red. Por ejemplo, el SolarWinds NTA ya mencionado anteriormente analiza bien el tr√°fico de la red para soportar las tareas de TI, pero lo hace muy mal por motivos de seguridad de la informaci√≥n.Lo mismo ocurre con 5View de InfoVista o Visual TruView de Fluke. Y el mismo, por ejemplo,</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede ser utilizado por ambos en la empresa.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ge/dd/jz/geddjzdyxryg6go3vpqkhswzmdq.jpeg" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© buscar al elegir?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al elegir una soluci√≥n NTA con fines de seguridad, as√≠ como al analizar exportadores / sensores proporcionados por SIEM o proveedores de SIEM con soporte de Netflow, recomendar√≠a prestar atenci√≥n a los siguientes criterios:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipos de actividad maliciosa detectable. </font><font style="vertical-align: inherit;">Usted toma una herramienta para monitorear la seguridad de la informaci√≥n; </font><font style="vertical-align: inherit;">Es l√≥gico suponer que debe ser capaz de identificar varias anomal√≠as y amenazas relacionadas con la seguridad de la informaci√≥n "fuera de la caja". </font><font style="vertical-align: inherit;">Adem√°s, este par√°metro se divide en tres partes: algoritmos integrados para detectar varios tipos de amenazas de seguridad de la informaci√≥n, escribir manejadores / reglas personalizadas y admitir fuentes externas de Inteligencia de amenazas para enriquecer los flujos analizados con datos sobre las amenazas.</font></font></li>
<li>  Netflow. ,      ,            .</li>
<li>.     ,     1  (   FPS)?     60  FPS,  NTA   40 ,       ,      ,   , ,  80  FPS.</li>
<li> . , flat, ‚Ä¶        ,          . ,  .    .  ,       (, ,  Argus, Fluke, Plixer, Riverbed  SolarWinds),   ,      .             ,       .           ,  ;     ,       .      , ,  Cisco Stealthwatch.</li>
<li> .         ,      ,      ,     ,     .           ‚Äî     NTA.     ,  Cisco    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>   nfdump  OSU FlowTools      Lancope,           .</li>
<li>   .   ,                -    .       :<br>
<br>
<ul>
<li>  /</li>
<li> flow cache (   cash flow :-)</li>
<li>   .   MAC-,  VLAN,  MPLS,  TCP, , ,       ,     ,       (  IPFIX  ).</li>
</ul></li>
<li>   .        Netflow  SIEM,    SIEM  NTA  .  , ,     (,   )  REST API, syslog  ..</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si se tratara de qu√© elegir, independientemente de SIEM, tambi√©n recomendar√≠a mirar hacia las oportunidades de b√∫squeda de amenazas que ofrece la soluci√≥n elegida. </font><font style="vertical-align: inherit;">Pero dado que el tema de la nota se eligi√≥ un poco diferente, no prestaremos atenci√≥n a este aspecto ahora.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problema de precio</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si observa estas tres opciones desde el punto de vista de su costo, la tercera opci√≥n resultar√° ser la m√°s costosa desde el punto de vista de los gastos de capital (sujeto a las mismas capacidades para el an√°lisis de Netflow en los tres escenarios). Es entendible. Adem√°s del costo de SIEM, necesitar√° una soluci√≥n separada para analizar el tr√°fico de red, que consistir√° al menos en un sistema de control y el n√∫mero requerido de recolectores que recolectan Netflow de varios exportadores / sensores. Por otro lado, no importa cu√°nto expanda la cobertura de su red con nuevos exportadores / sensores, no afectar√° el costo de SIEM y la infraestructura para ello, ya que funcionar√° con alarmas ya procesadas, y no con flujos de flujo Netflow ‚Äúsin procesar‚Äù, que (se√±ales) ser√°n varios √≥rdenes de magnitud menos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La primera opci√≥n parece la m√°s atractiva desde el punto de vista de su precio, ya que no tenemos que pagar m√°s por la capacitaci√≥n de analistas y administradores de NTA, o por exportadores / sensores adicionales; saber, transferir flujos de Netflow a SIEM y todo. Sin embargo, el costo de la infraestructura para SIEM aumentar√° significativamente, ya que tendr√° que almacenar flujos de Netflow sin procesar, lo que requerir√° expandir su almacenamiento existente. La segunda opci√≥n es intermedia entre los dos extremos, tanto en t√©rminos de capacidades de an√°lisis de Netflow como en t√©rminos de costo. En cualquier caso, en las dos primeras opciones, vale la pena consultar con el fabricante de SIEM el costo total de propiedad de la soluci√≥n en funci√≥n de los desaf√≠os, as√≠ como el FPS actual y esperado y, como resultado, los cambios en el costo de las licencias de SIEM y el almacenamiento para √©l. Toma por ejemploLogRhythm y su subsistema para el an√°lisis de Netflow. Hay al menos tres opciones para su implementaci√≥n y, como consecuencia, la fijaci√≥n de precios. La opci√≥n m√°s joven, Freemium solo puede enviar alarmas a SIEM, el ancho de banda no puede exceder 1 GB / s, la capacidad de almacenamiento es de solo 1 GB (esto es aproximadamente un d√≠a de almacenamiento de Netflow sin muestreo), el per√≠odo de almacenamiento del √≠ndice no es m√°s de 3 d√≠as, y no hay correlaci√≥n con fuentes de datos adicionales, y el soporte funciona solo en l√≠nea y a trav√©s de la comunidad. En la pr√≥xima versi√≥n, NetMon, los indicadores son mejores (ancho de banda de hasta 10 GB / s para todos los exportadores, el almacenamiento es ilimitado, el √≠ndice se almacena hasta por un mes, pero tampoco hay correlaci√≥n con otras fuentes). Y solo en la versi√≥n premium de NetworkXDR no tiene restricciones, pero se destaca como "un kil√≥metro de carreteras de Mosc√∫", es decir, no es barato.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En uno de los proyectos, nos enfrentamos con el hecho de que con un volumen diario de telemetr√≠a de red de 1 TB y enviarlo a SIEM con soporte integrado de Netflow, el costo total de la soluci√≥n fue de aproximadamente 600 mil d√≥lares estadounidenses (incluso antes del pr√≥ximo salto en el curso). Al mismo tiempo, parte de estos datos permanecieron sin procesar debido a la falta de reglas apropiadas en el SIEM y duplicados. El uso de una soluci√≥n NTA separada (en nuestro caso fue </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) condujo a una reducci√≥n del 80% en el volumen de datos transferidos a SIEM, y el costo de la soluci√≥n se redujo a 99 mil d√≥lares estadounidenses. Las matem√°ticas pueden diferir de un proyecto a otro, pero notamos que cuanto m√°s Netflow necesitemos procesar, m√°s costosa ser√° la infraestructura de SIEM para procesarla. ¬øPorqu√© es eso?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Veamos un ejemplo. Cuando un usuario se conecta al servidor, desde el punto de vista del an√°lisis cl√°sico de eventos de seguridad de la informaci√≥n, tratamos, condicionalmente, con un solo evento que "eliminamos" del servidor, envi√°ndolo, por ejemplo, a trav√©s de syslog a SIEM (de hecho, habr√° dos eventos: un intento conexi√≥n y su resultado). Si este evento se descompone en componentes de red, veremos que habr√° un orden de magnitud m√°s hilos generados. Por ejemplo, el n√∫mero promedio de "salto" (salto) desde el cliente al servidor es 5-6 en la red promedio. Cada conmutador o enrutador a trav√©s del cual la solicitud pasa del cliente al lado del servidor genera sus entradas de Netflow que describen el tr√°fico que pasa. Adem√°s, esto se hace para cada direcci√≥n de la sesi√≥n (solicitud y respuesta) por separado. Resulta que all√≠,donde solo se generaron 1-2 eventos a nivel de aplicaci√≥n, los flujos de Netflow requirieron al menos 10 veces m√°s (en realidad a√∫n m√°s, ya que un paquete de red genera alrededor de 20-30 flujos de Netflow). Y no solo tendremos que pagar por todas estas docenas de hilos (aunque el evento a√∫n es uno) y asignar espacio para su almacenamiento. Entonces, SIEM tambi√©n tendr√° que procesarlos, eliminar duplicados, combinar flujos multidireccionales dentro de una sesi√≥n y solo luego correlacionar estos datos con otros eventos. Por lo tanto, el costo total de una soluci√≥n aparentemente obvia puede ser mayor que en el caso de un exportador de Netflow separado o una soluci√≥n de an√°lisis de anomal√≠as de red independiente integrada con SIEM.entonces un paquete de red genera alrededor de 20-30 flujos de Netflow). Y no solo tendremos que pagar por todas estas docenas de hilos (aunque el evento a√∫n es uno) y asignar espacio para su almacenamiento. Entonces, SIEM tambi√©n tendr√° que procesarlos, eliminar duplicados, combinar flujos multidireccionales dentro de una sesi√≥n y solo luego correlacionar estos datos con otros eventos. Por lo tanto, el costo total de una soluci√≥n aparentemente obvia puede ser mayor que en el caso de un exportador de Netflow separado o una soluci√≥n de an√°lisis de anomal√≠as de red independiente integrada con SIEM.entonces un paquete de red genera alrededor de 20-30 flujos de Netflow). Y no solo tendremos que pagar por todas estas docenas de hilos (aunque el evento a√∫n es uno) y asignar espacio para su almacenamiento. Entonces, SIEM tambi√©n tendr√° que procesarlos, eliminar duplicados, combinar flujos multidireccionales dentro de una sesi√≥n y solo luego correlacionar estos datos con otros eventos. Por lo tanto, el costo total de una soluci√≥n aparentemente obvia puede ser mayor que en el caso de un exportador de Netflow separado o una soluci√≥n de an√°lisis de anomal√≠as de red independiente integrada con SIEM.para combinar flujos multidireccionales dentro de una sesi√≥n y solo entonces correlacionar estos datos con otros eventos. Por lo tanto, el costo total de una soluci√≥n aparentemente obvia puede ser mayor que en el caso de un exportador de Netflow separado o una soluci√≥n de an√°lisis de anomal√≠as de red independiente integrada con SIEM.para combinar flujos multidireccionales dentro de una sesi√≥n y solo entonces correlacionar estos datos con otros eventos. Por lo tanto, el costo total de una soluci√≥n aparentemente obvia puede ser mayor que en el caso de un exportador de Netflow separado o una soluci√≥n de an√°lisis de anomal√≠as de red independiente integrada con SIEM.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y estos analizadores externos de Netflow pueden usarse en uno de dos escenarios. El primero es la transferencia a SIEM de telemetr√≠a optimizada, libre de repeticiones (deduplicado), combinando flujos multidireccionales. Seg√∫n nuestra experiencia (y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede funcionar en este modo), puedo decir que esto reduce seis veces el volumen de telemetr√≠a transmitida a SIEM, que, en este escenario, a√∫n deber√≠a poder analizar Netflow desde un punto de vista de seguridad.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/dl/kp/ul/dlkpul7r3u12fhxu_-fzcdt5qqs.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo escenario supone que todo el procesamiento se lleva a cabo en una soluci√≥n de la clase NTA, y solo las alarmas recibidas como resultado del procesamiento de Netflow se reciben en SIEM. </font><font style="vertical-align: inherit;">Esta opci√≥n reduce a√∫n m√°s datos enviados a SIEM, reduciendo el costo de sus licencias e infraestructura. </font><font style="vertical-align: inherit;">S√≠, y SIEM ya no es necesario para poder analizar Netflow en bruto, lo que ampl√≠a las posibilidades de elegir herramientas para analizar eventos de seguridad de la informaci√≥n.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ub/su/mb/ubsumbhkpbgb2zqgn9qfwdzmd04.png" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øHay alguna alternativa?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de examinar las opciones para usar Netflow en SIEM para detectar m√°s eventos de seguridad que sin Netflow, veamos posibles alternativas. </font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas de diagn√≥stico de red</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede intentar usar las herramientas de diagn√≥stico de red utilizadas para evaluar el ancho de banda de la red, la disponibilidad de nodos y segmentos internos, cargas m√°ximas, etc. </font><font style="vertical-align: inherit;">Por ejemplo, SolarWinds NetFlow Traffic Analyzer. </font><font style="vertical-align: inherit;">Estas soluciones no est√°n dise√±adas para detectar anomal√≠as y amenazas de IS, pero se pueden usar para transferir informaci√≥n de flujo a SIEM, que puede analizar Netflow. </font><font style="vertical-align: inherit;">Esto cargar√° SIEM, como describ√≠ anteriormente, y ¬øtiene que decidir si est√° listo para esto? </font><font style="vertical-align: inherit;">Es cierto que vale la pena aclarar primero si el analizador de red puede enviar datos de Netflow a sistemas externos. </font><font style="vertical-align: inherit;">A veces solo pueden dar estad√≠sticas resumidas o generar alarmas, lo que claramente no es suficiente para las tareas de IS.</font></font><br>
<br>
<img src="https://habrastorage.org/webt/h8/yk/-s/h8yk-sjxv2lrquymay28nbqd5ui.jpeg" alt="imagen"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistemas de detecci√≥n de intrusos y NGFW</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Network IPS y NGFW son otra alternativa. Pueden mirar dentro del tr√°fico de red y pueden detectar muchas amenazas a trav√©s de un mecanismo de inspecci√≥n de red profunda ... pero en el per√≠metro. A√∫n as√≠, generalmente NGFW e IPS se colocan en el borde de la red corporativa e Internet y solo ven lo que pasa a trav√©s de ellos. Instalar estos dispositivos, "de hierro" o virtuales, en todos los lugares que le interesen ser√° demasiado costoso y, en algunos casos, t√©cnicamente imposible. Hablando sobre el borde o el per√≠metro, vale la pena recordar que la interfaz entre el centro de datos corporativo y los segmentos de usuarios tambi√©n es el borde. Y la uni√≥n entre la red corporativa e industrial, tambi√©n. Pero, en cualquier caso, la instalaci√≥n de sensores IPS o NGFW adicionales puede afectar su billetera dolorosamente, mientras que Netflow se recolectar√° de los equipos de red ya comprados e implementados.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas de investigaci√≥n de incidentes de red</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las soluciones de clase de Network Forensics Tool (NFT) le permiten almacenar, procesar y analizar el tr√°fico de red para investigar incidentes. </font><font style="vertical-align: inherit;">Pero hay una diferencia significativa entre este tipo de soluci√≥n y NTA: NFT funciona con una copia completa del tr√°fico, es decir, generalmente con archivos PCAP y NTA con registros al respecto. </font><font style="vertical-align: inherit;">Y si las soluciones de an√°lisis de Netflow funcionan casi en tiempo real, entonces NFT, con un retraso significativo. </font><font style="vertical-align: inherit;">Adem√°s, cualquier soluci√≥n que funcione con PCAP (o de otra manera para capturar y guardar una copia de todo el tr√°fico de red) se encontrar√° con el problema de un lugar para almacenar todos los datos recopilados.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Imagine que tiene un puerto en un dispositivo de red de 1 Gb / s. Con una longitud de paquete de 64 bytes, este puerto podr√° pasar a trav√©s de 1953125 paquetes por segundo, y con una longitud de 1500 bytes - 83,333 paquetes. Es decir, dependiendo de la longitud del paquete (y esto depende de las aplicaciones en la red), tendremos de aproximadamente 80 mil a 2 millones de paquetes por segundo, que tendremos que guardar. En un d√≠a, dicho puerto permitir√° 86400 Gbit / so casi 11 TB. Casi 4 PB se ejecutar√°n durante el a√±o, y esto es solo para un puerto, del cual podemos tener miles y decenas de miles en nuestra red. Incluso el almacenamiento selectivo del tr√°fico no facilitar√° en gran medida nuestras vidas. Por lo tanto, se necesitan soluciones de clase NFT, pero no pueden reemplazar a los analizadores de Netflow. Estas son herramientas que resuelven diferentes tareas: monitoreo e investigaci√≥n de incidentes.Por lo general, estas soluciones funcionan en pares: Netflow nos permite identificar incidentes y NFT ya recopila datos detallados sobre ellos en forma de capturar todo el tr√°fico de red.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero existe SIEM con NFT, por ejemplo, IBM QRadar Incident Forensics o RSA Security Analytics, que le permite trabajar con una copia completa del tr√°fico de red y todos los metadatos de Netflow estar√°n disponibles autom√°ticamente en SIEM</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"¬°S√≠, lo hay! Adem√°s, la ventaja de esta soluci√≥n es la posibilidad de reconstruir todas las sesiones de red de inter√©s y visualizarlas, lo que puede facilitar la investigaci√≥n de incidentes. Este SIEM le permite tomar el lugar del atacante y ver todo lo que ve. Pero esta ventaja est√° oculta y un serio inconveniente que mencion√© anteriormente es que almacenar una copia completa del tr√°fico de red requiere un almacenamiento grande, no tan grande que puede costar como un SIEM separado, o incluso m√°s (m√°s que almacenar incluso solo Netflow sin procesar Es posible que deba elegir qu√© sesiones espec√≠ficas guardar para ahorrar espacio, y esto puede conducir a la p√©rdida de tr√°fico. Adem√°s, en caso de cumplir con los requisitos legales para almacenar datos relacionados con incidentes,Tendr√° que romperlos o pagar dinero extra por el almacenamiento. Otra caracter√≠stica de esta soluci√≥n es la necesidad de guardar el tr√°fico que ya ha sido descifrado en SIEM, lo que significa que deber√° revisar la arquitectura de su sistema de monitoreo para poder descifrar el tr√°fico y enviarlo a SIEM. Y no olvide que tales soluciones a√∫n se centran en realizar investigaciones, lo que requiere personal calificado, y no en detectar anomal√≠as y amenazas utilizando algoritmos listos para usar.sin embargo, tales decisiones se centran en realizar investigaciones, lo que requiere personal calificado, y no en detectar anomal√≠as y amenazas utilizando algoritmos listos para usar.sin embargo, tales decisiones se centran en realizar investigaciones, lo que requiere personal calificado, y no en detectar anomal√≠as y amenazas utilizando algoritmos listos para usar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este escenario, a√∫n mirar√≠a el an√°lisis inicial del tr√°fico de red usando Netflow, y solo entonces, para los eventos e incidentes que me interesen, permitir√≠a el registro del tr√°fico de red. </font><font style="vertical-align: inherit;">Esto ahorrar√° y no gastar√° recursos en el almacenamiento de "todo".</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, para resumir brevemente. Netflow es una fuente valiosa de datos para monitorear la seguridad de las redes corporativas y departamentales, a menudo la √∫nica que se puede recopilar y en funci√≥n de la cual puede tomar decisiones sobre la presencia o ausencia de amenazas en su entorno. En principio, Netflow tambi√©n se puede analizar de forma independiente utilizando soluciones de clase NTA, que, con una gran base de reglas y algoritmos para detectar actividad maliciosa y anormal, pueden detectar incidentes r√°pidamente y responder a ellos. La integraci√≥n de Netflow con los datos recopilados por SIEM nos brinda mucho m√°s. SIEM comienza a ver lo que no ha visto antes y lo ve mucho antes de que podamos ser perjudicados. Al mismo tiempo, no necesitamos realizar cambios importantes en la infraestructura de monitoreo existente, ya que ya tenemos equipos de red,- solo necesita redirigir Netflow a SIEM, directamente o mediante soluciones intermedias. Habilitar Netflow tambi√©n me permite lograr una victoria peque√±a pero r√°pida: casi todos nuestros pilotos de soluciones</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco Stealthwatch Enterprise</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> termina con el hecho de que detectamos ciertas infracciones de las pol√≠ticas de IS que el servicio de IS no hab√≠a visto anteriormente. </font><font style="vertical-align: inherit;">Netflow les permiti√≥ ser vistos, y su integraci√≥n con SIEM, para obtener un efecto sin√©rgico de las herramientas de monitoreo de red aplicadas y el sistema de actividad.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es501806/index.html">ACS: problemas, soluciones y gesti√≥n de riesgos de seguridad</a></li>
<li><a href="../es501808/index.html">La lista de cambios en D 2.092. Pr√©stamo Pr√©stamo</a></li>
<li><a href="../es501810/index.html">Disparadores 3D geniales en una computadora port√°til antigua: una prueba de la plataforma de juegos en la nube GFN.RU</a></li>
<li><a href="../es501812/index.html">Python Telegram Pagination Bot</a></li>
<li><a href="../es501814/index.html">Cambios de COVID: historias de miembros de StartupDrive que han cambiado y se han fortalecido durante una pandemia</a></li>
<li><a href="../es501822/index.html">Ingeniero de tercera generaci√≥n</a></li>
<li><a href="../es501824/index.html">Prepar√°ndose para un hackathon en casa</a></li>
<li><a href="../es501826/index.html">Sobre fundadores ambiciosos o c√≥mo intent√© recaudar inversiones para una startup</a></li>
<li><a href="../es501828/index.html">Unreal Engine 5 establece el list√≥n para el realismo de los juegos</a></li>
<li><a href="../es501830/index.html">Portamos el proyecto Angular en ESLint, con Prettier, Husky y lint-staged</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>