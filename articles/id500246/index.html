<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇🏽 🍍 😿 Melindungi dan Meretas Xbox 360 (Bagian 3) 🤜🏼 🍬 👶🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada tahun 2011, 6 tahun setelah rilis konsol game Xbox 360, para peneliti menemukan fakta yang menarik - jika sinyal "0" dikirim ke output RESET dari...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Melindungi dan Meretas Xbox 360 (Bagian 3)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/500246/"><img src="https://habrastorage.org/webt/ly/33/lc/ly33lcab4l10ezi7uwxcjouyzw8.jpeg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahun 2011, 6 tahun setelah rilis konsol game Xbox 360, para peneliti menemukan fakta yang menarik - jika sinyal "0" dikirim ke output RESET dari prosesor pusat untuk waktu yang sangat singkat, prosesor tidak akan mengatur ulang statusnya (sebagaimana mestinya), tetapi sebaliknya ubah perilaku Anda! </font><font style="vertical-align: inherit;">Berdasarkan "fitur" ini, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset Glitch Hack (RGH)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dikembangkan </font><font style="vertical-align: inherit;">, dengan bantuan yang memungkinkan untuk sepenuhnya mengkompromikan perlindungan Xbox 360, menjalankan kode yang tidak ditandatangani, dengan demikian membuka cara untuk meretas sistem itu sendiri dan mengalahkan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">drive DG-16D5S yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “tidak dapat dipecahkan” </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat lebih dekat bagaimana RGH bekerja, bagaimana para pengembang mencoba untuk menambal lubang, dan bagaimana tambalan ini dapat berkeliling!</font></font><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa itu serangan kesalahan?</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prosesornya sangat bodoh, tidak peduli apa yang dikatakan pemasar. </font><font style="vertical-align: inherit;">Semua kode tingkat tinggi yang ditulis oleh programmer dikurangi menjadi eksekusi perintah sederhana - aritmatika dengan angka, data bergerak, lompatan bersyarat dan tanpa syarat. </font><font style="vertical-align: inherit;">Diasumsikan bahwa prosesor selalu menjalankan perintah ini tanpa kesalahan, dan hasilnya sesuai dengan dokumentasi.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/ae/ik/aeaeiktfaf_phbyprnjmqmwu0y4.png"></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memang, kompilasi kodenya</font></font><br>
<pre><code class="cpp hljs">i = i + <span class="hljs-number">2</span>;</code></pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda mengandalkan fakta bahwa nilai variabel saya akan meningkat tepat 2, bahkan tanpa menyadari bagaimana bisa sebaliknya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Serangan Glitch melanggar kepercayaan diri ini - tujuan mereka adalah untuk memastikan bahwa prosesor "bermasalah" dan berperilaku salah. </font><font style="vertical-align: inherit;">Ada beberapa cara untuk "menyalahkan" prosesor, misalnya:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tarik tegangan CPU</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk memberikan dorongan ekstra ke frekuensi referensi CPU</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Bersinar" pada persen radiasi</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada perangkat khusus untuk melakukan serangan seperti itu - misalnya, ChipWhisperer menawarkan berbagai serangan dalam frekuensi dan daya:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yc/uy/bu/ycuybuxustoyjxpu590edtbyjz0.jpeg" width="550"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus Xbox 360, "kesalahan" terjadi sebagai akibat dari paparan ke garis RESET. </font><font style="vertical-align: inherit;">Prosesor memulai prosedur reset, tetapi karena durasi sinyal yang sangat singkat, prosesor tidak punya waktu untuk menyelesaikannya dan terus bekerja seolah-olah tidak ada yang terjadi. </font><font style="vertical-align: inherit;">Tetapi hanya untuk momen singkat ini, ketika sinyal RESET aktif, perilakunya berubah!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prosesor kesalahan</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlindungan Xbox 360 bertumpu pada bootloader yang saling mengecek dalam satu rantai. Pada akhirnya, verifikasi pada setiap tahap datang ke memanggil fungsi membandingkan jumlah hash dengan "pola". Saat itulah mereka menerapkan serangan kesalahan, memaksa prosesor untuk mengabaikan ketidakcocokan. Impuls ke saluran RESET segera setelah memanggil prosedur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memaksa prosesor untuk "pergi" ke cabang lain dan terus memuat, bahkan jika jumlah hash salah:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/8a/i7/e68ai7t_wy0-har4u49gddcfwh4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tempat terbaik untuk menyerang ditemukan di bootloader tahap kedua, "CB". </font><font style="vertical-align: inherit;">Tahap-tahap selanjutnya lebih sulit untuk diserang (dan mudah diperbaiki), tetapi pada tahap pertama pemuatan (“1BL”, ROM) serangan gagal karena konstruksi yang sedikit berbeda dari kode program. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedengarannya sederhana, tetapi pada kenyataannya, ketika mencoba melakukan serangan, banyak nuansa yang ditemukan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama, agar berhasil melakukan serangan kesalahan, perlu untuk menentukan titik waktu ketika pulsa RESET harus diterapkan dengan sangat akurat. </font><font style="vertical-align: inherit;">Jika Anda membuat kesalahan setidaknya untuk mikrodetik, mengirim impuls terlalu pendek atau panjang, serangan itu tidak berfungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untungnya, di Xbox 360, setiap langkah boot disertai dengan perubahan nilai pada bus debug </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POST_OUT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Selain itu, output debug sering diatur sehingga nilai POST baru diatur segera sebelum membandingkan jumlah hash:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/o_/pz/hn/o_pzhn6nqueomzmzvlv2vkkfazw.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi tutup lokasi hasil debug dari situs serangan adalah pemicu yang sangat nyaman. </font><font style="vertical-align: inherit;">POST_OUT adalah bus paralel dan merupakan output ke 8 situs uji pada papan sirkuit tercetak, yang masing-masing bertanggung jawab atas salah satu bit nilai. </font><font style="vertical-align: inherit;">Bahkan dimungkinkan untuk menyederhanakan skema koneksi hanya menggunakan satu bit dan menghitung jumlah perubahan dalam statusnya sejak sistem di-boot:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ci/zg/qm/cizgqmpbnxyy2jnhoy5fmqovkde.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata juga karena frekuensi prosesor yang tinggi, hampir tidak mungkin untuk mendapatkan momen yang tepat dalam hal akurasi dan durasi. </font><font style="vertical-align: inherit;">Waktu pemaparan harus sangat singkat, berdasarkan urutan waktu pelaksanaan satu instruksi oleh prosesor. </font><font style="vertical-align: inherit;">Tetapi semakin lambat prosesor berjalan, semakin lama interval waktunya cocok untuk kita. </font><font style="vertical-align: inherit;">Karena itu, kami mengambil dan memperlambat prosesor! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada PC biasa, frekuensi CPU didefinisikan sebagai produk dari eksternal, frekuensi dan pengali "referensi":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/5h/vb/oo/5hvbooyj4elvow6nxit04kc4ypk.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi di Xbox 360, jalur eksternal dari frekuensi referensi cocok untuk prosesor, dan di dalam frekuensi ini dikalikan dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dan pada revisi lama, "tebal" dari set-top box, mekanisme PLL dapat dimatikan, memperlambat prosesor sebanyak 128 kali:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/4w/yt/sp4wytmvkymnu5geqbdp0jwgtag.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada versi "Slim", trik PLL tidak dapat dilakukan (garis tidak dipisahkan di papan), dan karena kita tidak dapat mempengaruhi faktor "Slim", kami akan mengurangi frekuensi "referensi"! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini dihasilkan oleh chip HANA, dan dapat dikonfigurasi melalui bus I2C:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/u0/mv/h3/u0mvh32w0mjhaeylbllspnsiwwc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, tidak mungkin mengurangi banyak, "pada kecepatan rendah" frekuensi prosesor akhir mulai "berenang" dengan kuat, yang mengurangi peluang keberhasilan. </font><font style="vertical-align: inherit;">Opsi yang paling stabil adalah penurunan 3,17 kali. </font><font style="vertical-align: inherit;">Tidak 128 kali, tapi setidaknya sesuatu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua? </font><font style="vertical-align: inherit;">Tidak semuanya. </font><font style="vertical-align: inherit;">Jauh dari fakta bahwa serangan itu akan bekerja pertama kali (terutama pada Slim). </font><font style="vertical-align: inherit;">Dan jika mulai gagal, awalan reboot dan mencoba untuk memulai lagi. </font><font style="vertical-align: inherit;">Hanya 5 upaya yang diberikan untuk memulai, setelah awalan berhenti dan mulai berkedip "cincin merah kematian". </font><font style="vertical-align: inherit;">Oleh karena itu, kami juga menambal firmware jembatan selatan (SMC) sehingga tidak menderita sampah dan mem-boot ulang awalan hingga menjadi biru:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/4s/em/3z/4sem3zqaipwaskszcy_nzntxdvu.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kami mendapatkan algoritma:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menambal SMC</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memperlambat persen (via PLL atau I2C)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunggu pemicu POST</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunggu N mikrodetik</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kirim impuls ke RESET</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mempercepat persen kembali</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk akurasi perhitungan yang lebih besar, kami mengambil frekuensi dari HANA yang sama (48 MHz):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/cg/em/dqcgemuy43cr24pzdnor6sl2zpy.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kami mendapatkan desain seperti itu berdasarkan CPLD Xilinx XC2C64A yang murah:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/uf/5m/yxuf5mhm9uohsh7axeb_trevnue.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jangan lupa perdukakan dengan panjang dan lokasi kabel pada RESET (perhatikan "koil" di bagian bawah foto) dan maju, berharap bahwa peluncuran akan bekerja dalam satu menit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi ini hanya di sisi perangkat keras. </font><font style="vertical-align: inherit;">Bagaimana kita menambal bootloader dan memasukkan kode kita?</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patch loader</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya sebutkan, bootloader tingkat kedua, "CB," sedang diserang. Bootloader ini dienkripsi dengan kunci tetap, sama untuk semua konsol, tetapi hanya "CB" tidak dapat dimodifikasi, kami hanya menyerang itu. Tetapi yang berikutnya sudah dienkripsi dengan kunci CPU, unik untuk setiap set-top box. Dan untuk memodifikasinya, Anda perlu tahu kunci ini ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atau tidak? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam revisi "tebal" lama dari Xbox 360, apa yang disebut mode "Zero-Pairing", yang digunakan pada tahap produksi konsol, didukung di CB loader. Setiap header bootloader pada offset 0x10 berisi kumpulan data Pairing acak yang digunakan sebagai bagian dari kunci untuk dekripsi. Dan jika kumpulan data ini seluruhnya terdiri dari nol ("Zero-Pairing"), maka kunci prosesor diabaikan dan diperbaiki, kunci nol digunakan sebagai gantinya!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s6/yd/tc/s6ydtc65_pqwl6vqimx88x7j4ws.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan trik ini adalah mungkin untuk mengumpulkan gambar dengan "CB" asli, mengenkripsi bootloader berikutnya, "CD" (dengan kode sendiri) dengan kunci nol dan menjalankannya menggunakan RGH!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/s5/mg/9y/s5mg9ynt52prplbrelkmas-3hqg.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam konsol "Slim" membungkus trik ini, menghapus mode "Zero-Pairing" dan membagi "CB" menjadi dua bagian. </font><font style="vertical-align: inherit;">Di sini, "CB" dibagi menjadi "CB_A" yang sangat sederhana dan kecil dan dienkripsi dengan kunci prosesor "CB_B":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/io/kw/fr/iokwfrhtycw2bg8fd8qnuzq9c-c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi enkripsi dengan algoritma RC4 (yaitu, CB_B dienkripsi dengan algoritma ini) memiliki satu kekhasan. </font><font style="vertical-align: inherit;">Dalam proses enkripsi berdasarkan kunci, aliran data pseudo-acak dihasilkan, yang merupakan biner "dijumlahkan" (operasi 'eksklusif atau', 'xor') dengan sumber data. </font><font style="vertical-align: inherit;">Ketika mendekripsi, hal yang sama terjadi, menambahkan dengan aliran pseudo-acak yang sama mengembalikan data ke nilai aslinya:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/mw/_3/da/mw_3da2ixwvjpwa3wmxion8bjvk.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi operasi penambahan biner bersifat komutatif dan asosiatif, yang berarti bahwa kita dapat memodifikasi data terenkripsi tanpa mengetahui kuncinya, hanya untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'dan kode terenkripsi dengan tambalan yang kita butuhkan!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/uc/hk/mr/uchkmrjc4tjpy5sepvgm_pv-jo4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasilnya, kita dapat mengenkripsi "CB_A", menambal "CB_B" yang dienkripsi (sehingga tidak melakukan dekripsi sama sekali) dan memasukkan "CD" teks biasa dengan kodenya!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_q/g1/hg/_qg1hghntkm59bnmg1bv5xp4h_8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Singkatnya, jika Anda menyatukannya, maka peluncurannya akan terlihat seperti ini: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
(XeLL adalah bootloader dari homebrew, Linux, dan juga menunjukkan kunci-kunci CPU)</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JOiPjlWDA1A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microsoft menyerang balik</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, Microsoft mencoba untuk memperbaiki semuanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam pembaruan sistem baru, semua konsol lama dipindahkan ke boot "terpisah" dari "CB_A" dan "CB_B", sehingga akhirnya menutup mode "Zero-Paired". </font><font style="vertical-align: inherit;">Pada Slim, bootloader juga telah diperbarui. </font><font style="vertical-align: inherit;">Bootloader baru telah dimodifikasi secara serius untuk melindungi terhadap RGH, dengan penekanan terbesar ditempatkan pada perlindungan CB_A:</font></font><br>
 <br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benar-benar menghapus hasil debug di POST</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verifikasi hash telah diulang dan diduplikasi untuk keandalan</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sepanjang kode, sleep () diset untuk waktu acak (tergantung pada kunci CPU !!)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan cek fusi CBLDV untuk mencabut CB_A</font></font></li>
</ul><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ro/zh/ak/rozhaks1oyb4q0ck6f_2mbzmwmi.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar inovasi tidak memberikan peluang bagi RGH. </font><font style="vertical-align: inherit;">Tapi mari kita perhatikan item terakhir dalam daftar - sebelum itu, tidak ada pemeriksaan fusi di CB_A! </font><font style="vertical-align: inherit;">Kelemahan fatal. </font><font style="vertical-align: inherit;">Selain itu, seperti yang kita ingat, kunci prosesor tidak terlibat dalam decoding "CB_A". </font><font style="vertical-align: inherit;">Ini berarti bahwa loader CB_A yang rentan terhadap RGH dapat diluncurkan pada konsol apa pun, dan ini tidak dapat dilarang. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi untuk memulai sesuatu dengan bantuan "CB_A" yang rentan ini, Anda perlu mengelak sedikit. </font><font style="vertical-align: inherit;">Jika kita tidak tahu kunci CPU, yang tersisa bagi kita adalah menambal "CB_B" yang ada. </font><font style="vertical-align: inherit;">Tetapi bagaimana jika, alih-alih memodifikasi setiap bagian, kami sepenuhnya menimpa seluruh bootloader? </font><font style="vertical-align: inherit;">Dan karena ini, "tulis" bootloader lama, yang sudah kita tahu cara menambal, untuk mengganti yang baru? </font><font style="vertical-align: inherit;">Jadi mereka melakukannya:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mengenkripsi CB_A yang rentan dengan cara yang sama seperti pada gambar asli</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XOR CB_B kami dengan yang baru, dapatkan "perbedaan"</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menaruhnya di "CB_B" terenkripsi!</font></font></li>
</ol><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rt/4t/7c/rt4t7ct5vu1vfnvexya_4yjp_oc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya, sekali lagi, tanpa mengetahui kuncinya, kami berhasil mengganti konten yang dienkripsi, dan juga menempatkan bootloader yang rentan. </font><font style="vertical-align: inherit;">Konsol diretas, Microsoft terkejut. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pengembang bekerja keras, dan dalam pembaruan sistem berikutnya ... sedikit mengubah metode enkripsi "CB_B", sekarang kunci enkripsi juga menjadi tergantung pada versi "CB_A":</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/2_/zy/kq/2_zykqm27pplqsop8gquppheo4g.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang, ketika mencoba untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'dan mendorong data ke "CB_A" versi lama, bootloader mendekripsi sampah karena perbedaan kunci. </font><font style="vertical-align: inherit;">Dan bootloader baru tidak dapat diretas, dilindungi dengan baik dari serangan glich. </font><font style="vertical-align: inherit;">Sejauh ini, kemenangan untuk Microsoft!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Corona melempar masalah</font></font></h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sementara itu, revisi baru Xbox 360, Corona, memasuki pasar, dan itu membawa masalah modders:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/zj/b1/fszjb1roudnv3rix_uf3usnwml4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak cukup chip di papan tulis, dapatkah Anda menemukannya? </font><font style="vertical-align: inherit;">Itu benar, chip HANA "tersembunyi" di jembatan selatan. </font><font style="vertical-align: inherit;">Tidak ada tempat lain untuk mengambil frekuensi 48 MHz untuk chip mod, perintah perlambatan I2C sebelumnya tidak berfungsi. </font><font style="vertical-align: inherit;">Tapi apa itu, flash NAND 16 MB, yang telah berfungsi sebagai penyimpanan sistem Xbox 360 selama bertahun-tahun, diganti dengan chip 4 GB dengan antarmuka eMMC! </font><font style="vertical-align: inherit;">(Benar, hanya di versi konsol yang lebih murah, tapi tetap saja):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ho/pv/dl/hopvdl-wilvzq4pzvndoogihru4.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi tidak ada, semuanya ditangani. </font><font style="vertical-align: inherit;">Kami menemukan cara membaca / menulis memori flash melalui pembaca kartu:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/oo/sz/pj/ooszpjupnf_mgzwpkc-vry0ovou.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ditemukan perintah perlambatan I2C baru, osilator kristal 48 MHz eksternal menggantikan HANA:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/88/lm/ic/88lmicizuembheqjiod-uff7jau.jpeg" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Script build yang lengkap, menambahkan dukungan untuk NAND 4 GB ...</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qm/7a/tk/qm7atka28kaj3anjmoq2cgoalz0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun Microsoft terus memasukkan tongkat ke roda. </font><font style="vertical-align: inherit;">Misalnya, pada papan baru, beberapa resistor menghilang, tanpa itu chip mod berhenti bekerja:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/ji/wg/kvjiwggxf9dncmv8rehaqhpzuy4.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Benar, ini diperbaiki dengan memasang jumper dengan besi solder:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/7x/sv/ku7xsv8rpu2fov8upv6g-osgfm8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hal-hal menjadi lebih serius ketika trek POST_OUT menghilang dari papan:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/lu/lo/0m/lulo0m01ihmy34glpcoeriz4ojo.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi di sini Microsoft tidak beruntung, "bola" CPU yang dibutuhkan untuk RGH berada di baris paling ekstrim:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/nk/e2/hcnke2-7eh_xgrz0bmpf2ewtzro.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan, tentu saja, mereka dapat terhubung dengan mereka. </font><font style="vertical-align: inherit;">Pertama, yang paling lengan, sedikit mengebor tepi prosesor dan menyolder langsung ke bola dengan kabel:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/-t/k_/gk-tk_mzrvo5suirxpk_d_kknru.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/dw/ue/ai/dwueaifiz18-tfgrylfhdgkpats.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kemudian orang Cina merilis kerangka kerja dengan jarum pegas, persis bertumpu pada bola, dan masalahnya diselesaikan untuk semua orang:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/k7/sd/xj/k7sdxjysbtq9ofcadfby2jpdf-i.jpeg"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perbatasan Terakhir</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah kami mengalahkan "mahkota", ada satu masalah - versi baru dari sistem tidak menyerah pada peretasan. Untuk memulai RGH, Anda perlu mengetahui kunci CPU, dan untuk mengetahui kunci CPU, Anda harus menjalankan RGH setidaknya sekali. Masalah ayam dan telur pada umumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan kemudian muncul pemikiran - dan mari kita tidak hanya memeriksa dengan otentikasi "kesalahan", tetapi kami juga akan melewatkan dekripsi! Jika berhasil, maka kita tidak perlu tahu kuncinya, letakkan "CB_B" di tempat yang jelas, itu saja. Gagasan ini menjadi dasar Double Glitch Hack (DGX):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/28/h2/yh/28h2yheods_vx8jptciovob9yby.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chip ini “buggy” persen dua kali, pulsa pertama melewatkan fase dekripsi bootloader, dan pulsa kedua melewatkan otentikasi. </font><font style="vertical-align: inherit;">Ini bekerja jauh lebih tidak stabil, karena setidaknya diperlukan satu peluncuran yang sukses - maka kita mendapatkan kunci CPU dan melanjutkan seperti sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DGX tidak relevan untuk waktu yang lama, setelah 3 bulan orang Cina melempar dalam rilis "DGX RIP" dengan gambar yang berjalan pada setiap set-top box, bekerja dengan RGH standar dan, tentu saja, mulai jauh lebih stabil:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ig/yv/fy/igyvfysfq1qsiyyefeqsknjiz1e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gambar-gambar ini berisi versi khusus dari bootloader CB_A yang digunakan dalam produksi Xbox 360 dan, pada kenyataannya, adalah analog lengkap dari mode "Zero-Pairing" yang baik. </font><font style="vertical-align: inherit;">Alih-alih kunci prosesor, "CB_A_mfg" ini mendekripsi "CB_B" dengan kunci null tetap:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/_2/3k/n1/_23kn1nx7eydggdpskbzkudinv4.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan inilah Microsoft. </font><font style="vertical-align: inherit;">Dalam versi "layanan" "CB_A" ini juga tidak ada pemeriksaan fusi dan tidak mungkin untuk melarangnya. </font><font style="vertical-align: inherit;">Sudah cukup untuk merekam gambar sesuai dengan revisi Xbox 360, solder chip - dan semuanya berfungsi.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/fa/_9/hd/fa_9hdfa5kgwphr69k6xpdnyaia.jpeg" width="550"></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winchester!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RGH sepenuhnya diperbaiki hanya dalam revisi baru konsol, nama kode Winchester. </font><font style="vertical-align: inherit;">Untuk pertama kalinya, prosesor CPU dan GPU digabung dalam satu chip, papan disederhanakan sebanyak mungkin:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/of/ps/1g/ofps1gt_gevcpmlz39aj97ukquc.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
POST_OUT trek tidak hanya dihapus. </font><font style="vertical-align: inherit;">Bahkan jika Anda menyolder ke platform di bawah prosesor:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/ha/vg/c6/havgc6afvvs4nt5pn8lihldlspq.jpeg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/nz/si/lc/nzsilch-pq6gun98tbugnx89owi.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan bahkan jika Anda menyolder prosesor ke versi khusus papan untuk pengembang, XDK, di mana trek ini masih ada:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/m2/di/n4/m2din48-hbqpbs2aw_if-uorx0g.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada POST_OUT, hanya satu pulsa yang terlihat saat konsol dimulai. </font><font style="vertical-align: inherit;">Bus terkunci:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/kq/6q/5c/kq6q5cngontmkypyxrsfbke-atw.png" width="550"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain itu, hanya diblokir pada tahap produksi. </font><font style="vertical-align: inherit;">Jika Anda mengambil prosesor "bersih" dari pabrik tempat Anda belum membakar sekering, POST_OUT bekerja di dalamnya!</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/p0/ke/au/p0keau_qpxnl61bmosmxcv5unya.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi RGH di atasnya tidak lagi berfungsi. </font><font style="vertical-align: inherit;">Tidak peduli bagaimana Anda mencoba memberikan pulsa RESET, prosesor dengan benar melakukan reset, atau mengabaikan sinyal Anda karena durasinya terlalu pendek. </font><font style="vertical-align: inherit;">Rupanya, modul logika khusus ditambahkan ke prosesor, memfilter garis RESET dan akhirnya memperbaiki kesalahan perangkat keras.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Posting scriptum</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata revisi terbaru Xbox 360 tidak mungkin diretas? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Iya dan tidak. </font><font style="vertical-align: inherit;">Saat ini, hanya ada satu cara yang dikenal untuk menjalankan sistem yang dimodifikasi pada revisi Winchester. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kit pengembangan perangkat lunak (XDK) berisi berbagai kunci pribadi untuk menandatangani kode yang dikompilasi. </font><font style="vertical-align: inherit;">Dan ternyata di antara mereka kunci "shadowboot" kunci, bootloader tingkat ketiga untuk sistem XDK, berantakan. </font><font style="vertical-align: inherit;">Dan dengan itu, Anda dapat mengumpulkan gambar yang ditandatangani sah dengan firmware yang dimodifikasi. </font><font style="vertical-align: inherit;">Hanya bekerja pada konsol "toko" biasa, dia tidak akan melakukannya. </font><font style="vertical-align: inherit;">Kami membutuhkan prosesor dengan versi XDK konsol, atau "bersih" CPU dengan sekering non-sekering (Anda bisa melihatnya di Aliexpress):</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/sl/fz/rrslfzrmohmrxuagyadwvojnpvq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan hanya pada saat itulah Anda memiliki kesempatan untuk merenungkan tulisan seperti itu di "informasi sistem" dari shell kustom:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gg/te/g7/ggteg7iezt2c-hw-h_mczs132fe.jpeg" width="450"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan itu saja! </font><font style="vertical-align: inherit;">Seperti biasa, saya siap menjawab pertanyaan Anda di komentar :) </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlindungan dan Peretasan </font></font></a><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xbox 360 </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">, Bagian 1 </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Perlindungan dan Peretasan </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Xbox 360 </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">, Bagian 2 </font></a></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlindungan dan Peretasan Xbox 360, Bagian 3</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id500228/index.html">Bagaimana Gatsby menghindari Next.js</a></li>
<li><a href="../id500232/index.html">Belajar Akka.NET: Server game online yang sederhana</a></li>
<li><a href="../id500234/index.html">Mengapa saya membuat proyek akuntansi pengeluaran pribadi untuk Git + JS</a></li>
<li><a href="../id500238/index.html">Katakan padaku apa yang mengganggumu</a></li>
<li><a href="../id500244/index.html">Di luar array</a></li>
<li><a href="../id500248/index.html">Berita FOSS No. 14 - ulasan berita gratis dan sumber terbuka untuk 27 April - 3 Mei 2020</a></li>
<li><a href="../id500250/index.html">Berita dari dunia OpenStreetMap No. 509 (04.14.2020-20.04.2020)</a></li>
<li><a href="../id500252/index.html">Pusat Keamanan Kaspersky - Level Baru</a></li>
<li><a href="../id500254/index.html">Kami menulis front-end yang berfungsi. Atau cara menjadi insinyur dari pengembang. Bagian 2</a></li>
<li><a href="../id500256/index.html">Dmitry Lebedev: "Beberapa tahun yang lalu, saya jelas mengerti bahwa sedikit lebih banyak dan OpenStreetMap akan tenggelam"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>