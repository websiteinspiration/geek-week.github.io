<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ”¬ ğŸ¼ ğŸ‘§ ç§ãŸã¡ã¯ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰ã®ä¸‹ã§ãƒ¢ãƒã‚¤ãƒ«1ã‚’é€†ã«ã—ã¾ã™ã€‚å°‘ã—ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦æ•°å¤œã‚’æ¨ã¦ã‚‹æ–¹æ³• ğŸ‘  ğŸŸï¸ ğŸ¤¶ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="èª°ã‹ãŒæ€ã†ã‹ã‚‚ã—ã‚Œãªã„ãŒã€é¨’ã€…ã—ã„ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«-ç›´æ¥çš„ãªãƒãƒ¼ãƒ‰ã‚³ã‚¢ã¯ã¾ã£ãŸããªã„ã ã‚ã†ã¨ç§ã¯ã™ãã«è¨€ã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ã¾ãŸã€ãƒªãƒãƒ¼ã‚¹ã¯ã»ã¨ã‚“ã©ã®å ´åˆæƒ…å ±ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢é€£ã—ã¦ã„ã‚‹ã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ä¿è­·ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹å¿…è¦ãŒãªã‹ã£ãŸãŸã‚ï¼ˆå°ã•ãªç¸®å°ã‚’é™¤ã„ã¦ï¼‰ã€ã“ã®ã‚ˆã†ãªã“ã¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>ç§ãŸã¡ã¯ã‚¢ãƒ³ãƒ‰ãƒ­ã‚¤ãƒ‰ã®ä¸‹ã§ãƒ¢ãƒã‚¤ãƒ«1ã‚’é€†ã«ã—ã¾ã™ã€‚å°‘ã—ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦æ•°å¤œã‚’æ¨ã¦ã‚‹æ–¹æ³•</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475266/"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èª°ã‹ãŒæ€ã†ã‹ã‚‚ã—ã‚Œãªã„ãŒã€é¨’ã€…ã—ã„ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«-ç›´æ¥çš„ãªãƒãƒ¼ãƒ‰ã‚³ã‚¢ã¯ã¾ã£ãŸããªã„ã ã‚ã†ã¨ç§ã¯ã™ãã«è¨€ã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ã¾ãŸã€ãƒªãƒãƒ¼ã‚¹ã¯ã»ã¨ã‚“ã©ã®å ´åˆæƒ…å ±ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢é€£ã—ã¦ã„ã‚‹ã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ä¿è­·ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹å¿…è¦ãŒãªã‹ã£ãŸãŸã‚ï¼ˆå°ã•ãªç¸®å°ã‚’é™¤ã„ã¦ï¼‰ã€ã“ã®ã‚ˆã†ãªã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">ãã‚Œã‚‰ã®ã©ã‚Œã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚</font><font style="vertical-align: inherit;">Mobile 1sã¯ã€ãƒã‚§ãƒƒã‚¯ã€ä¿è­·ã€æœ‰æ–™æ©Ÿèƒ½ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„ç„¡æ–™ã®è£½å“ã§ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã§ã™ã‹ã‚‰ã€è§£èª­å™¨ã®ä½¿ç”¨ã€Frida / Xposedã€ãã®ä»–ã®ãƒˆãƒªãƒƒã‚­ãƒ¼ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä½¿ç”¨ã‚’è¦‹ãŸã„äººã«ã‚¢ãƒ”ãƒ¼ãƒ«ã—ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã“ã“ã§ã¯ã€apktoolã€baksmaliã€apksignerã€adbã€jadxã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã€javacã€d8ã‚’ä½¿ç”¨ã™ã‚‹ã ã‘ã§ã™ã€‚</font></font></p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã¾ãŸã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®è©³ç´°ãªåˆ†æã¾ãŸã¯ãã®å¼·åŠ›ãªå¤‰æ›´ã‚’å¾…ã£ã¦ã„ãŸäººãŸã¡ã‚’äº‹å‰ã«å¤±æœ›ã•ã›ãŸã„ã¨æ€ã„ã¾ã™ã€‚</font><font style="vertical-align: inherit;">ã»ã‚“ã®æ•°å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã€ãã—ã¦å®Ÿéš›ã«ã¯ç§ãŒå¾¹åº•çš„ã«ä½œæˆã—ãªã‹ã£ãŸã“ã‚Œã‚‰ã®æ•°å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«åŠ ãˆã‚‰ã‚Œã‚‹å°ã•ãªç·¨é›†ã®ã¿ãŒã™ã¹ã¦ä¸Šéƒ¨ã«ã‚ã‚Šã¾ã™ã€‚</font></font></p><a name="habracut"></a><br>
<h1 id="s-chego-vse-nachalos"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã™ã¹ã¦ã®å§‹ã¾ã‚Š</font></font></h1><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çªç„¶ã€ã©ã†ã„ã†ã‚ã‘ã‹1ç§’é–“æºå¸¯é›»è©±ã«å…¥ã‚ã†ã¨æ€ã£ãŸç†ç”±ã‚’å°‘ã—ãŠè©±ã—ã—ã¾ã™ã€‚ç¾åœ¨ã€Androidã®ãƒã‚¤ãƒ†ã‚£ãƒ–é–‹ç™ºã‚’è¡Œã£ã¦ã„ã‚‹ã®ã¯1å¹´ã§ã™ãŒã€ãã®å‰ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã¨ã—ã¦4å¹´é–“åƒã„ã¦ã„ã¾ã—ãŸãŒã€ã“ã®1å¹´åŠã®é–“ã€ãƒ¢ãƒã‚¤ãƒ«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ä½œæ¥­ã™ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã—ãŸã€‚å½¼å¥³ã¯åŸºæœ¬çš„ãªãƒ‹ãƒ¼ã‚ºã‚’æº€ãŸã—ãŸã¨ã„ã†äº‹å®Ÿã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«åŠ ãˆã¦ï¼‰å¤šãã®ãƒã‚¤ãƒŠã‚¹ç‚¹ã‚‚ã‚ã‚Šã¾ã—ãŸã€‚ç‰¹ã«ã€å°‘ãªãã¨ã‚‚é€šå¸¸ã®æ–¹æ³•ã§ã€ãã—ã¦å½“æ™‚ã®çŸ¥è­˜ã®è“„ç©ã«ã‚ˆã£ã¦ã€å¤–éƒ¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’äººç‚ºçš„ã«åŸ‹ã‚è¾¼ã‚€ã“ã¨ã¯ä¸å¯èƒ½ã§ã—ãŸã€‚ã¾ãŸã€åœ°å›³ã«ãƒ©ãƒ™ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ãªã©ã€ã™ã¹ã¦ãŒéå¸¸ã«æ‚²ã—ã‹ã£ãŸã§ã™ã€‚ãã®æ§‹æˆã®ã™ã¹ã¦ã®å¯èƒ½æ€§ã¯ã€ãã‚Œã‚‰ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ãã«ãƒ©ãƒ™ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã—ãŸã€‚å½“æ™‚ã€ã©ã†ã«ã‹ã—ã¦ã“ã‚Œã‚’å›é¿ã™ã‚‹å”¯ä¸€ã®æ–¹æ³•ã¯ã€ç‰¹åˆ¥ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ŒHTML Document Fieldã€ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã—ãŸãŒã€å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚ 1ã‚’ä½¿ç”¨ã—ã¦ã„ãŸå½“æ™‚ã€Androidã®ãƒã‚¤ãƒ†ã‚£ãƒ–é–‹ç™ºã«é–¢ã™ã‚‹ç§ã®çŸ¥è­˜ã¯ã™ã¹ã¦HelloWorldãƒšã‚¢ã§ã‚ã£ãŸãŸã‚ã€1ã§æºå¸¯é›»è©±ã‚’ãƒªãƒãƒ¼ã‚¹ã™ã‚‹ã“ã¨ã•ãˆè€ƒãˆã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚1ã®éæ¨™æº–ã®æ‹¡å¼µã«é–¢ã™ã‚‹é¡§å®¢ã‹ã‚‰ã®ã•ã¾ã–ã¾ãªè³ªå•ã‚’è§£æ±ºã—ãªã‹ã£ãŸã‹ã€éå¸¸ã«å˜ç´”ãªãƒã‚¤ãƒ†ã‚£ãƒ–ã®ã‚‚ã®ã‚’è¦‹ã¾ã—ãŸãã®æ¨ªã«é…ç½®ã•ã‚Œã€1ã¨æ›²ãŒã£ã¦/æ–œã‚ã«çµ±åˆã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãŠã‚ˆã³1ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å¥‘ç´„ã§ã¯ã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è‡ªä½“ã®ç·¨é›†ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ï¼‰ã€‚1cæ©Ÿèƒ½ã®éæ¨™æº–çš„ãªæ‹¡å¼µã«é–¢ã™ã‚‹ãŠå®¢æ§˜ã‹ã‚‰ã®ã•ã¾ã–ã¾ãªè³ªå•ã‚’è§£æ±ºã—ãªã‹ã£ãŸã‹ã€ã¾ãŸã¯ãã®æ¨ªã«é…ç½®ã•ã‚Œã¦1cã¨æ›²ãŒã£ã¦/æ–œã‚ã«çµ±åˆã•ã‚ŒãŸéå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ‡ã‚Šã¾ã—ãŸï¼ˆãã—ã¦ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å¥‘ç´„1cã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è‡ªä½“ã®ç·¨é›†ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ï¼‰ã€‚1cæ©Ÿèƒ½ã®éæ¨™æº–ã®æ‹¡å¼µã«é–¢ã™ã‚‹ãŠå®¢æ§˜ã‹ã‚‰ã®ã•ã¾ã–ã¾ãªè³ªå•ã‚’è§£æ±ºã—ãªã‹ã£ãŸã‹ã€ã¾ãŸã¯ãã®æ¨ªã«é…ç½®ã•ã‚Œã¦1cã¨æ›²ãŒã£ã¦/æ–œã‚ã«çµ±åˆã•ã‚ŒãŸéå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ãªãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¾ã—ãŸï¼ˆãã—ã¦ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å¥‘ç´„1cã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è‡ªä½“ã®ç·¨é›†ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ï¼‰ã€‚</font></font></p><br>
<p>      1   ,    ,         .  ,        ,             .        1   /      .</p><br>
<p>     ,        apk,      ,    , ,       ,       1.</p><br>
<h1 id="pervye-shagi"> </h1><br>
<p>   ,     1      ,    apk     AndroidStudio.    â€”     ,     1   C++    .so ,    ,     .    classes.dex    ,                .     . ,         C++ â€”          ProGuard.       ;).</p><br>
<div class="spoiler"><b class="spoiler_title">       ( x86 ,        )</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ry/dx/6l/rydx6lnrt7oix0nqa63bftv2-8y.png"></p></div></div><br>
<p>      â€”      (     ).      java        so .</p><br>
<p> -    ,     MapImpl,             .</p><br>
<div class="spoiler"><b class="spoiler_title"> MapImpl</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ya/rl/xh/yarlxho_dqjalx6euv2g57bddn8.png"></p></div></div><br>
<p>           ,      smali ,          smali,    /. ,             ,    ,    .         (    ),      .</p><br>
<h1 id="stroyu-plany"> </h1><br>
<p>                 ,     ,         ,       .                          .     :</p><br>
<ol>
<li>  1             .</li>
<li> apk  ,   ,    .</li>
<li>    smali ,    ,            ,      .</li>
<li> smali     java,        ,       .   ,         â€”  ,       MapImpl       smali MapImpl.</li>
<li>   (   - ,        ,         )</li>
</ol><br>
<p>,          .     ,   ,        (1,       linux,         ,        ).   ,     ()       . .</p><br>
<p>     -    .    ,       .</p><br>
<h1 id="perepakovyvayu-prilozhenie-bez-izmeneniy-koda">    </h1><br>
<p>         apktool      apk  .smali ,       .     .  apk   (  ,          linux,      windows):</p><br>
<pre><code class="plaintext hljs">apktool.bat d .\sourceApk\1cem-x86.apk -o .\build\unpacked</code></pre><br>
<p>   unpacked     ,      .  apk  </p><br>
<pre><code class="plaintext hljs">apktool.bat b .\build\unpacked -o .\build\1cem-x86.apk</code></pre><br>
<p>     </p><br>
<pre><code class="plaintext hljs">adb install .\build\1cem-x86.apk</code></pre><br>
<p>   :</p><br>
<pre><code class="plaintext hljs">Performing Streamed Install<font></font>
adb: failed to install .\build\1cem-x86.apk: Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from /data/app/vmdl1115375036.tmp/base.apk: Attempt to get length of null array]</code></pre><br>
<p>       .      ,          ,          .      ,   apk </p><br>
<pre><code class="plaintext hljs">apksigner.bat sign --ks C:\Users\neikist\.android\debug.keystore .\build\1cem-x86.apk</code></pre><br>
<p>   .             google .                1,      .        google        api google   ,  api key,    res/values/strings.xml  google_maps_key ,           .    apk, ,     .</p><br>
<h1 id="dobavlyayu-svoi-logi">  </h1><br>
<p>     â€”        1  .            . </p><br>
<p>       jadx  dex2jar,      smali,       java,   -     (  jadx       ).   smali,         .</p><br>
<p> ,               adb,                 .    application (<code>com.e1c.mobile.E1cApplication</code>)    <code>android.intent.action.MAIN</code>  intent-filter (<code>com.e1c.mobile.App</code>).    reciever <code>com.e1c.mobile.Starter</code>   intent filter  <code>com.e1c.mobile.START_TEMPLATE</code>  <code>com.e1c.mobile.START_CMD</code>.            1,       .</p><br>
<p> <code>E1cApplication</code>       ,     â€”     .</p><br>
<p>     , <code>Starter</code>  <code>App</code>         .  <code>App.onCreate(Landroid/os/Bundle;)V</code>  ,       ,     .</p><br>
<div class="spoiler"><b class="spoiler_title">  App onCreate</b><div class="spoiler_text"><pre><code class="plaintext hljs">invoke-virtual {p0}, Lcom/e1c/mobile/App;-&gt;getIntent()Landroid/content/Intent;<font></font>
<font></font>
#     p1<font></font>
move-result-object p1<font></font>
<font></font>
new-instance v0, Ljava/lang/StringBuilder;<font></font>
<font></font>
invoke-direct {v0}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V<font></font>
<font></font>
invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder;<font></font>
<font></font>
const-string v1, ".onCreate() "<font></font>
<font></font>
invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder;<font></font>
<font></font>
invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder;<font></font>
<font></font>
invoke-virtual {v0}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String;<font></font>
<font></font>
move-result-object v0<font></font>
<font></font>
# ,  ?<font></font>
invoke-static {v0}, Lcom/e1c/mobile/Utils;-&gt;V(Ljava/lang/String;)V</code></pre></div></div><br>
<p>         ,       <code>p1</code>,  <code>StringBuilder</code>            <code>V(Ljava/lang/String;)V</code>  <code>Utils</code>.  -  .        , ,  ,    <code>Uri</code>,         <code>getQuery()</code>    <code>Starter</code>.   <code>onCreate</code>   ,        .          ,   <code>LayoutInflater</code>,      ,          .      â€” <code>Starter</code>.           .</p><br>
<p>       ,   (<code>.method static native startCmd(Ljava/lang/String;)V</code>),      <code>onRecieve</code> (       ).    ,           <code>V(Ljava/lang/String;)V</code>  <code>Utils</code>.      smali     â€”     ,          .    Utils    2  , V  W.          .           <code>android.utils.Log</code>.         0  1 (  ),       <code>v0</code>,      <code>Log</code></p><br>
<div class="spoiler"><b class="spoiler_title">  W  V</b><div class="spoiler_text"><pre><code class="plaintext hljs">    .method public static V(Ljava/lang/String;)V<font></font>
        .locals 1<font></font>
<font></font>
        const-string v0, "neikist_V"<font></font>
<font></font>
        invoke-static {v0, p0}, Landroid/util/Log;-&gt;v(Ljava/lang/String;Ljava/lang/String;)I<font></font>
<font></font>
        return-void<font></font>
    .end method<font></font>
<font></font>
    .method public static W(Ljava/lang/String;)V<font></font>
        .locals 1<font></font>
<font></font>
        const-string v0, "neikist_W"<font></font>
<font></font>
        invoke-static {v0, p0}, Landroid/util/Log;-&gt;w(Ljava/lang/String;Ljava/lang/String;)I<font></font>
<font></font>
        return-void<font></font>
    .end method</code></pre></div></div><br>
<p>  1  1     </p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="plaintext hljs">    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: com.e1c.mobile.Starter@139df1c.onReceive( android.app.ReceiverRestrictedContext@346b725, Intent { act=com.e1c.mobile.START_TEMPLATE flg=0x400010 cmp=com.e1c.mobile/.Starter (has extras) } )<font></font>
    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: context.getPackageName() = com.e1c.mobile<font></font>
    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: intent.getAction() = com.e1c.mobile.START_TEMPLATE<font></font>
    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: App.sActivity = null<font></font>
    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: templatePath = /sdcard/Download/mobilegeoMA/1cema.xml<font></font>
    2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: debugUrl = tcp://127.0.0.1:1560<font></font>
    2019-10-25 19:21:42.216 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App@423609b.onCreate() Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.e1c.mobile/.App bnds=[35,252][237,505] }<font></font>
    2019-10-25 19:21:42.651 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App$4@4c70381.run() adMobAppId = ca-app-pub-3940256099942544~3347511713<font></font>
    2019-10-25 19:21:42.687 29960-30009/com.e1c.mobile V/neikist_V: App.requestPermission() shouldShowRequestPermissionRationale = false<font></font>
    2019-10-25 19:21:46.138 29960-30009/com.e1c.mobile V/neikist_V: App.isLowBattery() sLastBatteryPercent = 1.0</code></pre></div></div><br>
<p>  â€”          adb.        . -,      jadx    java (      smali  ,   ).               (      ),       1 ,      gradle   ,        .       â€”         .       ,     .</p><br>
<h1 id="zapusk-platformy-cherez-adb">   adb</h1><br>
<p>     adb      gradle.              (,     smali      , , ,         ).       </p><br>
<pre><code class="plaintext hljs">    adb install ./build/1cem-x86.apk<font></font>
    adb shell pm grant com.e1c.mobile android.permission.READ_EXTERNAL_STORAGE<font></font>
    adb push src/1cConfiguration /storage/emulated/0/Download<font></font>
    adb shell am start -n com.e1c.mobile/.App -a android.intent.action.MAIN -c android.intent.category.LAUNCHER<font></font>
    adb shell am broadcast -n com.e1c.mobile/.Starter -a com.e1c.mobile.START_TEMPLATE -e templatepath /storage/emulated/0/Download/1cConfiguration/1cema.xml</code></pre><br>
<p>      apk,       ,   1  ,      1   .        ,     api 28,         .         .</p><br>
<h1 id="vnedryayus-v-obrabotku-dannyh-ot-1s-i-modificiruyu-metki">     1   </h1><br>
<p>        .</p><br>
<ol>
<li>  MapImpl.smali,             -   ,      smali    .</li>
<li>   jadx  MapImpl.java,    ,       ,   smali,  , .             ,                 .</li>
<li>  1  2,   smali      MapImplExtenstion.java     â€”     ,         ,           4,     (, , ).</li>
<li>     - ,  .      ,    MapImpl,   ,     smali       .     ,         ,   ,      .</li>
<li>    4,    â€¦ .          1  1 maps sdk,      .</li>
</ol><br>
<p>      2   src: java,  MapImplExtenstion.java  stubJava       .        ,     :</p><br>
<div class="spoiler"><b class="spoiler_title"> Xj:Ljava/util/ArrayList  Xk:Ljava/util/ArrayList</b><div class="spoiler_text"><pre><code class="plaintext hljs">    .field private final Xj:Ljava/util/ArrayList;<font></font>
        .annotation system Ldalvik/annotation/Signature;<font></font>
            value = {<font></font>
                "Ljava/util/ArrayList&lt;",<font></font>
                "Lcom/google/android/gms/maps/model/LatLng;",<font></font>
                "&gt;;"<font></font>
            }<font></font>
        .end annotation<font></font>
    .end field<font></font>
<font></font>
    .field private Xk:Ljava/util/ArrayList;<font></font>
        .annotation system Ldalvik/annotation/Signature;<font></font>
            value = {<font></font>
                "Ljava/util/ArrayList&lt;",<font></font>
                "Lcom/google/android/gms/maps/model/MarkerOptions;",<font></font>
                "&gt;;"<font></font>
            }<font></font>
        .end annotation<font></font>
    .end field</code></pre></div></div><br>
<p> jadx    java         </p><br>
<div class="spoiler"><b class="spoiler_title"> kN</b><div class="spoiler_text"><pre><code class="java hljs">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">kN</span><span class="hljs-params">()</span> </span>{<font></font>
        Bundle extras = getIntent().getExtras();<font></font>
        <span class="hljs-keyword">if</span> (extras != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">this</span>.Sd = extras.getLong(<span class="hljs-string">"native"</span>);<font></font>
            String[] stringArray = extras.getStringArray(<span class="hljs-string">"titles"</span>);
            <span class="hljs-keyword">double</span>[] doubleArray = extras.getDoubleArray(<span class="hljs-string">"coords"</span>);
            <span class="hljs-keyword">if</span> (doubleArray != <span class="hljs-keyword">null</span> &amp;&amp; doubleArray.length &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; stringArray.length; i++) {
                    <span class="hljs-keyword">int</span> i2 = i * <span class="hljs-number">2</span>;<font></font>
                    LatLng latLng = <span class="hljs-keyword">new</span> LatLng(doubleArray[i2], doubleArray[i2 + <span class="hljs-number">1</span>]);
                    <span class="hljs-keyword">this</span>.Xj.add(latLng);
                    <span class="hljs-keyword">this</span>.Xk.add(<span class="hljs-keyword">new</span> MarkerOptions().c(latLng).dS(stringArray[i]));<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
    }<font></font>
</code></pre></div></div><br>
<p>   MapImplExtension   ArrayList[] kN(String[] titles, double[] coordinates)             Xj,      Xk.</p><br>
<div class="spoiler"><b class="spoiler_title"> MapImplExtension</b><div class="spoiler_text"><pre><code class="java hljs">    <span class="hljs-keyword">package</span> com.e1c.mobile;<font></font>
<font></font>
    <span class="hljs-keyword">import</span> java.util.ArrayList;
    <span class="hljs-keyword">import</span> com.google.android.gms.maps.model.LatLng;
    <span class="hljs-keyword">import</span> com.google.android.gms.maps.model.MarkerOptions;<font></font>
<font></font>
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MapImplExtension</span> </span>{<font></font>
<font></font>
        <span class="hljs-keyword">private</span> MapImpl mapImpl;<font></font>
<font></font>
        MapImplExtension(MapImpl mapImpl){<font></font>
            <span class="hljs-keyword">this</span>.mapImpl = mapImpl;<font></font>
        }<font></font>
<font></font>
        ArrayList[] kN(String[] titles, <span class="hljs-keyword">double</span>[] coordinates) {<font></font>
            ArrayList[] result = <span class="hljs-keyword">new</span> ArrayList[<span class="hljs-number">2</span>];<font></font>
            ArrayList&lt;LatLng&gt; xj = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<font></font>
            ArrayList&lt;MarkerOptions&gt; xk = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<font></font>
            result[<span class="hljs-number">0</span>] = xj;<font></font>
            result[<span class="hljs-number">1</span>] = xk;<font></font>
<font></font>
            <span class="hljs-keyword">int</span> coordinatesOffset;
            <span class="hljs-keyword">if</span> (coordinates != <span class="hljs-keyword">null</span> &amp;&amp; coordinates.length &gt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; titles.length; i++) {<font></font>
                    coordinatesOffset = i * <span class="hljs-number">2</span>;<font></font>
                    LatLng latlng = <span class="hljs-keyword">new</span> LatLng(coordinates[coordinatesOffset], coordinates[coordinatesOffset + <span class="hljs-number">1</span>]);<font></font>
                    xj.add(latlng);<font></font>
                    xk.add(<span class="hljs-keyword">new</span> MarkerOptions().c(latlng).dS(<span class="hljs-string">" \n"</span> + titles[i]));<font></font>
                }<font></font>
            }<font></font>
<font></font>
            <span class="hljs-keyword">return</span> result;<font></font>
        }<font></font>
<font></font>
    }<font></font>
</code></pre></div></div><br>
<p>     class,   dex,    smali       </p><br>
<pre><code class="plaintext hljs">    javac -encoding UTF-8 -d .\build -source 1.8 -target 1.8 -sourcepath .\src\stubJava<font></font>
    .\src\java\com\e1c\mobile\MapImplExtenstion.java<font></font>
<font></font>
    d8.bat .\build\com\e1c\mobile\MapImplExtension.class --output .\build<font></font>
<font></font>
    java -jar C:\Path\to\baksmali\baksmali.jar d .\build\classes.dex -o .\build\unpackedOwn</code></pre><br>
<p>  MapImpl.smali  extension    ,    </p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><pre><code class="plaintext hljs">#   <font></font>
    .field private extension:Lcom/e1c/mobile/MapImplExtension;<font></font>
<font></font>
    #  ,  return-void<font></font>
    new-instance v0, Lcom/e1c/mobile/MapImplExtension;<font></font>
    invoke-direct {v0, p0}, Lcom/e1c/mobile/MapImplExtension;-&gt;&lt;init&gt;(Lcom/e1c/mobile/MapImpl;)V<font></font>
    iput-object v0, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension;</code></pre></div></div><br>
<p>      MapImpl   1     MapImplExtension</p><br>
<div class="spoiler"><b class="spoiler_title">  MapImpl.kN()</b><div class="spoiler_text"><pre><code class="plaintext hljs">    # v0 - ; v1 - ; v2 - extension;<font></font>
    #  MapImplExtension.kN(...)<font></font>
    iget-object v2, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension;<font></font>
    invoke-virtual {v2, v1, v0}, Lcom/e1c/mobile/MapImplExtension;-&gt;kN([Ljava/lang/String;[D)[Ljava/util/ArrayList;<font></font>
<font></font>
    # v0 -   ; v1 - | ; v2 -   <font></font>
    move-result-object v0<font></font>
    const/4 v2, 0x0<font></font>
    aget-object v1, v0, v2<font></font>
    iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xj:Ljava/util/ArrayList;<font></font>
<font></font>
    const/4 v2, 0x1<font></font>
    aget-object v1, v0, v2<font></font>
    iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xk:Ljava/util/ArrayList;</code></pre></div></div><br>
<p>    â€”      .                .       .                 .</p><br>
<h1 id="dobavlenie-novoy-funkcionalnosti">  </h1><br>
<p>        .   <code>MarkerOptions</code>   <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code>          <code>BitmapDescriptorFactory</code> .</p><br>
<p>      .  1     â€”       .   ,      .    ,        .           â€”          ,     , ,       ,     ,       (        ). </p><br>
<div class="spoiler"><b class="spoiler_title"> (   ).        (45;45)  (46;46)</b><div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pv/cz/lu/pvczlujpmwuu2y2bauzieeszkby.png"></p></div></div><br>
<p>      â€”      ,    .            â€”   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=">  </a>.</p><br>
<pre><code class="java hljs">      Lcom/google/android/gms/maps/model/MarkerOptions -   .<span class="hljs-function">method <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-title">icon</span><span class="hljs-params">(Lcom/google/android/gms/maps/model/a;)</span>Lcom/google/android/gms/maps/model/MarkerOptions</span>;<font></font>
<font></font>
      com.google.android.gms.internal.f.h   :<font></font>
    <span class="hljs-function">b <span class="hljs-title">zza</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zza</span><span class="hljs-params">(String)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zzb</span><span class="hljs-params">(String)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zzi</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zza</span><span class="hljs-params">(<span class="hljs-keyword">float</span>)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zza</span><span class="hljs-params">(Bitmap)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;
    <span class="hljs-function">b <span class="hljs-title">zzc</span><span class="hljs-params">(String)</span> <span class="hljs-keyword">throws</span> RemoteException</span>;<font></font>
<font></font>
      com.google.android.gms.internal.f.j     h    <font></font>
<font></font>
      com.google.android.gms.maps.model.b (BitmapDescriptorFactory)   <font></font>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">fromResource</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">fromAsset</span><span class="hljs-params">(String)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">fromFile</span><span class="hljs-params">(String)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">fromPath</span><span class="hljs-params">(String)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">defaultMarker</span><span class="hljs-params">()</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">defaultMarker</span><span class="hljs-params">(<span class="hljs-keyword">float</span>)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> a <span class="hljs-title">fromBitmap</span><span class="hljs-params">(Bitmap)</span>

         MapImplExtension.java
      xk.<span class="hljs-title">add</span><span class="hljs-params">(new MarkerOptions()</span>.<span class="hljs-title">c</span><span class="hljs-params">(latlng)</span>.<span class="hljs-title">dS</span><span class="hljs-params">(<span class="hljs-string">"  "</span> + titles[i])</span>)</span>;<font></font>
       <font></font>
    MarkerOptions markerOptions = <span class="hljs-keyword">new</span> MarkerOptions()<font></font>
        .c(latlng)<font></font>
        .dS(<span class="hljs-string">"  "</span> + titles[i]);
    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">//     </span><font></font>
        markerOptions.icon(b.defaultMarker(b.HUE_YELLOW));<font></font>
    }<font></font>
    xk.add(markerOptions);<font></font>
</code></pre><br>
<p>  â€”    .     .     ,           dalvik/art,        (       R8        ,       ,      ).</p><br>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èª°ã‹ãŒè‡ªåˆ†ã§ã™ã¹ã¦ã‚’ç¹°ã‚Šè¿”ã—ã€ã•ã‚‰ã«å¤šãã‚’æ‹¾ã†ã“ã¨ã«èˆˆå‘³ãŒã‚ã‚‹å ´åˆã¯</font><font style="vertical-align: inherit;">ã€å¤‰æ›´ã•ã‚ŒãŸå…ƒã®apkã‹ã‚‰æ§‹ç¯‰ã•ã‚ŒãŸæ›²ãŒã£ãŸGradleã‚¹ã‚¯ãƒªãƒ—ãƒˆã¨ã¨ã‚‚ã«ã€ã™ã¹ã¦ã®ã‚½ãƒ¼ã‚¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã‚’githubã«æŠ•ç¨¿ã—ã¾ã—</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ãŸã€‚</font></font></p></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja475254/index.html">AERODISK vAIRã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¾ãŸã¯å…¨å›½ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ§‹ç¯‰ã®æ©Ÿèƒ½</a></li>
<li><a href="../ja475258/index.html">ã‚µãƒ³ã‚¯ãƒˆãƒšãƒ†ãƒ«ãƒ–ãƒ«ã‚¯ã®é¸æŒ™ã®è¦–è¦šçš„è¡¨ç¾-éŸ³å£°ãƒ©ãƒƒãƒ”ãƒ³ã‚°ã®é­”æ³•</a></li>
<li><a href="../ja475260/index.html">éåŒæœŸé–¢æ•°ã¨promiseã‚’è¿”ã™é–¢æ•°ã®é•ã„</a></li>
<li><a href="../ja475262/index.html">å…ˆé€±ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ä¸–ç•Œã‹ã‚‰ã®æ–°é®®ãªé£Ÿæã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆNo.388ï¼ˆ2019å¹´11æœˆ4-10æ—¥ï¼‰</a></li>
<li><a href="../ja475264/index.html">ã§ãã‚‹ã‚¹ãƒ‹ãƒ•ã‚¡ï¼šFakeSecurityãƒ•ã‚¡ãƒŸãƒªãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒˆã‚¢ã«æ„ŸæŸ“ã—ãŸæ–¹æ³•</a></li>
<li><a href="../ja475268/index.html">C ++ãŠã‚ˆã³Javaã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®æ™®éçš„ãªæ–¹æ³•ã¨ã—ã¦ã®ä¸ç¢ºå®Ÿãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼åŒ–ã€‚ä¾¡æ ¼</a></li>
<li><a href="../ja475270/index.html">SwiftUIï¼šãƒªã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼ã§å±•é–‹å¯èƒ½/æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹</a></li>
<li><a href="../ja475272/index.html">Rustã®éåŒæœŸå¾…æ©Ÿã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã¸ã®ç§»è¡Œ</a></li>
<li><a href="../ja475276/index.html">ã‚¢ã‚µãƒ¼ãƒˆã‚’æ­£ã—ãæ›¸ãæ–¹æ³•</a></li>
<li><a href="../ja475278/index.html">ãƒãƒƒã‚«ãƒ¼ãŒã‚ãªãŸã‚’è¦—ãè¦‹ã—ã¦ã„ã‚‹é–“ã«ãƒãƒƒã‚«ãƒ¼ã‚’è¦—ãè¦‹ã™ã‚‹æ–¹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>