<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äç‚öïÔ∏è üë©üèæ‚Äçü§ù‚Äçüë©üèΩ üìã BarsUP.AM: how we developed a tool for protecting information of web applications üòå üë¶üèø üíü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="BarsUp.Access Manager (BarsUp.AM) - our software package for protecting confidential information. When designing and developing this system in accorda...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>BarsUP.AM: how we developed a tool for protecting information of web applications</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/barsgroup/blog/487894/"><img src="https://habrastorage.org/webt/in/-y/om/in-yomp0onem8i3uopz0e31ekwe.jpeg" alt="image"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BarsUp.Access Manager (BarsUp.AM)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - our software package for protecting confidential information. When designing and developing this system in accordance with the requirements of regulatory documents of the FSTEC of Russia, we encountered difficulties in managing access to web applications using certified information protection tools. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Order of the FSTEC of Russia No. 17 says that there should be a choice of information protection tools certified for compliance with information security requirements, taking into account their cost, compatibility with information technology and technical means. We looked at what was on the market at that time and understood: the cost of solutions compatible with our information systems often exceeded the cost of the systems themselves, or they were incompatible.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In this case, the regulator reports that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the absence of suitable means of information protection, their development (revision) and certification in accordance with the legislation of the Russian Federation or the adjustment of design decisions are organized</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We decided to develop and certify in FSTEC of Russia software that implements the functions of user identification and authentication, access control and registration of security events for the possibility of its use:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In automated systems up to security class 1G inclusive according to the requirements of the guidance document ‚ÄúAutomated systems. </font><font style="vertical-align: inherit;">Protection against unauthorized access to information. </font><font style="vertical-align: inherit;">Classification of automated systems and information protection requirements ‚Äù(State Technical Commission of Russia, 1992);</font></font></li>
<li>              11  2013 . ‚Ññ 17 ¬´     ,    ,     ¬ª     11  2014 . ¬´      ¬ª;</li>
<li>      1         18  2013 . ‚Ññ 21 ¬´                     ¬ª.</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The product is called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BarsUP.Access Manager</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BarsUP.AM</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I will remove issues related to obtaining a decision from the FSTEC and concluding agreements with a testing laboratory and certification body beyond the boundaries of this material, and describe how we developed software for protecting web applications.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Start</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
We formed a team consisting of a project manager, information security engineer, analyst, software architect, and two leading developers. During the implementation of the project, we identified the following stages of work: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/xu/bh/3u/xubh3uvuo7tjcgzv-7kc0o5kjry.jpeg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the stage of analysis, we collected requirements from the regulatory documents that can be implemented as a security tool for the web, then we worked together with the developers on the possibility of their implementation in terms of resources spent and time. When discussing the requirements, the language was translated from the normative documents into a language that was understandable to analysts and developers, they formed a roadmap: what should be implemented in the first place, which is optional. We wrote documentation for certification in parallel and after product development. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
At the output, we received a product that solves the following tasks:</font></font><br>
<br>
<ul>
<li>    (SSO)   ;</li>
<li>     ;</li>
<li> ;</li>
<li> ;</li>
<li>      ;</li>
<li>  .</li>
<li>  ,         ;</li>
<li>    ;</li>
<li>  () ,   TOTP ;</li>
<li>     ;</li>
<li>          ;</li>
<li>         ()     ;</li>
<li>  ;</li>
<li>   ;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">horizontal scalability of the system due to clustering.</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The software supports two standards for implementing single sign-on:</font></font></b><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security assertion markup language (SAML);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenID Connect 1.0.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAML Single Sign-On Implementation</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In accordance with the terms of the SAML standard, the software acts as an identity provider (IdP). </font><font style="vertical-align: inherit;">IP subsystems act as service providers (SPs). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The general procedure for working with single sign-on via SAML is presented below:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/j0/ky/rz/j0kyrz85hoazvyddnpyofuc6kni.jpeg" alt="image"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The user is trying to implement web access to the application (SP);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The application checks for the presence of a security context and, in its absence, generates an AuthnRequest message and redirects the user's browser to the authorization server BarsUP.AM (IdP);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The user connects to the authorization server and enters his credentials;</font></font></li>
<li>  ,    ;</li>
<li>          Response;</li>
<li>      ,   Response.   Response    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The exchange of messages between the parties is in the form of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SAML</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> statements </font><b><font style="vertical-align: inherit;">(assertions)</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">SAML claims are transmitted using the secure HTTPS protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A trust relationship is established between the IdP identity provider and the SP service providers. </font><font style="vertical-align: inherit;">Sent SAML messages, including AuthRequest and AuthResponse, are signed using SP and IdP digital certificates, respectively. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
An AuthRequest message is signed with the application‚Äôs private key and delivered to the authorization server using HTTP Redirect, HTTP POST, or HTTP Artifact messages. </font><font style="vertical-align: inherit;">An AuthRequest message, in particular, contains the following information:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Application URL</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IdP Identity Provider URL (BarsUP.AM Authorization Server);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID and time of request creation.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The AuthnResponse response message is signed with the private key of the authorization server. </font><font style="vertical-align: inherit;">An AuthnResponse message, in particular, contains the following information:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthRequest request identifier to which this response corresponds;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Response handler URL</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the period during which the response is considered valid;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User authentication date and time</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user session identifier;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user attributes and their values.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementing Single Sign-On Based on OpenID Connect</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
OpenID Connect is an extension designed to provide user identification and authentication through the OAuth 2.0 protocol. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In the process of implementing single sign-on using OpenID Connect technology, BarsUP.AM acts as an OpenID provider (OpenID Provider, OP). </font><font style="vertical-align: inherit;">Information systems (i.e., targeted web applications accessed by the user) act as the Relying Party (RP), which uses the OP to authenticate the user. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The implementation of single sign-on via OpenID Connect is described in the figure below:</font></font><br>
<br>
<img src="https://habrastorage.org/webt/ee/lx/1y/eelx1y2azind61bfmgseqyi-epy.jpeg" alt="image"><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A user is attempting to access a web application (SP);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The application generates an Authorization Code Request (OAuth2.0 protocol) and redirects the user's browser to the authorization server BarsUP.AM (OP);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User enters their credentials on OP;</font></font></li>
<li>OP      ;</li>
<li>  , OP       RP   .    ,   Authorization Response,    ;</li>
<li>RP   OP,       (Token Request).         TLS;</li>
<li>      , OP  RP     (ID Token, Access Token);</li>
<li>RP         .</li>
</ol><br>
<h4>  BarsUP.AM  web-</h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
To avoid attacks aimed at spoofing the OP or RP, they must mutually authenticate each other. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BarsUP.AM supports the authentication methods defined in the specification for OpenID Connect. </font><font style="vertical-align: inherit;">The principle of operation of OpenID Connect and OAuth 2.0 is based on the use of identification tokens (ID token) and authorization (access token). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
I will give the implementation of the basic security functions in software:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user identification and authentication;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">access control;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">security event logging.</font></font></li>
</ul><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">User Authentication and Authentication</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Identification and authentication is implemented in BarsUP.AM based on username and password. </font><font style="vertical-align: inherit;">The user enters their credentials on the BarsUP.AM authentication web page. </font><font style="vertical-align: inherit;">In this case, the credentials are transmitted in a secure form via the HTTPS protocol. </font><font style="vertical-align: inherit;">Access to the target application is allowed only if authentication is successful. </font><font style="vertical-align: inherit;">Thus, user identification and authentication are realized with remote web access to IP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
When entering the password, the password is not displayed in the web form and the special is replaced. </font><font style="vertical-align: inherit;">characters. </font><font style="vertical-align: inherit;">Due to this, feedback protection is implemented when entering authentication information. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The BarsUP.AM password policy provides for the following settings:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashing algorithm;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ban user name in password;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimum number of digits in a password;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimum password length;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimum number of lower case letters;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimum number of uppercase letters;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minimum number of special characters;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">password history length;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forced password change after a certain period of time;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The minimum number of characters changed in the new password.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BarsUP.AM also supports multi-factor (two-factor) user authentication.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access control</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 BarsUP.AM implements automated user account management support and automatic user account lockout. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The administrator can create, modify, delete, block and unblock user accounts at his discretion. User accounts are created by the administrator using the web console of the BarsUP.AM management server. When creating an account, the name, e-mail address, account validity period and, if necessary, other user attributes are indicated. The password is changed by the user at the first login in accordance with the password policy. User accounts can be grouped with specific group attributes and permissions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The following user account lockout mechanisms are:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">administrator blocking;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocking at the end of the set period of time for using the account;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocking after a period of a specified time of non-use of the account;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocking when exceeding unsuccessful login attempts;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blocking when the number of concurrent sessions is exceeded.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The account will be unblocked by the administrator or after the blocking timeout has elapsed (for example, when it is blocked due to exceeding the number of failed login attempts). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BarsUP.AM implements access control of subjects upon entering the IP. </font><font style="vertical-align: inherit;">Each user or group of users in BarsUP.AM can be assigned roles and rights. </font><font style="vertical-align: inherit;">Rights can apply to a specific system or to the entire domain that includes several systems (applications). </font><font style="vertical-align: inherit;">Information about the role and rights is set by the administrator and is fixed in the form of access attributes.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Security Event Logging</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
BarsUP.AM implements the collection, recording and storage of information about security events during remote web access to IP. </font><font style="vertical-align: inherit;">In particular, events related to changing user passwords, setting up and deleting user accounts, changing access control rules and user permissions are recorded. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Security events are logged in the event log. </font><font style="vertical-align: inherit;">For each event, the date and time, the type of event, the affected system, the user associated with the event, and the IP address of the node are recorded. </font><font style="vertical-align: inherit;">The logging server is used to store event logs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Events are divided into categories, including security events and system events. </font><font style="vertical-align: inherit;">The rights to view the event log are granted to the administrator.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The composition of security events to be recorded can be customized. </font><font style="vertical-align: inherit;">The definition of security events to be recorded and their storage periods is recorded in the organizational and administrative documents for information protection</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The project took us 6 months, excluding the time of testing and the work of the certification body. </font><font style="vertical-align: inherit;">Now, when implementing projects to ensure the protection of information in information systems, we don‚Äôt have a headache, how to protect web applications.</font></font></div>
      
    </div><p class="reference-to-source js-reference-to-source">Source: https://habr.com/ru/post/undefined/</p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en487878/index.html">5 SQL Questions Frequently Asked by Data Scientists for Job Interviews</a></li>
<li><a href="../en487882/index.html">Chrome will automatically block annoying video ads</a></li>
<li><a href="../en487884/index.html">5 things I would like to know before developing the exchange</a></li>
<li><a href="../en487888/index.html">CSRF at Umbraco CMS</a></li>
<li><a href="../en487890/index.html">Translate speech to text on iOS using the Speech framework</a></li>
<li><a href="../en487896/index.html">When death turns into art: epitaphs of famous people with a deep meaning in English</a></li>
<li><a href="../en487898/index.html">Measuring memory bandwidth on the knee</a></li>
<li><a href="../en487900/index.html">pyqtdeploy, or we pack the Python program in exe'shnik ... the hard way</a></li>
<li><a href="../en487902/index.html">From fire to fire: refractory solid-state electrolyte for lithium-ion batteries</a></li>
<li><a href="../en487906/index.html">The book "Computer Networks. Principles, Technologies, Protocols: Anniversary Edition ¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>