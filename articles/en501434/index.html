<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚ÄçüöÄ ü•å üì¥ Security Week 20: hacking a computer through Thunderbolt üç¶ üë©‚Äç‚öñÔ∏è üë©üèø‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a long time in our digest there were no provocative studies about hardware vulnerabilities. Dutch researcher Bjorn Rutenberg found seven holes in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Security Week 20: hacking a computer through Thunderbolt</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/kaspersky/blog/501434/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For a long time in our digest there were no provocative studies about hardware vulnerabilities. Dutch researcher Bjorn Rutenberg found seven holes in Thunderbolt controllers ( </font><font style="vertical-align: inherit;">project </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">scientific</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> work, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">review</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> article in Wired). One way or another, all vulnerabilities allow you to bypass key computer and laptop protection systems if you manage to get physical access to it. In general, you will need to disassemble the device in order to access the flash memory chip with the Thunderbolt controller firmware. Changing the firmware removes all security levels and makes it possible to directly access RAM from an arbitrary external device.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/hs/ic/uu/hsicuu4jaqp_gcflghul06y3dzw.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vulnerabilities are affected by all computers with a Thunderbolt controller released before 2019. Last year, Intel, the main interface developer, implemented the Kernel DMA Protection method, which makes an attack impossible. The introduction of this layer of protection requires hardware changes and is therefore only available in devices released recently, and not all. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The researcher did not find fresh Dell laptops with Kernel DMA Protection, although Lenovo and HP laptops that were also released last year use this system. The potential damage from any vulnerabilities that require physical access to the hardware is small, but the story has developed (not very) beautiful. After all, it cannot be said that until 2019 Thunderbolt protection systems were not in the devices. Ryutenberg's work showed that they do not always work.</font></font><br>
<a name="habracut"></a><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/7uvSZA1F9os" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The author of the study shows the attack algorithm in the video above: in just five minutes, Ryutenberg managed to bypass the Windows lock screen. In reality, you can do it even faster: an attacker does not need to take pictures of himself and give explanations. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On a Lenovo ThinkPad P1 laptop, the researcher reflash the Thunderbolt controller, lowering the level of security. There are only four of them: in SL3 mode, in principle, direct access of external devices to RAM is impossible. SL1 mode is used by default on most laptops and turns on DMA after authorization. Re-flashing the controller resets the settings to SL0 - in this mode, all devices have access to memory without authorization.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Does the controller verify the authenticity of its own firmware? Yes, it checks - but only when updating the software using regular methods, for example, by sending updates to the manufacturer. Direct firmware chip SPI flash programmer is not detected. The most interesting thing is that with such firmware it is possible to block further updates, making the computer permanently vulnerable.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The attack is possible due to a forced reset of the security level, as well as a number of other omissions in the protection of Thunderbolt - for example, in the form of mandatory compatibility of Thunderbolt 3 controllers with the previous version of the interface, where there are no more serious protection methods. </font><font style="vertical-align: inherit;">And on Apple laptops, SL0 mode is forced, if you use the Bootcamp function to boot Windows or Linux - you don‚Äôt even need to flash anything. </font><font style="vertical-align: inherit;">On the project‚Äôs website, the author posted the code of the attack tools, as well as a utility for checking the computer with Thunderbolt.</font></font><br>
<br>
<div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1259718267087785989"></twitter-widget>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Is this a dangerous vulnerability? In general, not very: in Windows and consumer software regularly find local problems with privilege escalation, sometimes providing a similar result </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without using a soldering iron</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . But the attack turned out beautiful, in the style of James Bond films. In the proof-of-concept, the researcher uses a rather cumbersome design to connect to a computer, but if you have the means and desire, you can also make a miniature device, a kind of programmer with notes of espionage.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The work was subjected to the expected criticism: if you reflash the iron, you can do anything with it at all. </font><font style="vertical-align: inherit;">Yes, but such studies are often limited to a theoretical description of vulnerabilities, and a practical attack is shown here. </font><font style="vertical-align: inherit;">Countermeasures against such hacking will also be found, up to the flooding of ports and microcircuits with epoxy resin. </font><font style="vertical-align: inherit;">But in an ideal world there should be no loopholes for such a simple flashing of the device. </font><font style="vertical-align: inherit;">One can argue about the justification of additional security methods, but they exist and are applied. </font><font style="vertical-align: inherit;">Just not in this case.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What else happened</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Microsoft's GitHub account was probably </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacked</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . 500 gigabytes of data were stolen, but it is not yet clear what the consequences will be. The gigabyte sample posted by crackers does not shine with quality and does not even really confirm that it was Microsoft that was hacked. Another major leak </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">occurred</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the GoDaddy registrar - the data on 28 thousand customers was stolen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The Black Hat and DEF CON conferences, traditionally held in the USA in August, </font><font style="vertical-align: inherit;">will be </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canceled</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this year </font><font style="vertical-align: inherit;">but will be held online. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zoom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">has acquired</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Keybase, a cryptographic startup. The first takeover in the company's history was made to implement end-to-end encryption of web conferencing. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The next set of patches for the Android platform </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">closes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Several serious vulnerabilities in the Media Framework. </font><font style="vertical-align: inherit;">One of them can be used to remotely execute arbitrary code. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
The company Pen Test Partners </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">investigated the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algorithm of the TCAS system, which prevents the dangerous approach of aircraft. </font><font style="vertical-align: inherit;">And they showed an example of an attack involving the introduction of radio, as well as the creation of a non-existent object. </font><font style="vertical-align: inherit;">In theory, it is possible to force pilots to make maneuvers that pose a real security risk in an attempt to avoid a collision with a ‚Äúvirtual‚Äù aircraft.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../en501420/index.html">Online Mitapas and YouTube Shows: JUG Ru Group Stream Week</a></li>
<li><a href="../en501424/index.html">From life with Kubernetes: How we removed DBMS (and not only) from review environments to static</a></li>
<li><a href="../en501426/index.html">Unison: setting up and automating two-way synchronization of directories on two servers</a></li>
<li><a href="../en501430/index.html">Great Guide to Website Content Design and Planning</a></li>
<li><a href="../en501432/index.html">Two alternatives to JDBC</a></li>
<li><a href="../en501436/index.html">Number recognition algorithm on the image with a low probability of the second kind of error</a></li>
<li><a href="../en501438/index.html">How 3D game rendering works: lighting and shadows</a></li>
<li><a href="../en501440/index.html">Zabbix 5.0 released</a></li>
<li><a href="../en501448/index.html">How we profiled a unique Agile course</a></li>
<li><a href="../en501450/index.html">14 things an iOS developer must know</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>