<!doctype html>
<html class="no-js" lang="de">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç© üë©üèΩ‚Äçüè≠ üëö Rufen Sie gemeinsam genutzte Bibliotheken von Similink aus auf üêøÔ∏è üì≥ ü§®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! 
 Ich pr√§sentiere Ihnen die √úbersetzung eines Artikels meines Kollegen Mikhail √ºber Methoden zum Aufrufen von gemeinsam genutzten Biblioth...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Rufen Sie gemeinsam genutzte Bibliotheken von Similink aus auf</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/503908/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hallo Habr! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich pr√§sentiere Ihnen die √úbersetzung eines Artikels meines Kollegen Mikhail √ºber Methoden zum Aufrufen von gemeinsam genutzten Bibliotheken in Simulink. Warum wurde es √ºberhaupt geschaffen? Tatsache ist, dass viele Unternehmen bereits viele Legacy-Modelle haben, die wir gerne wiederverwenden m√∂chten, und uns h√§ufig Fragen gestellt werden: ‚ÄûWie kann ich Legacy-Modelle in Simulink integrieren? Und wenn mein Verm√§chtnis in Form einer DLL vorliegt? ‚Äú Daher wurde der Originalartikel geschrieben. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unter der Katze werden verschiedene M√∂glichkeiten zum Aufrufen gemeinsam genutzter Bibliotheken in Simulink erl√§utert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle √Ñnderungen am Code wurden mit Genehmigung von Mikhail vorgenommen, um den Artikel nicht zu √ºberladen.</font></font><br>
<br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel zeigt, wie Funktionen aus gemeinsam genutzten Bibliotheken in Simulink-Modellen verwendet werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Angenommen, wir m√ºssen die Exlib-Bibliothek in Simulink einbetten. </font><font style="vertical-align: inherit;">Sein Code ist in den Quellen von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib.c</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib.h enthalten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies ist eine sehr einfache Bibliothek mit drei Funktionen: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void exlib_init (void)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - √∂ffnet eine Datei zum Schreiben. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void exlib_print (float data)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - schreibt Daten in eine Datei. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">void exlib_term (void)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - schlie√üt die Datei.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bibliotheksmontage</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilieren Sie zun√§chst die Bibliothek. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Schritt ist nicht erforderlich, wenn die Bibliothek vorkompiliert und als Bin√§rdatei geliefert wird. In diesem Fall k√∂nnen Sie sofort mit Schritt 3 fortfahren. Beachten Sie jedoch, dass Sie f√ºr die Arbeit mit der Bibliothek die DLL-Datei (oder .so f√ºr Linux) und die entsprechende Header-Datei (.h) vom Bibliotheksanbieter erhalten m√ºssen. F√ºr Windows ben√∂tigen Sie au√üerdem eine LIB-Datei, bei der es sich nicht um eine statische Bibliothek handelt, sondern um die sogenannte Importbibliothek. Diese Importbibliothek wird f√ºr die implizite Verkn√ºpfung ben√∂tigt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zuerst verwenden wir den Befehl MATLAB mex, der den aktuell aktiven Host-Compiler aufruft, um die gemeinsam genutzte Bibliothek zu kompilieren (exlib.dll unter Windows und exlib.so unter Linux). Es ist wichtig sicherzustellen, dass der Befehl zuerst ausgef√ºhrt wurde.</font></font><br>
<pre><code class="matlab hljs">mex -setup
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
um einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unterst√ºtzten Compiler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auszuw√§hlen </font><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie jetzt mex, um die Bibliothek zu kompilieren:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code zum Erstellen einer Bibliothek</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs">mingw = strfind(mex.getCompilerConfigurations(<span class="hljs-string">'C'</span>,<span class="hljs-string">'Selected'</span>).Name,<span class="hljs-string">'MinGW64 Compiler'</span>);
<span class="hljs-keyword">if</span> isunix
    <span class="hljs-comment">% GCC</span>
    mex(<span class="hljs-string">'LDEXT=.so'</span>,<span class="hljs-string">'LINKEXPORT='</span>,<span class="hljs-string">'LINKEXPORTVER='</span>,<span class="hljs-string">'LINKLIBS='</span>,<span class="hljs-string">'exlib.c'</span>);
<span class="hljs-keyword">elseif</span> mingw
    <span class="hljs-comment">% MinGW builds static shared library, so dll and lib files are the same</span>
    <span class="hljs-comment">% loadlibrary uses the dll file, while legacy code tool looks for the lib file</span>
    mex(<span class="hljs-string">'LDEXT=.lib'</span>,<span class="hljs-string">'LINKEXPORT='</span>,<span class="hljs-string">'LINKEXPORTVER='</span>,<span class="hljs-string">'LINKLIBS='</span>,<span class="hljs-string">'exlib.c'</span>);<font></font>
    mex(<span class="hljs-string">'LDEXT=.dll'</span>,<span class="hljs-string">'LINKEXPORT='</span>,<span class="hljs-string">'LINKEXPORTVER='</span>,<span class="hljs-string">'LINKLIBS='</span>,<span class="hljs-string">'exlib.c'</span>);
<span class="hljs-keyword">else</span>
    <span class="hljs-comment">% Visual</span>
    mex(<span class="hljs-string">'LDEXT=.dll'</span>,<span class="hljs-string">'LINKEXPORT='</span>,<span class="hljs-string">'LINKEXPORTVER='</span>,<span class="hljs-string">'CMDLINE300="del exlib.exp exlib.dll.manifest"'</span>,<span class="hljs-string">'exlib.c'</span>);
<span class="hljs-keyword">end</span>
Building with <span class="hljs-string">'gcc'</span>.<font></font>
MEX completed successfully.</code></pre><br>
</div>
                    </div><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√úberpr√ºfen der kompilierten Bibliothek</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Kompilieren m√ºssen Sie sicherstellen, dass die resultierende Bibliothek geladen und in MATLAB verwendet werden kann:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code zum √úberpr√ºfen der Bibliothek</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-comment">% Load the library</span>
[~,~] = loadlibrary([<span class="hljs-string">'exlib'</span>,system_dependent(<span class="hljs-string">'GetSharedLibExt'</span>)],<span class="hljs-string">'exlib.h'</span>);
<span class="hljs-comment">% Display functions available in the library</span>
libfunctionsview(<span class="hljs-string">'exlib'</span>);
<span class="hljs-comment">% Initialize</span>
calllib(<span class="hljs-string">'exlib'</span>,<span class="hljs-string">'exlib_init'</span>);
<span class="hljs-comment">% Step</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span> = <span class="hljs-number">1</span>:<span class="hljs-number">10</span>
    calllib(<span class="hljs-string">'exlib'</span>,<span class="hljs-string">'exlib_print'</span>,single(<span class="hljs-built_in">i</span>));
<span class="hljs-keyword">end</span>
<span class="hljs-comment">% Terminate</span>
calllib(<span class="hljs-string">'exlib'</span>,<span class="hljs-string">'exlib_term'</span>);
<span class="hljs-comment">% Unload the library</span>
unloadlibrary(<span class="hljs-string">'exlib'</span>);
<span class="hljs-comment">% Show contents of generated file</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span>
</code></pre><br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem wir sichergestellt haben, dass alles funktioniert, k√∂nnen wir mit Simulink beginnen!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufrufen einer gemeinsam genutzten Bibliothek mit S-Funktionen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit S-Funktionen k√∂nnen Sie C-Code in Simulink verwenden. </font><font style="vertical-align: inherit;">Dieser Ansatz erm√∂glicht es dem Benutzer, jeden C-Code zu entwickeln, der zum Laden der Bibliothek und zum Aufrufen ihrer Funktionen erforderlich ist. </font><font style="vertical-align: inherit;">Anschlie√üend wird dieser Code in eine Bin√§rdatei kompiliert, die von Simulink erkannt und mit einer gemeinsam genutzten Bibliothek verkn√ºpft wird. </font><font style="vertical-align: inherit;">Diese Bin√§rdatei wird als S-Funktion bezeichnet. </font><font style="vertical-align: inherit;">Simulink hat einen Block zum Aufrufen dieser S-Funktion. </font><font style="vertical-align: inherit;">Es gibt verschiedene Ans√§tze zum Erstellen von S-Funktionen in Simulink.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden des Legacy-Code-Tools</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Ansatz ist die Verwendung des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legacy-Code-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tools, mit dem Sie automatisch S-Funktionen gem√§√ü den mit MATLAB erstellten Spezifikationen erstellen k√∂nnen. </font><font style="vertical-align: inherit;">In diesem Beispiel ist die S-Funktion mit der Importbibliothek verkn√ºpft (unter Windows ben√∂tigen wir die entsprechende * .lib-Datei) und die Bibliotheksfunktionen werden aufgerufen. </font><font style="vertical-align: inherit;">Dieser Ansatz wird als implizite Verkn√ºpfung bezeichnet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zun√§chst m√ºssen Sie die Struktur f√ºr das Legacy Code Tool initialisieren</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code zum Initialisieren der Legacy Code Tool-Struktur</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs">specs = legacy_code(<span class="hljs-string">'initialize'</span>);
<span class="hljs-comment">% Prototype for the initialization function</span>
specs.StartFcnSpec = <span class="hljs-string">'exlib_init()'</span>;
<span class="hljs-comment">% Prototype for the step function</span>
specs.OutputFcnSpec = <span class="hljs-string">'exlib_print(single u1)'</span>;
<span class="hljs-comment">% Prototype for the terminate function</span>
specs.TerminateFcnSpec = <span class="hljs-string">'exlib_term()'</span>;
<span class="hljs-comment">% Shared library to link with (.so on Linux and .dll on Windows)</span>
specs.HostLibFiles = {[<span class="hljs-string">'exlib'</span>,strrep(system_dependent(<span class="hljs-string">'GetSharedLibExt'</span>),<span class="hljs-string">'.dll'</span>,<span class="hljs-string">'.lib'</span>)]};
<span class="hljs-comment">% We must supply header file when linking with shared library, otherwise</span>
<span class="hljs-comment">% compiler might make wrong assumptions about function's prototype.</span>
specs.HeaderFiles = {<span class="hljs-string">'exlib.h'</span>};<font></font>
specs.SFunctionName = <span class="hljs-string">'sfun_exlib'</span>;
</code></pre><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie eine S-Funktion, kompilieren und verkn√ºpfen Sie sie:</font></font><br>
<pre><code class="matlab hljs">legacy_code(<span class="hljs-string">'generate_for_sim'</span>,specs);<font></font>
### Start Compiling sfun_exlib<font></font>
    mex(<span class="hljs-string">'sfun_exlib.c'</span>, <span class="hljs-string">'-I/tmp/simulink_shrlib_fex'</span>, <span class="hljs-string">'/tmp/simulink_shrlib_fex/exlib.so'</span>)<font></font>
Building with <span class="hljs-string">'gcc'</span>.<font></font>
MEX completed successfully.<font></font>
### Finish Compiling sfun_exlib<font></font>
### Exit<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erstellen Sie abschlie√üend den Simulink-Block:</font></font><br>
<pre><code class="matlab hljs">legacy_code(<span class="hljs-string">'slblock_generate'</span>,specs);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test'</span>);<font></font>
snapnow;<font></font>
sim(<span class="hljs-string">'simlib_test'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manuelles Schreiben von S-Funktionen</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der zweite Ansatz besteht darin, eigene S-Funktionen zum Laden einer gemeinsam genutzten Bibliothek und zum Aufrufen von Funktionen aus dieser Bibliothek zu schreiben. </font><font style="vertical-align: inherit;">Bei diesem Ansatz wird eine explizite Verkn√ºpfung verwendet, die auch als Laufzeitverkn√ºpfung bezeichnet wird. </font><font style="vertical-align: inherit;">Die einfachste L√∂sung besteht darin, die S-Funktion anzupassen, die zuvor vom Legacy Code Tool automatisch generiert wurde. </font><font style="vertical-align: inherit;">In diesem Beispiel werden die Funktionen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mdlStart</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mdlOutputs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mdlTerminate ge√§ndert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sehen diese Funktionen nach √Ñnderungen aus:</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code anzeigen</font></font></b>
                        <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">mdlStart</span><span class="hljs-params">(SimStruct *S)</span>
</span>{
  <span class="hljs-comment">/*
   * Load the dynamic library
   */</span><font></font>
<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(__GNUC__) &amp;&amp; !defined(__MINGW32__)</span>
    <span class="hljs-keyword">void</span> (*exlib_init_ptr)(<span class="hljs-keyword">void</span>);<font></font>
    dllHandle = dlopen(<span class="hljs-string">"./exlib.so"</span>,RTLD_LAZY);<font></font>
    exlib_init_ptr = dlsym(dllHandle, <span class="hljs-string">"exlib_init"</span>);
  <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
    exlib_init_type exlib_init_ptr = <span class="hljs-literal">NULL</span>;<font></font>
    dllHandle = LoadLibrary(<span class="hljs-string">"exlib.dll"</span>);<font></font>
    exlib_init_ptr = (exlib_init_type)GetProcAddress(dllHandle,<span class="hljs-string">"exlib_init"</span>);
  <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
  exlib_init_ptr();<font></font>
}<font></font>
</code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">mdlOutputs</span><span class="hljs-params">(SimStruct *S, int_T tid)</span>
</span>{<font></font>
  real32_T *u1 = <span class="hljs-number">0</span>;<font></font>
<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(__GNUC__) &amp;&amp; !defined(__MINGW32__)</span>
    <span class="hljs-keyword">void</span> (*exlib_print_ptr)(<span class="hljs-keyword">float</span>);<font></font>
    exlib_print_ptr = dlsym(dllHandle,<span class="hljs-string">"exlib_print"</span>);
  <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
    exlib_print_type exlib_print_ptr = <span class="hljs-literal">NULL</span>;<font></font>
    exlib_print_ptr = (exlib_print_type)GetProcAddress(dllHandle,<span class="hljs-string">"exlib_print"</span>);
  <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
<font></font>
  <span class="hljs-comment">/*
   * Get access to Parameter/Input/Output/DWork/size information
   */</span>
  u1 = (real32_T *) ssGetInputPortSignal(S, <span class="hljs-number">0</span>);<font></font>
<font></font>
  <span class="hljs-comment">/*
   * Call the function from library
   */</span><font></font>
  exlib_print_ptr( *u1);<font></font>
}<font></font>
</code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">mdlTerminate</span><span class="hljs-params">(SimStruct *S)</span>
</span>{
  <span class="hljs-comment">/*
   * Unload the dynamic library
   */</span><font></font>
<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(__GNUC__) &amp;&amp; !defined(__MINGW32__)</span>
    <span class="hljs-keyword">void</span> (*exlib_term_ptr)(<span class="hljs-keyword">void</span>);<font></font>
    exlib_term_ptr = dlsym(dllHandle,<span class="hljs-string">"exlib_term"</span>);<font></font>
    exlib_term_ptr();<font></font>
    dlclose(dllHandle);<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
    exlib_term_type exlib_term_ptr = <span class="hljs-literal">NULL</span>;<font></font>
    exlib_term_ptr = (exlib_term_type)GetProcAddress(dllHandle,<span class="hljs-string">"exlib_term"</span>);<font></font>
    exlib_term_ptr();<font></font>
    FreeLibrary(dllHandle);<font></font>
  <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><font></font>
}<font></font>
</code></pre><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kompilieren Sie die resultierende S-Funktion:</font></font><br>
<pre><code class="matlab hljs"><span class="hljs-keyword">if</span> isunix<font></font>
    mex(<span class="hljs-string">'sfun_exlib_dyn.c'</span>,<span class="hljs-string">'-ldl'</span>);
<span class="hljs-keyword">else</span>
    mex(<span class="hljs-string">'sfun_exlib_dyn.c'</span>);
<span class="hljs-keyword">end</span>
Building with <span class="hljs-string">'gcc'</span>.<font></font>
MEX completed successfully.</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und f√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_dyn'</span>);<font></font>
sim(<span class="hljs-string">'simlib_test_dyn'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verwenden des S-Function Builder</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein anderer Ansatz ist die Verwendung des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S-Function Builder-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Blocks </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dies ist eine spezielle Einheit, die hinsichtlich der Komplexit√§t als Kreuzung zwischen dem Legacy Code Tool und handgeschriebenen S-Funktionen angesehen werden kann. </font><font style="vertical-align: inherit;">S-Function Builder bietet eine grafische Oberfl√§che, die die Eigenschaften Ihrer S-Funktion beschreibt, und die S-Funktion wird automatisch erstellt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gibt einige Leistungseinschr√§nkungen und Probleme bei der Verwendung von S-Function Builder. </font><font style="vertical-align: inherit;">Derzeit wird dies als veralteter Ansatz zur Erstellung von S-Funktionen angesehen. </font><font style="vertical-align: inherit;">Es wird empfohlen, den C-Funktionsblock zu verwenden, der in der Version von R2020a enthalten ist und sp√§ter erl√§utert wird.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufrufen einer gemeinsam genutzten Bibliothek mit der MATLAB-Funktion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MATLAB-Funktionsblock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen Sie die MATLAB-Sprache verwenden, um einen benutzerdefinierten Algorithmus in Simulink zu beschreiben. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verwenden Sie die Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coder.ceval</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die nur im Hauptteil der MATLAB-Funktion (und nicht in MATLAB) verwendet werden kann </font><font style="vertical-align: inherit;">, um die </font><i><font style="vertical-align: inherit;">gemeinsam</font></i><font style="vertical-align: inherit;"> genutzte Bibliothek √ºber die MATLAB-Funktion </font><i><font style="vertical-align: inherit;">aufzurufen</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">F√ºr Coder.ceval ist MATLAB Coder nicht erforderlich. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code f√ºr den MATLAB-Funktionsblock, der die gemeinsam genutzte Bibliothek aufruft:</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code anzeigen</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fcn</span><span class="hljs-params">(u)</span></span>
<span class="hljs-comment">%#codegen</span><font></font>
<font></font>
<span class="hljs-comment">% Keep track of initialization and runtime count</span>
<span class="hljs-keyword">persistent</span> runTimeCnt<font></font>
<font></font>
<span class="hljs-comment">% Generate library path on the fly (current directory in this case)</span>
coder.extrinsic(<span class="hljs-string">'pwd'</span>,<span class="hljs-string">'system_dependent'</span>);<font></font>
libpath = coder.const(pwd);<font></font>
<span class="hljs-comment">% Shared library to link with</span>
libname = coder.const([<span class="hljs-string">'exlib'</span>,strrep(system_dependent(<span class="hljs-string">'GetSharedLibExt'</span>),<span class="hljs-string">'.dll'</span>,<span class="hljs-string">'.lib'</span>)]);
<span class="hljs-comment">% Add the external library. Mark it as precompiled, so it won't appear as</span>
<span class="hljs-comment">% makefile target during code generation.</span>
coder.updateBuildInfo(<span class="hljs-string">'addLinkObjects'</span>,libname,libpath,<span class="hljs-number">1000</span>,<span class="hljs-built_in">true</span>,<span class="hljs-built_in">true</span>);<font></font>
coder.updateBuildInfo(<span class="hljs-string">'addIncludePaths'</span>,libpath);<font></font>
coder.cinclude(<span class="hljs-string">'exlib.h'</span>);<font></font>
<font></font>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">isempty</span>(runTimeCnt)
    <span class="hljs-comment">% Initialize</span>
    coder.ceval(<span class="hljs-string">'exlib_init'</span>);<font></font>
    runTimeCnt = <span class="hljs-number">0</span>;
<span class="hljs-keyword">end</span>
<span class="hljs-comment">% Step</span>
coder.ceval(<span class="hljs-string">'exlib_print'</span>,single(u));<font></font>
runTimeCnt = runTimeCnt+<span class="hljs-number">1</span>;
<span class="hljs-comment">% Terminate on the 10th step</span>
<span class="hljs-keyword">if</span> (runTimeCnt == <span class="hljs-number">11</span>)<font></font>
    coder.ceval(<span class="hljs-string">'exlib_term'</span>);
<span class="hljs-keyword">end</span>
</code></pre><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Ansatz hat einen Nachteil - das Fehlen einer guten M√∂glichkeit, die Abschlussfunktion am Ende der Simulation aufzurufen (im Vergleich zum MATLAB-Systemblock). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen die Abschlussfunktion f√ºr das Modell definieren, indem Sie exlib_term () festlegen. in den Modelleinstellungen in der Kategorie </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulationsziel -&gt; Benutzerdefinierter Code -&gt; Funktion beenden</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HINWEIS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wenn der Parameter "Benutzerdefinierten Code </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importieren</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " in den Modelleinstellungen festgelegt ist, m√ºssen Sie alle </font><b><font style="vertical-align: inherit;">Codeabh√§ngigkeiten</font></b><font style="vertical-align: inherit;"> im Bereich "Simulationsziel" angeben (anstatt </font><b><font style="vertical-align: inherit;">coder.cinclude</font></b><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coder.updateBuildInfo zu verwenden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Wenn dieser Parameter nicht festgelegt ist, k√∂nnen Sie die Einstellungen aus Simulationsziel, coder.cinclude und coder.updateBuildInfo kombinieren.</font></font><br>
</i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Eine andere M√∂glichkeit besteht darin, Abh√§ngigkeiten mit zu pflegen</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coder.cinclude</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coder.updateBuildInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und rufen Sie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib_term () gem√§√ü</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konvention auf, wie im obigen Beispiel gezeigt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_mlf'</span>);<font></font>
sim(<span class="hljs-string">'simlib_test_mlf'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufrufen einer gemeinsam genutzten Bibliothek aus Stateflow </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie die Funktionen der gemeinsam genutzten Bibliothek in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stateflow-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diagrammen verwenden </font><b><font style="vertical-align: inherit;">m√∂chten</font></b><font style="vertical-align: inherit;"> , sollten diese Funktionen direkt von Stateflow aufgerufen werden. Die Stateflow-Dokumentation enth√§lt Beispiele, die zeigen, wie dies getan wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Aufrufen einer externen Funktion in Stateflow ist sehr einfach. Sie m√ºssen den Funktionsnamen im Stateflow-Diagramm angeben: </font></font><br>
<img src="https://habrastorage.org/webt/_f/3m/z7/_f3mz7djr11eebq8egiisjpk9ru.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au√üerdem m√ºssen Sie die Modellparameter so konfigurieren, dass Stateflow wei√ü, wo nach diesen externen Funktionen gesucht werden muss. In den Einstellungen der </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulation Target -&gt; Custom Code -&gt; Bibliotheken, Sie</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eingeben m√ºssen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib.lib (oder exlib.so in Linux)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulation Target -&gt; Custom Code -&gt; Header - </font><font style="vertical-align: inherit;">Datei Sie</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eingeben m√ºssen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include "exlib.h"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es ist auch wichtig, nicht zu vergessen, die Abschlussfunktion anzugeben. BEIM</font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulationsziel -&gt; Benutzerdefinierter Code -&gt; Abschlussfunktion</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muss</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exlib_term ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> angeben</font><i><font style="vertical-align: inherit;"> ; </font></i><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs"><span class="hljs-keyword">if</span> isunix<font></font>
    set_param(<span class="hljs-string">'simlib_test_sf'</span>,<span class="hljs-string">'SimUserLibraries'</span>,<span class="hljs-string">'exlib.so'</span>);
<span class="hljs-keyword">end</span>
sim(<span class="hljs-string">'simlib_test_sf'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass die Informationen in diesem Abschnitt f√ºr Stateflow-Diagramme gelten, die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Aktionssprache C verwenden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wenn das Stateflow-Diagramm </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Aktionssprache MATLAB verwendet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ist </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coder.ceval erforderlich</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wie dies bei der MATLAB-Funktion der Fall ist.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufrufen einer gemeinsam genutzten Bibliothek mit dem MATLAB-Systemblock </font></font></h2> <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dem MATLAB-Systemblock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k√∂nnen Sie Systemobjekte in Simulink verwenden. </font><font style="vertical-align: inherit;">Weitere Informationen zu diesem Block finden Sie in der Dokumentation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Unterst√ºtzung f√ºr Systemobjekte wurde in Simulink in der Version von R2013b ver√∂ffentlicht. </font><font style="vertical-align: inherit;">Viele Benutzer verwenden Systemobjekte, weil sie die Definition der Initialisierungs-, Simulations- und Abschlussfunktionen vereinfachen. </font><font style="vertical-align: inherit;">Au√üerdem k√∂nnen Systemobjekte den zus√§tzlichen MATLAB-Code f√ºr diese Funktionen verwenden, z. B. f√ºr die Vor- und Nachbearbeitung von Daten einer Schrittfunktion, ohne C-Code schreiben zu m√ºssen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So sieht das im MATLAB-Systemblock verwendete Systemobjekt aus:</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systemobjektcode</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-keyword">classdef</span> exlib &lt; matlab.System
    <span class="hljs-comment">% Call exlib shared library</span>
    <span class="hljs-comment">%</span>
    <span class="hljs-comment">% This example shows how to call shared library from Simulink using</span>
    <span class="hljs-comment">% MATLAB System block.</span>
    <span class="hljs-keyword">properties</span> (Nontunable,Access=private)<font></font>
        libName = exlib.getLibName;<font></font>
        libPath = pwd;<font></font>
        libHeader = <span class="hljs-string">'exlib.h'</span>;
    <span class="hljs-keyword">end</span><font></font>
    <font></font>
    <span class="hljs-keyword">methods</span> (Static)
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">libName</span> = <span class="hljs-title">getLibName</span></span>
            <span class="hljs-keyword">if</span> isunix<font></font>
                libName = <span class="hljs-string">'exlib.so'</span>;
            <span class="hljs-keyword">else</span>
                libName = <span class="hljs-string">'exlib.lib'</span>;
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span><font></font>
    <font></font>
    <span class="hljs-keyword">methods</span> (Access=protected)
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupImpl</span><span class="hljs-params">(obj, ~)</span></span>
            <span class="hljs-comment">% Initialize.</span>
            coder.updateBuildInfo(<span class="hljs-string">'addLinkObjects'</span>,obj.libName,obj.libPath,<span class="hljs-number">1000</span>,<span class="hljs-built_in">true</span>,<span class="hljs-built_in">true</span>);<font></font>
            coder.updateBuildInfo(<span class="hljs-string">'addIncludePaths'</span>,obj.libPath);<font></font>
            coder.cinclude(obj.libHeader);<font></font>
            coder.ceval(<span class="hljs-string">'exlib_init'</span>);
        <span class="hljs-keyword">end</span><font></font>
        <font></font>
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stepImpl</span><span class="hljs-params">(~, u)</span></span>
            <span class="hljs-comment">% Step.</span>
            coder.ceval(<span class="hljs-string">'exlib_print'</span>,u);
        <span class="hljs-keyword">end</span><font></font>
        <font></font>
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">releaseImpl</span><span class="hljs-params">(~)</span></span>
            <span class="hljs-comment">% Terminate.</span>
            coder.ceval(<span class="hljs-string">'exlib_term'</span>);
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_mls'</span>);<font></font>
sim(<span class="hljs-string">'simlib_test_mls'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufen Sie gemeinsam genutzte Bibliotheken mit dem C Caller-Block auf </font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C Caller-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">k√∂nnen Sie C-Funktionen direkt von Simulink aus aufrufen. Weitere Informationen zu diesem Block finden Sie in der Dokumentation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies ist ein relativ neuer Ansatz, der erstmals in MATLAB R2018b vorgestellt wurde. Hauptziel ist es, Funktionsaufrufe und C-Bibliotheken in Simulink extrem einfach zu gestalten. Es gibt jedoch Einschr√§nkungen, √ºber die Sie in der Dokumentation zu diesem Block lesen k√∂nnen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib.so/exlib.lib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulationsziel -&gt; Bibliotheken</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include "exlib.h"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulationsziel -&gt; Header</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Modelleinstellungen </font><font style="vertical-align: inherit;">hinzugef√ºgt wurde </font><font style="vertical-align: inherit;">, klicken Sie einfach auf die Schaltfl√§che "Benutzerdefinierten Code </font><i><font style="vertical-align: inherit;">aktualisieren"</font></i><font style="vertical-align: inherit;"> im </font><font style="vertical-align: inherit;">C-Anruferblock. um alle in der Bibliothek enthaltenen Funktionen zu sehen.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach Auswahl der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib_print</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird das Dialogfeld </font></font><br>
<img src="https://habrastorage.org/webt/4s/sz/bd/4sszbddxgbpffb3urxzbw2dv-ua.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
f√ºr die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portspezifikation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> automatisch ausgef√ºllt: </font><i><font style="vertical-align: inherit;">Au√üerdem </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√ºssen Sie die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktionsaufrufe </font><i><font style="vertical-align: inherit;">exlib_init</font></i><font style="vertical-align: inherit;"> und </font><i><font style="vertical-align: inherit;">exlib_term</font></i><font style="vertical-align: inherit;"> zum Simulationsziel </font><font style="vertical-align: inherit;">hinzuf√ºgen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie k√∂nnen auch einige andere C Caller-Bl√∂cke hinzuf√ºgen, um die Initialisierungs- und Beendigungsfunktionen direkt aufzurufen. </font><font style="vertical-align: inherit;">Diese C-Aufruferbl√∂cke m√ºssen in den Subsystemen Funktion initialisieren und Funktion beenden platziert werden. </font><font style="vertical-align: inherit;">Sie k√∂nnen auch das folgende Beispiel aus Stateflow betrachten: Planen der Ausf√ºhrung von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subsystemen zu bestimmten Zeiten</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
F√ºhren Sie die Simulation aus:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_ccaller'</span>);
<span class="hljs-keyword">if</span> isunix<font></font>
    set_param(<span class="hljs-string">'simlib_test_ccaller'</span>,<span class="hljs-string">'SimUserLibraries'</span>,<span class="hljs-string">'exlib.so'</span>);
<span class="hljs-keyword">end</span>
sim(<span class="hljs-string">'simlib_test_ccaller'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gemeinsame Bibliotheken mit dem C-Funktionsblock aufrufen</font></font></h2> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die neueste Erg√§nzung zur Integration von externem Code in Simulink ist der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C-Funktionsblock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Er erschien in der R2020a. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es √§hnelt in seiner Benutzerfreundlichkeit dem C-Caller-Block, erm√∂glicht jedoch das Erstellen eines C-Wrappers um importierte Funktionen (daher √§hnelt dieser Block dem S-Function Builder). H√∂chstwahrscheinlich besteht das Hauptszenario f√ºr die Verwendung des C-Funktionsblocks jedoch nicht darin, vorhandene C-Funktionen aufzurufen, sondern kleine Teile des C-Codes zu schreiben, wenn dieser Code in der Anwendung ben√∂tigt wird. Beispielsweise ben√∂tigen Sie m√∂glicherweise Zugriff auf Hardwareregister oder die integrierten Funktionen des Compilers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergessen Sie nicht, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exlib.so/exlib.lib</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zu den Einstellungen </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Simulationsziel -&gt; Bibliotheken"</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#include "exlib.h" hinzuzuf√ºgen.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in den Einstellungen </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Simulationsziel -&gt; Header-Datei"</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in den Modelleinstellungen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach m√ºssen Sie in den Einstellungen des C-Funktionsblocks ein Zeichen f√ºr die Eingabedaten mit dem Datentyp single hinzuf√ºgen und den Ausgabe-, Start- und Endcode angeben:</font></font><br>
<img src="https://habrastorage.org/webt/pm/ek/uz/pmekuz8kkzafgxf8ky1v8coqqla.png"><br>
<br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_cfunction'</span>);
<span class="hljs-keyword">if</span> isunix<font></font>
    set_param(<span class="hljs-string">'simlib_test_cfunction'</span>,<span class="hljs-string">'SimUserLibraries'</span>,<span class="hljs-string">'exlib.so'</span>);
<span class="hljs-keyword">end</span>
sim(<span class="hljs-string">'simlib_test_cfunction'</span>);
<span class="hljs-comment">% Observe the results:</span>
<span class="hljs-built_in">type</span>(<span class="hljs-string">'exlib.txt'</span>);
<span class="hljs-number">0.000000</span>
<span class="hljs-number">1.000000</span>
<span class="hljs-number">2.000000</span>
<span class="hljs-number">3.000000</span>
<span class="hljs-number">4.000000</span>
<span class="hljs-number">5.000000</span>
<span class="hljs-number">6.000000</span>
<span class="hljs-number">7.000000</span>
<span class="hljs-number">8.000000</span>
<span class="hljs-number">9.000000</span>
<span class="hljs-number">10.000000</span></code></pre><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aufrufen von gemeinsam genutzten Bibliotheken, die mit Embedded Coder erstellt wurden </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eines der Szenarien f√ºr die Verwendung von Embedded Coder ist die automatische Generierung von C-Code aus dem Simulink-Modell und das Packen dieses Codes in eine gemeinsam genutzte Bibliothek. Die Dokumentation enth√§lt auch ein Beispiel, das zeigt, wie eine gemeinsam genutzte Bibliothek automatisch generiert und von einer in C geschriebenen externen Anwendung aufgerufen wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Beachten Sie, dass es besser ist, den Algorithmus oder einen Teil des Algorithmus als C-Code im selben Simulink-Modell auszuf√ºhren S-Funktionen von Simulink Coder oder </font><i><font style="vertical-align: inherit;">Software-in-the-Loop-</font></i><font style="vertical-align: inherit;"> Simulation</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Wenn jedoch die vom Embedded Coder generierte gemeinsam genutzte Bibliothek f√ºr die naturnahe Modellierung verwendet wird, m√ºssen Sie m√∂glicherweise dieselbe Bibliothek in das gr√∂√üere Modell anderer Entwickler integrieren und so Ihr geistiges Eigentum sch√ºtzen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Arbeit mit einer von Embedded Coder generierten gemeinsam genutzten Bibliothek unterscheidet sich nicht von der Arbeit mit einer gemeinsam genutzten Bibliothek, die im Artikel verwendet wurde. </font><font style="vertical-align: inherit;">Stellen Sie sich ein einfaches Modell mit zwei Eing√§ngen und einem Ausgang vor:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_ert'</span>);<font></font>
snapnow;<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/wt/vo/wu/wtvowu3jc24ttsqd1qfgok9jxpc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach dem Zusammenstellen des Modells erhalten wir eine DLL-Datei (.so unter Linux), eine LIB-Datei (eine Importbibliothek f√ºr DLL) und eine EXP-Datei (eine Exportdatei f√ºr die Kommunikation mit DLL).</font></font><br>
<pre><code class="matlab hljs"><span class="hljs-keyword">if</span> isunix<font></font>
    set_param(<span class="hljs-string">'simlib_test_ert'</span>,<span class="hljs-string">'CustomHeaderCode'</span>,<span class="hljs-string">'#include &lt;stddef.h&gt;'</span>);
<span class="hljs-keyword">end</span>
rtwbuild(<span class="hljs-string">'simlib_test_ert'</span>);<font></font>
### Starting build procedure <span class="hljs-keyword">for</span>: simlib_test_ert<font></font>
### Successful completion of build procedure <span class="hljs-keyword">for</span>: simlib_test_ert</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die generierte gemeinsam genutzte Bibliothek exportiert die folgenden Zeichen:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-function">ex_init
<span class="hljs-keyword">double</span> <span class="hljs-title">ex_step</span><span class="hljs-params">(<span class="hljs-keyword">double</span>, <span class="hljs-keyword">double</span>)</span>
simlib_test_ert_terminate</span></code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Standardm√§√üig werden Ein- und Ausgaben als globale Zeichen exportiert, und die Initialisierungs-, Schritt- und Abschlussfunktionen folgen der Modellbenennungskonvention. </font><font style="vertical-align: inherit;">Bei Bedarf k√∂nnen Sie Funktionsprototypen, Symbolnamen und mehr konfigurieren (eine Erl√§uterung dieser Einstellungen w√ºrde den Rahmen dieses Artikels sprengen). </font><font style="vertical-align: inherit;">In diesem Modell ist der Prototyp der Schrittfunktion des Modells als </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Out1 = ex_step (In1, In2) definiert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um diese Funktionen aufzurufen, m√ºssen Sie eine der oben aufgef√ºhrten Methoden verwenden. </font><font style="vertical-align: inherit;">Sie k√∂nnen beispielsweise die MATLAB-Funktion verwenden (der Einfachheit halber nennen wir nur die Schrittfunktion):</font></font><br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code anzeigen</font></font></b>
                        <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">fcn</span><span class="hljs-params">(u1, u2)</span></span>
<span class="hljs-comment">%#codegen</span><font></font>
<font></font>
<span class="hljs-comment">% Generate library path on the fly</span>
coder.extrinsic(<span class="hljs-string">'RTW.getBuildDir'</span>,<span class="hljs-string">'fullfile'</span>);<font></font>
buildDir = coder.const(RTW.getBuildDir(<span class="hljs-string">'simlib_test_ert'</span>));<font></font>
libpath = coder.const(buildDir.CodeGenFolder);<font></font>
incpath = coder.const(fullfile(buildDir.BuildDirectory,<span class="hljs-string">'simlib_test_ert.h'</span>));
<span class="hljs-comment">% Shared library to link with</span>
<span class="hljs-keyword">if</span> isunix<font></font>
    ext = <span class="hljs-string">'.so'</span>;<font></font>
    libname = [<span class="hljs-string">'simlib_test_ert'</span>,ext];
<span class="hljs-keyword">else</span>
    ext = <span class="hljs-string">'.lib'</span>;<font></font>
    libname = [<span class="hljs-string">'simlib_test_ert_'</span>,computer(<span class="hljs-string">'arch'</span>),ext];
<span class="hljs-keyword">end</span>
<span class="hljs-comment">% Add the external library. Mark it as precompiled, so it won't appear as</span>
<span class="hljs-comment">% makefile target during code generation.</span>
coder.updateBuildInfo(<span class="hljs-string">'addLinkObjects'</span>,libname,libpath,<span class="hljs-number">1000</span>,<span class="hljs-built_in">true</span>,<span class="hljs-built_in">true</span>);<font></font>
coder.updateBuildInfo(<span class="hljs-string">'addIncludePaths'</span>,libpath);<font></font>
coder.cinclude(incpath);<font></font>
<font></font>
<span class="hljs-comment">% Initialize output</span>
y = <span class="hljs-number">0</span>;
<span class="hljs-comment">% Step</span>
y = coder.ceval(<span class="hljs-string">'ex_step'</span>,u1,u2);</code></pre><br>
</div>
                    </div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºhren Sie die Simulation aus und sehen Sie sich die Ergebnisse an:</font></font><br>
<pre><code class="matlab hljs">open_system(<span class="hljs-string">'simlib_test_callert'</span>);<font></font>
sim(<span class="hljs-string">'simlib_test_callert'</span>);<font></font>
snapnow;<font></font>
</code></pre><br>
<img src="https://habrastorage.org/webt/ga/qw/vt/gaqwvt2gg4g87wrtxufr78pezxa.png"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dieser Artikel beschreibt verschiedene Ans√§tze zum Aufrufen gemeinsam genutzter Bibliotheken aus Simulink-Modellen. </font><font style="vertical-align: inherit;">Es wurden sowohl implizite als auch explizite Links ber√ºcksichtigt. </font><font style="vertical-align: inherit;">Alle Methoden haben ihre Vor- und Nachteile, und ihre Eignung h√§ngt von den spezifischen Arbeitsabl√§ufen, Anforderungen und Zielen ab. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der </font><font style="vertical-align: inherit;">Ansatz des </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Legacy Code Tools</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> funktioniert am besten, wenn eine implizite Verkn√ºpfung mit einer gemeinsam genutzten Bibliothek implementiert wird. In diesem Fall k√∂nnen wir Funktionen einfach direkt aus der Bibliothek aufrufen, und der Linker k√ºmmert sich um den Rest. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der MATLAB-Systemblock</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein weiterer Ansatz, der die folgenden Vorteile bietet:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hervorragende √úbereinstimmung mit dem Paradigma der Initialisierungs-, Schritt- und Abschlussfunktionen, sodass Sie alle diese Funktionen innerhalb des Blocks selbst und nicht im Ma√üstab des Modells beibehalten k√∂nnen</font></font><br>
</li>
<li>       <br>
</li>
<li>    MATLAB     MATLAB<br>
</li>
<li> MATLAB System           (,    S-)<br>
</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Nachteil der Verwendung des MATLAB-Funktionsblocks besteht darin, dass seine Verwendung zu einem zus√§tzlichen Overhead w√§hrend der Codegenerierung f√ºhren kann. Daher werden die Funktionen Legacy Code Tool und S weiterhin zum Generieren von Produktionscode bevorzugt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine handgeschriebene S-Funktion eignet sich am besten zum Implementieren einer expliziten Verkn√ºpfung zu einer gemeinsam genutzten Bibliothek. In diesem Fall m√ºssen Sie Funktionen wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoadLibrary / dlopen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetProcAddress / dlsym</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeLibrary / dlclose</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verwenden, um Funktionen aufrufen zu k√∂nnen. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in R2018b eingef√ºhrte </font><b><font style="vertical-align: inherit;">C-Caller-Block</font></b><font style="vertical-align: inherit;"> ist bei weitem der einfachste Weg, C-Funktionen aufzurufen, hat jedoch seine Grenzen. Gleiches gilt f√ºr den </font><b><font style="vertical-align: inherit;">C-Funktionsbaustein</font></b><font style="vertical-align: inherit;"> .</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das ist die neueste Erg√§nzung zum R2020a. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Download - </font><font style="vertical-align: inherit;">Quellen und Modelle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de503894/index.html">Ank√ºndigung des Online-Meetings NskTechTalks # 12: Wo kann der Front-End-Entwickler wachsen und was ist, wenn nichts daraus wird?</a></li>
<li><a href="../de503898/index.html">Eines Tages Remote-Frontend</a></li>
<li><a href="../de503902/index.html">So bringen Sie Nachbarn dazu, an ihrem Projekt oder InnerSource f√ºr eine Bank zu arbeiten</a></li>
<li><a href="../de503904/index.html">Die Welt und n Welten oder Mathematik f√ºr die Geisteswissenschaften</a></li>
<li><a href="../de503906/index.html">LabVIEW NXG - Einfache Datentypen und Typenzwang</a></li>
<li><a href="../de503910/index.html">Experimente an Menschen, die nach "udalenka" gegangen sind</a></li>
<li><a href="../de503916/index.html">Lernen, an der B√∂rse zu handeln. Teil eins: Einrichten einer Testumgebung</a></li>
<li><a href="../de503918/index.html">Verwalten von Paketen mit Go-Modulen: Ein pragmatischer Leitfaden</a></li>
<li><a href="../de503920/index.html">Wie wir Mikrofonsysteme auf STM32 testen: die Erfahrung von Yandex-Ger√§teentwicklern</a></li>
<li><a href="../de503922/index.html">Warum beseitigt die EU Keksw√§nde?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>