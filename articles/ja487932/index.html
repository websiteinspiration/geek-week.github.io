<!doctype html>
<html class="no-js" lang="ja">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👍🏼 🗾 🙅🏽 Unity（および他のプログラム）の理想的な法線マップ 🚶🏽 🛀🏿 🏮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="...そして、コンテンツ作成パイプラインの何が問題かを理解する方法。
 
 
 アーティストが取り組んだ驚くべきハイポリモデルがあり、それをゲームに入れたいとします。アーティストは彼のプログラムでモデルのスクリーンショットを見せました、そして彼らは驚くほどに見えます。低ポリゴンバージョンの法線マップ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Unity（および他のプログラム）の理想的な法線マップ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/487932/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...そして、コンテンツ作成パイプラインの何が問題かを理解する方法。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/89e/6f3/877/89e6f38773acdefc8f2680cf7bfd223a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
アーティストが取り組んだ驚くべきハイポリモデルがあり、それをゲームに入れたいとします。</font><font style="vertical-align: inherit;">アーティストは彼のプログラムでモデルのスクリーンショットを見せました、そして彼らは驚くほどに見えます。</font><font style="vertical-align: inherit;">低ポリゴンバージョンの法線マップをベイクした後でも、見栄えがよくなります。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a4/810/be8/3a4810be8abd5ad6cb24fca98ee9e61c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線マップをテストするためのこの伝統的なモデルの素晴らしさをご覧ください！</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それから、アーティストは彼女をゲームに入れます、そして、彼女は見えます...少し間違っています。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/350/fa2/e70/350fa2e7020b28db82bf99958d10f958.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これらの面は平らであるべきではありませんか？</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
平らであるはずの表面はまだ少し丸みを帯びており、一部は凹んでおり、さらに悪いことに、奇妙な縞がそれらに沿っています。</font><font style="vertical-align: inherit;">身近な状況？</font><font style="vertical-align: inherit;">おそらくそれを見つけた人もいるだろうと思い、「まあ、たぶん、それはうまくいかないだろう」と考えて先に進みました。</font><font style="vertical-align: inherit;">おそらく、最も深刻なケースを隠すために少し汚れが付けられました。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
しかし、実際にはコンテンツ作成パイプラインに問題があります。</font><font style="vertical-align: inherit;">これは必ずしも明白ではありませんが、問題は解決できます！* </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*場合によっては、コンテンツパイプラインに変更を加えることができると想定した場合。</font></font></i><a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">序文</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事では、Unity 5.3以降で使用するために他のアプリケーションから理想的な法線マップをエクスポートする方法について説明します。</font><font style="vertical-align: inherit;">高品質の法線マップを取得する方法については説明していません。これには他にも多くのチュートリアルがあるため、このトピックについては触れません。</font></font><br>
<br>
<hr><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間基準</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
問題は、接線空間の法線マップがどのように機能するかです。特に、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（または接線基準）</font><font style="vertical-align: inherit;">はどのように機能しますか</font><font style="vertical-align: inherit;">。私は彼らが何をしているのかという技術的な側面にはあまり深く入りません。私は他の著者と同様に</font></font><a rel="noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">これについて</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">すでに</font><a rel="noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u="><font style="vertical-align: inherit;">話しました</font></a><font style="vertical-align: inherit;">が、簡単に言えば、接線空間は法線マップの方向の向きを表します。法線マップのどちらの方向が実際に「前方」、「上」、または「右」か。大まかに言えば、この向きはテクスチャのUV座標と頂点の法線の向きです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
法線マップをハイポリメッシュからローポリメッシュにベイクするために使用されるプログラムは、その接線空間を計算する必要があることを理解することがより重要です。</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線マップが使用されるプログラムとまったく同じ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">です。</font><font style="vertical-align: inherit;">プログラムによって接線空間の使用方法が異なるため、メッシュの通常のベイク処理されたマップは、すべてのアプリケーションで同じであるとは限りません。</font><font style="vertical-align: inherit;">同じ接線空間を使用するアプリケーションでも！</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">己の敵を知れ</font></font></h1><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">明らかな間違いによるクーデター</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最も一般的な間違いは、「OpenGLとDirect3D」の問題です。</font><font style="vertical-align: inherit;">それらは、法線マップY +およびY-とも呼ばれます。</font><font style="vertical-align: inherit;">完全を期すためにここに含めました。</font><font style="vertical-align: inherit;">おそらく、この問題に遭遇したほとんどの人はすでにそれについて知っているか、少なくともそれを解決する方法を学びました。</font><font style="vertical-align: inherit;">法線マップは1つの方向で生成されるので、別の方向を使用するように設計されたアプリケーションで使用するのには本質的に役に立ちません。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/39a/064/afd/39a064afd8830af08c8841d279e234bc.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnityエンジンのDirect3D方向の法線マップ。</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
これは</font><i><font style="vertical-align: inherit;">OpenGLの方向を想定しています。</font></i><font style="vertical-align: inherit;">これは、照明が逆になっている、または反対側から落ちているように見えるという事実によって理解できますが、一部の照明方向のみです。光源を移動するまで、一部のコーナーまたは面が完全に正常に見える場合があります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そしてこの問題で、すべてが十分に明確です。</font><font style="vertical-align: inherit;">ほとんどの通常のマップベイクアプリケーションには、OpenGL / Direct3DまたはY方向オプションを切り替えるための素敵な大きなボタンまたはメニューがあります。ターゲットアプリケーションが使用する方向を見つけ、その中でマップをベイクします。</font><font style="vertical-align: inherit;">UnityはOpenGLとY +を使用します。</font><font style="vertical-align: inherit;">アンリアルはDirect3DとY-を使用します。</font><font style="vertical-align: inherit;">これは、法線マップ自体のテクスチャを見ると明確に理解できます。</font><font style="vertical-align: inherit;">緑のチャネルで「上から」点灯しているように見える場合、これはOpenGLの向きです。</font><font style="vertical-align: inherit;">下からの場合、これはDirect3Dです。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sRGBの奇妙さ</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
もう1つのよくある間違いは、sRGBテクスチャとしてマークされたテクスチャを使用することです。これにより、GPUテクスチャのサンプリング方法が変更され、通常はカラー値を選択するsRGBスペースのカラー値が線形カラースペースに強制的に変換されます。法線マップの場合、これは必要ありません。 Unityでテクスチャのタイプを「ノーマルマップ」に設定すると、エンジンはこのオプションを自動的に無効にしますが、「sRGB（カラーテクスチャ）」オプションを手動で無効にすることもでき、テクスチャはノーマルマップとして機能します。 Unity 2017.1以降では少なくとも。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eed/4fa/006/eed4fa006eb6dc4cb232b61f6df0d95d.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトテクスチャタイプとsRGBが有効な</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
法線マップこの問題は、法線マップが一方向に強くバイアスされているという事実によって認識できます。</font><font style="vertical-align: inherit;">このモデルでは、ほとんどすべての顔が光源に向けられているように見えます。</font><font style="vertical-align: inherit;">明らかに、これは常に当てはまるとは限りません。</font><font style="vertical-align: inherit;">より詳細な法線マップでは、すべてのパーツがほぼ正しく照明に反応しますが、少し角度がずれます。</font><font style="vertical-align: inherit;">メッシュの表面全体が歪んでいるように見える場合があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正常ではない</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
別の一般的な問題は、ゲームアセットで異なる通常のベイクメッシュを使用することです。</font><font style="vertical-align: inherit;">接線と同様に、すべてが機能するためには、それらが</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正確に</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一致し</font><font style="vertical-align: inherit;">ている必要があり</font><em><font style="vertical-align: inherit;">ます</font></em><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">このエラーは、アーティストが不正な頂点法線でメッシュをエクスポートする場合によく発生します。</font><font style="vertical-align: inherit;">この場合、メッシュを開くアプリケーションはすべて、自分で計算する必要があります。</font><font style="vertical-align: inherit;">それを解決する正しい方法は1つではありません。すべてメッシュに依存するため、最終的な法線を使用してモデルをエクスポートすることを確認してください（またはアーティスト）。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/26b/196/2f9/26b1962f97b26c1f90e1143007844e30.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">滑らかなメッシュに焼き付けられた法線マップ。鋭いエッジを持つメッシュのように表示されます</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/970/07c/51d/97007c51d1aea9f42e5971e1a3d79ef6.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">滑らかなメッシュのように表示される、鋭いエッジを持つメッシュ上で焼き付けられた法線マップ</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは見つけやすい別の問題です。モデルが鋭いエッジを持っているように見えるが、シェーディングがこれらのエッジから曲がっている場合、これは、法線マップを滑らかな法線でベイク処理したが、鋭いエッジのあるメッシュ上にレンダリングされたことを意味します。シェーディングがエッジに向かって曲がっている場合、これは、マップが鋭いエッジでベイク処理され、滑らかなエッジにレンダリングされたことを意味します。実際、1つのモデルでは両方のケースが存在する可能性があります。これは、個々のエッジの滑らかさまたは鋭さ、さらには滑らかさの程度を示すことができるためです。しかし、実際には、別のアプリケーションがそれがどうあるべきかを推測することを許可する場合、それらは誤っていることが保証されています。上記のモデルは極端な場合であり、モデルの大部分が完全に正常に見える可能性があるため、多くの場合すべてがそれほど明白ではありません。しかし、一般的なケースでは、特に奇妙に見えるエッジがいくつかある場合、これはおそらく頂点法線の不一致が原因です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpace対Autodesk</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
あまり目立たない問題は、3ds MaxまたはMayaの法線マップをベイクすると、Unityエンジンで常に正しくないことです。</font><font style="vertical-align: inherit;">それらは、Unrealおよびその他のほとんどのプログラムで間違っています。ただし、それらがベイクされたプログラムは例外です。</font><font style="vertical-align: inherit;">3ds Maxの法線マップはMayaでは機能せず、その逆も同様です。</font><font style="vertical-align: inherit;">これらの各アプリケーションは、独自の方法で接線空間を計算しますが、これは他のアプリケーションには対応していません。</font><font style="vertical-align: inherit;">独立して使用すると、それらは</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完璧</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">に見え</font><font style="vertical-align: inherit;">ます。これらのプログラムで使用する法線マップを生成する場合は、それらの法線マップをベイクしてみてください。</font><font style="vertical-align: inherit;">これらのアプリケーションの正しい法線マップをベイクできるプログラムは</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">他に</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ほとんどない</font><font style="vertical-align: inherit;">ため、選択の余地はないようです。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この場合の唯一の解決策は、他の場所で使用したい場合に、これらのアプリケーションで法線マップをベイクしないことです。</font><font style="vertical-align: inherit;">無料のプログラムが必要な場合は、</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xNormal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を使用して</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">ください</font></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">これは業界標準のツールです。</font><font style="vertical-align: inherit;">コンテンツ作成パイプラインのどこかでSubstanceを使用する場合は、それを使用します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/350/fa2/e70/350fa2e7020b28db82bf99958d10f958.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3ds MaxがUnityが使用する法線マップを焼き付けました</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
この問題に気付く最も簡単な方法は、平らな面に小さなへこみや曲率があることを確認することです。</font><font style="vertical-align: inherit;">場合によっては、これは特に有機物では非常に目立たなくなることがあります。</font><font style="vertical-align: inherit;">したがって、この種の問題は気付かれないことがよくあります。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
オートデスク以外の多くのアプリケーションは、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">MikkTSpace</font></a><font style="vertical-align: inherit;">と呼ばれる接線空間計算方法に切り替えました</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">xNormalとSubstanceの両方、およびBlender、Unity、Unreal、Godot、Marmoset、Houdini、Modoなどのいくつかは、デフォルトでMikkTSpaceを使用するか、少なくとも何らかの形でサポートしており、互換性が大幅に向上しています。</font><font style="vertical-align: inherit;">実際、過去10年間で、接線空間の法線マップが使用されるすべてのケースで、業界標準になっています。</font><font style="vertical-align: inherit;">おそらく、ある時点で3ds Maxがサポートを追加する予定ですが、開発者がMikkTSpaceを使用して法線マップのベイクを許可するのか、それとも単に表示/レンダリングのサポートを提供するのかは不明です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュとサブスタンスペインターのエクスポート</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3ds MaxとMayaのもう1つの問題は、それらからメッシュをエクスポートするときに、「接線と従法線」を使用したエクスポートオプションがあることです。それらはMikkTSpaceの実際の接線にはありませんが、それらに基づいています。一部のアプリケーションはデフォルトで正しいMikkTSpaceを強制的に再計算しますが（たとえば、xNormal、Unity、Unreal）、他のアプリケーションは（存在する場合）接線メッシュを「そのまま」使用し、メッシュに接線がない場合にのみMikkTSpaceを計算します。たとえば、Substance Painterは、接線メッシュがそのまま存在する場合に使用します。つまり、Painterはベイクされた3ds Maxに非常によく似た法線マップを作成します。似ていますが、まったく同じではないため、3ds Maxにインポートして戻すと、Maxでベイクした場合よりも見た目が悪くなります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpace対MikkTSpace？</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
次の問題は、MikkTSpaceのバージョンが複数あることです。</font><font style="vertical-align: inherit;">はい、もし</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">それ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">が</font><em><font style="vertical-align: inherit;">どういうわけか</font></em><font style="vertical-align: inherit;">混乱をもたらさ</font><font style="vertical-align: inherit;">なければ</font><em><font style="vertical-align: inherit;">、それ</font></em><font style="vertical-align: inherit;">は</font><font style="vertical-align: inherit;">標準</font><em><font style="vertical-align: inherit;">で</font></em><font style="vertical-align: inherit;">はありません。</font><font style="vertical-align: inherit;">MikkTSpaceは、各頂点のメッシュにデータを格納する方法と、データをレンダリングに使用する方法を決定します。</font><font style="vertical-align: inherit;">MikkTSpace対応アプリケーションはすべて、頂点について同じメッシュデータを計算します。</font><font style="vertical-align: inherit;">ただし、</font><font style="vertical-align: inherit;">このデータをレンダリングで</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用する</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法は2つあり</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">MikkTSpaceは、UV方向に基づいて各頂点の接線ベクトルと符号を計算する方法を定義します。</font><font style="vertical-align: inherit;">しかし、接線空間を使用する場合、2つの点（接線）への接線は、頂点ごとまたはピクセルごとに再計算されます。</font><font style="vertical-align: inherit;">このパラメータも、ベイク処理と表示で同じでなければなりません。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
xNormalとSubstanceには、両方の方法を使用して法線マップをベイクするオプションがあります。これらのオプションは、Substanceでは「フラグメントごとの接線空間を計算する」と呼ばれ、xNormalでは「ピクセルシェーダーで従法線を計算する」と呼ばれます。</font><font style="vertical-align: inherit;">組み込みのUnityレンダリングメソッド</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用している場合は、これ</font><em><font style="vertical-align: inherit;">を</font></em><font style="vertical-align: inherit;">使用する</font><em><font style="vertical-align: inherit;">必要はありません</font></em><font style="vertical-align: inherit;">。ただし、</font><font style="vertical-align: inherit;">選択するタイプによっては、SRPでこれを行う</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">価値がある</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">かもしれません</font><font style="vertical-align: inherit;">！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc8/288/f49/dc8288f495d420416d8bd2ee5ae401c3.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フォワードレンダラーUnityが組み込まれたXNormalの「ピクセルシェーダー従法線」</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
視覚的には、これは完全に異なる接線空間を使用しているように見えますが、通常はあまり</font><i><font style="vertical-align: inherit;">目立ち</font></i><font style="vertical-align: inherit;">ません。一部の顔は、法線が少し歪んでいるかのように見え、大きなへこみがありません。ここでの解決策は非常に簡単です。Unityの組み込みレンダリングメソッドを使用する場合は、このオプションを選択しないでください。 HDRP用のUnrealまたはUnityエンジンをベイク処理する場合は、ボックスをオンにします。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
多くの情報筋は、BlenderとUnityは同一であると述べていますが、実際には決してそうではありません！ Unityと同様に、BlenderはMikkTSpaceとOpenGLの方向を使用しますが、Unrealと同様に、フラグメントの2項ごとに従法線を使用します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
良いニュースは、LWRP、URP、シェーダーグラフシェーダーが各頂点に従法線を使用し、各ピクセルに組み込みHDRPシェーダーを使用するようになったことです。</font><font style="vertical-align: inherit;">シェーダーグラフ（7.2.0）の将来の更新では、ピクセル単位の計算への移行が実行され、しばらくすると、組み込みのURPシェーダーもそれに切り替えます。</font><font style="vertical-align: inherit;">また、このようなルートを選択した場合は、独自のシェーダーを使用して標準のレンダリング方法を変更できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角測量、三角測量、三角測量！</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最後の問題は、三角測量のさまざまな方法です。</font><font style="vertical-align: inherit;">予備的な三角測量なしでメッシュをエクスポートする場合、他のアプリケーションが同じ方法でモデルを三角測量する保証はありません。</font><font style="vertical-align: inherit;">これは法線マップにも悪影響を及ぼします！</font><font style="vertical-align: inherit;">したがって、エクスポートオプションを使用するか、三角形分割モディファイアを使用して、メッシュを三角形分割します。</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/271/14f/174/27114f17454f66db812ec2673e72d97c.png"></div><br>
<i>  Substance Painter  ,   Unity  ,   3ds Max   (quads)</i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
これは、まるで法線マップが3ds Maxでベイク処理されているかのように、完全に間違った接線空間に非常に似ています。しかし、一般的なケースでは、それらは少し鋭く、ほとんど曲がっており、滑らかな凹面のようには見えません。このメッシュでは、Xシェイプが外面に表示されます。この問題は、複数の人が異なるアプリケーションのコンテンツ制作パイプラインでモデルを操作しているときに困難で煩わしいものになる可能性があります。これは、メッシュを三角形化せずに美しいポリゴンを保存しないと役立つことが多いためです。この場合、不便さを解消するか、モデルをゲームにエクスポートする前にパイプラインの最後のツールを作成して、法線のベイクに使用するメッシュの生成にも使用する必要があります。頂点の法線（接線空間の一部）を持つ接線空間のように、三角形分割も正確に一致する必要があります。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unityに最適な法線マップを作成するためのリスト</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そこで、Unityで使用する元の高ポリゴンモデルから低ポリゴンメッシュの接線空間法線マップを生成するためのヒントをいくつか紹介します。</font></font><br>
<br>
<ul>
<li><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3ds Max、Maya、または接線オプション</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpace</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">を持たないその他のアプリケーションを使用して法線マップをベイク</font><em><font style="vertical-align: inherit;">する必要はありません</font></em><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュをエクスポート</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角形</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">で、</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、および</font></font><strong><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">無</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線。</font></font></strong></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベーキング時（およびSubstance Painterのプロジェクトを作成するとき）、法線マップの方向として</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenGL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">またはX + </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y +</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z +を</font><font style="vertical-align: inherit;">選択し</font><strong><font style="vertical-align: inherit;">ます</font></strong><font style="vertical-align: inherit;">。</font></font></li>
<li><strong><em><font style="vertical-align: inherit;"></font></em> </strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">組み込みのレンダリング方法（プロアクティブまたは据え置き）またはLWRPをベイク処理するときに、</font><font style="vertical-align: inherit;">「</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピクセルごと</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">」/「</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フラグメント</font></font></strong><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">ごと</font></strong><font style="vertical-align: inherit;">」の</font><font style="vertical-align: inherit;">2つのポイントに対する接線のオプション</font><strong><em><font style="vertical-align: inherit;">を</font></em></strong><font style="vertical-align: inherit;">含める</font><strong><em><font style="vertical-align: inherit;">必要はありません</font></em></strong><font style="vertical-align: inherit;">。</font></font></li>
<li><strong><em><font style="vertical-align: inherit;"></font></em></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HDRPのベイク処理時、およびすぐにURPの場合</font><font style="vertical-align: inherit;">、2つの</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「ピクセルごと」</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> /</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">「フラグメントごと」の</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ポイントへの接線のオプションを</font><strong><em><font style="vertical-align: inherit;">含め</font></em></strong><font style="vertical-align: inherit;">ます</font><font style="vertical-align: inherit;">。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線を「インポート」に設定し、接線を「Mikktspaceを計算」に設定して、Unityのモデルインポートオプションをデフォルトのままにします。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
それで全部です！</font><font style="vertical-align: inherit;">完全に焼き付けられた法線マップを取得するたびに！</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3a4/810/be8/3a4810be8abd5ad6cb24fca98ee9e61c.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">やったー！</font><font style="vertical-align: inherit;">完璧なノーマルマップ！</font></font></i><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bed/daa/477/beddaa477b105ae87e6dda113381e910.png"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...反射あり？</font><font style="vertical-align: inherit;">Ahem ..</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
さて、最後の1つは無視します。</font><font style="vertical-align: inherit;">チャンネルごとに8ビットの圧縮テクスチャフォーマットで可能な限り「完璧」。</font><font style="vertical-align: inherit;">ディザ法線マップはストライプよりも少し良く見えるかもしれませんが、残念ながら、多くのツールがこのオプションを提供していません。</font><font style="vertical-align: inherit;">それ以外の場合は、16ビットの法線マップを使用できます。</font><font style="vertical-align: inherit;">しかし、これは別の記事のトピックです。</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpaceについて詳しく学んでください。</font></font></h1><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mikktspace.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
の半公式サイトでは、</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">MikkTSpace</font></a><font style="vertical-align: inherit;">の主な利点がよく説明されています。特に、このスペースは、結果の整合性を維持しながら、メッシュ処理が異なるプログラム間での接線データの再カウントと転送の両方に適しています。このサイトのテキストは、Morten S. Mikkelsen自身が書いた、すでに消滅しているBlender wikiページのコピーです。残念ながら、それは各ピクセルの2点への接線を持つバージョンにのみ言及し、各頂点のバージョンには言及しません。UnityとxNormalで使用されるデフォルトです。 Blenderはピクセルごとの接線の導関数を使用するので、それらだけが言及されるのは論理的です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
元の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mikktspace.h</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ファイルのこれら2つのオプションに関するコメントは次の</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;">とおり</font></a><font style="vertical-align: inherit;">です</font><font style="vertical-align: inherit;">。</font></font><br>
<br>
<blockquote>           ,    /.<br>
<br>
<code>bitangent = fSign * cross(vN, tangent);</code><br>
<br>
…<br>
<br>
    (/    )     ,          .<br>
<br>
,   ,       ,    «»  ,       : vT, vB  vN.<br>
<br>
  (  )<br>
<br>
<code>vNout = normalize( vNt.x * vT + vNt.y * vB + vNt.z * vN );</code><br>
<br>
 vNt —    .         «» ,       ,    .<br>
<br>
…<br>
<br>
         ,     ,   ,        .</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
そのため、元の例では、2点への接線が頂点シェーダーで再作成され、別の補間値としてピクセルシェーダーに渡されます。これは、通常のUnityシェーダーが現在、通常のマップを処理する方法です。ピクセルシェーダーでこのタスクを実行する例は、「メイン」の例というよりはむしろ即席です。さらに、Unity 5.3（およびxNormal？）の実装はMorten S. Mikkelsen自身によって作成され、どちらも各頂点に接線を使用しているため、これは私たちの理論のもう1つの証明です。しかし、その後Blenderはピクセル単位の接線を使用し、Mortenも関与しました。おそらく、実際には、完成したUnityシェーダーに小さな変更を加えたのは単なるオプションであり、リアルタイムグラフィックスの場合、他の方法よりもはるかに優れている方法はありませんでした。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ピクセルごとの実装の利点は、ALU（ピクセルシェーダーの計算）に少し余分なコストをかけて、2つの補間された値を削除することです。これは、Vector3の3つの値（接線、2点への接線、および法線）の代わりに、Vector4およびVector3（符号付きの接線と法線）のみが必要であることを意味します。最近のGPUでは、これは少し高速です。そして、それは、</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">間違いなく、</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CPUで実行するとき、それは非リアルタイムレンダラーのために使用することができるので、より速く。この観点から見ると、業界のほとんどが、頂点ではなくピクセルの2点への接線を再現することを決定したのは当然です。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
私がこの記事を書いたときに、モーテンがUnity SRPでのピクセル単位の接線から2点への移行を促進したのはおかしいです！</font><font style="vertical-align: inherit;">Unityの組み込みレンダリング方法に不便な選択の遺産があるのは、残念なことです。</font></font><br>
<br>
<hr><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">さまざまなアプリケーションでの接線スペース</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
この記事は主にUnityに焦点を当てていますが、今日このエンジンが主流になったので、私の研究をより詳細にしたかったのです。</font><font style="vertical-align: inherit;">したがって、接線空間の使用に関する情報を含むさまざまなアプリケーションのリストを作成しました。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unity（5.3以降）</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">頂点またはピクセル* </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトでは、エンジンはインポート時にメッシュの接線を強制的に再定義して、MikkTSpaceを使用します。上級ユーザー向けには、接線メッシュを使用するためのオプションがありますが、これは他のツールでベイク処理された法線マップとの互換性を保証するものではありません（特に組み込みシェーダーを使用する場合）。完全に独自のシェーダーに置き換えることができます。また、組み込みのシェーダーでは、HDRPは2点へのピクセル単位の接線を使用します。執筆時点では、URPシェーダーグラフとシェーダーグラフシェーダーも2点へのピクセル単位の接線に切り替える予定でした。 Unity 5.3より前の</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20160306000702/" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">バージョン</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">では、エンジンは</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20160306000702/" rel="noopener nofollow"><font style="vertical-align: inherit;">Lengyel</font></a><font style="vertical-align: inherit;">タンジェントを使用していました</font><font style="vertical-align: inherit;">。これは、メッシュインポーターでLegacy Tangentsオプションを選択することで引き続き使用できますが、組み込みシェーダーはこのタンジェントスペースをサポートしなくなりました。</font></font><br>
<br>
<em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">追加：URP 7.2.0より前のバージョンでは、シェーダーグラフの法線マップの処理は完全に壊れていました。</font><font style="vertical-align: inherit;">MikkTSpaceもLengyel接線空間も正しく使用されておらず、シェーダーグラフ内でこれを修正することは不可能です。</font><font style="vertical-align: inherit;">可能であれば、7.2.0にアップグレードします。</font></font></em><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">アンリアルエンジン4</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direct3D Y- </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピクセル単位</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトでは、エンジンはMikkTSpaceを使用してインポートするときにメッシュの接線を再定義します。</font><font style="vertical-align: inherit;">上級ユーザー向けには、接線メッシュを使用するオプションがありますが、これは他のツールでベイクされた法線マップとの互換性を保証するものではありません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ゴドット</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向き：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各頂点について</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線データがない場合、インポート時にMikkTSpaceで接線メッシュを計算できます。</font><font style="vertical-align: inherit;">エンジンのドキュメントでは、接線メッシュメッシュのエクスポートが推奨されていますが、ほとんどのツールは正しい接線メッシュをエクスポートしないため、このヒントは無視します。</font><font style="vertical-align: inherit;">元の接線メッシュを使用しても、法線マップが正しく表示される保証はありません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プレイキャンバス</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=http://web.archive.org/web/20160306000702/" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lengyel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schüler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> * </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各頂点/微分に基づく</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間を処理するためのいくつかの方法を提供します。コードで生成された接線はMikkTSpaceを使用しません。これは、各頂点のための2つの点の接線を使用するためのオプションを有する「fastTbn」ピクセルシェーダのいずれかでノーマライズ接線空間ベクトルを</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正規化することなく</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、我々は、フラグメントシェーダに接線空間を（</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">必要</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">、これは各頂点の計算を含むMikkTSpaceの実装に対応するため）、または</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ja&amp;u=" rel="noopener nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Christian Schuler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">から借用した導関数ベースのTBNを使用し</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">メッシュの接線を完全に無視し、ピクセルシェーダーの接線空間を計算します。</font><font style="vertical-align: inherit;">現在、デフォルトでは、導関数ベースの法線マップが使用されています。私が知る限り、正確な法線マップをベイクするためのツールはありません。</font><font style="vertical-align: inherit;">既存の法線とタンジェントデータを含むメッシュをMikkTSpaceからインポートし、「fastTbn」マテリアルオプションを使用してUnityの組み込みレンダリングメソッドと一致させることは可能ですが、これはエディターインターフェイスではなくコードで行う必要があると思います。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">フィラメント</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各頂点について</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将来のパフォーマンスによっては、エンジンが2点へのピクセル単位の接線に移動する場合があります。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3ds max</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direct3D Y- * </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブ</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュエクスポートオプション：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角化をオンにして、接線と従法線をオフにしてFBXファイルを</font><strong><font style="vertical-align: inherit;">エクスポートします</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">法線は常にエクスポートする必要があります。</font><font style="vertical-align: inherit;">頂点ごとの分割法線は無効のままにしておくことができます。</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトでは、3ds Maxは法線マップでDirect3Dの方向が使用されることを前提としていますが、マテリアルで法線マップテクスチャを使用するときにX方向とY方向を反転するオプションがあります。</font><font style="vertical-align: inherit;">ベイク処理は常にDirect3D方向を使用します。</font><font style="vertical-align: inherit;">MikkTSpaceのサポートは、将来のバージョンで提供される予定です。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マヤ</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ネイティブ</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュエクスポートオプション：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三角化をオンにして、接線と従法線をオフにしてFBXファイルを</font><strong><font style="vertical-align: inherit;">エクスポートします</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">法線は常にエクスポートされます。</font><font style="vertical-align: inherit;">頂点ごとの分割法線は無効のままにしておくことができます。</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一部の人から、MayaはすでにMikkTSpaceを部分的にサポートしていると言われていますが、どの程度かはわかりません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ブレンダー（2.57+）</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> OpenGL Y + </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線スペース：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各ピクセルの</font><strong><font style="vertical-align: inherit;">メッシュ</font></strong></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">エクスポートオプション：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">スムージング値が「通常のみ」のFBXファイルを</font><strong><font style="vertical-align: inherit;">エクスポートします</font></strong><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">ターゲットアプリケーションがUnityやUnrealなどのMikkTSpaceも使用している場合は、接線スペースの有無にかかわらずエクスポートできます。</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> FBXにエクスポートする場合、Blenderには三角形分割オプションがないため、最初に[三角形分割]モディファイヤを使用します。</font><font style="vertical-align: inherit;">Blenderでベイク処理された法線マップは、Unityと100％互換性がありませんが、サードパーティのアプリケーションまたはカスタマイズされたマテリアルで緑のチャンネルを反転させると、Unrealで完全に機能します。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xNormal（3.17.5以降）</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace * MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム（各頂点またはピクセル）</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線マップをベイクするためのオプション：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">には、エクスポート中に法線マップの3つの軸すべてを反転させるオプションがあります。 UnityにはX + Y + Z +が必要です。各頂点またはピクセル（つまり、フラグメント）の2点への接線を使用するオプションもあります。デフォルトでは、xNormalは各頂点の2点への接線を使用しますが、これはプラグインマネージャーメニュー（左下隅の電源プラグアイコン）で「正接基準計算機」、「Mikk-TSpace」をクリックし、「構成」をクリックして変更できます。ポップアップウィンドウが表示され、「ピクセルシェーダーで従法線を計算する」という唯一のオプションが表示されます。 Unityではオフにし、Unrealではオンにする必要があります。</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノート：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">xNormalはMikkTSpaceのみをサポートしますが、そのプラグインシステムは理論的にはすべての接線空間をサポートします。</font><font style="vertical-align: inherit;">これまでのところ、私が知っている唯一の接線空間プラグインは、Unity 4の接線空間をベイクするように設計されており、すでに役に立たない。</font><font style="vertical-align: inherit;">つまり、現実的にアプローチすると、アプリケーションはMikkTSpaceのみをサポートします。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">物質画家</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタマイズ可能（OpenGLまたはDirect3D）</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタマイズ可能（頂点またはピクセル用）</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線マップの</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ベイクオプション</font><strong><font style="vertical-align: inherit;">：</font></strong><font style="vertical-align: inherit;"> OpenGLまたはDirect3D方向にベイクオプションがあります。また、各頂点またはピクセル（フラグメント）の2点への接線を使用するためのオプションは、[フラグメントごとの接線スペースの計算]パラメーターで構成されます。組み込みのUnityレンダリング方式でエクスポートする場合は、OpenGLを選択し、プロジェクトおよびエクスポートオプションでフラグメントごとのタンジェントスペースの計算を無効にする必要があります。UnrealまたはUnity HDRPにエクスポートする場合は、逆の操作を行います。</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ノート：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Substance Painterはデフォルトで、インポートされたメッシュが使用する接線データを使用します。</font><font style="vertical-align: inherit;">Blenderからエクスポートしているのでなければ、あなたはそれを必要としません！</font><font style="vertical-align: inherit;">ただし、この機能を無効にするオプションはありません。</font><font style="vertical-align: inherit;">Substance Painterにインポートする前に、</font><font style="vertical-align: inherit;">接線</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">なしで</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">メッシュ</font><em><font style="vertical-align: inherit;">を</font></em><font style="vertical-align: inherit;">エクスポートし</font><font style="vertical-align: inherit;">ます。</font><font style="vertical-align: inherit;">以前のSubstanceドキュメントでは</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
、Blenderの</font><font style="vertical-align: inherit;">2点への接線の計算が</font><font style="vertical-align: inherit;">Unityに対応</font><font style="vertical-align: inherit;">していると誤って主張</font><font style="vertical-align: inherit;">されていましたが、今ではエラーが修正されました！</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">マーモセットツールバッグ3</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpaceの2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピクセル単位</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">プログラムには、ほとんどすべての既存の構成で法線マップを表示またはベイクするオプションがあるようです。</font><font style="vertical-align: inherit;">接線空間3ds MaxおよびMayaの既成の設定を含みます！</font><font style="vertical-align: inherit;">ただし、接線空間オプション「Mikk / xNormal」は、2点へのピクセル単位の接線を使用し、これは変更できません。</font><font style="vertical-align: inherit;">つまり、Marmoset Toolbag 3は、組み込みのUnityレンダリングメソッドの法線マップを正しく表示またはベイクできません。</font><font style="vertical-align: inherit;">おそらく将来のバージョンでは、開発者が問題を認識しているため、状況は変わるでしょう。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3DCoat</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向き：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpaceの2点への接線の計算</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：？</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法線マップを表示およびベイクするための多くのオプションがあります。</font><font style="vertical-align: inherit;">BlenderとUE4を完全に一致させることができるため、2点へのピクセル単位の接線をサポートしますが、Unityプリセットで2点への頂点接線が使用されているかどうかはわかりません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Houdini（16.0.514以降）</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタマイズ可能な</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタマイズ可能* </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpaceの2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピクセル単位</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線またはMikkTSpaceの独自の基準をサポートしていますが、表示とベイクの両方が可能ですが、ピクセル単位のバージョンのみです。</font><font style="vertical-align: inherit;">デフォルトではレンダリングにMikkTSpaceを使用していないようですが、Houdini 17.5以降で使用しています。</font><font style="vertical-align: inherit;">メッシュを組み込みノードで変更して、接線MikkTSpaceを使用できます。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modo（10+？）</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方向：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MikkTSpaceの2点接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム（頂点またはピクセル単位）* </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">異なる接線空間でのレンダリングとベイク処理、およびエクスポート用の2点へのピクセル単位の接線のオプションをサポートしているようです。</font><font style="vertical-align: inherit;">私はこれをテストしていません。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">クナルド</font></font></h2><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向き：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">カスタム</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">接線空間：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MikkTSpace MikkTSpaceの</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2点への接線の計算：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ピクセル単位</font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">デフォルトでは、MikkTSpaceを使用し、インポートされたメッシュの接線を再定義しますが、必要に応じて、既存の接線メッシュを使用するオプションがあります。</font><font style="vertical-align: inherit;">法線マップの向きは、プロジェクト全体に適用されるパラメーターを使用して反転できます。</font></font><br>
<br>
<hr><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最終的に</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
重要な側面は、ベイク処理する低ポリゴンモデルが単なる平面である場合（たとえば、テクスチャをタイリングする場合）、書き込まれたすべては重要ではなく、すべてのツールを使用してベイク処理できるということです...後で対応するテクスチャチャンネルを反転します。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
さらに、記事に記載されている問題のほとんどは、ソリッドモデルでのみ顕著です。</font><font style="vertical-align: inherit;">オーガニックフォームは、最も微妙な違い、たとえば、頂点とピクセルごとの2点への接線の違いを隠すことができます。</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ja487920/index.html">C ++でのオーバーロード。パートI.関数とテンプレートのオーバーロード</a></li>
<li><a href="../ja487922/index.html">マイクロサービスをデプロイする方法を学びます。パート1. Spring BootとDocker</a></li>
<li><a href="../ja487924/index.html">キム・ドットコム：キャッチ、オンラインで最も欲しい人。パート3</a></li>
<li><a href="../ja487926/index.html">体育を求めて</a></li>
<li><a href="../ja487930/index.html">講義夜、gamedevにしたい</a></li>
<li><a href="../ja487934/index.html">GOツールを使用してDNSサーバーを最適化した方法</a></li>
<li><a href="../ja487938/index.html">サンプルタスクリストを使用したエフェクタードムの紹介</a></li>
<li><a href="../ja487940/index.html">Rでの再現可能なコンピューティングコードとデータを分離する方法は？</a></li>
<li><a href="../ja487944/index.html">エネルギー分野の機械学習、または誰もが明日を見ることができるわけではない</a></li>
<li><a href="../ja487948/index.html">Telegramボットを使用したOpenVPNでの2要素認証</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>