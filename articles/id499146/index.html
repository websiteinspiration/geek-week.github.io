<!doctype html>
<html class="no-js" lang="id">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-13"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-13');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“‰ ğŸ• ğŸ‘¨ğŸ¼â€ğŸ« Cara mudah untuk melindungi Mikrotik Anda dari serangan ğŸšº ğŸ¤³ğŸ¿ ğŸ˜ </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya ingin berbagi dengan komunitas cara yang sederhana dan bekerja bagaimana menggunakan Mikrotik untuk melindungi jaringan saya dan layanan yang "me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://geek-week.github.io/index.html"></a>
    <div class="page-header-text">Get best of the week</div>
  </header>
  <section class="page js-page"><h1>Cara mudah untuk melindungi Mikrotik Anda dari serangan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/499146/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya ingin berbagi dengan komunitas cara yang sederhana dan bekerja bagaimana menggunakan Mikrotik untuk melindungi jaringan saya dan layanan yang "melihat keluar" karena itu dari serangan eksternal. Yaitu, dengan hanya tiga aturan, atur honeypot pada Mikrotik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, mari kita bayangkan bahwa kita memiliki kantor kecil, IP eksternal yang merupakan server RDP, bagi karyawan untuk bekerja dari jarak jauh. Aturan pertama tentu saja untuk mengubah port 3389 pada antarmuka eksternal ke yang lain. Tapi ini tidak lama, setelah beberapa hari, log audit server terminal akan mulai menunjukkan beberapa otorisasi yang gagal per detik dari klien yang tidak dikenal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Situasi lain, Anda memiliki tanda bintang yang tersembunyi di belakang Mikrotik, tentu saja, bukan pada port udp 5060, dan setelah beberapa hari tebak kata sandi juga dimulai ... ya ya, saya tahu, fail2ban adalah segalanya, tetapi saya masih harus engah ... misalnya, saya baru saja mengangkatnya ke ubuntu Pada tanggal 18 April, saya terkejut menemukan bahwa out2 kotak fail2ban tidak mengandung pengaturan aktual untuk asterisk dari kotak yang sama dari distribusi ubuntu yang sama ... tetapi Google tidak dapat mengatur cepat Google dari "resep" yang sudah jadi, jumlah rilis terus meningkat selama bertahun-tahun, dan artikel dengan " resep â€untuk versi lama tidak lagi berfungsi, tetapi hampir tidak ada yang baru ... Tapi sesuatu yang saya ngelantur ...</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, singkatnya honeypot - adalah umpan, dalam kasus kami, beberapa port populer pada IP eksternal, setiap permintaan ke port ini dari klien eksternal mengirimkan alamat src ke daftar hitam. </font><font style="vertical-align: inherit;">Semua.</font></font><br>
 <br>
<pre><code class="plaintext hljs">/ip firewall filter<font></font>
add action=add-src-to-address-list address-list="Honeypot Hacker" \<font></font>
    address-list-timeout=30d0h0m chain=input comment="block honeypot ssh rdp winbox" \<font></font>
    connection-state=new dst-port=22,3389,8291 in-interface=\<font></font>
    ether4-wan protocol=tcp<font></font>
add action=add-src-to-address-list address-list="Honeypot Hacker" \<font></font>
    address-list-timeout=30d0h0m chain=input comment=\<font></font>
    "block honeypot asterisk" connection-state=new dst-port=5060 \<font></font>
    in-interface=ether4-wan protocol=udp <font></font>
/ip firewall raw<font></font>
add action=drop chain=prerouting in-interface=ether4-wan src-address-list=\<font></font>
    "Honeypot Hacker"<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aturan pertama pada port TCP populer 22, 3389, 8291 dari antarmuka ether4-wan eksternal mengirimkan IP tamu ke daftar Honeypot Hacker (port untuk ssh, rdp dan winbox dinonaktifkan terlebih dahulu atau diubah ke yang lain). Yang kedua melakukan hal yang sama pada UDP 5060 yang populer </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
. Aturan ketiga pada tahap pra-routing menjatuhkan paket "tamu" yang srs-addressnya masuk ke "Honeypot Hacker". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah dua minggu bekerja di rumah Mikrotik, daftar Honeypot Hacker mencakup sekitar satu setengah ribu alamat IP penggemar ramah ambing sumber daya jaringan saya (telepon rumah, surat, nextcloud, rdp). Serangan brute force berhenti, kebahagiaan pun terjadi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di tempat kerja, tidak semuanya ternyata sangat sederhana, mereka terus menghancurkan server rdp dengan kata sandi brute force.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rupanya, nomor port ditentukan oleh pemindai jauh sebelum honeypot dinyalakan, dan selama karantina tidak mudah untuk mengkonfigurasi ulang lebih dari 100 pengguna, yang 20% â€‹â€‹di atas 65 tahun. </font><font style="vertical-align: inherit;">Jika port tidak dapat diubah, ada resep kerja kecil. </font><font style="vertical-align: inherit;">Saya bertemu serupa di Internet, tetapi ada yang selesai dan fine-tuning:</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aturan untuk mengonfigurasi Port Knocking</font></font></b>
                        <div class="spoiler_text"> <pre><code class="plaintext hljs"> /ip firewall filter<font></font>
add action=add-src-to-address-list address-list=rdp_blacklist \<font></font>
    address-list-timeout=15m chain=forward comment=rdp_to_blacklist \<font></font>
    connection-state=new dst-port=3389 protocol=tcp src-address-list=\<font></font>
    rdp_stage12<font></font>
add action=add-src-to-address-list address-list=rdp_stage12 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage11<font></font>
add action=add-src-to-address-list address-list=rdp_stage11 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage10<font></font>
add action=add-src-to-address-list address-list=rdp_stage10 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage9<font></font>
add action=add-src-to-address-list address-list=rdp_stage9 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage8<font></font>
add action=add-src-to-address-list address-list=rdp_stage8 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage4<font></font>
add action=add-src-to-address-list address-list=rdp_stage7 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage6<font></font>
add action=add-src-to-address-list address-list=rdp_stage6 \<font></font>
    address-list-timeout=4m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage5<font></font>
add action=add-src-to-address-list address-list=rdp_stage5 \<font></font>
    address-list-timeout=2m chain=forward connection-state=new dst-port=\<font></font>
    3389 protocol=tcp src-address-list=rdp_stage4<font></font>
add action=add-src-to-address-list address-list=rdp_stage4 \<font></font>
    address-list-timeout=2m chain=forward connection-state=new dst-port=\<font></font>
    3389 protocol=tcp src-address-list=rdp_stage3<font></font>
add action=add-src-to-address-list address-list=rdp_stage3 \<font></font>
    address-list-timeout=2m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage2<font></font>
add action=add-src-to-address-list address-list=rdp_stage2 \<font></font>
    address-list-timeout=2m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp src-address-list=rdp_stage1<font></font>
add action=add-src-to-address-list address-list=rdp_stage1 \<font></font>
    address-list-timeout=2m chain=forward connection-state=new dst-port=3389 \<font></font>
    protocol=tcp <font></font>
/ip firewall raw<font></font>
add action=drop chain=prerouting in-interface=ether4-wan src-address-list=\<font></font>
rdp_blacklist<font></font>
</code></pre> </div>
                    </div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam 4 menit, klien jarak jauh diizinkan untuk membuat hanya 12 "permintaan" baru ke server RDP. </font><font style="vertical-align: inherit;">Satu upaya login adalah dari 1 hingga 4 â€œpermintaanâ€. </font><font style="vertical-align: inherit;">Pada "permintaan" ke-12 - kunci selama 15 menit. </font><font style="vertical-align: inherit;">Dalam kasus saya, para penyerang tidak berhenti meretas server, mereka beradaptasi dengan timer dan sekarang mereka melakukannya dengan sangat lambat, kecepatan pemilihan ini mengurangi efisiensi serangan menjadi nol. </font><font style="vertical-align: inherit;">Karyawan perusahaan praktis tidak mengalami ketidaknyamanan dalam pekerjaan yang diambil.</font></font><br>
<br>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trik kecil lainnya</font></font></b>
                        <div class="spoiler_text">            5,     ,     .<br>
<br>
<pre><code class="plaintext hljs">/ip firewall filter <font></font>
add action=add-src-to-address-list address-list=rdp_blacklist \<font></font>
    address-list-timeout=1w0d0h0m chain=forward comment=\<font></font>
    "night_rdp_blacklist" connection-state=new disabled=\<font></font>
    yes dst-port=3389 protocol=tcp src-address-list=rdp_stage8</code></pre><br>
  8    IP       . !<br>
</div>
                    </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, selain yang di atas, saya akan menambahkan tautan ke artikel Wiki, dengan pengaturan kerja melindungi Mikrotik dari pemindai jaringan. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki.mikrotik.com/wiki/Drop_port_scanners</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Di perangkat saya, pengaturan ini bekerja bersama dengan aturan honeypot yang dijelaskan di atas, melengkapi mereka dengan baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD: Seperti yang disarankan dalam komentar, aturan drop paket telah dipindahkan ke RAW untuk mengurangi beban pada router.</font></font></div>
      
    </div>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id499130/index.html">BlockAdBlock Advertising Anti-Blocking Reverse Engineering</a></li>
<li><a href="../id499134/index.html">4 langkah untuk meningkatkan produk LTV melalui komunikasi pengguna</a></li>
<li><a href="../id499136/index.html">#BeeFree, atau ... Langsung menuju - Anda tidak bisa menolak?</a></li>
<li><a href="../id499138/index.html">Penyortiran topologis</a></li>
<li><a href="../id499140/index.html">Generasi di bawah kendali: cara mengekang model bahasa yang kuat</a></li>
<li><a href="../id499148/index.html">Aerosol dan klorin dioksida (ClO2): bagaimana ini terkait?</a></li>
<li><a href="../id499150/index.html">Dan satu prajurit di lapangan: apakah mungkin untuk menyediakan layanan hosting yang berkualitas tanpa tim</a></li>
<li><a href="../id499152/index.html">DLL & Python</a></li>
<li><a href="../id499154/index.html">Intisari materi menarik untuk pengembang seluler # 342 (pada 20 - 26 April)</a></li>
<li><a href="../id499162/index.html">Bagaimana mengurangi ukuran bundel - strategi kelas satu huruf dalam css-modules</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter63335242 = new Ya.Metrika({
                  id:63335242,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/63335242" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-13', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Geek Week | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=i62cJ2037o_BACd40gCrIso3niu0Sjx2sDFYJkeYdRk&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>